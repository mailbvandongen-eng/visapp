const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-DSfk1ysZ.js","assets/GeoJSON-DLOFIqVA.js","assets/boothellingenOL-DFr1ImEA.js","assets/viswaterOL-sHXa_mau.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Sx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var $0={exports:{}},Sh={},H0={exports:{}},$e={};var GT;function HM(){if(GT)return $e;GT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function y(U){return U===null||typeof U!="object"?null:(U=p&&U[p]||U["@@iterator"],typeof U=="function"?U:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,T={};function S(U,$,ie){this.props=U,this.context=$,this.refs=T,this.updater=ie||x}S.prototype.isReactComponent={},S.prototype.setState=function(U,$){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,$,"setState")},S.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function b(){}b.prototype=S.prototype;function D(U,$,ie){this.props=U,this.context=$,this.refs=T,this.updater=ie||x}var N=D.prototype=new b;N.constructor=D,I(N,S.prototype),N.isPureReactComponent=!0;var L=Array.isArray,F=Object.prototype.hasOwnProperty,G={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function R(U,$,ie){var me,xe={},ke=null,Me=null;if($!=null)for(me in $.ref!==void 0&&(Me=$.ref),$.key!==void 0&&(ke=""+$.key),$)F.call($,me)&&!k.hasOwnProperty(me)&&(xe[me]=$[me]);var Ve=arguments.length-2;if(Ve===1)xe.children=ie;else if(1<Ve){for(var We=Array(Ve),lt=0;lt<Ve;lt++)We[lt]=arguments[lt+2];xe.children=We}if(U&&U.defaultProps)for(me in Ve=U.defaultProps,Ve)xe[me]===void 0&&(xe[me]=Ve[me]);return{$$typeof:n,type:U,key:ke,ref:Me,props:xe,_owner:G.current}}function P(U,$){return{$$typeof:n,type:U.type,key:$,ref:U.ref,props:U.props,_owner:U._owner}}function V(U){return typeof U=="object"&&U!==null&&U.$$typeof===n}function j(U){var $={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(ie){return $[ie]})}var B=/\/+/g;function M(U,$){return typeof U=="object"&&U!==null&&U.key!=null?j(""+U.key):$.toString(36)}function se(U,$,ie,me,xe){var ke=typeof U;(ke==="undefined"||ke==="boolean")&&(U=null);var Me=!1;if(U===null)Me=!0;else switch(ke){case"string":case"number":Me=!0;break;case"object":switch(U.$$typeof){case n:case e:Me=!0}}if(Me)return Me=U,xe=xe(Me),U=me===""?"."+M(Me,0):me,L(xe)?(ie="",U!=null&&(ie=U.replace(B,"$&/")+"/"),se(xe,$,ie,"",function(lt){return lt})):xe!=null&&(V(xe)&&(xe=P(xe,ie+(!xe.key||Me&&Me.key===xe.key?"":(""+xe.key).replace(B,"$&/")+"/")+U)),$.push(xe)),1;if(Me=0,me=me===""?".":me+":",L(U))for(var Ve=0;Ve<U.length;Ve++){ke=U[Ve];var We=me+M(ke,Ve);Me+=se(ke,$,ie,We,xe)}else if(We=y(U),typeof We=="function")for(U=We.call(U),Ve=0;!(ke=U.next()).done;)ke=ke.value,We=me+M(ke,Ve++),Me+=se(ke,$,ie,We,xe);else if(ke==="object")throw $=String(U),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Me}function he(U,$,ie){if(U==null)return U;var me=[],xe=0;return se(U,me,"","",function(ke){return $.call(ie,ke,xe++)}),me}function ge(U){if(U._status===-1){var $=U._result;$=$(),$.then(function(ie){(U._status===0||U._status===-1)&&(U._status=1,U._result=ie)},function(ie){(U._status===0||U._status===-1)&&(U._status=2,U._result=ie)}),U._status===-1&&(U._status=0,U._result=$)}if(U._status===1)return U._result.default;throw U._result}var ue={current:null},Q={transition:null},re={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:Q,ReactCurrentOwner:G};function ne(){throw Error("act(...) is not supported in production builds of React.")}return $e.Children={map:he,forEach:function(U,$,ie){he(U,function(){$.apply(this,arguments)},ie)},count:function(U){var $=0;return he(U,function(){$++}),$},toArray:function(U){return he(U,function($){return $})||[]},only:function(U){if(!V(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},$e.Component=S,$e.Fragment=t,$e.Profiler=r,$e.PureComponent=D,$e.StrictMode=i,$e.Suspense=u,$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=re,$e.act=ne,$e.cloneElement=function(U,$,ie){if(U==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+U+".");var me=I({},U.props),xe=U.key,ke=U.ref,Me=U._owner;if($!=null){if($.ref!==void 0&&(ke=$.ref,Me=G.current),$.key!==void 0&&(xe=""+$.key),U.type&&U.type.defaultProps)var Ve=U.type.defaultProps;for(We in $)F.call($,We)&&!k.hasOwnProperty(We)&&(me[We]=$[We]===void 0&&Ve!==void 0?Ve[We]:$[We])}var We=arguments.length-2;if(We===1)me.children=ie;else if(1<We){Ve=Array(We);for(var lt=0;lt<We;lt++)Ve[lt]=arguments[lt+2];me.children=Ve}return{$$typeof:n,type:U.type,key:xe,ref:ke,props:me,_owner:Me}},$e.createContext=function(U){return U={$$typeof:o,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},U.Provider={$$typeof:s,_context:U},U.Consumer=U},$e.createElement=R,$e.createFactory=function(U){var $=R.bind(null,U);return $.type=U,$},$e.createRef=function(){return{current:null}},$e.forwardRef=function(U){return{$$typeof:l,render:U}},$e.isValidElement=V,$e.lazy=function(U){return{$$typeof:f,_payload:{_status:-1,_result:U},_init:ge}},$e.memo=function(U,$){return{$$typeof:h,type:U,compare:$===void 0?null:$}},$e.startTransition=function(U){var $=Q.transition;Q.transition={};try{U()}finally{Q.transition=$}},$e.unstable_act=ne,$e.useCallback=function(U,$){return ue.current.useCallback(U,$)},$e.useContext=function(U){return ue.current.useContext(U)},$e.useDebugValue=function(){},$e.useDeferredValue=function(U){return ue.current.useDeferredValue(U)},$e.useEffect=function(U,$){return ue.current.useEffect(U,$)},$e.useId=function(){return ue.current.useId()},$e.useImperativeHandle=function(U,$,ie){return ue.current.useImperativeHandle(U,$,ie)},$e.useInsertionEffect=function(U,$){return ue.current.useInsertionEffect(U,$)},$e.useLayoutEffect=function(U,$){return ue.current.useLayoutEffect(U,$)},$e.useMemo=function(U,$){return ue.current.useMemo(U,$)},$e.useReducer=function(U,$,ie){return ue.current.useReducer(U,$,ie)},$e.useRef=function(U){return ue.current.useRef(U)},$e.useState=function(U){return ue.current.useState(U)},$e.useSyncExternalStore=function(U,$,ie){return ue.current.useSyncExternalStore(U,$,ie)},$e.useTransition=function(){return ue.current.useTransition()},$e.version="18.3.1",$e}var WT;function Yd(){return WT||(WT=1,H0.exports=HM()),H0.exports}var $T;function KM(){if($T)return Sh;$T=1;var n=Yd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var f,p={},y=null,x=null;h!==void 0&&(y=""+h),u.key!==void 0&&(y=""+u.key),u.ref!==void 0&&(x=u.ref);for(f in u)i.call(u,f)&&!s.hasOwnProperty(f)&&(p[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)p[f]===void 0&&(p[f]=u[f]);return{$$typeof:e,type:l,key:y,ref:x,props:p,_owner:r.current}}return Sh.Fragment=t,Sh.jsx=o,Sh.jsxs=o,Sh}var HT;function qM(){return HT||(HT=1,$0.exports=KM()),$0.exports}var _=qM(),Pg={},K0={exports:{}},Qn={},q0={exports:{}},X0={};var KT;function XM(){return KT||(KT=1,(function(n){function e(Q,re){var ne=Q.length;Q.push(re);e:for(;0<ne;){var U=ne-1>>>1,$=Q[U];if(0<r($,re))Q[U]=re,Q[ne]=$,ne=U;else break e}}function t(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var re=Q[0],ne=Q.pop();if(ne!==re){Q[0]=ne;e:for(var U=0,$=Q.length,ie=$>>>1;U<ie;){var me=2*(U+1)-1,xe=Q[me],ke=me+1,Me=Q[ke];if(0>r(xe,ne))ke<$&&0>r(Me,xe)?(Q[U]=Me,Q[ke]=ne,U=ke):(Q[U]=xe,Q[me]=ne,U=me);else if(ke<$&&0>r(Me,ne))Q[U]=Me,Q[ke]=ne,U=ke;else break e}}return re}function r(Q,re){var ne=Q.sortIndex-re.sortIndex;return ne!==0?ne:Q.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,p=null,y=3,x=!1,I=!1,T=!1,S=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Q){for(var re=t(h);re!==null;){if(re.callback===null)i(h);else if(re.startTime<=Q)i(h),re.sortIndex=re.expirationTime,e(u,re);else break;re=t(h)}}function L(Q){if(T=!1,N(Q),!I)if(t(u)!==null)I=!0,ge(F);else{var re=t(h);re!==null&&ue(L,re.startTime-Q)}}function F(Q,re){I=!1,T&&(T=!1,b(R),R=-1),x=!0;var ne=y;try{for(N(re),p=t(u);p!==null&&(!(p.expirationTime>re)||Q&&!j());){var U=p.callback;if(typeof U=="function"){p.callback=null,y=p.priorityLevel;var $=U(p.expirationTime<=re);re=n.unstable_now(),typeof $=="function"?p.callback=$:p===t(u)&&i(u),N(re)}else i(u);p=t(u)}if(p!==null)var ie=!0;else{var me=t(h);me!==null&&ue(L,me.startTime-re),ie=!1}return ie}finally{p=null,y=ne,x=!1}}var G=!1,k=null,R=-1,P=5,V=-1;function j(){return!(n.unstable_now()-V<P)}function B(){if(k!==null){var Q=n.unstable_now();V=Q;var re=!0;try{re=k(!0,Q)}finally{re?M():(G=!1,k=null)}}else G=!1}var M;if(typeof D=="function")M=function(){D(B)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,he=se.port2;se.port1.onmessage=B,M=function(){he.postMessage(null)}}else M=function(){S(B,0)};function ge(Q){k=Q,G||(G=!0,M())}function ue(Q,re){R=S(function(){Q(n.unstable_now())},re)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_continueExecution=function(){I||x||(I=!0,ge(F))},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(Q){switch(y){case 1:case 2:case 3:var re=3;break;default:re=y}var ne=y;y=re;try{return Q()}finally{y=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Q,re){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ne=y;y=Q;try{return re()}finally{y=ne}},n.unstable_scheduleCallback=function(Q,re,ne){var U=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?U+ne:U):ne=U,Q){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,Q={id:f++,callback:re,priorityLevel:Q,startTime:ne,expirationTime:$,sortIndex:-1},ne>U?(Q.sortIndex=ne,e(h,Q),t(u)===null&&Q===t(h)&&(T?(b(R),R=-1):T=!0,ue(L,ne-U))):(Q.sortIndex=$,e(u,Q),I||x||(I=!0,ge(F))),Q},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(Q){var re=y;return function(){var ne=y;y=re;try{return Q.apply(this,arguments)}finally{y=ne}}}})(X0)),X0}var qT;function YM(){return qT||(qT=1,q0.exports=XM()),q0.exports}var XT;function ZM(){if(XT)return Qn;XT=1;var n=Yd(),e=YM();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)i.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function y(a){return u.call(p,a)?!0:u.call(f,a)?!1:h.test(a)?p[a]=!0:(f[a]=!0,!1)}function x(a,c,d,m){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return m?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function I(a,c,d,m){if(c===null||typeof c>"u"||x(a,c,d,m))return!0;if(m)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function T(a,c,d,m,v,w,A){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=w,this.removeEmptyString=A}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){S[a]=new T(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];S[c]=new T(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){S[a]=new T(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){S[a]=new T(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){S[a]=new T(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){S[a]=new T(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){S[a]=new T(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){S[a]=new T(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){S[a]=new T(a,5,!1,a.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function D(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(b,D);S[c]=new T(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(b,D);S[c]=new T(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(b,D);S[c]=new T(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){S[a]=new T(a,1,!1,a.toLowerCase(),null,!1,!1)}),S.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){S[a]=new T(a,1,!1,a.toLowerCase(),null,!0,!0)});function N(a,c,d,m){var v=S.hasOwnProperty(c)?S[c]:null;(v!==null?v.type!==0:m||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(I(c,d,v,m)&&(d=null),m||v===null?y(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):v.mustUseProperty?a[v.propertyName]=d===null?v.type===3?!1:"":d:(c=v.attributeName,m=v.attributeNamespace,d===null?a.removeAttribute(c):(v=v.type,d=v===3||v===4&&d===!0?"":""+d,m?a.setAttributeNS(m,c,d):a.setAttribute(c,d))))}var L=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),G=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),j=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),he=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),Q=Symbol.iterator;function re(a){return a===null||typeof a!="object"?null:(a=Q&&a[Q]||a["@@iterator"],typeof a=="function"?a:null)}var ne=Object.assign,U;function $(a){if(U===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);U=c&&c[1]||""}return`
`+U+a}var ie=!1;function me(a,c){if(!a||ie)return"";ie=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(J){var m=J}Reflect.construct(a,[],c)}else{try{c.call()}catch(J){m=J}a.call(c.prototype)}else{try{throw Error()}catch(J){m=J}a()}}catch(J){if(J&&m&&typeof J.stack=="string"){for(var v=J.stack.split(`
`),w=m.stack.split(`
`),A=v.length-1,z=w.length-1;1<=A&&0<=z&&v[A]!==w[z];)z--;for(;1<=A&&0<=z;A--,z--)if(v[A]!==w[z]){if(A!==1||z!==1)do if(A--,z--,0>z||v[A]!==w[z]){var W=`
`+v[A].replace(" at new "," at ");return a.displayName&&W.includes("<anonymous>")&&(W=W.replace("<anonymous>",a.displayName)),W}while(1<=A&&0<=z);break}}}finally{ie=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?$(a):""}function xe(a){switch(a.tag){case 5:return $(a.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return a=me(a.type,!1),a;case 11:return a=me(a.type.render,!1),a;case 1:return a=me(a.type,!0),a;default:return""}}function ke(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case k:return"Fragment";case G:return"Portal";case P:return"Profiler";case R:return"StrictMode";case M:return"Suspense";case se:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case j:return(a.displayName||"Context")+".Consumer";case V:return(a._context.displayName||"Context")+".Provider";case B:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case he:return c=a.displayName||null,c!==null?c:ke(a.type)||"Memo";case ge:c=a._payload,a=a._init;try{return ke(a(c))}catch{}}return null}function Me(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ke(c);case 8:return c===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Ve(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function We(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function lt(a){var c=We(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),m=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,w=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return v.call(this)},set:function(A){m=""+A,w.call(this,A)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(A){m=""+A},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function er(a){a._valueTracker||(a._valueTracker=lt(a))}function fs(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),m="";return a&&(m=We(a)?a.checked?"true":"false":a.value),a=m,a!==d?(c.setValue(a),!0):!1}function Wn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function $n(a,c){var d=c.checked;return ne({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function hn(a,c){var d=c.defaultValue==null?"":c.defaultValue,m=c.checked!=null?c.checked:c.defaultChecked;d=Ve(c.value!=null?c.value:d),a._wrapperState={initialChecked:m,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function dn(a,c){c=c.checked,c!=null&&N(a,"checked",c,!1)}function Hn(a,c){dn(a,c);var d=Ve(c.value),m=c.type;if(d!=null)m==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(m==="submit"||m==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?yt(a,c.type,d):c.hasOwnProperty("defaultValue")&&yt(a,c.type,Ve(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function bi(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var m=c.type;if(!(m!=="submit"&&m!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function yt(a,c,d){(c!=="number"||Wn(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ct=Array.isArray;function tn(a,c,d,m){if(a=a.options,c){c={};for(var v=0;v<d.length;v++)c["$"+d[v]]=!0;for(d=0;d<a.length;d++)v=c.hasOwnProperty("$"+a[d].value),a[d].selected!==v&&(a[d].selected=v),v&&m&&(a[d].defaultSelected=!0)}else{for(d=""+Ve(d),c=null,v=0;v<a.length;v++){if(a[v].value===d){a[v].selected=!0,m&&(a[v].defaultSelected=!0);return}c!==null||a[v].disabled||(c=a[v])}c!==null&&(c.selected=!0)}}function Pi(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function St(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(t(92));if(ct(d)){if(1<d.length)throw Error(t(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:Ve(d)}}function to(a,c){var d=Ve(c.value),m=Ve(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),m!=null&&(a.defaultValue=""+m)}function ki(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function Ar(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tr(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?Ar(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var br,ca=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,m,v){MSApp.execUnsafeLocalFunction(function(){return a(c,d,m,v)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(br=br||document.createElement("div"),br.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=br.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function Pr(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var Ni={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ol=["Webkit","ms","Moz","O"];Object.keys(Ni).forEach(function(a){Ol.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Ni[c]=Ni[a]})});function kr(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||Ni.hasOwnProperty(a)&&Ni[a]?(""+c).trim():c+"px"}function gs(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var m=d.indexOf("--")===0,v=kr(d,c[d],m);d==="float"&&(d="cssFloat"),m?a.setProperty(d,v):a[d]=v}}var no=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function On(a,c){if(c){if(no[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function ps(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nr=null;function Dr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Fn=null,Vn=null,ft=null;function io(a){if(a=ch(a)){if(typeof Fn!="function")throw Error(t(280));var c=a.stateNode;c&&(c=$f(c),Fn(a.stateNode,a.type,c))}}function nr(a){Vn?ft?ft.push(a):ft=[a]:Vn=a}function Ot(){if(Vn){var a=Vn,c=ft;if(ft=Vn=null,io(a),c)for(a=0;a<c.length;a++)io(c[a])}}function Di(a,c){return a(c)}function fn(){}var Ft=!1;function gn(a,c,d){if(Ft)return a(c,d);Ft=!0;try{return Di(a,c,d)}finally{Ft=!1,(Vn!==null||ft!==null)&&(fn(),Ot())}}function pn(a,c){var d=a.stateNode;if(d===null)return null;var m=$f(d);if(m===null)return null;d=m[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,c,typeof d));return d}var nn=!1;if(l)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){nn=!0}}),window.addEventListener("test",rt,rt),window.removeEventListener("test",rt,rt)}catch{nn=!1}function Bt(a,c,d,m,v,w,A,z,W){var J=Array.prototype.slice.call(arguments,3);try{c.apply(d,J)}catch(ae){this.onError(ae)}}var qt=!1,Mi=null,Fl=!1,Li=null,Tf={onError:function(a){qt=!0,Mi=a}};function Sf(a,c,d,m,v,w,A,z,W){qt=!1,Mi=null,Bt.apply(Tf,arguments)}function Fu(a,c,d,m,v,w,A,z,W){if(Sf.apply(this,arguments),qt){if(qt){var J=Mi;qt=!1,Mi=null}else throw Error(t(198));Fl||(Fl=!0,Li=J)}}function ir(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function Vu(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function If(a){if(ir(a)!==a)throw Error(t(188))}function Cf(a){var c=a.alternate;if(!c){if(c=ir(a),c===null)throw Error(t(188));return c!==a?null:a}for(var d=a,m=c;;){var v=d.return;if(v===null)break;var w=v.alternate;if(w===null){if(m=v.return,m!==null){d=m;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===d)return If(v),a;if(w===m)return If(v),c;w=w.sibling}throw Error(t(188))}if(d.return!==m.return)d=v,m=w;else{for(var A=!1,z=v.child;z;){if(z===d){A=!0,d=v,m=w;break}if(z===m){A=!0,m=v,d=w;break}z=z.sibling}if(!A){for(z=w.child;z;){if(z===d){A=!0,d=w,m=v;break}if(z===m){A=!0,m=w,d=v;break}z=z.sibling}if(!A)throw Error(t(189))}}if(d.alternate!==m)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:c}function Rf(a){return a=Cf(a),a!==null?ua(a):null}function ua(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=ua(a);if(c!==null)return c;a=a.sibling}return null}var ju=e.unstable_scheduleCallback,Vl=e.unstable_cancelCallback,ha=e.unstable_shouldYield,ms=e.unstable_requestPaint,vt=e.unstable_now,Ey=e.unstable_getCurrentPriorityLevel,jl=e.unstable_ImmediatePriority,Uu=e.unstable_UserBlockingPriority,da=e.unstable_NormalPriority,zu=e.unstable_LowPriority,Ul=e.unstable_IdlePriority,fa=null,hi=null;function Af(a){if(hi&&typeof hi.onCommitFiberRoot=="function")try{hi.onCommitFiberRoot(fa,a,void 0,(a.current.flags&128)===128)}catch{}}var di=Math.clz32?Math.clz32:ga,Mr=Math.log,Oi=Math.LN2;function ga(a){return a>>>=0,a===0?32:31-(Mr(a)/Oi|0)|0}var Lr=64,ro=4194304;function st(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ys(a,c){var d=a.pendingLanes;if(d===0)return 0;var m=0,v=a.suspendedLanes,w=a.pingedLanes,A=d&268435455;if(A!==0){var z=A&~v;z!==0?m=st(z):(w&=A,w!==0&&(m=st(w)))}else A=d&~v,A!==0?m=st(A):w!==0&&(m=st(w));if(m===0)return 0;if(c!==0&&c!==m&&(c&v)===0&&(v=m&-m,w=c&-c,v>=w||v===16&&(w&4194240)!==0))return c;if((m&4)!==0&&(m|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=m;0<c;)d=31-di(c),v=1<<d,m|=a[d],c&=~v;return m}function pa(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ma(a,c){for(var d=a.suspendedLanes,m=a.pingedLanes,v=a.expirationTimes,w=a.pendingLanes;0<w;){var A=31-di(w),z=1<<A,W=v[A];W===-1?((z&d)===0||(z&m)!==0)&&(v[A]=pa(z,c)):W<=c&&(a.expiredLanes|=z),w&=~z}}function Bu(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Gu(){var a=Lr;return Lr<<=1,(Lr&4194240)===0&&(Lr=64),a}function Wu(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function ya(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-di(c),a[c]=d}function Ty(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var m=a.eventTimes;for(a=a.expirationTimes;0<d;){var v=31-di(d),w=1<<v;c[v]=0,m[v]=-1,a[v]=-1,d&=~w}}function $u(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var m=31-di(d),v=1<<m;v&c|a[m]&c&&(a[m]|=c),d&=~v}}var qe=0;function Or(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Hu,zl,Ku,qu,Xu,Fr=!1,Bl=[],Vr=null,jr=null,mn=null,_a=new Map,_s=new Map,fi=[],bf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function so(a,c){switch(a){case"focusin":case"focusout":Vr=null;break;case"dragenter":case"dragleave":jr=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":_a.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":_s.delete(c.pointerId)}}function rr(a,c,d,m,v,w){return a===null||a.nativeEvent!==w?(a={blockedOn:c,domEventName:d,eventSystemFlags:m,nativeEvent:w,targetContainers:[v]},c!==null&&(c=ch(c),c!==null&&zl(c)),a):(a.eventSystemFlags|=m,c=a.targetContainers,v!==null&&c.indexOf(v)===-1&&c.push(v),a)}function Pf(a,c,d,m,v){switch(c){case"focusin":return Vr=rr(Vr,a,c,d,m,v),!0;case"dragenter":return jr=rr(jr,a,c,d,m,v),!0;case"mouseover":return mn=rr(mn,a,c,d,m,v),!0;case"pointerover":var w=v.pointerId;return _a.set(w,rr(_a.get(w)||null,a,c,d,m,v)),!0;case"gotpointercapture":return w=v.pointerId,_s.set(w,rr(_s.get(w)||null,a,c,d,m,v)),!0}return!1}function Gl(a){var c=Ea(a.target);if(c!==null){var d=ir(c);if(d!==null){if(c=d.tag,c===13){if(c=Vu(d),c!==null){a.blockedOn=c,Xu(a.priority,function(){Ku(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=Wl(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var m=new d.constructor(d.type,d);Nr=m,d.target.dispatchEvent(m),Nr=null}else return c=ch(d),c!==null&&zl(c),a.blockedOn=d,!1;c.shift()}return!0}function kf(a,c,d){pt(a)&&d.delete(c)}function Sy(){Fr=!1,Vr!==null&&pt(Vr)&&(Vr=null),jr!==null&&pt(jr)&&(jr=null),mn!==null&&pt(mn)&&(mn=null),_a.forEach(kf),_s.forEach(kf)}function oo(a,c){a.blockedOn===c&&(a.blockedOn=null,Fr||(Fr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Sy)))}function ao(a){function c(v){return oo(v,a)}if(0<Bl.length){oo(Bl[0],a);for(var d=1;d<Bl.length;d++){var m=Bl[d];m.blockedOn===a&&(m.blockedOn=null)}}for(Vr!==null&&oo(Vr,a),jr!==null&&oo(jr,a),mn!==null&&oo(mn,a),_a.forEach(c),_s.forEach(c),d=0;d<fi.length;d++)m=fi[d],m.blockedOn===a&&(m.blockedOn=null);for(;0<fi.length&&(d=fi[0],d.blockedOn===null);)Gl(d),d.blockedOn===null&&fi.shift()}var vs=L.ReactCurrentBatchConfig,xs=!0;function Ur(a,c,d,m){var v=qe,w=vs.transition;vs.transition=null;try{qe=1,Yu(a,c,d,m)}finally{qe=v,vs.transition=w}}function Nf(a,c,d,m){var v=qe,w=vs.transition;vs.transition=null;try{qe=4,Yu(a,c,d,m)}finally{qe=v,vs.transition=w}}function Yu(a,c,d,m){if(xs){var v=Wl(a,c,d,m);if(v===null)Ly(a,c,m,zr,d),so(a,m);else if(Pf(v,a,c,d,m))m.stopPropagation();else if(so(a,m),c&4&&-1<bf.indexOf(a)){for(;v!==null;){var w=ch(v);if(w!==null&&Hu(w),w=Wl(a,c,d,m),w===null&&Ly(a,c,m,zr,d),w===v)break;v=w}v!==null&&m.stopPropagation()}else Ly(a,c,m,null,d)}}var zr=null;function Wl(a,c,d,m){if(zr=null,a=Dr(m),a=Ea(a),a!==null)if(c=ir(a),c===null)a=null;else if(d=c.tag,d===13){if(a=Vu(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return zr=a,null}function $l(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ey()){case jl:return 1;case Uu:return 4;case da:case zu:return 16;case Ul:return 536870912;default:return 16}default:return 16}}var gi=null,Hl=null,ws=null;function Df(){if(ws)return ws;var a,c=Hl,d=c.length,m,v="value"in gi?gi.value:gi.textContent,w=v.length;for(a=0;a<d&&c[a]===v[a];a++);var A=d-a;for(m=1;m<=A&&c[d-m]===v[w-m];m++);return ws=v.slice(a,1<m?1-m:void 0)}function va(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Br(){return!0}function Zu(){return!1}function Cn(a){function c(d,m,v,w,A){this._reactName=d,this._targetInst=v,this.type=m,this.nativeEvent=w,this.target=A,this.currentTarget=null;for(var z in a)a.hasOwnProperty(z)&&(d=a[z],this[z]=d?d(w):w[z]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Br:Zu,this.isPropagationStopped=Zu,this}return ne(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Br)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Br)},persist:function(){},isPersistent:Br}),c}var Gr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xa=Cn(Gr),lo=ne({},Gr,{view:0,detail:0}),Kl=Cn(lo),ql,Xl,pi,wa=ne({},lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:je,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==pi&&(pi&&a.type==="mousemove"?(ql=a.screenX-pi.screenX,Xl=a.screenY-pi.screenY):Xl=ql=0,pi=a),ql)},movementY:function(a){return"movementY"in a?a.movementY:Xl}}),Qu=Cn(wa),Mf=ne({},wa,{dataTransfer:0}),Lf=Cn(Mf),Yl=ne({},lo,{relatedTarget:0}),yn=Cn(Yl),Of=ne({},Gr,{animationName:0,elapsedTime:0,pseudoElement:0}),Ff=Cn(Of),co=ne({},Gr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=Cn(co),E=ne({},Gr,{data:0}),C=Cn(E),O={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fe(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=ee[a])?!!c[a]:!1}function je(){return fe}var Vt=ne({},lo,{key:function(a){if(a.key){var c=O[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=va(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?X[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:je,charCode:function(a){return a.type==="keypress"?va(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?va(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ut=Cn(Vt),Gt=ne({},wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mi=Cn(Gt),Es=ne({},lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:je}),Wr=Cn(Es),$r=ne({},Gr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zl=Cn($r),Ju=ne({},wa,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),UD=Cn(Ju),zD=[9,13,27,32],Iy=l&&"CompositionEvent"in window,eh=null;l&&"documentMode"in document&&(eh=document.documentMode);var BD=l&&"TextEvent"in window&&!eh,Lw=l&&(!Iy||eh&&8<eh&&11>=eh),Ow=" ",Fw=!1;function Vw(a,c){switch(a){case"keyup":return zD.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jw(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ql=!1;function GD(a,c){switch(a){case"compositionend":return jw(c);case"keypress":return c.which!==32?null:(Fw=!0,Ow);case"textInput":return a=c.data,a===Ow&&Fw?null:a;default:return null}}function WD(a,c){if(Ql)return a==="compositionend"||!Iy&&Vw(a,c)?(a=Df(),ws=Hl=gi=null,Ql=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Lw&&c.locale!=="ko"?null:c.data;default:return null}}var $D={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uw(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!$D[a.type]:c==="textarea"}function zw(a,c,d,m){nr(m),c=Bf(c,"onChange"),0<c.length&&(d=new xa("onChange","change",null,d,m),a.push({event:d,listeners:c}))}var th=null,nh=null;function HD(a){sE(a,0)}function Vf(a){var c=ic(a);if(fs(c))return a}function KD(a,c){if(a==="change")return c}var Bw=!1;if(l){var Cy;if(l){var Ry="oninput"in document;if(!Ry){var Gw=document.createElement("div");Gw.setAttribute("oninput","return;"),Ry=typeof Gw.oninput=="function"}Cy=Ry}else Cy=!1;Bw=Cy&&(!document.documentMode||9<document.documentMode)}function Ww(){th&&(th.detachEvent("onpropertychange",$w),nh=th=null)}function $w(a){if(a.propertyName==="value"&&Vf(nh)){var c=[];zw(c,nh,a,Dr(a)),gn(HD,c)}}function qD(a,c,d){a==="focusin"?(Ww(),th=c,nh=d,th.attachEvent("onpropertychange",$w)):a==="focusout"&&Ww()}function XD(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Vf(nh)}function YD(a,c){if(a==="click")return Vf(c)}function ZD(a,c){if(a==="input"||a==="change")return Vf(c)}function QD(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var sr=typeof Object.is=="function"?Object.is:QD;function ih(a,c){if(sr(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),m=Object.keys(c);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var v=d[m];if(!u.call(c,v)||!sr(a[v],c[v]))return!1}return!0}function Hw(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Kw(a,c){var d=Hw(a);a=0;for(var m;d;){if(d.nodeType===3){if(m=a+d.textContent.length,a<=c&&m>=c)return{node:d,offset:c-a};a=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Hw(d)}}function qw(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?qw(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function Xw(){for(var a=window,c=Wn();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=Wn(a.document)}return c}function Ay(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function JD(a){var c=Xw(),d=a.focusedElem,m=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&qw(d.ownerDocument.documentElement,d)){if(m!==null&&Ay(d)){if(c=m.start,a=m.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var v=d.textContent.length,w=Math.min(m.start,v);m=m.end===void 0?w:Math.min(m.end,v),!a.extend&&w>m&&(v=m,m=w,w=v),v=Kw(d,w);var A=Kw(d,m);v&&A&&(a.rangeCount!==1||a.anchorNode!==v.node||a.anchorOffset!==v.offset||a.focusNode!==A.node||a.focusOffset!==A.offset)&&(c=c.createRange(),c.setStart(v.node,v.offset),a.removeAllRanges(),w>m?(a.addRange(c),a.extend(A.node,A.offset)):(c.setEnd(A.node,A.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var eM=l&&"documentMode"in document&&11>=document.documentMode,Jl=null,by=null,rh=null,Py=!1;function Yw(a,c,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Py||Jl==null||Jl!==Wn(m)||(m=Jl,"selectionStart"in m&&Ay(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),rh&&ih(rh,m)||(rh=m,m=Bf(by,"onSelect"),0<m.length&&(c=new xa("onSelect","select",null,c,d),a.push({event:c,listeners:m}),c.target=Jl)))}function jf(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var ec={animationend:jf("Animation","AnimationEnd"),animationiteration:jf("Animation","AnimationIteration"),animationstart:jf("Animation","AnimationStart"),transitionend:jf("Transition","TransitionEnd")},ky={},Zw={};l&&(Zw=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function Uf(a){if(ky[a])return ky[a];if(!ec[a])return a;var c=ec[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in Zw)return ky[a]=c[d];return a}var Qw=Uf("animationend"),Jw=Uf("animationiteration"),eE=Uf("animationstart"),tE=Uf("transitionend"),nE=new Map,iE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function uo(a,c){nE.set(a,c),s(c,[a])}for(var Ny=0;Ny<iE.length;Ny++){var Dy=iE[Ny],tM=Dy.toLowerCase(),nM=Dy[0].toUpperCase()+Dy.slice(1);uo(tM,"on"+nM)}uo(Qw,"onAnimationEnd"),uo(Jw,"onAnimationIteration"),uo(eE,"onAnimationStart"),uo("dblclick","onDoubleClick"),uo("focusin","onFocus"),uo("focusout","onBlur"),uo(tE,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iM=new Set("cancel close invalid load scroll toggle".split(" ").concat(sh));function rE(a,c,d){var m=a.type||"unknown-event";a.currentTarget=d,Fu(m,c,void 0,a),a.currentTarget=null}function sE(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var m=a[d],v=m.event;m=m.listeners;e:{var w=void 0;if(c)for(var A=m.length-1;0<=A;A--){var z=m[A],W=z.instance,J=z.currentTarget;if(z=z.listener,W!==w&&v.isPropagationStopped())break e;rE(v,z,J),w=W}else for(A=0;A<m.length;A++){if(z=m[A],W=z.instance,J=z.currentTarget,z=z.listener,W!==w&&v.isPropagationStopped())break e;rE(v,z,J),w=W}}}if(Fl)throw a=Li,Fl=!1,Li=null,a}function xt(a,c){var d=c[zy];d===void 0&&(d=c[zy]=new Set);var m=a+"__bubble";d.has(m)||(oE(c,a,2,!1),d.add(m))}function My(a,c,d){var m=0;c&&(m|=4),oE(d,a,m,c)}var zf="_reactListening"+Math.random().toString(36).slice(2);function oh(a){if(!a[zf]){a[zf]=!0,i.forEach(function(d){d!=="selectionchange"&&(iM.has(d)||My(d,!1,a),My(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[zf]||(c[zf]=!0,My("selectionchange",!1,c))}}function oE(a,c,d,m){switch($l(c)){case 1:var v=Ur;break;case 4:v=Nf;break;default:v=Yu}d=v.bind(null,c,d,a),v=void 0,!nn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(v=!0),m?v!==void 0?a.addEventListener(c,d,{capture:!0,passive:v}):a.addEventListener(c,d,!0):v!==void 0?a.addEventListener(c,d,{passive:v}):a.addEventListener(c,d,!1)}function Ly(a,c,d,m,v){var w=m;if((c&1)===0&&(c&2)===0&&m!==null)e:for(;;){if(m===null)return;var A=m.tag;if(A===3||A===4){var z=m.stateNode.containerInfo;if(z===v||z.nodeType===8&&z.parentNode===v)break;if(A===4)for(A=m.return;A!==null;){var W=A.tag;if((W===3||W===4)&&(W=A.stateNode.containerInfo,W===v||W.nodeType===8&&W.parentNode===v))return;A=A.return}for(;z!==null;){if(A=Ea(z),A===null)return;if(W=A.tag,W===5||W===6){m=w=A;continue e}z=z.parentNode}}m=m.return}gn(function(){var J=w,ae=Dr(d),ce=[];e:{var oe=nE.get(a);if(oe!==void 0){var ye=xa,ve=a;switch(a){case"keypress":if(va(d)===0)break e;case"keydown":case"keyup":ye=ut;break;case"focusin":ve="focus",ye=yn;break;case"focusout":ve="blur",ye=yn;break;case"beforeblur":case"afterblur":ye=yn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=Qu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=Lf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=Wr;break;case Qw:case Jw:case eE:ye=Ff;break;case tE:ye=Zl;break;case"scroll":ye=Kl;break;case"wheel":ye=UD;break;case"copy":case"cut":case"paste":ye=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=mi}var we=(c&4)!==0,jt=!we&&a==="scroll",K=we?oe!==null?oe+"Capture":null:oe;we=[];for(var H=J,Y;H!==null;){Y=H;var de=Y.stateNode;if(Y.tag===5&&de!==null&&(Y=de,K!==null&&(de=pn(H,K),de!=null&&we.push(ah(H,de,Y)))),jt)break;H=H.return}0<we.length&&(oe=new ye(oe,ve,null,d,ae),ce.push({event:oe,listeners:we}))}}if((c&7)===0){e:{if(oe=a==="mouseover"||a==="pointerover",ye=a==="mouseout"||a==="pointerout",oe&&d!==Nr&&(ve=d.relatedTarget||d.fromElement)&&(Ea(ve)||ve[Ts]))break e;if((ye||oe)&&(oe=ae.window===ae?ae:(oe=ae.ownerDocument)?oe.defaultView||oe.parentWindow:window,ye?(ve=d.relatedTarget||d.toElement,ye=J,ve=ve?Ea(ve):null,ve!==null&&(jt=ir(ve),ve!==jt||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(ye=null,ve=J),ye!==ve)){if(we=Qu,de="onMouseLeave",K="onMouseEnter",H="mouse",(a==="pointerout"||a==="pointerover")&&(we=mi,de="onPointerLeave",K="onPointerEnter",H="pointer"),jt=ye==null?oe:ic(ye),Y=ve==null?oe:ic(ve),oe=new we(de,H+"leave",ye,d,ae),oe.target=jt,oe.relatedTarget=Y,de=null,Ea(ae)===J&&(we=new we(K,H+"enter",ve,d,ae),we.target=Y,we.relatedTarget=jt,de=we),jt=de,ye&&ve)t:{for(we=ye,K=ve,H=0,Y=we;Y;Y=tc(Y))H++;for(Y=0,de=K;de;de=tc(de))Y++;for(;0<H-Y;)we=tc(we),H--;for(;0<Y-H;)K=tc(K),Y--;for(;H--;){if(we===K||K!==null&&we===K.alternate)break t;we=tc(we),K=tc(K)}we=null}else we=null;ye!==null&&aE(ce,oe,ye,we,!1),ve!==null&&jt!==null&&aE(ce,jt,ve,we,!0)}}e:{if(oe=J?ic(J):window,ye=oe.nodeName&&oe.nodeName.toLowerCase(),ye==="select"||ye==="input"&&oe.type==="file")var Te=KD;else if(Uw(oe))if(Bw)Te=ZD;else{Te=XD;var be=qD}else(ye=oe.nodeName)&&ye.toLowerCase()==="input"&&(oe.type==="checkbox"||oe.type==="radio")&&(Te=YD);if(Te&&(Te=Te(a,J))){zw(ce,Te,d,ae);break e}be&&be(a,oe,J),a==="focusout"&&(be=oe._wrapperState)&&be.controlled&&oe.type==="number"&&yt(oe,"number",oe.value)}switch(be=J?ic(J):window,a){case"focusin":(Uw(be)||be.contentEditable==="true")&&(Jl=be,by=J,rh=null);break;case"focusout":rh=by=Jl=null;break;case"mousedown":Py=!0;break;case"contextmenu":case"mouseup":case"dragend":Py=!1,Yw(ce,d,ae);break;case"selectionchange":if(eM)break;case"keydown":case"keyup":Yw(ce,d,ae)}var Pe;if(Iy)e:{switch(a){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else Ql?Vw(a,d)&&(Le="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Le="onCompositionStart");Le&&(Lw&&d.locale!=="ko"&&(Ql||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&Ql&&(Pe=Df()):(gi=ae,Hl="value"in gi?gi.value:gi.textContent,Ql=!0)),be=Bf(J,Le),0<be.length&&(Le=new C(Le,a,null,d,ae),ce.push({event:Le,listeners:be}),Pe?Le.data=Pe:(Pe=jw(d),Pe!==null&&(Le.data=Pe)))),(Pe=BD?GD(a,d):WD(a,d))&&(J=Bf(J,"onBeforeInput"),0<J.length&&(ae=new C("onBeforeInput","beforeinput",null,d,ae),ce.push({event:ae,listeners:J}),ae.data=Pe))}sE(ce,c)})}function ah(a,c,d){return{instance:a,listener:c,currentTarget:d}}function Bf(a,c){for(var d=c+"Capture",m=[];a!==null;){var v=a,w=v.stateNode;v.tag===5&&w!==null&&(v=w,w=pn(a,d),w!=null&&m.unshift(ah(a,w,v)),w=pn(a,c),w!=null&&m.push(ah(a,w,v))),a=a.return}return m}function tc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function aE(a,c,d,m,v){for(var w=c._reactName,A=[];d!==null&&d!==m;){var z=d,W=z.alternate,J=z.stateNode;if(W!==null&&W===m)break;z.tag===5&&J!==null&&(z=J,v?(W=pn(d,w),W!=null&&A.unshift(ah(d,W,z))):v||(W=pn(d,w),W!=null&&A.push(ah(d,W,z)))),d=d.return}A.length!==0&&a.push({event:c,listeners:A})}var rM=/\r\n?/g,sM=/\u0000|\uFFFD/g;function lE(a){return(typeof a=="string"?a:""+a).replace(rM,`
`).replace(sM,"")}function Gf(a,c,d){if(c=lE(c),lE(a)!==c&&d)throw Error(t(425))}function Wf(){}var Oy=null,Fy=null;function Vy(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var jy=typeof setTimeout=="function"?setTimeout:void 0,oM=typeof clearTimeout=="function"?clearTimeout:void 0,cE=typeof Promise=="function"?Promise:void 0,aM=typeof queueMicrotask=="function"?queueMicrotask:typeof cE<"u"?function(a){return cE.resolve(null).then(a).catch(lM)}:jy;function lM(a){setTimeout(function(){throw a})}function Uy(a,c){var d=c,m=0;do{var v=d.nextSibling;if(a.removeChild(d),v&&v.nodeType===8)if(d=v.data,d==="/$"){if(m===0){a.removeChild(v),ao(c);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=v}while(d);ao(c)}function ho(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function uE(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var nc=Math.random().toString(36).slice(2),Hr="__reactFiber$"+nc,lh="__reactProps$"+nc,Ts="__reactContainer$"+nc,zy="__reactEvents$"+nc,cM="__reactListeners$"+nc,uM="__reactHandles$"+nc;function Ea(a){var c=a[Hr];if(c)return c;for(var d=a.parentNode;d;){if(c=d[Ts]||d[Hr]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=uE(a);a!==null;){if(d=a[Hr])return d;a=uE(a)}return c}a=d,d=a.parentNode}return null}function ch(a){return a=a[Hr]||a[Ts],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ic(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function $f(a){return a[lh]||null}var By=[],rc=-1;function fo(a){return{current:a}}function wt(a){0>rc||(a.current=By[rc],By[rc]=null,rc--)}function _t(a,c){rc++,By[rc]=a.current,a.current=c}var go={},Rn=fo(go),Kn=fo(!1),Ta=go;function sc(a,c){var d=a.type.contextTypes;if(!d)return go;var m=a.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===c)return m.__reactInternalMemoizedMaskedChildContext;var v={},w;for(w in d)v[w]=c[w];return m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=v),v}function qn(a){return a=a.childContextTypes,a!=null}function Hf(){wt(Kn),wt(Rn)}function hE(a,c,d){if(Rn.current!==go)throw Error(t(168));_t(Rn,c),_t(Kn,d)}function dE(a,c,d){var m=a.stateNode;if(c=c.childContextTypes,typeof m.getChildContext!="function")return d;m=m.getChildContext();for(var v in m)if(!(v in c))throw Error(t(108,Me(a)||"Unknown",v));return ne({},d,m)}function Kf(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||go,Ta=Rn.current,_t(Rn,a),_t(Kn,Kn.current),!0}function fE(a,c,d){var m=a.stateNode;if(!m)throw Error(t(169));d?(a=dE(a,c,Ta),m.__reactInternalMemoizedMergedChildContext=a,wt(Kn),wt(Rn),_t(Rn,a)):wt(Kn),_t(Kn,d)}var Ss=null,qf=!1,Gy=!1;function gE(a){Ss===null?Ss=[a]:Ss.push(a)}function hM(a){qf=!0,gE(a)}function po(){if(!Gy&&Ss!==null){Gy=!0;var a=0,c=qe;try{var d=Ss;for(qe=1;a<d.length;a++){var m=d[a];do m=m(!0);while(m!==null)}Ss=null,qf=!1}catch(v){throw Ss!==null&&(Ss=Ss.slice(a+1)),ju(jl,po),v}finally{qe=c,Gy=!1}}return null}var oc=[],ac=0,Xf=null,Yf=0,Fi=[],Vi=0,Sa=null,Is=1,Cs="";function Ia(a,c){oc[ac++]=Yf,oc[ac++]=Xf,Xf=a,Yf=c}function pE(a,c,d){Fi[Vi++]=Is,Fi[Vi++]=Cs,Fi[Vi++]=Sa,Sa=a;var m=Is;a=Cs;var v=32-di(m)-1;m&=~(1<<v),d+=1;var w=32-di(c)+v;if(30<w){var A=v-v%5;w=(m&(1<<A)-1).toString(32),m>>=A,v-=A,Is=1<<32-di(c)+v|d<<v|m,Cs=w+a}else Is=1<<w|d<<v|m,Cs=a}function Wy(a){a.return!==null&&(Ia(a,1),pE(a,1,0))}function $y(a){for(;a===Xf;)Xf=oc[--ac],oc[ac]=null,Yf=oc[--ac],oc[ac]=null;for(;a===Sa;)Sa=Fi[--Vi],Fi[Vi]=null,Cs=Fi[--Vi],Fi[Vi]=null,Is=Fi[--Vi],Fi[Vi]=null}var yi=null,_i=null,It=!1,or=null;function mE(a,c){var d=Bi(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function yE(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,yi=a,_i=ho(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,yi=a,_i=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Sa!==null?{id:Is,overflow:Cs}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=Bi(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,yi=a,_i=null,!0):!1;default:return!1}}function Hy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Ky(a){if(It){var c=_i;if(c){var d=c;if(!yE(a,c)){if(Hy(a))throw Error(t(418));c=ho(d.nextSibling);var m=yi;c&&yE(a,c)?mE(m,d):(a.flags=a.flags&-4097|2,It=!1,yi=a)}}else{if(Hy(a))throw Error(t(418));a.flags=a.flags&-4097|2,It=!1,yi=a}}}function _E(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;yi=a}function Zf(a){if(a!==yi)return!1;if(!It)return _E(a),It=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!Vy(a.type,a.memoizedProps)),c&&(c=_i)){if(Hy(a))throw vE(),Error(t(418));for(;c;)mE(a,c),c=ho(c.nextSibling)}if(_E(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){_i=ho(a.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}_i=null}}else _i=yi?ho(a.stateNode.nextSibling):null;return!0}function vE(){for(var a=_i;a;)a=ho(a.nextSibling)}function lc(){_i=yi=null,It=!1}function qy(a){or===null?or=[a]:or.push(a)}var dM=L.ReactCurrentBatchConfig;function uh(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var m=d.stateNode}if(!m)throw Error(t(147,a));var v=m,w=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===w?c.ref:(c=function(A){var z=v.refs;A===null?delete z[w]:z[w]=A},c._stringRef=w,c)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function Qf(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function xE(a){var c=a._init;return c(a._payload)}function wE(a){function c(K,H){if(a){var Y=K.deletions;Y===null?(K.deletions=[H],K.flags|=16):Y.push(H)}}function d(K,H){if(!a)return null;for(;H!==null;)c(K,H),H=H.sibling;return null}function m(K,H){for(K=new Map;H!==null;)H.key!==null?K.set(H.key,H):K.set(H.index,H),H=H.sibling;return K}function v(K,H){return K=To(K,H),K.index=0,K.sibling=null,K}function w(K,H,Y){return K.index=Y,a?(Y=K.alternate,Y!==null?(Y=Y.index,Y<H?(K.flags|=2,H):Y):(K.flags|=2,H)):(K.flags|=1048576,H)}function A(K){return a&&K.alternate===null&&(K.flags|=2),K}function z(K,H,Y,de){return H===null||H.tag!==6?(H=j0(Y,K.mode,de),H.return=K,H):(H=v(H,Y),H.return=K,H)}function W(K,H,Y,de){var Te=Y.type;return Te===k?ae(K,H,Y.props.children,de,Y.key):H!==null&&(H.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&xE(Te)===H.type)?(de=v(H,Y.props),de.ref=uh(K,H,Y),de.return=K,de):(de=Eg(Y.type,Y.key,Y.props,null,K.mode,de),de.ref=uh(K,H,Y),de.return=K,de)}function J(K,H,Y,de){return H===null||H.tag!==4||H.stateNode.containerInfo!==Y.containerInfo||H.stateNode.implementation!==Y.implementation?(H=U0(Y,K.mode,de),H.return=K,H):(H=v(H,Y.children||[]),H.return=K,H)}function ae(K,H,Y,de,Te){return H===null||H.tag!==7?(H=Da(Y,K.mode,de,Te),H.return=K,H):(H=v(H,Y),H.return=K,H)}function ce(K,H,Y){if(typeof H=="string"&&H!==""||typeof H=="number")return H=j0(""+H,K.mode,Y),H.return=K,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case F:return Y=Eg(H.type,H.key,H.props,null,K.mode,Y),Y.ref=uh(K,null,H),Y.return=K,Y;case G:return H=U0(H,K.mode,Y),H.return=K,H;case ge:var de=H._init;return ce(K,de(H._payload),Y)}if(ct(H)||re(H))return H=Da(H,K.mode,Y,null),H.return=K,H;Qf(K,H)}return null}function oe(K,H,Y,de){var Te=H!==null?H.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Te!==null?null:z(K,H,""+Y,de);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case F:return Y.key===Te?W(K,H,Y,de):null;case G:return Y.key===Te?J(K,H,Y,de):null;case ge:return Te=Y._init,oe(K,H,Te(Y._payload),de)}if(ct(Y)||re(Y))return Te!==null?null:ae(K,H,Y,de,null);Qf(K,Y)}return null}function ye(K,H,Y,de,Te){if(typeof de=="string"&&de!==""||typeof de=="number")return K=K.get(Y)||null,z(H,K,""+de,Te);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case F:return K=K.get(de.key===null?Y:de.key)||null,W(H,K,de,Te);case G:return K=K.get(de.key===null?Y:de.key)||null,J(H,K,de,Te);case ge:var be=de._init;return ye(K,H,Y,be(de._payload),Te)}if(ct(de)||re(de))return K=K.get(Y)||null,ae(H,K,de,Te,null);Qf(H,de)}return null}function ve(K,H,Y,de){for(var Te=null,be=null,Pe=H,Le=H=0,on=null;Pe!==null&&Le<Y.length;Le++){Pe.index>Le?(on=Pe,Pe=null):on=Pe.sibling;var et=oe(K,Pe,Y[Le],de);if(et===null){Pe===null&&(Pe=on);break}a&&Pe&&et.alternate===null&&c(K,Pe),H=w(et,H,Le),be===null?Te=et:be.sibling=et,be=et,Pe=on}if(Le===Y.length)return d(K,Pe),It&&Ia(K,Le),Te;if(Pe===null){for(;Le<Y.length;Le++)Pe=ce(K,Y[Le],de),Pe!==null&&(H=w(Pe,H,Le),be===null?Te=Pe:be.sibling=Pe,be=Pe);return It&&Ia(K,Le),Te}for(Pe=m(K,Pe);Le<Y.length;Le++)on=ye(Pe,K,Le,Y[Le],de),on!==null&&(a&&on.alternate!==null&&Pe.delete(on.key===null?Le:on.key),H=w(on,H,Le),be===null?Te=on:be.sibling=on,be=on);return a&&Pe.forEach(function(So){return c(K,So)}),It&&Ia(K,Le),Te}function we(K,H,Y,de){var Te=re(Y);if(typeof Te!="function")throw Error(t(150));if(Y=Te.call(Y),Y==null)throw Error(t(151));for(var be=Te=null,Pe=H,Le=H=0,on=null,et=Y.next();Pe!==null&&!et.done;Le++,et=Y.next()){Pe.index>Le?(on=Pe,Pe=null):on=Pe.sibling;var So=oe(K,Pe,et.value,de);if(So===null){Pe===null&&(Pe=on);break}a&&Pe&&So.alternate===null&&c(K,Pe),H=w(So,H,Le),be===null?Te=So:be.sibling=So,be=So,Pe=on}if(et.done)return d(K,Pe),It&&Ia(K,Le),Te;if(Pe===null){for(;!et.done;Le++,et=Y.next())et=ce(K,et.value,de),et!==null&&(H=w(et,H,Le),be===null?Te=et:be.sibling=et,be=et);return It&&Ia(K,Le),Te}for(Pe=m(K,Pe);!et.done;Le++,et=Y.next())et=ye(Pe,K,Le,et.value,de),et!==null&&(a&&et.alternate!==null&&Pe.delete(et.key===null?Le:et.key),H=w(et,H,Le),be===null?Te=et:be.sibling=et,be=et);return a&&Pe.forEach(function($M){return c(K,$M)}),It&&Ia(K,Le),Te}function jt(K,H,Y,de){if(typeof Y=="object"&&Y!==null&&Y.type===k&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case F:e:{for(var Te=Y.key,be=H;be!==null;){if(be.key===Te){if(Te=Y.type,Te===k){if(be.tag===7){d(K,be.sibling),H=v(be,Y.props.children),H.return=K,K=H;break e}}else if(be.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&xE(Te)===be.type){d(K,be.sibling),H=v(be,Y.props),H.ref=uh(K,be,Y),H.return=K,K=H;break e}d(K,be);break}else c(K,be);be=be.sibling}Y.type===k?(H=Da(Y.props.children,K.mode,de,Y.key),H.return=K,K=H):(de=Eg(Y.type,Y.key,Y.props,null,K.mode,de),de.ref=uh(K,H,Y),de.return=K,K=de)}return A(K);case G:e:{for(be=Y.key;H!==null;){if(H.key===be)if(H.tag===4&&H.stateNode.containerInfo===Y.containerInfo&&H.stateNode.implementation===Y.implementation){d(K,H.sibling),H=v(H,Y.children||[]),H.return=K,K=H;break e}else{d(K,H);break}else c(K,H);H=H.sibling}H=U0(Y,K.mode,de),H.return=K,K=H}return A(K);case ge:return be=Y._init,jt(K,H,be(Y._payload),de)}if(ct(Y))return ve(K,H,Y,de);if(re(Y))return we(K,H,Y,de);Qf(K,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,H!==null&&H.tag===6?(d(K,H.sibling),H=v(H,Y),H.return=K,K=H):(d(K,H),H=j0(Y,K.mode,de),H.return=K,K=H),A(K)):d(K,H)}return jt}var cc=wE(!0),EE=wE(!1),Jf=fo(null),eg=null,uc=null,Xy=null;function Yy(){Xy=uc=eg=null}function Zy(a){var c=Jf.current;wt(Jf),a._currentValue=c}function Qy(a,c,d){for(;a!==null;){var m=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),a===d)break;a=a.return}}function hc(a,c){eg=a,Xy=uc=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(Xn=!0),a.firstContext=null)}function ji(a){var c=a._currentValue;if(Xy!==a)if(a={context:a,memoizedValue:c,next:null},uc===null){if(eg===null)throw Error(t(308));uc=a,eg.dependencies={lanes:0,firstContext:a}}else uc=uc.next=a;return c}var Ca=null;function Jy(a){Ca===null?Ca=[a]:Ca.push(a)}function TE(a,c,d,m){var v=c.interleaved;return v===null?(d.next=d,Jy(c)):(d.next=v.next,v.next=d),c.interleaved=d,Rs(a,m)}function Rs(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var mo=!1;function e0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function SE(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function As(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function yo(a,c,d){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(Je&2)!==0){var v=m.pending;return v===null?c.next=c:(c.next=v.next,v.next=c),m.pending=c,Rs(a,d)}return v=m.interleaved,v===null?(c.next=c,Jy(m)):(c.next=v.next,v.next=c),m.interleaved=c,Rs(a,d)}function tg(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,$u(a,d)}}function IE(a,c){var d=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var v=null,w=null;if(d=d.firstBaseUpdate,d!==null){do{var A={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};w===null?v=w=A:w=w.next=A,d=d.next}while(d!==null);w===null?v=w=c:w=w.next=c}else v=w=c;d={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:m.shared,effects:m.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function ng(a,c,d,m){var v=a.updateQueue;mo=!1;var w=v.firstBaseUpdate,A=v.lastBaseUpdate,z=v.shared.pending;if(z!==null){v.shared.pending=null;var W=z,J=W.next;W.next=null,A===null?w=J:A.next=J,A=W;var ae=a.alternate;ae!==null&&(ae=ae.updateQueue,z=ae.lastBaseUpdate,z!==A&&(z===null?ae.firstBaseUpdate=J:z.next=J,ae.lastBaseUpdate=W))}if(w!==null){var ce=v.baseState;A=0,ae=J=W=null,z=w;do{var oe=z.lane,ye=z.eventTime;if((m&oe)===oe){ae!==null&&(ae=ae.next={eventTime:ye,lane:0,tag:z.tag,payload:z.payload,callback:z.callback,next:null});e:{var ve=a,we=z;switch(oe=c,ye=d,we.tag){case 1:if(ve=we.payload,typeof ve=="function"){ce=ve.call(ye,ce,oe);break e}ce=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=we.payload,oe=typeof ve=="function"?ve.call(ye,ce,oe):ve,oe==null)break e;ce=ne({},ce,oe);break e;case 2:mo=!0}}z.callback!==null&&z.lane!==0&&(a.flags|=64,oe=v.effects,oe===null?v.effects=[z]:oe.push(z))}else ye={eventTime:ye,lane:oe,tag:z.tag,payload:z.payload,callback:z.callback,next:null},ae===null?(J=ae=ye,W=ce):ae=ae.next=ye,A|=oe;if(z=z.next,z===null){if(z=v.shared.pending,z===null)break;oe=z,z=oe.next,oe.next=null,v.lastBaseUpdate=oe,v.shared.pending=null}}while(!0);if(ae===null&&(W=ce),v.baseState=W,v.firstBaseUpdate=J,v.lastBaseUpdate=ae,c=v.shared.interleaved,c!==null){v=c;do A|=v.lane,v=v.next;while(v!==c)}else w===null&&(v.shared.lanes=0);ba|=A,a.lanes=A,a.memoizedState=ce}}function CE(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var m=a[c],v=m.callback;if(v!==null){if(m.callback=null,m=d,typeof v!="function")throw Error(t(191,v));v.call(m)}}}var hh={},Kr=fo(hh),dh=fo(hh),fh=fo(hh);function Ra(a){if(a===hh)throw Error(t(174));return a}function t0(a,c){switch(_t(fh,c),_t(dh,a),_t(Kr,hh),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:tr(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=tr(c,a)}wt(Kr),_t(Kr,c)}function dc(){wt(Kr),wt(dh),wt(fh)}function RE(a){Ra(fh.current);var c=Ra(Kr.current),d=tr(c,a.type);c!==d&&(_t(dh,a),_t(Kr,d))}function n0(a){dh.current===a&&(wt(Kr),wt(dh))}var At=fo(0);function ig(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var i0=[];function r0(){for(var a=0;a<i0.length;a++)i0[a]._workInProgressVersionPrimary=null;i0.length=0}var rg=L.ReactCurrentDispatcher,s0=L.ReactCurrentBatchConfig,Aa=0,bt=null,Xt=null,rn=null,sg=!1,gh=!1,ph=0,fM=0;function An(){throw Error(t(321))}function o0(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!sr(a[d],c[d]))return!1;return!0}function a0(a,c,d,m,v,w){if(Aa=w,bt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,rg.current=a===null||a.memoizedState===null?yM:_M,a=d(m,v),gh){w=0;do{if(gh=!1,ph=0,25<=w)throw Error(t(301));w+=1,rn=Xt=null,c.updateQueue=null,rg.current=vM,a=d(m,v)}while(gh)}if(rg.current=lg,c=Xt!==null&&Xt.next!==null,Aa=0,rn=Xt=bt=null,sg=!1,c)throw Error(t(300));return a}function l0(){var a=ph!==0;return ph=0,a}function qr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?bt.memoizedState=rn=a:rn=rn.next=a,rn}function Ui(){if(Xt===null){var a=bt.alternate;a=a!==null?a.memoizedState:null}else a=Xt.next;var c=rn===null?bt.memoizedState:rn.next;if(c!==null)rn=c,Xt=a;else{if(a===null)throw Error(t(310));Xt=a,a={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},rn===null?bt.memoizedState=rn=a:rn=rn.next=a}return rn}function mh(a,c){return typeof c=="function"?c(a):c}function c0(a){var c=Ui(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=Xt,v=m.baseQueue,w=d.pending;if(w!==null){if(v!==null){var A=v.next;v.next=w.next,w.next=A}m.baseQueue=v=w,d.pending=null}if(v!==null){w=v.next,m=m.baseState;var z=A=null,W=null,J=w;do{var ae=J.lane;if((Aa&ae)===ae)W!==null&&(W=W.next={lane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),m=J.hasEagerState?J.eagerState:a(m,J.action);else{var ce={lane:ae,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null};W===null?(z=W=ce,A=m):W=W.next=ce,bt.lanes|=ae,ba|=ae}J=J.next}while(J!==null&&J!==w);W===null?A=m:W.next=z,sr(m,c.memoizedState)||(Xn=!0),c.memoizedState=m,c.baseState=A,c.baseQueue=W,d.lastRenderedState=m}if(a=d.interleaved,a!==null){v=a;do w=v.lane,bt.lanes|=w,ba|=w,v=v.next;while(v!==a)}else v===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function u0(a){var c=Ui(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=d.dispatch,v=d.pending,w=c.memoizedState;if(v!==null){d.pending=null;var A=v=v.next;do w=a(w,A.action),A=A.next;while(A!==v);sr(w,c.memoizedState)||(Xn=!0),c.memoizedState=w,c.baseQueue===null&&(c.baseState=w),d.lastRenderedState=w}return[w,m]}function AE(){}function bE(a,c){var d=bt,m=Ui(),v=c(),w=!sr(m.memoizedState,v);if(w&&(m.memoizedState=v,Xn=!0),m=m.queue,h0(NE.bind(null,d,m,a),[a]),m.getSnapshot!==c||w||rn!==null&&rn.memoizedState.tag&1){if(d.flags|=2048,yh(9,kE.bind(null,d,m,v,c),void 0,null),sn===null)throw Error(t(349));(Aa&30)!==0||PE(d,c,v)}return v}function PE(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=bt.updateQueue,c===null?(c={lastEffect:null,stores:null},bt.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function kE(a,c,d,m){c.value=d,c.getSnapshot=m,DE(c)&&ME(a)}function NE(a,c,d){return d(function(){DE(c)&&ME(a)})}function DE(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!sr(a,d)}catch{return!0}}function ME(a){var c=Rs(a,1);c!==null&&ur(c,a,1,-1)}function LE(a){var c=qr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mh,lastRenderedState:a},c.queue=a,a=a.dispatch=mM.bind(null,bt,a),[c.memoizedState,a]}function yh(a,c,d,m){return a={tag:a,create:c,destroy:d,deps:m,next:null},c=bt.updateQueue,c===null?(c={lastEffect:null,stores:null},bt.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(m=d.next,d.next=a,a.next=m,c.lastEffect=a)),a}function OE(){return Ui().memoizedState}function og(a,c,d,m){var v=qr();bt.flags|=a,v.memoizedState=yh(1|c,d,void 0,m===void 0?null:m)}function ag(a,c,d,m){var v=Ui();m=m===void 0?null:m;var w=void 0;if(Xt!==null){var A=Xt.memoizedState;if(w=A.destroy,m!==null&&o0(m,A.deps)){v.memoizedState=yh(c,d,w,m);return}}bt.flags|=a,v.memoizedState=yh(1|c,d,w,m)}function FE(a,c){return og(8390656,8,a,c)}function h0(a,c){return ag(2048,8,a,c)}function VE(a,c){return ag(4,2,a,c)}function jE(a,c){return ag(4,4,a,c)}function UE(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function zE(a,c,d){return d=d!=null?d.concat([a]):null,ag(4,4,UE.bind(null,c,a),d)}function d0(){}function BE(a,c){var d=Ui();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&o0(c,m[1])?m[0]:(d.memoizedState=[a,c],a)}function GE(a,c){var d=Ui();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&o0(c,m[1])?m[0]:(a=a(),d.memoizedState=[a,c],a)}function WE(a,c,d){return(Aa&21)===0?(a.baseState&&(a.baseState=!1,Xn=!0),a.memoizedState=d):(sr(d,c)||(d=Gu(),bt.lanes|=d,ba|=d,a.baseState=!0),c)}function gM(a,c){var d=qe;qe=d!==0&&4>d?d:4,a(!0);var m=s0.transition;s0.transition={};try{a(!1),c()}finally{qe=d,s0.transition=m}}function $E(){return Ui().memoizedState}function pM(a,c,d){var m=wo(a);if(d={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null},HE(a))KE(c,d);else if(d=TE(a,c,d,m),d!==null){var v=Un();ur(d,a,m,v),qE(d,c,m)}}function mM(a,c,d){var m=wo(a),v={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null};if(HE(a))KE(c,v);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=c.lastRenderedReducer,w!==null))try{var A=c.lastRenderedState,z=w(A,d);if(v.hasEagerState=!0,v.eagerState=z,sr(z,A)){var W=c.interleaved;W===null?(v.next=v,Jy(c)):(v.next=W.next,W.next=v),c.interleaved=v;return}}catch{}d=TE(a,c,v,m),d!==null&&(v=Un(),ur(d,a,m,v),qE(d,c,m))}}function HE(a){var c=a.alternate;return a===bt||c!==null&&c===bt}function KE(a,c){gh=sg=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function qE(a,c,d){if((d&4194240)!==0){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,$u(a,d)}}var lg={readContext:ji,useCallback:An,useContext:An,useEffect:An,useImperativeHandle:An,useInsertionEffect:An,useLayoutEffect:An,useMemo:An,useReducer:An,useRef:An,useState:An,useDebugValue:An,useDeferredValue:An,useTransition:An,useMutableSource:An,useSyncExternalStore:An,useId:An,unstable_isNewReconciler:!1},yM={readContext:ji,useCallback:function(a,c){return qr().memoizedState=[a,c===void 0?null:c],a},useContext:ji,useEffect:FE,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,og(4194308,4,UE.bind(null,c,a),d)},useLayoutEffect:function(a,c){return og(4194308,4,a,c)},useInsertionEffect:function(a,c){return og(4,2,a,c)},useMemo:function(a,c){var d=qr();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var m=qr();return c=d!==void 0?d(c):c,m.memoizedState=m.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},m.queue=a,a=a.dispatch=pM.bind(null,bt,a),[m.memoizedState,a]},useRef:function(a){var c=qr();return a={current:a},c.memoizedState=a},useState:LE,useDebugValue:d0,useDeferredValue:function(a){return qr().memoizedState=a},useTransition:function(){var a=LE(!1),c=a[0];return a=gM.bind(null,a[1]),qr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var m=bt,v=qr();if(It){if(d===void 0)throw Error(t(407));d=d()}else{if(d=c(),sn===null)throw Error(t(349));(Aa&30)!==0||PE(m,c,d)}v.memoizedState=d;var w={value:d,getSnapshot:c};return v.queue=w,FE(NE.bind(null,m,w,a),[a]),m.flags|=2048,yh(9,kE.bind(null,m,w,d,c),void 0,null),d},useId:function(){var a=qr(),c=sn.identifierPrefix;if(It){var d=Cs,m=Is;d=(m&~(1<<32-di(m)-1)).toString(32)+d,c=":"+c+"R"+d,d=ph++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=fM++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},_M={readContext:ji,useCallback:BE,useContext:ji,useEffect:h0,useImperativeHandle:zE,useInsertionEffect:VE,useLayoutEffect:jE,useMemo:GE,useReducer:c0,useRef:OE,useState:function(){return c0(mh)},useDebugValue:d0,useDeferredValue:function(a){var c=Ui();return WE(c,Xt.memoizedState,a)},useTransition:function(){var a=c0(mh)[0],c=Ui().memoizedState;return[a,c]},useMutableSource:AE,useSyncExternalStore:bE,useId:$E,unstable_isNewReconciler:!1},vM={readContext:ji,useCallback:BE,useContext:ji,useEffect:h0,useImperativeHandle:zE,useInsertionEffect:VE,useLayoutEffect:jE,useMemo:GE,useReducer:u0,useRef:OE,useState:function(){return u0(mh)},useDebugValue:d0,useDeferredValue:function(a){var c=Ui();return Xt===null?c.memoizedState=a:WE(c,Xt.memoizedState,a)},useTransition:function(){var a=u0(mh)[0],c=Ui().memoizedState;return[a,c]},useMutableSource:AE,useSyncExternalStore:bE,useId:$E,unstable_isNewReconciler:!1};function ar(a,c){if(a&&a.defaultProps){c=ne({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function f0(a,c,d,m){c=a.memoizedState,d=d(m,c),d=d==null?c:ne({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var cg={isMounted:function(a){return(a=a._reactInternals)?ir(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var m=Un(),v=wo(a),w=As(m,v);w.payload=c,d!=null&&(w.callback=d),c=yo(a,w,v),c!==null&&(ur(c,a,v,m),tg(c,a,v))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var m=Un(),v=wo(a),w=As(m,v);w.tag=1,w.payload=c,d!=null&&(w.callback=d),c=yo(a,w,v),c!==null&&(ur(c,a,v,m),tg(c,a,v))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=Un(),m=wo(a),v=As(d,m);v.tag=2,c!=null&&(v.callback=c),c=yo(a,v,m),c!==null&&(ur(c,a,m,d),tg(c,a,m))}};function XE(a,c,d,m,v,w,A){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,w,A):c.prototype&&c.prototype.isPureReactComponent?!ih(d,m)||!ih(v,w):!0}function YE(a,c,d){var m=!1,v=go,w=c.contextType;return typeof w=="object"&&w!==null?w=ji(w):(v=qn(c)?Ta:Rn.current,m=c.contextTypes,w=(m=m!=null)?sc(a,v):go),c=new c(d,w),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=cg,a.stateNode=c,c._reactInternals=a,m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=w),c}function ZE(a,c,d,m){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,m),c.state!==a&&cg.enqueueReplaceState(c,c.state,null)}function g0(a,c,d,m){var v=a.stateNode;v.props=d,v.state=a.memoizedState,v.refs={},e0(a);var w=c.contextType;typeof w=="object"&&w!==null?v.context=ji(w):(w=qn(c)?Ta:Rn.current,v.context=sc(a,w)),v.state=a.memoizedState,w=c.getDerivedStateFromProps,typeof w=="function"&&(f0(a,c,w,d),v.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(c=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),c!==v.state&&cg.enqueueReplaceState(v,v.state,null),ng(a,d,v,m),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function fc(a,c){try{var d="",m=c;do d+=xe(m),m=m.return;while(m);var v=d}catch(w){v=`
Error generating stack: `+w.message+`
`+w.stack}return{value:a,source:c,stack:v,digest:null}}function p0(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function m0(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var xM=typeof WeakMap=="function"?WeakMap:Map;function QE(a,c,d){d=As(-1,d),d.tag=3,d.payload={element:null};var m=c.value;return d.callback=function(){mg||(mg=!0,k0=m),m0(a,c)},d}function JE(a,c,d){d=As(-1,d),d.tag=3;var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var v=c.value;d.payload=function(){return m(v)},d.callback=function(){m0(a,c)}}var w=a.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(d.callback=function(){m0(a,c),typeof m!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var A=c.stack;this.componentDidCatch(c.value,{componentStack:A!==null?A:""})}),d}function eT(a,c,d){var m=a.pingCache;if(m===null){m=a.pingCache=new xM;var v=new Set;m.set(c,v)}else v=m.get(c),v===void 0&&(v=new Set,m.set(c,v));v.has(d)||(v.add(d),a=MM.bind(null,a,c,d),c.then(a,a))}function tT(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function nT(a,c,d,m,v){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=As(-1,1),c.tag=2,yo(d,c,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=v,a)}var wM=L.ReactCurrentOwner,Xn=!1;function jn(a,c,d,m){c.child=a===null?EE(c,null,d,m):cc(c,a.child,d,m)}function iT(a,c,d,m,v){d=d.render;var w=c.ref;return hc(c,v),m=a0(a,c,d,m,w,v),d=l0(),a!==null&&!Xn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,bs(a,c,v)):(It&&d&&Wy(c),c.flags|=1,jn(a,c,m,v),c.child)}function rT(a,c,d,m,v){if(a===null){var w=d.type;return typeof w=="function"&&!V0(w)&&w.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=w,sT(a,c,w,m,v)):(a=Eg(d.type,null,m,c,c.mode,v),a.ref=c.ref,a.return=c,c.child=a)}if(w=a.child,(a.lanes&v)===0){var A=w.memoizedProps;if(d=d.compare,d=d!==null?d:ih,d(A,m)&&a.ref===c.ref)return bs(a,c,v)}return c.flags|=1,a=To(w,m),a.ref=c.ref,a.return=c,c.child=a}function sT(a,c,d,m,v){if(a!==null){var w=a.memoizedProps;if(ih(w,m)&&a.ref===c.ref)if(Xn=!1,c.pendingProps=m=w,(a.lanes&v)!==0)(a.flags&131072)!==0&&(Xn=!0);else return c.lanes=a.lanes,bs(a,c,v)}return y0(a,c,d,m,v)}function oT(a,c,d){var m=c.pendingProps,v=m.children,w=a!==null?a.memoizedState:null;if(m.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(pc,vi),vi|=d;else{if((d&1073741824)===0)return a=w!==null?w.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,_t(pc,vi),vi|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=w!==null?w.baseLanes:d,_t(pc,vi),vi|=m}else w!==null?(m=w.baseLanes|d,c.memoizedState=null):m=d,_t(pc,vi),vi|=m;return jn(a,c,v,d),c.child}function aT(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function y0(a,c,d,m,v){var w=qn(d)?Ta:Rn.current;return w=sc(c,w),hc(c,v),d=a0(a,c,d,m,w,v),m=l0(),a!==null&&!Xn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,bs(a,c,v)):(It&&m&&Wy(c),c.flags|=1,jn(a,c,d,v),c.child)}function lT(a,c,d,m,v){if(qn(d)){var w=!0;Kf(c)}else w=!1;if(hc(c,v),c.stateNode===null)hg(a,c),YE(c,d,m),g0(c,d,m,v),m=!0;else if(a===null){var A=c.stateNode,z=c.memoizedProps;A.props=z;var W=A.context,J=d.contextType;typeof J=="object"&&J!==null?J=ji(J):(J=qn(d)?Ta:Rn.current,J=sc(c,J));var ae=d.getDerivedStateFromProps,ce=typeof ae=="function"||typeof A.getSnapshotBeforeUpdate=="function";ce||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(z!==m||W!==J)&&ZE(c,A,m,J),mo=!1;var oe=c.memoizedState;A.state=oe,ng(c,m,A,v),W=c.memoizedState,z!==m||oe!==W||Kn.current||mo?(typeof ae=="function"&&(f0(c,d,ae,m),W=c.memoizedState),(z=mo||XE(c,d,z,m,oe,W,J))?(ce||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=W),A.props=m,A.state=W,A.context=J,m=z):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{A=c.stateNode,SE(a,c),z=c.memoizedProps,J=c.type===c.elementType?z:ar(c.type,z),A.props=J,ce=c.pendingProps,oe=A.context,W=d.contextType,typeof W=="object"&&W!==null?W=ji(W):(W=qn(d)?Ta:Rn.current,W=sc(c,W));var ye=d.getDerivedStateFromProps;(ae=typeof ye=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(z!==ce||oe!==W)&&ZE(c,A,m,W),mo=!1,oe=c.memoizedState,A.state=oe,ng(c,m,A,v);var ve=c.memoizedState;z!==ce||oe!==ve||Kn.current||mo?(typeof ye=="function"&&(f0(c,d,ye,m),ve=c.memoizedState),(J=mo||XE(c,d,J,m,oe,ve,W)||!1)?(ae||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(m,ve,W),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(m,ve,W)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||z===a.memoizedProps&&oe===a.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&oe===a.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=ve),A.props=m,A.state=ve,A.context=W,m=J):(typeof A.componentDidUpdate!="function"||z===a.memoizedProps&&oe===a.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&oe===a.memoizedState||(c.flags|=1024),m=!1)}return _0(a,c,d,m,w,v)}function _0(a,c,d,m,v,w){aT(a,c);var A=(c.flags&128)!==0;if(!m&&!A)return v&&fE(c,d,!1),bs(a,c,w);m=c.stateNode,wM.current=c;var z=A&&typeof d.getDerivedStateFromError!="function"?null:m.render();return c.flags|=1,a!==null&&A?(c.child=cc(c,a.child,null,w),c.child=cc(c,null,z,w)):jn(a,c,z,w),c.memoizedState=m.state,v&&fE(c,d,!0),c.child}function cT(a){var c=a.stateNode;c.pendingContext?hE(a,c.pendingContext,c.pendingContext!==c.context):c.context&&hE(a,c.context,!1),t0(a,c.containerInfo)}function uT(a,c,d,m,v){return lc(),qy(v),c.flags|=256,jn(a,c,d,m),c.child}var v0={dehydrated:null,treeContext:null,retryLane:0};function x0(a){return{baseLanes:a,cachePool:null,transitions:null}}function hT(a,c,d){var m=c.pendingProps,v=At.current,w=!1,A=(c.flags&128)!==0,z;if((z=A)||(z=a!==null&&a.memoizedState===null?!1:(v&2)!==0),z?(w=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),_t(At,v&1),a===null)return Ky(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(A=m.children,a=m.fallback,w?(m=c.mode,w=c.child,A={mode:"hidden",children:A},(m&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=A):w=Tg(A,m,0,null),a=Da(a,m,d,null),w.return=c,a.return=c,w.sibling=a,c.child=w,c.child.memoizedState=x0(d),c.memoizedState=v0,a):w0(c,A));if(v=a.memoizedState,v!==null&&(z=v.dehydrated,z!==null))return EM(a,c,A,m,z,v,d);if(w){w=m.fallback,A=c.mode,v=a.child,z=v.sibling;var W={mode:"hidden",children:m.children};return(A&1)===0&&c.child!==v?(m=c.child,m.childLanes=0,m.pendingProps=W,c.deletions=null):(m=To(v,W),m.subtreeFlags=v.subtreeFlags&14680064),z!==null?w=To(z,w):(w=Da(w,A,d,null),w.flags|=2),w.return=c,m.return=c,m.sibling=w,c.child=m,m=w,w=c.child,A=a.child.memoizedState,A=A===null?x0(d):{baseLanes:A.baseLanes|d,cachePool:null,transitions:A.transitions},w.memoizedState=A,w.childLanes=a.childLanes&~d,c.memoizedState=v0,m}return w=a.child,a=w.sibling,m=To(w,{mode:"visible",children:m.children}),(c.mode&1)===0&&(m.lanes=d),m.return=c,m.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=m,c.memoizedState=null,m}function w0(a,c){return c=Tg({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function ug(a,c,d,m){return m!==null&&qy(m),cc(c,a.child,null,d),a=w0(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function EM(a,c,d,m,v,w,A){if(d)return c.flags&256?(c.flags&=-257,m=p0(Error(t(422))),ug(a,c,A,m)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(w=m.fallback,v=c.mode,m=Tg({mode:"visible",children:m.children},v,0,null),w=Da(w,v,A,null),w.flags|=2,m.return=c,w.return=c,m.sibling=w,c.child=m,(c.mode&1)!==0&&cc(c,a.child,null,A),c.child.memoizedState=x0(A),c.memoizedState=v0,w);if((c.mode&1)===0)return ug(a,c,A,null);if(v.data==="$!"){if(m=v.nextSibling&&v.nextSibling.dataset,m)var z=m.dgst;return m=z,w=Error(t(419)),m=p0(w,m,void 0),ug(a,c,A,m)}if(z=(A&a.childLanes)!==0,Xn||z){if(m=sn,m!==null){switch(A&-A){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(m.suspendedLanes|A))!==0?0:v,v!==0&&v!==w.retryLane&&(w.retryLane=v,Rs(a,v),ur(m,a,v,-1))}return F0(),m=p0(Error(t(421))),ug(a,c,A,m)}return v.data==="$?"?(c.flags|=128,c.child=a.child,c=LM.bind(null,a),v._reactRetry=c,null):(a=w.treeContext,_i=ho(v.nextSibling),yi=c,It=!0,or=null,a!==null&&(Fi[Vi++]=Is,Fi[Vi++]=Cs,Fi[Vi++]=Sa,Is=a.id,Cs=a.overflow,Sa=c),c=w0(c,m.children),c.flags|=4096,c)}function dT(a,c,d){a.lanes|=c;var m=a.alternate;m!==null&&(m.lanes|=c),Qy(a.return,c,d)}function E0(a,c,d,m,v){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:v}:(w.isBackwards=c,w.rendering=null,w.renderingStartTime=0,w.last=m,w.tail=d,w.tailMode=v)}function fT(a,c,d){var m=c.pendingProps,v=m.revealOrder,w=m.tail;if(jn(a,c,m.children,d),m=At.current,(m&2)!==0)m=m&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&dT(a,d,c);else if(a.tag===19)dT(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}if(_t(At,m),(c.mode&1)===0)c.memoizedState=null;else switch(v){case"forwards":for(d=c.child,v=null;d!==null;)a=d.alternate,a!==null&&ig(a)===null&&(v=d),d=d.sibling;d=v,d===null?(v=c.child,c.child=null):(v=d.sibling,d.sibling=null),E0(c,!1,v,d,w);break;case"backwards":for(d=null,v=c.child,c.child=null;v!==null;){if(a=v.alternate,a!==null&&ig(a)===null){c.child=v;break}a=v.sibling,v.sibling=d,d=v,v=a}E0(c,!0,d,null,w);break;case"together":E0(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function hg(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function bs(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),ba|=c.lanes,(d&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,d=To(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=To(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function TM(a,c,d){switch(c.tag){case 3:cT(c),lc();break;case 5:RE(c);break;case 1:qn(c.type)&&Kf(c);break;case 4:t0(c,c.stateNode.containerInfo);break;case 10:var m=c.type._context,v=c.memoizedProps.value;_t(Jf,m._currentValue),m._currentValue=v;break;case 13:if(m=c.memoizedState,m!==null)return m.dehydrated!==null?(_t(At,At.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?hT(a,c,d):(_t(At,At.current&1),a=bs(a,c,d),a!==null?a.sibling:null);_t(At,At.current&1);break;case 19:if(m=(d&c.childLanes)!==0,(a.flags&128)!==0){if(m)return fT(a,c,d);c.flags|=128}if(v=c.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),_t(At,At.current),m)break;return null;case 22:case 23:return c.lanes=0,oT(a,c,d)}return bs(a,c,d)}var gT,T0,pT,mT;gT=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},T0=function(){},pT=function(a,c,d,m){var v=a.memoizedProps;if(v!==m){a=c.stateNode,Ra(Kr.current);var w=null;switch(d){case"input":v=$n(a,v),m=$n(a,m),w=[];break;case"select":v=ne({},v,{value:void 0}),m=ne({},m,{value:void 0}),w=[];break;case"textarea":v=Pi(a,v),m=Pi(a,m),w=[];break;default:typeof v.onClick!="function"&&typeof m.onClick=="function"&&(a.onclick=Wf)}On(d,m);var A;d=null;for(J in v)if(!m.hasOwnProperty(J)&&v.hasOwnProperty(J)&&v[J]!=null)if(J==="style"){var z=v[J];for(A in z)z.hasOwnProperty(A)&&(d||(d={}),d[A]="")}else J!=="dangerouslySetInnerHTML"&&J!=="children"&&J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(r.hasOwnProperty(J)?w||(w=[]):(w=w||[]).push(J,null));for(J in m){var W=m[J];if(z=v?.[J],m.hasOwnProperty(J)&&W!==z&&(W!=null||z!=null))if(J==="style")if(z){for(A in z)!z.hasOwnProperty(A)||W&&W.hasOwnProperty(A)||(d||(d={}),d[A]="");for(A in W)W.hasOwnProperty(A)&&z[A]!==W[A]&&(d||(d={}),d[A]=W[A])}else d||(w||(w=[]),w.push(J,d)),d=W;else J==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,z=z?z.__html:void 0,W!=null&&z!==W&&(w=w||[]).push(J,W)):J==="children"?typeof W!="string"&&typeof W!="number"||(w=w||[]).push(J,""+W):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&(r.hasOwnProperty(J)?(W!=null&&J==="onScroll"&&xt("scroll",a),w||z===W||(w=[])):(w=w||[]).push(J,W))}d&&(w=w||[]).push("style",d);var J=w;(c.updateQueue=J)&&(c.flags|=4)}},mT=function(a,c,d,m){d!==m&&(c.flags|=4)};function _h(a,c){if(!It)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function bn(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,m=0;if(c)for(var v=a.child;v!==null;)d|=v.lanes|v.childLanes,m|=v.subtreeFlags&14680064,m|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)d|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=m,a.childLanes=d,c}function SM(a,c,d){var m=c.pendingProps;switch($y(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(c),null;case 1:return qn(c.type)&&Hf(),bn(c),null;case 3:return m=c.stateNode,dc(),wt(Kn),wt(Rn),r0(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(Zf(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,or!==null&&(M0(or),or=null))),T0(a,c),bn(c),null;case 5:n0(c);var v=Ra(fh.current);if(d=c.type,a!==null&&c.stateNode!=null)pT(a,c,d,m,v),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!m){if(c.stateNode===null)throw Error(t(166));return bn(c),null}if(a=Ra(Kr.current),Zf(c)){m=c.stateNode,d=c.type;var w=c.memoizedProps;switch(m[Hr]=c,m[lh]=w,a=(c.mode&1)!==0,d){case"dialog":xt("cancel",m),xt("close",m);break;case"iframe":case"object":case"embed":xt("load",m);break;case"video":case"audio":for(v=0;v<sh.length;v++)xt(sh[v],m);break;case"source":xt("error",m);break;case"img":case"image":case"link":xt("error",m),xt("load",m);break;case"details":xt("toggle",m);break;case"input":hn(m,w),xt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!w.multiple},xt("invalid",m);break;case"textarea":St(m,w),xt("invalid",m)}On(d,w),v=null;for(var A in w)if(w.hasOwnProperty(A)){var z=w[A];A==="children"?typeof z=="string"?m.textContent!==z&&(w.suppressHydrationWarning!==!0&&Gf(m.textContent,z,a),v=["children",z]):typeof z=="number"&&m.textContent!==""+z&&(w.suppressHydrationWarning!==!0&&Gf(m.textContent,z,a),v=["children",""+z]):r.hasOwnProperty(A)&&z!=null&&A==="onScroll"&&xt("scroll",m)}switch(d){case"input":er(m),bi(m,w,!0);break;case"textarea":er(m),ki(m);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(m.onclick=Wf)}m=v,c.updateQueue=m,m!==null&&(c.flags|=4)}else{A=v.nodeType===9?v:v.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Ar(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=A.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof m.is=="string"?a=A.createElement(d,{is:m.is}):(a=A.createElement(d),d==="select"&&(A=a,m.multiple?A.multiple=!0:m.size&&(A.size=m.size))):a=A.createElementNS(a,d),a[Hr]=c,a[lh]=m,gT(a,c,!1,!1),c.stateNode=a;e:{switch(A=ps(d,m),d){case"dialog":xt("cancel",a),xt("close",a),v=m;break;case"iframe":case"object":case"embed":xt("load",a),v=m;break;case"video":case"audio":for(v=0;v<sh.length;v++)xt(sh[v],a);v=m;break;case"source":xt("error",a),v=m;break;case"img":case"image":case"link":xt("error",a),xt("load",a),v=m;break;case"details":xt("toggle",a),v=m;break;case"input":hn(a,m),v=$n(a,m),xt("invalid",a);break;case"option":v=m;break;case"select":a._wrapperState={wasMultiple:!!m.multiple},v=ne({},m,{value:void 0}),xt("invalid",a);break;case"textarea":St(a,m),v=Pi(a,m),xt("invalid",a);break;default:v=m}On(d,v),z=v;for(w in z)if(z.hasOwnProperty(w)){var W=z[w];w==="style"?gs(a,W):w==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,W!=null&&ca(a,W)):w==="children"?typeof W=="string"?(d!=="textarea"||W!=="")&&Pr(a,W):typeof W=="number"&&Pr(a,""+W):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(r.hasOwnProperty(w)?W!=null&&w==="onScroll"&&xt("scroll",a):W!=null&&N(a,w,W,A))}switch(d){case"input":er(a),bi(a,m,!1);break;case"textarea":er(a),ki(a);break;case"option":m.value!=null&&a.setAttribute("value",""+Ve(m.value));break;case"select":a.multiple=!!m.multiple,w=m.value,w!=null?tn(a,!!m.multiple,w,!1):m.defaultValue!=null&&tn(a,!!m.multiple,m.defaultValue,!0);break;default:typeof v.onClick=="function"&&(a.onclick=Wf)}switch(d){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return bn(c),null;case 6:if(a&&c.stateNode!=null)mT(a,c,a.memoizedProps,m);else{if(typeof m!="string"&&c.stateNode===null)throw Error(t(166));if(d=Ra(fh.current),Ra(Kr.current),Zf(c)){if(m=c.stateNode,d=c.memoizedProps,m[Hr]=c,(w=m.nodeValue!==d)&&(a=yi,a!==null))switch(a.tag){case 3:Gf(m.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Gf(m.nodeValue,d,(a.mode&1)!==0)}w&&(c.flags|=4)}else m=(d.nodeType===9?d:d.ownerDocument).createTextNode(m),m[Hr]=c,c.stateNode=m}return bn(c),null;case 13:if(wt(At),m=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(It&&_i!==null&&(c.mode&1)!==0&&(c.flags&128)===0)vE(),lc(),c.flags|=98560,w=!1;else if(w=Zf(c),m!==null&&m.dehydrated!==null){if(a===null){if(!w)throw Error(t(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[Hr]=c}else lc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;bn(c),w=!1}else or!==null&&(M0(or),or=null),w=!0;if(!w)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(m=m!==null,m!==(a!==null&&a.memoizedState!==null)&&m&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(At.current&1)!==0?Yt===0&&(Yt=3):F0())),c.updateQueue!==null&&(c.flags|=4),bn(c),null);case 4:return dc(),T0(a,c),a===null&&oh(c.stateNode.containerInfo),bn(c),null;case 10:return Zy(c.type._context),bn(c),null;case 17:return qn(c.type)&&Hf(),bn(c),null;case 19:if(wt(At),w=c.memoizedState,w===null)return bn(c),null;if(m=(c.flags&128)!==0,A=w.rendering,A===null)if(m)_h(w,!1);else{if(Yt!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(A=ig(a),A!==null){for(c.flags|=128,_h(w,!1),m=A.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),c.subtreeFlags=0,m=d,d=c.child;d!==null;)w=d,a=m,w.flags&=14680066,A=w.alternate,A===null?(w.childLanes=0,w.lanes=a,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=A.childLanes,w.lanes=A.lanes,w.child=A.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=A.memoizedProps,w.memoizedState=A.memoizedState,w.updateQueue=A.updateQueue,w.type=A.type,a=A.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return _t(At,At.current&1|2),c.child}a=a.sibling}w.tail!==null&&vt()>mc&&(c.flags|=128,m=!0,_h(w,!1),c.lanes=4194304)}else{if(!m)if(a=ig(A),a!==null){if(c.flags|=128,m=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),_h(w,!0),w.tail===null&&w.tailMode==="hidden"&&!A.alternate&&!It)return bn(c),null}else 2*vt()-w.renderingStartTime>mc&&d!==1073741824&&(c.flags|=128,m=!0,_h(w,!1),c.lanes=4194304);w.isBackwards?(A.sibling=c.child,c.child=A):(d=w.last,d!==null?d.sibling=A:c.child=A,w.last=A)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=vt(),c.sibling=null,d=At.current,_t(At,m?d&1|2:d&1),c):(bn(c),null);case 22:case 23:return O0(),m=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==m&&(c.flags|=8192),m&&(c.mode&1)!==0?(vi&1073741824)!==0&&(bn(c),c.subtreeFlags&6&&(c.flags|=8192)):bn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function IM(a,c){switch($y(c),c.tag){case 1:return qn(c.type)&&Hf(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return dc(),wt(Kn),wt(Rn),r0(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return n0(c),null;case 13:if(wt(At),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));lc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return wt(At),null;case 4:return dc(),null;case 10:return Zy(c.type._context),null;case 22:case 23:return O0(),null;case 24:return null;default:return null}}var dg=!1,Pn=!1,CM=typeof WeakSet=="function"?WeakSet:Set,_e=null;function gc(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(m){Dt(a,c,m)}else d.current=null}function S0(a,c,d){try{d()}catch(m){Dt(a,c,m)}}var yT=!1;function RM(a,c){if(Oy=xs,a=Xw(),Ay(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var v=m.anchorOffset,w=m.focusNode;m=m.focusOffset;try{d.nodeType,w.nodeType}catch{d=null;break e}var A=0,z=-1,W=-1,J=0,ae=0,ce=a,oe=null;t:for(;;){for(var ye;ce!==d||v!==0&&ce.nodeType!==3||(z=A+v),ce!==w||m!==0&&ce.nodeType!==3||(W=A+m),ce.nodeType===3&&(A+=ce.nodeValue.length),(ye=ce.firstChild)!==null;)oe=ce,ce=ye;for(;;){if(ce===a)break t;if(oe===d&&++J===v&&(z=A),oe===w&&++ae===m&&(W=A),(ye=ce.nextSibling)!==null)break;ce=oe,oe=ce.parentNode}ce=ye}d=z===-1||W===-1?null:{start:z,end:W}}else d=null}d=d||{start:0,end:0}}else d=null;for(Fy={focusedElem:a,selectionRange:d},xs=!1,_e=c;_e!==null;)if(c=_e,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,_e=a;else for(;_e!==null;){c=_e;try{var ve=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var we=ve.memoizedProps,jt=ve.memoizedState,K=c.stateNode,H=K.getSnapshotBeforeUpdate(c.elementType===c.type?we:ar(c.type,we),jt);K.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var Y=c.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(de){Dt(c,c.return,de)}if(a=c.sibling,a!==null){a.return=c.return,_e=a;break}_e=c.return}return ve=yT,yT=!1,ve}function vh(a,c,d){var m=c.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var v=m=m.next;do{if((v.tag&a)===a){var w=v.destroy;v.destroy=void 0,w!==void 0&&S0(c,d,w)}v=v.next}while(v!==m)}}function fg(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var m=d.create;d.destroy=m()}d=d.next}while(d!==c)}}function I0(a){var c=a.ref;if(c!==null){var d=a.stateNode;a.tag,a=d,typeof c=="function"?c(a):c.current=a}}function _T(a){var c=a.alternate;c!==null&&(a.alternate=null,_T(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[Hr],delete c[lh],delete c[zy],delete c[cM],delete c[uM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function vT(a){return a.tag===5||a.tag===3||a.tag===4}function xT(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||vT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function C0(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=Wf));else if(m!==4&&(a=a.child,a!==null))for(C0(a,c,d),a=a.sibling;a!==null;)C0(a,c,d),a=a.sibling}function R0(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(m!==4&&(a=a.child,a!==null))for(R0(a,c,d),a=a.sibling;a!==null;)R0(a,c,d),a=a.sibling}var _n=null,lr=!1;function _o(a,c,d){for(d=d.child;d!==null;)wT(a,c,d),d=d.sibling}function wT(a,c,d){if(hi&&typeof hi.onCommitFiberUnmount=="function")try{hi.onCommitFiberUnmount(fa,d)}catch{}switch(d.tag){case 5:Pn||gc(d,c);case 6:var m=_n,v=lr;_n=null,_o(a,c,d),_n=m,lr=v,_n!==null&&(lr?(a=_n,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):_n.removeChild(d.stateNode));break;case 18:_n!==null&&(lr?(a=_n,d=d.stateNode,a.nodeType===8?Uy(a.parentNode,d):a.nodeType===1&&Uy(a,d),ao(a)):Uy(_n,d.stateNode));break;case 4:m=_n,v=lr,_n=d.stateNode.containerInfo,lr=!0,_o(a,c,d),_n=m,lr=v;break;case 0:case 11:case 14:case 15:if(!Pn&&(m=d.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){v=m=m.next;do{var w=v,A=w.destroy;w=w.tag,A!==void 0&&((w&2)!==0||(w&4)!==0)&&S0(d,c,A),v=v.next}while(v!==m)}_o(a,c,d);break;case 1:if(!Pn&&(gc(d,c),m=d.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=d.memoizedProps,m.state=d.memoizedState,m.componentWillUnmount()}catch(z){Dt(d,c,z)}_o(a,c,d);break;case 21:_o(a,c,d);break;case 22:d.mode&1?(Pn=(m=Pn)||d.memoizedState!==null,_o(a,c,d),Pn=m):_o(a,c,d);break;default:_o(a,c,d)}}function ET(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new CM),c.forEach(function(m){var v=OM.bind(null,a,m);d.has(m)||(d.add(m),m.then(v,v))})}}function cr(a,c){var d=c.deletions;if(d!==null)for(var m=0;m<d.length;m++){var v=d[m];try{var w=a,A=c,z=A;e:for(;z!==null;){switch(z.tag){case 5:_n=z.stateNode,lr=!1;break e;case 3:_n=z.stateNode.containerInfo,lr=!0;break e;case 4:_n=z.stateNode.containerInfo,lr=!0;break e}z=z.return}if(_n===null)throw Error(t(160));wT(w,A,v),_n=null,lr=!1;var W=v.alternate;W!==null&&(W.return=null),v.return=null}catch(J){Dt(v,c,J)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)TT(c,a),c=c.sibling}function TT(a,c){var d=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(cr(c,a),Xr(a),m&4){try{vh(3,a,a.return),fg(3,a)}catch(we){Dt(a,a.return,we)}try{vh(5,a,a.return)}catch(we){Dt(a,a.return,we)}}break;case 1:cr(c,a),Xr(a),m&512&&d!==null&&gc(d,d.return);break;case 5:if(cr(c,a),Xr(a),m&512&&d!==null&&gc(d,d.return),a.flags&32){var v=a.stateNode;try{Pr(v,"")}catch(we){Dt(a,a.return,we)}}if(m&4&&(v=a.stateNode,v!=null)){var w=a.memoizedProps,A=d!==null?d.memoizedProps:w,z=a.type,W=a.updateQueue;if(a.updateQueue=null,W!==null)try{z==="input"&&w.type==="radio"&&w.name!=null&&dn(v,w),ps(z,A);var J=ps(z,w);for(A=0;A<W.length;A+=2){var ae=W[A],ce=W[A+1];ae==="style"?gs(v,ce):ae==="dangerouslySetInnerHTML"?ca(v,ce):ae==="children"?Pr(v,ce):N(v,ae,ce,J)}switch(z){case"input":Hn(v,w);break;case"textarea":to(v,w);break;case"select":var oe=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!w.multiple;var ye=w.value;ye!=null?tn(v,!!w.multiple,ye,!1):oe!==!!w.multiple&&(w.defaultValue!=null?tn(v,!!w.multiple,w.defaultValue,!0):tn(v,!!w.multiple,w.multiple?[]:"",!1))}v[lh]=w}catch(we){Dt(a,a.return,we)}}break;case 6:if(cr(c,a),Xr(a),m&4){if(a.stateNode===null)throw Error(t(162));v=a.stateNode,w=a.memoizedProps;try{v.nodeValue=w}catch(we){Dt(a,a.return,we)}}break;case 3:if(cr(c,a),Xr(a),m&4&&d!==null&&d.memoizedState.isDehydrated)try{ao(c.containerInfo)}catch(we){Dt(a,a.return,we)}break;case 4:cr(c,a),Xr(a);break;case 13:cr(c,a),Xr(a),v=a.child,v.flags&8192&&(w=v.memoizedState!==null,v.stateNode.isHidden=w,!w||v.alternate!==null&&v.alternate.memoizedState!==null||(P0=vt())),m&4&&ET(a);break;case 22:if(ae=d!==null&&d.memoizedState!==null,a.mode&1?(Pn=(J=Pn)||ae,cr(c,a),Pn=J):cr(c,a),Xr(a),m&8192){if(J=a.memoizedState!==null,(a.stateNode.isHidden=J)&&!ae&&(a.mode&1)!==0)for(_e=a,ae=a.child;ae!==null;){for(ce=_e=ae;_e!==null;){switch(oe=_e,ye=oe.child,oe.tag){case 0:case 11:case 14:case 15:vh(4,oe,oe.return);break;case 1:gc(oe,oe.return);var ve=oe.stateNode;if(typeof ve.componentWillUnmount=="function"){m=oe,d=oe.return;try{c=m,ve.props=c.memoizedProps,ve.state=c.memoizedState,ve.componentWillUnmount()}catch(we){Dt(m,d,we)}}break;case 5:gc(oe,oe.return);break;case 22:if(oe.memoizedState!==null){CT(ce);continue}}ye!==null?(ye.return=oe,_e=ye):CT(ce)}ae=ae.sibling}e:for(ae=null,ce=a;;){if(ce.tag===5){if(ae===null){ae=ce;try{v=ce.stateNode,J?(w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(z=ce.stateNode,W=ce.memoizedProps.style,A=W!=null&&W.hasOwnProperty("display")?W.display:null,z.style.display=kr("display",A))}catch(we){Dt(a,a.return,we)}}}else if(ce.tag===6){if(ae===null)try{ce.stateNode.nodeValue=J?"":ce.memoizedProps}catch(we){Dt(a,a.return,we)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===a)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===a)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===a)break e;ae===ce&&(ae=null),ce=ce.return}ae===ce&&(ae=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:cr(c,a),Xr(a),m&4&&ET(a);break;case 21:break;default:cr(c,a),Xr(a)}}function Xr(a){var c=a.flags;if(c&2){try{e:{for(var d=a.return;d!==null;){if(vT(d)){var m=d;break e}d=d.return}throw Error(t(160))}switch(m.tag){case 5:var v=m.stateNode;m.flags&32&&(Pr(v,""),m.flags&=-33);var w=xT(a);R0(a,w,v);break;case 3:case 4:var A=m.stateNode.containerInfo,z=xT(a);C0(a,z,A);break;default:throw Error(t(161))}}catch(W){Dt(a,a.return,W)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function AM(a,c,d){_e=a,ST(a)}function ST(a,c,d){for(var m=(a.mode&1)!==0;_e!==null;){var v=_e,w=v.child;if(v.tag===22&&m){var A=v.memoizedState!==null||dg;if(!A){var z=v.alternate,W=z!==null&&z.memoizedState!==null||Pn;z=dg;var J=Pn;if(dg=A,(Pn=W)&&!J)for(_e=v;_e!==null;)A=_e,W=A.child,A.tag===22&&A.memoizedState!==null?RT(v):W!==null?(W.return=A,_e=W):RT(v);for(;w!==null;)_e=w,ST(w),w=w.sibling;_e=v,dg=z,Pn=J}IT(a)}else(v.subtreeFlags&8772)!==0&&w!==null?(w.return=v,_e=w):IT(a)}}function IT(a){for(;_e!==null;){var c=_e;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Pn||fg(5,c);break;case 1:var m=c.stateNode;if(c.flags&4&&!Pn)if(d===null)m.componentDidMount();else{var v=c.elementType===c.type?d.memoizedProps:ar(c.type,d.memoizedProps);m.componentDidUpdate(v,d.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var w=c.updateQueue;w!==null&&CE(c,w,m);break;case 3:var A=c.updateQueue;if(A!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}CE(c,A,d)}break;case 5:var z=c.stateNode;if(d===null&&c.flags&4){d=z;var W=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":W.autoFocus&&d.focus();break;case"img":W.src&&(d.src=W.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var J=c.alternate;if(J!==null){var ae=J.memoizedState;if(ae!==null){var ce=ae.dehydrated;ce!==null&&ao(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Pn||c.flags&512&&I0(c)}catch(oe){Dt(c,c.return,oe)}}if(c===a){_e=null;break}if(d=c.sibling,d!==null){d.return=c.return,_e=d;break}_e=c.return}}function CT(a){for(;_e!==null;){var c=_e;if(c===a){_e=null;break}var d=c.sibling;if(d!==null){d.return=c.return,_e=d;break}_e=c.return}}function RT(a){for(;_e!==null;){var c=_e;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{fg(4,c)}catch(W){Dt(c,d,W)}break;case 1:var m=c.stateNode;if(typeof m.componentDidMount=="function"){var v=c.return;try{m.componentDidMount()}catch(W){Dt(c,v,W)}}var w=c.return;try{I0(c)}catch(W){Dt(c,w,W)}break;case 5:var A=c.return;try{I0(c)}catch(W){Dt(c,A,W)}}}catch(W){Dt(c,c.return,W)}if(c===a){_e=null;break}var z=c.sibling;if(z!==null){z.return=c.return,_e=z;break}_e=c.return}}var bM=Math.ceil,gg=L.ReactCurrentDispatcher,A0=L.ReactCurrentOwner,zi=L.ReactCurrentBatchConfig,Je=0,sn=null,Wt=null,vn=0,vi=0,pc=fo(0),Yt=0,xh=null,ba=0,pg=0,b0=0,wh=null,Yn=null,P0=0,mc=1/0,Ps=null,mg=!1,k0=null,vo=null,yg=!1,xo=null,_g=0,Eh=0,N0=null,vg=-1,xg=0;function Un(){return(Je&6)!==0?vt():vg!==-1?vg:vg=vt()}function wo(a){return(a.mode&1)===0?1:(Je&2)!==0&&vn!==0?vn&-vn:dM.transition!==null?(xg===0&&(xg=Gu()),xg):(a=qe,a!==0||(a=window.event,a=a===void 0?16:$l(a.type)),a)}function ur(a,c,d,m){if(50<Eh)throw Eh=0,N0=null,Error(t(185));ya(a,d,m),((Je&2)===0||a!==sn)&&(a===sn&&((Je&2)===0&&(pg|=d),Yt===4&&Eo(a,vn)),Zn(a,m),d===1&&Je===0&&(c.mode&1)===0&&(mc=vt()+500,qf&&po()))}function Zn(a,c){var d=a.callbackNode;ma(a,c);var m=ys(a,a===sn?vn:0);if(m===0)d!==null&&Vl(d),a.callbackNode=null,a.callbackPriority=0;else if(c=m&-m,a.callbackPriority!==c){if(d!=null&&Vl(d),c===1)a.tag===0?hM(bT.bind(null,a)):gE(bT.bind(null,a)),aM(function(){(Je&6)===0&&po()}),d=null;else{switch(Or(m)){case 1:d=jl;break;case 4:d=Uu;break;case 16:d=da;break;case 536870912:d=Ul;break;default:d=da}d=FT(d,AT.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function AT(a,c){if(vg=-1,xg=0,(Je&6)!==0)throw Error(t(327));var d=a.callbackNode;if(yc()&&a.callbackNode!==d)return null;var m=ys(a,a===sn?vn:0);if(m===0)return null;if((m&30)!==0||(m&a.expiredLanes)!==0||c)c=wg(a,m);else{c=m;var v=Je;Je|=2;var w=kT();(sn!==a||vn!==c)&&(Ps=null,mc=vt()+500,ka(a,c));do try{NM();break}catch(z){PT(a,z)}while(!0);Yy(),gg.current=w,Je=v,Wt!==null?c=0:(sn=null,vn=0,c=Yt)}if(c!==0){if(c===2&&(v=Bu(a),v!==0&&(m=v,c=D0(a,v))),c===1)throw d=xh,ka(a,0),Eo(a,m),Zn(a,vt()),d;if(c===6)Eo(a,m);else{if(v=a.current.alternate,(m&30)===0&&!PM(v)&&(c=wg(a,m),c===2&&(w=Bu(a),w!==0&&(m=w,c=D0(a,w))),c===1))throw d=xh,ka(a,0),Eo(a,m),Zn(a,vt()),d;switch(a.finishedWork=v,a.finishedLanes=m,c){case 0:case 1:throw Error(t(345));case 2:Na(a,Yn,Ps);break;case 3:if(Eo(a,m),(m&130023424)===m&&(c=P0+500-vt(),10<c)){if(ys(a,0)!==0)break;if(v=a.suspendedLanes,(v&m)!==m){Un(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=jy(Na.bind(null,a,Yn,Ps),c);break}Na(a,Yn,Ps);break;case 4:if(Eo(a,m),(m&4194240)===m)break;for(c=a.eventTimes,v=-1;0<m;){var A=31-di(m);w=1<<A,A=c[A],A>v&&(v=A),m&=~w}if(m=v,m=vt()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*bM(m/1960))-m,10<m){a.timeoutHandle=jy(Na.bind(null,a,Yn,Ps),m);break}Na(a,Yn,Ps);break;case 5:Na(a,Yn,Ps);break;default:throw Error(t(329))}}}return Zn(a,vt()),a.callbackNode===d?AT.bind(null,a):null}function D0(a,c){var d=wh;return a.current.memoizedState.isDehydrated&&(ka(a,c).flags|=256),a=wg(a,c),a!==2&&(c=Yn,Yn=d,c!==null&&M0(c)),a}function M0(a){Yn===null?Yn=a:Yn.push.apply(Yn,a)}function PM(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var m=0;m<d.length;m++){var v=d[m],w=v.getSnapshot;v=v.value;try{if(!sr(w(),v))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Eo(a,c){for(c&=~b0,c&=~pg,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-di(c),m=1<<d;a[d]=-1,c&=~m}}function bT(a){if((Je&6)!==0)throw Error(t(327));yc();var c=ys(a,0);if((c&1)===0)return Zn(a,vt()),null;var d=wg(a,c);if(a.tag!==0&&d===2){var m=Bu(a);m!==0&&(c=m,d=D0(a,m))}if(d===1)throw d=xh,ka(a,0),Eo(a,c),Zn(a,vt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Na(a,Yn,Ps),Zn(a,vt()),null}function L0(a,c){var d=Je;Je|=1;try{return a(c)}finally{Je=d,Je===0&&(mc=vt()+500,qf&&po())}}function Pa(a){xo!==null&&xo.tag===0&&(Je&6)===0&&yc();var c=Je;Je|=1;var d=zi.transition,m=qe;try{if(zi.transition=null,qe=1,a)return a()}finally{qe=m,zi.transition=d,Je=c,(Je&6)===0&&po()}}function O0(){vi=pc.current,wt(pc)}function ka(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,oM(d)),Wt!==null)for(d=Wt.return;d!==null;){var m=d;switch($y(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Hf();break;case 3:dc(),wt(Kn),wt(Rn),r0();break;case 5:n0(m);break;case 4:dc();break;case 13:wt(At);break;case 19:wt(At);break;case 10:Zy(m.type._context);break;case 22:case 23:O0()}d=d.return}if(sn=a,Wt=a=To(a.current,null),vn=vi=c,Yt=0,xh=null,b0=pg=ba=0,Yn=wh=null,Ca!==null){for(c=0;c<Ca.length;c++)if(d=Ca[c],m=d.interleaved,m!==null){d.interleaved=null;var v=m.next,w=d.pending;if(w!==null){var A=w.next;w.next=v,m.next=A}d.pending=m}Ca=null}return a}function PT(a,c){do{var d=Wt;try{if(Yy(),rg.current=lg,sg){for(var m=bt.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}sg=!1}if(Aa=0,rn=Xt=bt=null,gh=!1,ph=0,A0.current=null,d===null||d.return===null){Yt=1,xh=c,Wt=null;break}e:{var w=a,A=d.return,z=d,W=c;if(c=vn,z.flags|=32768,W!==null&&typeof W=="object"&&typeof W.then=="function"){var J=W,ae=z,ce=ae.tag;if((ae.mode&1)===0&&(ce===0||ce===11||ce===15)){var oe=ae.alternate;oe?(ae.updateQueue=oe.updateQueue,ae.memoizedState=oe.memoizedState,ae.lanes=oe.lanes):(ae.updateQueue=null,ae.memoizedState=null)}var ye=tT(A);if(ye!==null){ye.flags&=-257,nT(ye,A,z,w,c),ye.mode&1&&eT(w,J,c),c=ye,W=J;var ve=c.updateQueue;if(ve===null){var we=new Set;we.add(W),c.updateQueue=we}else ve.add(W);break e}else{if((c&1)===0){eT(w,J,c),F0();break e}W=Error(t(426))}}else if(It&&z.mode&1){var jt=tT(A);if(jt!==null){(jt.flags&65536)===0&&(jt.flags|=256),nT(jt,A,z,w,c),qy(fc(W,z));break e}}w=W=fc(W,z),Yt!==4&&(Yt=2),wh===null?wh=[w]:wh.push(w),w=A;do{switch(w.tag){case 3:w.flags|=65536,c&=-c,w.lanes|=c;var K=QE(w,W,c);IE(w,K);break e;case 1:z=W;var H=w.type,Y=w.stateNode;if((w.flags&128)===0&&(typeof H.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(vo===null||!vo.has(Y)))){w.flags|=65536,c&=-c,w.lanes|=c;var de=JE(w,z,c);IE(w,de);break e}}w=w.return}while(w!==null)}DT(d)}catch(Te){c=Te,Wt===d&&d!==null&&(Wt=d=d.return);continue}break}while(!0)}function kT(){var a=gg.current;return gg.current=lg,a===null?lg:a}function F0(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),sn===null||(ba&268435455)===0&&(pg&268435455)===0||Eo(sn,vn)}function wg(a,c){var d=Je;Je|=2;var m=kT();(sn!==a||vn!==c)&&(Ps=null,ka(a,c));do try{kM();break}catch(v){PT(a,v)}while(!0);if(Yy(),Je=d,gg.current=m,Wt!==null)throw Error(t(261));return sn=null,vn=0,Yt}function kM(){for(;Wt!==null;)NT(Wt)}function NM(){for(;Wt!==null&&!ha();)NT(Wt)}function NT(a){var c=OT(a.alternate,a,vi);a.memoizedProps=a.pendingProps,c===null?DT(a):Wt=c,A0.current=null}function DT(a){var c=a;do{var d=c.alternate;if(a=c.return,(c.flags&32768)===0){if(d=SM(d,c,vi),d!==null){Wt=d;return}}else{if(d=IM(d,c),d!==null){d.flags&=32767,Wt=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Yt=6,Wt=null;return}}if(c=c.sibling,c!==null){Wt=c;return}Wt=c=a}while(c!==null);Yt===0&&(Yt=5)}function Na(a,c,d){var m=qe,v=zi.transition;try{zi.transition=null,qe=1,DM(a,c,d,m)}finally{zi.transition=v,qe=m}return null}function DM(a,c,d,m){do yc();while(xo!==null);if((Je&6)!==0)throw Error(t(327));d=a.finishedWork;var v=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var w=d.lanes|d.childLanes;if(Ty(a,w),a===sn&&(Wt=sn=null,vn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||yg||(yg=!0,FT(da,function(){return yc(),null})),w=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||w){w=zi.transition,zi.transition=null;var A=qe;qe=1;var z=Je;Je|=4,A0.current=null,RM(a,d),TT(d,a),JD(Fy),xs=!!Oy,Fy=Oy=null,a.current=d,AM(d),ms(),Je=z,qe=A,zi.transition=w}else a.current=d;if(yg&&(yg=!1,xo=a,_g=v),w=a.pendingLanes,w===0&&(vo=null),Af(d.stateNode),Zn(a,vt()),c!==null)for(m=a.onRecoverableError,d=0;d<c.length;d++)v=c[d],m(v.value,{componentStack:v.stack,digest:v.digest});if(mg)throw mg=!1,a=k0,k0=null,a;return(_g&1)!==0&&a.tag!==0&&yc(),w=a.pendingLanes,(w&1)!==0?a===N0?Eh++:(Eh=0,N0=a):Eh=0,po(),null}function yc(){if(xo!==null){var a=Or(_g),c=zi.transition,d=qe;try{if(zi.transition=null,qe=16>a?16:a,xo===null)var m=!1;else{if(a=xo,xo=null,_g=0,(Je&6)!==0)throw Error(t(331));var v=Je;for(Je|=4,_e=a.current;_e!==null;){var w=_e,A=w.child;if((_e.flags&16)!==0){var z=w.deletions;if(z!==null){for(var W=0;W<z.length;W++){var J=z[W];for(_e=J;_e!==null;){var ae=_e;switch(ae.tag){case 0:case 11:case 15:vh(8,ae,w)}var ce=ae.child;if(ce!==null)ce.return=ae,_e=ce;else for(;_e!==null;){ae=_e;var oe=ae.sibling,ye=ae.return;if(_T(ae),ae===J){_e=null;break}if(oe!==null){oe.return=ye,_e=oe;break}_e=ye}}}var ve=w.alternate;if(ve!==null){var we=ve.child;if(we!==null){ve.child=null;do{var jt=we.sibling;we.sibling=null,we=jt}while(we!==null)}}_e=w}}if((w.subtreeFlags&2064)!==0&&A!==null)A.return=w,_e=A;else e:for(;_e!==null;){if(w=_e,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:vh(9,w,w.return)}var K=w.sibling;if(K!==null){K.return=w.return,_e=K;break e}_e=w.return}}var H=a.current;for(_e=H;_e!==null;){A=_e;var Y=A.child;if((A.subtreeFlags&2064)!==0&&Y!==null)Y.return=A,_e=Y;else e:for(A=H;_e!==null;){if(z=_e,(z.flags&2048)!==0)try{switch(z.tag){case 0:case 11:case 15:fg(9,z)}}catch(Te){Dt(z,z.return,Te)}if(z===A){_e=null;break e}var de=z.sibling;if(de!==null){de.return=z.return,_e=de;break e}_e=z.return}}if(Je=v,po(),hi&&typeof hi.onPostCommitFiberRoot=="function")try{hi.onPostCommitFiberRoot(fa,a)}catch{}m=!0}return m}finally{qe=d,zi.transition=c}}return!1}function MT(a,c,d){c=fc(d,c),c=QE(a,c,1),a=yo(a,c,1),c=Un(),a!==null&&(ya(a,1,c),Zn(a,c))}function Dt(a,c,d){if(a.tag===3)MT(a,a,d);else for(;c!==null;){if(c.tag===3){MT(c,a,d);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(vo===null||!vo.has(m))){a=fc(d,a),a=JE(c,a,1),c=yo(c,a,1),a=Un(),c!==null&&(ya(c,1,a),Zn(c,a));break}}c=c.return}}function MM(a,c,d){var m=a.pingCache;m!==null&&m.delete(c),c=Un(),a.pingedLanes|=a.suspendedLanes&d,sn===a&&(vn&d)===d&&(Yt===4||Yt===3&&(vn&130023424)===vn&&500>vt()-P0?ka(a,0):b0|=d),Zn(a,c)}function LT(a,c){c===0&&((a.mode&1)===0?c=1:(c=ro,ro<<=1,(ro&130023424)===0&&(ro=4194304)));var d=Un();a=Rs(a,c),a!==null&&(ya(a,c,d),Zn(a,d))}function LM(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),LT(a,d)}function OM(a,c){var d=0;switch(a.tag){case 13:var m=a.stateNode,v=a.memoizedState;v!==null&&(d=v.retryLane);break;case 19:m=a.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(c),LT(a,d)}var OT;OT=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Kn.current)Xn=!0;else{if((a.lanes&d)===0&&(c.flags&128)===0)return Xn=!1,TM(a,c,d);Xn=(a.flags&131072)!==0}else Xn=!1,It&&(c.flags&1048576)!==0&&pE(c,Yf,c.index);switch(c.lanes=0,c.tag){case 2:var m=c.type;hg(a,c),a=c.pendingProps;var v=sc(c,Rn.current);hc(c,d),v=a0(null,c,m,a,v,d);var w=l0();return c.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,qn(m)?(w=!0,Kf(c)):w=!1,c.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,e0(c),v.updater=cg,c.stateNode=v,v._reactInternals=c,g0(c,m,a,d),c=_0(null,c,m,!0,w,d)):(c.tag=0,It&&w&&Wy(c),jn(null,c,v,d),c=c.child),c;case 16:m=c.elementType;e:{switch(hg(a,c),a=c.pendingProps,v=m._init,m=v(m._payload),c.type=m,v=c.tag=VM(m),a=ar(m,a),v){case 0:c=y0(null,c,m,a,d);break e;case 1:c=lT(null,c,m,a,d);break e;case 11:c=iT(null,c,m,a,d);break e;case 14:c=rT(null,c,m,ar(m.type,a),d);break e}throw Error(t(306,m,""))}return c;case 0:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),y0(a,c,m,v,d);case 1:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),lT(a,c,m,v,d);case 3:e:{if(cT(c),a===null)throw Error(t(387));m=c.pendingProps,w=c.memoizedState,v=w.element,SE(a,c),ng(c,m,null,d);var A=c.memoizedState;if(m=A.element,w.isDehydrated)if(w={element:m,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},c.updateQueue.baseState=w,c.memoizedState=w,c.flags&256){v=fc(Error(t(423)),c),c=uT(a,c,m,d,v);break e}else if(m!==v){v=fc(Error(t(424)),c),c=uT(a,c,m,d,v);break e}else for(_i=ho(c.stateNode.containerInfo.firstChild),yi=c,It=!0,or=null,d=EE(c,null,m,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(lc(),m===v){c=bs(a,c,d);break e}jn(a,c,m,d)}c=c.child}return c;case 5:return RE(c),a===null&&Ky(c),m=c.type,v=c.pendingProps,w=a!==null?a.memoizedProps:null,A=v.children,Vy(m,v)?A=null:w!==null&&Vy(m,w)&&(c.flags|=32),aT(a,c),jn(a,c,A,d),c.child;case 6:return a===null&&Ky(c),null;case 13:return hT(a,c,d);case 4:return t0(c,c.stateNode.containerInfo),m=c.pendingProps,a===null?c.child=cc(c,null,m,d):jn(a,c,m,d),c.child;case 11:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),iT(a,c,m,v,d);case 7:return jn(a,c,c.pendingProps,d),c.child;case 8:return jn(a,c,c.pendingProps.children,d),c.child;case 12:return jn(a,c,c.pendingProps.children,d),c.child;case 10:e:{if(m=c.type._context,v=c.pendingProps,w=c.memoizedProps,A=v.value,_t(Jf,m._currentValue),m._currentValue=A,w!==null)if(sr(w.value,A)){if(w.children===v.children&&!Kn.current){c=bs(a,c,d);break e}}else for(w=c.child,w!==null&&(w.return=c);w!==null;){var z=w.dependencies;if(z!==null){A=w.child;for(var W=z.firstContext;W!==null;){if(W.context===m){if(w.tag===1){W=As(-1,d&-d),W.tag=2;var J=w.updateQueue;if(J!==null){J=J.shared;var ae=J.pending;ae===null?W.next=W:(W.next=ae.next,ae.next=W),J.pending=W}}w.lanes|=d,W=w.alternate,W!==null&&(W.lanes|=d),Qy(w.return,d,c),z.lanes|=d;break}W=W.next}}else if(w.tag===10)A=w.type===c.type?null:w.child;else if(w.tag===18){if(A=w.return,A===null)throw Error(t(341));A.lanes|=d,z=A.alternate,z!==null&&(z.lanes|=d),Qy(A,d,c),A=w.sibling}else A=w.child;if(A!==null)A.return=w;else for(A=w;A!==null;){if(A===c){A=null;break}if(w=A.sibling,w!==null){w.return=A.return,A=w;break}A=A.return}w=A}jn(a,c,v.children,d),c=c.child}return c;case 9:return v=c.type,m=c.pendingProps.children,hc(c,d),v=ji(v),m=m(v),c.flags|=1,jn(a,c,m,d),c.child;case 14:return m=c.type,v=ar(m,c.pendingProps),v=ar(m.type,v),rT(a,c,m,v,d);case 15:return sT(a,c,c.type,c.pendingProps,d);case 17:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),hg(a,c),c.tag=1,qn(m)?(a=!0,Kf(c)):a=!1,hc(c,d),YE(c,m,v),g0(c,m,v,d),_0(null,c,m,!0,a,d);case 19:return fT(a,c,d);case 22:return oT(a,c,d)}throw Error(t(156,c.tag))};function FT(a,c){return ju(a,c)}function FM(a,c,d,m){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bi(a,c,d,m){return new FM(a,c,d,m)}function V0(a){return a=a.prototype,!(!a||!a.isReactComponent)}function VM(a){if(typeof a=="function")return V0(a)?1:0;if(a!=null){if(a=a.$$typeof,a===B)return 11;if(a===he)return 14}return 2}function To(a,c){var d=a.alternate;return d===null?(d=Bi(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function Eg(a,c,d,m,v,w){var A=2;if(m=a,typeof a=="function")V0(a)&&(A=1);else if(typeof a=="string")A=5;else e:switch(a){case k:return Da(d.children,v,w,c);case R:A=8,v|=8;break;case P:return a=Bi(12,d,c,v|2),a.elementType=P,a.lanes=w,a;case M:return a=Bi(13,d,c,v),a.elementType=M,a.lanes=w,a;case se:return a=Bi(19,d,c,v),a.elementType=se,a.lanes=w,a;case ue:return Tg(d,v,w,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case V:A=10;break e;case j:A=9;break e;case B:A=11;break e;case he:A=14;break e;case ge:A=16,m=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=Bi(A,d,c,v),c.elementType=a,c.type=m,c.lanes=w,c}function Da(a,c,d,m){return a=Bi(7,a,m,c),a.lanes=d,a}function Tg(a,c,d,m){return a=Bi(22,a,m,c),a.elementType=ue,a.lanes=d,a.stateNode={isHidden:!1},a}function j0(a,c,d){return a=Bi(6,a,null,c),a.lanes=d,a}function U0(a,c,d){return c=Bi(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function jM(a,c,d,m,v){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wu(0),this.expirationTimes=Wu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wu(0),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function z0(a,c,d,m,v,w,A,z,W){return a=new jM(a,c,d,z,W),c===1?(c=1,w===!0&&(c|=8)):c=0,w=Bi(3,null,null,c),a.current=w,w.stateNode=a,w.memoizedState={element:m,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},e0(w),a}function UM(a,c,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:m==null?null:""+m,children:a,containerInfo:c,implementation:d}}function VT(a){if(!a)return go;a=a._reactInternals;e:{if(ir(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(qn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(qn(d))return dE(a,d,c)}return c}function jT(a,c,d,m,v,w,A,z,W){return a=z0(d,m,!0,a,v,w,A,z,W),a.context=VT(null),d=a.current,m=Un(),v=wo(d),w=As(m,v),w.callback=c??null,yo(d,w,v),a.current.lanes=v,ya(a,v,m),Zn(a,m),a}function Sg(a,c,d,m){var v=c.current,w=Un(),A=wo(v);return d=VT(d),c.context===null?c.context=d:c.pendingContext=d,c=As(w,A),c.payload={element:a},m=m===void 0?null:m,m!==null&&(c.callback=m),a=yo(v,c,A),a!==null&&(ur(a,v,A,w),tg(a,v,A)),A}function Ig(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function UT(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function B0(a,c){UT(a,c),(a=a.alternate)&&UT(a,c)}function zM(){return null}var zT=typeof reportError=="function"?reportError:function(a){console.error(a)};function G0(a){this._internalRoot=a}Cg.prototype.render=G0.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));Sg(a,c,null,null)},Cg.prototype.unmount=G0.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;Pa(function(){Sg(null,a,null,null)}),c[Ts]=null}};function Cg(a){this._internalRoot=a}Cg.prototype.unstable_scheduleHydration=function(a){if(a){var c=qu();a={blockedOn:null,target:a,priority:c};for(var d=0;d<fi.length&&c!==0&&c<fi[d].priority;d++);fi.splice(d,0,a),d===0&&Gl(a)}};function W0(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Rg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function BT(){}function BM(a,c,d,m,v){if(v){if(typeof m=="function"){var w=m;m=function(){var J=Ig(A);w.call(J)}}var A=jT(c,m,a,0,null,!1,!1,"",BT);return a._reactRootContainer=A,a[Ts]=A.current,oh(a.nodeType===8?a.parentNode:a),Pa(),A}for(;v=a.lastChild;)a.removeChild(v);if(typeof m=="function"){var z=m;m=function(){var J=Ig(W);z.call(J)}}var W=z0(a,0,!1,null,null,!1,!1,"",BT);return a._reactRootContainer=W,a[Ts]=W.current,oh(a.nodeType===8?a.parentNode:a),Pa(function(){Sg(c,W,d,m)}),W}function Ag(a,c,d,m,v){var w=d._reactRootContainer;if(w){var A=w;if(typeof v=="function"){var z=v;v=function(){var W=Ig(A);z.call(W)}}Sg(c,A,a,v)}else A=BM(d,c,a,v,m);return Ig(A)}Hu=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=st(c.pendingLanes);d!==0&&($u(c,d|1),Zn(c,vt()),(Je&6)===0&&(mc=vt()+500,po()))}break;case 13:Pa(function(){var m=Rs(a,1);if(m!==null){var v=Un();ur(m,a,1,v)}}),B0(a,1)}},zl=function(a){if(a.tag===13){var c=Rs(a,134217728);if(c!==null){var d=Un();ur(c,a,134217728,d)}B0(a,134217728)}},Ku=function(a){if(a.tag===13){var c=wo(a),d=Rs(a,c);if(d!==null){var m=Un();ur(d,a,c,m)}B0(a,c)}},qu=function(){return qe},Xu=function(a,c){var d=qe;try{return qe=a,c()}finally{qe=d}},Fn=function(a,c,d){switch(c){case"input":if(Hn(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var m=d[c];if(m!==a&&m.form===a.form){var v=$f(m);if(!v)throw Error(t(90));fs(m),Hn(m,v)}}}break;case"textarea":to(a,d);break;case"select":c=d.value,c!=null&&tn(a,!!d.multiple,c,!1)}},Di=L0,fn=Pa;var GM={usingClientEntryPoint:!1,Events:[ch,ic,$f,nr,Ot,L0]},Th={findFiberByHostInstance:Ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},WM={bundleType:Th.bundleType,version:Th.version,rendererPackageName:Th.rendererPackageName,rendererConfig:Th.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Rf(a),a===null?null:a.stateNode},findFiberByHostInstance:Th.findFiberByHostInstance||zM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bg.isDisabled&&bg.supportsFiber)try{fa=bg.inject(WM),hi=bg}catch{}}return Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GM,Qn.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!W0(c))throw Error(t(200));return UM(a,c,null,d)},Qn.createRoot=function(a,c){if(!W0(a))throw Error(t(299));var d=!1,m="",v=zT;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onRecoverableError!==void 0&&(v=c.onRecoverableError)),c=z0(a,1,!1,null,null,d,!1,m,v),a[Ts]=c.current,oh(a.nodeType===8?a.parentNode:a),new G0(c)},Qn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Rf(c),a=a===null?null:a.stateNode,a},Qn.flushSync=function(a){return Pa(a)},Qn.hydrate=function(a,c,d){if(!Rg(c))throw Error(t(200));return Ag(null,a,c,!0,d)},Qn.hydrateRoot=function(a,c,d){if(!W0(a))throw Error(t(405));var m=d!=null&&d.hydratedSources||null,v=!1,w="",A=zT;if(d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(A=d.onRecoverableError)),c=jT(c,null,a,1,d??null,v,!1,w,A),a[Ts]=c.current,oh(a),m)for(a=0;a<m.length;a++)d=m[a],v=d._getVersion,v=v(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,v]:c.mutableSourceEagerHydrationData.push(d,v);return new Cg(c)},Qn.render=function(a,c,d){if(!Rg(c))throw Error(t(200));return Ag(null,a,c,!1,d)},Qn.unmountComponentAtNode=function(a){if(!Rg(a))throw Error(t(40));return a._reactRootContainer?(Pa(function(){Ag(null,null,a,!1,function(){a._reactRootContainer=null,a[Ts]=null})}),!0):!1},Qn.unstable_batchedUpdates=L0,Qn.unstable_renderSubtreeIntoContainer=function(a,c,d,m){if(!Rg(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Ag(a,c,d,!1,m)},Qn.version="18.3.1-next-f1338f8080-20240426",Qn}var YT;function QM(){if(YT)return K0.exports;YT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),K0.exports=ZM(),K0.exports}var ZT;function JM(){if(ZT)return Pg;ZT=1;var n=QM();return Pg.createRoot=n.createRoot,Pg.hydrateRoot=n.hydrateRoot,Pg}var eL=JM();const tL=Sx(eL);var q=Yd();const nL=Sx(q),Ix=q.createContext({});function Cx(n){const e=q.useRef(null);return e.current===null&&(e.current=n()),e.current}const Tm=q.createContext(null),Rx=q.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class iL extends q.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function rL({children:n,isPresent:e}){const t=q.useId(),i=q.useRef(null),r=q.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=q.useContext(Rx);return q.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),_.jsx(iL,{isPresent:e,childRef:i,sizeRef:r,children:q.cloneElement(n,{ref:i})})}const sL=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=Cx(oL),u=q.useId(),h=q.useCallback(p=>{l.set(p,!0);for(const y of l.values())if(!y)return;i&&i()},[l,i]),f=q.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:p=>(l.set(p,!1),()=>l.delete(p))}),s?[Math.random(),h]:[t,h]);return q.useMemo(()=>{l.forEach((p,y)=>l.set(y,!1))},[t]),q.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=_.jsx(rL,{isPresent:t,children:n})),_.jsx(Tm.Provider,{value:f,children:n})};function oL(){return new Map}function MA(n=!0){const e=q.useContext(Tm);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=q.useId();q.useEffect(()=>{n&&r(s)},[n]);const o=q.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const kg=n=>n.key||"";function QT(n){const e=[];return q.Children.forEach(n,t=>{q.isValidElement(t)&&e.push(t)}),e}const Ax=typeof window<"u",LA=Ax?q.useLayoutEffect:q.useEffect,ri=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,u]=MA(o),h=q.useMemo(()=>QT(n),[n]),f=o&&!l?[]:h.map(kg),p=q.useRef(!0),y=q.useRef(h),x=Cx(()=>new Map),[I,T]=q.useState(h),[S,b]=q.useState(h);LA(()=>{p.current=!1,y.current=h;for(let L=0;L<S.length;L++){const F=kg(S[L]);f.includes(F)?x.delete(F):x.get(F)!==!0&&x.set(F,!1)}},[S,f.length,f.join("-")]);const D=[];if(h!==I){let L=[...h];for(let F=0;F<S.length;F++){const G=S[F],k=kg(G);f.includes(k)||(L.splice(F,0,G),D.push(G))}s==="wait"&&D.length&&(L=D),b(QT(L)),T(h);return}const{forceRender:N}=q.useContext(Ix);return _.jsx(_.Fragment,{children:S.map(L=>{const F=kg(L),G=o&&!l?!1:h===S||f.includes(F),k=()=>{if(x.has(F))x.set(F,!0);else return;let R=!0;x.forEach(P=>{P||(R=!1)}),R&&(N?.(),b(y.current),o&&u?.(),i&&i())};return _.jsx(sL,{isPresent:G,initial:!p.current||t?void 0:!1,custom:G?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:G?void 0:k,children:L},F)})})},Ii=n=>n;let OA=Ii;function bx(n){let e;return()=>(e===void 0&&(e=n()),e)}const nu=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},Us=n=>n*1e3,zs=n=>n/1e3,aL={useManualTiming:!1};function lL(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,f=!1,p=!1)=>{const x=p&&i?e:t;return f&&s.add(h),x.has(h)||x.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Ng=["read","resolveKeyframes","update","preRender","render","postRender"],cL=40;function FA(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Ng.reduce((b,D)=>(b[D]=lL(s),b),{}),{read:l,resolveKeyframes:u,update:h,preRender:f,render:p,postRender:y}=o,x=()=>{const b=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(b-r.timestamp,cL),1),r.timestamp=b,r.isProcessing=!0,l.process(r),u.process(r),h.process(r),f.process(r),p.process(r),y.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(x))},I=()=>{t=!0,i=!0,r.isProcessing||n(x)};return{schedule:Ng.reduce((b,D)=>{const N=o[D];return b[D]=(L,F=!1,G=!1)=>(t||I(),N.schedule(L,F,G)),b},{}),cancel:b=>{for(let D=0;D<Ng.length;D++)o[Ng[D]].cancel(b)},state:r,steps:o}}const{schedule:Et,cancel:Jo,state:xn,steps:Y0}=FA(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ii,!0),VA=q.createContext({strict:!1}),JT={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},iu={};for(const n in JT)iu[n]={isEnabled:e=>JT[n].some(t=>!!e[t])};function uL(n){for(const e in n)iu[e]={...iu[e],...n[e]}}const hL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ip(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||hL.has(n)}let jA=n=>!Ip(n);function dL(n){n&&(jA=e=>e.startsWith("on")?!Ip(e):n(e))}try{dL(require("@emotion/is-prop-valid").default)}catch{}function fL(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(jA(r)||t===!0&&Ip(r)||!e&&!Ip(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function gL(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const Sm=q.createContext({});function pd(n){return typeof n=="string"||Array.isArray(n)}function Im(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const Px=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],kx=["initial",...Px];function Cm(n){return Im(n.animate)||kx.some(e=>pd(n[e]))}function UA(n){return!!(Cm(n)||n.variants)}function pL(n,e){if(Cm(n)){const{initial:t,animate:i}=n;return{initial:t===!1||pd(t)?t:void 0,animate:pd(i)?i:void 0}}return n.inherit!==!1?e:{}}function mL(n){const{initial:e,animate:t}=pL(n,q.useContext(Sm));return q.useMemo(()=>({initial:e,animate:t}),[eS(e),eS(t)])}function eS(n){return Array.isArray(n)?n.join(" "):n}const yL=Symbol.for("motionComponentSymbol");function jc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function _L(n,e,t){return q.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):jc(t)&&(t.current=i))},[e])}const Nx=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),vL="framerAppearId",zA="data-"+Nx(vL),{schedule:Dx}=FA(queueMicrotask,!1),BA=q.createContext({});function xL(n,e,t,i,r){var s,o;const{visualElement:l}=q.useContext(Sm),u=q.useContext(VA),h=q.useContext(Tm),f=q.useContext(Rx).reducedMotion,p=q.useRef(null);i=i||u.renderer,!p.current&&i&&(p.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const y=p.current,x=q.useContext(BA);y&&!y.projection&&r&&(y.type==="html"||y.type==="svg")&&wL(p.current,t,r,x);const I=q.useRef(!1);q.useInsertionEffect(()=>{y&&I.current&&y.update(t,h)});const T=t[zA],S=q.useRef(!!T&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,T))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,T)));return LA(()=>{y&&(I.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),Dx.render(y.render),S.current&&y.animationState&&y.animationState.animateChanges())}),q.useEffect(()=>{y&&(!S.current&&y.animationState&&y.animationState.animateChanges(),S.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)===null||b===void 0||b.call(window,T)}),S.current=!1))}),y}function wL(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:GA(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&jc(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function GA(n){if(n)return n.options.allowProjection!==!1?n.projection:GA(n.parent)}function EL({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&uL(n);function l(h,f){let p;const y={...q.useContext(Rx),...h,layoutId:TL(h)},{isStatic:x}=y,I=mL(h),T=i(h,x);if(!x&&Ax){SL();const S=IL(y);p=S.MeasureLayout,I.visualElement=xL(r,T,y,e,S.ProjectionNode)}return _.jsxs(Sm.Provider,{value:I,children:[p&&I.visualElement?_.jsx(p,{visualElement:I.visualElement,...y}):null,t(r,h,_L(T,I.visualElement,f),T,x,I.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=q.forwardRef(l);return u[yL]=r,u}function TL({layoutId:n}){const e=q.useContext(Ix).id;return e&&n!==void 0?e+"-"+n:n}function SL(n,e){q.useContext(VA).strict}function IL(n){const{drag:e,layout:t}=iu;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const CL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Mx(n){return typeof n!="string"||n.includes("-")?!1:!!(CL.indexOf(n)>-1||/[A-Z]/u.test(n))}function tS(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function Lx(n,e,t,i){if(typeof e=="function"){const[r,s]=tS(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=tS(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const sv=n=>Array.isArray(n),RL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),AL=n=>sv(n)?n[n.length-1]||0:n,Ln=n=>!!(n&&n.getVelocity);function op(n){const e=Ln(n)?n.get():n;return RL(e)?e.toValue():e}function bL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:PL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const WA=n=>(e,t)=>{const i=q.useContext(Sm),r=q.useContext(Tm),s=()=>bL(n,e,i,r);return t?s():Cx(s)};function PL(n,e,t,i){const r={},s=i(n,{});for(const y in s)r[y]=op(s[y]);let{initial:o,animate:l}=n;const u=Cm(n),h=UA(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const p=f?l:o;if(p&&typeof p!="boolean"&&!Im(p)){const y=Array.isArray(p)?p:[p];for(let x=0;x<y.length;x++){const I=Lx(n,y[x]);if(I){const{transitionEnd:T,transition:S,...b}=I;for(const D in b){let N=b[D];if(Array.isArray(N)){const L=f?N.length-1:0;N=N[L]}N!==null&&(r[D]=N)}for(const D in T)r[D]=T[D]}}}return r}const bu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],bl=new Set(bu),$A=n=>e=>typeof e=="string"&&e.startsWith(n),HA=$A("--"),kL=$A("var(--"),Ox=n=>kL(n)?NL.test(n.split("/*")[0].trim()):!1,NL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,KA=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Hs=(n,e,t)=>t>e?e:t<n?n:t,Pu={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},md={...Pu,transform:n=>Hs(0,1,n)},Dg={...Pu,default:1},Zd=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Lo=Zd("deg"),is=Zd("%"),Ne=Zd("px"),DL=Zd("vh"),ML=Zd("vw"),nS={...is,parse:n=>is.parse(n)/100,transform:n=>is.transform(n*100)},LL={borderWidth:Ne,borderTopWidth:Ne,borderRightWidth:Ne,borderBottomWidth:Ne,borderLeftWidth:Ne,borderRadius:Ne,radius:Ne,borderTopLeftRadius:Ne,borderTopRightRadius:Ne,borderBottomRightRadius:Ne,borderBottomLeftRadius:Ne,width:Ne,maxWidth:Ne,height:Ne,maxHeight:Ne,top:Ne,right:Ne,bottom:Ne,left:Ne,padding:Ne,paddingTop:Ne,paddingRight:Ne,paddingBottom:Ne,paddingLeft:Ne,margin:Ne,marginTop:Ne,marginRight:Ne,marginBottom:Ne,marginLeft:Ne,backgroundPositionX:Ne,backgroundPositionY:Ne},OL={rotate:Lo,rotateX:Lo,rotateY:Lo,rotateZ:Lo,scale:Dg,scaleX:Dg,scaleY:Dg,scaleZ:Dg,skew:Lo,skewX:Lo,skewY:Lo,distance:Ne,translateX:Ne,translateY:Ne,translateZ:Ne,x:Ne,y:Ne,z:Ne,perspective:Ne,transformPerspective:Ne,opacity:md,originX:nS,originY:nS,originZ:Ne},iS={...Pu,transform:Math.round},Fx={...LL,...OL,zIndex:iS,size:Ne,fillOpacity:md,strokeOpacity:md,numOctaves:iS},FL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},VL=bu.length;function jL(n,e,t){let i="",r=!0;for(let s=0;s<VL;s++){const o=bu[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=KA(l,Fx[o]);if(!u){r=!1;const f=FL[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function Vx(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const u in e){const h=e[u];if(bl.has(u)){o=!0;continue}else if(HA(u)){r[u]=h;continue}else{const f=KA(h,Fx[u]);u.startsWith("origin")?(l=!0,s[u]=f):i[u]=f}}if(e.transform||(o||t?i.transform=jL(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${u} ${h} ${f}`}}const UL={offset:"stroke-dashoffset",array:"stroke-dasharray"},zL={offset:"strokeDashoffset",array:"strokeDasharray"};function BL(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?UL:zL;n[s.offset]=Ne.transform(-i);const o=Ne.transform(e),l=Ne.transform(t);n[s.array]=`${o} ${l}`}function rS(n,e,t){return typeof n=="string"?n:Ne.transform(e+t*n)}function GL(n,e,t){const i=rS(e,n.x,n.width),r=rS(t,n.y,n.height);return`${i} ${r}`}function jx(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...h},f,p){if(Vx(n,h,p),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:y,style:x,dimensions:I}=n;y.transform&&(I&&(x.transform=y.transform),delete y.transform),I&&(r!==void 0||s!==void 0||x.transform)&&(x.transformOrigin=GL(I,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(y.x=e),t!==void 0&&(y.y=t),i!==void 0&&(y.scale=i),o!==void 0&&BL(y,o,l,u,!1)}const Ux=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),qA=()=>({...Ux(),attrs:{}}),zx=n=>typeof n=="string"&&n.toLowerCase()==="svg";function XA(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const YA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function ZA(n,e,t,i){XA(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(YA.has(r)?r:Nx(r),e.attrs[r])}const Cp={};function WL(n){Object.assign(Cp,n)}function QA(n,{layout:e,layoutId:t}){return bl.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Cp[n]||n==="opacity")}function Bx(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(Ln(r[o])||e.style&&Ln(e.style[o])||QA(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function JA(n,e,t){const i=Bx(n,e,t);for(const r in n)if(Ln(n[r])||Ln(e[r])){const s=bu.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function $L(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const sS=["x","y","width","height","cx","cy","r"],HL={useVisualState:WA({scrapeMotionValuesFromProps:JA,createRenderState:qA,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(bl.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<sS.length;l++){const u=sS[l];n[u]!==e[u]&&(o=!0)}o&&Et.read(()=>{$L(t,i),Et.render(()=>{jx(i,r,zx(t.tagName),n.transformTemplate),ZA(t,i)})})}})},KL={useVisualState:WA({scrapeMotionValuesFromProps:Bx,createRenderState:Ux})};function eb(n,e,t){for(const i in e)!Ln(e[i])&&!QA(i,t)&&(n[i]=e[i])}function qL({transformTemplate:n},e){return q.useMemo(()=>{const t=Ux();return Vx(t,e,n),Object.assign({},t.vars,t.style)},[e])}function XL(n,e){const t=n.style||{},i={};return eb(i,t,n),Object.assign(i,qL(n,e)),i}function YL(n,e){const t={},i=XL(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function ZL(n,e,t,i){const r=q.useMemo(()=>{const s=qA();return jx(s,e,zx(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};eb(s,n.style,n),r.style={...s,...r.style}}return r}function QL(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(Mx(t)?ZL:YL)(i,s,o,t),h=fL(i,typeof t=="string",n),f=t!==q.Fragment?{...h,...u,ref:r}:{},{children:p}=i,y=q.useMemo(()=>Ln(p)?p.get():p,[p]);return q.createElement(t,{...f,children:y})}}function JL(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...Mx(i)?HL:KL,preloadedFeatures:n,useRender:QL(r),createVisualElement:e,Component:i};return EL(o)}}function tb(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function Rm(n,e,t){const i=n.getProps();return Lx(i,e,t!==void 0?t:i.custom,n)}const eO=bx(()=>window.ScrollTimeline!==void 0);class tO{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(eO()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class nO extends tO{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Gx(n,e){return n?n[e]||n.default||n:void 0}const ov=2e4;function nb(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<ov;)e+=t,i=n.next(e);return e>=ov?1/0:e}function Wx(n){return typeof n=="function"}function oS(n,e){n.timeline=e,n.onfinish=null}const $x=n=>Array.isArray(n)&&typeof n[0]=="number",iO={linearEasing:void 0};function rO(n,e){const t=bx(n);return()=>{var i;return(i=iO[e])!==null&&i!==void 0?i:t()}}const Rp=rO(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ib=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(nu(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function rb(n){return!!(typeof n=="function"&&Rp()||!n||typeof n=="string"&&(n in av||Rp())||$x(n)||Array.isArray(n)&&n.every(rb))}const jh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,av={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:jh([0,.65,.55,1]),circOut:jh([.55,0,1,.45]),backIn:jh([.31,.01,.66,-.59]),backOut:jh([.33,1.53,.69,.99])};function sb(n,e){if(n)return typeof n=="function"&&Rp()?ib(n,e):$x(n)?jh(n):Array.isArray(n)?n.map(t=>sb(t,e)||av.easeOut):av[n]}const dr={x:!1,y:!1};function ob(){return dr.x||dr.y}function sO(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function ab(n,e){const t=sO(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function aS(n){return e=>{e.pointerType==="touch"||ob()||n(e)}}function oO(n,e,t={}){const[i,r,s]=ab(n,t),o=aS(l=>{const{target:u}=l,h=e(l);if(typeof h!="function"||!u)return;const f=aS(p=>{h(p),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const lb=(n,e)=>e?n===e?!0:lb(n,e.parentElement):!1,Hx=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,aO=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function lO(n){return aO.has(n.tagName)||n.tabIndex!==-1}const Uh=new WeakSet;function lS(n){return e=>{e.key==="Enter"&&n(e)}}function Z0(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const cO=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=lS(()=>{if(Uh.has(t))return;Z0(t,"down");const r=lS(()=>{Z0(t,"up")}),s=()=>Z0(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function cS(n){return Hx(n)&&!ob()}function uO(n,e,t={}){const[i,r,s]=ab(n,t),o=l=>{const u=l.currentTarget;if(!cS(l)||Uh.has(u))return;Uh.add(u);const h=e(l),f=(x,I)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",y),!(!cS(x)||!Uh.has(u))&&(Uh.delete(u),typeof h=="function"&&h(x,{success:I}))},p=x=>{f(x,t.useGlobalTarget||lb(u,x.target))},y=x=>{f(x,!1)};window.addEventListener("pointerup",p,r),window.addEventListener("pointercancel",y,r)};return i.forEach(l=>{!lO(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>cO(h,r),r)}),s}function hO(n){return n==="x"||n==="y"?dr[n]?null:(dr[n]=!0,()=>{dr[n]=!1}):dr.x||dr.y?null:(dr.x=dr.y=!0,()=>{dr.x=dr.y=!1})}const cb=new Set(["width","height","top","left","right","bottom",...bu]);let ap;function dO(){ap=void 0}const rs={now:()=>(ap===void 0&&rs.set(xn.isProcessing||aL.useManualTiming?xn.timestamp:performance.now()),ap),set:n=>{ap=n,queueMicrotask(dO)}};function Kx(n,e){n.indexOf(e)===-1&&n.push(e)}function qx(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class Xx{constructor(){this.subscriptions=[]}add(e){return Kx(this.subscriptions,e),()=>qx(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function ub(n,e){return e?n*(1e3/e):0}const uS=30,fO=n=>!isNaN(parseFloat(n));class gO{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=rs.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=rs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=fO(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Xx);const i=this.events[e].add(t);return e==="change"?()=>{i(),Et.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=rs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>uS)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,uS);return ub(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function yd(n,e){return new gO(n,e)}function pO(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,yd(t))}function mO(n,e){const t=Rm(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=AL(s[o]);pO(n,o,l)}}function yO(n){return!!(Ln(n)&&n.add)}function lv(n,e){const t=n.getValue("willChange");if(yO(t))return t.add(e)}function hb(n){return n.props[zA]}const db=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,_O=1e-7,vO=12;function xO(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=db(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>_O&&++l<vO);return o}function Qd(n,e,t,i){if(n===e&&t===i)return Ii;const r=s=>xO(s,0,1,n,t);return s=>s===0||s===1?s:db(r(s),e,i)}const fb=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,gb=n=>e=>1-n(1-e),pb=Qd(.33,1.53,.69,.99),Yx=gb(pb),mb=fb(Yx),yb=n=>(n*=2)<1?.5*Yx(n):.5*(2-Math.pow(2,-10*(n-1))),Zx=n=>1-Math.sin(Math.acos(n)),_b=gb(Zx),vb=fb(Zx),xb=n=>/^0[^.\s]+$/u.test(n);function wO(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||xb(n):!0}const Zh=n=>Math.round(n*1e5)/1e5,Qx=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function EO(n){return n==null}const TO=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Jx=(n,e)=>t=>!!(typeof t=="string"&&TO.test(t)&&t.startsWith(n)||e&&!EO(t)&&Object.prototype.hasOwnProperty.call(t,e)),wb=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(Qx);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},SO=n=>Hs(0,255,n),Q0={...Pu,transform:n=>Math.round(SO(n))},Ya={test:Jx("rgb","red"),parse:wb("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+Q0.transform(n)+", "+Q0.transform(e)+", "+Q0.transform(t)+", "+Zh(md.transform(i))+")"};function IO(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const cv={test:Jx("#"),parse:IO,transform:Ya.transform},Uc={test:Jx("hsl","hue"),parse:wb("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+is.transform(Zh(e))+", "+is.transform(Zh(t))+", "+Zh(md.transform(i))+")"},Dn={test:n=>Ya.test(n)||cv.test(n)||Uc.test(n),parse:n=>Ya.test(n)?Ya.parse(n):Uc.test(n)?Uc.parse(n):cv.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Ya.transform(n):Uc.transform(n)},CO=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function RO(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(Qx))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(CO))===null||t===void 0?void 0:t.length)||0)>0}const Eb="number",Tb="color",AO="var",bO="var(",hS="${}",PO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function _d(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(PO,u=>(Dn.test(u)?(i.color.push(s),r.push(Tb),t.push(Dn.parse(u))):u.startsWith(bO)?(i.var.push(s),r.push(AO),t.push(u)):(i.number.push(s),r.push(Eb),t.push(parseFloat(u))),++s,hS)).split(hS);return{values:t,split:l,indexes:i,types:r}}function Sb(n){return _d(n).values}function Ib(n){const{split:e,types:t}=_d(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===Eb?s+=Zh(r[o]):l===Tb?s+=Dn.transform(r[o]):s+=r[o]}return s}}const kO=n=>typeof n=="number"?0:n;function NO(n){const e=Sb(n);return Ib(n)(e.map(kO))}const ea={test:RO,parse:Sb,createTransformer:Ib,getAnimatableNone:NO},DO=new Set(["brightness","contrast","saturate","opacity"]);function MO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(Qx)||[];if(!i)return n;const r=t.replace(i,"");let s=DO.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const LO=/\b([a-z-]*)\(.*?\)/gu,uv={...ea,getAnimatableNone:n=>{const e=n.match(LO);return e?e.map(MO).join(" "):n}},OO={...Fx,color:Dn,backgroundColor:Dn,outlineColor:Dn,fill:Dn,stroke:Dn,borderColor:Dn,borderTopColor:Dn,borderRightColor:Dn,borderBottomColor:Dn,borderLeftColor:Dn,filter:uv,WebkitFilter:uv},e1=n=>OO[n];function Cb(n,e){let t=e1(n);return t!==uv&&(t=ea),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const FO=new Set(["auto","none","0"]);function VO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!FO.has(s)&&_d(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=Cb(t,r)}const dS=n=>n===Pu||n===Ne,fS=(n,e)=>parseFloat(n.split(", ")[e]),gS=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return fS(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?fS(s[1],n):0}},jO=new Set(["x","y","z"]),UO=bu.filter(n=>!jO.has(n));function zO(n){const e=[];return UO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const ru={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:gS(4,13),y:gS(5,14)};ru.translateX=ru.x;ru.translateY=ru.y;const rl=new Set;let hv=!1,dv=!1;function Rb(){if(dv){const n=Array.from(rl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=zO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}dv=!1,hv=!1,rl.forEach(n=>n.complete()),rl.clear()}function Ab(){rl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(dv=!0)})}function BO(){Ab(),Rb()}class t1{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(rl.add(this),hv||(hv=!0,Et.read(Ab),Et.resolveKeyframes(Rb))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),rl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,rl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const bb=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),GO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function WO(n){const e=GO.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function Pb(n,e,t=1){const[i,r]=WO(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return bb(o)?parseFloat(o):o}return Ox(r)?Pb(r,e,t+1):r}const kb=n=>e=>e.test(n),$O={test:n=>n==="auto",parse:n=>n},Nb=[Pu,Ne,is,Lo,ML,DL,$O],pS=n=>Nb.find(kb(n));class Db extends t1{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),Ox(h))){const f=Pb(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!cb.has(i)||e.length!==2)return;const[r,s]=e,o=pS(r),l=pS(s);if(o!==l)if(dS(o)&&dS(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)wO(e[r])&&i.push(r);i.length&&VO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ru[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=ru[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const mS=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ea.test(n)||n==="0")&&!n.startsWith("url("));function HO(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function KO(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=mS(r,e),l=mS(s,e);return!o||!l?!1:HO(n)||(t==="spring"||Wx(t))&&i}const qO=n=>n!==null;function Am(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(qO),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const XO=40;class Mb{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=rs.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>XO?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&BO(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=rs.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:u,isGenerator:h}=this.options;if(!h&&!KO(e,i,r,s))if(o)this.options.duration=0;else{u&&u(Am(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const kt=(n,e,t)=>n+(e-n)*t;function J0(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function YO({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;r=J0(u,l,n+1/3),s=J0(u,l,n),o=J0(u,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Ap(n,e){return t=>t>0?e:n}const e_=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},ZO=[cv,Ya,Uc],QO=n=>ZO.find(e=>e.test(n));function yS(n){const e=QO(n);if(!e)return!1;let t=e.parse(n);return e===Uc&&(t=YO(t)),t}const _S=(n,e)=>{const t=yS(n),i=yS(e);if(!t||!i)return Ap(n,e);const r={...t};return s=>(r.red=e_(t.red,i.red,s),r.green=e_(t.green,i.green,s),r.blue=e_(t.blue,i.blue,s),r.alpha=kt(t.alpha,i.alpha,s),Ya.transform(r))},JO=(n,e)=>t=>e(n(t)),Jd=(...n)=>n.reduce(JO),fv=new Set(["none","hidden"]);function eF(n,e){return fv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function tF(n,e){return t=>kt(n,e,t)}function n1(n){return typeof n=="number"?tF:typeof n=="string"?Ox(n)?Ap:Dn.test(n)?_S:rF:Array.isArray(n)?Lb:typeof n=="object"?Dn.test(n)?_S:nF:Ap}function Lb(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>n1(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function nF(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=n1(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function iF(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],u=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const rF=(n,e)=>{const t=ea.createTransformer(e),i=_d(n),r=_d(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?fv.has(n)&&!r.values.length||fv.has(e)&&!i.values.length?eF(n,e):Jd(Lb(iF(i,r),r.values),t):Ap(n,e)};function Ob(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?kt(n,e,t):n1(n)(n,e)}const sF=5;function Fb(n,e,t){const i=Math.max(e-sF,0);return ub(t-n(i),e-i)}const Lt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},t_=.001;function oF({duration:n=Lt.duration,bounce:e=Lt.bounce,velocity:t=Lt.velocity,mass:i=Lt.mass}){let r,s,o=1-e;o=Hs(Lt.minDamping,Lt.maxDamping,o),n=Hs(Lt.minDuration,Lt.maxDuration,zs(n)),o<1?(r=h=>{const f=h*o,p=f*n,y=f-t,x=gv(h,o),I=Math.exp(-p);return t_-y/x*I},s=h=>{const p=h*o*n,y=p*t+t,x=Math.pow(o,2)*Math.pow(h,2)*n,I=Math.exp(-p),T=gv(Math.pow(h,2),o);return(-r(h)+t_>0?-1:1)*((y-x)*I)/T}):(r=h=>{const f=Math.exp(-h*n),p=(h-t)*n+1;return-t_+f*p},s=h=>{const f=Math.exp(-h*n),p=(t-h)*(n*n);return f*p});const l=5/n,u=lF(r,s,l);if(n=Us(n),isNaN(u))return{stiffness:Lt.stiffness,damping:Lt.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const aF=12;function lF(n,e,t){let i=t;for(let r=1;r<aF;r++)i=i-n(i)/e(i);return i}function gv(n,e){return n*Math.sqrt(1-e*e)}const cF=["duration","bounce"],uF=["stiffness","damping","mass"];function vS(n,e){return e.some(t=>n[t]!==void 0)}function hF(n){let e={velocity:Lt.velocity,stiffness:Lt.stiffness,damping:Lt.damping,mass:Lt.mass,isResolvedFromDuration:!1,...n};if(!vS(n,uF)&&vS(n,cF))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Hs(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Lt.mass,stiffness:r,damping:s}}else{const t=oF(n);e={...e,...t,mass:Lt.mass},e.isResolvedFromDuration=!0}return e}function Vb(n=Lt.visualDuration,e=Lt.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:p,velocity:y,isResolvedFromDuration:x}=hF({...t,velocity:-zs(t.velocity||0)}),I=y||0,T=h/(2*Math.sqrt(u*f)),S=o-s,b=zs(Math.sqrt(u/f)),D=Math.abs(S)<5;i||(i=D?Lt.restSpeed.granular:Lt.restSpeed.default),r||(r=D?Lt.restDelta.granular:Lt.restDelta.default);let N;if(T<1){const F=gv(b,T);N=G=>{const k=Math.exp(-T*b*G);return o-k*((I+T*b*S)/F*Math.sin(F*G)+S*Math.cos(F*G))}}else if(T===1)N=F=>o-Math.exp(-b*F)*(S+(I+b*S)*F);else{const F=b*Math.sqrt(T*T-1);N=G=>{const k=Math.exp(-T*b*G),R=Math.min(F*G,300);return o-k*((I+T*b*S)*Math.sinh(R)+F*S*Math.cosh(R))/F}}const L={calculatedDuration:x&&p||null,next:F=>{const G=N(F);if(x)l.done=F>=p;else{let k=0;T<1&&(k=F===0?Us(I):Fb(N,F,G));const R=Math.abs(k)<=i,P=Math.abs(o-G)<=r;l.done=R&&P}return l.value=l.done?o:G,l},toString:()=>{const F=Math.min(nb(L),ov),G=ib(k=>L.next(F*k).value,F,30);return F+"ms "+G}};return L}function xS({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:f}){const p=n[0],y={done:!1,value:p},x=R=>l!==void 0&&R<l||u!==void 0&&R>u,I=R=>l===void 0?u:u===void 0||Math.abs(l-R)<Math.abs(u-R)?l:u;let T=t*e;const S=p+T,b=o===void 0?S:o(S);b!==S&&(T=b-p);const D=R=>-T*Math.exp(-R/i),N=R=>b+D(R),L=R=>{const P=D(R),V=N(R);y.done=Math.abs(P)<=h,y.value=y.done?b:V};let F,G;const k=R=>{x(y.value)&&(F=R,G=Vb({keyframes:[y.value,I(y.value)],velocity:Fb(N,R,y.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return k(0),{calculatedDuration:null,next:R=>{let P=!1;return!G&&F===void 0&&(P=!0,L(R),k(R)),F!==void 0&&R>=F?G.next(R-F):(!P&&L(R),y)}}}const dF=Qd(.42,0,1,1),fF=Qd(0,0,.58,1),jb=Qd(.42,0,.58,1),gF=n=>Array.isArray(n)&&typeof n[0]!="number",pF={linear:Ii,easeIn:dF,easeInOut:jb,easeOut:fF,circIn:Zx,circInOut:vb,circOut:_b,backIn:Yx,backInOut:mb,backOut:pb,anticipate:yb},wS=n=>{if($x(n)){OA(n.length===4);const[e,t,i,r]=n;return Qd(e,t,i,r)}else if(typeof n=="string")return pF[n];return n};function mF(n,e,t){const i=[],r=t||Ob,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ii:e;l=Jd(u,l)}i.push(l)}return i}function yF(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(OA(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=mF(e,i,r),u=l.length,h=f=>{if(o&&f<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(f<n[p+1]);p++);const y=nu(n[p],n[p+1],f);return l[p](y)};return t?f=>h(Hs(n[0],n[s-1],f)):h}function _F(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=nu(0,e,i);n.push(kt(t,1,r))}}function vF(n){const e=[0];return _F(e,n.length-1),e}function xF(n,e){return n.map(t=>t*e)}function wF(n,e){return n.map(()=>e||jb).splice(0,n.length-1)}function bp({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=gF(i)?i.map(wS):wS(i),s={done:!1,value:e[0]},o=xF(t&&t.length===e.length?t:vF(e),n),l=yF(o,e,{ease:Array.isArray(r)?r:wF(e,r)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const EF=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Et.update(e,!0),stop:()=>Jo(e),now:()=>xn.isProcessing?xn.timestamp:rs.now()}},TF={decay:xS,inertia:xS,tween:bp,keyframes:bp,spring:Vb},SF=n=>n/100;class i1 extends Mb{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||t1,l=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=Wx(t)?t:TF[t]||bp;let u,h;l!==bp&&typeof e[0]!="number"&&(u=Jd(SF,Ob(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=nb(f));const{calculatedDuration:p}=f,y=p+r,x=y*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:p,resolvedDuration:y,totalDuration:x}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:R}=this.options;return{done:!0,value:R[R.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:p}=i;if(this.startTime===null)return s.next(0);const{delay:y,repeat:x,repeatType:I,repeatDelay:T,onUpdate:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const b=this.currentTime-y*(this.speed>=0?1:-1),D=this.speed>=0?b<0:b>f;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let N=this.currentTime,L=s;if(x){const R=Math.min(this.currentTime,f)/p;let P=Math.floor(R),V=R%1;!V&&R>=1&&(V=1),V===1&&P--,P=Math.min(P,x+1),P%2&&(I==="reverse"?(V=1-V,T&&(V-=T/p)):I==="mirror"&&(L=o)),N=Hs(0,1,V)*p}const F=D?{done:!1,value:u[0]}:L.next(N);l&&(F.value=l(F.value));let{done:G}=F;!D&&h!==null&&(G=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&G);return k&&r!==void 0&&(F.value=Am(u,this.options,r)),S&&S(F.value),k&&this.finish(),F}get duration(){const{resolved:e}=this;return e?zs(e.calculatedDuration):0}get time(){return zs(this.currentTime)}set time(e){e=Us(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=zs(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=EF,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const IF=new Set(["opacity","clipPath","filter","transform"]);function CF(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=sb(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const RF=bx(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Pp=10,AF=2e4;function bF(n){return Wx(n.type)||n.type==="spring"||!rb(n.ease)}function PF(n,e){const t=new i1({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<AF;)i=t.sample(s),r.push(i.value),s+=Pp;return{times:void 0,keyframes:r,duration:s-Pp,ease:"linear"}}const Ub={anticipate:yb,backInOut:mb,circInOut:vb};function kF(n){return n in Ub}class ES extends Mb{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new Db(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:u,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&Rp()&&kF(s)&&(s=Ub[s]),bF(this.options)){const{onComplete:p,onUpdate:y,motionValue:x,element:I,...T}=this.options,S=PF(e,T);e=S.keyframes,e.length===1&&(e[1]=e[0]),i=S.duration,r=S.times,s=S.ease,o="keyframes"}const f=CF(l.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(oS(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:p}=this.options;l.set(Am(e,this.options,t)),p&&p(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return zs(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return zs(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=Us(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Ii;const{animation:i}=t;oS(i,e)}return Ii}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:p,element:y,...x}=this.options,I=new i1({...x,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),T=Us(this.time);h.setWithVelocity(I.sample(T-Pp).value,I.sample(T).value,Pp)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return RF()&&i&&IF.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const NF={type:"spring",stiffness:500,damping:25,restSpeed:10},DF=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),MF={type:"keyframes",duration:.8},LF={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},OF=(n,{keyframes:e})=>e.length>2?MF:bl.has(n)?n.startsWith("scale")?DF(e[1]):NF:LF;function FF({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const r1=(n,e,t,i={},r,s)=>o=>{const l=Gx(i,n)||{},u=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-Us(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:y=>{e.set(y),l.onUpdate&&l.onUpdate(y)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};FF(l)||(f={...f,...OF(n,f)}),f.duration&&(f.duration=Us(f.duration)),f.repeatDelay&&(f.repeatDelay=Us(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(p=!0)),p&&!s&&e.get()!==void 0){const y=Am(f.keyframes,l);if(y!==void 0)return Et.update(()=>{f.onUpdate(y),f.onComplete()}),new nO([])}return!s&&ES.supports(f)?new ES(f):new i1(f)};function VF({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function zb(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...u}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const p in u){const y=n.getValue(p,(s=n.latestValues[p])!==null&&s!==void 0?s:null),x=u[p];if(x===void 0||f&&VF(f,p))continue;const I={delay:t,...Gx(o||{},p)};let T=!1;if(window.MotionHandoffAnimation){const b=hb(n);if(b){const D=window.MotionHandoffAnimation(b,p,Et);D!==null&&(I.startTime=D,T=!0)}}lv(n,p),y.start(r1(p,y,x,n.shouldReduceMotion&&cb.has(p)?{type:!1}:I,n,T));const S=y.animation;S&&h.push(S)}return l&&Promise.all(h).then(()=>{Et.update(()=>{l&&mO(n,l)})}),h}function pv(n,e,t={}){var i;const r=Rm(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(zb(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:p,staggerDirection:y}=s;return jF(n,e,f+h,p,y,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function jF(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(UF).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(pv(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function UF(n,e){return n.sortNodePosition(e)}function zF(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>pv(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=pv(n,e,t);else{const r=typeof e=="function"?Rm(n,e,t.custom):e;i=Promise.all(zb(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const BF=kx.length;function Bb(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?Bb(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<BF;t++){const i=kx[t],r=n.props[i];(pd(r)||r===!1)&&(e[i]=r)}return e}const GF=[...Px].reverse(),WF=Px.length;function $F(n){return e=>Promise.all(e.map(({animation:t,options:i})=>zF(n,t,i)))}function HF(n){let e=$F(n),t=TS(),i=!0;const r=u=>(h,f)=>{var p;const y=Rm(n,f,u==="exit"?(p=n.presenceContext)===null||p===void 0?void 0:p.custom:void 0);if(y){const{transition:x,transitionEnd:I,...T}=y;h={...h,...T,...I}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,f=Bb(n.parent)||{},p=[],y=new Set;let x={},I=1/0;for(let S=0;S<WF;S++){const b=GF[S],D=t[b],N=h[b]!==void 0?h[b]:f[b],L=pd(N),F=b===u?D.isActive:null;F===!1&&(I=S);let G=N===f[b]&&N!==h[b]&&L;if(G&&i&&n.manuallyAnimateOnMount&&(G=!1),D.protectedKeys={...x},!D.isActive&&F===null||!N&&!D.prevProp||Im(N)||typeof N=="boolean")continue;const k=KF(D.prevProp,N);let R=k||b===u&&D.isActive&&!G&&L||S>I&&L,P=!1;const V=Array.isArray(N)?N:[N];let j=V.reduce(r(b),{});F===!1&&(j={});const{prevResolvedValues:B={}}=D,M={...B,...j},se=ue=>{R=!0,y.has(ue)&&(P=!0,y.delete(ue)),D.needsAnimating[ue]=!0;const Q=n.getValue(ue);Q&&(Q.liveStyle=!1)};for(const ue in M){const Q=j[ue],re=B[ue];if(x.hasOwnProperty(ue))continue;let ne=!1;sv(Q)&&sv(re)?ne=!tb(Q,re):ne=Q!==re,ne?Q!=null?se(ue):y.add(ue):Q!==void 0&&y.has(ue)?se(ue):D.protectedKeys[ue]=!0}D.prevProp=N,D.prevResolvedValues=j,D.isActive&&(x={...x,...j}),i&&n.blockInitialAnimation&&(R=!1),R&&(!(G&&k)||P)&&p.push(...V.map(ue=>({animation:ue,options:{type:b}})))}if(y.size){const S={};y.forEach(b=>{const D=n.getBaseTarget(b),N=n.getValue(b);N&&(N.liveStyle=!0),S[b]=D??null}),p.push({animation:S})}let T=!!p.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(T=!1),i=!1,T?e(p):Promise.resolve()}function l(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(y=>{var x;return(x=y.animationState)===null||x===void 0?void 0:x.setActive(u,h)}),t[u].isActive=h;const p=o(u);for(const y in t)t[y].protectedKeys={};return p}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=TS(),i=!0}}}function KF(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!tb(e,n):!1}function Ma(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function TS(){return{animate:Ma(!0),whileInView:Ma(),whileHover:Ma(),whileTap:Ma(),whileDrag:Ma(),whileFocus:Ma(),exit:Ma()}}let oa=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class qF extends oa{constructor(e){super(e),e.animationState||(e.animationState=HF(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Im(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let XF=0;class YF extends oa{constructor(){super(...arguments),this.id=XF++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const ZF={animation:{Feature:qF},exit:{Feature:YF}};function vd(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function ef(n){return{point:{x:n.pageX,y:n.pageY}}}const QF=n=>e=>Hx(e)&&n(e,ef(e));function Qh(n,e,t,i){return vd(n,e,QF(t),i)}const SS=(n,e)=>Math.abs(n-e);function JF(n,e){const t=SS(n.x,e.x),i=SS(n.y,e.y);return Math.sqrt(t**2+i**2)}class Gb{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=i_(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,x=JF(p.offset,{x:0,y:0})>=3;if(!y&&!x)return;const{point:I}=p,{timestamp:T}=xn;this.history.push({...I,timestamp:T});const{onStart:S,onMove:b}=this.handlers;y||(S&&S(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,p)},this.handlePointerMove=(p,y)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=n_(y,this.transformPagePoint),Et.update(this.updatePoint,!0)},this.handlePointerUp=(p,y)=>{this.end();const{onEnd:x,onSessionEnd:I,resumeAnimation:T}=this.handlers;if(this.dragSnapToOrigin&&T&&T(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=i_(p.type==="pointercancel"?this.lastMoveEventInfo:n_(y,this.transformPagePoint),this.history);this.startEvent&&x&&x(p,S),I&&I(p,S)},!Hx(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=ef(e),l=n_(o,this.transformPagePoint),{point:u}=l,{timestamp:h}=xn;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,i_(l,this.history)),this.removeListeners=Jd(Qh(this.contextWindow,"pointermove",this.handlePointerMove),Qh(this.contextWindow,"pointerup",this.handlePointerUp),Qh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Jo(this.updatePoint)}}function n_(n,e){return e?{point:e(n.point)}:n}function IS(n,e){return{x:n.x-e.x,y:n.y-e.y}}function i_({point:n},e){return{point:n,delta:IS(n,Wb(e)),offset:IS(n,eV(e)),velocity:tV(e,.1)}}function eV(n){return n[0]}function Wb(n){return n[n.length-1]}function tV(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=Wb(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>Us(e)));)t--;if(!i)return{x:0,y:0};const s=zs(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const $b=1e-4,nV=1-$b,iV=1+$b,Hb=.01,rV=0-Hb,sV=0+Hb;function Ci(n){return n.max-n.min}function oV(n,e,t){return Math.abs(n-e)<=t}function CS(n,e,t,i=.5){n.origin=i,n.originPoint=kt(e.min,e.max,n.origin),n.scale=Ci(t)/Ci(e),n.translate=kt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=nV&&n.scale<=iV||isNaN(n.scale))&&(n.scale=1),(n.translate>=rV&&n.translate<=sV||isNaN(n.translate))&&(n.translate=0)}function Jh(n,e,t,i){CS(n.x,e.x,t.x,i?i.originX:void 0),CS(n.y,e.y,t.y,i?i.originY:void 0)}function RS(n,e,t){n.min=t.min+e.min,n.max=n.min+Ci(e)}function aV(n,e,t){RS(n.x,e.x,t.x),RS(n.y,e.y,t.y)}function AS(n,e,t){n.min=e.min-t.min,n.max=n.min+Ci(e)}function ed(n,e,t){AS(n.x,e.x,t.x),AS(n.y,e.y,t.y)}function lV(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?kt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?kt(t,n,i.max):Math.min(n,t)),n}function bS(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function cV(n,{top:e,left:t,bottom:i,right:r}){return{x:bS(n.x,t,r),y:bS(n.y,e,i)}}function PS(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function uV(n,e){return{x:PS(n.x,e.x),y:PS(n.y,e.y)}}function hV(n,e){let t=.5;const i=Ci(n),r=Ci(e);return r>i?t=nu(e.min,e.max-i,n.min):i>r&&(t=nu(n.min,n.max-r,e.min)),Hs(0,1,t)}function dV(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const mv=.35;function fV(n=mv){return n===!1?n=0:n===!0&&(n=mv),{x:kS(n,"left","right"),y:kS(n,"top","bottom")}}function kS(n,e,t){return{min:NS(n,e),max:NS(n,t)}}function NS(n,e){return typeof n=="number"?n:n[e]||0}const DS=()=>({translate:0,scale:1,origin:0,originPoint:0}),zc=()=>({x:DS(),y:DS()}),MS=()=>({min:0,max:0}),Ut=()=>({x:MS(),y:MS()});function $i(n){return[n("x"),n("y")]}function Kb({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function gV({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function pV(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function r_(n){return n===void 0||n===1}function yv({scale:n,scaleX:e,scaleY:t}){return!r_(n)||!r_(e)||!r_(t)}function Va(n){return yv(n)||qb(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function qb(n){return LS(n.x)||LS(n.y)}function LS(n){return n&&n!=="0%"}function kp(n,e,t){const i=n-t,r=e*i;return t+r}function OS(n,e,t,i,r){return r!==void 0&&(n=kp(n,r,i)),kp(n,t,i)+e}function _v(n,e=0,t=1,i,r){n.min=OS(n.min,e,t,i,r),n.max=OS(n.max,e,t,i,r)}function Xb(n,{x:e,y:t}){_v(n.x,e.translate,e.scale,e.originPoint),_v(n.y,t.translate,t.scale,t.originPoint)}const FS=.999999999999,VS=1.0000000000001;function mV(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Gc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Xb(n,o)),i&&Va(s.latestValues)&&Gc(n,s.latestValues))}e.x<VS&&e.x>FS&&(e.x=1),e.y<VS&&e.y>FS&&(e.y=1)}function Bc(n,e){n.min=n.min+e,n.max=n.max+e}function jS(n,e,t,i,r=.5){const s=kt(n.min,n.max,r);_v(n,e,t,s,i)}function Gc(n,e){jS(n.x,e.x,e.scaleX,e.scale,e.originX),jS(n.y,e.y,e.scaleY,e.scale,e.originY)}function Yb(n,e){return Kb(pV(n.getBoundingClientRect(),e))}function yV(n,e,t){const i=Yb(n,t),{scroll:r}=e;return r&&(Bc(i.x,r.offset.x),Bc(i.y,r.offset.y)),i}const Zb=({current:n})=>n?n.ownerDocument.defaultView:null,_V=new WeakMap;class vV{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(ef(f).point)},s=(f,p)=>{const{drag:y,dragPropagation:x,onDragStart:I}=this.getProps();if(y&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=hO(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),$i(S=>{let b=this.getAxisMotionValue(S).get()||0;if(is.test(b)){const{projection:D}=this.visualElement;if(D&&D.layout){const N=D.layout.layoutBox[S];N&&(b=Ci(N)*(parseFloat(b)/100))}}this.originPoint[S]=b}),I&&Et.postRender(()=>I(f,p)),lv(this.visualElement,"transform");const{animationState:T}=this.visualElement;T&&T.setActive("whileDrag",!0)},o=(f,p)=>{const{dragPropagation:y,dragDirectionLock:x,onDirectionLock:I,onDrag:T}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:S}=p;if(x&&this.currentDirection===null){this.currentDirection=xV(S),this.currentDirection!==null&&I&&I(this.currentDirection);return}this.updateAxis("x",p.point,S),this.updateAxis("y",p.point,S),this.visualElement.render(),T&&T(f,p)},l=(f,p)=>this.stop(f,p),u=()=>$i(f=>{var p;return this.getAnimationState(f)==="paused"&&((p=this.getAxisMotionValue(f).animation)===null||p===void 0?void 0:p.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new Gb(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:Zb(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Et.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Mg(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=lV(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&jc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=cV(r.layoutBox,t):this.constraints=!1,this.elastic=fV(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&$i(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=dV(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!jc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=yV(i,r.root,this.visualElement.getTransformPagePoint());let o=uV(r.layout.layoutBox,s);if(t){const l=t(gV(o));this.hasMutatedConstraints=!!l,l&&(o=Kb(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=$i(f=>{if(!Mg(f,t,this.currentDirection))return;let p=u&&u[f]||{};o&&(p={min:0,max:0});const y=r?200:1e6,x=r?40:1e7,I={type:"inertia",velocity:i?e[f]:0,bounceStiffness:y,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...s,...p};return this.startAxisValueAnimation(f,I)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return lv(this.visualElement,e),i.start(r1(e,i,0,t,this.visualElement,!1))}stopAnimation(){$i(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){$i(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){$i(t=>{const{drag:i}=this.getProps();if(!Mg(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-kt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!jc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};$i(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();r[o]=hV({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),$i(o=>{if(!Mg(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(kt(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;_V.set(this.visualElement,this);const e=this.visualElement.current,t=Qh(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();jc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Et.read(i);const o=vd(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&($i(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=u[f].translate,p.set(p.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=mv,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function Mg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function xV(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class wV extends oa{constructor(e){super(e),this.removeGroupControls=Ii,this.removeListeners=Ii,this.controls=new vV(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ii}unmount(){this.removeGroupControls(),this.removeListeners()}}const US=n=>(e,t)=>{n&&Et.postRender(()=>n(e,t))};class EV extends oa{constructor(){super(...arguments),this.removePointerDownListener=Ii}onPointerDown(e){this.session=new Gb(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Zb(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:US(e),onStart:US(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Et.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Qh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const lp={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function zS(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Ih={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ne.test(n))n=parseFloat(n);else return n;const t=zS(n,e.target.x),i=zS(n,e.target.y);return`${t}% ${i}%`}},TV={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=ea.parse(n);if(r.length>5)return i;const s=ea.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=u;const h=kt(l,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class SV extends q.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;WL(IV),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),lp.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Et.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Dx.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Qb(n){const[e,t]=MA(),i=q.useContext(Ix);return _.jsx(SV,{...n,layoutGroup:i,switchLayoutGroup:q.useContext(BA),isPresent:e,safeToRemove:t})}const IV={borderRadius:{...Ih,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ih,borderTopRightRadius:Ih,borderBottomLeftRadius:Ih,borderBottomRightRadius:Ih,boxShadow:TV};function CV(n,e,t){const i=Ln(n)?n:yd(n);return i.start(r1("",i,e,t)),i.animation}function RV(n){return n instanceof SVGElement&&n.tagName!=="svg"}const AV=(n,e)=>n.depth-e.depth;class bV{constructor(){this.children=[],this.isDirty=!1}add(e){Kx(this.children,e),this.isDirty=!0}remove(e){qx(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(AV),this.isDirty=!1,this.children.forEach(e)}}function PV(n,e){const t=rs.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Jo(i),n(s-e))};return Et.read(i,!0),()=>Jo(i)}const Jb=["TopLeft","TopRight","BottomLeft","BottomRight"],kV=Jb.length,BS=n=>typeof n=="string"?parseFloat(n):n,GS=n=>typeof n=="number"||Ne.test(n);function NV(n,e,t,i,r,s){r?(n.opacity=kt(0,t.opacity!==void 0?t.opacity:1,DV(i)),n.opacityExit=kt(e.opacity!==void 0?e.opacity:1,0,MV(i))):s&&(n.opacity=kt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<kV;o++){const l=`border${Jb[o]}Radius`;let u=WS(e,l),h=WS(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||GS(u)===GS(h)?(n[l]=Math.max(kt(BS(u),BS(h),i),0),(is.test(h)||is.test(u))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=kt(e.rotate||0,t.rotate||0,i))}function WS(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const DV=e2(0,.5,_b),MV=e2(.5,.95,Ii);function e2(n,e,t){return i=>i<n?0:i>e?1:t(nu(n,e,i))}function $S(n,e){n.min=e.min,n.max=e.max}function Gi(n,e){$S(n.x,e.x),$S(n.y,e.y)}function HS(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function KS(n,e,t,i,r){return n-=e,n=kp(n,1/t,i),r!==void 0&&(n=kp(n,1/r,i)),n}function LV(n,e=0,t=1,i=.5,r,s=n,o=n){if(is.test(e)&&(e=parseFloat(e),e=kt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=kt(s.min,s.max,i);n===s&&(l-=e),n.min=KS(n.min,e,t,l,r),n.max=KS(n.max,e,t,l,r)}function qS(n,e,[t,i,r],s,o){LV(n,e[t],e[i],e[r],e.scale,s,o)}const OV=["x","scaleX","originX"],FV=["y","scaleY","originY"];function XS(n,e,t,i){qS(n.x,e,OV,t?t.x:void 0,i?i.x:void 0),qS(n.y,e,FV,t?t.y:void 0,i?i.y:void 0)}function YS(n){return n.translate===0&&n.scale===1}function t2(n){return YS(n.x)&&YS(n.y)}function ZS(n,e){return n.min===e.min&&n.max===e.max}function VV(n,e){return ZS(n.x,e.x)&&ZS(n.y,e.y)}function QS(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function n2(n,e){return QS(n.x,e.x)&&QS(n.y,e.y)}function JS(n){return Ci(n.x)/Ci(n.y)}function eI(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class jV{constructor(){this.members=[]}add(e){Kx(this.members,e),e.scheduleRender()}remove(e){if(qx(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function UV(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:p,rotateY:y,skewX:x,skewY:I}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),p&&(i+=`rotateX(${p}deg) `),y&&(i+=`rotateY(${y}deg) `),x&&(i+=`skewX(${x}deg) `),I&&(i+=`skewY(${I}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(i+=`scale(${l}, ${u})`),i||"none"}const ja={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},zh=typeof window<"u"&&window.MotionDebug!==void 0,s_=["","X","Y","Z"],zV={visibility:"hidden"},tI=1e3;let BV=0;function o_(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function i2(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=hb(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Et,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&i2(i)}function r2({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=BV++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,zh&&(ja.totalNodes=ja.resolvedTargetDeltas=ja.recalculatedProjection=0),this.nodes.forEach($V),this.nodes.forEach(YV),this.nodes.forEach(ZV),this.nodes.forEach(HV),zh&&window.MotionDebug.record(ja)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new bV)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Xx),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=RV(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||u)&&(this.isLayoutDirty=!0),n){let p;const y=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=PV(y,250),lp.hasAnimatedSinceResize&&(lp.hasAnimatedSinceResize=!1,this.nodes.forEach(iI))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:y,hasRelativeTargetChanged:x,layout:I})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const T=this.options.transition||f.getDefaultTransition()||n5,{onLayoutAnimationStart:S,onLayoutAnimationComplete:b}=f.getProps(),D=!this.targetLayout||!n2(this.targetLayout,I)||x,N=!y&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||N||y&&(D||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,N);const L={...Gx(T,"layout"),onPlay:S,onComplete:b};(f.shouldReduceMotion||this.options.layoutRoot)&&(L.delay=0,L.type=!1),this.startAnimation(L)}else y||iI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=I})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Jo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(QV),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&i2(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(nI);return}this.isUpdating||this.nodes.forEach(qV),this.isUpdating=!1,this.nodes.forEach(XV),this.nodes.forEach(GV),this.nodes.forEach(WV),this.clearAllSnapshots();const l=rs.now();xn.delta=Hs(0,1e3/60,l-xn.timestamp),xn.timestamp=l,xn.isProcessing=!0,Y0.update.process(xn),Y0.preRender.process(xn),Y0.render.process(xn),xn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Dx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(KV),this.sharedNodes.forEach(JV)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Et.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Et.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!t2(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||Va(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),i5(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(r5))){const{scroll:f}=this.root;f&&(Bc(u.x,f.offset.x),Bc(u.y,f.offset.y))}return u}removeElementScroll(o){var l;const u=Ut();if(Gi(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:p,options:y}=f;f!==this.root&&p&&y.layoutScroll&&(p.wasRoot&&Gi(u,o),Bc(u.x,p.offset.x),Bc(u.y,p.offset.y))}return u}applyTransform(o,l=!1){const u=Ut();Gi(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Gc(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Va(f.latestValues)&&Gc(u,f.latestValues)}return Va(this.latestValues)&&Gc(u,this.latestValues),u}removeTransform(o){const l=Ut();Gi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Va(h.latestValues))continue;yv(h.latestValues)&&h.updateSnapshot();const f=Ut(),p=h.measurePageBox();Gi(f,p),XS(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return Va(this.latestValues)&&XS(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==xn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:y}=this.options;if(!(!this.layout||!(p||y))){if(this.resolvedRelativeTargetAt=xn.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),ed(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),Gi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),aV(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Gi(this.target,this.layout.layoutBox),Xb(this.target,this.targetDelta)):Gi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),ed(this.relativeTargetOrigin,this.target,x.target),Gi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}zh&&ja.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||yv(this.parent.latestValues)||qb(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===xn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;Gi(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,x=this.treeScale.y;mV(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:I}=l;if(!I){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(HS(this.prevProjectionDelta.x,this.projectionDelta.x),HS(this.prevProjectionDelta.y,this.projectionDelta.y)),Jh(this.projectionDelta,this.layoutCorrected,I,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==x||!eI(this.projectionDelta.x,this.prevProjectionDelta.x)||!eI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",I)),zh&&ja.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=zc(),this.projectionDelta=zc(),this.projectionDeltaWithTransform=zc()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},p=zc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const y=Ut(),x=u?u.source:void 0,I=this.layout?this.layout.source:void 0,T=x!==I,S=this.getStack(),b=!S||S.members.length<=1,D=!!(T&&!b&&this.options.crossfade===!0&&!this.path.some(t5));this.animationProgress=0;let N;this.mixTargetDelta=L=>{const F=L/1e3;rI(p.x,o.x,F),rI(p.y,o.y,F),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ed(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),e5(this.relativeTarget,this.relativeTargetOrigin,y,F),N&&VV(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=Ut()),Gi(N,this.relativeTarget)),T&&(this.animationValues=f,NV(f,h,this.latestValues,F,D,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Jo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Et.update(()=>{lp.hasAnimatedSinceResize=!0,this.currentAnimation=CV(0,tI,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(tI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:f}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&s2(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Ut();const p=Ci(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const y=Ci(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+y}Gi(l,u),Gc(l,f),Jh(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new jV),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&o_("z",o,h,this.animationValues);for(let f=0;f<s_.length;f++)o_(`rotate${s_[f]}`,o,h,this.animationValues),o_(`skew${s_[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return zV;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=op(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const T={};return this.options.layoutId&&(T.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,T.pointerEvents=op(o?.pointerEvents)||""),this.hasProjected&&!Va(this.latestValues)&&(T.transform=f?f({},""):"none",this.hasProjected=!1),T}const y=p.animationValues||p.latestValues;this.applyTransformsToTarget(),h.transform=UV(this.projectionDeltaWithTransform,this.treeScale,y),f&&(h.transform=f(y,h.transform));const{x,y:I}=this.projectionDelta;h.transformOrigin=`${x.origin*100}% ${I.origin*100}% 0`,p.animationValues?h.opacity=p===this?(u=(l=y.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:h.opacity=p===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const T in Cp){if(y[T]===void 0)continue;const{correct:S,applyTo:b}=Cp[T],D=h.transform==="none"?y[T]:S(y[T],p);if(b){const N=b.length;for(let L=0;L<N;L++)h[b[L]]=D}else h[T]=D}return this.options.layoutId&&(h.pointerEvents=p===this?op(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(nI),this.root.sharedNodes.clear()}}}function GV(n){n.updateLayout()}function WV(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?$i(p=>{const y=o?t.measuredBox[p]:t.layoutBox[p],x=Ci(y);y.min=i[p].min,y.max=y.min+x}):s2(s,t.layoutBox,i)&&$i(p=>{const y=o?t.measuredBox[p]:t.layoutBox[p],x=Ci(i[p]);y.max=y.min+x,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[p].max=n.relativeTarget[p].min+x)});const l=zc();Jh(l,i,t.layoutBox);const u=zc();o?Jh(u,n.applyTransform(r,!0),t.measuredBox):Jh(u,i,t.layoutBox);const h=!t2(l);let f=!1;if(!n.resumeFrom){const p=n.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:y,layout:x}=p;if(y&&x){const I=Ut();ed(I,t.layoutBox,y.layoutBox);const T=Ut();ed(T,i,x.layoutBox),n2(I,T)||(f=!0),p.options.layoutRoot&&(n.relativeTarget=T,n.relativeTargetOrigin=I,n.relativeParent=p)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function $V(n){zh&&ja.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function HV(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function KV(n){n.clearSnapshot()}function nI(n){n.clearMeasurements()}function qV(n){n.isLayoutDirty=!1}function XV(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function iI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function YV(n){n.resolveTargetDelta()}function ZV(n){n.calcProjection()}function QV(n){n.resetSkewAndRotation()}function JV(n){n.removeLeadSnapshot()}function rI(n,e,t){n.translate=kt(e.translate,0,t),n.scale=kt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function sI(n,e,t,i){n.min=kt(e.min,t.min,i),n.max=kt(e.max,t.max,i)}function e5(n,e,t,i){sI(n.x,e.x,t.x,i),sI(n.y,e.y,t.y,i)}function t5(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const n5={duration:.45,ease:[.4,0,.1,1]},oI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),aI=oI("applewebkit/")&&!oI("chrome/")?Math.round:Ii;function lI(n){n.min=aI(n.min),n.max=aI(n.max)}function i5(n){lI(n.x),lI(n.y)}function s2(n,e,t){return n==="position"||n==="preserve-aspect"&&!oV(JS(e),JS(t),.2)}function r5(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const s5=r2({attachResizeListener:(n,e)=>vd(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),a_={current:void 0},o2=r2({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!a_.current){const n=new s5({});n.mount(window),n.setOptions({layoutScroll:!0}),a_.current=n}return a_.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),o5={pan:{Feature:EV},drag:{Feature:wV,ProjectionNode:o2,MeasureLayout:Qb}};function cI(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Et.postRender(()=>s(e,ef(e)))}class a5 extends oa{mount(){const{current:e}=this.node;e&&(this.unmount=oO(e,t=>(cI(this.node,t,"Start"),i=>cI(this.node,i,"End"))))}unmount(){}}class l5 extends oa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Jd(vd(this.node.current,"focus",()=>this.onFocus()),vd(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function uI(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Et.postRender(()=>s(e,ef(e)))}class c5 extends oa{mount(){const{current:e}=this.node;e&&(this.unmount=uO(e,t=>(uI(this.node,t,"Start"),(i,{success:r})=>uI(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const vv=new WeakMap,l_=new WeakMap,u5=n=>{const e=vv.get(n.target);e&&e(n)},h5=n=>{n.forEach(u5)};function d5({root:n,...e}){const t=n||document;l_.has(t)||l_.set(t,{});const i=l_.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(h5,{root:n,...e})),i[r]}function f5(n,e,t){const i=d5(e);return vv.set(n,t),i.observe(n),()=>{vv.delete(n),i.unobserve(n)}}const g5={some:0,all:1};class p5 extends oa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:g5[r]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),y=h?f:p;y&&y(u)};return f5(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(m5(e,t))&&this.startObserver()}unmount(){}}function m5({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const y5={inView:{Feature:p5},tap:{Feature:c5},focus:{Feature:l5},hover:{Feature:a5}},_5={layout:{ProjectionNode:o2,MeasureLayout:Qb}},xv={current:null},a2={current:!1};function v5(){if(a2.current=!0,!!Ax)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>xv.current=n.matches;n.addListener(e),e()}else xv.current=!1}const x5=[...Nb,Dn,ea],w5=n=>x5.find(kb(n)),hI=new WeakMap;function E5(n,e,t){for(const i in e){const r=e[i],s=t[i];if(Ln(r))n.addValue(i,r);else if(Ln(s))n.addValue(i,yd(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,yd(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const dI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class T5{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=t1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=rs.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,Et.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=Cm(t),this.isVariantNode=UA(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,...y}=this.scrapeMotionValuesFromProps(t,{},this);for(const x in y){const I=y[x];u[x]!==void 0&&Ln(I)&&I.set(u[x],!1)}}mount(e){this.current=e,hI.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),a2.current||v5(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:xv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){hI.delete(this.current),this.projection&&this.projection.unmount(),Jo(this.notifyUpdate),Jo(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=bl.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Et.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in iu){const t=iu[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<dI.length;i++){const r=dI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=E5(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=yd(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(bb(r)||xb(r))?r=parseFloat(r):!w5(r)&&ea.test(t)&&(r=Cb(e,t)),this.setBaseTarget(e,Ln(r)?r.get():r)),Ln(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=Lx(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ln(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new Xx),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class l2 extends T5{constructor(){super(...arguments),this.KeyframeResolver=Db}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ln(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function S5(n){return window.getComputedStyle(n)}class I5 extends l2{constructor(){super(...arguments),this.type="html",this.renderInstance=XA}readValueFromInstance(e,t){if(bl.has(t)){const i=e1(t);return i&&i.default||0}else{const i=S5(e),r=(HA(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return Yb(e,t)}build(e,t,i){Vx(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return Bx(e,t,i)}}class C5 extends l2{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(bl.has(t)){const i=e1(t);return i&&i.default||0}return t=YA.has(t)?t:Nx(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return JA(e,t,i)}build(e,t,i){jx(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){ZA(e,t,i,r)}mount(e){this.isSVGTag=zx(e.tagName),super.mount(e)}}const R5=(n,e)=>Mx(n)?new C5(e):new I5(e,{allowProjection:n!==q.Fragment}),A5=JL({...ZF,...y5,...o5,..._5},R5),Ge=gL(A5),ei={ADD:"add",REMOVE:"remove"},su={PROPERTYCHANGE:"propertychange"},Be={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class bm{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function b5(n,e,t){let i,r;t=t||Bs;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function Bs(n,e){return n>e?1:n<e?-1:0}function P5(n,e){return n<e?1:n>e?-1:0}function s1(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function k5(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function o1(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function aa(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function N5(n,e,t){const i=e||Bs;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function xd(){return!0}function Pm(){return!1}function wd(){}function c2(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!aa(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function D5(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function tf(n){for(const e in n)delete n[e]}function ou(n){let e;for(e in n)return!1;return!e}class Zs{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class km extends bm{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Zs(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let u;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,wd);delete o[i]}return u}disposeInternal(){this.listeners_&&tf(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=wd,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function nt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Np(n,e,t,i){return nt(n,e,t,i,!0)}function Rt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),tf(n))}class nf extends km{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Be.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=nt(this,e[s],t);return r}return nt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Np(this,e[s],t)}else i=Np(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)M5(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}nf.prototype.on;nf.prototype.once;nf.prototype.un;function M5(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Rt(n[e]);else Rt(n)}function tt(){throw new Error("Unimplemented abstract method.")}let L5=0;function it(n){return n.ol_uid||(n.ol_uid=String(++L5))}class fI extends Zs{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class us extends nf{constructor(e){super(),this.on,this.once,this.un,it(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new fI(i,e,t)),i=su.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new fI(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],ou(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const gI={LENGTH:"length"};class Lg extends Zs{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Ki extends us{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(gI.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Lg(ei.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Lg(ei.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Lg(ei.REMOVE,r,e)),this.dispatchEvent(new Lg(ei.ADD,t,e))}updateLength_(){this.set(gI.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function at(n,e){if(!n)throw new Error(e)}class au extends us{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new au(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Rt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=nt(e,Be.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?O5(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function O5(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(at(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const an={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function pI(n){const e=Qi();for(let t=0,i=n.length;t<i;++t)td(e,n[t]);return e}function a1(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function u2(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function h2(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function lu(n,e){return d2(n,e[0],e[1])}function Bh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function d2(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function wv(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let u=an.UNKNOWN;return o<t?u=u|an.LEFT:o>r&&(u=u|an.RIGHT),l<i?u=u|an.BELOW:l>s&&(u=u|an.ABOVE),u===an.UNKNOWN&&(u=an.INTERSECTING),u}function Qi(){return[1/0,1/0,-1/0,-1/0]}function ta(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Nm(n){return ta(1/0,1/0,-1/0,-1/0,n)}function f2(n,e){const t=n[0],i=n[1];return ta(t,i,t,i,e)}function l1(n,e,t,i,r){const s=Nm(r);return g2(s,n,e,t,i)}function Ed(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function F5(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function td(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function g2(n,e,t,i,r){for(;t<i;t+=r)V5(n,e[t],e[t+1]);return n}function V5(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function p2(n,e){let t;return t=e(Dm(n)),t||(t=e(Mm(n)),t)||(t=e(Lm(n)),t)||(t=e(Pl(n)),t)?t:!1}function Ev(n){let e=0;return Om(n)||(e=dt(n)*Bn(n)),e}function Dm(n){return[n[0],n[1]]}function Mm(n){return[n[2],n[1]]}function fl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function j5(n,e){let t;if(e==="bottom-left")t=Dm(n);else if(e==="bottom-right")t=Mm(n);else if(e==="top-left")t=Pl(n);else if(e==="top-right")t=Lm(n);else throw new Error("Invalid corner");return t}function Tv(n,e,t,i,r){const[s,o,l,u,h,f,p,y]=m2(n,e,t,i);return ta(Math.min(s,l,h,p),Math.min(o,u,f,y),Math.max(s,l,h,p),Math.max(o,u,f,y),r)}function m2(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),u=r*o,h=r*l,f=s*o,p=s*l,y=n[0],x=n[1];return[y-u+p,x-h-f,y-u-p,x-h+f,y+u-p,x+h+f,y+u+p,x+h-f,y-u+p,x-h-f]}function Bn(n){return n[3]-n[1]}function sl(n,e,t){const i=t||Qi();return si(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Nm(i),i}function Pl(n){return[n[0],n[3]]}function Lm(n){return[n[2],n[3]]}function dt(n){return n[2]-n[0]}function si(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Om(n){return n[2]<n[0]||n[3]<n[1]}function U5(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function z5(n,e,t){let i=!1;const r=wv(n,e),s=wv(n,t);if(r===an.INTERSECTING||s===an.INTERSECTING)i=!0;else{const o=n[0],l=n[1],u=n[2],h=n[3],f=e[0],p=e[1],y=t[0],x=t[1],I=(x-p)/(y-f);let T,S;s&an.ABOVE&&!(r&an.ABOVE)&&(T=y-(x-h)/I,i=T>=o&&T<=u),!i&&s&an.RIGHT&&!(r&an.RIGHT)&&(S=x-(y-u)*I,i=S>=l&&S<=h),!i&&s&an.BELOW&&!(r&an.BELOW)&&(T=y-(x-l)/I,i=T>=o&&T<=u),!i&&s&an.LEFT&&!(r&an.LEFT)&&(S=x-(y-o)*I,i=S>=l&&S<=h)}return i}function y2(n,e){const t=e.getExtent(),i=fl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=dt(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function _2(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];y2(n,e);const r=dt(i);if(dt(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Nt(n,e,t){return Math.min(Math.max(n,e),t)}function B5(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const u=((n-t)*o+(e-i)*l)/(o*o+l*l);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=l*u)}return Kc(n,e,t,i)}function Kc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function G5(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const u=Math.abs(n[l][i]);u>s&&(s=u,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const u=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function mI(n){return n*180/Math.PI}function Ko(n){return n*Math.PI/180}function ol(n,e){const t=n%e;return t*e<0?t+e:t}function wi(n,e,t){return n+t*(e-n)}function rf(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function _q(n,e){return Math.round(rf(n,e))}function Og(n,e){return Math.floor(rf(n,e))}function Fg(n,e){return Math.ceil(rf(n,e))}function Sv(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function W5(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Dp(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function c1(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function $5(n,e){return n[0]*=e,n[1]*=e,n}function v2(n,e){if(e.canWrapX()){const t=dt(e.getExtent()),i=H5(n,e,t);i&&(n[0]-=i*t)}return n}function H5(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||dt(i),r=Math.floor((n[0]-i[0])/t)),r}function x2(...n){console.warn(...n)}const cu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class u1{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||cu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const sf=6378137,Wc=Math.PI*sf,K5=[-Wc,-Wc,Wc,Wc],q5=[-180,-85,180,85],Vg=sf*Math.log(Math.tan(Math.PI/2));class _c extends u1{constructor(e){super({code:e,units:"m",extent:K5,global:!0,worldExtent:q5,getPointResolution:function(t,i){return t/Math.cosh(i[1]/sf)}})}}const yI=[new _c("EPSG:3857"),new _c("EPSG:102100"),new _c("EPSG:102113"),new _c("EPSG:900913"),new _c("http://www.opengis.net/def/crs/EPSG/0/3857"),new _c("http://www.opengis.net/gml/srs/epsg.xml#3857")];function X5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Wc*n[s]/180;let o=sf*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Vg?o=Vg:o<-Vg&&(o=-Vg),e[s+1]=o}return e}function Y5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Wc,e[s+1]=360*Math.atan(Math.exp(n[s+1]/sf))/Math.PI-90;return e}const Z5=6378137,_I=[-180,-90,180,90],Q5=Math.PI*Z5/180;class La extends u1{constructor(e,t){super({code:e,units:"degrees",extent:_I,axisOrientation:t,global:!0,metersPerUnit:Q5,worldExtent:_I})}}const vI=[new La("CRS:84"),new La("EPSG:4326","neu"),new La("urn:ogc:def:crs:OGC:1.3:CRS84"),new La("urn:ogc:def:crs:OGC:2:84"),new La("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new La("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new La("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Iv={};function J5(n){return Iv[n]||Iv[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function ej(n,e){Iv[n]=e}let qc={};function Td(n,e,t){const i=n.getCode(),r=e.getCode();i in qc||(qc[i]={}),qc[i][r]=t}function c_(n,e){return n in qc&&e in qc[n]?qc[n][e]:null}const Mp=.9996,Yi=.00669438,Fm=Yi*Yi,Vm=Fm*Yi,Za=Yi/(1-Yi),xI=Math.sqrt(1-Yi),uu=(1-xI)/(1+xI),w2=uu*uu,h1=w2*uu,d1=h1*uu,E2=d1*uu,T2=1-Yi/4-3*Fm/64-5*Vm/256,tj=3*Yi/8+3*Fm/32+45*Vm/1024,nj=15*Fm/256+45*Vm/1024,ij=35*Vm/3072,rj=3/2*uu-27/32*h1+269/512*E2,sj=21/16*w2-55/32*d1,oj=151/96*h1-417/128*E2,aj=1097/512*d1,Lp=6378137;function lj(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/Mp/(Lp*T2),l=o+rj*Math.sin(2*o)+sj*Math.sin(4*o)+oj*Math.sin(6*o)+aj*Math.sin(8*o),u=Math.sin(l),h=u*u,f=Math.cos(l),p=u/f,y=p*p,x=y*y,I=1-Yi*h,T=Math.sqrt(1-Yi*h),S=Lp/T,b=(1-Yi)/I,D=Za*f**2,N=D*D,L=i/(S*Mp),F=L*L,G=F*L,k=G*L,R=k*L,P=R*L,V=l-p/b*(F/2-k/24*(5+3*y+10*D-4*N-9*Za))+P/720*(61+90*y+298*D+45*x-252*Za-3*N);let j=(L-G/6*(1+2*y+D)+R/120*(5-2*D+28*y-3*N+8*Za+24*x))/f;return j=Sv(j+Ko(S2(t.number)),-Math.PI,Math.PI),[mI(j),mI(V)]}const wI=-80,EI=84,cj=-180,uj=180;function hj(n,e,t){n=Sv(n,cj,uj),e<wI?e=wI:e>EI&&(e=EI);const i=Ko(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,u=l*l,h=Ko(n),f=S2(t.number),p=Ko(f),y=Lp/Math.sqrt(1-Yi*r**2),x=Za*s**2,I=s*Sv(h-p,-Math.PI,Math.PI),T=I*I,S=T*I,b=S*I,D=b*I,N=D*I,L=Lp*(T2*i-tj*Math.sin(2*i)+nj*Math.sin(4*i)-ij*Math.sin(6*i)),F=Mp*y*(I+S/6*(1-l+x)+D/120*(5-18*l+u+72*x-58*Za))+5e5;let G=Mp*(L+y*o*(T/2+b/24*(5-l+9*x+4*x**2)+N/720*(61-58*l+u+600*x-330*Za)));return t.north||(G+=1e7),[F,G]}function S2(n){return(n-1)*6-180+3}const dj=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function I2(n){let e=0;for(const r of dj){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function TI(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const u=t[l],h=t[l+1],f=n(u,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function fj(n){return I2(n)?new u1({code:n,units:"m"}):null}function gj(n){const e=I2(n.getCode());return e?{forward:TI(hj,e),inverse:TI(lj,e)}:null}const pj=63710088e-1;function SI(n,e,t){t=t||pj;const i=Ko(n[1]),r=Ko(e[1]),s=(r-i)/2,o=Ko(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const mj=[gj],yj=[fj];let Cv=!0;function C2(n){Cv=!1}function f1(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function Rv(n){ej(n.getCode(),n),Td(n,n,f1)}function _j(n){n.forEach(Rv)}function li(n){if(typeof n!="string")return n;const e=J5(n);if(e)return e;for(const t of yj){const i=t(n);if(i)return i}return null}function Op(n,e,t,i){n=li(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/cu[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=p1(n,li("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=SI(h.slice(0,2),h.slice(2,4)),p=SI(h.slice(4,6),h.slice(6,8));r=(f+p)/2}const u=i?cu[i]:n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function II(n){_j(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Td(e,t,f1)})})}function vj(n,e,t,i){n.forEach(function(r){e.forEach(function(s){Td(r,s,t),Td(s,r,i)})})}function g1(n,e){return n?typeof n=="string"?li(n):n:li(e)}function xj(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),u=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=u?e[o+h]:l[h]}return t})}function gl(n,e){return C2(),jm(n,"EPSG:4326","EPSG:3857")}function CI(n,e){const t=jm(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=ol(i+180,360)-180),t}function cp(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||p1(n,e)===f1)&&t}function p1(n,e){const t=n.getCode(),i=e.getCode();let r=c_(t,i);if(r)return r;let s=null,o=null;for(const u of mj)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=u_(s.inverse,o.forward);else{const u=c_(t,l);u&&(r=u_(u,o.forward))}else{const u=c_(l,i);u&&(r=u_(s.inverse,u))}return r&&(Rv(n),Rv(e),Td(n,e,r)),r}function u_(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Fp(n,e){const t=li(n),i=li(e);return p1(t,i)}function jm(n,e,t){const i=Fp(e,t);if(!i){const r=li(e).getCode(),s=li(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Av(n,e){return n}function Ds(n,e){return Cv&&!Dp(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Cv=!1,x2("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function R2(n,e){return n}function Go(n,e){return n}function wj(){II(yI),II(vI),vj(vI,yI,X5,Y5)}wj();new Array(6);function Er(){return[1,0,0,1,0,0]}function Ej(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function un(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Ks(n,e,t,i,r,s,o,l){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-l*i*u+e,n[5]=o*r*u+l*r*h+t,n}function A2(n,e){const t=Tj(e);at(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*l)/t,n[5]=-(i*u-r*l)/t,n}function Tj(n){return n[0]*n[3]-n[1]*n[2]}const Sj=[1e5,1e5,1e5,1e5,2,2];function Ij(n){return"matrix("+n.join(", ")+")"}function bv(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function Cj(n,e){const t=bv(n),i=bv(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*Sj[r])!==0)return!1;return!0}function qo(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let u=e;u<t;u+=i){const h=n[u],f=n[u+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let p=2;p<o;p++)s[l++]=n[u+p]}return s&&s.length!=l&&(s.length=l),s}function b2(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),u=Math.sin(r),h=s[0],f=s[1];let p=0;for(let y=e;y<t;y+=i){const x=n[y]-h,I=n[y+1]-f;o[p++]=h+x*l-I*u,o[p++]=f+x*u+I*l;for(let T=y+2;T<y+i;++T)o[p++]=n[T]}return o&&o.length!=p&&(o.length=p),o}function Rj(n,e,t,i,r,s,o,l){l=l||[];const u=o[0],h=o[1];let f=0;for(let p=e;p<t;p+=i){const y=n[p]-u,x=n[p+1]-h;l[f++]=u+r*y,l[f++]=h+s*x;for(let I=p+2;I<p+i;++I)l[f++]=n[I]}return l&&l.length!=f&&(l.length=f),l}function Aj(n,e,t,i,r,s,o){o=o||[];let l=0;for(let u=e;u<t;u+=i){o[l++]=n[u]+r,o[l++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const RI=Er(),bj=[NaN,NaN];class Pj extends us{constructor(){super(),this.extent_=Qi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=c2((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return tt()}closestPointXY(e,t,i,r){return tt()}containsXY(e,t){return this.closestPointXY(e,t,bj,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return tt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Nm(t),this.extentRevision_=this.getRevision()}return U5(this.extent_,e)}rotate(e,t){tt()}scale(e,t,i){tt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return tt()}getType(){return tt()}applyTransform(e){tt()}intersectsExtent(e){return tt()}translate(e,t){tt()}transform(e,t){const i=li(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const u=i.getExtent(),h=i.getWorldExtent(),f=Bn(h)/Bn(u);Ks(RI,h[0],h[3],f,-f,0,0,0);const p=qo(s,0,s.length,l,RI,o),y=Fp(i,t);return y?y(p,p,l):p}:Fp(i,t);return this.applyTransform(r),this}}class m1 extends Pj{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return l1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return tt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=AI(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){tt()}setLayout(e,t,i){let r;if(e)r=AI(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=kj(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();b2(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=fl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Rj(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Aj(i,0,i.length,r,e,t,i),this.changed()}}}function kj(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function AI(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function Nj(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return qo(i,0,i.length,r,e,t)}function bI(n,e,t,i,r,s,o){const l=n[e],u=n[e+1],h=n[t]-l,f=n[t+1]-u;let p;if(h===0&&f===0)p=e;else{const y=((r-l)*h+(s-u)*f)/(h*h+f*f);if(y>1)p=t;else if(y>0){for(let x=0;x<i;++x)o[x]=wi(n[e+x],n[t+x],y);o.length=i;return}else p=e}for(let y=0;y<i;++y)o[y]=n[p+y];o.length=i}function P2(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],u=n[e+1],h=Kc(s,o,l,u);h>r&&(r=h),s=l,o=u}return r}function k2(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=P2(n,e,l,i,r),e=l}return r}function vq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=k2(n,e,l,i,r),e=l[l.length-1]}return r}function N2(n,e,t,i,r,s,o,l,u,h,f){if(e==t)return h;let p,y;if(r===0){if(y=Kc(o,l,n[e],n[e+1]),y<h){for(p=0;p<i;++p)u[p]=n[e+p];return u.length=i,y}return h}f=f||[NaN,NaN];let x=e+i;for(;x<t;)if(bI(n,x-i,x,i,o,l,f),y=Kc(o,l,f[0],f[1]),y<h){for(h=y,p=0;p<i;++p)u[p]=f[p];u.length=i,x+=i}else x+=i*Math.max((Math.sqrt(y)-Math.sqrt(h))/r|0,1);if(s&&(bI(n,t-i,e,i,o,l,f),y=Kc(o,l,f[0],f[1]),y<h)){for(h=y,p=0;p<i;++p)u[p]=f[p];u.length=i}return h}function D2(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,y=t.length;p<y;++p){const x=t[p];h=N2(n,e,x,i,r,s,o,l,u,h,f),e=x}return h}function xq(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,y=t.length;p<y;++p){const x=t[p];h=D2(n,e,x,i,r,s,o,l,u,h,f),e=x[x.length-1]}return h}function Dj(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function M2(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function L2(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=M2(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function wq(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=L2(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function $c(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Vp(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=$c(n,e,u,i,r[s]),e=u}return r.length=s,r}function PI(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:Vp(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function kI(n,e,t,i,r,s,o){let l,u;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,u=r;else if(h!==0){let f=n[e],p=n[e+1],y=0;const x=[0];for(let S=e+i;S<t;S+=i){const b=n[S],D=n[S+1];y+=Math.sqrt((b-f)*(b-f)+(D-p)*(D-p)),x.push(y),f=b,p=D}const I=r*y,T=b5(x,I);T<0?(u=(I-x[-T-2])/(x[-T-1]-x[-T-2]),l=e+(-T-2)*i):l=e+T*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:u===void 0?n[l+f]:wi(n[l+f],n[l+i+f],u);return s}function NI(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,u=t/i;for(;l<u;){const y=l+u>>1;r<n[(y+1)*i-1]?u=y:l=y+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],p=(r-h)/(f-h);o=[];for(let y=0;y<i-1;++y)o.push(wi(n[(l-1)*i+y],n[l*i+y],p));return o.push(r),o}function Eq(n,e,t,i,r,s,o){if(o)return NI(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let u=0,h=t.length;u<h;++u){const f=t[u];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return NI(n,e,f,i,r,!1);e=f}}return null}function Mj(n,e,t,i,r){return!p2(r,function(o){return!Qa(n,e,t,i,o[0],o[1])})}function Qa(n,e,t,i,r,s){let o=0,l=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];u<=s?f>s&&(h-l)*(s-u)-(r-l)*(f-u)>0&&o++:f<=s&&(h-l)*(s-u)-(r-l)*(f-u)<0&&o--,l=h,u=f}return o!==0}function y1(n,e,t,i,r,s){if(t.length===0||!Qa(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(Qa(n,t[o-1],t[o],i,r,s))return!1;return!0}function Tq(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const u=t[o];if(y1(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function Lj(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function _1(n,e,t,i,r,s){return s=s??g2(Qi(),n,e,t,i),si(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:Lj(n,e,t,i,function(o,l){return z5(r,o,l)}):!1}function Sq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(_1(n,e,t[s],i,r))return!0;e=t[s]}return!1}function O2(n,e,t,i,r){return!!(_1(n,e,t,i,r)||Qa(n,e,t,i,r[0],r[1])||Qa(n,e,t,i,r[0],r[3])||Qa(n,e,t,i,r[2],r[1])||Qa(n,e,t,i,r[2],r[3]))}function F2(n,e,t,i,r){if(!O2(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(Mj(n,t[s-1],t[s],i,r)&&!_1(n,t[s-1],t[s],i,r))return!1;return!0}function Iq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(F2(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function Oj(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const u=n[l],h=n[l+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function v1(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(l);u[0]=1,u[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const p=h.pop(),y=h.pop();let x=0;const I=n[y],T=n[y+1],S=n[p],b=n[p+1];for(let D=y+i;D<p;D+=i){const N=n[D],L=n[D+1],F=B5(N,L,I,T,S,b);F>x&&(f=D,x=F)}x>r&&(u[(f-e)/i]=1,y+i<f&&h.push(y,f),f+i<p&&h.push(f,p))}for(let p=0;p<l;++p)u[p]&&(s[o++]=n[e+p*i],s[o++]=n[e+p*i+1]);return o}function Fj(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=v1(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Ua(n,e){return e*Math.round(n/e)}function Vj(n,e,t,i,r,s,o){if(e==t)return o;let l=Ua(n[e],r),u=Ua(n[e+1],r);e+=i,s[o++]=l,s[o++]=u;let h,f;do if(h=Ua(n[e],r),f=Ua(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==u);for(;e<t;){const p=Ua(n[e],r),y=Ua(n[e+1],r);if(e+=i,p==h&&y==f)continue;const x=h-l,I=f-u,T=p-l,S=y-u;if(x*S==I*T&&(x<0&&T<x||x==T||x>0&&T>x)&&(I<0&&S<I||I==S||I>0&&S>I)){h=p,f=y;continue}s[o++]=h,s[o++]=f,l=h,u=f,h=p,f=y}return s[o++]=h,s[o++]=f,o}function x1(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=Vj(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Cq(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u],p=[];o=x1(n,e,f,i,r,s,o,p),l.push(p),e=f[f.length-1]}return o}class pl extends m1{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new pl(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Kc(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let u=0;u<l;++u)i[u]=s[u];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return f2(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return d2(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Dj(this.flatCoordinates,0,e,this.stride),this.changed()}}const qi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},ml=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",jj=ml.includes("safari")&&!ml.includes("chrom");jj&&(ml.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ml));const Uj=ml.includes("webkit")&&!ml.includes("edge"),V2=ml.includes("macintosh"),zj=typeof devicePixelRatio<"u"?devicePixelRatio:1,Si=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,j2=typeof Image<"u"&&Image.prototype.decode,U2=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),ze={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Qt(n,e,t,i){let r;return t&&t.length?r=t.shift():Si?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let h_;function jp(){return h_||(h_=Qt(1,1)),h_}function Um(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function DI(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function Bj(n){for(;n.lastChild;)n.lastChild.remove()}function Gj(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function z2(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Wo(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const w1=[NaN,NaN,NaN,0];let d_;function Wj(){return d_||(d_=Qt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),d_}const $j=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Hj=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Kj=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,qj=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function jg(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function nd(n){throw new Error('failed to parse "'+n+'" as color')}function B2(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(Hj)||n.match($j)||n.match(Kj);if(s){const o=s[4],l=100/255;return[Nt(jg(s[1],l)+.5|0,0,255),Nt(jg(s[2],l)+.5|0,0,255),Nt(jg(s[3],l)+.5|0,0,255),o!==void 0?Nt(jg(o,100),0,1):1]}nd(n)}if(n.startsWith("#")){if(qj.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let f=parseInt(s.substring(u,u+o),16);o===1&&(f+=f<<4),l[u/o]=f}return l[3]=l[3]/255,l}nd(n)}const e=Wj();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&nd(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return B2(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=rf(r[3]/255,3),r}function Xj(n){return typeof n=="string"?n:T1(n)}const Yj=1024,Ch={};let f_=0;function Zj(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function g_(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function p_(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function m_(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function y_(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function MI(n){const e=m_(n[0]),t=m_(n[1]),i=m_(n[2]),r=y_(e*.222488403+t*.716873169+i*.06060791),s=500*(y_(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-y_(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function Qj(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=p_(e),s=p_(e+t/500*Math.cos(i)),o=p_(e-t/200*Math.sin(i)),l=g_(s*3.021973625-r*1.617392459-o*.404875592),u=g_(s*-.943766287+r*1.916279586+o*.027607165),h=g_(s*.069407491-r*.22898585+o*1.159737864);return[Nt(l+.5|0,0,255),Nt(u+.5|0,0,255),Nt(h+.5|0,0,255),n[3]]}function E1(n){if(n==="none")return w1;if(Ch.hasOwnProperty(n))return Ch[n];if(f_>=Yj){let t=0;for(const i in Ch)(t++&3)===0&&(delete Ch[i],--f_)}const e=B2(n);e.length!==4&&nd(n);for(const t of e)isNaN(t)&&nd(n);return Ch[n]=e,++f_,e}function hu(n){return Array.isArray(n)?n:E1(n)}function T1(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}function Jj(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[Np(i,Be.LOAD,function(){o=!0,s||e()})];return i.src&&j2?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):l.push(Np(i,Be.ERROR,t)),function(){r=!1,l.forEach(Rt)}}function e4(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function t4(n,e){return e&&(n.src=e),n.src&&j2?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):e4(n)}class n4{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=__(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=__(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=__(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===ze.IDLE&&r.load(),r.getImageState()===ze.LOADING?r.ready().then(()=>{this.patternCache_[o]=jp().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=jp().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function __(n,e,t){const i=t?hu(t):"null";return e+":"+n+":"+i}const Xi=new n4;let Rh=null;class G2 extends km{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?ze.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===ze.LOADED){Rh||(Rh=Qt(1,1,void 0,{willReadFrequently:!0})),Rh.drawImage(this.image_,0,0);try{Rh.getImageData(0,0,1,1),this.tainted_=!1}catch{Rh=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Be.CHANGE)}handleImageError_(){this.imageState_=ze.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ze.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Qt(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ze.IDLE){this.image_||this.initializeImage_(),this.imageState_=ze.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&t4(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==ze.LOADED)return;const t=this.image_,i=Qt(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=Xj(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===ze.LOADED||this.imageState_===ze.ERROR)e();else{const t=()=>{(this.imageState_===ze.LOADED||this.imageState_===ze.ERROR)&&(this.removeEventListener(Be.CHANGE,t),e())};this.addEventListener(Be.CHANGE,t)}})),this.ready_}}function Up(n,e,t,i,r,s){let o=e===void 0?void 0:Xi.get(e,t,r);return o||(o=new G2(n,n&&"src"in n?n.src||void 0:e,t,i,r),Xi.set(e,t,r,o,s)),s&&o&&!Xi.getPattern(e,t,r)&&Xi.set(e,t,r,o,s),o}function Jr(n){return n?Array.isArray(n)?T1(n):typeof n=="object"&&"src"in n?i4(n):n:null}function i4(n){if(!n.offset||!n.size)return Xi.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Xi.getPattern(e,void 0,n.color);if(t)return t;const i=Xi.get(n.src,"anonymous",null);if(i.getImageState()!==ze.LOADED)return null;const r=Qt(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Up(r.canvas,e,void 0,ze.LOADED,n.color,!0),Xi.getPattern(e,void 0,n.color)}class W2{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Ug="ol-hidden",of="ol-unselectable",S1="ol-control",LI="ol-collapsed",r4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),OI=["style","variant","weight","size","lineHeight","family"],Pv={normal:400,bold:700},kv=function(n){const e=n.match(r4);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=OI.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[OI[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in Pv&&(t.weight=Pv[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},$2="10px sans-serif",ti="#000",du="round",Gs=[],Ws=0,fu="round",Sd=10,Id="#000",Cd="center",zp="middle",Ja=[0,0,0,0],Rd=1,kc=new us;let Ah=null,FI;const Nv={},s4=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function o4(n,e,t){return`${n} ${e} 16px "${t}"`}const a4=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=kv(s),u=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const p=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),y=Pv[f.weight]||f.weight;return p===u&&f.style===l.style&&y==h})}async function r(){await t.ready;let s=!0;const o=kc.getProperties(),l=Object.keys(o).filter(u=>o[u]<100);for(let u=l.length-1;u>=0;--u){const h=l[u];let f=o[h];f<100&&(await i(h)?(tf(Nv),kc.set(h,100)):(f+=10,kc.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Si?self.fonts:document.fonts);const o=kv(s);if(!o)return;const l=o.families;let u=!1;for(const h of l){if(s4.has(h))continue;const f=o4(o.style,o.weight,h);kc.get(f)===void 0&&(kc.set(f,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),l4=(function(){let n;return function(e){let t=Nv[e];if(t==null){if(Si){const i=kv(e),r=H2(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);Nv[e]=t}return t}})();function H2(n,e){return Ah||(Ah=Qt(1,1)),n!=FI&&(Ah.font=n,FI=Ah.font),Ah.measureText(e)}function K2(n,e){return H2(n,e).width}function VI(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,K2(n,s)),0);return t[e]=i,i}function c4(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,u=0;for(let h=0,f=e.length;h<=f;h+=2){const p=e[h];if(p===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=u,u=0;continue}const y=e[h+1]||n.font,x=K2(y,p);t.push(x),o+=x;const I=l4(y);i.push(I),u=Math.max(u,I)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function u4(n,e,t,i,r,s,o,l,u,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=p=>p.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(f[0],f[1]),h4(i,n)):f[0]<0||f[1]<0?(n.translate(u,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,u,h,o*f[0],l*f[1]),n.restore()}function h4(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class d4 extends W2{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?rf(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Er()}drawImages_(e,t,i,r){if(!this.image_)return;const s=qo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,p=s.length;f<p;f+=2){const y=s[f]-this.imageAnchorX_,x=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const I=y+this.imageAnchorX_,T=x+this.imageAnchorY_;Ks(l,I,T,1,1,h,-I,-T),o.save(),o.transform.apply(o,l),o.translate(I,T),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=qo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=qo(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let u=l.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!si(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=Nj(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!si(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(si(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!si(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!si(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,u=s.length;l<u;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),aa(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Cd;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Jr(i||ti)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),f=s||Gs;this.strokeState_={lineCap:r!==void 0?r:du,lineDash:this.pixelRatio_===1?f:f.map(p=>p*this.pixelRatio_),lineDashOffset:(o||Ws)*this.pixelRatio_,lineJoin:l!==void 0?l:fu,lineWidth:(u!==void 0?u:Rd)*this.pixelRatio_,miterLimit:h!==void 0?h:Sd,strokeStyle:Jr(i||Id)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const x=t.getColor();this.textFillState_={fillStyle:Jr(x||ti)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const x=i.getColor(),I=i.getLineCap(),T=i.getLineDash(),S=i.getLineDashOffset(),b=i.getLineJoin(),D=i.getWidth(),N=i.getMiterLimit();this.textStrokeState_={lineCap:I!==void 0?I:du,lineDash:T||Gs,lineDashOffset:S||Ws,lineJoin:b!==void 0?b:fu,lineWidth:D!==void 0?D:Rd,miterLimit:N!==void 0?N:Sd,strokeStyle:Jr(x||Id)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),f=e.getText(),p=e.getTextAlign(),y=e.getTextBaseline();this.textState_={font:r!==void 0?r:$2,textAlign:p!==void 0?p:Cd,textBaseline:y!==void 0?y:zp},this.text_=f!==void 0?Array.isArray(f)?f.reduce((x,I,T)=>x+=T%2?" ":I,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const f4=.5,q2={Point:w4,LineString:_4,Polygon:T4,MultiPoint:E4,MultiLineString:v4,MultiPolygon:x4,GeometryCollection:y4,Circle:p4};function g4(n,e){return parseInt(it(n),10)-parseInt(it(e),10)}function jI(n,e){const t=X2(n,e);return t*t}function X2(n,e){return f4*n/e}function p4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}function UI(n,e,t,i,r,s,o,l){const u=[],h=t.getImage();if(h){let y=!0;const x=h.getImageState();x==ze.LOADED||x==ze.ERROR?y=!1:x==ze.IDLE&&h.load(),y&&u.push(h.ready())}const f=t.getFill();f&&f.loading()&&u.push(f.ready());const p=u.length>0;return p&&Promise.all(u).then(()=>r(null)),m4(n,e,t,i,s,o,l),p}function m4(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const u=l.simplifyTransformed(i,r);if(t.getRenderer())Y2(n,u,t,e,o);else{const f=q2[u.getType()];f(n,u,t,e,o,s)}}function Y2(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,u=o.length;l<u;++l)Y2(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function y4(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,u;for(l=0,u=o.length;l<u;++l){const h=q2[o[l].getType()];h(n,o[l],t,i,r,s)}}function _4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function v4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function x4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}function w4(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=ze.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function E4(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=ze.LOADED)return;const p=n.getBuilder(t.getZIndex(),"Image");p.setImageStyle(o,f),p.drawMultiPoint(e,i,r)}if(h){const p=n.getBuilder(t.getZIndex(),"Text");p.setTextStyle(u,f),p.drawText(e,i,r)}}function T4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}let S4=!1;function I4(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=S4,l.onload=function(u){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function zI(n,e){return function(t,i,r,s,o){I4(n,e,t,i,r,(l,u)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function C4(n,e){return[[-1/0,-1/0,1/0,1/0]]}function R4(n,e,t,i){const r=[];let s=Qi();for(let o=0,l=t.length;o<l;++o){const u=t[o];s=l1(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function I1(n,e,t,i,r,s,o){let l,u,h,f,p,y,x;const I=r[s+1],T=[];for(let D=0,N=t.length;D<N;++D){const L=t[D];for(f=n[L-i],y=n[L-i+1],l=e;l<L;l+=i)p=n[l],x=n[l+1],(I<=y&&x<=I||y<=I&&I<=x)&&(h=(I-y)/(x-y)*(p-f)+f,T.push(h)),f=p,y=x}let S=NaN,b=-1/0;for(T.sort(Bs),f=T[0],l=1,u=T.length;l<u;++l){p=T[l];const D=Math.abs(p-f);D>b&&(h=(f+p)/2,y1(n,e,t,i,h,I)&&(S=h,b=D)),f=p}return isNaN(S)&&(S=r[s]),o?(o.push(S,I,b),o):[S,I,b]}function A4(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const u=t[o];s=I1(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function b4(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function C1(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],u=n[e+1];r+=(l-s)*(u+o),s=l,o=u}return r===0?void 0:r>0}function Z2(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=C1(n,e,l,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function Rq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!Z2(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function Dv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=C1(n,e,l,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&b4(n,e,l,i),e=l}return e}function Aq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=Dv(n,e,t[s],i,r);return e}function P4(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const u=e[o],h=C1(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function Q2(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,u=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=u*h-l*f,l=h,u=f}return r/2}function J2(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=Q2(n,e,l,i),e=l}return r}function bq(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=J2(n,e,l,i),e=l[l.length-1]}return r}class Ad extends m1{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Ad(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<h2(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(P2(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),N2(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return Q2(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return $c(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=v1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Ad(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=M2(this.flatCoordinates,0,e,this.stride),this.changed()}}class bd extends m1{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?o1(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new bd(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<h2(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(k2(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),D2(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return y1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return J2(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Dv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Vp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=fl(this.getExtent());this.flatInteriorPoint_=I1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new pl(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Ad(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const u=i[o],h=new Ad(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Z2(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Dv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=x1(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new bd(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return F2(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=L2(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function BI(n){if(Om(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new bd(s,"XY",[s.length])}const GI=Er();class gr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?f2(this.flatCoordinates_):l1(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=fl(this.getExtent());this.flatInteriorPoints_=I1(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=P4(this.flatCoordinates_,this.ends_),t=R4(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=A4(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=kI(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=kI(e,t,o,2,.5);o1(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=li(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Bn(i)/Bn(t);Ks(GI,i[0],i[3],r,-r,0,0,0),qo(this.flatCoordinates_,0,this.flatCoordinates_.length,2,GI,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new gr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=c2((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=v1(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=Fj(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=x1(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new gr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}gr.prototype.getFlatCoordinates=gr.prototype.getOrientedFlatCoordinates;function eP(n,e,t=0,i=n.length-1,r=k4){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,f=Math.log(u),p=.5*Math.exp(2*f/3),y=.5*Math.sqrt(f*p*(u-p)/u)*(h-u/2<0?-1:1),x=Math.max(t,Math.floor(e-h*p/u+y)),I=Math.min(i,Math.floor(e+(u-h)*p/u+y));eP(n,e,x,I,r)}const s=n[e];let o=t,l=i;for(bh(n,t,e),r(n[i],s)>0&&bh(n,t,i);o<l;){for(bh(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?bh(n,t,l):(l++,bh(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function bh(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function k4(n,e){return n<e?-1:n>e?1:0}let tP=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!Bg(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],u=t.leaf?r(l):l;Bg(e,u)&&(t.leaf?i.push(l):x_(e,u)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!Bg(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(Bg(e,o)){if(t.leaf||x_(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Nc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=N4(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&x_(i,r)?(s.push(i),o.push(l),l=0,u=i,i=i.children[0]):u?(l++,i=u.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=Nc(e.slice(t,i+1)),vc(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=Nc([]),l.leaf=!1,l.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));WI(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const p=Math.min(f+h-1,i);WI(e,f,p,u,this.compareMinY);for(let y=f;y<=p;y+=u){const x=Math.min(y+u-1,p);l.children.push(this._build(e,y,x,r-1))}}return vc(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let u=0;u<t.children.length;u++){const h=t.children[u],f=v_(h),p=L4(e,h)-f;p<o?(o=p,s=f<s?f:s,l=h):p===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Wh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=Nc(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,vc(i,this.toBBox),vc(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=Nc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,vc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const u=Gh(e,0,l,this.toBBox),h=Gh(e,l,i,this.toBBox),f=O4(u,h),p=v_(u)+v_(h);f<s?(s=f,r=l,o=p<o?p:o):f===s&&p<o&&(o=p,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:D4,s=e.leaf?this.compareMinY:M4,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Gh(e,0,t,s),l=Gh(e,i-t,i,s);let u=zg(o)+zg(l);for(let h=t;h<i-t;h++){const f=e.children[h];Wh(o,e.leaf?s(f):f),u+=zg(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];Wh(l,e.leaf?s(f):f),u+=zg(l)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Wh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():vc(e[t],this.toBBox)}};function N4(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function vc(n,e){Gh(n,0,n.children.length,e,n)}function Gh(n,e,t,i,r){r||(r=Nc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Wh(r,n.leaf?i(o):o)}return r}function Wh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function D4(n,e){return n.minX-e.minX}function M4(n,e){return n.minY-e.minY}function v_(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function zg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function L4(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function O4(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function x_(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Bg(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Nc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function WI(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;eP(n,o,e,t,r),s.push(e,o,o,t)}}class $I{constructor(e){this.rbush_=new tP(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[it(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=u,this.items_[it(l)]=u}this.rbush_.load(i)}remove(e){const t=it(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[it(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Ed(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return ou(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return ta(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class nP extends us{constructor(e){super(),this.projection=li(e.projection),this.attributions_=HI(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=HI(e),this.changed()}setState(e){this.state_=e,this.changed()}}function HI(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const Wi={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Io extends Zs{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class R1 extends nP{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=wd,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(at(this.format_,"`format` must be set when `url` is set"),this.loader_=zI(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:C4;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new $I:null,this.loadedExtentsRtree_=new $I,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Ki(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=it(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Io(Wi.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof gr||(this.featureChangeKeys_[e]=[nt(t,Be.CHANGE,this.handleFeatureChange_,this),nt(t,su.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof gr){const s=this.idIndex_[r];s instanceof gr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(at(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],u=it(l);this.addToIndex_(u,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],u=it(l);this.setupChangeEvents_(u,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(Wi.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Io(Wi.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Wi.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(Wi.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(ei.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(ei.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Rt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Io(Wi.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof gr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof gr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),ou(this.nullGeometryFeatures_)||o1(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=_2(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||xd,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const f=h.getGeometry(),p=l;if(l=f instanceof gr?0:f.closestPointXY(i,r,o,l),l<p){s=h;const y=Math.sqrt(l);u[0]=i-y,u[1]=r-y,u[2]=i+y,u[3]=r+y}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=it(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new Io(Wi.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:it(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&ou(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const u=s[o];r.forEachInExtent(u,function(f){return Bh(f.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Io(Wi.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new Io(Wi.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Io(Wi.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Ed(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=it(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Rt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(Wi.REMOVEFEATURE)&&this.dispatchEvent(new Io(Wi.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){at(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(zI(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Ir{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Ir({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Up(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===ze.IDLE&&t.load(),t.getImageState()===ze.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?it(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:hu(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class ku{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new ku({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function KI(n){return n[0]>0&&n[1]>0}function F4(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function ai(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class zm{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=ai(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new zm({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return tt()}getImage(e){return tt()}getHitDetectionImage(){return tt()}getPixelRatio(e){return 1}getImageState(){return tt()}getImageSize(){return tt()}getOrigin(){return tt()}getSize(){return tt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ai(e)}listenImageChange(e){tt()}load(){tt()}unlistenImageChange(e){tt()}ready(){return Promise.resolve()}}class Bm extends zm{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?ze.LOADING:ze.LOADED,this.imageState_===ze.LOADING&&this.ready().then(()=>this.imageState_=ze.LOADED),this.render()}clone(){const e=this.getScale(),t=new Bm({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Xi.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=Qt(o,o);this.draw_(s,l,e),r=l.canvas,Xi.set(i,null,null,new G2(r,void 0,null,ze.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const G=r;r=s,s=G}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,u=s*Math.sin(l),h=Math.sqrt(s*s-u*u),f=r-h,p=Math.sqrt(u*u+f*f),y=p/u;if(e==="miter"&&y<=i)return y*t;const x=t/2/y,I=t/2*(f/p),S=Math.sqrt((r+x)*(r+x)+I*I)-r;if(this.radius2_===void 0||e==="bevel")return S*2;const b=r*Math.sin(l),D=Math.sqrt(r*r-b*b),N=s-D,F=Math.sqrt(b*b+N*N)/b;if(F<=i){const G=F*t/2-s-r;return 2*Math.max(S,G)}return S*2}createRenderOptions(){let e=du,t=fu,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=Jr(this.stroke_.getColor()??Id),l=this.stroke_.getWidth()??Rd,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??fu,e=this.stroke_.getLineCap()??du,i=this.stroke_.getMiterLimit()??Sd);const u=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ti),t.fillStyle=Jr(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=hu(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Qt(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const u=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ti,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class kl extends Bm{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new kl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Zi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=qI,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Zi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=qI,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function V4(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(at(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let w_=null;function iP(n,e){if(!w_){const t=new Ir({color:"rgba(255,255,255,0.4)"}),i=new ku({color:"#3399CC",width:1.25});w_=[new Zi({image:new kl({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return w_}function qI(n){return n.getGeometry()}const j4="#333";class af{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=ai(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Ir({color:j4}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new af({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Ir?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ai(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Mn={ANIMATING:0,INTERACTING:1},Ie={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Gg=[Ie.FILL],$o=[Ie.STROKE],el=[Ie.BEGIN_PATH],XI=[Ie.CLOSE_PATH];class lf extends W2{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,u=e.length;l<u;l+=t)r[0]=e[l],r[1]=e[l+1],lu(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let u=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],p=e[t+1];const y=this.tmpCoordinate_;let x=!0,I,T,S;for(I=t+r;I<i;I+=r)y[0]=e[I],y[1]=e[I+1],S=wv(h,y),S!==T?(x&&(l[u++]=f,l[u++]=p,x=!1),l[u++]=y[0],l[u++]=y[1]):S===an.INTERSECTING?(l[u++]=y[0],l[u++]=y[1],x=!1):x=!0,f=y[0],p=y[1],T=S;return(s&&x||I===t+r)&&(l[u++]=f,l[u++]=p),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),u=this.coordinates.length;let h,f,p,y,x;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),y=[];const I=e.getEndss();x=0;for(let T=0,S=I.length;T<S;++T){const b=[];x=this.drawCustomCoordinates_(h,x,I[T],l,b),y.push(b)}this.instructions.push([Ie.CUSTOM,u,y,e,i,PI,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,y,e,r||i,PI,s]);break;case"Polygon":case"MultiLineString":p=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),x=this.drawCustomCoordinates_(h,0,e.getEnds(),l,p),this.instructions.push([Ie.CUSTOM,u,p,e,i,Vp,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,p,e,r||i,Vp,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Ie.CUSTOM,u,f,e,i,$c,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,$c,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>u&&(this.instructions.push([Ie.CUSTOM,u,f,e,i,$c,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,$c,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Ie.CUSTOM,u,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Ie.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ie.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Ie.END_GEOMETRY?o=t:s==Ie.BEGIN_GEOMETRY&&(r[2]=t,k5(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Jr(i||ti)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Jr(i||Id);const r=e.getLineCap();t.lineCap=r!==void 0?r:du;const s=e.getLineDash();t.lineDash=s?s.slice():Gs;const o=e.getLineDashOffset();t.lineDashOffset=o||Ws;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:fu;const u=e.getWidth();t.lineWidth=u!==void 0?u:Rd;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Sd,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Ie.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ie.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!aa(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Ie.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=u2(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;a1(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class U4 extends lf{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!lu(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Ie.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||lu(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ie.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class z4 extends lf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Ie.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws],el);const l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push($o),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws],el);const l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,y=l.length;p<y;++p)f=this.drawFlatCoordinates_(u,f,l[p],h);this.hitDetectionInstructions.push($o),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push($o),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push($o),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(el)}}class YI extends lf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,u=i.length;this.instructions.push(el),this.hitDetectionInstructions.push(el);for(let h=0;h<u;++h){const f=i[h],p=this.coordinates.length,y=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),x=[Ie.MOVE_TO_LINE_TO,p,y];this.instructions.push(x),this.hitDetectionInstructions.push(x),l&&(this.instructions.push(XI),this.hitDetectionInstructions.push(XI)),t=f}return o&&(this.instructions.push(Gg),this.hitDetectionInstructions.push(Gg)),l&&(this.instructions.push($o),this.hitDetectionInstructions.push($o)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);const f=[Ie.CIRCLE,h];this.instructions.push(el,f),this.hitDetectionInstructions.push(el,f),r.fillStyle!==void 0&&(this.instructions.push(Gg),this.hitDetectionInstructions.push(Gg)),r.strokeStyle!==void 0&&(this.instructions.push($o),this.hitDetectionInstructions.push($o)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,y=l.length;p<y;++p)f=this.drawFlatCoordinatess_(u,f,l[p],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Ua(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function B4(n,e,t,i,r){const s=[];let o=t,l=0,u=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=u.slice(-2),p=e[o+r],y=e[o+r+1],x=Math.sqrt((p-h)*(p-h)+(y-f)*(y-f));if(l+=x,l>=n){const I=(n-l+x)/x,T=wi(h,p,I),S=wi(f,y,I);u.push(T,S),s.push(u),u=[T,S],l==n&&(o+=r),l=0}else if(l<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const I=x-l,T=wi(h,p,I/x),S=wi(f,y,I/x);u.push(T,S),s.push(u),u=[T,S],l=0,o+=r}}return l>0&&s.push(u),s}function G4(n,e,t,i,r){let s=t,o=t,l=0,u=0,h=t,f,p,y,x,I,T,S,b,D,N;for(p=t;p<i;p+=r){const L=e[p],F=e[p+1];I!==void 0&&(D=L-I,N=F-T,x=Math.sqrt(D*D+N*N),S!==void 0&&(u+=y,f=Math.acos((S*D+b*N)/(y*x)),f>n&&(u>l&&(l=u,s=h,o=p),u=0,h=p-r)),y=x,S=D,b=N),I=L,T=F}return u+=x,u>l?[h,p]:[s,o]}const Bp={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class W4 extends lf{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ti]={fillStyle:ti},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let u=l.length;const h=e.getType();let f=null,p=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!si(this.maxExtent,e.getExtent()))return;let y;if(f=e.getFlatCoordinates(),h=="LineString")y=[f.length];else if(h=="MultiLineString")y=e.getEnds();else if(h=="Polygon")y=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const S=e.getEndss();y=[];for(let b=0,D=S.length;b<D;++b)y.push(S[b][0])}this.beginGeometry(e,t,i);const x=o.repeat,I=x?void 0:o.textAlign;let T=0;for(let S=0,b=y.length;S<b;++S){let D;x?D=B4(x*this.resolution,f,T,y[S],p):D=[f.slice(T,y[S])];for(let N=0,L=D.length;N<L;++N){const F=D[N];let G=0,k=F.length;if(I==null){const P=G4(o.maxAngle,F,0,F.length,2);G=P[0],k=P[1]}for(let P=G;P<k;P+=p)l.push(F[P],F[P+1]);const R=l.length;T=y[S],this.drawChars_(u,R),u=R}}this.endGeometry(t)}else{let y=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),p=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||y.push(f[2]/this.resolution),p=3;break;case"MultiPolygon":const L=e.getFlatInteriorPoints();f=[];for(let F=0,G=L.length;F<G;F+=3)o.overflow||y.push(L[F+2]/this.resolution),f.push(L[F],L[F+1]);if(f.length===0)return;p=2;break}const x=this.appendFlatPointCoordinates(f,p);if(x===u)return;if(y&&(x-u)/2!==f.length/p){let L=u/2;y=y.filter((F,G)=>{const k=l[(L+G)*2]===f[G*p]&&l[(L+G)*2+1]===f[G*p+1];return k||--L,k})}this.saveTextStates_();const I=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,T=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let S=o.padding;if(S!=Ja&&(o.scale[0]<0||o.scale[1]<0)){let L=o.padding[0],F=o.padding[1],G=o.padding[2],k=o.padding[3];o.scale[0]<0&&(F=-F,k=-k),o.scale[1]<0&&(L=-L,G=-G),S=[L,F,G,k]}const b=this.pixelRatio;this.instructions.push([Ie.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,S==Ja?Ja:S.map(function(L){return L*b}),I,T,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]);const D=1/b,N=I?I.slice(0):null;N&&(N[1]=ti),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[D,D],NaN,this.declutterMode_,this.declutterImageWithText_,S,N,T,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ti:this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Cd,justify:t.justify,textBaseline:t.textBaseline||zp,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=Bp[r.textBaseline],f=this.textOffsetY_*u,p=this.text_,y=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Ie.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,u,f,s,y*u,p,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ie.DRAW_CHARS,e,t,h,r.overflow,l&&ti,r.maxAngle,u,f,s,y*u,p,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Jr(o.getColor()||ti)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const T=l.getLineDash(),S=l.getLineDashOffset(),b=l.getWidth(),D=l.getMiterLimit();s.lineCap=l.getLineCap()||du,s.lineDash=T?T.slice():Gs,s.lineDashOffset=S===void 0?Ws:S,s.lineJoin=l.getLineJoin()||fu,s.lineWidth=b===void 0?Rd:b,s.miterLimit=D===void 0?Sd:D,s.strokeStyle=Jr(l.getColor()||Id)}i=this.textState_;const u=e.getFont()||$2;a4(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||zp,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||Ja,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),p=e.getOffsetY(),y=e.getRotateWithView(),x=e.getKeepUpright(),I=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=p===void 0?0:p,this.textRotateWithView_=y===void 0?!1:y,this.textKeepUpright_=x===void 0?!0:x,this.textRotation_=I===void 0?0:I,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:it(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+it(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const $4={Circle:YI,Default:lf,Image:U4,LineString:z4,Polygon:YI,Text:W4};class H4{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=$4[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function K4(n,e,t,i,r,s,o,l,u,h,f,p,y=!0){let x=n[e],I=n[e+1],T=0,S=0,b=0,D=0;function N(){T=x,S=I,e+=i,x=n[e],I=n[e+1],D+=b,b=Math.sqrt((x-T)*(x-T)+(I-S)*(I-S))}do N();while(e<t-i&&D+b<s);let L=b===0?0:(s-D)/b;const F=wi(T,x,L),G=wi(S,I,L),k=e-i,R=D,P=s+l*u(h,r,f);for(;e<t-i&&D+b<P;)N();L=b===0?0:(P-D)/b;const V=wi(T,x,L),j=wi(S,I,L);let B=!1;if(y)if(p){const ue=[F,G,V,j];b2(ue,0,4,2,p,ue,ue),B=ue[0]>ue[2]}else B=F>V;const M=Math.PI,se=[],he=k+i===e;e=k,b=0,D=R,x=n[e],I=n[e+1];let ge;if(he){N(),ge=Math.atan2(I-S,x-T),B&&(ge+=ge>0?-M:M);const ue=(V+F)/2,Q=(j+G)/2;return se[0]=[ue,Q,(P-s)/2,ge,r],se}r=r.replace(/\n/g," ");for(let ue=0,Q=r.length;ue<Q;){N();let re=Math.atan2(I-S,x-T);if(B&&(re+=re>0?-M:M),ge!==void 0){let xe=re-ge;if(xe+=xe>M?-2*M:xe<-M?2*M:0,Math.abs(xe)>o)return null}ge=re;const ne=ue;let U=0;for(;ue<Q;++ue){const xe=B?Q-ue-1:ue,ke=l*u(h,r[xe],f);if(e+i<t&&D+b<s+U+ke/2)break;U+=ke}if(ue===ne)continue;const $=B?r.substring(Q-ne,Q-ue):r.substring(ne,ue);L=b===0?0:(s+U/2-D)/b;const ie=wi(T,x,L),me=wi(S,I,L);se.push([ie,me,U/2,re,$]),s+=U}return se}class rP{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(jp(),{get:(e,t)=>{if(typeof jp()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const xc=Qi(),Co=[],ks=[],Ns=[],Ro=[];function ZI(n){return n[3].declutterBox}const QI=new RegExp("[-----]");function E_(n,e){return e==="start"?e=QI.test(n)?"right":"left":e==="end"&&(e=QI.test(n)?"left":"right"),Bp[e]}function q4(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function X4(n,e,t){return t%2===0&&(n+=e),n}class Y4{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Er(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new rP:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,f=[u.scale[0]*h,u.scale[1]*h],p=u.justify?Bp[u.justify]:E_(Array.isArray(e)?e[0]:e,u.textAlign||Cd),y=r&&o.lineWidth?o.lineWidth:0,x=Array.isArray(e)?e:String(e).split(`
`).reduce(q4,[]),{width:I,height:T,widths:S,heights:b,lineWidths:D}=c4(u,x),N=I+y,L=[],F=(N+2)*f[0],G=(T+y)*f[1],k={width:F<0?Math.floor(F):Math.ceil(F),height:G<0?Math.floor(G):Math.ceil(G),contextInstructions:L};(f[0]!=1||f[1]!=1)&&L.push("scale",f),r&&(L.push("strokeStyle",o.strokeStyle),L.push("lineWidth",y),L.push("lineCap",o.lineCap),L.push("lineJoin",o.lineJoin),L.push("miterLimit",o.miterLimit),L.push("setLineDash",[o.lineDash]),L.push("lineDashOffset",o.lineDashOffset)),i&&L.push("fillStyle",l.fillStyle),L.push("textBaseline","middle"),L.push("textAlign","center");const R=.5-p;let P=p*N+R*y;const V=[],j=[];let B=0,M=0,se=0,he=0,ge;for(let ue=0,Q=x.length;ue<Q;ue+=2){const re=x[ue];if(re===`
`){M+=B,B=0,P=p*N+R*y,++he;continue}const ne=x[ue+1]||u.font;ne!==ge&&(r&&V.push("font",ne),i&&j.push("font",ne),ge=ne),B=Math.max(B,b[se]);const U=[re,P+R*S[se]+p*(S[se]-D[he]),.5*(y+B)+M];P+=S[se],r&&V.push("strokeText",U),i&&j.push("fillText",U),++se}return Array.prototype.push.apply(L,V),Array.prototype.push.apply(L,j),this.labels_[s]=k,k}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,u,h,f,p,y,x,I,T,S){l*=y[0],u*=y[1];let b=i-l,D=r-u;const N=s+h>e?e-h:s,L=o+f>t?t-f:o,F=I[3]+N*y[0]+I[1],G=I[0]+L*y[1]+I[2],k=b-I[3],R=D-I[0];(T||p!==0)&&(Co[0]=k,Ro[0]=k,Co[1]=R,ks[1]=R,ks[0]=k+F,Ns[0]=ks[0],Ns[1]=R+G,Ro[1]=Ns[1]);let P;return p!==0?(P=Ks(Er(),i,r,1,1,p,-i,-r),un(P,Co),un(P,ks),un(P,Ns),un(P,Ro),ta(Math.min(Co[0],ks[0],Ns[0],Ro[0]),Math.min(Co[1],ks[1],Ns[1],Ro[1]),Math.max(Co[0],ks[0],Ns[0],Ro[0]),Math.max(Co[1],ks[1],Ns[1],Ro[1]),xc)):ta(Math.min(k,k+F),Math.min(R,R+G),Math.max(k,k+F),Math.max(R,R+G),xc),x&&(b=Math.round(b),D=Math.round(D)),{drawImageX:b,drawImageY:D,drawImageW:N,drawImageH:L,originX:h,originY:f,declutterBox:{minX:xc[0],minY:xc[1],maxX:xc[2],maxY:xc[3],value:S},canvasTransform:P,scale:y}}replayImageOrLabel_(e,t,i,r,s,o,l){const u=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(u&&this.replayTextBackground_(e,Co,ks,Ns,Ro,o,l),u4(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=un(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],u=this.pixelRatio,h=E_(Array.isArray(e)?e[0]:e,s.textAlign||Cd),f=Bp[s.textBaseline||zp],p=l&&l.lineWidth?l.lineWidth:0,y=o.width/u-2*s.scale[0],x=h*y+2*(.5-h)*p,I=f*o.height/u+2*(.5-f)*p;return{label:o,anchorX:x,anchorY:I}}execute_(e,t,i,r,s,o,l,u){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&aa(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=qo(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Ej(this.renderedTransform_,i));let p=0;const y=r.length;let x=0,I,T,S,b,D,N,L,F,G,k,R,P,V,j=0,B=0;const M=this.coordinateCache_,se=this.viewRotation_,he=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ge={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:se},ue=this.instructions!=r||this.overlaps?0:200;let Q,re,ne,U;for(;p<y;){const $=r[p];switch($[0]){case Ie.BEGIN_GEOMETRY:Q=$[1],U=$[3],Q.getGeometry()?l!==void 0&&!si(l,U.getExtent())?p=$[2]+1:++p:p=$[2],h&&(h.zIndex=$[4]);break;case Ie.BEGIN_PATH:j>ue&&(this.fill_(e),j=0),B>ue&&(e.stroke(),B=0),!j&&!B&&(e.beginPath(),D=NaN,N=NaN),++p;break;case Ie.CIRCLE:x=$[1];const me=f[x],xe=f[x+1],ke=f[x+2],Me=f[x+3],Ve=ke-me,We=Me-xe,lt=Math.sqrt(Ve*Ve+We*We);e.moveTo(me+lt,xe),e.arc(me,xe,lt,0,2*Math.PI,!0),++p;break;case Ie.CLOSE_PATH:e.closePath(),++p;break;case Ie.CUSTOM:x=$[1],I=$[2];const er=$[3],fs=$[4],Wn=$[5];ge.geometry=er,ge.feature=Q,p in M||(M[p]=[]);const $n=M[p];Wn?Wn(f,x,I,2,$n):($n[0]=f[x],$n[1]=f[x+1],$n.length=2),h&&(h.zIndex=$[6]),fs($n,ge),++p;break;case Ie.DRAW_IMAGE:x=$[1],I=$[2],G=$[3],T=$[4],S=$[5];let hn=$[6];const dn=$[7],Hn=$[8],bi=$[9],yt=$[10];let ct=$[11];const tn=$[12];let Pi=$[13];b=$[14]||"declutter";const St=$[15];if(!G&&$.length>=20){k=$[19],R=$[20],P=$[21],V=$[22];const Ot=this.drawLabelWithPointPlacement_(k,R,P,V);G=Ot.label,$[3]=G;const Di=$[23];T=(Ot.anchorX-Di)*this.pixelRatio,$[4]=T;const fn=$[24];S=(Ot.anchorY-fn)*this.pixelRatio,$[5]=S,hn=G.height,$[6]=hn,Pi=G.width,$[13]=Pi}let to;$.length>25&&(to=$[25]);let ki,Ar,tr;$.length>17?(ki=$[16],Ar=$[17],tr=$[18]):(ki=Ja,Ar=null,tr=null),yt&&he?ct+=se:!yt&&!he&&(ct-=se);let br=0;for(;x<I;x+=2){if(to&&to[br++]<Pi/this.pixelRatio)continue;const Ot=this.calculateImageOrLabelDimensions_(G.width,G.height,f[x],f[x+1],Pi,hn,T,S,Hn,bi,ct,tn,s,ki,!!Ar||!!tr,Q),Di=[e,t,G,Ot,dn,Ar,tr];if(u){let fn,Ft,gn;if(St){const rt=I-x;if(!St[rt]){St[rt]={args:Di,declutterMode:b};continue}const Bt=St[rt];fn=Bt.args,Ft=Bt.declutterMode,delete St[rt],gn=ZI(fn)}let pn,nn;if(fn&&(Ft!=="declutter"||!u.collides(gn))&&(pn=!0),(b!=="declutter"||!u.collides(Ot.declutterBox))&&(nn=!0),Ft==="declutter"&&b==="declutter"){const rt=pn&&nn;pn=rt,nn=rt}pn&&(Ft!=="none"&&u.insert(gn),this.replayImageOrLabel_.apply(this,fn)),nn&&(b!=="none"&&u.insert(Ot.declutterBox),this.replayImageOrLabel_.apply(this,Di))}else this.replayImageOrLabel_.apply(this,Di)}++p;break;case Ie.DRAW_CHARS:const ca=$[1],Pr=$[2],Ni=$[3],Ol=$[4];V=$[5];const kr=$[6],gs=$[7],no=$[8];P=$[9];const On=$[10];k=$[11],Array.isArray(k)&&(k=k.reduce(X4,"")),R=$[12];const ps=[$[13],$[13]];b=$[14]||"declutter";const Nr=$[15],Dr=this.textStates[R],Fn=Dr.font,Vn=[Dr.scale[0]*gs,Dr.scale[1]*gs];let ft;Fn in this.widths_?ft=this.widths_[Fn]:(ft={},this.widths_[Fn]=ft);const io=Oj(f,ca,Pr,2),nr=Math.abs(Vn[0])*VI(Fn,k,ft);if(Ol||nr<=io){const Ot=this.textStates[R].textAlign,Di=(io-nr)*E_(k,Ot),fn=K4(f,ca,Pr,2,k,Di,kr,Math.abs(Vn[0]),VI,Fn,ft,he?0:this.viewRotation_,Nr);e:if(fn){const Ft=[];let gn,pn,nn,rt,Bt;if(P)for(gn=0,pn=fn.length;gn<pn;++gn){Bt=fn[gn],nn=Bt[4],rt=this.createLabel(nn,R,"",P),T=Bt[2]+(Vn[0]<0?-On:On),S=Ni*rt.height+(.5-Ni)*2*On*Vn[1]/Vn[0]-no;const qt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Bt[0],Bt[1],rt.width,rt.height,T,S,0,0,Bt[3],ps,!1,Ja,!1,Q);if(u&&b==="declutter"&&u.collides(qt.declutterBox))break e;Ft.push([e,t,rt,qt,1,null,null])}if(V)for(gn=0,pn=fn.length;gn<pn;++gn){Bt=fn[gn],nn=Bt[4],rt=this.createLabel(nn,R,V,""),T=Bt[2],S=Ni*rt.height-no;const qt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Bt[0],Bt[1],rt.width,rt.height,T,S,0,0,Bt[3],ps,!1,Ja,!1,Q);if(u&&b==="declutter"&&u.collides(qt.declutterBox))break e;Ft.push([e,t,rt,qt,1,null,null])}u&&b!=="none"&&u.load(Ft.map(ZI));for(let qt=0,Mi=Ft.length;qt<Mi;++qt)this.replayImageOrLabel_.apply(this,Ft[qt])}}++p;break;case Ie.END_GEOMETRY:if(o!==void 0){Q=$[1];const Ot=o(Q,U,b);if(Ot)return Ot}++p;break;case Ie.FILL:ue?j++:this.fill_(e),++p;break;case Ie.MOVE_TO_LINE_TO:for(x=$[1],I=$[2],re=f[x],ne=f[x+1],e.moveTo(re,ne),D=re+.5|0,N=ne+.5|0,x+=2;x<I;x+=2)re=f[x],ne=f[x+1],L=re+.5|0,F=ne+.5|0,(x==I-2||L!==D||F!==N)&&(e.lineTo(re,ne),D=L,N=F);++p;break;case Ie.SET_FILL_STYLE:this.alignAndScaleFill_=$[2],j&&(this.fill_(e),j=0,B&&(e.stroke(),B=0)),e.fillStyle=$[1],++p;break;case Ie.SET_STROKE_STYLE:B&&(e.stroke(),B=0),this.setStrokeStyle_(e,$),++p;break;case Ie.STROKE:ue?B++:e.stroke(),++p;break;default:++p;break}}j&&this.fill_(e),B&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const $a=["Polygon","Circle","LineString","Image","Text","Default"],sP=["Image","Text"],Z4=$a.filter(n=>!sP.includes(n));class Q4{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Er(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new Y4(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,u=Ks(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Qt(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let p;this.renderBuffer_!==void 0&&(p=Qi(),td(p,e),a1(p,t*(this.renderBuffer_+r),p));const y=J4(r);let x;function I(F,G,k){const R=f.getImageData(0,0,l,l).data;for(let P=0,V=y.length;P<V;P++)if(R[y[P]]>0){if(!o||k==="none"||x!=="Image"&&x!=="Text"||o.includes(F)){const j=(y[P]-3)/4,B=r-j%l,M=r-(j/l|0),se=s(F,G,B*B+M*M);if(se)return se}f.clearRect(0,0,l,l);break}}const T=Object.keys(this.executorsByZIndex_).map(Number);T.sort(Bs);let S,b,D,N,L;for(S=T.length-1;S>=0;--S){const F=T[S].toString();for(D=this.executorsByZIndex_[F],b=$a.length-1;b>=0;--b)if(x=$a[b],N=D[x],N!==void 0&&(L=N.executeHitDetection(f,u,i,I,p),L))return L}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return qo(l,0,8,2,e,l),l}isEmpty(){return ou(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(l?P5:Bs),o=o||$a;const h=$a.length;for(let f=0,p=u.length;f<p;++f){const y=u[f].toString(),x=this.executorsByZIndex_[y];for(let I=0,T=o.length;I<T;++I){const S=o[I],b=x[S];if(b!==void 0){const D=l===null?void 0:b.getZIndexContext(),N=D?D.getContext():e,L=this.maxExtent_&&S!=="Image"&&S!=="Text";if(L&&(N.save(),this.clip(N,i)),!D||S==="Text"||S==="Image"?b.execute(N,t,i,r,s,l):D.pushFunction(F=>b.execute(F,t,i,r,s,l)),L&&N.restore(),D){D.offset();const F=u[f]*h+$a.indexOf(S);this.deferredZIndexContexts_[F]||(this.deferredZIndexContexts_[F]=[]),this.deferredZIndexContexts_[F].push(D)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Bs);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const T_={};function J4(n){if(T_[n]!==void 0)return T_[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let u=i[l];u||(u=[],i[l]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return T_[n]=r,r}function JI(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let A1=class oP extends zm{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;at(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||it(o)),at(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),at(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=ze.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?ze.LOADED:ze.IDLE:u=ze.LOADING:u=ze.LOADED),this.color_=e.color!==void 0?hu(e.color):null,this.iconImage_=Up(o,l,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const p=this.getImage(1);if(p.width&&p.height)h=p.width,f=p.height;else if(p instanceof HTMLImageElement){this.initialOptions_=e;const y=()=>{if(this.unlistenImageChange(y),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale(JI(x[0],x[1],e.width,e.height))};this.listenImageChange(y);return}}h!==void 0&&this.setScale(JI(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new oP({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=Up(null,e,this.crossOrigin_,ze.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==ze.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==ze.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Be.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Be.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Zr=.5;function e3(n,e,t,i,r,s,o,l,u){const h=r,f=n[0]*Zr,p=n[1]*Zr,y=Qt(f,p);y.imageSmoothingEnabled=!1;const x=y.canvas,I=new d4(y,Zr,r,null,o,l,null),T=t.length,S=Math.floor((256*256*256-1)/T),b={};for(let N=1;N<=T;++N){const L=t[N-1],F=L.getStyleFunction()||i;if(!F)continue;let G=F(L,s);if(!G)continue;Array.isArray(G)||(G=[G]);const R=(N*S).toString(16).padStart(7,"#00000");for(let P=0,V=G.length;P<V;++P){const j=G[P],B=j.getGeometryFunction()(L);if(!B||!si(h,B.getExtent()))continue;const M=j.clone(),se=M.getFill();se&&se.setColor(R);const he=M.getStroke();he&&(he.setColor(R),he.setLineDash(null)),M.setText(void 0);const ge=j.getImage();if(ge){const ne=ge.getImageSize();if(!ne)continue;const U=Qt(ne[0],ne[1],void 0,{alpha:!1}),$=U.canvas;U.fillStyle=R,U.fillRect(0,0,$.width,$.height),M.setImage(new A1({img:$,anchor:ge.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ge.getOrigin(),opacity:1,size:ge.getSize(),scale:ge.getScale(),rotation:ge.getRotation(),rotateWithView:ge.getRotateWithView()}))}const ue=M.getZIndex()||0;let Q=b[ue];Q||(Q={},b[ue]=Q,Q.Polygon=[],Q.Circle=[],Q.LineString=[],Q.Point=[]);const re=B.getType();if(re==="GeometryCollection"){const ne=B.getGeometriesArrayRecursive();for(let U=0,$=ne.length;U<$;++U){const ie=ne[U];Q[ie.getType().replace("Multi","")].push(ie,M)}}else Q[re.replace("Multi","")].push(B,M)}}const D=Object.keys(b).map(Number).sort(Bs);for(let N=0,L=D.length;N<L;++N){const F=b[D[N]];for(const G in F){const k=F[G];for(let R=0,P=k.length;R<P;R+=2){I.setStyle(k[R+1]);for(let V=0,j=e.length;V<j;++V)I.setTransform(e[V]),I.drawGeometry(k[R])}}}return y.getImageData(0,0,x.width,x.height)}function t3(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Zr),s=Math.floor(Math.round(n[1])*Zr),o=(Nt(r,0,t.width-1)+Nt(s,0,t.height-1)*t.width)*4,l=t.data[o],u=t.data[o+1],f=t.data[o+2]+256*(u+256*l),p=Math.floor((256*256*256-1)/e.length);f&&f%p===0&&i.push(e[f/p-1])}return i}class aP extends Zs{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const n3=5;class i3 extends nf{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=n3}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return tt()}getData(e){return null}prepareFrame(e){return tt()}renderFrame(e,t){return tt()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===ze.LOADED||t.getState()===ze.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=ze.LOADED&&t!=ze.ERROR&&e.addEventListener(Be.CHANGE,this.boundHandleImageChange_),t==ze.IDLE&&(e.load(),t=e.getState()),t==ze.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const eC=[];let Dc=null;function r3(){Dc=Qt(1,1,void 0,{willReadFrequently:!0})}class lP extends i3{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Er(),this.pixelTransform=Er(),this.inversePixelTransform=Er(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Dc||r3(),Dc.clearRect(0,0,1,1);let r;try{Dc.drawImage(e,t,i,1,1,0,0,1,1),r=Dc.getImageData(0,0,1,1).data}catch{return Dc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&aa(hu(e.style.backgroundColor),hu(i)))){const l=e.firstElementChild;Wo(l)&&(o=l.getContext("2d"))}if(o&&Cj(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Si?z2():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Qt();const u=o.canvas;s.appendChild(u),l=u.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Pl(i),s=Lm(i),o=Mm(i),l=Dm(i);un(t.coordinateToPixelTransform,r),un(t.coordinateToPixelTransform,s),un(t.coordinateToPixelTransform,o),un(t.coordinateToPixelTransform,l);const u=this.inversePixelTransform;un(u,r),un(u,s),un(u,o),un(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(dt(i)/r*o),u=Math.round(Bn(i)/r*o);Ks(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-u/2),A2(this.inversePixelTransform,this.pixelTransform);const h=Ij(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=u?(f.width=l,f.height=u):this.context.clearRect(0,0,l,u),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new aP(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(qi.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(qi.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new rP),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(qi.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(qi.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const u=s/2,h=o/2,f=r/t,p=-f,y=-e[0]+l,x=-e[1];return Ks(this.tempTransform,u,h,f,p,-i,y,x)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class s3 extends lP{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Qi(),this.wrappedRenderedExtent_=Qi(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,u=s.projection,h=s.rotation,f=u.getExtent(),p=this.getLayer().getSource(),y=this.getLayer().getDeclutter(),x=t.pixelRatio,I=t.viewHints,T=!(I[Mn.ANIMATING]||I[Mn.INTERACTING]),S=this.context,b=Math.round(dt(r)/l*x),D=Math.round(Bn(r)/l*x),N=p.getWrapX()&&u.canWrapX(),L=N?dt(f):null,F=N?Math.ceil((r[2]-f[2])/L)+1:1;let G=N?Math.floor((r[0]-f[0])/L):0;do{let k=this.getRenderTransform(o,l,0,x,b,D,G*L);t.declutter&&(k=k.slice(0)),e.execute(S,[S.canvas.width,S.canvas.height],k,h,T,i===void 0?$a:i?sP:Z4,i?y&&t.declutter[y]:void 0)}while(++G<F)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Qt(this.context.canvas.width,this.context.canvas.height,eC))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Um(this.context),eC.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(qi.PRERENDER)||this.getLayer().hasListener(qi.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const u=Go(i.extent);l=si(u,e.extent),this.clipped_=l&&!Bh(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],p=i[0]*Zr,y=i[1]*Zr;f.push(this.getRenderTransform(r,s,o,Zr,p,y,0).slice());const x=h.getSource(),I=l.getExtent();if(x.getWrapX()&&l.canWrapX()&&!Bh(I,u)){let T=u[0];const S=dt(I);let b=0,D;for(;T<I[0];)--b,D=S*b,f.push(this.getRenderTransform(r,s,o,Zr,p,y,D).slice()),T+=S;for(b=0,T=u[2];T>I[2];)++b,D=S*b,f.push(this.getRenderTransform(r,s,o,Zr,p,y,D).slice()),T-=S}this.hitDetectionImageData_=e3(i,f,this.renderedFeatures_,h.getStyleFunction(),u,s,o,jI(s,this.renderedPixelRatio_))}t(t3(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},f=function(y,x,I){const T=it(y),S=h[T];if(S){if(S!==!0&&I<S.distanceSq){if(I===0)return h[T]=!0,s.splice(s.lastIndexOf(S),1),r(y,u,x);S.geometry=x,S.distanceSq=I}}else{if(I===0)return h[T]=!0,r(y,u,x);s.push(h[T]={feature:y,layer:u,geometry:x,distanceSq:I,callback:r})}},p=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,p?t.declutter?.[p]?.all().map(y=>y.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Mn.ANIMATING],s=e.viewHints[Mn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,f=h.projection,p=h.resolution,y=e.pixelRatio,x=t.getRevision(),I=t.getRenderBuffer();let T=t.getRenderOrder();T===void 0&&(T=g4);const S=h.center.slice(),b=a1(u,I*p),D=b.slice(),N=[b.slice()],L=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Bh(L,e.extent)){const se=dt(L),he=Math.max(dt(b)/2,se);b[0]=L[0]-he,b[2]=L[2]+he,v2(S,f);const ge=y2(N[0],f);ge[0]<L[0]&&ge[2]<L[2]?N.push([ge[0]+se,ge[1],ge[2]+se,ge[3]]):ge[0]>L[0]&&ge[2]>L[2]&&N.push([ge[0]-se,ge[1],ge[2]-se,ge[3]])}if(this.ready&&this.renderedResolution_==p&&this.renderedRevision_==x&&this.renderedRenderOrder_==T&&this.renderedFrameDeclutter_===!!e.declutter&&Bh(this.wrappedRenderedExtent_,b))return aa(this.renderedExtent_,D)||(this.hitDetectionImageData_=null,this.renderedExtent_=D),this.renderedCenter_=S,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const F=new H4(X2(p,y),b,p,y);let G;for(let se=0,he=N.length;se<he;++se)i.loadFeatures(N[se],p,f);const k=jI(p,y);let R=!0;const P=(se,he)=>{let ge;const ue=se.getStyleFunction()||t.getStyleFunction();if(ue&&(ge=ue(se,p)),ge){const Q=this.renderFeature(se,k,ge,F,G,this.getLayer().getDeclutter(),he);R=R&&!Q}},V=R2(b),j=i.getFeaturesInExtent(V);T&&j.sort(T);for(let se=0,he=j.length;se<he;++se)P(j[se],se);this.renderedFeatures_=j,this.ready=R;const B=F.finish(),M=new Q4(b,p,y,i.getOverlaps(),B,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=p,this.renderedRevision_=x,this.renderedRenderOrder_=T,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=D,this.wrappedRenderedExtent_=b,this.renderedCenter_=S,this.renderedProjection_=f,this.renderedPixelRatio_=y,this.replayGroup_=M,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)u=UI(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||u;else u=UI(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return u}}let Nl=0;const zn=1<<Nl++,Xe=1<<Nl++,ni=1<<Nl++,pr=1<<Nl++,yl=1<<Nl++,$h=1<<Nl++,Wg=Math.pow(2,Nl)-1,b1={[zn]:"boolean",[Xe]:"number",[ni]:"string",[pr]:"color",[yl]:"number[]",[$h]:"size"},o3=Object.keys(b1).map(Number).sort(Bs);function a3(n){return n in b1}function Hh(n){const e=[];for(const t of o3)Kh(n,t)&&e.push(b1[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Kh(n,e){return(n&e)===e}function Ao(n,e){return n===e}class Zt{constructor(e,t){if(!a3(e))throw new Error(`literal expressions must have a specific type, got ${Hh(e)}`);this.type=e,this.value=t}}class l3{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function cP(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function In(n,e,t){switch(typeof n){case"boolean":{if(Ao(e,ni))return new Zt(ni,n?"true":"false");if(!Kh(e,zn))throw new Error(`got a boolean, but expected ${Hh(e)}`);return new Zt(zn,n)}case"number":{if(Ao(e,$h))return new Zt($h,ai(n));if(Ao(e,zn))return new Zt(zn,!!n);if(Ao(e,ni))return new Zt(ni,n.toString());if(!Kh(e,Xe))throw new Error(`got a number, but expected ${Hh(e)}`);return new Zt(Xe,n)}case"string":{if(Ao(e,pr))return new Zt(pr,E1(n));if(Ao(e,zn))return new Zt(zn,!!n);if(!Kh(e,ni))throw new Error(`got a string, but expected ${Hh(e)}`);return new Zt(ni,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return v3(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Ao(e,$h)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Zt($h,n)}if(Ao(e,pr)){if(n.length===3)return new Zt(pr,[...n,1]);if(n.length===4)return new Zt(pr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Kh(e,yl))throw new Error(`got an array of numbers, but expected ${Hh(e)}`);return new Zt(yl,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},c3={[te.Get]:Oe(Ue(1,1/0),tC),[te.Var]:Oe(Ue(1,1),u3),[te.Has]:Oe(Ue(1,1/0),tC),[te.Id]:Oe(h3,wc),[te.Concat]:Oe(Ue(2,1/0),ot(ni)),[te.GeometryType]:Oe(d3,wc),[te.LineMetric]:Oe(wc),[te.Resolution]:Oe(S_,wc),[te.Zoom]:Oe(S_,wc),[te.Time]:Oe(S_,wc),[te.Any]:Oe(Ue(2,1/0),ot(zn)),[te.All]:Oe(Ue(2,1/0),ot(zn)),[te.Not]:Oe(Ue(1,1),ot(zn)),[te.Equal]:Oe(Ue(2,2),ot(Wg)),[te.NotEqual]:Oe(Ue(2,2),ot(Wg)),[te.GreaterThan]:Oe(Ue(2,2),ot(Xe)),[te.GreaterThanOrEqualTo]:Oe(Ue(2,2),ot(Xe)),[te.LessThan]:Oe(Ue(2,2),ot(Xe)),[te.LessThanOrEqualTo]:Oe(Ue(2,2),ot(Xe)),[te.Multiply]:Oe(Ue(2,1/0),nC),[te.Coalesce]:Oe(Ue(2,1/0),nC),[te.Divide]:Oe(Ue(2,2),ot(Xe)),[te.Add]:Oe(Ue(2,1/0),ot(Xe)),[te.Subtract]:Oe(Ue(2,2),ot(Xe)),[te.Clamp]:Oe(Ue(3,3),ot(Xe)),[te.Mod]:Oe(Ue(2,2),ot(Xe)),[te.Pow]:Oe(Ue(2,2),ot(Xe)),[te.Abs]:Oe(Ue(1,1),ot(Xe)),[te.Floor]:Oe(Ue(1,1),ot(Xe)),[te.Ceil]:Oe(Ue(1,1),ot(Xe)),[te.Round]:Oe(Ue(1,1),ot(Xe)),[te.Sin]:Oe(Ue(1,1),ot(Xe)),[te.Cos]:Oe(Ue(1,1),ot(Xe)),[te.Atan]:Oe(Ue(1,2),ot(Xe)),[te.Sqrt]:Oe(Ue(1,1),ot(Xe)),[te.Match]:Oe(Ue(4,1/0),iC,g3),[te.Between]:Oe(Ue(3,3),ot(Xe)),[te.Interpolate]:Oe(Ue(6,1/0),iC,p3),[te.Case]:Oe(Ue(3,1/0),f3,m3),[te.In]:Oe(Ue(2,2),y3),[te.Number]:Oe(Ue(1,1/0),ot(Wg)),[te.String]:Oe(Ue(1,1/0),ot(Wg)),[te.Array]:Oe(Ue(1,1/0),ot(Xe)),[te.Color]:Oe(Ue(1,4),ot(Xe)),[te.Band]:Oe(Ue(1,3),ot(Xe)),[te.Palette]:Oe(Ue(2,2),_3),[te.ToString]:Oe(Ue(1,1),ot(zn|Xe|ni|pr))};function tC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Zt(Xe,o);break}case"string":{r[s]=new Zt(ni,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function u3(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Zt(ni,i)]}function h3(n,e,t){t.featureId=!0}function d3(n,e,t){t.geometryType=!0}function S_(n,e,t){t.mapState=!0}function wc(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Ue(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function nC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=In(n[s+1],e,t);r[s]=o}return r}function ot(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=In(e[o+1],n,i);s[o]=l}return s}}function f3(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function iC(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function g3(n,e,t){const i=n.length-1,r=ni|Xe|zn,s=In(n[1],r,t),o=In(n[n.length-1],e,t),l=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=In(n[u+2],s.type,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=In(n[u+3],o.type,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...l,o]}function p3(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Zt(Xe,r);let o;try{o=In(n[2],Xe,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const l=new Array(n.length-3);for(let u=0;u<l.length;u+=2){try{const h=In(n[u+3],Xe,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=In(n[u+4],e,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function m3(n,e,t){const i=In(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=In(n[s+1],zn,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=In(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function y3(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=ni}else r=Xe;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const u=In(i[l],r,t);s[l]=u}catch(u){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${u.message}`)}return[In(n[1],r,t),...s]}function _3(n,e,t){let i;try{i=In(n[1],Xe,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=In(r[o],pr,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(l instanceof Zt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Oe(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new l3(t,r,...s)}}function v3(n,e,t){const i=n[0],r=c3[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function uP(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return uP(n.getGeometries()[0]);default:return""}}function hP(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Qs(n,e,t){const i=In(n,e,t);return Cr(i)}function Cr(n,e){if(n instanceof Zt){if(n.type===pr&&typeof n.value=="string"){const i=E1(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return x3(n);case te.Get:case te.Var:case te.Has:return w3(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Cr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return T3(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return E3(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return S3(n);case te.Case:return I3(n);case te.Match:return C3(n);case te.Interpolate:return R3(n);case te.ToString:return A3(n);default:throw new Error(`Unsupported operator ${t}`)}}function x3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function w3(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;o=o[f]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function E3(n,e){const t=n.operator,i=Cr(n.args[0]),r=Cr(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function T3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),l=r[1](s),u=r[2](s);return o>=l&&o<=u};case te.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function S3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const u=r[2](s);return o>u?u:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function I3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function C3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function R3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,u;for(let h=2;h<t;h+=2){const f=i[h](r);let p=i[h+1](r);const y=Array.isArray(p);if(y&&(p=Zj(p)),f>=o)return h===2?p:y?b3(s,o,l,u,f,p):qh(s,o,l,u,f,p);l=f,u=p}return u}}function A3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);if(t===te.ToString)return s=>{const o=r[0](s);return n.args[0].type===pr?T1(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function qh(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,u=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function b3(n,e,t,i,r,s){if(r-t===0)return i;const l=MI(i),u=MI(s);let h=u[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[qh(n,e,t,l[0],r,u[0]),qh(n,e,t,l[1],r,u[1]),l[2]+qh(n,e,t,0,r,h),qh(n,e,t,i[3],r,s[3])];return Qj(f)}function P3(n){return!0}function k3(n){const e=cP(),t=N3(n,e),i=hP();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=uP(r.getGeometry())),t(i)}}function rC(n){const e=cP(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Mv(n[o],e);const r=hP(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[u]=f,u+=1)}return s.length=u,s}}function N3(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Qs(s.filter,zn,e):P3;let l;if(Array.isArray(s.style)){const u=s.style.length;l=new Array(u);for(let h=0;h<u;++h)l[h]=Mv(s.style[h],e)}else l=[Mv(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const u=i[l].filter;if(u(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function Mv(n,e){const t=Pd(n,"",e),i=kd(n,"",e),r=D3(n,e),s=M3(n,e),o=oi(n,"z-index",e);if(!t&&!i&&!r&&!s&&!ou(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new Zi;return function(u){let h=!0;if(t){const f=t(u);f&&(h=!1),l.setFill(f)}if(i){const f=i(u);f&&(h=!1),l.setStroke(f)}if(r){const f=r(u);f&&(h=!1),l.setText(f)}if(s){const f=s(u);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(u)),h?null:l}}function Pd(n,e,t){let i;if(e+"fill-pattern-src"in n)i=V3(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=P1(n,e+"fill-color",t)}if(!i)return null;const r=new Ir;return function(s){const o=i(s);return o===w1?null:(r.setColor(o),r)}}function kd(n,e,t){const i=oi(n,e+"stroke-width",t),r=P1(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Ms(n,e+"stroke-line-cap",t),o=Ms(n,e+"stroke-line-join",t),l=dP(n,e+"stroke-line-dash",t),u=oi(n,e+"stroke-line-dash-offset",t),h=oi(n,e+"stroke-miter-limit",t),f=new ku;return function(p){if(r){const y=r(p);if(y===w1)return null;f.setColor(y)}if(i&&f.setWidth(i(p)),s){const y=s(p);if(y!=="butt"&&y!=="round"&&y!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(y)}if(o){const y=o(p);if(y!=="bevel"&&y!=="round"&&y!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(y)}return l&&f.setLineDash(l(p)),u&&f.setLineDashOffset(u(p)),h&&f.setMiterLimit(h(p)),f}}function D3(n,e){const t="text-",i=Ms(n,t+"value",e);if(!i)return null;const r=Pd(n,t,e),s=Pd(n,t+"background-",e),o=kd(n,t,e),l=kd(n,t+"background-",e),u=Ms(n,t+"font",e),h=oi(n,t+"max-angle",e),f=oi(n,t+"offset-x",e),p=oi(n,t+"offset-y",e),y=Xc(n,t+"overflow",e),x=Ms(n,t+"placement",e),I=oi(n,t+"repeat",e),T=Gm(n,t+"scale",e),S=Xc(n,t+"rotate-with-view",e),b=oi(n,t+"rotation",e),D=Ms(n,t+"align",e),N=Ms(n,t+"justify",e),L=Ms(n,t+"baseline",e),F=Xc(n,t+"keep-upright",e),G=dP(n,t+"padding",e),k=Wm(n,t+"declutter-mode"),R=new af({declutterMode:k});return function(P){if(R.setText(i(P)),r&&R.setFill(r(P)),s&&R.setBackgroundFill(s(P)),o&&R.setStroke(o(P)),l&&R.setBackgroundStroke(l(P)),u&&R.setFont(u(P)),h&&R.setMaxAngle(h(P)),f&&R.setOffsetX(f(P)),p&&R.setOffsetY(p(P)),y&&R.setOverflow(y(P)),x){const V=x(P);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");R.setPlacement(V)}if(I&&R.setRepeat(I(P)),T&&R.setScale(T(P)),S&&R.setRotateWithView(S(P)),b&&R.setRotation(b(P)),D){const V=D(P);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");R.setTextAlign(V)}if(N){const V=N(P);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");R.setJustify(V)}if(L){const V=L(P);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");R.setTextBaseline(V)}return G&&R.setPadding(G(P)),F&&R.setKeepUpright(F(P)),R}}function M3(n,e){return"icon-src"in n?L3(n,e):"shape-points"in n?O3(n,e):"circle-radius"in n?F3(n,e):null}function L3(n,e){const t="icon-",i=t+"src",r=fP(n[i],i),s=Gp(n,t+"anchor",e),o=Gm(n,t+"scale",e),l=oi(n,t+"opacity",e),u=Gp(n,t+"displacement",e),h=oi(n,t+"rotation",e),f=Xc(n,t+"rotate-with-view",e),p=oC(n,t+"anchor-origin"),y=aC(n,t+"anchor-x-units"),x=aC(n,t+"anchor-y-units"),I=B3(n,t+"color"),T=U3(n,t+"cross-origin"),S=z3(n,t+"offset"),b=oC(n,t+"offset-origin"),D=Wp(n,t+"width"),N=Wp(n,t+"height"),L=j3(n,t+"size"),F=Wm(n,t+"declutter-mode"),G=new A1({src:r,anchorOrigin:p,anchorXUnits:y,anchorYUnits:x,color:I,crossOrigin:T,offset:S,offsetOrigin:b,height:N,width:D,size:L,declutterMode:F});return function(k){return l&&G.setOpacity(l(k)),u&&G.setDisplacement(u(k)),h&&G.setRotation(h(k)),f&&G.setRotateWithView(f(k)),o&&G.setScale(o(k)),s&&G.setAnchor(s(k)),G}}function O3(n,e){const t="shape-",i=t+"points",r=t+"radius",s=Lv(n[i],i),o=Lv(n[r],r),l=Pd(n,t,e),u=kd(n,t,e),h=Gm(n,t+"scale",e),f=Gp(n,t+"displacement",e),p=oi(n,t+"rotation",e),y=Xc(n,t+"rotate-with-view",e),x=Wp(n,t+"radius2"),I=Wp(n,t+"angle"),T=Wm(n,t+"declutter-mode"),S=new Bm({points:s,radius:o,radius2:x,angle:I,declutterMode:T});return function(b){return l&&S.setFill(l(b)),u&&S.setStroke(u(b)),f&&S.setDisplacement(f(b)),p&&S.setRotation(p(b)),y&&S.setRotateWithView(y(b)),h&&S.setScale(h(b)),S}}function F3(n,e){const t="circle-",i=Pd(n,t,e),r=kd(n,t,e),s=oi(n,t+"radius",e),o=Gm(n,t+"scale",e),l=Gp(n,t+"displacement",e),u=oi(n,t+"rotation",e),h=Xc(n,t+"rotate-with-view",e),f=Wm(n,t+"declutter-mode"),p=new kl({radius:5,declutterMode:f});return function(y){return s&&p.setRadius(s(y)),i&&p.setFill(i(y)),r&&p.setStroke(r(y)),l&&p.setDisplacement(l(y)),u&&p.setRotation(u(y)),h&&p.setRotateWithView(h(y)),o&&p.setScale(o(y)),p}}function oi(n,e,t){if(!(e in n))return;const i=Qs(n[e],Xe,t);return function(r){return Lv(i(r),e)}}function Ms(n,e,t){if(!(e in n))return null;const i=Qs(n[e],ni,t);return function(r){return fP(i(r),e)}}function V3(n,e,t){const i=Ms(n,e+"pattern-src",t),r=sC(n,e+"pattern-offset",t),s=sC(n,e+"pattern-size",t),o=P1(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function Xc(n,e,t){if(!(e in n))return null;const i=Qs(n[e],zn,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function P1(n,e,t){if(!(e in n))return null;const i=Qs(n[e],pr,t);return function(r){return gP(i(r),e)}}function dP(n,e,t){if(!(e in n))return null;const i=Qs(n[e],yl,t);return function(r){return cf(i(r),e)}}function Gp(n,e,t){if(!(e in n))return null;const i=Qs(n[e],yl,t);return function(r){const s=cf(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function sC(n,e,t){if(!(e in n))return null;const i=Qs(n[e],yl,t);return function(r){return pP(i(r),e)}}function Gm(n,e,t){if(!(e in n))return null;const i=Qs(n[e],yl|Xe,t);return function(r){return G3(i(r),e)}}function Wp(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function j3(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return ai(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function U3(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function oC(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function aC(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function z3(n,e){const t=n[e];if(t!==void 0)return cf(t,e)}function Wm(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function B3(n,e){const t=n[e];if(t!==void 0)return gP(t,e)}function cf(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function fP(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function Lv(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function gP(n,e){if(typeof n=="string")return n;const t=cf(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function pP(n,e){const t=cf(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function G3(n,e){return typeof n=="number"?n:pP(n,e)}const hr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function lC(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,p=l?l[1]:0;let y=n[0]+u/2+f,x=n[2]-u/2+f,I=n[1]+h/2+p,T=n[3]-h/2+p;y>x&&(y=(x+y)/2,x=y),I>T&&(I=(T+I)/2,T=I);let S=Nt(i[0],y,x),b=Nt(i[1],I,T);if(o&&t&&r){const D=30*r;S+=-D*Math.log(1+Math.max(0,y-i[0])/D)+D*Math.log(1+Math.max(0,i[0]-x)/D),b+=-D*Math.log(1+Math.max(0,I-i[1])/D)+D*Math.log(1+Math.max(0,i[1]-T)/D)}return[S,b]})}function W3(n){return n}function mP(n){return Math.pow(n,3)}function Nu(n){return 1-mP(1-n)}function $3(n){return 3*n*n-2*n*n*n}function H3(n){return n}function k1(n,e,t,i){const r=dt(e)/t[0],s=Bn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function N1(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Nt(i,t/2,e*2)}function K3(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const u=n[0],h=n[n.length-1],f=t?k1(u,t,o,i):u;if(l)return e?N1(r,f,h):Nt(r,h,f);const p=Math.min(f,r),y=Math.floor(s1(n,p,s));return n[y]>f&&y<n.length-1?n[y+1]:n[y]}})}function q3(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,u,h){if(o!==void 0){const f=r?k1(e,r,u,s):e;if(h)return i?N1(o,f,t):Nt(o,t,f);const p=1e-9,y=Math.ceil(Math.log(e/f)/Math.log(n)-p),x=-l*(.5-p)+.5,I=Math.min(f,o),T=Math.floor(Math.log(e/I)/Math.log(n)+x),S=Math.max(y,T),b=e/Math.pow(n,S);return Nt(b,t,f)}})}function cC(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,u){if(s!==void 0){const h=i?k1(n,i,l,r):n;return!t||!u?Nt(s,e,h):N1(s,h,e)}})}function D1(n){if(n!==void 0)return 0}function uC(n){if(n!==void 0)return n}function X3(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function Y3(n){const e=Ko(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const Z3=42,M1=256,I_=0;class Qr extends us{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=g1(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&C2(),e.center&&(e.center=Ds(e.center,this.projection_)),e.extent&&(e.extent=Go(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in hr)delete t[l];this.setProperties(t,!0);const i=J3(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=Q3(e),s=i.constraint,o=e6(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ds(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ds(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&$g(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],p={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||$3,callback:i};if(f.center&&(p.sourceCenter=o,p.targetCenter=f.center.slice(),o=p.targetCenter),f.zoom!==void 0?(p.sourceResolution=l,p.targetResolution=this.getResolutionForZoom(f.zoom),l=p.targetResolution):f.resolution&&(p.sourceResolution=l,p.targetResolution=f.resolution,l=p.targetResolution),f.rotation!==void 0){p.sourceRotation=u;const y=ol(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=u+y,u=p.targetRotation}t6(p)?p.complete=!0:s+=p.duration,h.push(p)}this.animations_.push(h),this.setHint(Mn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Mn.ANIMATING]>0}getInteracting(){return this.hints_[Mn.INTERACTING]>0}cancelAnimations(){this.setHint(Mn.ANIMATING,-this.hints_[Mn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&$g(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let f=u.duration>0?h/u.duration:1;f>=1?(u.complete=!0,f=1):s=!1;const p=u.easing(f);if(u.sourceCenter){const y=u.sourceCenter[0],x=u.sourceCenter[1],I=u.targetCenter[0],T=u.targetCenter[1];this.nextCenter_=u.targetCenter;const S=y+p*(I-y),b=x+p*(T-x);this.targetCenter_=[S,b]}if(u.sourceResolution&&u.targetResolution){const y=p===1?u.targetResolution:u.sourceResolution+p*(u.targetResolution-u.sourceResolution);if(u.anchor){const x=this.getViewportSize_(this.getRotation()),I=this.constraints_.resolution(y,0,x,!0);this.targetCenter_=this.calculateCenterZoom(I,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const y=p===1?ol(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+p*(u.targetRotation-u.sourceRotation);if(u.anchor){const x=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(x,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Mn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&$g(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],c1(i,e-this.getRotation()),W5(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Av(e,this.getProjection())}getCenterInternal(){return this.get(hr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return R2(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();at(t,"The view center is not defined");const i=this.getResolution();at(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return at(r!==void 0,"The view rotation is not defined"),Tv(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(hr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Go(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=dt(e)/t[0],r=Bn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(hr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=C_(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=s1(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Nt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Nt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(at(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){at(!Om(e),"Cannot fit empty extent provided as `geometry`");const r=Go(e,this.getProjection());i=BI(r)}else if(e.getType()==="Circle"){const r=Go(e.getExtent(),this.getProjection());i=BI(r),i.rotate(this.getRotation(),fl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,u=1/0,h=-1/0,f=-1/0;for(let p=0,y=s.length;p<y;p+=o){const x=s[p]*i-s[p+1]*r,I=s[p]*r+s[p+1]*i;l=Math.min(l,x),u=Math.min(u,I),h=Math.max(h,x),f=Math.max(f,I)}return[l,u,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),f=Math.sin(h),p=Math.cos(h),y=fl(l);y[0]+=(r[1]-r[3])/2*u,y[1]+=(r[0]-r[2])/2*u;const x=y[0]*p-y[1]*f,I=y[1]*p+y[0]*f,T=this.getConstrainedCenter([x,I],u),S=t.callback?t.callback:wd;t.duration!==void 0?this.animateInternal({resolution:u,center:T,duration:t.duration,easing:t.easing},S):(this.targetResolution_=u,this.targetCenter_=T,this.applyTargetState_(!1,!0),$g(S,!0))}centerOn(e,t,i){this.centerOnInternal(Ds(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(C_(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),u=C_(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Av(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ds(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ds(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ds(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(hr.ROTATION)!==r&&this.set(hr.ROTATION,r),this.get(hr.RESOLUTION)!==o&&(this.set(hr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(hr.CENTER)||!Dp(this.get(hr.CENTER),l))&&this.set(hr.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Dp(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:e,easing:Nu,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Mn.INTERACTING,1)}endInteraction(e,t,i){i=i&&Ds(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Mn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function $g(n,e){setTimeout(function(){n(e)},0)}function Q3(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return lC(n.extent,n.constrainOnlyCenter,t)}const e=g1(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,lC(t,!1,!1)}return W3}function J3(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:I_,l=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,p=n.showFullExtent!==void 0?n.showFullExtent:!1,y=g1(n.projection,"EPSG:3857"),x=y.getExtent();let I=n.constrainOnlyCenter,T=n.extent;if(!h&&!T&&y.isGlobal()&&(I=!1,T=x),n.resolutions!==void 0){const S=n.resolutions;t=S[o],i=S[l]!==void 0?S[l]:S[S.length-1],n.constrainResolution?e=K3(S,f,!I&&T,p):e=cC(t,i,f,!I&&T,p)}else{const b=(x?Math.max(dt(x),Bn(x)):360*cu.degrees/y.getMetersPerUnit())/M1/Math.pow(2,I_),D=b/Math.pow(2,28-I_);t=n.maxResolution,t!==void 0?o=0:t=b/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,l):i=b/Math.pow(u,l):i=D),l=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,l-o),n.constrainResolution?e=q3(u,t,i,f,!I&&T,p):e=cC(t,i,f,!I&&T,p)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function e6(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?Y3():t===!1?uC:typeof t=="number"?X3(t):uC}return D1}function t6(n){return!(n.sourceCenter&&n.targetCenter&&!Dp(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function C_(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-u*o,f=u*s+l*o;return[h,f]}const ht={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class yP extends us{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[ht.OPACITY]=e.opacity!==void 0?e.opacity:1,at(typeof t[ht.OPACITY]=="number","Layer opacity must be a number"),t[ht.VISIBLE]=e.visible!==void 0?e.visible:!0,t[ht.Z_INDEX]=e.zIndex,t[ht.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[ht.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[ht.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[ht.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Nt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return tt()}getLayerStatesArray(e){return tt()}getExtent(){return this.get(ht.EXTENT)}getMaxResolution(){return this.get(ht.MAX_RESOLUTION)}getMinResolution(){return this.get(ht.MIN_RESOLUTION)}getMinZoom(){return this.get(ht.MIN_ZOOM)}getMaxZoom(){return this.get(ht.MAX_ZOOM)}getOpacity(){return this.get(ht.OPACITY)}getSourceState(){return tt()}getVisible(){return this.get(ht.VISIBLE)}getZIndex(){return this.get(ht.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(ht.EXTENT,e)}setMaxResolution(e){this.set(ht.MAX_RESOLUTION,e)}setMinResolution(e){this.set(ht.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(ht.MAX_ZOOM,e)}setMinZoom(e){this.set(ht.MIN_ZOOM,e)}setOpacity(e){at(typeof e=="number","Layer opacity must be a number"),this.set(ht.OPACITY,e)}setVisible(e){this.set(ht.VISIBLE,e)}setZIndex(e){this.set(ht.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class $m extends yP{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(ht.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(ht.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Rt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=nt(e,Be.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Qr?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return L1(r,t.viewState)&&(!s||si(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof Qr?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(ht.MAP,e)}getMapInternal(){return this.get(ht.MAP)}setMap(e){this.mapPrecomposeKey_&&(Rt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Rt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=nt(e,qi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=nt(this,Be.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);at(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(ht.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function L1(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const hC={RENDER_ORDER:"renderOrder"};class _P extends $m{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(hC.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new tP(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(hC.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?iP:e;const t=n6(e);this.styleFunction_=e===null?void 0:V4(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function n6(n){if(n===void 0)return iP;if(!n)return null;if(typeof n=="function"||n instanceof Zi)return n;if(!Array.isArray(n))return rC([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Zi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Zi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return k3(r)}return rC(n)}class O1 extends _P{constructor(e){super(e)}createRenderer(){return new s3(this)}}const bo={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Vo extends Zs{constructor(e,t){super(e),this.layer=t}}const R_={LAYERS:"layers"};class Du extends yP{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(R_.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Ki(i.slice(),{unique:!0}):at(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Ki(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Rt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(nt(e,ei.ADD,this.handleLayersAdd_,this),nt(e,ei.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Rt);tf(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new Vo(bo.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[nt(e,su.PROPERTYCHANGE,this.handleLayerChange_,this),nt(e,Be.CHANGE,this.handleLayerChange_,this)];e instanceof Du&&t.push(nt(e,bo.ADDLAYER,this.handleLayerGroupAdd_,this),nt(e,bo.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[it(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Vo(bo.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Vo(bo.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Vo(bo.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=it(t);this.listenerKeys_[i].forEach(Rt),delete this.listenerKeys_[i],this.dispatchEvent(new Vo(bo.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(R_.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Vo(bo.REMOVELAYER,i[r]))}this.set(R_.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=sl(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}}const Ce={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class F1 extends km{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Be.CHANGE)}release(){this.setState(Ce.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Ce.EMPTY){if(this.state!==Ce.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){tt()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:mP(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Ov(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const i6=new Error("disposed"),r6=[256,256];class dC extends F1{constructor(e){const t=Ce.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Ov(this.data_);return e?[e.width,e.height]:r6}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Ce.IDLE&&this.state!==Ce.ERROR)return;this.state=Ce.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Ce.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Ce.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(i6),this.controller_=null),super.disposeInternal()}}class vP extends F1{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Si?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Ce.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Ce.ERROR,this.unlistenImage_(),this.image_=s6(),this.changed()}handleImageLoad_(){if(Si)this.state=Ce.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Ce.LOADED:this.state=Ce.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Ce.ERROR&&(this.state=Ce.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ce.IDLE&&(this.state=Ce.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Jj(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function s6(){const n=Qt(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let A_;const Yc=[];function fC(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function b_(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function o6(){if(A_===void 0){const n=Qt(6,6,Yc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",fC(n,4,5,4,0),fC(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;A_=b_(e,0)||b_(e,4)||b_(e,8),Um(n),Yc.push(n.canvas)}return A_}function gC(n,e,t,i){const r=jm(t,e,n);let s=Op(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const u=n.getExtent();if(!u||lu(u,r)){const h=Op(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function a6(n,e,t,i){const r=fl(t);let s=gC(n,e,r,i);return(!isFinite(s)||s<=0)&&p2(t,function(o){return s=gC(n,e,o,i),isFinite(s)&&s>0}),s}function l6(n,e,t,i,r,s,o,l,u,h,f,p,y,x){const I=Qt(Math.round(t*n),Math.round(t*e),Yc);if(p||(I.imageSmoothingEnabled=!1),u.length===0)return I.canvas;I.scale(t,t);function T(F){return Math.round(F*t)/t}I.globalCompositeOperation="lighter";const S=Qi();u.forEach(function(F,G,k){F5(S,F.extent)});let b;const D=t/i,N=(p?1:1+Math.pow(2,-24))/D;b=Qt(Math.round(dt(S)*D),Math.round(Bn(S)*D),Yc),p||(b.imageSmoothingEnabled=!1),u.forEach(function(F,G,k){if(F.image.width>0&&F.image.height>0){if(F.clipExtent){b.save();const B=(F.clipExtent[0]-S[0])*D,M=-(F.clipExtent[3]-S[3])*D,se=dt(F.clipExtent)*D,he=Bn(F.clipExtent)*D;b.rect(p?B:Math.round(B),p?M:Math.round(M),p?se:Math.round(B+se)-Math.round(B),p?he:Math.round(M+he)-Math.round(M)),b.clip()}const R=(F.extent[0]-S[0])*D,P=-(F.extent[3]-S[3])*D,V=dt(F.extent)*D,j=Bn(F.extent)*D;b.drawImage(F.image,h,h,F.image.width-2*h,F.image.height-2*h,p?R:Math.round(R),p?P:Math.round(P),p?V:Math.round(R+V)-Math.round(R),p?j:Math.round(P+j)-Math.round(P)),F.clipExtent&&b.restore()}});const L=Pl(o);return l.getTriangles().forEach(function(F,G,k){const R=F.source,P=F.target;let V=R[0][0],j=R[0][1],B=R[1][0],M=R[1][1],se=R[2][0],he=R[2][1];const ge=T((P[0][0]-L[0])/s),ue=T(-(P[0][1]-L[1])/s),Q=T((P[1][0]-L[0])/s),re=T(-(P[1][1]-L[1])/s),ne=T((P[2][0]-L[0])/s),U=T(-(P[2][1]-L[1])/s),$=V,ie=j;V=0,j=0,B-=$,M-=ie,se-=$,he-=ie;const me=[[B,M,0,0,Q-ge],[se,he,0,0,ne-ge],[0,0,B,M,re-ue],[0,0,se,he,U-ue]],xe=G5(me);if(!xe)return;if(I.save(),I.beginPath(),o6()||!p){I.moveTo(Q,re);const Me=4,Ve=ge-Q,We=ue-re;for(let lt=0;lt<Me;lt++)I.lineTo(Q+T((lt+1)*Ve/Me),re+T(lt*We/(Me-1))),lt!=Me-1&&I.lineTo(Q+T((lt+1)*Ve/Me),re+T((lt+1)*We/(Me-1)));I.lineTo(ne,U)}else I.moveTo(Q,re),I.lineTo(ge,ue),I.lineTo(ne,U);I.clip(),I.transform(xe[0],xe[2],xe[1],xe[3],ge,ue),I.translate(S[0]-$,S[3]-ie);let ke;if(b)ke=b.canvas,I.scale(N,-N);else{const Me=u[0],Ve=Me.extent;ke=Me.image,I.scale(dt(Ve)/ke.width,-Bn(Ve)/ke.height)}I.drawImage(ke,0,0),I.restore()}),b&&(Um(b),Yc.push(b.canvas)),f&&(I.save(),I.globalCompositeOperation="source-over",I.strokeStyle="black",I.lineWidth=1,l.getTriangles().forEach(function(F,G,k){const R=F.target,P=(R[0][0]-L[0])/s,V=-(R[0][1]-L[1])/s,j=(R[1][0]-L[0])/s,B=-(R[1][1]-L[1])/s,M=(R[2][0]-L[0])/s,se=-(R[2][1]-L[1])/s;I.beginPath(),I.moveTo(j,B),I.lineTo(P,V),I.lineTo(M,se),I.closePath(),I.stroke()}),I.restore()),I.canvas}const c6=10,pC=.25;class u6{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let u={};const h=l?xj(N=>un(l,jm(N,this.targetProj_,this.sourceProj_))):Fp(this.targetProj_,this.sourceProj_);this.transformInv_=function(N){const L=N[0]+"/"+N[1];return u[L]||(u[L]=h(N)),u[L]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&dt(r)>=dt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?dt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?dt(this.targetProj_.getExtent()):null;const f=Pl(i),p=Lm(i),y=Mm(i),x=Dm(i),I=this.transformInv_(f),T=this.transformInv_(p),S=this.transformInv_(y),b=this.transformInv_(x),D=c6+(o?Math.max(0,Math.ceil(Math.log2(Ev(i)/(o*o*256*256)))):0);if(this.addQuad_(f,p,y,x,I,T,S,b,D),this.wrapsXInSource_){let N=1/0;this.triangles_.forEach(function(L,F,G){N=Math.min(N,L.source[0][0],L.source[1][0],L.source[2][0])}),this.triangles_.forEach(L=>{if(Math.max(L.source[0][0],L.source[1][0],L.source[2][0])-N>this.sourceWorldWidth_/2){const F=[[L.source[0][0],L.source[0][1]],[L.source[1][0],L.source[1][1]],[L.source[2][0],L.source[2][1]]];F[0][0]-N>this.sourceWorldWidth_/2&&(F[0][0]-=this.sourceWorldWidth_),F[1][0]-N>this.sourceWorldWidth_/2&&(F[1][0]-=this.sourceWorldWidth_),F[2][0]-N>this.sourceWorldWidth_/2&&(F[2][0]-=this.sourceWorldWidth_);const G=Math.min(F[0][0],F[1][0],F[2][0]);Math.max(F[0][0],F[1][0],F[2][0])-G<this.sourceWorldWidth_/2&&(L.source=F)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,u,h){const f=pI([s,o,l,u]),p=this.sourceWorldWidth_?dt(f)/this.sourceWorldWidth_:null,y=this.sourceWorldWidth_,x=this.sourceProj_.canWrapX()&&p>.5&&p<1;let I=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const S=pI([e,t,i,r]);I=dt(S)/this.targetWorldWidth_>pC||I}!x&&this.sourceProj_.isGlobal()&&p&&(I=p>pC||I)}if(!I&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!si(f,this.maxSourceExtent_))return;let T=0;if(!I&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)I=!0;else if(T=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),T!=1&&T!=2&&T!=4&&T!=8)return}if(h>0){if(!I){const S=[(e[0]+i[0])/2,(e[1]+i[1])/2],b=this.transformInv_(S);let D;x?D=(ol(s[0],y)+ol(l[0],y))/2-ol(b[0],y):D=(s[0]+l[0])/2-b[0];const N=(s[1]+l[1])/2-b[1];I=D*D+N*N>this.errorThresholdSquared_}if(I){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const S=[(t[0]+i[0])/2,(t[1]+i[1])/2],b=this.transformInv_(S),D=[(r[0]+e[0])/2,(r[1]+e[1])/2],N=this.transformInv_(D);this.addQuad_(e,t,S,D,s,o,b,N,h-1),this.addQuad_(D,S,i,r,N,b,l,u,h-1)}else{const S=[(e[0]+t[0])/2,(e[1]+t[1])/2],b=this.transformInv_(S),D=[(i[0]+r[0])/2,(i[1]+r[1])/2],N=this.transformInv_(D);this.addQuad_(e,S,D,r,s,b,N,u,h-1),this.addQuad_(S,t,i,D,b,o,l,N,h-1)}return}}if(x){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(T&11)==0&&this.addTriangle_(e,i,r,s,l,u),(T&14)==0&&this.addTriangle_(e,i,t,s,l,o),T&&((T&13)==0&&this.addTriangle_(t,r,e,o,u,s),(T&7)==0&&this.addTriangle_(t,r,i,o,u,l))}calculateSourceExtent(){const e=Qi();return this.triangles_.forEach(function(t,i,r){const s=t.source;td(e,s[0]),td(e,s[1]),td(e,s[2])}),e}getTriangles(){return this.triangles_}}const h6=.5;class xP extends F1{constructor(e,t,i,r,s,o,l,u,h,f,p,y){super(s,Ce.IDLE,y),this.renderEdges_=p!==void 0?p:!1,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const x=r.getTileCoordExtent(this.wrappedTileCoord_),I=this.targetTileGrid_.getExtent();let T=this.sourceTileGrid_.getExtent();const S=I?sl(x,I):x;if(Ev(S)===0){this.state=Ce.EMPTY;return}const b=e.getExtent();b&&(T?T=sl(T,b):T=b);const D=r.getResolution(this.wrappedTileCoord_[0]),N=a6(e,i,S,D);if(!isFinite(N)||N<=0){this.state=Ce.EMPTY;return}const L=f!==void 0?f:h6;if(this.triangulation_=new u6(e,i,S,T,N*L,D),this.triangulation_.getTriangles().length===0){this.state=Ce.EMPTY;return}this.sourceZ_=t.getZForResolution(N);let F=this.triangulation_.calculateSourceExtent();if(T&&(e.canWrapX()?(F[1]=Nt(F[1],T[1],T[3]),F[3]=Nt(F[3],T[1],T[3])):F=sl(F,T)),!Ev(F))this.state=Ce.EMPTY;else{let G=0,k=0;e.canWrapX()&&(G=dt(b),k=Math.floor((F[0]-b[0])/G)),_2(F.slice(),e,!0).forEach(P=>{const V=t.getTileRangeForExtentAndZ(P,this.sourceZ_);for(let j=V.minX;j<=V.maxX;j++)for(let B=V.minY;B<=V.maxY;B++){const M=h(this.sourceZ_,j,B,l);if(M){const se=k*G;this.sourceTiles_.push({tile:M,offset:se})}}++k}),this.sourceTiles_.length===0&&(this.state=Ce.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Ce.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Ce.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=l6(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Ce.LOADED}this.changed()}load(){if(this.state==Ce.IDLE){this.state=Ce.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Ce.IDLE||i==Ce.LOADING){e++;const r=nt(t,Be.CHANGE,s=>{const o=t.getState();(o==Ce.LOADED||o==Ce.ERROR||o==Ce.EMPTY)&&(Rt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Ce.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Rt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Um(this.canvas_.getContext("2d")),Yc.push(this.canvas_),this.canvas_=null),super.release()}}class V1{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Ec(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new V1(n,e,t,i)}class mC{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof bm&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return at(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return at(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){at(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function $p(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function d6(n,e,t){return n+"/"+e+"/"+t}function up(n,e,t,i,r){return`${it(n)},${e},${d6(t,i,r)}`}function f6(n){return g6(n[0],n[1],n[2])}function g6(n,e,t){return(e<<n)+t}function p6(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function P_(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function m6(n,e,t){const i=n[t];return i?i.delete(e):!1}function yC(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=sl(e,Go(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=sl(e,r))}return e}class y6 extends lP{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Qi(),this.tempTileRange_=new V1(0,0,0,0),this.tempTileCoord_=$p(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new mC(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new mC(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),u=up(l,l.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const f=r.viewState.projection,p=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!p||cp(p,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=un(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!lu(s,r))return null;const o=t.viewState,l=i.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const p=u.getTileCoordForCoordAndZ(r,f),y=this.getTile(f,p[1],p[2],t);if(!y||y.getState()!==Ce.LOADED)continue;const x=u.getOrigin(f),I=ai(u.getTileSize(f)),T=u.getResolution(f);let S;if(y instanceof vP||y instanceof xP)S=y.getImage();else if(y instanceof dC){if(S=Ov(y.getData()),!S)continue}else continue;const b=Math.floor(h*((r[0]-x[0])/T-p[1]*I[0])),D=Math.floor(h*((x[1]-r[1])/T-p[2]*I[1])),N=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(S,b+N,D+N)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(o.projection),f=it(u);f in e.wantedTiles||(e.wantedTiles[f]={});const p=e.wantedTiles[f],y=l.getMapInternal(),x=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),y?y.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),I=o.rotation,T=I?m2(o.center,o.resolution,I,e.size):void 0;for(let S=i;S>=x;--S){const b=h.getTileRangeForExtentAndZ(t,S,this.tempTileRange_),D=h.getResolution(S);for(let N=b.minX;N<=b.maxX;++N)for(let L=b.minY;L<=b.maxY;++L){if(I&&!h.tileCoordIntersectsViewport([S,N,L],T))continue;const F=this.getTile(S,N,L,e);if(!F||!P_(r,F,S))continue;const k=F.getKey();if(p[k]=!0,F.getState()===Ce.IDLE&&!e.tileQueue.isKeyQueued(k)){const R=$p(S,N,L,this.tempTileCoord_);e.tileQueue.enqueue([F,f,h.getTileCoordCenter(R),D])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let u=0;u<l.length;++u){const h=up(this.getLayer().getSource(),l[u],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Ce.LOADED)return f.endTransition(it(this)),P_(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let p=s.minY;p<=s.maxY;++p){const y=up(u,h,i,f,p);let x=!1;if(l.containsKey(y)){const I=l.peek(y);I.getState()===Ce.LOADED&&(P_(r,I,i),x=!0)}x||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,u=e.pixelRatio,h=this.getLayer(),f=h.getSource(),p=f.getTileGridForProjection(s),y=p.getZForResolution(o,f.zDirection),x=p.getResolution(y),I=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==I&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=I):this.renderedSourceKey_=I;let T=e.extent;const S=f.getTilePixelRatio(u);this.prepareContainer(e,t);const b=this.context.canvas.width,D=this.context.canvas.height,N=i.extent&&Go(i.extent);N&&(T=sl(T,Go(i.extent)));const L=x*b/2/S,F=x*D/2/S,G=[l[0]-L,l[1]-F,l[0]+L,l[1]+F],k={};this.renderedTiles.length=0;const R=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const Q=p.getZForResolution(r.nextResolution,f.zDirection),re=yC(e,e.nextExtent);this.enqueueTiles(e,re,Q,k,R)}const P=yC(e,T);if(this.enqueueTiles(e,P,y,k,0),R>0&&setTimeout(()=>{this.enqueueTiles(e,P,y-1,k,R-1)},0),!(y in k))return this.container;const V=it(this),j=e.time;for(const Q of k[y]){const re=Q.getState();if(re===Ce.EMPTY)continue;const ne=Q.tileCoord;if(re===Ce.LOADED&&Q.getAlpha(V,j)===1){Q.endTransition(V);continue}if(re!==Ce.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,k)){m6(k,Q,y),e.animate=!0;continue}if(this.findAltTiles_(p,ne,y+1,k))continue;const ie=p.getMinZoom();for(let me=y-1;me>=ie&&!this.findAltTiles_(p,ne,me,k);--me);}const B=x/o*u/S,M=this.getRenderContext(e);Ks(this.tempTransform,b/2,D/2,B,B,0,-b/2,-D/2),i.extent&&this.clipUnrotated(M,e,N),f.getInterpolate()||(M.imageSmoothingEnabled=!1),this.preRender(M,e);const se=Object.keys(k).map(Number);se.sort(Bs);let he;const ge=[],ue=[];for(let Q=se.length-1;Q>=0;--Q){const re=se[Q],ne=f.getTilePixelSize(re,u,s),$=p.getResolution(re)/x,ie=ne[0]*$*B,me=ne[1]*$*B,xe=p.getTileCoordForCoordAndZ(Pl(G),re),ke=p.getTileCoordExtent(xe),Me=un(this.tempTransform,[S*(ke[0]-G[0])/x,S*(G[3]-ke[3])/x]),Ve=S*f.getGutterForProjection(s);for(const We of k[re]){if(We.getState()!==Ce.LOADED)continue;const lt=We.tileCoord,er=xe[1]-lt[1],fs=Math.round(Me[0]-(er-1)*ie),Wn=xe[2]-lt[2],$n=Math.round(Me[1]-(Wn-1)*me),hn=Math.round(Me[0]-er*ie),dn=Math.round(Me[1]-Wn*me),Hn=fs-hn,bi=$n-dn,yt=se.length===1;let ct=!1;he=[hn,dn,hn+Hn,dn,hn+Hn,dn+bi,hn,dn+bi];for(let tn=0,Pi=ge.length;tn<Pi;++tn)if(!yt&&re<ue[tn]){const St=ge[tn];si([hn,dn,hn+Hn,dn+bi],[St[0],St[3],St[4],St[7]])&&(ct||(M.save(),ct=!0),M.beginPath(),M.moveTo(he[0],he[1]),M.lineTo(he[2],he[3]),M.lineTo(he[4],he[5]),M.lineTo(he[6],he[7]),M.moveTo(St[6],St[7]),M.lineTo(St[4],St[5]),M.lineTo(St[2],St[3]),M.lineTo(St[0],St[1]),M.clip())}ge.push(he),ue.push(re),this.drawTile(We,e,hn,dn,Hn,bi,Ve,yt),ct&&M.restore(),this.renderedTiles.unshift(We),this.updateUsedTiles(e.usedTiles,f,We)}}if(this.renderedResolution=x,this.extentChanged=!this.renderedExtent_||!Ed(this.renderedExtent_,G),this.renderedExtent_=G,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&M.restore(),M.imageSmoothingEnabled=!0,this.renderComplete){const Q=(re,ne)=>{const U=it(f),$=ne.wantedTiles[U],ie=$?Object.keys($).length:0;this.updateCacheSize(ie),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(Q)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,u){let h;if(e instanceof dC){if(h=Ov(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),p=it(this),y=t.layerStatesArray[t.layerIndex],x=y.opacity*(u?e.getAlpha(p,t.time):1),I=x!==f.globalAlpha;I&&(f.save(),f.globalAlpha=x),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),I&&f.restore(),x!==y.opacity?t.animate=!0:u&&e.endTransition(p)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=it(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Hg={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class _6 extends $m{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Hg.PRELOAD)}setPreload(e){this.set(Hg.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Hg.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Hg.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class k_ extends _6{constructor(e){super(e)}createRenderer(){return new y6(this,{cacheSize:this.getCacheSize()})}}const Tc=[0,0,0],Po=5;class wP{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,at(N5(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,at(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Pl(i)),at(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,at(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:M1,at(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new V1(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,u=r.maxY;l<=u;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Ec(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Ec(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Ec(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),f=Math.floor(o*u);if(t<r)return Ec(h,h,f,f,i);const p=Math.floor(u*(s+1))-1,y=Math.floor(u*(o+1))-1;return Ec(h,p,f,y,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Tc);const r=Tc[1],s=Tc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Tc);const o=Tc[1],l=Tc[2];return Ec(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=ai(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=ai(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=l+s[1]*r;return ta(o,l,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),u=this.getOrigin(o),h=ai(this.getTileSize(o),this.tmpSize_);let f=l*(e-u[0])/i/h[0],p=l*(u[1]-t)/i/h[1];return r?(f=Fg(f,Po)-1,p=Fg(p,Po)-1):(f=Og(f,Po),p=Og(p,Po)),$p(o,f,p,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),u=ai(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/u[0],f=(o[1]-t)/l/u[1];return r?(h=Fg(h,Po)-1,f=Fg(f,Po)-1):(h=Og(h,Po),f=Og(f,Po)),$p(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=s1(this.resolutions_,e,t||0);return Nt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return O2(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function EP(n){let e=n.getDefaultTileGrid();return e||(e=E6(n),n.setDefaultTileGrid(e)),e}function v6(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=j1(t);if(!lu(s,r)){const o=dt(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function x6(n,e,t,i){i=i!==void 0?i:"top-left";const r=TP(n,e,t);return new wP({extent:n,origin:j5(n,i),resolutions:r,tileSize:t})}function w6(n){const e=n||{},t=e.extent||li("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:TP(t,e.maxZoom,e.tileSize,e.maxResolution)};return new wP(i)}function TP(n,e,t,i){e=e!==void 0?e:Z3,t=ai(t!==void 0?t:M1);const r=Bn(n),s=dt(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let u=0;u<o;++u)l[u]=i/Math.pow(2,u);return l}function E6(n,e,t,i){const r=j1(n);return x6(r,e,t,i)}function j1(n){n=li(n);let e=n.getExtent();if(!e){const t=180*cu.degrees/n.getMetersPerUnit();e=ta(-t,-t,t,t)}return e}function kq(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const T6=/\{z\}/g,S6=/\{x\}/g,I6=/\{y\}/g,C6=/\{-y\}/g;function R6(n,e,t,i,r){return n.replace(T6,e.toString()).replace(S6,t.toString()).replace(I6,i.toString()).replace(C6,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function A6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function b6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return R6(n,o,t[1],t[2],s)})}function P6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=b6(n[r],e);return k6(i)}function k6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=f6(e),s=ol(r,n.length);return n[s](e,t,i)})}class N6 extends nP{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&ai(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||it(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return tt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:EP(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=ai(r.getTileSize(e),this.tmpSize);return s==1?o:F4(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=v6(r,e,i)),p6(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class D6 extends Zs{constructor(e,t){super(e),this.tile=t}}const N_={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class U1 extends N6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===U1.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=it(t),r=t.getState();let s;r==Ce.LOADING?(this.tileLoadingKeys_[i]=!0,s=N_.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Ce.ERROR?N_.TILELOADERROR:r==Ce.LOADED?N_.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new D6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=A6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(P6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class M6 extends U1{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:SP,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:vP,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!cp(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||cp(t,e)))return this.tileGrid;const i=it(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=EP(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(l,h!==void 0?Ce.IDLE:Ce.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(Be.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||cp(l,s))return this.getTileInternal(e,t,i,r,l||s);const u=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),p=this.getTileGridForProjection(s),y=this.getTileCoordForTileUrlFunction(u,s),x=new xP(l,f,s,p,u,y,this.getTilePixelRatio(r),this.getGutter(),(I,T,S,b)=>this.getTileInternal(I,T,S,b,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return x.key=h,x}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),u=up(this,l,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,l);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=li(e);if(i){const r=it(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function SP(n,e){if(Si){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Fv extends M6{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:w6({extent:j1(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const L6="modulepreload",O6=function(n){return"/visapp/"+n},_C={},Kg=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=O6(h),h in _C)return;_C[h]=!0;const f=h.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":L6,f||(y.as="script"),y.crossOrigin="",y.href=h,l&&y.setAttribute("nonce",l),document.head.appendChild(y),f)return new Promise((x,I)=>{y.addEventListener("load",x),y.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},F6='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class V6 extends Fv{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[F6];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Si&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||SP)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const Hp=1/0;class j6{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,tf(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){at(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=Hp?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[u]?h:u;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,u;for(l=0;l<s;++l)o=t[l],u=e(o),u==Hp?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class U6 extends j6{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Be.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Ce.LOADED||i===Ce.ERROR||i===Ce.EMPTY){i!==Ce.ERROR&&t.removeEventListener(Be.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Ce.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function z6(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Hp;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Mc extends Zs{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Oo extends Mc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Mt={SINGLECLICK:"singleclick",CLICK:Be.CLICK,DBLCLICK:Be.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Vv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class B6 extends km{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=nt(i,Vv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=nt(i,Vv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Be.TOUCHMOVE,this.boundHandleTouchMove_,U2?{passive:!1}:!1)}emulateClick_(e){let t=new Oo(Mt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Oo(Mt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Oo(Mt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Mt.POINTERUP||t.type==Mt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Mt.POINTERDOWN||t.type==Mt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Oo(Mt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Oo(Mt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(nt(i,Mt.POINTERMOVE,this.handlePointerMove_,this),nt(i,Mt.POINTERUP,this.handlePointerUp_,this),nt(this.element_,Mt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(nt(this.element_.getRootNode(),Mt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Oo(Mt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Oo(Mt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Rt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Be.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Rt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Fo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Nn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Hm extends us{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Rt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==wd&&this.listenerKeys.push(nt(e,Fo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class G6 extends Hm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(Be.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+of+" "+S1+(this.collapsed_&&this.collapsible_?" "+LI:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>D5(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!aa(t,this.renderedAttributions_)){Bj(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(LI),this.collapsed_?DI(this.collapseLabel_,this.label_):DI(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class W6 extends Hm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Be.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+of+" "+S1,u=this.element;u.className=l,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ug)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Nu}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Ug);!s&&i===0?this.element.classList.add(Ug):s&&i!==0&&this.element.classList.remove(Ug)}this.label_.style.transform=r}this.rotation_=i}}class $6 extends Hm{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Be.CLICK,this.handleClick_.bind(this,i),!1);const p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=h,p.appendChild(typeof l=="string"?document.createTextNode(l):l),p.addEventListener(Be.CLICK,this.handleClick_.bind(this,-i),!1);const y=t+" "+of+" "+S1,x=this.element;x.className=y,x.appendChild(f),x.appendChild(p),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Nu})):i.setZoom(s)}}}function H6(n){n=n||{};const e=new Ki;return(n.zoom===void 0||n.zoom)&&e.push(new $6(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new W6(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new G6(n.attributionOptions)),e}class K6{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const vC={ACTIVE:"active"};class uf extends us{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(vC.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(vC.ACTIVE,e)}setMap(e){this.map_=e}}function q6(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:H3,center:n.getConstrainedCenter(r)})}}function z1(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Nu})}class X6 extends uf{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Mt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();z1(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function jv(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const Y6=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Z6=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},IP=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?Z6(n):!0},Q6=xd,CP=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(Uj&&V2&&e.ctrlKey)},RP=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},J6=function(n){const e=n.originalEvent;return V2?e.metaKey:e.ctrlKey},e9=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},AP=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},D_=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},t9=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class hf extends uf{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Mt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Mt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Mt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Mt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function B1(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class n9 extends hf{constructor(e){super({stopDown:Pm}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:jv(RP,t9);this.condition_=e.onFocusOnly?jv(IP,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(B1(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();$5(s,l.getResolution()),c1(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:Nu})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class i9 extends hf{constructor(e){e=e||{},super({stopDown:Pm}),this.condition_=e.condition?e.condition:Y6,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!D_(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===D1)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return D_(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return D_(e)&&CP(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class r9 extends bm{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new bd([r])}getGeometry(){return this.geometry_}}const Sc={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ph extends Zs{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class s9 extends hf{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new r9(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??CP,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ph(Sc.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Ph(t?Sc.BOXEND:Sc.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ph(Sc.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Sc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Sc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class o9 extends s9{constructor(e){e=e||{};const t=e.condition?e.condition:e9;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:Nu})}}const Oa={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class a9 extends uf{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return RP(t)&&AP(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Be.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Oa.DOWN||r==Oa.LEFT||r==Oa.RIGHT||r==Oa.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==Oa.DOWN?h=-l:r==Oa.LEFT?u=-l:r==Oa.RIGHT?u=l:h=l;const f=[u,h];c1(f,o.getRotation()),q6(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class l9 extends uf{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!J6(t)&&AP(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Be.KEYDOWN||e.type==Be.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();z1(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const c9=40,u9=300;class h9 extends uf{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:Q6;this.condition_=e.onFocusOnly?jv(IP,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Be.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=c9;break;case WheelEvent.DOM_DELTA_PAGE:s*=u9;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Nt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),z1(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class d9 extends hf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Pm),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==D1&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(B1(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class f9 extends hf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Pm),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(B1(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function g9(n){n=n||{};const e=new Ki,t=new K6(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new i9),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new X6({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new n9({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new d9),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new f9({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new a9),e.push(new l9({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new h9({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new o9({duration:n.zoomDuration})),e}class p9 extends bm{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){tt()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Ks(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),A2(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,u){let h;const f=t.viewState;function p(L,F,G,k){return s.call(o,F,L?G:null,k)}const y=f.projection,x=v2(e.slice(),y),I=[[0,0]];if(y.canWrapX()&&r){const L=y.getExtent(),F=dt(L);I.push([-F,0],[F,0])}const T=t.layerStatesArray,S=T.length,b=[],D=[];for(let L=0;L<I.length;L++)for(let F=S-1;F>=0;--F){const G=T[F],k=G.layer;if(k.hasRenderer()&&L1(G,f)&&l.call(u,k)){const R=k.getRenderer(),P=k.getSource();if(R&&P){const V=P.getWrapX()?x:e,j=p.bind(null,G.managed);D[0]=V[0]+I[L][0],D[1]=V[1]+I[L][1],h=R.forEachFeatureAtCoordinate(D,t,i,j,b)}if(h)return h}}if(b.length===0)return;const N=1/b.length;return b.forEach((L,F)=>L.distanceSq+=F*N),b.sort((L,F)=>L.distanceSq-F.distanceSq),b.some(L=>h=L.callback(L.feature,L.layer,L.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,xd,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){tt()}scheduleExpireIconCache(e){Xi.canExpireCache()&&e.postRenderFunctions.push(m9)}}function m9(n,e){Xi.expire()}class y9 extends p9{constructor(e){super(e),this.fontChangeListenerKey_=nt(kc,su.PROPERTYCHANGE,e.redrawText,e),this.element_=Si?z2():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=of+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new aP(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Rt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(qi.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof _P&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const p=t[h];e.layerIndex=h;const y=p.layer,x=y.getSourceState();if(!L1(p,r)||x!="ready"&&x!="undefined"){y.unrender();continue}const I=y.render(e,o);I&&(I!==o&&(this.children_.push(I),o=I),s.push(p))}this.declutter(e,s),Gj(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Wo(u)){const h=u.getContext("2d");for(const f of this.children_){const p=f.firstElementChild||f,y=f.style.backgroundColor;if(y&&(!Wo(p)||p.width>0)&&(h.fillStyle=y,h.fillRect(0,0,u.width,u.height)),Wo(p)&&p.width>0){const x=f.style.opacity||p.style.opacity;h.globalAlpha=x===""?1:Number(x);const I=p.style.transform;if(I)h.setTransform(...bv(I));else{const T=parseFloat(p.style.width)/p.width,S=parseFloat(p.style.height)/p.height;h.setTransform(T,0,0,S,0,0)}h.drawImage(p,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(qi.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function bP(n){if(n instanceof $m){n.setMapInternal(null);return}n instanceof Du&&n.getLayers().forEach(bP)}function PP(n,e){if(n instanceof $m){n.setMapInternal(e);return}if(n instanceof Du){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)PP(t[i],e)}}let _9=class extends us{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=v9(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:zj,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Er(),this.pixelToCoordinateTransform_=Er(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Si||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Si||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Si?new Ki:H6()),this.interactions=t.interactions||(Si?new Ki:g9({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new U6(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Nn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Nn.VIEW,this.handleViewChanged_),this.addChangeListener(Nn.SIZE,this.handleSizeChanged_),this.addChangeListener(Nn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Qr)&&e.view.then(function(r){i.setView(new Qr(r))}),this.controls.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(ei.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(ei.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){PP(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:xd,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof Du?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:xd,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(Nn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Av(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?un(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Nn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ki){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ds(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?un(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Nn.SIZE)}getView(){return this.get(Nn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return z6(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Oo(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Vv.POINTERDOWN||i===Be.WHEEL||i===Be.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Mn.ANIMATING]||o[Mn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(qi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(qi.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Mc(Fo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Mc(Fo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Rt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Be.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Be.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Wo(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Wo(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new y9(this)),!Wo(t)){this.mapBrowserEventHandler_=new B6(this,this.moveTolerance_);for(const r in Mt)this.mapBrowserEventHandler_.addEventListener(Mt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Be.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Be.WHEEL,this.boundHandleBrowserEvent_,U2?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[nt(i,Be.KEYDOWN,this.handleBrowserEvent,this),nt(i,Be.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Rt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Rt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=nt(e,su.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=nt(e,Be.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Rt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Vo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[nt(e,su.PROPERTYCHANGE,this.render,this),nt(e,Be.CHANGE,this.render,this),nt(e,"addlayer",this.handleLayerAdd_,this),nt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){bP(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&KI(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Tv(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:it(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=Tv(l.nextCenter,l.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Om(this.previousExtent_)&&!Ed(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Mc(Fo.MOVESTART,this,r)),this.previousExtent_=Nm(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Mn.ANIMATING]&&!s.viewHints[Mn.INTERACTING]&&!Ed(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Mc(Fo.MOVEEND,this,s)),u2(s.extent,this.previousExtent_))),this.dispatchEvent(new Mc(Fo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Fo.LOADSTART)||this.hasListener(Fo.LOADEND)||this.hasListener(qi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Vo("removelayer",t)),this.set(Nn.LAYERGROUP,e)}setSize(e){this.set(Nn.SIZE,e)}setTarget(e){this.set(Nn.TARGET,e)}setView(e){if(!e||e instanceof Qr){this.set(Nn.VIEW,e);return}this.set(Nn.VIEW,new Qr);const t=this;e.then(function(i){t.setView(new Qr(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Wo(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!KI(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&x2("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!aa(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function v9(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Du({layers:n.layers});t[Nn.LAYERGROUP]=i,t[Nn.TARGET]=n.target,t[Nn.VIEW]=n.view instanceof Qr?n.view:new Qr;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Ki(n.controls.slice()):(at(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Ki(n.interactions.slice()):(at(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Ki(n.overlays.slice()):(at(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Ki,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const M_="units",x9=[1,2,5],kh=25.4/.28;class w9 extends Hm{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+of,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(M_,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(M_)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(M_,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Op(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||kh)/kh,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||kh)/kh:void 0;let h=l*o,f="";if(r=="degrees"){const N=cu.degrees;h*=N,h<N/60?(f="",o*=3600):h<N?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let p=3*Math.floor(Math.log(l*o)/Math.log(10)),y,x,I,T=0,S,b;for(;;){I=Math.floor(p/3);const N=Math.pow(10,I);if(y=x9[(p%3+3)%3]*N,x=Math.round(y/o),isNaN(x)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&x>=u){y=T,x=S,I=b;break}else if(x>=l)break;T=y,S=x,b=I,++p}const D=this.scaleBar_?this.createScaleBar(x,y,f):y.toFixed(I<0?-I:0)+" "+f;this.renderedHTML_!=D&&(this.innerElement_.innerHTML=D,this.renderedHTML_=D),this.renderedWidth_!=x&&(this.innerElement_.style.width=x+"px",this.renderedWidth_=x),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,u=[this.createMarker("absolute")];for(let f=0;f<o;++f){const p=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${p}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return u.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),u=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=Op(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||kh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const E9={},xC=n=>{let e;const t=new Set,i=(f,p)=>{const y=typeof f=="function"?f(e):f;if(!Object.is(y,e)){const x=e;e=p??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(I=>I(e,x))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(E9?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},T9=n=>n?xC(n):xC;var L_={exports:{}},O_={},F_={exports:{}},V_={};var wC;function S9(){if(wC)return V_;wC=1;var n=Yd();function e(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(p,y){var x=y(),I=i({inst:{value:x,getSnapshot:y}}),T=I[0].inst,S=I[1];return s(function(){T.value=x,T.getSnapshot=y,u(T)&&S({inst:T})},[p,x,y]),r(function(){return u(T)&&S({inst:T}),p(function(){u(T)&&S({inst:T})})},[p]),o(x),x}function u(p){var y=p.getSnapshot;p=p.value;try{var x=y();return!t(p,x)}catch{return!0}}function h(p,y){return y()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return V_.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,V_}var EC;function I9(){return EC||(EC=1,F_.exports=S9()),F_.exports}var TC;function C9(){if(TC)return O_;TC=1;var n=Yd(),e=I9();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return O_.useSyncExternalStoreWithSelector=function(h,f,p,y,x){var I=s(null);if(I.current===null){var T={hasValue:!1,value:null};I.current=T}else T=I.current;I=l(function(){function b(G){if(!D){if(D=!0,N=G,G=y(G),x!==void 0&&T.hasValue){var k=T.value;if(x(k,G))return L=k}return L=G}if(k=L,i(N,G))return k;var R=y(G);return x!==void 0&&x(k,R)?(N=G,k):(N=G,L=R)}var D=!1,N,L,F=p===void 0?null:p;return[function(){return b(f())},F===null?void 0:function(){return b(F())}]},[f,p,y,x]);var S=r(h,I[0],I[1]);return o(function(){T.hasValue=!0,T.value=S},[S]),u(S),S},O_}var SC;function R9(){return SC||(SC=1,L_.exports=C9()),L_.exports}var A9=R9();const b9=Sx(A9),kP={},{useDebugValue:P9}=nL,{useSyncExternalStoreWithSelector:k9}=b9;let IC=!1;const N9=n=>n;function D9(n,e=N9,t){(kP?"production":void 0)!=="production"&&t&&!IC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),IC=!0);const i=k9(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return P9(i),i}const CC=n=>{(kP?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?T9(n):n,t=(i,r)=>D9(e,i,r);return Object.assign(t,e),t},Rr=n=>n?CC(n):CC;var NP=Symbol.for("immer-nothing"),RC=Symbol.for("immer-draftable"),Ri=Symbol.for("immer-state");function mr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Nd=Object.getPrototypeOf;function gu(n){return!!n&&!!n[Ri]}function _l(n){return n?DP(n)||Array.isArray(n)||!!n[RC]||!!n.constructor?.[RC]||df(n)||qm(n):!1}var M9=Object.prototype.constructor.toString(),AC=new WeakMap;function DP(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=AC.get(t);return i===void 0&&(i=Function.toString.call(t),AC.set(t,i)),i===M9}function Kp(n,e,t=!0){Km(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function Km(n){const e=n[Ri];return e?e.type_:Array.isArray(n)?1:df(n)?2:qm(n)?3:0}function Uv(n,e){return Km(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function MP(n,e,t){const i=Km(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function L9(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function df(n){return n instanceof Map}function qm(n){return n instanceof Set}function za(n){return n.copy_||n.base_}function zv(n,e){if(df(n))return new Map(n);if(qm(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=DP(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Ri];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Nd(n),i)}else{const i=Nd(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function G1(n,e=!1){return Xm(n)||gu(n)||!_l(n)||(Km(n)>1&&Object.defineProperties(n,{set:qg,add:qg,clear:qg,delete:qg}),Object.freeze(n),e&&Object.values(n).forEach(t=>G1(t,!0))),n}function O9(){mr(2)}var qg={value:O9};function Xm(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var F9={};function vl(n){const e=F9[n];return e||mr(0,n),e}var Dd;function LP(){return Dd}function V9(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function bC(n,e){e&&(vl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Bv(n){Gv(n),n.drafts_.forEach(j9),n.drafts_=null}function Gv(n){n===Dd&&(Dd=n.parent_)}function PC(n){return Dd=V9(Dd,n)}function j9(n){const e=n[Ri];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function kC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Ri].modified_&&(Bv(e),mr(4)),_l(n)&&(n=qp(e,n),e.parent_||Xp(e,n)),e.patches_&&vl("Patches").generateReplacementPatches_(t[Ri].base_,n,e.patches_,e.inversePatches_)):n=qp(e,t,[]),Bv(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==NP?n:void 0}function qp(n,e,t){if(Xm(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Ri];if(!r)return Kp(e,(s,o)=>NC(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return Xp(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),Kp(o,(u,h)=>NC(n,r,s,u,h,t,l),i),Xp(n,s,!1),t&&n.patches_&&vl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function NC(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=Xm(r);if(!(l&&!o)){if(gu(r)){const u=s&&e&&e.type_!==3&&!Uv(e.assigned_,i)?s.concat(i):void 0,h=qp(n,r,u);if(MP(t,i,h),gu(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(_l(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;qp(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(df(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&Xp(n,r)}}}function Xp(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&G1(e,t)}function U9(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:LP(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=W1;t&&(r=[i],s=Md);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var W1={get(n,e){if(e===Ri)return n;const t=za(n);if(!Uv(t,e))return z9(n,t,e);const i=t[e];return n.finalized_||!_l(i)?i:i===j_(n.base_,e)?(U_(n),n.copy_[e]=$v(i,n)):i},has(n,e){return e in za(n)},ownKeys(n){return Reflect.ownKeys(za(n))},set(n,e,t){const i=OP(za(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=j_(za(n),e),s=r?.[Ri];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(L9(t,r)&&(t!==void 0||Uv(n.base_,e)))return!0;U_(n),Wv(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return j_(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,U_(n),Wv(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=za(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){mr(11)},getPrototypeOf(n){return Nd(n.base_)},setPrototypeOf(){mr(12)}},Md={};Kp(W1,(n,e)=>{Md[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Md.deleteProperty=function(n,e){return Md.set.call(this,n,e,void 0)};Md.set=function(n,e,t){return W1.set.call(this,n[0],e,t,n[0])};function j_(n,e){const t=n[Ri];return(t?za(t):n)[e]}function z9(n,e,t){const i=OP(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function OP(n,e){if(!(e in n))return;let t=Nd(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Nd(t)}}function Wv(n){n.modified_||(n.modified_=!0,n.parent_&&Wv(n.parent_))}function U_(n){n.copy_||(n.copy_=zv(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var B9=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,f=>t.call(this,f,...h))}}typeof t!="function"&&mr(6),i!==void 0&&typeof i!="function"&&mr(7);let r;if(_l(e)){const s=PC(this),o=$v(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?Bv(s):Gv(s)}return bC(s,i),kC(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===NP&&(r=void 0),this.autoFreeze_&&G1(r,!0),i){const s=[],o=[];vl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else mr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){_l(n)||mr(8),gu(n)&&(n=G9(n));const e=PC(this),t=$v(n,void 0);return t[Ri].isManual_=!0,Gv(e),t}finishDraft(n,e){const t=n&&n[Ri];(!t||!t.isManual_)&&mr(9);const{scope_:i}=t;return bC(i,e),kC(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=vl("Patches").applyPatches_;return gu(n)?i(n,e):this.produce(n,r=>i(r,e))}};function $v(n,e){const t=df(n)?vl("MapSet").proxyMap_(n,e):qm(n)?vl("MapSet").proxySet_(n,e):U9(n,e);return(e?e.scope_:LP()).drafts_.push(t),t}function G9(n){return gu(n)||mr(10,n),FP(n)}function FP(n){if(!_l(n)||Xm(n))return n;const e=n[Ri];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=zv(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=zv(n,!0);return Kp(t,(r,s)=>{MP(t,r,FP(s))},i),e&&(e.finalized_=!1),t}var W9=new B9,$9=W9.produce;const H9=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?$9(r):r;return e(l,s,...o)},n(i.setState,t,i)),Ym=H9,Ei=Rr()(Ym((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),VP={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await Kg(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-DSfk1ysZ.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Boothellingen:{name:"Boothellingen",factory:async()=>{const{createBoothellingenLayer:n}=await Kg(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-DFr1ImEA.js");return{createBoothellingenLayer:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await Kg(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-B7fqbOr2.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await Kg(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-sHXa_mau.js");return{createViswaterLayer:e}},__vite__mapDeps([3,1]));return n()},immediateLoad:!1}};function K9(){return Object.values(VP).filter(n=>n.immediateLoad)}const Js=Rr()(Ym((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Xo=Rr()(Ym((n,e)=>({visible:{OpenStreetMap:!0,Luchtfoto:!1,"Labels Overlay":!1,Aanlegsteigers:!1,Boothellingen:!1,Dieptekaart:!1,Viswater:!1,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=VP[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=Js.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),ii=Rr()(Ym(n=>({layerControlOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchFormLocationSource:null,catchFormInitialPhotos:[],catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e?.location||null,t.catchFormLocationSource=e?.locationSource||null,t.catchFormInitialPhotos=e?.photos||[]})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null,e.catchFormLocationSource=null,e.catchFormInitialPhotos=[]})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),q9={};function X9(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Ld=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Ld(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Ld(i)(t)}}}},Y9=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:S=>S,version:0,merge:(S,b)=>({...b,...S}),...e},o=!1;const l=new Set,u=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...S)},i,r);const f=Ld(s.serialize),p=()=>{const S=s.partialize({...i()});let b;const D=f({state:S,version:s.version}).then(N=>h.setItem(s.name,N)).catch(N=>{b=N});if(b)throw b;return D},y=r.setState;r.setState=(S,b)=>{y(S,b),p()};const x=n((...S)=>{t(...S),p()},i,r);let I;const T=()=>{var S;if(!h)return;o=!1,l.forEach(D=>D(i()));const b=((S=s.onRehydrateStorage)==null?void 0:S.call(s,i()))||void 0;return Ld(h.getItem.bind(h))(s.name).then(D=>{if(D)return s.deserialize(D)}).then(D=>{if(D)if(typeof D.version=="number"&&D.version!==s.version){if(s.migrate)return s.migrate(D.state,D.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return D.state}).then(D=>{var N;return I=s.merge(D,(N=i())!=null?N:x),t(I,!0),p()}).then(()=>{b?.(I,void 0),o=!0,u.forEach(D=>D(I))}).catch(D=>{b?.(void 0,D)})};return r.persist={setOptions:S=>{s={...s,...S},S.getStorage&&(h=S.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>T(),hasHydrated:()=>o,onHydrate:S=>(l.add(S),()=>{l.delete(S)}),onFinishHydration:S=>(u.add(S),()=>{u.delete(S)})},T(),I||x},Z9=(n,e)=>(t,i,r)=>{let s={storage:X9(()=>localStorage),partialize:T=>T,version:0,merge:(T,S)=>({...S,...T}),...e},o=!1;const l=new Set,u=new Set;let h=s.storage;if(!h)return n((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...T)},i,r);const f=()=>{const T=s.partialize({...i()});return h.setItem(s.name,{state:T,version:s.version})},p=r.setState;r.setState=(T,S)=>{p(T,S),f()};const y=n((...T)=>{t(...T),f()},i,r);r.getInitialState=()=>y;let x;const I=()=>{var T,S;if(!h)return;o=!1,l.forEach(D=>{var N;return D((N=i())!=null?N:y)});const b=((S=s.onRehydrateStorage)==null?void 0:S.call(s,(T=i())!=null?T:y))||void 0;return Ld(h.getItem.bind(h))(s.name).then(D=>{if(D)if(typeof D.version=="number"&&D.version!==s.version){if(s.migrate)return[!0,s.migrate(D.state,D.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,D.state];return[!1,void 0]}).then(D=>{var N;const[L,F]=D;if(x=s.merge(F,(N=i())!=null?N:y),t(x,!0),L)return f()}).then(()=>{b?.(x,void 0),x=i(),o=!0,u.forEach(D=>D(x))}).catch(D=>{b?.(void 0,D)})};return r.persist={setOptions:T=>{s={...s,...T},T.storage&&(h=T.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:T=>(l.add(T),()=>{l.delete(T)}),onFinishHydration:T=>(u.add(T),()=>{u.delete(T)})},s.skipHydration||I(),x||y},Q9=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((q9?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Y9(n,e)):Z9(n,e),ff=Q9,ln=Rr()(ff(n=>({defaultBackground:"OpenStreetMap",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,showWindIndicator:!1,showTideWidget:!1,showForecastSlider:!1,showWaterDataWidget:!1,widgetOrder:["wind","tide","forecast","waterData"],setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e}),setShowWindIndicator:e=>n({showWindIndicator:e}),setShowTideWidget:e=>n({showTideWidget:e}),setShowForecastSlider:e=>n({showForecastSlider:e}),setShowWaterDataWidget:e=>n({showWaterDataWidget:e}),setWidgetOrder:e=>n({widgetOrder:e})}),{name:"visapp-settings"})),jP=Rr()(ff((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),UP=Rr((n,e)=>({current:null,pressureHistory:[],hourlyForecast:[],precipitation15min:[],loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code,precipitation",hourly:"temperature_2m,wind_speed_10m,wind_direction_10m,surface_pressure,weather_code,precipitation_probability,precipitation",minutely_15:"precipitation",past_hours:"24",forecast_hours:"48",past_minutely_15:"0",forecast_minutely_15:"8",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();let l=[],u=[],h=[];o.hourly?.time&&o.hourly?.surface_pressure&&(l=o.hourly.time.map((f,p)=>({time:f,pressure:o.hourly.surface_pressure[p]})),u=o.hourly.time.map((f,p)=>({time:f,temperature:o.hourly.temperature_2m[p],windSpeed:o.hourly.wind_speed_10m[p],windDirection:o.hourly.wind_direction_10m[p],pressure:o.hourly.surface_pressure[p],weatherCode:o.hourly.weather_code[p],precipitationProbability:o.hourly.precipitation_probability?.[p]||0,precipitation:o.hourly.precipitation?.[p]||0}))),o.minutely_15?.time&&o.minutely_15?.precipitation&&(h=o.minutely_15.time.map((f,p)=>({time:f,precipitation:o.minutely_15.precipitation[p]||0}))),o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},pressureHistory:l,hourlyForecast:u,precipitation15min:h,loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"},getFishingScore:()=>{const{current:t}=e();if(!t)return 1;let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),Math.max(0,Math.min(3,i/2))},getPressureTrend:()=>{const{pressureHistory:t}=e();if(t.length<6)return"stable";const i=t.slice(-6),r=t.slice(-12,-6);if(r.length===0)return"stable";const s=i.reduce((u,h)=>u+h.pressure,0)/i.length,o=r.reduce((u,h)=>u+h.pressure,0)/r.length,l=s-o;return l>2?"rising":l<-2?"falling":"stable"},getWeatherAtTime:t=>{const{hourlyForecast:i}=e();if(i.length===0)return null;t.toISOString().slice(0,13)+"";let r=i[0],s=1/0;for(const o of i){const l=new Date(o.time).getTime(),u=Math.abs(l-t.getTime());u<s&&(s=u,r=o)}return r}})),zP=Rr()(ff(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),DC=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],MC=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],J9=Rr()(ff((n,e)=>({presets:DC,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=Xo.getState().setLayerVisibility;MC.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=Xo.getState().visible,r=MC.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:DC})}}),{name:"visapp-presets"})),eU=()=>{};var LC={};const BP=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},tU=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},GP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,f=s>>2,p=(s&3)<<4|l>>4;let y=(l&15)<<2|h>>6,x=h&63;u||(x=64,o||(y=64)),i.push(t[f],t[p],t[y],t[x])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(BP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):tU(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||p==null)throw new nU;const y=s<<2|l>>4;if(i.push(y),h!==64){const x=l<<4&240|h>>2;if(i.push(x),p!==64){const I=h<<6&192|p;i.push(I)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class nU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const iU=function(n){const e=BP(n);return GP.encodeByteArray(e,!0)},Yp=function(n){return iU(n).replace(/\./g,"")},WP=function(n){try{return GP.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function $P(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const rU=()=>$P().__FIREBASE_DEFAULTS__,sU=()=>{if(typeof process>"u"||typeof LC>"u")return;const n=LC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},oU=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&WP(n[1]);return e&&JSON.parse(e)},Zm=()=>{try{return eU()||rU()||sU()||oU()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},HP=n=>Zm()?.emulatorHosts?.[n],KP=n=>{const e=HP(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},qP=()=>Zm()?.config,XP=n=>Zm()?.[`_${n}`];class aU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Dl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $1(n){return(await fetch(n,{credentials:"include"})).ok}function YP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Yp(JSON.stringify(t)),Yp(JSON.stringify(o)),""].join(".")}const id={};function lU(){const n={prod:[],emulator:[]};for(const e of Object.keys(id))id[e]?n.emulator.push(e):n.prod.push(e);return n}function cU(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let OC=!1;function H1(n,e){if(typeof window>"u"||typeof document>"u"||!Dl(window.location.host)||id[n]===e||id[n]||OC)return;id[n]=e;function t(y){return`__firebase__banner__${y}`}const i="__firebase__banner",s=lU().prod.length>0;function o(){const y=document.getElementById(i);y&&y.remove()}function l(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,x){y.setAttribute("width","24"),y.setAttribute("id",x),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{OC=!0,o()},y}function f(y,x){y.setAttribute("id",x),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function p(){const y=cU(i),x=t("text"),I=document.getElementById(x)||document.createElement("span"),T=t("learnmore"),S=document.getElementById(T)||document.createElement("a"),b=t("preprendIcon"),D=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const N=y.element;l(N),f(S,T);const L=h();u(D,b),N.append(D,I,S,L),document.body.appendChild(N)}s?(I.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function Jt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function uU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jt())}function ZP(){const n=Zm()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function dU(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function fU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gU(){const n=Jt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function QP(){return!ZP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function JP(){return!ZP()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ek(){try{return typeof indexedDB=="object"}catch{return!1}}function pU(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const mU="FirebaseError";class hs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=mU,Object.setPrototypeOf(this,hs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gf.prototype.create)}}class gf{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?yU(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new hs(r,l,i)}}function yU(n,e){return n.replace(_U,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const _U=/\{\$([^}]+)}/g;function vU(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function xl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(FC(s)&&FC(o)){if(!xl(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function FC(n){return n!==null&&typeof n=="object"}function pf(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function xU(n,e){const t=new wU(n,e);return t.subscribe.bind(t)}class wU{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");EU(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=z_),r.error===void 0&&(r.error=z_),r.complete===void 0&&(r.complete=z_);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function EU(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function z_(){}function eo(n){return n&&n._delegate?n._delegate:n}class na{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ba="[DEFAULT]";class TU{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new aU;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(IU(e))try{this.getOrInitializeService({instanceIdentifier:Ba})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ba){return this.instances.has(e)}getOptions(e=Ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:SU(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ba){return this.component?this.component.multipleInstances?e:Ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function SU(n){return n===Ba?void 0:n}function IU(n){return n.instantiationMode==="EAGER"}class CU{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new TU(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ke;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ke||(Ke={}));const RU={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},AU=Ke.INFO,bU={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},PU=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=bU[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class K1{constructor(e){this.name=e,this._logLevel=AU,this._logHandler=PU,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?RU[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const kU=(n,e)=>e.some(t=>n instanceof t);let VC,jC;function NU(){return VC||(VC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DU(){return jC||(jC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const tk=new WeakMap,Hv=new WeakMap,nk=new WeakMap,B_=new WeakMap,q1=new WeakMap;function MU(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Yo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&tk.set(t,n)}).catch(()=>{}),q1.set(e,n),e}function LU(n){if(Hv.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Hv.set(n,e)}let Kv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Hv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||nk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Yo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function OU(n){Kv=n(Kv)}function FU(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(G_(this),e,...t);return nk.set(i,e.sort?e.sort():[e]),Yo(i)}:DU().includes(n)?function(...e){return n.apply(G_(this),e),Yo(tk.get(this))}:function(...e){return Yo(n.apply(G_(this),e))}}function VU(n){return typeof n=="function"?FU(n):(n instanceof IDBTransaction&&LU(n),kU(n,NU())?new Proxy(n,Kv):n)}function Yo(n){if(n instanceof IDBRequest)return MU(n);if(B_.has(n))return B_.get(n);const e=VU(n);return e!==n&&(B_.set(n,e),q1.set(e,n)),e}const G_=n=>q1.get(n);function jU(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Yo(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Yo(o.result),u.oldVersion,u.newVersion,Yo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const UU=["get","getKey","getAll","getAllKeys","count"],zU=["put","add","delete","clear"],W_=new Map;function UC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(W_.get(e))return W_.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=zU.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||UU.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&u.done]))[0]};return W_.set(e,s),s}OU(n=>({...n,get:(e,t,i)=>UC(e,t)||n.get(e,t,i),has:(e,t)=>!!UC(e,t)||n.has(e,t)}));class BU{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(GU(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function GU(n){return n.getComponent()?.type==="VERSION"}const qv="@firebase/app",zC="0.14.6";const qs=new K1("@firebase/app"),WU="@firebase/app-compat",$U="@firebase/analytics-compat",HU="@firebase/analytics",KU="@firebase/app-check-compat",qU="@firebase/app-check",XU="@firebase/auth",YU="@firebase/auth-compat",ZU="@firebase/database",QU="@firebase/data-connect",JU="@firebase/database-compat",ez="@firebase/functions",tz="@firebase/functions-compat",nz="@firebase/installations",iz="@firebase/installations-compat",rz="@firebase/messaging",sz="@firebase/messaging-compat",oz="@firebase/performance",az="@firebase/performance-compat",lz="@firebase/remote-config",cz="@firebase/remote-config-compat",uz="@firebase/storage",hz="@firebase/storage-compat",dz="@firebase/firestore",fz="@firebase/ai",gz="@firebase/firestore-compat",pz="firebase",mz="12.6.0";const Xv="[DEFAULT]",yz={[qv]:"fire-core",[WU]:"fire-core-compat",[HU]:"fire-analytics",[$U]:"fire-analytics-compat",[qU]:"fire-app-check",[KU]:"fire-app-check-compat",[XU]:"fire-auth",[YU]:"fire-auth-compat",[ZU]:"fire-rtdb",[QU]:"fire-data-connect",[JU]:"fire-rtdb-compat",[ez]:"fire-fn",[tz]:"fire-fn-compat",[nz]:"fire-iid",[iz]:"fire-iid-compat",[rz]:"fire-fcm",[sz]:"fire-fcm-compat",[oz]:"fire-perf",[az]:"fire-perf-compat",[lz]:"fire-rc",[cz]:"fire-rc-compat",[uz]:"fire-gcs",[hz]:"fire-gcs-compat",[dz]:"fire-fst",[gz]:"fire-fst-compat",[fz]:"fire-vertex","fire-js":"fire-js",[pz]:"fire-js-all"};const Zp=new Map,_z=new Map,Yv=new Map;function BC(n,e){try{n.container.addComponent(e)}catch(t){qs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function wl(n){const e=n.name;if(Yv.has(e))return qs.debug(`There were multiple attempts to register component ${e}.`),!1;Yv.set(e,n);for(const t of Zp.values())BC(t,n);for(const t of _z.values())BC(t,n);return!0}function Qm(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Hi(n){return n==null?!1:n.settings!==void 0}const vz={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zo=new gf("app","Firebase",vz);class xz{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new na("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zo.create("app-deleted",{appName:this._name})}}const Ml=mz;function ik(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Xv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Zo.create("bad-app-name",{appName:String(r)});if(t||(t=qP()),!t)throw Zo.create("no-options");const s=Zp.get(r);if(s){if(xl(t,s.options)&&xl(i,s.config))return s;throw Zo.create("duplicate-app",{appName:r})}const o=new CU(r);for(const u of Yv.values())o.addComponent(u);const l=new xz(t,i,o);return Zp.set(r,l),l}function X1(n=Xv){const e=Zp.get(n);if(!e&&n===Xv&&qP())return ik();if(!e)throw Zo.create("no-app",{appName:n});return e}function ss(n,e,t){let i=yz[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qs.warn(o.join(" "));return}wl(new na(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const wz="firebase-heartbeat-database",Ez=1,Od="firebase-heartbeat-store";let $_=null;function rk(){return $_||($_=jU(wz,Ez,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Od)}catch(t){console.warn(t)}}}}).catch(n=>{throw Zo.create("idb-open",{originalErrorMessage:n.message})})),$_}async function Tz(n){try{const t=(await rk()).transaction(Od),i=await t.objectStore(Od).get(sk(n));return await t.done,i}catch(e){if(e instanceof hs)qs.warn(e.message);else{const t=Zo.create("idb-get",{originalErrorMessage:e?.message});qs.warn(t.message)}}}async function GC(n,e){try{const i=(await rk()).transaction(Od,"readwrite");await i.objectStore(Od).put(e,sk(n)),await i.done}catch(t){if(t instanceof hs)qs.warn(t.message);else{const i=Zo.create("idb-set",{originalErrorMessage:t?.message});qs.warn(i.message)}}}function sk(n){return`${n.name}!${n.options.appId}`}const Sz=1024,Iz=30;class Cz{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Az(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=WC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>Iz){const r=bz(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){qs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=WC(),{heartbeatsToSend:t,unsentEntries:i}=Rz(this._heartbeatsCache.heartbeats),r=Yp(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return qs.warn(e),""}}}function WC(){return new Date().toISOString().substring(0,10)}function Rz(n,e=Sz){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),$C(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),$C(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class Az{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ek()?pU().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Tz(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return GC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return GC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function $C(n){return Yp(JSON.stringify({version:2,heartbeats:n})).length}function bz(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function Pz(n){wl(new na("platform-logger",e=>new BU(e),"PRIVATE")),wl(new na("heartbeat",e=>new Cz(e),"PRIVATE")),ss(qv,zC,n),ss(qv,zC,"esm2020"),ss("fire-js","")}Pz("");function ok(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const kz=ok,ak=new gf("auth","Firebase",ok());const Qp=new K1("@firebase/auth");function Nz(n,...e){Qp.logLevel<=Ke.WARN&&Qp.warn(`Auth (${Ml}): ${n}`,...e)}function hp(n,...e){Qp.logLevel<=Ke.ERROR&&Qp.error(`Auth (${Ml}): ${n}`,...e)}function as(n,...e){throw Z1(n,...e)}function Tr(n,...e){return Z1(n,...e)}function Y1(n,e,t){const i={...kz(),[e]:t};return new gf("auth","Firebase",i).create(e,{appName:n.name})}function al(n){return Y1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Dz(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&as(n,"argument-error"),Y1(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Z1(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return ak.create(n,...e)}function Fe(n,e,...t){if(!n)throw Z1(e,...t)}function Fs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw hp(e),new Error(e)}function Xs(n,e){n||Fs(e)}function Zv(){return typeof self<"u"&&self.location?.href||""}function Mz(){return HC()==="http:"||HC()==="https:"}function HC(){return typeof self<"u"&&self.location?.protocol||null}function Lz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Mz()||dU()||"connection"in navigator)?navigator.onLine:!0}function Oz(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class mf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xs(t>e,"Short delay should be less than long delay!"),this.isMobile=uU()||fU()}get(){return Lz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Q1(n,e){Xs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class lk{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Fz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Vz=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],jz=new mf(3e4,6e4);function J1(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Mu(n,e,t,i,r={}){return ck(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=pf({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return hU()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(h.credentials="include"),lk.fetch()(await uk(n,n.config.apiHost,t,l),h)})}async function ck(n,e,t){n._canInitEmulator=!1;const i={...Fz,...e};try{const r=new zz(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Xg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xg(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Xg(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Xg(n,"user-disabled",o);const f=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Y1(n,f,h);as(n,f)}}catch(r){if(r instanceof hs)throw r;as(n,"network-request-failed",{message:String(r)})}}async function Uz(n,e,t,i,r={}){const s=await Mu(n,e,t,i,r);return"mfaPendingCredential"in s&&as(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function uk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?Q1(n.config,r):`${n.config.apiScheme}://${r}`;return Vz.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class zz{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Tr(this.auth,"network-request-failed")),jz.get())})}}function Xg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Tr(n,e,i);return r.customData._tokenResponse=t,r}async function Bz(n,e){return Mu(n,"POST","/v1/accounts:delete",e)}async function Jp(n,e){return Mu(n,"POST","/v1/accounts:lookup",e)}function rd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Gz(n,e=!1){const t=eo(n),i=await t.getIdToken(e),r=ew(i);Fe(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:rd(H_(r.auth_time)),issuedAtTime:rd(H_(r.iat)),expirationTime:rd(H_(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function H_(n){return Number(n)*1e3}function ew(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return hp("JWT malformed, contained fewer than 3 sections"),null;try{const r=WP(t);return r?JSON.parse(r):(hp("Failed to decode base64 JWT payload"),null)}catch(r){return hp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function KC(n){const e=ew(n);return Fe(e,"internal-error"),Fe(typeof e.exp<"u","internal-error"),Fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Fd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof hs&&Wz(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Wz({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class $z{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Qv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=rd(this.lastLoginAt),this.creationTime=rd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function em(n){const e=n.auth,t=await n.getIdToken(),i=await Fd(n,Jp(e,{idToken:t}));Fe(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?hk(r.providerUserInfo):[],o=Kz(n.providerData,s),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Qv(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function Hz(n){const e=eo(n);await em(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Kz(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function hk(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function qz(n,e){const t=await ck(n,{},async()=>{const i=pf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await uk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:i};return n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(u.credentials="include"),lk.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Xz(n,e){return Mu(n,"POST","/v2/accounts:revokeToken",J1(n,e))}class Zc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Fe(e.idToken,"internal-error"),Fe(typeof e.idToken<"u","internal-error"),Fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):KC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Fe(e.length!==0,"internal-error");const t=KC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await qz(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Zc;return i&&(Fe(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Fe(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Fe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zc,this.toJSON())}_performRefresh(){return Fs("not implemented")}}function ko(n,e){Fe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class _r{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new $z(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Qv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Fd(this,this.stsTokenManager.getToken(this.auth,e));return Fe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Gz(this,e)}reload(){return Hz(this)}_assign(e){this!==e&&(Fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _r({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await em(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Hi(this.auth.app))return Promise.reject(al(this.auth));const e=await this.getIdToken();return await Fd(this,Bz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:p,emailVerified:y,isAnonymous:x,providerData:I,stsTokenManager:T}=t;Fe(p&&T,e,"internal-error");const S=Zc.fromJSON(this.name,T);Fe(typeof p=="string",e,"internal-error"),ko(i,e.name),ko(r,e.name),Fe(typeof y=="boolean",e,"internal-error"),Fe(typeof x=="boolean",e,"internal-error"),ko(s,e.name),ko(o,e.name),ko(l,e.name),ko(u,e.name),ko(h,e.name),ko(f,e.name);const b=new _r({uid:p,auth:e,email:r,emailVerified:y,displayName:i,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:S,createdAt:h,lastLoginAt:f});return I&&Array.isArray(I)&&(b.providerData=I.map(D=>({...D}))),u&&(b._redirectEventId=u),b}static async _fromIdTokenResponse(e,t,i=!1){const r=new Zc;r.updateFromServerResponse(t);const s=new _r({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await em(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Fe(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?hk(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new Zc;l.updateFromIdToken(i);const u=new _r({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Qv(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const qC=new Map;function Vs(n){Xs(n instanceof Function,"Expected a class definition");let e=qC.get(n);return e?(Xs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,qC.set(n,e),e)}class dk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}dk.type="NONE";const XC=dk;function dp(n,e,t){return`firebase:${n}:${e}:${t}`}class Qc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=dp(this.userKey,r.apiKey,s),this.fullPersistenceKey=dp("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Jp(this.auth,{idToken:e}).catch(()=>{});return t?_r._fromGetAccountInfoResponse(this.auth,t,e):null}return _r._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Qc(Vs(XC),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Vs(XC);const o=dp(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let p;if(typeof f=="string"){const y=await Jp(e,{idToken:f}).catch(()=>{});if(!y)break;p=await _r._fromGetAccountInfoResponse(e,y,f)}else p=_r._fromJSON(e,f);h!==s&&(l=p),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Qc(s,e,i):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Qc(s,e,i))}}function YC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(mk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_k(e))return"Blackberry";if(vk(e))return"Webos";if(gk(e))return"Safari";if((e.includes("chrome/")||pk(e))&&!e.includes("edge/"))return"Chrome";if(yk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function fk(n=Jt()){return/firefox\//i.test(n)}function gk(n=Jt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pk(n=Jt()){return/crios\//i.test(n)}function mk(n=Jt()){return/iemobile/i.test(n)}function yk(n=Jt()){return/android/i.test(n)}function _k(n=Jt()){return/blackberry/i.test(n)}function vk(n=Jt()){return/webos/i.test(n)}function tw(n=Jt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Yz(n=Jt()){return tw(n)&&!!window.navigator?.standalone}function Zz(){return gU()&&document.documentMode===10}function xk(n=Jt()){return tw(n)||yk(n)||vk(n)||_k(n)||/windows phone/i.test(n)||mk(n)}function wk(n,e=[]){let t;switch(n){case"Browser":t=YC(Jt());break;case"Worker":t=`${YC(Jt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ml}/${i}`}class Qz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function Jz(n,e={}){return Mu(n,"GET","/v2/passwordPolicy",J1(n,e))}const eB=6;class tB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??eB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class nB{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ZC(this),this.idTokenSubscription=new ZC(this),this.beforeStateQueue=new Qz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ak,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Qc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Jp(this,{idToken:e}),i=await _r._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Hi(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await em(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Oz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Hi(this.app))return Promise.reject(al(this));const t=e?eo(e):null;return t&&Fe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Hi(this.app)?Promise.reject(al(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Hi(this.app)?Promise.reject(al(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Jz(this),t=new tB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new gf("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await Xz(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vs(e)||this._popupRedirectResolver;Fe(t,this,"argument-error"),this.redirectPersistenceManager=await Qc.create(this,[Vs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Fe(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Hi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Nz(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Jm(n){return eo(n)}class ZC{constructor(e){this.auth=e,this.observer=null,this.addObserver=xU(t=>this.observer=t)}get next(){return Fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let nw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function iB(n){nw=n}function rB(n){return nw.loadJS(n)}function sB(){return nw.gapiScript}function oB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function aB(n,e){const t=Qm(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(xl(s,e??{}))return r;as(r,"already-initialized")}return t.initialize({options:e})}function lB(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Vs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function cB(n,e,t){const i=Jm(n);Fe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=Ek(e),{host:o,port:l}=uB(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Fe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Fe(xl(h,i.config.emulator)&&xl(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Dl(o)?($1(`${s}//${o}${u}`),H1("Auth",!0)):hB()}function Ek(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function uB(n){const e=Ek(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:QC(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:QC(o)}}}function QC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function hB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Tk{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fs("not implemented")}_getIdTokenResponse(e){return Fs("not implemented")}_linkToIdToken(e,t){return Fs("not implemented")}_getReauthenticationResolver(e){return Fs("not implemented")}}async function Jc(n,e){return Uz(n,"POST","/v1/accounts:signInWithIdp",J1(n,e))}const dB="http://localhost";class El extends Tk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new El(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):as("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new El(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Jc(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Jc(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Jc(e,t)}buildRequest(){const e={requestUri:dB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=pf(t)}return e}}class iw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class yf extends iw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class jo extends yf{constructor(){super("facebook.com")}static credential(e){return El._fromParams({providerId:jo.PROVIDER_ID,signInMethod:jo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jo.credentialFromTaggedObject(e)}static credentialFromError(e){return jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jo.credential(e.oauthAccessToken)}catch{return null}}}jo.FACEBOOK_SIGN_IN_METHOD="facebook.com";jo.PROVIDER_ID="facebook.com";class Ls extends yf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return El._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ls.credential(t,i)}catch{return null}}}Ls.GOOGLE_SIGN_IN_METHOD="google.com";Ls.PROVIDER_ID="google.com";class Uo extends yf{constructor(){super("github.com")}static credential(e){return El._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.GITHUB_SIGN_IN_METHOD="github.com";Uo.PROVIDER_ID="github.com";class zo extends yf{constructor(){super("twitter.com")}static credential(e,t){return El._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return zo.credential(t,i)}catch{return null}}}zo.TWITTER_SIGN_IN_METHOD="twitter.com";zo.PROVIDER_ID="twitter.com";class pu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await _r._fromIdTokenResponse(e,i,r),o=JC(i);return new pu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=JC(i);return new pu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function JC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class tm extends hs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,tm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new tm(e,t,i,r)}}function Sk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?tm._fromErrorAndOperation(n,s,e,i):s})}async function fB(n,e,t=!1){const i=await Fd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return pu._forOperation(n,"link",i)}async function gB(n,e,t=!1){const{auth:i}=n;if(Hi(i.app))return Promise.reject(al(i));const r="reauthenticate";try{const s=await Fd(n,Sk(i,r,e,n),t);Fe(s.idToken,i,"internal-error");const o=ew(s.idToken);Fe(o,i,"internal-error");const{sub:l}=o;return Fe(n.uid===l,i,"user-mismatch"),pu._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&as(i,"user-mismatch"),s}}async function pB(n,e,t=!1){if(Hi(n.app))return Promise.reject(al(n));const i="signIn",r=await Sk(n,i,e),s=await pu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function mB(n,e,t,i){return eo(n).onIdTokenChanged(e,t,i)}function yB(n,e,t){return eo(n).beforeAuthStateChanged(e,t)}function _B(n,e,t,i){return eo(n).onAuthStateChanged(e,t,i)}function vB(n){return eo(n).signOut()}const nm="__sak";class Ik{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(nm,"1"),this.storage.removeItem(nm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const xB=1e3,wB=10;class Ck extends Ik{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);Zz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,wB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},xB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ck.type="LOCAL";const EB=Ck;class Rk extends Ik{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Rk.type="SESSION";const Ak=Rk;function TB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ey{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new ey(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),u=await TB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ey.receivers=[];function rw(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class SB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=rw("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(p){const y=p;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(y.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function os(){return window}function IB(n){os().location.href=n}function bk(){return typeof os().WorkerGlobalScope<"u"&&typeof os().importScripts=="function"}async function CB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function RB(){return navigator?.serviceWorker?.controller||null}function AB(){return bk()?self:null}const Pk="firebaseLocalStorageDb",bB=1,im="firebaseLocalStorage",kk="fbase_key";class _f{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ty(n,e){return n.transaction([im],e?"readwrite":"readonly").objectStore(im)}function PB(){const n=indexedDB.deleteDatabase(Pk);return new _f(n).toPromise()}function Jv(){const n=indexedDB.open(Pk,bB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(im,{keyPath:kk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(im)?e(i):(i.close(),await PB(),e(await Jv()))})})}async function eR(n,e,t){const i=ty(n,!0).put({[kk]:e,value:t});return new _f(i).toPromise()}async function kB(n,e){const t=ty(n,!1).get(e),i=await new _f(t).toPromise();return i===void 0?null:i.value}function tR(n,e){const t=ty(n,!0).delete(e);return new _f(t).toPromise()}const NB=800,DB=3;class Nk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Jv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>DB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ey._getInstance(AB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await CB(),!this.activeServiceWorker)return;this.sender=new SB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||RB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Jv();return await eR(e,nm,"1"),await tR(e,nm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>eR(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>kB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>tR(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=ty(r,!1).getAll();return new _f(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),NB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Nk.type="LOCAL";const MB=Nk;new mf(3e4,6e4);function Dk(n,e){return e?Vs(e):(Fe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class sw extends Tk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function LB(n){return pB(n.auth,new sw(n),n.bypassAuthState)}function OB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),gB(t,new sw(n),n.bypassAuthState)}async function FB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),fB(t,new sw(n),n.bypassAuthState)}class Mk{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return LB;case"linkViaPopup":case"linkViaRedirect":return FB;case"reauthViaPopup":case"reauthViaRedirect":return OB;default:as(this.auth,"internal-error")}}resolve(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const VB=new mf(2e3,1e4);async function jB(n,e,t){if(Hi(n.app))return Promise.reject(Tr(n,"operation-not-supported-in-this-environment"));const i=Jm(n);Dz(n,e,iw);const r=Dk(i,t);return new tl(i,"signInViaPopup",e,r).executeNotNull()}class tl extends Mk{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,tl.currentPopupAction&&tl.currentPopupAction.cancel(),tl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Fe(e,this.auth,"internal-error"),e}async onExecution(){Xs(this.filter.length===1,"Popup operations only handle one event");const e=rw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,VB.get())};e()}}tl.currentPopupAction=null;const UB="pendingRedirect",fp=new Map;class zB extends Mk{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=fp.get(this.auth._key());if(!e){try{const i=await BB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}fp.set(this.auth._key(),e)}return this.bypassAuthState||fp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function BB(n,e){const t=$B(e),i=WB(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function GB(n,e){fp.set(n._key(),e)}function WB(n){return Vs(n._redirectPersistence)}function $B(n){return dp(UB,n.config.apiKey,n.name)}async function HB(n,e,t=!1){if(Hi(n.app))return Promise.reject(al(n));const i=Jm(n),r=Dk(i,e),o=await new zB(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const KB=600*1e3;class qB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!XB(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Lk(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Tr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=KB&&this.cachedEventUids.clear(),this.cachedEventUids.has(nR(e))}saveEventToCache(e){this.cachedEventUids.add(nR(e)),this.lastProcessedEventTime=Date.now()}}function nR(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Lk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function XB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Lk(n);default:return!1}}async function YB(n,e={}){return Mu(n,"GET","/v1/projects",e)}const ZB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,QB=/^https?/;async function JB(n){if(n.config.emulator)return;const{authorizedDomains:e}=await YB(n);for(const t of e)try{if(e8(t))return}catch{}as(n,"unauthorized-domain")}function e8(n){const e=Zv(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!QB.test(t))return!1;if(ZB.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const t8=new mf(3e4,6e4);function iR(){const n=os().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function n8(n){return new Promise((e,t)=>{function i(){iR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iR(),t(Tr(n,"network-request-failed"))},timeout:t8.get()})}if(os().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(os().gapi?.load)i();else{const r=oB("iframefcb");return os()[r]=()=>{gapi.load?i():t(Tr(n,"network-request-failed"))},rB(`${sB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw gp=null,e})}let gp=null;function i8(n){return gp=gp||n8(n),gp}const r8=new mf(5e3,15e3),s8="__/auth/iframe",o8="emulator/auth/iframe",a8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},l8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function c8(n){const e=n.config;Fe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Q1(e,o8):`https://${n.config.authDomain}/${s8}`,i={apiKey:e.apiKey,appName:n.name,v:Ml},r=l8.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${pf(i).slice(1)}`}async function u8(n){const e=await i8(n),t=os().gapi;return Fe(t,n,"internal-error"),e.open({where:document.body,url:c8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:a8,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Tr(n,"network-request-failed"),l=os().setTimeout(()=>{s(o)},r8.get());function u(){os().clearTimeout(l),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const h8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},d8=500,f8=600,g8="_blank",p8="http://localhost";class rR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function m8(n,e,t,i=d8,r=f8){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u={...h8,width:i.toString(),height:r.toString(),top:s,left:o},h=Jt().toLowerCase();t&&(l=pk(h)?g8:t),fk(h)&&(e=e||p8,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[x,I])=>`${y}${x}=${I},`,"");if(Yz(h)&&l!=="_self")return y8(e||"",l),new rR(null);const p=window.open(e||"",l,f);Fe(p,n,"popup-blocked");try{p.focus()}catch{}return new rR(p)}function y8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const _8="__/auth/handler",v8="emulator/auth/handler",x8=encodeURIComponent("fac");async function sR(n,e,t,i,r,s){Fe(n.config.authDomain,n,"auth-domain-config-required"),Fe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ml,eventId:r};if(e instanceof iw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",vU(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof yf){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),h=u?`#${x8}=${encodeURIComponent(u)}`:"";return`${w8(n)}?${pf(l).slice(1)}${h}`}function w8({config:n}){return n.emulator?Q1(n,v8):`https://${n.authDomain}/${_8}`}const K_="webStorageSupport";class E8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ak,this._completeRedirectFn=HB,this._overrideRedirectResult=GB}async _openPopup(e,t,i,r){Xs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await sR(e,t,i,Zv(),r);return m8(e,s,rw())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await sR(e,t,i,Zv(),r);return IB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Xs(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await u8(e),i=new qB(e);return t.register("authEvent",r=>(Fe(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(K_,{type:K_},r=>{const s=r?.[0]?.[K_];s!==void 0&&t(!!s),as(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=JB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return xk()||gk()||tw()}}const T8=E8;var oR="@firebase/auth",aR="1.12.0";class S8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function I8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function C8(n){wl(new na("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Fe(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wk(n)},h=new nB(i,r,s,u);return lB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),wl(new na("auth-internal",e=>{const t=Jm(e.getProvider("auth").getImmediate());return(i=>new S8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ss(oR,aR,I8(n)),ss(oR,aR,"esm2020")}const R8=300,A8=XP("authIdTokenMaxAge")||R8;let lR=null;const b8=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>A8)return;const r=t?.token;lR!==r&&(lR=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function P8(n=X1()){const e=Qm(n,"auth");if(e.isInitialized())return e.getImmediate();const t=aB(n,{popupRedirectResolver:T8,persistence:[MB,EB,Ak]}),i=XP("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=b8(s.toString());yB(t,o,()=>o(t.currentUser)),mB(t,l=>o(l))}}const r=HP("auth");return r&&cB(t,`http://${r}`),t}function k8(){return document.getElementsByTagName("head")?.[0]??document}iB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Tr("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",k8().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});C8("Browser");var N8="firebase",D8="12.7.0";ss(N8,D8,"app");var cR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ow;(function(){var n;function e(k,R){function P(){}P.prototype=R.prototype,k.F=R.prototype,k.prototype=new P,k.prototype.constructor=k,k.D=function(V,j,B){for(var M=Array(arguments.length-2),se=2;se<arguments.length;se++)M[se-2]=arguments[se];return R.prototype[j].apply(V,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,R,P){P||(P=0);const V=Array(16);if(typeof R=="string")for(var j=0;j<16;++j)V[j]=R.charCodeAt(P++)|R.charCodeAt(P++)<<8|R.charCodeAt(P++)<<16|R.charCodeAt(P++)<<24;else for(j=0;j<16;++j)V[j]=R[P++]|R[P++]<<8|R[P++]<<16|R[P++]<<24;R=k.g[0],P=k.g[1],j=k.g[2];let B=k.g[3],M;M=R+(B^P&(j^B))+V[0]+3614090360&4294967295,R=P+(M<<7&4294967295|M>>>25),M=B+(j^R&(P^j))+V[1]+3905402710&4294967295,B=R+(M<<12&4294967295|M>>>20),M=j+(P^B&(R^P))+V[2]+606105819&4294967295,j=B+(M<<17&4294967295|M>>>15),M=P+(R^j&(B^R))+V[3]+3250441966&4294967295,P=j+(M<<22&4294967295|M>>>10),M=R+(B^P&(j^B))+V[4]+4118548399&4294967295,R=P+(M<<7&4294967295|M>>>25),M=B+(j^R&(P^j))+V[5]+1200080426&4294967295,B=R+(M<<12&4294967295|M>>>20),M=j+(P^B&(R^P))+V[6]+2821735955&4294967295,j=B+(M<<17&4294967295|M>>>15),M=P+(R^j&(B^R))+V[7]+4249261313&4294967295,P=j+(M<<22&4294967295|M>>>10),M=R+(B^P&(j^B))+V[8]+1770035416&4294967295,R=P+(M<<7&4294967295|M>>>25),M=B+(j^R&(P^j))+V[9]+2336552879&4294967295,B=R+(M<<12&4294967295|M>>>20),M=j+(P^B&(R^P))+V[10]+4294925233&4294967295,j=B+(M<<17&4294967295|M>>>15),M=P+(R^j&(B^R))+V[11]+2304563134&4294967295,P=j+(M<<22&4294967295|M>>>10),M=R+(B^P&(j^B))+V[12]+1804603682&4294967295,R=P+(M<<7&4294967295|M>>>25),M=B+(j^R&(P^j))+V[13]+4254626195&4294967295,B=R+(M<<12&4294967295|M>>>20),M=j+(P^B&(R^P))+V[14]+2792965006&4294967295,j=B+(M<<17&4294967295|M>>>15),M=P+(R^j&(B^R))+V[15]+1236535329&4294967295,P=j+(M<<22&4294967295|M>>>10),M=R+(j^B&(P^j))+V[1]+4129170786&4294967295,R=P+(M<<5&4294967295|M>>>27),M=B+(P^j&(R^P))+V[6]+3225465664&4294967295,B=R+(M<<9&4294967295|M>>>23),M=j+(R^P&(B^R))+V[11]+643717713&4294967295,j=B+(M<<14&4294967295|M>>>18),M=P+(B^R&(j^B))+V[0]+3921069994&4294967295,P=j+(M<<20&4294967295|M>>>12),M=R+(j^B&(P^j))+V[5]+3593408605&4294967295,R=P+(M<<5&4294967295|M>>>27),M=B+(P^j&(R^P))+V[10]+38016083&4294967295,B=R+(M<<9&4294967295|M>>>23),M=j+(R^P&(B^R))+V[15]+3634488961&4294967295,j=B+(M<<14&4294967295|M>>>18),M=P+(B^R&(j^B))+V[4]+3889429448&4294967295,P=j+(M<<20&4294967295|M>>>12),M=R+(j^B&(P^j))+V[9]+568446438&4294967295,R=P+(M<<5&4294967295|M>>>27),M=B+(P^j&(R^P))+V[14]+3275163606&4294967295,B=R+(M<<9&4294967295|M>>>23),M=j+(R^P&(B^R))+V[3]+4107603335&4294967295,j=B+(M<<14&4294967295|M>>>18),M=P+(B^R&(j^B))+V[8]+1163531501&4294967295,P=j+(M<<20&4294967295|M>>>12),M=R+(j^B&(P^j))+V[13]+2850285829&4294967295,R=P+(M<<5&4294967295|M>>>27),M=B+(P^j&(R^P))+V[2]+4243563512&4294967295,B=R+(M<<9&4294967295|M>>>23),M=j+(R^P&(B^R))+V[7]+1735328473&4294967295,j=B+(M<<14&4294967295|M>>>18),M=P+(B^R&(j^B))+V[12]+2368359562&4294967295,P=j+(M<<20&4294967295|M>>>12),M=R+(P^j^B)+V[5]+4294588738&4294967295,R=P+(M<<4&4294967295|M>>>28),M=B+(R^P^j)+V[8]+2272392833&4294967295,B=R+(M<<11&4294967295|M>>>21),M=j+(B^R^P)+V[11]+1839030562&4294967295,j=B+(M<<16&4294967295|M>>>16),M=P+(j^B^R)+V[14]+4259657740&4294967295,P=j+(M<<23&4294967295|M>>>9),M=R+(P^j^B)+V[1]+2763975236&4294967295,R=P+(M<<4&4294967295|M>>>28),M=B+(R^P^j)+V[4]+1272893353&4294967295,B=R+(M<<11&4294967295|M>>>21),M=j+(B^R^P)+V[7]+4139469664&4294967295,j=B+(M<<16&4294967295|M>>>16),M=P+(j^B^R)+V[10]+3200236656&4294967295,P=j+(M<<23&4294967295|M>>>9),M=R+(P^j^B)+V[13]+681279174&4294967295,R=P+(M<<4&4294967295|M>>>28),M=B+(R^P^j)+V[0]+3936430074&4294967295,B=R+(M<<11&4294967295|M>>>21),M=j+(B^R^P)+V[3]+3572445317&4294967295,j=B+(M<<16&4294967295|M>>>16),M=P+(j^B^R)+V[6]+76029189&4294967295,P=j+(M<<23&4294967295|M>>>9),M=R+(P^j^B)+V[9]+3654602809&4294967295,R=P+(M<<4&4294967295|M>>>28),M=B+(R^P^j)+V[12]+3873151461&4294967295,B=R+(M<<11&4294967295|M>>>21),M=j+(B^R^P)+V[15]+530742520&4294967295,j=B+(M<<16&4294967295|M>>>16),M=P+(j^B^R)+V[2]+3299628645&4294967295,P=j+(M<<23&4294967295|M>>>9),M=R+(j^(P|~B))+V[0]+4096336452&4294967295,R=P+(M<<6&4294967295|M>>>26),M=B+(P^(R|~j))+V[7]+1126891415&4294967295,B=R+(M<<10&4294967295|M>>>22),M=j+(R^(B|~P))+V[14]+2878612391&4294967295,j=B+(M<<15&4294967295|M>>>17),M=P+(B^(j|~R))+V[5]+4237533241&4294967295,P=j+(M<<21&4294967295|M>>>11),M=R+(j^(P|~B))+V[12]+1700485571&4294967295,R=P+(M<<6&4294967295|M>>>26),M=B+(P^(R|~j))+V[3]+2399980690&4294967295,B=R+(M<<10&4294967295|M>>>22),M=j+(R^(B|~P))+V[10]+4293915773&4294967295,j=B+(M<<15&4294967295|M>>>17),M=P+(B^(j|~R))+V[1]+2240044497&4294967295,P=j+(M<<21&4294967295|M>>>11),M=R+(j^(P|~B))+V[8]+1873313359&4294967295,R=P+(M<<6&4294967295|M>>>26),M=B+(P^(R|~j))+V[15]+4264355552&4294967295,B=R+(M<<10&4294967295|M>>>22),M=j+(R^(B|~P))+V[6]+2734768916&4294967295,j=B+(M<<15&4294967295|M>>>17),M=P+(B^(j|~R))+V[13]+1309151649&4294967295,P=j+(M<<21&4294967295|M>>>11),M=R+(j^(P|~B))+V[4]+4149444226&4294967295,R=P+(M<<6&4294967295|M>>>26),M=B+(P^(R|~j))+V[11]+3174756917&4294967295,B=R+(M<<10&4294967295|M>>>22),M=j+(R^(B|~P))+V[2]+718787259&4294967295,j=B+(M<<15&4294967295|M>>>17),M=P+(B^(j|~R))+V[9]+3951481745&4294967295,k.g[0]=k.g[0]+R&4294967295,k.g[1]=k.g[1]+(j+(M<<21&4294967295|M>>>11))&4294967295,k.g[2]=k.g[2]+j&4294967295,k.g[3]=k.g[3]+B&4294967295}i.prototype.v=function(k,R){R===void 0&&(R=k.length);const P=R-this.blockSize,V=this.C;let j=this.h,B=0;for(;B<R;){if(j==0)for(;B<=P;)r(this,k,B),B+=this.blockSize;if(typeof k=="string"){for(;B<R;)if(V[j++]=k.charCodeAt(B++),j==this.blockSize){r(this,V),j=0;break}}else for(;B<R;)if(V[j++]=k[B++],j==this.blockSize){r(this,V),j=0;break}}this.h=j,this.o+=R},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var R=1;R<k.length-8;++R)k[R]=0;R=this.o*8;for(var P=k.length-8;P<k.length;++P)k[P]=R&255,R/=256;for(this.v(k),k=Array(16),R=0,P=0;P<4;++P)for(let V=0;V<32;V+=8)k[R++]=this.g[P]>>>V&255;return k};function s(k,R){var P=l;return Object.prototype.hasOwnProperty.call(P,k)?P[k]:P[k]=R(k)}function o(k,R){this.h=R;const P=[];let V=!0;for(let j=k.length-1;j>=0;j--){const B=k[j]|0;V&&B==R||(P[j]=B,V=!1)}this.g=P}var l={};function u(k){return-128<=k&&k<128?s(k,function(R){return new o([R|0],R<0?-1:0)}):new o([k|0],k<0?-1:0)}function h(k){if(isNaN(k)||!isFinite(k))return p;if(k<0)return S(h(-k));const R=[];let P=1;for(let V=0;k>=P;V++)R[V]=k/P|0,P*=4294967296;return new o(R,0)}function f(k,R){if(k.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(k.charAt(0)=="-")return S(f(k.substring(1),R));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=h(Math.pow(R,8));let V=p;for(let B=0;B<k.length;B+=8){var j=Math.min(8,k.length-B);const M=parseInt(k.substring(B,B+j),R);j<8?(j=h(Math.pow(R,j)),V=V.j(j).add(h(M))):(V=V.j(P),V=V.add(h(M)))}return V}var p=u(0),y=u(1),x=u(16777216);n=o.prototype,n.m=function(){if(T(this))return-S(this).m();let k=0,R=1;for(let P=0;P<this.g.length;P++){const V=this.i(P);k+=(V>=0?V:4294967296+V)*R,R*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(I(this))return"0";if(T(this))return"-"+S(this).toString(k);const R=h(Math.pow(k,6));var P=this;let V="";for(;;){const j=L(P,R).g;P=b(P,j.j(R));let B=((P.g.length>0?P.g[0]:P.h)>>>0).toString(k);if(P=j,I(P))return B+V;for(;B.length<6;)B="0"+B;V=B+V}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function I(k){if(k.h!=0)return!1;for(let R=0;R<k.g.length;R++)if(k.g[R]!=0)return!1;return!0}function T(k){return k.h==-1}n.l=function(k){return k=b(this,k),T(k)?-1:I(k)?0:1};function S(k){const R=k.g.length,P=[];for(let V=0;V<R;V++)P[V]=~k.g[V];return new o(P,~k.h).add(y)}n.abs=function(){return T(this)?S(this):this},n.add=function(k){const R=Math.max(this.g.length,k.g.length),P=[];let V=0;for(let j=0;j<=R;j++){let B=V+(this.i(j)&65535)+(k.i(j)&65535),M=(B>>>16)+(this.i(j)>>>16)+(k.i(j)>>>16);V=M>>>16,B&=65535,M&=65535,P[j]=M<<16|B}return new o(P,P[P.length-1]&-2147483648?-1:0)};function b(k,R){return k.add(S(R))}n.j=function(k){if(I(this)||I(k))return p;if(T(this))return T(k)?S(this).j(S(k)):S(S(this).j(k));if(T(k))return S(this.j(S(k)));if(this.l(x)<0&&k.l(x)<0)return h(this.m()*k.m());const R=this.g.length+k.g.length,P=[];for(var V=0;V<2*R;V++)P[V]=0;for(V=0;V<this.g.length;V++)for(let j=0;j<k.g.length;j++){const B=this.i(V)>>>16,M=this.i(V)&65535,se=k.i(j)>>>16,he=k.i(j)&65535;P[2*V+2*j]+=M*he,D(P,2*V+2*j),P[2*V+2*j+1]+=B*he,D(P,2*V+2*j+1),P[2*V+2*j+1]+=M*se,D(P,2*V+2*j+1),P[2*V+2*j+2]+=B*se,D(P,2*V+2*j+2)}for(k=0;k<R;k++)P[k]=P[2*k+1]<<16|P[2*k];for(k=R;k<2*R;k++)P[k]=0;return new o(P,0)};function D(k,R){for(;(k[R]&65535)!=k[R];)k[R+1]+=k[R]>>>16,k[R]&=65535,R++}function N(k,R){this.g=k,this.h=R}function L(k,R){if(I(R))throw Error("division by zero");if(I(k))return new N(p,p);if(T(k))return R=L(S(k),R),new N(S(R.g),S(R.h));if(T(R))return R=L(k,S(R)),new N(S(R.g),R.h);if(k.g.length>30){if(T(k)||T(R))throw Error("slowDivide_ only works with positive integers.");for(var P=y,V=R;V.l(k)<=0;)P=F(P),V=F(V);var j=G(P,1),B=G(V,1);for(V=G(V,2),P=G(P,2);!I(V);){var M=B.add(V);M.l(k)<=0&&(j=j.add(P),B=M),V=G(V,1),P=G(P,1)}return R=b(k,j.j(R)),new N(j,R)}for(j=p;k.l(R)>=0;){for(P=Math.max(1,Math.floor(k.m()/R.m())),V=Math.ceil(Math.log(P)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),B=h(P),M=B.j(R);T(M)||M.l(k)>0;)P-=V,B=h(P),M=B.j(R);I(B)&&(B=y),j=j.add(B),k=b(k,M)}return new N(j,k)}n.B=function(k){return L(this,k).h},n.and=function(k){const R=Math.max(this.g.length,k.g.length),P=[];for(let V=0;V<R;V++)P[V]=this.i(V)&k.i(V);return new o(P,this.h&k.h)},n.or=function(k){const R=Math.max(this.g.length,k.g.length),P=[];for(let V=0;V<R;V++)P[V]=this.i(V)|k.i(V);return new o(P,this.h|k.h)},n.xor=function(k){const R=Math.max(this.g.length,k.g.length),P=[];for(let V=0;V<R;V++)P[V]=this.i(V)^k.i(V);return new o(P,this.h^k.h)};function F(k){const R=k.g.length+1,P=[];for(let V=0;V<R;V++)P[V]=k.i(V)<<1|k.i(V-1)>>>31;return new o(P,k.h)}function G(k,R){const P=R>>5;R%=32;const V=k.g.length-P,j=[];for(let B=0;B<V;B++)j[B]=R>0?k.i(B+P)>>>R|k.i(B+P+1)<<32-R:k.i(B+P);return new o(j,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,ow=o}).apply(typeof cR<"u"?cR:typeof self<"u"?self:typeof window<"u"?window:{});var Yg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ok,Xh,Fk,pp,ex,Vk,jk,Uk;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yg=="object"&&Yg];for(var E=0;E<g.length;++E){var C=g[E];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=t(this);function r(g,E){if(E)e:{var C=i;g=g.split(".");for(var O=0;O<g.length-1;O++){var X=g[O];if(!(X in C))break e;C=C[X]}g=g[g.length-1],O=C[g],E=E(O),E!=O&&E!=null&&e(C,g,{configurable:!0,writable:!0,value:E})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(E){var C=[],O;for(O in E)Object.prototype.hasOwnProperty.call(E,O)&&C.push([O,E[O]]);return C}});var s=s||{},o=this||self;function l(g){var E=typeof g;return E=="object"&&g!=null||E=="function"}function u(g,E,C){return g.call.apply(g.bind,arguments)}function h(g,E,C){return h=u,h.apply(null,arguments)}function f(g,E){var C=Array.prototype.slice.call(arguments,1);return function(){var O=C.slice();return O.push.apply(O,arguments),g.apply(this,O)}}function p(g,E){function C(){}C.prototype=E.prototype,g.Z=E.prototype,g.prototype=new C,g.prototype.constructor=g,g.Ob=function(O,X,ee){for(var fe=Array(arguments.length-2),je=2;je<arguments.length;je++)fe[je-2]=arguments[je];return E.prototype[X].apply(O,fe)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function x(g){const E=g.length;if(E>0){const C=Array(E);for(let O=0;O<E;O++)C[O]=g[O];return C}return[]}function I(g,E){for(let O=1;O<arguments.length;O++){const X=arguments[O];var C=typeof X;if(C=C!="object"?C:X?Array.isArray(X)?"array":C:"null",C=="array"||C=="object"&&typeof X.length=="number"){C=g.length||0;const ee=X.length||0;g.length=C+ee;for(let fe=0;fe<ee;fe++)g[C+fe]=X[fe]}else g.push(X)}}class T{constructor(E,C){this.i=E,this.j=C,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function S(g){o.setTimeout(()=>{throw g},0)}function b(){var g=k;let E=null;return g.g&&(E=g.g,g.g=g.g.next,g.g||(g.h=null),E.next=null),E}class D{constructor(){this.h=this.g=null}add(E,C){const O=N.get();O.set(E,C),this.h?this.h.next=O:this.g=O,this.h=O}}var N=new T(()=>new L,g=>g.reset());class L{constructor(){this.next=this.g=this.h=null}set(E,C){this.h=E,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let F,G=!1,k=new D,R=()=>{const g=Promise.resolve(void 0);F=()=>{g.then(P)}};function P(){for(var g;g=b();){try{g.h.call(g.g)}catch(C){S(C)}var E=N;E.j(g),E.h<100&&(E.h++,g.next=E.g,E.g=g)}G=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(g,E){this.type=g,this.g=this.target=E,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,E=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const C=()=>{};o.addEventListener("test",C,E),o.removeEventListener("test",C,E)}catch{}return g})();function M(g){return/^[\s\xa0]*$/.test(g)}function se(g,E){j.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,E)}p(se,j),se.prototype.init=function(g,E){const C=this.type=g.type,O=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=E,E=g.relatedTarget,E||(C=="mouseover"?E=g.fromElement:C=="mouseout"&&(E=g.toElement)),this.relatedTarget=E,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&se.Z.h.call(this)},se.prototype.h=function(){se.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var he="closure_listenable_"+(Math.random()*1e6|0),ge=0;function ue(g,E,C,O,X){this.listener=g,this.proxy=null,this.src=E,this.type=C,this.capture=!!O,this.ha=X,this.key=++ge,this.da=this.fa=!1}function Q(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function re(g,E,C){for(const O in g)E.call(C,g[O],O,g)}function ne(g,E){for(const C in g)E.call(void 0,g[C],C,g)}function U(g){const E={};for(const C in g)E[C]=g[C];return E}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(g,E){let C,O;for(let X=1;X<arguments.length;X++){O=arguments[X];for(C in O)g[C]=O[C];for(let ee=0;ee<$.length;ee++)C=$[ee],Object.prototype.hasOwnProperty.call(O,C)&&(g[C]=O[C])}}function me(g){this.src=g,this.g={},this.h=0}me.prototype.add=function(g,E,C,O,X){const ee=g.toString();g=this.g[ee],g||(g=this.g[ee]=[],this.h++);const fe=ke(g,E,O,X);return fe>-1?(E=g[fe],C||(E.fa=!1)):(E=new ue(E,this.src,ee,!!O,X),E.fa=C,g.push(E)),E};function xe(g,E){const C=E.type;if(C in g.g){var O=g.g[C],X=Array.prototype.indexOf.call(O,E,void 0),ee;(ee=X>=0)&&Array.prototype.splice.call(O,X,1),ee&&(Q(E),g.g[C].length==0&&(delete g.g[C],g.h--))}}function ke(g,E,C,O){for(let X=0;X<g.length;++X){const ee=g[X];if(!ee.da&&ee.listener==E&&ee.capture==!!C&&ee.ha==O)return X}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),Ve={};function We(g,E,C,O,X){if(Array.isArray(E)){for(let ee=0;ee<E.length;ee++)We(g,E[ee],C,O,X);return null}return C=bi(C),g&&g[he]?g.J(E,C,l(O)?!!O.capture:!1,X):lt(g,E,C,!1,O,X)}function lt(g,E,C,O,X,ee){if(!E)throw Error("Invalid event type");const fe=l(X)?!!X.capture:!!X;let je=dn(g);if(je||(g[Me]=je=new me(g)),C=je.add(E,C,O,fe,ee),C.proxy)return C;if(O=er(),C.proxy=O,O.src=g,O.listener=C,g.addEventListener)B||(X=fe),X===void 0&&(X=!1),g.addEventListener(E.toString(),O,X);else if(g.attachEvent)g.attachEvent($n(E.toString()),O);else if(g.addListener&&g.removeListener)g.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return C}function er(){function g(C){return E.call(g.src,g.listener,C)}const E=hn;return g}function fs(g,E,C,O,X){if(Array.isArray(E))for(var ee=0;ee<E.length;ee++)fs(g,E[ee],C,O,X);else O=l(O)?!!O.capture:!!O,C=bi(C),g&&g[he]?(g=g.i,ee=String(E).toString(),ee in g.g&&(E=g.g[ee],C=ke(E,C,O,X),C>-1&&(Q(E[C]),Array.prototype.splice.call(E,C,1),E.length==0&&(delete g.g[ee],g.h--)))):g&&(g=dn(g))&&(E=g.g[E.toString()],g=-1,E&&(g=ke(E,C,O,X)),(C=g>-1?E[g]:null)&&Wn(C))}function Wn(g){if(typeof g!="number"&&g&&!g.da){var E=g.src;if(E&&E[he])xe(E.i,g);else{var C=g.type,O=g.proxy;E.removeEventListener?E.removeEventListener(C,O,g.capture):E.detachEvent?E.detachEvent($n(C),O):E.addListener&&E.removeListener&&E.removeListener(O),(C=dn(E))?(xe(C,g),C.h==0&&(C.src=null,E[Me]=null)):Q(g)}}}function $n(g){return g in Ve?Ve[g]:Ve[g]="on"+g}function hn(g,E){if(g.da)g=!0;else{E=new se(E,this);const C=g.listener,O=g.ha||g.src;g.fa&&Wn(g),g=C.call(O,E)}return g}function dn(g){return g=g[Me],g instanceof me?g:null}var Hn="__closure_events_fn_"+(Math.random()*1e9>>>0);function bi(g){return typeof g=="function"?g:(g[Hn]||(g[Hn]=function(E){return g.handleEvent(E)}),g[Hn])}function yt(){V.call(this),this.i=new me(this),this.M=this,this.G=null}p(yt,V),yt.prototype[he]=!0,yt.prototype.removeEventListener=function(g,E,C,O){fs(this,g,E,C,O)};function ct(g,E){var C,O=g.G;if(O)for(C=[];O;O=O.G)C.push(O);if(g=g.M,O=E.type||E,typeof E=="string")E=new j(E,g);else if(E instanceof j)E.target=E.target||g;else{var X=E;E=new j(O,g),ie(E,X)}X=!0;let ee,fe;if(C)for(fe=C.length-1;fe>=0;fe--)ee=E.g=C[fe],X=tn(ee,O,!0,E)&&X;if(ee=E.g=g,X=tn(ee,O,!0,E)&&X,X=tn(ee,O,!1,E)&&X,C)for(fe=0;fe<C.length;fe++)ee=E.g=C[fe],X=tn(ee,O,!1,E)&&X}yt.prototype.N=function(){if(yt.Z.N.call(this),this.i){var g=this.i;for(const E in g.g){const C=g.g[E];for(let O=0;O<C.length;O++)Q(C[O]);delete g.g[E],g.h--}}this.G=null},yt.prototype.J=function(g,E,C,O){return this.i.add(String(g),E,!1,C,O)},yt.prototype.K=function(g,E,C,O){return this.i.add(String(g),E,!0,C,O)};function tn(g,E,C,O){if(E=g.i.g[String(E)],!E)return!0;E=E.concat();let X=!0;for(let ee=0;ee<E.length;++ee){const fe=E[ee];if(fe&&!fe.da&&fe.capture==C){const je=fe.listener,Vt=fe.ha||fe.src;fe.fa&&xe(g.i,fe),X=je.call(Vt,O)!==!1&&X}}return X&&!O.defaultPrevented}function Pi(g,E){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:o.setTimeout(g,E||0)}function St(g){g.g=Pi(()=>{g.g=null,g.i&&(g.i=!1,St(g))},g.l);const E=g.h;g.h=null,g.m.apply(null,E)}class to extends V{constructor(E,C){super(),this.m=E,this.l=C,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:St(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ki(g){V.call(this),this.h=g,this.g={}}p(ki,V);var Ar=[];function tr(g){re(g.g,function(E,C){this.g.hasOwnProperty(C)&&Wn(E)},g),g.g={}}ki.prototype.N=function(){ki.Z.N.call(this),tr(this)},ki.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var br=o.JSON.stringify,ca=o.JSON.parse,Pr=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function Ni(){}function Ol(){}var kr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gs(){j.call(this,"d")}p(gs,j);function no(){j.call(this,"c")}p(no,j);var On={},ps=null;function Nr(){return ps=ps||new yt}On.Ia="serverreachability";function Dr(g){j.call(this,On.Ia,g)}p(Dr,j);function Fn(g){const E=Nr();ct(E,new Dr(E))}On.STAT_EVENT="statevent";function Vn(g,E){j.call(this,On.STAT_EVENT,g),this.stat=E}p(Vn,j);function ft(g){const E=Nr();ct(E,new Vn(E,g))}On.Ja="timingevent";function io(g,E){j.call(this,On.Ja,g),this.size=E}p(io,j);function nr(g,E){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},E)}function Ot(){this.g=!0}Ot.prototype.ua=function(){this.g=!1};function Di(g,E,C,O,X,ee){g.info(function(){if(g.g)if(ee){var fe="",je=ee.split("&");for(let ut=0;ut<je.length;ut++){var Vt=je[ut].split("=");if(Vt.length>1){const Gt=Vt[0];Vt=Vt[1];const mi=Gt.split("_");fe=mi.length>=2&&mi[1]=="type"?fe+(Gt+"="+Vt+"&"):fe+(Gt+"=redacted&")}}}else fe=null;else fe=ee;return"XMLHTTP REQ ("+O+") [attempt "+X+"]: "+E+`
`+C+`
`+fe})}function fn(g,E,C,O,X,ee,fe){g.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+X+"]: "+E+`
`+C+`
`+ee+" "+fe})}function Ft(g,E,C,O){g.info(function(){return"XMLHTTP TEXT ("+E+"): "+pn(g,C)+(O?" "+O:"")})}function gn(g,E){g.info(function(){return"TIMEOUT: "+E})}Ot.prototype.info=function(){};function pn(g,E){if(!g.g)return E;if(!E)return null;try{const ee=JSON.parse(E);if(ee){for(g=0;g<ee.length;g++)if(Array.isArray(ee[g])){var C=ee[g];if(!(C.length<2)){var O=C[1];if(Array.isArray(O)&&!(O.length<1)){var X=O[0];if(X!="noop"&&X!="stop"&&X!="close")for(let fe=1;fe<O.length;fe++)O[fe]=""}}}}return br(ee)}catch{return E}}var nn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bt;function qt(){}p(qt,Ni),qt.prototype.g=function(){return new XMLHttpRequest},Bt=new qt;function Mi(g){return encodeURIComponent(String(g))}function Fl(g){var E=1;g=g.split(":");const C=[];for(;E>0&&g.length;)C.push(g.shift()),E--;return g.length&&C.push(g.join(":")),C}function Li(g,E,C,O){this.j=g,this.i=E,this.l=C,this.S=O||1,this.V=new ki(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Tf}function Tf(){this.i=null,this.g="",this.h=!1}var Sf={},Fu={};function ir(g,E,C){g.M=1,g.A=ys(Oi(E)),g.u=C,g.R=!0,Vu(g,null)}function Vu(g,E){g.F=Date.now(),ua(g),g.B=Oi(g.A);var C=g.B,O=g.S;Array.isArray(O)||(O=[String(O)]),qu(C.i,"t",O),g.C=0,C=g.j.L,g.h=new Tf,g.g=Mf(g.j,C?E:null,!g.u),g.P>0&&(g.O=new to(h(g.Y,g,g.g),g.P)),E=g.V,C=g.g,O=g.ba;var X="readystatechange";Array.isArray(X)||(X&&(Ar[0]=X.toString()),X=Ar);for(let ee=0;ee<X.length;ee++){const fe=We(C,X[ee],O||E.handleEvent,!1,E.h||E);if(!fe)break;E.g[fe.key]=fe}E=g.J?U(g.J):{},g.u?(g.v||(g.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,E)):(g.v="GET",g.g.ea(g.B,g.v,null,E)),Fn(),Di(g.i,g.v,g.B,g.l,g.S,g.u)}Li.prototype.ba=function(g){g=g.target;const E=this.O;E&&Ur(g)==3?E.j():this.Y(g)},Li.prototype.Y=function(g){try{if(g==this.g)e:{const je=Ur(this.g),Vt=this.g.ya(),ut=this.g.ca();if(!(je<3)&&(je!=3||this.g&&(this.h.h||this.g.la()||Nf(this.g)))){this.K||je!=4||Vt==7||(Vt==8||ut<=0?Fn(3):Fn(2)),Vl(this);var E=this.g.ca();this.X=E;var C=If(this);if(this.o=E==200,fn(this.i,this.v,this.B,this.l,this.S,je,E),this.o){if(this.U&&!this.L){t:{if(this.g){var O,X=this.g;if((O=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(O)){var ee=O;break t}}ee=null}if(g=ee)Ft(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,vt(this,g);else{this.o=!1,this.m=3,ft(12),ms(this),ha(this);break e}}if(this.R){g=!0;let Gt;for(;!this.K&&this.C<C.length;)if(Gt=Rf(this,C),Gt==Fu){je==4&&(this.m=4,ft(14),g=!1),Ft(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==Sf){this.m=4,ft(15),Ft(this.i,this.l,C,"[Invalid Chunk]"),g=!1;break}else Ft(this.i,this.l,Gt,null),vt(this,Gt);if(Cf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),je!=4||C.length!=0||this.h.h||(this.m=1,ft(16),g=!1),this.o=this.o&&g,!g)Ft(this.i,this.l,C,"[Invalid Chunked Response]"),ms(this),ha(this);else if(C.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),xa(fe),fe.P=!0,ft(11))}}else Ft(this.i,this.l,C,null),vt(this,C);je==4&&ms(this),this.o&&!this.K&&(je==4?ql(this.j,this):(this.o=!1,ua(this)))}else Yu(this.g),E==400&&C.indexOf("Unknown SID")>0?(this.m=3,ft(12)):(this.m=0,ft(13)),ms(this),ha(this)}}}catch{}};function If(g){if(!Cf(g))return g.g.la();const E=Nf(g.g);if(E==="")return"";let C="";const O=E.length,X=Ur(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ms(g),ha(g),"";g.h.i=new o.TextDecoder}for(let ee=0;ee<O;ee++)g.h.h=!0,C+=g.h.i.decode(E[ee],{stream:!(X&&ee==O-1)});return E.length=0,g.h.g+=C,g.C=0,g.h.g}function Cf(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Rf(g,E){var C=g.C,O=E.indexOf(`
`,C);return O==-1?Fu:(C=Number(E.substring(C,O)),isNaN(C)?Sf:(O+=1,O+C>E.length?Fu:(E=E.slice(O,O+C),g.C=O+C,E)))}Li.prototype.cancel=function(){this.K=!0,ms(this)};function ua(g){g.T=Date.now()+g.H,ju(g,g.H)}function ju(g,E){if(g.D!=null)throw Error("WatchDog timer not null");g.D=nr(h(g.aa,g),E)}function Vl(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Li.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(gn(this.i,this.B),this.M!=2&&(Fn(),ft(17)),ms(this),this.m=2,ha(this)):ju(this,this.T-g)};function ha(g){g.j.I==0||g.K||ql(g.j,g)}function ms(g){Vl(g);var E=g.O;E&&typeof E.dispose=="function"&&E.dispose(),g.O=null,tr(g.V),g.g&&(E=g.g,g.g=null,E.abort(),E.dispose())}function vt(g,E){try{var C=g.j;if(C.I!=0&&(C.g==g||zu(C.h,g))){if(!g.L&&zu(C.h,g)&&C.I==3){try{var O=C.Ba.g.parse(E)}catch{O=null}if(Array.isArray(O)&&O.length==3){var X=O;if(X[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<g.F)Kl(C),gi(C);else break e;Gr(C),ft(18)}}else C.xa=X[1],0<C.xa-C.K&&X[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=nr(h(C.Va,C),6e3));da(C.h)<=1&&C.ta&&(C.ta=void 0)}else pi(C,11)}else if((g.L||C.g==g)&&Kl(C),!M(E))for(X=C.Ba.g.parse(E),E=0;E<X.length;E++){let ut=X[E];const Gt=ut[0];if(!(Gt<=C.K))if(C.K=Gt,ut=ut[1],C.I==2)if(ut[0]=="c"){C.M=ut[1],C.ba=ut[2];const mi=ut[3];mi!=null&&(C.ka=mi,C.j.info("VER="+C.ka));const Es=ut[4];Es!=null&&(C.za=Es,C.j.info("SVER="+C.za));const Wr=ut[5];Wr!=null&&typeof Wr=="number"&&Wr>0&&(O=1.5*Wr,C.O=O,C.j.info("backChannelRequestTimeoutMs_="+O)),O=C;const $r=g.g;if($r){const Zl=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zl){var ee=O.h;ee.g||Zl.indexOf("spdy")==-1&&Zl.indexOf("quic")==-1&&Zl.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(Ul(ee,ee.h),ee.h=null))}if(O.G){const Ju=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;Ju&&(O.wa=Ju,st(O.J,O.G,Ju))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-g.F,C.j.info("Handshake RTT: "+C.T+"ms")),O=C;var fe=g;if(O.na=Qu(O,O.L?O.ba:null,O.W),fe.L){fa(O.h,fe);var je=fe,Vt=O.O;Vt&&(je.H=Vt),je.D&&(Vl(je),ua(je)),O.g=fe}else Cn(O);C.i.length>0&&ws(C)}else ut[0]!="stop"&&ut[0]!="close"||pi(C,7);else C.I==3&&(ut[0]=="stop"||ut[0]=="close"?ut[0]=="stop"?pi(C,7):$l(C):ut[0]!="noop"&&C.l&&C.l.qa(ut),C.A=0)}}Fn(4)}catch{}}var Ey=class{constructor(g,E){this.g=g,this.map=E}};function jl(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Uu(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function da(g){return g.h?1:g.g?g.g.size:0}function zu(g,E){return g.h?g.h==E:g.g?g.g.has(E):!1}function Ul(g,E){g.g?g.g.add(E):g.h=E}function fa(g,E){g.h&&g.h==E?g.h=null:g.g&&g.g.has(E)&&g.g.delete(E)}jl.prototype.cancel=function(){if(this.i=hi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function hi(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let E=g.i;for(const C of g.g.values())E=E.concat(C.G);return E}return x(g.i)}var Af=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function di(g,E){if(g){g=g.split("&");for(let C=0;C<g.length;C++){const O=g[C].indexOf("=");let X,ee=null;O>=0?(X=g[C].substring(0,O),ee=g[C].substring(O+1)):X=g[C],E(X,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Mr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;g instanceof Mr?(this.l=g.l,ga(this,g.j),this.o=g.o,this.g=g.g,Lr(this,g.u),this.h=g.h,ro(this,Xu(g.i)),this.m=g.m):g&&(E=String(g).match(Af))?(this.l=!1,ga(this,E[1]||"",!0),this.o=pa(E[2]||""),this.g=pa(E[3]||"",!0),Lr(this,E[4]),this.h=pa(E[5]||"",!0),ro(this,E[6]||"",!0),this.m=pa(E[7]||"")):(this.l=!1,this.i=new qe(null,this.l))}Mr.prototype.toString=function(){const g=[];var E=this.j;E&&g.push(ma(E,Gu,!0),":");var C=this.g;return(C||E=="file")&&(g.push("//"),(E=this.o)&&g.push(ma(E,Gu,!0),"@"),g.push(Mi(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&g.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&g.push("/"),g.push(ma(C,C.charAt(0)=="/"?ya:Wu,!0))),(C=this.i.toString())&&g.push("?",C),(C=this.m)&&g.push("#",ma(C,$u)),g.join("")},Mr.prototype.resolve=function(g){const E=Oi(this);let C=!!g.j;C?ga(E,g.j):C=!!g.o,C?E.o=g.o:C=!!g.g,C?E.g=g.g:C=g.u!=null;var O=g.h;if(C)Lr(E,g.u);else if(C=!!g.h){if(O.charAt(0)!="/")if(this.g&&!this.h)O="/"+O;else{var X=E.h.lastIndexOf("/");X!=-1&&(O=E.h.slice(0,X+1)+O)}if(X=O,X==".."||X==".")O="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){O=X.lastIndexOf("/",0)==0,X=X.split("/");const ee=[];for(let fe=0;fe<X.length;){const je=X[fe++];je=="."?O&&fe==X.length&&ee.push(""):je==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),O&&fe==X.length&&ee.push("")):(ee.push(je),O=!0)}O=ee.join("/")}else O=X}return C?E.h=O:C=g.i.toString()!=="",C?ro(E,Xu(g.i)):C=!!g.m,C&&(E.m=g.m),E};function Oi(g){return new Mr(g)}function ga(g,E,C){g.j=C?pa(E,!0):E,g.j&&(g.j=g.j.replace(/:$/,""))}function Lr(g,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);g.u=E}else g.u=null}function ro(g,E,C){E instanceof qe?(g.i=E,Bl(g.i,g.l)):(C||(E=ma(E,Ty)),g.i=new qe(E,g.l))}function st(g,E,C){g.i.set(E,C)}function ys(g){return st(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function pa(g,E){return g?E?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ma(g,E,C){return typeof g=="string"?(g=encodeURI(g).replace(E,Bu),C&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Bu(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Gu=/[#\/\?@]/g,Wu=/[#\?:]/g,ya=/[#\?]/g,Ty=/[#\?@]/g,$u=/#/g;function qe(g,E){this.h=this.g=null,this.i=g||null,this.j=!!E}function Or(g){g.g||(g.g=new Map,g.h=0,g.i&&di(g.i,function(E,C){g.add(decodeURIComponent(E.replace(/\+/g," ")),C)}))}n=qe.prototype,n.add=function(g,E){Or(this),this.i=null,g=Fr(this,g);let C=this.g.get(g);return C||this.g.set(g,C=[]),C.push(E),this.h+=1,this};function Hu(g,E){Or(g),E=Fr(g,E),g.g.has(E)&&(g.i=null,g.h-=g.g.get(E).length,g.g.delete(E))}function zl(g,E){return Or(g),E=Fr(g,E),g.g.has(E)}n.forEach=function(g,E){Or(this),this.g.forEach(function(C,O){C.forEach(function(X){g.call(E,X,O,this)},this)},this)};function Ku(g,E){Or(g);let C=[];if(typeof E=="string")zl(g,E)&&(C=C.concat(g.g.get(Fr(g,E))));else for(g=Array.from(g.g.values()),E=0;E<g.length;E++)C=C.concat(g[E]);return C}n.set=function(g,E){return Or(this),this.i=null,g=Fr(this,g),zl(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[E]),this.h+=1,this},n.get=function(g,E){return g?(g=Ku(this,g),g.length>0?String(g[0]):E):E};function qu(g,E,C){Hu(g,E),C.length>0&&(g.i=null,g.g.set(Fr(g,E),x(C)),g.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],E=Array.from(this.g.keys());for(let O=0;O<E.length;O++){var C=E[O];const X=Mi(C);C=Ku(this,C);for(let ee=0;ee<C.length;ee++){let fe=X;C[ee]!==""&&(fe+="="+Mi(C[ee])),g.push(fe)}}return this.i=g.join("&")};function Xu(g){const E=new qe;return E.i=g.i,g.g&&(E.g=new Map(g.g),E.h=g.h),E}function Fr(g,E){return E=String(E),g.j&&(E=E.toLowerCase()),E}function Bl(g,E){E&&!g.j&&(Or(g),g.i=null,g.g.forEach(function(C,O){const X=O.toLowerCase();O!=X&&(Hu(this,O),qu(this,X,C))},g)),g.j=E}function Vr(g,E){const C=new Ot;if(o.Image){const O=new Image;O.onload=f(mn,C,"TestLoadImage: loaded",!0,E,O),O.onerror=f(mn,C,"TestLoadImage: error",!1,E,O),O.onabort=f(mn,C,"TestLoadImage: abort",!1,E,O),O.ontimeout=f(mn,C,"TestLoadImage: timeout",!1,E,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=g}else E(!1)}function jr(g,E){const C=new Ot,O=new AbortController,X=setTimeout(()=>{O.abort(),mn(C,"TestPingServer: timeout",!1,E)},1e4);fetch(g,{signal:O.signal}).then(ee=>{clearTimeout(X),ee.ok?mn(C,"TestPingServer: ok",!0,E):mn(C,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(X),mn(C,"TestPingServer: error",!1,E)})}function mn(g,E,C,O,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),O(C)}catch{}}function _a(){this.g=new Pr}function _s(g){this.i=g.Sb||null,this.h=g.ab||!1}p(_s,Ni),_s.prototype.g=function(){return new fi(this.i,this.h)};function fi(g,E){yt.call(this),this.H=g,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(fi,yt),n=fi.prototype,n.open=function(g,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=E,this.readyState=1,rr(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(E.body=g),(this.H||o).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,so(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,rr(this)),this.g&&(this.readyState=3,rr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;bf(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function bf(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var E=g.value?g.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!g.done}))&&(this.response=this.responseText+=E)}g.done?so(this):rr(this),this.readyState==3&&bf(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,so(this))},n.Na=function(g){this.g&&(this.response=g,so(this))},n.ga=function(){this.g&&so(this)};function so(g){g.readyState=4,g.l=null,g.j=null,g.B=null,rr(g)}n.setRequestHeader=function(g,E){this.A.append(g,E)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],E=this.h.entries();for(var C=E.next();!C.done;)C=C.value,g.push(C[0]+": "+C[1]),C=E.next();return g.join(`\r
`)};function rr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(fi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Pf(g){let E="";return re(g,function(C,O){E+=O,E+=":",E+=C,E+=`\r
`}),E}function Gl(g,E,C){e:{for(O in C){var O=!1;break e}O=!0}O||(C=Pf(C),typeof g=="string"?C!=null&&Mi(C):st(g,E,C))}function pt(g){yt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(pt,yt);var kf=/^https?$/i,Sy=["POST","PUT"];n=pt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,E,C,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);E=E?E.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bt.g(),this.g.onreadystatechange=y(h(this.Ca,this));try{this.B=!0,this.g.open(E,String(g),!0),this.B=!1}catch(ee){oo(this,ee);return}if(g=C||"",C=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var X in O)C.set(X,O[X]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const ee of O.keys())C.set(ee,O.get(ee));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(C.keys()).find(ee=>ee.toLowerCase()=="content-type"),X=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(Sy,E,void 0)>=0)||O||X||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,fe]of C)this.g.setRequestHeader(ee,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(ee){oo(this,ee)}};function oo(g,E){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=E,g.o=5,ao(g),xs(g)}function ao(g){g.A||(g.A=!0,ct(g,"complete"),ct(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ct(this,"complete"),ct(this,"abort"),xs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xs(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?vs(this):this.Xa())},n.Xa=function(){vs(this)};function vs(g){if(g.h&&typeof s<"u"){if(g.v&&Ur(g)==4)setTimeout(g.Ca.bind(g),0);else if(ct(g,"readystatechange"),Ur(g)==4){g.h=!1;try{const ee=g.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var C;if(!(C=E)){var O;if(O=ee===0){let fe=String(g.D).match(Af)[1]||null;!fe&&o.self&&o.self.location&&(fe=o.self.location.protocol.slice(0,-1)),O=!kf.test(fe?fe.toLowerCase():"")}C=O}if(C)ct(g,"complete"),ct(g,"success");else{g.o=6;try{var X=Ur(g)>2?g.g.statusText:""}catch{X=""}g.l=X+" ["+g.ca()+"]",ao(g)}}finally{xs(g)}}}}function xs(g,E){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const C=g.g;g.g=null,E||ct(g,"ready");try{C.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ur(g){return g.g?g.g.readyState:0}n.ca=function(){try{return Ur(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var E=this.g.responseText;return g&&E.indexOf(g)==0&&(E=E.substring(g.length)),ca(E)}};function Nf(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Yu(g){const E={};g=(g.g&&Ur(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<g.length;O++){if(M(g[O]))continue;var C=Fl(g[O]);const X=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ee=E[X]||[];E[X]=ee,ee.push(C)}ne(E,function(O){return O.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function zr(g,E,C){return C&&C.internalChannelParams&&C.internalChannelParams[g]||E}function Wl(g){this.za=0,this.i=[],this.j=new Ot,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=zr("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=zr("baseRetryDelayMs",5e3,g),this.Za=zr("retryDelaySeedMs",1e4,g),this.Ta=zr("forwardChannelMaxRetries",2,g),this.va=zr("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new jl(g&&g.concurrentRequestLimit),this.Ba=new _a,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Wl.prototype,n.ka=8,n.I=1,n.connect=function(g,E,C,O){ft(0),this.W=g,this.H=E||{},C&&O!==void 0&&(this.H.OSID=C,this.H.OAID=O),this.F=this.X,this.J=Qu(this,null,this.W),ws(this)};function $l(g){if(Hl(g),g.I==3){var E=g.V++,C=Oi(g.J);if(st(C,"SID",g.M),st(C,"RID",E),st(C,"TYPE","terminate"),Br(g,C),E=new Li(g,g.j,E),E.M=2,E.A=ys(Oi(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(E.A.toString(),"")}catch{}!C&&o.Image&&(new Image().src=E.A,C=!0),C||(E.g=Mf(E.j,null),E.g.ea(E.A)),E.F=Date.now(),ua(E)}wa(g)}function gi(g){g.g&&(xa(g),g.g.cancel(),g.g=null)}function Hl(g){gi(g),g.v&&(o.clearTimeout(g.v),g.v=null),Kl(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function ws(g){if(!Uu(g.h)&&!g.m){g.m=!0;var E=g.Ea;F||R(),G||(F(),G=!0),k.add(E,g),g.D=0}}function Df(g,E){return da(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=E.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=nr(h(g.Ea,g,E),Xl(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const X=new Li(this,this.j,g);let ee=this.o;if(this.U&&(ee?(ee=U(ee),ie(ee,this.U)):ee=this.U),this.u!==null||this.R||(X.J=ee,ee=null),this.S)e:{for(var E=0,C=0;C<this.i.length;C++){t:{var O=this.i[C];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(E+=O,E>4096){E=C;break e}if(E===4096||C===this.i.length-1){E=C+1;break e}}E=1e3}else E=1e3;E=Zu(this,X,E),C=Oi(this.J),st(C,"RID",g),st(C,"CVER",22),this.G&&st(C,"X-HTTP-Session-Id",this.G),Br(this,C),ee&&(this.R?E="headers="+Mi(Pf(ee))+"&"+E:this.u&&Gl(C,this.u,ee)),Ul(this.h,X),this.Ra&&st(C,"TYPE","init"),this.S?(st(C,"$req",E),st(C,"SID","null"),X.U=!0,ir(X,C,null)):ir(X,C,E),this.I=2}}else this.I==3&&(g?va(this,g):this.i.length==0||Uu(this.h)||va(this))};function va(g,E){var C;E?C=E.l:C=g.V++;const O=Oi(g.J);st(O,"SID",g.M),st(O,"RID",C),st(O,"AID",g.K),Br(g,O),g.u&&g.o&&Gl(O,g.u,g.o),C=new Li(g,g.j,C,g.D+1),g.u===null&&(C.J=g.o),E&&(g.i=E.G.concat(g.i)),E=Zu(g,C,1e3),C.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Ul(g.h,C),ir(C,O,E)}function Br(g,E){g.H&&re(g.H,function(C,O){st(E,O,C)}),g.l&&re({},function(C,O){st(E,O,C)})}function Zu(g,E,C){C=Math.min(g.i.length,C);const O=g.l?h(g.l.Ka,g.l,g):null;e:{var X=g.i;let je=-1;for(;;){const Vt=["count="+C];je==-1?C>0?(je=X[0].g,Vt.push("ofs="+je)):je=0:Vt.push("ofs="+je);let ut=!0;for(let Gt=0;Gt<C;Gt++){var ee=X[Gt].g;const mi=X[Gt].map;if(ee-=je,ee<0)je=Math.max(0,X[Gt].g-100),ut=!1;else try{ee="req"+ee+"_"||"";try{var fe=mi instanceof Map?mi:Object.entries(mi);for(const[Es,Wr]of fe){let $r=Wr;l(Wr)&&($r=br(Wr)),Vt.push(ee+Es+"="+encodeURIComponent($r))}}catch(Es){throw Vt.push(ee+"type="+encodeURIComponent("_badmap")),Es}}catch{O&&O(mi)}}if(ut){fe=Vt.join("&");break e}}fe=void 0}return g=g.i.splice(0,C),E.G=g,fe}function Cn(g){if(!g.g&&!g.v){g.Y=1;var E=g.Da;F||R(),G||(F(),G=!0),k.add(E,g),g.A=0}}function Gr(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=nr(h(g.Da,g),Xl(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,lo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=nr(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ft(10),gi(this),lo(this))};function xa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function lo(g){g.g=new Li(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var E=Oi(g.na);st(E,"RID","rpc"),st(E,"SID",g.M),st(E,"AID",g.K),st(E,"CI",g.F?"0":"1"),!g.F&&g.ia&&st(E,"TO",g.ia),st(E,"TYPE","xmlhttp"),Br(g,E),g.u&&g.o&&Gl(E,g.u,g.o),g.O&&(g.g.H=g.O);var C=g.g;g=g.ba,C.M=1,C.A=ys(Oi(E)),C.u=null,C.R=!0,Vu(C,g)}n.Va=function(){this.C!=null&&(this.C=null,gi(this),Gr(this),ft(19))};function Kl(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function ql(g,E){var C=null;if(g.g==E){Kl(g),xa(g),g.g=null;var O=2}else if(zu(g.h,E))C=E.G,fa(g.h,E),O=1;else return;if(g.I!=0){if(E.o)if(O==1){C=E.u?E.u.length:0,E=Date.now()-E.F;var X=g.D;O=Nr(),ct(O,new io(O,C)),ws(g)}else Cn(g);else if(X=E.m,X==3||X==0&&E.X>0||!(O==1&&Df(g,E)||O==2&&Gr(g)))switch(C&&C.length>0&&(E=g.h,E.i=E.i.concat(C)),X){case 1:pi(g,5);break;case 4:pi(g,10);break;case 3:pi(g,6);break;default:pi(g,2)}}}function Xl(g,E){let C=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(C*=2),C*E}function pi(g,E){if(g.j.info("Error code "+E),E==2){var C=h(g.bb,g),O=g.Ua;const X=!O;O=new Mr(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ga(O,"https"),ys(O),X?Vr(O.toString(),C):jr(O.toString(),C)}else ft(2);g.I=0,g.l&&g.l.pa(E),wa(g),Hl(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function wa(g){if(g.I=0,g.ja=[],g.l){const E=hi(g.h);(E.length!=0||g.i.length!=0)&&(I(g.ja,E),I(g.ja,g.i),g.h.i.length=0,x(g.i),g.i.length=0),g.l.oa()}}function Qu(g,E,C){var O=C instanceof Mr?Oi(C):new Mr(C);if(O.g!="")E&&(O.g=E+"."+O.g),Lr(O,O.u);else{var X=o.location;O=X.protocol,E=E?E+"."+X.hostname:X.hostname,X=+X.port;const ee=new Mr(null);O&&ga(ee,O),E&&(ee.g=E),X&&Lr(ee,X),C&&(ee.h=C),O=ee}return C=g.G,E=g.wa,C&&E&&st(O,C,E),st(O,"VER",g.ka),Br(g,O),O}function Mf(g,E,C){if(E&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=g.Aa&&!g.ma?new pt(new _s({ab:C})):new pt(g.ma),E.Fa(g.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Lf(){}n=Lf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Yl(){}Yl.prototype.g=function(g,E){return new yn(g,E)};function yn(g,E){yt.call(this),this.g=new Wl(E),this.l=g,this.h=E&&E.messageUrlParams||null,g=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(g?g["X-WebChannel-Content-Type"]=E.messageContentType:g={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(g?g["X-WebChannel-Client-Profile"]=E.sa:g={"X-WebChannel-Client-Profile":E.sa}),this.g.U=g,(g=E&&E.Qb)&&!M(g)&&(this.g.u=g),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!M(E)&&(this.g.G=E,g=this.h,g!==null&&E in g&&(g=this.h,E in g&&delete g[E])),this.j=new co(this)}p(yn,yt),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){$l(this.g)},yn.prototype.o=function(g){var E=this.g;if(typeof g=="string"){var C={};C.__data__=g,g=C}else this.v&&(C={},C.__data__=br(g),g=C);E.i.push(new Ey(E.Ya++,g)),E.I==3&&ws(E)},yn.prototype.N=function(){this.g.l=null,delete this.j,$l(this.g),delete this.g,yn.Z.N.call(this)};function Of(g){gs.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var E=g.__sm__;if(E){e:{for(const C in E){g=C;break e}g=void 0}(this.i=g)&&(g=this.i,E=E!==null&&g in E?E[g]:void 0),this.data=E}else this.data=g}p(Of,gs);function Ff(){no.call(this),this.status=1}p(Ff,no);function co(g){this.g=g}p(co,Lf),co.prototype.ra=function(){ct(this.g,"a")},co.prototype.qa=function(g){ct(this.g,new Of(g))},co.prototype.pa=function(g){ct(this.g,new Ff)},co.prototype.oa=function(){ct(this.g,"b")},Yl.prototype.createWebChannel=Yl.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,Uk=function(){return new Yl},jk=function(){return Nr()},Vk=On,ex={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},nn.NO_ERROR=0,nn.TIMEOUT=8,nn.HTTP_ERROR=6,pp=nn,rt.COMPLETE="complete",Fk=rt,Ol.EventType=kr,kr.OPEN="a",kr.CLOSE="b",kr.ERROR="c",kr.MESSAGE="d",yt.prototype.listen=yt.prototype.J,Xh=Ol,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,Ok=pt}).apply(typeof Yg<"u"?Yg:typeof self<"u"?self:typeof window<"u"?window:{});const uR="@firebase/firestore",hR="4.9.3";let wn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};wn.UNAUTHENTICATED=new wn(null),wn.GOOGLE_CREDENTIALS=new wn("google-credentials-uid"),wn.FIRST_PARTY=new wn("first-party-uid"),wn.MOCK_USER=new wn("mock-user");let Lu="12.7.0";const Tl=new K1("@firebase/firestore");function Lc(){return Tl.logLevel}function pe(n,...e){if(Tl.logLevel<=Ke.DEBUG){const t=e.map(aw);Tl.debug(`Firestore (${Lu}): ${n}`,...t)}}function Ti(n,...e){if(Tl.logLevel<=Ke.ERROR){const t=e.map(aw);Tl.error(`Firestore (${Lu}): ${n}`,...t)}}function ny(n,...e){if(Tl.logLevel<=Ke.WARN){const t=e.map(aw);Tl.warn(`Firestore (${Lu}): ${n}`,...t)}}function aw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Re(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,zk(n,i,t)}function zk(n,e,t){let i=`FIRESTORE (${Lu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ti(i),new Error(i)}function De(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||zk(e,r,i)}function Tt(n,e){return n}const le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends hs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ll{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Bk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class M8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(wn.UNAUTHENTICATED)))}shutdown(){}}class L8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class O8{constructor(e){this.t=e,this.currentUser=wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){De(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new ll;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ll,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},l=u=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ll)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(De(typeof i.accessToken=="string",31837,{l:i}),new Bk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return De(e===null||typeof e=="string",2055,{h:e}),new wn(e)}}class F8{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class V8{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new F8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(wn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class dR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class j8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Hi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){De(this.o===void 0,3512);const i=s=>{s.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,pe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new dR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(De(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new dR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function U8(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Gk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=U8(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function He(n,e){return n<e?-1:n>e?1:0}function tx(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return q_(r)===q_(s)?He(r,s):q_(r)?1:-1}return He(n.length,e.length)}const z8=55296,B8=57343;function q_(n){const e=n.charCodeAt(0);return e>=z8&&e<=B8}function mu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function Wk(n){return n+"\0"}const fR="__name__";class Yr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Re(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Re(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Yr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Yr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return He(e.length,t.length)}static compareSegments(e,t){const i=Yr.isNumericId(e),r=Yr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Yr.extractNumericId(e).compare(Yr.extractNumericId(t)):tx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ow.fromString(e.substring(4,e.length-2))}}class Ct extends Yr{construct(e,t,i){return new Ct(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Se(le.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Ct(t)}static emptyPath(){return new Ct([])}}const G8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends Yr{construct(e,t,i){return new zt(e,t,i)}static isValidIdentifier(e){return G8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fR}static keyField(){return new zt([fR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Se(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Se(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Se(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new Se(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(t)}static emptyPath(){return new zt([])}}class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(Ct.fromString(e))}static fromName(e){return new Ee(Ct.fromString(e).popFirst(5))}static empty(){return new Ee(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new Ct(e.slice()))}}function W8(n,e,t,i){if(e===!0&&i===!0)throw new Se(le.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function $8(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function H8(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Re(12329,{type:typeof n})}function $k(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Se(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=H8(n);throw new Se(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Kt(n,e){const t={typeString:n};return e&&(t.value=e),t}function vf(n,e){if(!$8(n))throw new Se(le.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Se(le.INVALID_ARGUMENT,t);return!0}const gR=-62135596800,pR=1e6;class Pt{static now(){return Pt.fromMillis(Date.now())}static fromDate(e){return Pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*pR);return new Pt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Se(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Se(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<gR)throw new Se(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/pR}_compareTo(e){return this.seconds===e.seconds?He(this.nanoseconds,e.nanoseconds):He(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(vf(e,Pt._jsonSchema))return new Pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-gR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Pt._jsonSchemaVersion="firestore/timestamp/1.0",Pt._jsonSchema={type:Kt("string",Pt._jsonSchemaVersion),seconds:Kt("number"),nanoseconds:Kt("number")};class Qe{static fromTimestamp(e){return new Qe(e)}static min(){return new Qe(new Pt(0,0))}static max(){return new Qe(new Pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Vd=-1;class rm{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function nx(n){return n.fields.find((e=>e.kind===2))}function Ga(n){return n.fields.filter((e=>e.kind!==2))}rm.UNKNOWN_ID=-1;class mp{constructor(e,t){this.fieldPath=e,this.kind=t}}class jd{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new jd(0,Ai.min())}}function K8(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Qe.fromTimestamp(i===1e9?new Pt(t+1,0):new Pt(t,i));return new Ai(r,Ee.empty(),e)}function Hk(n){return new Ai(n.readTime,n.key,Vd)}class Ai{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ai(Qe.min(),Ee.empty(),Vd)}static max(){return new Ai(Qe.max(),Ee.empty(),Vd)}}function lw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:He(n.largestBatchId,e.largestBatchId))}const Kk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class qk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function iy(n){if(n.code!==le.FAILED_PRECONDITION||n.message!==Kk)throw n;pe("LocalStore","Unexpectedly lost primary lease")}class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Z(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Z?t:Z.resolve(t)}catch(t){return Z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.reject(t)}static resolve(e){return new Z(((t,i)=>{t(e)}))}static reject(e){return new Z(((t,i)=>{i(e)}))}static waitFor(e){return new Z(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=Z.resolve(!1);for(const i of e)t=t.next((r=>r?Z.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Z(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new Z(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const xi="SimpleDb";class ry{static open(e,t,i,r){try{return new ry(t,e.transaction(r,i))}catch(s){throw new sd(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ll,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new sd(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=cw(i.target.error);this.S.reject(new sd(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(pe(xi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new X8(t)}}class Qo{static delete(e){return pe(xi,"Removing database:",e),Ha($P().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ek())return!1;if(Qo.F())return!0;const e=Jt(),t=Qo.M(e),i=0<t&&t<10,r=Xk(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Qo.M(Jt())===12.2&&Ti("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(pe(xi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new sd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Se(le.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Se(le.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new sd(e,o))},r.onupgradeneeded=s=>{pe(xi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{pe(xi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=ry.open(this.db,e,s?"readonly":"readwrite",i),u=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),Z.reject(h)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,h=u.name!=="FirebaseError"&&o<3;if(pe(xi,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Xk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class q8{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ha(this.U.delete())}}class sd extends Se{constructor(e,t){super(le.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ll(n){return n.name==="IndexedDbTransactionError"}class X8{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(pe(xi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(pe(xi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ha(i)}add(e){return pe(xi,"ADD",this.store.name,e,e),Ha(this.store.add(e))}get(e){return Ha(this.store.get(e)).next((t=>(t===void 0&&(t=null),pe(xi,"GET",this.store.name,e,t),t)))}delete(e){return pe(xi,"DELETE",this.store.name,e),Ha(this.store.delete(e))}count(){return pe(xi,"COUNT",this.store.name),Ha(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Z(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Z(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){pe(xi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Z(((i,r)=>{t.onerror=s=>{const o=cw(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Z(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new q8(l),h=t(l.primaryKey,l.value,u);if(h instanceof Z){const f=h.catch((p=>(u.done(),Z.reject(p))));i.push(f)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}})).next((()=>Z.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ha(n){return new Z(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=cw(i.target.error);t(r)}}))}let mR=!1;function cw(n){const e=Qo.M(Jt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Se("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return mR||(mR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const od="IndexBackfiller";class Y8{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){pe(od,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();pe(od,`Documents written: ${t}`)}catch(t){Ll(t)?pe(od,"Ignoring IndexedDB error during index backfill: ",t):await iy(t)}await this.re(6e4)}))}}class Z8{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Z.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return pe(od,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(pe(od,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=Hk(s);lw(o,i)>0&&(i=o)})),new Ai(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class vr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}vr.ce=-1;const cl=-1;function sy(n){return n==null}function sm(n){return n===0&&1/n==-1/0}const om="";function Gn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=yR(e)),e=Q8(n.get(t),e);return yR(e)}function Q8(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case om:t+="";break;default:t+=s}}return t}function yR(n){return n+om+""}function es(n){const e=n.length;if(De(e>=2,64408,{path:n}),e===2)return De(n.charAt(0)===om&&n.charAt(1)==="",56145,{path:n}),Ct.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(om,s);switch((o<0||o>t)&&Re(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Re(61167,{path:n})}s=o+2}return new Ct(i)}const Wa="remoteDocuments",xf="owner",Ic="owner",Ud="mutationQueues",J8="userId",fr="mutations",_R="batchId",nl="userMutationsIndex",vR=["userId","batchId"];function yp(n,e){return[n,Gn(e)]}function Yk(n,e,t){return[n,Gn(e),t]}const eG={},yu="documentMutations",am="remoteDocumentsV14",tG=["prefixPath","collectionGroup","readTime","documentId"],_p="documentKeyIndex",nG=["prefixPath","collectionGroup","documentId"],Zk="collectionGroupIndex",iG=["collectionGroup","readTime","prefixPath","documentId"],zd="remoteDocumentGlobal",ix="remoteDocumentGlobalKey",_u="targets",Qk="queryTargetsIndex",rG=["canonicalId","targetId"],vu="targetDocuments",sG=["targetId","path"],uw="documentTargetsIndex",oG=["path","targetId"],lm="targetGlobalKey",ul="targetGlobal",Bd="collectionParents",aG=["collectionId","parent"],xu="clientMetadata",lG="clientId",oy="bundles",cG="bundleId",ay="namedQueries",uG="name",hw="indexConfiguration",hG="indexId",rx="collectionGroupIndex",dG="collectionGroup",ad="indexState",fG=["indexId","uid"],Jk="sequenceNumberIndex",gG=["uid","sequenceNumber"],ld="indexEntries",pG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],eN="documentKeyIndex",mG=["indexId","uid","orderedDocumentKey"],ly="documentOverlays",yG=["userId","collectionPath","documentId"],sx="collectionPathOverlayIndex",_G=["userId","collectionPath","largestBatchId"],tN="collectionGroupOverlayIndex",vG=["userId","collectionGroup","largestBatchId"],dw="globals",xG="name",nN=[Ud,fr,yu,Wa,_u,xf,ul,vu,xu,zd,Bd,oy,ay],wG=[...nN,ly],iN=[Ud,fr,yu,am,_u,xf,ul,vu,xu,zd,Bd,oy,ay,ly],rN=iN,fw=[...rN,hw,ad,ld],EG=fw,sN=[...fw,dw],TG=sN;class ox extends qk{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function en(n,e){const t=Tt(n);return Qo.O(t.le,e)}function xR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function gw(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function SG(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ci{constructor(e,t){this.comparator=e,this.root=t||En.EMPTY}insert(e,t){return new ci(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new ci(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zg(this.root,e,this.comparator,!0)}}class Zg{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??En.RED,this.left=r??En.EMPTY,this.right=s??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new En(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return En.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Re(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw Re(57766)}get value(){throw Re(16141)}get color(){throw Re(16727)}get left(){throw Re(29726)}get right(){throw Re(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new En(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class mt{constructor(e){this.comparator=e,this.data=new ci(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wR(this.data.getIterator())}getIteratorFrom(e){return new wR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new mt(this.comparator);return t.data=e,t}}class wR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Cc(n){return n.hasNext()?n.getNext():void 0}class js{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new js([])}unionWith(e){let t=new mt(zt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new js(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return mu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class IG extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ui{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new IG("Invalid base64 string: "+s):s}})(e);return new ui(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new ui(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return He(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ui.EMPTY_BYTE_STRING=new ui("");const CG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ia(n){if(De(!!n,39018),typeof n=="string"){let e=0;const t=CG.exec(n);if(De(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ht(n.seconds),nanos:Ht(n.nanos)}}function Ht(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wu(n){return typeof n=="string"?ui.fromBase64String(n):ui.fromUint8Array(n)}const oN="server_timestamp",aN="__type__",lN="__previous_value__",cN="__local_write_time__";function pw(n){return(n?.mapValue?.fields||{})[aN]?.stringValue===oN}function uN(n){const e=n.mapValue.fields[lN];return pw(e)?uN(e):e}function cm(n){const e=ia(n.mapValue.fields[cN].timestampValue);return new Pt(e.seconds,e.nanos)}class RG{constructor(e,t,i,r,s,o,l,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const um="(default)";class Eu{constructor(e,t){this.projectId=e,this.database=t||um}static empty(){return new Eu("","")}get isDefaultDatabase(){return this.database===um}isEqual(e){return e instanceof Eu&&e.projectId===this.projectId&&e.database===this.database}}const hN="__type__",dN="__max__",Ho={mapValue:{fields:{__type__:{stringValue:dN}}}},fN="__vector__",hm="value",vp={nullValue:"NULL_VALUE"};function Tu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?pw(n)?4:gN(n)?9007199254740991:cy(n)?10:11:Re(28295,{value:n})}function ls(n,e){if(n===e)return!0;const t=Tu(n);if(t!==Tu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return cm(n).isEqual(cm(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ia(r.timestampValue),l=ia(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return wu(r.bytesValue).isEqual(wu(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Ht(r.geoPointValue.latitude)===Ht(s.geoPointValue.latitude)&&Ht(r.geoPointValue.longitude)===Ht(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Ht(r.integerValue)===Ht(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Ht(r.doubleValue),l=Ht(s.doubleValue);return o===l?sm(o)===sm(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return mu(n.arrayValue.values||[],e.arrayValue.values||[],ls);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(xR(o)!==xR(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!ls(o[u],l[u])))return!1;return!0})(n,e);default:return Re(52216,{left:n})}}function Gd(n,e){return(n.values||[]).find((t=>ls(t,e)))!==void 0}function ra(n,e){if(n===e)return 0;const t=Tu(n),i=Tu(e);if(t!==i)return He(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return He(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=Ht(s.integerValue||s.doubleValue),u=Ht(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return ER(n.timestampValue,e.timestampValue);case 4:return ER(cm(n),cm(e));case 5:return tx(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=wu(s),u=wu(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=He(l[h],u[h]);if(f!==0)return f}return He(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=He(Ht(s.latitude),Ht(o.latitude));return l!==0?l:He(Ht(s.longitude),Ht(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return TR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[hm]?.arrayValue,f=u[hm]?.arrayValue,p=He(h?.values?.length||0,f?.values?.length||0);return p!==0?p:TR(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Ho.mapValue&&o===Ho.mapValue)return 0;if(s===Ho.mapValue)return 1;if(o===Ho.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const y=tx(u[p],f[p]);if(y!==0)return y;const x=ra(l[u[p]],h[f[p]]);if(x!==0)return x}return He(u.length,f.length)})(n.mapValue,e.mapValue);default:throw Re(23264,{he:t})}}function ER(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return He(n,e);const t=ia(n),i=ia(e),r=He(t.seconds,i.seconds);return r!==0?r:He(t.nanos,i.nanos)}function TR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=ra(t[r],i[r]);if(s)return s}return He(t.length,i.length)}function Su(n){return ax(n)}function ax(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ia(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return wu(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ee.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=ax(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${ax(t.fields[o])}`;return r+"}"})(n.mapValue):Re(61005,{value:n})}function mw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function lx(n){return!!n&&"integerValue"in n}function Wd(n){return!!n&&"arrayValue"in n}function SR(n){return!!n&&"nullValue"in n}function IR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function X_(n){return!!n&&"mapValue"in n}function cy(n){return(n?.mapValue?.fields||{})[hN]?.stringValue===fN}function cd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return gw(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=cd(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cd(n.arrayValue.values[t]);return e}return{...n}}function gN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===dN}const pN={mapValue:{fields:{[hN]:{stringValue:fN},[hm]:{arrayValue:{}}}}};function AG(n){return"nullValue"in n?vp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?mw(Eu.empty(),Ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?cy(n)?pN:{mapValue:{}}:Re(35942,{value:n})}function bG(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?mw(Eu.empty(),Ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?pN:"mapValue"in n?cy(n)?{mapValue:{}}:Ho:Re(61959,{value:n})}function CR(n,e){const t=ra(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function RR(n,e){const t=ra(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class yr{constructor(e){this.value=e}static empty(){return new yr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!X_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cd(t)}setAll(e){let t=zt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=cd(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());X_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ls(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];X_(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){gw(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new yr(cd(this.value))}}class Tn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Qe.min(),Qe.min(),Qe.min(),yr.empty(),0)}static newFoundDocument(e,t,i,r){return new Tn(e,1,t,Qe.min(),i,r,0)}static newNoDocument(e,t){return new Tn(e,2,t,Qe.min(),Qe.min(),yr.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Qe.min(),Qe.min(),yr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Iu{constructor(e,t){this.position=e,this.inclusive=t}}function AR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Ee.comparator(Ee.fromName(o.referenceValue),t.key):i=ra(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function bR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ls(n.position[t],e.position[t]))return!1;return!0}class dm{constructor(e,t="asc"){this.field=e,this.dir=t}}function PG(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class mN{}class Ye extends mN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new kG(e,t,i):t==="array-contains"?new MG(e,i):t==="in"?new EN(e,i):t==="not-in"?new LG(e,i):t==="array-contains-any"?new OG(e,i):new Ye(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new NG(e,i):new DG(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ra(t,this.value)):t!==null&&Tu(this.value)===Tu(t)&&this.matchesComparison(ra(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gt extends mN{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gt(e,t)}matches(e){return Cu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Cu(n){return n.op==="and"}function cx(n){return n.op==="or"}function yw(n){return yN(n)&&Cu(n)}function yN(n){for(const e of n.filters)if(e instanceof gt)return!1;return!0}function ux(n){if(n instanceof Ye)return n.field.canonicalString()+n.op.toString()+Su(n.value);if(yw(n))return n.filters.map((e=>ux(e))).join(",");{const e=n.filters.map((t=>ux(t))).join(",");return`${n.op}(${e})`}}function _N(n,e){return n instanceof Ye?(function(i,r){return r instanceof Ye&&i.op===r.op&&i.field.isEqual(r.field)&&ls(i.value,r.value)})(n,e):n instanceof gt?(function(i,r){return r instanceof gt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&_N(o,r.filters[l])),!0):!1})(n,e):void Re(19439)}function vN(n,e){const t=n.filters.concat(e);return gt.create(t,n.op)}function xN(n){return n instanceof Ye?(function(t){return`${t.field.canonicalString()} ${t.op} ${Su(t.value)}`})(n):n instanceof gt?(function(t){return t.op.toString()+" {"+t.getFilters().map(xN).join(" ,")+"}"})(n):"Filter"}class kG extends Ye{constructor(e,t,i){super(e,t,i),this.key=Ee.fromName(i.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class NG extends Ye{constructor(e,t){super(e,"in",t),this.keys=wN("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class DG extends Ye{constructor(e,t){super(e,"not-in",t),this.keys=wN("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function wN(n,e){return(e.arrayValue?.values||[]).map((t=>Ee.fromName(t.referenceValue)))}class MG extends Ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Wd(t)&&Gd(t.arrayValue,this.value)}}class EN extends Ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Gd(this.value.arrayValue,t)}}class LG extends Ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Gd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Gd(this.value.arrayValue,t)}}class OG extends Ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Wd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Gd(this.value.arrayValue,i)))}}class FG{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function hx(n,e=null,t=[],i=[],r=null,s=null,o=null){return new FG(n,e,t,i,r,s,o)}function Sl(n){const e=Tt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>ux(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),sy(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Su(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Su(i))).join(",")),e.Te=t}return e.Te}function wf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!PG(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_N(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!bR(n.startAt,e.startAt)&&bR(n.endAt,e.endAt)}function VG(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function fm(n,e){return n.filters.filter((t=>t instanceof Ye&&t.field.isEqual(e)))}function PR(n,e,t){let i=vp,r=!0;for(const s of fm(n,e)){let o=vp,l=!0;switch(s.op){case"<":case"<=":o=AG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=vp}CR({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];CR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function kR(n,e,t){let i=Ho,r=!0;for(const s of fm(n,e)){let o=Ho,l=!0;switch(s.op){case">=":case">":o=bG(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Ho}RR({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];RR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class uy{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function jG(n,e,t,i,r,s,o,l){return new uy(n,e,t,i,r,s,o,l)}function TN(n){return new uy(n)}function NR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function UG(n){return n.collectionGroup!==null}function ud(n){const e=Tt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new mt(zt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new dm(s,i))})),t.has(zt.keyField().canonicalString())||e.Ie.push(new dm(zt.keyField(),i))}return e.Ie}function $s(n){const e=Tt(n);return e.Ee||(e.Ee=zG(e,ud(n))),e.Ee}function zG(n,e){if(n.limitType==="F")return hx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new dm(r.field,s)}));const t=n.endAt?new Iu(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Iu(n.startAt.position,n.startAt.inclusive):null;return hx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function dx(n,e,t){return new uy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function SN(n,e){return wf($s(n),$s(e))&&n.limitType===e.limitType}function IN(n){return`${Sl($s(n))}|lt:${n.limitType}`}function Nh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>xN(r))).join(", ")}]`),sy(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Su(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Su(r))).join(",")),`Target(${i})`})($s(n))}; limitType=${n.limitType})`}function hy(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ee.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of ud(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,u){const h=AR(o,l,u);return o.inclusive?h<=0:h<0})(i.startAt,ud(i),r)||i.endAt&&!(function(o,l,u){const h=AR(o,l,u);return o.inclusive?h>=0:h>0})(i.endAt,ud(i),r))})(n,e)}function BG(n){return(e,t)=>{let i=!1;for(const r of ud(n)){const s=GG(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function GG(n,e,t){const i=n.field.isKeyField()?Ee.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?ra(u,h):Re(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Re(19790,{direction:n.dir})}}class la{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){gw(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return SG(this.inner)}size(){return this.innerSize}}const WG=new ci(Ee.comparator);function il(){return WG}const CN=new ci(Ee.comparator);function Qg(...n){let e=CN;for(const t of n)e=e.insert(t.key,t);return e}function $G(n){let e=CN;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function ts(){return hd()}function RN(){return hd()}function hd(){return new la((n=>n.toString()),((n,e)=>n.isEqual(e)))}const HG=new ci(Ee.comparator),KG=new mt(Ee.comparator);function Sn(...n){let e=KG;for(const t of n)e=e.add(t);return e}const qG=new mt(He);function XG(){return qG}function YG(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sm(e)?"-0":e}}function ZG(n){return{integerValue:""+n}}class dy{constructor(){this._=void 0}}function QG(n,e,t){return n instanceof $d?(function(r,s){const o={fields:{[aN]:{stringValue:oN},[cN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&pw(s)&&(s=uN(s)),s&&(o.fields[lN]=s),{mapValue:o}})(t,e):n instanceof Ru?AN(n,e):n instanceof Au?bN(n,e):(function(r,s){const o=e7(r,s),l=DR(o)+DR(r.Ae);return lx(o)&&lx(r.Ae)?ZG(l):YG(r.serializer,l)})(n,e)}function JG(n,e,t){return n instanceof Ru?AN(n,e):n instanceof Au?bN(n,e):t}function e7(n,e){return n instanceof Hd?(function(i){return lx(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class $d extends dy{}class Ru extends dy{constructor(e){super(),this.elements=e}}function AN(n,e){const t=PN(e);for(const i of n.elements)t.some((r=>ls(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Au extends dy{constructor(e){super(),this.elements=e}}function bN(n,e){let t=PN(e);for(const i of n.elements)t=t.filter((r=>!ls(r,i)));return{arrayValue:{values:t}}}class Hd extends dy{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function DR(n){return Ht(n.integerValue||n.doubleValue)}function PN(n){return Wd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class t7{constructor(e,t){this.field=e,this.transform=t}}function n7(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Ru&&r instanceof Ru||i instanceof Au&&r instanceof Au?mu(i.elements,r.elements,ls):i instanceof Hd&&r instanceof Hd?ls(i.Ae,r.Ae):i instanceof $d&&r instanceof $d})(n.transform,e.transform)}class i7{constructor(e,t){this.version=e,this.transformResults=t}}class xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xr}static exists(e){return new xr(void 0,e)}static updateTime(e){return new xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class fy{}function kN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new _w(n.key,xr.none()):new Ef(n.key,n.data,xr.none());{const t=n.data,i=yr.empty();let r=new mt(zt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Ou(n.key,i,new js(r.toArray()),xr.none())}}function r7(n,e,t){n instanceof Ef?(function(r,s,o){const l=r.value.clone(),u=LR(r.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Ou?(function(r,s,o){if(!xp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=LR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(NN(r)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function dd(n,e,t,i){return n instanceof Ef?(function(s,o,l,u){if(!xp(s.precondition,o))return l;const h=s.value.clone(),f=OR(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Ou?(function(s,o,l,u){if(!xp(s.precondition,o))return l;const h=OR(s.fieldTransforms,u,o),f=o.data;return f.setAll(NN(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((p=>p.field)))})(n,e,t,i):(function(s,o,l){return xp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function MR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&mu(i,r,((s,o)=>n7(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ef extends fy{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ou extends fy{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function NN(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function LR(n,e,t){const i=new Map;De(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,JG(o,l,t[r]))}return i}function OR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,QG(s,o,e))}return i}class _w extends fy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class DN extends fy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class vw{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&r7(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=dd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=dd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=RN();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const u=kN(o,l);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Qe.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Sn())}isEqual(e){return this.batchId===e.batchId&&mu(this.mutations,e.mutations,((t,i)=>MR(t,i)))&&mu(this.baseMutations,e.baseMutations,((t,i)=>MR(t,i)))}}class xw{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){De(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return HG})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new xw(e,t,i,r)}}class ww{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var $t,Ze;function s7(n){switch(n){case le.OK:return Re(64938);case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0;default:return Re(15467,{code:n})}}function o7(n){if(n===void 0)return Ti("GRPC error has no .code"),le.UNKNOWN;switch(n){case $t.OK:return le.OK;case $t.CANCELLED:return le.CANCELLED;case $t.UNKNOWN:return le.UNKNOWN;case $t.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case $t.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case $t.INTERNAL:return le.INTERNAL;case $t.UNAVAILABLE:return le.UNAVAILABLE;case $t.UNAUTHENTICATED:return le.UNAUTHENTICATED;case $t.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case $t.NOT_FOUND:return le.NOT_FOUND;case $t.ALREADY_EXISTS:return le.ALREADY_EXISTS;case $t.PERMISSION_DENIED:return le.PERMISSION_DENIED;case $t.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case $t.ABORTED:return le.ABORTED;case $t.OUT_OF_RANGE:return le.OUT_OF_RANGE;case $t.UNIMPLEMENTED:return le.UNIMPLEMENTED;case $t.DATA_LOSS:return le.DATA_LOSS;default:return Re(39323,{code:n})}}(Ze=$t||($t={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";new ow([4294967295,4294967295],0);const a7={asc:"ASCENDING",desc:"DESCENDING"},l7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},c7={and:"AND",or:"OR"};class u7{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function h7(n,e){return n.useProto3Json||sy(e)?e:{value:e}}function fx(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function d7(n,e){return fx(n,e.toTimestamp())}function Sr(n){return De(!!n,49232),Qe.fromTimestamp((function(t){const i=ia(t);return new Pt(i.seconds,i.nanos)})(n))}function MN(n,e){return gx(n,e).canonicalString()}function gx(n,e){const t=(function(r){return new Ct(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function LN(n){const e=Ct.fromString(n);return De(E7(e),10190,{key:e.toString()}),e}function gm(n,e){return MN(n.databaseId,e.path)}function wp(n,e){const t=LN(e);if(t.get(1)!==n.databaseId.projectId)throw new Se(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Se(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee(VN(t))}function ON(n,e){return MN(n.databaseId,e)}function FN(n){const e=LN(n);return e.length===4?Ct.emptyPath():VN(e)}function f7(n){return new Ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function VN(n){return De(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function FR(n,e,t){return{name:gm(n,e),fields:t.value.mapValue.fields}}function g7(n,e,t){const i=wp(n,e.name),r=Sr(e.updateTime),s=e.createTime?Sr(e.createTime):Qe.min(),o=new yr({mapValue:{fields:e.fields}}),l=Tn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function pm(n,e){let t;if(e instanceof Ef)t={update:FR(n,e.key,e.value)};else if(e instanceof _w)t={delete:gm(n,e.key)};else if(e instanceof Ou)t={update:FR(n,e.key,e.data),updateMask:w7(e.fieldMask)};else{if(!(e instanceof DN))return Re(16599,{Vt:e.type});t={verify:gm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof $d)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ru)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Au)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Hd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Re(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:d7(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Re(27497)})(n,e.precondition)),t}function px(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?xr.updateTime(Sr(s.updateTime)):s.exists!==void 0?xr.exists(s.exists):xr.none()})(e.currentDocument):xr.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let u=null;if("setToServerValue"in l)De(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new $d;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new Ru(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Au(f)}else"increment"in l?u=new Hd(o,l.increment):Re(16584,{proto:l});const h=zt.fromServerFormat(l.fieldPath);return new t7(h,u)})(n,r))):[];if(e.update){e.update.name;const r=wp(n,e.update.name),s=new yr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new js(h.map((f=>zt.fromServerFormat(f))))})(e.updateMask);return new Ou(r,s,o,t,i)}return new Ef(r,s,t,i)}if(e.delete){const r=wp(n,e.delete);return new _w(r,t)}if(e.verify){const r=wp(n,e.verify);return new DN(r,t)}return Re(1463,{proto:e})}function p7(n,e){return n&&n.length>0?(De(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Sr(r.updateTime):Sr(s);return o.isEqual(Qe.min())&&(o=Sr(s)),new i7(o,r.transformResults||[])})(t,e)))):[]}function m7(n,e){return{documents:[ON(n,e.path)]}}function y7(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=ON(n,r);const s=(function(h){if(h.length!==0)return zN(gt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(y){return{field:Oc(y.field),direction:_7(y.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=h7(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function jN(n){let e=FN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){De(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(p){const y=UN(p);return y instanceof gt&&yw(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((y=>(function(I){return new dm(Fc(I.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(I.direction))})(y)))})(t.orderBy));let l=null;t.limit&&(l=(function(p){let y;return y=typeof p=="object"?p.value:p,sy(y)?null:y})(t.limit));let u=null;t.startAt&&(u=(function(p){const y=!!p.before,x=p.values||[];return new Iu(x,y)})(t.startAt));let h=null;return t.endAt&&(h=(function(p){const y=!p.before,x=p.values||[];return new Iu(x,y)})(t.endAt)),jG(e,r,o,s,l,"F",u,h)}function UN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Fc(t.unaryFilter.field);return Ye.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Fc(t.unaryFilter.field);return Ye.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Fc(t.unaryFilter.field);return Ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fc(t.unaryFilter.field);return Ye.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Re(61313);default:return Re(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ye.create(Fc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Re(58110);default:return Re(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return gt.create(t.compositeFilter.filters.map((i=>UN(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Re(1026)}})(t.compositeFilter.op))})(n):Re(30097,{filter:n})}function _7(n){return a7[n]}function v7(n){return l7[n]}function x7(n){return c7[n]}function Oc(n){return{fieldPath:n.canonicalString()}}function Fc(n){return zt.fromServerFormat(n.fieldPath)}function zN(n){return n instanceof Ye?(function(t){if(t.op==="=="){if(IR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NAN"}};if(SR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(IR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NOT_NAN"}};if(SR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oc(t.field),op:v7(t.op),value:t.value}}})(n):n instanceof gt?(function(t){const i=t.getFilters().map((r=>zN(r)));return i.length===1?i[0]:{compositeFilter:{op:x7(t.op),filters:i}}})(n):Re(54877,{filter:n})}function w7(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function E7(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Hc{constructor(e,t,i,r,s=Qe.min(),o=Qe.min(),l=ui.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Hc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Hc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Hc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Hc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class BN{constructor(e){this.yt=e}}function T7(n,e){let t;if(e.document)t=g7(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Ee.fromSegments(e.noDocument.path),r=Cl(e.noDocument.readTime);t=Tn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Re(56709);{const i=Ee.fromSegments(e.unknownDocument.path),r=Cl(e.unknownDocument.version);t=Tn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new Pt(r[0],r[1]);return Qe.fromTimestamp(s)})(e.readTime)),t}function VR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:mm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:gm(s,o.key),fields:o.data.value.mapValue.fields,updateTime:fx(s,o.version.toTimestamp()),createTime:fx(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Il(e.version)};else{if(!e.isUnknownDocument())return Re(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Il(e.version)}}return i}function mm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Il(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Cl(n){const e=new Pt(n.seconds,n.nanoseconds);return Qe.fromTimestamp(e)}function Ka(n,e){const t=(e.baseMutations||[]).map((s=>px(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>px(n.yt,s))),r=Pt.fromMillis(e.localWriteTimeMs);return new vw(e.batchId,r,t,i)}function Yh(n){const e=Cl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Cl(n.lastLimboFreeSnapshotVersion):Qe.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return De(o===1,1966,{count:o}),$s(TN(FN(s.documents[0])))})(n.query):(function(s){return $s(jN(s))})(n.query),new Hc(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ui.fromBase64String(n.resumeToken))}function GN(n,e){const t=Il(e.snapshotVersion),i=Il(e.lastLimboFreeSnapshotVersion);let r;r=VG(e.target)?m7(n.yt,e.target):y7(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Sl(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function WN(n){const e=jN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?dx(e,e.limit,"L"):e}function Y_(n,e){return new ww(e.largestBatchId,px(n.yt,e.overlayMutation))}function jR(n,e){const t=e.path.lastSegment();return[n,Gn(e.path.popLast()),t]}function UR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Il(i.readTime),documentKey:Gn(i.documentKey.path),largestBatchId:i.largestBatchId}}class S7{getBundleMetadata(e,t){return zR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Cl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return zR(e).put((function(r){return{bundleId:r.id,createTime:Il(Sr(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return BR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:WN(s.bundledQuery),readTime:Cl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return BR(e).put((function(r){return{name:r.name,readTime:Il(Sr(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function zR(n){return en(n,oy)}function BR(n){return en(n,ay)}class gy{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new gy(e,i)}getOverlay(e,t){return Dh(e).get(jR(this.userId,t)).next((i=>i?Y_(this.serializer,i):null))}getOverlays(e,t){const i=ts();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new ww(t,o);r.push(this.St(e,l))})),Z.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Gn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Dh(e).Z(sx,l))})),Z.waitFor(s)}getOverlaysForCollection(e,t,i){const r=ts(),s=Gn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Dh(e).J(sx,o).next((l=>{for(const u of l){const h=Y_(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=ts();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Dh(e).ee({index:tN,range:l},((u,h,f)=>{const p=Y_(this.serializer,h);s.size()<r||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Dh(e).put((function(r,s,o){const[l,u,h]=jR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:pm(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Dh(n){return en(n,ly)}class I7{bt(e){return en(e,dw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?ui.fromUint8Array(i):ui.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class qa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ht(e.integerValue));else if("doubleValue"in e){const i=Ht(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),sm(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ia(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(wu(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?gN(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):cy(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Re(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=hm,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ht(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ee.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}qa.Kt=new qa;const Rc=255;function C7(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function GR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=C7(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class R7{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=GR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=GR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Rc),this.sn(255)}_n(){this.an(Rc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Rc?(this.sn(Rc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Rc?(this.an(Rc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class A7{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class b7{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Mh{constructor(){this.cn=new R7,this.ln=new A7(this.cn),this.hn=new b7(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Xa{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Xa(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Ep(this.En),directionalValue:Ep(this.dn),orderedDocumentKey:Ep(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function No(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=WR(n.En,e.En),t!==0?t:(t=WR(n.dn,e.dn),t!==0?t:Ee.comparator(n.In,e.In)))}function WR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Ep(n){return JP()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function $R(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class HR{constructor(e){this.mn=new mt(((t,i)=>zt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(De(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=nx(e);if(t!==void 0&&!this.wn(t))return!1;const i=Ga(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=i[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new mt(zt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new mp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new mp(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new mp(i.field,i.dir==="asc"?0:1)));return new rm(rm.UNKNOWN_ID,this.collectionId,t,jd.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function $N(n){if(De(n instanceof Ye||n instanceof gt,20012),n instanceof Ye){if(n instanceof EN){const t=n.value.arrayValue?.values?.map((i=>Ye.create(n.field,"==",i)))||[];return gt.create(t,"or")}return n}const e=n.filters.map((t=>$N(t)));return gt.create(e,n.op)}function P7(n){if(n.getFilters().length===0)return[];const e=_x($N(n));return De(HN(e),7391),mx(e)||yx(e)?[e]:e.getFilters()}function mx(n){return n instanceof Ye}function yx(n){return n instanceof gt&&yw(n)}function HN(n){return mx(n)||yx(n)||(function(t){if(t instanceof gt&&cx(t)){for(const i of t.getFilters())if(!mx(i)&&!yx(i))return!1;return!0}return!1})(n)}function _x(n){if(De(n instanceof Ye||n instanceof gt,34018),n instanceof Ye)return n;if(n.filters.length===1)return _x(n.filters[0]);const e=n.filters.map((i=>_x(i)));let t=gt.create(e,n.op);return t=ym(t),HN(t)?t:(De(t instanceof gt,64498),De(Cu(t),40251),De(t.filters.length>1,57927),t.filters.reduce(((i,r)=>Ew(i,r))))}function Ew(n,e){let t;return De(n instanceof Ye||n instanceof gt,38388),De(e instanceof Ye||e instanceof gt,25473),t=n instanceof Ye?e instanceof Ye?(function(r,s){return gt.create([r,s],"and")})(n,e):KR(n,e):e instanceof Ye?KR(e,n):(function(r,s){if(De(r.filters.length>0&&s.filters.length>0,48005),Cu(r)&&Cu(s))return vN(r,s.getFilters());const o=cx(r)?r:s,l=cx(r)?s:r,u=o.filters.map((h=>Ew(h,l)));return gt.create(u,"or")})(n,e),ym(t)}function KR(n,e){if(Cu(e))return vN(e,n.getFilters());{const t=e.filters.map((i=>Ew(n,i)));return gt.create(t,"or")}}function ym(n){if(De(n instanceof Ye||n instanceof gt,11850),n instanceof Ye)return n;const e=n.getFilters();if(e.length===1)return ym(e[0]);if(yN(n))return n;const t=e.map((r=>ym(r))),i=[];return t.forEach((r=>{r instanceof Ye?i.push(r):r instanceof gt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:gt.create(i,n.op)}class k7{constructor(){this.Cn=new Tw}addToCollectionParentIndex(e,t){return this.Cn.add(t),Z.resolve()}getCollectionParents(e,t){return Z.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Z.resolve()}deleteFieldIndex(e,t){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,t){return Z.resolve()}getDocumentsMatchingTarget(e,t){return Z.resolve(null)}getIndexType(e,t){return Z.resolve(0)}getFieldIndexes(e,t){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,t){return Z.resolve(Ai.min())}getMinOffsetFromCollectionGroup(e,t){return Z.resolve(Ai.min())}updateCollectionGroup(e,t,i){return Z.resolve()}updateIndexEntries(e,t){return Z.resolve()}}class Tw{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new mt(Ct.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new mt(Ct.comparator)).toArray()}}const qR="IndexedDbIndexManager",Jg=new Uint8Array(0);class N7{constructor(e,t){this.databaseId=t,this.vn=new Tw,this.Fn=new la((i=>Sl(i)),((i,r)=>wf(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Gn(r)};return XR(e).put(s)}return Z.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[Wk(t),""],!1,!0);return XR(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(es(o.parent))}return i}))}addFieldIndex(e,t){const i=Lh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=bc(e);return s.next((l=>{o.put(UR(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Lh(e),r=bc(e),s=Ac(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Lh(e),i=Ac(e),r=bc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Z.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new HR(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Ac(e);let r=!0;const s=new Map;return Z.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=Sn();const l=[];return Z.forEach(s,((u,h)=>{pe(qR,`Using index ${(function(N){return`id=${N.indexId}|cg=${N.collectionGroup}|f=${N.fields.map((L=>`${L.fieldPath}:${L.kind}`)).join(",")}`})(u)} to execute ${Sl(t)}`);const f=(function(N,L){const F=nx(L);if(F===void 0)return null;for(const G of fm(N,F.fieldPath))switch(G.op){case"array-contains-any":return G.value.arrayValue.values||[];case"array-contains":return[G.value]}return null})(h,u),p=(function(N,L){const F=new Map;for(const G of Ga(L))for(const k of fm(N,G.fieldPath))switch(k.op){case"==":case"in":F.set(G.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return F.set(G.fieldPath.canonicalString(),k.value),Array.from(F.values())}return null})(h,u),y=(function(N,L){const F=[];let G=!0;for(const k of Ga(L)){const R=k.kind===0?PR(N,k.fieldPath,N.startAt):kR(N,k.fieldPath,N.startAt);F.push(R.value),G&&(G=R.inclusive)}return new Iu(F,G)})(h,u),x=(function(N,L){const F=[];let G=!0;for(const k of Ga(L)){const R=k.kind===0?kR(N,k.fieldPath,N.endAt):PR(N,k.fieldPath,N.endAt);F.push(R.value),G&&(G=R.inclusive)}return new Iu(F,G)})(h,u),I=this.On(u,h,y),T=this.On(u,h,x),S=this.Nn(u,h,p),b=this.Bn(u.indexId,f,I,y.inclusive,T,x.inclusive,S);return Z.forEach(b,(D=>i.Y(D,t.limit).next((N=>{N.forEach((L=>{const F=Ee.fromSegments(L.documentKey);o.has(F)||(o=o.add(F),l.push(F))}))}))))})).next((()=>l))}return Z.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=P7(gt.create(e.filters,"and")).map((i=>hx(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let p=0;p<u;++p){const y=t?this.Ln(t[p/h]):Jg,x=this.kn(e,y,i[p%h],r),I=this.qn(e,y,s[p%h],o),T=l.map((S=>this.kn(e,y,S,!0)));f.push(...this.createRange(x,I,T))}return f}kn(e,t,i,r){const s=new Xa(e,Ee.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Xa(e,Ee.empty(),t,i);return r?s.An():s}xn(e,t){const i=new HR(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Z.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new mt(zt.comparator),f=!1;for(const p of u.filters)for(const y of p.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?f=!0:h=h.add(y.field));for(const p of u.orderBy)p.field.isKeyField()||(h=h.add(p.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Mh;for(const r of Ga(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);qa.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Mh;return qa.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Mh;return qa.Kt.Dt(mw(this.databaseId,t),i.Pn((function(s){const o=Ga(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Mh);let s=0;for(const o of Ga(e)){const l=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&Wd(l))r=this.Kn(r,o,l);else{const h=u.Pn(o.kind);qa.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const u=new Mh;u.seed(l.un()),qa.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof Ye&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Lh(e),r=bc(e);return(t?i.J(rx,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Z.forEach(s,(l=>r.get([l.indexId,this.uid]).next((u=>{o.push((function(f,p){const y=p?new jd(p.sequenceNumber,new Ai(Cl(p.readTime),new Ee(es(p.documentKey)),p.largestBatchId)):jd.empty(),x=f.fields.map((([I,T])=>new mp(zt.fromServerFormat(I),T)));return new rm(f.indexId,f.collectionGroup,x,y)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:He(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Lh(e),s=bc(e);return this.Gn(e).next((o=>r.J(rx,IDBKeyRange.bound(t,t)).next((l=>Z.forEach(l,(u=>s.put(UR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Z.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Z.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),Z.forEach(l,(u=>this.zn(e,r,u).next((h=>{const f=this.jn(s,u);return h.isEqual(f)?Z.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,i,r){return Ac(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Ac(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Ac(e);let s=new mt(No);return r.ee({index:eN,range:IDBKeyRange.only([i.indexId,this.uid,Ep(this.$n(i,t))])},((o,l)=>{s=s.add(new Xa(i.indexId,t,$R(l.arrayValue),$R(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new mt(No);const r=this.Qn(t,e);if(r==null)return i;const s=nx(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Wd(o))for(const l of o.arrayValue.values||[])i=i.add(new Xa(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new Xa(t.indexId,e.key,Jg,r));return i}Jn(e,t,i,r,s){pe(qR,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,f,p,y){const x=u.getIterator(),I=h.getIterator();let T=Cc(x),S=Cc(I);for(;T||S;){let b=!1,D=!1;if(T&&S){const N=f(T,S);N<0?D=!0:N>0&&(b=!0)}else T!=null?D=!0:b=!0;b?(p(S),S=Cc(I)):D?(y(T),T=Cc(x)):(T=Cc(x),S=Cc(I))}})(r,s,No,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),Z.waitFor(o)}Gn(e){let t=1;return bc(e).ee({index:Jk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>No(o,l))).filter(((o,l,u)=>!l||No(o,u[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=No(o,e),u=No(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,Jg,Ee.empty()),u=r[o+1].Vn(this.uid,Jg,Ee.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return No(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(YR)}getMinOffset(e,t){return Z.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Re(44426))))).next(YR)}}function XR(n){return en(n,Bd)}function Ac(n){return en(n,ld)}function Lh(n){return en(n,hw)}function bc(n){return en(n,ad)}function YR(n){De(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;lw(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ai(e.readTime,e.documentKey,t)}const ZR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},KN=41943040;class Jn{static withCacheSize(e){return new Jn(e,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function qN(n,e,t){const i=n.store(fr),r=n.store(yu),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.ee({range:o},((f,p,y)=>(l++,y.delete())));s.push(u.next((()=>{De(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const p=Yk(e,f.key.path,t.batchId);s.push(r.delete(p)),h.push(f.key)}return Z.waitFor(s).next((()=>h))}function _m(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Re(14731);e=n.noDocument}return JSON.stringify(e).length}Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn(KN,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);class py{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){De(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new py(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).ee({index:nl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Vc(e),o=Do(e);return o.add({}).next((l=>{De(typeof l=="number",49019);const u=new vw(l,t,i,r),h=(function(x,I,T){const S=T.baseMutations.map((D=>pm(x.yt,D))),b=T.mutations.map((D=>pm(x.yt,D)));return{userId:I,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:S,mutations:b}})(this.serializer,this.userId,u),f=[];let p=new mt(((y,x)=>He(y.canonicalString(),x.canonicalString())));for(const y of r){const x=Yk(this.userId,y.key.path,l);p=p.add(y.key.path.popLast()),f.push(o.put(h)),f.push(s.put(x,eG))}return p.forEach((y=>{f.push(this.indexManager.addToCollectionParentIndex(e,y))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),Z.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return Do(e).get(t).next((i=>i?(De(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Ka(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Z.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Do(e).ee({index:nl,range:r},((o,l,u)=>{l.userId===this.userId&&(De(l.batchId>=i,47524,{tr:i}),s=Ka(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=cl;return Do(e).ee({index:nl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,cl],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).J(nl,t).next((i=>i.map((r=>Ka(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=yp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Vc(e).ee({range:r},((o,l,u)=>{const[h,f,p]=o,y=es(f);if(h===this.userId&&t.path.isEqual(y))return Do(e).get(p).next((x=>{if(!x)throw Re(61480,{nr:o,batchId:p});De(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:p}),s.push(Ka(this.serializer,x))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt(He);const r=[];return t.forEach((s=>{const o=yp(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=Vc(e).ee({range:l},((h,f,p)=>{const[y,x,I]=h,T=es(x);y===this.userId&&s.path.isEqual(T)?i=i.add(I):p.done()}));r.push(u)})),Z.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=yp(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new mt(He);return Vc(e).ee({range:o},((u,h,f)=>{const[p,y,x]=u,I=es(y);p===this.userId&&i.isPrefixOf(I)?I.length===r&&(l=l.add(x)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(Do(e).get(s).next((o=>{if(o===null)throw Re(35274,{batchId:s});De(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Ka(this.serializer,o))})))})),Z.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return qN(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Z.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Z.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Vc(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const u=es(s[1]);r.push(u)}else l.done()})).next((()=>{De(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return XN(e,this.userId,t)}_r(e){return YN(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:cl,lastStreamToken:""}))}}function XN(n,e,t){const i=yp(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Vc(n).ee({range:s,X:!0},((l,u,h)=>{const[f,p,y]=l;f===e&&p===r&&(o=!0),h.done()})).next((()=>o))}function Do(n){return en(n,fr)}function Vc(n){return en(n,yu)}function YN(n){return en(n,Ud)}class Rl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Rl(0)}static cr(){return new Rl(-1)}}class D7{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Rl(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Qe.fromTimestamp(new Pt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Pc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(De(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return Pc(e).ee(((o,l)=>{const u=Yh(l);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>Z.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Pc(e).ee(((i,r)=>{const s=Yh(r);t(s)}))}lr(e){return QR(e).get(lm).next((t=>(De(t!==null,2888),t)))}hr(e,t){return QR(e).put(lm,t)}Pr(e,t){return Pc(e).put(GN(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Sl(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Pc(e).ee({range:r,index:Qk},((o,l,u)=>{const h=Yh(l);wf(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Bo(e);return t.forEach((o=>{const l=Gn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),Z.waitFor(r)}removeMatchingKeys(e,t,i){const r=Bo(e);return Z.forEach(t,(s=>{const o=Gn(s.path);return Z.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Bo(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Bo(e);let s=Sn();return r.ee({range:i,X:!0},((o,l,u)=>{const h=es(o[1]),f=new Ee(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Gn(t.path),r=IDBKeyRange.bound([i],[Wk(i)],!1,!0);let s=0;return Bo(e).ee({index:uw,X:!0,range:r},(([o,l],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return Pc(e).get(t).next((i=>i?Yh(i):null))}}function Pc(n){return en(n,_u)}function QR(n){return en(n,ul)}function Bo(n){return en(n,vu)}const JR="LruGarbageCollector",M7=1048576;function eA([n,e],[t,i]){const r=He(n,t);return r===0?He(e,i):r}class L7{constructor(e){this.Ir=e,this.buffer=new mt(eA),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();eA(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class O7{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){pe(JR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ll(t)?pe(JR,"Ignoring IndexedDB error during garbage collection: ",t):await iy(t)}await this.Vr(3e5)}))}}class F7{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Z.resolve(vr.ce);const i=new L7(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(ZR)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ZR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),r=this.params.maximumSequenceNumbersToCollect):r=p,o=Date.now(),this.nthSequenceNumber(e,r)))).next((p=>(i=p,l=Date.now(),this.removeTargets(e,i,t)))).next((p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((p=>(h=Date.now(),Lc()<=Ke.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:p}))))}}function V7(n,e){return new F7(n,e)}class j7{constructor(e,t){this.db=e,this.garbageCollector=V7(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return ep(e,i)}removeReference(e,t,i){return ep(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return ep(e,t)}br(e,t){return(function(r,s){let o=!1;return YN(r).te((l=>XN(r,l,s).next((u=>(u&&(o=!0),Z.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Qe.min()),Bo(e).delete((function(p){return[0,Gn(p.path)]})(o)))))}));r.push(u)}})).next((()=>Z.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return ep(e,t)}Sr(e,t){const i=Bo(e);let r,s=vr.ce;return i.ee({index:uw},(([o,l],{path:u,sequenceNumber:h})=>{o===0?(s!==vr.ce&&t(new Ee(es(r)),s),s=h,r=u):s=vr.ce})).next((()=>{s!==vr.ce&&t(new Ee(es(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ep(n,e){return Bo(n).put((function(i,r){return{targetId:0,path:Gn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class ZN{constructor(){this.changes=new la((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Z.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class U7{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Fa(e).put(i)}removeEntry(e,t,i){return Fa(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],mm(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Tn.newInvalidDocument(t);return Fa(e).ee({index:_p,range:IDBKeyRange.only(Oh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Tn.newInvalidDocument(t)};return Fa(e).ee({index:_p,range:IDBKeyRange.only(Oh(t))},((r,s)=>{i={document:this.Cr(t,s),size:_m(s)}})).next((()=>i))}getEntries(e,t){let i=il();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=il(),r=new ci(Ee.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,_m(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Z.resolve();let r=new mt(iA);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Oh(r.first()),Oh(r.last())),o=r.getIterator();let l=o.getNext();return Fa(e).ee({index:_p,range:s},((u,h,f)=>{const p=Ee.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&iA(l,p)<0;)i(l,null),l=o.getNext();l&&l.isEqual(p)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Oh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),mm(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fa(e).J(IDBKeyRange.bound(l,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=il();for(const p of h){const y=this.Cr(Ee.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);y.isFoundDocument()&&(hy(t,y)||r.has(y.key))&&(f=f.insert(y.key,y))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=il();const o=nA(t,i),l=nA(t,Ai.max());return Fa(e).ee({index:Zk,range:IDBKeyRange.bound(o,l,!0)},((u,h,f)=>{const p=this.Cr(Ee.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(p.key,p),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new z7(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return tA(e).get(ix).next((t=>(De(!!t,20021),t)))}Dr(e,t){return tA(e).put(ix,t)}Cr(e,t){if(t){const i=T7(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Qe.min())))return i}return Tn.newInvalidDocument(e)}}function QN(n){return new U7(n)}class z7 extends ZN{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new la((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new mt(((s,o)=>He(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=VR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=_m(u);i+=h-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=l.size,this.trackRemovals){const u=VR(this.Nr.serializer,o.convertToNoDocument(Qe.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Z.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function tA(n){return en(n,zd)}function Fa(n){return en(n,am)}function Oh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function nA(n,e){const t=e.documentKey.path.toArray();return[n,mm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function iA(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=He(t[s],i[s]),r)return r;return r=He(t.length,i.length),r||(r=He(t[t.length-2],i[i.length-2]),r||He(t[t.length-1],i[i.length-1]))}class B7{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class JN{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&dd(i.mutation,r,js.empty(),Pt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Sn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Sn()){const r=ts();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=Qg();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=ts();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Sn())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=il();const o=hd(),l=(function(){return hd()})();return t.forEach(((u,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Ou)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),dd(f.mutation,h,f.mutation.getFieldMask(),Pt.now())):o.set(h.key,js.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new B7(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=hd();let r=new ci(((o,l)=>o-l)),s=Sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=i.get(u)||js.empty();f=l.applyToLocalView(h,f),i.set(u,f);const p=(r.get(l.batchId)||Sn()).add(u);r=r.insert(l.batchId,p)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,p=RN();f.forEach((y=>{if(!s.has(y)){const x=kN(t.get(y),i.get(y));x!==null&&p.set(y,x),s=s.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return Z.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):UG(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Z.resolve(ts());let l=Vd,u=s;return o.next((h=>Z.forEach(h,((f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(f)?Z.resolve():this.remoteDocumentCache.getEntry(e,f).next((y=>{u=u.insert(f,y)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Sn()))).next((f=>({batchId:l,changes:$G(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next((i=>{let r=Qg();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Qg();return this.indexManager.getCollectionParents(e,s).next((l=>Z.forEach(l,(u=>{const h=(function(p,y){return new uy(y,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((p,y)=>{o=o.insert(p,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Tn.newInvalidDocument(f)))}));let l=Qg();return o.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&dd(f.mutation,h,js.empty(),Pt.now()),hy(t,h)&&(l=l.insert(u,h))})),l}))}}class G7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Z.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Sr(r.createTime)}})(t)),Z.resolve()}getNamedQuery(e,t){return Z.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:WN(r.bundledQuery),readTime:Sr(r.readTime)}})(t)),Z.resolve()}}class W7{constructor(){this.overlays=new ci(Ee.comparator),this.qr=new Map}getOverlay(e,t){return Z.resolve(this.overlays.get(t))}getOverlays(e,t){const i=ts();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Z.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Z.resolve()}getOverlaysForCollection(e,t,i){const r=ts(),s=t.length+1,o=new Ee(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return Z.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new ci(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=ts(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=ts(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return Z.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new ww(t,i));let s=this.qr.get(t);s===void 0&&(s=Sn(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class $7{constructor(){this.sessionToken=ui.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Z.resolve()}}class Sw{constructor(){this.Qr=new mt(cn.$r),this.Ur=new mt(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new cn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new cn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ee(new Ct([])),i=new cn(t,e),r=new cn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ee(new Ct([])),i=new cn(t,e),r=new cn(t,e+1);let s=Sn();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new cn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class cn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ee.comparator(e.key,t.key)||He(e.Yr,t.Yr)}static Kr(e,t){return He(e.Yr,t.Yr)||Ee.comparator(e.key,t.key)}}class H7{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new mt(cn.$r)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new vw(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new cn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Z.resolve(o)}lookupMutationBatch(e,t){return Z.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?cl:this.tr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new cn(t,0),r=new cn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),Z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt(He);return t.forEach((r=>{const s=new cn(r,0),o=new cn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),Z.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Ee.isDocumentKey(s)||(s=s.child(""));const o=new cn(new Ee(s),0);let l=new mt(He);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(u.Yr)),!0)}),o),Z.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){De(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Z.forEach(t.mutations,(r=>{const s=new cn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new cn(t,0),r=this.Zr.firstAfterOrEqual(i);return Z.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class K7{constructor(e){this.ri=e,this.docs=(function(){return new ci(Ee.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Z.resolve(i?i.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let i=il();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Tn.newInvalidDocument(r))})),Z.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=il();const o=t.path,l=new Ee(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||lw(Hk(f),i)<=0||(r.has(f.key)||hy(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Z.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Re(9500)}ii(e,t){return Z.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new q7(this)}getSize(e){return Z.resolve(this.size)}}class q7 extends ZN{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Z.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class X7{constructor(e){this.persistence=e,this.si=new la((t=>Sl(t)),wf),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.oi=0,this._i=new Sw,this.targetCount=0,this.ai=Rl.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Z.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Rl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Z.resolve()}updateTargetData(e,t){return this.Pr(t),Z.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),Z.waitFor(s).next((()=>r))}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Z.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Z.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Z.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Z.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Z.resolve(i)}containsKey(e,t){return Z.resolve(this._i.containsKey(t))}}class eD{constructor(e,t){this.ui={},this.overlays={},this.ci=new vr(0),this.li=!1,this.li=!0,this.hi=new $7,this.referenceDelegate=e(this),this.Pi=new X7(this),this.indexManager=new k7,this.remoteDocumentCache=(function(r){return new K7(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new BN(t),this.Ii=new G7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new W7,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new H7(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){pe("MemoryPersistence","Starting transaction:",e);const r=new Y7(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Z.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class Y7 extends qk{constructor(e){super(),this.currentSequenceNumber=e}}class my{constructor(e){this.persistence=e,this.Ri=new Sw,this.Vi=null}static mi(e){return new my(e)}get fi(){if(this.Vi)return this.Vi;throw Re(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Z.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Z.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Z.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.fi,(i=>{const r=Ee.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Qe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Z.or([()=>Z.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Z7{constructor(e){this.serializer=e}k(e,t,i,r){const s=new ry("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(xf)})(e),(function(u){u.createObjectStore(Ud,{keyPath:J8}),u.createObjectStore(fr,{keyPath:_R,autoIncrement:!0}).createIndex(nl,vR,{unique:!0}),u.createObjectStore(yu)})(e),rA(e),(function(u){u.createObjectStore(Wa)})(e));let o=Z.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(vu),u.deleteObjectStore(_u),u.deleteObjectStore(ul)})(e),rA(e)),o=o.next((()=>(function(u){const h=u.store(ul),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Qe.min().toTimestamp(),targetCount:0};return h.put(lm,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(fr).J().next((p=>{u.deleteObjectStore(fr),u.createObjectStore(fr,{keyPath:_R,autoIncrement:!0}).createIndex(nl,vR,{unique:!0});const y=h.store(fr),x=p.map((I=>y.put(I)));return Z.waitFor(x)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(xu,{keyPath:lG})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(zd)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(oy,{keyPath:cG})})(e),(function(u){u.createObjectStore(ay,{keyPath:uG})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(ly,{keyPath:yG});h.createIndex(sx,_G,{unique:!1}),h.createIndex(tN,vG,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(am,{keyPath:tG});h.createIndex(_p,nG),h.createIndex(Zk,iG)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Wa)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(hw,{keyPath:hG,autoIncrement:!0}).createIndex(rx,dG,{unique:!1}),u.createObjectStore(ad,{keyPath:fG}).createIndex(Jk,gG,{unique:!1}),u.createObjectStore(ld,{keyPath:pG}).createIndex(eN,mG,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(ad).clear()})).next((()=>{t.objectStore(ld).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(dw,{keyPath:xG})})(e)}))),i<18&&r>=18&&JP()&&(o=o.next((()=>{t.objectStore(ad).clear()})).next((()=>{t.objectStore(ld).clear()}))),o}wi(e){let t=0;return e.store(Wa).ee(((i,r)=>{t+=_m(r)})).next((()=>{const i={byteSize:t};return e.store(zd).put(ix,i)}))}yi(e){const t=e.store(Ud),i=e.store(fr);return t.J().next((r=>Z.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,cl],[s.userId,s.lastAcknowledgedBatchId]);return i.J(nl,o).next((l=>Z.forEach(l,(u=>{De(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=Ka(this.serializer,u);return qN(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(vu),i=e.store(Wa);return e.store(ul).get(lm).next((r=>{const s=[];return i.ee(((o,l)=>{const u=new Ct(o),h=(function(p){return[0,Gn(p)]})(u);s.push(t.get(h).next((f=>f?Z.resolve():(p=>t.put({targetId:0,path:Gn(p),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>Z.waitFor(s)))}))}bi(e,t){e.createObjectStore(Bd,{keyPath:aG});const i=t.store(Bd),r=new Tw,s=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:Gn(u)})}};return t.store(Wa).ee({X:!0},((o,l)=>{const u=new Ct(o);return s(u.popLast())})).next((()=>t.store(yu).ee({X:!0},(([o,l,u],h)=>{const f=es(l);return s(f.popLast())}))))}Di(e){const t=e.store(_u);return t.ee(((i,r)=>{const s=Yh(r),o=GN(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(Wa),r=[];return i.ee(((s,o)=>{const l=t.store(am),u=(function(p){return p.document?new Ee(Ct.fromString(p.document.name).popFirst(5)):p.noDocument?Ee.fromSegments(p.noDocument.path):p.unknownDocument?Ee.fromSegments(p.unknownDocument.path):Re(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>Z.waitFor(r)))}Fi(e,t){const i=t.store(fr),r=QN(this.serializer),s=new eD(my.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((u=>{let h=l.get(u.userId)??Sn();Ka(this.serializer,u).keys().forEach((f=>h=h.add(f))),l.set(u.userId,h)})),Z.forEach(l,((u,h)=>{const f=new wn(h),p=gy.wt(this.serializer,f),y=s.getIndexManager(f),x=py.wt(f,this.serializer,y,s.referenceDelegate);return new JN(r,x,p,y).recalculateAndSaveOverlaysForDocumentKeys(new ox(t,vr.ce),u).next()}))}))}}function rA(n){n.createObjectStore(vu,{keyPath:sG}).createIndex(uw,oG,{unique:!0}),n.createObjectStore(_u,{keyPath:"targetId"}).createIndex(Qk,rG,{unique:!0}),n.createObjectStore(ul)}const Mo="IndexedDbPersistence",Z_=18e5,Q_=5e3,J_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Q7="main";class Iw{constructor(e,t,i,r,s,o,l,u,h,f,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=y=>Promise.resolve(),!Iw.v())throw new Se(le.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new j7(this,r),this.$i=t+Q7,this.serializer=new BN(u),this.Ui=new Qo(this.$i,this.Ni,new Z7(this.serializer)),this.hi=new I7,this.Pi=new D7(this.referenceDelegate,this.serializer),this.remoteDocumentCache=QN(this.serializer),this.Ii=new S7,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&Ti(Mo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Se(le.FAILED_PRECONDITION,J_);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new vr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>tp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ll(e))return pe(Mo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return pe(Mo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Fh(e).get(Ic).next((t=>Z.resolve(this.es(t))))}ts(e){return tp(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Z_)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=en(t,xu);return i.J().next((r=>{const s=this.ss(r,Z_),o=r.filter((l=>s.indexOf(l)===-1));return Z.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Z.resolve(!0):Fh(e).get(Ic).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Q_)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Se(le.FAILED_PRECONDITION,J_);return!1}}return!(!this.networkEnabled||!this.inForeground)||tp(e).J().next((i=>this.ss(i,Q_).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&pe(Mo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[xf,xu],(e=>{const t=new ox(e,vr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>tp(e).J().next((t=>this.ss(t,Z_).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return py.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new N7(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return gy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){pe(Mo,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?TG:u===17?sN:u===16?EG:u===15?fw:u===14?rN:u===13?iN:u===12?wG:u===11?nN:void Re(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new ox(l,this.ci?this.ci.next():vr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Ti(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Se(le.FAILED_PRECONDITION,Kk);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return Fh(e).get(Ic).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Q_)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Se(le.FAILED_PRECONDITION,J_)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Fh(e).put(Ic,t)}static v(){return Qo.v()}Zi(e){const t=Fh(e);return t.get(Ic).next((i=>this.es(i)?(pe(Mo,"Releasing primary lease."),t.delete(Ic)):Z.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Ti(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;QP()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return pe(Mo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ti(Mo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ti("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Fh(n){return en(n,xf)}function tp(n){return en(n,xu)}function J7(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Cw{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Sn(),r=Sn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Cw(e,t.fromCache,i,r)}}class eW{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class tD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return QP()?8:Xk(Jt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new eW;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Lc()<=Ke.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",Nh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Z.resolve()):(Lc()<=Ke.DEBUG&&pe("QueryEngine","Query:",Nh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Lc()<=Ke.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",Nh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$s(t))):Z.resolve())}ys(e,t){if(NR(t))return Z.resolve(null);let i=$s(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=dx(t,null,"F"),i=$s(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Sn(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,l);return this.Cs(t,h,o,u.readTime)?this.ys(e,dx(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return NR(t)||r.isEqual(Qe.min())?Z.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Z.resolve(null):(Lc()<=Ke.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Nh(t)),this.vs(e,o,t,K8(r,Vd)).next((l=>l)))}))}Ds(e,t){let i=new mt(BG(e));return t.forEach(((r,s)=>{hy(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Lc()<=Ke.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",Nh(t)),this.ps.getDocumentsMatchingQuery(e,t,Ai.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const tW="LocalStore";class nW{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new ci(He),this.xs=new la((s=>Sl(s)),wf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JN(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function nD(n,e,t,i){return new nW(n,e,t,i)}async function iW(n,e){const t=Tt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let u=Sn();for(const h of r){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function rW(n,e){const t=Tt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,f){const p=h.batch,y=p.keys();let x=Z.resolve();return y.forEach((I=>{x=x.next((()=>f.getEntry(u,I))).next((T=>{const S=h.docVersions.get(I);De(S!==null,48541),T.version.compareTo(S)<0&&(p.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),f.addEntry(T)))}))})),x.next((()=>l.mutationQueue.removeMutationBatch(u,p)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let u=Sn();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function sW(n){const e=Tt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function oW(n,e){const t=Tt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=cl),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class sA{constructor(){this.activeTargetIds=XG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class iD{constructor(){this.Mo=new sA,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new sA,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class aW{Oo(e){}shutdown(){}}const oA="ConnectivityMonitor";class aA{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){pe(oA,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){pe(oA,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let np=null;function vx(){return np===null?np=(function(){return 268435456+Math.round(2147483648*Math.random())})():np++,"0x"+np.toString(16)}const ev="RestConnection",lW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cW{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===um?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=vx(),l=this.zo(e,t.toUriEncodedString());pe(ev,`Sending RPC '${e}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(l),f=Dl(h);return this.Jo(e,l,u,i,f).then((p=>(pe(ev,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw ny(ev,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",i),p}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Lu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=lW[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class uW{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const kn="WebChannelConnection";class hW extends cW{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=vx();return new Promise(((l,u)=>{const h=new Ok;h.setWithCredentials(!0),h.listenOnce(Fk.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case pp.NO_ERROR:const p=h.getResponseJson();pe(kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case pp.TIMEOUT:pe(kn,`RPC '${e}' ${o} timed out`),u(new Se(le.DEADLINE_EXCEEDED,"Request time out"));break;case pp.HTTP_ERROR:const y=h.getStatus();if(pe(kn,`RPC '${e}' ${o} failed with status:`,y,"response text:",h.getResponseText()),y>0){let x=h.getResponseJson();Array.isArray(x)&&(x=x[0]);const I=x?.error;if(I&&I.status&&I.message){const T=(function(b){const D=b.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(D)>=0?D:le.UNKNOWN})(I.status);u(new Se(T,I.message))}else u(new Se(le.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Se(le.UNAVAILABLE,"Connection failed."));break;default:Re(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{pe(kn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);pe(kn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=vx(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Uk(),l=jk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const f=s.join("");pe(kn,`Creating RPC '${e}' stream ${r}: ${f}`,u);const p=o.createWebChannel(f,u);this.I_(p);let y=!1,x=!1;const I=new uW({Yo:S=>{x?pe(kn,`Not sending because RPC '${e}' stream ${r} is closed:`,S):(y||(pe(kn,`Opening RPC '${e}' stream ${r} transport.`),p.open(),y=!0),pe(kn,`RPC '${e}' stream ${r} sending:`,S),p.send(S))},Zo:()=>p.close()}),T=(S,b,D)=>{S.listen(b,(N=>{try{D(N)}catch(L){setTimeout((()=>{throw L}),0)}}))};return T(p,Xh.EventType.OPEN,(()=>{x||(pe(kn,`RPC '${e}' stream ${r} transport opened.`),I.o_())})),T(p,Xh.EventType.CLOSE,(()=>{x||(x=!0,pe(kn,`RPC '${e}' stream ${r} transport closed`),I.a_(),this.E_(p))})),T(p,Xh.EventType.ERROR,(S=>{x||(x=!0,ny(kn,`RPC '${e}' stream ${r} transport errored. Name:`,S.name,"Message:",S.message),I.a_(new Se(le.UNAVAILABLE,"The operation could not be completed")))})),T(p,Xh.EventType.MESSAGE,(S=>{if(!x){const b=S.data[0];De(!!b,16349);const D=b,N=D?.error||D[0]?.error;if(N){pe(kn,`RPC '${e}' stream ${r} received error:`,N);const L=N.status;let F=(function(R){const P=$t[R];if(P!==void 0)return o7(P)})(L),G=N.message;F===void 0&&(F=le.INTERNAL,G="Unknown error status: "+L+" with message "+N.message),x=!0,I.a_(new Se(F,G)),p.close()}else pe(kn,`RPC '${e}' stream ${r} received:`,b),I.u_(b)}})),T(l,Vk.STAT_EVENT,(S=>{S.stat===ex.PROXY?pe(kn,`RPC '${e}' stream ${r} detected buffering proxy`):S.stat===ex.NOPROXY&&pe(kn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{I.__()}),0),I}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function dW(){return typeof window<"u"?window:null}function Tp(){return typeof document<"u"?document:null}function rD(n){return new u7(n,!0)}class sD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&pe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const lA="PersistentStream";class fW{constructor(e,t,i,r,s,o,l,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new sD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===le.RESOURCE_EXHAUSTED?(Ti(t.toString()),Ti("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Se(le.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return pe(lA,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(pe(lA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class gW extends fW{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return De(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,De(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){De(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=p7(e.writeResults,e.commitTime),i=Sr(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=f7(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>pm(this.serializer,i)))};this.q_(t)}}class pW{}class mW extends pW{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Se(le.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,gx(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Se(le.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,gx(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Se(le.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class yW{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ti(t),this.aa=!1):pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const yy="RemoteStore";class _W{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{vy(this)&&(pe(yy,"Restarting streams for network reachability change."),await(async function(u){const h=Tt(u);h.Ea.add(4),await _y(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Rw(h)})(this))}))})),this.Ra=new yW(i,r)}}async function Rw(n){if(vy(n))for(const e of n.da)await e(!0)}async function _y(n){for(const e of n.da)await e(!1)}function vy(n){return Tt(n).Ea.size===0}async function oD(n,e,t){if(!Ll(e))throw e;n.Ea.add(1),await _y(n),n.Ra.set("Offline"),t||(t=()=>sW(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{pe(yy,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Rw(n)}))}function aD(n,e){return e().catch((t=>oD(n,t,e)))}async function xy(n){const e=Tt(n),t=sa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:cl;for(;vW(e);)try{const r=await oW(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,xW(e,r)}catch(r){await oD(e,r)}lD(e)&&cD(e)}function vW(n){return vy(n)&&n.Ta.length<10}function xW(n,e){n.Ta.push(e);const t=sa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function lD(n){return vy(n)&&!sa(n).x_()&&n.Ta.length>0}function cD(n){sa(n).start()}async function wW(n){sa(n).ra()}async function EW(n){const e=sa(n);for(const t of n.Ta)e.ea(t.mutations)}async function TW(n,e,t){const i=n.Ta.shift(),r=xw.from(i,e,t);await aD(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await xy(n)}async function SW(n,e){e&&sa(n).X_&&await(async function(i,r){if((function(o){return s7(o)&&o!==le.ABORTED})(r.code)){const s=i.Ta.shift();sa(i).B_(),await aD(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await xy(i)}})(n,e),lD(n)&&cD(n)}async function IW(n,e){const t=Tt(n);e?(t.Ea.delete(2),await Rw(t)):e||(t.Ea.add(2),await _y(t),t.Ra.set("Unknown"))}function sa(n){return n.fa||(n.fa=(function(t,i,r){const s=Tt(t);return s.sa(),new gW(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:wW.bind(null,n),r_:SW.bind(null,n),ta:EW.bind(null,n),na:TW.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await xy(n)):(await n.fa.stop(),n.Ta.length>0&&(pe(yy,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Aw{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new ll,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new Aw(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function CW(n,e){if(Ti("AsyncQueue",`${e}: ${n}`),Ll(n))return new Se(le.UNAVAILABLE,`${e}: ${n}`);throw n}class RW{constructor(){this.queries=cA(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Tt(t),s=r.queries;r.queries=cA(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(i)}))})(this,new Se(le.ABORTED,"Firestore shutting down"))}}function cA(){return new la((n=>IN(n)),SN)}function AW(n){n.Ca.forEach((e=>{e.next()}))}var uA,hA;(hA=uA||(uA={})).Ma="default",hA.Cache="cache";const bW="SyncEngine";class PW{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new la((l=>IN(l)),SN),this.Iu=new Map,this.Eu=new Set,this.du=new ci(Ee.comparator),this.Au=new Map,this.Ru=new Sw,this.Vu={},this.mu=new Map,this.fu=Rl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function dA(n,e,t){const i=Tt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const u=Tt(o);u.onlineState=l;let h=!1;u.queries.forEach(((f,p)=>{for(const y of p.Sa)y.va(l)&&(h=!0)})),h&&AW(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function kW(n,e){const t=Tt(n),i=e.batch.batchId;try{const r=await rW(t.localStore,e);hD(t,i,null),uD(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await bw(t,r)}catch(r){await iy(r)}}async function NW(n,e,t){const i=Tt(n);try{const r=await(function(o,l){const u=Tt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next((p=>(De(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);hD(i,e,t),uD(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await bw(i,r)}catch(r){await iy(r)}}function uD(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function hD(n,e,t){const i=Tt(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function bw(n,e,t){const i=Tt(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){r.push(h);const f=Cw.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const f=Tt(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>Z.forEach(h,(y=>Z.forEach(y.Es,(x=>f.persistence.referenceDelegate.addReference(p,y.targetId,x))).next((()=>Z.forEach(y.ds,(x=>f.persistence.referenceDelegate.removeReference(p,y.targetId,x)))))))))}catch(p){if(!Ll(p))throw p;pe(tW,"Failed to update sequence numbers: "+p)}for(const p of h){const y=p.targetId;if(!p.fromCache){const x=f.Ms.get(y),I=x.snapshotVersion,T=x.withLastLimboFreeSnapshotVersion(I);f.Ms=f.Ms.insert(y,T)}}})(i.localStore,s))}async function DW(n,e){const t=Tt(n);if(!t.currentUser.isEqual(e)){pe(bW,"User change. New user:",e.toKey());const i=await iW(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new Se(le.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await bw(t,i.Ls)}}function MW(n){const e=Tt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kW.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NW.bind(null,e),e}class xx{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rD(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return nD(this.persistence,new tD,e.initialUser,this.serializer)}Cu(e){return new eD(my.mi,this.serializer)}Du(e){return new iD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}xx.provider={build:()=>new xx};class LW extends xx{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await MW(this.xu.syncEngine),await xy(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return nD(this.persistence,new tD,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new O7(i,e.asyncQueue,t)}Mu(e,t){const i=new Z8(t,this.persistence);return new Y8(e.asyncQueue,i)}Cu(e){const t=J7(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new Iw(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,dW(),Tp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new iD}}class wx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>dA(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=DW.bind(null,this.syncEngine),await IW(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new RW})()}createDatastore(e){const t=rD(e.databaseInfo.databaseId),i=(function(s){return new hW(s)})(e.databaseInfo);return(function(s,o,l,u){return new mW(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new _W(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>dA(this.syncEngine,t,0)),(function(){return aA.v()?new aA:new aW})())}createSyncEngine(e,t){return(function(r,s,o,l,u,h,f){const p=new PW(r,s,o,l,u,h);return f&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Tt(t);pe(yy,"RemoteStore shutting down."),i.Ea.add(5),await _y(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}wx.provider={build:()=>new wx};const fA="FirestoreClient";class OW{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=wn.UNAUTHENTICATED,this.clientId=Gk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{pe(fA,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(pe(fA,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ll;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=CW(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function dD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const gA=new Map;const fD="firestore.googleapis.com",pA=!0;class mA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Se(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=fD,this.ssl=pA}else this.host=e.host,this.ssl=e.ssl??pA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=KN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<M7)throw new Se(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}W8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dD(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Se(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Se(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Se(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gD{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new M8;switch(i.type){case"firstParty":return new V8(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Se(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=gA.get(t);i&&(pe("ComponentProvider","Removing Datastore"),gA.delete(t),i.terminate())})(this),Promise.resolve()}}function FW(n,e,t,i={}){n=$k(n,gD);const r=Dl(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&($1(`https://${l}`),H1("Firestore",!0)),s.host!==fD&&s.host!==l&&ny("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:r,emulatorOptions:i};if(!xl(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=wn.MOCK_USER;else{h=YP(i.mockUserToken,n._app?.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new Se(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new wn(p)}n._authCredentials=new L8(new Bk(h,f))}}class Pw{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Pw(this.firestore,e,this._query)}}class ns{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new kw(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ns(this.firestore,e,this._key)}toJSON(){return{type:ns._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(vf(t,ns._jsonSchema))return new ns(e,i||null,new Ee(Ct.fromString(t.referencePath)))}}ns._jsonSchemaVersion="firestore/documentReference/1.0",ns._jsonSchema={type:Kt("string",ns._jsonSchemaVersion),referencePath:Kt("string")};class kw extends Pw{constructor(e,t,i){super(e,t,TN(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ns(this.firestore,null,new Ee(e))}withConverter(e){return new kw(this.firestore,e,this._path)}}const yA="AsyncQueue";class _A{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new sD(this,"async_queue_retry"),this._c=()=>{const i=Tp();i&&pe(yA,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Tp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Tp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ll;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ll(e))throw e;pe(yA,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ti("INTERNAL UNHANDLED ERROR: ",vA(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Aw.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Re(47125,{Pc:vA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function vA(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class pD extends gD{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new _A,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new _A(e),this._firestoreClient=void 0,await e}}}function VW(n,e){const t=typeof n=="object"?n:X1(),i=typeof n=="string"?n:um,r=Qm(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=KP("firestore");s&&FW(r,...s)}return r}function jW(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new RG(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,dD(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new OW(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function UW(n,e){ny("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return zW(n,wx.provider,{build:i=>new LW(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function zW(n,e,t){if((n=$k(n,pD))._firestoreClient||n._terminated)throw new Se(le.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Se(le.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},jW(n)}class Os{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Os(ui.fromBase64String(e))}catch(t){throw new Se(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Os(ui.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Os._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(vf(e,Os._jsonSchema))return Os.fromBase64String(e.bytes)}}Os._jsonSchemaVersion="firestore/bytes/1.0",Os._jsonSchema={type:Kt("string",Os._jsonSchemaVersion),bytes:Kt("string")};class mD{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Se(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Se(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Se(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return He(this._lat,e._lat)||He(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:hl._jsonSchemaVersion}}static fromJSON(e){if(vf(e,hl._jsonSchema))return new hl(e.latitude,e.longitude)}}hl._jsonSchemaVersion="firestore/geoPoint/1.0",hl._jsonSchema={type:Kt("string",hl._jsonSchemaVersion),latitude:Kt("number"),longitude:Kt("number")};class dl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:dl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(vf(e,dl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new dl(e.vectorValues);throw new Se(le.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}dl._jsonSchemaVersion="firestore/vectorValue/1.0",dl._jsonSchema={type:Kt("string",dl._jsonSchemaVersion),vectorValues:Kt("object")};const BW=new RegExp("[~\\*/\\[\\]]");function GW(n,e,t){if(e.search(BW)>=0)throw xA(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new mD(...e.split("."))._internalPath}catch{throw xA(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function xA(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new Se(le.INVALID_ARGUMENT,s+n+o)}class yD{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ns(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new WW(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(_D("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class WW extends yD{data(){return super.data()}}function _D(n,e){return typeof e=="string"?GW(n,e):e instanceof mD?e._internalPath:e._delegate._internalPath}class ip{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class eu extends yD{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Sp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(_D("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(le.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=eu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}eu._jsonSchemaVersion="firestore/documentSnapshot/1.0",eu._jsonSchema={type:Kt("string",eu._jsonSchemaVersion),bundleSource:Kt("string","DocumentSnapshot"),bundleName:Kt("string"),bundle:Kt("string")};class Sp extends eu{data(e={}){return super.data(e)}}class fd{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ip(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Sp(this._firestore,this._userDataWriter,i.key,i,new ip(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Se(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const u=new Sp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new ip(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new Sp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new ip(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:$W(l.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(le.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Gk.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function $W(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re(61501,{type:n})}}fd._jsonSchemaVersion="firestore/querySnapshot/1.0",fd._jsonSchema={type:Kt("string",fd._jsonSchemaVersion),bundleSource:Kt("string","QuerySnapshot"),bundleName:Kt("string"),bundle:Kt("string")};(function(e,t=!0){(function(r){Lu=r})(Ml),wl(new na("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new pD(new O8(i.getProvider("auth-internal")),new j8(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Se(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Eu(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),ss(uR,hR,e),ss(uR,hR,"esm2020")})();const vD="firebasestorage.googleapis.com",HW="storageBucket",KW=120*1e3,qW=600*1e3;class ds extends hs{constructor(e,t,i=0){super(tv(e),`Firebase Storage: ${t} (${tv(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return tv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var cs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(cs||(cs={}));function tv(n){return"storage/"+n}function XW(){const n="An unknown error occurred, please check the error payload for server response.";return new ds(cs.UNKNOWN,n)}function YW(){return new ds(cs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function ZW(){return new ds(cs.CANCELED,"User canceled the upload/download.")}function QW(n){return new ds(cs.INVALID_URL,"Invalid URL '"+n+"'.")}function JW(n){return new ds(cs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function wA(n){return new ds(cs.INVALID_ARGUMENT,n)}function xD(){return new ds(cs.APP_DELETED,"The Firebase app was deleted.")}function e$(n){return new ds(cs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class wr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=wr.makeFromUrl(e,t)}catch{return new wr(e,"")}if(i.path==="")return i;throw JW(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(L){L.path_=decodeURIComponent(L.path)}const f="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",x=new RegExp(`^https?://${p}/${f}/b/${r}/o${y}`,"i"),I={bucket:1,path:3},T=t===vD?"(?:storage.googleapis.com|storage.cloud.google.com)":t,S="([^?#]*)",b=new RegExp(`^https?://${T}/${r}/${S}`,"i"),N=[{regex:l,indices:u,postModify:s},{regex:x,indices:I,postModify:h},{regex:b,indices:{bucket:1,path:2},postModify:h}];for(let L=0;L<N.length;L++){const F=N[L],G=F.regex.exec(e);if(G){const k=G[F.indices.bucket];let R=G[F.indices.path];R||(R=""),i=new wr(k,R),F.postModify(i);break}}if(i==null)throw QW(e);return i}}class t${constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function n$(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function f(...S){h||(h=!0,e.apply(null,S))}function p(S){r=setTimeout(()=>{r=null,n(x,u())},S)}function y(){s&&clearTimeout(s)}function x(S,...b){if(h){y();return}if(S){y(),f.call(null,S,...b);return}if(u()||o){y(),f.call(null,S,...b);return}i<64&&(i*=2);let N;l===1?(l=2,N=0):N=(i+Math.random())*1e3,p(N)}let I=!1;function T(S){I||(I=!0,y(),!h&&(r!==null?(S||(l=2),clearTimeout(r),p(0)):S||(l=1)))}return p(0),s=setTimeout(()=>{o=!0,T(!0)},t),T}function i$(n){n(!1)}function r$(n){return n!==void 0}function EA(n,e,t,i){if(i<e)throw wA(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw wA(`Invalid value for '${n}'. Expected ${t} or less.`)}function s$(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var vm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(vm||(vm={}));function o$(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class a${constructor(e,t,i,r,s,o,l,u,h,f,p,y=!0,x=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=p,this.retry=y,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((I,T)=>{this.resolve_=I,this.reject_=T,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new rp(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===vm.NO_ERROR,u=s.getStatus();if(!l||o$(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===vm.ABORT;i(!1,new rp(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new rp(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());r$(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=XW();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?xD():ZW();o(u)}else{const u=YW();o(u)}};this.canceled_?t(!1,new rp(!1,null,!0)):this.backoffId_=n$(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&i$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class rp{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function l$(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function c$(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function u$(n,e){e&&(n["X-Firebase-GMPID"]=e)}function h$(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function d$(n,e,t,i,r,s,o=!0,l=!1){const u=s$(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return u$(f,e),l$(f,t),c$(f,s),h$(f,i),new a$(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function f$(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function g$(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class xm{constructor(e,t){this._service=e,t instanceof wr?this._location=t:this._location=wr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new xm(e,t)}get root(){const e=new wr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return g$(this._location.path)}get storage(){return this._service}get parent(){const e=f$(this._location.path);if(e===null)return null;const t=new wr(this._location.bucket,e);return new xm(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw e$(e)}}function TA(n,e){const t=e?.[HW];return t==null?null:wr.makeFromBucketSpec(t,n)}function p$(n,e,t,i={}){n.host=`${e}:${t}`;const r=Dl(e);r&&($1(`https://${n.host}/b`),H1("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:YP(s,n.app.options.projectId))}class m${constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=vD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=KW,this._maxUploadRetryTime=qW,this._requests=new Set,r!=null?this._bucket=wr.makeFromBucketSpec(r,this._host):this._bucket=TA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=wr.makeFromBucketSpec(this._url,e):this._bucket=TA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){EA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){EA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Hi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new xm(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new t$(xD());{const o=d$(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const SA="@firebase/storage",IA="0.14.0";const wD="storage";function y$(n=X1(),e){n=eo(n);const i=Qm(n,wD).getImmediate({identifier:e}),r=KP("storage");return r&&_$(i,...r),i}function _$(n,e,t,i={}){p$(n,e,t,i)}function v$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new m$(t,i,r,e,Ml)}function x$(){wl(new na(wD,v$,"PUBLIC").setMultipleInstances(!0)),ss(SA,IA,""),ss(SA,IA,"esm2020")}x$();const w$={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},Nw=ik(w$),nv=P8(Nw),E$=VW(Nw);y$(Nw);UW(E$).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const T$="visvriend2024",S$=new Ls,ED=Rr()(ff((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===T$;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await jB(nv,S$);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await vB(nv),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{_B(nv,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})})),Dw="https://waterwebservices.rijkswaterstaat.nl/ONLINEWAARNEMINGENSERVICES_DBO",Kd=[{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556,x:97580,y:497920},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664,x:75580,y:458220},{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12,x:65150,y:444150},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961,x:30410,y:385360},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456,x:109200,y:553200},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083,x:158e3,y:576500},{id:"TERSLNZE",name:"Terschelling",lat:53.4397,lng:5.3281,x:155e3,y:606e3},{id:"TEXLHORS",name:"Texel Hors",lat:52.9983,lng:4.6981,x:106e3,y:557e3},{id:"EEMHVN",name:"Eemhaven",lat:51.9,lng:4.4833,x:9e4,y:436e3},{id:"KATSVR",name:"Kats",lat:51.5694,lng:3.9389,x:53e3,y:399e3}];function I$(n,e){let t=Kd[0],i=1/0;for(const r of Kd){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}async function C$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"T"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Dw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching water temperature:",r),null}}async function R$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"GOLFHTE"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Dw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching wave height:",r),null}}async function A$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"STROOMSHD"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Dw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0){const l=o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null;return l!==null?{speed:l,direction:0}:null}}return null}catch(r){return console.error("Error fetching current speed:",r),null}}async function b$(n){const[e,t,i]=await Promise.all([C$(n),R$(n),A$(n)]);return{temperature:e??void 0,waveHeight:t??void 0,currentSpeed:i?.speed??void 0,currentDirection:i?.direction??void 0,timestamp:new Date,station:n}}function CA(n){const e=new Date().getMonth(),i=[5,4,5,8,12,16,18,19,17,13,9,6][e]+(Math.random()*2-1),r=30+Math.random()*80,s=Math.random()*60,o=Math.random()*360;return{temperature:Math.round(i*10)/10,waveHeight:Math.round(r),currentSpeed:Math.round(s),currentDirection:Math.round(o),timestamp:new Date,station:n}}const TD=Rr((n,e)=>({station:Kd[1],waterData:null,lastUpdated:null,isLoading:!1,error:null,useSimulatedData:!0,setStation:t=>n({station:t}),setStationByPosition:(t,i)=>{const r=I$(t,i);n({station:r})},fetchData:async()=>{const{station:t,useSimulatedData:i}=e();if(t){n({isLoading:!0,error:null});try{let r;i?r=CA(t):r=await b$(t),n({waterData:r,lastUpdated:new Date,isLoading:!1})}catch(r){console.error("Error fetching water data:",r);const s=CA(t);n({waterData:s,lastUpdated:new Date,isLoading:!1,error:"Kon geen live data ophalen, gesimuleerde data wordt getoond"})}}},setUseSimulatedData:t=>n({useSimulatedData:t})}));function P$({target:n}){const e=q.useRef(null),t=q.useRef(null),i=Js(s=>s.setMap),r=ln(s=>s.showScaleBar);return q.useEffect(()=>{if(!e.current){const s=new _9({target:n,controls:[],view:new Qr({center:gl([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),q.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new w9({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const k$=["OpenStreetMap","Luchtfoto"];function N$(){const n=q.useRef(null),e=q.useRef(!1);P$({target:"map"});const t=Js(u=>u.map),i=Xo(u=>u.registerLayer),r=Xo(u=>u.setLayerVisibility),s=ln(u=>u.defaultBackground),o=ln(u=>u.gpsAutoStart),l=Ei(u=>u.startTracking);return q.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const u=new k_({properties:{title:"OpenStreetMap",type:"base"},visible:!0,source:new V6}),h=new k_({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Fv({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),f=new k_({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Fv({url:"https://{a-d}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})});t.addLayer(u),t.addLayer(h),t.addLayer(f),i("OpenStreetMap",u),i("Luchtfoto",h),i("Labels Overlay",f),t.updateSize(),p();async function p(){const y=K9();console.log(`Loading ${y.length} immediate layers...`),(await Promise.allSettled(y.map(async I=>{try{const T=await I.factory();return T?{name:I.name,layer:T}:null}catch(T){return console.warn(`Failed to create ${I.name}:`,T),null}}))).forEach(I=>{if(I.status==="fulfilled"&&I.value){const{name:T,layer:S}=I.value;t.addLayer(S),i(T,S)}})}},[t,i]),q.useEffect(()=>{if(!t||e.current)return;const u=setTimeout(()=>{const h=s||"OpenStreetMap";k$.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(u)},[t,s,r]),q.useEffect(()=>{if(!t||!o)return;const u=setTimeout(()=>l(),500);return()=>clearTimeout(u)},[t,o,l]),_.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const D$=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),M$=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),RA=n=>{const e=M$(n);return e.charAt(0).toUpperCase()+e.slice(1)},SD=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),L$=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var O$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const F$=q.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},u)=>q.createElement("svg",{ref:u,...O$,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:SD("lucide",r),...!s&&!L$(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>q.createElement(h,f)),...Array.isArray(s)?s:[s]]));const Ae=(n,e)=>{const t=q.forwardRef(({className:i,...r},s)=>q.createElement(F$,{ref:s,iconNode:e,className:SD(`lucide-${D$(RA(n))}`,`lucide-${n}`,i),...r}));return t.displayName=RA(n),t};const V$=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],ID=Ae("anchor",V$);const j$=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],U$=Ae("book-open",j$);const z$=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Mw=Ae("camera",z$);const B$=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],G$=Ae("chart-column",B$);const W$=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ex=Ae("check",W$);const $$=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],H$=Ae("chevron-down",$$);const K$=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Vh=Ae("chevron-right",K$);const q$=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],CD=Ae("chevron-up",q$);const X$=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],Y$=Ae("cloud-fog",X$);const Z$=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],Q$=Ae("cloud-lightning",Z$);const J$=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],RD=Ae("cloud-rain",J$);const eH=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],tH=Ae("cloud-snow",eH);const nH=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],qd=Ae("cloud",nH);const iH=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],rH=Ae("droplets",iH);const sH=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],AD=Ae("external-link",sH);const oH=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],aH=Ae("eye-off",oH);const lH=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],cH=Ae("eye",lH);const uH=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],hH=Ae("file-text",uH);const dH=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],Ys=Ae("fish",dH);const fH=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],gH=Ae("image-plus",fH);const pH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],bD=Ae("info",pH);const mH=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],wm=Ae("layers",mH);const yH=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],_H=Ae("loader-circle",yH);const vH=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],xH=Ae("locate-fixed",vH);const wH=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],EH=Ae("lock",wH);const TH=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],SH=Ae("log-out",TH);const IH=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Al=Ae("map-pin",IH);const CH=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],wy=Ae("map",CH);const RH=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],AH=Ae("menu",RH);const bH=[["path",{d:"M5 12h14",key:"1ays0h"}]],PH=Ae("minus",bH);const kH=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],NH=Ae("moon",kH);const DH=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],tu=Ae("navigation",DH);const MH=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],LH=Ae("person-standing",MH);const OH=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],FH=Ae("plus",OH);const VH=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],PD=Ae("refresh-cw",VH);const jH=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],UH=Ae("rotate-ccw",jH);const zH=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],BH=Ae("ruler",zH);const GH=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],WH=Ae("save",GH);const $H=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],HH=Ae("scale",$H);const KH=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],AA=Ae("search",KH);const qH=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],XH=Ae("settings",qH);const YH=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],ZH=Ae("ship",YH);const QH=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],JH=Ae("sparkles",QH);const eK=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Tx=Ae("star",eK);const tK=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],nK=Ae("sun",tK);const iK=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],rK=Ae("tag",iK);const sK=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],kD=Ae("thermometer",sK);const oK=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],aK=Ae("trending-down",oK);const lK=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],cK=Ae("trending-up",lK);const uK=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],hK=Ae("user",uK);const dK=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],Xd=Ae("waves",dK);const fK=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],bA=Ae("wind",fK);const gK=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ji=Ae("x",gK);async function pK(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e(null);return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,p=r.getUint16(f)===18761,y=mK(r,f,p);e(y);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e(null)},t.onerror=()=>e(null),t.readAsArrayBuffer(n)})}function mK(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null;for(let p=0;p<r;p++){const y=i+2+p*12;if(n.getUint16(y,t)===34853){s=e+n.getUint32(y+8,t);break}}if(!s)return null;const o=n.getUint16(s,t);let l=null,u=null,h=null,f=null;for(let p=0;p<o;p++){const y=s+2+p*12,x=n.getUint16(y,t),I=n.getUint16(y+2,t),T=n.getUint32(y+4,t),S=y+8;switch(x){case 1:l=String.fromCharCode(n.getUint8(S));break;case 2:u=PA(n,e+n.getUint32(S,t),3,t);break;case 3:h=String.fromCharCode(n.getUint8(S));break;case 4:f=PA(n,e+n.getUint32(S,t),3,t);break}}if(u&&f&&l&&h){const p=kA(u[0],u[1],u[2],l),y=kA(f[0],f[1],f[2],h);if(!isNaN(p)&&!isNaN(y))return{lat:p,lng:y}}return null}catch{return null}}function PA(n,e,t,i){const r=[];for(let s=0;s<t;s++){const o=n.getUint32(e+s*8,i),l=n.getUint32(e+s*8+4,i);r.push(l===0?0:o/l)}return r}function kA(n,e,t,i){let r=n+e/60+t/3600;return(i==="S"||i==="W")&&(r=-r),r}const ND=200,yK=.7;async function _K(n,e=ND){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,u=r.height;l>u?l>e&&(u=Math.round(u*e/l),l=e):u>e&&(l=Math.round(l*e/u),u=e),s.width=l,s.height=u,o?.drawImage(r,0,0,l,u),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",yK)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function vK(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function DD(n){const e=await _K(n,ND),t=await vK(e);return{thumbnailBlob:e,thumbnailBase64:t}}function MD(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function xK(){const n=Js(N=>N.map),e=ii(N=>N.openCatchForm),[t,i]=q.useState(null),[r,s]=q.useState(!1),[o,l]=q.useState(!1),u=q.useRef(null),h=q.useRef(null);q.useEffect(()=>{if(!n)return;const N=n.getViewport();if(!N)return;const L=600,F=15,G=M=>{if(M.touches.length!==1)return;const se=M.touches[0];h.current={x:se.clientX,y:se.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const he=window.__olMap;if(!he)return;const ge=N.getBoundingClientRect(),ue=[h.current.x-ge.left,h.current.y-ge.top],Q=he.getCoordinateFromPixel(ue);if(Q){const re=CI(Q);M.preventDefault(),i({pixel:[h.current.x,h.current.y],coordinate:re}),s(!0),l(!1),setTimeout(()=>l(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},L)},k=M=>{if(!u.current||!h.current)return;const se=M.touches[0],he=se.clientX-h.current.x,ge=se.clientY-h.current.y;Math.sqrt(he*he+ge*ge)>F&&(clearTimeout(u.current),u.current=null)},R=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null},P=M=>{r&&M.preventDefault()},V=M=>{M.button===0&&(h.current={x:M.clientX,y:M.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const se=window.__olMap;if(!se)return;const he=N.getBoundingClientRect(),ge=[h.current.x-he.left,h.current.y-he.top],ue=se.getCoordinateFromPixel(ge);if(ue){const Q=CI(ue);i({pixel:[h.current.x,h.current.y],coordinate:Q}),s(!0),l(!1),setTimeout(()=>l(!0),300)}},L))},j=M=>{if(!u.current||!h.current)return;const se=M.clientX-h.current.x,he=M.clientY-h.current.y;Math.sqrt(se*se+he*he)>F&&(clearTimeout(u.current),u.current=null)},B=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null};return N.addEventListener("touchstart",G,{passive:!1}),N.addEventListener("touchmove",k,{passive:!0}),N.addEventListener("touchend",R),N.addEventListener("touchcancel",R),N.addEventListener("contextmenu",P),N.addEventListener("mousedown",V),N.addEventListener("mousemove",j),N.addEventListener("mouseup",B),N.addEventListener("mouseleave",B),()=>{N.removeEventListener("touchstart",G),N.removeEventListener("touchmove",k),N.removeEventListener("touchend",R),N.removeEventListener("touchcancel",R),N.removeEventListener("contextmenu",P),N.removeEventListener("mousedown",V),N.removeEventListener("mousemove",j),N.removeEventListener("mouseup",B),N.removeEventListener("mouseleave",B),u.current&&clearTimeout(u.current)}},[n,r]);const f=()=>{o&&(s(!1),i(null),l(!1))},p=()=>{s(!1),i(null),l(!1)},y=q.useRef(null),x=()=>{if(!t)return;const[N,L]=t.coordinate;e({location:{lat:L,lng:N},locationSource:"map"}),p()},I=()=>{y.current?.click()},T=async N=>{const L=N.target.files?.[0];if(!(!L||!t)){try{const F=await pK(L),{thumbnailBase64:G}=await DD(L),k={id:MD(),thumbnailBase64:G,createdAt:new Date().toISOString(),pendingUpload:!0};if(F)e({location:F,locationSource:"photo",photos:[k]});else{const[R,P]=t.coordinate;e({location:{lat:P,lng:R},locationSource:"map",photos:[k]})}}catch(F){console.error("Failed to process photo:",F);const[G,k]=t.coordinate;e({location:{lat:k,lng:G},locationSource:"map"})}N.target.value="",p()}},S=()=>{if(!t)return;const[N,L]=t.coordinate,F=`https://www.google.com/maps?q=${L},${N}`;window.open(F,"_blank"),p()},b=()=>{if(!t)return;const[N,L]=t.coordinate,F=`https://www.google.com/maps?layer=c&cbll=${L},${N}`;window.open(F,"_blank"),p()},D=N=>{const[L,F]=N;return`${F.toFixed(5)}N, ${L.toFixed(5)}E`};return _.jsx(ri,{children:r&&t&&_.jsxs(_.Fragment,{children:[_.jsx(Ge.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),_.jsxs(Ge.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(t.pixel[0],window.innerWidth-220),top:Math.min(t.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[_.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:_.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[_.jsx(Al,{size:16}),_.jsx("span",{className:"text-xs font-mono",children:D(t.coordinate)})]})}),_.jsxs("div",{className:"bg-white",children:[_.jsxs("button",{onClick:I,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(Mw,{size:20,className:"text-green-500"}),_.jsx("span",{className:"font-medium",children:"Maak foto"})]}),_.jsxs("button",{onClick:x,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(Ys,{size:20,className:"text-orange-500"}),_.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),_.jsxs("button",{onClick:b,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(LH,{size:20,className:"text-yellow-600"}),_.jsx("span",{className:"font-medium",children:"Street View"})]}),_.jsxs("button",{onClick:S,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(AD,{size:20,className:"text-blue-600"}),_.jsx("span",{className:"font-medium",children:"Google Maps"})]})]}),_.jsx("input",{ref:y,type:"file",accept:"image/*",capture:"environment",onChange:T,className:"hidden"}),_.jsx("div",{className:"bg-white",children:_.jsxs("button",{onClick:p,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[_.jsx(Ji,{size:18}),_.jsx("span",{children:"Annuleren"})]})})]})]})})}function wK(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=Ei(),s=q.useCallback(l=>{i(l)},[i]),o=q.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return q.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function EK(){const{tracking:n,toggle:e}=wK();return _.jsx(Ge.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:_.jsx(xH,{size:22,strokeWidth:2})})}const TK="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function SK(){const n=Js(y=>y.map),e=Ei(y=>y.position),t=Ei(y=>y.accuracy),i=Ei(y=>y.tracking),r=Ei(y=>y.smoothHeading),s=ln(y=>y.showAccuracyCircle),o=Ei(y=>y.firstFix),l=Ei(y=>y.resetFirstFix),u=q.useRef(null),h=q.useRef(null),f=q.useRef(null),p=q.useMemo(()=>y=>new Zi({image:new A1({src:TK,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return q.useEffect(()=>{if(!n||!i&&!e)return;const y=gl([5.1214,52.0907]);return u.current=new au({geometry:new pl(y)}),u.current.setStyle(p(0)),h.current=new au({geometry:new pl(y)}),f.current=new O1({source:new R1({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,p]),q.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const y=gl([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const x=n.getView().getResolution()||1,I=Math.min(t/x,80);h.current.setStyle(new Zi({image:new kl({radius:I,fill:new Ir({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new Zi({}));if(o&&i){n.getView().setCenter(y),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:y,duration:150})},[n,i,e,t,o,l,s]),q.useEffect(()=>{if(!u.current)return;const y=r!==null?r*Math.PI/180:0;u.current.setStyle(p(y))},[r,p]),null}function IK(){const n=Js(N=>N.map),[e,t]=q.useState(!1),[i,r]=q.useState(""),[s,o]=q.useState([]),[l,u]=q.useState(!1),[h,f]=q.useState(!1),p=q.useRef(null),y=q.useRef(null),x=q.useRef();q.useEffect(()=>{e&&p.current&&p.current.focus()},[e]),q.useEffect(()=>{if(!e)return;const N=L=>{y.current&&!y.current.contains(L.target)&&I()};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[e]),q.useEffect(()=>{if(!e)return;const N=L=>{L.key==="Escape"&&I()};return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},[e]),q.useEffect(()=>{if(x.current&&clearTimeout(x.current),i.length<2){o([]);return}return x.current=window.setTimeout(async()=>{f(!0);try{const L=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();L.response?.docs&&o(L.response.docs)}catch(N){console.error("Search error:",N),o([])}finally{f(!1)}},300),()=>{x.current&&clearTimeout(x.current)}},[i]);const I=()=>{t(!1),r(""),o([]),u(!1)},T=async N=>{try{const F=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(N)}`)).json();if(F.response?.docs?.[0]?.centroide_ll){const k=F.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(k)return{lng:parseFloat(k[1]),lat:parseFloat(k[2])}}}catch(L){console.error("Lookup error:",L)}return null},S=async N=>{if(!n)return;const L=await T(N.id);L&&n.getView().animate({center:gl([L.lng,L.lat]),zoom:16,duration:1e3}),I()},b=async(N,L)=>{L.stopPropagation();const F=await T(N.id);if(F){const G=`https://www.google.com/maps?q=${F.lat},${F.lng}`;window.open(G,"_blank")}I()},D={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?_.jsxs("div",{ref:y,className:"fixed left-[52px] right-14 z-[850]",style:D,children:[_.jsxs(Ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[_.jsx(AA,{size:18,className:"search-icon"}),_.jsx("input",{ref:p,type:"text",value:i,onChange:N=>{r(N.target.value),u(!0)},onFocus:()=>u(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),_.jsx("button",{onClick:I,className:"search-clear",title:"Sluiten",children:_.jsx(Ji,{size:18})})]}),_.jsx(ri,{children:l&&s.length>0&&_.jsx(Ge.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(N=>_.jsxs("li",{className:"search-result-item",children:[_.jsx("div",{className:"search-result-content",onClick:()=>S(N),children:_.jsx("span",{className:"search-result-text",children:N.weergavenaam})}),_.jsx("button",{className:"search-navigate-btn",onClick:L=>b(N,L),title:"Open in Google Maps",children:_.jsx(AD,{size:20})})]},N.id))})}),l&&h&&_.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):_.jsx(Ge.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:D,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:_.jsx(AA,{size:22,className:"text-gray-600"})})}function CK({size:n=18}){return _.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[_.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),_.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),_.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),_.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function RK(){const[n,e]=q.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=ii(),{user:r,loading:s,signInWithGoogle:o,logout:l}=ED(),u=ln(S=>S.showCatchButton),h=ln(S=>S.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},p=()=>e(!1),y=()=>{p(),t()},x=()=>{p(),i()},I=()=>{p(),o()},T=()=>{p(),l()};return _.jsxs(_.Fragment,{children:[_.jsx(Ge.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?_.jsx(Ji,{size:22,className:"text-white"}):_.jsx(AH,{size:22,className:"text-gray-600"})}),_.jsx(ri,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(Ge.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:p}),_.jsxs(Ge.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[_.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-blue-500",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?_.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:_.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):r?_.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:_.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?_.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):_.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:_.jsx(hK,{size:16,className:"text-white"})}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),_.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),_.jsx("button",{onClick:T,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:_.jsx(SH,{size:16})})]})}):_.jsxs("button",{onClick:I,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[_.jsx(CK,{size:18}),_.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),_.jsx("div",{className:"py-1",children:_.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[_.jsx(bD,{size:18,className:"text-blue-500"}),_.jsx("span",{children:"Info & handleiding"})]})}),_.jsx("div",{className:"py-1 border-t border-gray-100",children:_.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx(Ys,{size:18,className:"text-green-500"}),_.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),_.jsx("button",{onClick:()=>h(!u),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${u?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:_.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${u?"left-[22px]":"left-0.5"}`})})]})}),_.jsx("div",{className:"mt-auto border-t border-gray-100",children:_.jsxs("button",{onClick:x,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[_.jsx(XH,{size:18,className:"text-gray-500"}),_.jsx("span",{children:"Instellingen"})]})}),_.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.5"})]})]})})]})}function AK(){const{infoPanelOpen:n,toggleInfoPanel:e}=ii(),[t,i]=q.useState("info"),r=[{id:"info",label:"Info",icon:_.jsx(bD,{size:14})},{id:"functies",label:"Functies",icon:_.jsx(hH,{size:14})},{id:"handleiding",label:"Handleiding",icon:_.jsx(U$,{size:14})}];return _.jsx(ri,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(Ge.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),_.jsxs(Ge.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.5"}),_.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:_.jsx(Ji,{size:18,className:"text-white",strokeWidth:2.5})})]}),_.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>_.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&_.jsx(bK,{}),t==="functies"&&_.jsx(PK,{}),t==="handleiding"&&_.jsx(kK,{}),_.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:_.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.5 - Voor jou en je vismaat"})})]})]})]})})}function bK(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),_.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),_.jsxs("ul",{className:"space-y-2 text-gray-600",children:[_.jsxs("li",{children:[_.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),_.jsxs("li",{children:[_.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),_.jsxs("div",{className:"text-gray-600 space-y-2",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function PK(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(wy,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsxs("li",{children:[_.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(Ys,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Registreer soort, gewicht en lengte"}),_.jsx("li",{children:"Vismethode en aas bijhouden"}),_.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),_.jsx("li",{children:"GPS locatie per vangst"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(Al,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Markeer je beste visplekken"}),_.jsx("li",{children:"Voeg notities en ratings toe"}),_.jsx("li",{children:"Welke vis zit waar?"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(qd,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Live weergegevens op je locatie"}),_.jsx("li",{children:"Windsnelheid en richting"}),_.jsx("li",{children:"Luchtdruk"}),_.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(tu,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Live GPS tracking"}),_.jsx("li",{children:"Zoek adressen en plaatsen"}),_.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function kK(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),_.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[_.jsxs("li",{children:["Tik op de ",_.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),_.jsxs("li",{children:["Gebruik het ",_.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),_.jsxs("li",{children:["Tik op de ",_.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[_.jsxs("li",{children:["Gebruik de ",_.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),_.jsxs("li",{children:["Check de ",_.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),_.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),_.jsxs("li",{children:["Markeer succesvolle plekken als ",_.jsx("strong",{children:"favoriet"})]})]})]})]})}const NK=gl([5.1214,52.0907]),DK=8;function MK(){const n=Js(r=>r.map),e=Xo(r=>r.setLayerVisibility),t=Ei(r=>r.stopTracking),i=()=>{t(),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Labels Overlay",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:NK,zoom:DK,rotation:0,duration:500})};return _.jsx(Ge.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:_.jsx(UH,{size:18,className:"text-gray-600"})})}const LK={Map:wy,Fish:Ys,Anchor:ID,Layers:wm,Star:Tx},OK={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},FK={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function VK(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=J9(),[r,s]=q.useState(!1),[o,l]=q.useState(null),[u,h]=q.useState(!1),[f,p]=q.useState(""),y=T=>{e(T),s(!1)},x=(T,S)=>{T.stopPropagation();const{useLayerStore:b}=require("../../store"),D=b.getState().visible,N=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(L=>D[L]);t(S,{layers:N}),l(S),setTimeout(()=>l(null),2e3)},I=()=>{f.trim()&&(i(f.trim()),p(""),h(!1))};return _.jsxs(_.Fragment,{children:[_.jsx(Ge.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?_.jsx(CD,{size:20,className:"text-blue-600"}):_.jsx(wm,{size:20,className:"text-gray-600"})}),_.jsx(ri,{children:r&&_.jsxs(_.Fragment,{children:[_.jsx(Ge.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),_.jsxs(Ge.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[_.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),_.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(T=>{const S=LK[T.icon]||wm,b=OK[T.icon]||"text-blue-600",D=FK[T.icon]||"hover:bg-blue-50",N=o===T.id;return _.jsxs("button",{onClick:()=>y(T.id),className:`w-full h-9 flex items-center gap-2 px-2 ${D} rounded text-left transition-colors border-0 outline-none bg-transparent ${N?"bg-green-50":""}`,children:[_.jsx(S,{size:16,className:`${b} flex-shrink-0`}),_.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:T.name}),N?_.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:_.jsx(Ex,{size:14,className:"text-green-500"})}):_.jsx("span",{onClick:L=>x(L,T.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:_.jsx(WH,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},T.id)})}),_.jsx("div",{className:"border-t border-gray-200 p-2",children:u?_.jsxs("div",{className:"flex gap-1",children:[_.jsx("input",{type:"text",value:f,onChange:T=>p(T.target.value),onKeyDown:T=>{T.key==="Enter"&&I(),T.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400"}),_.jsx("button",{onClick:I,disabled:!f.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):_.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",children:[_.jsx(FH,{size:14}),_.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const iv={lat:52.1326,lng:5.2913},jK={0:"Helder",1:"Overwegend helder",2:"Halfbewolkt",3:"Bewolkt",45:"Mist",48:"Rijpmist",51:"Lichte motregen",53:"Motregen",55:"Zware motregen",61:"Lichte regen",63:"Regen",65:"Zware regen",71:"Lichte sneeuw",73:"Sneeuw",75:"Zware sneeuw",80:"Lichte buien",81:"Buien",82:"Zware buien",95:"Onweer",96:"Onweer met hagel",99:"Zwaar onweer"};function LD({code:n,size:e=18}){return n===0?_.jsx(nK,{size:e,className:"text-yellow-500"}):n>=1&&n<=3?_.jsx(qd,{size:e,className:"text-gray-400"}):n===45||n===48?_.jsx(Y$,{size:e,className:"text-gray-400"}):n>=51&&n<=67||n>=80&&n<=82?_.jsx(RD,{size:e,className:"text-blue-500"}):n>=71&&n<=77||n>=85&&n<=86?_.jsx(tH,{size:e,className:"text-cyan-500"}):n>=95?_.jsx(Q$,{size:e,className:"text-purple-500"}):_.jsx(qd,{size:e,className:"text-gray-400"})}function UK({degrees:n,size:e=14}){return _.jsx("div",{style:{transform:`rotate(${n+180}deg)`},className:"inline-flex",children:_.jsx(tu,{size:e,className:"text-blue-500"})})}function zK({size:n=16,className:e=""}){return _.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[_.jsx("path",{d:"M3 12h18"}),_.jsx("path",{d:"M21 12c-1.5 0-3-1-3-3s1.5-3 3-3"}),_.jsx("path",{d:"M21 12c-1.5 0-3 1-3 3s1.5 3 3 3"}),_.jsx("circle",{cx:"4",cy:"12",r:"1.5",fill:"currentColor"}),_.jsx("path",{d:"M8 12l2-3"}),_.jsx("path",{d:"M8 12l2 3"}),_.jsx("path",{d:"M12 12l2-3"}),_.jsx("path",{d:"M12 12l2 3"}),_.jsx("path",{d:"M16 12l1.5-2"}),_.jsx("path",{d:"M16 12l1.5 2"})]})}function NA({size:n=16,className:e="",clipPercent:t=100}){const i=`fish-clip-${Math.random().toString(36).substr(2,9)}`;return _.jsxs("svg",{width:n*(t/100),height:n,viewBox:`0 0 ${24*(t/100)} 24`,fill:"currentColor",className:e,style:{overflow:"hidden"},children:[_.jsx("defs",{children:_.jsx("clipPath",{id:i,children:_.jsx("rect",{x:"0",y:"0",width:24*(t/100),height:"24"})})}),_.jsxs("g",{clipPath:`url(#${i})`,children:[_.jsx("path",{d:"M6.5 12c0-3.5 3-6 7-6 2.5 0 4.5 1 6 2.5.8.8 1.5 1.8 2 3-.5 1.2-1.2 2.2-2 3-1.5 1.5-3.5 2.5-6 2.5-4 0-7-2.5-7-5z"}),_.jsx("path",{d:"M2.5 12l3-3v6l-3-3z"}),_.jsx("circle",{cx:"17",cy:"11",r:"1",fill:"white"})]})]})}function BK({value:n,maxFish:e=3,color:t}){const i=Math.floor(n),r=n%1>=.5,s=[];for(let o=0;o<i&&o<e;o++)s.push(_.jsx(NA,{size:16,className:t},o));return r&&i<e&&s.push(_.jsx(NA,{size:16,className:t,clipPercent:50},"half")),_.jsx("div",{className:"flex items-center gap-0.5",children:s.length>0?s:_.jsx(zK,{size:16,className:t})})}function gd(n){const e=29.53058867,t=new Date("2000-01-06T18:14:00Z");return(n.getTime()-t.getTime())/(1e3*60*60*24)%e/e}function OD(n){return n<.03||n>.97?"Nieuwe maan":n<.22?"Wassende sikkel":n<.28?"Eerste kwartier":n<.47?"Wassende maan":n<.53?"Volle maan":n<.72?"Afnemende maan":n<.78?"Laatste kwartier":"Afnemende sikkel"}function FD({phase:n,size:e=20}){const t=n<.5?(.5-n)*2:(n-.5)*2,i=n<.5;return _.jsxs("div",{className:"relative rounded-full overflow-hidden",style:{width:e,height:e,background:"linear-gradient(145deg, #f5f5dc 0%, #e8e4c9 50%, #d4d0b8 100%)",boxShadow:`inset 0 0 ${e*.1}px rgba(0,0,0,0.1), 0 ${e*.05}px ${e*.1}px rgba(0,0,0,0.2)`},children:[_.jsx("div",{className:"absolute inset-0 rounded-full opacity-30",style:{background:"radial-gradient(circle at 30% 30%, transparent 0%, rgba(139,119,101,0.3) 100%)"}}),_.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:i?`linear-gradient(to left, transparent ${(1-t)*100}%, rgba(20,20,30,0.95) ${(1-t)*100+15}%)`:`linear-gradient(to right, transparent ${(1-t)*100}%, rgba(20,20,30,0.95) ${(1-t)*100+15}%)`}})]})}function GK(n){const e=gd(n),t=n.getHours(),i=Math.floor((e*24+12)%24),r=(i+6)%24,s=(i+18)%24,o=(i+12)%24,l=[i,o],u=[r,s];let h=.3;return(e<.1||e>.9||e>.4&&e<.6)&&(h+=.3),l.forEach(f=>{const p=Math.abs(t-f);p<=1||p>=23?h+=.3:(p<=2||p>=22)&&(h+=.15)}),u.forEach(f=>{Math.abs(t-f)<=1&&(h-=.1)}),{activity:Math.max(.1,Math.min(1,h)),besteTijden:l,slechteTijden:u}}function VD(n){return n<.1||n>.9||n>.4&&n<.6?{type:"Springtij",color:"text-green-600"}:n>.2&&n<.3||n>.7&&n<.8?{type:"Doodtij",color:"text-orange-600"}:{type:"Normaal",color:"text-blue-600"}}function jD(n,e){const t=[],i=29.53058867,r=new Date("2000-01-06T18:14:00Z"),s=745;for(let o=0;o<e;o++){const l=new Date(n);l.setDate(l.getDate()+o),l.setHours(0,0,0,0);const h=(l.getTime()-r.getTime())/(1e3*60*60*24)%i/i;let f=h*s*2%1440;for(let p=0;p<4;p++){const y=p%2===0,x=p*(s/2);let I=f+x;const T=Math.floor(I/1440);I=I%1440;const S=Math.floor(I/60),b=Math.floor(I%60),D=new Date(l);D.setDate(D.getDate()+T),D.setHours(S,b,0,0);const N=Math.abs(Math.sin(h*Math.PI*2)),L=y?1.8:.4,F=N*.5;t.push({time:D,height:y?L+F:L-F*.5,type:y?"high":"low"})}}return t.sort((o,l)=>o.time.getTime()-l.time.getTime())}function WK({data:n,showHeader:e=!1}){if(!n||n.length===0)return null;const t=Math.max(...n.map(s=>s.precipitation),.5),i=n.some(s=>s.precipitation>0),r=s=>{const o=new Date(s);return`${o.getHours()}:${o.getMinutes().toString().padStart(2,"0")}`};return _.jsxs("div",{className:"space-y-1",children:[e&&_.jsx("div",{className:"flex items-center justify-between",children:_.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag komende 2 uur"})}),!i&&_.jsx("div",{className:"text-[10px] text-green-600 font-medium text-right",children:"Droog"}),_.jsxs("div",{className:"relative h-10 bg-gray-100 rounded-lg overflow-hidden",children:[_.jsx("div",{className:"absolute inset-0 flex",children:[...Array(8)].map((s,o)=>_.jsx("div",{className:"flex-1 border-r border-gray-200/50"},o))}),_.jsx("div",{className:"absolute inset-0 flex items-end px-0.5",children:n.map((s,o)=>{const l=s.precipitation/t*100,u=s.precipitation>2?"bg-blue-600":s.precipitation>.5?"bg-blue-500":s.precipitation>0?"bg-blue-400":"bg-transparent";return _.jsx("div",{className:"flex-1 mx-px",title:`${r(s.time)}: ${s.precipitation.toFixed(1)} mm`,children:_.jsx("div",{className:`w-full rounded-t transition-all ${u}`,style:{height:`${Math.max(l,s.precipitation>0?8:0)}%`}})},o)})}),_.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-1 text-[8px] text-gray-400",children:[_.jsx("span",{children:"Nu"}),_.jsx("span",{children:"+1u"}),_.jsx("span",{children:"+2u"})]})]}),i&&_.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-gray-500",children:[_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-400"}),_.jsx("span",{children:"Licht"})]}),_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-500"}),_.jsx("span",{children:"Matig"})]}),_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-600"}),_.jsx("span",{children:"Zwaar"})]})]})]})}function $K({hourly:n}){const e=new Date,t=e.getHours(),i=n.filter(r=>new Date(r.time)>=e).slice(0,8);return i.length===0?null:_.jsxs("div",{className:"space-y-1",children:[_.jsx("div",{className:"text-[10px] text-gray-500",children:"Komende uren"}),_.jsx("div",{className:"flex gap-1 overflow-x-auto py-1 -mx-1 px-1",children:i.map((r,s)=>{const o=new Date(r.time),l=o.getHours()===t;return _.jsxs("div",{className:`flex flex-col items-center p-1.5 rounded-lg min-w-[36px] ${l?"bg-blue-100":"bg-gray-50"}`,children:[_.jsx("span",{className:"text-[9px] text-gray-500",children:l?"Nu":`${o.getHours()}:00`}),_.jsx(LD,{code:r.weatherCode,size:14}),_.jsxs("span",{className:"text-[10px] font-medium",children:[Math.round(r.temperature),""]}),r.precipitationProbability>20&&_.jsxs("span",{className:"text-[8px] text-blue-500",children:[r.precipitationProbability,"%"]})]},r.time)})})]})}function HK({hourlyData:n,onClose:e}){const[t,i]=q.useState(new Date),r=new Date,s=q.useMemo(()=>{const T=new Date(r);return T.setHours(T.getHours(),0,0,0),T},[]),o=q.useMemo(()=>{const T=new Date(s);return T.setHours(T.getHours()+48),T},[s]),l=o.getTime()-s.getTime(),u=(t.getTime()-s.getTime())/l*100,h=n.filter(T=>{const S=new Date(T.time);return S>=s&&S<=o}),f=T=>{const S=new Date;S.setHours(0,0,0,0);const b=new Date(T);b.setHours(0,0,0,0);const D=Math.floor((b.getTime()-S.getTime())/(1440*60*1e3));return D===0?"Vandaag":D===1?"Morgen":D===2?"Overmorgen":T.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},p=T=>`${T.getHours().toString().padStart(2,"0")}:00`,y=h.find(T=>{const S=new Date(T.time);return S.getHours()===t.getHours()&&S.getDate()===t.getDate()}),x=Math.max(...h.map(T=>T.precipitation),1),I=h.some(T=>T.precipitation>0);return _.jsx(Ge.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:_.jsx(Ge.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:T=>T.stopPropagation(),children:_.jsxs("div",{className:"p-4 space-y-3",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(RD,{size:20,className:"text-blue-500"}),_.jsx("span",{className:"font-semibold text-gray-800",children:"Neerslag 48 uur"}),!I&&_.jsx("span",{className:"text-xs text-green-600 font-medium bg-green-50 px-2 py-0.5 rounded-full",children:"Droog"})]}),_.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:16,className:"text-gray-500"})})]}),_.jsxs("div",{className:"bg-blue-50 rounded-xl p-3 flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("div",{className:"text-xs text-gray-500",children:f(t)}),_.jsx("div",{className:"text-xl font-bold text-blue-600",children:p(t)})]}),_.jsxs("div",{className:"text-right",children:[_.jsx("div",{className:"text-2xl font-bold text-blue-600",children:y?`${y.precipitation.toFixed(1)} mm`:"0 mm"}),y&&y.precipitationProbability>0&&_.jsxs("div",{className:"text-xs text-blue-500",children:[y.precipitationProbability,"% kans"]})]})]}),_.jsxs("div",{className:"relative bg-gray-100 rounded-xl p-2 h-24",children:[_.jsx("div",{className:"absolute inset-2 flex items-end gap-px",children:h.map((T,S)=>{const b=T.precipitation/x*100,D=new Date(T.time),N=D.getHours()===t.getHours()&&D.getDate()===t.getDate(),L=T.precipitation>2?"bg-blue-600":T.precipitation>.5?"bg-blue-500":T.precipitation>0?"bg-blue-400":"bg-gray-200";return _.jsx("div",{className:"flex-1 cursor-pointer h-full flex flex-col justify-end",onClick:()=>i(D),children:_.jsx("div",{className:`w-full rounded-t transition-all ${L} ${N?"ring-2 ring-amber-400 ring-offset-1":""}`,style:{height:`${Math.max(b,T.precipitation>0?8:3)}%`}})},S)})}),_.jsxs("div",{className:"absolute bottom-0.5 left-2 right-2 flex justify-between text-[8px] text-gray-400",children:[_.jsx("span",{children:"Nu"}),_.jsx("span",{children:"+24u"}),_.jsx("span",{children:"+48u"})]})]}),_.jsx("input",{type:"range",min:"0",max:"100",value:u,onChange:T=>i(new Date(s.getTime()+parseFloat(T.target.value)/100*l)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("button",{onClick:()=>i(new Date),className:"flex-1 px-3 py-2 text-sm bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-xl transition-colors border-0 outline-none font-medium",children:"Nu"}),_.jsx("button",{onClick:()=>{const T=new Date;T.setDate(T.getDate()+1),T.setHours(8,0,0,0),i(T)},className:"flex-1 px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors border-0 outline-none",children:"Morgen 8:00"}),_.jsx("button",{onClick:()=>{const T=new Date;T.setDate(T.getDate()+1),T.setHours(18,0,0,0),i(T)},className:"flex-1 px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors border-0 outline-none",children:"Morgen 18:00"})]}),_.jsxs("div",{className:"flex items-center justify-center gap-4 text-[10px] text-gray-400",children:[_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-400"}),_.jsx("span",{children:"Licht"})]}),_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-500"}),_.jsx("span",{children:"Matig"})]}),_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-600"}),_.jsx("span",{children:"Zwaar"})]})]})]})})})}function KK({onClose:n}){const[e,t]=q.useState(0),i=q.useMemo(()=>{const l=new Date;return l.setDate(l.getDate()+e),l},[e]),r=gd(i),s=l=>{if(l===0)return"Vandaag";if(l===1)return"Morgen";if(l===-1)return"Gisteren";const u=new Date;return u.setDate(u.getDate()+l),u.toLocaleDateString("nl-NL",{weekday:"long",day:"numeric",month:"long"})},o=VD(r);return _.jsx(Ge.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsx(Ge.div,{className:"bg-gradient-to-b from-slate-800 to-slate-900 rounded-2xl shadow-2xl w-full max-w-xs overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:l=>l.stopPropagation(),children:_.jsxs("div",{className:"p-5 space-y-4",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(NH,{size:18,className:"text-slate-400"}),_.jsx("span",{className:"font-semibold text-white",children:"Maanstand"})]}),_.jsx("button",{onClick:n,className:"p-2 hover:bg-white/10 rounded-full transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:16,className:"text-slate-400"})})]}),_.jsxs("div",{className:"flex flex-col items-center py-4",children:[_.jsx(FD,{phase:r,size:120}),_.jsxs("div",{className:"mt-4 text-center",children:[_.jsx("div",{className:"text-xl font-semibold text-white",children:OD(r)}),_.jsxs("div",{className:"text-slate-400 text-sm",children:[Math.round(r*100),"% verlicht"]}),_.jsx("div",{className:`text-sm font-medium mt-1 ${o.color}`,children:o.type})]})]}),_.jsx("div",{className:"text-center text-slate-300 text-sm",children:s(e)}),_.jsxs("div",{className:"space-y-2",children:[_.jsx("input",{type:"range",min:"-14",max:"14",value:e,onChange:l=>t(parseInt(l.target.value)),className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-amber-400"}),_.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[_.jsx("span",{children:"-14 dagen"}),_.jsx("span",{children:"Nu"}),_.jsx("span",{children:"+14 dagen"})]})]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("button",{onClick:()=>t(0),className:"flex-1 px-3 py-2 text-sm bg-slate-700 hover:bg-slate-600 text-white rounded-xl transition-colors border-0 outline-none",children:"Vandaag"}),_.jsx("button",{onClick:()=>{for(let l=1;l<=30;l++){const u=new Date;u.setDate(u.getDate()+l);const h=gd(u);if(h<.03||h>.97){t(l);break}}},className:"flex-1 px-3 py-2 text-sm bg-slate-700 hover:bg-slate-600 text-white rounded-xl transition-colors border-0 outline-none",children:"Nieuwe maan"}),_.jsx("button",{onClick:()=>{for(let l=1;l<=30;l++){const u=new Date;u.setDate(u.getDate()+l);const h=gd(u);if(h>.47&&h<.53){t(l);break}}},className:"flex-1 px-3 py-2 text-sm bg-slate-700 hover:bg-slate-600 text-white rounded-xl transition-colors border-0 outline-none",children:"Volle maan"})]}),_.jsx("div",{className:"text-[10px] text-slate-500 text-center",children:"Springtij: nieuwe/volle maan (sterk getij)"})]})})})}function qK({onClose:n}){const[e,t]=q.useState(new Date),i=Ei(R=>R.position),r=[{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12},{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664}],s=(R,P)=>{let V=r[5],j=1/0;for(const B of r){const M=Math.sqrt(Math.pow(B.lat-R,2)+Math.pow(B.lng-P,2));M<j&&(j=M,V=B)}return V},[o,l]=q.useState(()=>i?s(i.lat,i.lng):r[5]),u=new Date,h=q.useMemo(()=>{const R=new Date;return R.setDate(R.getDate()-1),R.setHours(0,0,0,0),R},[]),f=q.useMemo(()=>{const R=new Date;return R.setDate(R.getDate()+2),R.setHours(23,59,59,999),R},[]),p=q.useMemo(()=>{const R=new Date(h);return jD(R,4)},[h]),y=f.getTime()-h.getTime(),x=(e.getTime()-h.getTime())/y*100,I=R=>{if(p.length<2)return 1;let P=p[0],V=p[1];for(let he=0;he<p.length-1;he++)if(p[he].time<=R&&p[he+1].time>R){P=p[he],V=p[he+1];break}const j=V.time.getTime()-P.time.getTime(),B=R.getTime()-P.time.getTime(),M=Math.max(0,Math.min(1,B/j)),se=(1-Math.cos(M*Math.PI))/2;return P.height+(V.height-P.height)*se},T=q.useMemo(()=>{const R=[];for(let V=0;V<=200;V++){const j=new Date(h.getTime()+V/200*y),B=I(j);R.push({x:V/200*100,y:B,time:j})}return R},[h,y,p]),S=Math.min(...T.map(R=>R.y)),D=Math.max(...T.map(R=>R.y))-S||1,N=R=>{const P=new Date;P.setHours(0,0,0,0);const V=new Date(R);V.setHours(0,0,0,0);const j=Math.floor((V.getTime()-P.getTime())/(1440*60*1e3));return j===0?"Vandaag":j===1?"Morgen":j===-1?"Gisteren":R.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},L=R=>R.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"}),F=I(e),G=(u.getTime()-h.getTime())/y*100,k=(e.getTime()-h.getTime())/y*100;return _.jsx(Ge.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsx(Ge.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-md overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:R=>R.stopPropagation(),children:_.jsxs("div",{className:"p-4 space-y-3",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Xd,{size:20,className:"text-blue-500"}),_.jsx("span",{className:"font-semibold text-gray-800",children:"Getijden"})]}),_.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:16,className:"text-gray-500"})})]}),_.jsx("select",{value:o.id,onChange:R=>{const P=r.find(V=>V.id===R.target.value);P&&l(P)},className:"w-full p-2.5 border border-gray-200 rounded-xl text-sm bg-white/80 outline-none focus:ring-2 focus:ring-blue-400",children:r.map(R=>_.jsx("option",{value:R.id,children:R.name},R.id))}),_.jsxs("div",{className:"relative bg-gradient-to-b from-blue-50 to-blue-100 rounded-xl p-3 h-32",children:[_.jsxs("svg",{className:"absolute inset-3 w-[calc(100%-24px)] h-[calc(100%-24px)]",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[_.jsx("path",{d:`M 0 100 ${T.map(R=>`L ${R.x} ${100-(R.y-S)/D*80}`).join(" ")} L 100 100 Z`,fill:"url(#waterGradient)",opacity:"0.6"}),_.jsx("path",{d:`M ${T.map(R=>`${R.x} ${100-(R.y-S)/D*80}`).join(" L ")}`,fill:"none",stroke:"#3b82f6",strokeWidth:"1.5"}),G>=0&&G<=100&&_.jsx("line",{x1:G,y1:"0",x2:G,y2:"100",stroke:"#f59e0b",strokeWidth:"1",strokeDasharray:"3,3"}),_.jsx("line",{x1:k,y1:"0",x2:k,y2:"100",stroke:"#ef4444",strokeWidth:"1.5"}),_.jsx("circle",{cx:k,cy:100-(F-S)/D*80,r:"3",fill:"#ef4444"}),_.jsx("defs",{children:_.jsxs("linearGradient",{id:"waterGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[_.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),_.jsx("stop",{offset:"100%",stopColor:"#93c5fd"})]})})]}),_.jsxs("div",{className:"absolute bottom-1 left-3 right-3 flex justify-between text-[9px] text-gray-500",children:[_.jsx("span",{children:N(h)}),_.jsx("span",{children:N(u)}),_.jsx("span",{children:N(f)})]}),_.jsxs("div",{className:"absolute top-2 right-3 bg-white/90 rounded-lg px-2 py-1 shadow-sm",children:[_.jsxs("div",{className:"text-[10px] text-gray-500",children:[N(e)," ",L(e)]}),_.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[F.toFixed(2),"m"]})]})]}),_.jsx("input",{type:"range",min:"0",max:"100",value:x,onChange:R=>{const P=new Date(h.getTime()+parseFloat(R.target.value)/100*y);t(P)},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("button",{onClick:()=>t(new Date),className:"flex-1 px-3 py-2 text-sm bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-xl transition-colors border-0 outline-none font-medium",children:"Nu"}),p.filter(R=>R.time>u).slice(0,2).map((R,P)=>_.jsxs("button",{onClick:()=>t(R.time),className:`flex-1 px-2 py-2 text-sm rounded-xl transition-colors border-0 outline-none font-medium ${R.type==="high"?"bg-green-50 hover:bg-green-100 text-green-600":"bg-red-50 hover:bg-red-100 text-red-600"}`,children:[R.type==="high"?"HW":"LW"," ",L(R.time)]},P))]}),_.jsx("div",{className:"text-[10px] text-gray-400 text-center",children:"Berekening op basis van maanstand"})]})})})}function XK({onClose:n}){const{waterData:e,station:t,fetchData:i,setStation:r,isLoading:s}=TD(),o=u=>u<8?"text-blue-600":u<14?"text-cyan-500":u<18?"text-green-500":"text-orange-500",l=u=>u<30?"Kalm":u<60?"Licht":u<100?"Matig":u<150?"Ruw":"Hoog";return _.jsx(Ge.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsx(Ge.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:u=>u.stopPropagation(),children:_.jsxs("div",{className:"p-4 space-y-4",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(rH,{size:20,className:"text-cyan-500"}),_.jsx("span",{className:"font-semibold text-gray-800",children:"Waterdata"})]}),_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx("button",{onClick:()=>i(),className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",disabled:s,children:_.jsx(PD,{size:16,className:`text-gray-500 ${s?"animate-spin":""}`})}),_.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:16,className:"text-gray-500"})})]})]}),_.jsx("select",{value:t?.id||"",onChange:u=>{const h=Kd.find(f=>f.id===u.target.value);h&&r(h)},className:"w-full p-2.5 border border-gray-200 rounded-xl text-sm bg-white/80 outline-none focus:ring-2 focus:ring-cyan-400",children:Kd.map(u=>_.jsx("option",{value:u.id,children:u.name},u.id))}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-3",children:[_.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[_.jsx(kD,{size:14,className:"text-cyan-500"}),_.jsx("span",{className:"text-[10px] text-gray-500",children:"Water"})]}),e?.temperature!==void 0?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:`text-xl font-bold ${o(e.temperature)}`,children:[e.temperature.toFixed(1),"C"]}),_.jsx("div",{className:"text-[9px] text-gray-400 mt-0.5",children:e.temperature<10?"Koud":e.temperature<15?"Roofvis":"Warm"})]}):_.jsx("div",{className:"text-gray-400 text-lg",children:"-"})]}),_.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-3",children:[_.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[_.jsx(Xd,{size:14,className:"text-blue-500"}),_.jsx("span",{className:"text-[10px] text-gray-500",children:"Golven"})]}),e?.waveHeight!==void 0?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"text-xl font-bold text-blue-600",children:[e.waveHeight," cm"]}),_.jsx("div",{className:"text-[9px] text-gray-400 mt-0.5",children:l(e.waveHeight)})]}):_.jsx("div",{className:"text-gray-400 text-lg",children:"-"})]}),_.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-3",children:[_.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[_.jsx(tu,{size:14,className:"text-green-500"}),_.jsx("span",{className:"text-[10px] text-gray-500",children:"Stroming"})]}),e?.currentSpeed!==void 0?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"text-xl font-bold text-green-600",children:[e.currentSpeed," cm/s"]}),_.jsx("div",{className:"text-[9px] text-gray-400 mt-0.5",children:e.currentSpeed<20?"Zwak":e.currentSpeed<50?"Matig":"Sterk"})]}):_.jsx("div",{className:"text-gray-400 text-lg",children:"-"})]}),_.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-3",children:[_.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[_.jsx(tu,{size:14,className:"text-purple-500"}),_.jsx("span",{className:"text-[10px] text-gray-500",children:"Richting"})]}),e?.currentDirection!==void 0?_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("div",{style:{transform:`rotate(${e.currentDirection}deg)`},children:_.jsx(tu,{size:20,className:"text-purple-500",fill:"currentColor"})}),_.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[Math.round(e.currentDirection),""]})]}):_.jsx("div",{className:"text-gray-400 text-lg",children:"-"})]})]}),_.jsx("div",{className:"text-[10px] text-gray-400 text-center pt-1",children:"Bron: Rijkswaterstaat"})]})})})}function YK(){const{current:n,loading:e,fetchWeather:t,getFishingScore:i,pressureHistory:r,getPressureTrend:s,hourlyForecast:o,precipitation15min:l}=UP(),u=Ei(U=>U.position),h=ln(U=>U.showWeatherWidget),{waterData:f,station:p,fetchData:y}=TD(),[x,I]=q.useState(!1),[T,S]=q.useState(!1),[b,D]=q.useState(!1),[N,L]=q.useState(!1),[F,G]=q.useState(!1),k={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};q.useEffect(()=>{const U=u||iv;t(U.lat,U.lng),y()},[]),q.useEffect(()=>{u&&t(u.lat,u.lng)},[u,t]),q.useEffect(()=>{const U=u||iv,$=setInterval(()=>{t(U.lat,U.lng),y()},600*1e3);return()=>clearInterval($)},[u,t,y]);const R=new Date,P=gd(R),V=GK(R),j=VD(P),M=q.useMemo(()=>{const U=new Date;return U.setHours(0,0,0,0),jD(U,2)},[]).filter(U=>U.time>R).slice(0,4),se=i?i():1,he=Math.min(3,se/2+V.activity*1.5),ge=U=>U>=2.5?"text-green-500":U>=1.5?"text-lime-500":U>=.8?"text-amber-500":"text-red-500",ue=U=>U>=2.5?"bg-green-50 border-green-200":U>=1.5?"bg-lime-50 border-lime-200":U>=.8?"bg-amber-50 border-amber-200":"bg-red-50 border-red-200",Q=U=>U>=2.5?"Uitstekend":U>=1.5?"Goed":U>=.8?"Matig":"Slecht",re=U=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(U/45)%8],ne=U=>U.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return h?_.jsxs(Ge.div,{className:`fixed left-2 z-[700] backdrop-blur-sm rounded-xl shadow-sm border transition-all select-none ${ue(he)}`,style:k,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[e&&!n?_.jsxs("div",{className:"p-3 flex items-center gap-2",children:[_.jsx(PD,{size:16,className:"animate-spin text-blue-500"}),_.jsx("span",{className:"text-sm text-gray-500",children:"Laden..."})]}):n?_.jsxs("div",{className:"p-2.5 min-w-[160px]",children:[_.jsxs("button",{onClick:()=>I(!x),className:"w-full border-0 outline-none bg-transparent p-0",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(LD,{code:n.weatherCode,size:24}),_.jsx("div",{className:"flex flex-col leading-tight",children:_.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[Math.round(n.temperature),""]})})]}),_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx(bA,{size:14,className:"text-gray-400"}),_.jsx("span",{className:"text-sm text-gray-600",children:Math.round(n.windSpeed)}),_.jsx(UK,{degrees:n.windDirection,size:12})]}),_.jsx("div",{className:"ml-auto",children:x?_.jsx(CD,{size:16,className:"text-gray-400"}):_.jsx(H$,{size:16,className:"text-gray-400"})})]}),_.jsxs("div",{className:"flex items-center gap-2 mt-1.5 pt-1.5 border-t border-gray-200/50",children:[_.jsx(BK,{value:he,color:ge(he)}),_.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:_.jsx("div",{className:`h-full transition-all ${he>=2.5?"bg-green-500":he>=1.5?"bg-lime-500":he>=.8?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.max(he/3*100,5)}%`}})}),_.jsx("span",{className:`text-[10px] font-medium ${ge(he)}`,children:Q(he)})]})]}),_.jsx(ri,{children:x&&_.jsx(Ge.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:_.jsxs("div",{className:"pt-3 mt-2 border-t border-gray-200/50 space-y-3",children:[_.jsx("div",{className:"text-xs text-gray-600",children:jK[n.weatherCode]||"Onbekend"}),_.jsxs("button",{onClick:()=>G(!0),className:"w-full bg-slate-800 hover:bg-slate-700 rounded-lg p-3 flex items-center gap-3 border-0 outline-none cursor-pointer transition-colors",children:[_.jsx(FD,{phase:P,size:36}),_.jsxs("div",{className:"flex-1 text-left",children:[_.jsx("div",{className:"text-white text-sm font-medium",children:OD(P)}),_.jsxs("div",{className:"text-slate-400 text-[10px]",children:[Math.round(P*100),"% verlicht"]}),_.jsx("div",{className:`text-[10px] font-medium ${j.color}`,children:j.type})]}),_.jsx(Vh,{size:14,className:"text-slate-400"})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[_.jsx("span",{className:"text-gray-500",children:"Maanactiviteit"}),_.jsxs("span",{className:"text-gray-600",children:[Math.round(V.activity*100),"%"]})]}),_.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:_.jsx("div",{className:`h-full transition-all ${V.activity>=.7?"bg-green-500":V.activity>=.5?"bg-lime-500":V.activity>=.3?"bg-amber-500":"bg-red-400"}`,style:{width:`${V.activity*100}%`}})})]}),f&&_.jsxs("button",{onClick:()=>D(!0),className:"w-full grid grid-cols-2 gap-2 border-0 bg-transparent p-0 cursor-pointer",children:[f.temperature!==void 0&&_.jsxs("div",{className:"bg-cyan-50 rounded-lg p-2 hover:bg-cyan-100 transition-colors",children:[_.jsxs("div",{className:"flex items-center justify-between text-[10px] text-gray-500",children:[_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx(kD,{size:12,className:"text-cyan-500"}),_.jsx("span",{children:"Water"})]}),_.jsx(Vh,{size:10,className:"text-gray-400"})]}),_.jsxs("div",{className:"text-sm font-bold text-cyan-600 text-left",children:[f.temperature.toFixed(1),"C"]})]}),f.waveHeight!==void 0&&_.jsxs("div",{className:"bg-blue-50 rounded-lg p-2 hover:bg-blue-100 transition-colors",children:[_.jsxs("div",{className:"flex items-center justify-between text-[10px] text-gray-500",children:[_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx(Xd,{size:12,className:"text-blue-500"}),_.jsx("span",{children:"Golven"})]}),_.jsx(Vh,{size:10,className:"text-gray-400"})]}),_.jsxs("div",{className:"text-sm font-bold text-blue-600 text-left",children:[f.waveHeight," cm"]})]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[_.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600",children:[_.jsx(bA,{size:12,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",re(n.windDirection)]})]}),_.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600",children:[_.jsx(G$,{size:12,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.pressure)," hPa"]}),(()=>{const U=s();return U==="rising"?_.jsx(cK,{size:12,className:"text-green-500"}):U==="falling"?_.jsx(aK,{size:12,className:"text-red-500"}):_.jsx(PH,{size:12,className:"text-gray-400"})})()]})]}),l.length>0&&_.jsx("button",{onClick:()=>L(!0),className:"w-full border-0 bg-transparent p-0 cursor-pointer text-left",children:_.jsxs("div",{className:"hover:bg-gray-50 rounded-lg p-1 -m-1 transition-colors",children:[_.jsxs("div",{className:"flex items-center justify-between mb-1",children:[_.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag komende 2 uur"}),_.jsx(Vh,{size:12,className:"text-gray-400"})]}),_.jsx(WK,{data:l})]})}),o.length>0&&_.jsx($K,{hourly:o}),M.length>0&&_.jsx("button",{onClick:()=>S(!0),className:"w-full border-0 bg-transparent p-0 cursor-pointer text-left",children:_.jsxs("div",{className:"space-y-1 hover:bg-gray-50 rounded-lg p-1 -m-1 transition-colors",children:[_.jsxs("div",{className:"text-[10px] text-gray-500 flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx(Xd,{size:12}),_.jsx("span",{children:"Volgende getijden"})]}),_.jsx(Vh,{size:12,className:"text-gray-400"})]}),_.jsx("div",{className:"flex gap-1",children:M.map((U,$)=>_.jsxs("div",{className:`flex-1 p-1.5 rounded text-center ${U.type==="high"?"bg-green-50":"bg-red-50"}`,children:[_.jsx("div",{className:`text-[9px] font-medium ${U.type==="high"?"text-green-600":"text-red-600"}`,children:U.type==="high"?"HW":"LW"}),_.jsx("div",{className:"text-[10px] font-medium",children:ne(U.time)})]},$))})]})}),p&&_.jsxs("div",{className:"text-[9px] text-gray-400 text-center",children:["Waterdata: ",p.name]})]})})})]}):_.jsxs("button",{onClick:()=>{const U=u||iv;t(U.lat,U.lng)},className:"p-3 flex items-center gap-2 border-0 outline-none bg-transparent",children:[_.jsx(qd,{size:18,className:"text-gray-400"}),_.jsx("span",{className:"text-sm text-gray-500",children:"Weer laden"})]}),_.jsx(ri,{children:T&&_.jsx(qK,{onClose:()=>S(!1)})}),_.jsx(ri,{children:b&&_.jsx(XK,{onClose:()=>D(!1)})}),_.jsx(ri,{children:N&&o.length>0&&_.jsx(HK,{hourlyData:o,onClose:()=>L(!1)})}),_.jsx(ri,{children:F&&_.jsx(KK,{onClose:()=>G(!1)})})]}):null}const Em=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],ZK=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],QK=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],rv=5;function JK({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=q.useRef(null),s=q.useRef(null),o=async u=>{const h=u.target.files;if(!h||h.length===0)return;const f=rv-n.length,p=Array.from(h).slice(0,f);for(const y of p)try{const{thumbnailBase64:x}=await DD(y),I={id:MD(),thumbnailBase64:x,createdAt:new Date().toISOString(),pendingUpload:!0};e(I)}catch(x){console.error("Failed to process image:",x)}u.target.value=""},l=n.length<rv;return _.jsxs("div",{className:"space-y-2",children:[_.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",rv,")"]}),_.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(u=>_.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[_.jsx("img",{src:u.thumbnailUrl||u.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&_.jsx("button",{type:"button",onClick:()=>t(u.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:_.jsx(Ji,{size:12,className:"text-white"})}),u.pendingUpload&&_.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},u.id)),l&&!i&&_.jsxs(_.Fragment,{children:[_.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[_.jsx(Mw,{size:20,className:"text-gray-400"}),_.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),_.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[_.jsx(gH,{size:20,className:"text-gray-400"}),_.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),_.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),_.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}const eq={Snoek:{colors:["green","yellow","spotted"],pattern:"elongated with spots"},Snoekbaars:{colors:["gray","silver","striped"],pattern:"elongated with stripes"},Baars:{colors:["green","black","striped","red-fins"],pattern:"oval with stripes"},Karper:{colors:["brown","gold","orange"],pattern:"large oval"},Brasem:{colors:["silver","bronze"],pattern:"flat oval"},Voorn:{colors:["silver","red-fins"],pattern:"small oval"},Zeelt:{colors:["green","brown","slimy"],pattern:"elongated"},Meerval:{colors:["dark","brown","black"],pattern:"large with whiskers"},Aal:{colors:["dark","silver-belly"],pattern:"snake-like"},Forel:{colors:["spotted","pink","silver"],pattern:"streamlined with spots"}};async function tq(n){return new Promise(e=>{const t=new Image;t.onload=()=>{const i=document.createElement("canvas"),r=i.getContext("2d");if(!r){e([]);return}const s=100;i.width=s,i.height=s;const o=(t.width-s)/2,l=(t.height-s)/2;r.drawImage(t,o,l,s,s,0,0,s,s);const h=r.getImageData(0,0,s,s).data;let f=0,p=0,y=0,x=0,I=0,T=0;const S=h.length/4;for(let L=0;L<h.length;L+=4){const F=h[L],G=h[L+1],k=h[L+2];f+=F,p+=G,G>F&&G>k&&y++,F>100&&G>80&&G<150&&k<100&&x++,F>150&&G>150&&k>150&&I++,F<80&&G<80&&k<80&&T++}const b=[];y/S>.2&&b.push("green"),x/S>.2&&b.push("brown"),I/S>.2&&b.push("silver"),T/S>.3&&b.push("dark");const D=f/S,N=p/S;D>150&&N>100&&N<180&&b.push("gold"),e(b)},t.src=n})}function nq(n){const e=[];for(const[t,i]of Object.entries(eq)){let r=0;for(const s of n)i.colors.some(o=>o.includes(s)||s.includes(o))&&r++;r>0&&e.push({species:t,score:r/i.colors.length})}return e.sort((t,i)=>i.score-t.score)}async function iq(n){try{const e=await tq(n),t=nq(e);if(t.length===0)return{species:"",confidence:0,suggestions:Em.slice(0,5).map(o=>o.name)};const i=t[0],r=t.slice(0,5).map(o=>o.species),s=["Snoek","Baars","Karper","Snoekbaars","Brasem"];for(const o of s)!r.includes(o)&&r.length<5&&r.push(o);return{species:i.score>.3?i.species:"",confidence:i.score,suggestions:r.slice(0,5)}}catch(e){return console.error("Fish recognition error:",e),{species:"",confidence:0,suggestions:Em.slice(0,5).map(t=>t.name)}}}function rq(n){return{Snoek:{avgWeight:3e3,avgLength:70},Snoekbaars:{avgWeight:2500,avgLength:60},Baars:{avgWeight:500,avgLength:30},Karper:{avgWeight:8e3,avgLength:60},Brasem:{avgWeight:2e3,avgLength:45},Voorn:{avgWeight:300,avgLength:25},Zeelt:{avgWeight:1500,avgLength:40},Meerval:{avgWeight:15e3,avgLength:120},Aal:{avgWeight:800,avgLength:60},Forel:{avgWeight:1e3,avgLength:40},Kolblei:{avgWeight:500,avgLength:30},Winde:{avgWeight:1e3,avgLength:40},Kopvoorn:{avgWeight:800,avgLength:35},Ruisvoorn:{avgWeight:400,avgLength:25},Blankvoorn:{avgWeight:300,avgLength:25}}[n]||null}function sq({onClose:n,initialLocation:e,initialLocationSource:t,initialPhotos:i=[]}){const r=jP(ie=>ie.addCatch),s=UP(ie=>ie.current),o=Ei(ie=>ie.position),[l,u]=q.useState(e||(o?{lat:o.lat,lng:o.lng}:null)),[h,f]=q.useState(t||(o?"gps":null)),[p,y]=q.useState(""),[x,I]=q.useState(""),[T,S]=q.useState(""),[b,D]=q.useState(""),[N,L]=q.useState(""),[F,G]=q.useState(""),[k,R]=q.useState(i),[P,V]=q.useState(!1),[j,B]=q.useState([]),[M,se]=q.useState(0),he=async ie=>{if(R(me=>[...me,ie]),ie.dataUrl&&!p){V(!0);try{const me=await iq(ie.dataUrl);if(B(me.suggestions),se(me.confidence),me.species&&me.confidence>.4){y(me.species);const xe=rq(me.species)}}catch(me){console.error("AI recognition failed:",me)}finally{V(!1)}}},ge=ie=>{y(ie),B([])},ue=ie=>{R(me=>me.filter(xe=>xe.id!==ie))},Q=()=>{o&&(u({lat:o.lat,lng:o.lng}),f("gps"))},re=ie=>{if(ie.preventDefault(),!p||!l){alert("Selecteer een vissoort en zorg dat er een locatie is");return}r({location:l,species:p,weight:x?parseInt(x):void 0,length:T?parseInt(T):void 0,photos:k.length>0?k:void 0,method:b||"Anders",bait:N||void 0,notes:F||void 0,weather:s?{temp:s.temperature,windSpeed:s.windSpeed,windDirection:s.windDirection,pressure:s.pressure}:void 0}),n()},U=(()=>{switch(h){case"gps":return{icon:tu,label:"GPS",color:"text-blue-500"};case"photo":return{icon:Mw,label:"Foto EXIF",color:"text-green-500"};case"map":return{icon:wy,label:"Kaart",color:"text-orange-500"};default:return{icon:Al,label:"Locatie",color:"text-gray-500"}}})(),$=U.icon;return _.jsx(Ge.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(Ge.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:ie=>ie.stopPropagation(),children:[_.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Ys,{className:"text-white",size:24}),_.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),_.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:_.jsx(Ji,{size:20})})]}),_.jsxs("form",{onSubmit:re,className:"p-4 space-y-4",children:[_.jsx("div",{className:"space-y-2",children:l?_.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-gray-50 p-2 rounded-lg",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx($,{size:16,className:U.color}),_.jsxs("span",{className:"text-gray-600",children:[l.lat.toFixed(5),", ",l.lng.toFixed(5)]})]}),_.jsx("span",{className:`text-xs ${U.color} font-medium`,children:U.label})]}):_.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-red-50 p-2 rounded-lg text-red-600",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Al,{size:16}),_.jsx("span",{children:"Geen locatie"})]}),o&&_.jsx("button",{type:"button",onClick:Q,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded-md border-0 outline-none",children:"Gebruik GPS"})]})}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:["Vissoort *",P&&_.jsxs("span",{className:"flex items-center gap-1 text-xs text-blue-500",children:[_.jsx(_H,{size:12,className:"animate-spin"}),"AI analyseert..."]})]}),_.jsx(ri,{children:j.length>0&&!p&&_.jsxs(Ge.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-2 p-2 bg-blue-50 rounded-lg border border-blue-200",children:[_.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mb-2",children:[_.jsx(JH,{size:12}),_.jsxs("span",{children:["AI suggesties ",M>.3?`(${Math.round(M*100)}% zeker)`:""]})]}),_.jsx("div",{className:"flex flex-wrap gap-1",children:j.map(ie=>_.jsx("button",{type:"button",onClick:()=>ge(ie),className:"px-2 py-1 text-xs bg-white border border-blue-300 text-blue-700 rounded-full hover:bg-blue-100 transition-colors",children:ie},ie))})]})}),_.jsxs("select",{value:p,onChange:ie=>{y(ie.target.value),B([])},className:"form-select",required:!0,children:[_.jsx("option",{value:"",children:"Selecteer vissoort..."}),Em.map(ie=>_.jsx("option",{value:ie.name,children:ie.name},ie.name))]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(HH,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),_.jsx("input",{type:"number",value:x,onChange:ie=>I(ie.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(BH,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),_.jsx("input",{type:"number",value:T,onChange:ie=>S(ie.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),_.jsxs("select",{value:b,onChange:ie=>D(ie.target.value),className:"form-select",children:[_.jsx("option",{value:"",children:"Selecteer methode..."}),ZK.map(ie=>_.jsx("option",{value:ie,children:ie},ie))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),_.jsxs("select",{value:N,onChange:ie=>L(ie.target.value),className:"form-select",children:[_.jsx("option",{value:"",children:"Selecteer aas..."}),QK.map(ie=>_.jsx("option",{value:ie,children:ie},ie))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),_.jsx("textarea",{value:F,onChange:ie=>G(ie.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),_.jsx(JK,{photos:k,onAddPhoto:he,onRemovePhoto:ue}),_.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function oq(){const n=ii(h=>h.catchFormOpen),e=ii(h=>h.catchFormLocation),t=ii(h=>h.catchFormLocationSource),i=ii(h=>h.catchFormInitialPhotos),r=ii(h=>h.openCatchForm),s=ii(h=>h.closeCatchForm),o=Ei(h=>h.position),l=ln(h=>h.showCatchButton),u=()=>{o?r({location:{lat:o.lat,lng:o.lng},locationSource:"gps"}):r()};return _.jsxs(_.Fragment,{children:[l&&_.jsx(Ge.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:u,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:_.jsx(Ys,{size:22,strokeWidth:2})}),_.jsx(ri,{children:n&&_.jsx(sq,{onClose:s,initialLocation:e||void 0,initialLocationSource:t||void 0,initialPhotos:i})})]})}function aq(){const n=Js(r=>r.map),e=jP(r=>r.catches),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new R1,t.current=new O1({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=gl([r.location.lng,r.location.lat]),o=new au({geometry:new pl(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new Zi({image:new kl({radius:14,fill:new Ir({color:"#22c55e"}),stroke:new ku({color:"#fff",width:2})}),text:new af({text:l,font:"bold 12px sans-serif",fill:new Ir({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function lq(){const n=Js(r=>r.map),e=zP(r=>r.spots),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new R1,t.current=new O1({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=gl([r.location.lng,r.location.lat]),o=new au({geometry:new pl(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new Zi({image:new kl({radius:12,fill:new Ir({color:l}),stroke:new ku({color:"#fff",width:2})}),text:new af({text:"",font:"bold 14px sans-serif",fill:new Ir({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function cq({onClose:n,initialLocation:e}){const t=zP(S=>S.addSpot),[i,r]=q.useState(""),[s,o]=q.useState(""),[l,u]=q.useState([]),[h,f]=q.useState(""),[p,y]=q.useState(3),x=e,I=S=>{u(b=>b.includes(S)?b.filter(D=>D!==S):[...b,S])},T=S=>{if(S.preventDefault(),!i||!x){alert("Geef een naam op voor deze locatie");return}t({name:i,location:x,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:p}),n()};return _.jsx(Ge.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(Ge.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:S=>S.stopPropagation(),children:[_.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Tx,{className:"text-white",size:24}),_.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),_.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:_.jsx(Ji,{size:20})})]}),_.jsxs("form",{onSubmit:T,className:"p-4 space-y-4",children:[x&&_.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[_.jsx(Al,{size:16}),_.jsxs("span",{children:[x.lat.toFixed(5),", ",x.lng.toFixed(5)]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),_.jsx("input",{type:"text",value:i,onChange:S=>r(S.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),_.jsx("input",{type:"text",value:s,onChange:S=>o(S.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),_.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(S=>_.jsx("button",{type:"button",onClick:()=>y(S),className:"p-1 border-0 outline-none bg-transparent",children:_.jsx(Tx,{size:28,className:S<=p?"text-yellow-400 fill-yellow-400":"text-gray-300"})},S))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),_.jsx("div",{className:"flex flex-wrap gap-2",children:Em.slice(0,12).map(S=>_.jsx("button",{type:"button",onClick:()=>I(S.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(S.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S.name},S.name))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),_.jsx("textarea",{value:h,onChange:S=>f(S.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),_.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const uq=[{name:"Aanlegsteigers",icon:ID,color:"#2196F3"},{name:"Boothellingen",icon:ZH,color:"#4CAF50"},{name:"Dieptekaart",icon:Xd,color:"#00BCD4"},{name:"Viswater",icon:Al,color:"#9C27B0"}],DA=[{name:"OpenStreetMap",label:"Kaart"},{name:"Luchtfoto",label:"Satelliet"}];function hq(){const[n,e]=q.useState(!1),t=Xo(l=>l.visible),i=Xo(l=>l.toggleLayer),r=Xo(l=>l.setLayerVisibility),s=l=>{DA.forEach(u=>{r(u.name,u.name===l)}),l==="Luchtfoto"?r("Labels Overlay",!0):r("Labels Overlay",!1)},o=()=>{r("Labels Overlay",!t["Labels Overlay"])};return _.jsxs("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:[_.jsx(Ge.button,{className:"w-11 h-11 bg-white/90 hover:bg-white backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:_.jsx(wm,{size:22})}),_.jsx(ri,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(Ge.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),_.jsxs(Ge.div,{className:"absolute bottom-12 right-0 bg-white rounded-xl shadow-lg overflow-hidden min-w-[200px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},children:[_.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Kaartlagen"})}),_.jsxs("div",{className:"p-2",children:[_.jsxs("div",{className:"mb-2 pb-2 border-b border-gray-100",children:[_.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Achtergrond"}),_.jsx("div",{className:"flex gap-1",children:DA.map(l=>_.jsx("button",{className:`flex-1 px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t[l.name]?"bg-blue-500 text-white":"bg-transparent text-gray-600 hover:bg-blue-50"}`,onClick:()=>s(l.name),children:l.label},l.name))}),t.Luchtfoto&&_.jsxs("button",{onClick:o,className:`mt-1.5 w-full flex items-center justify-between px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t["Labels Overlay"]?"bg-blue-50 text-blue-600":"bg-transparent text-gray-500 hover:bg-blue-50"}`,children:[_.jsxs("span",{className:"flex items-center gap-1.5",children:[_.jsx(rK,{size:12}),"Labels overlay"]}),t["Labels Overlay"]&&_.jsx(Ex,{size:12})]})]}),_.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Kaartlagen"}),_.jsx("div",{className:"space-y-0.5",children:uq.map(l=>{const u=l.icon,h=t[l.name];return _.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-colors border-0 outline-none ${h?"bg-blue-50":"bg-transparent hover:bg-blue-50"}`,onClick:()=>i(l.name),children:[_.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center transition-colors",style:{backgroundColor:h?l.color:"#e5e7eb"},children:_.jsx(u,{size:14,className:"text-white"})}),_.jsx("span",{className:`text-sm ${h?"text-blue-700":"text-gray-600"}`,children:l.name}),_.jsx("div",{className:"ml-auto",children:_.jsx("div",{className:"w-4 h-4 rounded flex items-center justify-center transition-all",style:{backgroundColor:h?"#3b82f6":"transparent",border:h?"2px solid #3b82f6":"2px solid #93c5fd"},children:h&&_.jsx(Ex,{size:10,className:"text-white",strokeWidth:3})})})]},l.name)})})]})]})]})})]})}function dq(){const n=ii(y=>y.settingsPanelOpen),e=ii(y=>y.toggleSettingsPanel),t=ln(y=>y.showCatchButton),i=ln(y=>y.setShowCatchButton),r=ln(y=>y.showCatches),s=ln(y=>y.setShowCatches),o=ln(y=>y.showFavoriteSpots),l=ln(y=>y.setShowFavoriteSpots),u=ln(y=>y.defaultBackground),h=ln(y=>y.setDefaultBackground),f=ln(y=>y.showWeatherWidget),p=ln(y=>y.setShowWeatherWidget);return n?_.jsx(Ge.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:_.jsxs(Ge.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:y=>y.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),_.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:_.jsx(Ji,{size:20,className:"text-white"})})]}),_.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),_.jsx(sp,{icon:_.jsx(Ys,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),_.jsx(sp,{icon:_.jsx(Ys,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),_.jsx(sp,{icon:_.jsx(Al,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:_.jsx(wy,{size:18,className:"text-gray-500"})}),_.jsxs("div",{className:"flex-1",children:[_.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),_.jsxs("select",{value:u,onChange:y=>h(y.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-400",children:[_.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),_.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weer & Water"}),_.jsx(sp,{icon:_.jsx(qd,{size:18,className:"text-blue-400"}),label:"Vis-weer widget",description:"Weer, getijden, waterdata, maanstand",checked:f,onChange:p})]})]}),_.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function sp({icon:n,label:e,description:t,checked:i,onChange:r}){return _.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),_.jsxs("div",{className:"flex-1",children:[_.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),_.jsx("p",{className:"text-xs text-gray-400",children:t})]}),_.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-blue-500":"bg-gray-300"}`,children:_.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function fq({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=ED(),[l,u]=q.useState(""),[h,f]=q.useState(!1),[p,y]=q.useState(!1),[x,I]=q.useState(null);if(q.useEffect(()=>{o()},[o]),s)return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center",children:_.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return _.jsx(_.Fragment,{children:n});const T=b=>{b.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},S=async()=>{try{I(null),await i()}catch{I("Google login mislukt"),setTimeout(()=>I(null),3e3)}};return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center p-4",children:_.jsxs(Ge.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[_.jsxs("div",{className:"flex flex-col items-center mb-6",children:[_.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:_.jsx(Ys,{size:40,className:"text-white"})}),_.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),_.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),_.jsxs(Ge.button,{onClick:S,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[_.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),_.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),_.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),_.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),x&&_.jsx(Ge.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:x}),_.jsxs("div",{className:"flex items-center gap-3 my-4",children:[_.jsx("div",{className:"flex-1 h-px bg-gray-200"}),_.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),_.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),_.jsxs("form",{onSubmit:T,className:"space-y-4",children:[_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:_.jsx(EH,{size:20})}),_.jsx("input",{type:p?"text":"password",value:l,onChange:b=>u(b.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-blue-400"}`}),_.jsx("button",{type:"button",onClick:()=>y(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p?_.jsx(aH,{size:20}):_.jsx(cH,{size:20})})]}),h&&_.jsx(Ge.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),_.jsx(Ge.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),_.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function gq(){const n=ii(i=>i.spotFormOpen),e=ii(i=>i.spotFormLocation),t=ii(i=>i.closeSpotForm);return _.jsx(fq,{children:_.jsxs("div",{className:"h-screen w-screen overflow-hidden",children:[_.jsx(N$,{}),_.jsx(SK,{}),_.jsx(aq,{}),_.jsx(lq,{}),_.jsx(xK,{}),_.jsx(YK,{}),_.jsx(IK,{}),_.jsx(RK,{}),_.jsx(VK,{}),_.jsx(MK,{}),_.jsx(hq,{}),_.jsx(oq,{}),_.jsx(EK,{}),_.jsx(AK,{}),_.jsx(dq,{}),_.jsx(ri,{children:n&&_.jsx(cq,{onClose:t,initialLocation:e||void 0})})]})})}const pq="1.2.15";console.log(`%c VisApp v${pq}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");tL.createRoot(document.getElementById("root")).render(_.jsx(gq,{}));export{Aq as $,M2 as A,Rt as B,kl as C,nt as D,Be as E,Ir as F,Pj as G,Nm as H,F5 as I,fl as J,k2 as K,D2 as L,Eq as M,Vp as N,Fj as O,Sq as P,L2 as Q,Kc as R,Zi as S,M6 as T,pl as U,R1 as V,d2 as W,vq as X,xq as Y,Tq as Z,bq as _,O1 as a,PI as a0,R4 as a1,A4 as a2,Rq as a3,Cq as a4,bd as a5,Iq as a6,wq as a7,gr as a8,au as a9,tt as aa,cp as ab,Fp as ac,Z2 as ad,Dv as ae,ou as af,kj as ag,ku as b,Bn as c,kq as d,Qi as e,li as f,dt as g,gC as h,a1 as i,f6 as j,k_ as k,m1 as l,ol as m,o1 as n,h2 as o,P2 as p,N2 as q,_q as r,Lj as s,jm as t,NI as u,$c as v,kI as w,Oj as x,v1 as y,_1 as z};
//# sourceMappingURL=index-IvIoHuFy.js.map
