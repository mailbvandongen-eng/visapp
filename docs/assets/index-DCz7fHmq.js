const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-B0Fq61fu.js","assets/GeoJSON-Cz5mwQhL.js","assets/boothellingenOL-BPwIFbfU.js","assets/viswaterOL-BUS-OUBC.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Sx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var G_={exports:{}},Sh={},W_={exports:{}},$e={};var WT;function GM(){if(WT)return $e;WT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function y(W){return W===null||typeof W!="object"?null:(W=p&&W[p]||W["@@iterator"],typeof W=="function"?W:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,I={};function T(W,$,ie){this.props=W,this.context=$,this.refs=I,this.updater=ie||x}T.prototype.isReactComponent={},T.prototype.setState=function(W,$){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,$,"setState")},T.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function A(){}A.prototype=T.prototype;function P(W,$,ie){this.props=W,this.context=$,this.refs=I,this.updater=ie||x}var N=P.prototype=new A;N.constructor=P,S(N,T.prototype),N.isPureReactComponent=!0;var R=Array.isArray,L=Object.prototype.hasOwnProperty,j={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function b(W,$,ie){var me,xe={},ke=null,Me=null;if($!=null)for(me in $.ref!==void 0&&(Me=$.ref),$.key!==void 0&&(ke=""+$.key),$)L.call($,me)&&!D.hasOwnProperty(me)&&(xe[me]=$[me]);var Ve=arguments.length-2;if(Ve===1)xe.children=ie;else if(1<Ve){for(var We=Array(Ve),lt=0;lt<Ve;lt++)We[lt]=arguments[lt+2];xe.children=We}if(W&&W.defaultProps)for(me in Ve=W.defaultProps,Ve)xe[me]===void 0&&(xe[me]=Ve[me]);return{$$typeof:n,type:W,key:ke,ref:Me,props:xe,_owner:j.current}}function M(W,$){return{$$typeof:n,type:W.type,key:$,ref:W.ref,props:W.props,_owner:W._owner}}function V(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function z(W){var $={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(ie){return $[ie]})}var B=/\/+/g;function O(W,$){return typeof W=="object"&&W!==null&&W.key!=null?z(""+W.key):$.toString(36)}function le(W,$,ie,me,xe){var ke=typeof W;(ke==="undefined"||ke==="boolean")&&(W=null);var Me=!1;if(W===null)Me=!0;else switch(ke){case"string":case"number":Me=!0;break;case"object":switch(W.$$typeof){case n:case e:Me=!0}}if(Me)return Me=W,xe=xe(Me),W=me===""?"."+O(Me,0):me,R(xe)?(ie="",W!=null&&(ie=W.replace(B,"$&/")+"/"),le(xe,$,ie,"",function(lt){return lt})):xe!=null&&(V(xe)&&(xe=M(xe,ie+(!xe.key||Me&&Me.key===xe.key?"":(""+xe.key).replace(B,"$&/")+"/")+W)),$.push(xe)),1;if(Me=0,me=me===""?".":me+":",R(W))for(var Ve=0;Ve<W.length;Ve++){ke=W[Ve];var We=me+O(ke,Ve);Me+=le(ke,$,ie,We,xe)}else if(We=y(W),typeof We=="function")for(W=We.call(W),Ve=0;!(ke=W.next()).done;)ke=ke.value,We=me+O(ke,Ve++),Me+=le(ke,$,ie,We,xe);else if(ke==="object")throw $=String(W),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Me}function pe(W,$,ie){if(W==null)return W;var me=[],xe=0;return le(W,me,"","",function(ke){return $.call(ie,ke,xe++)}),me}function ge(W){if(W._status===-1){var $=W._result;$=$(),$.then(function(ie){(W._status===0||W._status===-1)&&(W._status=1,W._result=ie)},function(ie){(W._status===0||W._status===-1)&&(W._status=2,W._result=ie)}),W._status===-1&&(W._status=0,W._result=$)}if(W._status===1)return W._result.default;throw W._result}var ue={current:null},Q={transition:null},se={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:Q,ReactCurrentOwner:j};function ne(){throw Error("act(...) is not supported in production builds of React.")}return $e.Children={map:pe,forEach:function(W,$,ie){pe(W,function(){$.apply(this,arguments)},ie)},count:function(W){var $=0;return pe(W,function(){$++}),$},toArray:function(W){return pe(W,function($){return $})||[]},only:function(W){if(!V(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},$e.Component=T,$e.Fragment=t,$e.Profiler=r,$e.PureComponent=P,$e.StrictMode=i,$e.Suspense=u,$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=se,$e.act=ne,$e.cloneElement=function(W,$,ie){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var me=S({},W.props),xe=W.key,ke=W.ref,Me=W._owner;if($!=null){if($.ref!==void 0&&(ke=$.ref,Me=j.current),$.key!==void 0&&(xe=""+$.key),W.type&&W.type.defaultProps)var Ve=W.type.defaultProps;for(We in $)L.call($,We)&&!D.hasOwnProperty(We)&&(me[We]=$[We]===void 0&&Ve!==void 0?Ve[We]:$[We])}var We=arguments.length-2;if(We===1)me.children=ie;else if(1<We){Ve=Array(We);for(var lt=0;lt<We;lt++)Ve[lt]=arguments[lt+2];me.children=Ve}return{$$typeof:n,type:W.type,key:xe,ref:ke,props:me,_owner:Me}},$e.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:s,_context:W},W.Consumer=W},$e.createElement=b,$e.createFactory=function(W){var $=b.bind(null,W);return $.type=W,$},$e.createRef=function(){return{current:null}},$e.forwardRef=function(W){return{$$typeof:l,render:W}},$e.isValidElement=V,$e.lazy=function(W){return{$$typeof:f,_payload:{_status:-1,_result:W},_init:ge}},$e.memo=function(W,$){return{$$typeof:h,type:W,compare:$===void 0?null:$}},$e.startTransition=function(W){var $=Q.transition;Q.transition={};try{W()}finally{Q.transition=$}},$e.unstable_act=ne,$e.useCallback=function(W,$){return ue.current.useCallback(W,$)},$e.useContext=function(W){return ue.current.useContext(W)},$e.useDebugValue=function(){},$e.useDeferredValue=function(W){return ue.current.useDeferredValue(W)},$e.useEffect=function(W,$){return ue.current.useEffect(W,$)},$e.useId=function(){return ue.current.useId()},$e.useImperativeHandle=function(W,$,ie){return ue.current.useImperativeHandle(W,$,ie)},$e.useInsertionEffect=function(W,$){return ue.current.useInsertionEffect(W,$)},$e.useLayoutEffect=function(W,$){return ue.current.useLayoutEffect(W,$)},$e.useMemo=function(W,$){return ue.current.useMemo(W,$)},$e.useReducer=function(W,$,ie){return ue.current.useReducer(W,$,ie)},$e.useRef=function(W){return ue.current.useRef(W)},$e.useState=function(W){return ue.current.useState(W)},$e.useSyncExternalStore=function(W,$,ie){return ue.current.useSyncExternalStore(W,$,ie)},$e.useTransition=function(){return ue.current.useTransition()},$e.version="18.3.1",$e}var $T;function Xd(){return $T||($T=1,W_.exports=GM()),W_.exports}var KT;function WM(){if(KT)return Sh;KT=1;var n=Xd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var f,p={},y=null,x=null;h!==void 0&&(y=""+h),u.key!==void 0&&(y=""+u.key),u.ref!==void 0&&(x=u.ref);for(f in u)i.call(u,f)&&!s.hasOwnProperty(f)&&(p[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)p[f]===void 0&&(p[f]=u[f]);return{$$typeof:e,type:l,key:y,ref:x,props:p,_owner:r.current}}return Sh.Fragment=t,Sh.jsx=o,Sh.jsxs=o,Sh}var HT;function $M(){return HT||(HT=1,G_.exports=WM()),G_.exports}var _=$M(),Ag={},$_={exports:{}},Qn={},K_={exports:{}},H_={};var XT;function KM(){return XT||(XT=1,(function(n){function e(Q,se){var ne=Q.length;Q.push(se);e:for(;0<ne;){var W=ne-1>>>1,$=Q[W];if(0<r($,se))Q[W]=se,Q[ne]=$,ne=W;else break e}}function t(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var se=Q[0],ne=Q.pop();if(ne!==se){Q[0]=ne;e:for(var W=0,$=Q.length,ie=$>>>1;W<ie;){var me=2*(W+1)-1,xe=Q[me],ke=me+1,Me=Q[ke];if(0>r(xe,ne))ke<$&&0>r(Me,xe)?(Q[W]=Me,Q[ke]=ne,W=ke):(Q[W]=xe,Q[me]=ne,W=me);else if(ke<$&&0>r(Me,ne))Q[W]=Me,Q[ke]=ne,W=ke;else break e}}return se}function r(Q,se){var ne=Q.sortIndex-se.sortIndex;return ne!==0?ne:Q.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,p=null,y=3,x=!1,S=!1,I=!1,T=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Q){for(var se=t(h);se!==null;){if(se.callback===null)i(h);else if(se.startTime<=Q)i(h),se.sortIndex=se.expirationTime,e(u,se);else break;se=t(h)}}function R(Q){if(I=!1,N(Q),!S)if(t(u)!==null)S=!0,ge(L);else{var se=t(h);se!==null&&ue(R,se.startTime-Q)}}function L(Q,se){S=!1,I&&(I=!1,A(b),b=-1),x=!0;var ne=y;try{for(N(se),p=t(u);p!==null&&(!(p.expirationTime>se)||Q&&!z());){var W=p.callback;if(typeof W=="function"){p.callback=null,y=p.priorityLevel;var $=W(p.expirationTime<=se);se=n.unstable_now(),typeof $=="function"?p.callback=$:p===t(u)&&i(u),N(se)}else i(u);p=t(u)}if(p!==null)var ie=!0;else{var me=t(h);me!==null&&ue(R,me.startTime-se),ie=!1}return ie}finally{p=null,y=ne,x=!1}}var j=!1,D=null,b=-1,M=5,V=-1;function z(){return!(n.unstable_now()-V<M)}function B(){if(D!==null){var Q=n.unstable_now();V=Q;var se=!0;try{se=D(!0,Q)}finally{se?O():(j=!1,D=null)}}else j=!1}var O;if(typeof P=="function")O=function(){P(B)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,pe=le.port2;le.port1.onmessage=B,O=function(){pe.postMessage(null)}}else O=function(){T(B,0)};function ge(Q){D=Q,j||(j=!0,O())}function ue(Q,se){b=T(function(){Q(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_continueExecution=function(){S||x||(S=!0,ge(L))},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(Q){switch(y){case 1:case 2:case 3:var se=3;break;default:se=y}var ne=y;y=se;try{return Q()}finally{y=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Q,se){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ne=y;y=Q;try{return se()}finally{y=ne}},n.unstable_scheduleCallback=function(Q,se,ne){var W=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?W+ne:W):ne=W,Q){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,Q={id:f++,callback:se,priorityLevel:Q,startTime:ne,expirationTime:$,sortIndex:-1},ne>W?(Q.sortIndex=ne,e(h,Q),t(u)===null&&Q===t(h)&&(I?(A(b),b=-1):I=!0,ue(R,ne-W))):(Q.sortIndex=$,e(u,Q),S||x||(S=!0,ge(L))),Q},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(Q){var se=y;return function(){var ne=y;y=se;try{return Q.apply(this,arguments)}finally{y=ne}}}})(H_)),H_}var qT;function HM(){return qT||(qT=1,K_.exports=KM()),K_.exports}var YT;function XM(){if(YT)return Qn;YT=1;var n=Xd(),e=HM();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)i.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function y(a){return u.call(p,a)?!0:u.call(f,a)?!1:h.test(a)?p[a]=!0:(f[a]=!0,!1)}function x(a,c,d,m){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return m?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function S(a,c,d,m){if(c===null||typeof c>"u"||x(a,c,d,m))return!0;if(m)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function I(a,c,d,m,v,w,k){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=w,this.removeEmptyString=k}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){T[a]=new I(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];T[c]=new I(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){T[a]=new I(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){T[a]=new I(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){T[a]=new I(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){T[a]=new I(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){T[a]=new I(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){T[a]=new I(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){T[a]=new I(a,5,!1,a.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function P(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(A,P);T[c]=new I(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(A,P);T[c]=new I(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(A,P);T[c]=new I(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){T[a]=new I(a,1,!1,a.toLowerCase(),null,!1,!1)}),T.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){T[a]=new I(a,1,!1,a.toLowerCase(),null,!0,!0)});function N(a,c,d,m){var v=T.hasOwnProperty(c)?T[c]:null;(v!==null?v.type!==0:m||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(S(c,d,v,m)&&(d=null),m||v===null?y(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):v.mustUseProperty?a[v.propertyName]=d===null?v.type===3?!1:"":d:(c=v.attributeName,m=v.attributeNamespace,d===null?a.removeAttribute(c):(v=v.type,d=v===3||v===4&&d===!0?"":""+d,m?a.setAttributeNS(m,c,d):a.setAttribute(c,d))))}var R=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),j=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),z=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),Q=Symbol.iterator;function se(a){return a===null||typeof a!="object"?null:(a=Q&&a[Q]||a["@@iterator"],typeof a=="function"?a:null)}var ne=Object.assign,W;function $(a){if(W===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);W=c&&c[1]||""}return`
`+W+a}var ie=!1;function me(a,c){if(!a||ie)return"";ie=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(J){var m=J}Reflect.construct(a,[],c)}else{try{c.call()}catch(J){m=J}a.call(c.prototype)}else{try{throw Error()}catch(J){m=J}a()}}catch(J){if(J&&m&&typeof J.stack=="string"){for(var v=J.stack.split(`
`),w=m.stack.split(`
`),k=v.length-1,U=w.length-1;1<=k&&0<=U&&v[k]!==w[U];)U--;for(;1<=k&&0<=U;k--,U--)if(v[k]!==w[U]){if(k!==1||U!==1)do if(k--,U--,0>U||v[k]!==w[U]){var G=`
`+v[k].replace(" at new "," at ");return a.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",a.displayName)),G}while(1<=k&&0<=U);break}}}finally{ie=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?$(a):""}function xe(a){switch(a.tag){case 5:return $(a.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return a=me(a.type,!1),a;case 11:return a=me(a.type.render,!1),a;case 1:return a=me(a.type,!0),a;default:return""}}function ke(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case D:return"Fragment";case j:return"Portal";case M:return"Profiler";case b:return"StrictMode";case O:return"Suspense";case le:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case z:return(a.displayName||"Context")+".Consumer";case V:return(a._context.displayName||"Context")+".Provider";case B:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case pe:return c=a.displayName||null,c!==null?c:ke(a.type)||"Memo";case ge:c=a._payload,a=a._init;try{return ke(a(c))}catch{}}return null}function Me(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ke(c);case 8:return c===b?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Ve(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function We(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function lt(a){var c=We(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),m=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,w=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return v.call(this)},set:function(k){m=""+k,w.call(this,k)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(k){m=""+k},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function er(a){a._valueTracker||(a._valueTracker=lt(a))}function fs(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),m="";return a&&(m=We(a)?a.checked?"true":"false":a.value),a=m,a!==d?(c.setValue(a),!0):!1}function Wn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function $n(a,c){var d=c.checked;return ne({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function hn(a,c){var d=c.defaultValue==null?"":c.defaultValue,m=c.checked!=null?c.checked:c.defaultChecked;d=Ve(c.value!=null?c.value:d),a._wrapperState={initialChecked:m,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function dn(a,c){c=c.checked,c!=null&&N(a,"checked",c,!1)}function Kn(a,c){dn(a,c);var d=Ve(c.value),m=c.type;if(d!=null)m==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(m==="submit"||m==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?_t(a,c.type,d):c.hasOwnProperty("defaultValue")&&_t(a,c.type,Ve(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function bi(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var m=c.type;if(!(m!=="submit"&&m!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function _t(a,c,d){(c!=="number"||Wn(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ct=Array.isArray;function nn(a,c,d,m){if(a=a.options,c){c={};for(var v=0;v<d.length;v++)c["$"+d[v]]=!0;for(d=0;d<a.length;d++)v=c.hasOwnProperty("$"+a[d].value),a[d].selected!==v&&(a[d].selected=v),v&&m&&(a[d].defaultSelected=!0)}else{for(d=""+Ve(d),c=null,v=0;v<a.length;v++){if(a[v].value===d){a[v].selected=!0,m&&(a[v].defaultSelected=!0);return}c!==null||a[v].disabled||(c=a[v])}c!==null&&(c.selected=!0)}}function Pi(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function It(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(t(92));if(ct(d)){if(1<d.length)throw Error(t(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:Ve(d)}}function to(a,c){var d=Ve(c.value),m=Ve(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),m!=null&&(a.defaultValue=""+m)}function ki(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function Rr(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tr(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?Rr(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Ar,ca=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,m,v){MSApp.execUnsafeLocalFunction(function(){return a(c,d,m,v)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(Ar=Ar||document.createElement("div"),Ar.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Ar.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function br(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var Di={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fl=["Webkit","ms","Moz","O"];Object.keys(Di).forEach(function(a){Fl.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Di[c]=Di[a]})});function Pr(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||Di.hasOwnProperty(a)&&Di[a]?(""+c).trim():c+"px"}function gs(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var m=d.indexOf("--")===0,v=Pr(d,c[d],m);d==="float"&&(d="cssFloat"),m?a.setProperty(d,v):a[d]=v}}var no=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function On(a,c){if(c){if(no[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function ps(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kr=null;function Dr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Fn=null,Vn=null,ft=null;function io(a){if(a=ch(a)){if(typeof Fn!="function")throw Error(t(280));var c=a.stateNode;c&&(c=Gf(c),Fn(a.stateNode,a.type,c))}}function nr(a){Vn?ft?ft.push(a):ft=[a]:Vn=a}function Ft(){if(Vn){var a=Vn,c=ft;if(ft=Vn=null,io(a),c)for(a=0;a<c.length;a++)io(c[a])}}function Ni(a,c){return a(c)}function fn(){}var Vt=!1;function gn(a,c,d){if(Vt)return a(c,d);Vt=!0;try{return Ni(a,c,d)}finally{Vt=!1,(Vn!==null||ft!==null)&&(fn(),Ft())}}function pn(a,c){var d=a.stateNode;if(d===null)return null;var m=Gf(d);if(m===null)return null;d=m[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,c,typeof d));return d}var rn=!1;if(l)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){rn=!0}}),window.addEventListener("test",rt,rt),window.removeEventListener("test",rt,rt)}catch{rn=!1}function Gt(a,c,d,m,v,w,k,U,G){var J=Array.prototype.slice.call(arguments,3);try{c.apply(d,J)}catch(oe){this.onError(oe)}}var qt=!1,Mi=null,Vl=!1,Li=null,wf={onError:function(a){qt=!0,Mi=a}};function Ef(a,c,d,m,v,w,k,U,G){qt=!1,Mi=null,Gt.apply(wf,arguments)}function Fu(a,c,d,m,v,w,k,U,G){if(Ef.apply(this,arguments),qt){if(qt){var J=Mi;qt=!1,Mi=null}else throw Error(t(198));Vl||(Vl=!0,Li=J)}}function ir(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function Vu(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function Tf(a){if(ir(a)!==a)throw Error(t(188))}function Sf(a){var c=a.alternate;if(!c){if(c=ir(a),c===null)throw Error(t(188));return c!==a?null:a}for(var d=a,m=c;;){var v=d.return;if(v===null)break;var w=v.alternate;if(w===null){if(m=v.return,m!==null){d=m;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===d)return Tf(v),a;if(w===m)return Tf(v),c;w=w.sibling}throw Error(t(188))}if(d.return!==m.return)d=v,m=w;else{for(var k=!1,U=v.child;U;){if(U===d){k=!0,d=v,m=w;break}if(U===m){k=!0,m=v,d=w;break}U=U.sibling}if(!k){for(U=w.child;U;){if(U===d){k=!0,d=w,m=v;break}if(U===m){k=!0,m=w,d=v;break}U=U.sibling}if(!k)throw Error(t(189))}}if(d.alternate!==m)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:c}function If(a){return a=Sf(a),a!==null?ua(a):null}function ua(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=ua(a);if(c!==null)return c;a=a.sibling}return null}var ju=e.unstable_scheduleCallback,jl=e.unstable_cancelCallback,ha=e.unstable_shouldYield,ms=e.unstable_requestPaint,xt=e.unstable_now,xy=e.unstable_getCurrentPriorityLevel,zl=e.unstable_ImmediatePriority,zu=e.unstable_UserBlockingPriority,da=e.unstable_NormalPriority,Uu=e.unstable_LowPriority,Ul=e.unstable_IdlePriority,fa=null,ui=null;function Cf(a){if(ui&&typeof ui.onCommitFiberRoot=="function")try{ui.onCommitFiberRoot(fa,a,void 0,(a.current.flags&128)===128)}catch{}}var hi=Math.clz32?Math.clz32:ga,Nr=Math.log,Oi=Math.LN2;function ga(a){return a>>>=0,a===0?32:31-(Nr(a)/Oi|0)|0}var Mr=64,ro=4194304;function st(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ys(a,c){var d=a.pendingLanes;if(d===0)return 0;var m=0,v=a.suspendedLanes,w=a.pingedLanes,k=d&268435455;if(k!==0){var U=k&~v;U!==0?m=st(U):(w&=k,w!==0&&(m=st(w)))}else k=d&~v,k!==0?m=st(k):w!==0&&(m=st(w));if(m===0)return 0;if(c!==0&&c!==m&&(c&v)===0&&(v=m&-m,w=c&-c,v>=w||v===16&&(w&4194240)!==0))return c;if((m&4)!==0&&(m|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=m;0<c;)d=31-hi(c),v=1<<d,m|=a[d],c&=~v;return m}function pa(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ma(a,c){for(var d=a.suspendedLanes,m=a.pingedLanes,v=a.expirationTimes,w=a.pendingLanes;0<w;){var k=31-hi(w),U=1<<k,G=v[k];G===-1?((U&d)===0||(U&m)!==0)&&(v[k]=pa(U,c)):G<=c&&(a.expiredLanes|=U),w&=~U}}function Bu(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Gu(){var a=Mr;return Mr<<=1,(Mr&4194240)===0&&(Mr=64),a}function Wu(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function ya(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-hi(c),a[c]=d}function wy(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var m=a.eventTimes;for(a=a.expirationTimes;0<d;){var v=31-hi(d),w=1<<v;c[v]=0,m[v]=-1,a[v]=-1,d&=~w}}function $u(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var m=31-hi(d),v=1<<m;v&c|a[m]&c&&(a[m]|=c),d&=~v}}var Xe=0;function Lr(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Ku,Bl,Hu,Xu,qu,Or=!1,Gl=[],Fr=null,Vr=null,mn=null,_a=new Map,_s=new Map,di=[],Rf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function so(a,c){switch(a){case"focusin":case"focusout":Fr=null;break;case"dragenter":case"dragleave":Vr=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":_a.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":_s.delete(c.pointerId)}}function rr(a,c,d,m,v,w){return a===null||a.nativeEvent!==w?(a={blockedOn:c,domEventName:d,eventSystemFlags:m,nativeEvent:w,targetContainers:[v]},c!==null&&(c=ch(c),c!==null&&Bl(c)),a):(a.eventSystemFlags|=m,c=a.targetContainers,v!==null&&c.indexOf(v)===-1&&c.push(v),a)}function Af(a,c,d,m,v){switch(c){case"focusin":return Fr=rr(Fr,a,c,d,m,v),!0;case"dragenter":return Vr=rr(Vr,a,c,d,m,v),!0;case"mouseover":return mn=rr(mn,a,c,d,m,v),!0;case"pointerover":var w=v.pointerId;return _a.set(w,rr(_a.get(w)||null,a,c,d,m,v)),!0;case"gotpointercapture":return w=v.pointerId,_s.set(w,rr(_s.get(w)||null,a,c,d,m,v)),!0}return!1}function Wl(a){var c=Ea(a.target);if(c!==null){var d=ir(c);if(d!==null){if(c=d.tag,c===13){if(c=Vu(d),c!==null){a.blockedOn=c,qu(a.priority,function(){Hu(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=$l(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var m=new d.constructor(d.type,d);kr=m,d.target.dispatchEvent(m),kr=null}else return c=ch(d),c!==null&&Bl(c),a.blockedOn=d,!1;c.shift()}return!0}function bf(a,c,d){pt(a)&&d.delete(c)}function Ey(){Or=!1,Fr!==null&&pt(Fr)&&(Fr=null),Vr!==null&&pt(Vr)&&(Vr=null),mn!==null&&pt(mn)&&(mn=null),_a.forEach(bf),_s.forEach(bf)}function oo(a,c){a.blockedOn===c&&(a.blockedOn=null,Or||(Or=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ey)))}function ao(a){function c(v){return oo(v,a)}if(0<Gl.length){oo(Gl[0],a);for(var d=1;d<Gl.length;d++){var m=Gl[d];m.blockedOn===a&&(m.blockedOn=null)}}for(Fr!==null&&oo(Fr,a),Vr!==null&&oo(Vr,a),mn!==null&&oo(mn,a),_a.forEach(c),_s.forEach(c),d=0;d<di.length;d++)m=di[d],m.blockedOn===a&&(m.blockedOn=null);for(;0<di.length&&(d=di[0],d.blockedOn===null);)Wl(d),d.blockedOn===null&&di.shift()}var vs=R.ReactCurrentBatchConfig,xs=!0;function jr(a,c,d,m){var v=Xe,w=vs.transition;vs.transition=null;try{Xe=1,Yu(a,c,d,m)}finally{Xe=v,vs.transition=w}}function Pf(a,c,d,m){var v=Xe,w=vs.transition;vs.transition=null;try{Xe=4,Yu(a,c,d,m)}finally{Xe=v,vs.transition=w}}function Yu(a,c,d,m){if(xs){var v=$l(a,c,d,m);if(v===null)Ny(a,c,m,zr,d),so(a,m);else if(Af(v,a,c,d,m))m.stopPropagation();else if(so(a,m),c&4&&-1<Rf.indexOf(a)){for(;v!==null;){var w=ch(v);if(w!==null&&Ku(w),w=$l(a,c,d,m),w===null&&Ny(a,c,m,zr,d),w===v)break;v=w}v!==null&&m.stopPropagation()}else Ny(a,c,m,null,d)}}var zr=null;function $l(a,c,d,m){if(zr=null,a=Dr(m),a=Ea(a),a!==null)if(c=ir(a),c===null)a=null;else if(d=c.tag,d===13){if(a=Vu(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return zr=a,null}function Kl(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xy()){case zl:return 1;case zu:return 4;case da:case Uu:return 16;case Ul:return 536870912;default:return 16}default:return 16}}var fi=null,Hl=null,ws=null;function kf(){if(ws)return ws;var a,c=Hl,d=c.length,m,v="value"in fi?fi.value:fi.textContent,w=v.length;for(a=0;a<d&&c[a]===v[a];a++);var k=d-a;for(m=1;m<=k&&c[d-m]===v[w-m];m++);return ws=v.slice(a,1<m?1-m:void 0)}function va(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Ur(){return!0}function Zu(){return!1}function Cn(a){function c(d,m,v,w,k){this._reactName=d,this._targetInst=v,this.type=m,this.nativeEvent=w,this.target=k,this.currentTarget=null;for(var U in a)a.hasOwnProperty(U)&&(d=a[U],this[U]=d?d(w):w[U]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Ur:Zu,this.isPropagationStopped=Zu,this}return ne(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Ur)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Ur)},persist:function(){},isPersistent:Ur}),c}var Br={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xa=Cn(Br),lo=ne({},Br,{view:0,detail:0}),Xl=Cn(lo),ql,Yl,gi,wa=ne({},lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:je,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==gi&&(gi&&a.type==="mousemove"?(ql=a.screenX-gi.screenX,Yl=a.screenY-gi.screenY):Yl=ql=0,gi=a),ql)},movementY:function(a){return"movementY"in a?a.movementY:Yl}}),Qu=Cn(wa),Df=ne({},wa,{dataTransfer:0}),Nf=Cn(Df),Zl=ne({},lo,{relatedTarget:0}),yn=Cn(Zl),Mf=ne({},Br,{animationName:0,elapsedTime:0,pseudoElement:0}),Lf=Cn(Mf),co=ne({},Br,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=Cn(co),E=ne({},Br,{data:0}),C=Cn(E),F={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function de(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=ee[a])?!!c[a]:!1}function je(){return de}var jt=ne({},lo,{key:function(a){if(a.key){var c=F[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=va(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?X[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:je,charCode:function(a){return a.type==="keypress"?va(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?va(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ut=Cn(jt),Wt=ne({},wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pi=Cn(Wt),Es=ne({},lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:je}),Gr=Cn(Es),Wr=ne({},Br,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ql=Cn(Wr),Ju=ne({},wa,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),FN=Cn(Ju),VN=[9,13,27,32],Ty=l&&"CompositionEvent"in window,eh=null;l&&"documentMode"in document&&(eh=document.documentMode);var jN=l&&"TextEvent"in window&&!eh,Ow=l&&(!Ty||eh&&8<eh&&11>=eh),Fw=" ",Vw=!1;function jw(a,c){switch(a){case"keyup":return VN.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zw(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Jl=!1;function zN(a,c){switch(a){case"compositionend":return zw(c);case"keypress":return c.which!==32?null:(Vw=!0,Fw);case"textInput":return a=c.data,a===Fw&&Vw?null:a;default:return null}}function UN(a,c){if(Jl)return a==="compositionend"||!Ty&&jw(a,c)?(a=kf(),ws=Hl=fi=null,Jl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Ow&&c.locale!=="ko"?null:c.data;default:return null}}var BN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uw(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!BN[a.type]:c==="textarea"}function Bw(a,c,d,m){nr(m),c=zf(c,"onChange"),0<c.length&&(d=new xa("onChange","change",null,d,m),a.push({event:d,listeners:c}))}var th=null,nh=null;function GN(a){oE(a,0)}function Of(a){var c=rc(a);if(fs(c))return a}function WN(a,c){if(a==="change")return c}var Gw=!1;if(l){var Sy;if(l){var Iy="oninput"in document;if(!Iy){var Ww=document.createElement("div");Ww.setAttribute("oninput","return;"),Iy=typeof Ww.oninput=="function"}Sy=Iy}else Sy=!1;Gw=Sy&&(!document.documentMode||9<document.documentMode)}function $w(){th&&(th.detachEvent("onpropertychange",Kw),nh=th=null)}function Kw(a){if(a.propertyName==="value"&&Of(nh)){var c=[];Bw(c,nh,a,Dr(a)),gn(GN,c)}}function $N(a,c,d){a==="focusin"?($w(),th=c,nh=d,th.attachEvent("onpropertychange",Kw)):a==="focusout"&&$w()}function KN(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Of(nh)}function HN(a,c){if(a==="click")return Of(c)}function XN(a,c){if(a==="input"||a==="change")return Of(c)}function qN(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var sr=typeof Object.is=="function"?Object.is:qN;function ih(a,c){if(sr(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),m=Object.keys(c);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var v=d[m];if(!u.call(c,v)||!sr(a[v],c[v]))return!1}return!0}function Hw(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Xw(a,c){var d=Hw(a);a=0;for(var m;d;){if(d.nodeType===3){if(m=a+d.textContent.length,a<=c&&m>=c)return{node:d,offset:c-a};a=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Hw(d)}}function qw(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?qw(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function Yw(){for(var a=window,c=Wn();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=Wn(a.document)}return c}function Cy(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function YN(a){var c=Yw(),d=a.focusedElem,m=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&qw(d.ownerDocument.documentElement,d)){if(m!==null&&Cy(d)){if(c=m.start,a=m.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var v=d.textContent.length,w=Math.min(m.start,v);m=m.end===void 0?w:Math.min(m.end,v),!a.extend&&w>m&&(v=m,m=w,w=v),v=Xw(d,w);var k=Xw(d,m);v&&k&&(a.rangeCount!==1||a.anchorNode!==v.node||a.anchorOffset!==v.offset||a.focusNode!==k.node||a.focusOffset!==k.offset)&&(c=c.createRange(),c.setStart(v.node,v.offset),a.removeAllRanges(),w>m?(a.addRange(c),a.extend(k.node,k.offset)):(c.setEnd(k.node,k.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var ZN=l&&"documentMode"in document&&11>=document.documentMode,ec=null,Ry=null,rh=null,Ay=!1;function Zw(a,c,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Ay||ec==null||ec!==Wn(m)||(m=ec,"selectionStart"in m&&Cy(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),rh&&ih(rh,m)||(rh=m,m=zf(Ry,"onSelect"),0<m.length&&(c=new xa("onSelect","select",null,c,d),a.push({event:c,listeners:m}),c.target=ec)))}function Ff(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var tc={animationend:Ff("Animation","AnimationEnd"),animationiteration:Ff("Animation","AnimationIteration"),animationstart:Ff("Animation","AnimationStart"),transitionend:Ff("Transition","TransitionEnd")},by={},Qw={};l&&(Qw=document.createElement("div").style,"AnimationEvent"in window||(delete tc.animationend.animation,delete tc.animationiteration.animation,delete tc.animationstart.animation),"TransitionEvent"in window||delete tc.transitionend.transition);function Vf(a){if(by[a])return by[a];if(!tc[a])return a;var c=tc[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in Qw)return by[a]=c[d];return a}var Jw=Vf("animationend"),eE=Vf("animationiteration"),tE=Vf("animationstart"),nE=Vf("transitionend"),iE=new Map,rE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function uo(a,c){iE.set(a,c),s(c,[a])}for(var Py=0;Py<rE.length;Py++){var ky=rE[Py],QN=ky.toLowerCase(),JN=ky[0].toUpperCase()+ky.slice(1);uo(QN,"on"+JN)}uo(Jw,"onAnimationEnd"),uo(eE,"onAnimationIteration"),uo(tE,"onAnimationStart"),uo("dblclick","onDoubleClick"),uo("focusin","onFocus"),uo("focusout","onBlur"),uo(nE,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eM=new Set("cancel close invalid load scroll toggle".split(" ").concat(sh));function sE(a,c,d){var m=a.type||"unknown-event";a.currentTarget=d,Fu(m,c,void 0,a),a.currentTarget=null}function oE(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var m=a[d],v=m.event;m=m.listeners;e:{var w=void 0;if(c)for(var k=m.length-1;0<=k;k--){var U=m[k],G=U.instance,J=U.currentTarget;if(U=U.listener,G!==w&&v.isPropagationStopped())break e;sE(v,U,J),w=G}else for(k=0;k<m.length;k++){if(U=m[k],G=U.instance,J=U.currentTarget,U=U.listener,G!==w&&v.isPropagationStopped())break e;sE(v,U,J),w=G}}}if(Vl)throw a=Li,Vl=!1,Li=null,a}function wt(a,c){var d=c[jy];d===void 0&&(d=c[jy]=new Set);var m=a+"__bubble";d.has(m)||(aE(c,a,2,!1),d.add(m))}function Dy(a,c,d){var m=0;c&&(m|=4),aE(d,a,m,c)}var jf="_reactListening"+Math.random().toString(36).slice(2);function oh(a){if(!a[jf]){a[jf]=!0,i.forEach(function(d){d!=="selectionchange"&&(eM.has(d)||Dy(d,!1,a),Dy(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[jf]||(c[jf]=!0,Dy("selectionchange",!1,c))}}function aE(a,c,d,m){switch(Kl(c)){case 1:var v=jr;break;case 4:v=Pf;break;default:v=Yu}d=v.bind(null,c,d,a),v=void 0,!rn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(v=!0),m?v!==void 0?a.addEventListener(c,d,{capture:!0,passive:v}):a.addEventListener(c,d,!0):v!==void 0?a.addEventListener(c,d,{passive:v}):a.addEventListener(c,d,!1)}function Ny(a,c,d,m,v){var w=m;if((c&1)===0&&(c&2)===0&&m!==null)e:for(;;){if(m===null)return;var k=m.tag;if(k===3||k===4){var U=m.stateNode.containerInfo;if(U===v||U.nodeType===8&&U.parentNode===v)break;if(k===4)for(k=m.return;k!==null;){var G=k.tag;if((G===3||G===4)&&(G=k.stateNode.containerInfo,G===v||G.nodeType===8&&G.parentNode===v))return;k=k.return}for(;U!==null;){if(k=Ea(U),k===null)return;if(G=k.tag,G===5||G===6){m=w=k;continue e}U=U.parentNode}}m=m.return}gn(function(){var J=w,oe=Dr(d),ce=[];e:{var re=iE.get(a);if(re!==void 0){var ye=xa,ve=a;switch(a){case"keypress":if(va(d)===0)break e;case"keydown":case"keyup":ye=ut;break;case"focusin":ve="focus",ye=yn;break;case"focusout":ve="blur",ye=yn;break;case"beforeblur":case"afterblur":ye=yn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=Qu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=Nf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=Gr;break;case Jw:case eE:case tE:ye=Lf;break;case nE:ye=Ql;break;case"scroll":ye=Xl;break;case"wheel":ye=FN;break;case"copy":case"cut":case"paste":ye=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=pi}var we=(c&4)!==0,zt=!we&&a==="scroll",H=we?re!==null?re+"Capture":null:re;we=[];for(var K=J,Y;K!==null;){Y=K;var he=Y.stateNode;if(Y.tag===5&&he!==null&&(Y=he,H!==null&&(he=pn(K,H),he!=null&&we.push(ah(K,he,Y)))),zt)break;K=K.return}0<we.length&&(re=new ye(re,ve,null,d,oe),ce.push({event:re,listeners:we}))}}if((c&7)===0){e:{if(re=a==="mouseover"||a==="pointerover",ye=a==="mouseout"||a==="pointerout",re&&d!==kr&&(ve=d.relatedTarget||d.fromElement)&&(Ea(ve)||ve[Ts]))break e;if((ye||re)&&(re=oe.window===oe?oe:(re=oe.ownerDocument)?re.defaultView||re.parentWindow:window,ye?(ve=d.relatedTarget||d.toElement,ye=J,ve=ve?Ea(ve):null,ve!==null&&(zt=ir(ve),ve!==zt||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(ye=null,ve=J),ye!==ve)){if(we=Qu,he="onMouseLeave",H="onMouseEnter",K="mouse",(a==="pointerout"||a==="pointerover")&&(we=pi,he="onPointerLeave",H="onPointerEnter",K="pointer"),zt=ye==null?re:rc(ye),Y=ve==null?re:rc(ve),re=new we(he,K+"leave",ye,d,oe),re.target=zt,re.relatedTarget=Y,he=null,Ea(oe)===J&&(we=new we(H,K+"enter",ve,d,oe),we.target=Y,we.relatedTarget=zt,he=we),zt=he,ye&&ve)t:{for(we=ye,H=ve,K=0,Y=we;Y;Y=nc(Y))K++;for(Y=0,he=H;he;he=nc(he))Y++;for(;0<K-Y;)we=nc(we),K--;for(;0<Y-K;)H=nc(H),Y--;for(;K--;){if(we===H||H!==null&&we===H.alternate)break t;we=nc(we),H=nc(H)}we=null}else we=null;ye!==null&&lE(ce,re,ye,we,!1),ve!==null&&zt!==null&&lE(ce,zt,ve,we,!0)}}e:{if(re=J?rc(J):window,ye=re.nodeName&&re.nodeName.toLowerCase(),ye==="select"||ye==="input"&&re.type==="file")var Te=WN;else if(Uw(re))if(Gw)Te=XN;else{Te=KN;var be=$N}else(ye=re.nodeName)&&ye.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Te=HN);if(Te&&(Te=Te(a,J))){Bw(ce,Te,d,oe);break e}be&&be(a,re,J),a==="focusout"&&(be=re._wrapperState)&&be.controlled&&re.type==="number"&&_t(re,"number",re.value)}switch(be=J?rc(J):window,a){case"focusin":(Uw(be)||be.contentEditable==="true")&&(ec=be,Ry=J,rh=null);break;case"focusout":rh=Ry=ec=null;break;case"mousedown":Ay=!0;break;case"contextmenu":case"mouseup":case"dragend":Ay=!1,Zw(ce,d,oe);break;case"selectionchange":if(ZN)break;case"keydown":case"keyup":Zw(ce,d,oe)}var Pe;if(Ty)e:{switch(a){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else Jl?jw(a,d)&&(Le="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Le="onCompositionStart");Le&&(Ow&&d.locale!=="ko"&&(Jl||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&Jl&&(Pe=kf()):(fi=oe,Hl="value"in fi?fi.value:fi.textContent,Jl=!0)),be=zf(J,Le),0<be.length&&(Le=new C(Le,a,null,d,oe),ce.push({event:Le,listeners:be}),Pe?Le.data=Pe:(Pe=zw(d),Pe!==null&&(Le.data=Pe)))),(Pe=jN?zN(a,d):UN(a,d))&&(J=zf(J,"onBeforeInput"),0<J.length&&(oe=new C("onBeforeInput","beforeinput",null,d,oe),ce.push({event:oe,listeners:J}),oe.data=Pe))}oE(ce,c)})}function ah(a,c,d){return{instance:a,listener:c,currentTarget:d}}function zf(a,c){for(var d=c+"Capture",m=[];a!==null;){var v=a,w=v.stateNode;v.tag===5&&w!==null&&(v=w,w=pn(a,d),w!=null&&m.unshift(ah(a,w,v)),w=pn(a,c),w!=null&&m.push(ah(a,w,v))),a=a.return}return m}function nc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function lE(a,c,d,m,v){for(var w=c._reactName,k=[];d!==null&&d!==m;){var U=d,G=U.alternate,J=U.stateNode;if(G!==null&&G===m)break;U.tag===5&&J!==null&&(U=J,v?(G=pn(d,w),G!=null&&k.unshift(ah(d,G,U))):v||(G=pn(d,w),G!=null&&k.push(ah(d,G,U)))),d=d.return}k.length!==0&&a.push({event:c,listeners:k})}var tM=/\r\n?/g,nM=/\u0000|\uFFFD/g;function cE(a){return(typeof a=="string"?a:""+a).replace(tM,`
`).replace(nM,"")}function Uf(a,c,d){if(c=cE(c),cE(a)!==c&&d)throw Error(t(425))}function Bf(){}var My=null,Ly=null;function Oy(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Fy=typeof setTimeout=="function"?setTimeout:void 0,iM=typeof clearTimeout=="function"?clearTimeout:void 0,uE=typeof Promise=="function"?Promise:void 0,rM=typeof queueMicrotask=="function"?queueMicrotask:typeof uE<"u"?function(a){return uE.resolve(null).then(a).catch(sM)}:Fy;function sM(a){setTimeout(function(){throw a})}function Vy(a,c){var d=c,m=0;do{var v=d.nextSibling;if(a.removeChild(d),v&&v.nodeType===8)if(d=v.data,d==="/$"){if(m===0){a.removeChild(v),ao(c);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=v}while(d);ao(c)}function ho(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function hE(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var ic=Math.random().toString(36).slice(2),$r="__reactFiber$"+ic,lh="__reactProps$"+ic,Ts="__reactContainer$"+ic,jy="__reactEvents$"+ic,oM="__reactListeners$"+ic,aM="__reactHandles$"+ic;function Ea(a){var c=a[$r];if(c)return c;for(var d=a.parentNode;d;){if(c=d[Ts]||d[$r]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=hE(a);a!==null;){if(d=a[$r])return d;a=hE(a)}return c}a=d,d=a.parentNode}return null}function ch(a){return a=a[$r]||a[Ts],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function rc(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Gf(a){return a[lh]||null}var zy=[],sc=-1;function fo(a){return{current:a}}function Et(a){0>sc||(a.current=zy[sc],zy[sc]=null,sc--)}function vt(a,c){sc++,zy[sc]=a.current,a.current=c}var go={},Rn=fo(go),Hn=fo(!1),Ta=go;function oc(a,c){var d=a.type.contextTypes;if(!d)return go;var m=a.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===c)return m.__reactInternalMemoizedMaskedChildContext;var v={},w;for(w in d)v[w]=c[w];return m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=v),v}function Xn(a){return a=a.childContextTypes,a!=null}function Wf(){Et(Hn),Et(Rn)}function dE(a,c,d){if(Rn.current!==go)throw Error(t(168));vt(Rn,c),vt(Hn,d)}function fE(a,c,d){var m=a.stateNode;if(c=c.childContextTypes,typeof m.getChildContext!="function")return d;m=m.getChildContext();for(var v in m)if(!(v in c))throw Error(t(108,Me(a)||"Unknown",v));return ne({},d,m)}function $f(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||go,Ta=Rn.current,vt(Rn,a),vt(Hn,Hn.current),!0}function gE(a,c,d){var m=a.stateNode;if(!m)throw Error(t(169));d?(a=fE(a,c,Ta),m.__reactInternalMemoizedMergedChildContext=a,Et(Hn),Et(Rn),vt(Rn,a)):Et(Hn),vt(Hn,d)}var Ss=null,Kf=!1,Uy=!1;function pE(a){Ss===null?Ss=[a]:Ss.push(a)}function lM(a){Kf=!0,pE(a)}function po(){if(!Uy&&Ss!==null){Uy=!0;var a=0,c=Xe;try{var d=Ss;for(Xe=1;a<d.length;a++){var m=d[a];do m=m(!0);while(m!==null)}Ss=null,Kf=!1}catch(v){throw Ss!==null&&(Ss=Ss.slice(a+1)),ju(zl,po),v}finally{Xe=c,Uy=!1}}return null}var ac=[],lc=0,Hf=null,Xf=0,Fi=[],Vi=0,Sa=null,Is=1,Cs="";function Ia(a,c){ac[lc++]=Xf,ac[lc++]=Hf,Hf=a,Xf=c}function mE(a,c,d){Fi[Vi++]=Is,Fi[Vi++]=Cs,Fi[Vi++]=Sa,Sa=a;var m=Is;a=Cs;var v=32-hi(m)-1;m&=~(1<<v),d+=1;var w=32-hi(c)+v;if(30<w){var k=v-v%5;w=(m&(1<<k)-1).toString(32),m>>=k,v-=k,Is=1<<32-hi(c)+v|d<<v|m,Cs=w+a}else Is=1<<w|d<<v|m,Cs=a}function By(a){a.return!==null&&(Ia(a,1),mE(a,1,0))}function Gy(a){for(;a===Hf;)Hf=ac[--lc],ac[lc]=null,Xf=ac[--lc],ac[lc]=null;for(;a===Sa;)Sa=Fi[--Vi],Fi[Vi]=null,Cs=Fi[--Vi],Fi[Vi]=null,Is=Fi[--Vi],Fi[Vi]=null}var mi=null,yi=null,Ct=!1,or=null;function yE(a,c){var d=Bi(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function _E(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,mi=a,yi=ho(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,mi=a,yi=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Sa!==null?{id:Is,overflow:Cs}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=Bi(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,mi=a,yi=null,!0):!1;default:return!1}}function Wy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function $y(a){if(Ct){var c=yi;if(c){var d=c;if(!_E(a,c)){if(Wy(a))throw Error(t(418));c=ho(d.nextSibling);var m=mi;c&&_E(a,c)?yE(m,d):(a.flags=a.flags&-4097|2,Ct=!1,mi=a)}}else{if(Wy(a))throw Error(t(418));a.flags=a.flags&-4097|2,Ct=!1,mi=a}}}function vE(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;mi=a}function qf(a){if(a!==mi)return!1;if(!Ct)return vE(a),Ct=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!Oy(a.type,a.memoizedProps)),c&&(c=yi)){if(Wy(a))throw xE(),Error(t(418));for(;c;)yE(a,c),c=ho(c.nextSibling)}if(vE(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){yi=ho(a.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}yi=null}}else yi=mi?ho(a.stateNode.nextSibling):null;return!0}function xE(){for(var a=yi;a;)a=ho(a.nextSibling)}function cc(){yi=mi=null,Ct=!1}function Ky(a){or===null?or=[a]:or.push(a)}var cM=R.ReactCurrentBatchConfig;function uh(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var m=d.stateNode}if(!m)throw Error(t(147,a));var v=m,w=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===w?c.ref:(c=function(k){var U=v.refs;k===null?delete U[w]:U[w]=k},c._stringRef=w,c)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function Yf(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function wE(a){var c=a._init;return c(a._payload)}function EE(a){function c(H,K){if(a){var Y=H.deletions;Y===null?(H.deletions=[K],H.flags|=16):Y.push(K)}}function d(H,K){if(!a)return null;for(;K!==null;)c(H,K),K=K.sibling;return null}function m(H,K){for(H=new Map;K!==null;)K.key!==null?H.set(K.key,K):H.set(K.index,K),K=K.sibling;return H}function v(H,K){return H=To(H,K),H.index=0,H.sibling=null,H}function w(H,K,Y){return H.index=Y,a?(Y=H.alternate,Y!==null?(Y=Y.index,Y<K?(H.flags|=2,K):Y):(H.flags|=2,K)):(H.flags|=1048576,K)}function k(H){return a&&H.alternate===null&&(H.flags|=2),H}function U(H,K,Y,he){return K===null||K.tag!==6?(K=F_(Y,H.mode,he),K.return=H,K):(K=v(K,Y),K.return=H,K)}function G(H,K,Y,he){var Te=Y.type;return Te===D?oe(H,K,Y.props.children,he,Y.key):K!==null&&(K.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&wE(Te)===K.type)?(he=v(K,Y.props),he.ref=uh(H,K,Y),he.return=H,he):(he=xg(Y.type,Y.key,Y.props,null,H.mode,he),he.ref=uh(H,K,Y),he.return=H,he)}function J(H,K,Y,he){return K===null||K.tag!==4||K.stateNode.containerInfo!==Y.containerInfo||K.stateNode.implementation!==Y.implementation?(K=V_(Y,H.mode,he),K.return=H,K):(K=v(K,Y.children||[]),K.return=H,K)}function oe(H,K,Y,he,Te){return K===null||K.tag!==7?(K=Na(Y,H.mode,he,Te),K.return=H,K):(K=v(K,Y),K.return=H,K)}function ce(H,K,Y){if(typeof K=="string"&&K!==""||typeof K=="number")return K=F_(""+K,H.mode,Y),K.return=H,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case L:return Y=xg(K.type,K.key,K.props,null,H.mode,Y),Y.ref=uh(H,null,K),Y.return=H,Y;case j:return K=V_(K,H.mode,Y),K.return=H,K;case ge:var he=K._init;return ce(H,he(K._payload),Y)}if(ct(K)||se(K))return K=Na(K,H.mode,Y,null),K.return=H,K;Yf(H,K)}return null}function re(H,K,Y,he){var Te=K!==null?K.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Te!==null?null:U(H,K,""+Y,he);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case L:return Y.key===Te?G(H,K,Y,he):null;case j:return Y.key===Te?J(H,K,Y,he):null;case ge:return Te=Y._init,re(H,K,Te(Y._payload),he)}if(ct(Y)||se(Y))return Te!==null?null:oe(H,K,Y,he,null);Yf(H,Y)}return null}function ye(H,K,Y,he,Te){if(typeof he=="string"&&he!==""||typeof he=="number")return H=H.get(Y)||null,U(K,H,""+he,Te);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case L:return H=H.get(he.key===null?Y:he.key)||null,G(K,H,he,Te);case j:return H=H.get(he.key===null?Y:he.key)||null,J(K,H,he,Te);case ge:var be=he._init;return ye(H,K,Y,be(he._payload),Te)}if(ct(he)||se(he))return H=H.get(Y)||null,oe(K,H,he,Te,null);Yf(K,he)}return null}function ve(H,K,Y,he){for(var Te=null,be=null,Pe=K,Le=K=0,an=null;Pe!==null&&Le<Y.length;Le++){Pe.index>Le?(an=Pe,Pe=null):an=Pe.sibling;var et=re(H,Pe,Y[Le],he);if(et===null){Pe===null&&(Pe=an);break}a&&Pe&&et.alternate===null&&c(H,Pe),K=w(et,K,Le),be===null?Te=et:be.sibling=et,be=et,Pe=an}if(Le===Y.length)return d(H,Pe),Ct&&Ia(H,Le),Te;if(Pe===null){for(;Le<Y.length;Le++)Pe=ce(H,Y[Le],he),Pe!==null&&(K=w(Pe,K,Le),be===null?Te=Pe:be.sibling=Pe,be=Pe);return Ct&&Ia(H,Le),Te}for(Pe=m(H,Pe);Le<Y.length;Le++)an=ye(Pe,H,Le,Y[Le],he),an!==null&&(a&&an.alternate!==null&&Pe.delete(an.key===null?Le:an.key),K=w(an,K,Le),be===null?Te=an:be.sibling=an,be=an);return a&&Pe.forEach(function(So){return c(H,So)}),Ct&&Ia(H,Le),Te}function we(H,K,Y,he){var Te=se(Y);if(typeof Te!="function")throw Error(t(150));if(Y=Te.call(Y),Y==null)throw Error(t(151));for(var be=Te=null,Pe=K,Le=K=0,an=null,et=Y.next();Pe!==null&&!et.done;Le++,et=Y.next()){Pe.index>Le?(an=Pe,Pe=null):an=Pe.sibling;var So=re(H,Pe,et.value,he);if(So===null){Pe===null&&(Pe=an);break}a&&Pe&&So.alternate===null&&c(H,Pe),K=w(So,K,Le),be===null?Te=So:be.sibling=So,be=So,Pe=an}if(et.done)return d(H,Pe),Ct&&Ia(H,Le),Te;if(Pe===null){for(;!et.done;Le++,et=Y.next())et=ce(H,et.value,he),et!==null&&(K=w(et,K,Le),be===null?Te=et:be.sibling=et,be=et);return Ct&&Ia(H,Le),Te}for(Pe=m(H,Pe);!et.done;Le++,et=Y.next())et=ye(Pe,H,Le,et.value,he),et!==null&&(a&&et.alternate!==null&&Pe.delete(et.key===null?Le:et.key),K=w(et,K,Le),be===null?Te=et:be.sibling=et,be=et);return a&&Pe.forEach(function(BM){return c(H,BM)}),Ct&&Ia(H,Le),Te}function zt(H,K,Y,he){if(typeof Y=="object"&&Y!==null&&Y.type===D&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case L:e:{for(var Te=Y.key,be=K;be!==null;){if(be.key===Te){if(Te=Y.type,Te===D){if(be.tag===7){d(H,be.sibling),K=v(be,Y.props.children),K.return=H,H=K;break e}}else if(be.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&wE(Te)===be.type){d(H,be.sibling),K=v(be,Y.props),K.ref=uh(H,be,Y),K.return=H,H=K;break e}d(H,be);break}else c(H,be);be=be.sibling}Y.type===D?(K=Na(Y.props.children,H.mode,he,Y.key),K.return=H,H=K):(he=xg(Y.type,Y.key,Y.props,null,H.mode,he),he.ref=uh(H,K,Y),he.return=H,H=he)}return k(H);case j:e:{for(be=Y.key;K!==null;){if(K.key===be)if(K.tag===4&&K.stateNode.containerInfo===Y.containerInfo&&K.stateNode.implementation===Y.implementation){d(H,K.sibling),K=v(K,Y.children||[]),K.return=H,H=K;break e}else{d(H,K);break}else c(H,K);K=K.sibling}K=V_(Y,H.mode,he),K.return=H,H=K}return k(H);case ge:return be=Y._init,zt(H,K,be(Y._payload),he)}if(ct(Y))return ve(H,K,Y,he);if(se(Y))return we(H,K,Y,he);Yf(H,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,K!==null&&K.tag===6?(d(H,K.sibling),K=v(K,Y),K.return=H,H=K):(d(H,K),K=F_(Y,H.mode,he),K.return=H,H=K),k(H)):d(H,K)}return zt}var uc=EE(!0),TE=EE(!1),Zf=fo(null),Qf=null,hc=null,Hy=null;function Xy(){Hy=hc=Qf=null}function qy(a){var c=Zf.current;Et(Zf),a._currentValue=c}function Yy(a,c,d){for(;a!==null;){var m=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),a===d)break;a=a.return}}function dc(a,c){Qf=a,Hy=hc=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(qn=!0),a.firstContext=null)}function ji(a){var c=a._currentValue;if(Hy!==a)if(a={context:a,memoizedValue:c,next:null},hc===null){if(Qf===null)throw Error(t(308));hc=a,Qf.dependencies={lanes:0,firstContext:a}}else hc=hc.next=a;return c}var Ca=null;function Zy(a){Ca===null?Ca=[a]:Ca.push(a)}function SE(a,c,d,m){var v=c.interleaved;return v===null?(d.next=d,Zy(c)):(d.next=v.next,v.next=d),c.interleaved=d,Rs(a,m)}function Rs(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var mo=!1;function Qy(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function IE(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function As(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function yo(a,c,d){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(Je&2)!==0){var v=m.pending;return v===null?c.next=c:(c.next=v.next,v.next=c),m.pending=c,Rs(a,d)}return v=m.interleaved,v===null?(c.next=c,Zy(m)):(c.next=v.next,v.next=c),m.interleaved=c,Rs(a,d)}function Jf(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,$u(a,d)}}function CE(a,c){var d=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var v=null,w=null;if(d=d.firstBaseUpdate,d!==null){do{var k={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};w===null?v=w=k:w=w.next=k,d=d.next}while(d!==null);w===null?v=w=c:w=w.next=c}else v=w=c;d={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:m.shared,effects:m.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function eg(a,c,d,m){var v=a.updateQueue;mo=!1;var w=v.firstBaseUpdate,k=v.lastBaseUpdate,U=v.shared.pending;if(U!==null){v.shared.pending=null;var G=U,J=G.next;G.next=null,k===null?w=J:k.next=J,k=G;var oe=a.alternate;oe!==null&&(oe=oe.updateQueue,U=oe.lastBaseUpdate,U!==k&&(U===null?oe.firstBaseUpdate=J:U.next=J,oe.lastBaseUpdate=G))}if(w!==null){var ce=v.baseState;k=0,oe=J=G=null,U=w;do{var re=U.lane,ye=U.eventTime;if((m&re)===re){oe!==null&&(oe=oe.next={eventTime:ye,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var ve=a,we=U;switch(re=c,ye=d,we.tag){case 1:if(ve=we.payload,typeof ve=="function"){ce=ve.call(ye,ce,re);break e}ce=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=we.payload,re=typeof ve=="function"?ve.call(ye,ce,re):ve,re==null)break e;ce=ne({},ce,re);break e;case 2:mo=!0}}U.callback!==null&&U.lane!==0&&(a.flags|=64,re=v.effects,re===null?v.effects=[U]:re.push(U))}else ye={eventTime:ye,lane:re,tag:U.tag,payload:U.payload,callback:U.callback,next:null},oe===null?(J=oe=ye,G=ce):oe=oe.next=ye,k|=re;if(U=U.next,U===null){if(U=v.shared.pending,U===null)break;re=U,U=re.next,re.next=null,v.lastBaseUpdate=re,v.shared.pending=null}}while(!0);if(oe===null&&(G=ce),v.baseState=G,v.firstBaseUpdate=J,v.lastBaseUpdate=oe,c=v.shared.interleaved,c!==null){v=c;do k|=v.lane,v=v.next;while(v!==c)}else w===null&&(v.shared.lanes=0);ba|=k,a.lanes=k,a.memoizedState=ce}}function RE(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var m=a[c],v=m.callback;if(v!==null){if(m.callback=null,m=d,typeof v!="function")throw Error(t(191,v));v.call(m)}}}var hh={},Kr=fo(hh),dh=fo(hh),fh=fo(hh);function Ra(a){if(a===hh)throw Error(t(174));return a}function Jy(a,c){switch(vt(fh,c),vt(dh,a),vt(Kr,hh),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:tr(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=tr(c,a)}Et(Kr),vt(Kr,c)}function fc(){Et(Kr),Et(dh),Et(fh)}function AE(a){Ra(fh.current);var c=Ra(Kr.current),d=tr(c,a.type);c!==d&&(vt(dh,a),vt(Kr,d))}function e_(a){dh.current===a&&(Et(Kr),Et(dh))}var bt=fo(0);function tg(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var t_=[];function n_(){for(var a=0;a<t_.length;a++)t_[a]._workInProgressVersionPrimary=null;t_.length=0}var ng=R.ReactCurrentDispatcher,i_=R.ReactCurrentBatchConfig,Aa=0,Pt=null,Yt=null,sn=null,ig=!1,gh=!1,ph=0,uM=0;function An(){throw Error(t(321))}function r_(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!sr(a[d],c[d]))return!1;return!0}function s_(a,c,d,m,v,w){if(Aa=w,Pt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,ng.current=a===null||a.memoizedState===null?gM:pM,a=d(m,v),gh){w=0;do{if(gh=!1,ph=0,25<=w)throw Error(t(301));w+=1,sn=Yt=null,c.updateQueue=null,ng.current=mM,a=d(m,v)}while(gh)}if(ng.current=og,c=Yt!==null&&Yt.next!==null,Aa=0,sn=Yt=Pt=null,ig=!1,c)throw Error(t(300));return a}function o_(){var a=ph!==0;return ph=0,a}function Hr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?Pt.memoizedState=sn=a:sn=sn.next=a,sn}function zi(){if(Yt===null){var a=Pt.alternate;a=a!==null?a.memoizedState:null}else a=Yt.next;var c=sn===null?Pt.memoizedState:sn.next;if(c!==null)sn=c,Yt=a;else{if(a===null)throw Error(t(310));Yt=a,a={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},sn===null?Pt.memoizedState=sn=a:sn=sn.next=a}return sn}function mh(a,c){return typeof c=="function"?c(a):c}function a_(a){var c=zi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=Yt,v=m.baseQueue,w=d.pending;if(w!==null){if(v!==null){var k=v.next;v.next=w.next,w.next=k}m.baseQueue=v=w,d.pending=null}if(v!==null){w=v.next,m=m.baseState;var U=k=null,G=null,J=w;do{var oe=J.lane;if((Aa&oe)===oe)G!==null&&(G=G.next={lane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),m=J.hasEagerState?J.eagerState:a(m,J.action);else{var ce={lane:oe,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null};G===null?(U=G=ce,k=m):G=G.next=ce,Pt.lanes|=oe,ba|=oe}J=J.next}while(J!==null&&J!==w);G===null?k=m:G.next=U,sr(m,c.memoizedState)||(qn=!0),c.memoizedState=m,c.baseState=k,c.baseQueue=G,d.lastRenderedState=m}if(a=d.interleaved,a!==null){v=a;do w=v.lane,Pt.lanes|=w,ba|=w,v=v.next;while(v!==a)}else v===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function l_(a){var c=zi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=d.dispatch,v=d.pending,w=c.memoizedState;if(v!==null){d.pending=null;var k=v=v.next;do w=a(w,k.action),k=k.next;while(k!==v);sr(w,c.memoizedState)||(qn=!0),c.memoizedState=w,c.baseQueue===null&&(c.baseState=w),d.lastRenderedState=w}return[w,m]}function bE(){}function PE(a,c){var d=Pt,m=zi(),v=c(),w=!sr(m.memoizedState,v);if(w&&(m.memoizedState=v,qn=!0),m=m.queue,c_(NE.bind(null,d,m,a),[a]),m.getSnapshot!==c||w||sn!==null&&sn.memoizedState.tag&1){if(d.flags|=2048,yh(9,DE.bind(null,d,m,v,c),void 0,null),on===null)throw Error(t(349));(Aa&30)!==0||kE(d,c,v)}return v}function kE(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function DE(a,c,d,m){c.value=d,c.getSnapshot=m,ME(c)&&LE(a)}function NE(a,c,d){return d(function(){ME(c)&&LE(a)})}function ME(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!sr(a,d)}catch{return!0}}function LE(a){var c=Rs(a,1);c!==null&&ur(c,a,1,-1)}function OE(a){var c=Hr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mh,lastRenderedState:a},c.queue=a,a=a.dispatch=fM.bind(null,Pt,a),[c.memoizedState,a]}function yh(a,c,d,m){return a={tag:a,create:c,destroy:d,deps:m,next:null},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(m=d.next,d.next=a,a.next=m,c.lastEffect=a)),a}function FE(){return zi().memoizedState}function rg(a,c,d,m){var v=Hr();Pt.flags|=a,v.memoizedState=yh(1|c,d,void 0,m===void 0?null:m)}function sg(a,c,d,m){var v=zi();m=m===void 0?null:m;var w=void 0;if(Yt!==null){var k=Yt.memoizedState;if(w=k.destroy,m!==null&&r_(m,k.deps)){v.memoizedState=yh(c,d,w,m);return}}Pt.flags|=a,v.memoizedState=yh(1|c,d,w,m)}function VE(a,c){return rg(8390656,8,a,c)}function c_(a,c){return sg(2048,8,a,c)}function jE(a,c){return sg(4,2,a,c)}function zE(a,c){return sg(4,4,a,c)}function UE(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function BE(a,c,d){return d=d!=null?d.concat([a]):null,sg(4,4,UE.bind(null,c,a),d)}function u_(){}function GE(a,c){var d=zi();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&r_(c,m[1])?m[0]:(d.memoizedState=[a,c],a)}function WE(a,c){var d=zi();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&r_(c,m[1])?m[0]:(a=a(),d.memoizedState=[a,c],a)}function $E(a,c,d){return(Aa&21)===0?(a.baseState&&(a.baseState=!1,qn=!0),a.memoizedState=d):(sr(d,c)||(d=Gu(),Pt.lanes|=d,ba|=d,a.baseState=!0),c)}function hM(a,c){var d=Xe;Xe=d!==0&&4>d?d:4,a(!0);var m=i_.transition;i_.transition={};try{a(!1),c()}finally{Xe=d,i_.transition=m}}function KE(){return zi().memoizedState}function dM(a,c,d){var m=wo(a);if(d={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null},HE(a))XE(c,d);else if(d=SE(a,c,d,m),d!==null){var v=zn();ur(d,a,m,v),qE(d,c,m)}}function fM(a,c,d){var m=wo(a),v={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null};if(HE(a))XE(c,v);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=c.lastRenderedReducer,w!==null))try{var k=c.lastRenderedState,U=w(k,d);if(v.hasEagerState=!0,v.eagerState=U,sr(U,k)){var G=c.interleaved;G===null?(v.next=v,Zy(c)):(v.next=G.next,G.next=v),c.interleaved=v;return}}catch{}d=SE(a,c,v,m),d!==null&&(v=zn(),ur(d,a,m,v),qE(d,c,m))}}function HE(a){var c=a.alternate;return a===Pt||c!==null&&c===Pt}function XE(a,c){gh=ig=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function qE(a,c,d){if((d&4194240)!==0){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,$u(a,d)}}var og={readContext:ji,useCallback:An,useContext:An,useEffect:An,useImperativeHandle:An,useInsertionEffect:An,useLayoutEffect:An,useMemo:An,useReducer:An,useRef:An,useState:An,useDebugValue:An,useDeferredValue:An,useTransition:An,useMutableSource:An,useSyncExternalStore:An,useId:An,unstable_isNewReconciler:!1},gM={readContext:ji,useCallback:function(a,c){return Hr().memoizedState=[a,c===void 0?null:c],a},useContext:ji,useEffect:VE,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,rg(4194308,4,UE.bind(null,c,a),d)},useLayoutEffect:function(a,c){return rg(4194308,4,a,c)},useInsertionEffect:function(a,c){return rg(4,2,a,c)},useMemo:function(a,c){var d=Hr();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var m=Hr();return c=d!==void 0?d(c):c,m.memoizedState=m.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},m.queue=a,a=a.dispatch=dM.bind(null,Pt,a),[m.memoizedState,a]},useRef:function(a){var c=Hr();return a={current:a},c.memoizedState=a},useState:OE,useDebugValue:u_,useDeferredValue:function(a){return Hr().memoizedState=a},useTransition:function(){var a=OE(!1),c=a[0];return a=hM.bind(null,a[1]),Hr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var m=Pt,v=Hr();if(Ct){if(d===void 0)throw Error(t(407));d=d()}else{if(d=c(),on===null)throw Error(t(349));(Aa&30)!==0||kE(m,c,d)}v.memoizedState=d;var w={value:d,getSnapshot:c};return v.queue=w,VE(NE.bind(null,m,w,a),[a]),m.flags|=2048,yh(9,DE.bind(null,m,w,d,c),void 0,null),d},useId:function(){var a=Hr(),c=on.identifierPrefix;if(Ct){var d=Cs,m=Is;d=(m&~(1<<32-hi(m)-1)).toString(32)+d,c=":"+c+"R"+d,d=ph++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=uM++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},pM={readContext:ji,useCallback:GE,useContext:ji,useEffect:c_,useImperativeHandle:BE,useInsertionEffect:jE,useLayoutEffect:zE,useMemo:WE,useReducer:a_,useRef:FE,useState:function(){return a_(mh)},useDebugValue:u_,useDeferredValue:function(a){var c=zi();return $E(c,Yt.memoizedState,a)},useTransition:function(){var a=a_(mh)[0],c=zi().memoizedState;return[a,c]},useMutableSource:bE,useSyncExternalStore:PE,useId:KE,unstable_isNewReconciler:!1},mM={readContext:ji,useCallback:GE,useContext:ji,useEffect:c_,useImperativeHandle:BE,useInsertionEffect:jE,useLayoutEffect:zE,useMemo:WE,useReducer:l_,useRef:FE,useState:function(){return l_(mh)},useDebugValue:u_,useDeferredValue:function(a){var c=zi();return Yt===null?c.memoizedState=a:$E(c,Yt.memoizedState,a)},useTransition:function(){var a=l_(mh)[0],c=zi().memoizedState;return[a,c]},useMutableSource:bE,useSyncExternalStore:PE,useId:KE,unstable_isNewReconciler:!1};function ar(a,c){if(a&&a.defaultProps){c=ne({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function h_(a,c,d,m){c=a.memoizedState,d=d(m,c),d=d==null?c:ne({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var ag={isMounted:function(a){return(a=a._reactInternals)?ir(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var m=zn(),v=wo(a),w=As(m,v);w.payload=c,d!=null&&(w.callback=d),c=yo(a,w,v),c!==null&&(ur(c,a,v,m),Jf(c,a,v))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var m=zn(),v=wo(a),w=As(m,v);w.tag=1,w.payload=c,d!=null&&(w.callback=d),c=yo(a,w,v),c!==null&&(ur(c,a,v,m),Jf(c,a,v))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=zn(),m=wo(a),v=As(d,m);v.tag=2,c!=null&&(v.callback=c),c=yo(a,v,m),c!==null&&(ur(c,a,m,d),Jf(c,a,m))}};function YE(a,c,d,m,v,w,k){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,w,k):c.prototype&&c.prototype.isPureReactComponent?!ih(d,m)||!ih(v,w):!0}function ZE(a,c,d){var m=!1,v=go,w=c.contextType;return typeof w=="object"&&w!==null?w=ji(w):(v=Xn(c)?Ta:Rn.current,m=c.contextTypes,w=(m=m!=null)?oc(a,v):go),c=new c(d,w),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=ag,a.stateNode=c,c._reactInternals=a,m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=w),c}function QE(a,c,d,m){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,m),c.state!==a&&ag.enqueueReplaceState(c,c.state,null)}function d_(a,c,d,m){var v=a.stateNode;v.props=d,v.state=a.memoizedState,v.refs={},Qy(a);var w=c.contextType;typeof w=="object"&&w!==null?v.context=ji(w):(w=Xn(c)?Ta:Rn.current,v.context=oc(a,w)),v.state=a.memoizedState,w=c.getDerivedStateFromProps,typeof w=="function"&&(h_(a,c,w,d),v.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(c=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),c!==v.state&&ag.enqueueReplaceState(v,v.state,null),eg(a,d,v,m),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function gc(a,c){try{var d="",m=c;do d+=xe(m),m=m.return;while(m);var v=d}catch(w){v=`
Error generating stack: `+w.message+`
`+w.stack}return{value:a,source:c,stack:v,digest:null}}function f_(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function g_(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var yM=typeof WeakMap=="function"?WeakMap:Map;function JE(a,c,d){d=As(-1,d),d.tag=3,d.payload={element:null};var m=c.value;return d.callback=function(){gg||(gg=!0,b_=m),g_(a,c)},d}function eT(a,c,d){d=As(-1,d),d.tag=3;var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var v=c.value;d.payload=function(){return m(v)},d.callback=function(){g_(a,c)}}var w=a.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(d.callback=function(){g_(a,c),typeof m!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var k=c.stack;this.componentDidCatch(c.value,{componentStack:k!==null?k:""})}),d}function tT(a,c,d){var m=a.pingCache;if(m===null){m=a.pingCache=new yM;var v=new Set;m.set(c,v)}else v=m.get(c),v===void 0&&(v=new Set,m.set(c,v));v.has(d)||(v.add(d),a=kM.bind(null,a,c,d),c.then(a,a))}function nT(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function iT(a,c,d,m,v){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=As(-1,1),c.tag=2,yo(d,c,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=v,a)}var _M=R.ReactCurrentOwner,qn=!1;function jn(a,c,d,m){c.child=a===null?TE(c,null,d,m):uc(c,a.child,d,m)}function rT(a,c,d,m,v){d=d.render;var w=c.ref;return dc(c,v),m=s_(a,c,d,m,w,v),d=o_(),a!==null&&!qn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,bs(a,c,v)):(Ct&&d&&By(c),c.flags|=1,jn(a,c,m,v),c.child)}function sT(a,c,d,m,v){if(a===null){var w=d.type;return typeof w=="function"&&!O_(w)&&w.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=w,oT(a,c,w,m,v)):(a=xg(d.type,null,m,c,c.mode,v),a.ref=c.ref,a.return=c,c.child=a)}if(w=a.child,(a.lanes&v)===0){var k=w.memoizedProps;if(d=d.compare,d=d!==null?d:ih,d(k,m)&&a.ref===c.ref)return bs(a,c,v)}return c.flags|=1,a=To(w,m),a.ref=c.ref,a.return=c,c.child=a}function oT(a,c,d,m,v){if(a!==null){var w=a.memoizedProps;if(ih(w,m)&&a.ref===c.ref)if(qn=!1,c.pendingProps=m=w,(a.lanes&v)!==0)(a.flags&131072)!==0&&(qn=!0);else return c.lanes=a.lanes,bs(a,c,v)}return p_(a,c,d,m,v)}function aT(a,c,d){var m=c.pendingProps,v=m.children,w=a!==null?a.memoizedState:null;if(m.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(mc,_i),_i|=d;else{if((d&1073741824)===0)return a=w!==null?w.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,vt(mc,_i),_i|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=w!==null?w.baseLanes:d,vt(mc,_i),_i|=m}else w!==null?(m=w.baseLanes|d,c.memoizedState=null):m=d,vt(mc,_i),_i|=m;return jn(a,c,v,d),c.child}function lT(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function p_(a,c,d,m,v){var w=Xn(d)?Ta:Rn.current;return w=oc(c,w),dc(c,v),d=s_(a,c,d,m,w,v),m=o_(),a!==null&&!qn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,bs(a,c,v)):(Ct&&m&&By(c),c.flags|=1,jn(a,c,d,v),c.child)}function cT(a,c,d,m,v){if(Xn(d)){var w=!0;$f(c)}else w=!1;if(dc(c,v),c.stateNode===null)cg(a,c),ZE(c,d,m),d_(c,d,m,v),m=!0;else if(a===null){var k=c.stateNode,U=c.memoizedProps;k.props=U;var G=k.context,J=d.contextType;typeof J=="object"&&J!==null?J=ji(J):(J=Xn(d)?Ta:Rn.current,J=oc(c,J));var oe=d.getDerivedStateFromProps,ce=typeof oe=="function"||typeof k.getSnapshotBeforeUpdate=="function";ce||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(U!==m||G!==J)&&QE(c,k,m,J),mo=!1;var re=c.memoizedState;k.state=re,eg(c,m,k,v),G=c.memoizedState,U!==m||re!==G||Hn.current||mo?(typeof oe=="function"&&(h_(c,d,oe,m),G=c.memoizedState),(U=mo||YE(c,d,U,m,re,G,J))?(ce||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(c.flags|=4194308)):(typeof k.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=G),k.props=m,k.state=G,k.context=J,m=U):(typeof k.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{k=c.stateNode,IE(a,c),U=c.memoizedProps,J=c.type===c.elementType?U:ar(c.type,U),k.props=J,ce=c.pendingProps,re=k.context,G=d.contextType,typeof G=="object"&&G!==null?G=ji(G):(G=Xn(d)?Ta:Rn.current,G=oc(c,G));var ye=d.getDerivedStateFromProps;(oe=typeof ye=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(U!==ce||re!==G)&&QE(c,k,m,G),mo=!1,re=c.memoizedState,k.state=re,eg(c,m,k,v);var ve=c.memoizedState;U!==ce||re!==ve||Hn.current||mo?(typeof ye=="function"&&(h_(c,d,ye,m),ve=c.memoizedState),(J=mo||YE(c,d,J,m,re,ve,G)||!1)?(oe||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(m,ve,G),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(m,ve,G)),typeof k.componentDidUpdate=="function"&&(c.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof k.componentDidUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=ve),k.props=m,k.state=ve,k.context=G,m=J):(typeof k.componentDidUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=1024),m=!1)}return m_(a,c,d,m,w,v)}function m_(a,c,d,m,v,w){lT(a,c);var k=(c.flags&128)!==0;if(!m&&!k)return v&&gE(c,d,!1),bs(a,c,w);m=c.stateNode,_M.current=c;var U=k&&typeof d.getDerivedStateFromError!="function"?null:m.render();return c.flags|=1,a!==null&&k?(c.child=uc(c,a.child,null,w),c.child=uc(c,null,U,w)):jn(a,c,U,w),c.memoizedState=m.state,v&&gE(c,d,!0),c.child}function uT(a){var c=a.stateNode;c.pendingContext?dE(a,c.pendingContext,c.pendingContext!==c.context):c.context&&dE(a,c.context,!1),Jy(a,c.containerInfo)}function hT(a,c,d,m,v){return cc(),Ky(v),c.flags|=256,jn(a,c,d,m),c.child}var y_={dehydrated:null,treeContext:null,retryLane:0};function __(a){return{baseLanes:a,cachePool:null,transitions:null}}function dT(a,c,d){var m=c.pendingProps,v=bt.current,w=!1,k=(c.flags&128)!==0,U;if((U=k)||(U=a!==null&&a.memoizedState===null?!1:(v&2)!==0),U?(w=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),vt(bt,v&1),a===null)return $y(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(k=m.children,a=m.fallback,w?(m=c.mode,w=c.child,k={mode:"hidden",children:k},(m&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=k):w=wg(k,m,0,null),a=Na(a,m,d,null),w.return=c,a.return=c,w.sibling=a,c.child=w,c.child.memoizedState=__(d),c.memoizedState=y_,a):v_(c,k));if(v=a.memoizedState,v!==null&&(U=v.dehydrated,U!==null))return vM(a,c,k,m,U,v,d);if(w){w=m.fallback,k=c.mode,v=a.child,U=v.sibling;var G={mode:"hidden",children:m.children};return(k&1)===0&&c.child!==v?(m=c.child,m.childLanes=0,m.pendingProps=G,c.deletions=null):(m=To(v,G),m.subtreeFlags=v.subtreeFlags&14680064),U!==null?w=To(U,w):(w=Na(w,k,d,null),w.flags|=2),w.return=c,m.return=c,m.sibling=w,c.child=m,m=w,w=c.child,k=a.child.memoizedState,k=k===null?__(d):{baseLanes:k.baseLanes|d,cachePool:null,transitions:k.transitions},w.memoizedState=k,w.childLanes=a.childLanes&~d,c.memoizedState=y_,m}return w=a.child,a=w.sibling,m=To(w,{mode:"visible",children:m.children}),(c.mode&1)===0&&(m.lanes=d),m.return=c,m.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=m,c.memoizedState=null,m}function v_(a,c){return c=wg({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function lg(a,c,d,m){return m!==null&&Ky(m),uc(c,a.child,null,d),a=v_(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function vM(a,c,d,m,v,w,k){if(d)return c.flags&256?(c.flags&=-257,m=f_(Error(t(422))),lg(a,c,k,m)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(w=m.fallback,v=c.mode,m=wg({mode:"visible",children:m.children},v,0,null),w=Na(w,v,k,null),w.flags|=2,m.return=c,w.return=c,m.sibling=w,c.child=m,(c.mode&1)!==0&&uc(c,a.child,null,k),c.child.memoizedState=__(k),c.memoizedState=y_,w);if((c.mode&1)===0)return lg(a,c,k,null);if(v.data==="$!"){if(m=v.nextSibling&&v.nextSibling.dataset,m)var U=m.dgst;return m=U,w=Error(t(419)),m=f_(w,m,void 0),lg(a,c,k,m)}if(U=(k&a.childLanes)!==0,qn||U){if(m=on,m!==null){switch(k&-k){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(m.suspendedLanes|k))!==0?0:v,v!==0&&v!==w.retryLane&&(w.retryLane=v,Rs(a,v),ur(m,a,v,-1))}return L_(),m=f_(Error(t(421))),lg(a,c,k,m)}return v.data==="$?"?(c.flags|=128,c.child=a.child,c=DM.bind(null,a),v._reactRetry=c,null):(a=w.treeContext,yi=ho(v.nextSibling),mi=c,Ct=!0,or=null,a!==null&&(Fi[Vi++]=Is,Fi[Vi++]=Cs,Fi[Vi++]=Sa,Is=a.id,Cs=a.overflow,Sa=c),c=v_(c,m.children),c.flags|=4096,c)}function fT(a,c,d){a.lanes|=c;var m=a.alternate;m!==null&&(m.lanes|=c),Yy(a.return,c,d)}function x_(a,c,d,m,v){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:v}:(w.isBackwards=c,w.rendering=null,w.renderingStartTime=0,w.last=m,w.tail=d,w.tailMode=v)}function gT(a,c,d){var m=c.pendingProps,v=m.revealOrder,w=m.tail;if(jn(a,c,m.children,d),m=bt.current,(m&2)!==0)m=m&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&fT(a,d,c);else if(a.tag===19)fT(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}if(vt(bt,m),(c.mode&1)===0)c.memoizedState=null;else switch(v){case"forwards":for(d=c.child,v=null;d!==null;)a=d.alternate,a!==null&&tg(a)===null&&(v=d),d=d.sibling;d=v,d===null?(v=c.child,c.child=null):(v=d.sibling,d.sibling=null),x_(c,!1,v,d,w);break;case"backwards":for(d=null,v=c.child,c.child=null;v!==null;){if(a=v.alternate,a!==null&&tg(a)===null){c.child=v;break}a=v.sibling,v.sibling=d,d=v,v=a}x_(c,!0,d,null,w);break;case"together":x_(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function cg(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function bs(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),ba|=c.lanes,(d&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,d=To(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=To(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function xM(a,c,d){switch(c.tag){case 3:uT(c),cc();break;case 5:AE(c);break;case 1:Xn(c.type)&&$f(c);break;case 4:Jy(c,c.stateNode.containerInfo);break;case 10:var m=c.type._context,v=c.memoizedProps.value;vt(Zf,m._currentValue),m._currentValue=v;break;case 13:if(m=c.memoizedState,m!==null)return m.dehydrated!==null?(vt(bt,bt.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?dT(a,c,d):(vt(bt,bt.current&1),a=bs(a,c,d),a!==null?a.sibling:null);vt(bt,bt.current&1);break;case 19:if(m=(d&c.childLanes)!==0,(a.flags&128)!==0){if(m)return gT(a,c,d);c.flags|=128}if(v=c.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),vt(bt,bt.current),m)break;return null;case 22:case 23:return c.lanes=0,aT(a,c,d)}return bs(a,c,d)}var pT,w_,mT,yT;pT=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},w_=function(){},mT=function(a,c,d,m){var v=a.memoizedProps;if(v!==m){a=c.stateNode,Ra(Kr.current);var w=null;switch(d){case"input":v=$n(a,v),m=$n(a,m),w=[];break;case"select":v=ne({},v,{value:void 0}),m=ne({},m,{value:void 0}),w=[];break;case"textarea":v=Pi(a,v),m=Pi(a,m),w=[];break;default:typeof v.onClick!="function"&&typeof m.onClick=="function"&&(a.onclick=Bf)}On(d,m);var k;d=null;for(J in v)if(!m.hasOwnProperty(J)&&v.hasOwnProperty(J)&&v[J]!=null)if(J==="style"){var U=v[J];for(k in U)U.hasOwnProperty(k)&&(d||(d={}),d[k]="")}else J!=="dangerouslySetInnerHTML"&&J!=="children"&&J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(r.hasOwnProperty(J)?w||(w=[]):(w=w||[]).push(J,null));for(J in m){var G=m[J];if(U=v?.[J],m.hasOwnProperty(J)&&G!==U&&(G!=null||U!=null))if(J==="style")if(U){for(k in U)!U.hasOwnProperty(k)||G&&G.hasOwnProperty(k)||(d||(d={}),d[k]="");for(k in G)G.hasOwnProperty(k)&&U[k]!==G[k]&&(d||(d={}),d[k]=G[k])}else d||(w||(w=[]),w.push(J,d)),d=G;else J==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,U=U?U.__html:void 0,G!=null&&U!==G&&(w=w||[]).push(J,G)):J==="children"?typeof G!="string"&&typeof G!="number"||(w=w||[]).push(J,""+G):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&(r.hasOwnProperty(J)?(G!=null&&J==="onScroll"&&wt("scroll",a),w||U===G||(w=[])):(w=w||[]).push(J,G))}d&&(w=w||[]).push("style",d);var J=w;(c.updateQueue=J)&&(c.flags|=4)}},yT=function(a,c,d,m){d!==m&&(c.flags|=4)};function _h(a,c){if(!Ct)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function bn(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,m=0;if(c)for(var v=a.child;v!==null;)d|=v.lanes|v.childLanes,m|=v.subtreeFlags&14680064,m|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)d|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=m,a.childLanes=d,c}function wM(a,c,d){var m=c.pendingProps;switch(Gy(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(c),null;case 1:return Xn(c.type)&&Wf(),bn(c),null;case 3:return m=c.stateNode,fc(),Et(Hn),Et(Rn),n_(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(qf(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,or!==null&&(D_(or),or=null))),w_(a,c),bn(c),null;case 5:e_(c);var v=Ra(fh.current);if(d=c.type,a!==null&&c.stateNode!=null)mT(a,c,d,m,v),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!m){if(c.stateNode===null)throw Error(t(166));return bn(c),null}if(a=Ra(Kr.current),qf(c)){m=c.stateNode,d=c.type;var w=c.memoizedProps;switch(m[$r]=c,m[lh]=w,a=(c.mode&1)!==0,d){case"dialog":wt("cancel",m),wt("close",m);break;case"iframe":case"object":case"embed":wt("load",m);break;case"video":case"audio":for(v=0;v<sh.length;v++)wt(sh[v],m);break;case"source":wt("error",m);break;case"img":case"image":case"link":wt("error",m),wt("load",m);break;case"details":wt("toggle",m);break;case"input":hn(m,w),wt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!w.multiple},wt("invalid",m);break;case"textarea":It(m,w),wt("invalid",m)}On(d,w),v=null;for(var k in w)if(w.hasOwnProperty(k)){var U=w[k];k==="children"?typeof U=="string"?m.textContent!==U&&(w.suppressHydrationWarning!==!0&&Uf(m.textContent,U,a),v=["children",U]):typeof U=="number"&&m.textContent!==""+U&&(w.suppressHydrationWarning!==!0&&Uf(m.textContent,U,a),v=["children",""+U]):r.hasOwnProperty(k)&&U!=null&&k==="onScroll"&&wt("scroll",m)}switch(d){case"input":er(m),bi(m,w,!0);break;case"textarea":er(m),ki(m);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(m.onclick=Bf)}m=v,c.updateQueue=m,m!==null&&(c.flags|=4)}else{k=v.nodeType===9?v:v.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Rr(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=k.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof m.is=="string"?a=k.createElement(d,{is:m.is}):(a=k.createElement(d),d==="select"&&(k=a,m.multiple?k.multiple=!0:m.size&&(k.size=m.size))):a=k.createElementNS(a,d),a[$r]=c,a[lh]=m,pT(a,c,!1,!1),c.stateNode=a;e:{switch(k=ps(d,m),d){case"dialog":wt("cancel",a),wt("close",a),v=m;break;case"iframe":case"object":case"embed":wt("load",a),v=m;break;case"video":case"audio":for(v=0;v<sh.length;v++)wt(sh[v],a);v=m;break;case"source":wt("error",a),v=m;break;case"img":case"image":case"link":wt("error",a),wt("load",a),v=m;break;case"details":wt("toggle",a),v=m;break;case"input":hn(a,m),v=$n(a,m),wt("invalid",a);break;case"option":v=m;break;case"select":a._wrapperState={wasMultiple:!!m.multiple},v=ne({},m,{value:void 0}),wt("invalid",a);break;case"textarea":It(a,m),v=Pi(a,m),wt("invalid",a);break;default:v=m}On(d,v),U=v;for(w in U)if(U.hasOwnProperty(w)){var G=U[w];w==="style"?gs(a,G):w==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,G!=null&&ca(a,G)):w==="children"?typeof G=="string"?(d!=="textarea"||G!=="")&&br(a,G):typeof G=="number"&&br(a,""+G):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(r.hasOwnProperty(w)?G!=null&&w==="onScroll"&&wt("scroll",a):G!=null&&N(a,w,G,k))}switch(d){case"input":er(a),bi(a,m,!1);break;case"textarea":er(a),ki(a);break;case"option":m.value!=null&&a.setAttribute("value",""+Ve(m.value));break;case"select":a.multiple=!!m.multiple,w=m.value,w!=null?nn(a,!!m.multiple,w,!1):m.defaultValue!=null&&nn(a,!!m.multiple,m.defaultValue,!0);break;default:typeof v.onClick=="function"&&(a.onclick=Bf)}switch(d){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return bn(c),null;case 6:if(a&&c.stateNode!=null)yT(a,c,a.memoizedProps,m);else{if(typeof m!="string"&&c.stateNode===null)throw Error(t(166));if(d=Ra(fh.current),Ra(Kr.current),qf(c)){if(m=c.stateNode,d=c.memoizedProps,m[$r]=c,(w=m.nodeValue!==d)&&(a=mi,a!==null))switch(a.tag){case 3:Uf(m.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Uf(m.nodeValue,d,(a.mode&1)!==0)}w&&(c.flags|=4)}else m=(d.nodeType===9?d:d.ownerDocument).createTextNode(m),m[$r]=c,c.stateNode=m}return bn(c),null;case 13:if(Et(bt),m=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Ct&&yi!==null&&(c.mode&1)!==0&&(c.flags&128)===0)xE(),cc(),c.flags|=98560,w=!1;else if(w=qf(c),m!==null&&m.dehydrated!==null){if(a===null){if(!w)throw Error(t(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[$r]=c}else cc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;bn(c),w=!1}else or!==null&&(D_(or),or=null),w=!0;if(!w)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(m=m!==null,m!==(a!==null&&a.memoizedState!==null)&&m&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(bt.current&1)!==0?Zt===0&&(Zt=3):L_())),c.updateQueue!==null&&(c.flags|=4),bn(c),null);case 4:return fc(),w_(a,c),a===null&&oh(c.stateNode.containerInfo),bn(c),null;case 10:return qy(c.type._context),bn(c),null;case 17:return Xn(c.type)&&Wf(),bn(c),null;case 19:if(Et(bt),w=c.memoizedState,w===null)return bn(c),null;if(m=(c.flags&128)!==0,k=w.rendering,k===null)if(m)_h(w,!1);else{if(Zt!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(k=tg(a),k!==null){for(c.flags|=128,_h(w,!1),m=k.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),c.subtreeFlags=0,m=d,d=c.child;d!==null;)w=d,a=m,w.flags&=14680066,k=w.alternate,k===null?(w.childLanes=0,w.lanes=a,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=k.childLanes,w.lanes=k.lanes,w.child=k.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=k.memoizedProps,w.memoizedState=k.memoizedState,w.updateQueue=k.updateQueue,w.type=k.type,a=k.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return vt(bt,bt.current&1|2),c.child}a=a.sibling}w.tail!==null&&xt()>yc&&(c.flags|=128,m=!0,_h(w,!1),c.lanes=4194304)}else{if(!m)if(a=tg(k),a!==null){if(c.flags|=128,m=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),_h(w,!0),w.tail===null&&w.tailMode==="hidden"&&!k.alternate&&!Ct)return bn(c),null}else 2*xt()-w.renderingStartTime>yc&&d!==1073741824&&(c.flags|=128,m=!0,_h(w,!1),c.lanes=4194304);w.isBackwards?(k.sibling=c.child,c.child=k):(d=w.last,d!==null?d.sibling=k:c.child=k,w.last=k)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=xt(),c.sibling=null,d=bt.current,vt(bt,m?d&1|2:d&1),c):(bn(c),null);case 22:case 23:return M_(),m=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==m&&(c.flags|=8192),m&&(c.mode&1)!==0?(_i&1073741824)!==0&&(bn(c),c.subtreeFlags&6&&(c.flags|=8192)):bn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function EM(a,c){switch(Gy(c),c.tag){case 1:return Xn(c.type)&&Wf(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return fc(),Et(Hn),Et(Rn),n_(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return e_(c),null;case 13:if(Et(bt),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));cc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return Et(bt),null;case 4:return fc(),null;case 10:return qy(c.type._context),null;case 22:case 23:return M_(),null;case 24:return null;default:return null}}var ug=!1,Pn=!1,TM=typeof WeakSet=="function"?WeakSet:Set,_e=null;function pc(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(m){Mt(a,c,m)}else d.current=null}function E_(a,c,d){try{d()}catch(m){Mt(a,c,m)}}var _T=!1;function SM(a,c){if(My=xs,a=Yw(),Cy(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var v=m.anchorOffset,w=m.focusNode;m=m.focusOffset;try{d.nodeType,w.nodeType}catch{d=null;break e}var k=0,U=-1,G=-1,J=0,oe=0,ce=a,re=null;t:for(;;){for(var ye;ce!==d||v!==0&&ce.nodeType!==3||(U=k+v),ce!==w||m!==0&&ce.nodeType!==3||(G=k+m),ce.nodeType===3&&(k+=ce.nodeValue.length),(ye=ce.firstChild)!==null;)re=ce,ce=ye;for(;;){if(ce===a)break t;if(re===d&&++J===v&&(U=k),re===w&&++oe===m&&(G=k),(ye=ce.nextSibling)!==null)break;ce=re,re=ce.parentNode}ce=ye}d=U===-1||G===-1?null:{start:U,end:G}}else d=null}d=d||{start:0,end:0}}else d=null;for(Ly={focusedElem:a,selectionRange:d},xs=!1,_e=c;_e!==null;)if(c=_e,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,_e=a;else for(;_e!==null;){c=_e;try{var ve=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var we=ve.memoizedProps,zt=ve.memoizedState,H=c.stateNode,K=H.getSnapshotBeforeUpdate(c.elementType===c.type?we:ar(c.type,we),zt);H.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var Y=c.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Mt(c,c.return,he)}if(a=c.sibling,a!==null){a.return=c.return,_e=a;break}_e=c.return}return ve=_T,_T=!1,ve}function vh(a,c,d){var m=c.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var v=m=m.next;do{if((v.tag&a)===a){var w=v.destroy;v.destroy=void 0,w!==void 0&&E_(c,d,w)}v=v.next}while(v!==m)}}function hg(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var m=d.create;d.destroy=m()}d=d.next}while(d!==c)}}function T_(a){var c=a.ref;if(c!==null){var d=a.stateNode;a.tag,a=d,typeof c=="function"?c(a):c.current=a}}function vT(a){var c=a.alternate;c!==null&&(a.alternate=null,vT(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[$r],delete c[lh],delete c[jy],delete c[oM],delete c[aM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function xT(a){return a.tag===5||a.tag===3||a.tag===4}function wT(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||xT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function S_(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=Bf));else if(m!==4&&(a=a.child,a!==null))for(S_(a,c,d),a=a.sibling;a!==null;)S_(a,c,d),a=a.sibling}function I_(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(m!==4&&(a=a.child,a!==null))for(I_(a,c,d),a=a.sibling;a!==null;)I_(a,c,d),a=a.sibling}var _n=null,lr=!1;function _o(a,c,d){for(d=d.child;d!==null;)ET(a,c,d),d=d.sibling}function ET(a,c,d){if(ui&&typeof ui.onCommitFiberUnmount=="function")try{ui.onCommitFiberUnmount(fa,d)}catch{}switch(d.tag){case 5:Pn||pc(d,c);case 6:var m=_n,v=lr;_n=null,_o(a,c,d),_n=m,lr=v,_n!==null&&(lr?(a=_n,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):_n.removeChild(d.stateNode));break;case 18:_n!==null&&(lr?(a=_n,d=d.stateNode,a.nodeType===8?Vy(a.parentNode,d):a.nodeType===1&&Vy(a,d),ao(a)):Vy(_n,d.stateNode));break;case 4:m=_n,v=lr,_n=d.stateNode.containerInfo,lr=!0,_o(a,c,d),_n=m,lr=v;break;case 0:case 11:case 14:case 15:if(!Pn&&(m=d.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){v=m=m.next;do{var w=v,k=w.destroy;w=w.tag,k!==void 0&&((w&2)!==0||(w&4)!==0)&&E_(d,c,k),v=v.next}while(v!==m)}_o(a,c,d);break;case 1:if(!Pn&&(pc(d,c),m=d.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=d.memoizedProps,m.state=d.memoizedState,m.componentWillUnmount()}catch(U){Mt(d,c,U)}_o(a,c,d);break;case 21:_o(a,c,d);break;case 22:d.mode&1?(Pn=(m=Pn)||d.memoizedState!==null,_o(a,c,d),Pn=m):_o(a,c,d);break;default:_o(a,c,d)}}function TT(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new TM),c.forEach(function(m){var v=NM.bind(null,a,m);d.has(m)||(d.add(m),m.then(v,v))})}}function cr(a,c){var d=c.deletions;if(d!==null)for(var m=0;m<d.length;m++){var v=d[m];try{var w=a,k=c,U=k;e:for(;U!==null;){switch(U.tag){case 5:_n=U.stateNode,lr=!1;break e;case 3:_n=U.stateNode.containerInfo,lr=!0;break e;case 4:_n=U.stateNode.containerInfo,lr=!0;break e}U=U.return}if(_n===null)throw Error(t(160));ET(w,k,v),_n=null,lr=!1;var G=v.alternate;G!==null&&(G.return=null),v.return=null}catch(J){Mt(v,c,J)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)ST(c,a),c=c.sibling}function ST(a,c){var d=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(cr(c,a),Xr(a),m&4){try{vh(3,a,a.return),hg(3,a)}catch(we){Mt(a,a.return,we)}try{vh(5,a,a.return)}catch(we){Mt(a,a.return,we)}}break;case 1:cr(c,a),Xr(a),m&512&&d!==null&&pc(d,d.return);break;case 5:if(cr(c,a),Xr(a),m&512&&d!==null&&pc(d,d.return),a.flags&32){var v=a.stateNode;try{br(v,"")}catch(we){Mt(a,a.return,we)}}if(m&4&&(v=a.stateNode,v!=null)){var w=a.memoizedProps,k=d!==null?d.memoizedProps:w,U=a.type,G=a.updateQueue;if(a.updateQueue=null,G!==null)try{U==="input"&&w.type==="radio"&&w.name!=null&&dn(v,w),ps(U,k);var J=ps(U,w);for(k=0;k<G.length;k+=2){var oe=G[k],ce=G[k+1];oe==="style"?gs(v,ce):oe==="dangerouslySetInnerHTML"?ca(v,ce):oe==="children"?br(v,ce):N(v,oe,ce,J)}switch(U){case"input":Kn(v,w);break;case"textarea":to(v,w);break;case"select":var re=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!w.multiple;var ye=w.value;ye!=null?nn(v,!!w.multiple,ye,!1):re!==!!w.multiple&&(w.defaultValue!=null?nn(v,!!w.multiple,w.defaultValue,!0):nn(v,!!w.multiple,w.multiple?[]:"",!1))}v[lh]=w}catch(we){Mt(a,a.return,we)}}break;case 6:if(cr(c,a),Xr(a),m&4){if(a.stateNode===null)throw Error(t(162));v=a.stateNode,w=a.memoizedProps;try{v.nodeValue=w}catch(we){Mt(a,a.return,we)}}break;case 3:if(cr(c,a),Xr(a),m&4&&d!==null&&d.memoizedState.isDehydrated)try{ao(c.containerInfo)}catch(we){Mt(a,a.return,we)}break;case 4:cr(c,a),Xr(a);break;case 13:cr(c,a),Xr(a),v=a.child,v.flags&8192&&(w=v.memoizedState!==null,v.stateNode.isHidden=w,!w||v.alternate!==null&&v.alternate.memoizedState!==null||(A_=xt())),m&4&&TT(a);break;case 22:if(oe=d!==null&&d.memoizedState!==null,a.mode&1?(Pn=(J=Pn)||oe,cr(c,a),Pn=J):cr(c,a),Xr(a),m&8192){if(J=a.memoizedState!==null,(a.stateNode.isHidden=J)&&!oe&&(a.mode&1)!==0)for(_e=a,oe=a.child;oe!==null;){for(ce=_e=oe;_e!==null;){switch(re=_e,ye=re.child,re.tag){case 0:case 11:case 14:case 15:vh(4,re,re.return);break;case 1:pc(re,re.return);var ve=re.stateNode;if(typeof ve.componentWillUnmount=="function"){m=re,d=re.return;try{c=m,ve.props=c.memoizedProps,ve.state=c.memoizedState,ve.componentWillUnmount()}catch(we){Mt(m,d,we)}}break;case 5:pc(re,re.return);break;case 22:if(re.memoizedState!==null){RT(ce);continue}}ye!==null?(ye.return=re,_e=ye):RT(ce)}oe=oe.sibling}e:for(oe=null,ce=a;;){if(ce.tag===5){if(oe===null){oe=ce;try{v=ce.stateNode,J?(w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(U=ce.stateNode,G=ce.memoizedProps.style,k=G!=null&&G.hasOwnProperty("display")?G.display:null,U.style.display=Pr("display",k))}catch(we){Mt(a,a.return,we)}}}else if(ce.tag===6){if(oe===null)try{ce.stateNode.nodeValue=J?"":ce.memoizedProps}catch(we){Mt(a,a.return,we)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===a)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===a)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===a)break e;oe===ce&&(oe=null),ce=ce.return}oe===ce&&(oe=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:cr(c,a),Xr(a),m&4&&TT(a);break;case 21:break;default:cr(c,a),Xr(a)}}function Xr(a){var c=a.flags;if(c&2){try{e:{for(var d=a.return;d!==null;){if(xT(d)){var m=d;break e}d=d.return}throw Error(t(160))}switch(m.tag){case 5:var v=m.stateNode;m.flags&32&&(br(v,""),m.flags&=-33);var w=wT(a);I_(a,w,v);break;case 3:case 4:var k=m.stateNode.containerInfo,U=wT(a);S_(a,U,k);break;default:throw Error(t(161))}}catch(G){Mt(a,a.return,G)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function IM(a,c,d){_e=a,IT(a)}function IT(a,c,d){for(var m=(a.mode&1)!==0;_e!==null;){var v=_e,w=v.child;if(v.tag===22&&m){var k=v.memoizedState!==null||ug;if(!k){var U=v.alternate,G=U!==null&&U.memoizedState!==null||Pn;U=ug;var J=Pn;if(ug=k,(Pn=G)&&!J)for(_e=v;_e!==null;)k=_e,G=k.child,k.tag===22&&k.memoizedState!==null?AT(v):G!==null?(G.return=k,_e=G):AT(v);for(;w!==null;)_e=w,IT(w),w=w.sibling;_e=v,ug=U,Pn=J}CT(a)}else(v.subtreeFlags&8772)!==0&&w!==null?(w.return=v,_e=w):CT(a)}}function CT(a){for(;_e!==null;){var c=_e;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Pn||hg(5,c);break;case 1:var m=c.stateNode;if(c.flags&4&&!Pn)if(d===null)m.componentDidMount();else{var v=c.elementType===c.type?d.memoizedProps:ar(c.type,d.memoizedProps);m.componentDidUpdate(v,d.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var w=c.updateQueue;w!==null&&RE(c,w,m);break;case 3:var k=c.updateQueue;if(k!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}RE(c,k,d)}break;case 5:var U=c.stateNode;if(d===null&&c.flags&4){d=U;var G=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":G.autoFocus&&d.focus();break;case"img":G.src&&(d.src=G.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var J=c.alternate;if(J!==null){var oe=J.memoizedState;if(oe!==null){var ce=oe.dehydrated;ce!==null&&ao(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Pn||c.flags&512&&T_(c)}catch(re){Mt(c,c.return,re)}}if(c===a){_e=null;break}if(d=c.sibling,d!==null){d.return=c.return,_e=d;break}_e=c.return}}function RT(a){for(;_e!==null;){var c=_e;if(c===a){_e=null;break}var d=c.sibling;if(d!==null){d.return=c.return,_e=d;break}_e=c.return}}function AT(a){for(;_e!==null;){var c=_e;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{hg(4,c)}catch(G){Mt(c,d,G)}break;case 1:var m=c.stateNode;if(typeof m.componentDidMount=="function"){var v=c.return;try{m.componentDidMount()}catch(G){Mt(c,v,G)}}var w=c.return;try{T_(c)}catch(G){Mt(c,w,G)}break;case 5:var k=c.return;try{T_(c)}catch(G){Mt(c,k,G)}}}catch(G){Mt(c,c.return,G)}if(c===a){_e=null;break}var U=c.sibling;if(U!==null){U.return=c.return,_e=U;break}_e=c.return}}var CM=Math.ceil,dg=R.ReactCurrentDispatcher,C_=R.ReactCurrentOwner,Ui=R.ReactCurrentBatchConfig,Je=0,on=null,$t=null,vn=0,_i=0,mc=fo(0),Zt=0,xh=null,ba=0,fg=0,R_=0,wh=null,Yn=null,A_=0,yc=1/0,Ps=null,gg=!1,b_=null,vo=null,pg=!1,xo=null,mg=0,Eh=0,P_=null,yg=-1,_g=0;function zn(){return(Je&6)!==0?xt():yg!==-1?yg:yg=xt()}function wo(a){return(a.mode&1)===0?1:(Je&2)!==0&&vn!==0?vn&-vn:cM.transition!==null?(_g===0&&(_g=Gu()),_g):(a=Xe,a!==0||(a=window.event,a=a===void 0?16:Kl(a.type)),a)}function ur(a,c,d,m){if(50<Eh)throw Eh=0,P_=null,Error(t(185));ya(a,d,m),((Je&2)===0||a!==on)&&(a===on&&((Je&2)===0&&(fg|=d),Zt===4&&Eo(a,vn)),Zn(a,m),d===1&&Je===0&&(c.mode&1)===0&&(yc=xt()+500,Kf&&po()))}function Zn(a,c){var d=a.callbackNode;ma(a,c);var m=ys(a,a===on?vn:0);if(m===0)d!==null&&jl(d),a.callbackNode=null,a.callbackPriority=0;else if(c=m&-m,a.callbackPriority!==c){if(d!=null&&jl(d),c===1)a.tag===0?lM(PT.bind(null,a)):pE(PT.bind(null,a)),rM(function(){(Je&6)===0&&po()}),d=null;else{switch(Lr(m)){case 1:d=zl;break;case 4:d=zu;break;case 16:d=da;break;case 536870912:d=Ul;break;default:d=da}d=VT(d,bT.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function bT(a,c){if(yg=-1,_g=0,(Je&6)!==0)throw Error(t(327));var d=a.callbackNode;if(_c()&&a.callbackNode!==d)return null;var m=ys(a,a===on?vn:0);if(m===0)return null;if((m&30)!==0||(m&a.expiredLanes)!==0||c)c=vg(a,m);else{c=m;var v=Je;Je|=2;var w=DT();(on!==a||vn!==c)&&(Ps=null,yc=xt()+500,ka(a,c));do try{bM();break}catch(U){kT(a,U)}while(!0);Xy(),dg.current=w,Je=v,$t!==null?c=0:(on=null,vn=0,c=Zt)}if(c!==0){if(c===2&&(v=Bu(a),v!==0&&(m=v,c=k_(a,v))),c===1)throw d=xh,ka(a,0),Eo(a,m),Zn(a,xt()),d;if(c===6)Eo(a,m);else{if(v=a.current.alternate,(m&30)===0&&!RM(v)&&(c=vg(a,m),c===2&&(w=Bu(a),w!==0&&(m=w,c=k_(a,w))),c===1))throw d=xh,ka(a,0),Eo(a,m),Zn(a,xt()),d;switch(a.finishedWork=v,a.finishedLanes=m,c){case 0:case 1:throw Error(t(345));case 2:Da(a,Yn,Ps);break;case 3:if(Eo(a,m),(m&130023424)===m&&(c=A_+500-xt(),10<c)){if(ys(a,0)!==0)break;if(v=a.suspendedLanes,(v&m)!==m){zn(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=Fy(Da.bind(null,a,Yn,Ps),c);break}Da(a,Yn,Ps);break;case 4:if(Eo(a,m),(m&4194240)===m)break;for(c=a.eventTimes,v=-1;0<m;){var k=31-hi(m);w=1<<k,k=c[k],k>v&&(v=k),m&=~w}if(m=v,m=xt()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*CM(m/1960))-m,10<m){a.timeoutHandle=Fy(Da.bind(null,a,Yn,Ps),m);break}Da(a,Yn,Ps);break;case 5:Da(a,Yn,Ps);break;default:throw Error(t(329))}}}return Zn(a,xt()),a.callbackNode===d?bT.bind(null,a):null}function k_(a,c){var d=wh;return a.current.memoizedState.isDehydrated&&(ka(a,c).flags|=256),a=vg(a,c),a!==2&&(c=Yn,Yn=d,c!==null&&D_(c)),a}function D_(a){Yn===null?Yn=a:Yn.push.apply(Yn,a)}function RM(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var m=0;m<d.length;m++){var v=d[m],w=v.getSnapshot;v=v.value;try{if(!sr(w(),v))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Eo(a,c){for(c&=~R_,c&=~fg,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-hi(c),m=1<<d;a[d]=-1,c&=~m}}function PT(a){if((Je&6)!==0)throw Error(t(327));_c();var c=ys(a,0);if((c&1)===0)return Zn(a,xt()),null;var d=vg(a,c);if(a.tag!==0&&d===2){var m=Bu(a);m!==0&&(c=m,d=k_(a,m))}if(d===1)throw d=xh,ka(a,0),Eo(a,c),Zn(a,xt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Da(a,Yn,Ps),Zn(a,xt()),null}function N_(a,c){var d=Je;Je|=1;try{return a(c)}finally{Je=d,Je===0&&(yc=xt()+500,Kf&&po())}}function Pa(a){xo!==null&&xo.tag===0&&(Je&6)===0&&_c();var c=Je;Je|=1;var d=Ui.transition,m=Xe;try{if(Ui.transition=null,Xe=1,a)return a()}finally{Xe=m,Ui.transition=d,Je=c,(Je&6)===0&&po()}}function M_(){_i=mc.current,Et(mc)}function ka(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,iM(d)),$t!==null)for(d=$t.return;d!==null;){var m=d;switch(Gy(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Wf();break;case 3:fc(),Et(Hn),Et(Rn),n_();break;case 5:e_(m);break;case 4:fc();break;case 13:Et(bt);break;case 19:Et(bt);break;case 10:qy(m.type._context);break;case 22:case 23:M_()}d=d.return}if(on=a,$t=a=To(a.current,null),vn=_i=c,Zt=0,xh=null,R_=fg=ba=0,Yn=wh=null,Ca!==null){for(c=0;c<Ca.length;c++)if(d=Ca[c],m=d.interleaved,m!==null){d.interleaved=null;var v=m.next,w=d.pending;if(w!==null){var k=w.next;w.next=v,m.next=k}d.pending=m}Ca=null}return a}function kT(a,c){do{var d=$t;try{if(Xy(),ng.current=og,ig){for(var m=Pt.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}ig=!1}if(Aa=0,sn=Yt=Pt=null,gh=!1,ph=0,C_.current=null,d===null||d.return===null){Zt=1,xh=c,$t=null;break}e:{var w=a,k=d.return,U=d,G=c;if(c=vn,U.flags|=32768,G!==null&&typeof G=="object"&&typeof G.then=="function"){var J=G,oe=U,ce=oe.tag;if((oe.mode&1)===0&&(ce===0||ce===11||ce===15)){var re=oe.alternate;re?(oe.updateQueue=re.updateQueue,oe.memoizedState=re.memoizedState,oe.lanes=re.lanes):(oe.updateQueue=null,oe.memoizedState=null)}var ye=nT(k);if(ye!==null){ye.flags&=-257,iT(ye,k,U,w,c),ye.mode&1&&tT(w,J,c),c=ye,G=J;var ve=c.updateQueue;if(ve===null){var we=new Set;we.add(G),c.updateQueue=we}else ve.add(G);break e}else{if((c&1)===0){tT(w,J,c),L_();break e}G=Error(t(426))}}else if(Ct&&U.mode&1){var zt=nT(k);if(zt!==null){(zt.flags&65536)===0&&(zt.flags|=256),iT(zt,k,U,w,c),Ky(gc(G,U));break e}}w=G=gc(G,U),Zt!==4&&(Zt=2),wh===null?wh=[w]:wh.push(w),w=k;do{switch(w.tag){case 3:w.flags|=65536,c&=-c,w.lanes|=c;var H=JE(w,G,c);CE(w,H);break e;case 1:U=G;var K=w.type,Y=w.stateNode;if((w.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(vo===null||!vo.has(Y)))){w.flags|=65536,c&=-c,w.lanes|=c;var he=eT(w,U,c);CE(w,he);break e}}w=w.return}while(w!==null)}MT(d)}catch(Te){c=Te,$t===d&&d!==null&&($t=d=d.return);continue}break}while(!0)}function DT(){var a=dg.current;return dg.current=og,a===null?og:a}function L_(){(Zt===0||Zt===3||Zt===2)&&(Zt=4),on===null||(ba&268435455)===0&&(fg&268435455)===0||Eo(on,vn)}function vg(a,c){var d=Je;Je|=2;var m=DT();(on!==a||vn!==c)&&(Ps=null,ka(a,c));do try{AM();break}catch(v){kT(a,v)}while(!0);if(Xy(),Je=d,dg.current=m,$t!==null)throw Error(t(261));return on=null,vn=0,Zt}function AM(){for(;$t!==null;)NT($t)}function bM(){for(;$t!==null&&!ha();)NT($t)}function NT(a){var c=FT(a.alternate,a,_i);a.memoizedProps=a.pendingProps,c===null?MT(a):$t=c,C_.current=null}function MT(a){var c=a;do{var d=c.alternate;if(a=c.return,(c.flags&32768)===0){if(d=wM(d,c,_i),d!==null){$t=d;return}}else{if(d=EM(d,c),d!==null){d.flags&=32767,$t=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Zt=6,$t=null;return}}if(c=c.sibling,c!==null){$t=c;return}$t=c=a}while(c!==null);Zt===0&&(Zt=5)}function Da(a,c,d){var m=Xe,v=Ui.transition;try{Ui.transition=null,Xe=1,PM(a,c,d,m)}finally{Ui.transition=v,Xe=m}return null}function PM(a,c,d,m){do _c();while(xo!==null);if((Je&6)!==0)throw Error(t(327));d=a.finishedWork;var v=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var w=d.lanes|d.childLanes;if(wy(a,w),a===on&&($t=on=null,vn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||pg||(pg=!0,VT(da,function(){return _c(),null})),w=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||w){w=Ui.transition,Ui.transition=null;var k=Xe;Xe=1;var U=Je;Je|=4,C_.current=null,SM(a,d),ST(d,a),YN(Ly),xs=!!My,Ly=My=null,a.current=d,IM(d),ms(),Je=U,Xe=k,Ui.transition=w}else a.current=d;if(pg&&(pg=!1,xo=a,mg=v),w=a.pendingLanes,w===0&&(vo=null),Cf(d.stateNode),Zn(a,xt()),c!==null)for(m=a.onRecoverableError,d=0;d<c.length;d++)v=c[d],m(v.value,{componentStack:v.stack,digest:v.digest});if(gg)throw gg=!1,a=b_,b_=null,a;return(mg&1)!==0&&a.tag!==0&&_c(),w=a.pendingLanes,(w&1)!==0?a===P_?Eh++:(Eh=0,P_=a):Eh=0,po(),null}function _c(){if(xo!==null){var a=Lr(mg),c=Ui.transition,d=Xe;try{if(Ui.transition=null,Xe=16>a?16:a,xo===null)var m=!1;else{if(a=xo,xo=null,mg=0,(Je&6)!==0)throw Error(t(331));var v=Je;for(Je|=4,_e=a.current;_e!==null;){var w=_e,k=w.child;if((_e.flags&16)!==0){var U=w.deletions;if(U!==null){for(var G=0;G<U.length;G++){var J=U[G];for(_e=J;_e!==null;){var oe=_e;switch(oe.tag){case 0:case 11:case 15:vh(8,oe,w)}var ce=oe.child;if(ce!==null)ce.return=oe,_e=ce;else for(;_e!==null;){oe=_e;var re=oe.sibling,ye=oe.return;if(vT(oe),oe===J){_e=null;break}if(re!==null){re.return=ye,_e=re;break}_e=ye}}}var ve=w.alternate;if(ve!==null){var we=ve.child;if(we!==null){ve.child=null;do{var zt=we.sibling;we.sibling=null,we=zt}while(we!==null)}}_e=w}}if((w.subtreeFlags&2064)!==0&&k!==null)k.return=w,_e=k;else e:for(;_e!==null;){if(w=_e,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:vh(9,w,w.return)}var H=w.sibling;if(H!==null){H.return=w.return,_e=H;break e}_e=w.return}}var K=a.current;for(_e=K;_e!==null;){k=_e;var Y=k.child;if((k.subtreeFlags&2064)!==0&&Y!==null)Y.return=k,_e=Y;else e:for(k=K;_e!==null;){if(U=_e,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:hg(9,U)}}catch(Te){Mt(U,U.return,Te)}if(U===k){_e=null;break e}var he=U.sibling;if(he!==null){he.return=U.return,_e=he;break e}_e=U.return}}if(Je=v,po(),ui&&typeof ui.onPostCommitFiberRoot=="function")try{ui.onPostCommitFiberRoot(fa,a)}catch{}m=!0}return m}finally{Xe=d,Ui.transition=c}}return!1}function LT(a,c,d){c=gc(d,c),c=JE(a,c,1),a=yo(a,c,1),c=zn(),a!==null&&(ya(a,1,c),Zn(a,c))}function Mt(a,c,d){if(a.tag===3)LT(a,a,d);else for(;c!==null;){if(c.tag===3){LT(c,a,d);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(vo===null||!vo.has(m))){a=gc(d,a),a=eT(c,a,1),c=yo(c,a,1),a=zn(),c!==null&&(ya(c,1,a),Zn(c,a));break}}c=c.return}}function kM(a,c,d){var m=a.pingCache;m!==null&&m.delete(c),c=zn(),a.pingedLanes|=a.suspendedLanes&d,on===a&&(vn&d)===d&&(Zt===4||Zt===3&&(vn&130023424)===vn&&500>xt()-A_?ka(a,0):R_|=d),Zn(a,c)}function OT(a,c){c===0&&((a.mode&1)===0?c=1:(c=ro,ro<<=1,(ro&130023424)===0&&(ro=4194304)));var d=zn();a=Rs(a,c),a!==null&&(ya(a,c,d),Zn(a,d))}function DM(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),OT(a,d)}function NM(a,c){var d=0;switch(a.tag){case 13:var m=a.stateNode,v=a.memoizedState;v!==null&&(d=v.retryLane);break;case 19:m=a.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(c),OT(a,d)}var FT;FT=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Hn.current)qn=!0;else{if((a.lanes&d)===0&&(c.flags&128)===0)return qn=!1,xM(a,c,d);qn=(a.flags&131072)!==0}else qn=!1,Ct&&(c.flags&1048576)!==0&&mE(c,Xf,c.index);switch(c.lanes=0,c.tag){case 2:var m=c.type;cg(a,c),a=c.pendingProps;var v=oc(c,Rn.current);dc(c,d),v=s_(null,c,m,a,v,d);var w=o_();return c.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Xn(m)?(w=!0,$f(c)):w=!1,c.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Qy(c),v.updater=ag,c.stateNode=v,v._reactInternals=c,d_(c,m,a,d),c=m_(null,c,m,!0,w,d)):(c.tag=0,Ct&&w&&By(c),jn(null,c,v,d),c=c.child),c;case 16:m=c.elementType;e:{switch(cg(a,c),a=c.pendingProps,v=m._init,m=v(m._payload),c.type=m,v=c.tag=LM(m),a=ar(m,a),v){case 0:c=p_(null,c,m,a,d);break e;case 1:c=cT(null,c,m,a,d);break e;case 11:c=rT(null,c,m,a,d);break e;case 14:c=sT(null,c,m,ar(m.type,a),d);break e}throw Error(t(306,m,""))}return c;case 0:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),p_(a,c,m,v,d);case 1:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),cT(a,c,m,v,d);case 3:e:{if(uT(c),a===null)throw Error(t(387));m=c.pendingProps,w=c.memoizedState,v=w.element,IE(a,c),eg(c,m,null,d);var k=c.memoizedState;if(m=k.element,w.isDehydrated)if(w={element:m,isDehydrated:!1,cache:k.cache,pendingSuspenseBoundaries:k.pendingSuspenseBoundaries,transitions:k.transitions},c.updateQueue.baseState=w,c.memoizedState=w,c.flags&256){v=gc(Error(t(423)),c),c=hT(a,c,m,d,v);break e}else if(m!==v){v=gc(Error(t(424)),c),c=hT(a,c,m,d,v);break e}else for(yi=ho(c.stateNode.containerInfo.firstChild),mi=c,Ct=!0,or=null,d=TE(c,null,m,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(cc(),m===v){c=bs(a,c,d);break e}jn(a,c,m,d)}c=c.child}return c;case 5:return AE(c),a===null&&$y(c),m=c.type,v=c.pendingProps,w=a!==null?a.memoizedProps:null,k=v.children,Oy(m,v)?k=null:w!==null&&Oy(m,w)&&(c.flags|=32),lT(a,c),jn(a,c,k,d),c.child;case 6:return a===null&&$y(c),null;case 13:return dT(a,c,d);case 4:return Jy(c,c.stateNode.containerInfo),m=c.pendingProps,a===null?c.child=uc(c,null,m,d):jn(a,c,m,d),c.child;case 11:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),rT(a,c,m,v,d);case 7:return jn(a,c,c.pendingProps,d),c.child;case 8:return jn(a,c,c.pendingProps.children,d),c.child;case 12:return jn(a,c,c.pendingProps.children,d),c.child;case 10:e:{if(m=c.type._context,v=c.pendingProps,w=c.memoizedProps,k=v.value,vt(Zf,m._currentValue),m._currentValue=k,w!==null)if(sr(w.value,k)){if(w.children===v.children&&!Hn.current){c=bs(a,c,d);break e}}else for(w=c.child,w!==null&&(w.return=c);w!==null;){var U=w.dependencies;if(U!==null){k=w.child;for(var G=U.firstContext;G!==null;){if(G.context===m){if(w.tag===1){G=As(-1,d&-d),G.tag=2;var J=w.updateQueue;if(J!==null){J=J.shared;var oe=J.pending;oe===null?G.next=G:(G.next=oe.next,oe.next=G),J.pending=G}}w.lanes|=d,G=w.alternate,G!==null&&(G.lanes|=d),Yy(w.return,d,c),U.lanes|=d;break}G=G.next}}else if(w.tag===10)k=w.type===c.type?null:w.child;else if(w.tag===18){if(k=w.return,k===null)throw Error(t(341));k.lanes|=d,U=k.alternate,U!==null&&(U.lanes|=d),Yy(k,d,c),k=w.sibling}else k=w.child;if(k!==null)k.return=w;else for(k=w;k!==null;){if(k===c){k=null;break}if(w=k.sibling,w!==null){w.return=k.return,k=w;break}k=k.return}w=k}jn(a,c,v.children,d),c=c.child}return c;case 9:return v=c.type,m=c.pendingProps.children,dc(c,d),v=ji(v),m=m(v),c.flags|=1,jn(a,c,m,d),c.child;case 14:return m=c.type,v=ar(m,c.pendingProps),v=ar(m.type,v),sT(a,c,m,v,d);case 15:return oT(a,c,c.type,c.pendingProps,d);case 17:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),cg(a,c),c.tag=1,Xn(m)?(a=!0,$f(c)):a=!1,dc(c,d),ZE(c,m,v),d_(c,m,v,d),m_(null,c,m,!0,a,d);case 19:return gT(a,c,d);case 22:return aT(a,c,d)}throw Error(t(156,c.tag))};function VT(a,c){return ju(a,c)}function MM(a,c,d,m){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bi(a,c,d,m){return new MM(a,c,d,m)}function O_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function LM(a){if(typeof a=="function")return O_(a)?1:0;if(a!=null){if(a=a.$$typeof,a===B)return 11;if(a===pe)return 14}return 2}function To(a,c){var d=a.alternate;return d===null?(d=Bi(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function xg(a,c,d,m,v,w){var k=2;if(m=a,typeof a=="function")O_(a)&&(k=1);else if(typeof a=="string")k=5;else e:switch(a){case D:return Na(d.children,v,w,c);case b:k=8,v|=8;break;case M:return a=Bi(12,d,c,v|2),a.elementType=M,a.lanes=w,a;case O:return a=Bi(13,d,c,v),a.elementType=O,a.lanes=w,a;case le:return a=Bi(19,d,c,v),a.elementType=le,a.lanes=w,a;case ue:return wg(d,v,w,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case V:k=10;break e;case z:k=9;break e;case B:k=11;break e;case pe:k=14;break e;case ge:k=16,m=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=Bi(k,d,c,v),c.elementType=a,c.type=m,c.lanes=w,c}function Na(a,c,d,m){return a=Bi(7,a,m,c),a.lanes=d,a}function wg(a,c,d,m){return a=Bi(22,a,m,c),a.elementType=ue,a.lanes=d,a.stateNode={isHidden:!1},a}function F_(a,c,d){return a=Bi(6,a,null,c),a.lanes=d,a}function V_(a,c,d){return c=Bi(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function OM(a,c,d,m,v){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wu(0),this.expirationTimes=Wu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wu(0),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function j_(a,c,d,m,v,w,k,U,G){return a=new OM(a,c,d,U,G),c===1?(c=1,w===!0&&(c|=8)):c=0,w=Bi(3,null,null,c),a.current=w,w.stateNode=a,w.memoizedState={element:m,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qy(w),a}function FM(a,c,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j,key:m==null?null:""+m,children:a,containerInfo:c,implementation:d}}function jT(a){if(!a)return go;a=a._reactInternals;e:{if(ir(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Xn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(Xn(d))return fE(a,d,c)}return c}function zT(a,c,d,m,v,w,k,U,G){return a=j_(d,m,!0,a,v,w,k,U,G),a.context=jT(null),d=a.current,m=zn(),v=wo(d),w=As(m,v),w.callback=c??null,yo(d,w,v),a.current.lanes=v,ya(a,v,m),Zn(a,m),a}function Eg(a,c,d,m){var v=c.current,w=zn(),k=wo(v);return d=jT(d),c.context===null?c.context=d:c.pendingContext=d,c=As(w,k),c.payload={element:a},m=m===void 0?null:m,m!==null&&(c.callback=m),a=yo(v,c,k),a!==null&&(ur(a,v,k,w),Jf(a,v,k)),k}function Tg(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function UT(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function z_(a,c){UT(a,c),(a=a.alternate)&&UT(a,c)}function VM(){return null}var BT=typeof reportError=="function"?reportError:function(a){console.error(a)};function U_(a){this._internalRoot=a}Sg.prototype.render=U_.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));Eg(a,c,null,null)},Sg.prototype.unmount=U_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;Pa(function(){Eg(null,a,null,null)}),c[Ts]=null}};function Sg(a){this._internalRoot=a}Sg.prototype.unstable_scheduleHydration=function(a){if(a){var c=Xu();a={blockedOn:null,target:a,priority:c};for(var d=0;d<di.length&&c!==0&&c<di[d].priority;d++);di.splice(d,0,a),d===0&&Wl(a)}};function B_(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Ig(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function GT(){}function jM(a,c,d,m,v){if(v){if(typeof m=="function"){var w=m;m=function(){var J=Tg(k);w.call(J)}}var k=zT(c,m,a,0,null,!1,!1,"",GT);return a._reactRootContainer=k,a[Ts]=k.current,oh(a.nodeType===8?a.parentNode:a),Pa(),k}for(;v=a.lastChild;)a.removeChild(v);if(typeof m=="function"){var U=m;m=function(){var J=Tg(G);U.call(J)}}var G=j_(a,0,!1,null,null,!1,!1,"",GT);return a._reactRootContainer=G,a[Ts]=G.current,oh(a.nodeType===8?a.parentNode:a),Pa(function(){Eg(c,G,d,m)}),G}function Cg(a,c,d,m,v){var w=d._reactRootContainer;if(w){var k=w;if(typeof v=="function"){var U=v;v=function(){var G=Tg(k);U.call(G)}}Eg(c,k,a,v)}else k=jM(d,c,a,v,m);return Tg(k)}Ku=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=st(c.pendingLanes);d!==0&&($u(c,d|1),Zn(c,xt()),(Je&6)===0&&(yc=xt()+500,po()))}break;case 13:Pa(function(){var m=Rs(a,1);if(m!==null){var v=zn();ur(m,a,1,v)}}),z_(a,1)}},Bl=function(a){if(a.tag===13){var c=Rs(a,134217728);if(c!==null){var d=zn();ur(c,a,134217728,d)}z_(a,134217728)}},Hu=function(a){if(a.tag===13){var c=wo(a),d=Rs(a,c);if(d!==null){var m=zn();ur(d,a,c,m)}z_(a,c)}},Xu=function(){return Xe},qu=function(a,c){var d=Xe;try{return Xe=a,c()}finally{Xe=d}},Fn=function(a,c,d){switch(c){case"input":if(Kn(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var m=d[c];if(m!==a&&m.form===a.form){var v=Gf(m);if(!v)throw Error(t(90));fs(m),Kn(m,v)}}}break;case"textarea":to(a,d);break;case"select":c=d.value,c!=null&&nn(a,!!d.multiple,c,!1)}},Ni=N_,fn=Pa;var zM={usingClientEntryPoint:!1,Events:[ch,rc,Gf,nr,Ft,N_]},Th={findFiberByHostInstance:Ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},UM={bundleType:Th.bundleType,version:Th.version,rendererPackageName:Th.rendererPackageName,rendererConfig:Th.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=If(a),a===null?null:a.stateNode},findFiberByHostInstance:Th.findFiberByHostInstance||VM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rg.isDisabled&&Rg.supportsFiber)try{fa=Rg.inject(UM),ui=Rg}catch{}}return Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zM,Qn.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!B_(c))throw Error(t(200));return FM(a,c,null,d)},Qn.createRoot=function(a,c){if(!B_(a))throw Error(t(299));var d=!1,m="",v=BT;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onRecoverableError!==void 0&&(v=c.onRecoverableError)),c=j_(a,1,!1,null,null,d,!1,m,v),a[Ts]=c.current,oh(a.nodeType===8?a.parentNode:a),new U_(c)},Qn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=If(c),a=a===null?null:a.stateNode,a},Qn.flushSync=function(a){return Pa(a)},Qn.hydrate=function(a,c,d){if(!Ig(c))throw Error(t(200));return Cg(null,a,c,!0,d)},Qn.hydrateRoot=function(a,c,d){if(!B_(a))throw Error(t(405));var m=d!=null&&d.hydratedSources||null,v=!1,w="",k=BT;if(d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(k=d.onRecoverableError)),c=zT(c,null,a,1,d??null,v,!1,w,k),a[Ts]=c.current,oh(a),m)for(a=0;a<m.length;a++)d=m[a],v=d._getVersion,v=v(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,v]:c.mutableSourceEagerHydrationData.push(d,v);return new Sg(c)},Qn.render=function(a,c,d){if(!Ig(c))throw Error(t(200));return Cg(null,a,c,!1,d)},Qn.unmountComponentAtNode=function(a){if(!Ig(a))throw Error(t(40));return a._reactRootContainer?(Pa(function(){Cg(null,null,a,!1,function(){a._reactRootContainer=null,a[Ts]=null})}),!0):!1},Qn.unstable_batchedUpdates=N_,Qn.unstable_renderSubtreeIntoContainer=function(a,c,d,m){if(!Ig(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Cg(a,c,d,!1,m)},Qn.version="18.3.1-next-f1338f8080-20240426",Qn}var ZT;function qM(){if(ZT)return $_.exports;ZT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),$_.exports=XM(),$_.exports}var QT;function YM(){if(QT)return Ag;QT=1;var n=qM();return Ag.createRoot=n.createRoot,Ag.hydrateRoot=n.hydrateRoot,Ag}var ZM=YM();const QM=Sx(ZM);var q=Xd();const JM=Sx(q),Ix=q.createContext({});function Cx(n){const e=q.useRef(null);return e.current===null&&(e.current=n()),e.current}const wm=q.createContext(null),Rx=q.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class eL extends q.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function tL({children:n,isPresent:e}){const t=q.useId(),i=q.useRef(null),r=q.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=q.useContext(Rx);return q.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),_.jsx(eL,{isPresent:e,childRef:i,sizeRef:r,children:q.cloneElement(n,{ref:i})})}const nL=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=Cx(iL),u=q.useId(),h=q.useCallback(p=>{l.set(p,!0);for(const y of l.values())if(!y)return;i&&i()},[l,i]),f=q.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:p=>(l.set(p,!1),()=>l.delete(p))}),s?[Math.random(),h]:[t,h]);return q.useMemo(()=>{l.forEach((p,y)=>l.set(y,!1))},[t]),q.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=_.jsx(tL,{isPresent:t,children:n})),_.jsx(wm.Provider,{value:f,children:n})};function iL(){return new Map}function LA(n=!0){const e=q.useContext(wm);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=q.useId();q.useEffect(()=>{n&&r(s)},[n]);const o=q.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const bg=n=>n.key||"";function JT(n){const e=[];return q.Children.forEach(n,t=>{q.isValidElement(t)&&e.push(t)}),e}const Ax=typeof window<"u",OA=Ax?q.useLayoutEffect:q.useEffect,Ii=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,u]=LA(o),h=q.useMemo(()=>JT(n),[n]),f=o&&!l?[]:h.map(bg),p=q.useRef(!0),y=q.useRef(h),x=Cx(()=>new Map),[S,I]=q.useState(h),[T,A]=q.useState(h);OA(()=>{p.current=!1,y.current=h;for(let R=0;R<T.length;R++){const L=bg(T[R]);f.includes(L)?x.delete(L):x.get(L)!==!0&&x.set(L,!1)}},[T,f.length,f.join("-")]);const P=[];if(h!==S){let R=[...h];for(let L=0;L<T.length;L++){const j=T[L],D=bg(j);f.includes(D)||(R.splice(L,0,j),P.push(j))}s==="wait"&&P.length&&(R=P),A(JT(R)),I(h);return}const{forceRender:N}=q.useContext(Ix);return _.jsx(_.Fragment,{children:T.map(R=>{const L=bg(R),j=o&&!l?!1:h===T||f.includes(L),D=()=>{if(x.has(L))x.set(L,!0);else return;let b=!0;x.forEach(M=>{M||(b=!1)}),b&&(N?.(),A(y.current),o&&u?.(),i&&i())};return _.jsx(nL,{isPresent:j,initial:!p.current||t?void 0:!1,custom:j?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:j?void 0:D,children:R},L)})})},Si=n=>n;let FA=Si;function bx(n){let e;return()=>(e===void 0&&(e=n()),e)}const nu=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},zs=n=>n*1e3,Us=n=>n/1e3,rL={useManualTiming:!1};function sL(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,f=!1,p=!1)=>{const x=p&&i?e:t;return f&&s.add(h),x.has(h)||x.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Pg=["read","resolveKeyframes","update","preRender","render","postRender"],oL=40;function VA(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Pg.reduce((A,P)=>(A[P]=sL(s),A),{}),{read:l,resolveKeyframes:u,update:h,preRender:f,render:p,postRender:y}=o,x=()=>{const A=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(A-r.timestamp,oL),1),r.timestamp=A,r.isProcessing=!0,l.process(r),u.process(r),h.process(r),f.process(r),p.process(r),y.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(x))},S=()=>{t=!0,i=!0,r.isProcessing||n(x)};return{schedule:Pg.reduce((A,P)=>{const N=o[P];return A[P]=(R,L=!1,j=!1)=>(t||S(),N.schedule(R,L,j)),A},{}),cancel:A=>{for(let P=0;P<Pg.length;P++)o[Pg[P]].cancel(A)},state:r,steps:o}}const{schedule:Tt,cancel:Jo,state:xn,steps:X_}=VA(typeof requestAnimationFrame<"u"?requestAnimationFrame:Si,!0),jA=q.createContext({strict:!1}),eS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},iu={};for(const n in eS)iu[n]={isEnabled:e=>eS[n].some(t=>!!e[t])};function aL(n){for(const e in n)iu[e]={...iu[e],...n[e]}}const lL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ep(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||lL.has(n)}let zA=n=>!Ep(n);function cL(n){n&&(zA=e=>e.startsWith("on")?!Ep(e):n(e))}try{cL(require("@emotion/is-prop-valid").default)}catch{}function uL(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(zA(r)||t===!0&&Ep(r)||!e&&!Ep(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function hL(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const Em=q.createContext({});function pd(n){return typeof n=="string"||Array.isArray(n)}function Tm(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const Px=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],kx=["initial",...Px];function Sm(n){return Tm(n.animate)||kx.some(e=>pd(n[e]))}function UA(n){return!!(Sm(n)||n.variants)}function dL(n,e){if(Sm(n)){const{initial:t,animate:i}=n;return{initial:t===!1||pd(t)?t:void 0,animate:pd(i)?i:void 0}}return n.inherit!==!1?e:{}}function fL(n){const{initial:e,animate:t}=dL(n,q.useContext(Em));return q.useMemo(()=>({initial:e,animate:t}),[tS(e),tS(t)])}function tS(n){return Array.isArray(n)?n.join(" "):n}const gL=Symbol.for("motionComponentSymbol");function zc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function pL(n,e,t){return q.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):zc(t)&&(t.current=i))},[e])}const Dx=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),mL="framerAppearId",BA="data-"+Dx(mL),{schedule:Nx}=VA(queueMicrotask,!1),GA=q.createContext({});function yL(n,e,t,i,r){var s,o;const{visualElement:l}=q.useContext(Em),u=q.useContext(jA),h=q.useContext(wm),f=q.useContext(Rx).reducedMotion,p=q.useRef(null);i=i||u.renderer,!p.current&&i&&(p.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const y=p.current,x=q.useContext(GA);y&&!y.projection&&r&&(y.type==="html"||y.type==="svg")&&_L(p.current,t,r,x);const S=q.useRef(!1);q.useInsertionEffect(()=>{y&&S.current&&y.update(t,h)});const I=t[BA],T=q.useRef(!!I&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,I))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,I)));return OA(()=>{y&&(S.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),Nx.render(y.render),T.current&&y.animationState&&y.animationState.animateChanges())}),q.useEffect(()=>{y&&(!T.current&&y.animationState&&y.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{var A;(A=window.MotionHandoffMarkAsComplete)===null||A===void 0||A.call(window,I)}),T.current=!1))}),y}function _L(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:WA(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&zc(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function WA(n){if(n)return n.options.allowProjection!==!1?n.projection:WA(n.parent)}function vL({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&aL(n);function l(h,f){let p;const y={...q.useContext(Rx),...h,layoutId:xL(h)},{isStatic:x}=y,S=fL(h),I=i(h,x);if(!x&&Ax){wL();const T=EL(y);p=T.MeasureLayout,S.visualElement=yL(r,I,y,e,T.ProjectionNode)}return _.jsxs(Em.Provider,{value:S,children:[p&&S.visualElement?_.jsx(p,{visualElement:S.visualElement,...y}):null,t(r,h,pL(I,S.visualElement,f),I,x,S.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=q.forwardRef(l);return u[gL]=r,u}function xL({layoutId:n}){const e=q.useContext(Ix).id;return e&&n!==void 0?e+"-"+n:n}function wL(n,e){q.useContext(jA).strict}function EL(n){const{drag:e,layout:t}=iu;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const TL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Mx(n){return typeof n!="string"||n.includes("-")?!1:!!(TL.indexOf(n)>-1||/[A-Z]/u.test(n))}function nS(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function Lx(n,e,t,i){if(typeof e=="function"){const[r,s]=nS(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=nS(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const nv=n=>Array.isArray(n),SL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),IL=n=>nv(n)?n[n.length-1]||0:n,Ln=n=>!!(n&&n.getVelocity);function ip(n){const e=Ln(n)?n.get():n;return SL(e)?e.toValue():e}function CL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:RL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const $A=n=>(e,t)=>{const i=q.useContext(Em),r=q.useContext(wm),s=()=>CL(n,e,i,r);return t?s():Cx(s)};function RL(n,e,t,i){const r={},s=i(n,{});for(const y in s)r[y]=ip(s[y]);let{initial:o,animate:l}=n;const u=Sm(n),h=UA(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const p=f?l:o;if(p&&typeof p!="boolean"&&!Tm(p)){const y=Array.isArray(p)?p:[p];for(let x=0;x<y.length;x++){const S=Lx(n,y[x]);if(S){const{transitionEnd:I,transition:T,...A}=S;for(const P in A){let N=A[P];if(Array.isArray(N)){const R=f?N.length-1:0;N=N[R]}N!==null&&(r[P]=N)}for(const P in I)r[P]=I[P]}}}return r}const bu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Pl=new Set(bu),KA=n=>e=>typeof e=="string"&&e.startsWith(n),HA=KA("--"),AL=KA("var(--"),Ox=n=>AL(n)?bL.test(n.split("/*")[0].trim()):!1,bL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,XA=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Ks=(n,e,t)=>t>e?e:t<n?n:t,Pu={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},md={...Pu,transform:n=>Ks(0,1,n)},kg={...Pu,default:1},qd=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Lo=qd("deg"),ns=qd("%"),De=qd("px"),PL=qd("vh"),kL=qd("vw"),iS={...ns,parse:n=>ns.parse(n)/100,transform:n=>ns.transform(n*100)},DL={borderWidth:De,borderTopWidth:De,borderRightWidth:De,borderBottomWidth:De,borderLeftWidth:De,borderRadius:De,radius:De,borderTopLeftRadius:De,borderTopRightRadius:De,borderBottomRightRadius:De,borderBottomLeftRadius:De,width:De,maxWidth:De,height:De,maxHeight:De,top:De,right:De,bottom:De,left:De,padding:De,paddingTop:De,paddingRight:De,paddingBottom:De,paddingLeft:De,margin:De,marginTop:De,marginRight:De,marginBottom:De,marginLeft:De,backgroundPositionX:De,backgroundPositionY:De},NL={rotate:Lo,rotateX:Lo,rotateY:Lo,rotateZ:Lo,scale:kg,scaleX:kg,scaleY:kg,scaleZ:kg,skew:Lo,skewX:Lo,skewY:Lo,distance:De,translateX:De,translateY:De,translateZ:De,x:De,y:De,z:De,perspective:De,transformPerspective:De,opacity:md,originX:iS,originY:iS,originZ:De},rS={...Pu,transform:Math.round},Fx={...DL,...NL,zIndex:rS,size:De,fillOpacity:md,strokeOpacity:md,numOctaves:rS},ML={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},LL=bu.length;function OL(n,e,t){let i="",r=!0;for(let s=0;s<LL;s++){const o=bu[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=XA(l,Fx[o]);if(!u){r=!1;const f=ML[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function Vx(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const u in e){const h=e[u];if(Pl.has(u)){o=!0;continue}else if(HA(u)){r[u]=h;continue}else{const f=XA(h,Fx[u]);u.startsWith("origin")?(l=!0,s[u]=f):i[u]=f}}if(e.transform||(o||t?i.transform=OL(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${u} ${h} ${f}`}}const FL={offset:"stroke-dashoffset",array:"stroke-dasharray"},VL={offset:"strokeDashoffset",array:"strokeDasharray"};function jL(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?FL:VL;n[s.offset]=De.transform(-i);const o=De.transform(e),l=De.transform(t);n[s.array]=`${o} ${l}`}function sS(n,e,t){return typeof n=="string"?n:De.transform(e+t*n)}function zL(n,e,t){const i=sS(e,n.x,n.width),r=sS(t,n.y,n.height);return`${i} ${r}`}function jx(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...h},f,p){if(Vx(n,h,p),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:y,style:x,dimensions:S}=n;y.transform&&(S&&(x.transform=y.transform),delete y.transform),S&&(r!==void 0||s!==void 0||x.transform)&&(x.transformOrigin=zL(S,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(y.x=e),t!==void 0&&(y.y=t),i!==void 0&&(y.scale=i),o!==void 0&&jL(y,o,l,u,!1)}const zx=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),qA=()=>({...zx(),attrs:{}}),Ux=n=>typeof n=="string"&&n.toLowerCase()==="svg";function YA(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const ZA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function QA(n,e,t,i){YA(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(ZA.has(r)?r:Dx(r),e.attrs[r])}const Tp={};function UL(n){Object.assign(Tp,n)}function JA(n,{layout:e,layoutId:t}){return Pl.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Tp[n]||n==="opacity")}function Bx(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(Ln(r[o])||e.style&&Ln(e.style[o])||JA(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function e2(n,e,t){const i=Bx(n,e,t);for(const r in n)if(Ln(n[r])||Ln(e[r])){const s=bu.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function BL(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const oS=["x","y","width","height","cx","cy","r"],GL={useVisualState:$A({scrapeMotionValuesFromProps:e2,createRenderState:qA,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(Pl.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<oS.length;l++){const u=oS[l];n[u]!==e[u]&&(o=!0)}o&&Tt.read(()=>{BL(t,i),Tt.render(()=>{jx(i,r,Ux(t.tagName),n.transformTemplate),QA(t,i)})})}})},WL={useVisualState:$A({scrapeMotionValuesFromProps:Bx,createRenderState:zx})};function t2(n,e,t){for(const i in e)!Ln(e[i])&&!JA(i,t)&&(n[i]=e[i])}function $L({transformTemplate:n},e){return q.useMemo(()=>{const t=zx();return Vx(t,e,n),Object.assign({},t.vars,t.style)},[e])}function KL(n,e){const t=n.style||{},i={};return t2(i,t,n),Object.assign(i,$L(n,e)),i}function HL(n,e){const t={},i=KL(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function XL(n,e,t,i){const r=q.useMemo(()=>{const s=qA();return jx(s,e,Ux(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};t2(s,n.style,n),r.style={...s,...r.style}}return r}function qL(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(Mx(t)?XL:HL)(i,s,o,t),h=uL(i,typeof t=="string",n),f=t!==q.Fragment?{...h,...u,ref:r}:{},{children:p}=i,y=q.useMemo(()=>Ln(p)?p.get():p,[p]);return q.createElement(t,{...f,children:y})}}function YL(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...Mx(i)?GL:WL,preloadedFeatures:n,useRender:qL(r),createVisualElement:e,Component:i};return vL(o)}}function n2(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function Im(n,e,t){const i=n.getProps();return Lx(i,e,t!==void 0?t:i.custom,n)}const ZL=bx(()=>window.ScrollTimeline!==void 0);class QL{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(ZL()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class JL extends QL{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Gx(n,e){return n?n[e]||n.default||n:void 0}const iv=2e4;function i2(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<iv;)e+=t,i=n.next(e);return e>=iv?1/0:e}function Wx(n){return typeof n=="function"}function aS(n,e){n.timeline=e,n.onfinish=null}const $x=n=>Array.isArray(n)&&typeof n[0]=="number",eO={linearEasing:void 0};function tO(n,e){const t=bx(n);return()=>{var i;return(i=eO[e])!==null&&i!==void 0?i:t()}}const Sp=tO(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),r2=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(nu(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function s2(n){return!!(typeof n=="function"&&Sp()||!n||typeof n=="string"&&(n in rv||Sp())||$x(n)||Array.isArray(n)&&n.every(s2))}const Vh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,rv={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Vh([0,.65,.55,1]),circOut:Vh([.55,0,1,.45]),backIn:Vh([.31,.01,.66,-.59]),backOut:Vh([.33,1.53,.69,.99])};function o2(n,e){if(n)return typeof n=="function"&&Sp()?r2(n,e):$x(n)?Vh(n):Array.isArray(n)?n.map(t=>o2(t,e)||rv.easeOut):rv[n]}const dr={x:!1,y:!1};function a2(){return dr.x||dr.y}function nO(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function l2(n,e){const t=nO(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function lS(n){return e=>{e.pointerType==="touch"||a2()||n(e)}}function iO(n,e,t={}){const[i,r,s]=l2(n,t),o=lS(l=>{const{target:u}=l,h=e(l);if(typeof h!="function"||!u)return;const f=lS(p=>{h(p),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const c2=(n,e)=>e?n===e?!0:c2(n,e.parentElement):!1,Kx=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,rO=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function sO(n){return rO.has(n.tagName)||n.tabIndex!==-1}const jh=new WeakSet;function cS(n){return e=>{e.key==="Enter"&&n(e)}}function q_(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const oO=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=cS(()=>{if(jh.has(t))return;q_(t,"down");const r=cS(()=>{q_(t,"up")}),s=()=>q_(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function uS(n){return Kx(n)&&!a2()}function aO(n,e,t={}){const[i,r,s]=l2(n,t),o=l=>{const u=l.currentTarget;if(!uS(l)||jh.has(u))return;jh.add(u);const h=e(l),f=(x,S)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",y),!(!uS(x)||!jh.has(u))&&(jh.delete(u),typeof h=="function"&&h(x,{success:S}))},p=x=>{f(x,t.useGlobalTarget||c2(u,x.target))},y=x=>{f(x,!1)};window.addEventListener("pointerup",p,r),window.addEventListener("pointercancel",y,r)};return i.forEach(l=>{!sO(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>oO(h,r),r)}),s}function lO(n){return n==="x"||n==="y"?dr[n]?null:(dr[n]=!0,()=>{dr[n]=!1}):dr.x||dr.y?null:(dr.x=dr.y=!0,()=>{dr.x=dr.y=!1})}const u2=new Set(["width","height","top","left","right","bottom",...bu]);let rp;function cO(){rp=void 0}const is={now:()=>(rp===void 0&&is.set(xn.isProcessing||rL.useManualTiming?xn.timestamp:performance.now()),rp),set:n=>{rp=n,queueMicrotask(cO)}};function Hx(n,e){n.indexOf(e)===-1&&n.push(e)}function Xx(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class qx{constructor(){this.subscriptions=[]}add(e){return Hx(this.subscriptions,e),()=>Xx(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function h2(n,e){return e?n*(1e3/e):0}const hS=30,uO=n=>!isNaN(parseFloat(n));class hO{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=is.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=is.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=uO(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new qx);const i=this.events[e].add(t);return e==="change"?()=>{i(),Tt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=is.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>hS)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,hS);return h2(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function yd(n,e){return new hO(n,e)}function dO(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,yd(t))}function fO(n,e){const t=Im(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=IL(s[o]);dO(n,o,l)}}function gO(n){return!!(Ln(n)&&n.add)}function sv(n,e){const t=n.getValue("willChange");if(gO(t))return t.add(e)}function d2(n){return n.props[BA]}const f2=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,pO=1e-7,mO=12;function yO(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=f2(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>pO&&++l<mO);return o}function Yd(n,e,t,i){if(n===e&&t===i)return Si;const r=s=>yO(s,0,1,n,t);return s=>s===0||s===1?s:f2(r(s),e,i)}const g2=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,p2=n=>e=>1-n(1-e),m2=Yd(.33,1.53,.69,.99),Yx=p2(m2),y2=g2(Yx),_2=n=>(n*=2)<1?.5*Yx(n):.5*(2-Math.pow(2,-10*(n-1))),Zx=n=>1-Math.sin(Math.acos(n)),v2=p2(Zx),x2=g2(Zx),w2=n=>/^0[^.\s]+$/u.test(n);function _O(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||w2(n):!0}const Yh=n=>Math.round(n*1e5)/1e5,Qx=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function vO(n){return n==null}const xO=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Jx=(n,e)=>t=>!!(typeof t=="string"&&xO.test(t)&&t.startsWith(n)||e&&!vO(t)&&Object.prototype.hasOwnProperty.call(t,e)),E2=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(Qx);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},wO=n=>Ks(0,255,n),Y_={...Pu,transform:n=>Math.round(wO(n))},Za={test:Jx("rgb","red"),parse:E2("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+Y_.transform(n)+", "+Y_.transform(e)+", "+Y_.transform(t)+", "+Yh(md.transform(i))+")"};function EO(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const ov={test:Jx("#"),parse:EO,transform:Za.transform},Uc={test:Jx("hsl","hue"),parse:E2("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+ns.transform(Yh(e))+", "+ns.transform(Yh(t))+", "+Yh(md.transform(i))+")"},Nn={test:n=>Za.test(n)||ov.test(n)||Uc.test(n),parse:n=>Za.test(n)?Za.parse(n):Uc.test(n)?Uc.parse(n):ov.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Za.transform(n):Uc.transform(n)},TO=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function SO(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(Qx))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(TO))===null||t===void 0?void 0:t.length)||0)>0}const T2="number",S2="color",IO="var",CO="var(",dS="${}",RO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function _d(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(RO,u=>(Nn.test(u)?(i.color.push(s),r.push(S2),t.push(Nn.parse(u))):u.startsWith(CO)?(i.var.push(s),r.push(IO),t.push(u)):(i.number.push(s),r.push(T2),t.push(parseFloat(u))),++s,dS)).split(dS);return{values:t,split:l,indexes:i,types:r}}function I2(n){return _d(n).values}function C2(n){const{split:e,types:t}=_d(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===T2?s+=Yh(r[o]):l===S2?s+=Nn.transform(r[o]):s+=r[o]}return s}}const AO=n=>typeof n=="number"?0:n;function bO(n){const e=I2(n);return C2(n)(e.map(AO))}const ea={test:SO,parse:I2,createTransformer:C2,getAnimatableNone:bO},PO=new Set(["brightness","contrast","saturate","opacity"]);function kO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(Qx)||[];if(!i)return n;const r=t.replace(i,"");let s=PO.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const DO=/\b([a-z-]*)\(.*?\)/gu,av={...ea,getAnimatableNone:n=>{const e=n.match(DO);return e?e.map(kO).join(" "):n}},NO={...Fx,color:Nn,backgroundColor:Nn,outlineColor:Nn,fill:Nn,stroke:Nn,borderColor:Nn,borderTopColor:Nn,borderRightColor:Nn,borderBottomColor:Nn,borderLeftColor:Nn,filter:av,WebkitFilter:av},e1=n=>NO[n];function R2(n,e){let t=e1(n);return t!==av&&(t=ea),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const MO=new Set(["auto","none","0"]);function LO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!MO.has(s)&&_d(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=R2(t,r)}const fS=n=>n===Pu||n===De,gS=(n,e)=>parseFloat(n.split(", ")[e]),pS=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return gS(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?gS(s[1],n):0}},OO=new Set(["x","y","z"]),FO=bu.filter(n=>!OO.has(n));function VO(n){const e=[];return FO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const ru={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:pS(4,13),y:pS(5,14)};ru.translateX=ru.x;ru.translateY=ru.y;const sl=new Set;let lv=!1,cv=!1;function A2(){if(cv){const n=Array.from(sl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=VO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}cv=!1,lv=!1,sl.forEach(n=>n.complete()),sl.clear()}function b2(){sl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(cv=!0)})}function jO(){b2(),A2()}class t1{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(sl.add(this),lv||(lv=!0,Tt.read(b2),Tt.resolveKeyframes(A2))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),sl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,sl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const P2=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),zO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function UO(n){const e=zO.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function k2(n,e,t=1){const[i,r]=UO(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return P2(o)?parseFloat(o):o}return Ox(r)?k2(r,e,t+1):r}const D2=n=>e=>e.test(n),BO={test:n=>n==="auto",parse:n=>n},N2=[Pu,De,ns,Lo,kL,PL,BO],mS=n=>N2.find(D2(n));class M2 extends t1{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),Ox(h))){const f=k2(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!u2.has(i)||e.length!==2)return;const[r,s]=e,o=mS(r),l=mS(s);if(o!==l)if(fS(o)&&fS(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)_O(e[r])&&i.push(r);i.length&&LO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ru[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=ru[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const yS=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ea.test(n)||n==="0")&&!n.startsWith("url("));function GO(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function WO(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=yS(r,e),l=yS(s,e);return!o||!l?!1:GO(n)||(t==="spring"||Wx(t))&&i}const $O=n=>n!==null;function Cm(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter($O),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const KO=40;class L2{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=is.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>KO?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&jO(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=is.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:u,isGenerator:h}=this.options;if(!h&&!WO(e,i,r,s))if(o)this.options.duration=0;else{u&&u(Cm(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Dt=(n,e,t)=>n+(e-n)*t;function Z_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function HO({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;r=Z_(u,l,n+1/3),s=Z_(u,l,n),o=Z_(u,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Ip(n,e){return t=>t>0?e:n}const Q_=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},XO=[ov,Za,Uc],qO=n=>XO.find(e=>e.test(n));function _S(n){const e=qO(n);if(!e)return!1;let t=e.parse(n);return e===Uc&&(t=HO(t)),t}const vS=(n,e)=>{const t=_S(n),i=_S(e);if(!t||!i)return Ip(n,e);const r={...t};return s=>(r.red=Q_(t.red,i.red,s),r.green=Q_(t.green,i.green,s),r.blue=Q_(t.blue,i.blue,s),r.alpha=Dt(t.alpha,i.alpha,s),Za.transform(r))},YO=(n,e)=>t=>e(n(t)),Zd=(...n)=>n.reduce(YO),uv=new Set(["none","hidden"]);function ZO(n,e){return uv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function QO(n,e){return t=>Dt(n,e,t)}function n1(n){return typeof n=="number"?QO:typeof n=="string"?Ox(n)?Ip:Nn.test(n)?vS:tF:Array.isArray(n)?O2:typeof n=="object"?Nn.test(n)?vS:JO:Ip}function O2(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>n1(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function JO(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=n1(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function eF(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],u=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const tF=(n,e)=>{const t=ea.createTransformer(e),i=_d(n),r=_d(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?uv.has(n)&&!r.values.length||uv.has(e)&&!i.values.length?ZO(n,e):Zd(O2(eF(i,r),r.values),t):Ip(n,e)};function F2(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Dt(n,e,t):n1(n)(n,e)}const nF=5;function V2(n,e,t){const i=Math.max(e-nF,0);return h2(t-n(i),e-i)}const Ot={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},J_=.001;function iF({duration:n=Ot.duration,bounce:e=Ot.bounce,velocity:t=Ot.velocity,mass:i=Ot.mass}){let r,s,o=1-e;o=Ks(Ot.minDamping,Ot.maxDamping,o),n=Ks(Ot.minDuration,Ot.maxDuration,Us(n)),o<1?(r=h=>{const f=h*o,p=f*n,y=f-t,x=hv(h,o),S=Math.exp(-p);return J_-y/x*S},s=h=>{const p=h*o*n,y=p*t+t,x=Math.pow(o,2)*Math.pow(h,2)*n,S=Math.exp(-p),I=hv(Math.pow(h,2),o);return(-r(h)+J_>0?-1:1)*((y-x)*S)/I}):(r=h=>{const f=Math.exp(-h*n),p=(h-t)*n+1;return-J_+f*p},s=h=>{const f=Math.exp(-h*n),p=(t-h)*(n*n);return f*p});const l=5/n,u=sF(r,s,l);if(n=zs(n),isNaN(u))return{stiffness:Ot.stiffness,damping:Ot.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const rF=12;function sF(n,e,t){let i=t;for(let r=1;r<rF;r++)i=i-n(i)/e(i);return i}function hv(n,e){return n*Math.sqrt(1-e*e)}const oF=["duration","bounce"],aF=["stiffness","damping","mass"];function xS(n,e){return e.some(t=>n[t]!==void 0)}function lF(n){let e={velocity:Ot.velocity,stiffness:Ot.stiffness,damping:Ot.damping,mass:Ot.mass,isResolvedFromDuration:!1,...n};if(!xS(n,aF)&&xS(n,oF))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Ks(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Ot.mass,stiffness:r,damping:s}}else{const t=iF(n);e={...e,...t,mass:Ot.mass},e.isResolvedFromDuration=!0}return e}function j2(n=Ot.visualDuration,e=Ot.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:p,velocity:y,isResolvedFromDuration:x}=lF({...t,velocity:-Us(t.velocity||0)}),S=y||0,I=h/(2*Math.sqrt(u*f)),T=o-s,A=Us(Math.sqrt(u/f)),P=Math.abs(T)<5;i||(i=P?Ot.restSpeed.granular:Ot.restSpeed.default),r||(r=P?Ot.restDelta.granular:Ot.restDelta.default);let N;if(I<1){const L=hv(A,I);N=j=>{const D=Math.exp(-I*A*j);return o-D*((S+I*A*T)/L*Math.sin(L*j)+T*Math.cos(L*j))}}else if(I===1)N=L=>o-Math.exp(-A*L)*(T+(S+A*T)*L);else{const L=A*Math.sqrt(I*I-1);N=j=>{const D=Math.exp(-I*A*j),b=Math.min(L*j,300);return o-D*((S+I*A*T)*Math.sinh(b)+L*T*Math.cosh(b))/L}}const R={calculatedDuration:x&&p||null,next:L=>{const j=N(L);if(x)l.done=L>=p;else{let D=0;I<1&&(D=L===0?zs(S):V2(N,L,j));const b=Math.abs(D)<=i,M=Math.abs(o-j)<=r;l.done=b&&M}return l.value=l.done?o:j,l},toString:()=>{const L=Math.min(i2(R),iv),j=r2(D=>R.next(L*D).value,L,30);return L+"ms "+j}};return R}function wS({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:f}){const p=n[0],y={done:!1,value:p},x=b=>l!==void 0&&b<l||u!==void 0&&b>u,S=b=>l===void 0?u:u===void 0||Math.abs(l-b)<Math.abs(u-b)?l:u;let I=t*e;const T=p+I,A=o===void 0?T:o(T);A!==T&&(I=A-p);const P=b=>-I*Math.exp(-b/i),N=b=>A+P(b),R=b=>{const M=P(b),V=N(b);y.done=Math.abs(M)<=h,y.value=y.done?A:V};let L,j;const D=b=>{x(y.value)&&(L=b,j=j2({keyframes:[y.value,S(y.value)],velocity:V2(N,b,y.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return D(0),{calculatedDuration:null,next:b=>{let M=!1;return!j&&L===void 0&&(M=!0,R(b),D(b)),L!==void 0&&b>=L?j.next(b-L):(!M&&R(b),y)}}}const cF=Yd(.42,0,1,1),uF=Yd(0,0,.58,1),z2=Yd(.42,0,.58,1),hF=n=>Array.isArray(n)&&typeof n[0]!="number",dF={linear:Si,easeIn:cF,easeInOut:z2,easeOut:uF,circIn:Zx,circInOut:x2,circOut:v2,backIn:Yx,backInOut:y2,backOut:m2,anticipate:_2},ES=n=>{if($x(n)){FA(n.length===4);const[e,t,i,r]=n;return Yd(e,t,i,r)}else if(typeof n=="string")return dF[n];return n};function fF(n,e,t){const i=[],r=t||F2,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Si:e;l=Zd(u,l)}i.push(l)}return i}function gF(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(FA(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=fF(e,i,r),u=l.length,h=f=>{if(o&&f<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(f<n[p+1]);p++);const y=nu(n[p],n[p+1],f);return l[p](y)};return t?f=>h(Ks(n[0],n[s-1],f)):h}function pF(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=nu(0,e,i);n.push(Dt(t,1,r))}}function mF(n){const e=[0];return pF(e,n.length-1),e}function yF(n,e){return n.map(t=>t*e)}function _F(n,e){return n.map(()=>e||z2).splice(0,n.length-1)}function Cp({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=hF(i)?i.map(ES):ES(i),s={done:!1,value:e[0]},o=yF(t&&t.length===e.length?t:mF(e),n),l=gF(o,e,{ease:Array.isArray(r)?r:_F(e,r)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const vF=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Tt.update(e,!0),stop:()=>Jo(e),now:()=>xn.isProcessing?xn.timestamp:is.now()}},xF={decay:wS,inertia:wS,tween:Cp,keyframes:Cp,spring:j2},wF=n=>n/100;class i1 extends L2{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||t1,l=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=Wx(t)?t:xF[t]||Cp;let u,h;l!==Cp&&typeof e[0]!="number"&&(u=Zd(wF,F2(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=i2(f));const{calculatedDuration:p}=f,y=p+r,x=y*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:p,resolvedDuration:y,totalDuration:x}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:b}=this.options;return{done:!0,value:b[b.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:p}=i;if(this.startTime===null)return s.next(0);const{delay:y,repeat:x,repeatType:S,repeatDelay:I,onUpdate:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const A=this.currentTime-y*(this.speed>=0?1:-1),P=this.speed>=0?A<0:A>f;this.currentTime=Math.max(A,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let N=this.currentTime,R=s;if(x){const b=Math.min(this.currentTime,f)/p;let M=Math.floor(b),V=b%1;!V&&b>=1&&(V=1),V===1&&M--,M=Math.min(M,x+1),M%2&&(S==="reverse"?(V=1-V,I&&(V-=I/p)):S==="mirror"&&(R=o)),N=Ks(0,1,V)*p}const L=P?{done:!1,value:u[0]}:R.next(N);l&&(L.value=l(L.value));let{done:j}=L;!P&&h!==null&&(j=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&j);return D&&r!==void 0&&(L.value=Cm(u,this.options,r)),T&&T(L.value),D&&this.finish(),L}get duration(){const{resolved:e}=this;return e?Us(e.calculatedDuration):0}get time(){return Us(this.currentTime)}set time(e){e=zs(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Us(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=vF,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const EF=new Set(["opacity","clipPath","filter","transform"]);function TF(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=o2(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const SF=bx(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Rp=10,IF=2e4;function CF(n){return Wx(n.type)||n.type==="spring"||!s2(n.ease)}function RF(n,e){const t=new i1({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<IF;)i=t.sample(s),r.push(i.value),s+=Rp;return{times:void 0,keyframes:r,duration:s-Rp,ease:"linear"}}const U2={anticipate:_2,backInOut:y2,circInOut:x2};function AF(n){return n in U2}class TS extends L2{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new M2(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:u,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&Sp()&&AF(s)&&(s=U2[s]),CF(this.options)){const{onComplete:p,onUpdate:y,motionValue:x,element:S,...I}=this.options,T=RF(e,I);e=T.keyframes,e.length===1&&(e[1]=e[0]),i=T.duration,r=T.times,s=T.ease,o="keyframes"}const f=TF(l.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(aS(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:p}=this.options;l.set(Cm(e,this.options,t)),p&&p(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Us(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Us(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=zs(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Si;const{animation:i}=t;aS(i,e)}return Si}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:p,element:y,...x}=this.options,S=new i1({...x,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),I=zs(this.time);h.setWithVelocity(S.sample(I-Rp).value,S.sample(I).value,Rp)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return SF()&&i&&EF.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const bF={type:"spring",stiffness:500,damping:25,restSpeed:10},PF=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),kF={type:"keyframes",duration:.8},DF={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},NF=(n,{keyframes:e})=>e.length>2?kF:Pl.has(n)?n.startsWith("scale")?PF(e[1]):bF:DF;function MF({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const r1=(n,e,t,i={},r,s)=>o=>{const l=Gx(i,n)||{},u=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-zs(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:y=>{e.set(y),l.onUpdate&&l.onUpdate(y)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};MF(l)||(f={...f,...NF(n,f)}),f.duration&&(f.duration=zs(f.duration)),f.repeatDelay&&(f.repeatDelay=zs(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(p=!0)),p&&!s&&e.get()!==void 0){const y=Cm(f.keyframes,l);if(y!==void 0)return Tt.update(()=>{f.onUpdate(y),f.onComplete()}),new JL([])}return!s&&TS.supports(f)?new TS(f):new i1(f)};function LF({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function B2(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...u}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const p in u){const y=n.getValue(p,(s=n.latestValues[p])!==null&&s!==void 0?s:null),x=u[p];if(x===void 0||f&&LF(f,p))continue;const S={delay:t,...Gx(o||{},p)};let I=!1;if(window.MotionHandoffAnimation){const A=d2(n);if(A){const P=window.MotionHandoffAnimation(A,p,Tt);P!==null&&(S.startTime=P,I=!0)}}sv(n,p),y.start(r1(p,y,x,n.shouldReduceMotion&&u2.has(p)?{type:!1}:S,n,I));const T=y.animation;T&&h.push(T)}return l&&Promise.all(h).then(()=>{Tt.update(()=>{l&&fO(n,l)})}),h}function dv(n,e,t={}){var i;const r=Im(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(B2(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:p,staggerDirection:y}=s;return OF(n,e,f+h,p,y,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function OF(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(FF).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(dv(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function FF(n,e){return n.sortNodePosition(e)}function VF(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>dv(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=dv(n,e,t);else{const r=typeof e=="function"?Im(n,e,t.custom):e;i=Promise.all(B2(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const jF=kx.length;function G2(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?G2(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<jF;t++){const i=kx[t],r=n.props[i];(pd(r)||r===!1)&&(e[i]=r)}return e}const zF=[...Px].reverse(),UF=Px.length;function BF(n){return e=>Promise.all(e.map(({animation:t,options:i})=>VF(n,t,i)))}function GF(n){let e=BF(n),t=SS(),i=!0;const r=u=>(h,f)=>{var p;const y=Im(n,f,u==="exit"?(p=n.presenceContext)===null||p===void 0?void 0:p.custom:void 0);if(y){const{transition:x,transitionEnd:S,...I}=y;h={...h,...I,...S}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,f=G2(n.parent)||{},p=[],y=new Set;let x={},S=1/0;for(let T=0;T<UF;T++){const A=zF[T],P=t[A],N=h[A]!==void 0?h[A]:f[A],R=pd(N),L=A===u?P.isActive:null;L===!1&&(S=T);let j=N===f[A]&&N!==h[A]&&R;if(j&&i&&n.manuallyAnimateOnMount&&(j=!1),P.protectedKeys={...x},!P.isActive&&L===null||!N&&!P.prevProp||Tm(N)||typeof N=="boolean")continue;const D=WF(P.prevProp,N);let b=D||A===u&&P.isActive&&!j&&R||T>S&&R,M=!1;const V=Array.isArray(N)?N:[N];let z=V.reduce(r(A),{});L===!1&&(z={});const{prevResolvedValues:B={}}=P,O={...B,...z},le=ue=>{b=!0,y.has(ue)&&(M=!0,y.delete(ue)),P.needsAnimating[ue]=!0;const Q=n.getValue(ue);Q&&(Q.liveStyle=!1)};for(const ue in O){const Q=z[ue],se=B[ue];if(x.hasOwnProperty(ue))continue;let ne=!1;nv(Q)&&nv(se)?ne=!n2(Q,se):ne=Q!==se,ne?Q!=null?le(ue):y.add(ue):Q!==void 0&&y.has(ue)?le(ue):P.protectedKeys[ue]=!0}P.prevProp=N,P.prevResolvedValues=z,P.isActive&&(x={...x,...z}),i&&n.blockInitialAnimation&&(b=!1),b&&(!(j&&D)||M)&&p.push(...V.map(ue=>({animation:ue,options:{type:A}})))}if(y.size){const T={};y.forEach(A=>{const P=n.getBaseTarget(A),N=n.getValue(A);N&&(N.liveStyle=!0),T[A]=P??null}),p.push({animation:T})}let I=!!p.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(I=!1),i=!1,I?e(p):Promise.resolve()}function l(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(y=>{var x;return(x=y.animationState)===null||x===void 0?void 0:x.setActive(u,h)}),t[u].isActive=h;const p=o(u);for(const y in t)t[y].protectedKeys={};return p}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=SS(),i=!0}}}function WF(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!n2(e,n):!1}function Ma(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function SS(){return{animate:Ma(!0),whileInView:Ma(),whileHover:Ma(),whileTap:Ma(),whileDrag:Ma(),whileFocus:Ma(),exit:Ma()}}let oa=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class $F extends oa{constructor(e){super(e),e.animationState||(e.animationState=GF(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Tm(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let KF=0;class HF extends oa{constructor(){super(...arguments),this.id=KF++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const XF={animation:{Feature:$F},exit:{Feature:HF}};function vd(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function Qd(n){return{point:{x:n.pageX,y:n.pageY}}}const qF=n=>e=>Kx(e)&&n(e,Qd(e));function Zh(n,e,t,i){return vd(n,e,qF(t),i)}const IS=(n,e)=>Math.abs(n-e);function YF(n,e){const t=IS(n.x,e.x),i=IS(n.y,e.y);return Math.sqrt(t**2+i**2)}class W2{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=t0(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,x=YF(p.offset,{x:0,y:0})>=3;if(!y&&!x)return;const{point:S}=p,{timestamp:I}=xn;this.history.push({...S,timestamp:I});const{onStart:T,onMove:A}=this.handlers;y||(T&&T(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,p)},this.handlePointerMove=(p,y)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=e0(y,this.transformPagePoint),Tt.update(this.updatePoint,!0)},this.handlePointerUp=(p,y)=>{this.end();const{onEnd:x,onSessionEnd:S,resumeAnimation:I}=this.handlers;if(this.dragSnapToOrigin&&I&&I(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=t0(p.type==="pointercancel"?this.lastMoveEventInfo:e0(y,this.transformPagePoint),this.history);this.startEvent&&x&&x(p,T),S&&S(p,T)},!Kx(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=Qd(e),l=e0(o,this.transformPagePoint),{point:u}=l,{timestamp:h}=xn;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,t0(l,this.history)),this.removeListeners=Zd(Zh(this.contextWindow,"pointermove",this.handlePointerMove),Zh(this.contextWindow,"pointerup",this.handlePointerUp),Zh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Jo(this.updatePoint)}}function e0(n,e){return e?{point:e(n.point)}:n}function CS(n,e){return{x:n.x-e.x,y:n.y-e.y}}function t0({point:n},e){return{point:n,delta:CS(n,$2(e)),offset:CS(n,ZF(e)),velocity:QF(e,.1)}}function ZF(n){return n[0]}function $2(n){return n[n.length-1]}function QF(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=$2(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>zs(e)));)t--;if(!i)return{x:0,y:0};const s=Us(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const K2=1e-4,JF=1-K2,eV=1+K2,H2=.01,tV=0-H2,nV=0+H2;function Ci(n){return n.max-n.min}function iV(n,e,t){return Math.abs(n-e)<=t}function RS(n,e,t,i=.5){n.origin=i,n.originPoint=Dt(e.min,e.max,n.origin),n.scale=Ci(t)/Ci(e),n.translate=Dt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=JF&&n.scale<=eV||isNaN(n.scale))&&(n.scale=1),(n.translate>=tV&&n.translate<=nV||isNaN(n.translate))&&(n.translate=0)}function Qh(n,e,t,i){RS(n.x,e.x,t.x,i?i.originX:void 0),RS(n.y,e.y,t.y,i?i.originY:void 0)}function AS(n,e,t){n.min=t.min+e.min,n.max=n.min+Ci(e)}function rV(n,e,t){AS(n.x,e.x,t.x),AS(n.y,e.y,t.y)}function bS(n,e,t){n.min=e.min-t.min,n.max=n.min+Ci(e)}function Jh(n,e,t){bS(n.x,e.x,t.x),bS(n.y,e.y,t.y)}function sV(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?Dt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?Dt(t,n,i.max):Math.min(n,t)),n}function PS(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function oV(n,{top:e,left:t,bottom:i,right:r}){return{x:PS(n.x,t,r),y:PS(n.y,e,i)}}function kS(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function aV(n,e){return{x:kS(n.x,e.x),y:kS(n.y,e.y)}}function lV(n,e){let t=.5;const i=Ci(n),r=Ci(e);return r>i?t=nu(e.min,e.max-i,n.min):i>r&&(t=nu(n.min,n.max-r,e.min)),Ks(0,1,t)}function cV(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const fv=.35;function uV(n=fv){return n===!1?n=0:n===!0&&(n=fv),{x:DS(n,"left","right"),y:DS(n,"top","bottom")}}function DS(n,e,t){return{min:NS(n,e),max:NS(n,t)}}function NS(n,e){return typeof n=="number"?n:n[e]||0}const MS=()=>({translate:0,scale:1,origin:0,originPoint:0}),Bc=()=>({x:MS(),y:MS()}),LS=()=>({min:0,max:0}),Ut=()=>({x:LS(),y:LS()});function $i(n){return[n("x"),n("y")]}function X2({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function hV({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function dV(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function n0(n){return n===void 0||n===1}function gv({scale:n,scaleX:e,scaleY:t}){return!n0(n)||!n0(e)||!n0(t)}function ja(n){return gv(n)||q2(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function q2(n){return OS(n.x)||OS(n.y)}function OS(n){return n&&n!=="0%"}function Ap(n,e,t){const i=n-t,r=e*i;return t+r}function FS(n,e,t,i,r){return r!==void 0&&(n=Ap(n,r,i)),Ap(n,t,i)+e}function pv(n,e=0,t=1,i,r){n.min=FS(n.min,e,t,i,r),n.max=FS(n.max,e,t,i,r)}function Y2(n,{x:e,y:t}){pv(n.x,e.translate,e.scale,e.originPoint),pv(n.y,t.translate,t.scale,t.originPoint)}const VS=.999999999999,jS=1.0000000000001;function fV(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Wc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Y2(n,o)),i&&ja(s.latestValues)&&Wc(n,s.latestValues))}e.x<jS&&e.x>VS&&(e.x=1),e.y<jS&&e.y>VS&&(e.y=1)}function Gc(n,e){n.min=n.min+e,n.max=n.max+e}function zS(n,e,t,i,r=.5){const s=Dt(n.min,n.max,r);pv(n,e,t,s,i)}function Wc(n,e){zS(n.x,e.x,e.scaleX,e.scale,e.originX),zS(n.y,e.y,e.scaleY,e.scale,e.originY)}function Z2(n,e){return X2(dV(n.getBoundingClientRect(),e))}function gV(n,e,t){const i=Z2(n,t),{scroll:r}=e;return r&&(Gc(i.x,r.offset.x),Gc(i.y,r.offset.y)),i}const Q2=({current:n})=>n?n.ownerDocument.defaultView:null,pV=new WeakMap;class mV{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Qd(f).point)},s=(f,p)=>{const{drag:y,dragPropagation:x,onDragStart:S}=this.getProps();if(y&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=lO(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),$i(T=>{let A=this.getAxisMotionValue(T).get()||0;if(ns.test(A)){const{projection:P}=this.visualElement;if(P&&P.layout){const N=P.layout.layoutBox[T];N&&(A=Ci(N)*(parseFloat(A)/100))}}this.originPoint[T]=A}),S&&Tt.postRender(()=>S(f,p)),sv(this.visualElement,"transform");const{animationState:I}=this.visualElement;I&&I.setActive("whileDrag",!0)},o=(f,p)=>{const{dragPropagation:y,dragDirectionLock:x,onDirectionLock:S,onDrag:I}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:T}=p;if(x&&this.currentDirection===null){this.currentDirection=yV(T),this.currentDirection!==null&&S&&S(this.currentDirection);return}this.updateAxis("x",p.point,T),this.updateAxis("y",p.point,T),this.visualElement.render(),I&&I(f,p)},l=(f,p)=>this.stop(f,p),u=()=>$i(f=>{var p;return this.getAnimationState(f)==="paused"&&((p=this.getAxisMotionValue(f).animation)===null||p===void 0?void 0:p.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new W2(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:Q2(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Tt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Dg(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=sV(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&zc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=oV(r.layoutBox,t):this.constraints=!1,this.elastic=uV(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&$i(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=cV(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!zc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=gV(i,r.root,this.visualElement.getTransformPagePoint());let o=aV(r.layout.layoutBox,s);if(t){const l=t(hV(o));this.hasMutatedConstraints=!!l,l&&(o=X2(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=$i(f=>{if(!Dg(f,t,this.currentDirection))return;let p=u&&u[f]||{};o&&(p={min:0,max:0});const y=r?200:1e6,x=r?40:1e7,S={type:"inertia",velocity:i?e[f]:0,bounceStiffness:y,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...s,...p};return this.startAxisValueAnimation(f,S)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return sv(this.visualElement,e),i.start(r1(e,i,0,t,this.visualElement,!1))}stopAnimation(){$i(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){$i(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){$i(t=>{const{drag:i}=this.getProps();if(!Dg(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-Dt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!zc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};$i(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();r[o]=lV({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),$i(o=>{if(!Dg(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(Dt(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;pV.set(this.visualElement,this);const e=this.visualElement.current,t=Zh(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();zc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Tt.read(i);const o=vd(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&($i(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=u[f].translate,p.set(p.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=fv,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function Dg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function yV(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class _V extends oa{constructor(e){super(e),this.removeGroupControls=Si,this.removeListeners=Si,this.controls=new mV(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Si}unmount(){this.removeGroupControls(),this.removeListeners()}}const US=n=>(e,t)=>{n&&Tt.postRender(()=>n(e,t))};class vV extends oa{constructor(){super(...arguments),this.removePointerDownListener=Si}onPointerDown(e){this.session=new W2(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Q2(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:US(e),onStart:US(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Tt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Zh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const sp={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function BS(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Ih={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(De.test(n))n=parseFloat(n);else return n;const t=BS(n,e.target.x),i=BS(n,e.target.y);return`${t}% ${i}%`}},xV={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=ea.parse(n);if(r.length>5)return i;const s=ea.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=u;const h=Dt(l,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class wV extends q.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;UL(EV),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),sp.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Tt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Nx.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function J2(n){const[e,t]=LA(),i=q.useContext(Ix);return _.jsx(wV,{...n,layoutGroup:i,switchLayoutGroup:q.useContext(GA),isPresent:e,safeToRemove:t})}const EV={borderRadius:{...Ih,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ih,borderTopRightRadius:Ih,borderBottomLeftRadius:Ih,borderBottomRightRadius:Ih,boxShadow:xV};function TV(n,e,t){const i=Ln(n)?n:yd(n);return i.start(r1("",i,e,t)),i.animation}function SV(n){return n instanceof SVGElement&&n.tagName!=="svg"}const IV=(n,e)=>n.depth-e.depth;class CV{constructor(){this.children=[],this.isDirty=!1}add(e){Hx(this.children,e),this.isDirty=!0}remove(e){Xx(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(IV),this.isDirty=!1,this.children.forEach(e)}}function RV(n,e){const t=is.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Jo(i),n(s-e))};return Tt.read(i,!0),()=>Jo(i)}const eb=["TopLeft","TopRight","BottomLeft","BottomRight"],AV=eb.length,GS=n=>typeof n=="string"?parseFloat(n):n,WS=n=>typeof n=="number"||De.test(n);function bV(n,e,t,i,r,s){r?(n.opacity=Dt(0,t.opacity!==void 0?t.opacity:1,PV(i)),n.opacityExit=Dt(e.opacity!==void 0?e.opacity:1,0,kV(i))):s&&(n.opacity=Dt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<AV;o++){const l=`border${eb[o]}Radius`;let u=$S(e,l),h=$S(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||WS(u)===WS(h)?(n[l]=Math.max(Dt(GS(u),GS(h),i),0),(ns.test(h)||ns.test(u))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=Dt(e.rotate||0,t.rotate||0,i))}function $S(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const PV=tb(0,.5,v2),kV=tb(.5,.95,Si);function tb(n,e,t){return i=>i<n?0:i>e?1:t(nu(n,e,i))}function KS(n,e){n.min=e.min,n.max=e.max}function Gi(n,e){KS(n.x,e.x),KS(n.y,e.y)}function HS(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function XS(n,e,t,i,r){return n-=e,n=Ap(n,1/t,i),r!==void 0&&(n=Ap(n,1/r,i)),n}function DV(n,e=0,t=1,i=.5,r,s=n,o=n){if(ns.test(e)&&(e=parseFloat(e),e=Dt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=Dt(s.min,s.max,i);n===s&&(l-=e),n.min=XS(n.min,e,t,l,r),n.max=XS(n.max,e,t,l,r)}function qS(n,e,[t,i,r],s,o){DV(n,e[t],e[i],e[r],e.scale,s,o)}const NV=["x","scaleX","originX"],MV=["y","scaleY","originY"];function YS(n,e,t,i){qS(n.x,e,NV,t?t.x:void 0,i?i.x:void 0),qS(n.y,e,MV,t?t.y:void 0,i?i.y:void 0)}function ZS(n){return n.translate===0&&n.scale===1}function nb(n){return ZS(n.x)&&ZS(n.y)}function QS(n,e){return n.min===e.min&&n.max===e.max}function LV(n,e){return QS(n.x,e.x)&&QS(n.y,e.y)}function JS(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function ib(n,e){return JS(n.x,e.x)&&JS(n.y,e.y)}function eI(n){return Ci(n.x)/Ci(n.y)}function tI(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class OV{constructor(){this.members=[]}add(e){Hx(this.members,e),e.scheduleRender()}remove(e){if(Xx(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function FV(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:p,rotateY:y,skewX:x,skewY:S}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),p&&(i+=`rotateX(${p}deg) `),y&&(i+=`rotateY(${y}deg) `),x&&(i+=`skewX(${x}deg) `),S&&(i+=`skewY(${S}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(i+=`scale(${l}, ${u})`),i||"none"}const za={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},zh=typeof window<"u"&&window.MotionDebug!==void 0,i0=["","X","Y","Z"],VV={visibility:"hidden"},nI=1e3;let jV=0;function r0(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function rb(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=d2(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Tt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&rb(i)}function sb({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=jV++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,zh&&(za.totalNodes=za.resolvedTargetDeltas=za.recalculatedProjection=0),this.nodes.forEach(BV),this.nodes.forEach(HV),this.nodes.forEach(XV),this.nodes.forEach(GV),zh&&window.MotionDebug.record(za)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new CV)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new qx),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=SV(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||u)&&(this.isLayoutDirty=!0),n){let p;const y=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=RV(y,250),sp.hasAnimatedSinceResize&&(sp.hasAnimatedSinceResize=!1,this.nodes.forEach(rI))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:y,hasRelativeTargetChanged:x,layout:S})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||f.getDefaultTransition()||JV,{onLayoutAnimationStart:T,onLayoutAnimationComplete:A}=f.getProps(),P=!this.targetLayout||!ib(this.targetLayout,S)||x,N=!y&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||N||y&&(P||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,N);const R={...Gx(I,"layout"),onPlay:T,onComplete:A};(f.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R)}else y||rI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=S})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Jo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(qV),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&rb(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(iI);return}this.isUpdating||this.nodes.forEach($V),this.isUpdating=!1,this.nodes.forEach(KV),this.nodes.forEach(zV),this.nodes.forEach(UV),this.clearAllSnapshots();const l=is.now();xn.delta=Ks(0,1e3/60,l-xn.timestamp),xn.timestamp=l,xn.isProcessing=!0,X_.update.process(xn),X_.preRender.process(xn),X_.render.process(xn),xn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Nx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(WV),this.sharedNodes.forEach(YV)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Tt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Tt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!nb(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||ja(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),e5(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(t5))){const{scroll:f}=this.root;f&&(Gc(u.x,f.offset.x),Gc(u.y,f.offset.y))}return u}removeElementScroll(o){var l;const u=Ut();if(Gi(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:p,options:y}=f;f!==this.root&&p&&y.layoutScroll&&(p.wasRoot&&Gi(u,o),Gc(u.x,p.offset.x),Gc(u.y,p.offset.y))}return u}applyTransform(o,l=!1){const u=Ut();Gi(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Wc(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),ja(f.latestValues)&&Wc(u,f.latestValues)}return ja(this.latestValues)&&Wc(u,this.latestValues),u}removeTransform(o){const l=Ut();Gi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!ja(h.latestValues))continue;gv(h.latestValues)&&h.updateSnapshot();const f=Ut(),p=h.measurePageBox();Gi(f,p),YS(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return ja(this.latestValues)&&YS(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==xn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:y}=this.options;if(!(!this.layout||!(p||y))){if(this.resolvedRelativeTargetAt=xn.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Jh(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),Gi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),rV(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Gi(this.target,this.layout.layoutBox),Y2(this.target,this.targetDelta)):Gi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Jh(this.relativeTargetOrigin,this.target,x.target),Gi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}zh&&za.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||gv(this.parent.latestValues)||q2(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===xn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;Gi(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,x=this.treeScale.y;fV(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:S}=l;if(!S){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(HS(this.prevProjectionDelta.x,this.projectionDelta.x),HS(this.prevProjectionDelta.y,this.projectionDelta.y)),Qh(this.projectionDelta,this.layoutCorrected,S,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==x||!tI(this.projectionDelta.x,this.prevProjectionDelta.x)||!tI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",S)),zh&&za.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Bc(),this.projectionDelta=Bc(),this.projectionDeltaWithTransform=Bc()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},p=Bc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const y=Ut(),x=u?u.source:void 0,S=this.layout?this.layout.source:void 0,I=x!==S,T=this.getStack(),A=!T||T.members.length<=1,P=!!(I&&!A&&this.options.crossfade===!0&&!this.path.some(QV));this.animationProgress=0;let N;this.mixTargetDelta=R=>{const L=R/1e3;sI(p.x,o.x,L),sI(p.y,o.y,L),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Jh(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),ZV(this.relativeTarget,this.relativeTargetOrigin,y,L),N&&LV(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=Ut()),Gi(N,this.relativeTarget)),I&&(this.animationValues=f,bV(f,h,this.latestValues,L,P,A)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=L},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Jo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Tt.update(()=>{sp.hasAnimatedSinceResize=!0,this.currentAnimation=TV(0,nI,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(nI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:f}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&ob(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Ut();const p=Ci(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const y=Ci(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+y}Gi(l,u),Wc(l,f),Qh(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new OV),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&r0("z",o,h,this.animationValues);for(let f=0;f<i0.length;f++)r0(`rotate${i0[f]}`,o,h,this.animationValues),r0(`skew${i0[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return VV;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=ip(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const I={};return this.options.layoutId&&(I.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,I.pointerEvents=ip(o?.pointerEvents)||""),this.hasProjected&&!ja(this.latestValues)&&(I.transform=f?f({},""):"none",this.hasProjected=!1),I}const y=p.animationValues||p.latestValues;this.applyTransformsToTarget(),h.transform=FV(this.projectionDeltaWithTransform,this.treeScale,y),f&&(h.transform=f(y,h.transform));const{x,y:S}=this.projectionDelta;h.transformOrigin=`${x.origin*100}% ${S.origin*100}% 0`,p.animationValues?h.opacity=p===this?(u=(l=y.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:h.opacity=p===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const I in Tp){if(y[I]===void 0)continue;const{correct:T,applyTo:A}=Tp[I],P=h.transform==="none"?y[I]:T(y[I],p);if(A){const N=A.length;for(let R=0;R<N;R++)h[A[R]]=P}else h[I]=P}return this.options.layoutId&&(h.pointerEvents=p===this?ip(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(iI),this.root.sharedNodes.clear()}}}function zV(n){n.updateLayout()}function UV(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?$i(p=>{const y=o?t.measuredBox[p]:t.layoutBox[p],x=Ci(y);y.min=i[p].min,y.max=y.min+x}):ob(s,t.layoutBox,i)&&$i(p=>{const y=o?t.measuredBox[p]:t.layoutBox[p],x=Ci(i[p]);y.max=y.min+x,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[p].max=n.relativeTarget[p].min+x)});const l=Bc();Qh(l,i,t.layoutBox);const u=Bc();o?Qh(u,n.applyTransform(r,!0),t.measuredBox):Qh(u,i,t.layoutBox);const h=!nb(l);let f=!1;if(!n.resumeFrom){const p=n.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:y,layout:x}=p;if(y&&x){const S=Ut();Jh(S,t.layoutBox,y.layoutBox);const I=Ut();Jh(I,i,x.layoutBox),ib(S,I)||(f=!0),p.options.layoutRoot&&(n.relativeTarget=I,n.relativeTargetOrigin=S,n.relativeParent=p)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function BV(n){zh&&za.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function GV(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function WV(n){n.clearSnapshot()}function iI(n){n.clearMeasurements()}function $V(n){n.isLayoutDirty=!1}function KV(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function rI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function HV(n){n.resolveTargetDelta()}function XV(n){n.calcProjection()}function qV(n){n.resetSkewAndRotation()}function YV(n){n.removeLeadSnapshot()}function sI(n,e,t){n.translate=Dt(e.translate,0,t),n.scale=Dt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function oI(n,e,t,i){n.min=Dt(e.min,t.min,i),n.max=Dt(e.max,t.max,i)}function ZV(n,e,t,i){oI(n.x,e.x,t.x,i),oI(n.y,e.y,t.y,i)}function QV(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const JV={duration:.45,ease:[.4,0,.1,1]},aI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),lI=aI("applewebkit/")&&!aI("chrome/")?Math.round:Si;function cI(n){n.min=lI(n.min),n.max=lI(n.max)}function e5(n){cI(n.x),cI(n.y)}function ob(n,e,t){return n==="position"||n==="preserve-aspect"&&!iV(eI(e),eI(t),.2)}function t5(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const n5=sb({attachResizeListener:(n,e)=>vd(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),s0={current:void 0},ab=sb({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!s0.current){const n=new n5({});n.mount(window),n.setOptions({layoutScroll:!0}),s0.current=n}return s0.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),i5={pan:{Feature:vV},drag:{Feature:_V,ProjectionNode:ab,MeasureLayout:J2}};function uI(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Tt.postRender(()=>s(e,Qd(e)))}class r5 extends oa{mount(){const{current:e}=this.node;e&&(this.unmount=iO(e,t=>(uI(this.node,t,"Start"),i=>uI(this.node,i,"End"))))}unmount(){}}class s5 extends oa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Zd(vd(this.node.current,"focus",()=>this.onFocus()),vd(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function hI(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Tt.postRender(()=>s(e,Qd(e)))}class o5 extends oa{mount(){const{current:e}=this.node;e&&(this.unmount=aO(e,t=>(hI(this.node,t,"Start"),(i,{success:r})=>hI(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const mv=new WeakMap,o0=new WeakMap,a5=n=>{const e=mv.get(n.target);e&&e(n)},l5=n=>{n.forEach(a5)};function c5({root:n,...e}){const t=n||document;o0.has(t)||o0.set(t,{});const i=o0.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(l5,{root:n,...e})),i[r]}function u5(n,e,t){const i=c5(e);return mv.set(n,t),i.observe(n),()=>{mv.delete(n),i.unobserve(n)}}const h5={some:0,all:1};class d5 extends oa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:h5[r]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),y=h?f:p;y&&y(u)};return u5(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(f5(e,t))&&this.startObserver()}unmount(){}}function f5({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const g5={inView:{Feature:d5},tap:{Feature:o5},focus:{Feature:s5},hover:{Feature:r5}},p5={layout:{ProjectionNode:ab,MeasureLayout:J2}},yv={current:null},lb={current:!1};function m5(){if(lb.current=!0,!!Ax)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>yv.current=n.matches;n.addListener(e),e()}else yv.current=!1}const y5=[...N2,Nn,ea],_5=n=>y5.find(D2(n)),dI=new WeakMap;function v5(n,e,t){for(const i in e){const r=e[i],s=t[i];if(Ln(r))n.addValue(i,r);else if(Ln(s))n.addValue(i,yd(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,yd(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const fI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class x5{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=t1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=is.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,Tt.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=Sm(t),this.isVariantNode=UA(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,...y}=this.scrapeMotionValuesFromProps(t,{},this);for(const x in y){const S=y[x];u[x]!==void 0&&Ln(S)&&S.set(u[x],!1)}}mount(e){this.current=e,dI.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),lb.current||m5(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:yv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){dI.delete(this.current),this.projection&&this.projection.unmount(),Jo(this.notifyUpdate),Jo(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Pl.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Tt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in iu){const t=iu[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<fI.length;i++){const r=fI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=v5(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=yd(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(P2(r)||w2(r))?r=parseFloat(r):!_5(r)&&ea.test(t)&&(r=R2(e,t)),this.setBaseTarget(e,Ln(r)?r.get():r)),Ln(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=Lx(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ln(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new qx),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class cb extends x5{constructor(){super(...arguments),this.KeyframeResolver=M2}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ln(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function w5(n){return window.getComputedStyle(n)}class E5 extends cb{constructor(){super(...arguments),this.type="html",this.renderInstance=YA}readValueFromInstance(e,t){if(Pl.has(t)){const i=e1(t);return i&&i.default||0}else{const i=w5(e),r=(HA(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return Z2(e,t)}build(e,t,i){Vx(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return Bx(e,t,i)}}class T5 extends cb{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Pl.has(t)){const i=e1(t);return i&&i.default||0}return t=ZA.has(t)?t:Dx(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return e2(e,t,i)}build(e,t,i){jx(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){QA(e,t,i,r)}mount(e){this.isSVGTag=Ux(e.tagName),super.mount(e)}}const S5=(n,e)=>Mx(n)?new T5(e):new E5(e,{allowProjection:n!==q.Fragment}),I5=YL({...XF,...g5,...i5,...p5},S5),ze=hL(I5),ei={ADD:"add",REMOVE:"remove"},su={PROPERTYCHANGE:"propertychange"},Ge={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Rm{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function C5(n,e,t){let i,r;t=t||Bs;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function Bs(n,e){return n>e?1:n<e?-1:0}function R5(n,e){return n<e?1:n>e?-1:0}function s1(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function A5(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function o1(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function aa(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function b5(n,e,t){const i=e||Bs;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function xd(){return!0}function Am(){return!1}function wd(){}function ub(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!aa(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function P5(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function Jd(n){for(const e in n)delete n[e]}function ou(n){let e;for(e in n)return!1;return!e}class Zs{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class bm extends Rm{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Zs(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let u;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,wd);delete o[i]}return u}disposeInternal(){this.listeners_&&Jd(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=wd,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function nt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function bp(n,e,t,i){return nt(n,e,t,i,!0)}function At(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Jd(n))}class ef extends bm{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Ge.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=nt(this,e[s],t);return r}return nt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=bp(this,e[s],t)}else i=bp(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)k5(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}ef.prototype.on;ef.prototype.once;ef.prototype.un;function k5(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)At(n[e]);else At(n)}function tt(){throw new Error("Unimplemented abstract method.")}let D5=0;function it(n){return n.ol_uid||(n.ol_uid=String(++D5))}class gI extends Zs{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class cs extends ef{constructor(e){super(),this.on,this.once,this.un,it(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new gI(i,e,t)),i=su.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new gI(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],ou(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const pI={LENGTH:"length"};class Ng extends Zs{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Hi extends cs{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(pI.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Ng(ei.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Ng(ei.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Ng(ei.REMOVE,r,e)),this.dispatchEvent(new Ng(ei.ADD,t,e))}updateLength_(){this.set(pI.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function at(n,e){if(!n)throw new Error(e)}class au extends cs{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new au(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(At(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=nt(e,Ge.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?N5(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function N5(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(at(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const ln={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function mI(n){const e=Qi();for(let t=0,i=n.length;t<i;++t)ed(e,n[t]);return e}function a1(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function hb(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function db(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function lu(n,e){return fb(n,e[0],e[1])}function Uh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function fb(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function _v(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let u=ln.UNKNOWN;return o<t?u=u|ln.LEFT:o>r&&(u=u|ln.RIGHT),l<i?u=u|ln.BELOW:l>s&&(u=u|ln.ABOVE),u===ln.UNKNOWN&&(u=ln.INTERSECTING),u}function Qi(){return[1/0,1/0,-1/0,-1/0]}function ta(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Pm(n){return ta(1/0,1/0,-1/0,-1/0,n)}function gb(n,e){const t=n[0],i=n[1];return ta(t,i,t,i,e)}function l1(n,e,t,i,r){const s=Pm(r);return pb(s,n,e,t,i)}function Ed(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function M5(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function ed(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function pb(n,e,t,i,r){for(;t<i;t+=r)L5(n,e[t],e[t+1]);return n}function L5(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function mb(n,e){let t;return t=e(km(n)),t||(t=e(Dm(n)),t)||(t=e(Nm(n)),t)||(t=e(kl(n)),t)?t:!1}function vv(n){let e=0;return Mm(n)||(e=dt(n)*Bn(n)),e}function km(n){return[n[0],n[1]]}function Dm(n){return[n[2],n[1]]}function gl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function O5(n,e){let t;if(e==="bottom-left")t=km(n);else if(e==="bottom-right")t=Dm(n);else if(e==="top-left")t=kl(n);else if(e==="top-right")t=Nm(n);else throw new Error("Invalid corner");return t}function xv(n,e,t,i,r){const[s,o,l,u,h,f,p,y]=yb(n,e,t,i);return ta(Math.min(s,l,h,p),Math.min(o,u,f,y),Math.max(s,l,h,p),Math.max(o,u,f,y),r)}function yb(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),u=r*o,h=r*l,f=s*o,p=s*l,y=n[0],x=n[1];return[y-u+p,x-h-f,y-u-p,x-h+f,y+u-p,x+h+f,y+u+p,x+h-f,y-u+p,x-h-f]}function Bn(n){return n[3]-n[1]}function ol(n,e,t){const i=t||Qi();return ri(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Pm(i),i}function kl(n){return[n[0],n[3]]}function Nm(n){return[n[2],n[3]]}function dt(n){return n[2]-n[0]}function ri(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Mm(n){return n[2]<n[0]||n[3]<n[1]}function F5(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function V5(n,e,t){let i=!1;const r=_v(n,e),s=_v(n,t);if(r===ln.INTERSECTING||s===ln.INTERSECTING)i=!0;else{const o=n[0],l=n[1],u=n[2],h=n[3],f=e[0],p=e[1],y=t[0],x=t[1],S=(x-p)/(y-f);let I,T;s&ln.ABOVE&&!(r&ln.ABOVE)&&(I=y-(x-h)/S,i=I>=o&&I<=u),!i&&s&ln.RIGHT&&!(r&ln.RIGHT)&&(T=x-(y-u)*S,i=T>=l&&T<=h),!i&&s&ln.BELOW&&!(r&ln.BELOW)&&(I=y-(x-l)/S,i=I>=o&&I<=u),!i&&s&ln.LEFT&&!(r&ln.LEFT)&&(T=x-(y-o)*S,i=T>=l&&T<=h)}return i}function _b(n,e){const t=e.getExtent(),i=gl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=dt(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function vb(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];_b(n,e);const r=dt(i);if(dt(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Nt(n,e,t){return Math.min(Math.max(n,e),t)}function j5(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const u=((n-t)*o+(e-i)*l)/(o*o+l*l);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=l*u)}return Xc(n,e,t,i)}function Xc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function z5(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const u=Math.abs(n[l][i]);u>s&&(s=u,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const u=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function yI(n){return n*180/Math.PI}function Ho(n){return n*Math.PI/180}function al(n,e){const t=n%e;return t*e<0?t+e:t}function xi(n,e,t){return n+t*(e-n)}function tf(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function uX(n,e){return Math.round(tf(n,e))}function Mg(n,e){return Math.floor(tf(n,e))}function Lg(n,e){return Math.ceil(tf(n,e))}function wv(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function U5(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Pp(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function c1(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function B5(n,e){return n[0]*=e,n[1]*=e,n}function xb(n,e){if(e.canWrapX()){const t=dt(e.getExtent()),i=G5(n,e,t);i&&(n[0]-=i*t)}return n}function G5(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||dt(i),r=Math.floor((n[0]-i[0])/t)),r}function wb(...n){console.warn(...n)}const cu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class u1{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||cu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const nf=6378137,$c=Math.PI*nf,W5=[-$c,-$c,$c,$c],$5=[-180,-85,180,85],Og=nf*Math.log(Math.tan(Math.PI/2));class vc extends u1{constructor(e){super({code:e,units:"m",extent:W5,global:!0,worldExtent:$5,getPointResolution:function(t,i){return t/Math.cosh(i[1]/nf)}})}}const _I=[new vc("EPSG:3857"),new vc("EPSG:102100"),new vc("EPSG:102113"),new vc("EPSG:900913"),new vc("http://www.opengis.net/def/crs/EPSG/0/3857"),new vc("http://www.opengis.net/gml/srs/epsg.xml#3857")];function K5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=$c*n[s]/180;let o=nf*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Og?o=Og:o<-Og&&(o=-Og),e[s+1]=o}return e}function H5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/$c,e[s+1]=360*Math.atan(Math.exp(n[s+1]/nf))/Math.PI-90;return e}const X5=6378137,vI=[-180,-90,180,90],q5=Math.PI*X5/180;class La extends u1{constructor(e,t){super({code:e,units:"degrees",extent:vI,axisOrientation:t,global:!0,metersPerUnit:q5,worldExtent:vI})}}const xI=[new La("CRS:84"),new La("EPSG:4326","neu"),new La("urn:ogc:def:crs:OGC:1.3:CRS84"),new La("urn:ogc:def:crs:OGC:2:84"),new La("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new La("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new La("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Ev={};function Y5(n){return Ev[n]||Ev[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Z5(n,e){Ev[n]=e}let qc={};function Td(n,e,t){const i=n.getCode(),r=e.getCode();i in qc||(qc[i]={}),qc[i][r]=t}function a0(n,e){return n in qc&&e in qc[n]?qc[n][e]:null}const kp=.9996,Yi=.00669438,Lm=Yi*Yi,Om=Lm*Yi,Qa=Yi/(1-Yi),wI=Math.sqrt(1-Yi),uu=(1-wI)/(1+wI),Eb=uu*uu,h1=Eb*uu,d1=h1*uu,Tb=d1*uu,Sb=1-Yi/4-3*Lm/64-5*Om/256,Q5=3*Yi/8+3*Lm/32+45*Om/1024,J5=15*Lm/256+45*Om/1024,ej=35*Om/3072,tj=3/2*uu-27/32*h1+269/512*Tb,nj=21/16*Eb-55/32*d1,ij=151/96*h1-417/128*Tb,rj=1097/512*d1,Dp=6378137;function sj(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/kp/(Dp*Sb),l=o+tj*Math.sin(2*o)+nj*Math.sin(4*o)+ij*Math.sin(6*o)+rj*Math.sin(8*o),u=Math.sin(l),h=u*u,f=Math.cos(l),p=u/f,y=p*p,x=y*y,S=1-Yi*h,I=Math.sqrt(1-Yi*h),T=Dp/I,A=(1-Yi)/S,P=Qa*f**2,N=P*P,R=i/(T*kp),L=R*R,j=L*R,D=j*R,b=D*R,M=b*R,V=l-p/A*(L/2-D/24*(5+3*y+10*P-4*N-9*Qa))+M/720*(61+90*y+298*P+45*x-252*Qa-3*N);let z=(R-j/6*(1+2*y+P)+b/120*(5-2*P+28*y-3*N+8*Qa+24*x))/f;return z=wv(z+Ho(Ib(t.number)),-Math.PI,Math.PI),[yI(z),yI(V)]}const EI=-80,TI=84,oj=-180,aj=180;function lj(n,e,t){n=wv(n,oj,aj),e<EI?e=EI:e>TI&&(e=TI);const i=Ho(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,u=l*l,h=Ho(n),f=Ib(t.number),p=Ho(f),y=Dp/Math.sqrt(1-Yi*r**2),x=Qa*s**2,S=s*wv(h-p,-Math.PI,Math.PI),I=S*S,T=I*S,A=T*S,P=A*S,N=P*S,R=Dp*(Sb*i-Q5*Math.sin(2*i)+J5*Math.sin(4*i)-ej*Math.sin(6*i)),L=kp*y*(S+T/6*(1-l+x)+P/120*(5-18*l+u+72*x-58*Qa))+5e5;let j=kp*(R+y*o*(I/2+A/24*(5-l+9*x+4*x**2)+N/720*(61-58*l+u+600*x-330*Qa)));return t.north||(j+=1e7),[L,j]}function Ib(n){return(n-1)*6-180+3}const cj=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function Cb(n){let e=0;for(const r of cj){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function SI(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const u=t[l],h=t[l+1],f=n(u,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function uj(n){return Cb(n)?new u1({code:n,units:"m"}):null}function hj(n){const e=Cb(n.getCode());return e?{forward:SI(lj,e),inverse:SI(sj,e)}:null}const dj=63710088e-1;function II(n,e,t){t=t||dj;const i=Ho(n[1]),r=Ho(e[1]),s=(r-i)/2,o=Ho(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const fj=[hj],gj=[uj];let Tv=!0;function Rb(n){Tv=!1}function f1(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function Sv(n){Z5(n.getCode(),n),Td(n,n,f1)}function pj(n){n.forEach(Sv)}function ai(n){if(typeof n!="string")return n;const e=Y5(n);if(e)return e;for(const t of gj){const i=t(n);if(i)return i}return null}function Np(n,e,t,i){n=ai(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/cu[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=p1(n,ai("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=II(h.slice(0,2),h.slice(2,4)),p=II(h.slice(4,6),h.slice(6,8));r=(f+p)/2}const u=i?cu[i]:n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function CI(n){pj(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Td(e,t,f1)})})}function mj(n,e,t,i){n.forEach(function(r){e.forEach(function(s){Td(r,s,t),Td(s,r,i)})})}function g1(n,e){return n?typeof n=="string"?ai(n):n:ai(e)}function yj(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),u=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=u?e[o+h]:l[h]}return t})}function pl(n,e){return Rb(),Fm(n,"EPSG:4326","EPSG:3857")}function RI(n,e){const t=Fm(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=al(i+180,360)-180),t}function op(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||p1(n,e)===f1)&&t}function p1(n,e){const t=n.getCode(),i=e.getCode();let r=a0(t,i);if(r)return r;let s=null,o=null;for(const u of fj)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=l0(s.inverse,o.forward);else{const u=a0(t,l);u&&(r=l0(u,o.forward))}else{const u=a0(l,i);u&&(r=l0(s.inverse,u))}return r&&(Sv(n),Sv(e),Td(n,e,r)),r}function l0(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Mp(n,e){const t=ai(n),i=ai(e);return p1(t,i)}function Fm(n,e,t){const i=Mp(e,t);if(!i){const r=ai(e).getCode(),s=ai(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Iv(n,e){return n}function Ns(n,e){return Tv&&!Pp(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Tv=!1,wb("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function Ab(n,e){return n}function Go(n,e){return n}function _j(){CI(_I),CI(xI),mj(xI,_I,K5,H5)}_j();new Array(6);function Er(){return[1,0,0,1,0,0]}function vj(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function un(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Hs(n,e,t,i,r,s,o,l){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-l*i*u+e,n[5]=o*r*u+l*r*h+t,n}function bb(n,e){const t=xj(e);at(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*l)/t,n[5]=-(i*u-r*l)/t,n}function xj(n){return n[0]*n[3]-n[1]*n[2]}const wj=[1e5,1e5,1e5,1e5,2,2];function Ej(n){return"matrix("+n.join(", ")+")"}function Cv(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function Tj(n,e){const t=Cv(n),i=Cv(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*wj[r])!==0)return!1;return!0}function Xo(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let u=e;u<t;u+=i){const h=n[u],f=n[u+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let p=2;p<o;p++)s[l++]=n[u+p]}return s&&s.length!=l&&(s.length=l),s}function Pb(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),u=Math.sin(r),h=s[0],f=s[1];let p=0;for(let y=e;y<t;y+=i){const x=n[y]-h,S=n[y+1]-f;o[p++]=h+x*l-S*u,o[p++]=f+x*u+S*l;for(let I=y+2;I<y+i;++I)o[p++]=n[I]}return o&&o.length!=p&&(o.length=p),o}function Sj(n,e,t,i,r,s,o,l){l=l||[];const u=o[0],h=o[1];let f=0;for(let p=e;p<t;p+=i){const y=n[p]-u,x=n[p+1]-h;l[f++]=u+r*y,l[f++]=h+s*x;for(let S=p+2;S<p+i;++S)l[f++]=n[S]}return l&&l.length!=f&&(l.length=f),l}function Ij(n,e,t,i,r,s,o){o=o||[];let l=0;for(let u=e;u<t;u+=i){o[l++]=n[u]+r,o[l++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const AI=Er(),Cj=[NaN,NaN];class Rj extends cs{constructor(){super(),this.extent_=Qi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=ub((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return tt()}closestPointXY(e,t,i,r){return tt()}containsXY(e,t){return this.closestPointXY(e,t,Cj,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return tt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Pm(t),this.extentRevision_=this.getRevision()}return F5(this.extent_,e)}rotate(e,t){tt()}scale(e,t,i){tt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return tt()}getType(){return tt()}applyTransform(e){tt()}intersectsExtent(e){return tt()}translate(e,t){tt()}transform(e,t){const i=ai(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const u=i.getExtent(),h=i.getWorldExtent(),f=Bn(h)/Bn(u);Hs(AI,h[0],h[3],f,-f,0,0,0);const p=Xo(s,0,s.length,l,AI,o),y=Mp(i,t);return y?y(p,p,l):p}:Mp(i,t);return this.applyTransform(r),this}}class m1 extends Rj{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return l1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return tt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=bI(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){tt()}setLayout(e,t,i){let r;if(e)r=bI(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=Aj(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Pb(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=gl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Sj(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Ij(i,0,i.length,r,e,t,i),this.changed()}}}function Aj(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function bI(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function bj(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Xo(i,0,i.length,r,e,t)}function PI(n,e,t,i,r,s,o){const l=n[e],u=n[e+1],h=n[t]-l,f=n[t+1]-u;let p;if(h===0&&f===0)p=e;else{const y=((r-l)*h+(s-u)*f)/(h*h+f*f);if(y>1)p=t;else if(y>0){for(let x=0;x<i;++x)o[x]=xi(n[e+x],n[t+x],y);o.length=i;return}else p=e}for(let y=0;y<i;++y)o[y]=n[p+y];o.length=i}function kb(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],u=n[e+1],h=Xc(s,o,l,u);h>r&&(r=h),s=l,o=u}return r}function Db(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=kb(n,e,l,i,r),e=l}return r}function hX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=Db(n,e,l,i,r),e=l[l.length-1]}return r}function Nb(n,e,t,i,r,s,o,l,u,h,f){if(e==t)return h;let p,y;if(r===0){if(y=Xc(o,l,n[e],n[e+1]),y<h){for(p=0;p<i;++p)u[p]=n[e+p];return u.length=i,y}return h}f=f||[NaN,NaN];let x=e+i;for(;x<t;)if(PI(n,x-i,x,i,o,l,f),y=Xc(o,l,f[0],f[1]),y<h){for(h=y,p=0;p<i;++p)u[p]=f[p];u.length=i,x+=i}else x+=i*Math.max((Math.sqrt(y)-Math.sqrt(h))/r|0,1);if(s&&(PI(n,t-i,e,i,o,l,f),y=Xc(o,l,f[0],f[1]),y<h)){for(h=y,p=0;p<i;++p)u[p]=f[p];u.length=i}return h}function Mb(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,y=t.length;p<y;++p){const x=t[p];h=Nb(n,e,x,i,r,s,o,l,u,h,f),e=x}return h}function dX(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,y=t.length;p<y;++p){const x=t[p];h=Mb(n,e,x,i,r,s,o,l,u,h,f),e=x[x.length-1]}return h}function Pj(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function Lb(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function Ob(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=Lb(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function fX(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=Ob(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function Kc(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Lp(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=Kc(n,e,u,i,r[s]),e=u}return r.length=s,r}function kI(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:Lp(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function DI(n,e,t,i,r,s,o){let l,u;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,u=r;else if(h!==0){let f=n[e],p=n[e+1],y=0;const x=[0];for(let T=e+i;T<t;T+=i){const A=n[T],P=n[T+1];y+=Math.sqrt((A-f)*(A-f)+(P-p)*(P-p)),x.push(y),f=A,p=P}const S=r*y,I=C5(x,S);I<0?(u=(S-x[-I-2])/(x[-I-1]-x[-I-2]),l=e+(-I-2)*i):l=e+I*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:u===void 0?n[l+f]:xi(n[l+f],n[l+i+f],u);return s}function NI(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,u=t/i;for(;l<u;){const y=l+u>>1;r<n[(y+1)*i-1]?u=y:l=y+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],p=(r-h)/(f-h);o=[];for(let y=0;y<i-1;++y)o.push(xi(n[(l-1)*i+y],n[l*i+y],p));return o.push(r),o}function gX(n,e,t,i,r,s,o){if(o)return NI(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let u=0,h=t.length;u<h;++u){const f=t[u];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return NI(n,e,f,i,r,!1);e=f}}return null}function kj(n,e,t,i,r){return!mb(r,function(o){return!Ja(n,e,t,i,o[0],o[1])})}function Ja(n,e,t,i,r,s){let o=0,l=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];u<=s?f>s&&(h-l)*(s-u)-(r-l)*(f-u)>0&&o++:f<=s&&(h-l)*(s-u)-(r-l)*(f-u)<0&&o--,l=h,u=f}return o!==0}function y1(n,e,t,i,r,s){if(t.length===0||!Ja(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(Ja(n,t[o-1],t[o],i,r,s))return!1;return!0}function pX(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const u=t[o];if(y1(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function Dj(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function _1(n,e,t,i,r,s){return s=s??pb(Qi(),n,e,t,i),ri(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:Dj(n,e,t,i,function(o,l){return V5(r,o,l)}):!1}function mX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(_1(n,e,t[s],i,r))return!0;e=t[s]}return!1}function Fb(n,e,t,i,r){return!!(_1(n,e,t,i,r)||Ja(n,e,t,i,r[0],r[1])||Ja(n,e,t,i,r[0],r[3])||Ja(n,e,t,i,r[2],r[1])||Ja(n,e,t,i,r[2],r[3]))}function Vb(n,e,t,i,r){if(!Fb(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(kj(n,t[s-1],t[s],i,r)&&!_1(n,t[s-1],t[s],i,r))return!1;return!0}function yX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(Vb(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function Nj(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const u=n[l],h=n[l+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function v1(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(l);u[0]=1,u[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const p=h.pop(),y=h.pop();let x=0;const S=n[y],I=n[y+1],T=n[p],A=n[p+1];for(let P=y+i;P<p;P+=i){const N=n[P],R=n[P+1],L=j5(N,R,S,I,T,A);L>x&&(f=P,x=L)}x>r&&(u[(f-e)/i]=1,y+i<f&&h.push(y,f),f+i<p&&h.push(f,p))}for(let p=0;p<l;++p)u[p]&&(s[o++]=n[e+p*i],s[o++]=n[e+p*i+1]);return o}function Mj(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=v1(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Ua(n,e){return e*Math.round(n/e)}function Lj(n,e,t,i,r,s,o){if(e==t)return o;let l=Ua(n[e],r),u=Ua(n[e+1],r);e+=i,s[o++]=l,s[o++]=u;let h,f;do if(h=Ua(n[e],r),f=Ua(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==u);for(;e<t;){const p=Ua(n[e],r),y=Ua(n[e+1],r);if(e+=i,p==h&&y==f)continue;const x=h-l,S=f-u,I=p-l,T=y-u;if(x*T==S*I&&(x<0&&I<x||x==I||x>0&&I>x)&&(S<0&&T<S||S==T||S>0&&T>S)){h=p,f=y;continue}s[o++]=h,s[o++]=f,l=h,u=f,h=p,f=y}return s[o++]=h,s[o++]=f,o}function x1(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=Lj(n,e,f,i,r,s,o),l.push(o),e=f}return o}function _X(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u],p=[];o=x1(n,e,f,i,r,s,o,p),l.push(p),e=f[f.length-1]}return o}class ml extends m1{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new ml(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Xc(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let u=0;u<l;++u)i[u]=s[u];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return gb(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return fb(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Pj(this.flatCoordinates,0,e,this.stride),this.changed()}}const Xi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},yl=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",Oj=yl.includes("safari")&&!yl.includes("chrom");Oj&&(yl.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(yl));const Fj=yl.includes("webkit")&&!yl.includes("edge"),jb=yl.includes("macintosh"),Vj=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ti=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,zb=typeof Image<"u"&&Image.prototype.decode,Ub=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Be={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Jt(n,e,t,i){let r;return t&&t.length?r=t.shift():Ti?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let c0;function Op(){return c0||(c0=Jt(1,1)),c0}function Vm(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function MI(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function jj(n){for(;n.lastChild;)n.lastChild.remove()}function zj(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function Bb(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Wo(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const w1=[NaN,NaN,NaN,0];let u0;function Uj(){return u0||(u0=Jt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),u0}const Bj=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Gj=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Wj=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,$j=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Fg(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function td(n){throw new Error('failed to parse "'+n+'" as color')}function Gb(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(Gj)||n.match(Bj)||n.match(Wj);if(s){const o=s[4],l=100/255;return[Nt(Fg(s[1],l)+.5|0,0,255),Nt(Fg(s[2],l)+.5|0,0,255),Nt(Fg(s[3],l)+.5|0,0,255),o!==void 0?Nt(Fg(o,100),0,1):1]}td(n)}if(n.startsWith("#")){if($j.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let f=parseInt(s.substring(u,u+o),16);o===1&&(f+=f<<4),l[u/o]=f}return l[3]=l[3]/255,l}td(n)}const e=Uj();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&td(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Gb(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=tf(r[3]/255,3),r}function Kj(n){return typeof n=="string"?n:T1(n)}const Hj=1024,Ch={};let h0=0;function Xj(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function d0(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function f0(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function g0(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function p0(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function LI(n){const e=g0(n[0]),t=g0(n[1]),i=g0(n[2]),r=p0(e*.222488403+t*.716873169+i*.06060791),s=500*(p0(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-p0(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function qj(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=f0(e),s=f0(e+t/500*Math.cos(i)),o=f0(e-t/200*Math.sin(i)),l=d0(s*3.021973625-r*1.617392459-o*.404875592),u=d0(s*-.943766287+r*1.916279586+o*.027607165),h=d0(s*.069407491-r*.22898585+o*1.159737864);return[Nt(l+.5|0,0,255),Nt(u+.5|0,0,255),Nt(h+.5|0,0,255),n[3]]}function E1(n){if(n==="none")return w1;if(Ch.hasOwnProperty(n))return Ch[n];if(h0>=Hj){let t=0;for(const i in Ch)(t++&3)===0&&(delete Ch[i],--h0)}const e=Gb(n);e.length!==4&&td(n);for(const t of e)isNaN(t)&&td(n);return Ch[n]=e,++h0,e}function hu(n){return Array.isArray(n)?n:E1(n)}function T1(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}function Yj(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[bp(i,Ge.LOAD,function(){o=!0,s||e()})];return i.src&&zb?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):l.push(bp(i,Ge.ERROR,t)),function(){r=!1,l.forEach(At)}}function Zj(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function Qj(n,e){return e&&(n.src=e),n.src&&zb?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):Zj(n)}class Jj{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=m0(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=m0(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=m0(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Be.IDLE&&r.load(),r.getImageState()===Be.LOADING?r.ready().then(()=>{this.patternCache_[o]=Op().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Op().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function m0(n,e,t){const i=t?hu(t):"null";return e+":"+n+":"+i}const qi=new Jj;let Rh=null;class Wb extends bm{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Be.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Be.LOADED){Rh||(Rh=Jt(1,1,void 0,{willReadFrequently:!0})),Rh.drawImage(this.image_,0,0);try{Rh.getImageData(0,0,1,1),this.tainted_=!1}catch{Rh=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Ge.CHANGE)}handleImageError_(){this.imageState_=Be.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Be.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Jt(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Be.IDLE){this.image_||this.initializeImage_(),this.imageState_=Be.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Qj(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Be.LOADED)return;const t=this.image_,i=Jt(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=Kj(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Be.LOADED||this.imageState_===Be.ERROR)e();else{const t=()=>{(this.imageState_===Be.LOADED||this.imageState_===Be.ERROR)&&(this.removeEventListener(Ge.CHANGE,t),e())};this.addEventListener(Ge.CHANGE,t)}})),this.ready_}}function Fp(n,e,t,i,r,s){let o=e===void 0?void 0:qi.get(e,t,r);return o||(o=new Wb(n,n&&"src"in n?n.src||void 0:e,t,i,r),qi.set(e,t,r,o,s)),s&&o&&!qi.getPattern(e,t,r)&&qi.set(e,t,r,o,s),o}function Qr(n){return n?Array.isArray(n)?T1(n):typeof n=="object"&&"src"in n?e4(n):n:null}function e4(n){if(!n.offset||!n.size)return qi.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=qi.getPattern(e,void 0,n.color);if(t)return t;const i=qi.get(n.src,"anonymous",null);if(i.getImageState()!==Be.LOADED)return null;const r=Jt(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Fp(r.canvas,e,void 0,Be.LOADED,n.color,!0),qi.getPattern(e,void 0,n.color)}class $b{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Vg="ol-hidden",rf="ol-unselectable",S1="ol-control",OI="ol-collapsed",t4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),FI=["style","variant","weight","size","lineHeight","family"],Rv={normal:400,bold:700},Av=function(n){const e=n.match(t4);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=FI.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[FI[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in Rv&&(t.weight=Rv[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},Kb="10px sans-serif",ti="#000",du="round",Gs=[],Ws=0,fu="round",Sd=10,Id="#000",Cd="center",Vp="middle",el=[0,0,0,0],Rd=1,Dc=new cs;let Ah=null,VI;const bv={},n4=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function i4(n,e,t){return`${n} ${e} 16px "${t}"`}const r4=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=Av(s),u=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const p=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),y=Rv[f.weight]||f.weight;return p===u&&f.style===l.style&&y==h})}async function r(){await t.ready;let s=!0;const o=Dc.getProperties(),l=Object.keys(o).filter(u=>o[u]<100);for(let u=l.length-1;u>=0;--u){const h=l[u];let f=o[h];f<100&&(await i(h)?(Jd(bv),Dc.set(h,100)):(f+=10,Dc.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Ti?self.fonts:document.fonts);const o=Av(s);if(!o)return;const l=o.families;let u=!1;for(const h of l){if(n4.has(h))continue;const f=i4(o.style,o.weight,h);Dc.get(f)===void 0&&(Dc.set(f,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),s4=(function(){let n;return function(e){let t=bv[e];if(t==null){if(Ti){const i=Av(e),r=Hb(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);bv[e]=t}return t}})();function Hb(n,e){return Ah||(Ah=Jt(1,1)),n!=VI&&(Ah.font=n,VI=Ah.font),Ah.measureText(e)}function Xb(n,e){return Hb(n,e).width}function jI(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,Xb(n,s)),0);return t[e]=i,i}function o4(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,u=0;for(let h=0,f=e.length;h<=f;h+=2){const p=e[h];if(p===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=u,u=0;continue}const y=e[h+1]||n.font,x=Xb(y,p);t.push(x),o+=x;const S=s4(y);i.push(S),u=Math.max(u,S)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function a4(n,e,t,i,r,s,o,l,u,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=p=>p.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(f[0],f[1]),l4(i,n)):f[0]<0||f[1]<0?(n.translate(u,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,u,h,o*f[0],l*f[1]),n.restore()}function l4(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class c4 extends $b{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?tf(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Er()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Xo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,p=s.length;f<p;f+=2){const y=s[f]-this.imageAnchorX_,x=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const S=y+this.imageAnchorX_,I=x+this.imageAnchorY_;Hs(l,S,I,1,1,h,-S,-I),o.save(),o.transform.apply(o,l),o.translate(S,I),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Xo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=Xo(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let u=l.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=bj(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(ri(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,u=s.length;l<u;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),aa(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Cd;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Qr(i||ti)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),f=s||Gs;this.strokeState_={lineCap:r!==void 0?r:du,lineDash:this.pixelRatio_===1?f:f.map(p=>p*this.pixelRatio_),lineDashOffset:(o||Ws)*this.pixelRatio_,lineJoin:l!==void 0?l:fu,lineWidth:(u!==void 0?u:Rd)*this.pixelRatio_,miterLimit:h!==void 0?h:Sd,strokeStyle:Qr(i||Id)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const x=t.getColor();this.textFillState_={fillStyle:Qr(x||ti)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const x=i.getColor(),S=i.getLineCap(),I=i.getLineDash(),T=i.getLineDashOffset(),A=i.getLineJoin(),P=i.getWidth(),N=i.getMiterLimit();this.textStrokeState_={lineCap:S!==void 0?S:du,lineDash:I||Gs,lineDashOffset:T||Ws,lineJoin:A!==void 0?A:fu,lineWidth:P!==void 0?P:Rd,miterLimit:N!==void 0?N:Sd,strokeStyle:Qr(x||Id)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),f=e.getText(),p=e.getTextAlign(),y=e.getTextBaseline();this.textState_={font:r!==void 0?r:Kb,textAlign:p!==void 0?p:Cd,textBaseline:y!==void 0?y:Vp},this.text_=f!==void 0?Array.isArray(f)?f.reduce((x,S,I)=>x+=I%2?" ":S,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const u4=.5,qb={Point:_4,LineString:p4,Polygon:x4,MultiPoint:v4,MultiLineString:m4,MultiPolygon:y4,GeometryCollection:g4,Circle:d4};function h4(n,e){return parseInt(it(n),10)-parseInt(it(e),10)}function zI(n,e){const t=Yb(n,e);return t*t}function Yb(n,e){return u4*n/e}function d4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}function UI(n,e,t,i,r,s,o,l){const u=[],h=t.getImage();if(h){let y=!0;const x=h.getImageState();x==Be.LOADED||x==Be.ERROR?y=!1:x==Be.IDLE&&h.load(),y&&u.push(h.ready())}const f=t.getFill();f&&f.loading()&&u.push(f.ready());const p=u.length>0;return p&&Promise.all(u).then(()=>r(null)),f4(n,e,t,i,s,o,l),p}function f4(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const u=l.simplifyTransformed(i,r);if(t.getRenderer())Zb(n,u,t,e,o);else{const f=qb[u.getType()];f(n,u,t,e,o,s)}}function Zb(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,u=o.length;l<u;++l)Zb(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function g4(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,u;for(l=0,u=o.length;l<u;++l){const h=qb[o[l].getType()];h(n,o[l],t,i,r,s)}}function p4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function m4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function y4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}function _4(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=Be.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function v4(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=Be.LOADED)return;const p=n.getBuilder(t.getZIndex(),"Image");p.setImageStyle(o,f),p.drawMultiPoint(e,i,r)}if(h){const p=n.getBuilder(t.getZIndex(),"Text");p.setTextStyle(u,f),p.drawText(e,i,r)}}function x4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}let w4=!1;function E4(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=w4,l.onload=function(u){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function BI(n,e){return function(t,i,r,s,o){E4(n,e,t,i,r,(l,u)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function T4(n,e){return[[-1/0,-1/0,1/0,1/0]]}function S4(n,e,t,i){const r=[];let s=Qi();for(let o=0,l=t.length;o<l;++o){const u=t[o];s=l1(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function I1(n,e,t,i,r,s,o){let l,u,h,f,p,y,x;const S=r[s+1],I=[];for(let P=0,N=t.length;P<N;++P){const R=t[P];for(f=n[R-i],y=n[R-i+1],l=e;l<R;l+=i)p=n[l],x=n[l+1],(S<=y&&x<=S||y<=S&&S<=x)&&(h=(S-y)/(x-y)*(p-f)+f,I.push(h)),f=p,y=x}let T=NaN,A=-1/0;for(I.sort(Bs),f=I[0],l=1,u=I.length;l<u;++l){p=I[l];const P=Math.abs(p-f);P>A&&(h=(f+p)/2,y1(n,e,t,i,h,S)&&(T=h,A=P)),f=p}return isNaN(T)&&(T=r[s]),o?(o.push(T,S,A),o):[T,S,A]}function I4(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const u=t[o];s=I1(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function C4(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function C1(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],u=n[e+1];r+=(l-s)*(u+o),s=l,o=u}return r===0?void 0:r>0}function Qb(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=C1(n,e,l,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function vX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!Qb(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function Pv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=C1(n,e,l,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&C4(n,e,l,i),e=l}return e}function xX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=Pv(n,e,t[s],i,r);return e}function R4(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const u=e[o],h=C1(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function Jb(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,u=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=u*h-l*f,l=h,u=f}return r/2}function eP(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=Jb(n,e,l,i),e=l}return r}function wX(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=eP(n,e,l,i),e=l[l.length-1]}return r}class Ad extends m1{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Ad(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<db(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(kb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Nb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return Jb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Kc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=v1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Ad(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Lb(this.flatCoordinates,0,e,this.stride),this.changed()}}class bd extends m1{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?o1(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new bd(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<db(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Db(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Mb(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return y1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return eP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Pv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Lp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=gl(this.getExtent());this.flatInteriorPoint_=I1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new ml(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Ad(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const u=i[o],h=new Ad(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Qb(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Pv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=x1(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new bd(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return Vb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Ob(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function GI(n){if(Mm(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new bd(s,"XY",[s.length])}const WI=Er();class gr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?gb(this.flatCoordinates_):l1(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=gl(this.getExtent());this.flatInteriorPoints_=I1(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=R4(this.flatCoordinates_,this.ends_),t=S4(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=I4(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=DI(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=DI(e,t,o,2,.5);o1(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ai(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Bn(i)/Bn(t);Hs(WI,i[0],i[3],r,-r,0,0,0),Xo(this.flatCoordinates_,0,this.flatCoordinates_.length,2,WI,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new gr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=ub((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=v1(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=Mj(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=x1(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new gr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}gr.prototype.getFlatCoordinates=gr.prototype.getOrientedFlatCoordinates;function tP(n,e,t=0,i=n.length-1,r=A4){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,f=Math.log(u),p=.5*Math.exp(2*f/3),y=.5*Math.sqrt(f*p*(u-p)/u)*(h-u/2<0?-1:1),x=Math.max(t,Math.floor(e-h*p/u+y)),S=Math.min(i,Math.floor(e+(u-h)*p/u+y));tP(n,e,x,S,r)}const s=n[e];let o=t,l=i;for(bh(n,t,e),r(n[i],s)>0&&bh(n,t,i);o<l;){for(bh(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?bh(n,t,l):(l++,bh(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function bh(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function A4(n,e){return n<e?-1:n>e?1:0}let nP=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!zg(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],u=t.leaf?r(l):l;zg(e,u)&&(t.leaf?i.push(l):_0(e,u)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!zg(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(zg(e,o)){if(t.leaf||_0(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Nc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=b4(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&_0(i,r)?(s.push(i),o.push(l),l=0,u=i,i=i.children[0]):u?(l++,i=u.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=Nc(e.slice(t,i+1)),xc(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=Nc([]),l.leaf=!1,l.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));$I(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const p=Math.min(f+h-1,i);$I(e,f,p,u,this.compareMinY);for(let y=f;y<=p;y+=u){const x=Math.min(y+u-1,p);l.children.push(this._build(e,y,x,r-1))}}return xc(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let u=0;u<t.children.length;u++){const h=t.children[u],f=y0(h),p=D4(e,h)-f;p<o?(o=p,s=f<s?f:s,l=h):p===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Gh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=Nc(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,xc(i,this.toBBox),xc(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=Nc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,xc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const u=Bh(e,0,l,this.toBBox),h=Bh(e,l,i,this.toBBox),f=N4(u,h),p=y0(u)+y0(h);f<s?(s=f,r=l,o=p<o?p:o):f===s&&p<o&&(o=p,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:P4,s=e.leaf?this.compareMinY:k4,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Bh(e,0,t,s),l=Bh(e,i-t,i,s);let u=jg(o)+jg(l);for(let h=t;h<i-t;h++){const f=e.children[h];Gh(o,e.leaf?s(f):f),u+=jg(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];Gh(l,e.leaf?s(f):f),u+=jg(l)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Gh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():xc(e[t],this.toBBox)}};function b4(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function xc(n,e){Bh(n,0,n.children.length,e,n)}function Bh(n,e,t,i,r){r||(r=Nc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Gh(r,n.leaf?i(o):o)}return r}function Gh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function P4(n,e){return n.minX-e.minX}function k4(n,e){return n.minY-e.minY}function y0(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function jg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function D4(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function N4(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function _0(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function zg(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Nc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function $I(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;tP(n,o,e,t,r),s.push(e,o,o,t)}}class KI{constructor(e){this.rbush_=new nP(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[it(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=u,this.items_[it(l)]=u}this.rbush_.load(i)}remove(e){const t=it(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[it(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Ed(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return ou(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return ta(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class iP extends cs{constructor(e){super(),this.projection=ai(e.projection),this.attributions_=HI(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=HI(e),this.changed()}setState(e){this.state_=e,this.changed()}}function HI(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const Wi={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Io extends Zs{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class R1 extends iP{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=wd,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(at(this.format_,"`format` must be set when `url` is set"),this.loader_=BI(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:T4;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new KI:null,this.loadedExtentsRtree_=new KI,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Hi(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=it(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Io(Wi.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof gr||(this.featureChangeKeys_[e]=[nt(t,Ge.CHANGE,this.handleFeatureChange_,this),nt(t,su.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof gr){const s=this.idIndex_[r];s instanceof gr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(at(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],u=it(l);this.addToIndex_(u,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],u=it(l);this.setupChangeEvents_(u,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(Wi.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Io(Wi.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Wi.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(Wi.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(ei.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(ei.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(At);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Io(Wi.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof gr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof gr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),ou(this.nullGeometryFeatures_)||o1(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=vb(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||xd,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const f=h.getGeometry(),p=l;if(l=f instanceof gr?0:f.closestPointXY(i,r,o,l),l<p){s=h;const y=Math.sqrt(l);u[0]=i-y,u[1]=r-y,u[2]=i+y,u[3]=r+y}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=it(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new Io(Wi.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:it(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&ou(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const u=s[o];r.forEachInExtent(u,function(f){return Uh(f.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Io(Wi.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new Io(Wi.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Io(Wi.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Ed(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=it(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(At),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(Wi.REMOVEFEATURE)&&this.dispatchEvent(new Io(Wi.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){at(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(BI(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Ir{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Ir({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Fp(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Be.IDLE&&t.load(),t.getImageState()===Be.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?it(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:hu(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class ku{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new ku({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function XI(n){return n[0]>0&&n[1]>0}function M4(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function oi(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class jm{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=oi(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new jm({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return tt()}getImage(e){return tt()}getHitDetectionImage(){return tt()}getPixelRatio(e){return 1}getImageState(){return tt()}getImageSize(){return tt()}getOrigin(){return tt()}getSize(){return tt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=oi(e)}listenImageChange(e){tt()}load(){tt()}unlistenImageChange(e){tt()}ready(){return Promise.resolve()}}class zm extends jm{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Be.LOADING:Be.LOADED,this.imageState_===Be.LOADING&&this.ready().then(()=>this.imageState_=Be.LOADED),this.render()}clone(){const e=this.getScale(),t=new zm({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=qi.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=Jt(o,o);this.draw_(s,l,e),r=l.canvas,qi.set(i,null,null,new Wb(r,void 0,null,Be.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const j=r;r=s,s=j}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,u=s*Math.sin(l),h=Math.sqrt(s*s-u*u),f=r-h,p=Math.sqrt(u*u+f*f),y=p/u;if(e==="miter"&&y<=i)return y*t;const x=t/2/y,S=t/2*(f/p),T=Math.sqrt((r+x)*(r+x)+S*S)-r;if(this.radius2_===void 0||e==="bevel")return T*2;const A=r*Math.sin(l),P=Math.sqrt(r*r-A*A),N=s-P,L=Math.sqrt(A*A+N*N)/A;if(L<=i){const j=L*t/2-s-r;return 2*Math.max(T,j)}return T*2}createRenderOptions(){let e=du,t=fu,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=Qr(this.stroke_.getColor()??Id),l=this.stroke_.getWidth()??Rd,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??fu,e=this.stroke_.getLineCap()??du,i=this.stroke_.getMiterLimit()??Sd);const u=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ti),t.fillStyle=Qr(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=hu(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Jt(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const u=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ti,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Dl extends zm{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Dl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Zi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=qI,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Zi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=qI,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function L4(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(at(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let v0=null;function rP(n,e){if(!v0){const t=new Ir({color:"rgba(255,255,255,0.4)"}),i=new ku({color:"#3399CC",width:1.25});v0=[new Zi({image:new Dl({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return v0}function qI(n){return n.getGeometry()}const O4="#333";class sf{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=oi(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Ir({color:O4}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new sf({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Ir?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=oi(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Mn={ANIMATING:0,INTERACTING:1},Ie={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ug=[Ie.FILL],$o=[Ie.STROKE],tl=[Ie.BEGIN_PATH],YI=[Ie.CLOSE_PATH];class of extends $b{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,u=e.length;l<u;l+=t)r[0]=e[l],r[1]=e[l+1],lu(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let u=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],p=e[t+1];const y=this.tmpCoordinate_;let x=!0,S,I,T;for(S=t+r;S<i;S+=r)y[0]=e[S],y[1]=e[S+1],T=_v(h,y),T!==I?(x&&(l[u++]=f,l[u++]=p,x=!1),l[u++]=y[0],l[u++]=y[1]):T===ln.INTERSECTING?(l[u++]=y[0],l[u++]=y[1],x=!1):x=!0,f=y[0],p=y[1],I=T;return(s&&x||S===t+r)&&(l[u++]=f,l[u++]=p),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),u=this.coordinates.length;let h,f,p,y,x;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),y=[];const S=e.getEndss();x=0;for(let I=0,T=S.length;I<T;++I){const A=[];x=this.drawCustomCoordinates_(h,x,S[I],l,A),y.push(A)}this.instructions.push([Ie.CUSTOM,u,y,e,i,kI,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,y,e,r||i,kI,s]);break;case"Polygon":case"MultiLineString":p=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),x=this.drawCustomCoordinates_(h,0,e.getEnds(),l,p),this.instructions.push([Ie.CUSTOM,u,p,e,i,Lp,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,p,e,r||i,Lp,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Ie.CUSTOM,u,f,e,i,Kc,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,Kc,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>u&&(this.instructions.push([Ie.CUSTOM,u,f,e,i,Kc,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,Kc,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Ie.CUSTOM,u,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Ie.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ie.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Ie.END_GEOMETRY?o=t:s==Ie.BEGIN_GEOMETRY&&(r[2]=t,A5(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Qr(i||ti)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Qr(i||Id);const r=e.getLineCap();t.lineCap=r!==void 0?r:du;const s=e.getLineDash();t.lineDash=s?s.slice():Gs;const o=e.getLineDashOffset();t.lineDashOffset=o||Ws;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:fu;const u=e.getWidth();t.lineWidth=u!==void 0?u:Rd;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Sd,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Ie.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ie.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!aa(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Ie.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=hb(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;a1(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class F4 extends of{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!lu(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Ie.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||lu(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ie.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class V4 extends of{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Ie.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws],tl);const l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push($o),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws],tl);const l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,y=l.length;p<y;++p)f=this.drawFlatCoordinates_(u,f,l[p],h);this.hitDetectionInstructions.push($o),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push($o),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push($o),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(tl)}}class ZI extends of{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,u=i.length;this.instructions.push(tl),this.hitDetectionInstructions.push(tl);for(let h=0;h<u;++h){const f=i[h],p=this.coordinates.length,y=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),x=[Ie.MOVE_TO_LINE_TO,p,y];this.instructions.push(x),this.hitDetectionInstructions.push(x),l&&(this.instructions.push(YI),this.hitDetectionInstructions.push(YI)),t=f}return o&&(this.instructions.push(Ug),this.hitDetectionInstructions.push(Ug)),l&&(this.instructions.push($o),this.hitDetectionInstructions.push($o)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);const f=[Ie.CIRCLE,h];this.instructions.push(tl,f),this.hitDetectionInstructions.push(tl,f),r.fillStyle!==void 0&&(this.instructions.push(Ug),this.hitDetectionInstructions.push(Ug)),r.strokeStyle!==void 0&&(this.instructions.push($o),this.hitDetectionInstructions.push($o)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,y=l.length;p<y;++p)f=this.drawFlatCoordinatess_(u,f,l[p],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Ua(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function j4(n,e,t,i,r){const s=[];let o=t,l=0,u=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=u.slice(-2),p=e[o+r],y=e[o+r+1],x=Math.sqrt((p-h)*(p-h)+(y-f)*(y-f));if(l+=x,l>=n){const S=(n-l+x)/x,I=xi(h,p,S),T=xi(f,y,S);u.push(I,T),s.push(u),u=[I,T],l==n&&(o+=r),l=0}else if(l<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const S=x-l,I=xi(h,p,S/x),T=xi(f,y,S/x);u.push(I,T),s.push(u),u=[I,T],l=0,o+=r}}return l>0&&s.push(u),s}function z4(n,e,t,i,r){let s=t,o=t,l=0,u=0,h=t,f,p,y,x,S,I,T,A,P,N;for(p=t;p<i;p+=r){const R=e[p],L=e[p+1];S!==void 0&&(P=R-S,N=L-I,x=Math.sqrt(P*P+N*N),T!==void 0&&(u+=y,f=Math.acos((T*P+A*N)/(y*x)),f>n&&(u>l&&(l=u,s=h,o=p),u=0,h=p-r)),y=x,T=P,A=N),S=R,I=L}return u+=x,u>l?[h,p]:[s,o]}const jp={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class U4 extends of{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ti]={fillStyle:ti},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let u=l.length;const h=e.getType();let f=null,p=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!ri(this.maxExtent,e.getExtent()))return;let y;if(f=e.getFlatCoordinates(),h=="LineString")y=[f.length];else if(h=="MultiLineString")y=e.getEnds();else if(h=="Polygon")y=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const T=e.getEndss();y=[];for(let A=0,P=T.length;A<P;++A)y.push(T[A][0])}this.beginGeometry(e,t,i);const x=o.repeat,S=x?void 0:o.textAlign;let I=0;for(let T=0,A=y.length;T<A;++T){let P;x?P=j4(x*this.resolution,f,I,y[T],p):P=[f.slice(I,y[T])];for(let N=0,R=P.length;N<R;++N){const L=P[N];let j=0,D=L.length;if(S==null){const M=z4(o.maxAngle,L,0,L.length,2);j=M[0],D=M[1]}for(let M=j;M<D;M+=p)l.push(L[M],L[M+1]);const b=l.length;I=y[T],this.drawChars_(u,b),u=b}}this.endGeometry(t)}else{let y=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),p=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||y.push(f[2]/this.resolution),p=3;break;case"MultiPolygon":const R=e.getFlatInteriorPoints();f=[];for(let L=0,j=R.length;L<j;L+=3)o.overflow||y.push(R[L+2]/this.resolution),f.push(R[L],R[L+1]);if(f.length===0)return;p=2;break}const x=this.appendFlatPointCoordinates(f,p);if(x===u)return;if(y&&(x-u)/2!==f.length/p){let R=u/2;y=y.filter((L,j)=>{const D=l[(R+j)*2]===f[j*p]&&l[(R+j)*2+1]===f[j*p+1];return D||--R,D})}this.saveTextStates_();const S=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,I=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let T=o.padding;if(T!=el&&(o.scale[0]<0||o.scale[1]<0)){let R=o.padding[0],L=o.padding[1],j=o.padding[2],D=o.padding[3];o.scale[0]<0&&(L=-L,D=-D),o.scale[1]<0&&(R=-R,j=-j),T=[R,L,j,D]}const A=this.pixelRatio;this.instructions.push([Ie.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,T==el?el:T.map(function(R){return R*A}),S,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]);const P=1/A,N=S?S.slice(0):null;N&&(N[1]=ti),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[P,P],NaN,this.declutterMode_,this.declutterImageWithText_,T,N,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ti:this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Cd,justify:t.justify,textBaseline:t.textBaseline||Vp,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=jp[r.textBaseline],f=this.textOffsetY_*u,p=this.text_,y=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Ie.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,u,f,s,y*u,p,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ie.DRAW_CHARS,e,t,h,r.overflow,l&&ti,r.maxAngle,u,f,s,y*u,p,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Qr(o.getColor()||ti)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const I=l.getLineDash(),T=l.getLineDashOffset(),A=l.getWidth(),P=l.getMiterLimit();s.lineCap=l.getLineCap()||du,s.lineDash=I?I.slice():Gs,s.lineDashOffset=T===void 0?Ws:T,s.lineJoin=l.getLineJoin()||fu,s.lineWidth=A===void 0?Rd:A,s.miterLimit=P===void 0?Sd:P,s.strokeStyle=Qr(l.getColor()||Id)}i=this.textState_;const u=e.getFont()||Kb;r4(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Vp,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||el,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),p=e.getOffsetY(),y=e.getRotateWithView(),x=e.getKeepUpright(),S=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=p===void 0?0:p,this.textRotateWithView_=y===void 0?!1:y,this.textKeepUpright_=x===void 0?!0:x,this.textRotation_=S===void 0?0:S,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:it(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+it(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const B4={Circle:ZI,Default:of,Image:F4,LineString:V4,Polygon:ZI,Text:U4};class G4{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=B4[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function W4(n,e,t,i,r,s,o,l,u,h,f,p,y=!0){let x=n[e],S=n[e+1],I=0,T=0,A=0,P=0;function N(){I=x,T=S,e+=i,x=n[e],S=n[e+1],P+=A,A=Math.sqrt((x-I)*(x-I)+(S-T)*(S-T))}do N();while(e<t-i&&P+A<s);let R=A===0?0:(s-P)/A;const L=xi(I,x,R),j=xi(T,S,R),D=e-i,b=P,M=s+l*u(h,r,f);for(;e<t-i&&P+A<M;)N();R=A===0?0:(M-P)/A;const V=xi(I,x,R),z=xi(T,S,R);let B=!1;if(y)if(p){const ue=[L,j,V,z];Pb(ue,0,4,2,p,ue,ue),B=ue[0]>ue[2]}else B=L>V;const O=Math.PI,le=[],pe=D+i===e;e=D,A=0,P=b,x=n[e],S=n[e+1];let ge;if(pe){N(),ge=Math.atan2(S-T,x-I),B&&(ge+=ge>0?-O:O);const ue=(V+L)/2,Q=(z+j)/2;return le[0]=[ue,Q,(M-s)/2,ge,r],le}r=r.replace(/\n/g," ");for(let ue=0,Q=r.length;ue<Q;){N();let se=Math.atan2(S-T,x-I);if(B&&(se+=se>0?-O:O),ge!==void 0){let xe=se-ge;if(xe+=xe>O?-2*O:xe<-O?2*O:0,Math.abs(xe)>o)return null}ge=se;const ne=ue;let W=0;for(;ue<Q;++ue){const xe=B?Q-ue-1:ue,ke=l*u(h,r[xe],f);if(e+i<t&&P+A<s+W+ke/2)break;W+=ke}if(ue===ne)continue;const $=B?r.substring(Q-ne,Q-ue):r.substring(ne,ue);R=A===0?0:(s+W/2-P)/A;const ie=xi(I,x,R),me=xi(T,S,R);le.push([ie,me,W/2,se,$]),s+=W}return le}class sP{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Op(),{get:(e,t)=>{if(typeof Op()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const wc=Qi(),Co=[],ks=[],Ds=[],Ro=[];function QI(n){return n[3].declutterBox}const JI=new RegExp("[-----]");function x0(n,e){return e==="start"?e=JI.test(n)?"right":"left":e==="end"&&(e=JI.test(n)?"left":"right"),jp[e]}function $4(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function K4(n,e,t){return t%2===0&&(n+=e),n}class H4{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Er(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new sP:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,f=[u.scale[0]*h,u.scale[1]*h],p=u.justify?jp[u.justify]:x0(Array.isArray(e)?e[0]:e,u.textAlign||Cd),y=r&&o.lineWidth?o.lineWidth:0,x=Array.isArray(e)?e:String(e).split(`
`).reduce($4,[]),{width:S,height:I,widths:T,heights:A,lineWidths:P}=o4(u,x),N=S+y,R=[],L=(N+2)*f[0],j=(I+y)*f[1],D={width:L<0?Math.floor(L):Math.ceil(L),height:j<0?Math.floor(j):Math.ceil(j),contextInstructions:R};(f[0]!=1||f[1]!=1)&&R.push("scale",f),r&&(R.push("strokeStyle",o.strokeStyle),R.push("lineWidth",y),R.push("lineCap",o.lineCap),R.push("lineJoin",o.lineJoin),R.push("miterLimit",o.miterLimit),R.push("setLineDash",[o.lineDash]),R.push("lineDashOffset",o.lineDashOffset)),i&&R.push("fillStyle",l.fillStyle),R.push("textBaseline","middle"),R.push("textAlign","center");const b=.5-p;let M=p*N+b*y;const V=[],z=[];let B=0,O=0,le=0,pe=0,ge;for(let ue=0,Q=x.length;ue<Q;ue+=2){const se=x[ue];if(se===`
`){O+=B,B=0,M=p*N+b*y,++pe;continue}const ne=x[ue+1]||u.font;ne!==ge&&(r&&V.push("font",ne),i&&z.push("font",ne),ge=ne),B=Math.max(B,A[le]);const W=[se,M+b*T[le]+p*(T[le]-P[pe]),.5*(y+B)+O];M+=T[le],r&&V.push("strokeText",W),i&&z.push("fillText",W),++le}return Array.prototype.push.apply(R,V),Array.prototype.push.apply(R,z),this.labels_[s]=D,D}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,u,h,f,p,y,x,S,I,T){l*=y[0],u*=y[1];let A=i-l,P=r-u;const N=s+h>e?e-h:s,R=o+f>t?t-f:o,L=S[3]+N*y[0]+S[1],j=S[0]+R*y[1]+S[2],D=A-S[3],b=P-S[0];(I||p!==0)&&(Co[0]=D,Ro[0]=D,Co[1]=b,ks[1]=b,ks[0]=D+L,Ds[0]=ks[0],Ds[1]=b+j,Ro[1]=Ds[1]);let M;return p!==0?(M=Hs(Er(),i,r,1,1,p,-i,-r),un(M,Co),un(M,ks),un(M,Ds),un(M,Ro),ta(Math.min(Co[0],ks[0],Ds[0],Ro[0]),Math.min(Co[1],ks[1],Ds[1],Ro[1]),Math.max(Co[0],ks[0],Ds[0],Ro[0]),Math.max(Co[1],ks[1],Ds[1],Ro[1]),wc)):ta(Math.min(D,D+L),Math.min(b,b+j),Math.max(D,D+L),Math.max(b,b+j),wc),x&&(A=Math.round(A),P=Math.round(P)),{drawImageX:A,drawImageY:P,drawImageW:N,drawImageH:R,originX:h,originY:f,declutterBox:{minX:wc[0],minY:wc[1],maxX:wc[2],maxY:wc[3],value:T},canvasTransform:M,scale:y}}replayImageOrLabel_(e,t,i,r,s,o,l){const u=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(u&&this.replayTextBackground_(e,Co,ks,Ds,Ro,o,l),a4(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=un(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],u=this.pixelRatio,h=x0(Array.isArray(e)?e[0]:e,s.textAlign||Cd),f=jp[s.textBaseline||Vp],p=l&&l.lineWidth?l.lineWidth:0,y=o.width/u-2*s.scale[0],x=h*y+2*(.5-h)*p,S=f*o.height/u+2*(.5-f)*p;return{label:o,anchorX:x,anchorY:S}}execute_(e,t,i,r,s,o,l,u){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&aa(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=Xo(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),vj(this.renderedTransform_,i));let p=0;const y=r.length;let x=0,S,I,T,A,P,N,R,L,j,D,b,M,V,z=0,B=0;const O=this.coordinateCache_,le=this.viewRotation_,pe=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ge={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:le},ue=this.instructions!=r||this.overlaps?0:200;let Q,se,ne,W;for(;p<y;){const $=r[p];switch($[0]){case Ie.BEGIN_GEOMETRY:Q=$[1],W=$[3],Q.getGeometry()?l!==void 0&&!ri(l,W.getExtent())?p=$[2]+1:++p:p=$[2],h&&(h.zIndex=$[4]);break;case Ie.BEGIN_PATH:z>ue&&(this.fill_(e),z=0),B>ue&&(e.stroke(),B=0),!z&&!B&&(e.beginPath(),P=NaN,N=NaN),++p;break;case Ie.CIRCLE:x=$[1];const me=f[x],xe=f[x+1],ke=f[x+2],Me=f[x+3],Ve=ke-me,We=Me-xe,lt=Math.sqrt(Ve*Ve+We*We);e.moveTo(me+lt,xe),e.arc(me,xe,lt,0,2*Math.PI,!0),++p;break;case Ie.CLOSE_PATH:e.closePath(),++p;break;case Ie.CUSTOM:x=$[1],S=$[2];const er=$[3],fs=$[4],Wn=$[5];ge.geometry=er,ge.feature=Q,p in O||(O[p]=[]);const $n=O[p];Wn?Wn(f,x,S,2,$n):($n[0]=f[x],$n[1]=f[x+1],$n.length=2),h&&(h.zIndex=$[6]),fs($n,ge),++p;break;case Ie.DRAW_IMAGE:x=$[1],S=$[2],j=$[3],I=$[4],T=$[5];let hn=$[6];const dn=$[7],Kn=$[8],bi=$[9],_t=$[10];let ct=$[11];const nn=$[12];let Pi=$[13];A=$[14]||"declutter";const It=$[15];if(!j&&$.length>=20){D=$[19],b=$[20],M=$[21],V=$[22];const Ft=this.drawLabelWithPointPlacement_(D,b,M,V);j=Ft.label,$[3]=j;const Ni=$[23];I=(Ft.anchorX-Ni)*this.pixelRatio,$[4]=I;const fn=$[24];T=(Ft.anchorY-fn)*this.pixelRatio,$[5]=T,hn=j.height,$[6]=hn,Pi=j.width,$[13]=Pi}let to;$.length>25&&(to=$[25]);let ki,Rr,tr;$.length>17?(ki=$[16],Rr=$[17],tr=$[18]):(ki=el,Rr=null,tr=null),_t&&pe?ct+=le:!_t&&!pe&&(ct-=le);let Ar=0;for(;x<S;x+=2){if(to&&to[Ar++]<Pi/this.pixelRatio)continue;const Ft=this.calculateImageOrLabelDimensions_(j.width,j.height,f[x],f[x+1],Pi,hn,I,T,Kn,bi,ct,nn,s,ki,!!Rr||!!tr,Q),Ni=[e,t,j,Ft,dn,Rr,tr];if(u){let fn,Vt,gn;if(It){const rt=S-x;if(!It[rt]){It[rt]={args:Ni,declutterMode:A};continue}const Gt=It[rt];fn=Gt.args,Vt=Gt.declutterMode,delete It[rt],gn=QI(fn)}let pn,rn;if(fn&&(Vt!=="declutter"||!u.collides(gn))&&(pn=!0),(A!=="declutter"||!u.collides(Ft.declutterBox))&&(rn=!0),Vt==="declutter"&&A==="declutter"){const rt=pn&&rn;pn=rt,rn=rt}pn&&(Vt!=="none"&&u.insert(gn),this.replayImageOrLabel_.apply(this,fn)),rn&&(A!=="none"&&u.insert(Ft.declutterBox),this.replayImageOrLabel_.apply(this,Ni))}else this.replayImageOrLabel_.apply(this,Ni)}++p;break;case Ie.DRAW_CHARS:const ca=$[1],br=$[2],Di=$[3],Fl=$[4];V=$[5];const Pr=$[6],gs=$[7],no=$[8];M=$[9];const On=$[10];D=$[11],Array.isArray(D)&&(D=D.reduce(K4,"")),b=$[12];const ps=[$[13],$[13]];A=$[14]||"declutter";const kr=$[15],Dr=this.textStates[b],Fn=Dr.font,Vn=[Dr.scale[0]*gs,Dr.scale[1]*gs];let ft;Fn in this.widths_?ft=this.widths_[Fn]:(ft={},this.widths_[Fn]=ft);const io=Nj(f,ca,br,2),nr=Math.abs(Vn[0])*jI(Fn,D,ft);if(Fl||nr<=io){const Ft=this.textStates[b].textAlign,Ni=(io-nr)*x0(D,Ft),fn=W4(f,ca,br,2,D,Ni,Pr,Math.abs(Vn[0]),jI,Fn,ft,pe?0:this.viewRotation_,kr);e:if(fn){const Vt=[];let gn,pn,rn,rt,Gt;if(M)for(gn=0,pn=fn.length;gn<pn;++gn){Gt=fn[gn],rn=Gt[4],rt=this.createLabel(rn,b,"",M),I=Gt[2]+(Vn[0]<0?-On:On),T=Di*rt.height+(.5-Di)*2*On*Vn[1]/Vn[0]-no;const qt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Gt[0],Gt[1],rt.width,rt.height,I,T,0,0,Gt[3],ps,!1,el,!1,Q);if(u&&A==="declutter"&&u.collides(qt.declutterBox))break e;Vt.push([e,t,rt,qt,1,null,null])}if(V)for(gn=0,pn=fn.length;gn<pn;++gn){Gt=fn[gn],rn=Gt[4],rt=this.createLabel(rn,b,V,""),I=Gt[2],T=Di*rt.height-no;const qt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Gt[0],Gt[1],rt.width,rt.height,I,T,0,0,Gt[3],ps,!1,el,!1,Q);if(u&&A==="declutter"&&u.collides(qt.declutterBox))break e;Vt.push([e,t,rt,qt,1,null,null])}u&&A!=="none"&&u.load(Vt.map(QI));for(let qt=0,Mi=Vt.length;qt<Mi;++qt)this.replayImageOrLabel_.apply(this,Vt[qt])}}++p;break;case Ie.END_GEOMETRY:if(o!==void 0){Q=$[1];const Ft=o(Q,W,A);if(Ft)return Ft}++p;break;case Ie.FILL:ue?z++:this.fill_(e),++p;break;case Ie.MOVE_TO_LINE_TO:for(x=$[1],S=$[2],se=f[x],ne=f[x+1],e.moveTo(se,ne),P=se+.5|0,N=ne+.5|0,x+=2;x<S;x+=2)se=f[x],ne=f[x+1],R=se+.5|0,L=ne+.5|0,(x==S-2||R!==P||L!==N)&&(e.lineTo(se,ne),P=R,N=L);++p;break;case Ie.SET_FILL_STYLE:this.alignAndScaleFill_=$[2],z&&(this.fill_(e),z=0,B&&(e.stroke(),B=0)),e.fillStyle=$[1],++p;break;case Ie.SET_STROKE_STYLE:B&&(e.stroke(),B=0),this.setStrokeStyle_(e,$),++p;break;case Ie.STROKE:ue?B++:e.stroke(),++p;break;default:++p;break}}z&&this.fill_(e),B&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Ka=["Polygon","Circle","LineString","Image","Text","Default"],oP=["Image","Text"],X4=Ka.filter(n=>!oP.includes(n));class q4{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Er(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new H4(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,u=Hs(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Jt(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let p;this.renderBuffer_!==void 0&&(p=Qi(),ed(p,e),a1(p,t*(this.renderBuffer_+r),p));const y=Y4(r);let x;function S(L,j,D){const b=f.getImageData(0,0,l,l).data;for(let M=0,V=y.length;M<V;M++)if(b[y[M]]>0){if(!o||D==="none"||x!=="Image"&&x!=="Text"||o.includes(L)){const z=(y[M]-3)/4,B=r-z%l,O=r-(z/l|0),le=s(L,j,B*B+O*O);if(le)return le}f.clearRect(0,0,l,l);break}}const I=Object.keys(this.executorsByZIndex_).map(Number);I.sort(Bs);let T,A,P,N,R;for(T=I.length-1;T>=0;--T){const L=I[T].toString();for(P=this.executorsByZIndex_[L],A=Ka.length-1;A>=0;--A)if(x=Ka[A],N=P[x],N!==void 0&&(R=N.executeHitDetection(f,u,i,S,p),R))return R}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return Xo(l,0,8,2,e,l),l}isEmpty(){return ou(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(l?R5:Bs),o=o||Ka;const h=Ka.length;for(let f=0,p=u.length;f<p;++f){const y=u[f].toString(),x=this.executorsByZIndex_[y];for(let S=0,I=o.length;S<I;++S){const T=o[S],A=x[T];if(A!==void 0){const P=l===null?void 0:A.getZIndexContext(),N=P?P.getContext():e,R=this.maxExtent_&&T!=="Image"&&T!=="Text";if(R&&(N.save(),this.clip(N,i)),!P||T==="Text"||T==="Image"?A.execute(N,t,i,r,s,l):P.pushFunction(L=>A.execute(L,t,i,r,s,l)),R&&N.restore(),P){P.offset();const L=u[f]*h+Ka.indexOf(T);this.deferredZIndexContexts_[L]||(this.deferredZIndexContexts_[L]=[]),this.deferredZIndexContexts_[L].push(P)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Bs);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const w0={};function Y4(n){if(w0[n]!==void 0)return w0[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let u=i[l];u||(u=[],i[l]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return w0[n]=r,r}function eC(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let A1=class aP extends jm{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;at(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||it(o)),at(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),at(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=Be.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?Be.LOADED:Be.IDLE:u=Be.LOADING:u=Be.LOADED),this.color_=e.color!==void 0?hu(e.color):null,this.iconImage_=Fp(o,l,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const p=this.getImage(1);if(p.width&&p.height)h=p.width,f=p.height;else if(p instanceof HTMLImageElement){this.initialOptions_=e;const y=()=>{if(this.unlistenImageChange(y),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale(eC(x[0],x[1],e.width,e.height))};this.listenImageChange(y);return}}h!==void 0&&this.setScale(eC(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new aP({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=Fp(null,e,this.crossOrigin_,Be.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Be.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Be.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Ge.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Ge.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Yr=.5;function Z4(n,e,t,i,r,s,o,l,u){const h=r,f=n[0]*Yr,p=n[1]*Yr,y=Jt(f,p);y.imageSmoothingEnabled=!1;const x=y.canvas,S=new c4(y,Yr,r,null,o,l,null),I=t.length,T=Math.floor((256*256*256-1)/I),A={};for(let N=1;N<=I;++N){const R=t[N-1],L=R.getStyleFunction()||i;if(!L)continue;let j=L(R,s);if(!j)continue;Array.isArray(j)||(j=[j]);const b=(N*T).toString(16).padStart(7,"#00000");for(let M=0,V=j.length;M<V;++M){const z=j[M],B=z.getGeometryFunction()(R);if(!B||!ri(h,B.getExtent()))continue;const O=z.clone(),le=O.getFill();le&&le.setColor(b);const pe=O.getStroke();pe&&(pe.setColor(b),pe.setLineDash(null)),O.setText(void 0);const ge=z.getImage();if(ge){const ne=ge.getImageSize();if(!ne)continue;const W=Jt(ne[0],ne[1],void 0,{alpha:!1}),$=W.canvas;W.fillStyle=b,W.fillRect(0,0,$.width,$.height),O.setImage(new A1({img:$,anchor:ge.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ge.getOrigin(),opacity:1,size:ge.getSize(),scale:ge.getScale(),rotation:ge.getRotation(),rotateWithView:ge.getRotateWithView()}))}const ue=O.getZIndex()||0;let Q=A[ue];Q||(Q={},A[ue]=Q,Q.Polygon=[],Q.Circle=[],Q.LineString=[],Q.Point=[]);const se=B.getType();if(se==="GeometryCollection"){const ne=B.getGeometriesArrayRecursive();for(let W=0,$=ne.length;W<$;++W){const ie=ne[W];Q[ie.getType().replace("Multi","")].push(ie,O)}}else Q[se.replace("Multi","")].push(B,O)}}const P=Object.keys(A).map(Number).sort(Bs);for(let N=0,R=P.length;N<R;++N){const L=A[P[N]];for(const j in L){const D=L[j];for(let b=0,M=D.length;b<M;b+=2){S.setStyle(D[b+1]);for(let V=0,z=e.length;V<z;++V)S.setTransform(e[V]),S.drawGeometry(D[b])}}}return y.getImageData(0,0,x.width,x.height)}function Q4(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Yr),s=Math.floor(Math.round(n[1])*Yr),o=(Nt(r,0,t.width-1)+Nt(s,0,t.height-1)*t.width)*4,l=t.data[o],u=t.data[o+1],f=t.data[o+2]+256*(u+256*l),p=Math.floor((256*256*256-1)/e.length);f&&f%p===0&&i.push(e[f/p-1])}return i}class lP extends Zs{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const J4=5;class e3 extends ef{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=J4}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return tt()}getData(e){return null}prepareFrame(e){return tt()}renderFrame(e,t){return tt()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Be.LOADED||t.getState()===Be.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Be.LOADED&&t!=Be.ERROR&&e.addEventListener(Ge.CHANGE,this.boundHandleImageChange_),t==Be.IDLE&&(e.load(),t=e.getState()),t==Be.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const tC=[];let Mc=null;function t3(){Mc=Jt(1,1,void 0,{willReadFrequently:!0})}class cP extends e3{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Er(),this.pixelTransform=Er(),this.inversePixelTransform=Er(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Mc||t3(),Mc.clearRect(0,0,1,1);let r;try{Mc.drawImage(e,t,i,1,1,0,0,1,1),r=Mc.getImageData(0,0,1,1).data}catch{return Mc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&aa(hu(e.style.backgroundColor),hu(i)))){const l=e.firstElementChild;Wo(l)&&(o=l.getContext("2d"))}if(o&&Tj(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Ti?Bb():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Jt();const u=o.canvas;s.appendChild(u),l=u.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=kl(i),s=Nm(i),o=Dm(i),l=km(i);un(t.coordinateToPixelTransform,r),un(t.coordinateToPixelTransform,s),un(t.coordinateToPixelTransform,o),un(t.coordinateToPixelTransform,l);const u=this.inversePixelTransform;un(u,r),un(u,s),un(u,o),un(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(dt(i)/r*o),u=Math.round(Bn(i)/r*o);Hs(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-u/2),bb(this.inversePixelTransform,this.pixelTransform);const h=Ej(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=u?(f.width=l,f.height=u):this.context.clearRect(0,0,l,u),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new lP(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Xi.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Xi.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new sP),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Xi.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Xi.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const u=s/2,h=o/2,f=r/t,p=-f,y=-e[0]+l,x=-e[1];return Hs(this.tempTransform,u,h,f,p,-i,y,x)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class n3 extends cP{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Qi(),this.wrappedRenderedExtent_=Qi(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,u=s.projection,h=s.rotation,f=u.getExtent(),p=this.getLayer().getSource(),y=this.getLayer().getDeclutter(),x=t.pixelRatio,S=t.viewHints,I=!(S[Mn.ANIMATING]||S[Mn.INTERACTING]),T=this.context,A=Math.round(dt(r)/l*x),P=Math.round(Bn(r)/l*x),N=p.getWrapX()&&u.canWrapX(),R=N?dt(f):null,L=N?Math.ceil((r[2]-f[2])/R)+1:1;let j=N?Math.floor((r[0]-f[0])/R):0;do{let D=this.getRenderTransform(o,l,0,x,A,P,j*R);t.declutter&&(D=D.slice(0)),e.execute(T,[T.canvas.width,T.canvas.height],D,h,I,i===void 0?Ka:i?oP:X4,i?y&&t.declutter[y]:void 0)}while(++j<L)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Jt(this.context.canvas.width,this.context.canvas.height,tC))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Vm(this.context),tC.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(Xi.PRERENDER)||this.getLayer().hasListener(Xi.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const u=Go(i.extent);l=ri(u,e.extent),this.clipped_=l&&!Uh(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],p=i[0]*Yr,y=i[1]*Yr;f.push(this.getRenderTransform(r,s,o,Yr,p,y,0).slice());const x=h.getSource(),S=l.getExtent();if(x.getWrapX()&&l.canWrapX()&&!Uh(S,u)){let I=u[0];const T=dt(S);let A=0,P;for(;I<S[0];)--A,P=T*A,f.push(this.getRenderTransform(r,s,o,Yr,p,y,P).slice()),I+=T;for(A=0,I=u[2];I>S[2];)++A,P=T*A,f.push(this.getRenderTransform(r,s,o,Yr,p,y,P).slice()),I-=T}this.hitDetectionImageData_=Z4(i,f,this.renderedFeatures_,h.getStyleFunction(),u,s,o,zI(s,this.renderedPixelRatio_))}t(Q4(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},f=function(y,x,S){const I=it(y),T=h[I];if(T){if(T!==!0&&S<T.distanceSq){if(S===0)return h[I]=!0,s.splice(s.lastIndexOf(T),1),r(y,u,x);T.geometry=x,T.distanceSq=S}}else{if(S===0)return h[I]=!0,r(y,u,x);s.push(h[I]={feature:y,layer:u,geometry:x,distanceSq:S,callback:r})}},p=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,p?t.declutter?.[p]?.all().map(y=>y.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Mn.ANIMATING],s=e.viewHints[Mn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,f=h.projection,p=h.resolution,y=e.pixelRatio,x=t.getRevision(),S=t.getRenderBuffer();let I=t.getRenderOrder();I===void 0&&(I=h4);const T=h.center.slice(),A=a1(u,S*p),P=A.slice(),N=[A.slice()],R=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Uh(R,e.extent)){const le=dt(R),pe=Math.max(dt(A)/2,le);A[0]=R[0]-pe,A[2]=R[2]+pe,xb(T,f);const ge=_b(N[0],f);ge[0]<R[0]&&ge[2]<R[2]?N.push([ge[0]+le,ge[1],ge[2]+le,ge[3]]):ge[0]>R[0]&&ge[2]>R[2]&&N.push([ge[0]-le,ge[1],ge[2]-le,ge[3]])}if(this.ready&&this.renderedResolution_==p&&this.renderedRevision_==x&&this.renderedRenderOrder_==I&&this.renderedFrameDeclutter_===!!e.declutter&&Uh(this.wrappedRenderedExtent_,A))return aa(this.renderedExtent_,P)||(this.hitDetectionImageData_=null,this.renderedExtent_=P),this.renderedCenter_=T,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const L=new G4(Yb(p,y),A,p,y);let j;for(let le=0,pe=N.length;le<pe;++le)i.loadFeatures(N[le],p,f);const D=zI(p,y);let b=!0;const M=(le,pe)=>{let ge;const ue=le.getStyleFunction()||t.getStyleFunction();if(ue&&(ge=ue(le,p)),ge){const Q=this.renderFeature(le,D,ge,L,j,this.getLayer().getDeclutter(),pe);b=b&&!Q}},V=Ab(A),z=i.getFeaturesInExtent(V);I&&z.sort(I);for(let le=0,pe=z.length;le<pe;++le)M(z[le],le);this.renderedFeatures_=z,this.ready=b;const B=L.finish(),O=new q4(A,p,y,i.getOverlaps(),B,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=p,this.renderedRevision_=x,this.renderedRenderOrder_=I,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=P,this.wrappedRenderedExtent_=A,this.renderedCenter_=T,this.renderedProjection_=f,this.renderedPixelRatio_=y,this.replayGroup_=O,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)u=UI(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||u;else u=UI(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return u}}let Nl=0;const Un=1<<Nl++,qe=1<<Nl++,ni=1<<Nl++,pr=1<<Nl++,_l=1<<Nl++,Wh=1<<Nl++,Bg=Math.pow(2,Nl)-1,b1={[Un]:"boolean",[qe]:"number",[ni]:"string",[pr]:"color",[_l]:"number[]",[Wh]:"size"},i3=Object.keys(b1).map(Number).sort(Bs);function r3(n){return n in b1}function $h(n){const e=[];for(const t of i3)Kh(n,t)&&e.push(b1[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Kh(n,e){return(n&e)===e}function Ao(n,e){return n===e}class Qt{constructor(e,t){if(!r3(e))throw new Error(`literal expressions must have a specific type, got ${$h(e)}`);this.type=e,this.value=t}}class s3{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function uP(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function In(n,e,t){switch(typeof n){case"boolean":{if(Ao(e,ni))return new Qt(ni,n?"true":"false");if(!Kh(e,Un))throw new Error(`got a boolean, but expected ${$h(e)}`);return new Qt(Un,n)}case"number":{if(Ao(e,Wh))return new Qt(Wh,oi(n));if(Ao(e,Un))return new Qt(Un,!!n);if(Ao(e,ni))return new Qt(ni,n.toString());if(!Kh(e,qe))throw new Error(`got a number, but expected ${$h(e)}`);return new Qt(qe,n)}case"string":{if(Ao(e,pr))return new Qt(pr,E1(n));if(Ao(e,Un))return new Qt(Un,!!n);if(!Kh(e,ni))throw new Error(`got a string, but expected ${$h(e)}`);return new Qt(ni,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return m3(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Ao(e,Wh)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Qt(Wh,n)}if(Ao(e,pr)){if(n.length===3)return new Qt(pr,[...n,1]);if(n.length===4)return new Qt(pr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Kh(e,_l))throw new Error(`got an array of numbers, but expected ${$h(e)}`);return new Qt(_l,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},o3={[te.Get]:Oe(Ue(1,1/0),nC),[te.Var]:Oe(Ue(1,1),a3),[te.Has]:Oe(Ue(1,1/0),nC),[te.Id]:Oe(l3,Ec),[te.Concat]:Oe(Ue(2,1/0),ot(ni)),[te.GeometryType]:Oe(c3,Ec),[te.LineMetric]:Oe(Ec),[te.Resolution]:Oe(E0,Ec),[te.Zoom]:Oe(E0,Ec),[te.Time]:Oe(E0,Ec),[te.Any]:Oe(Ue(2,1/0),ot(Un)),[te.All]:Oe(Ue(2,1/0),ot(Un)),[te.Not]:Oe(Ue(1,1),ot(Un)),[te.Equal]:Oe(Ue(2,2),ot(Bg)),[te.NotEqual]:Oe(Ue(2,2),ot(Bg)),[te.GreaterThan]:Oe(Ue(2,2),ot(qe)),[te.GreaterThanOrEqualTo]:Oe(Ue(2,2),ot(qe)),[te.LessThan]:Oe(Ue(2,2),ot(qe)),[te.LessThanOrEqualTo]:Oe(Ue(2,2),ot(qe)),[te.Multiply]:Oe(Ue(2,1/0),iC),[te.Coalesce]:Oe(Ue(2,1/0),iC),[te.Divide]:Oe(Ue(2,2),ot(qe)),[te.Add]:Oe(Ue(2,1/0),ot(qe)),[te.Subtract]:Oe(Ue(2,2),ot(qe)),[te.Clamp]:Oe(Ue(3,3),ot(qe)),[te.Mod]:Oe(Ue(2,2),ot(qe)),[te.Pow]:Oe(Ue(2,2),ot(qe)),[te.Abs]:Oe(Ue(1,1),ot(qe)),[te.Floor]:Oe(Ue(1,1),ot(qe)),[te.Ceil]:Oe(Ue(1,1),ot(qe)),[te.Round]:Oe(Ue(1,1),ot(qe)),[te.Sin]:Oe(Ue(1,1),ot(qe)),[te.Cos]:Oe(Ue(1,1),ot(qe)),[te.Atan]:Oe(Ue(1,2),ot(qe)),[te.Sqrt]:Oe(Ue(1,1),ot(qe)),[te.Match]:Oe(Ue(4,1/0),rC,h3),[te.Between]:Oe(Ue(3,3),ot(qe)),[te.Interpolate]:Oe(Ue(6,1/0),rC,d3),[te.Case]:Oe(Ue(3,1/0),u3,f3),[te.In]:Oe(Ue(2,2),g3),[te.Number]:Oe(Ue(1,1/0),ot(Bg)),[te.String]:Oe(Ue(1,1/0),ot(Bg)),[te.Array]:Oe(Ue(1,1/0),ot(qe)),[te.Color]:Oe(Ue(1,4),ot(qe)),[te.Band]:Oe(Ue(1,3),ot(qe)),[te.Palette]:Oe(Ue(2,2),p3),[te.ToString]:Oe(Ue(1,1),ot(Un|qe|ni|pr))};function nC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Qt(qe,o);break}case"string":{r[s]=new Qt(ni,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function a3(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Qt(ni,i)]}function l3(n,e,t){t.featureId=!0}function c3(n,e,t){t.geometryType=!0}function E0(n,e,t){t.mapState=!0}function Ec(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Ue(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function iC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=In(n[s+1],e,t);r[s]=o}return r}function ot(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=In(e[o+1],n,i);s[o]=l}return s}}function u3(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function rC(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function h3(n,e,t){const i=n.length-1,r=ni|qe|Un,s=In(n[1],r,t),o=In(n[n.length-1],e,t),l=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=In(n[u+2],s.type,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=In(n[u+3],o.type,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...l,o]}function d3(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Qt(qe,r);let o;try{o=In(n[2],qe,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const l=new Array(n.length-3);for(let u=0;u<l.length;u+=2){try{const h=In(n[u+3],qe,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=In(n[u+4],e,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function f3(n,e,t){const i=In(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=In(n[s+1],Un,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=In(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function g3(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=ni}else r=qe;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const u=In(i[l],r,t);s[l]=u}catch(u){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${u.message}`)}return[In(n[1],r,t),...s]}function p3(n,e,t){let i;try{i=In(n[1],qe,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=In(r[o],pr,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(l instanceof Qt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Oe(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new s3(t,r,...s)}}function m3(n,e,t){const i=n[0],r=o3[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function hP(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return hP(n.getGeometries()[0]);default:return""}}function dP(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Qs(n,e,t){const i=In(n,e,t);return Cr(i)}function Cr(n,e){if(n instanceof Qt){if(n.type===pr&&typeof n.value=="string"){const i=E1(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return y3(n);case te.Get:case te.Var:case te.Has:return _3(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Cr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return x3(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return v3(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return w3(n);case te.Case:return E3(n);case te.Match:return T3(n);case te.Interpolate:return S3(n);case te.ToString:return I3(n);default:throw new Error(`Unsupported operator ${t}`)}}function y3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function _3(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;o=o[f]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function v3(n,e){const t=n.operator,i=Cr(n.args[0]),r=Cr(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function x3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),l=r[1](s),u=r[2](s);return o>=l&&o<=u};case te.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function w3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const u=r[2](s);return o>u?u:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function E3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function T3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function S3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,u;for(let h=2;h<t;h+=2){const f=i[h](r);let p=i[h+1](r);const y=Array.isArray(p);if(y&&(p=Xj(p)),f>=o)return h===2?p:y?C3(s,o,l,u,f,p):Hh(s,o,l,u,f,p);l=f,u=p}return u}}function I3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);if(t===te.ToString)return s=>{const o=r[0](s);return n.args[0].type===pr?T1(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function Hh(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,u=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function C3(n,e,t,i,r,s){if(r-t===0)return i;const l=LI(i),u=LI(s);let h=u[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[Hh(n,e,t,l[0],r,u[0]),Hh(n,e,t,l[1],r,u[1]),l[2]+Hh(n,e,t,0,r,h),Hh(n,e,t,i[3],r,s[3])];return qj(f)}function R3(n){return!0}function A3(n){const e=uP(),t=b3(n,e),i=dP();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=hP(r.getGeometry())),t(i)}}function sC(n){const e=uP(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=kv(n[o],e);const r=dP(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[u]=f,u+=1)}return s.length=u,s}}function b3(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Qs(s.filter,Un,e):R3;let l;if(Array.isArray(s.style)){const u=s.style.length;l=new Array(u);for(let h=0;h<u;++h)l[h]=kv(s.style[h],e)}else l=[kv(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const u=i[l].filter;if(u(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function kv(n,e){const t=Pd(n,"",e),i=kd(n,"",e),r=P3(n,e),s=k3(n,e),o=si(n,"z-index",e);if(!t&&!i&&!r&&!s&&!ou(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new Zi;return function(u){let h=!0;if(t){const f=t(u);f&&(h=!1),l.setFill(f)}if(i){const f=i(u);f&&(h=!1),l.setStroke(f)}if(r){const f=r(u);f&&(h=!1),l.setText(f)}if(s){const f=s(u);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(u)),h?null:l}}function Pd(n,e,t){let i;if(e+"fill-pattern-src"in n)i=L3(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=P1(n,e+"fill-color",t)}if(!i)return null;const r=new Ir;return function(s){const o=i(s);return o===w1?null:(r.setColor(o),r)}}function kd(n,e,t){const i=si(n,e+"stroke-width",t),r=P1(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Ms(n,e+"stroke-line-cap",t),o=Ms(n,e+"stroke-line-join",t),l=fP(n,e+"stroke-line-dash",t),u=si(n,e+"stroke-line-dash-offset",t),h=si(n,e+"stroke-miter-limit",t),f=new ku;return function(p){if(r){const y=r(p);if(y===w1)return null;f.setColor(y)}if(i&&f.setWidth(i(p)),s){const y=s(p);if(y!=="butt"&&y!=="round"&&y!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(y)}if(o){const y=o(p);if(y!=="bevel"&&y!=="round"&&y!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(y)}return l&&f.setLineDash(l(p)),u&&f.setLineDashOffset(u(p)),h&&f.setMiterLimit(h(p)),f}}function P3(n,e){const t="text-",i=Ms(n,t+"value",e);if(!i)return null;const r=Pd(n,t,e),s=Pd(n,t+"background-",e),o=kd(n,t,e),l=kd(n,t+"background-",e),u=Ms(n,t+"font",e),h=si(n,t+"max-angle",e),f=si(n,t+"offset-x",e),p=si(n,t+"offset-y",e),y=Yc(n,t+"overflow",e),x=Ms(n,t+"placement",e),S=si(n,t+"repeat",e),I=Um(n,t+"scale",e),T=Yc(n,t+"rotate-with-view",e),A=si(n,t+"rotation",e),P=Ms(n,t+"align",e),N=Ms(n,t+"justify",e),R=Ms(n,t+"baseline",e),L=Yc(n,t+"keep-upright",e),j=fP(n,t+"padding",e),D=Bm(n,t+"declutter-mode"),b=new sf({declutterMode:D});return function(M){if(b.setText(i(M)),r&&b.setFill(r(M)),s&&b.setBackgroundFill(s(M)),o&&b.setStroke(o(M)),l&&b.setBackgroundStroke(l(M)),u&&b.setFont(u(M)),h&&b.setMaxAngle(h(M)),f&&b.setOffsetX(f(M)),p&&b.setOffsetY(p(M)),y&&b.setOverflow(y(M)),x){const V=x(M);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");b.setPlacement(V)}if(S&&b.setRepeat(S(M)),I&&b.setScale(I(M)),T&&b.setRotateWithView(T(M)),A&&b.setRotation(A(M)),P){const V=P(M);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");b.setTextAlign(V)}if(N){const V=N(M);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");b.setJustify(V)}if(R){const V=R(M);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");b.setTextBaseline(V)}return j&&b.setPadding(j(M)),L&&b.setKeepUpright(L(M)),b}}function k3(n,e){return"icon-src"in n?D3(n,e):"shape-points"in n?N3(n,e):"circle-radius"in n?M3(n,e):null}function D3(n,e){const t="icon-",i=t+"src",r=gP(n[i],i),s=zp(n,t+"anchor",e),o=Um(n,t+"scale",e),l=si(n,t+"opacity",e),u=zp(n,t+"displacement",e),h=si(n,t+"rotation",e),f=Yc(n,t+"rotate-with-view",e),p=aC(n,t+"anchor-origin"),y=lC(n,t+"anchor-x-units"),x=lC(n,t+"anchor-y-units"),S=j3(n,t+"color"),I=F3(n,t+"cross-origin"),T=V3(n,t+"offset"),A=aC(n,t+"offset-origin"),P=Up(n,t+"width"),N=Up(n,t+"height"),R=O3(n,t+"size"),L=Bm(n,t+"declutter-mode"),j=new A1({src:r,anchorOrigin:p,anchorXUnits:y,anchorYUnits:x,color:S,crossOrigin:I,offset:T,offsetOrigin:A,height:N,width:P,size:R,declutterMode:L});return function(D){return l&&j.setOpacity(l(D)),u&&j.setDisplacement(u(D)),h&&j.setRotation(h(D)),f&&j.setRotateWithView(f(D)),o&&j.setScale(o(D)),s&&j.setAnchor(s(D)),j}}function N3(n,e){const t="shape-",i=t+"points",r=t+"radius",s=Dv(n[i],i),o=Dv(n[r],r),l=Pd(n,t,e),u=kd(n,t,e),h=Um(n,t+"scale",e),f=zp(n,t+"displacement",e),p=si(n,t+"rotation",e),y=Yc(n,t+"rotate-with-view",e),x=Up(n,t+"radius2"),S=Up(n,t+"angle"),I=Bm(n,t+"declutter-mode"),T=new zm({points:s,radius:o,radius2:x,angle:S,declutterMode:I});return function(A){return l&&T.setFill(l(A)),u&&T.setStroke(u(A)),f&&T.setDisplacement(f(A)),p&&T.setRotation(p(A)),y&&T.setRotateWithView(y(A)),h&&T.setScale(h(A)),T}}function M3(n,e){const t="circle-",i=Pd(n,t,e),r=kd(n,t,e),s=si(n,t+"radius",e),o=Um(n,t+"scale",e),l=zp(n,t+"displacement",e),u=si(n,t+"rotation",e),h=Yc(n,t+"rotate-with-view",e),f=Bm(n,t+"declutter-mode"),p=new Dl({radius:5,declutterMode:f});return function(y){return s&&p.setRadius(s(y)),i&&p.setFill(i(y)),r&&p.setStroke(r(y)),l&&p.setDisplacement(l(y)),u&&p.setRotation(u(y)),h&&p.setRotateWithView(h(y)),o&&p.setScale(o(y)),p}}function si(n,e,t){if(!(e in n))return;const i=Qs(n[e],qe,t);return function(r){return Dv(i(r),e)}}function Ms(n,e,t){if(!(e in n))return null;const i=Qs(n[e],ni,t);return function(r){return gP(i(r),e)}}function L3(n,e,t){const i=Ms(n,e+"pattern-src",t),r=oC(n,e+"pattern-offset",t),s=oC(n,e+"pattern-size",t),o=P1(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function Yc(n,e,t){if(!(e in n))return null;const i=Qs(n[e],Un,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function P1(n,e,t){if(!(e in n))return null;const i=Qs(n[e],pr,t);return function(r){return pP(i(r),e)}}function fP(n,e,t){if(!(e in n))return null;const i=Qs(n[e],_l,t);return function(r){return af(i(r),e)}}function zp(n,e,t){if(!(e in n))return null;const i=Qs(n[e],_l,t);return function(r){const s=af(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function oC(n,e,t){if(!(e in n))return null;const i=Qs(n[e],_l,t);return function(r){return mP(i(r),e)}}function Um(n,e,t){if(!(e in n))return null;const i=Qs(n[e],_l|qe,t);return function(r){return z3(i(r),e)}}function Up(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function O3(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return oi(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function F3(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function aC(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function lC(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function V3(n,e){const t=n[e];if(t!==void 0)return af(t,e)}function Bm(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function j3(n,e){const t=n[e];if(t!==void 0)return pP(t,e)}function af(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function gP(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function Dv(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function pP(n,e){if(typeof n=="string")return n;const t=af(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function mP(n,e){const t=af(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function z3(n,e){return typeof n=="number"?n:mP(n,e)}const hr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function cC(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,p=l?l[1]:0;let y=n[0]+u/2+f,x=n[2]-u/2+f,S=n[1]+h/2+p,I=n[3]-h/2+p;y>x&&(y=(x+y)/2,x=y),S>I&&(S=(I+S)/2,I=S);let T=Nt(i[0],y,x),A=Nt(i[1],S,I);if(o&&t&&r){const P=30*r;T+=-P*Math.log(1+Math.max(0,y-i[0])/P)+P*Math.log(1+Math.max(0,i[0]-x)/P),A+=-P*Math.log(1+Math.max(0,S-i[1])/P)+P*Math.log(1+Math.max(0,i[1]-I)/P)}return[T,A]})}function U3(n){return n}function yP(n){return Math.pow(n,3)}function Du(n){return 1-yP(1-n)}function B3(n){return 3*n*n-2*n*n*n}function G3(n){return n}function k1(n,e,t,i){const r=dt(e)/t[0],s=Bn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function D1(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Nt(i,t/2,e*2)}function W3(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const u=n[0],h=n[n.length-1],f=t?k1(u,t,o,i):u;if(l)return e?D1(r,f,h):Nt(r,h,f);const p=Math.min(f,r),y=Math.floor(s1(n,p,s));return n[y]>f&&y<n.length-1?n[y+1]:n[y]}})}function $3(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,u,h){if(o!==void 0){const f=r?k1(e,r,u,s):e;if(h)return i?D1(o,f,t):Nt(o,t,f);const p=1e-9,y=Math.ceil(Math.log(e/f)/Math.log(n)-p),x=-l*(.5-p)+.5,S=Math.min(f,o),I=Math.floor(Math.log(e/S)/Math.log(n)+x),T=Math.max(y,I),A=e/Math.pow(n,T);return Nt(A,t,f)}})}function uC(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,u){if(s!==void 0){const h=i?k1(n,i,l,r):n;return!t||!u?Nt(s,e,h):D1(s,h,e)}})}function N1(n){if(n!==void 0)return 0}function hC(n){if(n!==void 0)return n}function K3(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function H3(n){const e=Ho(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const X3=42,M1=256,T0=0;class Zr extends cs{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=g1(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Rb(),e.center&&(e.center=Ns(e.center,this.projection_)),e.extent&&(e.extent=Go(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in hr)delete t[l];this.setProperties(t,!0);const i=Y3(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=q3(e),s=i.constraint,o=Z3(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ns(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ns(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&Gg(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],p={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||B3,callback:i};if(f.center&&(p.sourceCenter=o,p.targetCenter=f.center.slice(),o=p.targetCenter),f.zoom!==void 0?(p.sourceResolution=l,p.targetResolution=this.getResolutionForZoom(f.zoom),l=p.targetResolution):f.resolution&&(p.sourceResolution=l,p.targetResolution=f.resolution,l=p.targetResolution),f.rotation!==void 0){p.sourceRotation=u;const y=al(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=u+y,u=p.targetRotation}Q3(p)?p.complete=!0:s+=p.duration,h.push(p)}this.animations_.push(h),this.setHint(Mn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Mn.ANIMATING]>0}getInteracting(){return this.hints_[Mn.INTERACTING]>0}cancelAnimations(){this.setHint(Mn.ANIMATING,-this.hints_[Mn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&Gg(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let f=u.duration>0?h/u.duration:1;f>=1?(u.complete=!0,f=1):s=!1;const p=u.easing(f);if(u.sourceCenter){const y=u.sourceCenter[0],x=u.sourceCenter[1],S=u.targetCenter[0],I=u.targetCenter[1];this.nextCenter_=u.targetCenter;const T=y+p*(S-y),A=x+p*(I-x);this.targetCenter_=[T,A]}if(u.sourceResolution&&u.targetResolution){const y=p===1?u.targetResolution:u.sourceResolution+p*(u.targetResolution-u.sourceResolution);if(u.anchor){const x=this.getViewportSize_(this.getRotation()),S=this.constraints_.resolution(y,0,x,!0);this.targetCenter_=this.calculateCenterZoom(S,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const y=p===1?al(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+p*(u.targetRotation-u.sourceRotation);if(u.anchor){const x=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(x,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Mn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Gg(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],c1(i,e-this.getRotation()),U5(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Iv(e,this.getProjection())}getCenterInternal(){return this.get(hr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return Ab(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();at(t,"The view center is not defined");const i=this.getResolution();at(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return at(r!==void 0,"The view rotation is not defined"),xv(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(hr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Go(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=dt(e)/t[0],r=Bn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(hr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=S0(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=s1(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Nt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Nt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(at(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){at(!Mm(e),"Cannot fit empty extent provided as `geometry`");const r=Go(e,this.getProjection());i=GI(r)}else if(e.getType()==="Circle"){const r=Go(e.getExtent(),this.getProjection());i=GI(r),i.rotate(this.getRotation(),gl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,u=1/0,h=-1/0,f=-1/0;for(let p=0,y=s.length;p<y;p+=o){const x=s[p]*i-s[p+1]*r,S=s[p]*r+s[p+1]*i;l=Math.min(l,x),u=Math.min(u,S),h=Math.max(h,x),f=Math.max(f,S)}return[l,u,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),f=Math.sin(h),p=Math.cos(h),y=gl(l);y[0]+=(r[1]-r[3])/2*u,y[1]+=(r[0]-r[2])/2*u;const x=y[0]*p-y[1]*f,S=y[1]*p+y[0]*f,I=this.getConstrainedCenter([x,S],u),T=t.callback?t.callback:wd;t.duration!==void 0?this.animateInternal({resolution:u,center:I,duration:t.duration,easing:t.easing},T):(this.targetResolution_=u,this.targetCenter_=I,this.applyTargetState_(!1,!0),Gg(T,!0))}centerOn(e,t,i){this.centerOnInternal(Ns(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(S0(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),u=S0(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Iv(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ns(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ns(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ns(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(hr.ROTATION)!==r&&this.set(hr.ROTATION,r),this.get(hr.RESOLUTION)!==o&&(this.set(hr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(hr.CENTER)||!Pp(this.get(hr.CENTER),l))&&this.set(hr.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Pp(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:e,easing:Du,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Mn.INTERACTING,1)}endInteraction(e,t,i){i=i&&Ns(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Mn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Gg(n,e){setTimeout(function(){n(e)},0)}function q3(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return cC(n.extent,n.constrainOnlyCenter,t)}const e=g1(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,cC(t,!1,!1)}return U3}function Y3(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:T0,l=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,p=n.showFullExtent!==void 0?n.showFullExtent:!1,y=g1(n.projection,"EPSG:3857"),x=y.getExtent();let S=n.constrainOnlyCenter,I=n.extent;if(!h&&!I&&y.isGlobal()&&(S=!1,I=x),n.resolutions!==void 0){const T=n.resolutions;t=T[o],i=T[l]!==void 0?T[l]:T[T.length-1],n.constrainResolution?e=W3(T,f,!S&&I,p):e=uC(t,i,f,!S&&I,p)}else{const A=(x?Math.max(dt(x),Bn(x)):360*cu.degrees/y.getMetersPerUnit())/M1/Math.pow(2,T0),P=A/Math.pow(2,28-T0);t=n.maxResolution,t!==void 0?o=0:t=A/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,l):i=A/Math.pow(u,l):i=P),l=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,l-o),n.constrainResolution?e=$3(u,t,i,f,!S&&I,p):e=uC(t,i,f,!S&&I,p)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function Z3(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?H3():t===!1?hC:typeof t=="number"?K3(t):hC}return N1}function Q3(n){return!(n.sourceCenter&&n.targetCenter&&!Pp(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function S0(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-u*o,f=u*s+l*o;return[h,f]}const ht={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class _P extends cs{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[ht.OPACITY]=e.opacity!==void 0?e.opacity:1,at(typeof t[ht.OPACITY]=="number","Layer opacity must be a number"),t[ht.VISIBLE]=e.visible!==void 0?e.visible:!0,t[ht.Z_INDEX]=e.zIndex,t[ht.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[ht.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[ht.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[ht.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Nt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return tt()}getLayerStatesArray(e){return tt()}getExtent(){return this.get(ht.EXTENT)}getMaxResolution(){return this.get(ht.MAX_RESOLUTION)}getMinResolution(){return this.get(ht.MIN_RESOLUTION)}getMinZoom(){return this.get(ht.MIN_ZOOM)}getMaxZoom(){return this.get(ht.MAX_ZOOM)}getOpacity(){return this.get(ht.OPACITY)}getSourceState(){return tt()}getVisible(){return this.get(ht.VISIBLE)}getZIndex(){return this.get(ht.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(ht.EXTENT,e)}setMaxResolution(e){this.set(ht.MAX_RESOLUTION,e)}setMinResolution(e){this.set(ht.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(ht.MAX_ZOOM,e)}setMinZoom(e){this.set(ht.MIN_ZOOM,e)}setOpacity(e){at(typeof e=="number","Layer opacity must be a number"),this.set(ht.OPACITY,e)}setVisible(e){this.set(ht.VISIBLE,e)}setZIndex(e){this.set(ht.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Gm extends _P{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(ht.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(ht.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(At(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=nt(e,Ge.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Zr?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return L1(r,t.viewState)&&(!s||ri(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof Zr?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(ht.MAP,e)}getMapInternal(){return this.get(ht.MAP)}setMap(e){this.mapPrecomposeKey_&&(At(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(At(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=nt(e,Xi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=nt(this,Ge.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);at(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(ht.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function L1(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const dC={RENDER_ORDER:"renderOrder"};class vP extends Gm{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(dC.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new nP(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(dC.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?rP:e;const t=J3(e);this.styleFunction_=e===null?void 0:L4(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function J3(n){if(n===void 0)return rP;if(!n)return null;if(typeof n=="function"||n instanceof Zi)return n;if(!Array.isArray(n))return sC([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Zi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Zi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return A3(r)}return sC(n)}class O1 extends vP{constructor(e){super(e)}createRenderer(){return new n3(this)}}const bo={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Vo extends Zs{constructor(e,t){super(e),this.layer=t}}const I0={LAYERS:"layers"};class Nu extends _P{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(I0.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Hi(i.slice(),{unique:!0}):at(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Hi(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(At),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(nt(e,ei.ADD,this.handleLayersAdd_,this),nt(e,ei.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(At);Jd(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new Vo(bo.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[nt(e,su.PROPERTYCHANGE,this.handleLayerChange_,this),nt(e,Ge.CHANGE,this.handleLayerChange_,this)];e instanceof Nu&&t.push(nt(e,bo.ADDLAYER,this.handleLayerGroupAdd_,this),nt(e,bo.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[it(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Vo(bo.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Vo(bo.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Vo(bo.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=it(t);this.listenerKeys_[i].forEach(At),delete this.listenerKeys_[i],this.dispatchEvent(new Vo(bo.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(I0.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Vo(bo.REMOVELAYER,i[r]))}this.set(I0.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=ol(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}}const Ce={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class F1 extends bm{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Ge.CHANGE)}release(){this.setState(Ce.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Ce.EMPTY){if(this.state!==Ce.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){tt()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:yP(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Nv(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const e6=new Error("disposed"),t6=[256,256];class fC extends F1{constructor(e){const t=Ce.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Nv(this.data_);return e?[e.width,e.height]:t6}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Ce.IDLE&&this.state!==Ce.ERROR)return;this.state=Ce.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Ce.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Ce.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(e6),this.controller_=null),super.disposeInternal()}}class xP extends F1{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Ti?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Ce.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Ce.ERROR,this.unlistenImage_(),this.image_=n6(),this.changed()}handleImageLoad_(){if(Ti)this.state=Ce.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Ce.LOADED:this.state=Ce.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Ce.ERROR&&(this.state=Ce.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ce.IDLE&&(this.state=Ce.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Yj(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function n6(){const n=Jt(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let C0;const Zc=[];function gC(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function R0(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function i6(){if(C0===void 0){const n=Jt(6,6,Zc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",gC(n,4,5,4,0),gC(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;C0=R0(e,0)||R0(e,4)||R0(e,8),Vm(n),Zc.push(n.canvas)}return C0}function pC(n,e,t,i){const r=Fm(t,e,n);let s=Np(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const u=n.getExtent();if(!u||lu(u,r)){const h=Np(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function r6(n,e,t,i){const r=gl(t);let s=pC(n,e,r,i);return(!isFinite(s)||s<=0)&&mb(t,function(o){return s=pC(n,e,o,i),isFinite(s)&&s>0}),s}function s6(n,e,t,i,r,s,o,l,u,h,f,p,y,x){const S=Jt(Math.round(t*n),Math.round(t*e),Zc);if(p||(S.imageSmoothingEnabled=!1),u.length===0)return S.canvas;S.scale(t,t);function I(L){return Math.round(L*t)/t}S.globalCompositeOperation="lighter";const T=Qi();u.forEach(function(L,j,D){M5(T,L.extent)});let A;const P=t/i,N=(p?1:1+Math.pow(2,-24))/P;A=Jt(Math.round(dt(T)*P),Math.round(Bn(T)*P),Zc),p||(A.imageSmoothingEnabled=!1),u.forEach(function(L,j,D){if(L.image.width>0&&L.image.height>0){if(L.clipExtent){A.save();const B=(L.clipExtent[0]-T[0])*P,O=-(L.clipExtent[3]-T[3])*P,le=dt(L.clipExtent)*P,pe=Bn(L.clipExtent)*P;A.rect(p?B:Math.round(B),p?O:Math.round(O),p?le:Math.round(B+le)-Math.round(B),p?pe:Math.round(O+pe)-Math.round(O)),A.clip()}const b=(L.extent[0]-T[0])*P,M=-(L.extent[3]-T[3])*P,V=dt(L.extent)*P,z=Bn(L.extent)*P;A.drawImage(L.image,h,h,L.image.width-2*h,L.image.height-2*h,p?b:Math.round(b),p?M:Math.round(M),p?V:Math.round(b+V)-Math.round(b),p?z:Math.round(M+z)-Math.round(M)),L.clipExtent&&A.restore()}});const R=kl(o);return l.getTriangles().forEach(function(L,j,D){const b=L.source,M=L.target;let V=b[0][0],z=b[0][1],B=b[1][0],O=b[1][1],le=b[2][0],pe=b[2][1];const ge=I((M[0][0]-R[0])/s),ue=I(-(M[0][1]-R[1])/s),Q=I((M[1][0]-R[0])/s),se=I(-(M[1][1]-R[1])/s),ne=I((M[2][0]-R[0])/s),W=I(-(M[2][1]-R[1])/s),$=V,ie=z;V=0,z=0,B-=$,O-=ie,le-=$,pe-=ie;const me=[[B,O,0,0,Q-ge],[le,pe,0,0,ne-ge],[0,0,B,O,se-ue],[0,0,le,pe,W-ue]],xe=z5(me);if(!xe)return;if(S.save(),S.beginPath(),i6()||!p){S.moveTo(Q,se);const Me=4,Ve=ge-Q,We=ue-se;for(let lt=0;lt<Me;lt++)S.lineTo(Q+I((lt+1)*Ve/Me),se+I(lt*We/(Me-1))),lt!=Me-1&&S.lineTo(Q+I((lt+1)*Ve/Me),se+I((lt+1)*We/(Me-1)));S.lineTo(ne,W)}else S.moveTo(Q,se),S.lineTo(ge,ue),S.lineTo(ne,W);S.clip(),S.transform(xe[0],xe[2],xe[1],xe[3],ge,ue),S.translate(T[0]-$,T[3]-ie);let ke;if(A)ke=A.canvas,S.scale(N,-N);else{const Me=u[0],Ve=Me.extent;ke=Me.image,S.scale(dt(Ve)/ke.width,-Bn(Ve)/ke.height)}S.drawImage(ke,0,0),S.restore()}),A&&(Vm(A),Zc.push(A.canvas)),f&&(S.save(),S.globalCompositeOperation="source-over",S.strokeStyle="black",S.lineWidth=1,l.getTriangles().forEach(function(L,j,D){const b=L.target,M=(b[0][0]-R[0])/s,V=-(b[0][1]-R[1])/s,z=(b[1][0]-R[0])/s,B=-(b[1][1]-R[1])/s,O=(b[2][0]-R[0])/s,le=-(b[2][1]-R[1])/s;S.beginPath(),S.moveTo(z,B),S.lineTo(M,V),S.lineTo(O,le),S.closePath(),S.stroke()}),S.restore()),S.canvas}const o6=10,mC=.25;class a6{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let u={};const h=l?yj(N=>un(l,Fm(N,this.targetProj_,this.sourceProj_))):Mp(this.targetProj_,this.sourceProj_);this.transformInv_=function(N){const R=N[0]+"/"+N[1];return u[R]||(u[R]=h(N)),u[R]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&dt(r)>=dt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?dt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?dt(this.targetProj_.getExtent()):null;const f=kl(i),p=Nm(i),y=Dm(i),x=km(i),S=this.transformInv_(f),I=this.transformInv_(p),T=this.transformInv_(y),A=this.transformInv_(x),P=o6+(o?Math.max(0,Math.ceil(Math.log2(vv(i)/(o*o*256*256)))):0);if(this.addQuad_(f,p,y,x,S,I,T,A,P),this.wrapsXInSource_){let N=1/0;this.triangles_.forEach(function(R,L,j){N=Math.min(N,R.source[0][0],R.source[1][0],R.source[2][0])}),this.triangles_.forEach(R=>{if(Math.max(R.source[0][0],R.source[1][0],R.source[2][0])-N>this.sourceWorldWidth_/2){const L=[[R.source[0][0],R.source[0][1]],[R.source[1][0],R.source[1][1]],[R.source[2][0],R.source[2][1]]];L[0][0]-N>this.sourceWorldWidth_/2&&(L[0][0]-=this.sourceWorldWidth_),L[1][0]-N>this.sourceWorldWidth_/2&&(L[1][0]-=this.sourceWorldWidth_),L[2][0]-N>this.sourceWorldWidth_/2&&(L[2][0]-=this.sourceWorldWidth_);const j=Math.min(L[0][0],L[1][0],L[2][0]);Math.max(L[0][0],L[1][0],L[2][0])-j<this.sourceWorldWidth_/2&&(R.source=L)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,u,h){const f=mI([s,o,l,u]),p=this.sourceWorldWidth_?dt(f)/this.sourceWorldWidth_:null,y=this.sourceWorldWidth_,x=this.sourceProj_.canWrapX()&&p>.5&&p<1;let S=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const T=mI([e,t,i,r]);S=dt(T)/this.targetWorldWidth_>mC||S}!x&&this.sourceProj_.isGlobal()&&p&&(S=p>mC||S)}if(!S&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!ri(f,this.maxSourceExtent_))return;let I=0;if(!S&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)S=!0;else if(I=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),I!=1&&I!=2&&I!=4&&I!=8)return}if(h>0){if(!S){const T=[(e[0]+i[0])/2,(e[1]+i[1])/2],A=this.transformInv_(T);let P;x?P=(al(s[0],y)+al(l[0],y))/2-al(A[0],y):P=(s[0]+l[0])/2-A[0];const N=(s[1]+l[1])/2-A[1];S=P*P+N*N>this.errorThresholdSquared_}if(S){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const T=[(t[0]+i[0])/2,(t[1]+i[1])/2],A=this.transformInv_(T),P=[(r[0]+e[0])/2,(r[1]+e[1])/2],N=this.transformInv_(P);this.addQuad_(e,t,T,P,s,o,A,N,h-1),this.addQuad_(P,T,i,r,N,A,l,u,h-1)}else{const T=[(e[0]+t[0])/2,(e[1]+t[1])/2],A=this.transformInv_(T),P=[(i[0]+r[0])/2,(i[1]+r[1])/2],N=this.transformInv_(P);this.addQuad_(e,T,P,r,s,A,N,u,h-1),this.addQuad_(T,t,i,P,A,o,l,N,h-1)}return}}if(x){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(I&11)==0&&this.addTriangle_(e,i,r,s,l,u),(I&14)==0&&this.addTriangle_(e,i,t,s,l,o),I&&((I&13)==0&&this.addTriangle_(t,r,e,o,u,s),(I&7)==0&&this.addTriangle_(t,r,i,o,u,l))}calculateSourceExtent(){const e=Qi();return this.triangles_.forEach(function(t,i,r){const s=t.source;ed(e,s[0]),ed(e,s[1]),ed(e,s[2])}),e}getTriangles(){return this.triangles_}}const l6=.5;class wP extends F1{constructor(e,t,i,r,s,o,l,u,h,f,p,y){super(s,Ce.IDLE,y),this.renderEdges_=p!==void 0?p:!1,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const x=r.getTileCoordExtent(this.wrappedTileCoord_),S=this.targetTileGrid_.getExtent();let I=this.sourceTileGrid_.getExtent();const T=S?ol(x,S):x;if(vv(T)===0){this.state=Ce.EMPTY;return}const A=e.getExtent();A&&(I?I=ol(I,A):I=A);const P=r.getResolution(this.wrappedTileCoord_[0]),N=r6(e,i,T,P);if(!isFinite(N)||N<=0){this.state=Ce.EMPTY;return}const R=f!==void 0?f:l6;if(this.triangulation_=new a6(e,i,T,I,N*R,P),this.triangulation_.getTriangles().length===0){this.state=Ce.EMPTY;return}this.sourceZ_=t.getZForResolution(N);let L=this.triangulation_.calculateSourceExtent();if(I&&(e.canWrapX()?(L[1]=Nt(L[1],I[1],I[3]),L[3]=Nt(L[3],I[1],I[3])):L=ol(L,I)),!vv(L))this.state=Ce.EMPTY;else{let j=0,D=0;e.canWrapX()&&(j=dt(A),D=Math.floor((L[0]-A[0])/j)),vb(L.slice(),e,!0).forEach(M=>{const V=t.getTileRangeForExtentAndZ(M,this.sourceZ_);for(let z=V.minX;z<=V.maxX;z++)for(let B=V.minY;B<=V.maxY;B++){const O=h(this.sourceZ_,z,B,l);if(O){const le=D*j;this.sourceTiles_.push({tile:O,offset:le})}}++D}),this.sourceTiles_.length===0&&(this.state=Ce.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Ce.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Ce.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=s6(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Ce.LOADED}this.changed()}load(){if(this.state==Ce.IDLE){this.state=Ce.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Ce.IDLE||i==Ce.LOADING){e++;const r=nt(t,Ge.CHANGE,s=>{const o=t.getState();(o==Ce.LOADED||o==Ce.ERROR||o==Ce.EMPTY)&&(At(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Ce.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(At),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Vm(this.canvas_.getContext("2d")),Zc.push(this.canvas_),this.canvas_=null),super.release()}}class V1{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Tc(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new V1(n,e,t,i)}class yC{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Rm&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return at(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return at(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){at(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function Bp(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function c6(n,e,t){return n+"/"+e+"/"+t}function ap(n,e,t,i,r){return`${it(n)},${e},${c6(t,i,r)}`}function u6(n){return h6(n[0],n[1],n[2])}function h6(n,e,t){return(e<<n)+t}function d6(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function A0(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function f6(n,e,t){const i=n[t];return i?i.delete(e):!1}function _C(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=ol(e,Go(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=ol(e,r))}return e}class g6 extends cP{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Qi(),this.tempTileRange_=new V1(0,0,0,0),this.tempTileCoord_=Bp(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new yC(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new yC(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),u=ap(l,l.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const f=r.viewState.projection,p=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!p||op(p,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=un(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!lu(s,r))return null;const o=t.viewState,l=i.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const p=u.getTileCoordForCoordAndZ(r,f),y=this.getTile(f,p[1],p[2],t);if(!y||y.getState()!==Ce.LOADED)continue;const x=u.getOrigin(f),S=oi(u.getTileSize(f)),I=u.getResolution(f);let T;if(y instanceof xP||y instanceof wP)T=y.getImage();else if(y instanceof fC){if(T=Nv(y.getData()),!T)continue}else continue;const A=Math.floor(h*((r[0]-x[0])/I-p[1]*S[0])),P=Math.floor(h*((x[1]-r[1])/I-p[2]*S[1])),N=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(T,A+N,P+N)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(o.projection),f=it(u);f in e.wantedTiles||(e.wantedTiles[f]={});const p=e.wantedTiles[f],y=l.getMapInternal(),x=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),y?y.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),S=o.rotation,I=S?yb(o.center,o.resolution,S,e.size):void 0;for(let T=i;T>=x;--T){const A=h.getTileRangeForExtentAndZ(t,T,this.tempTileRange_),P=h.getResolution(T);for(let N=A.minX;N<=A.maxX;++N)for(let R=A.minY;R<=A.maxY;++R){if(S&&!h.tileCoordIntersectsViewport([T,N,R],I))continue;const L=this.getTile(T,N,R,e);if(!L||!A0(r,L,T))continue;const D=L.getKey();if(p[D]=!0,L.getState()===Ce.IDLE&&!e.tileQueue.isKeyQueued(D)){const b=Bp(T,N,R,this.tempTileCoord_);e.tileQueue.enqueue([L,f,h.getTileCoordCenter(b),P])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let u=0;u<l.length;++u){const h=ap(this.getLayer().getSource(),l[u],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Ce.LOADED)return f.endTransition(it(this)),A0(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let p=s.minY;p<=s.maxY;++p){const y=ap(u,h,i,f,p);let x=!1;if(l.containsKey(y)){const S=l.peek(y);S.getState()===Ce.LOADED&&(A0(r,S,i),x=!0)}x||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,u=e.pixelRatio,h=this.getLayer(),f=h.getSource(),p=f.getTileGridForProjection(s),y=p.getZForResolution(o,f.zDirection),x=p.getResolution(y),S=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==S&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=S):this.renderedSourceKey_=S;let I=e.extent;const T=f.getTilePixelRatio(u);this.prepareContainer(e,t);const A=this.context.canvas.width,P=this.context.canvas.height,N=i.extent&&Go(i.extent);N&&(I=ol(I,Go(i.extent)));const R=x*A/2/T,L=x*P/2/T,j=[l[0]-R,l[1]-L,l[0]+R,l[1]+L],D={};this.renderedTiles.length=0;const b=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const Q=p.getZForResolution(r.nextResolution,f.zDirection),se=_C(e,e.nextExtent);this.enqueueTiles(e,se,Q,D,b)}const M=_C(e,I);if(this.enqueueTiles(e,M,y,D,0),b>0&&setTimeout(()=>{this.enqueueTiles(e,M,y-1,D,b-1)},0),!(y in D))return this.container;const V=it(this),z=e.time;for(const Q of D[y]){const se=Q.getState();if(se===Ce.EMPTY)continue;const ne=Q.tileCoord;if(se===Ce.LOADED&&Q.getAlpha(V,z)===1){Q.endTransition(V);continue}if(se!==Ce.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,D)){f6(D,Q,y),e.animate=!0;continue}if(this.findAltTiles_(p,ne,y+1,D))continue;const ie=p.getMinZoom();for(let me=y-1;me>=ie&&!this.findAltTiles_(p,ne,me,D);--me);}const B=x/o*u/T,O=this.getRenderContext(e);Hs(this.tempTransform,A/2,P/2,B,B,0,-A/2,-P/2),i.extent&&this.clipUnrotated(O,e,N),f.getInterpolate()||(O.imageSmoothingEnabled=!1),this.preRender(O,e);const le=Object.keys(D).map(Number);le.sort(Bs);let pe;const ge=[],ue=[];for(let Q=le.length-1;Q>=0;--Q){const se=le[Q],ne=f.getTilePixelSize(se,u,s),$=p.getResolution(se)/x,ie=ne[0]*$*B,me=ne[1]*$*B,xe=p.getTileCoordForCoordAndZ(kl(j),se),ke=p.getTileCoordExtent(xe),Me=un(this.tempTransform,[T*(ke[0]-j[0])/x,T*(j[3]-ke[3])/x]),Ve=T*f.getGutterForProjection(s);for(const We of D[se]){if(We.getState()!==Ce.LOADED)continue;const lt=We.tileCoord,er=xe[1]-lt[1],fs=Math.round(Me[0]-(er-1)*ie),Wn=xe[2]-lt[2],$n=Math.round(Me[1]-(Wn-1)*me),hn=Math.round(Me[0]-er*ie),dn=Math.round(Me[1]-Wn*me),Kn=fs-hn,bi=$n-dn,_t=le.length===1;let ct=!1;pe=[hn,dn,hn+Kn,dn,hn+Kn,dn+bi,hn,dn+bi];for(let nn=0,Pi=ge.length;nn<Pi;++nn)if(!_t&&se<ue[nn]){const It=ge[nn];ri([hn,dn,hn+Kn,dn+bi],[It[0],It[3],It[4],It[7]])&&(ct||(O.save(),ct=!0),O.beginPath(),O.moveTo(pe[0],pe[1]),O.lineTo(pe[2],pe[3]),O.lineTo(pe[4],pe[5]),O.lineTo(pe[6],pe[7]),O.moveTo(It[6],It[7]),O.lineTo(It[4],It[5]),O.lineTo(It[2],It[3]),O.lineTo(It[0],It[1]),O.clip())}ge.push(pe),ue.push(se),this.drawTile(We,e,hn,dn,Kn,bi,Ve,_t),ct&&O.restore(),this.renderedTiles.unshift(We),this.updateUsedTiles(e.usedTiles,f,We)}}if(this.renderedResolution=x,this.extentChanged=!this.renderedExtent_||!Ed(this.renderedExtent_,j),this.renderedExtent_=j,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&O.restore(),O.imageSmoothingEnabled=!0,this.renderComplete){const Q=(se,ne)=>{const W=it(f),$=ne.wantedTiles[W],ie=$?Object.keys($).length:0;this.updateCacheSize(ie),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(Q)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,u){let h;if(e instanceof fC){if(h=Nv(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),p=it(this),y=t.layerStatesArray[t.layerIndex],x=y.opacity*(u?e.getAlpha(p,t.time):1),S=x!==f.globalAlpha;S&&(f.save(),f.globalAlpha=x),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),S&&f.restore(),x!==y.opacity?t.animate=!0:u&&e.endTransition(p)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=it(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Wg={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class p6 extends Gm{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Wg.PRELOAD)}setPreload(e){this.set(Wg.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Wg.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Wg.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class b0 extends p6{constructor(e){super(e)}createRenderer(){return new g6(this,{cacheSize:this.getCacheSize()})}}const Sc=[0,0,0],Po=5;class EP{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,at(b5(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,at(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=kl(i)),at(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,at(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:M1,at(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new V1(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,u=r.maxY;l<=u;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Tc(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Tc(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Tc(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),f=Math.floor(o*u);if(t<r)return Tc(h,h,f,f,i);const p=Math.floor(u*(s+1))-1,y=Math.floor(u*(o+1))-1;return Tc(h,p,f,y,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Sc);const r=Sc[1],s=Sc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Sc);const o=Sc[1],l=Sc[2];return Tc(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=oi(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=oi(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=l+s[1]*r;return ta(o,l,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),u=this.getOrigin(o),h=oi(this.getTileSize(o),this.tmpSize_);let f=l*(e-u[0])/i/h[0],p=l*(u[1]-t)/i/h[1];return r?(f=Lg(f,Po)-1,p=Lg(p,Po)-1):(f=Mg(f,Po),p=Mg(p,Po)),Bp(o,f,p,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),u=oi(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/u[0],f=(o[1]-t)/l/u[1];return r?(h=Lg(h,Po)-1,f=Lg(f,Po)-1):(h=Mg(h,Po),f=Mg(f,Po)),Bp(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=s1(this.resolutions_,e,t||0);return Nt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return Fb(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function TP(n){let e=n.getDefaultTileGrid();return e||(e=v6(n),n.setDefaultTileGrid(e)),e}function m6(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=j1(t);if(!lu(s,r)){const o=dt(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function y6(n,e,t,i){i=i!==void 0?i:"top-left";const r=SP(n,e,t);return new EP({extent:n,origin:O5(n,i),resolutions:r,tileSize:t})}function _6(n){const e=n||{},t=e.extent||ai("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:SP(t,e.maxZoom,e.tileSize,e.maxResolution)};return new EP(i)}function SP(n,e,t,i){e=e!==void 0?e:X3,t=oi(t!==void 0?t:M1);const r=Bn(n),s=dt(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let u=0;u<o;++u)l[u]=i/Math.pow(2,u);return l}function v6(n,e,t,i){const r=j1(n);return y6(r,e,t,i)}function j1(n){n=ai(n);let e=n.getExtent();if(!e){const t=180*cu.degrees/n.getMetersPerUnit();e=ta(-t,-t,t,t)}return e}function TX(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const x6=/\{z\}/g,w6=/\{x\}/g,E6=/\{y\}/g,T6=/\{-y\}/g;function S6(n,e,t,i,r){return n.replace(x6,e.toString()).replace(w6,t.toString()).replace(E6,i.toString()).replace(T6,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function I6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function C6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return S6(n,o,t[1],t[2],s)})}function R6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=C6(n[r],e);return A6(i)}function A6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=u6(e),s=al(r,n.length);return n[s](e,t,i)})}class b6 extends iP{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&oi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||it(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return tt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:TP(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=oi(r.getTileSize(e),this.tmpSize);return s==1?o:M4(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=m6(r,e,i)),d6(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class P6 extends Zs{constructor(e,t){super(e),this.tile=t}}const P0={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class z1 extends b6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===z1.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=it(t),r=t.getState();let s;r==Ce.LOADING?(this.tileLoadingKeys_[i]=!0,s=P0.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Ce.ERROR?P0.TILELOADERROR:r==Ce.LOADED?P0.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new P6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=I6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(R6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class k6 extends z1{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:IP,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:xP,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!op(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||op(t,e)))return this.tileGrid;const i=it(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=TP(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(l,h!==void 0?Ce.IDLE:Ce.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(Ge.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||op(l,s))return this.getTileInternal(e,t,i,r,l||s);const u=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),p=this.getTileGridForProjection(s),y=this.getTileCoordForTileUrlFunction(u,s),x=new wP(l,f,s,p,u,y,this.getTilePixelRatio(r),this.getGutter(),(S,I,T,A)=>this.getTileInternal(S,I,T,A,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return x.key=h,x}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),u=ap(this,l,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,l);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=ai(e);if(i){const r=it(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function IP(n,e){if(Ti){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Mv extends k6{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:_6({extent:j1(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const D6="modulepreload",N6=function(n){return"/visapp/"+n},vC={},$g=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=N6(h),h in vC)return;vC[h]=!0;const f=h.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":D6,f||(y.as="script"),y.crossOrigin="",y.href=h,l&&y.setAttribute("nonce",l),document.head.appendChild(y),f)return new Promise((x,S)=>{y.addEventListener("load",x),y.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},M6='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class L6 extends Mv{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[M6];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Ti&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||IP)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const Gp=1/0;class O6{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Jd(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){at(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=Gp?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[u]?h:u;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,u;for(l=0;l<s;++l)o=t[l],u=e(o),u==Gp?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class F6 extends O6{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Ge.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Ce.LOADED||i===Ce.ERROR||i===Ce.EMPTY){i!==Ce.ERROR&&t.removeEventListener(Ge.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Ce.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function V6(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Gp;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Lc extends Zs{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Oo extends Lc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Lt={SINGLECLICK:"singleclick",CLICK:Ge.CLICK,DBLCLICK:Ge.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Lv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class j6 extends bm{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=nt(i,Lv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=nt(i,Lv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Ge.TOUCHMOVE,this.boundHandleTouchMove_,Ub?{passive:!1}:!1)}emulateClick_(e){let t=new Oo(Lt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Oo(Lt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Oo(Lt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Lt.POINTERUP||t.type==Lt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Lt.POINTERDOWN||t.type==Lt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Oo(Lt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(At),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Oo(Lt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(nt(i,Lt.POINTERMOVE,this.handlePointerMove_,this),nt(i,Lt.POINTERUP,this.handlePointerUp_,this),nt(this.element_,Lt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(nt(this.element_.getRootNode(),Lt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Oo(Lt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Oo(Lt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(At(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Ge.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(At(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(At),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Fo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Dn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Wm extends cs{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)At(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==wd&&this.listenerKeys.push(nt(e,Fo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class z6 extends Wm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(Ge.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+rf+" "+S1+(this.collapsed_&&this.collapsible_?" "+OI:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>P5(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!aa(t,this.renderedAttributions_)){jj(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(OI),this.collapsed_?MI(this.collapseLabel_,this.label_):MI(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class U6 extends Wm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Ge.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+rf+" "+S1,u=this.element;u.className=l,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Vg)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Du}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Vg);!s&&i===0?this.element.classList.add(Vg):s&&i!==0&&this.element.classList.remove(Vg)}this.label_.style.transform=r}this.rotation_=i}}class B6 extends Wm{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Ge.CLICK,this.handleClick_.bind(this,i),!1);const p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=h,p.appendChild(typeof l=="string"?document.createTextNode(l):l),p.addEventListener(Ge.CLICK,this.handleClick_.bind(this,-i),!1);const y=t+" "+rf+" "+S1,x=this.element;x.className=y,x.appendChild(f),x.appendChild(p),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Du})):i.setZoom(s)}}}function G6(n){n=n||{};const e=new Hi;return(n.zoom===void 0||n.zoom)&&e.push(new B6(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new U6(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new z6(n.attributionOptions)),e}class W6{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const xC={ACTIVE:"active"};class lf extends cs{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(xC.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(xC.ACTIVE,e)}setMap(e){this.map_=e}}function $6(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:G3,center:n.getConstrainedCenter(r)})}}function U1(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Du})}class K6 extends lf{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Lt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();U1(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function Ov(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const H6=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},X6=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},CP=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?X6(n):!0},q6=xd,RP=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(Fj&&jb&&e.ctrlKey)},AP=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Y6=function(n){const e=n.originalEvent;return jb?e.metaKey:e.ctrlKey},Z6=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},bP=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},k0=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},Q6=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class cf extends lf{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Lt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Lt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Lt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Lt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function B1(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class J6 extends cf{constructor(e){super({stopDown:Am}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Ov(AP,Q6);this.condition_=e.onFocusOnly?Ov(CP,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(B1(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();B5(s,l.getResolution()),c1(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:Du})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class ez extends cf{constructor(e){e=e||{},super({stopDown:Am}),this.condition_=e.condition?e.condition:H6,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!k0(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===N1)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return k0(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return k0(e)&&RP(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class tz extends Rm{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new bd([r])}getGeometry(){return this.geometry_}}const Ic={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ph extends Zs{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class nz extends cf{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new tz(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??RP,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ph(Ic.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Ph(t?Ic.BOXEND:Ic.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ph(Ic.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Ic.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Ic.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class iz extends nz{constructor(e){e=e||{};const t=e.condition?e.condition:Z6;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:Du})}}const Oa={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class rz extends lf{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return AP(t)&&bP(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Ge.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Oa.DOWN||r==Oa.LEFT||r==Oa.RIGHT||r==Oa.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==Oa.DOWN?h=-l:r==Oa.LEFT?u=-l:r==Oa.RIGHT?u=l:h=l;const f=[u,h];c1(f,o.getRotation()),$6(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class sz extends lf{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!Y6(t)&&bP(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Ge.KEYDOWN||e.type==Ge.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();U1(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const oz=40,az=300;class lz extends lf{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:q6;this.condition_=e.onFocusOnly?Ov(CP,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Ge.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=oz;break;case WheelEvent.DOM_DELTA_PAGE:s*=az;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Nt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),U1(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class cz extends cf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Am),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==N1&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(B1(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class uz extends cf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Am),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(B1(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function hz(n){n=n||{};const e=new Hi,t=new W6(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new ez),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new K6({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new J6({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new cz),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new uz({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new rz),e.push(new sz({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new lz({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new iz({duration:n.zoomDuration})),e}class dz extends Rm{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){tt()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Hs(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),bb(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,u){let h;const f=t.viewState;function p(R,L,j,D){return s.call(o,L,R?j:null,D)}const y=f.projection,x=xb(e.slice(),y),S=[[0,0]];if(y.canWrapX()&&r){const R=y.getExtent(),L=dt(R);S.push([-L,0],[L,0])}const I=t.layerStatesArray,T=I.length,A=[],P=[];for(let R=0;R<S.length;R++)for(let L=T-1;L>=0;--L){const j=I[L],D=j.layer;if(D.hasRenderer()&&L1(j,f)&&l.call(u,D)){const b=D.getRenderer(),M=D.getSource();if(b&&M){const V=M.getWrapX()?x:e,z=p.bind(null,j.managed);P[0]=V[0]+S[R][0],P[1]=V[1]+S[R][1],h=b.forEachFeatureAtCoordinate(P,t,i,z,A)}if(h)return h}}if(A.length===0)return;const N=1/A.length;return A.forEach((R,L)=>R.distanceSq+=L*N),A.sort((R,L)=>R.distanceSq-L.distanceSq),A.some(R=>h=R.callback(R.feature,R.layer,R.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,xd,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){tt()}scheduleExpireIconCache(e){qi.canExpireCache()&&e.postRenderFunctions.push(fz)}}function fz(n,e){qi.expire()}class gz extends dz{constructor(e){super(e),this.fontChangeListenerKey_=nt(Dc,su.PROPERTYCHANGE,e.redrawText,e),this.element_=Ti?Bb():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=rf+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new lP(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){At(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Xi.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof vP&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const p=t[h];e.layerIndex=h;const y=p.layer,x=y.getSourceState();if(!L1(p,r)||x!="ready"&&x!="undefined"){y.unrender();continue}const S=y.render(e,o);S&&(S!==o&&(this.children_.push(S),o=S),s.push(p))}this.declutter(e,s),zj(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Wo(u)){const h=u.getContext("2d");for(const f of this.children_){const p=f.firstElementChild||f,y=f.style.backgroundColor;if(y&&(!Wo(p)||p.width>0)&&(h.fillStyle=y,h.fillRect(0,0,u.width,u.height)),Wo(p)&&p.width>0){const x=f.style.opacity||p.style.opacity;h.globalAlpha=x===""?1:Number(x);const S=p.style.transform;if(S)h.setTransform(...Cv(S));else{const I=parseFloat(p.style.width)/p.width,T=parseFloat(p.style.height)/p.height;h.setTransform(I,0,0,T,0,0)}h.drawImage(p,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Xi.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function PP(n){if(n instanceof Gm){n.setMapInternal(null);return}n instanceof Nu&&n.getLayers().forEach(PP)}function kP(n,e){if(n instanceof Gm){n.setMapInternal(e);return}if(n instanceof Nu){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)kP(t[i],e)}}let pz=class extends cs{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=mz(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:Vj,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Er(),this.pixelToCoordinateTransform_=Er(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ti||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ti||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ti?new Hi:G6()),this.interactions=t.interactions||(Ti?new Hi:hz({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new F6(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Dn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Dn.VIEW,this.handleViewChanged_),this.addChangeListener(Dn.SIZE,this.handleSizeChanged_),this.addChangeListener(Dn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Zr)&&e.view.then(function(r){i.setView(new Zr(r))}),this.controls.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(ei.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(ei.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){kP(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:xd,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof Nu?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:xd,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(Dn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Iv(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?un(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Dn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Hi){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ns(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?un(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Dn.SIZE)}getView(){return this.get(Dn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return V6(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Oo(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Lv.POINTERDOWN||i===Ge.WHEEL||i===Ge.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Mn.ANIMATING]||o[Mn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Xi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Xi.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Lc(Fo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Lc(Fo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)At(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Ge.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Ge.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Wo(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Wo(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new gz(this)),!Wo(t)){this.mapBrowserEventHandler_=new j6(this,this.moveTolerance_);for(const r in Lt)this.mapBrowserEventHandler_.addEventListener(Lt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Ge.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Ge.WHEEL,this.boundHandleBrowserEvent_,Ub?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[nt(i,Ge.KEYDOWN,this.handleBrowserEvent,this),nt(i,Ge.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(At(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(At(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=nt(e,su.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=nt(e,Ge.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(At),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Vo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[nt(e,su.PROPERTYCHANGE,this.render,this),nt(e,Ge.CHANGE,this.render,this),nt(e,"addlayer",this.handleLayerAdd_,this),nt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){PP(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&XI(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:xv(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:it(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=xv(l.nextCenter,l.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Mm(this.previousExtent_)&&!Ed(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Lc(Fo.MOVESTART,this,r)),this.previousExtent_=Pm(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Mn.ANIMATING]&&!s.viewHints[Mn.INTERACTING]&&!Ed(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Lc(Fo.MOVEEND,this,s)),hb(s.extent,this.previousExtent_))),this.dispatchEvent(new Lc(Fo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Fo.LOADSTART)||this.hasListener(Fo.LOADEND)||this.hasListener(Xi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Vo("removelayer",t)),this.set(Dn.LAYERGROUP,e)}setSize(e){this.set(Dn.SIZE,e)}setTarget(e){this.set(Dn.TARGET,e)}setView(e){if(!e||e instanceof Zr){this.set(Dn.VIEW,e);return}this.set(Dn.VIEW,new Zr);const t=this;e.then(function(i){t.setView(new Zr(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Wo(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!XI(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&wb("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!aa(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function mz(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Nu({layers:n.layers});t[Dn.LAYERGROUP]=i,t[Dn.TARGET]=n.target,t[Dn.VIEW]=n.view instanceof Zr?n.view:new Zr;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Hi(n.controls.slice()):(at(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Hi(n.interactions.slice()):(at(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Hi(n.overlays.slice()):(at(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Hi,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const D0="units",yz=[1,2,5],kh=25.4/.28;class _z extends Wm{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+rf,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(D0,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(D0)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(D0,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Np(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||kh)/kh,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||kh)/kh:void 0;let h=l*o,f="";if(r=="degrees"){const N=cu.degrees;h*=N,h<N/60?(f="",o*=3600):h<N?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let p=3*Math.floor(Math.log(l*o)/Math.log(10)),y,x,S,I=0,T,A;for(;;){S=Math.floor(p/3);const N=Math.pow(10,S);if(y=yz[(p%3+3)%3]*N,x=Math.round(y/o),isNaN(x)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&x>=u){y=I,x=T,S=A;break}else if(x>=l)break;I=y,T=x,A=S,++p}const P=this.scaleBar_?this.createScaleBar(x,y,f):y.toFixed(S<0?-S:0)+" "+f;this.renderedHTML_!=P&&(this.innerElement_.innerHTML=P,this.renderedHTML_=P),this.renderedWidth_!=x&&(this.innerElement_.style.width=x+"px",this.renderedWidth_=x),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,u=[this.createMarker("absolute")];for(let f=0;f<o;++f){const p=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${p}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return u.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),u=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=Np(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||kh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const vz={},wC=n=>{let e;const t=new Set,i=(f,p)=>{const y=typeof f=="function"?f(e):f;if(!Object.is(y,e)){const x=e;e=p??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(S=>S(e,x))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(vz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},xz=n=>n?wC(n):wC;var N0={exports:{}},M0={},L0={exports:{}},O0={};var EC;function wz(){if(EC)return O0;EC=1;var n=Xd();function e(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(p,y){var x=y(),S=i({inst:{value:x,getSnapshot:y}}),I=S[0].inst,T=S[1];return s(function(){I.value=x,I.getSnapshot=y,u(I)&&T({inst:I})},[p,x,y]),r(function(){return u(I)&&T({inst:I}),p(function(){u(I)&&T({inst:I})})},[p]),o(x),x}function u(p){var y=p.getSnapshot;p=p.value;try{var x=y();return!t(p,x)}catch{return!0}}function h(p,y){return y()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return O0.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,O0}var TC;function Ez(){return TC||(TC=1,L0.exports=wz()),L0.exports}var SC;function Tz(){if(SC)return M0;SC=1;var n=Xd(),e=Ez();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return M0.useSyncExternalStoreWithSelector=function(h,f,p,y,x){var S=s(null);if(S.current===null){var I={hasValue:!1,value:null};S.current=I}else I=S.current;S=l(function(){function A(j){if(!P){if(P=!0,N=j,j=y(j),x!==void 0&&I.hasValue){var D=I.value;if(x(D,j))return R=D}return R=j}if(D=R,i(N,j))return D;var b=y(j);return x!==void 0&&x(D,b)?(N=j,D):(N=j,R=b)}var P=!1,N,R,L=p===void 0?null:p;return[function(){return A(f())},L===null?void 0:function(){return A(L())}]},[f,p,y,x]);var T=r(h,S[0],S[1]);return o(function(){I.hasValue=!0,I.value=T},[T]),u(T),T},M0}var IC;function Sz(){return IC||(IC=1,N0.exports=Tz()),N0.exports}var Iz=Sz();const Cz=Sx(Iz),DP={},{useDebugValue:Rz}=JM,{useSyncExternalStoreWithSelector:Az}=Cz;let CC=!1;const bz=n=>n;function Pz(n,e=bz,t){(DP?"production":void 0)!=="production"&&t&&!CC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),CC=!0);const i=Az(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return Rz(i),i}const RC=n=>{(DP?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?xz(n):n,t=(i,r)=>Pz(e,i,r);return Object.assign(t,e),t},us=n=>n?RC(n):RC;var NP=Symbol.for("immer-nothing"),AC=Symbol.for("immer-draftable"),Ri=Symbol.for("immer-state");function mr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Dd=Object.getPrototypeOf;function gu(n){return!!n&&!!n[Ri]}function vl(n){return n?MP(n)||Array.isArray(n)||!!n[AC]||!!n.constructor?.[AC]||uf(n)||Km(n):!1}var kz=Object.prototype.constructor.toString(),bC=new WeakMap;function MP(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=bC.get(t);return i===void 0&&(i=Function.toString.call(t),bC.set(t,i)),i===kz}function Wp(n,e,t=!0){$m(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function $m(n){const e=n[Ri];return e?e.type_:Array.isArray(n)?1:uf(n)?2:Km(n)?3:0}function Fv(n,e){return $m(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function LP(n,e,t){const i=$m(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function Dz(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function uf(n){return n instanceof Map}function Km(n){return n instanceof Set}function Ba(n){return n.copy_||n.base_}function Vv(n,e){if(uf(n))return new Map(n);if(Km(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=MP(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Ri];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Dd(n),i)}else{const i=Dd(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function G1(n,e=!1){return Hm(n)||gu(n)||!vl(n)||($m(n)>1&&Object.defineProperties(n,{set:Kg,add:Kg,clear:Kg,delete:Kg}),Object.freeze(n),e&&Object.values(n).forEach(t=>G1(t,!0))),n}function Nz(){mr(2)}var Kg={value:Nz};function Hm(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var Mz={};function xl(n){const e=Mz[n];return e||mr(0,n),e}var Nd;function OP(){return Nd}function Lz(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function PC(n,e){e&&(xl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function jv(n){zv(n),n.drafts_.forEach(Oz),n.drafts_=null}function zv(n){n===Nd&&(Nd=n.parent_)}function kC(n){return Nd=Lz(Nd,n)}function Oz(n){const e=n[Ri];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function DC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Ri].modified_&&(jv(e),mr(4)),vl(n)&&(n=$p(e,n),e.parent_||Kp(e,n)),e.patches_&&xl("Patches").generateReplacementPatches_(t[Ri].base_,n,e.patches_,e.inversePatches_)):n=$p(e,t,[]),jv(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==NP?n:void 0}function $p(n,e,t){if(Hm(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Ri];if(!r)return Wp(e,(s,o)=>NC(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return Kp(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),Wp(o,(u,h)=>NC(n,r,s,u,h,t,l),i),Kp(n,s,!1),t&&n.patches_&&xl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function NC(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=Hm(r);if(!(l&&!o)){if(gu(r)){const u=s&&e&&e.type_!==3&&!Fv(e.assigned_,i)?s.concat(i):void 0,h=$p(n,r,u);if(LP(t,i,h),gu(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(vl(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;$p(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(uf(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&Kp(n,r)}}}function Kp(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&G1(e,t)}function Fz(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:OP(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=W1;t&&(r=[i],s=Md);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var W1={get(n,e){if(e===Ri)return n;const t=Ba(n);if(!Fv(t,e))return Vz(n,t,e);const i=t[e];return n.finalized_||!vl(i)?i:i===F0(n.base_,e)?(V0(n),n.copy_[e]=Bv(i,n)):i},has(n,e){return e in Ba(n)},ownKeys(n){return Reflect.ownKeys(Ba(n))},set(n,e,t){const i=FP(Ba(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=F0(Ba(n),e),s=r?.[Ri];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(Dz(t,r)&&(t!==void 0||Fv(n.base_,e)))return!0;V0(n),Uv(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return F0(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,V0(n),Uv(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Ba(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){mr(11)},getPrototypeOf(n){return Dd(n.base_)},setPrototypeOf(){mr(12)}},Md={};Wp(W1,(n,e)=>{Md[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Md.deleteProperty=function(n,e){return Md.set.call(this,n,e,void 0)};Md.set=function(n,e,t){return W1.set.call(this,n[0],e,t,n[0])};function F0(n,e){const t=n[Ri];return(t?Ba(t):n)[e]}function Vz(n,e,t){const i=FP(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function FP(n,e){if(!(e in n))return;let t=Dd(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Dd(t)}}function Uv(n){n.modified_||(n.modified_=!0,n.parent_&&Uv(n.parent_))}function V0(n){n.copy_||(n.copy_=Vv(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var jz=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,f=>t.call(this,f,...h))}}typeof t!="function"&&mr(6),i!==void 0&&typeof i!="function"&&mr(7);let r;if(vl(e)){const s=kC(this),o=Bv(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?jv(s):zv(s)}return PC(s,i),DC(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===NP&&(r=void 0),this.autoFreeze_&&G1(r,!0),i){const s=[],o=[];xl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else mr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){vl(n)||mr(8),gu(n)&&(n=zz(n));const e=kC(this),t=Bv(n,void 0);return t[Ri].isManual_=!0,zv(e),t}finishDraft(n,e){const t=n&&n[Ri];(!t||!t.isManual_)&&mr(9);const{scope_:i}=t;return PC(i,e),DC(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=xl("Patches").applyPatches_;return gu(n)?i(n,e):this.produce(n,r=>i(r,e))}};function Bv(n,e){const t=uf(n)?xl("MapSet").proxyMap_(n,e):Km(n)?xl("MapSet").proxySet_(n,e):Fz(n,e);return(e?e.scope_:OP()).drafts_.push(t),t}function zz(n){return gu(n)||mr(10,n),VP(n)}function VP(n){if(!vl(n)||Hm(n))return n;const e=n[Ri];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Vv(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=Vv(n,!0);return Wp(t,(r,s)=>{LP(t,r,VP(s))},i),e&&(e.finalized_=!1),t}var Uz=new jz,Bz=Uz.produce;const Gz=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?Bz(r):r;return e(l,s,...o)},n(i.setState,t,i)),Xm=Gz,wi=us()(Xm((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),jP={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await $g(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-B0Fq61fu.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Boothellingen:{name:"Boothellingen",factory:async()=>{const{createBoothellingenLayer:n}=await $g(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-BPwIFbfU.js");return{createBoothellingenLayer:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await $g(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-BgUopHch.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await $g(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-BUS-OUBC.js");return{createViswaterLayer:e}},__vite__mapDeps([3,1]));return n()},immediateLoad:!1}};function Wz(){return Object.values(jP).filter(n=>n.immediateLoad)}const Js=us()(Xm((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),qo=us()(Xm((n,e)=>({visible:{OpenStreetMap:!0,Luchtfoto:!1,"Labels Overlay":!1,Aanlegsteigers:!1,Boothellingen:!1,Dieptekaart:!1,Viswater:!1,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=jP[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=Js.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),ii=us()(Xm(n=>({layerControlOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchFormLocationSource:null,catchFormInitialPhotos:[],catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e?.location||null,t.catchFormLocationSource=e?.locationSource||null,t.catchFormInitialPhotos=e?.photos||[]})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null,e.catchFormLocationSource=null,e.catchFormInitialPhotos=[]})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),$z={};function Kz(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Ld=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Ld(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Ld(i)(t)}}}},Hz=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:T=>T,version:0,merge:(T,A)=>({...A,...T}),...e},o=!1;const l=new Set,u=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...T)},i,r);const f=Ld(s.serialize),p=()=>{const T=s.partialize({...i()});let A;const P=f({state:T,version:s.version}).then(N=>h.setItem(s.name,N)).catch(N=>{A=N});if(A)throw A;return P},y=r.setState;r.setState=(T,A)=>{y(T,A),p()};const x=n((...T)=>{t(...T),p()},i,r);let S;const I=()=>{var T;if(!h)return;o=!1,l.forEach(P=>P(i()));const A=((T=s.onRehydrateStorage)==null?void 0:T.call(s,i()))||void 0;return Ld(h.getItem.bind(h))(s.name).then(P=>{if(P)return s.deserialize(P)}).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==s.version){if(s.migrate)return s.migrate(P.state,P.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return P.state}).then(P=>{var N;return S=s.merge(P,(N=i())!=null?N:x),t(S,!0),p()}).then(()=>{A?.(S,void 0),o=!0,u.forEach(P=>P(S))}).catch(P=>{A?.(void 0,P)})};return r.persist={setOptions:T=>{s={...s,...T},T.getStorage&&(h=T.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:T=>(l.add(T),()=>{l.delete(T)}),onFinishHydration:T=>(u.add(T),()=>{u.delete(T)})},I(),S||x},Xz=(n,e)=>(t,i,r)=>{let s={storage:Kz(()=>localStorage),partialize:I=>I,version:0,merge:(I,T)=>({...T,...I}),...e},o=!1;const l=new Set,u=new Set;let h=s.storage;if(!h)return n((...I)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...I)},i,r);const f=()=>{const I=s.partialize({...i()});return h.setItem(s.name,{state:I,version:s.version})},p=r.setState;r.setState=(I,T)=>{p(I,T),f()};const y=n((...I)=>{t(...I),f()},i,r);r.getInitialState=()=>y;let x;const S=()=>{var I,T;if(!h)return;o=!1,l.forEach(P=>{var N;return P((N=i())!=null?N:y)});const A=((T=s.onRehydrateStorage)==null?void 0:T.call(s,(I=i())!=null?I:y))||void 0;return Ld(h.getItem.bind(h))(s.name).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==s.version){if(s.migrate)return[!0,s.migrate(P.state,P.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,P.state];return[!1,void 0]}).then(P=>{var N;const[R,L]=P;if(x=s.merge(L,(N=i())!=null?N:y),t(x,!0),R)return f()}).then(()=>{A?.(x,void 0),x=i(),o=!0,u.forEach(P=>P(x))}).catch(P=>{A?.(void 0,P)})};return r.persist={setOptions:I=>{s={...s,...I},I.storage&&(h=I.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>S(),hasHydrated:()=>o,onHydrate:I=>(l.add(I),()=>{l.delete(I)}),onFinishHydration:I=>(u.add(I),()=>{u.delete(I)})},s.skipHydration||S(),x||y},qz=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?(($z?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Hz(n,e)):Xz(n,e),hf=qz,mt=us()(hf(n=>({defaultBackground:"OpenStreetMap",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,showWindIndicator:!0,showTideWidget:!0,showForecastSlider:!0,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e}),setShowWindIndicator:e=>n({showWindIndicator:e}),setShowTideWidget:e=>n({showTideWidget:e}),setShowForecastSlider:e=>n({showForecastSlider:e})}),{name:"visapp-settings"})),zP=us()(hf((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),Od=us((n,e)=>({current:null,pressureHistory:[],hourlyForecast:[],loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code",hourly:"temperature_2m,wind_speed_10m,wind_direction_10m,surface_pressure,weather_code",past_hours:"24",forecast_hours:"48",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();let l=[],u=[];o.hourly?.time&&o.hourly?.surface_pressure&&(l=o.hourly.time.map((h,f)=>({time:h,pressure:o.hourly.surface_pressure[f]})),u=o.hourly.time.map((h,f)=>({time:h,temperature:o.hourly.temperature_2m[f],windSpeed:o.hourly.wind_speed_10m[f],windDirection:o.hourly.wind_direction_10m[f],pressure:o.hourly.surface_pressure[f],weatherCode:o.hourly.weather_code[f]}))),o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},pressureHistory:l,hourlyForecast:u,loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"},getFishingScore:()=>{const{current:t}=e();if(!t)return 1;let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),Math.max(0,Math.min(3,i/2))},getPressureTrend:()=>{const{pressureHistory:t}=e();if(t.length<6)return"stable";const i=t.slice(-6),r=t.slice(-12,-6);if(r.length===0)return"stable";const s=i.reduce((u,h)=>u+h.pressure,0)/i.length,o=r.reduce((u,h)=>u+h.pressure,0)/r.length,l=s-o;return l>2?"rising":l<-2?"falling":"stable"},getWeatherAtTime:t=>{const{hourlyForecast:i}=e();if(i.length===0)return null;t.toISOString().slice(0,13)+"";let r=i[0],s=1/0;for(const o of i){const l=new Date(o.time).getTime(),u=Math.abs(l-t.getTime());u<s&&(s=u,r=o)}return r}})),UP=us()(hf(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),MC=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],LC=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],Yz=us()(hf((n,e)=>({presets:MC,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=qo.getState().setLayerVisibility;LC.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=qo.getState().visible,r=LC.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:MC})}}),{name:"visapp-presets"})),Zz=()=>{};var OC={};const BP=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Qz=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},GP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,f=s>>2,p=(s&3)<<4|l>>4;let y=(l&15)<<2|h>>6,x=h&63;u||(x=64,o||(y=64)),i.push(t[f],t[p],t[y],t[x])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(BP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Qz(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||p==null)throw new Jz;const y=s<<2|l>>4;if(i.push(y),h!==64){const x=l<<4&240|h>>2;if(i.push(x),p!==64){const S=h<<6&192|p;i.push(S)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Jz extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const e9=function(n){const e=BP(n);return GP.encodeByteArray(e,!0)},Hp=function(n){return e9(n).replace(/\./g,"")},WP=function(n){try{return GP.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function $P(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const t9=()=>$P().__FIREBASE_DEFAULTS__,n9=()=>{if(typeof process>"u"||typeof OC>"u")return;const n=OC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},i9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&WP(n[1]);return e&&JSON.parse(e)},qm=()=>{try{return Zz()||t9()||n9()||i9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},KP=n=>qm()?.emulatorHosts?.[n],HP=n=>{const e=KP(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},XP=()=>qm()?.config,qP=n=>qm()?.[`_${n}`];class r9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Ml(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $1(n){return(await fetch(n,{credentials:"include"})).ok}function YP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Hp(JSON.stringify(t)),Hp(JSON.stringify(o)),""].join(".")}const nd={};function s9(){const n={prod:[],emulator:[]};for(const e of Object.keys(nd))nd[e]?n.emulator.push(e):n.prod.push(e);return n}function o9(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let FC=!1;function K1(n,e){if(typeof window>"u"||typeof document>"u"||!Ml(window.location.host)||nd[n]===e||nd[n]||FC)return;nd[n]=e;function t(y){return`__firebase__banner__${y}`}const i="__firebase__banner",s=s9().prod.length>0;function o(){const y=document.getElementById(i);y&&y.remove()}function l(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,x){y.setAttribute("width","24"),y.setAttribute("id",x),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{FC=!0,o()},y}function f(y,x){y.setAttribute("id",x),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function p(){const y=o9(i),x=t("text"),S=document.getElementById(x)||document.createElement("span"),I=t("learnmore"),T=document.getElementById(I)||document.createElement("a"),A=t("preprendIcon"),P=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const N=y.element;l(N),f(T,I);const R=h();u(P,A),N.append(P,S,T,R),document.body.appendChild(N)}s?(S.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function en(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function a9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(en())}function ZP(){const n=qm()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function l9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function c9(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function u9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function h9(){const n=en();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function QP(){return!ZP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function JP(){return!ZP()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ek(){try{return typeof indexedDB=="object"}catch{return!1}}function d9(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const f9="FirebaseError";class hs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=f9,Object.setPrototypeOf(this,hs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,df.prototype.create)}}class df{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?g9(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new hs(r,l,i)}}function g9(n,e){return n.replace(p9,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const p9=/\{\$([^}]+)}/g;function m9(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function wl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(VC(s)&&VC(o)){if(!wl(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function VC(n){return n!==null&&typeof n=="object"}function ff(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function y9(n,e){const t=new _9(n,e);return t.subscribe.bind(t)}class _9{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");v9(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=j0),r.error===void 0&&(r.error=j0),r.complete===void 0&&(r.complete=j0);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function v9(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function j0(){}function eo(n){return n&&n._delegate?n._delegate:n}class na{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ga="[DEFAULT]";class x9{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new r9;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(E9(e))try{this.getOrInitializeService({instanceIdentifier:Ga})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ga){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ga){return this.instances.has(e)}getOptions(e=Ga){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:w9(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ga){return this.component?this.component.multipleInstances?e:Ga:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function w9(n){return n===Ga?void 0:n}function E9(n){return n.instantiationMode==="EAGER"}class T9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new x9(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var He;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(He||(He={}));const S9={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},I9=He.INFO,C9={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},R9=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=C9[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class H1{constructor(e){this.name=e,this._logLevel=I9,this._logHandler=R9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?S9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const A9=(n,e)=>e.some(t=>n instanceof t);let jC,zC;function b9(){return jC||(jC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function P9(){return zC||(zC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const tk=new WeakMap,Gv=new WeakMap,nk=new WeakMap,z0=new WeakMap,X1=new WeakMap;function k9(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Yo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&tk.set(t,n)}).catch(()=>{}),X1.set(e,n),e}function D9(n){if(Gv.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Gv.set(n,e)}let Wv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Gv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||nk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Yo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function N9(n){Wv=n(Wv)}function M9(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(U0(this),e,...t);return nk.set(i,e.sort?e.sort():[e]),Yo(i)}:P9().includes(n)?function(...e){return n.apply(U0(this),e),Yo(tk.get(this))}:function(...e){return Yo(n.apply(U0(this),e))}}function L9(n){return typeof n=="function"?M9(n):(n instanceof IDBTransaction&&D9(n),A9(n,b9())?new Proxy(n,Wv):n)}function Yo(n){if(n instanceof IDBRequest)return k9(n);if(z0.has(n))return z0.get(n);const e=L9(n);return e!==n&&(z0.set(n,e),X1.set(e,n)),e}const U0=n=>X1.get(n);function O9(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Yo(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Yo(o.result),u.oldVersion,u.newVersion,Yo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const F9=["get","getKey","getAll","getAllKeys","count"],V9=["put","add","delete","clear"],B0=new Map;function UC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(B0.get(e))return B0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=V9.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||F9.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&u.done]))[0]};return B0.set(e,s),s}N9(n=>({...n,get:(e,t,i)=>UC(e,t)||n.get(e,t,i),has:(e,t)=>!!UC(e,t)||n.has(e,t)}));class j9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(z9(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function z9(n){return n.getComponent()?.type==="VERSION"}const $v="@firebase/app",BC="0.14.6";const Xs=new H1("@firebase/app"),U9="@firebase/app-compat",B9="@firebase/analytics-compat",G9="@firebase/analytics",W9="@firebase/app-check-compat",$9="@firebase/app-check",K9="@firebase/auth",H9="@firebase/auth-compat",X9="@firebase/database",q9="@firebase/data-connect",Y9="@firebase/database-compat",Z9="@firebase/functions",Q9="@firebase/functions-compat",J9="@firebase/installations",eU="@firebase/installations-compat",tU="@firebase/messaging",nU="@firebase/messaging-compat",iU="@firebase/performance",rU="@firebase/performance-compat",sU="@firebase/remote-config",oU="@firebase/remote-config-compat",aU="@firebase/storage",lU="@firebase/storage-compat",cU="@firebase/firestore",uU="@firebase/ai",hU="@firebase/firestore-compat",dU="firebase",fU="12.6.0";const Kv="[DEFAULT]",gU={[$v]:"fire-core",[U9]:"fire-core-compat",[G9]:"fire-analytics",[B9]:"fire-analytics-compat",[$9]:"fire-app-check",[W9]:"fire-app-check-compat",[K9]:"fire-auth",[H9]:"fire-auth-compat",[X9]:"fire-rtdb",[q9]:"fire-data-connect",[Y9]:"fire-rtdb-compat",[Z9]:"fire-fn",[Q9]:"fire-fn-compat",[J9]:"fire-iid",[eU]:"fire-iid-compat",[tU]:"fire-fcm",[nU]:"fire-fcm-compat",[iU]:"fire-perf",[rU]:"fire-perf-compat",[sU]:"fire-rc",[oU]:"fire-rc-compat",[aU]:"fire-gcs",[lU]:"fire-gcs-compat",[cU]:"fire-fst",[hU]:"fire-fst-compat",[uU]:"fire-vertex","fire-js":"fire-js",[dU]:"fire-js-all"};const Xp=new Map,pU=new Map,Hv=new Map;function GC(n,e){try{n.container.addComponent(e)}catch(t){Xs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function El(n){const e=n.name;if(Hv.has(e))return Xs.debug(`There were multiple attempts to register component ${e}.`),!1;Hv.set(e,n);for(const t of Xp.values())GC(t,n);for(const t of pU.values())GC(t,n);return!0}function Ym(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ki(n){return n==null?!1:n.settings!==void 0}const mU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zo=new df("app","Firebase",mU);class yU{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new na("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zo.create("app-deleted",{appName:this._name})}}const Ll=fU;function ik(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Kv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Zo.create("bad-app-name",{appName:String(r)});if(t||(t=XP()),!t)throw Zo.create("no-options");const s=Xp.get(r);if(s){if(wl(t,s.options)&&wl(i,s.config))return s;throw Zo.create("duplicate-app",{appName:r})}const o=new T9(r);for(const u of Hv.values())o.addComponent(u);const l=new yU(t,i,o);return Xp.set(r,l),l}function q1(n=Kv){const e=Xp.get(n);if(!e&&n===Kv&&XP())return ik();if(!e)throw Zo.create("no-app",{appName:n});return e}function rs(n,e,t){let i=gU[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xs.warn(o.join(" "));return}El(new na(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const _U="firebase-heartbeat-database",vU=1,Fd="firebase-heartbeat-store";let G0=null;function rk(){return G0||(G0=O9(_U,vU,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Fd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Zo.create("idb-open",{originalErrorMessage:n.message})})),G0}async function xU(n){try{const t=(await rk()).transaction(Fd),i=await t.objectStore(Fd).get(sk(n));return await t.done,i}catch(e){if(e instanceof hs)Xs.warn(e.message);else{const t=Zo.create("idb-get",{originalErrorMessage:e?.message});Xs.warn(t.message)}}}async function WC(n,e){try{const i=(await rk()).transaction(Fd,"readwrite");await i.objectStore(Fd).put(e,sk(n)),await i.done}catch(t){if(t instanceof hs)Xs.warn(t.message);else{const i=Zo.create("idb-set",{originalErrorMessage:t?.message});Xs.warn(i.message)}}}function sk(n){return`${n.name}!${n.options.appId}`}const wU=1024,EU=30;class TU{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new IU(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=$C();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>EU){const r=CU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=$C(),{heartbeatsToSend:t,unsentEntries:i}=SU(this._heartbeatsCache.heartbeats),r=Hp(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Xs.warn(e),""}}}function $C(){return new Date().toISOString().substring(0,10)}function SU(n,e=wU){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),KC(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),KC(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class IU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ek()?d9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await xU(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return WC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return WC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function KC(n){return Hp(JSON.stringify({version:2,heartbeats:n})).length}function CU(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function RU(n){El(new na("platform-logger",e=>new j9(e),"PRIVATE")),El(new na("heartbeat",e=>new TU(e),"PRIVATE")),rs($v,BC,n),rs($v,BC,"esm2020"),rs("fire-js","")}RU("");function ok(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const AU=ok,ak=new df("auth","Firebase",ok());const qp=new H1("@firebase/auth");function bU(n,...e){qp.logLevel<=He.WARN&&qp.warn(`Auth (${Ll}): ${n}`,...e)}function lp(n,...e){qp.logLevel<=He.ERROR&&qp.error(`Auth (${Ll}): ${n}`,...e)}function os(n,...e){throw Z1(n,...e)}function Tr(n,...e){return Z1(n,...e)}function Y1(n,e,t){const i={...AU(),[e]:t};return new df("auth","Firebase",i).create(e,{appName:n.name})}function ll(n){return Y1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function PU(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&os(n,"argument-error"),Y1(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Z1(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return ak.create(n,...e)}function Fe(n,e,...t){if(!n)throw Z1(e,...t)}function Fs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw lp(e),new Error(e)}function qs(n,e){n||Fs(e)}function Xv(){return typeof self<"u"&&self.location?.href||""}function kU(){return HC()==="http:"||HC()==="https:"}function HC(){return typeof self<"u"&&self.location?.protocol||null}function DU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(kU()||c9()||"connection"in navigator)?navigator.onLine:!0}function NU(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class gf{constructor(e,t){this.shortDelay=e,this.longDelay=t,qs(t>e,"Short delay should be less than long delay!"),this.isMobile=a9()||u9()}get(){return DU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Q1(n,e){qs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class lk{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const MU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const LU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],OU=new gf(3e4,6e4);function J1(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Mu(n,e,t,i,r={}){return ck(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=ff({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return l9()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Ml(n.emulatorConfig.host)&&(h.credentials="include"),lk.fetch()(await uk(n,n.config.apiHost,t,l),h)})}async function ck(n,e,t){n._canInitEmulator=!1;const i={...MU,...e};try{const r=new VU(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Hg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hg(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Hg(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Hg(n,"user-disabled",o);const f=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Y1(n,f,h);os(n,f)}}catch(r){if(r instanceof hs)throw r;os(n,"network-request-failed",{message:String(r)})}}async function FU(n,e,t,i,r={}){const s=await Mu(n,e,t,i,r);return"mfaPendingCredential"in s&&os(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function uk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?Q1(n.config,r):`${n.config.apiScheme}://${r}`;return LU.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class VU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Tr(this.auth,"network-request-failed")),OU.get())})}}function Hg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Tr(n,e,i);return r.customData._tokenResponse=t,r}async function jU(n,e){return Mu(n,"POST","/v1/accounts:delete",e)}async function Yp(n,e){return Mu(n,"POST","/v1/accounts:lookup",e)}function id(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function zU(n,e=!1){const t=eo(n),i=await t.getIdToken(e),r=ew(i);Fe(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:id(W0(r.auth_time)),issuedAtTime:id(W0(r.iat)),expirationTime:id(W0(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function W0(n){return Number(n)*1e3}function ew(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return lp("JWT malformed, contained fewer than 3 sections"),null;try{const r=WP(t);return r?JSON.parse(r):(lp("Failed to decode base64 JWT payload"),null)}catch(r){return lp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function XC(n){const e=ew(n);return Fe(e,"internal-error"),Fe(typeof e.exp<"u","internal-error"),Fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Vd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof hs&&UU(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function UU({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class BU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class qv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=id(this.lastLoginAt),this.creationTime=id(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Zp(n){const e=n.auth,t=await n.getIdToken(),i=await Vd(n,Yp(e,{idToken:t}));Fe(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?hk(r.providerUserInfo):[],o=WU(n.providerData,s),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new qv(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function GU(n){const e=eo(n);await Zp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function WU(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function hk(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function $U(n,e){const t=await ck(n,{},async()=>{const i=ff({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await uk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:i};return n.emulatorConfig&&Ml(n.emulatorConfig.host)&&(u.credentials="include"),lk.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function KU(n,e){return Mu(n,"POST","/v2/accounts:revokeToken",J1(n,e))}class Qc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Fe(e.idToken,"internal-error"),Fe(typeof e.idToken<"u","internal-error"),Fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):XC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Fe(e.length!==0,"internal-error");const t=XC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await $U(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Qc;return i&&(Fe(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Fe(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Fe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qc,this.toJSON())}_performRefresh(){return Fs("not implemented")}}function ko(n,e){Fe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class _r{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new BU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new qv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Vd(this,this.stsTokenManager.getToken(this.auth,e));return Fe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return zU(this,e)}reload(){return GU(this)}_assign(e){this!==e&&(Fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _r({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Zp(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ki(this.auth.app))return Promise.reject(ll(this.auth));const e=await this.getIdToken();return await Vd(this,jU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:p,emailVerified:y,isAnonymous:x,providerData:S,stsTokenManager:I}=t;Fe(p&&I,e,"internal-error");const T=Qc.fromJSON(this.name,I);Fe(typeof p=="string",e,"internal-error"),ko(i,e.name),ko(r,e.name),Fe(typeof y=="boolean",e,"internal-error"),Fe(typeof x=="boolean",e,"internal-error"),ko(s,e.name),ko(o,e.name),ko(l,e.name),ko(u,e.name),ko(h,e.name),ko(f,e.name);const A=new _r({uid:p,auth:e,email:r,emailVerified:y,displayName:i,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:T,createdAt:h,lastLoginAt:f});return S&&Array.isArray(S)&&(A.providerData=S.map(P=>({...P}))),u&&(A._redirectEventId=u),A}static async _fromIdTokenResponse(e,t,i=!1){const r=new Qc;r.updateFromServerResponse(t);const s=new _r({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Zp(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Fe(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?hk(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new Qc;l.updateFromIdToken(i);const u=new _r({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new qv(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const qC=new Map;function Vs(n){qs(n instanceof Function,"Expected a class definition");let e=qC.get(n);return e?(qs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,qC.set(n,e),e)}class dk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}dk.type="NONE";const YC=dk;function cp(n,e,t){return`firebase:${n}:${e}:${t}`}class Jc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=cp(this.userKey,r.apiKey,s),this.fullPersistenceKey=cp("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Yp(this.auth,{idToken:e}).catch(()=>{});return t?_r._fromGetAccountInfoResponse(this.auth,t,e):null}return _r._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Jc(Vs(YC),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Vs(YC);const o=cp(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let p;if(typeof f=="string"){const y=await Yp(e,{idToken:f}).catch(()=>{});if(!y)break;p=await _r._fromGetAccountInfoResponse(e,y,f)}else p=_r._fromJSON(e,f);h!==s&&(l=p),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Jc(s,e,i):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Jc(s,e,i))}}function ZC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(mk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_k(e))return"Blackberry";if(vk(e))return"Webos";if(gk(e))return"Safari";if((e.includes("chrome/")||pk(e))&&!e.includes("edge/"))return"Chrome";if(yk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function fk(n=en()){return/firefox\//i.test(n)}function gk(n=en()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pk(n=en()){return/crios\//i.test(n)}function mk(n=en()){return/iemobile/i.test(n)}function yk(n=en()){return/android/i.test(n)}function _k(n=en()){return/blackberry/i.test(n)}function vk(n=en()){return/webos/i.test(n)}function tw(n=en()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function HU(n=en()){return tw(n)&&!!window.navigator?.standalone}function XU(){return h9()&&document.documentMode===10}function xk(n=en()){return tw(n)||yk(n)||vk(n)||_k(n)||/windows phone/i.test(n)||mk(n)}function wk(n,e=[]){let t;switch(n){case"Browser":t=ZC(en());break;case"Worker":t=`${ZC(en())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ll}/${i}`}class qU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function YU(n,e={}){return Mu(n,"GET","/v2/passwordPolicy",J1(n,e))}const ZU=6;class QU{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??ZU,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class JU{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new QC(this),this.idTokenSubscription=new QC(this),this.beforeStateQueue=new qU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ak,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Jc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Yp(this,{idToken:e}),i=await _r._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ki(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Zp(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=NU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ki(this.app))return Promise.reject(ll(this));const t=e?eo(e):null;return t&&Fe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ki(this.app)?Promise.reject(ll(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ki(this.app)?Promise.reject(ll(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await YU(this),t=new QU(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new df("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await KU(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vs(e)||this._popupRedirectResolver;Fe(t,this,"argument-error"),this.redirectPersistenceManager=await Jc.create(this,[Vs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Fe(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Ki(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&bU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Zm(n){return eo(n)}class QC{constructor(e){this.auth=e,this.observer=null,this.addObserver=y9(t=>this.observer=t)}get next(){return Fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let nw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function eB(n){nw=n}function tB(n){return nw.loadJS(n)}function nB(){return nw.gapiScript}function iB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function rB(n,e){const t=Ym(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(wl(s,e??{}))return r;os(r,"already-initialized")}return t.initialize({options:e})}function sB(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Vs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function oB(n,e,t){const i=Zm(n);Fe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=Ek(e),{host:o,port:l}=aB(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Fe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Fe(wl(h,i.config.emulator)&&wl(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Ml(o)?($1(`${s}//${o}${u}`),K1("Auth",!0)):lB()}function Ek(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function aB(n){const e=Ek(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:JC(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:JC(o)}}}function JC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function lB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Tk{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fs("not implemented")}_getIdTokenResponse(e){return Fs("not implemented")}_linkToIdToken(e,t){return Fs("not implemented")}_getReauthenticationResolver(e){return Fs("not implemented")}}async function eu(n,e){return FU(n,"POST","/v1/accounts:signInWithIdp",J1(n,e))}const cB="http://localhost";class Tl extends Tk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Tl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):os("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new Tl(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return eu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,eu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,eu(e,t)}buildRequest(){const e={requestUri:cB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ff(t)}return e}}class iw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class pf extends iw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class jo extends pf{constructor(){super("facebook.com")}static credential(e){return Tl._fromParams({providerId:jo.PROVIDER_ID,signInMethod:jo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jo.credentialFromTaggedObject(e)}static credentialFromError(e){return jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jo.credential(e.oauthAccessToken)}catch{return null}}}jo.FACEBOOK_SIGN_IN_METHOD="facebook.com";jo.PROVIDER_ID="facebook.com";class Ls extends pf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Tl._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ls.credential(t,i)}catch{return null}}}Ls.GOOGLE_SIGN_IN_METHOD="google.com";Ls.PROVIDER_ID="google.com";class zo extends pf{constructor(){super("github.com")}static credential(e){return Tl._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zo.credential(e.oauthAccessToken)}catch{return null}}}zo.GITHUB_SIGN_IN_METHOD="github.com";zo.PROVIDER_ID="github.com";class Uo extends pf{constructor(){super("twitter.com")}static credential(e,t){return Tl._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Uo.credential(t,i)}catch{return null}}}Uo.TWITTER_SIGN_IN_METHOD="twitter.com";Uo.PROVIDER_ID="twitter.com";class pu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await _r._fromIdTokenResponse(e,i,r),o=eR(i);return new pu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=eR(i);return new pu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function eR(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Qp extends hs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Qp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Qp(e,t,i,r)}}function Sk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Qp._fromErrorAndOperation(n,s,e,i):s})}async function uB(n,e,t=!1){const i=await Vd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return pu._forOperation(n,"link",i)}async function hB(n,e,t=!1){const{auth:i}=n;if(Ki(i.app))return Promise.reject(ll(i));const r="reauthenticate";try{const s=await Vd(n,Sk(i,r,e,n),t);Fe(s.idToken,i,"internal-error");const o=ew(s.idToken);Fe(o,i,"internal-error");const{sub:l}=o;return Fe(n.uid===l,i,"user-mismatch"),pu._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&os(i,"user-mismatch"),s}}async function dB(n,e,t=!1){if(Ki(n.app))return Promise.reject(ll(n));const i="signIn",r=await Sk(n,i,e),s=await pu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function fB(n,e,t,i){return eo(n).onIdTokenChanged(e,t,i)}function gB(n,e,t){return eo(n).beforeAuthStateChanged(e,t)}function pB(n,e,t,i){return eo(n).onAuthStateChanged(e,t,i)}function mB(n){return eo(n).signOut()}const Jp="__sak";class Ik{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Jp,"1"),this.storage.removeItem(Jp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const yB=1e3,_B=10;class Ck extends Ik{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);XU()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,_B):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},yB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ck.type="LOCAL";const vB=Ck;class Rk extends Ik{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Rk.type="SESSION";const Ak=Rk;function xB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Qm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Qm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),u=await xB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qm.receivers=[];function rw(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class wB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=rw("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(p){const y=p;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(y.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function ss(){return window}function EB(n){ss().location.href=n}function bk(){return typeof ss().WorkerGlobalScope<"u"&&typeof ss().importScripts=="function"}async function TB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function SB(){return navigator?.serviceWorker?.controller||null}function IB(){return bk()?self:null}const Pk="firebaseLocalStorageDb",CB=1,em="firebaseLocalStorage",kk="fbase_key";class mf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Jm(n,e){return n.transaction([em],e?"readwrite":"readonly").objectStore(em)}function RB(){const n=indexedDB.deleteDatabase(Pk);return new mf(n).toPromise()}function Yv(){const n=indexedDB.open(Pk,CB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(em,{keyPath:kk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(em)?e(i):(i.close(),await RB(),e(await Yv()))})})}async function tR(n,e,t){const i=Jm(n,!0).put({[kk]:e,value:t});return new mf(i).toPromise()}async function AB(n,e){const t=Jm(n,!1).get(e),i=await new mf(t).toPromise();return i===void 0?null:i.value}function nR(n,e){const t=Jm(n,!0).delete(e);return new mf(t).toPromise()}const bB=800,PB=3;class Dk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Yv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>PB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qm._getInstance(IB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await TB(),!this.activeServiceWorker)return;this.sender=new wB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||SB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Yv();return await tR(e,Jp,"1"),await nR(e,Jp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>tR(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>AB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>nR(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=Jm(r,!1).getAll();return new mf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),bB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Dk.type="LOCAL";const kB=Dk;new gf(3e4,6e4);function Nk(n,e){return e?Vs(e):(Fe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class sw extends Tk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return eu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return eu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return eu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function DB(n){return dB(n.auth,new sw(n),n.bypassAuthState)}function NB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),hB(t,new sw(n),n.bypassAuthState)}async function MB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),uB(t,new sw(n),n.bypassAuthState)}class Mk{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return DB;case"linkViaPopup":case"linkViaRedirect":return MB;case"reauthViaPopup":case"reauthViaRedirect":return NB;default:os(this.auth,"internal-error")}}resolve(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const LB=new gf(2e3,1e4);async function OB(n,e,t){if(Ki(n.app))return Promise.reject(Tr(n,"operation-not-supported-in-this-environment"));const i=Zm(n);PU(n,e,iw);const r=Nk(i,t);return new nl(i,"signInViaPopup",e,r).executeNotNull()}class nl extends Mk{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,nl.currentPopupAction&&nl.currentPopupAction.cancel(),nl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Fe(e,this.auth,"internal-error"),e}async onExecution(){qs(this.filter.length===1,"Popup operations only handle one event");const e=rw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,LB.get())};e()}}nl.currentPopupAction=null;const FB="pendingRedirect",up=new Map;class VB extends Mk{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=up.get(this.auth._key());if(!e){try{const i=await jB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}up.set(this.auth._key(),e)}return this.bypassAuthState||up.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function jB(n,e){const t=BB(e),i=UB(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function zB(n,e){up.set(n._key(),e)}function UB(n){return Vs(n._redirectPersistence)}function BB(n){return cp(FB,n.config.apiKey,n.name)}async function GB(n,e,t=!1){if(Ki(n.app))return Promise.reject(ll(n));const i=Zm(n),r=Nk(i,e),o=await new VB(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const WB=600*1e3;class $B{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KB(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Lk(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Tr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WB&&this.cachedEventUids.clear(),this.cachedEventUids.has(iR(e))}saveEventToCache(e){this.cachedEventUids.add(iR(e)),this.lastProcessedEventTime=Date.now()}}function iR(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Lk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function KB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Lk(n);default:return!1}}async function HB(n,e={}){return Mu(n,"GET","/v1/projects",e)}const XB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qB=/^https?/;async function YB(n){if(n.config.emulator)return;const{authorizedDomains:e}=await HB(n);for(const t of e)try{if(ZB(t))return}catch{}os(n,"unauthorized-domain")}function ZB(n){const e=Xv(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!qB.test(t))return!1;if(XB.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const QB=new gf(3e4,6e4);function rR(){const n=ss().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function JB(n){return new Promise((e,t)=>{function i(){rR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rR(),t(Tr(n,"network-request-failed"))},timeout:QB.get()})}if(ss().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ss().gapi?.load)i();else{const r=iB("iframefcb");return ss()[r]=()=>{gapi.load?i():t(Tr(n,"network-request-failed"))},tB(`${nB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw hp=null,e})}let hp=null;function e8(n){return hp=hp||JB(n),hp}const t8=new gf(5e3,15e3),n8="__/auth/iframe",i8="emulator/auth/iframe",r8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},s8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function o8(n){const e=n.config;Fe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Q1(e,i8):`https://${n.config.authDomain}/${n8}`,i={apiKey:e.apiKey,appName:n.name,v:Ll},r=s8.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${ff(i).slice(1)}`}async function a8(n){const e=await e8(n),t=ss().gapi;return Fe(t,n,"internal-error"),e.open({where:document.body,url:o8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:r8,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Tr(n,"network-request-failed"),l=ss().setTimeout(()=>{s(o)},t8.get());function u(){ss().clearTimeout(l),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const l8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},c8=500,u8=600,h8="_blank",d8="http://localhost";class sR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function f8(n,e,t,i=c8,r=u8){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u={...l8,width:i.toString(),height:r.toString(),top:s,left:o},h=en().toLowerCase();t&&(l=pk(h)?h8:t),fk(h)&&(e=e||d8,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[x,S])=>`${y}${x}=${S},`,"");if(HU(h)&&l!=="_self")return g8(e||"",l),new sR(null);const p=window.open(e||"",l,f);Fe(p,n,"popup-blocked");try{p.focus()}catch{}return new sR(p)}function g8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const p8="__/auth/handler",m8="emulator/auth/handler",y8=encodeURIComponent("fac");async function oR(n,e,t,i,r,s){Fe(n.config.authDomain,n,"auth-domain-config-required"),Fe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ll,eventId:r};if(e instanceof iw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",m9(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof pf){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),h=u?`#${y8}=${encodeURIComponent(u)}`:"";return`${_8(n)}?${ff(l).slice(1)}${h}`}function _8({config:n}){return n.emulator?Q1(n,m8):`https://${n.authDomain}/${p8}`}const $0="webStorageSupport";class v8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ak,this._completeRedirectFn=GB,this._overrideRedirectResult=zB}async _openPopup(e,t,i,r){qs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await oR(e,t,i,Xv(),r);return f8(e,s,rw())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await oR(e,t,i,Xv(),r);return EB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(qs(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await a8(e),i=new $B(e);return t.register("authEvent",r=>(Fe(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send($0,{type:$0},r=>{const s=r?.[0]?.[$0];s!==void 0&&t(!!s),os(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=YB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return xk()||gk()||tw()}}const x8=v8;var aR="@firebase/auth",lR="1.12.0";class w8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function E8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function T8(n){El(new na("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Fe(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wk(n)},h=new JU(i,r,s,u);return sB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),El(new na("auth-internal",e=>{const t=Zm(e.getProvider("auth").getImmediate());return(i=>new w8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),rs(aR,lR,E8(n)),rs(aR,lR,"esm2020")}const S8=300,I8=qP("authIdTokenMaxAge")||S8;let cR=null;const C8=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>I8)return;const r=t?.token;cR!==r&&(cR=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function R8(n=q1()){const e=Ym(n,"auth");if(e.isInitialized())return e.getImmediate();const t=rB(n,{popupRedirectResolver:x8,persistence:[kB,vB,Ak]}),i=qP("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=C8(s.toString());gB(t,o,()=>o(t.currentUser)),fB(t,l=>o(l))}}const r=KP("auth");return r&&oB(t,`http://${r}`),t}function A8(){return document.getElementsByTagName("head")?.[0]??document}eB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Tr("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",A8().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});T8("Browser");var b8="firebase",P8="12.7.0";rs(b8,P8,"app");var uR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ow;(function(){var n;function e(D,b){function M(){}M.prototype=b.prototype,D.F=b.prototype,D.prototype=new M,D.prototype.constructor=D,D.D=function(V,z,B){for(var O=Array(arguments.length-2),le=2;le<arguments.length;le++)O[le-2]=arguments[le];return b.prototype[z].apply(V,O)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(D,b,M){M||(M=0);const V=Array(16);if(typeof b=="string")for(var z=0;z<16;++z)V[z]=b.charCodeAt(M++)|b.charCodeAt(M++)<<8|b.charCodeAt(M++)<<16|b.charCodeAt(M++)<<24;else for(z=0;z<16;++z)V[z]=b[M++]|b[M++]<<8|b[M++]<<16|b[M++]<<24;b=D.g[0],M=D.g[1],z=D.g[2];let B=D.g[3],O;O=b+(B^M&(z^B))+V[0]+3614090360&4294967295,b=M+(O<<7&4294967295|O>>>25),O=B+(z^b&(M^z))+V[1]+3905402710&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(M^B&(b^M))+V[2]+606105819&4294967295,z=B+(O<<17&4294967295|O>>>15),O=M+(b^z&(B^b))+V[3]+3250441966&4294967295,M=z+(O<<22&4294967295|O>>>10),O=b+(B^M&(z^B))+V[4]+4118548399&4294967295,b=M+(O<<7&4294967295|O>>>25),O=B+(z^b&(M^z))+V[5]+1200080426&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(M^B&(b^M))+V[6]+2821735955&4294967295,z=B+(O<<17&4294967295|O>>>15),O=M+(b^z&(B^b))+V[7]+4249261313&4294967295,M=z+(O<<22&4294967295|O>>>10),O=b+(B^M&(z^B))+V[8]+1770035416&4294967295,b=M+(O<<7&4294967295|O>>>25),O=B+(z^b&(M^z))+V[9]+2336552879&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(M^B&(b^M))+V[10]+4294925233&4294967295,z=B+(O<<17&4294967295|O>>>15),O=M+(b^z&(B^b))+V[11]+2304563134&4294967295,M=z+(O<<22&4294967295|O>>>10),O=b+(B^M&(z^B))+V[12]+1804603682&4294967295,b=M+(O<<7&4294967295|O>>>25),O=B+(z^b&(M^z))+V[13]+4254626195&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(M^B&(b^M))+V[14]+2792965006&4294967295,z=B+(O<<17&4294967295|O>>>15),O=M+(b^z&(B^b))+V[15]+1236535329&4294967295,M=z+(O<<22&4294967295|O>>>10),O=b+(z^B&(M^z))+V[1]+4129170786&4294967295,b=M+(O<<5&4294967295|O>>>27),O=B+(M^z&(b^M))+V[6]+3225465664&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^M&(B^b))+V[11]+643717713&4294967295,z=B+(O<<14&4294967295|O>>>18),O=M+(B^b&(z^B))+V[0]+3921069994&4294967295,M=z+(O<<20&4294967295|O>>>12),O=b+(z^B&(M^z))+V[5]+3593408605&4294967295,b=M+(O<<5&4294967295|O>>>27),O=B+(M^z&(b^M))+V[10]+38016083&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^M&(B^b))+V[15]+3634488961&4294967295,z=B+(O<<14&4294967295|O>>>18),O=M+(B^b&(z^B))+V[4]+3889429448&4294967295,M=z+(O<<20&4294967295|O>>>12),O=b+(z^B&(M^z))+V[9]+568446438&4294967295,b=M+(O<<5&4294967295|O>>>27),O=B+(M^z&(b^M))+V[14]+3275163606&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^M&(B^b))+V[3]+4107603335&4294967295,z=B+(O<<14&4294967295|O>>>18),O=M+(B^b&(z^B))+V[8]+1163531501&4294967295,M=z+(O<<20&4294967295|O>>>12),O=b+(z^B&(M^z))+V[13]+2850285829&4294967295,b=M+(O<<5&4294967295|O>>>27),O=B+(M^z&(b^M))+V[2]+4243563512&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^M&(B^b))+V[7]+1735328473&4294967295,z=B+(O<<14&4294967295|O>>>18),O=M+(B^b&(z^B))+V[12]+2368359562&4294967295,M=z+(O<<20&4294967295|O>>>12),O=b+(M^z^B)+V[5]+4294588738&4294967295,b=M+(O<<4&4294967295|O>>>28),O=B+(b^M^z)+V[8]+2272392833&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^M)+V[11]+1839030562&4294967295,z=B+(O<<16&4294967295|O>>>16),O=M+(z^B^b)+V[14]+4259657740&4294967295,M=z+(O<<23&4294967295|O>>>9),O=b+(M^z^B)+V[1]+2763975236&4294967295,b=M+(O<<4&4294967295|O>>>28),O=B+(b^M^z)+V[4]+1272893353&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^M)+V[7]+4139469664&4294967295,z=B+(O<<16&4294967295|O>>>16),O=M+(z^B^b)+V[10]+3200236656&4294967295,M=z+(O<<23&4294967295|O>>>9),O=b+(M^z^B)+V[13]+681279174&4294967295,b=M+(O<<4&4294967295|O>>>28),O=B+(b^M^z)+V[0]+3936430074&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^M)+V[3]+3572445317&4294967295,z=B+(O<<16&4294967295|O>>>16),O=M+(z^B^b)+V[6]+76029189&4294967295,M=z+(O<<23&4294967295|O>>>9),O=b+(M^z^B)+V[9]+3654602809&4294967295,b=M+(O<<4&4294967295|O>>>28),O=B+(b^M^z)+V[12]+3873151461&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^M)+V[15]+530742520&4294967295,z=B+(O<<16&4294967295|O>>>16),O=M+(z^B^b)+V[2]+3299628645&4294967295,M=z+(O<<23&4294967295|O>>>9),O=b+(z^(M|~B))+V[0]+4096336452&4294967295,b=M+(O<<6&4294967295|O>>>26),O=B+(M^(b|~z))+V[7]+1126891415&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~M))+V[14]+2878612391&4294967295,z=B+(O<<15&4294967295|O>>>17),O=M+(B^(z|~b))+V[5]+4237533241&4294967295,M=z+(O<<21&4294967295|O>>>11),O=b+(z^(M|~B))+V[12]+1700485571&4294967295,b=M+(O<<6&4294967295|O>>>26),O=B+(M^(b|~z))+V[3]+2399980690&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~M))+V[10]+4293915773&4294967295,z=B+(O<<15&4294967295|O>>>17),O=M+(B^(z|~b))+V[1]+2240044497&4294967295,M=z+(O<<21&4294967295|O>>>11),O=b+(z^(M|~B))+V[8]+1873313359&4294967295,b=M+(O<<6&4294967295|O>>>26),O=B+(M^(b|~z))+V[15]+4264355552&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~M))+V[6]+2734768916&4294967295,z=B+(O<<15&4294967295|O>>>17),O=M+(B^(z|~b))+V[13]+1309151649&4294967295,M=z+(O<<21&4294967295|O>>>11),O=b+(z^(M|~B))+V[4]+4149444226&4294967295,b=M+(O<<6&4294967295|O>>>26),O=B+(M^(b|~z))+V[11]+3174756917&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~M))+V[2]+718787259&4294967295,z=B+(O<<15&4294967295|O>>>17),O=M+(B^(z|~b))+V[9]+3951481745&4294967295,D.g[0]=D.g[0]+b&4294967295,D.g[1]=D.g[1]+(z+(O<<21&4294967295|O>>>11))&4294967295,D.g[2]=D.g[2]+z&4294967295,D.g[3]=D.g[3]+B&4294967295}i.prototype.v=function(D,b){b===void 0&&(b=D.length);const M=b-this.blockSize,V=this.C;let z=this.h,B=0;for(;B<b;){if(z==0)for(;B<=M;)r(this,D,B),B+=this.blockSize;if(typeof D=="string"){for(;B<b;)if(V[z++]=D.charCodeAt(B++),z==this.blockSize){r(this,V),z=0;break}}else for(;B<b;)if(V[z++]=D[B++],z==this.blockSize){r(this,V),z=0;break}}this.h=z,this.o+=b},i.prototype.A=function(){var D=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);D[0]=128;for(var b=1;b<D.length-8;++b)D[b]=0;b=this.o*8;for(var M=D.length-8;M<D.length;++M)D[M]=b&255,b/=256;for(this.v(D),D=Array(16),b=0,M=0;M<4;++M)for(let V=0;V<32;V+=8)D[b++]=this.g[M]>>>V&255;return D};function s(D,b){var M=l;return Object.prototype.hasOwnProperty.call(M,D)?M[D]:M[D]=b(D)}function o(D,b){this.h=b;const M=[];let V=!0;for(let z=D.length-1;z>=0;z--){const B=D[z]|0;V&&B==b||(M[z]=B,V=!1)}this.g=M}var l={};function u(D){return-128<=D&&D<128?s(D,function(b){return new o([b|0],b<0?-1:0)}):new o([D|0],D<0?-1:0)}function h(D){if(isNaN(D)||!isFinite(D))return p;if(D<0)return T(h(-D));const b=[];let M=1;for(let V=0;D>=M;V++)b[V]=D/M|0,M*=4294967296;return new o(b,0)}function f(D,b){if(D.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(D.charAt(0)=="-")return T(f(D.substring(1),b));if(D.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=h(Math.pow(b,8));let V=p;for(let B=0;B<D.length;B+=8){var z=Math.min(8,D.length-B);const O=parseInt(D.substring(B,B+z),b);z<8?(z=h(Math.pow(b,z)),V=V.j(z).add(h(O))):(V=V.j(M),V=V.add(h(O)))}return V}var p=u(0),y=u(1),x=u(16777216);n=o.prototype,n.m=function(){if(I(this))return-T(this).m();let D=0,b=1;for(let M=0;M<this.g.length;M++){const V=this.i(M);D+=(V>=0?V:4294967296+V)*b,b*=4294967296}return D},n.toString=function(D){if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(S(this))return"0";if(I(this))return"-"+T(this).toString(D);const b=h(Math.pow(D,6));var M=this;let V="";for(;;){const z=R(M,b).g;M=A(M,z.j(b));let B=((M.g.length>0?M.g[0]:M.h)>>>0).toString(D);if(M=z,S(M))return B+V;for(;B.length<6;)B="0"+B;V=B+V}},n.i=function(D){return D<0?0:D<this.g.length?this.g[D]:this.h};function S(D){if(D.h!=0)return!1;for(let b=0;b<D.g.length;b++)if(D.g[b]!=0)return!1;return!0}function I(D){return D.h==-1}n.l=function(D){return D=A(this,D),I(D)?-1:S(D)?0:1};function T(D){const b=D.g.length,M=[];for(let V=0;V<b;V++)M[V]=~D.g[V];return new o(M,~D.h).add(y)}n.abs=function(){return I(this)?T(this):this},n.add=function(D){const b=Math.max(this.g.length,D.g.length),M=[];let V=0;for(let z=0;z<=b;z++){let B=V+(this.i(z)&65535)+(D.i(z)&65535),O=(B>>>16)+(this.i(z)>>>16)+(D.i(z)>>>16);V=O>>>16,B&=65535,O&=65535,M[z]=O<<16|B}return new o(M,M[M.length-1]&-2147483648?-1:0)};function A(D,b){return D.add(T(b))}n.j=function(D){if(S(this)||S(D))return p;if(I(this))return I(D)?T(this).j(T(D)):T(T(this).j(D));if(I(D))return T(this.j(T(D)));if(this.l(x)<0&&D.l(x)<0)return h(this.m()*D.m());const b=this.g.length+D.g.length,M=[];for(var V=0;V<2*b;V++)M[V]=0;for(V=0;V<this.g.length;V++)for(let z=0;z<D.g.length;z++){const B=this.i(V)>>>16,O=this.i(V)&65535,le=D.i(z)>>>16,pe=D.i(z)&65535;M[2*V+2*z]+=O*pe,P(M,2*V+2*z),M[2*V+2*z+1]+=B*pe,P(M,2*V+2*z+1),M[2*V+2*z+1]+=O*le,P(M,2*V+2*z+1),M[2*V+2*z+2]+=B*le,P(M,2*V+2*z+2)}for(D=0;D<b;D++)M[D]=M[2*D+1]<<16|M[2*D];for(D=b;D<2*b;D++)M[D]=0;return new o(M,0)};function P(D,b){for(;(D[b]&65535)!=D[b];)D[b+1]+=D[b]>>>16,D[b]&=65535,b++}function N(D,b){this.g=D,this.h=b}function R(D,b){if(S(b))throw Error("division by zero");if(S(D))return new N(p,p);if(I(D))return b=R(T(D),b),new N(T(b.g),T(b.h));if(I(b))return b=R(D,T(b)),new N(T(b.g),b.h);if(D.g.length>30){if(I(D)||I(b))throw Error("slowDivide_ only works with positive integers.");for(var M=y,V=b;V.l(D)<=0;)M=L(M),V=L(V);var z=j(M,1),B=j(V,1);for(V=j(V,2),M=j(M,2);!S(V);){var O=B.add(V);O.l(D)<=0&&(z=z.add(M),B=O),V=j(V,1),M=j(M,1)}return b=A(D,z.j(b)),new N(z,b)}for(z=p;D.l(b)>=0;){for(M=Math.max(1,Math.floor(D.m()/b.m())),V=Math.ceil(Math.log(M)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),B=h(M),O=B.j(b);I(O)||O.l(D)>0;)M-=V,B=h(M),O=B.j(b);S(B)&&(B=y),z=z.add(B),D=A(D,O)}return new N(z,D)}n.B=function(D){return R(this,D).h},n.and=function(D){const b=Math.max(this.g.length,D.g.length),M=[];for(let V=0;V<b;V++)M[V]=this.i(V)&D.i(V);return new o(M,this.h&D.h)},n.or=function(D){const b=Math.max(this.g.length,D.g.length),M=[];for(let V=0;V<b;V++)M[V]=this.i(V)|D.i(V);return new o(M,this.h|D.h)},n.xor=function(D){const b=Math.max(this.g.length,D.g.length),M=[];for(let V=0;V<b;V++)M[V]=this.i(V)^D.i(V);return new o(M,this.h^D.h)};function L(D){const b=D.g.length+1,M=[];for(let V=0;V<b;V++)M[V]=D.i(V)<<1|D.i(V-1)>>>31;return new o(M,D.h)}function j(D,b){const M=b>>5;b%=32;const V=D.g.length-M,z=[];for(let B=0;B<V;B++)z[B]=b>0?D.i(B+M)>>>b|D.i(B+M+1)<<32-b:D.i(B+M);return new o(z,D.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,ow=o}).apply(typeof uR<"u"?uR:typeof self<"u"?self:typeof window<"u"?window:{});var Xg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ok,Xh,Fk,dp,Zv,Vk,jk,zk;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xg=="object"&&Xg];for(var E=0;E<g.length;++E){var C=g[E];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=t(this);function r(g,E){if(E)e:{var C=i;g=g.split(".");for(var F=0;F<g.length-1;F++){var X=g[F];if(!(X in C))break e;C=C[X]}g=g[g.length-1],F=C[g],E=E(F),E!=F&&E!=null&&e(C,g,{configurable:!0,writable:!0,value:E})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(E){var C=[],F;for(F in E)Object.prototype.hasOwnProperty.call(E,F)&&C.push([F,E[F]]);return C}});var s=s||{},o=this||self;function l(g){var E=typeof g;return E=="object"&&g!=null||E=="function"}function u(g,E,C){return g.call.apply(g.bind,arguments)}function h(g,E,C){return h=u,h.apply(null,arguments)}function f(g,E){var C=Array.prototype.slice.call(arguments,1);return function(){var F=C.slice();return F.push.apply(F,arguments),g.apply(this,F)}}function p(g,E){function C(){}C.prototype=E.prototype,g.Z=E.prototype,g.prototype=new C,g.prototype.constructor=g,g.Ob=function(F,X,ee){for(var de=Array(arguments.length-2),je=2;je<arguments.length;je++)de[je-2]=arguments[je];return E.prototype[X].apply(F,de)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function x(g){const E=g.length;if(E>0){const C=Array(E);for(let F=0;F<E;F++)C[F]=g[F];return C}return[]}function S(g,E){for(let F=1;F<arguments.length;F++){const X=arguments[F];var C=typeof X;if(C=C!="object"?C:X?Array.isArray(X)?"array":C:"null",C=="array"||C=="object"&&typeof X.length=="number"){C=g.length||0;const ee=X.length||0;g.length=C+ee;for(let de=0;de<ee;de++)g[C+de]=X[de]}else g.push(X)}}class I{constructor(E,C){this.i=E,this.j=C,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function T(g){o.setTimeout(()=>{throw g},0)}function A(){var g=D;let E=null;return g.g&&(E=g.g,g.g=g.g.next,g.g||(g.h=null),E.next=null),E}class P{constructor(){this.h=this.g=null}add(E,C){const F=N.get();F.set(E,C),this.h?this.h.next=F:this.g=F,this.h=F}}var N=new I(()=>new R,g=>g.reset());class R{constructor(){this.next=this.g=this.h=null}set(E,C){this.h=E,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let L,j=!1,D=new P,b=()=>{const g=Promise.resolve(void 0);L=()=>{g.then(M)}};function M(){for(var g;g=A();){try{g.h.call(g.g)}catch(C){T(C)}var E=N;E.j(g),E.h<100&&(E.h++,g.next=E.g,E.g=g)}j=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(g,E){this.type=g,this.g=this.target=E,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,E=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const C=()=>{};o.addEventListener("test",C,E),o.removeEventListener("test",C,E)}catch{}return g})();function O(g){return/^[\s\xa0]*$/.test(g)}function le(g,E){z.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,E)}p(le,z),le.prototype.init=function(g,E){const C=this.type=g.type,F=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=E,E=g.relatedTarget,E||(C=="mouseover"?E=g.fromElement:C=="mouseout"&&(E=g.toElement)),this.relatedTarget=E,F?(this.clientX=F.clientX!==void 0?F.clientX:F.pageX,this.clientY=F.clientY!==void 0?F.clientY:F.pageY,this.screenX=F.screenX||0,this.screenY=F.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&le.Z.h.call(this)},le.prototype.h=function(){le.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var pe="closure_listenable_"+(Math.random()*1e6|0),ge=0;function ue(g,E,C,F,X){this.listener=g,this.proxy=null,this.src=E,this.type=C,this.capture=!!F,this.ha=X,this.key=++ge,this.da=this.fa=!1}function Q(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function se(g,E,C){for(const F in g)E.call(C,g[F],F,g)}function ne(g,E){for(const C in g)E.call(void 0,g[C],C,g)}function W(g){const E={};for(const C in g)E[C]=g[C];return E}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(g,E){let C,F;for(let X=1;X<arguments.length;X++){F=arguments[X];for(C in F)g[C]=F[C];for(let ee=0;ee<$.length;ee++)C=$[ee],Object.prototype.hasOwnProperty.call(F,C)&&(g[C]=F[C])}}function me(g){this.src=g,this.g={},this.h=0}me.prototype.add=function(g,E,C,F,X){const ee=g.toString();g=this.g[ee],g||(g=this.g[ee]=[],this.h++);const de=ke(g,E,F,X);return de>-1?(E=g[de],C||(E.fa=!1)):(E=new ue(E,this.src,ee,!!F,X),E.fa=C,g.push(E)),E};function xe(g,E){const C=E.type;if(C in g.g){var F=g.g[C],X=Array.prototype.indexOf.call(F,E,void 0),ee;(ee=X>=0)&&Array.prototype.splice.call(F,X,1),ee&&(Q(E),g.g[C].length==0&&(delete g.g[C],g.h--))}}function ke(g,E,C,F){for(let X=0;X<g.length;++X){const ee=g[X];if(!ee.da&&ee.listener==E&&ee.capture==!!C&&ee.ha==F)return X}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),Ve={};function We(g,E,C,F,X){if(Array.isArray(E)){for(let ee=0;ee<E.length;ee++)We(g,E[ee],C,F,X);return null}return C=bi(C),g&&g[pe]?g.J(E,C,l(F)?!!F.capture:!1,X):lt(g,E,C,!1,F,X)}function lt(g,E,C,F,X,ee){if(!E)throw Error("Invalid event type");const de=l(X)?!!X.capture:!!X;let je=dn(g);if(je||(g[Me]=je=new me(g)),C=je.add(E,C,F,de,ee),C.proxy)return C;if(F=er(),C.proxy=F,F.src=g,F.listener=C,g.addEventListener)B||(X=de),X===void 0&&(X=!1),g.addEventListener(E.toString(),F,X);else if(g.attachEvent)g.attachEvent($n(E.toString()),F);else if(g.addListener&&g.removeListener)g.addListener(F);else throw Error("addEventListener and attachEvent are unavailable.");return C}function er(){function g(C){return E.call(g.src,g.listener,C)}const E=hn;return g}function fs(g,E,C,F,X){if(Array.isArray(E))for(var ee=0;ee<E.length;ee++)fs(g,E[ee],C,F,X);else F=l(F)?!!F.capture:!!F,C=bi(C),g&&g[pe]?(g=g.i,ee=String(E).toString(),ee in g.g&&(E=g.g[ee],C=ke(E,C,F,X),C>-1&&(Q(E[C]),Array.prototype.splice.call(E,C,1),E.length==0&&(delete g.g[ee],g.h--)))):g&&(g=dn(g))&&(E=g.g[E.toString()],g=-1,E&&(g=ke(E,C,F,X)),(C=g>-1?E[g]:null)&&Wn(C))}function Wn(g){if(typeof g!="number"&&g&&!g.da){var E=g.src;if(E&&E[pe])xe(E.i,g);else{var C=g.type,F=g.proxy;E.removeEventListener?E.removeEventListener(C,F,g.capture):E.detachEvent?E.detachEvent($n(C),F):E.addListener&&E.removeListener&&E.removeListener(F),(C=dn(E))?(xe(C,g),C.h==0&&(C.src=null,E[Me]=null)):Q(g)}}}function $n(g){return g in Ve?Ve[g]:Ve[g]="on"+g}function hn(g,E){if(g.da)g=!0;else{E=new le(E,this);const C=g.listener,F=g.ha||g.src;g.fa&&Wn(g),g=C.call(F,E)}return g}function dn(g){return g=g[Me],g instanceof me?g:null}var Kn="__closure_events_fn_"+(Math.random()*1e9>>>0);function bi(g){return typeof g=="function"?g:(g[Kn]||(g[Kn]=function(E){return g.handleEvent(E)}),g[Kn])}function _t(){V.call(this),this.i=new me(this),this.M=this,this.G=null}p(_t,V),_t.prototype[pe]=!0,_t.prototype.removeEventListener=function(g,E,C,F){fs(this,g,E,C,F)};function ct(g,E){var C,F=g.G;if(F)for(C=[];F;F=F.G)C.push(F);if(g=g.M,F=E.type||E,typeof E=="string")E=new z(E,g);else if(E instanceof z)E.target=E.target||g;else{var X=E;E=new z(F,g),ie(E,X)}X=!0;let ee,de;if(C)for(de=C.length-1;de>=0;de--)ee=E.g=C[de],X=nn(ee,F,!0,E)&&X;if(ee=E.g=g,X=nn(ee,F,!0,E)&&X,X=nn(ee,F,!1,E)&&X,C)for(de=0;de<C.length;de++)ee=E.g=C[de],X=nn(ee,F,!1,E)&&X}_t.prototype.N=function(){if(_t.Z.N.call(this),this.i){var g=this.i;for(const E in g.g){const C=g.g[E];for(let F=0;F<C.length;F++)Q(C[F]);delete g.g[E],g.h--}}this.G=null},_t.prototype.J=function(g,E,C,F){return this.i.add(String(g),E,!1,C,F)},_t.prototype.K=function(g,E,C,F){return this.i.add(String(g),E,!0,C,F)};function nn(g,E,C,F){if(E=g.i.g[String(E)],!E)return!0;E=E.concat();let X=!0;for(let ee=0;ee<E.length;++ee){const de=E[ee];if(de&&!de.da&&de.capture==C){const je=de.listener,jt=de.ha||de.src;de.fa&&xe(g.i,de),X=je.call(jt,F)!==!1&&X}}return X&&!F.defaultPrevented}function Pi(g,E){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:o.setTimeout(g,E||0)}function It(g){g.g=Pi(()=>{g.g=null,g.i&&(g.i=!1,It(g))},g.l);const E=g.h;g.h=null,g.m.apply(null,E)}class to extends V{constructor(E,C){super(),this.m=E,this.l=C,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ki(g){V.call(this),this.h=g,this.g={}}p(ki,V);var Rr=[];function tr(g){se(g.g,function(E,C){this.g.hasOwnProperty(C)&&Wn(E)},g),g.g={}}ki.prototype.N=function(){ki.Z.N.call(this),tr(this)},ki.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ar=o.JSON.stringify,ca=o.JSON.parse,br=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function Di(){}function Fl(){}var Pr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gs(){z.call(this,"d")}p(gs,z);function no(){z.call(this,"c")}p(no,z);var On={},ps=null;function kr(){return ps=ps||new _t}On.Ia="serverreachability";function Dr(g){z.call(this,On.Ia,g)}p(Dr,z);function Fn(g){const E=kr();ct(E,new Dr(E))}On.STAT_EVENT="statevent";function Vn(g,E){z.call(this,On.STAT_EVENT,g),this.stat=E}p(Vn,z);function ft(g){const E=kr();ct(E,new Vn(E,g))}On.Ja="timingevent";function io(g,E){z.call(this,On.Ja,g),this.size=E}p(io,z);function nr(g,E){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},E)}function Ft(){this.g=!0}Ft.prototype.ua=function(){this.g=!1};function Ni(g,E,C,F,X,ee){g.info(function(){if(g.g)if(ee){var de="",je=ee.split("&");for(let ut=0;ut<je.length;ut++){var jt=je[ut].split("=");if(jt.length>1){const Wt=jt[0];jt=jt[1];const pi=Wt.split("_");de=pi.length>=2&&pi[1]=="type"?de+(Wt+"="+jt+"&"):de+(Wt+"=redacted&")}}}else de=null;else de=ee;return"XMLHTTP REQ ("+F+") [attempt "+X+"]: "+E+`
`+C+`
`+de})}function fn(g,E,C,F,X,ee,de){g.info(function(){return"XMLHTTP RESP ("+F+") [ attempt "+X+"]: "+E+`
`+C+`
`+ee+" "+de})}function Vt(g,E,C,F){g.info(function(){return"XMLHTTP TEXT ("+E+"): "+pn(g,C)+(F?" "+F:"")})}function gn(g,E){g.info(function(){return"TIMEOUT: "+E})}Ft.prototype.info=function(){};function pn(g,E){if(!g.g)return E;if(!E)return null;try{const ee=JSON.parse(E);if(ee){for(g=0;g<ee.length;g++)if(Array.isArray(ee[g])){var C=ee[g];if(!(C.length<2)){var F=C[1];if(Array.isArray(F)&&!(F.length<1)){var X=F[0];if(X!="noop"&&X!="stop"&&X!="close")for(let de=1;de<F.length;de++)F[de]=""}}}}return Ar(ee)}catch{return E}}var rn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Gt;function qt(){}p(qt,Di),qt.prototype.g=function(){return new XMLHttpRequest},Gt=new qt;function Mi(g){return encodeURIComponent(String(g))}function Vl(g){var E=1;g=g.split(":");const C=[];for(;E>0&&g.length;)C.push(g.shift()),E--;return g.length&&C.push(g.join(":")),C}function Li(g,E,C,F){this.j=g,this.i=E,this.l=C,this.S=F||1,this.V=new ki(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new wf}function wf(){this.i=null,this.g="",this.h=!1}var Ef={},Fu={};function ir(g,E,C){g.M=1,g.A=ys(Oi(E)),g.u=C,g.R=!0,Vu(g,null)}function Vu(g,E){g.F=Date.now(),ua(g),g.B=Oi(g.A);var C=g.B,F=g.S;Array.isArray(F)||(F=[String(F)]),Xu(C.i,"t",F),g.C=0,C=g.j.L,g.h=new wf,g.g=Df(g.j,C?E:null,!g.u),g.P>0&&(g.O=new to(h(g.Y,g,g.g),g.P)),E=g.V,C=g.g,F=g.ba;var X="readystatechange";Array.isArray(X)||(X&&(Rr[0]=X.toString()),X=Rr);for(let ee=0;ee<X.length;ee++){const de=We(C,X[ee],F||E.handleEvent,!1,E.h||E);if(!de)break;E.g[de.key]=de}E=g.J?W(g.J):{},g.u?(g.v||(g.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,E)):(g.v="GET",g.g.ea(g.B,g.v,null,E)),Fn(),Ni(g.i,g.v,g.B,g.l,g.S,g.u)}Li.prototype.ba=function(g){g=g.target;const E=this.O;E&&jr(g)==3?E.j():this.Y(g)},Li.prototype.Y=function(g){try{if(g==this.g)e:{const je=jr(this.g),jt=this.g.ya(),ut=this.g.ca();if(!(je<3)&&(je!=3||this.g&&(this.h.h||this.g.la()||Pf(this.g)))){this.K||je!=4||jt==7||(jt==8||ut<=0?Fn(3):Fn(2)),jl(this);var E=this.g.ca();this.X=E;var C=Tf(this);if(this.o=E==200,fn(this.i,this.v,this.B,this.l,this.S,je,E),this.o){if(this.U&&!this.L){t:{if(this.g){var F,X=this.g;if((F=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(F)){var ee=F;break t}}ee=null}if(g=ee)Vt(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,xt(this,g);else{this.o=!1,this.m=3,ft(12),ms(this),ha(this);break e}}if(this.R){g=!0;let Wt;for(;!this.K&&this.C<C.length;)if(Wt=If(this,C),Wt==Fu){je==4&&(this.m=4,ft(14),g=!1),Vt(this.i,this.l,null,"[Incomplete Response]");break}else if(Wt==Ef){this.m=4,ft(15),Vt(this.i,this.l,C,"[Invalid Chunk]"),g=!1;break}else Vt(this.i,this.l,Wt,null),xt(this,Wt);if(Sf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),je!=4||C.length!=0||this.h.h||(this.m=1,ft(16),g=!1),this.o=this.o&&g,!g)Vt(this.i,this.l,C,"[Invalid Chunked Response]"),ms(this),ha(this);else if(C.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),xa(de),de.P=!0,ft(11))}}else Vt(this.i,this.l,C,null),xt(this,C);je==4&&ms(this),this.o&&!this.K&&(je==4?ql(this.j,this):(this.o=!1,ua(this)))}else Yu(this.g),E==400&&C.indexOf("Unknown SID")>0?(this.m=3,ft(12)):(this.m=0,ft(13)),ms(this),ha(this)}}}catch{}};function Tf(g){if(!Sf(g))return g.g.la();const E=Pf(g.g);if(E==="")return"";let C="";const F=E.length,X=jr(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ms(g),ha(g),"";g.h.i=new o.TextDecoder}for(let ee=0;ee<F;ee++)g.h.h=!0,C+=g.h.i.decode(E[ee],{stream:!(X&&ee==F-1)});return E.length=0,g.h.g+=C,g.C=0,g.h.g}function Sf(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function If(g,E){var C=g.C,F=E.indexOf(`
`,C);return F==-1?Fu:(C=Number(E.substring(C,F)),isNaN(C)?Ef:(F+=1,F+C>E.length?Fu:(E=E.slice(F,F+C),g.C=F+C,E)))}Li.prototype.cancel=function(){this.K=!0,ms(this)};function ua(g){g.T=Date.now()+g.H,ju(g,g.H)}function ju(g,E){if(g.D!=null)throw Error("WatchDog timer not null");g.D=nr(h(g.aa,g),E)}function jl(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Li.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(gn(this.i,this.B),this.M!=2&&(Fn(),ft(17)),ms(this),this.m=2,ha(this)):ju(this,this.T-g)};function ha(g){g.j.I==0||g.K||ql(g.j,g)}function ms(g){jl(g);var E=g.O;E&&typeof E.dispose=="function"&&E.dispose(),g.O=null,tr(g.V),g.g&&(E=g.g,g.g=null,E.abort(),E.dispose())}function xt(g,E){try{var C=g.j;if(C.I!=0&&(C.g==g||Uu(C.h,g))){if(!g.L&&Uu(C.h,g)&&C.I==3){try{var F=C.Ba.g.parse(E)}catch{F=null}if(Array.isArray(F)&&F.length==3){var X=F;if(X[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<g.F)Xl(C),fi(C);else break e;Br(C),ft(18)}}else C.xa=X[1],0<C.xa-C.K&&X[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=nr(h(C.Va,C),6e3));da(C.h)<=1&&C.ta&&(C.ta=void 0)}else gi(C,11)}else if((g.L||C.g==g)&&Xl(C),!O(E))for(X=C.Ba.g.parse(E),E=0;E<X.length;E++){let ut=X[E];const Wt=ut[0];if(!(Wt<=C.K))if(C.K=Wt,ut=ut[1],C.I==2)if(ut[0]=="c"){C.M=ut[1],C.ba=ut[2];const pi=ut[3];pi!=null&&(C.ka=pi,C.j.info("VER="+C.ka));const Es=ut[4];Es!=null&&(C.za=Es,C.j.info("SVER="+C.za));const Gr=ut[5];Gr!=null&&typeof Gr=="number"&&Gr>0&&(F=1.5*Gr,C.O=F,C.j.info("backChannelRequestTimeoutMs_="+F)),F=C;const Wr=g.g;if(Wr){const Ql=Wr.g?Wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ql){var ee=F.h;ee.g||Ql.indexOf("spdy")==-1&&Ql.indexOf("quic")==-1&&Ql.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(Ul(ee,ee.h),ee.h=null))}if(F.G){const Ju=Wr.g?Wr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ju&&(F.wa=Ju,st(F.J,F.G,Ju))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-g.F,C.j.info("Handshake RTT: "+C.T+"ms")),F=C;var de=g;if(F.na=Qu(F,F.L?F.ba:null,F.W),de.L){fa(F.h,de);var je=de,jt=F.O;jt&&(je.H=jt),je.D&&(jl(je),ua(je)),F.g=de}else Cn(F);C.i.length>0&&ws(C)}else ut[0]!="stop"&&ut[0]!="close"||gi(C,7);else C.I==3&&(ut[0]=="stop"||ut[0]=="close"?ut[0]=="stop"?gi(C,7):Kl(C):ut[0]!="noop"&&C.l&&C.l.qa(ut),C.A=0)}}Fn(4)}catch{}}var xy=class{constructor(g,E){this.g=g,this.map=E}};function zl(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function zu(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function da(g){return g.h?1:g.g?g.g.size:0}function Uu(g,E){return g.h?g.h==E:g.g?g.g.has(E):!1}function Ul(g,E){g.g?g.g.add(E):g.h=E}function fa(g,E){g.h&&g.h==E?g.h=null:g.g&&g.g.has(E)&&g.g.delete(E)}zl.prototype.cancel=function(){if(this.i=ui(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function ui(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let E=g.i;for(const C of g.g.values())E=E.concat(C.G);return E}return x(g.i)}var Cf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hi(g,E){if(g){g=g.split("&");for(let C=0;C<g.length;C++){const F=g[C].indexOf("=");let X,ee=null;F>=0?(X=g[C].substring(0,F),ee=g[C].substring(F+1)):X=g[C],E(X,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Nr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;g instanceof Nr?(this.l=g.l,ga(this,g.j),this.o=g.o,this.g=g.g,Mr(this,g.u),this.h=g.h,ro(this,qu(g.i)),this.m=g.m):g&&(E=String(g).match(Cf))?(this.l=!1,ga(this,E[1]||"",!0),this.o=pa(E[2]||""),this.g=pa(E[3]||"",!0),Mr(this,E[4]),this.h=pa(E[5]||"",!0),ro(this,E[6]||"",!0),this.m=pa(E[7]||"")):(this.l=!1,this.i=new Xe(null,this.l))}Nr.prototype.toString=function(){const g=[];var E=this.j;E&&g.push(ma(E,Gu,!0),":");var C=this.g;return(C||E=="file")&&(g.push("//"),(E=this.o)&&g.push(ma(E,Gu,!0),"@"),g.push(Mi(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&g.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&g.push("/"),g.push(ma(C,C.charAt(0)=="/"?ya:Wu,!0))),(C=this.i.toString())&&g.push("?",C),(C=this.m)&&g.push("#",ma(C,$u)),g.join("")},Nr.prototype.resolve=function(g){const E=Oi(this);let C=!!g.j;C?ga(E,g.j):C=!!g.o,C?E.o=g.o:C=!!g.g,C?E.g=g.g:C=g.u!=null;var F=g.h;if(C)Mr(E,g.u);else if(C=!!g.h){if(F.charAt(0)!="/")if(this.g&&!this.h)F="/"+F;else{var X=E.h.lastIndexOf("/");X!=-1&&(F=E.h.slice(0,X+1)+F)}if(X=F,X==".."||X==".")F="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){F=X.lastIndexOf("/",0)==0,X=X.split("/");const ee=[];for(let de=0;de<X.length;){const je=X[de++];je=="."?F&&de==X.length&&ee.push(""):je==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),F&&de==X.length&&ee.push("")):(ee.push(je),F=!0)}F=ee.join("/")}else F=X}return C?E.h=F:C=g.i.toString()!=="",C?ro(E,qu(g.i)):C=!!g.m,C&&(E.m=g.m),E};function Oi(g){return new Nr(g)}function ga(g,E,C){g.j=C?pa(E,!0):E,g.j&&(g.j=g.j.replace(/:$/,""))}function Mr(g,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);g.u=E}else g.u=null}function ro(g,E,C){E instanceof Xe?(g.i=E,Gl(g.i,g.l)):(C||(E=ma(E,wy)),g.i=new Xe(E,g.l))}function st(g,E,C){g.i.set(E,C)}function ys(g){return st(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function pa(g,E){return g?E?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ma(g,E,C){return typeof g=="string"?(g=encodeURI(g).replace(E,Bu),C&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Bu(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Gu=/[#\/\?@]/g,Wu=/[#\?:]/g,ya=/[#\?]/g,wy=/[#\?@]/g,$u=/#/g;function Xe(g,E){this.h=this.g=null,this.i=g||null,this.j=!!E}function Lr(g){g.g||(g.g=new Map,g.h=0,g.i&&hi(g.i,function(E,C){g.add(decodeURIComponent(E.replace(/\+/g," ")),C)}))}n=Xe.prototype,n.add=function(g,E){Lr(this),this.i=null,g=Or(this,g);let C=this.g.get(g);return C||this.g.set(g,C=[]),C.push(E),this.h+=1,this};function Ku(g,E){Lr(g),E=Or(g,E),g.g.has(E)&&(g.i=null,g.h-=g.g.get(E).length,g.g.delete(E))}function Bl(g,E){return Lr(g),E=Or(g,E),g.g.has(E)}n.forEach=function(g,E){Lr(this),this.g.forEach(function(C,F){C.forEach(function(X){g.call(E,X,F,this)},this)},this)};function Hu(g,E){Lr(g);let C=[];if(typeof E=="string")Bl(g,E)&&(C=C.concat(g.g.get(Or(g,E))));else for(g=Array.from(g.g.values()),E=0;E<g.length;E++)C=C.concat(g[E]);return C}n.set=function(g,E){return Lr(this),this.i=null,g=Or(this,g),Bl(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[E]),this.h+=1,this},n.get=function(g,E){return g?(g=Hu(this,g),g.length>0?String(g[0]):E):E};function Xu(g,E,C){Ku(g,E),C.length>0&&(g.i=null,g.g.set(Or(g,E),x(C)),g.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],E=Array.from(this.g.keys());for(let F=0;F<E.length;F++){var C=E[F];const X=Mi(C);C=Hu(this,C);for(let ee=0;ee<C.length;ee++){let de=X;C[ee]!==""&&(de+="="+Mi(C[ee])),g.push(de)}}return this.i=g.join("&")};function qu(g){const E=new Xe;return E.i=g.i,g.g&&(E.g=new Map(g.g),E.h=g.h),E}function Or(g,E){return E=String(E),g.j&&(E=E.toLowerCase()),E}function Gl(g,E){E&&!g.j&&(Lr(g),g.i=null,g.g.forEach(function(C,F){const X=F.toLowerCase();F!=X&&(Ku(this,F),Xu(this,X,C))},g)),g.j=E}function Fr(g,E){const C=new Ft;if(o.Image){const F=new Image;F.onload=f(mn,C,"TestLoadImage: loaded",!0,E,F),F.onerror=f(mn,C,"TestLoadImage: error",!1,E,F),F.onabort=f(mn,C,"TestLoadImage: abort",!1,E,F),F.ontimeout=f(mn,C,"TestLoadImage: timeout",!1,E,F),o.setTimeout(function(){F.ontimeout&&F.ontimeout()},1e4),F.src=g}else E(!1)}function Vr(g,E){const C=new Ft,F=new AbortController,X=setTimeout(()=>{F.abort(),mn(C,"TestPingServer: timeout",!1,E)},1e4);fetch(g,{signal:F.signal}).then(ee=>{clearTimeout(X),ee.ok?mn(C,"TestPingServer: ok",!0,E):mn(C,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(X),mn(C,"TestPingServer: error",!1,E)})}function mn(g,E,C,F,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),F(C)}catch{}}function _a(){this.g=new br}function _s(g){this.i=g.Sb||null,this.h=g.ab||!1}p(_s,Di),_s.prototype.g=function(){return new di(this.i,this.h)};function di(g,E){_t.call(this),this.H=g,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(di,_t),n=di.prototype,n.open=function(g,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=E,this.readyState=1,rr(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(E.body=g),(this.H||o).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,so(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,rr(this)),this.g&&(this.readyState=3,rr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Rf(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Rf(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var E=g.value?g.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!g.done}))&&(this.response=this.responseText+=E)}g.done?so(this):rr(this),this.readyState==3&&Rf(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,so(this))},n.Na=function(g){this.g&&(this.response=g,so(this))},n.ga=function(){this.g&&so(this)};function so(g){g.readyState=4,g.l=null,g.j=null,g.B=null,rr(g)}n.setRequestHeader=function(g,E){this.A.append(g,E)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],E=this.h.entries();for(var C=E.next();!C.done;)C=C.value,g.push(C[0]+": "+C[1]),C=E.next();return g.join(`\r
`)};function rr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Af(g){let E="";return se(g,function(C,F){E+=F,E+=":",E+=C,E+=`\r
`}),E}function Wl(g,E,C){e:{for(F in C){var F=!1;break e}F=!0}F||(C=Af(C),typeof g=="string"?C!=null&&Mi(C):st(g,E,C))}function pt(g){_t.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(pt,_t);var bf=/^https?$/i,Ey=["POST","PUT"];n=pt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,E,C,F){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);E=E?E.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Gt.g(),this.g.onreadystatechange=y(h(this.Ca,this));try{this.B=!0,this.g.open(E,String(g),!0),this.B=!1}catch(ee){oo(this,ee);return}if(g=C||"",C=new Map(this.headers),F)if(Object.getPrototypeOf(F)===Object.prototype)for(var X in F)C.set(X,F[X]);else if(typeof F.keys=="function"&&typeof F.get=="function")for(const ee of F.keys())C.set(ee,F.get(ee));else throw Error("Unknown input type for opt_headers: "+String(F));F=Array.from(C.keys()).find(ee=>ee.toLowerCase()=="content-type"),X=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(Ey,E,void 0)>=0)||F||X||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,de]of C)this.g.setRequestHeader(ee,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(ee){oo(this,ee)}};function oo(g,E){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=E,g.o=5,ao(g),xs(g)}function ao(g){g.A||(g.A=!0,ct(g,"complete"),ct(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ct(this,"complete"),ct(this,"abort"),xs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xs(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?vs(this):this.Xa())},n.Xa=function(){vs(this)};function vs(g){if(g.h&&typeof s<"u"){if(g.v&&jr(g)==4)setTimeout(g.Ca.bind(g),0);else if(ct(g,"readystatechange"),jr(g)==4){g.h=!1;try{const ee=g.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var C;if(!(C=E)){var F;if(F=ee===0){let de=String(g.D).match(Cf)[1]||null;!de&&o.self&&o.self.location&&(de=o.self.location.protocol.slice(0,-1)),F=!bf.test(de?de.toLowerCase():"")}C=F}if(C)ct(g,"complete"),ct(g,"success");else{g.o=6;try{var X=jr(g)>2?g.g.statusText:""}catch{X=""}g.l=X+" ["+g.ca()+"]",ao(g)}}finally{xs(g)}}}}function xs(g,E){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const C=g.g;g.g=null,E||ct(g,"ready");try{C.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function jr(g){return g.g?g.g.readyState:0}n.ca=function(){try{return jr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var E=this.g.responseText;return g&&E.indexOf(g)==0&&(E=E.substring(g.length)),ca(E)}};function Pf(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Yu(g){const E={};g=(g.g&&jr(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let F=0;F<g.length;F++){if(O(g[F]))continue;var C=Vl(g[F]);const X=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ee=E[X]||[];E[X]=ee,ee.push(C)}ne(E,function(F){return F.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function zr(g,E,C){return C&&C.internalChannelParams&&C.internalChannelParams[g]||E}function $l(g){this.za=0,this.i=[],this.j=new Ft,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=zr("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=zr("baseRetryDelayMs",5e3,g),this.Za=zr("retryDelaySeedMs",1e4,g),this.Ta=zr("forwardChannelMaxRetries",2,g),this.va=zr("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new zl(g&&g.concurrentRequestLimit),this.Ba=new _a,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=$l.prototype,n.ka=8,n.I=1,n.connect=function(g,E,C,F){ft(0),this.W=g,this.H=E||{},C&&F!==void 0&&(this.H.OSID=C,this.H.OAID=F),this.F=this.X,this.J=Qu(this,null,this.W),ws(this)};function Kl(g){if(Hl(g),g.I==3){var E=g.V++,C=Oi(g.J);if(st(C,"SID",g.M),st(C,"RID",E),st(C,"TYPE","terminate"),Ur(g,C),E=new Li(g,g.j,E),E.M=2,E.A=ys(Oi(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(E.A.toString(),"")}catch{}!C&&o.Image&&(new Image().src=E.A,C=!0),C||(E.g=Df(E.j,null),E.g.ea(E.A)),E.F=Date.now(),ua(E)}wa(g)}function fi(g){g.g&&(xa(g),g.g.cancel(),g.g=null)}function Hl(g){fi(g),g.v&&(o.clearTimeout(g.v),g.v=null),Xl(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function ws(g){if(!zu(g.h)&&!g.m){g.m=!0;var E=g.Ea;L||b(),j||(L(),j=!0),D.add(E,g),g.D=0}}function kf(g,E){return da(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=E.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=nr(h(g.Ea,g,E),Yl(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const X=new Li(this,this.j,g);let ee=this.o;if(this.U&&(ee?(ee=W(ee),ie(ee,this.U)):ee=this.U),this.u!==null||this.R||(X.J=ee,ee=null),this.S)e:{for(var E=0,C=0;C<this.i.length;C++){t:{var F=this.i[C];if("__data__"in F.map&&(F=F.map.__data__,typeof F=="string")){F=F.length;break t}F=void 0}if(F===void 0)break;if(E+=F,E>4096){E=C;break e}if(E===4096||C===this.i.length-1){E=C+1;break e}}E=1e3}else E=1e3;E=Zu(this,X,E),C=Oi(this.J),st(C,"RID",g),st(C,"CVER",22),this.G&&st(C,"X-HTTP-Session-Id",this.G),Ur(this,C),ee&&(this.R?E="headers="+Mi(Af(ee))+"&"+E:this.u&&Wl(C,this.u,ee)),Ul(this.h,X),this.Ra&&st(C,"TYPE","init"),this.S?(st(C,"$req",E),st(C,"SID","null"),X.U=!0,ir(X,C,null)):ir(X,C,E),this.I=2}}else this.I==3&&(g?va(this,g):this.i.length==0||zu(this.h)||va(this))};function va(g,E){var C;E?C=E.l:C=g.V++;const F=Oi(g.J);st(F,"SID",g.M),st(F,"RID",C),st(F,"AID",g.K),Ur(g,F),g.u&&g.o&&Wl(F,g.u,g.o),C=new Li(g,g.j,C,g.D+1),g.u===null&&(C.J=g.o),E&&(g.i=E.G.concat(g.i)),E=Zu(g,C,1e3),C.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Ul(g.h,C),ir(C,F,E)}function Ur(g,E){g.H&&se(g.H,function(C,F){st(E,F,C)}),g.l&&se({},function(C,F){st(E,F,C)})}function Zu(g,E,C){C=Math.min(g.i.length,C);const F=g.l?h(g.l.Ka,g.l,g):null;e:{var X=g.i;let je=-1;for(;;){const jt=["count="+C];je==-1?C>0?(je=X[0].g,jt.push("ofs="+je)):je=0:jt.push("ofs="+je);let ut=!0;for(let Wt=0;Wt<C;Wt++){var ee=X[Wt].g;const pi=X[Wt].map;if(ee-=je,ee<0)je=Math.max(0,X[Wt].g-100),ut=!1;else try{ee="req"+ee+"_"||"";try{var de=pi instanceof Map?pi:Object.entries(pi);for(const[Es,Gr]of de){let Wr=Gr;l(Gr)&&(Wr=Ar(Gr)),jt.push(ee+Es+"="+encodeURIComponent(Wr))}}catch(Es){throw jt.push(ee+"type="+encodeURIComponent("_badmap")),Es}}catch{F&&F(pi)}}if(ut){de=jt.join("&");break e}}de=void 0}return g=g.i.splice(0,C),E.G=g,de}function Cn(g){if(!g.g&&!g.v){g.Y=1;var E=g.Da;L||b(),j||(L(),j=!0),D.add(E,g),g.A=0}}function Br(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=nr(h(g.Da,g),Yl(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,lo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=nr(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ft(10),fi(this),lo(this))};function xa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function lo(g){g.g=new Li(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var E=Oi(g.na);st(E,"RID","rpc"),st(E,"SID",g.M),st(E,"AID",g.K),st(E,"CI",g.F?"0":"1"),!g.F&&g.ia&&st(E,"TO",g.ia),st(E,"TYPE","xmlhttp"),Ur(g,E),g.u&&g.o&&Wl(E,g.u,g.o),g.O&&(g.g.H=g.O);var C=g.g;g=g.ba,C.M=1,C.A=ys(Oi(E)),C.u=null,C.R=!0,Vu(C,g)}n.Va=function(){this.C!=null&&(this.C=null,fi(this),Br(this),ft(19))};function Xl(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function ql(g,E){var C=null;if(g.g==E){Xl(g),xa(g),g.g=null;var F=2}else if(Uu(g.h,E))C=E.G,fa(g.h,E),F=1;else return;if(g.I!=0){if(E.o)if(F==1){C=E.u?E.u.length:0,E=Date.now()-E.F;var X=g.D;F=kr(),ct(F,new io(F,C)),ws(g)}else Cn(g);else if(X=E.m,X==3||X==0&&E.X>0||!(F==1&&kf(g,E)||F==2&&Br(g)))switch(C&&C.length>0&&(E=g.h,E.i=E.i.concat(C)),X){case 1:gi(g,5);break;case 4:gi(g,10);break;case 3:gi(g,6);break;default:gi(g,2)}}}function Yl(g,E){let C=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(C*=2),C*E}function gi(g,E){if(g.j.info("Error code "+E),E==2){var C=h(g.bb,g),F=g.Ua;const X=!F;F=new Nr(F||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ga(F,"https"),ys(F),X?Fr(F.toString(),C):Vr(F.toString(),C)}else ft(2);g.I=0,g.l&&g.l.pa(E),wa(g),Hl(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function wa(g){if(g.I=0,g.ja=[],g.l){const E=ui(g.h);(E.length!=0||g.i.length!=0)&&(S(g.ja,E),S(g.ja,g.i),g.h.i.length=0,x(g.i),g.i.length=0),g.l.oa()}}function Qu(g,E,C){var F=C instanceof Nr?Oi(C):new Nr(C);if(F.g!="")E&&(F.g=E+"."+F.g),Mr(F,F.u);else{var X=o.location;F=X.protocol,E=E?E+"."+X.hostname:X.hostname,X=+X.port;const ee=new Nr(null);F&&ga(ee,F),E&&(ee.g=E),X&&Mr(ee,X),C&&(ee.h=C),F=ee}return C=g.G,E=g.wa,C&&E&&st(F,C,E),st(F,"VER",g.ka),Ur(g,F),F}function Df(g,E,C){if(E&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=g.Aa&&!g.ma?new pt(new _s({ab:C})):new pt(g.ma),E.Fa(g.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Nf(){}n=Nf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Zl(){}Zl.prototype.g=function(g,E){return new yn(g,E)};function yn(g,E){_t.call(this),this.g=new $l(E),this.l=g,this.h=E&&E.messageUrlParams||null,g=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(g?g["X-WebChannel-Content-Type"]=E.messageContentType:g={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(g?g["X-WebChannel-Client-Profile"]=E.sa:g={"X-WebChannel-Client-Profile":E.sa}),this.g.U=g,(g=E&&E.Qb)&&!O(g)&&(this.g.u=g),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!O(E)&&(this.g.G=E,g=this.h,g!==null&&E in g&&(g=this.h,E in g&&delete g[E])),this.j=new co(this)}p(yn,_t),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){Kl(this.g)},yn.prototype.o=function(g){var E=this.g;if(typeof g=="string"){var C={};C.__data__=g,g=C}else this.v&&(C={},C.__data__=Ar(g),g=C);E.i.push(new xy(E.Ya++,g)),E.I==3&&ws(E)},yn.prototype.N=function(){this.g.l=null,delete this.j,Kl(this.g),delete this.g,yn.Z.N.call(this)};function Mf(g){gs.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var E=g.__sm__;if(E){e:{for(const C in E){g=C;break e}g=void 0}(this.i=g)&&(g=this.i,E=E!==null&&g in E?E[g]:void 0),this.data=E}else this.data=g}p(Mf,gs);function Lf(){no.call(this),this.status=1}p(Lf,no);function co(g){this.g=g}p(co,Nf),co.prototype.ra=function(){ct(this.g,"a")},co.prototype.qa=function(g){ct(this.g,new Mf(g))},co.prototype.pa=function(g){ct(this.g,new Lf)},co.prototype.oa=function(){ct(this.g,"b")},Zl.prototype.createWebChannel=Zl.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,zk=function(){return new Zl},jk=function(){return kr()},Vk=On,Zv={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},rn.NO_ERROR=0,rn.TIMEOUT=8,rn.HTTP_ERROR=6,dp=rn,rt.COMPLETE="complete",Fk=rt,Fl.EventType=Pr,Pr.OPEN="a",Pr.CLOSE="b",Pr.ERROR="c",Pr.MESSAGE="d",_t.prototype.listen=_t.prototype.J,Xh=Fl,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,Ok=pt}).apply(typeof Xg<"u"?Xg:typeof self<"u"?self:typeof window<"u"?window:{});const hR="@firebase/firestore",dR="4.9.3";let wn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};wn.UNAUTHENTICATED=new wn(null),wn.GOOGLE_CREDENTIALS=new wn("google-credentials-uid"),wn.FIRST_PARTY=new wn("first-party-uid"),wn.MOCK_USER=new wn("mock-user");let Lu="12.7.0";const Sl=new H1("@firebase/firestore");function Oc(){return Sl.logLevel}function fe(n,...e){if(Sl.logLevel<=He.DEBUG){const t=e.map(aw);Sl.debug(`Firestore (${Lu}): ${n}`,...t)}}function Ei(n,...e){if(Sl.logLevel<=He.ERROR){const t=e.map(aw);Sl.error(`Firestore (${Lu}): ${n}`,...t)}}function ey(n,...e){if(Sl.logLevel<=He.WARN){const t=e.map(aw);Sl.warn(`Firestore (${Lu}): ${n}`,...t)}}function aw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Re(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Uk(n,i,t)}function Uk(n,e,t){let i=`FIRESTORE (${Lu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ei(i),new Error(i)}function Ne(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||Uk(e,r,i)}function St(n,e){return n}const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends hs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class cl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Bk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class k8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(wn.UNAUTHENTICATED)))}shutdown(){}}class D8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class N8{constructor(e){this.t=e,this.currentUser=wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ne(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new cl;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new cl,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},l=u=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new cl)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ne(typeof i.accessToken=="string",31837,{l:i}),new Bk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ne(e===null||typeof e=="string",2055,{h:e}),new wn(e)}}class M8{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class L8{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new M8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(wn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class fR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class O8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ki(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ne(this.o===void 0,3512);const i=s=>{s.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new fR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ne(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new fR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function F8(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Gk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=F8(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function Ke(n,e){return n<e?-1:n>e?1:0}function Qv(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return K0(r)===K0(s)?Ke(r,s):K0(r)?1:-1}return Ke(n.length,e.length)}const V8=55296,j8=57343;function K0(n){const e=n.charCodeAt(0);return e>=V8&&e<=j8}function mu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function Wk(n){return n+"\0"}const gR="__name__";class qr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Re(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Re(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return qr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=qr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return Ke(e.length,t.length)}static compareSegments(e,t){const i=qr.isNumericId(e),r=qr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?qr.extractNumericId(e).compare(qr.extractNumericId(t)):Qv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ow.fromString(e.substring(4,e.length-2))}}class Rt extends qr{construct(e,t,i){return new Rt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Se(ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Rt(t)}static emptyPath(){return new Rt([])}}const z8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bt extends qr{construct(e,t,i){return new Bt(e,t,i)}static isValidIdentifier(e){return z8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===gR}static keyField(){return new Bt([gR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Se(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Se(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Se(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new Se(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bt(t)}static emptyPath(){return new Bt([])}}class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(Rt.fromString(e))}static fromName(e){return new Ee(Rt.fromString(e).popFirst(5))}static empty(){return new Ee(Rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Rt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new Rt(e.slice()))}}function U8(n,e,t,i){if(e===!0&&i===!0)throw new Se(ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function B8(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function G8(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Re(12329,{type:typeof n})}function $k(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Se(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=G8(n);throw new Se(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Xt(n,e){const t={typeString:n};return e&&(t.value=e),t}function yf(n,e){if(!B8(n))throw new Se(ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Se(ae.INVALID_ARGUMENT,t);return!0}const pR=-62135596800,mR=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*mR);return new kt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Se(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Se(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<pR)throw new Se(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/mR}_compareTo(e){return this.seconds===e.seconds?Ke(this.nanoseconds,e.nanoseconds):Ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(yf(e,kt._jsonSchema))return new kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-pR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}kt._jsonSchemaVersion="firestore/timestamp/1.0",kt._jsonSchema={type:Xt("string",kt._jsonSchemaVersion),seconds:Xt("number"),nanoseconds:Xt("number")};class Qe{static fromTimestamp(e){return new Qe(e)}static min(){return new Qe(new kt(0,0))}static max(){return new Qe(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const jd=-1;class tm{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Jv(n){return n.fields.find((e=>e.kind===2))}function Wa(n){return n.fields.filter((e=>e.kind!==2))}tm.UNKNOWN_ID=-1;class fp{constructor(e,t){this.fieldPath=e,this.kind=t}}class zd{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new zd(0,Ai.min())}}function W8(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Qe.fromTimestamp(i===1e9?new kt(t+1,0):new kt(t,i));return new Ai(r,Ee.empty(),e)}function Kk(n){return new Ai(n.readTime,n.key,jd)}class Ai{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ai(Qe.min(),Ee.empty(),jd)}static max(){return new Ai(Qe.max(),Ee.empty(),jd)}}function lw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:Ke(n.largestBatchId,e.largestBatchId))}const Hk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Xk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ty(n){if(n.code!==ae.FAILED_PRECONDITION||n.message!==Hk)throw n;fe("LocalStore","Unexpectedly lost primary lease")}class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Z(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Z?t:Z.resolve(t)}catch(t){return Z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.reject(t)}static resolve(e){return new Z(((t,i)=>{t(e)}))}static reject(e){return new Z(((t,i)=>{i(e)}))}static waitFor(e){return new Z(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=Z.resolve(!1);for(const i of e)t=t.next((r=>r?Z.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Z(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new Z(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const vi="SimpleDb";class ny{static open(e,t,i,r){try{return new ny(t,e.transaction(r,i))}catch(s){throw new rd(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new cl,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new rd(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=cw(i.target.error);this.S.reject(new rd(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(fe(vi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new K8(t)}}class Qo{static delete(e){return fe(vi,"Removing database:",e),Ha($P().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ek())return!1;if(Qo.F())return!0;const e=en(),t=Qo.M(e),i=0<t&&t<10,r=qk(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Qo.M(en())===12.2&&Ei("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(fe(vi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new rd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Se(ae.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Se(ae.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new rd(e,o))},r.onupgradeneeded=s=>{fe(vi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{fe(vi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=ny.open(this.db,e,s?"readonly":"readwrite",i),u=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),Z.reject(h)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,h=u.name!=="FirebaseError"&&o<3;if(fe(vi,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function qk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class $8{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ha(this.U.delete())}}class rd extends Se{constructor(e,t){super(ae.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ol(n){return n.name==="IndexedDbTransactionError"}class K8{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(fe(vi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(fe(vi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ha(i)}add(e){return fe(vi,"ADD",this.store.name,e,e),Ha(this.store.add(e))}get(e){return Ha(this.store.get(e)).next((t=>(t===void 0&&(t=null),fe(vi,"GET",this.store.name,e,t),t)))}delete(e){return fe(vi,"DELETE",this.store.name,e),Ha(this.store.delete(e))}count(){return fe(vi,"COUNT",this.store.name),Ha(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Z(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Z(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){fe(vi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Z(((i,r)=>{t.onerror=s=>{const o=cw(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Z(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new $8(l),h=t(l.primaryKey,l.value,u);if(h instanceof Z){const f=h.catch((p=>(u.done(),Z.reject(p))));i.push(f)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}})).next((()=>Z.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ha(n){return new Z(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=cw(i.target.error);t(r)}}))}let yR=!1;function cw(n){const e=Qo.M(en());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Se("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return yR||(yR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const sd="IndexBackfiller";class H8{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){fe(sd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();fe(sd,`Documents written: ${t}`)}catch(t){Ol(t)?fe(sd,"Ignoring IndexedDB error during index backfill: ",t):await ty(t)}await this.re(6e4)}))}}class X8{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Z.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return fe(sd,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(fe(sd,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=Kk(s);lw(o,i)>0&&(i=o)})),new Ai(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class vr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}vr.ce=-1;const ul=-1;function iy(n){return n==null}function nm(n){return n===0&&1/n==-1/0}const im="";function Gn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=_R(e)),e=q8(n.get(t),e);return _R(e)}function q8(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case im:t+="";break;default:t+=s}}return t}function _R(n){return n+im+""}function Jr(n){const e=n.length;if(Ne(e>=2,64408,{path:n}),e===2)return Ne(n.charAt(0)===im&&n.charAt(1)==="",56145,{path:n}),Rt.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(im,s);switch((o<0||o>t)&&Re(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Re(61167,{path:n})}s=o+2}return new Rt(i)}const $a="remoteDocuments",_f="owner",Cc="owner",Ud="mutationQueues",Y8="userId",fr="mutations",vR="batchId",il="userMutationsIndex",xR=["userId","batchId"];function gp(n,e){return[n,Gn(e)]}function Yk(n,e,t){return[n,Gn(e),t]}const Z8={},yu="documentMutations",rm="remoteDocumentsV14",Q8=["prefixPath","collectionGroup","readTime","documentId"],pp="documentKeyIndex",J8=["prefixPath","collectionGroup","documentId"],Zk="collectionGroupIndex",eG=["collectionGroup","readTime","prefixPath","documentId"],Bd="remoteDocumentGlobal",ex="remoteDocumentGlobalKey",_u="targets",Qk="queryTargetsIndex",tG=["canonicalId","targetId"],vu="targetDocuments",nG=["targetId","path"],uw="documentTargetsIndex",iG=["path","targetId"],sm="targetGlobalKey",hl="targetGlobal",Gd="collectionParents",rG=["collectionId","parent"],xu="clientMetadata",sG="clientId",ry="bundles",oG="bundleId",sy="namedQueries",aG="name",hw="indexConfiguration",lG="indexId",tx="collectionGroupIndex",cG="collectionGroup",od="indexState",uG=["indexId","uid"],Jk="sequenceNumberIndex",hG=["uid","sequenceNumber"],ad="indexEntries",dG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],eD="documentKeyIndex",fG=["indexId","uid","orderedDocumentKey"],oy="documentOverlays",gG=["userId","collectionPath","documentId"],nx="collectionPathOverlayIndex",pG=["userId","collectionPath","largestBatchId"],tD="collectionGroupOverlayIndex",mG=["userId","collectionGroup","largestBatchId"],dw="globals",yG="name",nD=[Ud,fr,yu,$a,_u,_f,hl,vu,xu,Bd,Gd,ry,sy],_G=[...nD,oy],iD=[Ud,fr,yu,rm,_u,_f,hl,vu,xu,Bd,Gd,ry,sy,oy],rD=iD,fw=[...rD,hw,od,ad],vG=fw,sD=[...fw,dw],xG=sD;class ix extends Xk{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function tn(n,e){const t=St(n);return Qo.O(t.le,e)}function wR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function gw(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function wG(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class li{constructor(e,t){this.comparator=e,this.root=t||En.EMPTY}insert(e,t){return new li(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new li(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qg(this.root,e,this.comparator,!1)}getReverseIterator(){return new qg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qg(this.root,e,this.comparator,!0)}}class qg{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??En.RED,this.left=r??En.EMPTY,this.right=s??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new En(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return En.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Re(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw Re(57766)}get value(){throw Re(16141)}get color(){throw Re(16727)}get left(){throw Re(29726)}get right(){throw Re(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new En(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class yt{constructor(e){this.comparator=e,this.data=new li(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ER(this.data.getIterator())}getIteratorFrom(e){return new ER(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof yt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new yt(this.comparator);return t.data=e,t}}class ER{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Rc(n){return n.hasNext()?n.getNext():void 0}class js{constructor(e){this.fields=e,e.sort(Bt.comparator)}static empty(){return new js([])}unionWith(e){let t=new yt(Bt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new js(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return mu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class EG extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ci{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new EG("Invalid base64 string: "+s):s}})(e);return new ci(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new ci(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ci.EMPTY_BYTE_STRING=new ci("");const TG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ia(n){if(Ne(!!n,39018),typeof n=="string"){let e=0;const t=TG.exec(n);if(Ne(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ht(n.seconds),nanos:Ht(n.nanos)}}function Ht(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wu(n){return typeof n=="string"?ci.fromBase64String(n):ci.fromUint8Array(n)}const oD="server_timestamp",aD="__type__",lD="__previous_value__",cD="__local_write_time__";function pw(n){return(n?.mapValue?.fields||{})[aD]?.stringValue===oD}function uD(n){const e=n.mapValue.fields[lD];return pw(e)?uD(e):e}function om(n){const e=ia(n.mapValue.fields[cD].timestampValue);return new kt(e.seconds,e.nanos)}class SG{constructor(e,t,i,r,s,o,l,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const am="(default)";class Eu{constructor(e,t){this.projectId=e,this.database=t||am}static empty(){return new Eu("","")}get isDefaultDatabase(){return this.database===am}isEqual(e){return e instanceof Eu&&e.projectId===this.projectId&&e.database===this.database}}const hD="__type__",dD="__max__",Ko={mapValue:{fields:{__type__:{stringValue:dD}}}},fD="__vector__",lm="value",mp={nullValue:"NULL_VALUE"};function Tu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?pw(n)?4:gD(n)?9007199254740991:ay(n)?10:11:Re(28295,{value:n})}function as(n,e){if(n===e)return!0;const t=Tu(n);if(t!==Tu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return om(n).isEqual(om(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ia(r.timestampValue),l=ia(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return wu(r.bytesValue).isEqual(wu(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Ht(r.geoPointValue.latitude)===Ht(s.geoPointValue.latitude)&&Ht(r.geoPointValue.longitude)===Ht(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Ht(r.integerValue)===Ht(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Ht(r.doubleValue),l=Ht(s.doubleValue);return o===l?nm(o)===nm(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return mu(n.arrayValue.values||[],e.arrayValue.values||[],as);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(wR(o)!==wR(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!as(o[u],l[u])))return!1;return!0})(n,e);default:return Re(52216,{left:n})}}function Wd(n,e){return(n.values||[]).find((t=>as(t,e)))!==void 0}function ra(n,e){if(n===e)return 0;const t=Tu(n),i=Tu(e);if(t!==i)return Ke(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ke(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=Ht(s.integerValue||s.doubleValue),u=Ht(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return TR(n.timestampValue,e.timestampValue);case 4:return TR(om(n),om(e));case 5:return Qv(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=wu(s),u=wu(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=Ke(l[h],u[h]);if(f!==0)return f}return Ke(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=Ke(Ht(s.latitude),Ht(o.latitude));return l!==0?l:Ke(Ht(s.longitude),Ht(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return SR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[lm]?.arrayValue,f=u[lm]?.arrayValue,p=Ke(h?.values?.length||0,f?.values?.length||0);return p!==0?p:SR(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Ko.mapValue&&o===Ko.mapValue)return 0;if(s===Ko.mapValue)return 1;if(o===Ko.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const y=Qv(u[p],f[p]);if(y!==0)return y;const x=ra(l[u[p]],h[f[p]]);if(x!==0)return x}return Ke(u.length,f.length)})(n.mapValue,e.mapValue);default:throw Re(23264,{he:t})}}function TR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ke(n,e);const t=ia(n),i=ia(e),r=Ke(t.seconds,i.seconds);return r!==0?r:Ke(t.nanos,i.nanos)}function SR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=ra(t[r],i[r]);if(s)return s}return Ke(t.length,i.length)}function Su(n){return rx(n)}function rx(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ia(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return wu(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ee.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=rx(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${rx(t.fields[o])}`;return r+"}"})(n.mapValue):Re(61005,{value:n})}function mw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function sx(n){return!!n&&"integerValue"in n}function $d(n){return!!n&&"arrayValue"in n}function IR(n){return!!n&&"nullValue"in n}function CR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function H0(n){return!!n&&"mapValue"in n}function ay(n){return(n?.mapValue?.fields||{})[hD]?.stringValue===fD}function ld(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return gw(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=ld(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ld(n.arrayValue.values[t]);return e}return{...n}}function gD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===dD}const pD={mapValue:{fields:{[hD]:{stringValue:fD},[lm]:{arrayValue:{}}}}};function IG(n){return"nullValue"in n?mp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?mw(Eu.empty(),Ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?ay(n)?pD:{mapValue:{}}:Re(35942,{value:n})}function CG(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?mw(Eu.empty(),Ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?pD:"mapValue"in n?ay(n)?{mapValue:{}}:Ko:Re(61959,{value:n})}function RR(n,e){const t=ra(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function AR(n,e){const t=ra(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class yr{constructor(e){this.value=e}static empty(){return new yr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!H0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ld(t)}setAll(e){let t=Bt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=ld(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());H0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return as(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];H0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){gw(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new yr(ld(this.value))}}class Tn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Qe.min(),Qe.min(),Qe.min(),yr.empty(),0)}static newFoundDocument(e,t,i,r){return new Tn(e,1,t,Qe.min(),i,r,0)}static newNoDocument(e,t){return new Tn(e,2,t,Qe.min(),Qe.min(),yr.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Qe.min(),Qe.min(),yr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Iu{constructor(e,t){this.position=e,this.inclusive=t}}function bR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Ee.comparator(Ee.fromName(o.referenceValue),t.key):i=ra(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function PR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!as(n.position[t],e.position[t]))return!1;return!0}class cm{constructor(e,t="asc"){this.field=e,this.dir=t}}function RG(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class mD{}class Ye extends mD{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new AG(e,t,i):t==="array-contains"?new kG(e,i):t==="in"?new ED(e,i):t==="not-in"?new DG(e,i):t==="array-contains-any"?new NG(e,i):new Ye(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new bG(e,i):new PG(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ra(t,this.value)):t!==null&&Tu(this.value)===Tu(t)&&this.matchesComparison(ra(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gt extends mD{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gt(e,t)}matches(e){return Cu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Cu(n){return n.op==="and"}function ox(n){return n.op==="or"}function yw(n){return yD(n)&&Cu(n)}function yD(n){for(const e of n.filters)if(e instanceof gt)return!1;return!0}function ax(n){if(n instanceof Ye)return n.field.canonicalString()+n.op.toString()+Su(n.value);if(yw(n))return n.filters.map((e=>ax(e))).join(",");{const e=n.filters.map((t=>ax(t))).join(",");return`${n.op}(${e})`}}function _D(n,e){return n instanceof Ye?(function(i,r){return r instanceof Ye&&i.op===r.op&&i.field.isEqual(r.field)&&as(i.value,r.value)})(n,e):n instanceof gt?(function(i,r){return r instanceof gt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&_D(o,r.filters[l])),!0):!1})(n,e):void Re(19439)}function vD(n,e){const t=n.filters.concat(e);return gt.create(t,n.op)}function xD(n){return n instanceof Ye?(function(t){return`${t.field.canonicalString()} ${t.op} ${Su(t.value)}`})(n):n instanceof gt?(function(t){return t.op.toString()+" {"+t.getFilters().map(xD).join(" ,")+"}"})(n):"Filter"}class AG extends Ye{constructor(e,t,i){super(e,t,i),this.key=Ee.fromName(i.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class bG extends Ye{constructor(e,t){super(e,"in",t),this.keys=wD("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class PG extends Ye{constructor(e,t){super(e,"not-in",t),this.keys=wD("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function wD(n,e){return(e.arrayValue?.values||[]).map((t=>Ee.fromName(t.referenceValue)))}class kG extends Ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return $d(t)&&Wd(t.arrayValue,this.value)}}class ED extends Ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Wd(this.value.arrayValue,t)}}class DG extends Ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Wd(this.value.arrayValue,t)}}class NG extends Ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!$d(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Wd(this.value.arrayValue,i)))}}class MG{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function lx(n,e=null,t=[],i=[],r=null,s=null,o=null){return new MG(n,e,t,i,r,s,o)}function Il(n){const e=St(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>ax(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),iy(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Su(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Su(i))).join(",")),e.Te=t}return e.Te}function vf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!RG(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_D(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!PR(n.startAt,e.startAt)&&PR(n.endAt,e.endAt)}function LG(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function um(n,e){return n.filters.filter((t=>t instanceof Ye&&t.field.isEqual(e)))}function kR(n,e,t){let i=mp,r=!0;for(const s of um(n,e)){let o=mp,l=!0;switch(s.op){case"<":case"<=":o=IG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=mp}RR({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];RR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function DR(n,e,t){let i=Ko,r=!0;for(const s of um(n,e)){let o=Ko,l=!0;switch(s.op){case">=":case">":o=CG(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Ko}AR({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];AR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class ly{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function OG(n,e,t,i,r,s,o,l){return new ly(n,e,t,i,r,s,o,l)}function TD(n){return new ly(n)}function NR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function FG(n){return n.collectionGroup!==null}function cd(n){const e=St(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new yt(Bt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new cm(s,i))})),t.has(Bt.keyField().canonicalString())||e.Ie.push(new cm(Bt.keyField(),i))}return e.Ie}function $s(n){const e=St(n);return e.Ee||(e.Ee=VG(e,cd(n))),e.Ee}function VG(n,e){if(n.limitType==="F")return lx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new cm(r.field,s)}));const t=n.endAt?new Iu(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Iu(n.startAt.position,n.startAt.inclusive):null;return lx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function cx(n,e,t){return new ly(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function SD(n,e){return vf($s(n),$s(e))&&n.limitType===e.limitType}function ID(n){return`${Il($s(n))}|lt:${n.limitType}`}function Dh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>xD(r))).join(", ")}]`),iy(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Su(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Su(r))).join(",")),`Target(${i})`})($s(n))}; limitType=${n.limitType})`}function cy(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ee.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of cd(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,u){const h=bR(o,l,u);return o.inclusive?h<=0:h<0})(i.startAt,cd(i),r)||i.endAt&&!(function(o,l,u){const h=bR(o,l,u);return o.inclusive?h>=0:h>0})(i.endAt,cd(i),r))})(n,e)}function jG(n){return(e,t)=>{let i=!1;for(const r of cd(n)){const s=zG(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function zG(n,e,t){const i=n.field.isKeyField()?Ee.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?ra(u,h):Re(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Re(19790,{direction:n.dir})}}class la{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){gw(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return wG(this.inner)}size(){return this.innerSize}}const UG=new li(Ee.comparator);function rl(){return UG}const CD=new li(Ee.comparator);function Yg(...n){let e=CD;for(const t of n)e=e.insert(t.key,t);return e}function BG(n){let e=CD;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function es(){return ud()}function RD(){return ud()}function ud(){return new la((n=>n.toString()),((n,e)=>n.isEqual(e)))}const GG=new li(Ee.comparator),WG=new yt(Ee.comparator);function Sn(...n){let e=WG;for(const t of n)e=e.add(t);return e}const $G=new yt(Ke);function KG(){return $G}function HG(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nm(e)?"-0":e}}function XG(n){return{integerValue:""+n}}class uy{constructor(){this._=void 0}}function qG(n,e,t){return n instanceof Kd?(function(r,s){const o={fields:{[aD]:{stringValue:oD},[cD]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&pw(s)&&(s=uD(s)),s&&(o.fields[lD]=s),{mapValue:o}})(t,e):n instanceof Ru?AD(n,e):n instanceof Au?bD(n,e):(function(r,s){const o=ZG(r,s),l=MR(o)+MR(r.Ae);return sx(o)&&sx(r.Ae)?XG(l):HG(r.serializer,l)})(n,e)}function YG(n,e,t){return n instanceof Ru?AD(n,e):n instanceof Au?bD(n,e):t}function ZG(n,e){return n instanceof Hd?(function(i){return sx(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class Kd extends uy{}class Ru extends uy{constructor(e){super(),this.elements=e}}function AD(n,e){const t=PD(e);for(const i of n.elements)t.some((r=>as(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Au extends uy{constructor(e){super(),this.elements=e}}function bD(n,e){let t=PD(e);for(const i of n.elements)t=t.filter((r=>!as(r,i)));return{arrayValue:{values:t}}}class Hd extends uy{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function MR(n){return Ht(n.integerValue||n.doubleValue)}function PD(n){return $d(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class QG{constructor(e,t){this.field=e,this.transform=t}}function JG(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Ru&&r instanceof Ru||i instanceof Au&&r instanceof Au?mu(i.elements,r.elements,as):i instanceof Hd&&r instanceof Hd?as(i.Ae,r.Ae):i instanceof Kd&&r instanceof Kd})(n.transform,e.transform)}class eW{constructor(e,t){this.version=e,this.transformResults=t}}class xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xr}static exists(e){return new xr(void 0,e)}static updateTime(e){return new xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class hy{}function kD(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new _w(n.key,xr.none()):new xf(n.key,n.data,xr.none());{const t=n.data,i=yr.empty();let r=new yt(Bt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Ou(n.key,i,new js(r.toArray()),xr.none())}}function tW(n,e,t){n instanceof xf?(function(r,s,o){const l=r.value.clone(),u=OR(r.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Ou?(function(r,s,o){if(!yp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=OR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(DD(r)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function hd(n,e,t,i){return n instanceof xf?(function(s,o,l,u){if(!yp(s.precondition,o))return l;const h=s.value.clone(),f=FR(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Ou?(function(s,o,l,u){if(!yp(s.precondition,o))return l;const h=FR(s.fieldTransforms,u,o),f=o.data;return f.setAll(DD(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((p=>p.field)))})(n,e,t,i):(function(s,o,l){return yp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function LR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&mu(i,r,((s,o)=>JG(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class xf extends hy{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ou extends hy{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function DD(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function OR(n,e,t){const i=new Map;Ne(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,YG(o,l,t[r]))}return i}function FR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,qG(s,o,e))}return i}class _w extends hy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ND extends hy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class vw{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&tW(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=hd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=hd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=RD();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const u=kD(o,l);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Qe.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Sn())}isEqual(e){return this.batchId===e.batchId&&mu(this.mutations,e.mutations,((t,i)=>LR(t,i)))&&mu(this.baseMutations,e.baseMutations,((t,i)=>LR(t,i)))}}class xw{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Ne(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return GG})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new xw(e,t,i,r)}}class ww{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var Kt,Ze;function nW(n){switch(n){case ae.OK:return Re(64938);case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return Re(15467,{code:n})}}function iW(n){if(n===void 0)return Ei("GRPC error has no .code"),ae.UNKNOWN;switch(n){case Kt.OK:return ae.OK;case Kt.CANCELLED:return ae.CANCELLED;case Kt.UNKNOWN:return ae.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return ae.INTERNAL;case Kt.UNAVAILABLE:return ae.UNAVAILABLE;case Kt.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case Kt.NOT_FOUND:return ae.NOT_FOUND;case Kt.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case Kt.ABORTED:return ae.ABORTED;case Kt.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case Kt.DATA_LOSS:return ae.DATA_LOSS;default:return Re(39323,{code:n})}}(Ze=Kt||(Kt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";new ow([4294967295,4294967295],0);const rW={asc:"ASCENDING",desc:"DESCENDING"},sW={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},oW={and:"AND",or:"OR"};class aW{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function lW(n,e){return n.useProto3Json||iy(e)?e:{value:e}}function ux(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function cW(n,e){return ux(n,e.toTimestamp())}function Sr(n){return Ne(!!n,49232),Qe.fromTimestamp((function(t){const i=ia(t);return new kt(i.seconds,i.nanos)})(n))}function MD(n,e){return hx(n,e).canonicalString()}function hx(n,e){const t=(function(r){return new Rt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function LD(n){const e=Rt.fromString(n);return Ne(vW(e),10190,{key:e.toString()}),e}function hm(n,e){return MD(n.databaseId,e.path)}function _p(n,e){const t=LD(e);if(t.get(1)!==n.databaseId.projectId)throw new Se(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Se(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee(VD(t))}function OD(n,e){return MD(n.databaseId,e)}function FD(n){const e=LD(n);return e.length===4?Rt.emptyPath():VD(e)}function uW(n){return new Rt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function VD(n){return Ne(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function VR(n,e,t){return{name:hm(n,e),fields:t.value.mapValue.fields}}function hW(n,e,t){const i=_p(n,e.name),r=Sr(e.updateTime),s=e.createTime?Sr(e.createTime):Qe.min(),o=new yr({mapValue:{fields:e.fields}}),l=Tn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function dm(n,e){let t;if(e instanceof xf)t={update:VR(n,e.key,e.value)};else if(e instanceof _w)t={delete:hm(n,e.key)};else if(e instanceof Ou)t={update:VR(n,e.key,e.data),updateMask:_W(e.fieldMask)};else{if(!(e instanceof ND))return Re(16599,{Vt:e.type});t={verify:hm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof Kd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ru)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Au)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Hd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Re(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:cW(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Re(27497)})(n,e.precondition)),t}function dx(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?xr.updateTime(Sr(s.updateTime)):s.exists!==void 0?xr.exists(s.exists):xr.none()})(e.currentDocument):xr.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let u=null;if("setToServerValue"in l)Ne(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new Kd;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new Ru(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Au(f)}else"increment"in l?u=new Hd(o,l.increment):Re(16584,{proto:l});const h=Bt.fromServerFormat(l.fieldPath);return new QG(h,u)})(n,r))):[];if(e.update){e.update.name;const r=_p(n,e.update.name),s=new yr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new js(h.map((f=>Bt.fromServerFormat(f))))})(e.updateMask);return new Ou(r,s,o,t,i)}return new xf(r,s,t,i)}if(e.delete){const r=_p(n,e.delete);return new _w(r,t)}if(e.verify){const r=_p(n,e.verify);return new ND(r,t)}return Re(1463,{proto:e})}function dW(n,e){return n&&n.length>0?(Ne(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Sr(r.updateTime):Sr(s);return o.isEqual(Qe.min())&&(o=Sr(s)),new eW(o,r.transformResults||[])})(t,e)))):[]}function fW(n,e){return{documents:[OD(n,e.path)]}}function gW(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=OD(n,r);const s=(function(h){if(h.length!==0)return UD(gt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(y){return{field:Fc(y.field),direction:pW(y.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=lW(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function jD(n){let e=FD(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Ne(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(p){const y=zD(p);return y instanceof gt&&yw(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((y=>(function(S){return new cm(Vc(S.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(y)))})(t.orderBy));let l=null;t.limit&&(l=(function(p){let y;return y=typeof p=="object"?p.value:p,iy(y)?null:y})(t.limit));let u=null;t.startAt&&(u=(function(p){const y=!!p.before,x=p.values||[];return new Iu(x,y)})(t.startAt));let h=null;return t.endAt&&(h=(function(p){const y=!p.before,x=p.values||[];return new Iu(x,y)})(t.endAt)),OG(e,r,o,s,l,"F",u,h)}function zD(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Vc(t.unaryFilter.field);return Ye.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Vc(t.unaryFilter.field);return Ye.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Vc(t.unaryFilter.field);return Ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Vc(t.unaryFilter.field);return Ye.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Re(61313);default:return Re(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ye.create(Vc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Re(58110);default:return Re(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return gt.create(t.compositeFilter.filters.map((i=>zD(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Re(1026)}})(t.compositeFilter.op))})(n):Re(30097,{filter:n})}function pW(n){return rW[n]}function mW(n){return sW[n]}function yW(n){return oW[n]}function Fc(n){return{fieldPath:n.canonicalString()}}function Vc(n){return Bt.fromServerFormat(n.fieldPath)}function UD(n){return n instanceof Ye?(function(t){if(t.op==="=="){if(CR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NAN"}};if(IR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(CR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NOT_NAN"}};if(IR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fc(t.field),op:mW(t.op),value:t.value}}})(n):n instanceof gt?(function(t){const i=t.getFilters().map((r=>UD(r)));return i.length===1?i[0]:{compositeFilter:{op:yW(t.op),filters:i}}})(n):Re(54877,{filter:n})}function _W(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function vW(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Hc{constructor(e,t,i,r,s=Qe.min(),o=Qe.min(),l=ci.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Hc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Hc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Hc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Hc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class BD{constructor(e){this.yt=e}}function xW(n,e){let t;if(e.document)t=hW(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Ee.fromSegments(e.noDocument.path),r=Rl(e.noDocument.readTime);t=Tn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Re(56709);{const i=Ee.fromSegments(e.unknownDocument.path),r=Rl(e.unknownDocument.version);t=Tn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new kt(r[0],r[1]);return Qe.fromTimestamp(s)})(e.readTime)),t}function jR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:fm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:hm(s,o.key),fields:o.data.value.mapValue.fields,updateTime:ux(s,o.version.toTimestamp()),createTime:ux(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Cl(e.version)};else{if(!e.isUnknownDocument())return Re(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Cl(e.version)}}return i}function fm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Cl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Rl(n){const e=new kt(n.seconds,n.nanoseconds);return Qe.fromTimestamp(e)}function Xa(n,e){const t=(e.baseMutations||[]).map((s=>dx(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>dx(n.yt,s))),r=kt.fromMillis(e.localWriteTimeMs);return new vw(e.batchId,r,t,i)}function qh(n){const e=Rl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Rl(n.lastLimboFreeSnapshotVersion):Qe.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return Ne(o===1,1966,{count:o}),$s(TD(FD(s.documents[0])))})(n.query):(function(s){return $s(jD(s))})(n.query),new Hc(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ci.fromBase64String(n.resumeToken))}function GD(n,e){const t=Cl(e.snapshotVersion),i=Cl(e.lastLimboFreeSnapshotVersion);let r;r=LG(e.target)?fW(n.yt,e.target):gW(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Il(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function WD(n){const e=jD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?cx(e,e.limit,"L"):e}function X0(n,e){return new ww(e.largestBatchId,dx(n.yt,e.overlayMutation))}function zR(n,e){const t=e.path.lastSegment();return[n,Gn(e.path.popLast()),t]}function UR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Cl(i.readTime),documentKey:Gn(i.documentKey.path),largestBatchId:i.largestBatchId}}class wW{getBundleMetadata(e,t){return BR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Rl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return BR(e).put((function(r){return{bundleId:r.id,createTime:Cl(Sr(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return GR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:WD(s.bundledQuery),readTime:Rl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return GR(e).put((function(r){return{name:r.name,readTime:Cl(Sr(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function BR(n){return tn(n,ry)}function GR(n){return tn(n,sy)}class dy{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new dy(e,i)}getOverlay(e,t){return Nh(e).get(zR(this.userId,t)).next((i=>i?X0(this.serializer,i):null))}getOverlays(e,t){const i=es();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new ww(t,o);r.push(this.St(e,l))})),Z.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Gn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Nh(e).Z(nx,l))})),Z.waitFor(s)}getOverlaysForCollection(e,t,i){const r=es(),s=Gn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Nh(e).J(nx,o).next((l=>{for(const u of l){const h=X0(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=es();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Nh(e).ee({index:tD,range:l},((u,h,f)=>{const p=X0(this.serializer,h);s.size()<r||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Nh(e).put((function(r,s,o){const[l,u,h]=zR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:dm(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Nh(n){return tn(n,oy)}class EW{bt(e){return tn(e,dw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?ci.fromUint8Array(i):ci.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class qa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ht(e.integerValue));else if("doubleValue"in e){const i=Ht(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),nm(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ia(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(wu(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?gD(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):ay(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Re(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=lm,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ht(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ee.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}qa.Kt=new qa;const Ac=255;function TW(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function WR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=TW(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class SW{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=WR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=WR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Ac),this.sn(255)}_n(){this.an(Ac),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ac?(this.sn(Ac),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ac?(this.an(Ac),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class IW{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class CW{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Mh{constructor(){this.cn=new SW,this.ln=new IW(this.cn),this.hn=new CW(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Ya{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Ya(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:vp(this.En),directionalValue:vp(this.dn),orderedDocumentKey:vp(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Do(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=$R(n.En,e.En),t!==0?t:(t=$R(n.dn,e.dn),t!==0?t:Ee.comparator(n.In,e.In)))}function $R(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function vp(n){return JP()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function KR(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class HR{constructor(e){this.mn=new yt(((t,i)=>Bt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Ne(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Jv(e);if(t!==void 0&&!this.wn(t))return!1;const i=Wa(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=i[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new yt(Bt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new fp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new fp(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new fp(i.field,i.dir==="asc"?0:1)));return new tm(tm.UNKNOWN_ID,this.collectionId,t,zd.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function $D(n){if(Ne(n instanceof Ye||n instanceof gt,20012),n instanceof Ye){if(n instanceof ED){const t=n.value.arrayValue?.values?.map((i=>Ye.create(n.field,"==",i)))||[];return gt.create(t,"or")}return n}const e=n.filters.map((t=>$D(t)));return gt.create(e,n.op)}function RW(n){if(n.getFilters().length===0)return[];const e=px($D(n));return Ne(KD(e),7391),fx(e)||gx(e)?[e]:e.getFilters()}function fx(n){return n instanceof Ye}function gx(n){return n instanceof gt&&yw(n)}function KD(n){return fx(n)||gx(n)||(function(t){if(t instanceof gt&&ox(t)){for(const i of t.getFilters())if(!fx(i)&&!gx(i))return!1;return!0}return!1})(n)}function px(n){if(Ne(n instanceof Ye||n instanceof gt,34018),n instanceof Ye)return n;if(n.filters.length===1)return px(n.filters[0]);const e=n.filters.map((i=>px(i)));let t=gt.create(e,n.op);return t=gm(t),KD(t)?t:(Ne(t instanceof gt,64498),Ne(Cu(t),40251),Ne(t.filters.length>1,57927),t.filters.reduce(((i,r)=>Ew(i,r))))}function Ew(n,e){let t;return Ne(n instanceof Ye||n instanceof gt,38388),Ne(e instanceof Ye||e instanceof gt,25473),t=n instanceof Ye?e instanceof Ye?(function(r,s){return gt.create([r,s],"and")})(n,e):XR(n,e):e instanceof Ye?XR(e,n):(function(r,s){if(Ne(r.filters.length>0&&s.filters.length>0,48005),Cu(r)&&Cu(s))return vD(r,s.getFilters());const o=ox(r)?r:s,l=ox(r)?s:r,u=o.filters.map((h=>Ew(h,l)));return gt.create(u,"or")})(n,e),gm(t)}function XR(n,e){if(Cu(e))return vD(e,n.getFilters());{const t=e.filters.map((i=>Ew(n,i)));return gt.create(t,"or")}}function gm(n){if(Ne(n instanceof Ye||n instanceof gt,11850),n instanceof Ye)return n;const e=n.getFilters();if(e.length===1)return gm(e[0]);if(yD(n))return n;const t=e.map((r=>gm(r))),i=[];return t.forEach((r=>{r instanceof Ye?i.push(r):r instanceof gt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:gt.create(i,n.op)}class AW{constructor(){this.Cn=new Tw}addToCollectionParentIndex(e,t){return this.Cn.add(t),Z.resolve()}getCollectionParents(e,t){return Z.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Z.resolve()}deleteFieldIndex(e,t){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,t){return Z.resolve()}getDocumentsMatchingTarget(e,t){return Z.resolve(null)}getIndexType(e,t){return Z.resolve(0)}getFieldIndexes(e,t){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,t){return Z.resolve(Ai.min())}getMinOffsetFromCollectionGroup(e,t){return Z.resolve(Ai.min())}updateCollectionGroup(e,t,i){return Z.resolve()}updateIndexEntries(e,t){return Z.resolve()}}class Tw{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new yt(Rt.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new yt(Rt.comparator)).toArray()}}const qR="IndexedDbIndexManager",Zg=new Uint8Array(0);class bW{constructor(e,t){this.databaseId=t,this.vn=new Tw,this.Fn=new la((i=>Il(i)),((i,r)=>vf(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Gn(r)};return YR(e).put(s)}return Z.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[Wk(t),""],!1,!0);return YR(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Jr(o.parent))}return i}))}addFieldIndex(e,t){const i=Lh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=Pc(e);return s.next((l=>{o.put(UR(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Lh(e),r=Pc(e),s=bc(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Lh(e),i=bc(e),r=Pc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Z.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new HR(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=bc(e);let r=!0;const s=new Map;return Z.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=Sn();const l=[];return Z.forEach(s,((u,h)=>{fe(qR,`Using index ${(function(N){return`id=${N.indexId}|cg=${N.collectionGroup}|f=${N.fields.map((R=>`${R.fieldPath}:${R.kind}`)).join(",")}`})(u)} to execute ${Il(t)}`);const f=(function(N,R){const L=Jv(R);if(L===void 0)return null;for(const j of um(N,L.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null})(h,u),p=(function(N,R){const L=new Map;for(const j of Wa(R))for(const D of um(N,j.fieldPath))switch(D.op){case"==":case"in":L.set(j.fieldPath.canonicalString(),D.value);break;case"not-in":case"!=":return L.set(j.fieldPath.canonicalString(),D.value),Array.from(L.values())}return null})(h,u),y=(function(N,R){const L=[];let j=!0;for(const D of Wa(R)){const b=D.kind===0?kR(N,D.fieldPath,N.startAt):DR(N,D.fieldPath,N.startAt);L.push(b.value),j&&(j=b.inclusive)}return new Iu(L,j)})(h,u),x=(function(N,R){const L=[];let j=!0;for(const D of Wa(R)){const b=D.kind===0?DR(N,D.fieldPath,N.endAt):kR(N,D.fieldPath,N.endAt);L.push(b.value),j&&(j=b.inclusive)}return new Iu(L,j)})(h,u),S=this.On(u,h,y),I=this.On(u,h,x),T=this.Nn(u,h,p),A=this.Bn(u.indexId,f,S,y.inclusive,I,x.inclusive,T);return Z.forEach(A,(P=>i.Y(P,t.limit).next((N=>{N.forEach((R=>{const L=Ee.fromSegments(R.documentKey);o.has(L)||(o=o.add(L),l.push(L))}))}))))})).next((()=>l))}return Z.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=RW(gt.create(e.filters,"and")).map((i=>lx(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let p=0;p<u;++p){const y=t?this.Ln(t[p/h]):Zg,x=this.kn(e,y,i[p%h],r),S=this.qn(e,y,s[p%h],o),I=l.map((T=>this.kn(e,y,T,!0)));f.push(...this.createRange(x,S,I))}return f}kn(e,t,i,r){const s=new Ya(e,Ee.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Ya(e,Ee.empty(),t,i);return r?s.An():s}xn(e,t){const i=new HR(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Z.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new yt(Bt.comparator),f=!1;for(const p of u.filters)for(const y of p.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?f=!0:h=h.add(y.field));for(const p of u.orderBy)p.field.isKeyField()||(h=h.add(p.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Mh;for(const r of Wa(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);qa.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Mh;return qa.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Mh;return qa.Kt.Dt(mw(this.databaseId,t),i.Pn((function(s){const o=Wa(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Mh);let s=0;for(const o of Wa(e)){const l=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&$d(l))r=this.Kn(r,o,l);else{const h=u.Pn(o.kind);qa.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const u=new Mh;u.seed(l.un()),qa.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof Ye&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Lh(e),r=Pc(e);return(t?i.J(tx,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Z.forEach(s,(l=>r.get([l.indexId,this.uid]).next((u=>{o.push((function(f,p){const y=p?new zd(p.sequenceNumber,new Ai(Rl(p.readTime),new Ee(Jr(p.documentKey)),p.largestBatchId)):zd.empty(),x=f.fields.map((([S,I])=>new fp(Bt.fromServerFormat(S),I)));return new tm(f.indexId,f.collectionGroup,x,y)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:Ke(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Lh(e),s=Pc(e);return this.Gn(e).next((o=>r.J(tx,IDBKeyRange.bound(t,t)).next((l=>Z.forEach(l,(u=>s.put(UR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Z.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Z.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),Z.forEach(l,(u=>this.zn(e,r,u).next((h=>{const f=this.jn(s,u);return h.isEqual(f)?Z.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,i,r){return bc(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return bc(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=bc(e);let s=new yt(Do);return r.ee({index:eD,range:IDBKeyRange.only([i.indexId,this.uid,vp(this.$n(i,t))])},((o,l)=>{s=s.add(new Ya(i.indexId,t,KR(l.arrayValue),KR(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new yt(Do);const r=this.Qn(t,e);if(r==null)return i;const s=Jv(t);if(s!=null){const o=e.data.field(s.fieldPath);if($d(o))for(const l of o.arrayValue.values||[])i=i.add(new Ya(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new Ya(t.indexId,e.key,Zg,r));return i}Jn(e,t,i,r,s){fe(qR,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,f,p,y){const x=u.getIterator(),S=h.getIterator();let I=Rc(x),T=Rc(S);for(;I||T;){let A=!1,P=!1;if(I&&T){const N=f(I,T);N<0?P=!0:N>0&&(A=!0)}else I!=null?P=!0:A=!0;A?(p(T),T=Rc(S)):P?(y(I),I=Rc(x)):(I=Rc(x),T=Rc(S))}})(r,s,Do,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),Z.waitFor(o)}Gn(e){let t=1;return Pc(e).ee({index:Jk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>Do(o,l))).filter(((o,l,u)=>!l||Do(o,u[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=Do(o,e),u=Do(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,Zg,Ee.empty()),u=r[o+1].Vn(this.uid,Zg,Ee.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return Do(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(ZR)}getMinOffset(e,t){return Z.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Re(44426))))).next(ZR)}}function YR(n){return tn(n,Gd)}function bc(n){return tn(n,ad)}function Lh(n){return tn(n,hw)}function Pc(n){return tn(n,od)}function ZR(n){Ne(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;lw(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ai(e.readTime,e.documentKey,t)}const QR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},HD=41943040;class Jn{static withCacheSize(e){return new Jn(e,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function XD(n,e,t){const i=n.store(fr),r=n.store(yu),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.ee({range:o},((f,p,y)=>(l++,y.delete())));s.push(u.next((()=>{Ne(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const p=Yk(e,f.key.path,t.batchId);s.push(r.delete(p)),h.push(f.key)}return Z.waitFor(s).next((()=>h))}function pm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Re(14731);e=n.noDocument}return JSON.stringify(e).length}Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn(HD,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);class fy{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){Ne(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new fy(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return No(e).ee({index:il,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=jc(e),o=No(e);return o.add({}).next((l=>{Ne(typeof l=="number",49019);const u=new vw(l,t,i,r),h=(function(x,S,I){const T=I.baseMutations.map((P=>dm(x.yt,P))),A=I.mutations.map((P=>dm(x.yt,P)));return{userId:S,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:T,mutations:A}})(this.serializer,this.userId,u),f=[];let p=new yt(((y,x)=>Ke(y.canonicalString(),x.canonicalString())));for(const y of r){const x=Yk(this.userId,y.key.path,l);p=p.add(y.key.path.popLast()),f.push(o.put(h)),f.push(s.put(x,Z8))}return p.forEach((y=>{f.push(this.indexManager.addToCollectionParentIndex(e,y))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),Z.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return No(e).get(t).next((i=>i?(Ne(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Xa(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Z.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return No(e).ee({index:il,range:r},((o,l,u)=>{l.userId===this.userId&&(Ne(l.batchId>=i,47524,{tr:i}),s=Xa(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ul;return No(e).ee({index:il,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ul],[this.userId,Number.POSITIVE_INFINITY]);return No(e).J(il,t).next((i=>i.map((r=>Xa(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=gp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return jc(e).ee({range:r},((o,l,u)=>{const[h,f,p]=o,y=Jr(f);if(h===this.userId&&t.path.isEqual(y))return No(e).get(p).next((x=>{if(!x)throw Re(61480,{nr:o,batchId:p});Ne(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:p}),s.push(Xa(this.serializer,x))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(Ke);const r=[];return t.forEach((s=>{const o=gp(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=jc(e).ee({range:l},((h,f,p)=>{const[y,x,S]=h,I=Jr(x);y===this.userId&&s.path.isEqual(I)?i=i.add(S):p.done()}));r.push(u)})),Z.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=gp(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new yt(Ke);return jc(e).ee({range:o},((u,h,f)=>{const[p,y,x]=u,S=Jr(y);p===this.userId&&i.isPrefixOf(S)?S.length===r&&(l=l.add(x)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(No(e).get(s).next((o=>{if(o===null)throw Re(35274,{batchId:s});Ne(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Xa(this.serializer,o))})))})),Z.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return XD(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Z.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Z.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return jc(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const u=Jr(s[1]);r.push(u)}else l.done()})).next((()=>{Ne(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return qD(e,this.userId,t)}_r(e){return YD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:ul,lastStreamToken:""}))}}function qD(n,e,t){const i=gp(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return jc(n).ee({range:s,X:!0},((l,u,h)=>{const[f,p,y]=l;f===e&&p===r&&(o=!0),h.done()})).next((()=>o))}function No(n){return tn(n,fr)}function jc(n){return tn(n,yu)}function YD(n){return tn(n,Ud)}class Al{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Al(0)}static cr(){return new Al(-1)}}class PW{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Al(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Qe.fromTimestamp(new kt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>kc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Ne(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return kc(e).ee(((o,l)=>{const u=qh(l);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>Z.waitFor(s))).next((()=>r))}forEachTarget(e,t){return kc(e).ee(((i,r)=>{const s=qh(r);t(s)}))}lr(e){return JR(e).get(sm).next((t=>(Ne(t!==null,2888),t)))}hr(e,t){return JR(e).put(sm,t)}Pr(e,t){return kc(e).put(GD(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Il(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return kc(e).ee({range:r,index:Qk},((o,l,u)=>{const h=qh(l);vf(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Bo(e);return t.forEach((o=>{const l=Gn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),Z.waitFor(r)}removeMatchingKeys(e,t,i){const r=Bo(e);return Z.forEach(t,(s=>{const o=Gn(s.path);return Z.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Bo(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Bo(e);let s=Sn();return r.ee({range:i,X:!0},((o,l,u)=>{const h=Jr(o[1]),f=new Ee(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Gn(t.path),r=IDBKeyRange.bound([i],[Wk(i)],!1,!0);let s=0;return Bo(e).ee({index:uw,X:!0,range:r},(([o,l],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return kc(e).get(t).next((i=>i?qh(i):null))}}function kc(n){return tn(n,_u)}function JR(n){return tn(n,hl)}function Bo(n){return tn(n,vu)}const eA="LruGarbageCollector",kW=1048576;function tA([n,e],[t,i]){const r=Ke(n,t);return r===0?Ke(e,i):r}class DW{constructor(e){this.Ir=e,this.buffer=new yt(tA),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();tA(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class NW{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){fe(eA,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ol(t)?fe(eA,"Ignoring IndexedDB error during garbage collection: ",t):await ty(t)}await this.Vr(3e5)}))}}class MW{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Z.resolve(vr.ce);const i=new DW(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(QR)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),QR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),r=this.params.maximumSequenceNumbersToCollect):r=p,o=Date.now(),this.nthSequenceNumber(e,r)))).next((p=>(i=p,l=Date.now(),this.removeTargets(e,i,t)))).next((p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((p=>(h=Date.now(),Oc()<=He.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:p}))))}}function LW(n,e){return new MW(n,e)}class OW{constructor(e,t){this.db=e,this.garbageCollector=LW(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return Qg(e,i)}removeReference(e,t,i){return Qg(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Qg(e,t)}br(e,t){return(function(r,s){let o=!1;return YD(r).te((l=>qD(r,l,s).next((u=>(u&&(o=!0),Z.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Qe.min()),Bo(e).delete((function(p){return[0,Gn(p.path)]})(o)))))}));r.push(u)}})).next((()=>Z.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Qg(e,t)}Sr(e,t){const i=Bo(e);let r,s=vr.ce;return i.ee({index:uw},(([o,l],{path:u,sequenceNumber:h})=>{o===0?(s!==vr.ce&&t(new Ee(Jr(r)),s),s=h,r=u):s=vr.ce})).next((()=>{s!==vr.ce&&t(new Ee(Jr(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Qg(n,e){return Bo(n).put((function(i,r){return{targetId:0,path:Gn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class ZD{constructor(){this.changes=new la((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Z.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class FW{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Fa(e).put(i)}removeEntry(e,t,i){return Fa(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],fm(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Tn.newInvalidDocument(t);return Fa(e).ee({index:pp,range:IDBKeyRange.only(Oh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Tn.newInvalidDocument(t)};return Fa(e).ee({index:pp,range:IDBKeyRange.only(Oh(t))},((r,s)=>{i={document:this.Cr(t,s),size:pm(s)}})).next((()=>i))}getEntries(e,t){let i=rl();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=rl(),r=new li(Ee.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,pm(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Z.resolve();let r=new yt(rA);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Oh(r.first()),Oh(r.last())),o=r.getIterator();let l=o.getNext();return Fa(e).ee({index:pp,range:s},((u,h,f)=>{const p=Ee.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&rA(l,p)<0;)i(l,null),l=o.getNext();l&&l.isEqual(p)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Oh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),fm(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fa(e).J(IDBKeyRange.bound(l,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=rl();for(const p of h){const y=this.Cr(Ee.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);y.isFoundDocument()&&(cy(t,y)||r.has(y.key))&&(f=f.insert(y.key,y))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=rl();const o=iA(t,i),l=iA(t,Ai.max());return Fa(e).ee({index:Zk,range:IDBKeyRange.bound(o,l,!0)},((u,h,f)=>{const p=this.Cr(Ee.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(p.key,p),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new VW(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return nA(e).get(ex).next((t=>(Ne(!!t,20021),t)))}Dr(e,t){return nA(e).put(ex,t)}Cr(e,t){if(t){const i=xW(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Qe.min())))return i}return Tn.newInvalidDocument(e)}}function QD(n){return new FW(n)}class VW extends ZD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new la((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new yt(((s,o)=>Ke(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=jR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=pm(u);i+=h-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=l.size,this.trackRemovals){const u=jR(this.Nr.serializer,o.convertToNoDocument(Qe.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Z.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function nA(n){return tn(n,Bd)}function Fa(n){return tn(n,rm)}function Oh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function iA(n,e){const t=e.documentKey.path.toArray();return[n,fm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function rA(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=Ke(t[s],i[s]),r)return r;return r=Ke(t.length,i.length),r||(r=Ke(t[t.length-2],i[i.length-2]),r||Ke(t[t.length-1],i[i.length-1]))}class jW{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class JD{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&hd(i.mutation,r,js.empty(),kt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Sn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Sn()){const r=es();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=Yg();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=es();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Sn())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=rl();const o=ud(),l=(function(){return ud()})();return t.forEach(((u,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Ou)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),hd(f.mutation,h,f.mutation.getFieldMask(),kt.now())):o.set(h.key,js.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new jW(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=ud();let r=new li(((o,l)=>o-l)),s=Sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=i.get(u)||js.empty();f=l.applyToLocalView(h,f),i.set(u,f);const p=(r.get(l.batchId)||Sn()).add(u);r=r.insert(l.batchId,p)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,p=RD();f.forEach((y=>{if(!s.has(y)){const x=kD(t.get(y),i.get(y));x!==null&&p.set(y,x),s=s.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return Z.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):FG(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Z.resolve(es());let l=jd,u=s;return o.next((h=>Z.forEach(h,((f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(f)?Z.resolve():this.remoteDocumentCache.getEntry(e,f).next((y=>{u=u.insert(f,y)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Sn()))).next((f=>({batchId:l,changes:BG(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next((i=>{let r=Yg();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Yg();return this.indexManager.getCollectionParents(e,s).next((l=>Z.forEach(l,(u=>{const h=(function(p,y){return new ly(y,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((p,y)=>{o=o.insert(p,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Tn.newInvalidDocument(f)))}));let l=Yg();return o.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&hd(f.mutation,h,js.empty(),kt.now()),cy(t,h)&&(l=l.insert(u,h))})),l}))}}class zW{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Z.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Sr(r.createTime)}})(t)),Z.resolve()}getNamedQuery(e,t){return Z.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:WD(r.bundledQuery),readTime:Sr(r.readTime)}})(t)),Z.resolve()}}class UW{constructor(){this.overlays=new li(Ee.comparator),this.qr=new Map}getOverlay(e,t){return Z.resolve(this.overlays.get(t))}getOverlays(e,t){const i=es();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Z.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Z.resolve()}getOverlaysForCollection(e,t,i){const r=es(),s=t.length+1,o=new Ee(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return Z.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new li(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=es(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=es(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return Z.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new ww(t,i));let s=this.qr.get(t);s===void 0&&(s=Sn(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class BW{constructor(){this.sessionToken=ci.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Z.resolve()}}class Sw{constructor(){this.Qr=new yt(cn.$r),this.Ur=new yt(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new cn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new cn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ee(new Rt([])),i=new cn(t,e),r=new cn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ee(new Rt([])),i=new cn(t,e),r=new cn(t,e+1);let s=Sn();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new cn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class cn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ee.comparator(e.key,t.key)||Ke(e.Yr,t.Yr)}static Kr(e,t){return Ke(e.Yr,t.Yr)||Ee.comparator(e.key,t.key)}}class GW{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new yt(cn.$r)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new vw(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new cn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Z.resolve(o)}lookupMutationBatch(e,t){return Z.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?ul:this.tr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new cn(t,0),r=new cn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),Z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(Ke);return t.forEach((r=>{const s=new cn(r,0),o=new cn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),Z.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Ee.isDocumentKey(s)||(s=s.child(""));const o=new cn(new Ee(s),0);let l=new yt(Ke);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(u.Yr)),!0)}),o),Z.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Ne(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Z.forEach(t.mutations,(r=>{const s=new cn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new cn(t,0),r=this.Zr.firstAfterOrEqual(i);return Z.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class WW{constructor(e){this.ri=e,this.docs=(function(){return new li(Ee.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Z.resolve(i?i.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let i=rl();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Tn.newInvalidDocument(r))})),Z.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=rl();const o=t.path,l=new Ee(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||lw(Kk(f),i)<=0||(r.has(f.key)||cy(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Z.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Re(9500)}ii(e,t){return Z.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new $W(this)}getSize(e){return Z.resolve(this.size)}}class $W extends ZD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Z.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class KW{constructor(e){this.persistence=e,this.si=new la((t=>Il(t)),vf),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.oi=0,this._i=new Sw,this.targetCount=0,this.ai=Al.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Z.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Al(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Z.resolve()}updateTargetData(e,t){return this.Pr(t),Z.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),Z.waitFor(s).next((()=>r))}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Z.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Z.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Z.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Z.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Z.resolve(i)}containsKey(e,t){return Z.resolve(this._i.containsKey(t))}}class eN{constructor(e,t){this.ui={},this.overlays={},this.ci=new vr(0),this.li=!1,this.li=!0,this.hi=new BW,this.referenceDelegate=e(this),this.Pi=new KW(this),this.indexManager=new AW,this.remoteDocumentCache=(function(r){return new WW(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new BD(t),this.Ii=new zW(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new UW,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new GW(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe("MemoryPersistence","Starting transaction:",e);const r=new HW(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Z.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class HW extends Xk{constructor(e){super(),this.currentSequenceNumber=e}}class gy{constructor(e){this.persistence=e,this.Ri=new Sw,this.Vi=null}static mi(e){return new gy(e)}get fi(){if(this.Vi)return this.Vi;throw Re(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Z.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Z.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Z.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.fi,(i=>{const r=Ee.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Qe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Z.or([()=>Z.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class XW{constructor(e){this.serializer=e}k(e,t,i,r){const s=new ny("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(_f)})(e),(function(u){u.createObjectStore(Ud,{keyPath:Y8}),u.createObjectStore(fr,{keyPath:vR,autoIncrement:!0}).createIndex(il,xR,{unique:!0}),u.createObjectStore(yu)})(e),sA(e),(function(u){u.createObjectStore($a)})(e));let o=Z.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(vu),u.deleteObjectStore(_u),u.deleteObjectStore(hl)})(e),sA(e)),o=o.next((()=>(function(u){const h=u.store(hl),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Qe.min().toTimestamp(),targetCount:0};return h.put(sm,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(fr).J().next((p=>{u.deleteObjectStore(fr),u.createObjectStore(fr,{keyPath:vR,autoIncrement:!0}).createIndex(il,xR,{unique:!0});const y=h.store(fr),x=p.map((S=>y.put(S)));return Z.waitFor(x)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(xu,{keyPath:sG})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Bd)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(ry,{keyPath:oG})})(e),(function(u){u.createObjectStore(sy,{keyPath:aG})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(oy,{keyPath:gG});h.createIndex(nx,pG,{unique:!1}),h.createIndex(tD,mG,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(rm,{keyPath:Q8});h.createIndex(pp,J8),h.createIndex(Zk,eG)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore($a)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(hw,{keyPath:lG,autoIncrement:!0}).createIndex(tx,cG,{unique:!1}),u.createObjectStore(od,{keyPath:uG}).createIndex(Jk,hG,{unique:!1}),u.createObjectStore(ad,{keyPath:dG}).createIndex(eD,fG,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(od).clear()})).next((()=>{t.objectStore(ad).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(dw,{keyPath:yG})})(e)}))),i<18&&r>=18&&JP()&&(o=o.next((()=>{t.objectStore(od).clear()})).next((()=>{t.objectStore(ad).clear()}))),o}wi(e){let t=0;return e.store($a).ee(((i,r)=>{t+=pm(r)})).next((()=>{const i={byteSize:t};return e.store(Bd).put(ex,i)}))}yi(e){const t=e.store(Ud),i=e.store(fr);return t.J().next((r=>Z.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,ul],[s.userId,s.lastAcknowledgedBatchId]);return i.J(il,o).next((l=>Z.forEach(l,(u=>{Ne(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=Xa(this.serializer,u);return XD(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(vu),i=e.store($a);return e.store(hl).get(sm).next((r=>{const s=[];return i.ee(((o,l)=>{const u=new Rt(o),h=(function(p){return[0,Gn(p)]})(u);s.push(t.get(h).next((f=>f?Z.resolve():(p=>t.put({targetId:0,path:Gn(p),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>Z.waitFor(s)))}))}bi(e,t){e.createObjectStore(Gd,{keyPath:rG});const i=t.store(Gd),r=new Tw,s=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:Gn(u)})}};return t.store($a).ee({X:!0},((o,l)=>{const u=new Rt(o);return s(u.popLast())})).next((()=>t.store(yu).ee({X:!0},(([o,l,u],h)=>{const f=Jr(l);return s(f.popLast())}))))}Di(e){const t=e.store(_u);return t.ee(((i,r)=>{const s=qh(r),o=GD(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store($a),r=[];return i.ee(((s,o)=>{const l=t.store(rm),u=(function(p){return p.document?new Ee(Rt.fromString(p.document.name).popFirst(5)):p.noDocument?Ee.fromSegments(p.noDocument.path):p.unknownDocument?Ee.fromSegments(p.unknownDocument.path):Re(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>Z.waitFor(r)))}Fi(e,t){const i=t.store(fr),r=QD(this.serializer),s=new eN(gy.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((u=>{let h=l.get(u.userId)??Sn();Xa(this.serializer,u).keys().forEach((f=>h=h.add(f))),l.set(u.userId,h)})),Z.forEach(l,((u,h)=>{const f=new wn(h),p=dy.wt(this.serializer,f),y=s.getIndexManager(f),x=fy.wt(f,this.serializer,y,s.referenceDelegate);return new JD(r,x,p,y).recalculateAndSaveOverlaysForDocumentKeys(new ix(t,vr.ce),u).next()}))}))}}function sA(n){n.createObjectStore(vu,{keyPath:nG}).createIndex(uw,iG,{unique:!0}),n.createObjectStore(_u,{keyPath:"targetId"}).createIndex(Qk,tG,{unique:!0}),n.createObjectStore(hl)}const Mo="IndexedDbPersistence",q0=18e5,Y0=5e3,Z0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",qW="main";class Iw{constructor(e,t,i,r,s,o,l,u,h,f,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=y=>Promise.resolve(),!Iw.v())throw new Se(ae.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new OW(this,r),this.$i=t+qW,this.serializer=new BD(u),this.Ui=new Qo(this.$i,this.Ni,new XW(this.serializer)),this.hi=new EW,this.Pi=new PW(this.referenceDelegate,this.serializer),this.remoteDocumentCache=QD(this.serializer),this.Ii=new wW,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&Ei(Mo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Se(ae.FAILED_PRECONDITION,Z0);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new vr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Jg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ol(e))return fe(Mo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe(Mo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Fh(e).get(Cc).next((t=>Z.resolve(this.es(t))))}ts(e){return Jg(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,q0)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=tn(t,xu);return i.J().next((r=>{const s=this.ss(r,q0),o=r.filter((l=>s.indexOf(l)===-1));return Z.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Z.resolve(!0):Fh(e).get(Cc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Y0)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Se(ae.FAILED_PRECONDITION,Z0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Jg(e).J().next((i=>this.ss(i,Y0).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&fe(Mo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[_f,xu],(e=>{const t=new ix(e,vr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Jg(e).J().next((t=>this.ss(t,q0).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return fy.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new bW(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return dy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe(Mo,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?xG:u===17?sD:u===16?vG:u===15?fw:u===14?rD:u===13?iD:u===12?_G:u===11?nD:void Re(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new ix(l,this.ci?this.ci.next():vr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Ei(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Se(ae.FAILED_PRECONDITION,Hk);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return Fh(e).get(Cc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Y0)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Se(ae.FAILED_PRECONDITION,Z0)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Fh(e).put(Cc,t)}static v(){return Qo.v()}Zi(e){const t=Fh(e);return t.get(Cc).next((i=>this.es(i)?(fe(Mo,"Releasing primary lease."),t.delete(Cc)):Z.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Ei(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;QP()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return fe(Mo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ei(Mo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ei("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Fh(n){return tn(n,_f)}function Jg(n){return tn(n,xu)}function YW(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Cw{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Sn(),r=Sn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Cw(e,t.fromCache,i,r)}}class ZW{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class tN{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return QP()?8:qk(en())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new ZW;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Oc()<=He.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",Dh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Z.resolve()):(Oc()<=He.DEBUG&&fe("QueryEngine","Query:",Dh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Oc()<=He.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",Dh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$s(t))):Z.resolve())}ys(e,t){if(NR(t))return Z.resolve(null);let i=$s(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=cx(t,null,"F"),i=$s(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Sn(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,l);return this.Cs(t,h,o,u.readTime)?this.ys(e,cx(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return NR(t)||r.isEqual(Qe.min())?Z.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Z.resolve(null):(Oc()<=He.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Dh(t)),this.vs(e,o,t,W8(r,jd)).next((l=>l)))}))}Ds(e,t){let i=new yt(jG(e));return t.forEach(((r,s)=>{cy(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Oc()<=He.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",Dh(t)),this.ps.getDocumentsMatchingQuery(e,t,Ai.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const QW="LocalStore";class JW{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new li(Ke),this.xs=new la((s=>Il(s)),vf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function nN(n,e,t,i){return new JW(n,e,t,i)}async function e7(n,e){const t=St(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let u=Sn();for(const h of r){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function t7(n,e){const t=St(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,f){const p=h.batch,y=p.keys();let x=Z.resolve();return y.forEach((S=>{x=x.next((()=>f.getEntry(u,S))).next((I=>{const T=h.docVersions.get(S);Ne(T!==null,48541),I.version.compareTo(T)<0&&(p.applyToRemoteDocument(I,h),I.isValidDocument()&&(I.setReadTime(h.commitVersion),f.addEntry(I)))}))})),x.next((()=>l.mutationQueue.removeMutationBatch(u,p)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let u=Sn();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function n7(n){const e=St(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function i7(n,e){const t=St(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ul),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class oA{constructor(){this.activeTargetIds=KG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class iN{constructor(){this.Mo=new oA,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new oA,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class r7{Oo(e){}shutdown(){}}const aA="ConnectivityMonitor";class lA{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){fe(aA,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){fe(aA,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ep=null;function mx(){return ep===null?ep=(function(){return 268435456+Math.round(2147483648*Math.random())})():ep++,"0x"+ep.toString(16)}const Q0="RestConnection",s7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class o7{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===am?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=mx(),l=this.zo(e,t.toUriEncodedString());fe(Q0,`Sending RPC '${e}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(l),f=Ml(h);return this.Jo(e,l,u,i,f).then((p=>(fe(Q0,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw ey(Q0,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",i),p}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Lu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=s7[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class a7{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const kn="WebChannelConnection";class l7 extends o7{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=mx();return new Promise(((l,u)=>{const h=new Ok;h.setWithCredentials(!0),h.listenOnce(Fk.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case dp.NO_ERROR:const p=h.getResponseJson();fe(kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case dp.TIMEOUT:fe(kn,`RPC '${e}' ${o} timed out`),u(new Se(ae.DEADLINE_EXCEEDED,"Request time out"));break;case dp.HTTP_ERROR:const y=h.getStatus();if(fe(kn,`RPC '${e}' ${o} failed with status:`,y,"response text:",h.getResponseText()),y>0){let x=h.getResponseJson();Array.isArray(x)&&(x=x[0]);const S=x?.error;if(S&&S.status&&S.message){const I=(function(A){const P=A.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(P)>=0?P:ae.UNKNOWN})(S.status);u(new Se(I,S.message))}else u(new Se(ae.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Se(ae.UNAVAILABLE,"Connection failed."));break;default:Re(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{fe(kn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);fe(kn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=mx(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=zk(),l=jk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const f=s.join("");fe(kn,`Creating RPC '${e}' stream ${r}: ${f}`,u);const p=o.createWebChannel(f,u);this.I_(p);let y=!1,x=!1;const S=new a7({Yo:T=>{x?fe(kn,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(y||(fe(kn,`Opening RPC '${e}' stream ${r} transport.`),p.open(),y=!0),fe(kn,`RPC '${e}' stream ${r} sending:`,T),p.send(T))},Zo:()=>p.close()}),I=(T,A,P)=>{T.listen(A,(N=>{try{P(N)}catch(R){setTimeout((()=>{throw R}),0)}}))};return I(p,Xh.EventType.OPEN,(()=>{x||(fe(kn,`RPC '${e}' stream ${r} transport opened.`),S.o_())})),I(p,Xh.EventType.CLOSE,(()=>{x||(x=!0,fe(kn,`RPC '${e}' stream ${r} transport closed`),S.a_(),this.E_(p))})),I(p,Xh.EventType.ERROR,(T=>{x||(x=!0,ey(kn,`RPC '${e}' stream ${r} transport errored. Name:`,T.name,"Message:",T.message),S.a_(new Se(ae.UNAVAILABLE,"The operation could not be completed")))})),I(p,Xh.EventType.MESSAGE,(T=>{if(!x){const A=T.data[0];Ne(!!A,16349);const P=A,N=P?.error||P[0]?.error;if(N){fe(kn,`RPC '${e}' stream ${r} received error:`,N);const R=N.status;let L=(function(b){const M=Kt[b];if(M!==void 0)return iW(M)})(R),j=N.message;L===void 0&&(L=ae.INTERNAL,j="Unknown error status: "+R+" with message "+N.message),x=!0,S.a_(new Se(L,j)),p.close()}else fe(kn,`RPC '${e}' stream ${r} received:`,A),S.u_(A)}})),I(l,Vk.STAT_EVENT,(T=>{T.stat===Zv.PROXY?fe(kn,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===Zv.NOPROXY&&fe(kn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function c7(){return typeof window<"u"?window:null}function xp(){return typeof document<"u"?document:null}function rN(n){return new aW(n,!0)}class sN{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&fe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const cA="PersistentStream";class u7{constructor(e,t,i,r,s,o,l,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new sN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ae.RESOURCE_EXHAUSTED?(Ei(t.toString()),Ei("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Se(ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return fe(cA,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(fe(cA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class h7 extends u7{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=dW(e.writeResults,e.commitTime),i=Sr(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=uW(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>dm(this.serializer,i)))};this.q_(t)}}class d7{}class f7 extends d7{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Se(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,hx(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Se(ae.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,hx(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Se(ae.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class g7{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ei(t),this.aa=!1):fe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const py="RemoteStore";class p7{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{yy(this)&&(fe(py,"Restarting streams for network reachability change."),await(async function(u){const h=St(u);h.Ea.add(4),await my(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Rw(h)})(this))}))})),this.Ra=new g7(i,r)}}async function Rw(n){if(yy(n))for(const e of n.da)await e(!0)}async function my(n){for(const e of n.da)await e(!1)}function yy(n){return St(n).Ea.size===0}async function oN(n,e,t){if(!Ol(e))throw e;n.Ea.add(1),await my(n),n.Ra.set("Offline"),t||(t=()=>n7(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{fe(py,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Rw(n)}))}function aN(n,e){return e().catch((t=>oN(n,t,e)))}async function _y(n){const e=St(n),t=sa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ul;for(;m7(e);)try{const r=await i7(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,y7(e,r)}catch(r){await oN(e,r)}lN(e)&&cN(e)}function m7(n){return yy(n)&&n.Ta.length<10}function y7(n,e){n.Ta.push(e);const t=sa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function lN(n){return yy(n)&&!sa(n).x_()&&n.Ta.length>0}function cN(n){sa(n).start()}async function _7(n){sa(n).ra()}async function v7(n){const e=sa(n);for(const t of n.Ta)e.ea(t.mutations)}async function x7(n,e,t){const i=n.Ta.shift(),r=xw.from(i,e,t);await aN(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await _y(n)}async function w7(n,e){e&&sa(n).X_&&await(async function(i,r){if((function(o){return nW(o)&&o!==ae.ABORTED})(r.code)){const s=i.Ta.shift();sa(i).B_(),await aN(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await _y(i)}})(n,e),lN(n)&&cN(n)}async function E7(n,e){const t=St(n);e?(t.Ea.delete(2),await Rw(t)):e||(t.Ea.add(2),await my(t),t.Ra.set("Unknown"))}function sa(n){return n.fa||(n.fa=(function(t,i,r){const s=St(t);return s.sa(),new h7(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:_7.bind(null,n),r_:w7.bind(null,n),ta:v7.bind(null,n),na:x7.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await _y(n)):(await n.fa.stop(),n.Ta.length>0&&(fe(py,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Aw{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new cl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new Aw(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function T7(n,e){if(Ei("AsyncQueue",`${e}: ${n}`),Ol(n))return new Se(ae.UNAVAILABLE,`${e}: ${n}`);throw n}class S7{constructor(){this.queries=uA(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=St(t),s=r.queries;r.queries=uA(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(i)}))})(this,new Se(ae.ABORTED,"Firestore shutting down"))}}function uA(){return new la((n=>ID(n)),SD)}function I7(n){n.Ca.forEach((e=>{e.next()}))}var hA,dA;(dA=hA||(hA={})).Ma="default",dA.Cache="cache";const C7="SyncEngine";class R7{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new la((l=>ID(l)),SD),this.Iu=new Map,this.Eu=new Set,this.du=new li(Ee.comparator),this.Au=new Map,this.Ru=new Sw,this.Vu={},this.mu=new Map,this.fu=Al.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function fA(n,e,t){const i=St(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const u=St(o);u.onlineState=l;let h=!1;u.queries.forEach(((f,p)=>{for(const y of p.Sa)y.va(l)&&(h=!0)})),h&&I7(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function A7(n,e){const t=St(n),i=e.batch.batchId;try{const r=await t7(t.localStore,e);hN(t,i,null),uN(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await bw(t,r)}catch(r){await ty(r)}}async function b7(n,e,t){const i=St(n);try{const r=await(function(o,l){const u=St(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next((p=>(Ne(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);hN(i,e,t),uN(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await bw(i,r)}catch(r){await ty(r)}}function uN(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function hN(n,e,t){const i=St(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function bw(n,e,t){const i=St(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){r.push(h);const f=Cw.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const f=St(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>Z.forEach(h,(y=>Z.forEach(y.Es,(x=>f.persistence.referenceDelegate.addReference(p,y.targetId,x))).next((()=>Z.forEach(y.ds,(x=>f.persistence.referenceDelegate.removeReference(p,y.targetId,x)))))))))}catch(p){if(!Ol(p))throw p;fe(QW,"Failed to update sequence numbers: "+p)}for(const p of h){const y=p.targetId;if(!p.fromCache){const x=f.Ms.get(y),S=x.snapshotVersion,I=x.withLastLimboFreeSnapshotVersion(S);f.Ms=f.Ms.insert(y,I)}}})(i.localStore,s))}async function P7(n,e){const t=St(n);if(!t.currentUser.isEqual(e)){fe(C7,"User change. New user:",e.toKey());const i=await e7(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new Se(ae.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await bw(t,i.Ls)}}function k7(n){const e=St(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=A7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=b7.bind(null,e),e}class yx{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rN(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return nN(this.persistence,new tN,e.initialUser,this.serializer)}Cu(e){return new eN(gy.mi,this.serializer)}Du(e){return new iN}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yx.provider={build:()=>new yx};class D7 extends yx{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await k7(this.xu.syncEngine),await _y(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return nN(this.persistence,new tN,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new NW(i,e.asyncQueue,t)}Mu(e,t){const i=new X8(t,this.persistence);return new H8(e.asyncQueue,i)}Cu(e){const t=YW(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new Iw(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,c7(),xp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new iN}}class _x{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>fA(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=P7.bind(null,this.syncEngine),await E7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new S7})()}createDatastore(e){const t=rN(e.databaseInfo.databaseId),i=(function(s){return new l7(s)})(e.databaseInfo);return(function(s,o,l,u){return new f7(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new p7(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>fA(this.syncEngine,t,0)),(function(){return lA.v()?new lA:new r7})())}createSyncEngine(e,t){return(function(r,s,o,l,u,h,f){const p=new R7(r,s,o,l,u,h);return f&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=St(t);fe(py,"RemoteStore shutting down."),i.Ea.add(5),await my(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}_x.provider={build:()=>new _x};const gA="FirestoreClient";class N7{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=wn.UNAUTHENTICATED,this.clientId=Gk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{fe(gA,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(fe(gA,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=T7(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function dN(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const pA=new Map;const fN="firestore.googleapis.com",mA=!0;class yA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Se(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=fN,this.ssl=mA}else this.host=e.host,this.ssl=e.ssl??mA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=HD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<kW)throw new Se(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}U8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dN(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gN{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new k8;switch(i.type){case"firstParty":return new L8(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Se(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=pA.get(t);i&&(fe("ComponentProvider","Removing Datastore"),pA.delete(t),i.terminate())})(this),Promise.resolve()}}function M7(n,e,t,i={}){n=$k(n,gN);const r=Ml(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&($1(`https://${l}`),K1("Firestore",!0)),s.host!==fN&&s.host!==l&&ey("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:r,emulatorOptions:i};if(!wl(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=wn.MOCK_USER;else{h=YP(i.mockUserToken,n._app?.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new Se(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new wn(p)}n._authCredentials=new D8(new Bk(h,f))}}class Pw{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Pw(this.firestore,e,this._query)}}class ts{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new kw(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ts(this.firestore,e,this._key)}toJSON(){return{type:ts._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(yf(t,ts._jsonSchema))return new ts(e,i||null,new Ee(Rt.fromString(t.referencePath)))}}ts._jsonSchemaVersion="firestore/documentReference/1.0",ts._jsonSchema={type:Xt("string",ts._jsonSchemaVersion),referencePath:Xt("string")};class kw extends Pw{constructor(e,t,i){super(e,t,TD(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ts(this.firestore,null,new Ee(e))}withConverter(e){return new kw(this.firestore,e,this._path)}}const _A="AsyncQueue";class vA{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new sN(this,"async_queue_retry"),this._c=()=>{const i=xp();i&&fe(_A,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=xp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=xp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new cl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ol(e))throw e;fe(_A,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ei("INTERNAL UNHANDLED ERROR: ",xA(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Aw.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Re(47125,{Pc:xA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function xA(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class pN extends gN{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new vA,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vA(e),this._firestoreClient=void 0,await e}}}function L7(n,e){const t=typeof n=="object"?n:q1(),i=typeof n=="string"?n:am,r=Ym(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=HP("firestore");s&&M7(r,...s)}return r}function O7(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new SG(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,dN(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new N7(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function F7(n,e){ey("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return V7(n,_x.provider,{build:i=>new D7(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function V7(n,e,t){if((n=$k(n,pN))._firestoreClient||n._terminated)throw new Se(ae.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Se(ae.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},O7(n)}class Os{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Os(ci.fromBase64String(e))}catch(t){throw new Se(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Os(ci.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Os._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(yf(e,Os._jsonSchema))return Os.fromBase64String(e.bytes)}}Os._jsonSchemaVersion="firestore/bytes/1.0",Os._jsonSchema={type:Xt("string",Os._jsonSchemaVersion),bytes:Xt("string")};class mN{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Se(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class dl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Se(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Se(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ke(this._lat,e._lat)||Ke(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:dl._jsonSchemaVersion}}static fromJSON(e){if(yf(e,dl._jsonSchema))return new dl(e.latitude,e.longitude)}}dl._jsonSchemaVersion="firestore/geoPoint/1.0",dl._jsonSchema={type:Xt("string",dl._jsonSchemaVersion),latitude:Xt("number"),longitude:Xt("number")};class fl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:fl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(yf(e,fl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new fl(e.vectorValues);throw new Se(ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fl._jsonSchemaVersion="firestore/vectorValue/1.0",fl._jsonSchema={type:Xt("string",fl._jsonSchemaVersion),vectorValues:Xt("object")};const j7=new RegExp("[~\\*/\\[\\]]");function z7(n,e,t){if(e.search(j7)>=0)throw wA(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new mN(...e.split("."))._internalPath}catch{throw wA(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function wA(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new Se(ae.INVALID_ARGUMENT,s+n+o)}class yN{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ts(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new U7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(_N("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class U7 extends yN{data(){return super.data()}}function _N(n,e){return typeof e=="string"?z7(n,e):e instanceof mN?e._internalPath:e._delegate._internalPath}class tp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class tu extends yN{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(_N("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=tu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}tu._jsonSchemaVersion="firestore/documentSnapshot/1.0",tu._jsonSchema={type:Xt("string",tu._jsonSchemaVersion),bundleSource:Xt("string","DocumentSnapshot"),bundleName:Xt("string"),bundle:Xt("string")};class wp extends tu{data(e={}){return super.data(e)}}class dd{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new tp(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new wp(this._firestore,this._userDataWriter,i.key,i,new tp(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Se(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const u=new wp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new tp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new wp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new tp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:B7(l.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=dd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Gk.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function B7(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re(61501,{type:n})}}dd._jsonSchemaVersion="firestore/querySnapshot/1.0",dd._jsonSchema={type:Xt("string",dd._jsonSchemaVersion),bundleSource:Xt("string","QuerySnapshot"),bundleName:Xt("string"),bundle:Xt("string")};(function(e,t=!0){(function(r){Lu=r})(Ll),El(new na("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new pN(new N8(i.getProvider("auth-internal")),new O8(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Se(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Eu(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),rs(hR,dR,e),rs(hR,dR,"esm2020")})();const vN="firebasestorage.googleapis.com",G7="storageBucket",W7=120*1e3,$7=600*1e3;class ds extends hs{constructor(e,t,i=0){super(J0(e),`Firebase Storage: ${t} (${J0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return J0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ls;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ls||(ls={}));function J0(n){return"storage/"+n}function K7(){const n="An unknown error occurred, please check the error payload for server response.";return new ds(ls.UNKNOWN,n)}function H7(){return new ds(ls.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function X7(){return new ds(ls.CANCELED,"User canceled the upload/download.")}function q7(n){return new ds(ls.INVALID_URL,"Invalid URL '"+n+"'.")}function Y7(n){return new ds(ls.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function EA(n){return new ds(ls.INVALID_ARGUMENT,n)}function xN(){return new ds(ls.APP_DELETED,"The Firebase app was deleted.")}function Z7(n){return new ds(ls.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class wr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=wr.makeFromUrl(e,t)}catch{return new wr(e,"")}if(i.path==="")return i;throw Y7(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(R){R.path_=decodeURIComponent(R.path)}const f="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",x=new RegExp(`^https?://${p}/${f}/b/${r}/o${y}`,"i"),S={bucket:1,path:3},I=t===vN?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",A=new RegExp(`^https?://${I}/${r}/${T}`,"i"),N=[{regex:l,indices:u,postModify:s},{regex:x,indices:S,postModify:h},{regex:A,indices:{bucket:1,path:2},postModify:h}];for(let R=0;R<N.length;R++){const L=N[R],j=L.regex.exec(e);if(j){const D=j[L.indices.bucket];let b=j[L.indices.path];b||(b=""),i=new wr(D,b),L.postModify(i);break}}if(i==null)throw q7(e);return i}}class Q7{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function J7(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function f(...T){h||(h=!0,e.apply(null,T))}function p(T){r=setTimeout(()=>{r=null,n(x,u())},T)}function y(){s&&clearTimeout(s)}function x(T,...A){if(h){y();return}if(T){y(),f.call(null,T,...A);return}if(u()||o){y(),f.call(null,T,...A);return}i<64&&(i*=2);let N;l===1?(l=2,N=0):N=(i+Math.random())*1e3,p(N)}let S=!1;function I(T){S||(S=!0,y(),!h&&(r!==null?(T||(l=2),clearTimeout(r),p(0)):T||(l=1)))}return p(0),s=setTimeout(()=>{o=!0,I(!0)},t),I}function e$(n){n(!1)}function t$(n){return n!==void 0}function TA(n,e,t,i){if(i<e)throw EA(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw EA(`Invalid value for '${n}'. Expected ${t} or less.`)}function n$(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var mm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(mm||(mm={}));function i$(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class r${constructor(e,t,i,r,s,o,l,u,h,f,p,y=!0,x=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=p,this.retry=y,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,I)=>{this.resolve_=S,this.reject_=I,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new np(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===mm.NO_ERROR,u=s.getStatus();if(!l||i$(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===mm.ABORT;i(!1,new np(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new np(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());t$(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=K7();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?xN():X7();o(u)}else{const u=H7();o(u)}};this.canceled_?t(!1,new np(!1,null,!0)):this.backoffId_=J7(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&e$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class np{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function s$(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function o$(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function a$(n,e){e&&(n["X-Firebase-GMPID"]=e)}function l$(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function c$(n,e,t,i,r,s,o=!0,l=!1){const u=n$(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return a$(f,e),s$(f,t),o$(f,s),l$(f,i),new r$(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function u$(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function h$(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class ym{constructor(e,t){this._service=e,t instanceof wr?this._location=t:this._location=wr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ym(e,t)}get root(){const e=new wr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return h$(this._location.path)}get storage(){return this._service}get parent(){const e=u$(this._location.path);if(e===null)return null;const t=new wr(this._location.bucket,e);return new ym(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Z7(e)}}function SA(n,e){const t=e?.[G7];return t==null?null:wr.makeFromBucketSpec(t,n)}function d$(n,e,t,i={}){n.host=`${e}:${t}`;const r=Ml(e);r&&($1(`https://${n.host}/b`),K1("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:YP(s,n.app.options.projectId))}class f${constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=vN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=W7,this._maxUploadRetryTime=$7,this._requests=new Set,r!=null?this._bucket=wr.makeFromBucketSpec(r,this._host):this._bucket=SA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=wr.makeFromBucketSpec(this._url,e):this._bucket=SA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){TA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){TA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Ki(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ym(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new Q7(xN());{const o=c$(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const IA="@firebase/storage",CA="0.14.0";const wN="storage";function g$(n=q1(),e){n=eo(n);const i=Ym(n,wN).getImmediate({identifier:e}),r=HP("storage");return r&&p$(i,...r),i}function p$(n,e,t,i={}){d$(n,e,t,i)}function m$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new f$(t,i,r,e,Ll)}function y$(){El(new na(wN,m$,"PUBLIC").setMultipleInstances(!0)),rs(IA,CA,""),rs(IA,CA,"esm2020")}y$();const _$={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},Dw=ik(_$),ev=R8(Dw),v$=L7(Dw);g$(Dw);F7(v$).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const x$="visvriend2024",w$=new Ls,EN=us()(hf((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===x$;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await OB(ev,w$);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await mB(ev),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{pB(ev,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})}));function E$({target:n}){const e=q.useRef(null),t=q.useRef(null),i=Js(s=>s.setMap),r=mt(s=>s.showScaleBar);return q.useEffect(()=>{if(!e.current){const s=new pz({target:n,controls:[],view:new Zr({center:pl([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),q.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new _z({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const T$=["OpenStreetMap","Luchtfoto"];function S$(){const n=q.useRef(null),e=q.useRef(!1);E$({target:"map"});const t=Js(u=>u.map),i=qo(u=>u.registerLayer),r=qo(u=>u.setLayerVisibility),s=mt(u=>u.defaultBackground),o=mt(u=>u.gpsAutoStart),l=wi(u=>u.startTracking);return q.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const u=new b0({properties:{title:"OpenStreetMap",type:"base"},visible:!0,source:new L6}),h=new b0({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Mv({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),f=new b0({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Mv({url:"https://{a-d}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})});t.addLayer(u),t.addLayer(h),t.addLayer(f),i("OpenStreetMap",u),i("Luchtfoto",h),i("Labels Overlay",f),t.updateSize(),p();async function p(){const y=Wz();console.log(`Loading ${y.length} immediate layers...`),(await Promise.allSettled(y.map(async S=>{try{const I=await S.factory();return I?{name:S.name,layer:I}:null}catch(I){return console.warn(`Failed to create ${S.name}:`,I),null}}))).forEach(S=>{if(S.status==="fulfilled"&&S.value){const{name:I,layer:T}=S.value;t.addLayer(T),i(I,T)}})}},[t,i]),q.useEffect(()=>{if(!t||e.current)return;const u=setTimeout(()=>{const h=s||"OpenStreetMap";T$.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(u)},[t,s,r]),q.useEffect(()=>{if(!t||!o)return;const u=setTimeout(()=>l(),500);return()=>clearTimeout(u)},[t,o,l]),_.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const I$=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),C$=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),RA=n=>{const e=C$(n);return e.charAt(0).toUpperCase()+e.slice(1)},TN=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),R$=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var A$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const b$=q.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},u)=>q.createElement("svg",{ref:u,...A$,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:TN("lucide",r),...!s&&!R$(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>q.createElement(h,f)),...Array.isArray(s)?s:[s]]));const Ae=(n,e)=>{const t=q.forwardRef(({className:i,...r},s)=>q.createElement(b$,{ref:s,iconNode:e,className:TN(`lucide-${I$(RA(n))}`,`lucide-${n}`,i),...r}));return t.displayName=RA(n),t};const P$=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],SN=Ae("anchor",P$);const k$=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],D$=Ae("book-open",k$);const N$=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Nw=Ae("camera",N$);const M$=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],IN=Ae("chart-column",M$);const L$=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],vx=Ae("check",L$);const O$=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],F$=Ae("chevron-left",O$);const V$=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],CN=Ae("chevron-right",V$);const j$=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],z$=Ae("chevron-up",j$);const U$=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],xx=Ae("clock",U$);const B$=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],G$=Ae("cloud-lightning",B$);const W$=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],$$=Ae("cloud-rain",W$);const K$=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],H$=Ae("cloud-snow",K$);const X$=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],fd=Ae("cloud",X$);const q$=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],RN=Ae("external-link",q$);const Y$=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Z$=Ae("eye-off",Y$);const Q$=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],J$=Ae("eye",Q$);const eK=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],tK=Ae("file-text",eK);const nK=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],Ys=Ae("fish",nK);const iK=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],rK=Ae("image-plus",iK);const sK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],AN=Ae("info",sK);const oK=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],_m=Ae("layers",oK);const aK=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],lK=Ae("loader-circle",aK);const cK=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],uK=Ae("locate-fixed",cK);const hK=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],dK=Ae("lock",hK);const fK=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],gK=Ae("log-out",fK);const pK=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],bl=Ae("map-pin",pK);const mK=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],vy=Ae("map",mK);const yK=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],_K=Ae("menu",yK);const vK=[["path",{d:"M5 12h14",key:"1ays0h"}]],xK=Ae("minus",vK);const wK=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],EK=Ae("moon",wK);const TK=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],bN=Ae("navigation",TK);const SK=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],PN=Ae("pause",SK);const IK=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],CK=Ae("person-standing",IK);const RK=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],kN=Ae("play",RK);const AK=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],bK=Ae("plus",AK);const PK=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],kK=Ae("rotate-ccw",PK);const DK=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],NK=Ae("ruler",DK);const MK=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],LK=Ae("save",MK);const OK=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],FK=Ae("scale",OK);const VK=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],AA=Ae("search",VK);const jK=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zK=Ae("settings",jK);const UK=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],BK=Ae("ship",UK);const GK=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],WK=Ae("sparkles",GK);const $K=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],wx=Ae("star",$K);const KK=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],HK=Ae("sun",KK);const XK=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],qK=Ae("tag",XK);const YK=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],DN=Ae("thermometer",YK);const ZK=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],QK=Ae("trending-down",ZK);const JK=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],eH=Ae("trending-up",JK);const tH=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],nH=Ae("user",tH);const iH=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],vm=Ae("waves",iH);const rH=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],Mw=Ae("wind",rH);const sH=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ji=Ae("x",sH);async function oH(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e(null);return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,p=r.getUint16(f)===18761,y=aH(r,f,p);e(y);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e(null)},t.onerror=()=>e(null),t.readAsArrayBuffer(n)})}function aH(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null;for(let p=0;p<r;p++){const y=i+2+p*12;if(n.getUint16(y,t)===34853){s=e+n.getUint32(y+8,t);break}}if(!s)return null;const o=n.getUint16(s,t);let l=null,u=null,h=null,f=null;for(let p=0;p<o;p++){const y=s+2+p*12,x=n.getUint16(y,t),S=n.getUint16(y+2,t),I=n.getUint32(y+4,t),T=y+8;switch(x){case 1:l=String.fromCharCode(n.getUint8(T));break;case 2:u=bA(n,e+n.getUint32(T,t),3,t);break;case 3:h=String.fromCharCode(n.getUint8(T));break;case 4:f=bA(n,e+n.getUint32(T,t),3,t);break}}if(u&&f&&l&&h){const p=PA(u[0],u[1],u[2],l),y=PA(f[0],f[1],f[2],h);if(!isNaN(p)&&!isNaN(y))return{lat:p,lng:y}}return null}catch{return null}}function bA(n,e,t,i){const r=[];for(let s=0;s<t;s++){const o=n.getUint32(e+s*8,i),l=n.getUint32(e+s*8+4,i);r.push(l===0?0:o/l)}return r}function PA(n,e,t,i){let r=n+e/60+t/3600;return(i==="S"||i==="W")&&(r=-r),r}const NN=200,lH=.7;async function cH(n,e=NN){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,u=r.height;l>u?l>e&&(u=Math.round(u*e/l),l=e):u>e&&(l=Math.round(l*e/u),u=e),s.width=l,s.height=u,o?.drawImage(r,0,0,l,u),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",lH)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function uH(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function MN(n){const e=await cH(n,NN),t=await uH(e);return{thumbnailBlob:e,thumbnailBase64:t}}function LN(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function hH(){const n=Js(N=>N.map),e=ii(N=>N.openCatchForm),[t,i]=q.useState(null),[r,s]=q.useState(!1),[o,l]=q.useState(!1),u=q.useRef(null),h=q.useRef(null);q.useEffect(()=>{if(!n)return;const N=n.getViewport();if(!N)return;const R=600,L=15,j=O=>{if(O.touches.length!==1)return;const le=O.touches[0];h.current={x:le.clientX,y:le.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const pe=window.__olMap;if(!pe)return;const ge=N.getBoundingClientRect(),ue=[h.current.x-ge.left,h.current.y-ge.top],Q=pe.getCoordinateFromPixel(ue);if(Q){const se=RI(Q);O.preventDefault(),i({pixel:[h.current.x,h.current.y],coordinate:se}),s(!0),l(!1),setTimeout(()=>l(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},R)},D=O=>{if(!u.current||!h.current)return;const le=O.touches[0],pe=le.clientX-h.current.x,ge=le.clientY-h.current.y;Math.sqrt(pe*pe+ge*ge)>L&&(clearTimeout(u.current),u.current=null)},b=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null},M=O=>{r&&O.preventDefault()},V=O=>{O.button===0&&(h.current={x:O.clientX,y:O.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const le=window.__olMap;if(!le)return;const pe=N.getBoundingClientRect(),ge=[h.current.x-pe.left,h.current.y-pe.top],ue=le.getCoordinateFromPixel(ge);if(ue){const Q=RI(ue);i({pixel:[h.current.x,h.current.y],coordinate:Q}),s(!0),l(!1),setTimeout(()=>l(!0),300)}},R))},z=O=>{if(!u.current||!h.current)return;const le=O.clientX-h.current.x,pe=O.clientY-h.current.y;Math.sqrt(le*le+pe*pe)>L&&(clearTimeout(u.current),u.current=null)},B=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null};return N.addEventListener("touchstart",j,{passive:!1}),N.addEventListener("touchmove",D,{passive:!0}),N.addEventListener("touchend",b),N.addEventListener("touchcancel",b),N.addEventListener("contextmenu",M),N.addEventListener("mousedown",V),N.addEventListener("mousemove",z),N.addEventListener("mouseup",B),N.addEventListener("mouseleave",B),()=>{N.removeEventListener("touchstart",j),N.removeEventListener("touchmove",D),N.removeEventListener("touchend",b),N.removeEventListener("touchcancel",b),N.removeEventListener("contextmenu",M),N.removeEventListener("mousedown",V),N.removeEventListener("mousemove",z),N.removeEventListener("mouseup",B),N.removeEventListener("mouseleave",B),u.current&&clearTimeout(u.current)}},[n,r]);const f=()=>{o&&(s(!1),i(null),l(!1))},p=()=>{s(!1),i(null),l(!1)},y=q.useRef(null),x=()=>{if(!t)return;const[N,R]=t.coordinate;e({location:{lat:R,lng:N},locationSource:"map"}),p()},S=()=>{y.current?.click()},I=async N=>{const R=N.target.files?.[0];if(!(!R||!t)){try{const L=await oH(R),{thumbnailBase64:j}=await MN(R),D={id:LN(),thumbnailBase64:j,createdAt:new Date().toISOString(),pendingUpload:!0};if(L)e({location:L,locationSource:"photo",photos:[D]});else{const[b,M]=t.coordinate;e({location:{lat:M,lng:b},locationSource:"map",photos:[D]})}}catch(L){console.error("Failed to process photo:",L);const[j,D]=t.coordinate;e({location:{lat:D,lng:j},locationSource:"map"})}N.target.value="",p()}},T=()=>{if(!t)return;const[N,R]=t.coordinate,L=`https://www.google.com/maps?q=${R},${N}`;window.open(L,"_blank"),p()},A=()=>{if(!t)return;const[N,R]=t.coordinate,L=`https://www.google.com/maps?layer=c&cbll=${R},${N}`;window.open(L,"_blank"),p()},P=N=>{const[R,L]=N;return`${L.toFixed(5)}N, ${R.toFixed(5)}E`};return _.jsx(Ii,{children:r&&t&&_.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),_.jsxs(ze.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(t.pixel[0],window.innerWidth-220),top:Math.min(t.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[_.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:_.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[_.jsx(bl,{size:16}),_.jsx("span",{className:"text-xs font-mono",children:P(t.coordinate)})]})}),_.jsxs("div",{className:"bg-white",children:[_.jsxs("button",{onClick:S,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(Nw,{size:20,className:"text-green-500"}),_.jsx("span",{className:"font-medium",children:"Maak foto"})]}),_.jsxs("button",{onClick:x,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(Ys,{size:20,className:"text-orange-500"}),_.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),_.jsxs("button",{onClick:A,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(CK,{size:20,className:"text-yellow-600"}),_.jsx("span",{className:"font-medium",children:"Street View"})]}),_.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(RN,{size:20,className:"text-blue-600"}),_.jsx("span",{className:"font-medium",children:"Google Maps"})]})]}),_.jsx("input",{ref:y,type:"file",accept:"image/*",capture:"environment",onChange:I,className:"hidden"}),_.jsx("div",{className:"bg-white",children:_.jsxs("button",{onClick:p,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[_.jsx(Ji,{size:18}),_.jsx("span",{children:"Annuleren"})]})})]})]})})}function dH(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=wi(),s=q.useCallback(l=>{i(l)},[i]),o=q.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return q.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function fH(){const{tracking:n,toggle:e}=dH();return _.jsx(ze.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:_.jsx(uK,{size:22,strokeWidth:2})})}const gH="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function pH(){const n=Js(y=>y.map),e=wi(y=>y.position),t=wi(y=>y.accuracy),i=wi(y=>y.tracking),r=wi(y=>y.smoothHeading),s=mt(y=>y.showAccuracyCircle),o=wi(y=>y.firstFix),l=wi(y=>y.resetFirstFix),u=q.useRef(null),h=q.useRef(null),f=q.useRef(null),p=q.useMemo(()=>y=>new Zi({image:new A1({src:gH,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return q.useEffect(()=>{if(!n||!i&&!e)return;const y=pl([5.1214,52.0907]);return u.current=new au({geometry:new ml(y)}),u.current.setStyle(p(0)),h.current=new au({geometry:new ml(y)}),f.current=new O1({source:new R1({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,p]),q.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const y=pl([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const x=n.getView().getResolution()||1,S=Math.min(t/x,80);h.current.setStyle(new Zi({image:new Dl({radius:S,fill:new Ir({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new Zi({}));if(o&&i){n.getView().setCenter(y),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:y,duration:150})},[n,i,e,t,o,l,s]),q.useEffect(()=>{if(!u.current)return;const y=r!==null?r*Math.PI/180:0;u.current.setStyle(p(y))},[r,p]),null}function mH(){const n=Js(N=>N.map),[e,t]=q.useState(!1),[i,r]=q.useState(""),[s,o]=q.useState([]),[l,u]=q.useState(!1),[h,f]=q.useState(!1),p=q.useRef(null),y=q.useRef(null),x=q.useRef();q.useEffect(()=>{e&&p.current&&p.current.focus()},[e]),q.useEffect(()=>{if(!e)return;const N=R=>{y.current&&!y.current.contains(R.target)&&S()};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[e]),q.useEffect(()=>{if(!e)return;const N=R=>{R.key==="Escape"&&S()};return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},[e]),q.useEffect(()=>{if(x.current&&clearTimeout(x.current),i.length<2){o([]);return}return x.current=window.setTimeout(async()=>{f(!0);try{const R=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();R.response?.docs&&o(R.response.docs)}catch(N){console.error("Search error:",N),o([])}finally{f(!1)}},300),()=>{x.current&&clearTimeout(x.current)}},[i]);const S=()=>{t(!1),r(""),o([]),u(!1)},I=async N=>{try{const L=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(N)}`)).json();if(L.response?.docs?.[0]?.centroide_ll){const D=L.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(D)return{lng:parseFloat(D[1]),lat:parseFloat(D[2])}}}catch(R){console.error("Lookup error:",R)}return null},T=async N=>{if(!n)return;const R=await I(N.id);R&&n.getView().animate({center:pl([R.lng,R.lat]),zoom:16,duration:1e3}),S()},A=async(N,R)=>{R.stopPropagation();const L=await I(N.id);if(L){const j=`https://www.google.com/maps?q=${L.lat},${L.lng}`;window.open(j,"_blank")}S()},P={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?_.jsxs("div",{ref:y,className:"fixed left-[52px] right-14 z-[850]",style:P,children:[_.jsxs(ze.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[_.jsx(AA,{size:18,className:"search-icon"}),_.jsx("input",{ref:p,type:"text",value:i,onChange:N=>{r(N.target.value),u(!0)},onFocus:()=>u(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),_.jsx("button",{onClick:S,className:"search-clear",title:"Sluiten",children:_.jsx(Ji,{size:18})})]}),_.jsx(Ii,{children:l&&s.length>0&&_.jsx(ze.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(N=>_.jsxs("li",{className:"search-result-item",children:[_.jsx("div",{className:"search-result-content",onClick:()=>T(N),children:_.jsx("span",{className:"search-result-text",children:N.weergavenaam})}),_.jsx("button",{className:"search-navigate-btn",onClick:R=>A(N,R),title:"Open in Google Maps",children:_.jsx(RN,{size:20})})]},N.id))})}),l&&h&&_.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):_.jsx(ze.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:P,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:_.jsx(AA,{size:22,className:"text-gray-600"})})}function yH({size:n=18}){return _.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[_.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),_.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),_.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),_.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function _H(){const[n,e]=q.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=ii(),{user:r,loading:s,signInWithGoogle:o,logout:l}=EN(),u=mt(T=>T.showCatchButton),h=mt(T=>T.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},p=()=>e(!1),y=()=>{p(),t()},x=()=>{p(),i()},S=()=>{p(),o()},I=()=>{p(),l()};return _.jsxs(_.Fragment,{children:[_.jsx(ze.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?_.jsx(Ji,{size:22,className:"text-white"}):_.jsx(_K,{size:22,className:"text-gray-600"})}),_.jsx(Ii,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:p}),_.jsxs(ze.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[_.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-blue-500",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?_.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:_.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):r?_.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:_.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?_.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):_.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:_.jsx(nH,{size:16,className:"text-white"})}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),_.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),_.jsx("button",{onClick:I,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:_.jsx(gK,{size:16})})]})}):_.jsxs("button",{onClick:S,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[_.jsx(yH,{size:18}),_.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),_.jsx("div",{className:"py-1",children:_.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[_.jsx(AN,{size:18,className:"text-blue-500"}),_.jsx("span",{children:"Info & handleiding"})]})}),_.jsx("div",{className:"py-1 border-t border-gray-100",children:_.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx(Ys,{size:18,className:"text-green-500"}),_.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),_.jsx("button",{onClick:()=>h(!u),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${u?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:_.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${u?"left-[22px]":"left-0.5"}`})})]})}),_.jsx("div",{className:"mt-auto border-t border-gray-100",children:_.jsxs("button",{onClick:x,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[_.jsx(zK,{size:18,className:"text-gray-500"}),_.jsx("span",{children:"Instellingen"})]})}),_.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.5"})]})]})})]})}function vH(){const{infoPanelOpen:n,toggleInfoPanel:e}=ii(),[t,i]=q.useState("info"),r=[{id:"info",label:"Info",icon:_.jsx(AN,{size:14})},{id:"functies",label:"Functies",icon:_.jsx(tK,{size:14})},{id:"handleiding",label:"Handleiding",icon:_.jsx(D$,{size:14})}];return _.jsx(Ii,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),_.jsxs(ze.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.5"}),_.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:_.jsx(Ji,{size:18,className:"text-white",strokeWidth:2.5})})]}),_.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>_.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&_.jsx(xH,{}),t==="functies"&&_.jsx(wH,{}),t==="handleiding"&&_.jsx(EH,{}),_.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:_.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.5 - Voor jou en je vismaat"})})]})]})]})})}function xH(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),_.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),_.jsxs("ul",{className:"space-y-2 text-gray-600",children:[_.jsxs("li",{children:[_.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),_.jsxs("li",{children:[_.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),_.jsxs("div",{className:"text-gray-600 space-y-2",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function wH(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(vy,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsxs("li",{children:[_.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(Ys,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Registreer soort, gewicht en lengte"}),_.jsx("li",{children:"Vismethode en aas bijhouden"}),_.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),_.jsx("li",{children:"GPS locatie per vangst"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(bl,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Markeer je beste visplekken"}),_.jsx("li",{children:"Voeg notities en ratings toe"}),_.jsx("li",{children:"Welke vis zit waar?"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(fd,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Live weergegevens op je locatie"}),_.jsx("li",{children:"Windsnelheid en richting"}),_.jsx("li",{children:"Luchtdruk"}),_.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(bN,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Live GPS tracking"}),_.jsx("li",{children:"Zoek adressen en plaatsen"}),_.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function EH(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),_.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[_.jsxs("li",{children:["Tik op de ",_.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),_.jsxs("li",{children:["Gebruik het ",_.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),_.jsxs("li",{children:["Tik op de ",_.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[_.jsxs("li",{children:["Gebruik de ",_.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),_.jsxs("li",{children:["Check de ",_.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),_.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),_.jsxs("li",{children:["Markeer succesvolle plekken als ",_.jsx("strong",{children:"favoriet"})]})]})]})]})}const TH=pl([5.1214,52.0907]),SH=8;function IH(){const n=Js(r=>r.map),e=qo(r=>r.setLayerVisibility),t=wi(r=>r.stopTracking),i=()=>{t(),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Labels Overlay",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:TH,zoom:SH,rotation:0,duration:500})};return _.jsx(ze.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:_.jsx(kK,{size:18,className:"text-gray-600"})})}const CH={Map:vy,Fish:Ys,Anchor:SN,Layers:_m,Star:wx},RH={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},AH={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function bH(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=Yz(),[r,s]=q.useState(!1),[o,l]=q.useState(null),[u,h]=q.useState(!1),[f,p]=q.useState(""),y=I=>{e(I),s(!1)},x=(I,T)=>{I.stopPropagation();const{useLayerStore:A}=require("../../store"),P=A.getState().visible,N=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(R=>P[R]);t(T,{layers:N}),l(T),setTimeout(()=>l(null),2e3)},S=()=>{f.trim()&&(i(f.trim()),p(""),h(!1))};return _.jsxs(_.Fragment,{children:[_.jsx(ze.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?_.jsx(z$,{size:20,className:"text-blue-600"}):_.jsx(_m,{size:20,className:"text-gray-600"})}),_.jsx(Ii,{children:r&&_.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),_.jsxs(ze.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[_.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),_.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(I=>{const T=CH[I.icon]||_m,A=RH[I.icon]||"text-blue-600",P=AH[I.icon]||"hover:bg-blue-50",N=o===I.id;return _.jsxs("button",{onClick:()=>y(I.id),className:`w-full h-9 flex items-center gap-2 px-2 ${P} rounded text-left transition-colors border-0 outline-none bg-transparent ${N?"bg-green-50":""}`,children:[_.jsx(T,{size:16,className:`${A} flex-shrink-0`}),_.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:I.name}),N?_.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:_.jsx(vx,{size:14,className:"text-green-500"})}):_.jsx("span",{onClick:R=>x(R,I.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:_.jsx(LK,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},I.id)})}),_.jsx("div",{className:"border-t border-gray-200 p-2",children:u?_.jsxs("div",{className:"flex gap-1",children:[_.jsx("input",{type:"text",value:f,onChange:I=>p(I.target.value),onKeyDown:I=>{I.key==="Enter"&&S(),I.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400"}),_.jsx("button",{onClick:S,disabled:!f.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):_.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",children:[_.jsx(bK,{size:14}),_.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const kA={lat:52.1326,lng:5.2913};function PH({size:n=18,className:e=""}){return _.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[_.jsx("path",{d:"M3 12h18"}),_.jsx("path",{d:"M21 12c-1.5 0-3-1-3-3s1.5-3 3-3"}),_.jsx("path",{d:"M21 12c-1.5 0-3 1-3 3s1.5 3 3 3"}),_.jsx("circle",{cx:"4",cy:"12",r:"1.5",fill:"currentColor"}),_.jsx("path",{d:"M8 12l2-3"}),_.jsx("path",{d:"M8 12l2 3"}),_.jsx("path",{d:"M12 12l2-3"}),_.jsx("path",{d:"M12 12l2 3"}),_.jsx("path",{d:"M16 12l1.5-2"}),_.jsx("path",{d:"M16 12l1.5 2"})]})}function DA({size:n=16,className:e="",clipPercent:t=100}){const i=`fish-clip-${Math.random().toString(36).substr(2,9)}`;return _.jsxs("svg",{width:n*(t/100),height:n,viewBox:`0 0 ${24*(t/100)} 24`,fill:"currentColor",className:e,style:{overflow:"hidden"},children:[_.jsx("defs",{children:_.jsx("clipPath",{id:i,children:_.jsx("rect",{x:"0",y:"0",width:24*(t/100),height:"24"})})}),_.jsxs("g",{clipPath:`url(#${i})`,children:[_.jsx("path",{d:"M6.5 12c0-3.5 3-6 7-6 2.5 0 4.5 1 6 2.5.8.8 1.5 1.8 2 3-.5 1.2-1.2 2.2-2 3-1.5 1.5-3.5 2.5-6 2.5-4 0-7-2.5-7-5z"}),_.jsx("path",{d:"M2.5 12l3-3v6l-3-3z"}),_.jsx("circle",{cx:"17",cy:"11",r:"1",fill:"white"})]})]})}function kH({value:n,maxFish:e=3,color:t}){const i=Math.floor(n),r=n%1>=.5,s=[];for(let o=0;o<i&&o<e;o++)s.push(_.jsx(DA,{size:16,className:t},o));return r&&i<e&&s.push(_.jsx(DA,{size:16,className:t,clipPercent:50},"half")),_.jsx("div",{className:"flex items-center gap-0.5",children:s.length>0?s:_.jsx(PH,{size:18,className:t})})}function ON({phase:n,size:e=20}){const t=n<.5,i=n<.5?n*2:(1-n)*2;return _.jsx("div",{className:"relative rounded-full bg-gray-700 overflow-hidden",style:{width:e,height:e},children:_.jsx("div",{className:"absolute inset-0 bg-yellow-100",style:{clipPath:t?`inset(0 ${(1-i)*100}% 0 0)`:`inset(0 0 0 ${(1-i)*100}%)`}})})}function DH({activity:n,label:e}){const t=()=>n>=.8?"bg-green-500":n>=.6?"bg-lime-500":n>=.4?"bg-amber-500":"bg-red-400";return _.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"text-[10px] text-gray-500 w-12",children:e}),_.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:_.jsx("div",{className:`h-full ${t()} transition-all`,style:{width:`${n*100}%`}})})]})}function Lw(n){const e=29.53058867,t=new Date("2000-01-06T18:14:00Z");return(n.getTime()-t.getTime())/(1e3*60*60*24)%e/e}function Ex(n){const e=Lw(n),t=n.getHours(),i=Math.floor((e*24+12)%24),r=(i+6)%24,s=(i+18)%24,o=[i,(i+12)%24],l=[r,s];let u=.3;return(e<.1||e>.9||e>.4&&e<.6)&&(u+=.3),o.forEach(h=>{const f=Math.abs(t-h);f<=1||f>=23?u+=.3:(f<=2||f>=22)&&(u+=.15)}),l.forEach(h=>{const f=Math.abs(t-h);f<=.5?u+=.15:f<=1&&(u+=.08)}),{major:o,minor:l,overall:Math.min(1,u)}}function NH({data:n,onClose:e}){if(n.length===0)return null;const t=n.map(T=>T.pressure),i=Math.min(...t)-2,r=Math.max(...t)+2,s=r-i,o=300,l=120,u={top:10,right:10,bottom:25,left:35},h=o-u.left-u.right,f=l-u.top-u.bottom,p=n.map((T,A)=>{const P=u.left+A/(n.length-1)*h,N=u.top+f-(T.pressure-i)/s*f;return{x:P,y:N,time:T.time,pressure:T.pressure}}),y=p.map((T,A)=>`${A===0?"M":"L"} ${T.x} ${T.y}`).join(" "),x=new Date,S=n.findIndex(T=>new Date(T.time)>=x)||Math.floor(n.length/3),I=T=>new Date(T).getHours().toString().padStart(2,"0")+":00";return _.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:_.jsxs(ze.div,{className:"bg-white rounded-xl shadow-xl p-4 max-w-sm w-full",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:T=>T.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-3",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(IN,{size:18,className:"text-blue-500"}),"Luchtdruk (72 uur)"]}),_.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:18,className:"text-gray-500"})})]}),_.jsxs("svg",{width:o,height:l,className:"w-full",children:[[0,.25,.5,.75,1].map(T=>{const A=u.top+T*f,P=Math.round(r-T*s);return _.jsxs("g",{children:[_.jsx("line",{x1:u.left,y1:A,x2:o-u.right,y2:A,stroke:"#e5e7eb",strokeWidth:"1"}),_.jsx("text",{x:u.left-4,y:A+4,fontSize:"9",fill:"#9ca3af",textAnchor:"end",children:P})]},T)}),[0,Math.floor(n.length/3),Math.floor(2*n.length/3),n.length-1].map(T=>{if(T>=n.length)return null;const A=u.left+T/(n.length-1)*h;return _.jsx("text",{x:A,y:l-5,fontSize:"8",fill:"#9ca3af",textAnchor:"middle",children:I(n[T].time)},T)}),_.jsx("path",{d:`${p.slice(0,S+1).map((T,A)=>`${A===0?"M":"L"} ${T.x} ${T.y}`).join(" ")} L ${p[S]?.x||u.left} ${l-u.bottom} L ${u.left} ${l-u.bottom} Z`,fill:"rgba(59, 130, 246, 0.15)"}),S<p.length-1&&_.jsx("path",{d:`${p.slice(S).map((T,A)=>`${A===0?"M":"L"} ${T.x} ${T.y}`).join(" ")} L ${p[p.length-1].x} ${l-u.bottom} L ${p[S].x} ${l-u.bottom} Z`,fill:"rgba(59, 130, 246, 0.08)"}),_.jsx("path",{d:y,fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),p[S]&&_.jsxs(_.Fragment,{children:[_.jsx("line",{x1:p[S].x,y1:u.top,x2:p[S].x,y2:l-u.bottom,stroke:"#f59e0b",strokeWidth:"1",strokeDasharray:"3,3"}),_.jsx("circle",{cx:p[S].x,cy:p[S].y,r:"4",fill:"#f59e0b"}),_.jsx("text",{x:p[S].x,y:u.top-2,fontSize:"8",fill:"#f59e0b",textAnchor:"middle",children:"Nu"})]})]}),_.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Dalende druk = vaak beter bijten"})]})})}function MH({onClose:n}){const e=new Date,t=Lw(e),i=Ex(e),r=Array.from({length:24},(l,u)=>{const h=new Date(e);return h.setHours(u,0,0,0),{hour:u,activity:Ex(h).overall}}),s=l=>l<.03||l>.97?"Nieuwe maan":l<.22?"Wassende sikkel":l<.28?"Eerste kwartier":l<.47?"Wassende maan":l<.53?"Volle maan":l<.72?"Afnemende maan":l<.78?"Laatste kwartier":"Afnemende sikkel",o=l=>`${l.toString().padStart(2,"0")}:00`;return _.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(ze.div,{className:"bg-white rounded-xl shadow-xl p-4 max-w-sm w-full max-h-[80vh] overflow-y-auto",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:l=>l.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(EK,{size:18,className:"text-blue-500"}),"Solunar Activiteit"]}),_.jsx("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:18,className:"text-gray-500"})})]}),_.jsxs("div",{className:"flex items-center gap-3 mb-4 p-3 bg-gray-50 rounded-lg",children:[_.jsx(ON,{phase:t,size:40}),_.jsxs("div",{children:[_.jsx("div",{className:"font-medium text-gray-800",children:s(t)}),_.jsxs("div",{className:"text-xs text-gray-500",children:[Math.round(t*100),"% cyclus"]})]})]}),_.jsxs("div",{className:"mb-4",children:[_.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Beste tijden vandaag"}),_.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_.jsxs("div",{className:"bg-green-50 p-2 rounded-lg",children:[_.jsx("div",{className:"text-xs text-green-600 font-medium",children:"Major periodes"}),_.jsx("div",{className:"text-sm text-green-800",children:i.major.map(l=>o(l)).join(", ")})]}),_.jsxs("div",{className:"bg-amber-50 p-2 rounded-lg",children:[_.jsx("div",{className:"text-xs text-amber-600 font-medium",children:"Minor periodes"}),_.jsx("div",{className:"text-sm text-amber-800",children:i.minor.map(l=>o(l)).join(", ")})]})]})]}),_.jsxs("div",{className:"mb-3",children:[_.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Activiteit per uur"}),_.jsx("div",{className:"flex items-end gap-0.5 h-16",children:r.map(({hour:l,activity:u})=>_.jsx("div",{className:`flex-1 rounded-t transition-all ${u>=.7?"bg-green-500":u>=.5?"bg-lime-500":u>=.3?"bg-amber-500":"bg-red-400"} ${l===e.getHours()?"ring-2 ring-blue-500":""}`,style:{height:`${u*100}%`},title:`${o(l)}: ${Math.round(u*100)}%`},l))}),_.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400 mt-1",children:[_.jsx("span",{children:"00:00"}),_.jsx("span",{children:"06:00"}),_.jsx("span",{children:"12:00"}),_.jsx("span",{children:"18:00"}),_.jsx("span",{children:"24:00"})]})]}),_.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Gebaseerd op maanfase en -positie"})]})})}function LH(){const{current:n,loading:e,fetchWeather:t,getFishingCondition:i,getFishingScore:r,pressureHistory:s,getPressureTrend:o}=Od(),l=wi(j=>j.position),u=mt(j=>j.showWeatherWidget),[h,f]=q.useState(!1),[p,y]=q.useState(!1),x={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};if(q.useEffect(()=>{const j=l||kA;t(j.lat,j.lng)},[]),q.useEffect(()=>{l&&t(l.lat,l.lng)},[l,t]),q.useEffect(()=>{const j=l||kA,D=setInterval(()=>{t(j.lat,j.lng)},600*1e3);return()=>clearInterval(D)},[l,t]),!u||!n&&!e)return null;const S=i(),I=r?r():S==="excellent"?3:S==="good"?2:S==="moderate"?1:0,T=Ex(new Date),A=Lw(new Date),P=Math.min(3,I/2+T.overall*1.5),N=j=>j>=2.5?"text-green-500":j>=1.5?"text-lime-500":j>=.8?"text-amber-500":"text-red-500",R=j=>j>=2.5?"bg-green-50 border-green-200":j>=1.5?"bg-lime-50 border-lime-200":j>=.8?"bg-amber-50 border-amber-200":"bg-red-50 border-red-200",L=j=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(j/45)%8];return _.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:`fixed left-2 z-[700] bg-white/95 backdrop-blur-sm rounded-xl shadow-sm p-3 min-w-[140px] border ${R(P)}`,style:x,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e?_.jsx("div",{className:"text-sm text-gray-500",children:"Laden..."}):n?_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex items-center justify-between pb-2 border-b border-gray-100",children:[_.jsx(kH,{value:P,color:N(P)}),_.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-1 p-1 hover:bg-white/50 rounded transition-colors border-0 outline-none bg-transparent",title:"Solunar info",children:[_.jsx(ON,{phase:A,size:16}),_.jsx(CN,{size:12,className:"text-gray-400"})]})]}),_.jsx(DH,{activity:T.overall,label:"Activiteit"}),_.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[_.jsx(DN,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.temperature),"C"]})]}),_.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[_.jsx(Mw,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",L(n.windDirection)]})]}),_.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 text-sm text-gray-500 hover:text-blue-500 transition-colors w-full border-0 outline-none bg-transparent p-0",children:[_.jsx(IN,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.pressure)," hPa"]}),(()=>{const j=o();return j==="rising"?_.jsx(eH,{size:14,className:"text-green-500 ml-auto"}):j==="falling"?_.jsx(QK,{size:14,className:"text-red-500 ml-auto"}):_.jsx(xK,{size:14,className:"text-gray-400 ml-auto"})})()]})]}):null}),_.jsx(Ii,{children:h&&s.length>0&&_.jsx(NH,{data:s,onClose:()=>f(!1)})}),_.jsx(Ii,{children:p&&_.jsx(MH,{onClose:()=>y(!1)})})]})}function OH(){const n=Od(o=>o.current);if(!mt(o=>o.showWindIndicator)||!n)return null;const t=Math.round(n.windSpeed),i=n.windDirection,r=()=>t<12?"#22c55e":t<20?"#84cc16":t<30?"#eab308":t<40?"#f97316":"#ef4444",s=()=>t<5?"Stil":t<12?"Zwak":t<20?"Matig":t<30?"Vrij krachtig":t<40?"Krachtig":"Hard";return _.jsxs(ze.div,{className:"fixed bottom-4 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},children:[_.jsxs("div",{className:"relative w-16 h-16",children:[_.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-gray-200"}),_.jsx("span",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-0.5 text-[8px] font-bold text-gray-400",children:"N"}),_.jsx("span",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-0.5 text-[8px] font-bold text-gray-400",children:"Z"}),_.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-0.5 text-[8px] font-bold text-gray-400",children:"W"}),_.jsx("span",{className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-0.5 text-[8px] font-bold text-gray-400",children:"O"}),_.jsx(ze.div,{className:"absolute inset-2 flex items-center justify-center",style:{transform:`rotate(${i}deg)`},animate:{rotate:i},transition:{type:"spring",stiffness:100},children:_.jsx("svg",{viewBox:"0 0 24 24",className:"w-full h-full",style:{color:r()},children:_.jsx("path",{d:"M12 2l-6 10h4v10h4V12h4L12 2z",fill:"currentColor"})})}),_.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:_.jsx("div",{className:"bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-sm",children:_.jsx("span",{className:"text-xs font-bold",style:{color:r()},children:t})})})]}),_.jsx("div",{className:"text-center mt-1",children:_.jsx("span",{className:"text-[10px] text-gray-500",children:s()})})]})}const gd=[{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12},{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664}];function FH(n,e,t){const i=[],r=29.53058867,s=new Date("2000-01-06T18:14:00Z"),o=t.lng/15*60,l=745;for(let u=0;u<e;u++){const h=new Date(n);h.setDate(h.getDate()+u),h.setHours(0,0,0,0);const p=(h.getTime()-s.getTime())/(1e3*60*60*24)%r/r;let y=p*l*2%1440;y=(y+o)%1440;for(let x=0;x<4;x++){const S=x%2===0,I=x*(l/2);let T=y+I;const A=Math.floor(T/1440);T=T%1440;const P=Math.floor(T/60),N=Math.floor(T%60),R=new Date(h);R.setDate(R.getDate()+A),R.setHours(P,N,0,0);const L=Math.abs(Math.sin(p*Math.PI*2)),j=S?1.8:.4,D=L*.5;i.push({time:R,height:S?j+D:j-D*.5,type:S?"high":"low"})}}return i.sort((u,h)=>u.time.getTime()-h.time.getTime())}function VH(n,e){let t=gd[0],i=1/0;for(const r of gd){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}function Tx(n,e){if(e.length<2)return 1;let t=e[0],i=e[1];for(let u=0;u<e.length-1;u++)if(e[u].time<=n&&e[u+1].time>n){t=e[u],i=e[u+1];break}const r=i.time.getTime()-t.time.getTime(),s=n.getTime()-t.time.getTime(),o=Math.max(0,Math.min(1,s/r)),l=(1-Math.cos(o*Math.PI))/2;return t.height+(i.height-t.height)*l}function jH(){const[n,e]=q.useState(!1),[t,i]=q.useState(gd[5]),[r,s]=q.useState(new Date),[o,l]=q.useState(!1),u=wi(R=>R.position),h=mt(R=>R.showTideWidget);q.useEffect(()=>{u&&i(VH(u.lat,u.lng))},[u]);const f=q.useMemo(()=>{const R=new Date;return R.setDate(R.getDate()-2),R.setHours(0,0,0,0),FH(R,5,t)},[t]);if(q.useEffect(()=>{if(!o)return;const R=setInterval(()=>{s(L=>{const j=new Date(L.getTime()+18e5),D=new Date;return D.setDate(D.getDate()+2),D.setHours(23,59,59,999),j>D?(l(!1),D):j})},100);return()=>clearInterval(R)},[o]),!h)return null;const p=new Date,y=Tx(p,f);f.find(R=>R.time>p);const x=new Date;x.setDate(x.getDate()-2),x.setHours(0,0,0,0);const S=new Date;S.setDate(S.getDate()+2),S.setHours(23,59,59,999);const I=S.getTime()-x.getTime(),T=(r.getTime()-x.getTime())/I*100,A=R=>{const L=new Date(x.getTime()+R/100*I);s(L)},P=R=>{const L=new Date,j=Math.floor((R.getTime()-L.setHours(0,0,0,0))/(1440*60*1e3));return j===0?"Vandaag":j===1?"Morgen":j===-1?"Gisteren":j===2?"Overmorgen":j===-2?"Eergisteren":R.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric",month:"short"})},N=R=>R.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return _.jsxs(_.Fragment,{children:[_.jsxs(ze.button,{className:"fixed bottom-28 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none",onClick:()=>e(!0),whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsx(vm,{size:18,className:"text-blue-500"}),_.jsxs("div",{className:"text-left",children:[_.jsx("div",{className:"text-[10px] text-gray-500 truncate max-w-[80px]",children:t.name}),_.jsxs("div",{className:"text-xs font-medium text-blue-600",children:[y.toFixed(1),"m"]})]})]}),_.jsx(Ii,{children:n&&_.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1),children:_.jsxs(ze.div,{className:"bg-white rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:R=>R.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(vm,{size:20,className:"text-white"}),_.jsx("span",{className:"font-semibold text-white",children:"Getijden"})]}),_.jsx("button",{onClick:()=>e(!1),className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:20,className:"text-white"})})]}),_.jsxs("div",{className:"p-4 space-y-4",children:[_.jsx("div",{className:"flex items-center gap-2",children:_.jsx("select",{value:t.id,onChange:R=>{const L=gd.find(j=>j.id===R.target.value);L&&i(L)},className:"flex-1 p-2 border border-gray-200 rounded-lg text-sm bg-white",children:gd.map(R=>_.jsx("option",{value:R.id,children:R.name},R.id))})}),_.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("div",{className:"text-sm text-gray-500",children:P(r)}),_.jsx("div",{className:"text-2xl font-bold text-blue-600",children:N(r)})]}),_.jsxs("div",{className:"text-right",children:[_.jsx("div",{className:"text-sm text-gray-500",children:"Waterstand"}),_.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Tx(r,f).toFixed(2),"m"]})]})]})}),_.jsx(zH,{tides:f,selectedTime:r,minTime:x,maxTime:S,onTimeSelect:R=>s(R)}),_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[_.jsx("span",{children:P(x)}),_.jsx("span",{className:"font-medium text-blue-500",children:"Nu"}),_.jsx("span",{children:P(S)})]}),_.jsx("input",{type:"range",min:"0",max:"100",value:T,onChange:R=>A(parseFloat(R.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #93c5fd 0%, #93c5fd 40%, #3b82f6 40%, #3b82f6 ${T}%, #e5e7eb ${T}%, #e5e7eb 100%)`}})]}),_.jsxs("div",{className:"flex items-center justify-center gap-4",children:[_.jsx("button",{onClick:()=>{const R=new Date(x);s(R)},className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(F$,{size:20})}),_.jsx("button",{onClick:()=>l(!o),className:"p-3 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors border-0 outline-none",children:o?_.jsx(PN,{size:20}):_.jsx(kN,{size:20})}),_.jsx("button",{onClick:()=>s(new Date),className:"px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none bg-transparent font-medium",children:"Nu"}),_.jsx("button",{onClick:()=>{const R=new Date(S);s(R)},className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(CN,{size:20})})]}),_.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[_.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Volgende getijden"}),_.jsx("div",{className:"grid grid-cols-4 gap-2",children:f.filter(R=>R.time>p).slice(0,4).map((R,L)=>_.jsxs("button",{onClick:()=>s(R.time),className:`p-2 rounded-lg text-center transition-colors border-0 outline-none ${R.type==="high"?"bg-green-50 hover:bg-green-100":"bg-red-50 hover:bg-red-100"}`,children:[_.jsx("div",{className:`text-[10px] font-medium ${R.type==="high"?"text-green-600":"text-red-600"}`,children:R.type==="high"?"HW":"LW"}),_.jsx("div",{className:"text-xs font-medium",children:N(R.time)}),_.jsxs("div",{className:"text-[10px] text-gray-500",children:[R.height.toFixed(1),"m"]})]},L))})]}),_.jsx("div",{className:"text-xs text-gray-400 text-center",children:"Bron: berekening gebaseerd op maanstand  Alleen ter indicatie"})]})]})})})]})}function zH({tides:n,selectedTime:e,minTime:t,maxTime:i,onTimeSelect:r}){const l={top:20,right:15,bottom:30,left:40},u=400-l.left-l.right,h=150-l.top-l.bottom,f=i.getTime()-t.getTime(),p=new Date,y=[],x=240;for(let R=0;R<=x;R++){const L=new Date(t.getTime()+R/x*f),j=Tx(L,n),D=l.left+R/x*u,b=l.top+h-(j-.2)/2.3*h;y.push({x:D,y:b,time:L,height:j})}const S=y.map((R,L)=>`${L===0?"M":"L"} ${R.x} ${R.y}`).join(" "),I=l.left+(p.getTime()-t.getTime())/f*u,T=l.left+(e.getTime()-t.getTime())/f*u,A=y.find(R=>Math.abs(R.time.getTime()-e.getTime())<1800*1e3)?.y||l.top,P=[];for(let R=-2;R<=2;R++){const L=new Date;L.setDate(L.getDate()+R),L.setHours(0,0,0,0);const j=l.left+(L.getTime()-t.getTime())/f*u,D=R===0?"Vandaag":R===1?"Morgen":R===-1?"Gisteren":"";P.push({x:j,label:D})}const N=R=>{const L=R.currentTarget.getBoundingClientRect(),D=(R.clientX-L.left-l.left)/u;if(D>=0&&D<=1){const b=new Date(t.getTime()+D*f);r(b)}};return _.jsxs("svg",{width:400,height:150,className:"w-full cursor-crosshair",onClick:N,children:[[.5,1,1.5,2].map(R=>{const L=l.top+h-(R-.2)/2.3*h;return _.jsxs("g",{children:[_.jsx("line",{x1:l.left,y1:L,x2:400-l.right,y2:L,stroke:"#e5e7eb",strokeWidth:"1"}),_.jsxs("text",{x:l.left-5,y:L+4,fontSize:"10",fill:"#9ca3af",textAnchor:"end",children:[R,"m"]})]},R)}),P.map((R,L)=>_.jsxs("g",{children:[_.jsx("line",{x1:R.x,y1:l.top,x2:R.x,y2:150-l.bottom,stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"4,4"}),R.label&&_.jsx("text",{x:R.x+5,y:140,fontSize:"9",fill:"#6b7280",children:R.label})]},L)),_.jsx("path",{d:`${y.filter(R=>R.time<=p).map((R,L)=>`${L===0?"M":"L"} ${R.x} ${R.y}`).join(" ")} L ${I} ${150-l.bottom} L ${l.left} ${150-l.bottom} Z`,fill:"rgba(59, 130, 246, 0.2)"}),_.jsx("path",{d:`M ${I} ${y.find(R=>R.time>=p)?.y||l.top} ${y.filter(R=>R.time>p).map(R=>`L ${R.x} ${R.y}`).join(" ")} L ${400-l.right} ${150-l.bottom} L ${I} ${150-l.bottom} Z`,fill:"rgba(59, 130, 246, 0.08)"}),_.jsx("path",{d:S,fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),n.map((R,L)=>{const j=l.left+(R.time.getTime()-t.getTime())/f*u,D=l.top+h-(R.height-.2)/2.3*h;return j<l.left||j>400-l.right?null:_.jsx("circle",{cx:j,cy:D,r:"4",fill:R.type==="high"?"#22c55e":"#ef4444",stroke:"white",strokeWidth:"2"},L)}),_.jsx("line",{x1:I,y1:l.top,x2:I,y2:150-l.bottom,stroke:"#f59e0b",strokeWidth:"2"}),_.jsx("text",{x:I,y:l.top-5,fontSize:"9",fill:"#f59e0b",textAnchor:"middle",fontWeight:"bold",children:"NU"}),_.jsx("line",{x1:T,y1:l.top,x2:T,y2:150-l.bottom,stroke:"#8b5cf6",strokeWidth:"1",strokeDasharray:"3,3"}),_.jsx("circle",{cx:T,cy:A,r:"6",fill:"#8b5cf6",stroke:"white",strokeWidth:"2"})]})}function NA(n){return n===0?_.jsx(HK,{size:16,className:"text-yellow-500"}):n<=3?_.jsx(fd,{size:16,className:"text-gray-400"}):n<=49?_.jsx(fd,{size:16,className:"text-gray-500"}):n<=69?_.jsx($$,{size:16,className:"text-blue-500"}):n<=79?_.jsx(H$,{size:16,className:"text-cyan-500"}):n<=99?_.jsx(G$,{size:16,className:"text-purple-500"}):_.jsx(fd,{size:16,className:"text-gray-400"})}function UH(n){return n===0?"Helder":n<=3?"Bewolkt":n<=49?"Mist":n<=59?"Motregen":n<=69?"Regen":n<=79?"Sneeuw":n<=99?"Onweer":"Onbekend"}function BH(){const n=Od(A=>A.hourlyForecast),e=Od(A=>A.getWeatherAtTime),t=mt(A=>A.showForecastSlider),[i,r]=q.useState(!1),[s,o]=q.useState(0),[l,u]=q.useState(!1),h=new Date,f=n.findIndex(A=>new Date(A.time)>=h),p=s-24,y=new Date(h.getTime()+p*60*60*1e3),x=e(y);if(q.useEffect(()=>{if(!l)return;const A=setInterval(()=>{o(P=>P>=72?(u(!1),72):P+1)},200);return()=>clearInterval(A)},[l]),!t||n.length===0)return null;const S=A=>A.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"}),I=A=>{const P=new Date,N=new Date(P);N.setDate(N.getDate()+1);const R=new Date(P);return R.setDate(R.getDate()-1),A.toDateString()===P.toDateString()?"Vandaag":A.toDateString()===N.toDateString()?"Morgen":A.toDateString()===R.toDateString()?"Gisteren":A.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},T=A=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(A/45)%8];return _.jsxs(_.Fragment,{children:[_.jsxs(ze.button,{className:"fixed bottom-44 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none",onClick:()=>r(!0),whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsx(xx,{size:18,className:"text-blue-500"}),_.jsx("span",{className:"text-xs text-gray-600",children:"Forecast"})]}),_.jsx(Ii,{children:i&&_.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-end justify-center bg-black/30",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>r(!1),children:_.jsxs(ze.div,{className:"bg-white rounded-t-2xl shadow-xl p-4 w-full max-w-md",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:A=>A.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(xx,{size:18,className:"text-blue-500"}),"Weersvoorspelling"]}),_.jsx("button",{onClick:()=>r(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:18,className:"text-gray-500"})})]}),_.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsxs("div",{children:[_.jsx("div",{className:"text-lg font-bold text-gray-800",children:S(y)}),_.jsx("div",{className:"text-sm text-gray-500",children:I(y)})]}),x&&_.jsxs("div",{className:"flex items-center gap-2",children:[NA(x.weatherCode),_.jsx("span",{className:"text-sm text-gray-600",children:UH(x.weatherCode)})]})]}),x&&_.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-3",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(DN,{size:16,className:"text-orange-500"}),_.jsxs("span",{className:"text-sm font-medium",children:[Math.round(x.temperature),"C"]})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Mw,{size:16,className:"text-blue-500"}),_.jsxs("span",{className:"text-sm font-medium",children:[Math.round(x.windSpeed)," km/u"]})]}),_.jsx("div",{className:"text-right text-sm text-gray-500",children:T(x.windDirection)})]})]}),_.jsxs("div",{className:"mb-4",children:[_.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[_.jsx("span",{children:"-24u"}),_.jsx("span",{className:"font-medium text-blue-500",children:"Nu"}),_.jsx("span",{children:"+48u"})]}),_.jsxs("div",{className:"relative",children:[_.jsx("input",{type:"range",min:"0",max:"72",value:s,onChange:A=>o(parseInt(A.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, #93c5fd 0%, #93c5fd ${24/72*100}%, #3b82f6 ${24/72*100}%, #3b82f6 ${s/72*100}%, #e5e7eb ${s/72*100}%, #e5e7eb 100%)`}}),_.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-1 h-4 bg-blue-600 rounded",style:{left:`${24/72*100}%`}})]})]}),_.jsxs("div",{className:"flex items-center justify-center gap-4",children:[_.jsx("button",{onClick:()=>o(0),className:"px-3 py-1.5 text-xs text-gray-600 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:"Start"}),_.jsx("button",{onClick:()=>u(!l),className:"p-2 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors border-0 outline-none",children:l?_.jsx(PN,{size:16}):_.jsx(kN,{size:16})}),_.jsx("button",{onClick:()=>o(24),className:"px-3 py-1.5 text-xs text-gray-600 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:"Nu"})]}),_.jsx("div",{className:"mt-4 overflow-x-auto",children:_.jsx("div",{className:"flex gap-2 pb-2",children:n.slice(f,f+12).map((A,P)=>{const N=new Date(A.time),R=Math.abs(N.getTime()-y.getTime())<1800*1e3;return _.jsxs("button",{onClick:()=>{const L=(N.getTime()-h.getTime())/36e5;o(24+Math.round(L))},className:`flex flex-col items-center p-2 rounded-lg min-w-[50px] transition-colors border-0 outline-none ${R?"bg-blue-100":"bg-gray-50 hover:bg-gray-100"}`,children:[_.jsxs("span",{className:"text-[10px] text-gray-500",children:[N.getHours().toString().padStart(2,"0"),":00"]}),NA(A.weatherCode),_.jsxs("span",{className:"text-xs font-medium",children:[Math.round(A.temperature),""]})]},P)})})})]})})})]})}const xm=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],GH=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],WH=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],tv=5;function $H({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=q.useRef(null),s=q.useRef(null),o=async u=>{const h=u.target.files;if(!h||h.length===0)return;const f=tv-n.length,p=Array.from(h).slice(0,f);for(const y of p)try{const{thumbnailBase64:x}=await MN(y),S={id:LN(),thumbnailBase64:x,createdAt:new Date().toISOString(),pendingUpload:!0};e(S)}catch(x){console.error("Failed to process image:",x)}u.target.value=""},l=n.length<tv;return _.jsxs("div",{className:"space-y-2",children:[_.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",tv,")"]}),_.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(u=>_.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[_.jsx("img",{src:u.thumbnailUrl||u.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&_.jsx("button",{type:"button",onClick:()=>t(u.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:_.jsx(Ji,{size:12,className:"text-white"})}),u.pendingUpload&&_.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},u.id)),l&&!i&&_.jsxs(_.Fragment,{children:[_.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[_.jsx(Nw,{size:20,className:"text-gray-400"}),_.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),_.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[_.jsx(rK,{size:20,className:"text-gray-400"}),_.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),_.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),_.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}const KH={Snoek:{colors:["green","yellow","spotted"],pattern:"elongated with spots"},Snoekbaars:{colors:["gray","silver","striped"],pattern:"elongated with stripes"},Baars:{colors:["green","black","striped","red-fins"],pattern:"oval with stripes"},Karper:{colors:["brown","gold","orange"],pattern:"large oval"},Brasem:{colors:["silver","bronze"],pattern:"flat oval"},Voorn:{colors:["silver","red-fins"],pattern:"small oval"},Zeelt:{colors:["green","brown","slimy"],pattern:"elongated"},Meerval:{colors:["dark","brown","black"],pattern:"large with whiskers"},Aal:{colors:["dark","silver-belly"],pattern:"snake-like"},Forel:{colors:["spotted","pink","silver"],pattern:"streamlined with spots"}};async function HH(n){return new Promise(e=>{const t=new Image;t.onload=()=>{const i=document.createElement("canvas"),r=i.getContext("2d");if(!r){e([]);return}const s=100;i.width=s,i.height=s;const o=(t.width-s)/2,l=(t.height-s)/2;r.drawImage(t,o,l,s,s,0,0,s,s);const h=r.getImageData(0,0,s,s).data;let f=0,p=0,y=0,x=0,S=0,I=0;const T=h.length/4;for(let R=0;R<h.length;R+=4){const L=h[R],j=h[R+1],D=h[R+2];f+=L,p+=j,j>L&&j>D&&y++,L>100&&j>80&&j<150&&D<100&&x++,L>150&&j>150&&D>150&&S++,L<80&&j<80&&D<80&&I++}const A=[];y/T>.2&&A.push("green"),x/T>.2&&A.push("brown"),S/T>.2&&A.push("silver"),I/T>.3&&A.push("dark");const P=f/T,N=p/T;P>150&&N>100&&N<180&&A.push("gold"),e(A)},t.src=n})}function XH(n){const e=[];for(const[t,i]of Object.entries(KH)){let r=0;for(const s of n)i.colors.some(o=>o.includes(s)||s.includes(o))&&r++;r>0&&e.push({species:t,score:r/i.colors.length})}return e.sort((t,i)=>i.score-t.score)}async function qH(n){try{const e=await HH(n),t=XH(e);if(t.length===0)return{species:"",confidence:0,suggestions:xm.slice(0,5).map(o=>o.name)};const i=t[0],r=t.slice(0,5).map(o=>o.species),s=["Snoek","Baars","Karper","Snoekbaars","Brasem"];for(const o of s)!r.includes(o)&&r.length<5&&r.push(o);return{species:i.score>.3?i.species:"",confidence:i.score,suggestions:r.slice(0,5)}}catch(e){return console.error("Fish recognition error:",e),{species:"",confidence:0,suggestions:xm.slice(0,5).map(t=>t.name)}}}function YH(n){return{Snoek:{avgWeight:3e3,avgLength:70},Snoekbaars:{avgWeight:2500,avgLength:60},Baars:{avgWeight:500,avgLength:30},Karper:{avgWeight:8e3,avgLength:60},Brasem:{avgWeight:2e3,avgLength:45},Voorn:{avgWeight:300,avgLength:25},Zeelt:{avgWeight:1500,avgLength:40},Meerval:{avgWeight:15e3,avgLength:120},Aal:{avgWeight:800,avgLength:60},Forel:{avgWeight:1e3,avgLength:40},Kolblei:{avgWeight:500,avgLength:30},Winde:{avgWeight:1e3,avgLength:40},Kopvoorn:{avgWeight:800,avgLength:35},Ruisvoorn:{avgWeight:400,avgLength:25},Blankvoorn:{avgWeight:300,avgLength:25}}[n]||null}function ZH({onClose:n,initialLocation:e,initialLocationSource:t,initialPhotos:i=[]}){const r=zP(ie=>ie.addCatch),s=Od(ie=>ie.current),o=wi(ie=>ie.position),[l,u]=q.useState(e||(o?{lat:o.lat,lng:o.lng}:null)),[h,f]=q.useState(t||(o?"gps":null)),[p,y]=q.useState(""),[x,S]=q.useState(""),[I,T]=q.useState(""),[A,P]=q.useState(""),[N,R]=q.useState(""),[L,j]=q.useState(""),[D,b]=q.useState(i),[M,V]=q.useState(!1),[z,B]=q.useState([]),[O,le]=q.useState(0),pe=async ie=>{if(b(me=>[...me,ie]),ie.dataUrl&&!p){V(!0);try{const me=await qH(ie.dataUrl);if(B(me.suggestions),le(me.confidence),me.species&&me.confidence>.4){y(me.species);const xe=YH(me.species)}}catch(me){console.error("AI recognition failed:",me)}finally{V(!1)}}},ge=ie=>{y(ie),B([])},ue=ie=>{b(me=>me.filter(xe=>xe.id!==ie))},Q=()=>{o&&(u({lat:o.lat,lng:o.lng}),f("gps"))},se=ie=>{if(ie.preventDefault(),!p||!l){alert("Selecteer een vissoort en zorg dat er een locatie is");return}r({location:l,species:p,weight:x?parseInt(x):void 0,length:I?parseInt(I):void 0,photos:D.length>0?D:void 0,method:A||"Anders",bait:N||void 0,notes:L||void 0,weather:s?{temp:s.temperature,windSpeed:s.windSpeed,windDirection:s.windDirection,pressure:s.pressure}:void 0}),n()},W=(()=>{switch(h){case"gps":return{icon:bN,label:"GPS",color:"text-blue-500"};case"photo":return{icon:Nw,label:"Foto EXIF",color:"text-green-500"};case"map":return{icon:vy,label:"Kaart",color:"text-orange-500"};default:return{icon:bl,label:"Locatie",color:"text-gray-500"}}})(),$=W.icon;return _.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(ze.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:ie=>ie.stopPropagation(),children:[_.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Ys,{className:"text-white",size:24}),_.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),_.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:_.jsx(Ji,{size:20})})]}),_.jsxs("form",{onSubmit:se,className:"p-4 space-y-4",children:[_.jsx("div",{className:"space-y-2",children:l?_.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-gray-50 p-2 rounded-lg",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx($,{size:16,className:W.color}),_.jsxs("span",{className:"text-gray-600",children:[l.lat.toFixed(5),", ",l.lng.toFixed(5)]})]}),_.jsx("span",{className:`text-xs ${W.color} font-medium`,children:W.label})]}):_.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-red-50 p-2 rounded-lg text-red-600",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(bl,{size:16}),_.jsx("span",{children:"Geen locatie"})]}),o&&_.jsx("button",{type:"button",onClick:Q,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded-md border-0 outline-none",children:"Gebruik GPS"})]})}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:["Vissoort *",M&&_.jsxs("span",{className:"flex items-center gap-1 text-xs text-blue-500",children:[_.jsx(lK,{size:12,className:"animate-spin"}),"AI analyseert..."]})]}),_.jsx(Ii,{children:z.length>0&&!p&&_.jsxs(ze.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-2 p-2 bg-blue-50 rounded-lg border border-blue-200",children:[_.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mb-2",children:[_.jsx(WK,{size:12}),_.jsxs("span",{children:["AI suggesties ",O>.3?`(${Math.round(O*100)}% zeker)`:""]})]}),_.jsx("div",{className:"flex flex-wrap gap-1",children:z.map(ie=>_.jsx("button",{type:"button",onClick:()=>ge(ie),className:"px-2 py-1 text-xs bg-white border border-blue-300 text-blue-700 rounded-full hover:bg-blue-100 transition-colors",children:ie},ie))})]})}),_.jsxs("select",{value:p,onChange:ie=>{y(ie.target.value),B([])},className:"form-select",required:!0,children:[_.jsx("option",{value:"",children:"Selecteer vissoort..."}),xm.map(ie=>_.jsx("option",{value:ie.name,children:ie.name},ie.name))]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(FK,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),_.jsx("input",{type:"number",value:x,onChange:ie=>S(ie.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(NK,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),_.jsx("input",{type:"number",value:I,onChange:ie=>T(ie.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),_.jsxs("select",{value:A,onChange:ie=>P(ie.target.value),className:"form-select",children:[_.jsx("option",{value:"",children:"Selecteer methode..."}),GH.map(ie=>_.jsx("option",{value:ie,children:ie},ie))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),_.jsxs("select",{value:N,onChange:ie=>R(ie.target.value),className:"form-select",children:[_.jsx("option",{value:"",children:"Selecteer aas..."}),WH.map(ie=>_.jsx("option",{value:ie,children:ie},ie))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),_.jsx("textarea",{value:L,onChange:ie=>j(ie.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),_.jsx($H,{photos:D,onAddPhoto:pe,onRemovePhoto:ue}),_.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function QH(){const n=ii(h=>h.catchFormOpen),e=ii(h=>h.catchFormLocation),t=ii(h=>h.catchFormLocationSource),i=ii(h=>h.catchFormInitialPhotos),r=ii(h=>h.openCatchForm),s=ii(h=>h.closeCatchForm),o=wi(h=>h.position),l=mt(h=>h.showCatchButton),u=()=>{o?r({location:{lat:o.lat,lng:o.lng},locationSource:"gps"}):r()};return _.jsxs(_.Fragment,{children:[l&&_.jsx(ze.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:u,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:_.jsx(Ys,{size:22,strokeWidth:2})}),_.jsx(Ii,{children:n&&_.jsx(ZH,{onClose:s,initialLocation:e||void 0,initialLocationSource:t||void 0,initialPhotos:i})})]})}function JH(){const n=Js(r=>r.map),e=zP(r=>r.catches),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new R1,t.current=new O1({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=pl([r.location.lng,r.location.lat]),o=new au({geometry:new ml(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new Zi({image:new Dl({radius:14,fill:new Ir({color:"#22c55e"}),stroke:new ku({color:"#fff",width:2})}),text:new sf({text:l,font:"bold 12px sans-serif",fill:new Ir({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function eX(){const n=Js(r=>r.map),e=UP(r=>r.spots),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new R1,t.current=new O1({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=pl([r.location.lng,r.location.lat]),o=new au({geometry:new ml(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new Zi({image:new Dl({radius:12,fill:new Ir({color:l}),stroke:new ku({color:"#fff",width:2})}),text:new sf({text:"",font:"bold 14px sans-serif",fill:new Ir({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function tX({onClose:n,initialLocation:e}){const t=UP(T=>T.addSpot),[i,r]=q.useState(""),[s,o]=q.useState(""),[l,u]=q.useState([]),[h,f]=q.useState(""),[p,y]=q.useState(3),x=e,S=T=>{u(A=>A.includes(T)?A.filter(P=>P!==T):[...A,T])},I=T=>{if(T.preventDefault(),!i||!x){alert("Geef een naam op voor deze locatie");return}t({name:i,location:x,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:p}),n()};return _.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(ze.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:T=>T.stopPropagation(),children:[_.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(wx,{className:"text-white",size:24}),_.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),_.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:_.jsx(Ji,{size:20})})]}),_.jsxs("form",{onSubmit:I,className:"p-4 space-y-4",children:[x&&_.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[_.jsx(bl,{size:16}),_.jsxs("span",{children:[x.lat.toFixed(5),", ",x.lng.toFixed(5)]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),_.jsx("input",{type:"text",value:i,onChange:T=>r(T.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),_.jsx("input",{type:"text",value:s,onChange:T=>o(T.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),_.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(T=>_.jsx("button",{type:"button",onClick:()=>y(T),className:"p-1 border-0 outline-none bg-transparent",children:_.jsx(wx,{size:28,className:T<=p?"text-yellow-400 fill-yellow-400":"text-gray-300"})},T))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),_.jsx("div",{className:"flex flex-wrap gap-2",children:xm.slice(0,12).map(T=>_.jsx("button",{type:"button",onClick:()=>S(T.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(T.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:T.name},T.name))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),_.jsx("textarea",{value:h,onChange:T=>f(T.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),_.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const nX=[{name:"Aanlegsteigers",icon:SN,color:"#2196F3"},{name:"Boothellingen",icon:BK,color:"#4CAF50"},{name:"Dieptekaart",icon:vm,color:"#00BCD4"},{name:"Viswater",icon:bl,color:"#9C27B0"}],MA=[{name:"OpenStreetMap",label:"Kaart"},{name:"Luchtfoto",label:"Satelliet"}];function iX(){const[n,e]=q.useState(!1),t=qo(l=>l.visible),i=qo(l=>l.toggleLayer),r=qo(l=>l.setLayerVisibility),s=l=>{MA.forEach(u=>{r(u.name,u.name===l)}),l==="Luchtfoto"?r("Labels Overlay",!0):r("Labels Overlay",!1)},o=()=>{r("Labels Overlay",!t["Labels Overlay"])};return _.jsxs("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:[_.jsx(ze.button,{className:"w-11 h-11 bg-white/90 hover:bg-white backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:_.jsx(_m,{size:22})}),_.jsx(Ii,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),_.jsxs(ze.div,{className:"absolute bottom-12 right-0 bg-white rounded-xl shadow-lg overflow-hidden min-w-[200px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},children:[_.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Kaartlagen"})}),_.jsxs("div",{className:"p-2",children:[_.jsxs("div",{className:"mb-2 pb-2 border-b border-gray-100",children:[_.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Achtergrond"}),_.jsx("div",{className:"flex gap-1",children:MA.map(l=>_.jsx("button",{className:`flex-1 px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t[l.name]?"bg-blue-500 text-white":"bg-transparent text-gray-600 hover:bg-blue-50"}`,onClick:()=>s(l.name),children:l.label},l.name))}),t.Luchtfoto&&_.jsxs("button",{onClick:o,className:`mt-1.5 w-full flex items-center justify-between px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t["Labels Overlay"]?"bg-blue-50 text-blue-600":"bg-transparent text-gray-500 hover:bg-blue-50"}`,children:[_.jsxs("span",{className:"flex items-center gap-1.5",children:[_.jsx(qK,{size:12}),"Labels overlay"]}),t["Labels Overlay"]&&_.jsx(vx,{size:12})]})]}),_.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Kaartlagen"}),_.jsx("div",{className:"space-y-0.5",children:nX.map(l=>{const u=l.icon,h=t[l.name];return _.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-colors border-0 outline-none ${h?"bg-blue-50":"bg-transparent hover:bg-blue-50"}`,onClick:()=>i(l.name),children:[_.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center transition-colors",style:{backgroundColor:h?l.color:"#e5e7eb"},children:_.jsx(u,{size:14,className:"text-white"})}),_.jsx("span",{className:`text-sm ${h?"text-blue-700":"text-gray-600"}`,children:l.name}),_.jsx("div",{className:"ml-auto",children:_.jsx("div",{className:"w-4 h-4 rounded flex items-center justify-center transition-all",style:{backgroundColor:h?"#3b82f6":"transparent",border:h?"2px solid #3b82f6":"2px solid #93c5fd"},children:h&&_.jsx(vx,{size:10,className:"text-white",strokeWidth:3})})})]},l.name)})})]})]})]})})]})}function rX(){const n=ii(P=>P.settingsPanelOpen),e=ii(P=>P.toggleSettingsPanel),t=mt(P=>P.showCatchButton),i=mt(P=>P.setShowCatchButton),r=mt(P=>P.showCatches),s=mt(P=>P.setShowCatches),o=mt(P=>P.showFavoriteSpots),l=mt(P=>P.setShowFavoriteSpots),u=mt(P=>P.defaultBackground),h=mt(P=>P.setDefaultBackground),f=mt(P=>P.showWeatherWidget),p=mt(P=>P.setShowWeatherWidget),y=mt(P=>P.showWindIndicator),x=mt(P=>P.setShowWindIndicator),S=mt(P=>P.showTideWidget),I=mt(P=>P.setShowTideWidget),T=mt(P=>P.showForecastSlider),A=mt(P=>P.setShowForecastSlider);return n?_.jsx(ze.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:_.jsxs(ze.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:P=>P.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),_.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:_.jsx(Ji,{size:20,className:"text-white"})})]}),_.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),_.jsx(Va,{icon:_.jsx(Ys,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),_.jsx(Va,{icon:_.jsx(Ys,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),_.jsx(Va,{icon:_.jsx(bl,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:_.jsx(vy,{size:18,className:"text-gray-500"})}),_.jsxs("div",{className:"flex-1",children:[_.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),_.jsxs("select",{value:u,onChange:P=>h(P.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-400",children:[_.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),_.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weer & Water"}),_.jsx(Va,{icon:_.jsx(fd,{size:18,className:"text-blue-400"}),label:"Weer widget",description:"Temperatuur, wind, luchtdruk en solunar",checked:f,onChange:p}),_.jsx(Va,{icon:_.jsx(Mw,{size:18,className:"text-cyan-500"}),label:"Wind kompas",description:"Windrichting en snelheid indicator",checked:y,onChange:x}),_.jsx(Va,{icon:_.jsx(vm,{size:18,className:"text-blue-500"}),label:"Getijden",description:"Hoog- en laagwater tijden",checked:S,onChange:I}),_.jsx(Va,{icon:_.jsx(xx,{size:18,className:"text-purple-500"}),label:"Weersvoorspelling",description:"Tijdslider met 72 uur forecast",checked:T,onChange:A})]})]}),_.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function Va({icon:n,label:e,description:t,checked:i,onChange:r}){return _.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),_.jsxs("div",{className:"flex-1",children:[_.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),_.jsx("p",{className:"text-xs text-gray-400",children:t})]}),_.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-blue-500":"bg-gray-300"}`,children:_.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function sX({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=EN(),[l,u]=q.useState(""),[h,f]=q.useState(!1),[p,y]=q.useState(!1),[x,S]=q.useState(null);if(q.useEffect(()=>{o()},[o]),s)return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center",children:_.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return _.jsx(_.Fragment,{children:n});const I=A=>{A.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},T=async()=>{try{S(null),await i()}catch{S("Google login mislukt"),setTimeout(()=>S(null),3e3)}};return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center p-4",children:_.jsxs(ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[_.jsxs("div",{className:"flex flex-col items-center mb-6",children:[_.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:_.jsx(Ys,{size:40,className:"text-white"})}),_.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),_.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),_.jsxs(ze.button,{onClick:T,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[_.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),_.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),_.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),_.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),x&&_.jsx(ze.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:x}),_.jsxs("div",{className:"flex items-center gap-3 my-4",children:[_.jsx("div",{className:"flex-1 h-px bg-gray-200"}),_.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),_.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),_.jsxs("form",{onSubmit:I,className:"space-y-4",children:[_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:_.jsx(dK,{size:20})}),_.jsx("input",{type:p?"text":"password",value:l,onChange:A=>u(A.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-blue-400"}`}),_.jsx("button",{type:"button",onClick:()=>y(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p?_.jsx(Z$,{size:20}):_.jsx(J$,{size:20})})]}),h&&_.jsx(ze.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),_.jsx(ze.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),_.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function oX(){const n=ii(i=>i.spotFormOpen),e=ii(i=>i.spotFormLocation),t=ii(i=>i.closeSpotForm);return _.jsx(sX,{children:_.jsxs("div",{className:"h-screen w-screen overflow-hidden",children:[_.jsx(S$,{}),_.jsx(pH,{}),_.jsx(JH,{}),_.jsx(eX,{}),_.jsx(hH,{}),_.jsx(LH,{}),_.jsx(OH,{}),_.jsx(jH,{}),_.jsx(BH,{}),_.jsx(mH,{}),_.jsx(_H,{}),_.jsx(bH,{}),_.jsx(IH,{}),_.jsx(iX,{}),_.jsx(QH,{}),_.jsx(fH,{}),_.jsx(vH,{}),_.jsx(rX,{}),_.jsx(Ii,{children:n&&_.jsx(tX,{onClose:t,initialLocation:e||void 0})})]})})}const aX="1.2.6";console.log(`%c VisApp v${aX}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");QM.createRoot(document.getElementById("root")).render(_.jsx(oX,{}));export{xX as $,Lb as A,At as B,Dl as C,nt as D,Ge as E,Ir as F,Rj as G,Pm as H,M5 as I,gl as J,Db as K,Mb as L,gX as M,Lp as N,Mj as O,mX as P,Ob as Q,Xc as R,Zi as S,k6 as T,ml as U,R1 as V,fb as W,hX as X,dX as Y,pX as Z,wX as _,O1 as a,kI as a0,S4 as a1,I4 as a2,vX as a3,_X as a4,bd as a5,yX as a6,fX as a7,gr as a8,au as a9,tt as aa,op as ab,Mp as ac,Qb as ad,Pv as ae,ou as af,Aj as ag,ku as b,Bn as c,TX as d,Qi as e,ai as f,dt as g,pC as h,a1 as i,u6 as j,b0 as k,m1 as l,al as m,o1 as n,db as o,kb as p,Nb as q,uX as r,Dj as s,Fm as t,NI as u,Kc as v,DI as w,Nj as x,v1 as y,_1 as z};
//# sourceMappingURL=index-DCz7fHmq.js.map
