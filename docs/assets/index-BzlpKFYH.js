const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-C7VWr_jB.js","assets/GeoJSON-wFDfGWvN.js","assets/boothellingenOL-BZ5vrPC_.js","assets/viswaterOL-I8lsoYHS.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Ex(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var B_={exports:{}},Th={},G_={exports:{}},$e={};var UT;function zM(){if(UT)return $e;UT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function y(W){return W===null||typeof W!="object"?null:(W=p&&W[p]||W["@@iterator"],typeof W=="function"?W:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,I={};function T(W,$,ie){this.props=W,this.context=$,this.refs=I,this.updater=ie||x}T.prototype.isReactComponent={},T.prototype.setState=function(W,$){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,$,"setState")},T.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function R(){}R.prototype=T.prototype;function k(W,$,ie){this.props=W,this.context=$,this.refs=I,this.updater=ie||x}var N=k.prototype=new R;N.constructor=k,S(N,T.prototype),N.isPureReactComponent=!0;var M=Array.isArray,F=Object.prototype.hasOwnProperty,U={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function A(W,$,ie){var me,xe={},ke=null,Me=null;if($!=null)for(me in $.ref!==void 0&&(Me=$.ref),$.key!==void 0&&(ke=""+$.key),$)F.call($,me)&&!P.hasOwnProperty(me)&&(xe[me]=$[me]);var Ve=arguments.length-2;if(Ve===1)xe.children=ie;else if(1<Ve){for(var We=Array(Ve),lt=0;lt<Ve;lt++)We[lt]=arguments[lt+2];xe.children=We}if(W&&W.defaultProps)for(me in Ve=W.defaultProps,Ve)xe[me]===void 0&&(xe[me]=Ve[me]);return{$$typeof:n,type:W,key:ke,ref:Me,props:xe,_owner:U.current}}function D(W,$){return{$$typeof:n,type:W.type,key:$,ref:W.ref,props:W.props,_owner:W._owner}}function V(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function j(W){var $={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(ie){return $[ie]})}var B=/\/+/g;function L(W,$){return typeof W=="object"&&W!==null&&W.key!=null?j(""+W.key):$.toString(36)}function le(W,$,ie,me,xe){var ke=typeof W;(ke==="undefined"||ke==="boolean")&&(W=null);var Me=!1;if(W===null)Me=!0;else switch(ke){case"string":case"number":Me=!0;break;case"object":switch(W.$$typeof){case n:case e:Me=!0}}if(Me)return Me=W,xe=xe(Me),W=me===""?"."+L(Me,0):me,M(xe)?(ie="",W!=null&&(ie=W.replace(B,"$&/")+"/"),le(xe,$,ie,"",function(lt){return lt})):xe!=null&&(V(xe)&&(xe=D(xe,ie+(!xe.key||Me&&Me.key===xe.key?"":(""+xe.key).replace(B,"$&/")+"/")+W)),$.push(xe)),1;if(Me=0,me=me===""?".":me+":",M(W))for(var Ve=0;Ve<W.length;Ve++){ke=W[Ve];var We=me+L(ke,Ve);Me+=le(ke,$,ie,We,xe)}else if(We=y(W),typeof We=="function")for(W=We.call(W),Ve=0;!(ke=W.next()).done;)ke=ke.value,We=me+L(ke,Ve++),Me+=le(ke,$,ie,We,xe);else if(ke==="object")throw $=String(W),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Me}function pe(W,$,ie){if(W==null)return W;var me=[],xe=0;return le(W,me,"","",function(ke){return $.call(ie,ke,xe++)}),me}function ge(W){if(W._status===-1){var $=W._result;$=$(),$.then(function(ie){(W._status===0||W._status===-1)&&(W._status=1,W._result=ie)},function(ie){(W._status===0||W._status===-1)&&(W._status=2,W._result=ie)}),W._status===-1&&(W._status=0,W._result=$)}if(W._status===1)return W._result.default;throw W._result}var ue={current:null},Q={transition:null},se={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:Q,ReactCurrentOwner:U};function ne(){throw Error("act(...) is not supported in production builds of React.")}return $e.Children={map:pe,forEach:function(W,$,ie){pe(W,function(){$.apply(this,arguments)},ie)},count:function(W){var $=0;return pe(W,function(){$++}),$},toArray:function(W){return pe(W,function($){return $})||[]},only:function(W){if(!V(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},$e.Component=T,$e.Fragment=t,$e.Profiler=r,$e.PureComponent=k,$e.StrictMode=i,$e.Suspense=u,$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=se,$e.act=ne,$e.cloneElement=function(W,$,ie){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var me=S({},W.props),xe=W.key,ke=W.ref,Me=W._owner;if($!=null){if($.ref!==void 0&&(ke=$.ref,Me=U.current),$.key!==void 0&&(xe=""+$.key),W.type&&W.type.defaultProps)var Ve=W.type.defaultProps;for(We in $)F.call($,We)&&!P.hasOwnProperty(We)&&(me[We]=$[We]===void 0&&Ve!==void 0?Ve[We]:$[We])}var We=arguments.length-2;if(We===1)me.children=ie;else if(1<We){Ve=Array(We);for(var lt=0;lt<We;lt++)Ve[lt]=arguments[lt+2];me.children=Ve}return{$$typeof:n,type:W.type,key:xe,ref:ke,props:me,_owner:Me}},$e.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:s,_context:W},W.Consumer=W},$e.createElement=A,$e.createFactory=function(W){var $=A.bind(null,W);return $.type=W,$},$e.createRef=function(){return{current:null}},$e.forwardRef=function(W){return{$$typeof:l,render:W}},$e.isValidElement=V,$e.lazy=function(W){return{$$typeof:f,_payload:{_status:-1,_result:W},_init:ge}},$e.memo=function(W,$){return{$$typeof:h,type:W,compare:$===void 0?null:$}},$e.startTransition=function(W){var $=Q.transition;Q.transition={};try{W()}finally{Q.transition=$}},$e.unstable_act=ne,$e.useCallback=function(W,$){return ue.current.useCallback(W,$)},$e.useContext=function(W){return ue.current.useContext(W)},$e.useDebugValue=function(){},$e.useDeferredValue=function(W){return ue.current.useDeferredValue(W)},$e.useEffect=function(W,$){return ue.current.useEffect(W,$)},$e.useId=function(){return ue.current.useId()},$e.useImperativeHandle=function(W,$,ie){return ue.current.useImperativeHandle(W,$,ie)},$e.useInsertionEffect=function(W,$){return ue.current.useInsertionEffect(W,$)},$e.useLayoutEffect=function(W,$){return ue.current.useLayoutEffect(W,$)},$e.useMemo=function(W,$){return ue.current.useMemo(W,$)},$e.useReducer=function(W,$,ie){return ue.current.useReducer(W,$,ie)},$e.useRef=function(W){return ue.current.useRef(W)},$e.useState=function(W){return ue.current.useState(W)},$e.useSyncExternalStore=function(W,$,ie){return ue.current.useSyncExternalStore(W,$,ie)},$e.useTransition=function(){return ue.current.useTransition()},$e.version="18.3.1",$e}var BT;function Hd(){return BT||(BT=1,G_.exports=zM()),G_.exports}var GT;function UM(){if(GT)return Th;GT=1;var n=Hd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var f,p={},y=null,x=null;h!==void 0&&(y=""+h),u.key!==void 0&&(y=""+u.key),u.ref!==void 0&&(x=u.ref);for(f in u)i.call(u,f)&&!s.hasOwnProperty(f)&&(p[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)p[f]===void 0&&(p[f]=u[f]);return{$$typeof:e,type:l,key:y,ref:x,props:p,_owner:r.current}}return Th.Fragment=t,Th.jsx=o,Th.jsxs=o,Th}var WT;function BM(){return WT||(WT=1,B_.exports=UM()),B_.exports}var _=BM(),Rg={},W_={exports:{}},Qn={},$_={exports:{}},K_={};var $T;function GM(){return $T||($T=1,(function(n){function e(Q,se){var ne=Q.length;Q.push(se);e:for(;0<ne;){var W=ne-1>>>1,$=Q[W];if(0<r($,se))Q[W]=se,Q[ne]=$,ne=W;else break e}}function t(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var se=Q[0],ne=Q.pop();if(ne!==se){Q[0]=ne;e:for(var W=0,$=Q.length,ie=$>>>1;W<ie;){var me=2*(W+1)-1,xe=Q[me],ke=me+1,Me=Q[ke];if(0>r(xe,ne))ke<$&&0>r(Me,xe)?(Q[W]=Me,Q[ke]=ne,W=ke):(Q[W]=xe,Q[me]=ne,W=me);else if(ke<$&&0>r(Me,ne))Q[W]=Me,Q[ke]=ne,W=ke;else break e}}return se}function r(Q,se){var ne=Q.sortIndex-se.sortIndex;return ne!==0?ne:Q.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,p=null,y=3,x=!1,S=!1,I=!1,T=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Q){for(var se=t(h);se!==null;){if(se.callback===null)i(h);else if(se.startTime<=Q)i(h),se.sortIndex=se.expirationTime,e(u,se);else break;se=t(h)}}function M(Q){if(I=!1,N(Q),!S)if(t(u)!==null)S=!0,ge(F);else{var se=t(h);se!==null&&ue(M,se.startTime-Q)}}function F(Q,se){S=!1,I&&(I=!1,R(A),A=-1),x=!0;var ne=y;try{for(N(se),p=t(u);p!==null&&(!(p.expirationTime>se)||Q&&!j());){var W=p.callback;if(typeof W=="function"){p.callback=null,y=p.priorityLevel;var $=W(p.expirationTime<=se);se=n.unstable_now(),typeof $=="function"?p.callback=$:p===t(u)&&i(u),N(se)}else i(u);p=t(u)}if(p!==null)var ie=!0;else{var me=t(h);me!==null&&ue(M,me.startTime-se),ie=!1}return ie}finally{p=null,y=ne,x=!1}}var U=!1,P=null,A=-1,D=5,V=-1;function j(){return!(n.unstable_now()-V<D)}function B(){if(P!==null){var Q=n.unstable_now();V=Q;var se=!0;try{se=P(!0,Q)}finally{se?L():(U=!1,P=null)}}else U=!1}var L;if(typeof k=="function")L=function(){k(B)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,pe=le.port2;le.port1.onmessage=B,L=function(){pe.postMessage(null)}}else L=function(){T(B,0)};function ge(Q){P=Q,U||(U=!0,L())}function ue(Q,se){A=T(function(){Q(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_continueExecution=function(){S||x||(S=!0,ge(F))},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(Q){switch(y){case 1:case 2:case 3:var se=3;break;default:se=y}var ne=y;y=se;try{return Q()}finally{y=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Q,se){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ne=y;y=Q;try{return se()}finally{y=ne}},n.unstable_scheduleCallback=function(Q,se,ne){var W=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?W+ne:W):ne=W,Q){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,Q={id:f++,callback:se,priorityLevel:Q,startTime:ne,expirationTime:$,sortIndex:-1},ne>W?(Q.sortIndex=ne,e(h,Q),t(u)===null&&Q===t(h)&&(I?(R(A),A=-1):I=!0,ue(M,ne-W))):(Q.sortIndex=$,e(u,Q),S||x||(S=!0,ge(F))),Q},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(Q){var se=y;return function(){var ne=y;y=se;try{return Q.apply(this,arguments)}finally{y=ne}}}})(K_)),K_}var KT;function WM(){return KT||(KT=1,$_.exports=GM()),$_.exports}var HT;function $M(){if(HT)return Qn;HT=1;var n=Hd(),e=WM();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)i.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function y(a){return u.call(p,a)?!0:u.call(f,a)?!1:h.test(a)?p[a]=!0:(f[a]=!0,!1)}function x(a,c,d,m){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return m?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function S(a,c,d,m){if(c===null||typeof c>"u"||x(a,c,d,m))return!0;if(m)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function I(a,c,d,m,v,w,b){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=w,this.removeEmptyString=b}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){T[a]=new I(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];T[c]=new I(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){T[a]=new I(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){T[a]=new I(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){T[a]=new I(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){T[a]=new I(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){T[a]=new I(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){T[a]=new I(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){T[a]=new I(a,5,!1,a.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function k(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(R,k);T[c]=new I(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(R,k);T[c]=new I(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(R,k);T[c]=new I(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){T[a]=new I(a,1,!1,a.toLowerCase(),null,!1,!1)}),T.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){T[a]=new I(a,1,!1,a.toLowerCase(),null,!0,!0)});function N(a,c,d,m){var v=T.hasOwnProperty(c)?T[c]:null;(v!==null?v.type!==0:m||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(S(c,d,v,m)&&(d=null),m||v===null?y(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):v.mustUseProperty?a[v.propertyName]=d===null?v.type===3?!1:"":d:(c=v.attributeName,m=v.attributeNamespace,d===null?a.removeAttribute(c):(v=v.type,d=v===3||v===4&&d===!0?"":""+d,m?a.setAttributeNS(m,c,d):a.setAttribute(c,d))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),U=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),j=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),Q=Symbol.iterator;function se(a){return a===null||typeof a!="object"?null:(a=Q&&a[Q]||a["@@iterator"],typeof a=="function"?a:null)}var ne=Object.assign,W;function $(a){if(W===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);W=c&&c[1]||""}return`
`+W+a}var ie=!1;function me(a,c){if(!a||ie)return"";ie=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(J){var m=J}Reflect.construct(a,[],c)}else{try{c.call()}catch(J){m=J}a.call(c.prototype)}else{try{throw Error()}catch(J){m=J}a()}}catch(J){if(J&&m&&typeof J.stack=="string"){for(var v=J.stack.split(`
`),w=m.stack.split(`
`),b=v.length-1,z=w.length-1;1<=b&&0<=z&&v[b]!==w[z];)z--;for(;1<=b&&0<=z;b--,z--)if(v[b]!==w[z]){if(b!==1||z!==1)do if(b--,z--,0>z||v[b]!==w[z]){var G=`
`+v[b].replace(" at new "," at ");return a.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",a.displayName)),G}while(1<=b&&0<=z);break}}}finally{ie=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?$(a):""}function xe(a){switch(a.tag){case 5:return $(a.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return a=me(a.type,!1),a;case 11:return a=me(a.type.render,!1),a;case 1:return a=me(a.type,!0),a;default:return""}}function ke(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case P:return"Fragment";case U:return"Portal";case D:return"Profiler";case A:return"StrictMode";case L:return"Suspense";case le:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case j:return(a.displayName||"Context")+".Consumer";case V:return(a._context.displayName||"Context")+".Provider";case B:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case pe:return c=a.displayName||null,c!==null?c:ke(a.type)||"Memo";case ge:c=a._payload,a=a._init;try{return ke(a(c))}catch{}}return null}function Me(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ke(c);case 8:return c===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Ve(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function We(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function lt(a){var c=We(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),m=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,w=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return v.call(this)},set:function(b){m=""+b,w.call(this,b)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(b){m=""+b},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function er(a){a._valueTracker||(a._valueTracker=lt(a))}function fs(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),m="";return a&&(m=We(a)?a.checked?"true":"false":a.value),a=m,a!==d?(c.setValue(a),!0):!1}function Wn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function $n(a,c){var d=c.checked;return ne({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function hn(a,c){var d=c.defaultValue==null?"":c.defaultValue,m=c.checked!=null?c.checked:c.defaultChecked;d=Ve(c.value!=null?c.value:d),a._wrapperState={initialChecked:m,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function dn(a,c){c=c.checked,c!=null&&N(a,"checked",c,!1)}function Kn(a,c){dn(a,c);var d=Ve(c.value),m=c.type;if(d!=null)m==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(m==="submit"||m==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?yt(a,c.type,d):c.hasOwnProperty("defaultValue")&&yt(a,c.type,Ve(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function bi(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var m=c.type;if(!(m!=="submit"&&m!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function yt(a,c,d){(c!=="number"||Wn(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ct=Array.isArray;function nn(a,c,d,m){if(a=a.options,c){c={};for(var v=0;v<d.length;v++)c["$"+d[v]]=!0;for(d=0;d<a.length;d++)v=c.hasOwnProperty("$"+a[d].value),a[d].selected!==v&&(a[d].selected=v),v&&m&&(a[d].defaultSelected=!0)}else{for(d=""+Ve(d),c=null,v=0;v<a.length;v++){if(a[v].value===d){a[v].selected=!0,m&&(a[v].defaultSelected=!0);return}c!==null||a[v].disabled||(c=a[v])}c!==null&&(c.selected=!0)}}function Pi(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function St(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(t(92));if(ct(d)){if(1<d.length)throw Error(t(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:Ve(d)}}function to(a,c){var d=Ve(c.value),m=Ve(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),m!=null&&(a.defaultValue=""+m)}function ki(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function Rr(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tr(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?Rr(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Ar,ca=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,m,v){MSApp.execUnsafeLocalFunction(function(){return a(c,d,m,v)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(Ar=Ar||document.createElement("div"),Ar.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Ar.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function br(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var Ni={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ol=["Webkit","ms","Moz","O"];Object.keys(Ni).forEach(function(a){Ol.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Ni[c]=Ni[a]})});function Pr(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||Ni.hasOwnProperty(a)&&Ni[a]?(""+c).trim():c+"px"}function gs(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var m=d.indexOf("--")===0,v=Pr(d,c[d],m);d==="float"&&(d="cssFloat"),m?a.setProperty(d,v):a[d]=v}}var no=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function On(a,c){if(c){if(no[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function ps(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kr=null;function Nr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Fn=null,Vn=null,ft=null;function io(a){if(a=lh(a)){if(typeof Fn!="function")throw Error(t(280));var c=a.stateNode;c&&(c=Bf(c),Fn(a.stateNode,a.type,c))}}function nr(a){Vn?ft?ft.push(a):ft=[a]:Vn=a}function Ot(){if(Vn){var a=Vn,c=ft;if(ft=Vn=null,io(a),c)for(a=0;a<c.length;a++)io(c[a])}}function Di(a,c){return a(c)}function fn(){}var Ft=!1;function gn(a,c,d){if(Ft)return a(c,d);Ft=!0;try{return Di(a,c,d)}finally{Ft=!1,(Vn!==null||ft!==null)&&(fn(),Ot())}}function pn(a,c){var d=a.stateNode;if(d===null)return null;var m=Bf(d);if(m===null)return null;d=m[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,c,typeof d));return d}var rn=!1;if(l)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){rn=!0}}),window.addEventListener("test",rt,rt),window.removeEventListener("test",rt,rt)}catch{rn=!1}function Gt(a,c,d,m,v,w,b,z,G){var J=Array.prototype.slice.call(arguments,3);try{c.apply(d,J)}catch(oe){this.onError(oe)}}var qt=!1,Mi=null,Fl=!1,Li=null,xf={onError:function(a){qt=!0,Mi=a}};function wf(a,c,d,m,v,w,b,z,G){qt=!1,Mi=null,Gt.apply(xf,arguments)}function Ou(a,c,d,m,v,w,b,z,G){if(wf.apply(this,arguments),qt){if(qt){var J=Mi;qt=!1,Mi=null}else throw Error(t(198));Fl||(Fl=!0,Li=J)}}function ir(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function Fu(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function Ef(a){if(ir(a)!==a)throw Error(t(188))}function Tf(a){var c=a.alternate;if(!c){if(c=ir(a),c===null)throw Error(t(188));return c!==a?null:a}for(var d=a,m=c;;){var v=d.return;if(v===null)break;var w=v.alternate;if(w===null){if(m=v.return,m!==null){d=m;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===d)return Ef(v),a;if(w===m)return Ef(v),c;w=w.sibling}throw Error(t(188))}if(d.return!==m.return)d=v,m=w;else{for(var b=!1,z=v.child;z;){if(z===d){b=!0,d=v,m=w;break}if(z===m){b=!0,m=v,d=w;break}z=z.sibling}if(!b){for(z=w.child;z;){if(z===d){b=!0,d=w,m=v;break}if(z===m){b=!0,m=w,d=v;break}z=z.sibling}if(!b)throw Error(t(189))}}if(d.alternate!==m)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:c}function Sf(a){return a=Tf(a),a!==null?ua(a):null}function ua(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=ua(a);if(c!==null)return c;a=a.sibling}return null}var Vu=e.unstable_scheduleCallback,Vl=e.unstable_cancelCallback,ha=e.unstable_shouldYield,ms=e.unstable_requestPaint,vt=e.unstable_now,vy=e.unstable_getCurrentPriorityLevel,jl=e.unstable_ImmediatePriority,ju=e.unstable_UserBlockingPriority,da=e.unstable_NormalPriority,zu=e.unstable_LowPriority,zl=e.unstable_IdlePriority,fa=null,ui=null;function If(a){if(ui&&typeof ui.onCommitFiberRoot=="function")try{ui.onCommitFiberRoot(fa,a,void 0,(a.current.flags&128)===128)}catch{}}var hi=Math.clz32?Math.clz32:ga,Dr=Math.log,Oi=Math.LN2;function ga(a){return a>>>=0,a===0?32:31-(Dr(a)/Oi|0)|0}var Mr=64,ro=4194304;function st(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ys(a,c){var d=a.pendingLanes;if(d===0)return 0;var m=0,v=a.suspendedLanes,w=a.pingedLanes,b=d&268435455;if(b!==0){var z=b&~v;z!==0?m=st(z):(w&=b,w!==0&&(m=st(w)))}else b=d&~v,b!==0?m=st(b):w!==0&&(m=st(w));if(m===0)return 0;if(c!==0&&c!==m&&(c&v)===0&&(v=m&-m,w=c&-c,v>=w||v===16&&(w&4194240)!==0))return c;if((m&4)!==0&&(m|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=m;0<c;)d=31-hi(c),v=1<<d,m|=a[d],c&=~v;return m}function pa(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ma(a,c){for(var d=a.suspendedLanes,m=a.pingedLanes,v=a.expirationTimes,w=a.pendingLanes;0<w;){var b=31-hi(w),z=1<<b,G=v[b];G===-1?((z&d)===0||(z&m)!==0)&&(v[b]=pa(z,c)):G<=c&&(a.expiredLanes|=z),w&=~z}}function Uu(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Bu(){var a=Mr;return Mr<<=1,(Mr&4194240)===0&&(Mr=64),a}function Gu(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function ya(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-hi(c),a[c]=d}function xy(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var m=a.eventTimes;for(a=a.expirationTimes;0<d;){var v=31-hi(d),w=1<<v;c[v]=0,m[v]=-1,a[v]=-1,d&=~w}}function Wu(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var m=31-hi(d),v=1<<m;v&c|a[m]&c&&(a[m]|=c),d&=~v}}var Xe=0;function Lr(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var $u,Ul,Ku,Hu,Xu,Or=!1,Bl=[],Fr=null,Vr=null,mn=null,_a=new Map,_s=new Map,di=[],Cf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function so(a,c){switch(a){case"focusin":case"focusout":Fr=null;break;case"dragenter":case"dragleave":Vr=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":_a.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":_s.delete(c.pointerId)}}function rr(a,c,d,m,v,w){return a===null||a.nativeEvent!==w?(a={blockedOn:c,domEventName:d,eventSystemFlags:m,nativeEvent:w,targetContainers:[v]},c!==null&&(c=lh(c),c!==null&&Ul(c)),a):(a.eventSystemFlags|=m,c=a.targetContainers,v!==null&&c.indexOf(v)===-1&&c.push(v),a)}function Rf(a,c,d,m,v){switch(c){case"focusin":return Fr=rr(Fr,a,c,d,m,v),!0;case"dragenter":return Vr=rr(Vr,a,c,d,m,v),!0;case"mouseover":return mn=rr(mn,a,c,d,m,v),!0;case"pointerover":var w=v.pointerId;return _a.set(w,rr(_a.get(w)||null,a,c,d,m,v)),!0;case"gotpointercapture":return w=v.pointerId,_s.set(w,rr(_s.get(w)||null,a,c,d,m,v)),!0}return!1}function Gl(a){var c=Ea(a.target);if(c!==null){var d=ir(c);if(d!==null){if(c=d.tag,c===13){if(c=Fu(d),c!==null){a.blockedOn=c,Xu(a.priority,function(){Ku(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=Wl(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var m=new d.constructor(d.type,d);kr=m,d.target.dispatchEvent(m),kr=null}else return c=lh(d),c!==null&&Ul(c),a.blockedOn=d,!1;c.shift()}return!0}function Af(a,c,d){pt(a)&&d.delete(c)}function wy(){Or=!1,Fr!==null&&pt(Fr)&&(Fr=null),Vr!==null&&pt(Vr)&&(Vr=null),mn!==null&&pt(mn)&&(mn=null),_a.forEach(Af),_s.forEach(Af)}function oo(a,c){a.blockedOn===c&&(a.blockedOn=null,Or||(Or=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,wy)))}function ao(a){function c(v){return oo(v,a)}if(0<Bl.length){oo(Bl[0],a);for(var d=1;d<Bl.length;d++){var m=Bl[d];m.blockedOn===a&&(m.blockedOn=null)}}for(Fr!==null&&oo(Fr,a),Vr!==null&&oo(Vr,a),mn!==null&&oo(mn,a),_a.forEach(c),_s.forEach(c),d=0;d<di.length;d++)m=di[d],m.blockedOn===a&&(m.blockedOn=null);for(;0<di.length&&(d=di[0],d.blockedOn===null);)Gl(d),d.blockedOn===null&&di.shift()}var vs=M.ReactCurrentBatchConfig,xs=!0;function jr(a,c,d,m){var v=Xe,w=vs.transition;vs.transition=null;try{Xe=1,qu(a,c,d,m)}finally{Xe=v,vs.transition=w}}function bf(a,c,d,m){var v=Xe,w=vs.transition;vs.transition=null;try{Xe=4,qu(a,c,d,m)}finally{Xe=v,vs.transition=w}}function qu(a,c,d,m){if(xs){var v=Wl(a,c,d,m);if(v===null)Ny(a,c,m,zr,d),so(a,m);else if(Rf(v,a,c,d,m))m.stopPropagation();else if(so(a,m),c&4&&-1<Cf.indexOf(a)){for(;v!==null;){var w=lh(v);if(w!==null&&$u(w),w=Wl(a,c,d,m),w===null&&Ny(a,c,m,zr,d),w===v)break;v=w}v!==null&&m.stopPropagation()}else Ny(a,c,m,null,d)}}var zr=null;function Wl(a,c,d,m){if(zr=null,a=Nr(m),a=Ea(a),a!==null)if(c=ir(a),c===null)a=null;else if(d=c.tag,d===13){if(a=Fu(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return zr=a,null}function $l(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vy()){case jl:return 1;case ju:return 4;case da:case zu:return 16;case zl:return 536870912;default:return 16}default:return 16}}var fi=null,Kl=null,ws=null;function Pf(){if(ws)return ws;var a,c=Kl,d=c.length,m,v="value"in fi?fi.value:fi.textContent,w=v.length;for(a=0;a<d&&c[a]===v[a];a++);var b=d-a;for(m=1;m<=b&&c[d-m]===v[w-m];m++);return ws=v.slice(a,1<m?1-m:void 0)}function va(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Ur(){return!0}function Yu(){return!1}function Cn(a){function c(d,m,v,w,b){this._reactName=d,this._targetInst=v,this.type=m,this.nativeEvent=w,this.target=b,this.currentTarget=null;for(var z in a)a.hasOwnProperty(z)&&(d=a[z],this[z]=d?d(w):w[z]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Ur:Yu,this.isPropagationStopped=Yu,this}return ne(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Ur)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Ur)},persist:function(){},isPersistent:Ur}),c}var Br={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xa=Cn(Br),lo=ne({},Br,{view:0,detail:0}),Hl=Cn(lo),Xl,ql,gi,wa=ne({},lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:je,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==gi&&(gi&&a.type==="mousemove"?(Xl=a.screenX-gi.screenX,ql=a.screenY-gi.screenY):ql=Xl=0,gi=a),Xl)},movementY:function(a){return"movementY"in a?a.movementY:ql}}),Zu=Cn(wa),kf=ne({},wa,{dataTransfer:0}),Nf=Cn(kf),Yl=ne({},lo,{relatedTarget:0}),yn=Cn(Yl),Df=ne({},Br,{animationName:0,elapsedTime:0,pseudoElement:0}),Mf=Cn(Df),co=ne({},Br,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=Cn(co),E=ne({},Br,{data:0}),C=Cn(E),O={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function de(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=ee[a])?!!c[a]:!1}function je(){return de}var Vt=ne({},lo,{key:function(a){if(a.key){var c=O[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=va(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?X[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:je,charCode:function(a){return a.type==="keypress"?va(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?va(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ut=Cn(Vt),Wt=ne({},wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pi=Cn(Wt),Es=ne({},lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:je}),Gr=Cn(Es),Wr=ne({},Br,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zl=Cn(Wr),Qu=ne({},wa,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),MD=Cn(Qu),LD=[9,13,27,32],Ey=l&&"CompositionEvent"in window,Ju=null;l&&"documentMode"in document&&(Ju=document.documentMode);var OD=l&&"TextEvent"in window&&!Ju,Dw=l&&(!Ey||Ju&&8<Ju&&11>=Ju),Mw=" ",Lw=!1;function Ow(a,c){switch(a){case"keyup":return LD.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fw(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ql=!1;function FD(a,c){switch(a){case"compositionend":return Fw(c);case"keypress":return c.which!==32?null:(Lw=!0,Mw);case"textInput":return a=c.data,a===Mw&&Lw?null:a;default:return null}}function VD(a,c){if(Ql)return a==="compositionend"||!Ey&&Ow(a,c)?(a=Pf(),ws=Kl=fi=null,Ql=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Dw&&c.locale!=="ko"?null:c.data;default:return null}}var jD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vw(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!jD[a.type]:c==="textarea"}function jw(a,c,d,m){nr(m),c=jf(c,"onChange"),0<c.length&&(d=new xa("onChange","change",null,d,m),a.push({event:d,listeners:c}))}var eh=null,th=null;function zD(a){iE(a,0)}function Lf(a){var c=ic(a);if(fs(c))return a}function UD(a,c){if(a==="change")return c}var zw=!1;if(l){var Ty;if(l){var Sy="oninput"in document;if(!Sy){var Uw=document.createElement("div");Uw.setAttribute("oninput","return;"),Sy=typeof Uw.oninput=="function"}Ty=Sy}else Ty=!1;zw=Ty&&(!document.documentMode||9<document.documentMode)}function Bw(){eh&&(eh.detachEvent("onpropertychange",Gw),th=eh=null)}function Gw(a){if(a.propertyName==="value"&&Lf(th)){var c=[];jw(c,th,a,Nr(a)),gn(zD,c)}}function BD(a,c,d){a==="focusin"?(Bw(),eh=c,th=d,eh.attachEvent("onpropertychange",Gw)):a==="focusout"&&Bw()}function GD(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Lf(th)}function WD(a,c){if(a==="click")return Lf(c)}function $D(a,c){if(a==="input"||a==="change")return Lf(c)}function KD(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var sr=typeof Object.is=="function"?Object.is:KD;function nh(a,c){if(sr(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),m=Object.keys(c);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var v=d[m];if(!u.call(c,v)||!sr(a[v],c[v]))return!1}return!0}function Ww(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function $w(a,c){var d=Ww(a);a=0;for(var m;d;){if(d.nodeType===3){if(m=a+d.textContent.length,a<=c&&m>=c)return{node:d,offset:c-a};a=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Ww(d)}}function Kw(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?Kw(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function Hw(){for(var a=window,c=Wn();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=Wn(a.document)}return c}function Iy(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function HD(a){var c=Hw(),d=a.focusedElem,m=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&Kw(d.ownerDocument.documentElement,d)){if(m!==null&&Iy(d)){if(c=m.start,a=m.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var v=d.textContent.length,w=Math.min(m.start,v);m=m.end===void 0?w:Math.min(m.end,v),!a.extend&&w>m&&(v=m,m=w,w=v),v=$w(d,w);var b=$w(d,m);v&&b&&(a.rangeCount!==1||a.anchorNode!==v.node||a.anchorOffset!==v.offset||a.focusNode!==b.node||a.focusOffset!==b.offset)&&(c=c.createRange(),c.setStart(v.node,v.offset),a.removeAllRanges(),w>m?(a.addRange(c),a.extend(b.node,b.offset)):(c.setEnd(b.node,b.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var XD=l&&"documentMode"in document&&11>=document.documentMode,Jl=null,Cy=null,ih=null,Ry=!1;function Xw(a,c,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Ry||Jl==null||Jl!==Wn(m)||(m=Jl,"selectionStart"in m&&Iy(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),ih&&nh(ih,m)||(ih=m,m=jf(Cy,"onSelect"),0<m.length&&(c=new xa("onSelect","select",null,c,d),a.push({event:c,listeners:m}),c.target=Jl)))}function Of(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var ec={animationend:Of("Animation","AnimationEnd"),animationiteration:Of("Animation","AnimationIteration"),animationstart:Of("Animation","AnimationStart"),transitionend:Of("Transition","TransitionEnd")},Ay={},qw={};l&&(qw=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function Ff(a){if(Ay[a])return Ay[a];if(!ec[a])return a;var c=ec[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in qw)return Ay[a]=c[d];return a}var Yw=Ff("animationend"),Zw=Ff("animationiteration"),Qw=Ff("animationstart"),Jw=Ff("transitionend"),eE=new Map,tE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function uo(a,c){eE.set(a,c),s(c,[a])}for(var by=0;by<tE.length;by++){var Py=tE[by],qD=Py.toLowerCase(),YD=Py[0].toUpperCase()+Py.slice(1);uo(qD,"on"+YD)}uo(Yw,"onAnimationEnd"),uo(Zw,"onAnimationIteration"),uo(Qw,"onAnimationStart"),uo("dblclick","onDoubleClick"),uo("focusin","onFocus"),uo("focusout","onBlur"),uo(Jw,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZD=new Set("cancel close invalid load scroll toggle".split(" ").concat(rh));function nE(a,c,d){var m=a.type||"unknown-event";a.currentTarget=d,Ou(m,c,void 0,a),a.currentTarget=null}function iE(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var m=a[d],v=m.event;m=m.listeners;e:{var w=void 0;if(c)for(var b=m.length-1;0<=b;b--){var z=m[b],G=z.instance,J=z.currentTarget;if(z=z.listener,G!==w&&v.isPropagationStopped())break e;nE(v,z,J),w=G}else for(b=0;b<m.length;b++){if(z=m[b],G=z.instance,J=z.currentTarget,z=z.listener,G!==w&&v.isPropagationStopped())break e;nE(v,z,J),w=G}}}if(Fl)throw a=Li,Fl=!1,Li=null,a}function xt(a,c){var d=c[Vy];d===void 0&&(d=c[Vy]=new Set);var m=a+"__bubble";d.has(m)||(rE(c,a,2,!1),d.add(m))}function ky(a,c,d){var m=0;c&&(m|=4),rE(d,a,m,c)}var Vf="_reactListening"+Math.random().toString(36).slice(2);function sh(a){if(!a[Vf]){a[Vf]=!0,i.forEach(function(d){d!=="selectionchange"&&(ZD.has(d)||ky(d,!1,a),ky(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Vf]||(c[Vf]=!0,ky("selectionchange",!1,c))}}function rE(a,c,d,m){switch($l(c)){case 1:var v=jr;break;case 4:v=bf;break;default:v=qu}d=v.bind(null,c,d,a),v=void 0,!rn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(v=!0),m?v!==void 0?a.addEventListener(c,d,{capture:!0,passive:v}):a.addEventListener(c,d,!0):v!==void 0?a.addEventListener(c,d,{passive:v}):a.addEventListener(c,d,!1)}function Ny(a,c,d,m,v){var w=m;if((c&1)===0&&(c&2)===0&&m!==null)e:for(;;){if(m===null)return;var b=m.tag;if(b===3||b===4){var z=m.stateNode.containerInfo;if(z===v||z.nodeType===8&&z.parentNode===v)break;if(b===4)for(b=m.return;b!==null;){var G=b.tag;if((G===3||G===4)&&(G=b.stateNode.containerInfo,G===v||G.nodeType===8&&G.parentNode===v))return;b=b.return}for(;z!==null;){if(b=Ea(z),b===null)return;if(G=b.tag,G===5||G===6){m=w=b;continue e}z=z.parentNode}}m=m.return}gn(function(){var J=w,oe=Nr(d),ce=[];e:{var re=eE.get(a);if(re!==void 0){var ye=xa,ve=a;switch(a){case"keypress":if(va(d)===0)break e;case"keydown":case"keyup":ye=ut;break;case"focusin":ve="focus",ye=yn;break;case"focusout":ve="blur",ye=yn;break;case"beforeblur":case"afterblur":ye=yn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=Zu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=Nf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=Gr;break;case Yw:case Zw:case Qw:ye=Mf;break;case Jw:ye=Zl;break;case"scroll":ye=Hl;break;case"wheel":ye=MD;break;case"copy":case"cut":case"paste":ye=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=pi}var we=(c&4)!==0,jt=!we&&a==="scroll",H=we?re!==null?re+"Capture":null:re;we=[];for(var K=J,Y;K!==null;){Y=K;var he=Y.stateNode;if(Y.tag===5&&he!==null&&(Y=he,H!==null&&(he=pn(K,H),he!=null&&we.push(oh(K,he,Y)))),jt)break;K=K.return}0<we.length&&(re=new ye(re,ve,null,d,oe),ce.push({event:re,listeners:we}))}}if((c&7)===0){e:{if(re=a==="mouseover"||a==="pointerover",ye=a==="mouseout"||a==="pointerout",re&&d!==kr&&(ve=d.relatedTarget||d.fromElement)&&(Ea(ve)||ve[Ts]))break e;if((ye||re)&&(re=oe.window===oe?oe:(re=oe.ownerDocument)?re.defaultView||re.parentWindow:window,ye?(ve=d.relatedTarget||d.toElement,ye=J,ve=ve?Ea(ve):null,ve!==null&&(jt=ir(ve),ve!==jt||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(ye=null,ve=J),ye!==ve)){if(we=Zu,he="onMouseLeave",H="onMouseEnter",K="mouse",(a==="pointerout"||a==="pointerover")&&(we=pi,he="onPointerLeave",H="onPointerEnter",K="pointer"),jt=ye==null?re:ic(ye),Y=ve==null?re:ic(ve),re=new we(he,K+"leave",ye,d,oe),re.target=jt,re.relatedTarget=Y,he=null,Ea(oe)===J&&(we=new we(H,K+"enter",ve,d,oe),we.target=Y,we.relatedTarget=jt,he=we),jt=he,ye&&ve)t:{for(we=ye,H=ve,K=0,Y=we;Y;Y=tc(Y))K++;for(Y=0,he=H;he;he=tc(he))Y++;for(;0<K-Y;)we=tc(we),K--;for(;0<Y-K;)H=tc(H),Y--;for(;K--;){if(we===H||H!==null&&we===H.alternate)break t;we=tc(we),H=tc(H)}we=null}else we=null;ye!==null&&sE(ce,re,ye,we,!1),ve!==null&&jt!==null&&sE(ce,jt,ve,we,!0)}}e:{if(re=J?ic(J):window,ye=re.nodeName&&re.nodeName.toLowerCase(),ye==="select"||ye==="input"&&re.type==="file")var Te=UD;else if(Vw(re))if(zw)Te=$D;else{Te=GD;var be=BD}else(ye=re.nodeName)&&ye.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Te=WD);if(Te&&(Te=Te(a,J))){jw(ce,Te,d,oe);break e}be&&be(a,re,J),a==="focusout"&&(be=re._wrapperState)&&be.controlled&&re.type==="number"&&yt(re,"number",re.value)}switch(be=J?ic(J):window,a){case"focusin":(Vw(be)||be.contentEditable==="true")&&(Jl=be,Cy=J,ih=null);break;case"focusout":ih=Cy=Jl=null;break;case"mousedown":Ry=!0;break;case"contextmenu":case"mouseup":case"dragend":Ry=!1,Xw(ce,d,oe);break;case"selectionchange":if(XD)break;case"keydown":case"keyup":Xw(ce,d,oe)}var Pe;if(Ey)e:{switch(a){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else Ql?Ow(a,d)&&(Le="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Le="onCompositionStart");Le&&(Dw&&d.locale!=="ko"&&(Ql||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&Ql&&(Pe=Pf()):(fi=oe,Kl="value"in fi?fi.value:fi.textContent,Ql=!0)),be=jf(J,Le),0<be.length&&(Le=new C(Le,a,null,d,oe),ce.push({event:Le,listeners:be}),Pe?Le.data=Pe:(Pe=Fw(d),Pe!==null&&(Le.data=Pe)))),(Pe=OD?FD(a,d):VD(a,d))&&(J=jf(J,"onBeforeInput"),0<J.length&&(oe=new C("onBeforeInput","beforeinput",null,d,oe),ce.push({event:oe,listeners:J}),oe.data=Pe))}iE(ce,c)})}function oh(a,c,d){return{instance:a,listener:c,currentTarget:d}}function jf(a,c){for(var d=c+"Capture",m=[];a!==null;){var v=a,w=v.stateNode;v.tag===5&&w!==null&&(v=w,w=pn(a,d),w!=null&&m.unshift(oh(a,w,v)),w=pn(a,c),w!=null&&m.push(oh(a,w,v))),a=a.return}return m}function tc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function sE(a,c,d,m,v){for(var w=c._reactName,b=[];d!==null&&d!==m;){var z=d,G=z.alternate,J=z.stateNode;if(G!==null&&G===m)break;z.tag===5&&J!==null&&(z=J,v?(G=pn(d,w),G!=null&&b.unshift(oh(d,G,z))):v||(G=pn(d,w),G!=null&&b.push(oh(d,G,z)))),d=d.return}b.length!==0&&a.push({event:c,listeners:b})}var QD=/\r\n?/g,JD=/\u0000|\uFFFD/g;function oE(a){return(typeof a=="string"?a:""+a).replace(QD,`
`).replace(JD,"")}function zf(a,c,d){if(c=oE(c),oE(a)!==c&&d)throw Error(t(425))}function Uf(){}var Dy=null,My=null;function Ly(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Oy=typeof setTimeout=="function"?setTimeout:void 0,eM=typeof clearTimeout=="function"?clearTimeout:void 0,aE=typeof Promise=="function"?Promise:void 0,tM=typeof queueMicrotask=="function"?queueMicrotask:typeof aE<"u"?function(a){return aE.resolve(null).then(a).catch(nM)}:Oy;function nM(a){setTimeout(function(){throw a})}function Fy(a,c){var d=c,m=0;do{var v=d.nextSibling;if(a.removeChild(d),v&&v.nodeType===8)if(d=v.data,d==="/$"){if(m===0){a.removeChild(v),ao(c);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=v}while(d);ao(c)}function ho(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function lE(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var nc=Math.random().toString(36).slice(2),$r="__reactFiber$"+nc,ah="__reactProps$"+nc,Ts="__reactContainer$"+nc,Vy="__reactEvents$"+nc,iM="__reactListeners$"+nc,rM="__reactHandles$"+nc;function Ea(a){var c=a[$r];if(c)return c;for(var d=a.parentNode;d;){if(c=d[Ts]||d[$r]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=lE(a);a!==null;){if(d=a[$r])return d;a=lE(a)}return c}a=d,d=a.parentNode}return null}function lh(a){return a=a[$r]||a[Ts],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ic(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Bf(a){return a[ah]||null}var jy=[],rc=-1;function fo(a){return{current:a}}function wt(a){0>rc||(a.current=jy[rc],jy[rc]=null,rc--)}function _t(a,c){rc++,jy[rc]=a.current,a.current=c}var go={},Rn=fo(go),Hn=fo(!1),Ta=go;function sc(a,c){var d=a.type.contextTypes;if(!d)return go;var m=a.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===c)return m.__reactInternalMemoizedMaskedChildContext;var v={},w;for(w in d)v[w]=c[w];return m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=v),v}function Xn(a){return a=a.childContextTypes,a!=null}function Gf(){wt(Hn),wt(Rn)}function cE(a,c,d){if(Rn.current!==go)throw Error(t(168));_t(Rn,c),_t(Hn,d)}function uE(a,c,d){var m=a.stateNode;if(c=c.childContextTypes,typeof m.getChildContext!="function")return d;m=m.getChildContext();for(var v in m)if(!(v in c))throw Error(t(108,Me(a)||"Unknown",v));return ne({},d,m)}function Wf(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||go,Ta=Rn.current,_t(Rn,a),_t(Hn,Hn.current),!0}function hE(a,c,d){var m=a.stateNode;if(!m)throw Error(t(169));d?(a=uE(a,c,Ta),m.__reactInternalMemoizedMergedChildContext=a,wt(Hn),wt(Rn),_t(Rn,a)):wt(Hn),_t(Hn,d)}var Ss=null,$f=!1,zy=!1;function dE(a){Ss===null?Ss=[a]:Ss.push(a)}function sM(a){$f=!0,dE(a)}function po(){if(!zy&&Ss!==null){zy=!0;var a=0,c=Xe;try{var d=Ss;for(Xe=1;a<d.length;a++){var m=d[a];do m=m(!0);while(m!==null)}Ss=null,$f=!1}catch(v){throw Ss!==null&&(Ss=Ss.slice(a+1)),Vu(jl,po),v}finally{Xe=c,zy=!1}}return null}var oc=[],ac=0,Kf=null,Hf=0,Fi=[],Vi=0,Sa=null,Is=1,Cs="";function Ia(a,c){oc[ac++]=Hf,oc[ac++]=Kf,Kf=a,Hf=c}function fE(a,c,d){Fi[Vi++]=Is,Fi[Vi++]=Cs,Fi[Vi++]=Sa,Sa=a;var m=Is;a=Cs;var v=32-hi(m)-1;m&=~(1<<v),d+=1;var w=32-hi(c)+v;if(30<w){var b=v-v%5;w=(m&(1<<b)-1).toString(32),m>>=b,v-=b,Is=1<<32-hi(c)+v|d<<v|m,Cs=w+a}else Is=1<<w|d<<v|m,Cs=a}function Uy(a){a.return!==null&&(Ia(a,1),fE(a,1,0))}function By(a){for(;a===Kf;)Kf=oc[--ac],oc[ac]=null,Hf=oc[--ac],oc[ac]=null;for(;a===Sa;)Sa=Fi[--Vi],Fi[Vi]=null,Cs=Fi[--Vi],Fi[Vi]=null,Is=Fi[--Vi],Fi[Vi]=null}var mi=null,yi=null,It=!1,or=null;function gE(a,c){var d=Bi(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function pE(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,mi=a,yi=ho(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,mi=a,yi=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Sa!==null?{id:Is,overflow:Cs}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=Bi(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,mi=a,yi=null,!0):!1;default:return!1}}function Gy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Wy(a){if(It){var c=yi;if(c){var d=c;if(!pE(a,c)){if(Gy(a))throw Error(t(418));c=ho(d.nextSibling);var m=mi;c&&pE(a,c)?gE(m,d):(a.flags=a.flags&-4097|2,It=!1,mi=a)}}else{if(Gy(a))throw Error(t(418));a.flags=a.flags&-4097|2,It=!1,mi=a}}}function mE(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;mi=a}function Xf(a){if(a!==mi)return!1;if(!It)return mE(a),It=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!Ly(a.type,a.memoizedProps)),c&&(c=yi)){if(Gy(a))throw yE(),Error(t(418));for(;c;)gE(a,c),c=ho(c.nextSibling)}if(mE(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){yi=ho(a.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}yi=null}}else yi=mi?ho(a.stateNode.nextSibling):null;return!0}function yE(){for(var a=yi;a;)a=ho(a.nextSibling)}function lc(){yi=mi=null,It=!1}function $y(a){or===null?or=[a]:or.push(a)}var oM=M.ReactCurrentBatchConfig;function ch(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var m=d.stateNode}if(!m)throw Error(t(147,a));var v=m,w=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===w?c.ref:(c=function(b){var z=v.refs;b===null?delete z[w]:z[w]=b},c._stringRef=w,c)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function qf(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function _E(a){var c=a._init;return c(a._payload)}function vE(a){function c(H,K){if(a){var Y=H.deletions;Y===null?(H.deletions=[K],H.flags|=16):Y.push(K)}}function d(H,K){if(!a)return null;for(;K!==null;)c(H,K),K=K.sibling;return null}function m(H,K){for(H=new Map;K!==null;)K.key!==null?H.set(K.key,K):H.set(K.index,K),K=K.sibling;return H}function v(H,K){return H=To(H,K),H.index=0,H.sibling=null,H}function w(H,K,Y){return H.index=Y,a?(Y=H.alternate,Y!==null?(Y=Y.index,Y<K?(H.flags|=2,K):Y):(H.flags|=2,K)):(H.flags|=1048576,K)}function b(H){return a&&H.alternate===null&&(H.flags|=2),H}function z(H,K,Y,he){return K===null||K.tag!==6?(K=O_(Y,H.mode,he),K.return=H,K):(K=v(K,Y),K.return=H,K)}function G(H,K,Y,he){var Te=Y.type;return Te===P?oe(H,K,Y.props.children,he,Y.key):K!==null&&(K.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&_E(Te)===K.type)?(he=v(K,Y.props),he.ref=ch(H,K,Y),he.return=H,he):(he=vg(Y.type,Y.key,Y.props,null,H.mode,he),he.ref=ch(H,K,Y),he.return=H,he)}function J(H,K,Y,he){return K===null||K.tag!==4||K.stateNode.containerInfo!==Y.containerInfo||K.stateNode.implementation!==Y.implementation?(K=F_(Y,H.mode,he),K.return=H,K):(K=v(K,Y.children||[]),K.return=H,K)}function oe(H,K,Y,he,Te){return K===null||K.tag!==7?(K=Da(Y,H.mode,he,Te),K.return=H,K):(K=v(K,Y),K.return=H,K)}function ce(H,K,Y){if(typeof K=="string"&&K!==""||typeof K=="number")return K=O_(""+K,H.mode,Y),K.return=H,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case F:return Y=vg(K.type,K.key,K.props,null,H.mode,Y),Y.ref=ch(H,null,K),Y.return=H,Y;case U:return K=F_(K,H.mode,Y),K.return=H,K;case ge:var he=K._init;return ce(H,he(K._payload),Y)}if(ct(K)||se(K))return K=Da(K,H.mode,Y,null),K.return=H,K;qf(H,K)}return null}function re(H,K,Y,he){var Te=K!==null?K.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Te!==null?null:z(H,K,""+Y,he);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case F:return Y.key===Te?G(H,K,Y,he):null;case U:return Y.key===Te?J(H,K,Y,he):null;case ge:return Te=Y._init,re(H,K,Te(Y._payload),he)}if(ct(Y)||se(Y))return Te!==null?null:oe(H,K,Y,he,null);qf(H,Y)}return null}function ye(H,K,Y,he,Te){if(typeof he=="string"&&he!==""||typeof he=="number")return H=H.get(Y)||null,z(K,H,""+he,Te);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case F:return H=H.get(he.key===null?Y:he.key)||null,G(K,H,he,Te);case U:return H=H.get(he.key===null?Y:he.key)||null,J(K,H,he,Te);case ge:var be=he._init;return ye(H,K,Y,be(he._payload),Te)}if(ct(he)||se(he))return H=H.get(Y)||null,oe(K,H,he,Te,null);qf(K,he)}return null}function ve(H,K,Y,he){for(var Te=null,be=null,Pe=K,Le=K=0,an=null;Pe!==null&&Le<Y.length;Le++){Pe.index>Le?(an=Pe,Pe=null):an=Pe.sibling;var et=re(H,Pe,Y[Le],he);if(et===null){Pe===null&&(Pe=an);break}a&&Pe&&et.alternate===null&&c(H,Pe),K=w(et,K,Le),be===null?Te=et:be.sibling=et,be=et,Pe=an}if(Le===Y.length)return d(H,Pe),It&&Ia(H,Le),Te;if(Pe===null){for(;Le<Y.length;Le++)Pe=ce(H,Y[Le],he),Pe!==null&&(K=w(Pe,K,Le),be===null?Te=Pe:be.sibling=Pe,be=Pe);return It&&Ia(H,Le),Te}for(Pe=m(H,Pe);Le<Y.length;Le++)an=ye(Pe,H,Le,Y[Le],he),an!==null&&(a&&an.alternate!==null&&Pe.delete(an.key===null?Le:an.key),K=w(an,K,Le),be===null?Te=an:be.sibling=an,be=an);return a&&Pe.forEach(function(So){return c(H,So)}),It&&Ia(H,Le),Te}function we(H,K,Y,he){var Te=se(Y);if(typeof Te!="function")throw Error(t(150));if(Y=Te.call(Y),Y==null)throw Error(t(151));for(var be=Te=null,Pe=K,Le=K=0,an=null,et=Y.next();Pe!==null&&!et.done;Le++,et=Y.next()){Pe.index>Le?(an=Pe,Pe=null):an=Pe.sibling;var So=re(H,Pe,et.value,he);if(So===null){Pe===null&&(Pe=an);break}a&&Pe&&So.alternate===null&&c(H,Pe),K=w(So,K,Le),be===null?Te=So:be.sibling=So,be=So,Pe=an}if(et.done)return d(H,Pe),It&&Ia(H,Le),Te;if(Pe===null){for(;!et.done;Le++,et=Y.next())et=ce(H,et.value,he),et!==null&&(K=w(et,K,Le),be===null?Te=et:be.sibling=et,be=et);return It&&Ia(H,Le),Te}for(Pe=m(H,Pe);!et.done;Le++,et=Y.next())et=ye(Pe,H,Le,et.value,he),et!==null&&(a&&et.alternate!==null&&Pe.delete(et.key===null?Le:et.key),K=w(et,K,Le),be===null?Te=et:be.sibling=et,be=et);return a&&Pe.forEach(function(jM){return c(H,jM)}),It&&Ia(H,Le),Te}function jt(H,K,Y,he){if(typeof Y=="object"&&Y!==null&&Y.type===P&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case F:e:{for(var Te=Y.key,be=K;be!==null;){if(be.key===Te){if(Te=Y.type,Te===P){if(be.tag===7){d(H,be.sibling),K=v(be,Y.props.children),K.return=H,H=K;break e}}else if(be.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&_E(Te)===be.type){d(H,be.sibling),K=v(be,Y.props),K.ref=ch(H,be,Y),K.return=H,H=K;break e}d(H,be);break}else c(H,be);be=be.sibling}Y.type===P?(K=Da(Y.props.children,H.mode,he,Y.key),K.return=H,H=K):(he=vg(Y.type,Y.key,Y.props,null,H.mode,he),he.ref=ch(H,K,Y),he.return=H,H=he)}return b(H);case U:e:{for(be=Y.key;K!==null;){if(K.key===be)if(K.tag===4&&K.stateNode.containerInfo===Y.containerInfo&&K.stateNode.implementation===Y.implementation){d(H,K.sibling),K=v(K,Y.children||[]),K.return=H,H=K;break e}else{d(H,K);break}else c(H,K);K=K.sibling}K=F_(Y,H.mode,he),K.return=H,H=K}return b(H);case ge:return be=Y._init,jt(H,K,be(Y._payload),he)}if(ct(Y))return ve(H,K,Y,he);if(se(Y))return we(H,K,Y,he);qf(H,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,K!==null&&K.tag===6?(d(H,K.sibling),K=v(K,Y),K.return=H,H=K):(d(H,K),K=O_(Y,H.mode,he),K.return=H,H=K),b(H)):d(H,K)}return jt}var cc=vE(!0),xE=vE(!1),Yf=fo(null),Zf=null,uc=null,Ky=null;function Hy(){Ky=uc=Zf=null}function Xy(a){var c=Yf.current;wt(Yf),a._currentValue=c}function qy(a,c,d){for(;a!==null;){var m=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),a===d)break;a=a.return}}function hc(a,c){Zf=a,Ky=uc=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(qn=!0),a.firstContext=null)}function ji(a){var c=a._currentValue;if(Ky!==a)if(a={context:a,memoizedValue:c,next:null},uc===null){if(Zf===null)throw Error(t(308));uc=a,Zf.dependencies={lanes:0,firstContext:a}}else uc=uc.next=a;return c}var Ca=null;function Yy(a){Ca===null?Ca=[a]:Ca.push(a)}function wE(a,c,d,m){var v=c.interleaved;return v===null?(d.next=d,Yy(c)):(d.next=v.next,v.next=d),c.interleaved=d,Rs(a,m)}function Rs(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var mo=!1;function Zy(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function EE(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function As(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function yo(a,c,d){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(Je&2)!==0){var v=m.pending;return v===null?c.next=c:(c.next=v.next,v.next=c),m.pending=c,Rs(a,d)}return v=m.interleaved,v===null?(c.next=c,Yy(m)):(c.next=v.next,v.next=c),m.interleaved=c,Rs(a,d)}function Qf(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,Wu(a,d)}}function TE(a,c){var d=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var v=null,w=null;if(d=d.firstBaseUpdate,d!==null){do{var b={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};w===null?v=w=b:w=w.next=b,d=d.next}while(d!==null);w===null?v=w=c:w=w.next=c}else v=w=c;d={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:m.shared,effects:m.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function Jf(a,c,d,m){var v=a.updateQueue;mo=!1;var w=v.firstBaseUpdate,b=v.lastBaseUpdate,z=v.shared.pending;if(z!==null){v.shared.pending=null;var G=z,J=G.next;G.next=null,b===null?w=J:b.next=J,b=G;var oe=a.alternate;oe!==null&&(oe=oe.updateQueue,z=oe.lastBaseUpdate,z!==b&&(z===null?oe.firstBaseUpdate=J:z.next=J,oe.lastBaseUpdate=G))}if(w!==null){var ce=v.baseState;b=0,oe=J=G=null,z=w;do{var re=z.lane,ye=z.eventTime;if((m&re)===re){oe!==null&&(oe=oe.next={eventTime:ye,lane:0,tag:z.tag,payload:z.payload,callback:z.callback,next:null});e:{var ve=a,we=z;switch(re=c,ye=d,we.tag){case 1:if(ve=we.payload,typeof ve=="function"){ce=ve.call(ye,ce,re);break e}ce=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=we.payload,re=typeof ve=="function"?ve.call(ye,ce,re):ve,re==null)break e;ce=ne({},ce,re);break e;case 2:mo=!0}}z.callback!==null&&z.lane!==0&&(a.flags|=64,re=v.effects,re===null?v.effects=[z]:re.push(z))}else ye={eventTime:ye,lane:re,tag:z.tag,payload:z.payload,callback:z.callback,next:null},oe===null?(J=oe=ye,G=ce):oe=oe.next=ye,b|=re;if(z=z.next,z===null){if(z=v.shared.pending,z===null)break;re=z,z=re.next,re.next=null,v.lastBaseUpdate=re,v.shared.pending=null}}while(!0);if(oe===null&&(G=ce),v.baseState=G,v.firstBaseUpdate=J,v.lastBaseUpdate=oe,c=v.shared.interleaved,c!==null){v=c;do b|=v.lane,v=v.next;while(v!==c)}else w===null&&(v.shared.lanes=0);ba|=b,a.lanes=b,a.memoizedState=ce}}function SE(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var m=a[c],v=m.callback;if(v!==null){if(m.callback=null,m=d,typeof v!="function")throw Error(t(191,v));v.call(m)}}}var uh={},Kr=fo(uh),hh=fo(uh),dh=fo(uh);function Ra(a){if(a===uh)throw Error(t(174));return a}function Qy(a,c){switch(_t(dh,c),_t(hh,a),_t(Kr,uh),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:tr(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=tr(c,a)}wt(Kr),_t(Kr,c)}function dc(){wt(Kr),wt(hh),wt(dh)}function IE(a){Ra(dh.current);var c=Ra(Kr.current),d=tr(c,a.type);c!==d&&(_t(hh,a),_t(Kr,d))}function Jy(a){hh.current===a&&(wt(Kr),wt(hh))}var At=fo(0);function eg(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var e_=[];function t_(){for(var a=0;a<e_.length;a++)e_[a]._workInProgressVersionPrimary=null;e_.length=0}var tg=M.ReactCurrentDispatcher,n_=M.ReactCurrentBatchConfig,Aa=0,bt=null,Yt=null,sn=null,ng=!1,fh=!1,gh=0,aM=0;function An(){throw Error(t(321))}function i_(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!sr(a[d],c[d]))return!1;return!0}function r_(a,c,d,m,v,w){if(Aa=w,bt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,tg.current=a===null||a.memoizedState===null?hM:dM,a=d(m,v),fh){w=0;do{if(fh=!1,gh=0,25<=w)throw Error(t(301));w+=1,sn=Yt=null,c.updateQueue=null,tg.current=fM,a=d(m,v)}while(fh)}if(tg.current=sg,c=Yt!==null&&Yt.next!==null,Aa=0,sn=Yt=bt=null,ng=!1,c)throw Error(t(300));return a}function s_(){var a=gh!==0;return gh=0,a}function Hr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?bt.memoizedState=sn=a:sn=sn.next=a,sn}function zi(){if(Yt===null){var a=bt.alternate;a=a!==null?a.memoizedState:null}else a=Yt.next;var c=sn===null?bt.memoizedState:sn.next;if(c!==null)sn=c,Yt=a;else{if(a===null)throw Error(t(310));Yt=a,a={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},sn===null?bt.memoizedState=sn=a:sn=sn.next=a}return sn}function ph(a,c){return typeof c=="function"?c(a):c}function o_(a){var c=zi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=Yt,v=m.baseQueue,w=d.pending;if(w!==null){if(v!==null){var b=v.next;v.next=w.next,w.next=b}m.baseQueue=v=w,d.pending=null}if(v!==null){w=v.next,m=m.baseState;var z=b=null,G=null,J=w;do{var oe=J.lane;if((Aa&oe)===oe)G!==null&&(G=G.next={lane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),m=J.hasEagerState?J.eagerState:a(m,J.action);else{var ce={lane:oe,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null};G===null?(z=G=ce,b=m):G=G.next=ce,bt.lanes|=oe,ba|=oe}J=J.next}while(J!==null&&J!==w);G===null?b=m:G.next=z,sr(m,c.memoizedState)||(qn=!0),c.memoizedState=m,c.baseState=b,c.baseQueue=G,d.lastRenderedState=m}if(a=d.interleaved,a!==null){v=a;do w=v.lane,bt.lanes|=w,ba|=w,v=v.next;while(v!==a)}else v===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function a_(a){var c=zi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=d.dispatch,v=d.pending,w=c.memoizedState;if(v!==null){d.pending=null;var b=v=v.next;do w=a(w,b.action),b=b.next;while(b!==v);sr(w,c.memoizedState)||(qn=!0),c.memoizedState=w,c.baseQueue===null&&(c.baseState=w),d.lastRenderedState=w}return[w,m]}function CE(){}function RE(a,c){var d=bt,m=zi(),v=c(),w=!sr(m.memoizedState,v);if(w&&(m.memoizedState=v,qn=!0),m=m.queue,l_(PE.bind(null,d,m,a),[a]),m.getSnapshot!==c||w||sn!==null&&sn.memoizedState.tag&1){if(d.flags|=2048,mh(9,bE.bind(null,d,m,v,c),void 0,null),on===null)throw Error(t(349));(Aa&30)!==0||AE(d,c,v)}return v}function AE(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=bt.updateQueue,c===null?(c={lastEffect:null,stores:null},bt.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function bE(a,c,d,m){c.value=d,c.getSnapshot=m,kE(c)&&NE(a)}function PE(a,c,d){return d(function(){kE(c)&&NE(a)})}function kE(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!sr(a,d)}catch{return!0}}function NE(a){var c=Rs(a,1);c!==null&&ur(c,a,1,-1)}function DE(a){var c=Hr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ph,lastRenderedState:a},c.queue=a,a=a.dispatch=uM.bind(null,bt,a),[c.memoizedState,a]}function mh(a,c,d,m){return a={tag:a,create:c,destroy:d,deps:m,next:null},c=bt.updateQueue,c===null?(c={lastEffect:null,stores:null},bt.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(m=d.next,d.next=a,a.next=m,c.lastEffect=a)),a}function ME(){return zi().memoizedState}function ig(a,c,d,m){var v=Hr();bt.flags|=a,v.memoizedState=mh(1|c,d,void 0,m===void 0?null:m)}function rg(a,c,d,m){var v=zi();m=m===void 0?null:m;var w=void 0;if(Yt!==null){var b=Yt.memoizedState;if(w=b.destroy,m!==null&&i_(m,b.deps)){v.memoizedState=mh(c,d,w,m);return}}bt.flags|=a,v.memoizedState=mh(1|c,d,w,m)}function LE(a,c){return ig(8390656,8,a,c)}function l_(a,c){return rg(2048,8,a,c)}function OE(a,c){return rg(4,2,a,c)}function FE(a,c){return rg(4,4,a,c)}function VE(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function jE(a,c,d){return d=d!=null?d.concat([a]):null,rg(4,4,VE.bind(null,c,a),d)}function c_(){}function zE(a,c){var d=zi();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&i_(c,m[1])?m[0]:(d.memoizedState=[a,c],a)}function UE(a,c){var d=zi();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&i_(c,m[1])?m[0]:(a=a(),d.memoizedState=[a,c],a)}function BE(a,c,d){return(Aa&21)===0?(a.baseState&&(a.baseState=!1,qn=!0),a.memoizedState=d):(sr(d,c)||(d=Bu(),bt.lanes|=d,ba|=d,a.baseState=!0),c)}function lM(a,c){var d=Xe;Xe=d!==0&&4>d?d:4,a(!0);var m=n_.transition;n_.transition={};try{a(!1),c()}finally{Xe=d,n_.transition=m}}function GE(){return zi().memoizedState}function cM(a,c,d){var m=wo(a);if(d={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null},WE(a))$E(c,d);else if(d=wE(a,c,d,m),d!==null){var v=zn();ur(d,a,m,v),KE(d,c,m)}}function uM(a,c,d){var m=wo(a),v={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null};if(WE(a))$E(c,v);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=c.lastRenderedReducer,w!==null))try{var b=c.lastRenderedState,z=w(b,d);if(v.hasEagerState=!0,v.eagerState=z,sr(z,b)){var G=c.interleaved;G===null?(v.next=v,Yy(c)):(v.next=G.next,G.next=v),c.interleaved=v;return}}catch{}d=wE(a,c,v,m),d!==null&&(v=zn(),ur(d,a,m,v),KE(d,c,m))}}function WE(a){var c=a.alternate;return a===bt||c!==null&&c===bt}function $E(a,c){fh=ng=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function KE(a,c,d){if((d&4194240)!==0){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,Wu(a,d)}}var sg={readContext:ji,useCallback:An,useContext:An,useEffect:An,useImperativeHandle:An,useInsertionEffect:An,useLayoutEffect:An,useMemo:An,useReducer:An,useRef:An,useState:An,useDebugValue:An,useDeferredValue:An,useTransition:An,useMutableSource:An,useSyncExternalStore:An,useId:An,unstable_isNewReconciler:!1},hM={readContext:ji,useCallback:function(a,c){return Hr().memoizedState=[a,c===void 0?null:c],a},useContext:ji,useEffect:LE,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,ig(4194308,4,VE.bind(null,c,a),d)},useLayoutEffect:function(a,c){return ig(4194308,4,a,c)},useInsertionEffect:function(a,c){return ig(4,2,a,c)},useMemo:function(a,c){var d=Hr();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var m=Hr();return c=d!==void 0?d(c):c,m.memoizedState=m.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},m.queue=a,a=a.dispatch=cM.bind(null,bt,a),[m.memoizedState,a]},useRef:function(a){var c=Hr();return a={current:a},c.memoizedState=a},useState:DE,useDebugValue:c_,useDeferredValue:function(a){return Hr().memoizedState=a},useTransition:function(){var a=DE(!1),c=a[0];return a=lM.bind(null,a[1]),Hr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var m=bt,v=Hr();if(It){if(d===void 0)throw Error(t(407));d=d()}else{if(d=c(),on===null)throw Error(t(349));(Aa&30)!==0||AE(m,c,d)}v.memoizedState=d;var w={value:d,getSnapshot:c};return v.queue=w,LE(PE.bind(null,m,w,a),[a]),m.flags|=2048,mh(9,bE.bind(null,m,w,d,c),void 0,null),d},useId:function(){var a=Hr(),c=on.identifierPrefix;if(It){var d=Cs,m=Is;d=(m&~(1<<32-hi(m)-1)).toString(32)+d,c=":"+c+"R"+d,d=gh++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=aM++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},dM={readContext:ji,useCallback:zE,useContext:ji,useEffect:l_,useImperativeHandle:jE,useInsertionEffect:OE,useLayoutEffect:FE,useMemo:UE,useReducer:o_,useRef:ME,useState:function(){return o_(ph)},useDebugValue:c_,useDeferredValue:function(a){var c=zi();return BE(c,Yt.memoizedState,a)},useTransition:function(){var a=o_(ph)[0],c=zi().memoizedState;return[a,c]},useMutableSource:CE,useSyncExternalStore:RE,useId:GE,unstable_isNewReconciler:!1},fM={readContext:ji,useCallback:zE,useContext:ji,useEffect:l_,useImperativeHandle:jE,useInsertionEffect:OE,useLayoutEffect:FE,useMemo:UE,useReducer:a_,useRef:ME,useState:function(){return a_(ph)},useDebugValue:c_,useDeferredValue:function(a){var c=zi();return Yt===null?c.memoizedState=a:BE(c,Yt.memoizedState,a)},useTransition:function(){var a=a_(ph)[0],c=zi().memoizedState;return[a,c]},useMutableSource:CE,useSyncExternalStore:RE,useId:GE,unstable_isNewReconciler:!1};function ar(a,c){if(a&&a.defaultProps){c=ne({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function u_(a,c,d,m){c=a.memoizedState,d=d(m,c),d=d==null?c:ne({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var og={isMounted:function(a){return(a=a._reactInternals)?ir(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var m=zn(),v=wo(a),w=As(m,v);w.payload=c,d!=null&&(w.callback=d),c=yo(a,w,v),c!==null&&(ur(c,a,v,m),Qf(c,a,v))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var m=zn(),v=wo(a),w=As(m,v);w.tag=1,w.payload=c,d!=null&&(w.callback=d),c=yo(a,w,v),c!==null&&(ur(c,a,v,m),Qf(c,a,v))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=zn(),m=wo(a),v=As(d,m);v.tag=2,c!=null&&(v.callback=c),c=yo(a,v,m),c!==null&&(ur(c,a,m,d),Qf(c,a,m))}};function HE(a,c,d,m,v,w,b){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,w,b):c.prototype&&c.prototype.isPureReactComponent?!nh(d,m)||!nh(v,w):!0}function XE(a,c,d){var m=!1,v=go,w=c.contextType;return typeof w=="object"&&w!==null?w=ji(w):(v=Xn(c)?Ta:Rn.current,m=c.contextTypes,w=(m=m!=null)?sc(a,v):go),c=new c(d,w),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=og,a.stateNode=c,c._reactInternals=a,m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=w),c}function qE(a,c,d,m){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,m),c.state!==a&&og.enqueueReplaceState(c,c.state,null)}function h_(a,c,d,m){var v=a.stateNode;v.props=d,v.state=a.memoizedState,v.refs={},Zy(a);var w=c.contextType;typeof w=="object"&&w!==null?v.context=ji(w):(w=Xn(c)?Ta:Rn.current,v.context=sc(a,w)),v.state=a.memoizedState,w=c.getDerivedStateFromProps,typeof w=="function"&&(u_(a,c,w,d),v.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(c=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),c!==v.state&&og.enqueueReplaceState(v,v.state,null),Jf(a,d,v,m),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function fc(a,c){try{var d="",m=c;do d+=xe(m),m=m.return;while(m);var v=d}catch(w){v=`
Error generating stack: `+w.message+`
`+w.stack}return{value:a,source:c,stack:v,digest:null}}function d_(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function f_(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var gM=typeof WeakMap=="function"?WeakMap:Map;function YE(a,c,d){d=As(-1,d),d.tag=3,d.payload={element:null};var m=c.value;return d.callback=function(){fg||(fg=!0,A_=m),f_(a,c)},d}function ZE(a,c,d){d=As(-1,d),d.tag=3;var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var v=c.value;d.payload=function(){return m(v)},d.callback=function(){f_(a,c)}}var w=a.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(d.callback=function(){f_(a,c),typeof m!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var b=c.stack;this.componentDidCatch(c.value,{componentStack:b!==null?b:""})}),d}function QE(a,c,d){var m=a.pingCache;if(m===null){m=a.pingCache=new gM;var v=new Set;m.set(c,v)}else v=m.get(c),v===void 0&&(v=new Set,m.set(c,v));v.has(d)||(v.add(d),a=AM.bind(null,a,c,d),c.then(a,a))}function JE(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function eT(a,c,d,m,v){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=As(-1,1),c.tag=2,yo(d,c,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=v,a)}var pM=M.ReactCurrentOwner,qn=!1;function jn(a,c,d,m){c.child=a===null?xE(c,null,d,m):cc(c,a.child,d,m)}function tT(a,c,d,m,v){d=d.render;var w=c.ref;return hc(c,v),m=r_(a,c,d,m,w,v),d=s_(),a!==null&&!qn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,bs(a,c,v)):(It&&d&&Uy(c),c.flags|=1,jn(a,c,m,v),c.child)}function nT(a,c,d,m,v){if(a===null){var w=d.type;return typeof w=="function"&&!L_(w)&&w.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=w,iT(a,c,w,m,v)):(a=vg(d.type,null,m,c,c.mode,v),a.ref=c.ref,a.return=c,c.child=a)}if(w=a.child,(a.lanes&v)===0){var b=w.memoizedProps;if(d=d.compare,d=d!==null?d:nh,d(b,m)&&a.ref===c.ref)return bs(a,c,v)}return c.flags|=1,a=To(w,m),a.ref=c.ref,a.return=c,c.child=a}function iT(a,c,d,m,v){if(a!==null){var w=a.memoizedProps;if(nh(w,m)&&a.ref===c.ref)if(qn=!1,c.pendingProps=m=w,(a.lanes&v)!==0)(a.flags&131072)!==0&&(qn=!0);else return c.lanes=a.lanes,bs(a,c,v)}return g_(a,c,d,m,v)}function rT(a,c,d){var m=c.pendingProps,v=m.children,w=a!==null?a.memoizedState:null;if(m.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(pc,_i),_i|=d;else{if((d&1073741824)===0)return a=w!==null?w.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,_t(pc,_i),_i|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=w!==null?w.baseLanes:d,_t(pc,_i),_i|=m}else w!==null?(m=w.baseLanes|d,c.memoizedState=null):m=d,_t(pc,_i),_i|=m;return jn(a,c,v,d),c.child}function sT(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function g_(a,c,d,m,v){var w=Xn(d)?Ta:Rn.current;return w=sc(c,w),hc(c,v),d=r_(a,c,d,m,w,v),m=s_(),a!==null&&!qn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,bs(a,c,v)):(It&&m&&Uy(c),c.flags|=1,jn(a,c,d,v),c.child)}function oT(a,c,d,m,v){if(Xn(d)){var w=!0;Wf(c)}else w=!1;if(hc(c,v),c.stateNode===null)lg(a,c),XE(c,d,m),h_(c,d,m,v),m=!0;else if(a===null){var b=c.stateNode,z=c.memoizedProps;b.props=z;var G=b.context,J=d.contextType;typeof J=="object"&&J!==null?J=ji(J):(J=Xn(d)?Ta:Rn.current,J=sc(c,J));var oe=d.getDerivedStateFromProps,ce=typeof oe=="function"||typeof b.getSnapshotBeforeUpdate=="function";ce||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(z!==m||G!==J)&&qE(c,b,m,J),mo=!1;var re=c.memoizedState;b.state=re,Jf(c,m,b,v),G=c.memoizedState,z!==m||re!==G||Hn.current||mo?(typeof oe=="function"&&(u_(c,d,oe,m),G=c.memoizedState),(z=mo||HE(c,d,z,m,re,G,J))?(ce||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(c.flags|=4194308)):(typeof b.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=G),b.props=m,b.state=G,b.context=J,m=z):(typeof b.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{b=c.stateNode,EE(a,c),z=c.memoizedProps,J=c.type===c.elementType?z:ar(c.type,z),b.props=J,ce=c.pendingProps,re=b.context,G=d.contextType,typeof G=="object"&&G!==null?G=ji(G):(G=Xn(d)?Ta:Rn.current,G=sc(c,G));var ye=d.getDerivedStateFromProps;(oe=typeof ye=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(z!==ce||re!==G)&&qE(c,b,m,G),mo=!1,re=c.memoizedState,b.state=re,Jf(c,m,b,v);var ve=c.memoizedState;z!==ce||re!==ve||Hn.current||mo?(typeof ye=="function"&&(u_(c,d,ye,m),ve=c.memoizedState),(J=mo||HE(c,d,J,m,re,ve,G)||!1)?(oe||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(m,ve,G),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(m,ve,G)),typeof b.componentDidUpdate=="function"&&(c.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof b.componentDidUpdate!="function"||z===a.memoizedProps&&re===a.memoizedState||(c.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&re===a.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=ve),b.props=m,b.state=ve,b.context=G,m=J):(typeof b.componentDidUpdate!="function"||z===a.memoizedProps&&re===a.memoizedState||(c.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&re===a.memoizedState||(c.flags|=1024),m=!1)}return p_(a,c,d,m,w,v)}function p_(a,c,d,m,v,w){sT(a,c);var b=(c.flags&128)!==0;if(!m&&!b)return v&&hE(c,d,!1),bs(a,c,w);m=c.stateNode,pM.current=c;var z=b&&typeof d.getDerivedStateFromError!="function"?null:m.render();return c.flags|=1,a!==null&&b?(c.child=cc(c,a.child,null,w),c.child=cc(c,null,z,w)):jn(a,c,z,w),c.memoizedState=m.state,v&&hE(c,d,!0),c.child}function aT(a){var c=a.stateNode;c.pendingContext?cE(a,c.pendingContext,c.pendingContext!==c.context):c.context&&cE(a,c.context,!1),Qy(a,c.containerInfo)}function lT(a,c,d,m,v){return lc(),$y(v),c.flags|=256,jn(a,c,d,m),c.child}var m_={dehydrated:null,treeContext:null,retryLane:0};function y_(a){return{baseLanes:a,cachePool:null,transitions:null}}function cT(a,c,d){var m=c.pendingProps,v=At.current,w=!1,b=(c.flags&128)!==0,z;if((z=b)||(z=a!==null&&a.memoizedState===null?!1:(v&2)!==0),z?(w=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),_t(At,v&1),a===null)return Wy(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(b=m.children,a=m.fallback,w?(m=c.mode,w=c.child,b={mode:"hidden",children:b},(m&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=b):w=xg(b,m,0,null),a=Da(a,m,d,null),w.return=c,a.return=c,w.sibling=a,c.child=w,c.child.memoizedState=y_(d),c.memoizedState=m_,a):__(c,b));if(v=a.memoizedState,v!==null&&(z=v.dehydrated,z!==null))return mM(a,c,b,m,z,v,d);if(w){w=m.fallback,b=c.mode,v=a.child,z=v.sibling;var G={mode:"hidden",children:m.children};return(b&1)===0&&c.child!==v?(m=c.child,m.childLanes=0,m.pendingProps=G,c.deletions=null):(m=To(v,G),m.subtreeFlags=v.subtreeFlags&14680064),z!==null?w=To(z,w):(w=Da(w,b,d,null),w.flags|=2),w.return=c,m.return=c,m.sibling=w,c.child=m,m=w,w=c.child,b=a.child.memoizedState,b=b===null?y_(d):{baseLanes:b.baseLanes|d,cachePool:null,transitions:b.transitions},w.memoizedState=b,w.childLanes=a.childLanes&~d,c.memoizedState=m_,m}return w=a.child,a=w.sibling,m=To(w,{mode:"visible",children:m.children}),(c.mode&1)===0&&(m.lanes=d),m.return=c,m.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=m,c.memoizedState=null,m}function __(a,c){return c=xg({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function ag(a,c,d,m){return m!==null&&$y(m),cc(c,a.child,null,d),a=__(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function mM(a,c,d,m,v,w,b){if(d)return c.flags&256?(c.flags&=-257,m=d_(Error(t(422))),ag(a,c,b,m)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(w=m.fallback,v=c.mode,m=xg({mode:"visible",children:m.children},v,0,null),w=Da(w,v,b,null),w.flags|=2,m.return=c,w.return=c,m.sibling=w,c.child=m,(c.mode&1)!==0&&cc(c,a.child,null,b),c.child.memoizedState=y_(b),c.memoizedState=m_,w);if((c.mode&1)===0)return ag(a,c,b,null);if(v.data==="$!"){if(m=v.nextSibling&&v.nextSibling.dataset,m)var z=m.dgst;return m=z,w=Error(t(419)),m=d_(w,m,void 0),ag(a,c,b,m)}if(z=(b&a.childLanes)!==0,qn||z){if(m=on,m!==null){switch(b&-b){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(m.suspendedLanes|b))!==0?0:v,v!==0&&v!==w.retryLane&&(w.retryLane=v,Rs(a,v),ur(m,a,v,-1))}return M_(),m=d_(Error(t(421))),ag(a,c,b,m)}return v.data==="$?"?(c.flags|=128,c.child=a.child,c=bM.bind(null,a),v._reactRetry=c,null):(a=w.treeContext,yi=ho(v.nextSibling),mi=c,It=!0,or=null,a!==null&&(Fi[Vi++]=Is,Fi[Vi++]=Cs,Fi[Vi++]=Sa,Is=a.id,Cs=a.overflow,Sa=c),c=__(c,m.children),c.flags|=4096,c)}function uT(a,c,d){a.lanes|=c;var m=a.alternate;m!==null&&(m.lanes|=c),qy(a.return,c,d)}function v_(a,c,d,m,v){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:v}:(w.isBackwards=c,w.rendering=null,w.renderingStartTime=0,w.last=m,w.tail=d,w.tailMode=v)}function hT(a,c,d){var m=c.pendingProps,v=m.revealOrder,w=m.tail;if(jn(a,c,m.children,d),m=At.current,(m&2)!==0)m=m&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&uT(a,d,c);else if(a.tag===19)uT(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}if(_t(At,m),(c.mode&1)===0)c.memoizedState=null;else switch(v){case"forwards":for(d=c.child,v=null;d!==null;)a=d.alternate,a!==null&&eg(a)===null&&(v=d),d=d.sibling;d=v,d===null?(v=c.child,c.child=null):(v=d.sibling,d.sibling=null),v_(c,!1,v,d,w);break;case"backwards":for(d=null,v=c.child,c.child=null;v!==null;){if(a=v.alternate,a!==null&&eg(a)===null){c.child=v;break}a=v.sibling,v.sibling=d,d=v,v=a}v_(c,!0,d,null,w);break;case"together":v_(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function lg(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function bs(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),ba|=c.lanes,(d&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,d=To(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=To(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function yM(a,c,d){switch(c.tag){case 3:aT(c),lc();break;case 5:IE(c);break;case 1:Xn(c.type)&&Wf(c);break;case 4:Qy(c,c.stateNode.containerInfo);break;case 10:var m=c.type._context,v=c.memoizedProps.value;_t(Yf,m._currentValue),m._currentValue=v;break;case 13:if(m=c.memoizedState,m!==null)return m.dehydrated!==null?(_t(At,At.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?cT(a,c,d):(_t(At,At.current&1),a=bs(a,c,d),a!==null?a.sibling:null);_t(At,At.current&1);break;case 19:if(m=(d&c.childLanes)!==0,(a.flags&128)!==0){if(m)return hT(a,c,d);c.flags|=128}if(v=c.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),_t(At,At.current),m)break;return null;case 22:case 23:return c.lanes=0,rT(a,c,d)}return bs(a,c,d)}var dT,x_,fT,gT;dT=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},x_=function(){},fT=function(a,c,d,m){var v=a.memoizedProps;if(v!==m){a=c.stateNode,Ra(Kr.current);var w=null;switch(d){case"input":v=$n(a,v),m=$n(a,m),w=[];break;case"select":v=ne({},v,{value:void 0}),m=ne({},m,{value:void 0}),w=[];break;case"textarea":v=Pi(a,v),m=Pi(a,m),w=[];break;default:typeof v.onClick!="function"&&typeof m.onClick=="function"&&(a.onclick=Uf)}On(d,m);var b;d=null;for(J in v)if(!m.hasOwnProperty(J)&&v.hasOwnProperty(J)&&v[J]!=null)if(J==="style"){var z=v[J];for(b in z)z.hasOwnProperty(b)&&(d||(d={}),d[b]="")}else J!=="dangerouslySetInnerHTML"&&J!=="children"&&J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(r.hasOwnProperty(J)?w||(w=[]):(w=w||[]).push(J,null));for(J in m){var G=m[J];if(z=v?.[J],m.hasOwnProperty(J)&&G!==z&&(G!=null||z!=null))if(J==="style")if(z){for(b in z)!z.hasOwnProperty(b)||G&&G.hasOwnProperty(b)||(d||(d={}),d[b]="");for(b in G)G.hasOwnProperty(b)&&z[b]!==G[b]&&(d||(d={}),d[b]=G[b])}else d||(w||(w=[]),w.push(J,d)),d=G;else J==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,z=z?z.__html:void 0,G!=null&&z!==G&&(w=w||[]).push(J,G)):J==="children"?typeof G!="string"&&typeof G!="number"||(w=w||[]).push(J,""+G):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&(r.hasOwnProperty(J)?(G!=null&&J==="onScroll"&&xt("scroll",a),w||z===G||(w=[])):(w=w||[]).push(J,G))}d&&(w=w||[]).push("style",d);var J=w;(c.updateQueue=J)&&(c.flags|=4)}},gT=function(a,c,d,m){d!==m&&(c.flags|=4)};function yh(a,c){if(!It)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function bn(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,m=0;if(c)for(var v=a.child;v!==null;)d|=v.lanes|v.childLanes,m|=v.subtreeFlags&14680064,m|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)d|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=m,a.childLanes=d,c}function _M(a,c,d){var m=c.pendingProps;switch(By(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(c),null;case 1:return Xn(c.type)&&Gf(),bn(c),null;case 3:return m=c.stateNode,dc(),wt(Hn),wt(Rn),t_(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(Xf(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,or!==null&&(k_(or),or=null))),x_(a,c),bn(c),null;case 5:Jy(c);var v=Ra(dh.current);if(d=c.type,a!==null&&c.stateNode!=null)fT(a,c,d,m,v),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!m){if(c.stateNode===null)throw Error(t(166));return bn(c),null}if(a=Ra(Kr.current),Xf(c)){m=c.stateNode,d=c.type;var w=c.memoizedProps;switch(m[$r]=c,m[ah]=w,a=(c.mode&1)!==0,d){case"dialog":xt("cancel",m),xt("close",m);break;case"iframe":case"object":case"embed":xt("load",m);break;case"video":case"audio":for(v=0;v<rh.length;v++)xt(rh[v],m);break;case"source":xt("error",m);break;case"img":case"image":case"link":xt("error",m),xt("load",m);break;case"details":xt("toggle",m);break;case"input":hn(m,w),xt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!w.multiple},xt("invalid",m);break;case"textarea":St(m,w),xt("invalid",m)}On(d,w),v=null;for(var b in w)if(w.hasOwnProperty(b)){var z=w[b];b==="children"?typeof z=="string"?m.textContent!==z&&(w.suppressHydrationWarning!==!0&&zf(m.textContent,z,a),v=["children",z]):typeof z=="number"&&m.textContent!==""+z&&(w.suppressHydrationWarning!==!0&&zf(m.textContent,z,a),v=["children",""+z]):r.hasOwnProperty(b)&&z!=null&&b==="onScroll"&&xt("scroll",m)}switch(d){case"input":er(m),bi(m,w,!0);break;case"textarea":er(m),ki(m);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(m.onclick=Uf)}m=v,c.updateQueue=m,m!==null&&(c.flags|=4)}else{b=v.nodeType===9?v:v.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Rr(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=b.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof m.is=="string"?a=b.createElement(d,{is:m.is}):(a=b.createElement(d),d==="select"&&(b=a,m.multiple?b.multiple=!0:m.size&&(b.size=m.size))):a=b.createElementNS(a,d),a[$r]=c,a[ah]=m,dT(a,c,!1,!1),c.stateNode=a;e:{switch(b=ps(d,m),d){case"dialog":xt("cancel",a),xt("close",a),v=m;break;case"iframe":case"object":case"embed":xt("load",a),v=m;break;case"video":case"audio":for(v=0;v<rh.length;v++)xt(rh[v],a);v=m;break;case"source":xt("error",a),v=m;break;case"img":case"image":case"link":xt("error",a),xt("load",a),v=m;break;case"details":xt("toggle",a),v=m;break;case"input":hn(a,m),v=$n(a,m),xt("invalid",a);break;case"option":v=m;break;case"select":a._wrapperState={wasMultiple:!!m.multiple},v=ne({},m,{value:void 0}),xt("invalid",a);break;case"textarea":St(a,m),v=Pi(a,m),xt("invalid",a);break;default:v=m}On(d,v),z=v;for(w in z)if(z.hasOwnProperty(w)){var G=z[w];w==="style"?gs(a,G):w==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,G!=null&&ca(a,G)):w==="children"?typeof G=="string"?(d!=="textarea"||G!=="")&&br(a,G):typeof G=="number"&&br(a,""+G):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(r.hasOwnProperty(w)?G!=null&&w==="onScroll"&&xt("scroll",a):G!=null&&N(a,w,G,b))}switch(d){case"input":er(a),bi(a,m,!1);break;case"textarea":er(a),ki(a);break;case"option":m.value!=null&&a.setAttribute("value",""+Ve(m.value));break;case"select":a.multiple=!!m.multiple,w=m.value,w!=null?nn(a,!!m.multiple,w,!1):m.defaultValue!=null&&nn(a,!!m.multiple,m.defaultValue,!0);break;default:typeof v.onClick=="function"&&(a.onclick=Uf)}switch(d){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return bn(c),null;case 6:if(a&&c.stateNode!=null)gT(a,c,a.memoizedProps,m);else{if(typeof m!="string"&&c.stateNode===null)throw Error(t(166));if(d=Ra(dh.current),Ra(Kr.current),Xf(c)){if(m=c.stateNode,d=c.memoizedProps,m[$r]=c,(w=m.nodeValue!==d)&&(a=mi,a!==null))switch(a.tag){case 3:zf(m.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&zf(m.nodeValue,d,(a.mode&1)!==0)}w&&(c.flags|=4)}else m=(d.nodeType===9?d:d.ownerDocument).createTextNode(m),m[$r]=c,c.stateNode=m}return bn(c),null;case 13:if(wt(At),m=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(It&&yi!==null&&(c.mode&1)!==0&&(c.flags&128)===0)yE(),lc(),c.flags|=98560,w=!1;else if(w=Xf(c),m!==null&&m.dehydrated!==null){if(a===null){if(!w)throw Error(t(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[$r]=c}else lc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;bn(c),w=!1}else or!==null&&(k_(or),or=null),w=!0;if(!w)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(m=m!==null,m!==(a!==null&&a.memoizedState!==null)&&m&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(At.current&1)!==0?Zt===0&&(Zt=3):M_())),c.updateQueue!==null&&(c.flags|=4),bn(c),null);case 4:return dc(),x_(a,c),a===null&&sh(c.stateNode.containerInfo),bn(c),null;case 10:return Xy(c.type._context),bn(c),null;case 17:return Xn(c.type)&&Gf(),bn(c),null;case 19:if(wt(At),w=c.memoizedState,w===null)return bn(c),null;if(m=(c.flags&128)!==0,b=w.rendering,b===null)if(m)yh(w,!1);else{if(Zt!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(b=eg(a),b!==null){for(c.flags|=128,yh(w,!1),m=b.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),c.subtreeFlags=0,m=d,d=c.child;d!==null;)w=d,a=m,w.flags&=14680066,b=w.alternate,b===null?(w.childLanes=0,w.lanes=a,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=b.childLanes,w.lanes=b.lanes,w.child=b.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=b.memoizedProps,w.memoizedState=b.memoizedState,w.updateQueue=b.updateQueue,w.type=b.type,a=b.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return _t(At,At.current&1|2),c.child}a=a.sibling}w.tail!==null&&vt()>mc&&(c.flags|=128,m=!0,yh(w,!1),c.lanes=4194304)}else{if(!m)if(a=eg(b),a!==null){if(c.flags|=128,m=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),yh(w,!0),w.tail===null&&w.tailMode==="hidden"&&!b.alternate&&!It)return bn(c),null}else 2*vt()-w.renderingStartTime>mc&&d!==1073741824&&(c.flags|=128,m=!0,yh(w,!1),c.lanes=4194304);w.isBackwards?(b.sibling=c.child,c.child=b):(d=w.last,d!==null?d.sibling=b:c.child=b,w.last=b)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=vt(),c.sibling=null,d=At.current,_t(At,m?d&1|2:d&1),c):(bn(c),null);case 22:case 23:return D_(),m=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==m&&(c.flags|=8192),m&&(c.mode&1)!==0?(_i&1073741824)!==0&&(bn(c),c.subtreeFlags&6&&(c.flags|=8192)):bn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function vM(a,c){switch(By(c),c.tag){case 1:return Xn(c.type)&&Gf(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return dc(),wt(Hn),wt(Rn),t_(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return Jy(c),null;case 13:if(wt(At),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));lc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return wt(At),null;case 4:return dc(),null;case 10:return Xy(c.type._context),null;case 22:case 23:return D_(),null;case 24:return null;default:return null}}var cg=!1,Pn=!1,xM=typeof WeakSet=="function"?WeakSet:Set,_e=null;function gc(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(m){Dt(a,c,m)}else d.current=null}function w_(a,c,d){try{d()}catch(m){Dt(a,c,m)}}var pT=!1;function wM(a,c){if(Dy=xs,a=Hw(),Iy(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var v=m.anchorOffset,w=m.focusNode;m=m.focusOffset;try{d.nodeType,w.nodeType}catch{d=null;break e}var b=0,z=-1,G=-1,J=0,oe=0,ce=a,re=null;t:for(;;){for(var ye;ce!==d||v!==0&&ce.nodeType!==3||(z=b+v),ce!==w||m!==0&&ce.nodeType!==3||(G=b+m),ce.nodeType===3&&(b+=ce.nodeValue.length),(ye=ce.firstChild)!==null;)re=ce,ce=ye;for(;;){if(ce===a)break t;if(re===d&&++J===v&&(z=b),re===w&&++oe===m&&(G=b),(ye=ce.nextSibling)!==null)break;ce=re,re=ce.parentNode}ce=ye}d=z===-1||G===-1?null:{start:z,end:G}}else d=null}d=d||{start:0,end:0}}else d=null;for(My={focusedElem:a,selectionRange:d},xs=!1,_e=c;_e!==null;)if(c=_e,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,_e=a;else for(;_e!==null;){c=_e;try{var ve=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var we=ve.memoizedProps,jt=ve.memoizedState,H=c.stateNode,K=H.getSnapshotBeforeUpdate(c.elementType===c.type?we:ar(c.type,we),jt);H.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var Y=c.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Dt(c,c.return,he)}if(a=c.sibling,a!==null){a.return=c.return,_e=a;break}_e=c.return}return ve=pT,pT=!1,ve}function _h(a,c,d){var m=c.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var v=m=m.next;do{if((v.tag&a)===a){var w=v.destroy;v.destroy=void 0,w!==void 0&&w_(c,d,w)}v=v.next}while(v!==m)}}function ug(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var m=d.create;d.destroy=m()}d=d.next}while(d!==c)}}function E_(a){var c=a.ref;if(c!==null){var d=a.stateNode;a.tag,a=d,typeof c=="function"?c(a):c.current=a}}function mT(a){var c=a.alternate;c!==null&&(a.alternate=null,mT(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[$r],delete c[ah],delete c[Vy],delete c[iM],delete c[rM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function yT(a){return a.tag===5||a.tag===3||a.tag===4}function _T(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||yT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function T_(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=Uf));else if(m!==4&&(a=a.child,a!==null))for(T_(a,c,d),a=a.sibling;a!==null;)T_(a,c,d),a=a.sibling}function S_(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(m!==4&&(a=a.child,a!==null))for(S_(a,c,d),a=a.sibling;a!==null;)S_(a,c,d),a=a.sibling}var _n=null,lr=!1;function _o(a,c,d){for(d=d.child;d!==null;)vT(a,c,d),d=d.sibling}function vT(a,c,d){if(ui&&typeof ui.onCommitFiberUnmount=="function")try{ui.onCommitFiberUnmount(fa,d)}catch{}switch(d.tag){case 5:Pn||gc(d,c);case 6:var m=_n,v=lr;_n=null,_o(a,c,d),_n=m,lr=v,_n!==null&&(lr?(a=_n,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):_n.removeChild(d.stateNode));break;case 18:_n!==null&&(lr?(a=_n,d=d.stateNode,a.nodeType===8?Fy(a.parentNode,d):a.nodeType===1&&Fy(a,d),ao(a)):Fy(_n,d.stateNode));break;case 4:m=_n,v=lr,_n=d.stateNode.containerInfo,lr=!0,_o(a,c,d),_n=m,lr=v;break;case 0:case 11:case 14:case 15:if(!Pn&&(m=d.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){v=m=m.next;do{var w=v,b=w.destroy;w=w.tag,b!==void 0&&((w&2)!==0||(w&4)!==0)&&w_(d,c,b),v=v.next}while(v!==m)}_o(a,c,d);break;case 1:if(!Pn&&(gc(d,c),m=d.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=d.memoizedProps,m.state=d.memoizedState,m.componentWillUnmount()}catch(z){Dt(d,c,z)}_o(a,c,d);break;case 21:_o(a,c,d);break;case 22:d.mode&1?(Pn=(m=Pn)||d.memoizedState!==null,_o(a,c,d),Pn=m):_o(a,c,d);break;default:_o(a,c,d)}}function xT(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new xM),c.forEach(function(m){var v=PM.bind(null,a,m);d.has(m)||(d.add(m),m.then(v,v))})}}function cr(a,c){var d=c.deletions;if(d!==null)for(var m=0;m<d.length;m++){var v=d[m];try{var w=a,b=c,z=b;e:for(;z!==null;){switch(z.tag){case 5:_n=z.stateNode,lr=!1;break e;case 3:_n=z.stateNode.containerInfo,lr=!0;break e;case 4:_n=z.stateNode.containerInfo,lr=!0;break e}z=z.return}if(_n===null)throw Error(t(160));vT(w,b,v),_n=null,lr=!1;var G=v.alternate;G!==null&&(G.return=null),v.return=null}catch(J){Dt(v,c,J)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)wT(c,a),c=c.sibling}function wT(a,c){var d=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(cr(c,a),Xr(a),m&4){try{_h(3,a,a.return),ug(3,a)}catch(we){Dt(a,a.return,we)}try{_h(5,a,a.return)}catch(we){Dt(a,a.return,we)}}break;case 1:cr(c,a),Xr(a),m&512&&d!==null&&gc(d,d.return);break;case 5:if(cr(c,a),Xr(a),m&512&&d!==null&&gc(d,d.return),a.flags&32){var v=a.stateNode;try{br(v,"")}catch(we){Dt(a,a.return,we)}}if(m&4&&(v=a.stateNode,v!=null)){var w=a.memoizedProps,b=d!==null?d.memoizedProps:w,z=a.type,G=a.updateQueue;if(a.updateQueue=null,G!==null)try{z==="input"&&w.type==="radio"&&w.name!=null&&dn(v,w),ps(z,b);var J=ps(z,w);for(b=0;b<G.length;b+=2){var oe=G[b],ce=G[b+1];oe==="style"?gs(v,ce):oe==="dangerouslySetInnerHTML"?ca(v,ce):oe==="children"?br(v,ce):N(v,oe,ce,J)}switch(z){case"input":Kn(v,w);break;case"textarea":to(v,w);break;case"select":var re=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!w.multiple;var ye=w.value;ye!=null?nn(v,!!w.multiple,ye,!1):re!==!!w.multiple&&(w.defaultValue!=null?nn(v,!!w.multiple,w.defaultValue,!0):nn(v,!!w.multiple,w.multiple?[]:"",!1))}v[ah]=w}catch(we){Dt(a,a.return,we)}}break;case 6:if(cr(c,a),Xr(a),m&4){if(a.stateNode===null)throw Error(t(162));v=a.stateNode,w=a.memoizedProps;try{v.nodeValue=w}catch(we){Dt(a,a.return,we)}}break;case 3:if(cr(c,a),Xr(a),m&4&&d!==null&&d.memoizedState.isDehydrated)try{ao(c.containerInfo)}catch(we){Dt(a,a.return,we)}break;case 4:cr(c,a),Xr(a);break;case 13:cr(c,a),Xr(a),v=a.child,v.flags&8192&&(w=v.memoizedState!==null,v.stateNode.isHidden=w,!w||v.alternate!==null&&v.alternate.memoizedState!==null||(R_=vt())),m&4&&xT(a);break;case 22:if(oe=d!==null&&d.memoizedState!==null,a.mode&1?(Pn=(J=Pn)||oe,cr(c,a),Pn=J):cr(c,a),Xr(a),m&8192){if(J=a.memoizedState!==null,(a.stateNode.isHidden=J)&&!oe&&(a.mode&1)!==0)for(_e=a,oe=a.child;oe!==null;){for(ce=_e=oe;_e!==null;){switch(re=_e,ye=re.child,re.tag){case 0:case 11:case 14:case 15:_h(4,re,re.return);break;case 1:gc(re,re.return);var ve=re.stateNode;if(typeof ve.componentWillUnmount=="function"){m=re,d=re.return;try{c=m,ve.props=c.memoizedProps,ve.state=c.memoizedState,ve.componentWillUnmount()}catch(we){Dt(m,d,we)}}break;case 5:gc(re,re.return);break;case 22:if(re.memoizedState!==null){ST(ce);continue}}ye!==null?(ye.return=re,_e=ye):ST(ce)}oe=oe.sibling}e:for(oe=null,ce=a;;){if(ce.tag===5){if(oe===null){oe=ce;try{v=ce.stateNode,J?(w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(z=ce.stateNode,G=ce.memoizedProps.style,b=G!=null&&G.hasOwnProperty("display")?G.display:null,z.style.display=Pr("display",b))}catch(we){Dt(a,a.return,we)}}}else if(ce.tag===6){if(oe===null)try{ce.stateNode.nodeValue=J?"":ce.memoizedProps}catch(we){Dt(a,a.return,we)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===a)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===a)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===a)break e;oe===ce&&(oe=null),ce=ce.return}oe===ce&&(oe=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:cr(c,a),Xr(a),m&4&&xT(a);break;case 21:break;default:cr(c,a),Xr(a)}}function Xr(a){var c=a.flags;if(c&2){try{e:{for(var d=a.return;d!==null;){if(yT(d)){var m=d;break e}d=d.return}throw Error(t(160))}switch(m.tag){case 5:var v=m.stateNode;m.flags&32&&(br(v,""),m.flags&=-33);var w=_T(a);S_(a,w,v);break;case 3:case 4:var b=m.stateNode.containerInfo,z=_T(a);T_(a,z,b);break;default:throw Error(t(161))}}catch(G){Dt(a,a.return,G)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function EM(a,c,d){_e=a,ET(a)}function ET(a,c,d){for(var m=(a.mode&1)!==0;_e!==null;){var v=_e,w=v.child;if(v.tag===22&&m){var b=v.memoizedState!==null||cg;if(!b){var z=v.alternate,G=z!==null&&z.memoizedState!==null||Pn;z=cg;var J=Pn;if(cg=b,(Pn=G)&&!J)for(_e=v;_e!==null;)b=_e,G=b.child,b.tag===22&&b.memoizedState!==null?IT(v):G!==null?(G.return=b,_e=G):IT(v);for(;w!==null;)_e=w,ET(w),w=w.sibling;_e=v,cg=z,Pn=J}TT(a)}else(v.subtreeFlags&8772)!==0&&w!==null?(w.return=v,_e=w):TT(a)}}function TT(a){for(;_e!==null;){var c=_e;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Pn||ug(5,c);break;case 1:var m=c.stateNode;if(c.flags&4&&!Pn)if(d===null)m.componentDidMount();else{var v=c.elementType===c.type?d.memoizedProps:ar(c.type,d.memoizedProps);m.componentDidUpdate(v,d.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var w=c.updateQueue;w!==null&&SE(c,w,m);break;case 3:var b=c.updateQueue;if(b!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}SE(c,b,d)}break;case 5:var z=c.stateNode;if(d===null&&c.flags&4){d=z;var G=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":G.autoFocus&&d.focus();break;case"img":G.src&&(d.src=G.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var J=c.alternate;if(J!==null){var oe=J.memoizedState;if(oe!==null){var ce=oe.dehydrated;ce!==null&&ao(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Pn||c.flags&512&&E_(c)}catch(re){Dt(c,c.return,re)}}if(c===a){_e=null;break}if(d=c.sibling,d!==null){d.return=c.return,_e=d;break}_e=c.return}}function ST(a){for(;_e!==null;){var c=_e;if(c===a){_e=null;break}var d=c.sibling;if(d!==null){d.return=c.return,_e=d;break}_e=c.return}}function IT(a){for(;_e!==null;){var c=_e;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{ug(4,c)}catch(G){Dt(c,d,G)}break;case 1:var m=c.stateNode;if(typeof m.componentDidMount=="function"){var v=c.return;try{m.componentDidMount()}catch(G){Dt(c,v,G)}}var w=c.return;try{E_(c)}catch(G){Dt(c,w,G)}break;case 5:var b=c.return;try{E_(c)}catch(G){Dt(c,b,G)}}}catch(G){Dt(c,c.return,G)}if(c===a){_e=null;break}var z=c.sibling;if(z!==null){z.return=c.return,_e=z;break}_e=c.return}}var TM=Math.ceil,hg=M.ReactCurrentDispatcher,I_=M.ReactCurrentOwner,Ui=M.ReactCurrentBatchConfig,Je=0,on=null,$t=null,vn=0,_i=0,pc=fo(0),Zt=0,vh=null,ba=0,dg=0,C_=0,xh=null,Yn=null,R_=0,mc=1/0,Ps=null,fg=!1,A_=null,vo=null,gg=!1,xo=null,pg=0,wh=0,b_=null,mg=-1,yg=0;function zn(){return(Je&6)!==0?vt():mg!==-1?mg:mg=vt()}function wo(a){return(a.mode&1)===0?1:(Je&2)!==0&&vn!==0?vn&-vn:oM.transition!==null?(yg===0&&(yg=Bu()),yg):(a=Xe,a!==0||(a=window.event,a=a===void 0?16:$l(a.type)),a)}function ur(a,c,d,m){if(50<wh)throw wh=0,b_=null,Error(t(185));ya(a,d,m),((Je&2)===0||a!==on)&&(a===on&&((Je&2)===0&&(dg|=d),Zt===4&&Eo(a,vn)),Zn(a,m),d===1&&Je===0&&(c.mode&1)===0&&(mc=vt()+500,$f&&po()))}function Zn(a,c){var d=a.callbackNode;ma(a,c);var m=ys(a,a===on?vn:0);if(m===0)d!==null&&Vl(d),a.callbackNode=null,a.callbackPriority=0;else if(c=m&-m,a.callbackPriority!==c){if(d!=null&&Vl(d),c===1)a.tag===0?sM(RT.bind(null,a)):dE(RT.bind(null,a)),tM(function(){(Je&6)===0&&po()}),d=null;else{switch(Lr(m)){case 1:d=jl;break;case 4:d=ju;break;case 16:d=da;break;case 536870912:d=zl;break;default:d=da}d=LT(d,CT.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function CT(a,c){if(mg=-1,yg=0,(Je&6)!==0)throw Error(t(327));var d=a.callbackNode;if(yc()&&a.callbackNode!==d)return null;var m=ys(a,a===on?vn:0);if(m===0)return null;if((m&30)!==0||(m&a.expiredLanes)!==0||c)c=_g(a,m);else{c=m;var v=Je;Je|=2;var w=bT();(on!==a||vn!==c)&&(Ps=null,mc=vt()+500,ka(a,c));do try{CM();break}catch(z){AT(a,z)}while(!0);Hy(),hg.current=w,Je=v,$t!==null?c=0:(on=null,vn=0,c=Zt)}if(c!==0){if(c===2&&(v=Uu(a),v!==0&&(m=v,c=P_(a,v))),c===1)throw d=vh,ka(a,0),Eo(a,m),Zn(a,vt()),d;if(c===6)Eo(a,m);else{if(v=a.current.alternate,(m&30)===0&&!SM(v)&&(c=_g(a,m),c===2&&(w=Uu(a),w!==0&&(m=w,c=P_(a,w))),c===1))throw d=vh,ka(a,0),Eo(a,m),Zn(a,vt()),d;switch(a.finishedWork=v,a.finishedLanes=m,c){case 0:case 1:throw Error(t(345));case 2:Na(a,Yn,Ps);break;case 3:if(Eo(a,m),(m&130023424)===m&&(c=R_+500-vt(),10<c)){if(ys(a,0)!==0)break;if(v=a.suspendedLanes,(v&m)!==m){zn(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=Oy(Na.bind(null,a,Yn,Ps),c);break}Na(a,Yn,Ps);break;case 4:if(Eo(a,m),(m&4194240)===m)break;for(c=a.eventTimes,v=-1;0<m;){var b=31-hi(m);w=1<<b,b=c[b],b>v&&(v=b),m&=~w}if(m=v,m=vt()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*TM(m/1960))-m,10<m){a.timeoutHandle=Oy(Na.bind(null,a,Yn,Ps),m);break}Na(a,Yn,Ps);break;case 5:Na(a,Yn,Ps);break;default:throw Error(t(329))}}}return Zn(a,vt()),a.callbackNode===d?CT.bind(null,a):null}function P_(a,c){var d=xh;return a.current.memoizedState.isDehydrated&&(ka(a,c).flags|=256),a=_g(a,c),a!==2&&(c=Yn,Yn=d,c!==null&&k_(c)),a}function k_(a){Yn===null?Yn=a:Yn.push.apply(Yn,a)}function SM(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var m=0;m<d.length;m++){var v=d[m],w=v.getSnapshot;v=v.value;try{if(!sr(w(),v))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Eo(a,c){for(c&=~C_,c&=~dg,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-hi(c),m=1<<d;a[d]=-1,c&=~m}}function RT(a){if((Je&6)!==0)throw Error(t(327));yc();var c=ys(a,0);if((c&1)===0)return Zn(a,vt()),null;var d=_g(a,c);if(a.tag!==0&&d===2){var m=Uu(a);m!==0&&(c=m,d=P_(a,m))}if(d===1)throw d=vh,ka(a,0),Eo(a,c),Zn(a,vt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Na(a,Yn,Ps),Zn(a,vt()),null}function N_(a,c){var d=Je;Je|=1;try{return a(c)}finally{Je=d,Je===0&&(mc=vt()+500,$f&&po())}}function Pa(a){xo!==null&&xo.tag===0&&(Je&6)===0&&yc();var c=Je;Je|=1;var d=Ui.transition,m=Xe;try{if(Ui.transition=null,Xe=1,a)return a()}finally{Xe=m,Ui.transition=d,Je=c,(Je&6)===0&&po()}}function D_(){_i=pc.current,wt(pc)}function ka(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,eM(d)),$t!==null)for(d=$t.return;d!==null;){var m=d;switch(By(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Gf();break;case 3:dc(),wt(Hn),wt(Rn),t_();break;case 5:Jy(m);break;case 4:dc();break;case 13:wt(At);break;case 19:wt(At);break;case 10:Xy(m.type._context);break;case 22:case 23:D_()}d=d.return}if(on=a,$t=a=To(a.current,null),vn=_i=c,Zt=0,vh=null,C_=dg=ba=0,Yn=xh=null,Ca!==null){for(c=0;c<Ca.length;c++)if(d=Ca[c],m=d.interleaved,m!==null){d.interleaved=null;var v=m.next,w=d.pending;if(w!==null){var b=w.next;w.next=v,m.next=b}d.pending=m}Ca=null}return a}function AT(a,c){do{var d=$t;try{if(Hy(),tg.current=sg,ng){for(var m=bt.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}ng=!1}if(Aa=0,sn=Yt=bt=null,fh=!1,gh=0,I_.current=null,d===null||d.return===null){Zt=1,vh=c,$t=null;break}e:{var w=a,b=d.return,z=d,G=c;if(c=vn,z.flags|=32768,G!==null&&typeof G=="object"&&typeof G.then=="function"){var J=G,oe=z,ce=oe.tag;if((oe.mode&1)===0&&(ce===0||ce===11||ce===15)){var re=oe.alternate;re?(oe.updateQueue=re.updateQueue,oe.memoizedState=re.memoizedState,oe.lanes=re.lanes):(oe.updateQueue=null,oe.memoizedState=null)}var ye=JE(b);if(ye!==null){ye.flags&=-257,eT(ye,b,z,w,c),ye.mode&1&&QE(w,J,c),c=ye,G=J;var ve=c.updateQueue;if(ve===null){var we=new Set;we.add(G),c.updateQueue=we}else ve.add(G);break e}else{if((c&1)===0){QE(w,J,c),M_();break e}G=Error(t(426))}}else if(It&&z.mode&1){var jt=JE(b);if(jt!==null){(jt.flags&65536)===0&&(jt.flags|=256),eT(jt,b,z,w,c),$y(fc(G,z));break e}}w=G=fc(G,z),Zt!==4&&(Zt=2),xh===null?xh=[w]:xh.push(w),w=b;do{switch(w.tag){case 3:w.flags|=65536,c&=-c,w.lanes|=c;var H=YE(w,G,c);TE(w,H);break e;case 1:z=G;var K=w.type,Y=w.stateNode;if((w.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(vo===null||!vo.has(Y)))){w.flags|=65536,c&=-c,w.lanes|=c;var he=ZE(w,z,c);TE(w,he);break e}}w=w.return}while(w!==null)}kT(d)}catch(Te){c=Te,$t===d&&d!==null&&($t=d=d.return);continue}break}while(!0)}function bT(){var a=hg.current;return hg.current=sg,a===null?sg:a}function M_(){(Zt===0||Zt===3||Zt===2)&&(Zt=4),on===null||(ba&268435455)===0&&(dg&268435455)===0||Eo(on,vn)}function _g(a,c){var d=Je;Je|=2;var m=bT();(on!==a||vn!==c)&&(Ps=null,ka(a,c));do try{IM();break}catch(v){AT(a,v)}while(!0);if(Hy(),Je=d,hg.current=m,$t!==null)throw Error(t(261));return on=null,vn=0,Zt}function IM(){for(;$t!==null;)PT($t)}function CM(){for(;$t!==null&&!ha();)PT($t)}function PT(a){var c=MT(a.alternate,a,_i);a.memoizedProps=a.pendingProps,c===null?kT(a):$t=c,I_.current=null}function kT(a){var c=a;do{var d=c.alternate;if(a=c.return,(c.flags&32768)===0){if(d=_M(d,c,_i),d!==null){$t=d;return}}else{if(d=vM(d,c),d!==null){d.flags&=32767,$t=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Zt=6,$t=null;return}}if(c=c.sibling,c!==null){$t=c;return}$t=c=a}while(c!==null);Zt===0&&(Zt=5)}function Na(a,c,d){var m=Xe,v=Ui.transition;try{Ui.transition=null,Xe=1,RM(a,c,d,m)}finally{Ui.transition=v,Xe=m}return null}function RM(a,c,d,m){do yc();while(xo!==null);if((Je&6)!==0)throw Error(t(327));d=a.finishedWork;var v=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var w=d.lanes|d.childLanes;if(xy(a,w),a===on&&($t=on=null,vn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||gg||(gg=!0,LT(da,function(){return yc(),null})),w=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||w){w=Ui.transition,Ui.transition=null;var b=Xe;Xe=1;var z=Je;Je|=4,I_.current=null,wM(a,d),wT(d,a),HD(My),xs=!!Dy,My=Dy=null,a.current=d,EM(d),ms(),Je=z,Xe=b,Ui.transition=w}else a.current=d;if(gg&&(gg=!1,xo=a,pg=v),w=a.pendingLanes,w===0&&(vo=null),If(d.stateNode),Zn(a,vt()),c!==null)for(m=a.onRecoverableError,d=0;d<c.length;d++)v=c[d],m(v.value,{componentStack:v.stack,digest:v.digest});if(fg)throw fg=!1,a=A_,A_=null,a;return(pg&1)!==0&&a.tag!==0&&yc(),w=a.pendingLanes,(w&1)!==0?a===b_?wh++:(wh=0,b_=a):wh=0,po(),null}function yc(){if(xo!==null){var a=Lr(pg),c=Ui.transition,d=Xe;try{if(Ui.transition=null,Xe=16>a?16:a,xo===null)var m=!1;else{if(a=xo,xo=null,pg=0,(Je&6)!==0)throw Error(t(331));var v=Je;for(Je|=4,_e=a.current;_e!==null;){var w=_e,b=w.child;if((_e.flags&16)!==0){var z=w.deletions;if(z!==null){for(var G=0;G<z.length;G++){var J=z[G];for(_e=J;_e!==null;){var oe=_e;switch(oe.tag){case 0:case 11:case 15:_h(8,oe,w)}var ce=oe.child;if(ce!==null)ce.return=oe,_e=ce;else for(;_e!==null;){oe=_e;var re=oe.sibling,ye=oe.return;if(mT(oe),oe===J){_e=null;break}if(re!==null){re.return=ye,_e=re;break}_e=ye}}}var ve=w.alternate;if(ve!==null){var we=ve.child;if(we!==null){ve.child=null;do{var jt=we.sibling;we.sibling=null,we=jt}while(we!==null)}}_e=w}}if((w.subtreeFlags&2064)!==0&&b!==null)b.return=w,_e=b;else e:for(;_e!==null;){if(w=_e,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:_h(9,w,w.return)}var H=w.sibling;if(H!==null){H.return=w.return,_e=H;break e}_e=w.return}}var K=a.current;for(_e=K;_e!==null;){b=_e;var Y=b.child;if((b.subtreeFlags&2064)!==0&&Y!==null)Y.return=b,_e=Y;else e:for(b=K;_e!==null;){if(z=_e,(z.flags&2048)!==0)try{switch(z.tag){case 0:case 11:case 15:ug(9,z)}}catch(Te){Dt(z,z.return,Te)}if(z===b){_e=null;break e}var he=z.sibling;if(he!==null){he.return=z.return,_e=he;break e}_e=z.return}}if(Je=v,po(),ui&&typeof ui.onPostCommitFiberRoot=="function")try{ui.onPostCommitFiberRoot(fa,a)}catch{}m=!0}return m}finally{Xe=d,Ui.transition=c}}return!1}function NT(a,c,d){c=fc(d,c),c=YE(a,c,1),a=yo(a,c,1),c=zn(),a!==null&&(ya(a,1,c),Zn(a,c))}function Dt(a,c,d){if(a.tag===3)NT(a,a,d);else for(;c!==null;){if(c.tag===3){NT(c,a,d);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(vo===null||!vo.has(m))){a=fc(d,a),a=ZE(c,a,1),c=yo(c,a,1),a=zn(),c!==null&&(ya(c,1,a),Zn(c,a));break}}c=c.return}}function AM(a,c,d){var m=a.pingCache;m!==null&&m.delete(c),c=zn(),a.pingedLanes|=a.suspendedLanes&d,on===a&&(vn&d)===d&&(Zt===4||Zt===3&&(vn&130023424)===vn&&500>vt()-R_?ka(a,0):C_|=d),Zn(a,c)}function DT(a,c){c===0&&((a.mode&1)===0?c=1:(c=ro,ro<<=1,(ro&130023424)===0&&(ro=4194304)));var d=zn();a=Rs(a,c),a!==null&&(ya(a,c,d),Zn(a,d))}function bM(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),DT(a,d)}function PM(a,c){var d=0;switch(a.tag){case 13:var m=a.stateNode,v=a.memoizedState;v!==null&&(d=v.retryLane);break;case 19:m=a.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(c),DT(a,d)}var MT;MT=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Hn.current)qn=!0;else{if((a.lanes&d)===0&&(c.flags&128)===0)return qn=!1,yM(a,c,d);qn=(a.flags&131072)!==0}else qn=!1,It&&(c.flags&1048576)!==0&&fE(c,Hf,c.index);switch(c.lanes=0,c.tag){case 2:var m=c.type;lg(a,c),a=c.pendingProps;var v=sc(c,Rn.current);hc(c,d),v=r_(null,c,m,a,v,d);var w=s_();return c.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Xn(m)?(w=!0,Wf(c)):w=!1,c.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Zy(c),v.updater=og,c.stateNode=v,v._reactInternals=c,h_(c,m,a,d),c=p_(null,c,m,!0,w,d)):(c.tag=0,It&&w&&Uy(c),jn(null,c,v,d),c=c.child),c;case 16:m=c.elementType;e:{switch(lg(a,c),a=c.pendingProps,v=m._init,m=v(m._payload),c.type=m,v=c.tag=NM(m),a=ar(m,a),v){case 0:c=g_(null,c,m,a,d);break e;case 1:c=oT(null,c,m,a,d);break e;case 11:c=tT(null,c,m,a,d);break e;case 14:c=nT(null,c,m,ar(m.type,a),d);break e}throw Error(t(306,m,""))}return c;case 0:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),g_(a,c,m,v,d);case 1:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),oT(a,c,m,v,d);case 3:e:{if(aT(c),a===null)throw Error(t(387));m=c.pendingProps,w=c.memoizedState,v=w.element,EE(a,c),Jf(c,m,null,d);var b=c.memoizedState;if(m=b.element,w.isDehydrated)if(w={element:m,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},c.updateQueue.baseState=w,c.memoizedState=w,c.flags&256){v=fc(Error(t(423)),c),c=lT(a,c,m,d,v);break e}else if(m!==v){v=fc(Error(t(424)),c),c=lT(a,c,m,d,v);break e}else for(yi=ho(c.stateNode.containerInfo.firstChild),mi=c,It=!0,or=null,d=xE(c,null,m,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(lc(),m===v){c=bs(a,c,d);break e}jn(a,c,m,d)}c=c.child}return c;case 5:return IE(c),a===null&&Wy(c),m=c.type,v=c.pendingProps,w=a!==null?a.memoizedProps:null,b=v.children,Ly(m,v)?b=null:w!==null&&Ly(m,w)&&(c.flags|=32),sT(a,c),jn(a,c,b,d),c.child;case 6:return a===null&&Wy(c),null;case 13:return cT(a,c,d);case 4:return Qy(c,c.stateNode.containerInfo),m=c.pendingProps,a===null?c.child=cc(c,null,m,d):jn(a,c,m,d),c.child;case 11:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),tT(a,c,m,v,d);case 7:return jn(a,c,c.pendingProps,d),c.child;case 8:return jn(a,c,c.pendingProps.children,d),c.child;case 12:return jn(a,c,c.pendingProps.children,d),c.child;case 10:e:{if(m=c.type._context,v=c.pendingProps,w=c.memoizedProps,b=v.value,_t(Yf,m._currentValue),m._currentValue=b,w!==null)if(sr(w.value,b)){if(w.children===v.children&&!Hn.current){c=bs(a,c,d);break e}}else for(w=c.child,w!==null&&(w.return=c);w!==null;){var z=w.dependencies;if(z!==null){b=w.child;for(var G=z.firstContext;G!==null;){if(G.context===m){if(w.tag===1){G=As(-1,d&-d),G.tag=2;var J=w.updateQueue;if(J!==null){J=J.shared;var oe=J.pending;oe===null?G.next=G:(G.next=oe.next,oe.next=G),J.pending=G}}w.lanes|=d,G=w.alternate,G!==null&&(G.lanes|=d),qy(w.return,d,c),z.lanes|=d;break}G=G.next}}else if(w.tag===10)b=w.type===c.type?null:w.child;else if(w.tag===18){if(b=w.return,b===null)throw Error(t(341));b.lanes|=d,z=b.alternate,z!==null&&(z.lanes|=d),qy(b,d,c),b=w.sibling}else b=w.child;if(b!==null)b.return=w;else for(b=w;b!==null;){if(b===c){b=null;break}if(w=b.sibling,w!==null){w.return=b.return,b=w;break}b=b.return}w=b}jn(a,c,v.children,d),c=c.child}return c;case 9:return v=c.type,m=c.pendingProps.children,hc(c,d),v=ji(v),m=m(v),c.flags|=1,jn(a,c,m,d),c.child;case 14:return m=c.type,v=ar(m,c.pendingProps),v=ar(m.type,v),nT(a,c,m,v,d);case 15:return iT(a,c,c.type,c.pendingProps,d);case 17:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:ar(m,v),lg(a,c),c.tag=1,Xn(m)?(a=!0,Wf(c)):a=!1,hc(c,d),XE(c,m,v),h_(c,m,v,d),p_(null,c,m,!0,a,d);case 19:return hT(a,c,d);case 22:return rT(a,c,d)}throw Error(t(156,c.tag))};function LT(a,c){return Vu(a,c)}function kM(a,c,d,m){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bi(a,c,d,m){return new kM(a,c,d,m)}function L_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function NM(a){if(typeof a=="function")return L_(a)?1:0;if(a!=null){if(a=a.$$typeof,a===B)return 11;if(a===pe)return 14}return 2}function To(a,c){var d=a.alternate;return d===null?(d=Bi(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function vg(a,c,d,m,v,w){var b=2;if(m=a,typeof a=="function")L_(a)&&(b=1);else if(typeof a=="string")b=5;else e:switch(a){case P:return Da(d.children,v,w,c);case A:b=8,v|=8;break;case D:return a=Bi(12,d,c,v|2),a.elementType=D,a.lanes=w,a;case L:return a=Bi(13,d,c,v),a.elementType=L,a.lanes=w,a;case le:return a=Bi(19,d,c,v),a.elementType=le,a.lanes=w,a;case ue:return xg(d,v,w,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case V:b=10;break e;case j:b=9;break e;case B:b=11;break e;case pe:b=14;break e;case ge:b=16,m=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=Bi(b,d,c,v),c.elementType=a,c.type=m,c.lanes=w,c}function Da(a,c,d,m){return a=Bi(7,a,m,c),a.lanes=d,a}function xg(a,c,d,m){return a=Bi(22,a,m,c),a.elementType=ue,a.lanes=d,a.stateNode={isHidden:!1},a}function O_(a,c,d){return a=Bi(6,a,null,c),a.lanes=d,a}function F_(a,c,d){return c=Bi(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function DM(a,c,d,m,v){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gu(0),this.expirationTimes=Gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gu(0),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function V_(a,c,d,m,v,w,b,z,G){return a=new DM(a,c,d,z,G),c===1?(c=1,w===!0&&(c|=8)):c=0,w=Bi(3,null,null,c),a.current=w,w.stateNode=a,w.memoizedState={element:m,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zy(w),a}function MM(a,c,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:m==null?null:""+m,children:a,containerInfo:c,implementation:d}}function OT(a){if(!a)return go;a=a._reactInternals;e:{if(ir(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Xn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(Xn(d))return uE(a,d,c)}return c}function FT(a,c,d,m,v,w,b,z,G){return a=V_(d,m,!0,a,v,w,b,z,G),a.context=OT(null),d=a.current,m=zn(),v=wo(d),w=As(m,v),w.callback=c??null,yo(d,w,v),a.current.lanes=v,ya(a,v,m),Zn(a,m),a}function wg(a,c,d,m){var v=c.current,w=zn(),b=wo(v);return d=OT(d),c.context===null?c.context=d:c.pendingContext=d,c=As(w,b),c.payload={element:a},m=m===void 0?null:m,m!==null&&(c.callback=m),a=yo(v,c,b),a!==null&&(ur(a,v,b,w),Qf(a,v,b)),b}function Eg(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function VT(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function j_(a,c){VT(a,c),(a=a.alternate)&&VT(a,c)}function LM(){return null}var jT=typeof reportError=="function"?reportError:function(a){console.error(a)};function z_(a){this._internalRoot=a}Tg.prototype.render=z_.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));wg(a,c,null,null)},Tg.prototype.unmount=z_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;Pa(function(){wg(null,a,null,null)}),c[Ts]=null}};function Tg(a){this._internalRoot=a}Tg.prototype.unstable_scheduleHydration=function(a){if(a){var c=Hu();a={blockedOn:null,target:a,priority:c};for(var d=0;d<di.length&&c!==0&&c<di[d].priority;d++);di.splice(d,0,a),d===0&&Gl(a)}};function U_(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Sg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function zT(){}function OM(a,c,d,m,v){if(v){if(typeof m=="function"){var w=m;m=function(){var J=Eg(b);w.call(J)}}var b=FT(c,m,a,0,null,!1,!1,"",zT);return a._reactRootContainer=b,a[Ts]=b.current,sh(a.nodeType===8?a.parentNode:a),Pa(),b}for(;v=a.lastChild;)a.removeChild(v);if(typeof m=="function"){var z=m;m=function(){var J=Eg(G);z.call(J)}}var G=V_(a,0,!1,null,null,!1,!1,"",zT);return a._reactRootContainer=G,a[Ts]=G.current,sh(a.nodeType===8?a.parentNode:a),Pa(function(){wg(c,G,d,m)}),G}function Ig(a,c,d,m,v){var w=d._reactRootContainer;if(w){var b=w;if(typeof v=="function"){var z=v;v=function(){var G=Eg(b);z.call(G)}}wg(c,b,a,v)}else b=OM(d,c,a,v,m);return Eg(b)}$u=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=st(c.pendingLanes);d!==0&&(Wu(c,d|1),Zn(c,vt()),(Je&6)===0&&(mc=vt()+500,po()))}break;case 13:Pa(function(){var m=Rs(a,1);if(m!==null){var v=zn();ur(m,a,1,v)}}),j_(a,1)}},Ul=function(a){if(a.tag===13){var c=Rs(a,134217728);if(c!==null){var d=zn();ur(c,a,134217728,d)}j_(a,134217728)}},Ku=function(a){if(a.tag===13){var c=wo(a),d=Rs(a,c);if(d!==null){var m=zn();ur(d,a,c,m)}j_(a,c)}},Hu=function(){return Xe},Xu=function(a,c){var d=Xe;try{return Xe=a,c()}finally{Xe=d}},Fn=function(a,c,d){switch(c){case"input":if(Kn(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var m=d[c];if(m!==a&&m.form===a.form){var v=Bf(m);if(!v)throw Error(t(90));fs(m),Kn(m,v)}}}break;case"textarea":to(a,d);break;case"select":c=d.value,c!=null&&nn(a,!!d.multiple,c,!1)}},Di=N_,fn=Pa;var FM={usingClientEntryPoint:!1,Events:[lh,ic,Bf,nr,Ot,N_]},Eh={findFiberByHostInstance:Ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},VM={bundleType:Eh.bundleType,version:Eh.version,rendererPackageName:Eh.rendererPackageName,rendererConfig:Eh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Sf(a),a===null?null:a.stateNode},findFiberByHostInstance:Eh.findFiberByHostInstance||LM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cg.isDisabled&&Cg.supportsFiber)try{fa=Cg.inject(VM),ui=Cg}catch{}}return Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FM,Qn.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!U_(c))throw Error(t(200));return MM(a,c,null,d)},Qn.createRoot=function(a,c){if(!U_(a))throw Error(t(299));var d=!1,m="",v=jT;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onRecoverableError!==void 0&&(v=c.onRecoverableError)),c=V_(a,1,!1,null,null,d,!1,m,v),a[Ts]=c.current,sh(a.nodeType===8?a.parentNode:a),new z_(c)},Qn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Sf(c),a=a===null?null:a.stateNode,a},Qn.flushSync=function(a){return Pa(a)},Qn.hydrate=function(a,c,d){if(!Sg(c))throw Error(t(200));return Ig(null,a,c,!0,d)},Qn.hydrateRoot=function(a,c,d){if(!U_(a))throw Error(t(405));var m=d!=null&&d.hydratedSources||null,v=!1,w="",b=jT;if(d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(b=d.onRecoverableError)),c=FT(c,null,a,1,d??null,v,!1,w,b),a[Ts]=c.current,sh(a),m)for(a=0;a<m.length;a++)d=m[a],v=d._getVersion,v=v(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,v]:c.mutableSourceEagerHydrationData.push(d,v);return new Tg(c)},Qn.render=function(a,c,d){if(!Sg(c))throw Error(t(200));return Ig(null,a,c,!1,d)},Qn.unmountComponentAtNode=function(a){if(!Sg(a))throw Error(t(40));return a._reactRootContainer?(Pa(function(){Ig(null,null,a,!1,function(){a._reactRootContainer=null,a[Ts]=null})}),!0):!1},Qn.unstable_batchedUpdates=N_,Qn.unstable_renderSubtreeIntoContainer=function(a,c,d,m){if(!Sg(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Ig(a,c,d,!1,m)},Qn.version="18.3.1-next-f1338f8080-20240426",Qn}var XT;function KM(){if(XT)return W_.exports;XT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),W_.exports=$M(),W_.exports}var qT;function HM(){if(qT)return Rg;qT=1;var n=KM();return Rg.createRoot=n.createRoot,Rg.hydrateRoot=n.hydrateRoot,Rg}var XM=HM();const qM=Ex(XM);var q=Hd();const YM=Ex(q),Tx=q.createContext({});function Sx(n){const e=q.useRef(null);return e.current===null&&(e.current=n()),e.current}const xm=q.createContext(null),Ix=q.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class ZM extends q.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function QM({children:n,isPresent:e}){const t=q.useId(),i=q.useRef(null),r=q.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=q.useContext(Ix);return q.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),_.jsx(ZM,{isPresent:e,childRef:i,sizeRef:r,children:q.cloneElement(n,{ref:i})})}const JM=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=Sx(eL),u=q.useId(),h=q.useCallback(p=>{l.set(p,!0);for(const y of l.values())if(!y)return;i&&i()},[l,i]),f=q.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:p=>(l.set(p,!1),()=>l.delete(p))}),s?[Math.random(),h]:[t,h]);return q.useMemo(()=>{l.forEach((p,y)=>l.set(y,!1))},[t]),q.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=_.jsx(QM,{isPresent:t,children:n})),_.jsx(xm.Provider,{value:f,children:n})};function eL(){return new Map}function DA(n=!0){const e=q.useContext(xm);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=q.useId();q.useEffect(()=>{n&&r(s)},[n]);const o=q.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Ag=n=>n.key||"";function YT(n){const e=[];return q.Children.forEach(n,t=>{q.isValidElement(t)&&e.push(t)}),e}const Cx=typeof window<"u",MA=Cx?q.useLayoutEffect:q.useEffect,Ii=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,u]=DA(o),h=q.useMemo(()=>YT(n),[n]),f=o&&!l?[]:h.map(Ag),p=q.useRef(!0),y=q.useRef(h),x=Sx(()=>new Map),[S,I]=q.useState(h),[T,R]=q.useState(h);MA(()=>{p.current=!1,y.current=h;for(let M=0;M<T.length;M++){const F=Ag(T[M]);f.includes(F)?x.delete(F):x.get(F)!==!0&&x.set(F,!1)}},[T,f.length,f.join("-")]);const k=[];if(h!==S){let M=[...h];for(let F=0;F<T.length;F++){const U=T[F],P=Ag(U);f.includes(P)||(M.splice(F,0,U),k.push(U))}s==="wait"&&k.length&&(M=k),R(YT(M)),I(h);return}const{forceRender:N}=q.useContext(Tx);return _.jsx(_.Fragment,{children:T.map(M=>{const F=Ag(M),U=o&&!l?!1:h===T||f.includes(F),P=()=>{if(x.has(F))x.set(F,!0);else return;let A=!0;x.forEach(D=>{D||(A=!1)}),A&&(N?.(),R(y.current),o&&u?.(),i&&i())};return _.jsx(JM,{isPresent:U,initial:!p.current||t?void 0:!1,custom:U?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:U?void 0:P,children:M},F)})})},Si=n=>n;let LA=Si;function Rx(n){let e;return()=>(e===void 0&&(e=n()),e)}const tu=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},zs=n=>n*1e3,Us=n=>n/1e3,tL={useManualTiming:!1};function nL(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,f=!1,p=!1)=>{const x=p&&i?e:t;return f&&s.add(h),x.has(h)||x.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const bg=["read","resolveKeyframes","update","preRender","render","postRender"],iL=40;function OA(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=bg.reduce((R,k)=>(R[k]=nL(s),R),{}),{read:l,resolveKeyframes:u,update:h,preRender:f,render:p,postRender:y}=o,x=()=>{const R=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(R-r.timestamp,iL),1),r.timestamp=R,r.isProcessing=!0,l.process(r),u.process(r),h.process(r),f.process(r),p.process(r),y.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(x))},S=()=>{t=!0,i=!0,r.isProcessing||n(x)};return{schedule:bg.reduce((R,k)=>{const N=o[k];return R[k]=(M,F=!1,U=!1)=>(t||S(),N.schedule(M,F,U)),R},{}),cancel:R=>{for(let k=0;k<bg.length;k++)o[bg[k]].cancel(R)},state:r,steps:o}}const{schedule:Et,cancel:Jo,state:xn,steps:H_}=OA(typeof requestAnimationFrame<"u"?requestAnimationFrame:Si,!0),FA=q.createContext({strict:!1}),ZT={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},nu={};for(const n in ZT)nu[n]={isEnabled:e=>ZT[n].some(t=>!!e[t])};function rL(n){for(const e in n)nu[e]={...nu[e],...n[e]}}const sL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ep(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||sL.has(n)}let VA=n=>!Ep(n);function oL(n){n&&(VA=e=>e.startsWith("on")?!Ep(e):n(e))}try{oL(require("@emotion/is-prop-valid").default)}catch{}function aL(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(VA(r)||t===!0&&Ep(r)||!e&&!Ep(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function lL(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const wm=q.createContext({});function gd(n){return typeof n=="string"||Array.isArray(n)}function Em(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const Ax=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],bx=["initial",...Ax];function Tm(n){return Em(n.animate)||bx.some(e=>gd(n[e]))}function jA(n){return!!(Tm(n)||n.variants)}function cL(n,e){if(Tm(n)){const{initial:t,animate:i}=n;return{initial:t===!1||gd(t)?t:void 0,animate:gd(i)?i:void 0}}return n.inherit!==!1?e:{}}function uL(n){const{initial:e,animate:t}=cL(n,q.useContext(wm));return q.useMemo(()=>({initial:e,animate:t}),[QT(e),QT(t)])}function QT(n){return Array.isArray(n)?n.join(" "):n}const hL=Symbol.for("motionComponentSymbol");function jc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function dL(n,e,t){return q.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):jc(t)&&(t.current=i))},[e])}const Px=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),fL="framerAppearId",zA="data-"+Px(fL),{schedule:kx}=OA(queueMicrotask,!1),UA=q.createContext({});function gL(n,e,t,i,r){var s,o;const{visualElement:l}=q.useContext(wm),u=q.useContext(FA),h=q.useContext(xm),f=q.useContext(Ix).reducedMotion,p=q.useRef(null);i=i||u.renderer,!p.current&&i&&(p.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const y=p.current,x=q.useContext(UA);y&&!y.projection&&r&&(y.type==="html"||y.type==="svg")&&pL(p.current,t,r,x);const S=q.useRef(!1);q.useInsertionEffect(()=>{y&&S.current&&y.update(t,h)});const I=t[zA],T=q.useRef(!!I&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,I))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,I)));return MA(()=>{y&&(S.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),kx.render(y.render),T.current&&y.animationState&&y.animationState.animateChanges())}),q.useEffect(()=>{y&&(!T.current&&y.animationState&&y.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{var R;(R=window.MotionHandoffMarkAsComplete)===null||R===void 0||R.call(window,I)}),T.current=!1))}),y}function pL(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:BA(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&jc(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function BA(n){if(n)return n.options.allowProjection!==!1?n.projection:BA(n.parent)}function mL({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&rL(n);function l(h,f){let p;const y={...q.useContext(Ix),...h,layoutId:yL(h)},{isStatic:x}=y,S=uL(h),I=i(h,x);if(!x&&Cx){_L();const T=vL(y);p=T.MeasureLayout,S.visualElement=gL(r,I,y,e,T.ProjectionNode)}return _.jsxs(wm.Provider,{value:S,children:[p&&S.visualElement?_.jsx(p,{visualElement:S.visualElement,...y}):null,t(r,h,dL(I,S.visualElement,f),I,x,S.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=q.forwardRef(l);return u[hL]=r,u}function yL({layoutId:n}){const e=q.useContext(Tx).id;return e&&n!==void 0?e+"-"+n:n}function _L(n,e){q.useContext(FA).strict}function vL(n){const{drag:e,layout:t}=nu;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const xL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Nx(n){return typeof n!="string"||n.includes("-")?!1:!!(xL.indexOf(n)>-1||/[A-Z]/u.test(n))}function JT(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function Dx(n,e,t,i){if(typeof e=="function"){const[r,s]=JT(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=JT(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const tv=n=>Array.isArray(n),wL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),EL=n=>tv(n)?n[n.length-1]||0:n,Ln=n=>!!(n&&n.getVelocity);function ip(n){const e=Ln(n)?n.get():n;return wL(e)?e.toValue():e}function TL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:SL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const GA=n=>(e,t)=>{const i=q.useContext(wm),r=q.useContext(xm),s=()=>TL(n,e,i,r);return t?s():Sx(s)};function SL(n,e,t,i){const r={},s=i(n,{});for(const y in s)r[y]=ip(s[y]);let{initial:o,animate:l}=n;const u=Tm(n),h=jA(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const p=f?l:o;if(p&&typeof p!="boolean"&&!Em(p)){const y=Array.isArray(p)?p:[p];for(let x=0;x<y.length;x++){const S=Dx(n,y[x]);if(S){const{transitionEnd:I,transition:T,...R}=S;for(const k in R){let N=R[k];if(Array.isArray(N)){const M=f?N.length-1:0;N=N[M]}N!==null&&(r[k]=N)}for(const k in I)r[k]=I[k]}}}return r}const Au=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],bl=new Set(Au),WA=n=>e=>typeof e=="string"&&e.startsWith(n),$A=WA("--"),IL=WA("var(--"),Mx=n=>IL(n)?CL.test(n.split("/*")[0].trim()):!1,CL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,KA=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Ks=(n,e,t)=>t>e?e:t<n?n:t,bu={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},pd={...bu,transform:n=>Ks(0,1,n)},Pg={...bu,default:1},Xd=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Lo=Xd("deg"),ns=Xd("%"),Ne=Xd("px"),RL=Xd("vh"),AL=Xd("vw"),eS={...ns,parse:n=>ns.parse(n)/100,transform:n=>ns.transform(n*100)},bL={borderWidth:Ne,borderTopWidth:Ne,borderRightWidth:Ne,borderBottomWidth:Ne,borderLeftWidth:Ne,borderRadius:Ne,radius:Ne,borderTopLeftRadius:Ne,borderTopRightRadius:Ne,borderBottomRightRadius:Ne,borderBottomLeftRadius:Ne,width:Ne,maxWidth:Ne,height:Ne,maxHeight:Ne,top:Ne,right:Ne,bottom:Ne,left:Ne,padding:Ne,paddingTop:Ne,paddingRight:Ne,paddingBottom:Ne,paddingLeft:Ne,margin:Ne,marginTop:Ne,marginRight:Ne,marginBottom:Ne,marginLeft:Ne,backgroundPositionX:Ne,backgroundPositionY:Ne},PL={rotate:Lo,rotateX:Lo,rotateY:Lo,rotateZ:Lo,scale:Pg,scaleX:Pg,scaleY:Pg,scaleZ:Pg,skew:Lo,skewX:Lo,skewY:Lo,distance:Ne,translateX:Ne,translateY:Ne,translateZ:Ne,x:Ne,y:Ne,z:Ne,perspective:Ne,transformPerspective:Ne,opacity:pd,originX:eS,originY:eS,originZ:Ne},tS={...bu,transform:Math.round},Lx={...bL,...PL,zIndex:tS,size:Ne,fillOpacity:pd,strokeOpacity:pd,numOctaves:tS},kL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},NL=Au.length;function DL(n,e,t){let i="",r=!0;for(let s=0;s<NL;s++){const o=Au[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=KA(l,Lx[o]);if(!u){r=!1;const f=kL[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function Ox(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const u in e){const h=e[u];if(bl.has(u)){o=!0;continue}else if($A(u)){r[u]=h;continue}else{const f=KA(h,Lx[u]);u.startsWith("origin")?(l=!0,s[u]=f):i[u]=f}}if(e.transform||(o||t?i.transform=DL(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${u} ${h} ${f}`}}const ML={offset:"stroke-dashoffset",array:"stroke-dasharray"},LL={offset:"strokeDashoffset",array:"strokeDasharray"};function OL(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?ML:LL;n[s.offset]=Ne.transform(-i);const o=Ne.transform(e),l=Ne.transform(t);n[s.array]=`${o} ${l}`}function nS(n,e,t){return typeof n=="string"?n:Ne.transform(e+t*n)}function FL(n,e,t){const i=nS(e,n.x,n.width),r=nS(t,n.y,n.height);return`${i} ${r}`}function Fx(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...h},f,p){if(Ox(n,h,p),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:y,style:x,dimensions:S}=n;y.transform&&(S&&(x.transform=y.transform),delete y.transform),S&&(r!==void 0||s!==void 0||x.transform)&&(x.transformOrigin=FL(S,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(y.x=e),t!==void 0&&(y.y=t),i!==void 0&&(y.scale=i),o!==void 0&&OL(y,o,l,u,!1)}const Vx=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),HA=()=>({...Vx(),attrs:{}}),jx=n=>typeof n=="string"&&n.toLowerCase()==="svg";function XA(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const qA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function YA(n,e,t,i){XA(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(qA.has(r)?r:Px(r),e.attrs[r])}const Tp={};function VL(n){Object.assign(Tp,n)}function ZA(n,{layout:e,layoutId:t}){return bl.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Tp[n]||n==="opacity")}function zx(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(Ln(r[o])||e.style&&Ln(e.style[o])||ZA(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function QA(n,e,t){const i=zx(n,e,t);for(const r in n)if(Ln(n[r])||Ln(e[r])){const s=Au.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function jL(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const iS=["x","y","width","height","cx","cy","r"],zL={useVisualState:GA({scrapeMotionValuesFromProps:QA,createRenderState:HA,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(bl.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<iS.length;l++){const u=iS[l];n[u]!==e[u]&&(o=!0)}o&&Et.read(()=>{jL(t,i),Et.render(()=>{Fx(i,r,jx(t.tagName),n.transformTemplate),YA(t,i)})})}})},UL={useVisualState:GA({scrapeMotionValuesFromProps:zx,createRenderState:Vx})};function JA(n,e,t){for(const i in e)!Ln(e[i])&&!ZA(i,t)&&(n[i]=e[i])}function BL({transformTemplate:n},e){return q.useMemo(()=>{const t=Vx();return Ox(t,e,n),Object.assign({},t.vars,t.style)},[e])}function GL(n,e){const t=n.style||{},i={};return JA(i,t,n),Object.assign(i,BL(n,e)),i}function WL(n,e){const t={},i=GL(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function $L(n,e,t,i){const r=q.useMemo(()=>{const s=HA();return Fx(s,e,jx(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};JA(s,n.style,n),r.style={...s,...r.style}}return r}function KL(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(Nx(t)?$L:WL)(i,s,o,t),h=aL(i,typeof t=="string",n),f=t!==q.Fragment?{...h,...u,ref:r}:{},{children:p}=i,y=q.useMemo(()=>Ln(p)?p.get():p,[p]);return q.createElement(t,{...f,children:y})}}function HL(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...Nx(i)?zL:UL,preloadedFeatures:n,useRender:KL(r),createVisualElement:e,Component:i};return mL(o)}}function e2(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function Sm(n,e,t){const i=n.getProps();return Dx(i,e,t!==void 0?t:i.custom,n)}const XL=Rx(()=>window.ScrollTimeline!==void 0);class qL{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(XL()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class YL extends qL{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Ux(n,e){return n?n[e]||n.default||n:void 0}const nv=2e4;function t2(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<nv;)e+=t,i=n.next(e);return e>=nv?1/0:e}function Bx(n){return typeof n=="function"}function rS(n,e){n.timeline=e,n.onfinish=null}const Gx=n=>Array.isArray(n)&&typeof n[0]=="number",ZL={linearEasing:void 0};function QL(n,e){const t=Rx(n);return()=>{var i;return(i=ZL[e])!==null&&i!==void 0?i:t()}}const Sp=QL(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),n2=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(tu(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function i2(n){return!!(typeof n=="function"&&Sp()||!n||typeof n=="string"&&(n in iv||Sp())||Gx(n)||Array.isArray(n)&&n.every(i2))}const Fh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,iv={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Fh([0,.65,.55,1]),circOut:Fh([.55,0,1,.45]),backIn:Fh([.31,.01,.66,-.59]),backOut:Fh([.33,1.53,.69,.99])};function r2(n,e){if(n)return typeof n=="function"&&Sp()?n2(n,e):Gx(n)?Fh(n):Array.isArray(n)?n.map(t=>r2(t,e)||iv.easeOut):iv[n]}const dr={x:!1,y:!1};function s2(){return dr.x||dr.y}function JL(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function o2(n,e){const t=JL(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function sS(n){return e=>{e.pointerType==="touch"||s2()||n(e)}}function eO(n,e,t={}){const[i,r,s]=o2(n,t),o=sS(l=>{const{target:u}=l,h=e(l);if(typeof h!="function"||!u)return;const f=sS(p=>{h(p),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const a2=(n,e)=>e?n===e?!0:a2(n,e.parentElement):!1,Wx=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,tO=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function nO(n){return tO.has(n.tagName)||n.tabIndex!==-1}const Vh=new WeakSet;function oS(n){return e=>{e.key==="Enter"&&n(e)}}function X_(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const iO=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=oS(()=>{if(Vh.has(t))return;X_(t,"down");const r=oS(()=>{X_(t,"up")}),s=()=>X_(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function aS(n){return Wx(n)&&!s2()}function rO(n,e,t={}){const[i,r,s]=o2(n,t),o=l=>{const u=l.currentTarget;if(!aS(l)||Vh.has(u))return;Vh.add(u);const h=e(l),f=(x,S)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",y),!(!aS(x)||!Vh.has(u))&&(Vh.delete(u),typeof h=="function"&&h(x,{success:S}))},p=x=>{f(x,t.useGlobalTarget||a2(u,x.target))},y=x=>{f(x,!1)};window.addEventListener("pointerup",p,r),window.addEventListener("pointercancel",y,r)};return i.forEach(l=>{!nO(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>iO(h,r),r)}),s}function sO(n){return n==="x"||n==="y"?dr[n]?null:(dr[n]=!0,()=>{dr[n]=!1}):dr.x||dr.y?null:(dr.x=dr.y=!0,()=>{dr.x=dr.y=!1})}const l2=new Set(["width","height","top","left","right","bottom",...Au]);let rp;function oO(){rp=void 0}const is={now:()=>(rp===void 0&&is.set(xn.isProcessing||tL.useManualTiming?xn.timestamp:performance.now()),rp),set:n=>{rp=n,queueMicrotask(oO)}};function $x(n,e){n.indexOf(e)===-1&&n.push(e)}function Kx(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class Hx{constructor(){this.subscriptions=[]}add(e){return $x(this.subscriptions,e),()=>Kx(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function c2(n,e){return e?n*(1e3/e):0}const lS=30,aO=n=>!isNaN(parseFloat(n));class lO{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=is.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=is.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=aO(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Hx);const i=this.events[e].add(t);return e==="change"?()=>{i(),Et.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=is.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>lS)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,lS);return c2(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function md(n,e){return new lO(n,e)}function cO(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,md(t))}function uO(n,e){const t=Sm(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=EL(s[o]);cO(n,o,l)}}function hO(n){return!!(Ln(n)&&n.add)}function rv(n,e){const t=n.getValue("willChange");if(hO(t))return t.add(e)}function u2(n){return n.props[zA]}const h2=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,dO=1e-7,fO=12;function gO(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=h2(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>dO&&++l<fO);return o}function qd(n,e,t,i){if(n===e&&t===i)return Si;const r=s=>gO(s,0,1,n,t);return s=>s===0||s===1?s:h2(r(s),e,i)}const d2=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,f2=n=>e=>1-n(1-e),g2=qd(.33,1.53,.69,.99),Xx=f2(g2),p2=d2(Xx),m2=n=>(n*=2)<1?.5*Xx(n):.5*(2-Math.pow(2,-10*(n-1))),qx=n=>1-Math.sin(Math.acos(n)),y2=f2(qx),_2=d2(qx),v2=n=>/^0[^.\s]+$/u.test(n);function pO(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||v2(n):!0}const qh=n=>Math.round(n*1e5)/1e5,Yx=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function mO(n){return n==null}const yO=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Zx=(n,e)=>t=>!!(typeof t=="string"&&yO.test(t)&&t.startsWith(n)||e&&!mO(t)&&Object.prototype.hasOwnProperty.call(t,e)),x2=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(Yx);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},_O=n=>Ks(0,255,n),q_={...bu,transform:n=>Math.round(_O(n))},Ya={test:Zx("rgb","red"),parse:x2("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+q_.transform(n)+", "+q_.transform(e)+", "+q_.transform(t)+", "+qh(pd.transform(i))+")"};function vO(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const sv={test:Zx("#"),parse:vO,transform:Ya.transform},zc={test:Zx("hsl","hue"),parse:x2("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+ns.transform(qh(e))+", "+ns.transform(qh(t))+", "+qh(pd.transform(i))+")"},Dn={test:n=>Ya.test(n)||sv.test(n)||zc.test(n),parse:n=>Ya.test(n)?Ya.parse(n):zc.test(n)?zc.parse(n):sv.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Ya.transform(n):zc.transform(n)},xO=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function wO(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(Yx))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(xO))===null||t===void 0?void 0:t.length)||0)>0}const w2="number",E2="color",EO="var",TO="var(",cS="${}",SO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function yd(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(SO,u=>(Dn.test(u)?(i.color.push(s),r.push(E2),t.push(Dn.parse(u))):u.startsWith(TO)?(i.var.push(s),r.push(EO),t.push(u)):(i.number.push(s),r.push(w2),t.push(parseFloat(u))),++s,cS)).split(cS);return{values:t,split:l,indexes:i,types:r}}function T2(n){return yd(n).values}function S2(n){const{split:e,types:t}=yd(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===w2?s+=qh(r[o]):l===E2?s+=Dn.transform(r[o]):s+=r[o]}return s}}const IO=n=>typeof n=="number"?0:n;function CO(n){const e=T2(n);return S2(n)(e.map(IO))}const ea={test:wO,parse:T2,createTransformer:S2,getAnimatableNone:CO},RO=new Set(["brightness","contrast","saturate","opacity"]);function AO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(Yx)||[];if(!i)return n;const r=t.replace(i,"");let s=RO.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const bO=/\b([a-z-]*)\(.*?\)/gu,ov={...ea,getAnimatableNone:n=>{const e=n.match(bO);return e?e.map(AO).join(" "):n}},PO={...Lx,color:Dn,backgroundColor:Dn,outlineColor:Dn,fill:Dn,stroke:Dn,borderColor:Dn,borderTopColor:Dn,borderRightColor:Dn,borderBottomColor:Dn,borderLeftColor:Dn,filter:ov,WebkitFilter:ov},Qx=n=>PO[n];function I2(n,e){let t=Qx(n);return t!==ov&&(t=ea),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const kO=new Set(["auto","none","0"]);function NO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!kO.has(s)&&yd(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=I2(t,r)}const uS=n=>n===bu||n===Ne,hS=(n,e)=>parseFloat(n.split(", ")[e]),dS=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return hS(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?hS(s[1],n):0}},DO=new Set(["x","y","z"]),MO=Au.filter(n=>!DO.has(n));function LO(n){const e=[];return MO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const iu={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:dS(4,13),y:dS(5,14)};iu.translateX=iu.x;iu.translateY=iu.y;const rl=new Set;let av=!1,lv=!1;function C2(){if(lv){const n=Array.from(rl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=LO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}lv=!1,av=!1,rl.forEach(n=>n.complete()),rl.clear()}function R2(){rl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(lv=!0)})}function OO(){R2(),C2()}class Jx{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(rl.add(this),av||(av=!0,Et.read(R2),Et.resolveKeyframes(C2))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),rl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,rl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const A2=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),FO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function VO(n){const e=FO.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function b2(n,e,t=1){const[i,r]=VO(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return A2(o)?parseFloat(o):o}return Mx(r)?b2(r,e,t+1):r}const P2=n=>e=>e.test(n),jO={test:n=>n==="auto",parse:n=>n},k2=[bu,Ne,ns,Lo,AL,RL,jO],fS=n=>k2.find(P2(n));class N2 extends Jx{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),Mx(h))){const f=b2(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!l2.has(i)||e.length!==2)return;const[r,s]=e,o=fS(r),l=fS(s);if(o!==l)if(uS(o)&&uS(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)pO(e[r])&&i.push(r);i.length&&NO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=iu[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=iu[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const gS=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ea.test(n)||n==="0")&&!n.startsWith("url("));function zO(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function UO(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=gS(r,e),l=gS(s,e);return!o||!l?!1:zO(n)||(t==="spring"||Bx(t))&&i}const BO=n=>n!==null;function Im(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(BO),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const GO=40;class D2{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=is.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>GO?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&OO(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=is.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:u,isGenerator:h}=this.options;if(!h&&!UO(e,i,r,s))if(o)this.options.duration=0;else{u&&u(Im(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const kt=(n,e,t)=>n+(e-n)*t;function Y_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function WO({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;r=Y_(u,l,n+1/3),s=Y_(u,l,n),o=Y_(u,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Ip(n,e){return t=>t>0?e:n}const Z_=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},$O=[sv,Ya,zc],KO=n=>$O.find(e=>e.test(n));function pS(n){const e=KO(n);if(!e)return!1;let t=e.parse(n);return e===zc&&(t=WO(t)),t}const mS=(n,e)=>{const t=pS(n),i=pS(e);if(!t||!i)return Ip(n,e);const r={...t};return s=>(r.red=Z_(t.red,i.red,s),r.green=Z_(t.green,i.green,s),r.blue=Z_(t.blue,i.blue,s),r.alpha=kt(t.alpha,i.alpha,s),Ya.transform(r))},HO=(n,e)=>t=>e(n(t)),Yd=(...n)=>n.reduce(HO),cv=new Set(["none","hidden"]);function XO(n,e){return cv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function qO(n,e){return t=>kt(n,e,t)}function e1(n){return typeof n=="number"?qO:typeof n=="string"?Mx(n)?Ip:Dn.test(n)?mS:QO:Array.isArray(n)?M2:typeof n=="object"?Dn.test(n)?mS:YO:Ip}function M2(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>e1(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function YO(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=e1(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function ZO(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],u=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const QO=(n,e)=>{const t=ea.createTransformer(e),i=yd(n),r=yd(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?cv.has(n)&&!r.values.length||cv.has(e)&&!i.values.length?XO(n,e):Yd(M2(ZO(i,r),r.values),t):Ip(n,e)};function L2(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?kt(n,e,t):e1(n)(n,e)}const JO=5;function O2(n,e,t){const i=Math.max(e-JO,0);return c2(t-n(i),e-i)}const Lt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Q_=.001;function eF({duration:n=Lt.duration,bounce:e=Lt.bounce,velocity:t=Lt.velocity,mass:i=Lt.mass}){let r,s,o=1-e;o=Ks(Lt.minDamping,Lt.maxDamping,o),n=Ks(Lt.minDuration,Lt.maxDuration,Us(n)),o<1?(r=h=>{const f=h*o,p=f*n,y=f-t,x=uv(h,o),S=Math.exp(-p);return Q_-y/x*S},s=h=>{const p=h*o*n,y=p*t+t,x=Math.pow(o,2)*Math.pow(h,2)*n,S=Math.exp(-p),I=uv(Math.pow(h,2),o);return(-r(h)+Q_>0?-1:1)*((y-x)*S)/I}):(r=h=>{const f=Math.exp(-h*n),p=(h-t)*n+1;return-Q_+f*p},s=h=>{const f=Math.exp(-h*n),p=(t-h)*(n*n);return f*p});const l=5/n,u=nF(r,s,l);if(n=zs(n),isNaN(u))return{stiffness:Lt.stiffness,damping:Lt.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const tF=12;function nF(n,e,t){let i=t;for(let r=1;r<tF;r++)i=i-n(i)/e(i);return i}function uv(n,e){return n*Math.sqrt(1-e*e)}const iF=["duration","bounce"],rF=["stiffness","damping","mass"];function yS(n,e){return e.some(t=>n[t]!==void 0)}function sF(n){let e={velocity:Lt.velocity,stiffness:Lt.stiffness,damping:Lt.damping,mass:Lt.mass,isResolvedFromDuration:!1,...n};if(!yS(n,rF)&&yS(n,iF))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Ks(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Lt.mass,stiffness:r,damping:s}}else{const t=eF(n);e={...e,...t,mass:Lt.mass},e.isResolvedFromDuration=!0}return e}function F2(n=Lt.visualDuration,e=Lt.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:p,velocity:y,isResolvedFromDuration:x}=sF({...t,velocity:-Us(t.velocity||0)}),S=y||0,I=h/(2*Math.sqrt(u*f)),T=o-s,R=Us(Math.sqrt(u/f)),k=Math.abs(T)<5;i||(i=k?Lt.restSpeed.granular:Lt.restSpeed.default),r||(r=k?Lt.restDelta.granular:Lt.restDelta.default);let N;if(I<1){const F=uv(R,I);N=U=>{const P=Math.exp(-I*R*U);return o-P*((S+I*R*T)/F*Math.sin(F*U)+T*Math.cos(F*U))}}else if(I===1)N=F=>o-Math.exp(-R*F)*(T+(S+R*T)*F);else{const F=R*Math.sqrt(I*I-1);N=U=>{const P=Math.exp(-I*R*U),A=Math.min(F*U,300);return o-P*((S+I*R*T)*Math.sinh(A)+F*T*Math.cosh(A))/F}}const M={calculatedDuration:x&&p||null,next:F=>{const U=N(F);if(x)l.done=F>=p;else{let P=0;I<1&&(P=F===0?zs(S):O2(N,F,U));const A=Math.abs(P)<=i,D=Math.abs(o-U)<=r;l.done=A&&D}return l.value=l.done?o:U,l},toString:()=>{const F=Math.min(t2(M),nv),U=n2(P=>M.next(F*P).value,F,30);return F+"ms "+U}};return M}function _S({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:f}){const p=n[0],y={done:!1,value:p},x=A=>l!==void 0&&A<l||u!==void 0&&A>u,S=A=>l===void 0?u:u===void 0||Math.abs(l-A)<Math.abs(u-A)?l:u;let I=t*e;const T=p+I,R=o===void 0?T:o(T);R!==T&&(I=R-p);const k=A=>-I*Math.exp(-A/i),N=A=>R+k(A),M=A=>{const D=k(A),V=N(A);y.done=Math.abs(D)<=h,y.value=y.done?R:V};let F,U;const P=A=>{x(y.value)&&(F=A,U=F2({keyframes:[y.value,S(y.value)],velocity:O2(N,A,y.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return P(0),{calculatedDuration:null,next:A=>{let D=!1;return!U&&F===void 0&&(D=!0,M(A),P(A)),F!==void 0&&A>=F?U.next(A-F):(!D&&M(A),y)}}}const oF=qd(.42,0,1,1),aF=qd(0,0,.58,1),V2=qd(.42,0,.58,1),lF=n=>Array.isArray(n)&&typeof n[0]!="number",cF={linear:Si,easeIn:oF,easeInOut:V2,easeOut:aF,circIn:qx,circInOut:_2,circOut:y2,backIn:Xx,backInOut:p2,backOut:g2,anticipate:m2},vS=n=>{if(Gx(n)){LA(n.length===4);const[e,t,i,r]=n;return qd(e,t,i,r)}else if(typeof n=="string")return cF[n];return n};function uF(n,e,t){const i=[],r=t||L2,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Si:e;l=Yd(u,l)}i.push(l)}return i}function hF(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(LA(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=uF(e,i,r),u=l.length,h=f=>{if(o&&f<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(f<n[p+1]);p++);const y=tu(n[p],n[p+1],f);return l[p](y)};return t?f=>h(Ks(n[0],n[s-1],f)):h}function dF(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=tu(0,e,i);n.push(kt(t,1,r))}}function fF(n){const e=[0];return dF(e,n.length-1),e}function gF(n,e){return n.map(t=>t*e)}function pF(n,e){return n.map(()=>e||V2).splice(0,n.length-1)}function Cp({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=lF(i)?i.map(vS):vS(i),s={done:!1,value:e[0]},o=gF(t&&t.length===e.length?t:fF(e),n),l=hF(o,e,{ease:Array.isArray(r)?r:pF(e,r)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const mF=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Et.update(e,!0),stop:()=>Jo(e),now:()=>xn.isProcessing?xn.timestamp:is.now()}},yF={decay:_S,inertia:_S,tween:Cp,keyframes:Cp,spring:F2},_F=n=>n/100;class t1 extends D2{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||Jx,l=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=Bx(t)?t:yF[t]||Cp;let u,h;l!==Cp&&typeof e[0]!="number"&&(u=Yd(_F,L2(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=t2(f));const{calculatedDuration:p}=f,y=p+r,x=y*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:p,resolvedDuration:y,totalDuration:x}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:A}=this.options;return{done:!0,value:A[A.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:p}=i;if(this.startTime===null)return s.next(0);const{delay:y,repeat:x,repeatType:S,repeatDelay:I,onUpdate:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const R=this.currentTime-y*(this.speed>=0?1:-1),k=this.speed>=0?R<0:R>f;this.currentTime=Math.max(R,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let N=this.currentTime,M=s;if(x){const A=Math.min(this.currentTime,f)/p;let D=Math.floor(A),V=A%1;!V&&A>=1&&(V=1),V===1&&D--,D=Math.min(D,x+1),D%2&&(S==="reverse"?(V=1-V,I&&(V-=I/p)):S==="mirror"&&(M=o)),N=Ks(0,1,V)*p}const F=k?{done:!1,value:u[0]}:M.next(N);l&&(F.value=l(F.value));let{done:U}=F;!k&&h!==null&&(U=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&U);return P&&r!==void 0&&(F.value=Im(u,this.options,r)),T&&T(F.value),P&&this.finish(),F}get duration(){const{resolved:e}=this;return e?Us(e.calculatedDuration):0}get time(){return Us(this.currentTime)}set time(e){e=zs(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Us(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=mF,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const vF=new Set(["opacity","clipPath","filter","transform"]);function xF(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=r2(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const wF=Rx(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Rp=10,EF=2e4;function TF(n){return Bx(n.type)||n.type==="spring"||!i2(n.ease)}function SF(n,e){const t=new t1({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<EF;)i=t.sample(s),r.push(i.value),s+=Rp;return{times:void 0,keyframes:r,duration:s-Rp,ease:"linear"}}const j2={anticipate:m2,backInOut:p2,circInOut:_2};function IF(n){return n in j2}class xS extends D2{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new N2(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:u,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&Sp()&&IF(s)&&(s=j2[s]),TF(this.options)){const{onComplete:p,onUpdate:y,motionValue:x,element:S,...I}=this.options,T=SF(e,I);e=T.keyframes,e.length===1&&(e[1]=e[0]),i=T.duration,r=T.times,s=T.ease,o="keyframes"}const f=xF(l.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(rS(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:p}=this.options;l.set(Im(e,this.options,t)),p&&p(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Us(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Us(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=zs(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Si;const{animation:i}=t;rS(i,e)}return Si}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:p,element:y,...x}=this.options,S=new t1({...x,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),I=zs(this.time);h.setWithVelocity(S.sample(I-Rp).value,S.sample(I).value,Rp)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return wF()&&i&&vF.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const CF={type:"spring",stiffness:500,damping:25,restSpeed:10},RF=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),AF={type:"keyframes",duration:.8},bF={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},PF=(n,{keyframes:e})=>e.length>2?AF:bl.has(n)?n.startsWith("scale")?RF(e[1]):CF:bF;function kF({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const n1=(n,e,t,i={},r,s)=>o=>{const l=Ux(i,n)||{},u=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-zs(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:y=>{e.set(y),l.onUpdate&&l.onUpdate(y)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};kF(l)||(f={...f,...PF(n,f)}),f.duration&&(f.duration=zs(f.duration)),f.repeatDelay&&(f.repeatDelay=zs(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(p=!0)),p&&!s&&e.get()!==void 0){const y=Im(f.keyframes,l);if(y!==void 0)return Et.update(()=>{f.onUpdate(y),f.onComplete()}),new YL([])}return!s&&xS.supports(f)?new xS(f):new t1(f)};function NF({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function z2(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...u}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const p in u){const y=n.getValue(p,(s=n.latestValues[p])!==null&&s!==void 0?s:null),x=u[p];if(x===void 0||f&&NF(f,p))continue;const S={delay:t,...Ux(o||{},p)};let I=!1;if(window.MotionHandoffAnimation){const R=u2(n);if(R){const k=window.MotionHandoffAnimation(R,p,Et);k!==null&&(S.startTime=k,I=!0)}}rv(n,p),y.start(n1(p,y,x,n.shouldReduceMotion&&l2.has(p)?{type:!1}:S,n,I));const T=y.animation;T&&h.push(T)}return l&&Promise.all(h).then(()=>{Et.update(()=>{l&&uO(n,l)})}),h}function hv(n,e,t={}){var i;const r=Sm(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(z2(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:p,staggerDirection:y}=s;return DF(n,e,f+h,p,y,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function DF(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(MF).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(hv(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function MF(n,e){return n.sortNodePosition(e)}function LF(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>hv(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=hv(n,e,t);else{const r=typeof e=="function"?Sm(n,e,t.custom):e;i=Promise.all(z2(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const OF=bx.length;function U2(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?U2(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<OF;t++){const i=bx[t],r=n.props[i];(gd(r)||r===!1)&&(e[i]=r)}return e}const FF=[...Ax].reverse(),VF=Ax.length;function jF(n){return e=>Promise.all(e.map(({animation:t,options:i})=>LF(n,t,i)))}function zF(n){let e=jF(n),t=wS(),i=!0;const r=u=>(h,f)=>{var p;const y=Sm(n,f,u==="exit"?(p=n.presenceContext)===null||p===void 0?void 0:p.custom:void 0);if(y){const{transition:x,transitionEnd:S,...I}=y;h={...h,...I,...S}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,f=U2(n.parent)||{},p=[],y=new Set;let x={},S=1/0;for(let T=0;T<VF;T++){const R=FF[T],k=t[R],N=h[R]!==void 0?h[R]:f[R],M=gd(N),F=R===u?k.isActive:null;F===!1&&(S=T);let U=N===f[R]&&N!==h[R]&&M;if(U&&i&&n.manuallyAnimateOnMount&&(U=!1),k.protectedKeys={...x},!k.isActive&&F===null||!N&&!k.prevProp||Em(N)||typeof N=="boolean")continue;const P=UF(k.prevProp,N);let A=P||R===u&&k.isActive&&!U&&M||T>S&&M,D=!1;const V=Array.isArray(N)?N:[N];let j=V.reduce(r(R),{});F===!1&&(j={});const{prevResolvedValues:B={}}=k,L={...B,...j},le=ue=>{A=!0,y.has(ue)&&(D=!0,y.delete(ue)),k.needsAnimating[ue]=!0;const Q=n.getValue(ue);Q&&(Q.liveStyle=!1)};for(const ue in L){const Q=j[ue],se=B[ue];if(x.hasOwnProperty(ue))continue;let ne=!1;tv(Q)&&tv(se)?ne=!e2(Q,se):ne=Q!==se,ne?Q!=null?le(ue):y.add(ue):Q!==void 0&&y.has(ue)?le(ue):k.protectedKeys[ue]=!0}k.prevProp=N,k.prevResolvedValues=j,k.isActive&&(x={...x,...j}),i&&n.blockInitialAnimation&&(A=!1),A&&(!(U&&P)||D)&&p.push(...V.map(ue=>({animation:ue,options:{type:R}})))}if(y.size){const T={};y.forEach(R=>{const k=n.getBaseTarget(R),N=n.getValue(R);N&&(N.liveStyle=!0),T[R]=k??null}),p.push({animation:T})}let I=!!p.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(I=!1),i=!1,I?e(p):Promise.resolve()}function l(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(y=>{var x;return(x=y.animationState)===null||x===void 0?void 0:x.setActive(u,h)}),t[u].isActive=h;const p=o(u);for(const y in t)t[y].protectedKeys={};return p}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=wS(),i=!0}}}function UF(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!e2(e,n):!1}function Ma(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function wS(){return{animate:Ma(!0),whileInView:Ma(),whileHover:Ma(),whileTap:Ma(),whileDrag:Ma(),whileFocus:Ma(),exit:Ma()}}let oa=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class BF extends oa{constructor(e){super(e),e.animationState||(e.animationState=zF(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Em(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let GF=0;class WF extends oa{constructor(){super(...arguments),this.id=GF++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const $F={animation:{Feature:BF},exit:{Feature:WF}};function _d(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function Zd(n){return{point:{x:n.pageX,y:n.pageY}}}const KF=n=>e=>Wx(e)&&n(e,Zd(e));function Yh(n,e,t,i){return _d(n,e,KF(t),i)}const ES=(n,e)=>Math.abs(n-e);function HF(n,e){const t=ES(n.x,e.x),i=ES(n.y,e.y);return Math.sqrt(t**2+i**2)}class B2{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=e0(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,x=HF(p.offset,{x:0,y:0})>=3;if(!y&&!x)return;const{point:S}=p,{timestamp:I}=xn;this.history.push({...S,timestamp:I});const{onStart:T,onMove:R}=this.handlers;y||(T&&T(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),R&&R(this.lastMoveEvent,p)},this.handlePointerMove=(p,y)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=J_(y,this.transformPagePoint),Et.update(this.updatePoint,!0)},this.handlePointerUp=(p,y)=>{this.end();const{onEnd:x,onSessionEnd:S,resumeAnimation:I}=this.handlers;if(this.dragSnapToOrigin&&I&&I(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=e0(p.type==="pointercancel"?this.lastMoveEventInfo:J_(y,this.transformPagePoint),this.history);this.startEvent&&x&&x(p,T),S&&S(p,T)},!Wx(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=Zd(e),l=J_(o,this.transformPagePoint),{point:u}=l,{timestamp:h}=xn;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,e0(l,this.history)),this.removeListeners=Yd(Yh(this.contextWindow,"pointermove",this.handlePointerMove),Yh(this.contextWindow,"pointerup",this.handlePointerUp),Yh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Jo(this.updatePoint)}}function J_(n,e){return e?{point:e(n.point)}:n}function TS(n,e){return{x:n.x-e.x,y:n.y-e.y}}function e0({point:n},e){return{point:n,delta:TS(n,G2(e)),offset:TS(n,XF(e)),velocity:qF(e,.1)}}function XF(n){return n[0]}function G2(n){return n[n.length-1]}function qF(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=G2(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>zs(e)));)t--;if(!i)return{x:0,y:0};const s=Us(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const W2=1e-4,YF=1-W2,ZF=1+W2,$2=.01,QF=0-$2,JF=0+$2;function Ci(n){return n.max-n.min}function eV(n,e,t){return Math.abs(n-e)<=t}function SS(n,e,t,i=.5){n.origin=i,n.originPoint=kt(e.min,e.max,n.origin),n.scale=Ci(t)/Ci(e),n.translate=kt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=YF&&n.scale<=ZF||isNaN(n.scale))&&(n.scale=1),(n.translate>=QF&&n.translate<=JF||isNaN(n.translate))&&(n.translate=0)}function Zh(n,e,t,i){SS(n.x,e.x,t.x,i?i.originX:void 0),SS(n.y,e.y,t.y,i?i.originY:void 0)}function IS(n,e,t){n.min=t.min+e.min,n.max=n.min+Ci(e)}function tV(n,e,t){IS(n.x,e.x,t.x),IS(n.y,e.y,t.y)}function CS(n,e,t){n.min=e.min-t.min,n.max=n.min+Ci(e)}function Qh(n,e,t){CS(n.x,e.x,t.x),CS(n.y,e.y,t.y)}function nV(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?kt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?kt(t,n,i.max):Math.min(n,t)),n}function RS(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function iV(n,{top:e,left:t,bottom:i,right:r}){return{x:RS(n.x,t,r),y:RS(n.y,e,i)}}function AS(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function rV(n,e){return{x:AS(n.x,e.x),y:AS(n.y,e.y)}}function sV(n,e){let t=.5;const i=Ci(n),r=Ci(e);return r>i?t=tu(e.min,e.max-i,n.min):i>r&&(t=tu(n.min,n.max-r,e.min)),Ks(0,1,t)}function oV(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const dv=.35;function aV(n=dv){return n===!1?n=0:n===!0&&(n=dv),{x:bS(n,"left","right"),y:bS(n,"top","bottom")}}function bS(n,e,t){return{min:PS(n,e),max:PS(n,t)}}function PS(n,e){return typeof n=="number"?n:n[e]||0}const kS=()=>({translate:0,scale:1,origin:0,originPoint:0}),Uc=()=>({x:kS(),y:kS()}),NS=()=>({min:0,max:0}),zt=()=>({x:NS(),y:NS()});function $i(n){return[n("x"),n("y")]}function K2({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function lV({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function cV(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function t0(n){return n===void 0||n===1}function fv({scale:n,scaleX:e,scaleY:t}){return!t0(n)||!t0(e)||!t0(t)}function Va(n){return fv(n)||H2(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function H2(n){return DS(n.x)||DS(n.y)}function DS(n){return n&&n!=="0%"}function Ap(n,e,t){const i=n-t,r=e*i;return t+r}function MS(n,e,t,i,r){return r!==void 0&&(n=Ap(n,r,i)),Ap(n,t,i)+e}function gv(n,e=0,t=1,i,r){n.min=MS(n.min,e,t,i,r),n.max=MS(n.max,e,t,i,r)}function X2(n,{x:e,y:t}){gv(n.x,e.translate,e.scale,e.originPoint),gv(n.y,t.translate,t.scale,t.originPoint)}const LS=.999999999999,OS=1.0000000000001;function uV(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Gc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,X2(n,o)),i&&Va(s.latestValues)&&Gc(n,s.latestValues))}e.x<OS&&e.x>LS&&(e.x=1),e.y<OS&&e.y>LS&&(e.y=1)}function Bc(n,e){n.min=n.min+e,n.max=n.max+e}function FS(n,e,t,i,r=.5){const s=kt(n.min,n.max,r);gv(n,e,t,s,i)}function Gc(n,e){FS(n.x,e.x,e.scaleX,e.scale,e.originX),FS(n.y,e.y,e.scaleY,e.scale,e.originY)}function q2(n,e){return K2(cV(n.getBoundingClientRect(),e))}function hV(n,e,t){const i=q2(n,t),{scroll:r}=e;return r&&(Bc(i.x,r.offset.x),Bc(i.y,r.offset.y)),i}const Y2=({current:n})=>n?n.ownerDocument.defaultView:null,dV=new WeakMap;class fV{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=zt(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Zd(f).point)},s=(f,p)=>{const{drag:y,dragPropagation:x,onDragStart:S}=this.getProps();if(y&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=sO(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),$i(T=>{let R=this.getAxisMotionValue(T).get()||0;if(ns.test(R)){const{projection:k}=this.visualElement;if(k&&k.layout){const N=k.layout.layoutBox[T];N&&(R=Ci(N)*(parseFloat(R)/100))}}this.originPoint[T]=R}),S&&Et.postRender(()=>S(f,p)),rv(this.visualElement,"transform");const{animationState:I}=this.visualElement;I&&I.setActive("whileDrag",!0)},o=(f,p)=>{const{dragPropagation:y,dragDirectionLock:x,onDirectionLock:S,onDrag:I}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:T}=p;if(x&&this.currentDirection===null){this.currentDirection=gV(T),this.currentDirection!==null&&S&&S(this.currentDirection);return}this.updateAxis("x",p.point,T),this.updateAxis("y",p.point,T),this.visualElement.render(),I&&I(f,p)},l=(f,p)=>this.stop(f,p),u=()=>$i(f=>{var p;return this.getAnimationState(f)==="paused"&&((p=this.getAxisMotionValue(f).animation)===null||p===void 0?void 0:p.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new B2(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:Y2(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Et.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!kg(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=nV(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&jc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=iV(r.layoutBox,t):this.constraints=!1,this.elastic=aV(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&$i(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=oV(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!jc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=hV(i,r.root,this.visualElement.getTransformPagePoint());let o=rV(r.layout.layoutBox,s);if(t){const l=t(lV(o));this.hasMutatedConstraints=!!l,l&&(o=K2(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=$i(f=>{if(!kg(f,t,this.currentDirection))return;let p=u&&u[f]||{};o&&(p={min:0,max:0});const y=r?200:1e6,x=r?40:1e7,S={type:"inertia",velocity:i?e[f]:0,bounceStiffness:y,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...s,...p};return this.startAxisValueAnimation(f,S)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return rv(this.visualElement,e),i.start(n1(e,i,0,t,this.visualElement,!1))}stopAnimation(){$i(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){$i(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){$i(t=>{const{drag:i}=this.getProps();if(!kg(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-kt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!jc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};$i(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();r[o]=sV({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),$i(o=>{if(!kg(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(kt(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;dV.set(this.visualElement,this);const e=this.visualElement.current,t=Yh(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();jc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Et.read(i);const o=_d(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&($i(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=u[f].translate,p.set(p.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=dv,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function kg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function gV(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class pV extends oa{constructor(e){super(e),this.removeGroupControls=Si,this.removeListeners=Si,this.controls=new fV(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Si}unmount(){this.removeGroupControls(),this.removeListeners()}}const VS=n=>(e,t)=>{n&&Et.postRender(()=>n(e,t))};class mV extends oa{constructor(){super(...arguments),this.removePointerDownListener=Si}onPointerDown(e){this.session=new B2(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Y2(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:VS(e),onStart:VS(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Et.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Yh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const sp={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function jS(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Sh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ne.test(n))n=parseFloat(n);else return n;const t=jS(n,e.target.x),i=jS(n,e.target.y);return`${t}% ${i}%`}},yV={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=ea.parse(n);if(r.length>5)return i;const s=ea.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=u;const h=kt(l,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class _V extends q.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;VL(vV),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),sp.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Et.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),kx.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Z2(n){const[e,t]=DA(),i=q.useContext(Tx);return _.jsx(_V,{...n,layoutGroup:i,switchLayoutGroup:q.useContext(UA),isPresent:e,safeToRemove:t})}const vV={borderRadius:{...Sh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Sh,borderTopRightRadius:Sh,borderBottomLeftRadius:Sh,borderBottomRightRadius:Sh,boxShadow:yV};function xV(n,e,t){const i=Ln(n)?n:md(n);return i.start(n1("",i,e,t)),i.animation}function wV(n){return n instanceof SVGElement&&n.tagName!=="svg"}const EV=(n,e)=>n.depth-e.depth;class TV{constructor(){this.children=[],this.isDirty=!1}add(e){$x(this.children,e),this.isDirty=!0}remove(e){Kx(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(EV),this.isDirty=!1,this.children.forEach(e)}}function SV(n,e){const t=is.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Jo(i),n(s-e))};return Et.read(i,!0),()=>Jo(i)}const Q2=["TopLeft","TopRight","BottomLeft","BottomRight"],IV=Q2.length,zS=n=>typeof n=="string"?parseFloat(n):n,US=n=>typeof n=="number"||Ne.test(n);function CV(n,e,t,i,r,s){r?(n.opacity=kt(0,t.opacity!==void 0?t.opacity:1,RV(i)),n.opacityExit=kt(e.opacity!==void 0?e.opacity:1,0,AV(i))):s&&(n.opacity=kt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<IV;o++){const l=`border${Q2[o]}Radius`;let u=BS(e,l),h=BS(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||US(u)===US(h)?(n[l]=Math.max(kt(zS(u),zS(h),i),0),(ns.test(h)||ns.test(u))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=kt(e.rotate||0,t.rotate||0,i))}function BS(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const RV=J2(0,.5,y2),AV=J2(.5,.95,Si);function J2(n,e,t){return i=>i<n?0:i>e?1:t(tu(n,e,i))}function GS(n,e){n.min=e.min,n.max=e.max}function Gi(n,e){GS(n.x,e.x),GS(n.y,e.y)}function WS(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function $S(n,e,t,i,r){return n-=e,n=Ap(n,1/t,i),r!==void 0&&(n=Ap(n,1/r,i)),n}function bV(n,e=0,t=1,i=.5,r,s=n,o=n){if(ns.test(e)&&(e=parseFloat(e),e=kt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=kt(s.min,s.max,i);n===s&&(l-=e),n.min=$S(n.min,e,t,l,r),n.max=$S(n.max,e,t,l,r)}function KS(n,e,[t,i,r],s,o){bV(n,e[t],e[i],e[r],e.scale,s,o)}const PV=["x","scaleX","originX"],kV=["y","scaleY","originY"];function HS(n,e,t,i){KS(n.x,e,PV,t?t.x:void 0,i?i.x:void 0),KS(n.y,e,kV,t?t.y:void 0,i?i.y:void 0)}function XS(n){return n.translate===0&&n.scale===1}function eb(n){return XS(n.x)&&XS(n.y)}function qS(n,e){return n.min===e.min&&n.max===e.max}function NV(n,e){return qS(n.x,e.x)&&qS(n.y,e.y)}function YS(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function tb(n,e){return YS(n.x,e.x)&&YS(n.y,e.y)}function ZS(n){return Ci(n.x)/Ci(n.y)}function QS(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class DV{constructor(){this.members=[]}add(e){$x(this.members,e),e.scheduleRender()}remove(e){if(Kx(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function MV(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:p,rotateY:y,skewX:x,skewY:S}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),p&&(i+=`rotateX(${p}deg) `),y&&(i+=`rotateY(${y}deg) `),x&&(i+=`skewX(${x}deg) `),S&&(i+=`skewY(${S}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(i+=`scale(${l}, ${u})`),i||"none"}const ja={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},jh=typeof window<"u"&&window.MotionDebug!==void 0,n0=["","X","Y","Z"],LV={visibility:"hidden"},JS=1e3;let OV=0;function i0(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function nb(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=u2(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Et,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&nb(i)}function ib({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=OV++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,jh&&(ja.totalNodes=ja.resolvedTargetDeltas=ja.recalculatedProjection=0),this.nodes.forEach(jV),this.nodes.forEach(WV),this.nodes.forEach($V),this.nodes.forEach(zV),jh&&window.MotionDebug.record(ja)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new TV)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Hx),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=wV(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||u)&&(this.isLayoutDirty=!0),n){let p;const y=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=SV(y,250),sp.hasAnimatedSinceResize&&(sp.hasAnimatedSinceResize=!1,this.nodes.forEach(tI))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:y,hasRelativeTargetChanged:x,layout:S})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||f.getDefaultTransition()||YV,{onLayoutAnimationStart:T,onLayoutAnimationComplete:R}=f.getProps(),k=!this.targetLayout||!tb(this.targetLayout,S)||x,N=!y&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||N||y&&(k||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,N);const M={...Ux(I,"layout"),onPlay:T,onComplete:R};(f.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M)}else y||tI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=S})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Jo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(KV),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&nb(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(eI);return}this.isUpdating||this.nodes.forEach(BV),this.isUpdating=!1,this.nodes.forEach(GV),this.nodes.forEach(FV),this.nodes.forEach(VV),this.clearAllSnapshots();const l=is.now();xn.delta=Ks(0,1e3/60,l-xn.timestamp),xn.timestamp=l,xn.isProcessing=!0,H_.update.process(xn),H_.preRender.process(xn),H_.render.process(xn),xn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,kx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(UV),this.sharedNodes.forEach(HV)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Et.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Et.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=zt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!eb(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||Va(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),ZV(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return zt();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(QV))){const{scroll:f}=this.root;f&&(Bc(u.x,f.offset.x),Bc(u.y,f.offset.y))}return u}removeElementScroll(o){var l;const u=zt();if(Gi(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:p,options:y}=f;f!==this.root&&p&&y.layoutScroll&&(p.wasRoot&&Gi(u,o),Bc(u.x,p.offset.x),Bc(u.y,p.offset.y))}return u}applyTransform(o,l=!1){const u=zt();Gi(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Gc(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Va(f.latestValues)&&Gc(u,f.latestValues)}return Va(this.latestValues)&&Gc(u,this.latestValues),u}removeTransform(o){const l=zt();Gi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Va(h.latestValues))continue;fv(h.latestValues)&&h.updateSnapshot();const f=zt(),p=h.measurePageBox();Gi(f,p),HS(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return Va(this.latestValues)&&HS(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==xn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:y}=this.options;if(!(!this.layout||!(p||y))){if(this.resolvedRelativeTargetAt=xn.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=zt(),this.relativeTargetOrigin=zt(),Qh(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),Gi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=zt(),this.targetWithTransforms=zt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),tV(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Gi(this.target,this.layout.layoutBox),X2(this.target,this.targetDelta)):Gi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=zt(),this.relativeTargetOrigin=zt(),Qh(this.relativeTargetOrigin,this.target,x.target),Gi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}jh&&ja.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||fv(this.parent.latestValues)||H2(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===xn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;Gi(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,x=this.treeScale.y;uV(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=zt());const{target:S}=l;if(!S){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(WS(this.prevProjectionDelta.x,this.projectionDelta.x),WS(this.prevProjectionDelta.y,this.projectionDelta.y)),Zh(this.projectionDelta,this.layoutCorrected,S,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==x||!QS(this.projectionDelta.x,this.prevProjectionDelta.x)||!QS(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",S)),jh&&ja.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Uc(),this.projectionDelta=Uc(),this.projectionDeltaWithTransform=Uc()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},p=Uc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const y=zt(),x=u?u.source:void 0,S=this.layout?this.layout.source:void 0,I=x!==S,T=this.getStack(),R=!T||T.members.length<=1,k=!!(I&&!R&&this.options.crossfade===!0&&!this.path.some(qV));this.animationProgress=0;let N;this.mixTargetDelta=M=>{const F=M/1e3;nI(p.x,o.x,F),nI(p.y,o.y,F),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Qh(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),XV(this.relativeTarget,this.relativeTargetOrigin,y,F),N&&NV(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=zt()),Gi(N,this.relativeTarget)),I&&(this.animationValues=f,CV(f,h,this.latestValues,F,k,R)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Jo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Et.update(()=>{sp.hasAnimatedSinceResize=!0,this.currentAnimation=xV(0,JS,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(JS),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:f}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&rb(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||zt();const p=Ci(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const y=Ci(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+y}Gi(l,u),Gc(l,f),Zh(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new DV),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&i0("z",o,h,this.animationValues);for(let f=0;f<n0.length;f++)i0(`rotate${n0[f]}`,o,h,this.animationValues),i0(`skew${n0[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return LV;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=ip(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const I={};return this.options.layoutId&&(I.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,I.pointerEvents=ip(o?.pointerEvents)||""),this.hasProjected&&!Va(this.latestValues)&&(I.transform=f?f({},""):"none",this.hasProjected=!1),I}const y=p.animationValues||p.latestValues;this.applyTransformsToTarget(),h.transform=MV(this.projectionDeltaWithTransform,this.treeScale,y),f&&(h.transform=f(y,h.transform));const{x,y:S}=this.projectionDelta;h.transformOrigin=`${x.origin*100}% ${S.origin*100}% 0`,p.animationValues?h.opacity=p===this?(u=(l=y.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:h.opacity=p===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const I in Tp){if(y[I]===void 0)continue;const{correct:T,applyTo:R}=Tp[I],k=h.transform==="none"?y[I]:T(y[I],p);if(R){const N=R.length;for(let M=0;M<N;M++)h[R[M]]=k}else h[I]=k}return this.options.layoutId&&(h.pointerEvents=p===this?ip(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(eI),this.root.sharedNodes.clear()}}}function FV(n){n.updateLayout()}function VV(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?$i(p=>{const y=o?t.measuredBox[p]:t.layoutBox[p],x=Ci(y);y.min=i[p].min,y.max=y.min+x}):rb(s,t.layoutBox,i)&&$i(p=>{const y=o?t.measuredBox[p]:t.layoutBox[p],x=Ci(i[p]);y.max=y.min+x,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[p].max=n.relativeTarget[p].min+x)});const l=Uc();Zh(l,i,t.layoutBox);const u=Uc();o?Zh(u,n.applyTransform(r,!0),t.measuredBox):Zh(u,i,t.layoutBox);const h=!eb(l);let f=!1;if(!n.resumeFrom){const p=n.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:y,layout:x}=p;if(y&&x){const S=zt();Qh(S,t.layoutBox,y.layoutBox);const I=zt();Qh(I,i,x.layoutBox),tb(S,I)||(f=!0),p.options.layoutRoot&&(n.relativeTarget=I,n.relativeTargetOrigin=S,n.relativeParent=p)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function jV(n){jh&&ja.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function zV(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function UV(n){n.clearSnapshot()}function eI(n){n.clearMeasurements()}function BV(n){n.isLayoutDirty=!1}function GV(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function tI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function WV(n){n.resolveTargetDelta()}function $V(n){n.calcProjection()}function KV(n){n.resetSkewAndRotation()}function HV(n){n.removeLeadSnapshot()}function nI(n,e,t){n.translate=kt(e.translate,0,t),n.scale=kt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function iI(n,e,t,i){n.min=kt(e.min,t.min,i),n.max=kt(e.max,t.max,i)}function XV(n,e,t,i){iI(n.x,e.x,t.x,i),iI(n.y,e.y,t.y,i)}function qV(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const YV={duration:.45,ease:[.4,0,.1,1]},rI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),sI=rI("applewebkit/")&&!rI("chrome/")?Math.round:Si;function oI(n){n.min=sI(n.min),n.max=sI(n.max)}function ZV(n){oI(n.x),oI(n.y)}function rb(n,e,t){return n==="position"||n==="preserve-aspect"&&!eV(ZS(e),ZS(t),.2)}function QV(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const JV=ib({attachResizeListener:(n,e)=>_d(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),r0={current:void 0},sb=ib({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!r0.current){const n=new JV({});n.mount(window),n.setOptions({layoutScroll:!0}),r0.current=n}return r0.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),e5={pan:{Feature:mV},drag:{Feature:pV,ProjectionNode:sb,MeasureLayout:Z2}};function aI(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Et.postRender(()=>s(e,Zd(e)))}class t5 extends oa{mount(){const{current:e}=this.node;e&&(this.unmount=eO(e,t=>(aI(this.node,t,"Start"),i=>aI(this.node,i,"End"))))}unmount(){}}class n5 extends oa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Yd(_d(this.node.current,"focus",()=>this.onFocus()),_d(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function lI(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Et.postRender(()=>s(e,Zd(e)))}class i5 extends oa{mount(){const{current:e}=this.node;e&&(this.unmount=rO(e,t=>(lI(this.node,t,"Start"),(i,{success:r})=>lI(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const pv=new WeakMap,s0=new WeakMap,r5=n=>{const e=pv.get(n.target);e&&e(n)},s5=n=>{n.forEach(r5)};function o5({root:n,...e}){const t=n||document;s0.has(t)||s0.set(t,{});const i=s0.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(s5,{root:n,...e})),i[r]}function a5(n,e,t){const i=o5(e);return pv.set(n,t),i.observe(n),()=>{pv.delete(n),i.unobserve(n)}}const l5={some:0,all:1};class c5 extends oa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:l5[r]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),y=h?f:p;y&&y(u)};return a5(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(u5(e,t))&&this.startObserver()}unmount(){}}function u5({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const h5={inView:{Feature:c5},tap:{Feature:i5},focus:{Feature:n5},hover:{Feature:t5}},d5={layout:{ProjectionNode:sb,MeasureLayout:Z2}},mv={current:null},ob={current:!1};function f5(){if(ob.current=!0,!!Cx)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>mv.current=n.matches;n.addListener(e),e()}else mv.current=!1}const g5=[...k2,Dn,ea],p5=n=>g5.find(P2(n)),cI=new WeakMap;function m5(n,e,t){for(const i in e){const r=e[i],s=t[i];if(Ln(r))n.addValue(i,r);else if(Ln(s))n.addValue(i,md(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,md(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const uI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class y5{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Jx,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=is.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,Et.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=Tm(t),this.isVariantNode=jA(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,...y}=this.scrapeMotionValuesFromProps(t,{},this);for(const x in y){const S=y[x];u[x]!==void 0&&Ln(S)&&S.set(u[x],!1)}}mount(e){this.current=e,cI.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),ob.current||f5(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:mv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){cI.delete(this.current),this.projection&&this.projection.unmount(),Jo(this.notifyUpdate),Jo(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=bl.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Et.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in nu){const t=nu[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):zt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<uI.length;i++){const r=uI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=m5(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=md(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(A2(r)||v2(r))?r=parseFloat(r):!p5(r)&&ea.test(t)&&(r=I2(e,t)),this.setBaseTarget(e,Ln(r)?r.get():r)),Ln(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=Dx(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ln(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new Hx),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class ab extends y5{constructor(){super(...arguments),this.KeyframeResolver=N2}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ln(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function _5(n){return window.getComputedStyle(n)}class v5 extends ab{constructor(){super(...arguments),this.type="html",this.renderInstance=XA}readValueFromInstance(e,t){if(bl.has(t)){const i=Qx(t);return i&&i.default||0}else{const i=_5(e),r=($A(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return q2(e,t)}build(e,t,i){Ox(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return zx(e,t,i)}}class x5 extends ab{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=zt}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(bl.has(t)){const i=Qx(t);return i&&i.default||0}return t=qA.has(t)?t:Px(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return QA(e,t,i)}build(e,t,i){Fx(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){YA(e,t,i,r)}mount(e){this.isSVGTag=jx(e.tagName),super.mount(e)}}const w5=(n,e)=>Nx(n)?new x5(e):new v5(e,{allowProjection:n!==q.Fragment}),E5=HL({...$F,...h5,...e5,...d5},w5),ze=lL(E5),ei={ADD:"add",REMOVE:"remove"},ru={PROPERTYCHANGE:"propertychange"},Ge={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Cm{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function T5(n,e,t){let i,r;t=t||Bs;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function Bs(n,e){return n>e?1:n<e?-1:0}function S5(n,e){return n<e?1:n>e?-1:0}function i1(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function I5(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function r1(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function aa(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function C5(n,e,t){const i=e||Bs;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function vd(){return!0}function Rm(){return!1}function xd(){}function lb(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!aa(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function R5(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function Qd(n){for(const e in n)delete n[e]}function su(n){let e;for(e in n)return!1;return!e}class Zs{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class Am extends Cm{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Zs(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let u;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,xd);delete o[i]}return u}disposeInternal(){this.listeners_&&Qd(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=xd,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function nt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function bp(n,e,t,i){return nt(n,e,t,i,!0)}function Rt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Qd(n))}class Jd extends Am{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Ge.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=nt(this,e[s],t);return r}return nt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=bp(this,e[s],t)}else i=bp(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)A5(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}Jd.prototype.on;Jd.prototype.once;Jd.prototype.un;function A5(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Rt(n[e]);else Rt(n)}function tt(){throw new Error("Unimplemented abstract method.")}let b5=0;function it(n){return n.ol_uid||(n.ol_uid=String(++b5))}class hI extends Zs{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class cs extends Jd{constructor(e){super(),this.on,this.once,this.un,it(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new hI(i,e,t)),i=ru.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new hI(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],su(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const dI={LENGTH:"length"};class Ng extends Zs{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Hi extends cs{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(dI.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Ng(ei.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Ng(ei.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Ng(ei.REMOVE,r,e)),this.dispatchEvent(new Ng(ei.ADD,t,e))}updateLength_(){this.set(dI.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function at(n,e){if(!n)throw new Error(e)}class ou extends cs{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new ou(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Rt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=nt(e,Ge.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?P5(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function P5(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(at(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const ln={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function fI(n){const e=Qi();for(let t=0,i=n.length;t<i;++t)Jh(e,n[t]);return e}function s1(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function cb(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function ub(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function au(n,e){return hb(n,e[0],e[1])}function zh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function hb(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function yv(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let u=ln.UNKNOWN;return o<t?u=u|ln.LEFT:o>r&&(u=u|ln.RIGHT),l<i?u=u|ln.BELOW:l>s&&(u=u|ln.ABOVE),u===ln.UNKNOWN&&(u=ln.INTERSECTING),u}function Qi(){return[1/0,1/0,-1/0,-1/0]}function ta(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function bm(n){return ta(1/0,1/0,-1/0,-1/0,n)}function db(n,e){const t=n[0],i=n[1];return ta(t,i,t,i,e)}function o1(n,e,t,i,r){const s=bm(r);return fb(s,n,e,t,i)}function wd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function k5(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Jh(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function fb(n,e,t,i,r){for(;t<i;t+=r)N5(n,e[t],e[t+1]);return n}function N5(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function gb(n,e){let t;return t=e(Pm(n)),t||(t=e(km(n)),t)||(t=e(Nm(n)),t)||(t=e(Pl(n)),t)?t:!1}function _v(n){let e=0;return Dm(n)||(e=dt(n)*Bn(n)),e}function Pm(n){return[n[0],n[1]]}function km(n){return[n[2],n[1]]}function fl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function D5(n,e){let t;if(e==="bottom-left")t=Pm(n);else if(e==="bottom-right")t=km(n);else if(e==="top-left")t=Pl(n);else if(e==="top-right")t=Nm(n);else throw new Error("Invalid corner");return t}function vv(n,e,t,i,r){const[s,o,l,u,h,f,p,y]=pb(n,e,t,i);return ta(Math.min(s,l,h,p),Math.min(o,u,f,y),Math.max(s,l,h,p),Math.max(o,u,f,y),r)}function pb(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),u=r*o,h=r*l,f=s*o,p=s*l,y=n[0],x=n[1];return[y-u+p,x-h-f,y-u-p,x-h+f,y+u-p,x+h+f,y+u+p,x+h-f,y-u+p,x-h-f]}function Bn(n){return n[3]-n[1]}function sl(n,e,t){const i=t||Qi();return ri(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):bm(i),i}function Pl(n){return[n[0],n[3]]}function Nm(n){return[n[2],n[3]]}function dt(n){return n[2]-n[0]}function ri(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Dm(n){return n[2]<n[0]||n[3]<n[1]}function M5(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function L5(n,e,t){let i=!1;const r=yv(n,e),s=yv(n,t);if(r===ln.INTERSECTING||s===ln.INTERSECTING)i=!0;else{const o=n[0],l=n[1],u=n[2],h=n[3],f=e[0],p=e[1],y=t[0],x=t[1],S=(x-p)/(y-f);let I,T;s&ln.ABOVE&&!(r&ln.ABOVE)&&(I=y-(x-h)/S,i=I>=o&&I<=u),!i&&s&ln.RIGHT&&!(r&ln.RIGHT)&&(T=x-(y-u)*S,i=T>=l&&T<=h),!i&&s&ln.BELOW&&!(r&ln.BELOW)&&(I=y-(x-l)/S,i=I>=o&&I<=u),!i&&s&ln.LEFT&&!(r&ln.LEFT)&&(T=x-(y-o)*S,i=T>=l&&T<=h)}return i}function mb(n,e){const t=e.getExtent(),i=fl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=dt(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function yb(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];mb(n,e);const r=dt(i);if(dt(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Nt(n,e,t){return Math.min(Math.max(n,e),t)}function O5(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const u=((n-t)*o+(e-i)*l)/(o*o+l*l);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=l*u)}return Hc(n,e,t,i)}function Hc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function F5(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const u=Math.abs(n[l][i]);u>s&&(s=u,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const u=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function gI(n){return n*180/Math.PI}function Ho(n){return n*Math.PI/180}function ol(n,e){const t=n%e;return t*e<0?t+e:t}function xi(n,e,t){return n+t*(e-n)}function ef(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function cX(n,e){return Math.round(ef(n,e))}function Dg(n,e){return Math.floor(ef(n,e))}function Mg(n,e){return Math.ceil(ef(n,e))}function xv(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function V5(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Pp(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function a1(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function j5(n,e){return n[0]*=e,n[1]*=e,n}function _b(n,e){if(e.canWrapX()){const t=dt(e.getExtent()),i=z5(n,e,t);i&&(n[0]-=i*t)}return n}function z5(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||dt(i),r=Math.floor((n[0]-i[0])/t)),r}function vb(...n){console.warn(...n)}const lu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class l1{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||lu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const tf=6378137,Wc=Math.PI*tf,U5=[-Wc,-Wc,Wc,Wc],B5=[-180,-85,180,85],Lg=tf*Math.log(Math.tan(Math.PI/2));class _c extends l1{constructor(e){super({code:e,units:"m",extent:U5,global:!0,worldExtent:B5,getPointResolution:function(t,i){return t/Math.cosh(i[1]/tf)}})}}const pI=[new _c("EPSG:3857"),new _c("EPSG:102100"),new _c("EPSG:102113"),new _c("EPSG:900913"),new _c("http://www.opengis.net/def/crs/EPSG/0/3857"),new _c("http://www.opengis.net/gml/srs/epsg.xml#3857")];function G5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Wc*n[s]/180;let o=tf*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Lg?o=Lg:o<-Lg&&(o=-Lg),e[s+1]=o}return e}function W5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Wc,e[s+1]=360*Math.atan(Math.exp(n[s+1]/tf))/Math.PI-90;return e}const $5=6378137,mI=[-180,-90,180,90],K5=Math.PI*$5/180;class La extends l1{constructor(e,t){super({code:e,units:"degrees",extent:mI,axisOrientation:t,global:!0,metersPerUnit:K5,worldExtent:mI})}}const yI=[new La("CRS:84"),new La("EPSG:4326","neu"),new La("urn:ogc:def:crs:OGC:1.3:CRS84"),new La("urn:ogc:def:crs:OGC:2:84"),new La("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new La("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new La("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let wv={};function H5(n){return wv[n]||wv[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function X5(n,e){wv[n]=e}let Xc={};function Ed(n,e,t){const i=n.getCode(),r=e.getCode();i in Xc||(Xc[i]={}),Xc[i][r]=t}function o0(n,e){return n in Xc&&e in Xc[n]?Xc[n][e]:null}const kp=.9996,Yi=.00669438,Mm=Yi*Yi,Lm=Mm*Yi,Za=Yi/(1-Yi),_I=Math.sqrt(1-Yi),cu=(1-_I)/(1+_I),xb=cu*cu,c1=xb*cu,u1=c1*cu,wb=u1*cu,Eb=1-Yi/4-3*Mm/64-5*Lm/256,q5=3*Yi/8+3*Mm/32+45*Lm/1024,Y5=15*Mm/256+45*Lm/1024,Z5=35*Lm/3072,Q5=3/2*cu-27/32*c1+269/512*wb,J5=21/16*xb-55/32*u1,e4=151/96*c1-417/128*wb,t4=1097/512*u1,Np=6378137;function n4(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/kp/(Np*Eb),l=o+Q5*Math.sin(2*o)+J5*Math.sin(4*o)+e4*Math.sin(6*o)+t4*Math.sin(8*o),u=Math.sin(l),h=u*u,f=Math.cos(l),p=u/f,y=p*p,x=y*y,S=1-Yi*h,I=Math.sqrt(1-Yi*h),T=Np/I,R=(1-Yi)/S,k=Za*f**2,N=k*k,M=i/(T*kp),F=M*M,U=F*M,P=U*M,A=P*M,D=A*M,V=l-p/R*(F/2-P/24*(5+3*y+10*k-4*N-9*Za))+D/720*(61+90*y+298*k+45*x-252*Za-3*N);let j=(M-U/6*(1+2*y+k)+A/120*(5-2*k+28*y-3*N+8*Za+24*x))/f;return j=xv(j+Ho(Tb(t.number)),-Math.PI,Math.PI),[gI(j),gI(V)]}const vI=-80,xI=84,i4=-180,r4=180;function s4(n,e,t){n=xv(n,i4,r4),e<vI?e=vI:e>xI&&(e=xI);const i=Ho(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,u=l*l,h=Ho(n),f=Tb(t.number),p=Ho(f),y=Np/Math.sqrt(1-Yi*r**2),x=Za*s**2,S=s*xv(h-p,-Math.PI,Math.PI),I=S*S,T=I*S,R=T*S,k=R*S,N=k*S,M=Np*(Eb*i-q5*Math.sin(2*i)+Y5*Math.sin(4*i)-Z5*Math.sin(6*i)),F=kp*y*(S+T/6*(1-l+x)+k/120*(5-18*l+u+72*x-58*Za))+5e5;let U=kp*(M+y*o*(I/2+R/24*(5-l+9*x+4*x**2)+N/720*(61-58*l+u+600*x-330*Za)));return t.north||(U+=1e7),[F,U]}function Tb(n){return(n-1)*6-180+3}const o4=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function Sb(n){let e=0;for(const r of o4){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function wI(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const u=t[l],h=t[l+1],f=n(u,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function a4(n){return Sb(n)?new l1({code:n,units:"m"}):null}function l4(n){const e=Sb(n.getCode());return e?{forward:wI(s4,e),inverse:wI(n4,e)}:null}const c4=63710088e-1;function EI(n,e,t){t=t||c4;const i=Ho(n[1]),r=Ho(e[1]),s=(r-i)/2,o=Ho(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const u4=[l4],h4=[a4];let Ev=!0;function Ib(n){Ev=!1}function h1(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function Tv(n){X5(n.getCode(),n),Ed(n,n,h1)}function d4(n){n.forEach(Tv)}function ai(n){if(typeof n!="string")return n;const e=H5(n);if(e)return e;for(const t of h4){const i=t(n);if(i)return i}return null}function Dp(n,e,t,i){n=ai(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/lu[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=f1(n,ai("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=EI(h.slice(0,2),h.slice(2,4)),p=EI(h.slice(4,6),h.slice(6,8));r=(f+p)/2}const u=i?lu[i]:n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function TI(n){d4(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Ed(e,t,h1)})})}function f4(n,e,t,i){n.forEach(function(r){e.forEach(function(s){Ed(r,s,t),Ed(s,r,i)})})}function d1(n,e){return n?typeof n=="string"?ai(n):n:ai(e)}function g4(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),u=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=u?e[o+h]:l[h]}return t})}function gl(n,e){return Ib(),Om(n,"EPSG:4326","EPSG:3857")}function SI(n,e){const t=Om(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=ol(i+180,360)-180),t}function op(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||f1(n,e)===h1)&&t}function f1(n,e){const t=n.getCode(),i=e.getCode();let r=o0(t,i);if(r)return r;let s=null,o=null;for(const u of u4)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=a0(s.inverse,o.forward);else{const u=o0(t,l);u&&(r=a0(u,o.forward))}else{const u=o0(l,i);u&&(r=a0(s.inverse,u))}return r&&(Tv(n),Tv(e),Ed(n,e,r)),r}function a0(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Mp(n,e){const t=ai(n),i=ai(e);return f1(t,i)}function Om(n,e,t){const i=Mp(e,t);if(!i){const r=ai(e).getCode(),s=ai(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Sv(n,e){return n}function Ds(n,e){return Ev&&!Pp(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Ev=!1,vb("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function Cb(n,e){return n}function Go(n,e){return n}function p4(){TI(pI),TI(yI),f4(yI,pI,G5,W5)}p4();new Array(6);function Er(){return[1,0,0,1,0,0]}function m4(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function un(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Hs(n,e,t,i,r,s,o,l){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-l*i*u+e,n[5]=o*r*u+l*r*h+t,n}function Rb(n,e){const t=y4(e);at(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*l)/t,n[5]=-(i*u-r*l)/t,n}function y4(n){return n[0]*n[3]-n[1]*n[2]}const _4=[1e5,1e5,1e5,1e5,2,2];function v4(n){return"matrix("+n.join(", ")+")"}function Iv(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function x4(n,e){const t=Iv(n),i=Iv(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*_4[r])!==0)return!1;return!0}function Xo(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let u=e;u<t;u+=i){const h=n[u],f=n[u+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let p=2;p<o;p++)s[l++]=n[u+p]}return s&&s.length!=l&&(s.length=l),s}function Ab(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),u=Math.sin(r),h=s[0],f=s[1];let p=0;for(let y=e;y<t;y+=i){const x=n[y]-h,S=n[y+1]-f;o[p++]=h+x*l-S*u,o[p++]=f+x*u+S*l;for(let I=y+2;I<y+i;++I)o[p++]=n[I]}return o&&o.length!=p&&(o.length=p),o}function w4(n,e,t,i,r,s,o,l){l=l||[];const u=o[0],h=o[1];let f=0;for(let p=e;p<t;p+=i){const y=n[p]-u,x=n[p+1]-h;l[f++]=u+r*y,l[f++]=h+s*x;for(let S=p+2;S<p+i;++S)l[f++]=n[S]}return l&&l.length!=f&&(l.length=f),l}function E4(n,e,t,i,r,s,o){o=o||[];let l=0;for(let u=e;u<t;u+=i){o[l++]=n[u]+r,o[l++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const II=Er(),T4=[NaN,NaN];class S4 extends cs{constructor(){super(),this.extent_=Qi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=lb((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return tt()}closestPointXY(e,t,i,r){return tt()}containsXY(e,t){return this.closestPointXY(e,t,T4,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return tt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&bm(t),this.extentRevision_=this.getRevision()}return M5(this.extent_,e)}rotate(e,t){tt()}scale(e,t,i){tt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return tt()}getType(){return tt()}applyTransform(e){tt()}intersectsExtent(e){return tt()}translate(e,t){tt()}transform(e,t){const i=ai(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const u=i.getExtent(),h=i.getWorldExtent(),f=Bn(h)/Bn(u);Hs(II,h[0],h[3],f,-f,0,0,0);const p=Xo(s,0,s.length,l,II,o),y=Mp(i,t);return y?y(p,p,l):p}:Mp(i,t);return this.applyTransform(r),this}}class g1 extends S4{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return o1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return tt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=CI(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){tt()}setLayout(e,t,i){let r;if(e)r=CI(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=I4(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Ab(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=fl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();w4(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();E4(i,0,i.length,r,e,t,i),this.changed()}}}function I4(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function CI(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function C4(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Xo(i,0,i.length,r,e,t)}function RI(n,e,t,i,r,s,o){const l=n[e],u=n[e+1],h=n[t]-l,f=n[t+1]-u;let p;if(h===0&&f===0)p=e;else{const y=((r-l)*h+(s-u)*f)/(h*h+f*f);if(y>1)p=t;else if(y>0){for(let x=0;x<i;++x)o[x]=xi(n[e+x],n[t+x],y);o.length=i;return}else p=e}for(let y=0;y<i;++y)o[y]=n[p+y];o.length=i}function bb(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],u=n[e+1],h=Hc(s,o,l,u);h>r&&(r=h),s=l,o=u}return r}function Pb(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=bb(n,e,l,i,r),e=l}return r}function uX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=Pb(n,e,l,i,r),e=l[l.length-1]}return r}function kb(n,e,t,i,r,s,o,l,u,h,f){if(e==t)return h;let p,y;if(r===0){if(y=Hc(o,l,n[e],n[e+1]),y<h){for(p=0;p<i;++p)u[p]=n[e+p];return u.length=i,y}return h}f=f||[NaN,NaN];let x=e+i;for(;x<t;)if(RI(n,x-i,x,i,o,l,f),y=Hc(o,l,f[0],f[1]),y<h){for(h=y,p=0;p<i;++p)u[p]=f[p];u.length=i,x+=i}else x+=i*Math.max((Math.sqrt(y)-Math.sqrt(h))/r|0,1);if(s&&(RI(n,t-i,e,i,o,l,f),y=Hc(o,l,f[0],f[1]),y<h)){for(h=y,p=0;p<i;++p)u[p]=f[p];u.length=i}return h}function Nb(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,y=t.length;p<y;++p){const x=t[p];h=kb(n,e,x,i,r,s,o,l,u,h,f),e=x}return h}function hX(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,y=t.length;p<y;++p){const x=t[p];h=Nb(n,e,x,i,r,s,o,l,u,h,f),e=x[x.length-1]}return h}function R4(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function Db(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function Mb(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=Db(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function dX(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=Mb(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function $c(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Lp(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=$c(n,e,u,i,r[s]),e=u}return r.length=s,r}function AI(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:Lp(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function bI(n,e,t,i,r,s,o){let l,u;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,u=r;else if(h!==0){let f=n[e],p=n[e+1],y=0;const x=[0];for(let T=e+i;T<t;T+=i){const R=n[T],k=n[T+1];y+=Math.sqrt((R-f)*(R-f)+(k-p)*(k-p)),x.push(y),f=R,p=k}const S=r*y,I=T5(x,S);I<0?(u=(S-x[-I-2])/(x[-I-1]-x[-I-2]),l=e+(-I-2)*i):l=e+I*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:u===void 0?n[l+f]:xi(n[l+f],n[l+i+f],u);return s}function PI(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,u=t/i;for(;l<u;){const y=l+u>>1;r<n[(y+1)*i-1]?u=y:l=y+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],p=(r-h)/(f-h);o=[];for(let y=0;y<i-1;++y)o.push(xi(n[(l-1)*i+y],n[l*i+y],p));return o.push(r),o}function fX(n,e,t,i,r,s,o){if(o)return PI(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let u=0,h=t.length;u<h;++u){const f=t[u];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return PI(n,e,f,i,r,!1);e=f}}return null}function A4(n,e,t,i,r){return!gb(r,function(o){return!Qa(n,e,t,i,o[0],o[1])})}function Qa(n,e,t,i,r,s){let o=0,l=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];u<=s?f>s&&(h-l)*(s-u)-(r-l)*(f-u)>0&&o++:f<=s&&(h-l)*(s-u)-(r-l)*(f-u)<0&&o--,l=h,u=f}return o!==0}function p1(n,e,t,i,r,s){if(t.length===0||!Qa(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(Qa(n,t[o-1],t[o],i,r,s))return!1;return!0}function gX(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const u=t[o];if(p1(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function b4(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function m1(n,e,t,i,r,s){return s=s??fb(Qi(),n,e,t,i),ri(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:b4(n,e,t,i,function(o,l){return L5(r,o,l)}):!1}function pX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(m1(n,e,t[s],i,r))return!0;e=t[s]}return!1}function Lb(n,e,t,i,r){return!!(m1(n,e,t,i,r)||Qa(n,e,t,i,r[0],r[1])||Qa(n,e,t,i,r[0],r[3])||Qa(n,e,t,i,r[2],r[1])||Qa(n,e,t,i,r[2],r[3]))}function Ob(n,e,t,i,r){if(!Lb(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(A4(n,t[s-1],t[s],i,r)&&!m1(n,t[s-1],t[s],i,r))return!1;return!0}function mX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(Ob(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function P4(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const u=n[l],h=n[l+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function y1(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(l);u[0]=1,u[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const p=h.pop(),y=h.pop();let x=0;const S=n[y],I=n[y+1],T=n[p],R=n[p+1];for(let k=y+i;k<p;k+=i){const N=n[k],M=n[k+1],F=O5(N,M,S,I,T,R);F>x&&(f=k,x=F)}x>r&&(u[(f-e)/i]=1,y+i<f&&h.push(y,f),f+i<p&&h.push(f,p))}for(let p=0;p<l;++p)u[p]&&(s[o++]=n[e+p*i],s[o++]=n[e+p*i+1]);return o}function k4(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=y1(n,e,f,i,r,s,o),l.push(o),e=f}return o}function za(n,e){return e*Math.round(n/e)}function N4(n,e,t,i,r,s,o){if(e==t)return o;let l=za(n[e],r),u=za(n[e+1],r);e+=i,s[o++]=l,s[o++]=u;let h,f;do if(h=za(n[e],r),f=za(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==u);for(;e<t;){const p=za(n[e],r),y=za(n[e+1],r);if(e+=i,p==h&&y==f)continue;const x=h-l,S=f-u,I=p-l,T=y-u;if(x*T==S*I&&(x<0&&I<x||x==I||x>0&&I>x)&&(S<0&&T<S||S==T||S>0&&T>S)){h=p,f=y;continue}s[o++]=h,s[o++]=f,l=h,u=f,h=p,f=y}return s[o++]=h,s[o++]=f,o}function _1(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=N4(n,e,f,i,r,s,o),l.push(o),e=f}return o}function yX(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u],p=[];o=_1(n,e,f,i,r,s,o,p),l.push(p),e=f[f.length-1]}return o}class pl extends g1{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new pl(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Hc(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let u=0;u<l;++u)i[u]=s[u];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return db(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return hb(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=R4(this.flatCoordinates,0,e,this.stride),this.changed()}}const Xi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},ml=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",D4=ml.includes("safari")&&!ml.includes("chrom");D4&&(ml.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ml));const M4=ml.includes("webkit")&&!ml.includes("edge"),Fb=ml.includes("macintosh"),L4=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ti=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Vb=typeof Image<"u"&&Image.prototype.decode,jb=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Be={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Jt(n,e,t,i){let r;return t&&t.length?r=t.shift():Ti?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let l0;function Op(){return l0||(l0=Jt(1,1)),l0}function Fm(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function kI(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function O4(n){for(;n.lastChild;)n.lastChild.remove()}function F4(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function zb(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Wo(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const v1=[NaN,NaN,NaN,0];let c0;function V4(){return c0||(c0=Jt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),c0}const j4=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,z4=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,U4=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,B4=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Og(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function ed(n){throw new Error('failed to parse "'+n+'" as color')}function Ub(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(z4)||n.match(j4)||n.match(U4);if(s){const o=s[4],l=100/255;return[Nt(Og(s[1],l)+.5|0,0,255),Nt(Og(s[2],l)+.5|0,0,255),Nt(Og(s[3],l)+.5|0,0,255),o!==void 0?Nt(Og(o,100),0,1):1]}ed(n)}if(n.startsWith("#")){if(B4.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let f=parseInt(s.substring(u,u+o),16);o===1&&(f+=f<<4),l[u/o]=f}return l[3]=l[3]/255,l}ed(n)}const e=V4();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&ed(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Ub(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=ef(r[3]/255,3),r}function G4(n){return typeof n=="string"?n:w1(n)}const W4=1024,Ih={};let u0=0;function $4(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function h0(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function d0(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function f0(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function g0(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function NI(n){const e=f0(n[0]),t=f0(n[1]),i=f0(n[2]),r=g0(e*.222488403+t*.716873169+i*.06060791),s=500*(g0(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-g0(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function K4(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=d0(e),s=d0(e+t/500*Math.cos(i)),o=d0(e-t/200*Math.sin(i)),l=h0(s*3.021973625-r*1.617392459-o*.404875592),u=h0(s*-.943766287+r*1.916279586+o*.027607165),h=h0(s*.069407491-r*.22898585+o*1.159737864);return[Nt(l+.5|0,0,255),Nt(u+.5|0,0,255),Nt(h+.5|0,0,255),n[3]]}function x1(n){if(n==="none")return v1;if(Ih.hasOwnProperty(n))return Ih[n];if(u0>=W4){let t=0;for(const i in Ih)(t++&3)===0&&(delete Ih[i],--u0)}const e=Ub(n);e.length!==4&&ed(n);for(const t of e)isNaN(t)&&ed(n);return Ih[n]=e,++u0,e}function uu(n){return Array.isArray(n)?n:x1(n)}function w1(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}function H4(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[bp(i,Ge.LOAD,function(){o=!0,s||e()})];return i.src&&Vb?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):l.push(bp(i,Ge.ERROR,t)),function(){r=!1,l.forEach(Rt)}}function X4(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function q4(n,e){return e&&(n.src=e),n.src&&Vb?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):X4(n)}class Y4{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=p0(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=p0(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=p0(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Be.IDLE&&r.load(),r.getImageState()===Be.LOADING?r.ready().then(()=>{this.patternCache_[o]=Op().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Op().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function p0(n,e,t){const i=t?uu(t):"null";return e+":"+n+":"+i}const qi=new Y4;let Ch=null;class Bb extends Am{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Be.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Be.LOADED){Ch||(Ch=Jt(1,1,void 0,{willReadFrequently:!0})),Ch.drawImage(this.image_,0,0);try{Ch.getImageData(0,0,1,1),this.tainted_=!1}catch{Ch=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Ge.CHANGE)}handleImageError_(){this.imageState_=Be.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Be.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Jt(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Be.IDLE){this.image_||this.initializeImage_(),this.imageState_=Be.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&q4(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Be.LOADED)return;const t=this.image_,i=Jt(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=G4(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Be.LOADED||this.imageState_===Be.ERROR)e();else{const t=()=>{(this.imageState_===Be.LOADED||this.imageState_===Be.ERROR)&&(this.removeEventListener(Ge.CHANGE,t),e())};this.addEventListener(Ge.CHANGE,t)}})),this.ready_}}function Fp(n,e,t,i,r,s){let o=e===void 0?void 0:qi.get(e,t,r);return o||(o=new Bb(n,n&&"src"in n?n.src||void 0:e,t,i,r),qi.set(e,t,r,o,s)),s&&o&&!qi.getPattern(e,t,r)&&qi.set(e,t,r,o,s),o}function Qr(n){return n?Array.isArray(n)?w1(n):typeof n=="object"&&"src"in n?Z4(n):n:null}function Z4(n){if(!n.offset||!n.size)return qi.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=qi.getPattern(e,void 0,n.color);if(t)return t;const i=qi.get(n.src,"anonymous",null);if(i.getImageState()!==Be.LOADED)return null;const r=Jt(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Fp(r.canvas,e,void 0,Be.LOADED,n.color,!0),qi.getPattern(e,void 0,n.color)}class Gb{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Fg="ol-hidden",nf="ol-unselectable",E1="ol-control",DI="ol-collapsed",Q4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),MI=["style","variant","weight","size","lineHeight","family"],Cv={normal:400,bold:700},Rv=function(n){const e=n.match(Q4);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=MI.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[MI[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in Cv&&(t.weight=Cv[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},Wb="10px sans-serif",ti="#000",hu="round",Gs=[],Ws=0,du="round",Td=10,Sd="#000",Id="center",Vp="middle",Ja=[0,0,0,0],Cd=1,kc=new cs;let Rh=null,LI;const Av={},J4=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function ej(n,e,t){return`${n} ${e} 16px "${t}"`}const tj=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=Rv(s),u=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const p=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),y=Cv[f.weight]||f.weight;return p===u&&f.style===l.style&&y==h})}async function r(){await t.ready;let s=!0;const o=kc.getProperties(),l=Object.keys(o).filter(u=>o[u]<100);for(let u=l.length-1;u>=0;--u){const h=l[u];let f=o[h];f<100&&(await i(h)?(Qd(Av),kc.set(h,100)):(f+=10,kc.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Ti?self.fonts:document.fonts);const o=Rv(s);if(!o)return;const l=o.families;let u=!1;for(const h of l){if(J4.has(h))continue;const f=ej(o.style,o.weight,h);kc.get(f)===void 0&&(kc.set(f,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),nj=(function(){let n;return function(e){let t=Av[e];if(t==null){if(Ti){const i=Rv(e),r=$b(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);Av[e]=t}return t}})();function $b(n,e){return Rh||(Rh=Jt(1,1)),n!=LI&&(Rh.font=n,LI=Rh.font),Rh.measureText(e)}function Kb(n,e){return $b(n,e).width}function OI(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,Kb(n,s)),0);return t[e]=i,i}function ij(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,u=0;for(let h=0,f=e.length;h<=f;h+=2){const p=e[h];if(p===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=u,u=0;continue}const y=e[h+1]||n.font,x=Kb(y,p);t.push(x),o+=x;const S=nj(y);i.push(S),u=Math.max(u,S)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function rj(n,e,t,i,r,s,o,l,u,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=p=>p.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(f[0],f[1]),sj(i,n)):f[0]<0||f[1]<0?(n.translate(u,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,u,h,o*f[0],l*f[1]),n.restore()}function sj(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class oj extends Gb{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?ef(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Er()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Xo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,p=s.length;f<p;f+=2){const y=s[f]-this.imageAnchorX_,x=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const S=y+this.imageAnchorX_,I=x+this.imageAnchorY_;Hs(l,S,I,1,1,h,-S,-I),o.save(),o.transform.apply(o,l),o.translate(S,I),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Xo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=Xo(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let u=l.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=C4(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(ri(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,u=s.length;l<u;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),aa(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Id;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Qr(i||ti)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),f=s||Gs;this.strokeState_={lineCap:r!==void 0?r:hu,lineDash:this.pixelRatio_===1?f:f.map(p=>p*this.pixelRatio_),lineDashOffset:(o||Ws)*this.pixelRatio_,lineJoin:l!==void 0?l:du,lineWidth:(u!==void 0?u:Cd)*this.pixelRatio_,miterLimit:h!==void 0?h:Td,strokeStyle:Qr(i||Sd)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const x=t.getColor();this.textFillState_={fillStyle:Qr(x||ti)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const x=i.getColor(),S=i.getLineCap(),I=i.getLineDash(),T=i.getLineDashOffset(),R=i.getLineJoin(),k=i.getWidth(),N=i.getMiterLimit();this.textStrokeState_={lineCap:S!==void 0?S:hu,lineDash:I||Gs,lineDashOffset:T||Ws,lineJoin:R!==void 0?R:du,lineWidth:k!==void 0?k:Cd,miterLimit:N!==void 0?N:Td,strokeStyle:Qr(x||Sd)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),f=e.getText(),p=e.getTextAlign(),y=e.getTextBaseline();this.textState_={font:r!==void 0?r:Wb,textAlign:p!==void 0?p:Id,textBaseline:y!==void 0?y:Vp},this.text_=f!==void 0?Array.isArray(f)?f.reduce((x,S,I)=>x+=I%2?" ":S,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const aj=.5,Hb={Point:pj,LineString:dj,Polygon:yj,MultiPoint:mj,MultiLineString:fj,MultiPolygon:gj,GeometryCollection:hj,Circle:cj};function lj(n,e){return parseInt(it(n),10)-parseInt(it(e),10)}function FI(n,e){const t=Xb(n,e);return t*t}function Xb(n,e){return aj*n/e}function cj(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}function VI(n,e,t,i,r,s,o,l){const u=[],h=t.getImage();if(h){let y=!0;const x=h.getImageState();x==Be.LOADED||x==Be.ERROR?y=!1:x==Be.IDLE&&h.load(),y&&u.push(h.ready())}const f=t.getFill();f&&f.loading()&&u.push(f.ready());const p=u.length>0;return p&&Promise.all(u).then(()=>r(null)),uj(n,e,t,i,s,o,l),p}function uj(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const u=l.simplifyTransformed(i,r);if(t.getRenderer())qb(n,u,t,e,o);else{const f=Hb[u.getType()];f(n,u,t,e,o,s)}}function qb(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,u=o.length;l<u;++l)qb(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function hj(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,u;for(l=0,u=o.length;l<u;++l){const h=Hb[o[l].getType()];h(n,o[l],t,i,r,s)}}function dj(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function fj(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function gj(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}function pj(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=Be.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function mj(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=Be.LOADED)return;const p=n.getBuilder(t.getZIndex(),"Image");p.setImageStyle(o,f),p.drawMultiPoint(e,i,r)}if(h){const p=n.getBuilder(t.getZIndex(),"Text");p.setTextStyle(u,f),p.drawText(e,i,r)}}function yj(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}let _j=!1;function vj(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=_j,l.onload=function(u){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function jI(n,e){return function(t,i,r,s,o){vj(n,e,t,i,r,(l,u)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function xj(n,e){return[[-1/0,-1/0,1/0,1/0]]}function wj(n,e,t,i){const r=[];let s=Qi();for(let o=0,l=t.length;o<l;++o){const u=t[o];s=o1(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function T1(n,e,t,i,r,s,o){let l,u,h,f,p,y,x;const S=r[s+1],I=[];for(let k=0,N=t.length;k<N;++k){const M=t[k];for(f=n[M-i],y=n[M-i+1],l=e;l<M;l+=i)p=n[l],x=n[l+1],(S<=y&&x<=S||y<=S&&S<=x)&&(h=(S-y)/(x-y)*(p-f)+f,I.push(h)),f=p,y=x}let T=NaN,R=-1/0;for(I.sort(Bs),f=I[0],l=1,u=I.length;l<u;++l){p=I[l];const k=Math.abs(p-f);k>R&&(h=(f+p)/2,p1(n,e,t,i,h,S)&&(T=h,R=k)),f=p}return isNaN(T)&&(T=r[s]),o?(o.push(T,S,R),o):[T,S,R]}function Ej(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const u=t[o];s=T1(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function Tj(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function S1(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],u=n[e+1];r+=(l-s)*(u+o),s=l,o=u}return r===0?void 0:r>0}function Yb(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=S1(n,e,l,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function _X(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!Yb(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function bv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=S1(n,e,l,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&Tj(n,e,l,i),e=l}return e}function vX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=bv(n,e,t[s],i,r);return e}function Sj(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const u=e[o],h=S1(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function Zb(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,u=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=u*h-l*f,l=h,u=f}return r/2}function Qb(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=Zb(n,e,l,i),e=l}return r}function xX(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=Qb(n,e,l,i),e=l[l.length-1]}return r}class Rd extends g1{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Rd(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<ub(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(bb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),kb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return Zb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return $c(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=y1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Rd(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Db(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ad extends g1{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?r1(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ad(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<ub(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Pb(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Nb(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return p1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Qb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),bv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Lp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=fl(this.getExtent());this.flatInteriorPoint_=T1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new pl(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Rd(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const u=i[o],h=new Rd(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Yb(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=bv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=_1(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Ad(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return Ob(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Mb(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function zI(n){if(Dm(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Ad(s,"XY",[s.length])}const UI=Er();class gr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?db(this.flatCoordinates_):o1(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=fl(this.getExtent());this.flatInteriorPoints_=T1(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Sj(this.flatCoordinates_,this.ends_),t=wj(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=Ej(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=bI(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=bI(e,t,o,2,.5);r1(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ai(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Bn(i)/Bn(t);Hs(UI,i[0],i[3],r,-r,0,0,0),Xo(this.flatCoordinates_,0,this.flatCoordinates_.length,2,UI,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new gr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=lb((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=y1(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=k4(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=_1(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new gr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}gr.prototype.getFlatCoordinates=gr.prototype.getOrientedFlatCoordinates;function Jb(n,e,t=0,i=n.length-1,r=Ij){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,f=Math.log(u),p=.5*Math.exp(2*f/3),y=.5*Math.sqrt(f*p*(u-p)/u)*(h-u/2<0?-1:1),x=Math.max(t,Math.floor(e-h*p/u+y)),S=Math.min(i,Math.floor(e+(u-h)*p/u+y));Jb(n,e,x,S,r)}const s=n[e];let o=t,l=i;for(Ah(n,t,e),r(n[i],s)>0&&Ah(n,t,i);o<l;){for(Ah(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?Ah(n,t,l):(l++,Ah(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function Ah(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function Ij(n,e){return n<e?-1:n>e?1:0}let eP=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!jg(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],u=t.leaf?r(l):l;jg(e,u)&&(t.leaf?i.push(l):y0(e,u)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!jg(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(jg(e,o)){if(t.leaf||y0(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Nc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=Cj(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&y0(i,r)?(s.push(i),o.push(l),l=0,u=i,i=i.children[0]):u?(l++,i=u.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=Nc(e.slice(t,i+1)),vc(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=Nc([]),l.leaf=!1,l.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));BI(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const p=Math.min(f+h-1,i);BI(e,f,p,u,this.compareMinY);for(let y=f;y<=p;y+=u){const x=Math.min(y+u-1,p);l.children.push(this._build(e,y,x,r-1))}}return vc(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let u=0;u<t.children.length;u++){const h=t.children[u],f=m0(h),p=bj(e,h)-f;p<o?(o=p,s=f<s?f:s,l=h):p===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Bh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=Nc(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,vc(i,this.toBBox),vc(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=Nc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,vc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const u=Uh(e,0,l,this.toBBox),h=Uh(e,l,i,this.toBBox),f=Pj(u,h),p=m0(u)+m0(h);f<s?(s=f,r=l,o=p<o?p:o):f===s&&p<o&&(o=p,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:Rj,s=e.leaf?this.compareMinY:Aj,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Uh(e,0,t,s),l=Uh(e,i-t,i,s);let u=Vg(o)+Vg(l);for(let h=t;h<i-t;h++){const f=e.children[h];Bh(o,e.leaf?s(f):f),u+=Vg(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];Bh(l,e.leaf?s(f):f),u+=Vg(l)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Bh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():vc(e[t],this.toBBox)}};function Cj(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function vc(n,e){Uh(n,0,n.children.length,e,n)}function Uh(n,e,t,i,r){r||(r=Nc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Bh(r,n.leaf?i(o):o)}return r}function Bh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function Rj(n,e){return n.minX-e.minX}function Aj(n,e){return n.minY-e.minY}function m0(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Vg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function bj(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function Pj(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function y0(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function jg(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Nc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function BI(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;Jb(n,o,e,t,r),s.push(e,o,o,t)}}class GI{constructor(e){this.rbush_=new eP(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[it(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=u,this.items_[it(l)]=u}this.rbush_.load(i)}remove(e){const t=it(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[it(t)],r=[i.minX,i.minY,i.maxX,i.maxY];wd(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return su(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return ta(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class tP extends cs{constructor(e){super(),this.projection=ai(e.projection),this.attributions_=WI(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=WI(e),this.changed()}setState(e){this.state_=e,this.changed()}}function WI(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const Wi={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Io extends Zs{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class I1 extends tP{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=xd,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(at(this.format_,"`format` must be set when `url` is set"),this.loader_=jI(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:xj;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new GI:null,this.loadedExtentsRtree_=new GI,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Hi(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=it(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Io(Wi.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof gr||(this.featureChangeKeys_[e]=[nt(t,Ge.CHANGE,this.handleFeatureChange_,this),nt(t,ru.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof gr){const s=this.idIndex_[r];s instanceof gr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(at(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],u=it(l);this.addToIndex_(u,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],u=it(l);this.setupChangeEvents_(u,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(Wi.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Io(Wi.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Wi.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(Wi.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(ei.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(ei.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Rt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Io(Wi.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof gr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof gr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),su(this.nullGeometryFeatures_)||r1(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=yb(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||vd,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const f=h.getGeometry(),p=l;if(l=f instanceof gr?0:f.closestPointXY(i,r,o,l),l<p){s=h;const y=Math.sqrt(l);u[0]=i-y,u[1]=r-y,u[2]=i+y,u[3]=r+y}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=it(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new Io(Wi.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:it(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&su(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const u=s[o];r.forEachInExtent(u,function(f){return zh(f.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Io(Wi.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new Io(Wi.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Io(Wi.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(wd(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=it(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Rt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(Wi.REMOVEFEATURE)&&this.dispatchEvent(new Io(Wi.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){at(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(jI(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Ir{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Ir({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Fp(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Be.IDLE&&t.load(),t.getImageState()===Be.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?it(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:uu(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Pu{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Pu({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function $I(n){return n[0]>0&&n[1]>0}function kj(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function oi(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Vm{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=oi(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Vm({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return tt()}getImage(e){return tt()}getHitDetectionImage(){return tt()}getPixelRatio(e){return 1}getImageState(){return tt()}getImageSize(){return tt()}getOrigin(){return tt()}getSize(){return tt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=oi(e)}listenImageChange(e){tt()}load(){tt()}unlistenImageChange(e){tt()}ready(){return Promise.resolve()}}class jm extends Vm{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Be.LOADING:Be.LOADED,this.imageState_===Be.LOADING&&this.ready().then(()=>this.imageState_=Be.LOADED),this.render()}clone(){const e=this.getScale(),t=new jm({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=qi.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=Jt(o,o);this.draw_(s,l,e),r=l.canvas,qi.set(i,null,null,new Bb(r,void 0,null,Be.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const U=r;r=s,s=U}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,u=s*Math.sin(l),h=Math.sqrt(s*s-u*u),f=r-h,p=Math.sqrt(u*u+f*f),y=p/u;if(e==="miter"&&y<=i)return y*t;const x=t/2/y,S=t/2*(f/p),T=Math.sqrt((r+x)*(r+x)+S*S)-r;if(this.radius2_===void 0||e==="bevel")return T*2;const R=r*Math.sin(l),k=Math.sqrt(r*r-R*R),N=s-k,F=Math.sqrt(R*R+N*N)/R;if(F<=i){const U=F*t/2-s-r;return 2*Math.max(T,U)}return T*2}createRenderOptions(){let e=hu,t=du,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=Qr(this.stroke_.getColor()??Sd),l=this.stroke_.getWidth()??Cd,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??du,e=this.stroke_.getLineCap()??hu,i=this.stroke_.getMiterLimit()??Td);const u=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ti),t.fillStyle=Qr(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=uu(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Jt(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const u=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ti,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class kl extends jm{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new kl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Zi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=KI,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Zi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=KI,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function Nj(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(at(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let _0=null;function nP(n,e){if(!_0){const t=new Ir({color:"rgba(255,255,255,0.4)"}),i=new Pu({color:"#3399CC",width:1.25});_0=[new Zi({image:new kl({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return _0}function KI(n){return n.getGeometry()}const Dj="#333";class rf{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=oi(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Ir({color:Dj}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new rf({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Ir?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=oi(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Mn={ANIMATING:0,INTERACTING:1},Ie={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},zg=[Ie.FILL],$o=[Ie.STROKE],el=[Ie.BEGIN_PATH],HI=[Ie.CLOSE_PATH];class sf extends Gb{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,u=e.length;l<u;l+=t)r[0]=e[l],r[1]=e[l+1],au(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let u=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],p=e[t+1];const y=this.tmpCoordinate_;let x=!0,S,I,T;for(S=t+r;S<i;S+=r)y[0]=e[S],y[1]=e[S+1],T=yv(h,y),T!==I?(x&&(l[u++]=f,l[u++]=p,x=!1),l[u++]=y[0],l[u++]=y[1]):T===ln.INTERSECTING?(l[u++]=y[0],l[u++]=y[1],x=!1):x=!0,f=y[0],p=y[1],I=T;return(s&&x||S===t+r)&&(l[u++]=f,l[u++]=p),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),u=this.coordinates.length;let h,f,p,y,x;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),y=[];const S=e.getEndss();x=0;for(let I=0,T=S.length;I<T;++I){const R=[];x=this.drawCustomCoordinates_(h,x,S[I],l,R),y.push(R)}this.instructions.push([Ie.CUSTOM,u,y,e,i,AI,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,y,e,r||i,AI,s]);break;case"Polygon":case"MultiLineString":p=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),x=this.drawCustomCoordinates_(h,0,e.getEnds(),l,p),this.instructions.push([Ie.CUSTOM,u,p,e,i,Lp,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,p,e,r||i,Lp,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Ie.CUSTOM,u,f,e,i,$c,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,$c,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>u&&(this.instructions.push([Ie.CUSTOM,u,f,e,i,$c,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,$c,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Ie.CUSTOM,u,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Ie.CUSTOM,u,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Ie.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ie.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Ie.END_GEOMETRY?o=t:s==Ie.BEGIN_GEOMETRY&&(r[2]=t,I5(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Qr(i||ti)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Qr(i||Sd);const r=e.getLineCap();t.lineCap=r!==void 0?r:hu;const s=e.getLineDash();t.lineDash=s?s.slice():Gs;const o=e.getLineDashOffset();t.lineDashOffset=o||Ws;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:du;const u=e.getWidth();t.lineWidth=u!==void 0?u:Cd;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Td,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Ie.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ie.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!aa(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Ie.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=cb(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;s1(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Mj extends sf{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!au(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Ie.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||au(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ie.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class Lj extends sf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Ie.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws],el);const l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push($o),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws],el);const l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,y=l.length;p<y;++p)f=this.drawFlatCoordinates_(u,f,l[p],h);this.hitDetectionInstructions.push($o),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push($o),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push($o),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(el)}}class XI extends sf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,u=i.length;this.instructions.push(el),this.hitDetectionInstructions.push(el);for(let h=0;h<u;++h){const f=i[h],p=this.coordinates.length,y=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),x=[Ie.MOVE_TO_LINE_TO,p,y];this.instructions.push(x),this.hitDetectionInstructions.push(x),l&&(this.instructions.push(HI),this.hitDetectionInstructions.push(HI)),t=f}return o&&(this.instructions.push(zg),this.hitDetectionInstructions.push(zg)),l&&(this.instructions.push($o),this.hitDetectionInstructions.push($o)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);const f=[Ie.CIRCLE,h];this.instructions.push(el,f),this.hitDetectionInstructions.push(el,f),r.fillStyle!==void 0&&(this.instructions.push(zg),this.hitDetectionInstructions.push(zg)),r.strokeStyle!==void 0&&(this.instructions.push($o),this.hitDetectionInstructions.push($o)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ie.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,y=l.length;p<y;++p)f=this.drawFlatCoordinatess_(u,f,l[p],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=za(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function Oj(n,e,t,i,r){const s=[];let o=t,l=0,u=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=u.slice(-2),p=e[o+r],y=e[o+r+1],x=Math.sqrt((p-h)*(p-h)+(y-f)*(y-f));if(l+=x,l>=n){const S=(n-l+x)/x,I=xi(h,p,S),T=xi(f,y,S);u.push(I,T),s.push(u),u=[I,T],l==n&&(o+=r),l=0}else if(l<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const S=x-l,I=xi(h,p,S/x),T=xi(f,y,S/x);u.push(I,T),s.push(u),u=[I,T],l=0,o+=r}}return l>0&&s.push(u),s}function Fj(n,e,t,i,r){let s=t,o=t,l=0,u=0,h=t,f,p,y,x,S,I,T,R,k,N;for(p=t;p<i;p+=r){const M=e[p],F=e[p+1];S!==void 0&&(k=M-S,N=F-I,x=Math.sqrt(k*k+N*N),T!==void 0&&(u+=y,f=Math.acos((T*k+R*N)/(y*x)),f>n&&(u>l&&(l=u,s=h,o=p),u=0,h=p-r)),y=x,T=k,R=N),S=M,I=F}return u+=x,u>l?[h,p]:[s,o]}const jp={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Vj extends sf{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ti]={fillStyle:ti},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let u=l.length;const h=e.getType();let f=null,p=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!ri(this.maxExtent,e.getExtent()))return;let y;if(f=e.getFlatCoordinates(),h=="LineString")y=[f.length];else if(h=="MultiLineString")y=e.getEnds();else if(h=="Polygon")y=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const T=e.getEndss();y=[];for(let R=0,k=T.length;R<k;++R)y.push(T[R][0])}this.beginGeometry(e,t,i);const x=o.repeat,S=x?void 0:o.textAlign;let I=0;for(let T=0,R=y.length;T<R;++T){let k;x?k=Oj(x*this.resolution,f,I,y[T],p):k=[f.slice(I,y[T])];for(let N=0,M=k.length;N<M;++N){const F=k[N];let U=0,P=F.length;if(S==null){const D=Fj(o.maxAngle,F,0,F.length,2);U=D[0],P=D[1]}for(let D=U;D<P;D+=p)l.push(F[D],F[D+1]);const A=l.length;I=y[T],this.drawChars_(u,A),u=A}}this.endGeometry(t)}else{let y=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),p=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||y.push(f[2]/this.resolution),p=3;break;case"MultiPolygon":const M=e.getFlatInteriorPoints();f=[];for(let F=0,U=M.length;F<U;F+=3)o.overflow||y.push(M[F+2]/this.resolution),f.push(M[F],M[F+1]);if(f.length===0)return;p=2;break}const x=this.appendFlatPointCoordinates(f,p);if(x===u)return;if(y&&(x-u)/2!==f.length/p){let M=u/2;y=y.filter((F,U)=>{const P=l[(M+U)*2]===f[U*p]&&l[(M+U)*2+1]===f[U*p+1];return P||--M,P})}this.saveTextStates_();const S=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,I=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let T=o.padding;if(T!=Ja&&(o.scale[0]<0||o.scale[1]<0)){let M=o.padding[0],F=o.padding[1],U=o.padding[2],P=o.padding[3];o.scale[0]<0&&(F=-F,P=-P),o.scale[1]<0&&(M=-M,U=-U),T=[M,F,U,P]}const R=this.pixelRatio;this.instructions.push([Ie.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,T==Ja?Ja:T.map(function(M){return M*R}),S,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]);const k=1/R,N=S?S.slice(0):null;N&&(N[1]=ti),this.hitDetectionInstructions.push([Ie.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[k,k],NaN,this.declutterMode_,this.declutterImageWithText_,T,N,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ti:this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Id,justify:t.justify,textBaseline:t.textBaseline||Vp,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=jp[r.textBaseline],f=this.textOffsetY_*u,p=this.text_,y=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Ie.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,u,f,s,y*u,p,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ie.DRAW_CHARS,e,t,h,r.overflow,l&&ti,r.maxAngle,u,f,s,y*u,p,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Qr(o.getColor()||ti)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const I=l.getLineDash(),T=l.getLineDashOffset(),R=l.getWidth(),k=l.getMiterLimit();s.lineCap=l.getLineCap()||hu,s.lineDash=I?I.slice():Gs,s.lineDashOffset=T===void 0?Ws:T,s.lineJoin=l.getLineJoin()||du,s.lineWidth=R===void 0?Cd:R,s.miterLimit=k===void 0?Td:k,s.strokeStyle=Qr(l.getColor()||Sd)}i=this.textState_;const u=e.getFont()||Wb;tj(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Vp,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||Ja,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),p=e.getOffsetY(),y=e.getRotateWithView(),x=e.getKeepUpright(),S=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=p===void 0?0:p,this.textRotateWithView_=y===void 0?!1:y,this.textKeepUpright_=x===void 0?!0:x,this.textRotation_=S===void 0?0:S,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:it(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+it(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const jj={Circle:XI,Default:sf,Image:Mj,LineString:Lj,Polygon:XI,Text:Vj};class zj{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=jj[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function Uj(n,e,t,i,r,s,o,l,u,h,f,p,y=!0){let x=n[e],S=n[e+1],I=0,T=0,R=0,k=0;function N(){I=x,T=S,e+=i,x=n[e],S=n[e+1],k+=R,R=Math.sqrt((x-I)*(x-I)+(S-T)*(S-T))}do N();while(e<t-i&&k+R<s);let M=R===0?0:(s-k)/R;const F=xi(I,x,M),U=xi(T,S,M),P=e-i,A=k,D=s+l*u(h,r,f);for(;e<t-i&&k+R<D;)N();M=R===0?0:(D-k)/R;const V=xi(I,x,M),j=xi(T,S,M);let B=!1;if(y)if(p){const ue=[F,U,V,j];Ab(ue,0,4,2,p,ue,ue),B=ue[0]>ue[2]}else B=F>V;const L=Math.PI,le=[],pe=P+i===e;e=P,R=0,k=A,x=n[e],S=n[e+1];let ge;if(pe){N(),ge=Math.atan2(S-T,x-I),B&&(ge+=ge>0?-L:L);const ue=(V+F)/2,Q=(j+U)/2;return le[0]=[ue,Q,(D-s)/2,ge,r],le}r=r.replace(/\n/g," ");for(let ue=0,Q=r.length;ue<Q;){N();let se=Math.atan2(S-T,x-I);if(B&&(se+=se>0?-L:L),ge!==void 0){let xe=se-ge;if(xe+=xe>L?-2*L:xe<-L?2*L:0,Math.abs(xe)>o)return null}ge=se;const ne=ue;let W=0;for(;ue<Q;++ue){const xe=B?Q-ue-1:ue,ke=l*u(h,r[xe],f);if(e+i<t&&k+R<s+W+ke/2)break;W+=ke}if(ue===ne)continue;const $=B?r.substring(Q-ne,Q-ue):r.substring(ne,ue);M=R===0?0:(s+W/2-k)/R;const ie=xi(I,x,M),me=xi(T,S,M);le.push([ie,me,W/2,se,$]),s+=W}return le}class iP{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Op(),{get:(e,t)=>{if(typeof Op()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const xc=Qi(),Co=[],ks=[],Ns=[],Ro=[];function qI(n){return n[3].declutterBox}const YI=new RegExp("[-----]");function v0(n,e){return e==="start"?e=YI.test(n)?"right":"left":e==="end"&&(e=YI.test(n)?"left":"right"),jp[e]}function Bj(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function Gj(n,e,t){return t%2===0&&(n+=e),n}class Wj{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Er(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new iP:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,f=[u.scale[0]*h,u.scale[1]*h],p=u.justify?jp[u.justify]:v0(Array.isArray(e)?e[0]:e,u.textAlign||Id),y=r&&o.lineWidth?o.lineWidth:0,x=Array.isArray(e)?e:String(e).split(`
`).reduce(Bj,[]),{width:S,height:I,widths:T,heights:R,lineWidths:k}=ij(u,x),N=S+y,M=[],F=(N+2)*f[0],U=(I+y)*f[1],P={width:F<0?Math.floor(F):Math.ceil(F),height:U<0?Math.floor(U):Math.ceil(U),contextInstructions:M};(f[0]!=1||f[1]!=1)&&M.push("scale",f),r&&(M.push("strokeStyle",o.strokeStyle),M.push("lineWidth",y),M.push("lineCap",o.lineCap),M.push("lineJoin",o.lineJoin),M.push("miterLimit",o.miterLimit),M.push("setLineDash",[o.lineDash]),M.push("lineDashOffset",o.lineDashOffset)),i&&M.push("fillStyle",l.fillStyle),M.push("textBaseline","middle"),M.push("textAlign","center");const A=.5-p;let D=p*N+A*y;const V=[],j=[];let B=0,L=0,le=0,pe=0,ge;for(let ue=0,Q=x.length;ue<Q;ue+=2){const se=x[ue];if(se===`
`){L+=B,B=0,D=p*N+A*y,++pe;continue}const ne=x[ue+1]||u.font;ne!==ge&&(r&&V.push("font",ne),i&&j.push("font",ne),ge=ne),B=Math.max(B,R[le]);const W=[se,D+A*T[le]+p*(T[le]-k[pe]),.5*(y+B)+L];D+=T[le],r&&V.push("strokeText",W),i&&j.push("fillText",W),++le}return Array.prototype.push.apply(M,V),Array.prototype.push.apply(M,j),this.labels_[s]=P,P}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,u,h,f,p,y,x,S,I,T){l*=y[0],u*=y[1];let R=i-l,k=r-u;const N=s+h>e?e-h:s,M=o+f>t?t-f:o,F=S[3]+N*y[0]+S[1],U=S[0]+M*y[1]+S[2],P=R-S[3],A=k-S[0];(I||p!==0)&&(Co[0]=P,Ro[0]=P,Co[1]=A,ks[1]=A,ks[0]=P+F,Ns[0]=ks[0],Ns[1]=A+U,Ro[1]=Ns[1]);let D;return p!==0?(D=Hs(Er(),i,r,1,1,p,-i,-r),un(D,Co),un(D,ks),un(D,Ns),un(D,Ro),ta(Math.min(Co[0],ks[0],Ns[0],Ro[0]),Math.min(Co[1],ks[1],Ns[1],Ro[1]),Math.max(Co[0],ks[0],Ns[0],Ro[0]),Math.max(Co[1],ks[1],Ns[1],Ro[1]),xc)):ta(Math.min(P,P+F),Math.min(A,A+U),Math.max(P,P+F),Math.max(A,A+U),xc),x&&(R=Math.round(R),k=Math.round(k)),{drawImageX:R,drawImageY:k,drawImageW:N,drawImageH:M,originX:h,originY:f,declutterBox:{minX:xc[0],minY:xc[1],maxX:xc[2],maxY:xc[3],value:T},canvasTransform:D,scale:y}}replayImageOrLabel_(e,t,i,r,s,o,l){const u=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(u&&this.replayTextBackground_(e,Co,ks,Ns,Ro,o,l),rj(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=un(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],u=this.pixelRatio,h=v0(Array.isArray(e)?e[0]:e,s.textAlign||Id),f=jp[s.textBaseline||Vp],p=l&&l.lineWidth?l.lineWidth:0,y=o.width/u-2*s.scale[0],x=h*y+2*(.5-h)*p,S=f*o.height/u+2*(.5-f)*p;return{label:o,anchorX:x,anchorY:S}}execute_(e,t,i,r,s,o,l,u){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&aa(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=Xo(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),m4(this.renderedTransform_,i));let p=0;const y=r.length;let x=0,S,I,T,R,k,N,M,F,U,P,A,D,V,j=0,B=0;const L=this.coordinateCache_,le=this.viewRotation_,pe=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ge={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:le},ue=this.instructions!=r||this.overlaps?0:200;let Q,se,ne,W;for(;p<y;){const $=r[p];switch($[0]){case Ie.BEGIN_GEOMETRY:Q=$[1],W=$[3],Q.getGeometry()?l!==void 0&&!ri(l,W.getExtent())?p=$[2]+1:++p:p=$[2],h&&(h.zIndex=$[4]);break;case Ie.BEGIN_PATH:j>ue&&(this.fill_(e),j=0),B>ue&&(e.stroke(),B=0),!j&&!B&&(e.beginPath(),k=NaN,N=NaN),++p;break;case Ie.CIRCLE:x=$[1];const me=f[x],xe=f[x+1],ke=f[x+2],Me=f[x+3],Ve=ke-me,We=Me-xe,lt=Math.sqrt(Ve*Ve+We*We);e.moveTo(me+lt,xe),e.arc(me,xe,lt,0,2*Math.PI,!0),++p;break;case Ie.CLOSE_PATH:e.closePath(),++p;break;case Ie.CUSTOM:x=$[1],S=$[2];const er=$[3],fs=$[4],Wn=$[5];ge.geometry=er,ge.feature=Q,p in L||(L[p]=[]);const $n=L[p];Wn?Wn(f,x,S,2,$n):($n[0]=f[x],$n[1]=f[x+1],$n.length=2),h&&(h.zIndex=$[6]),fs($n,ge),++p;break;case Ie.DRAW_IMAGE:x=$[1],S=$[2],U=$[3],I=$[4],T=$[5];let hn=$[6];const dn=$[7],Kn=$[8],bi=$[9],yt=$[10];let ct=$[11];const nn=$[12];let Pi=$[13];R=$[14]||"declutter";const St=$[15];if(!U&&$.length>=20){P=$[19],A=$[20],D=$[21],V=$[22];const Ot=this.drawLabelWithPointPlacement_(P,A,D,V);U=Ot.label,$[3]=U;const Di=$[23];I=(Ot.anchorX-Di)*this.pixelRatio,$[4]=I;const fn=$[24];T=(Ot.anchorY-fn)*this.pixelRatio,$[5]=T,hn=U.height,$[6]=hn,Pi=U.width,$[13]=Pi}let to;$.length>25&&(to=$[25]);let ki,Rr,tr;$.length>17?(ki=$[16],Rr=$[17],tr=$[18]):(ki=Ja,Rr=null,tr=null),yt&&pe?ct+=le:!yt&&!pe&&(ct-=le);let Ar=0;for(;x<S;x+=2){if(to&&to[Ar++]<Pi/this.pixelRatio)continue;const Ot=this.calculateImageOrLabelDimensions_(U.width,U.height,f[x],f[x+1],Pi,hn,I,T,Kn,bi,ct,nn,s,ki,!!Rr||!!tr,Q),Di=[e,t,U,Ot,dn,Rr,tr];if(u){let fn,Ft,gn;if(St){const rt=S-x;if(!St[rt]){St[rt]={args:Di,declutterMode:R};continue}const Gt=St[rt];fn=Gt.args,Ft=Gt.declutterMode,delete St[rt],gn=qI(fn)}let pn,rn;if(fn&&(Ft!=="declutter"||!u.collides(gn))&&(pn=!0),(R!=="declutter"||!u.collides(Ot.declutterBox))&&(rn=!0),Ft==="declutter"&&R==="declutter"){const rt=pn&&rn;pn=rt,rn=rt}pn&&(Ft!=="none"&&u.insert(gn),this.replayImageOrLabel_.apply(this,fn)),rn&&(R!=="none"&&u.insert(Ot.declutterBox),this.replayImageOrLabel_.apply(this,Di))}else this.replayImageOrLabel_.apply(this,Di)}++p;break;case Ie.DRAW_CHARS:const ca=$[1],br=$[2],Ni=$[3],Ol=$[4];V=$[5];const Pr=$[6],gs=$[7],no=$[8];D=$[9];const On=$[10];P=$[11],Array.isArray(P)&&(P=P.reduce(Gj,"")),A=$[12];const ps=[$[13],$[13]];R=$[14]||"declutter";const kr=$[15],Nr=this.textStates[A],Fn=Nr.font,Vn=[Nr.scale[0]*gs,Nr.scale[1]*gs];let ft;Fn in this.widths_?ft=this.widths_[Fn]:(ft={},this.widths_[Fn]=ft);const io=P4(f,ca,br,2),nr=Math.abs(Vn[0])*OI(Fn,P,ft);if(Ol||nr<=io){const Ot=this.textStates[A].textAlign,Di=(io-nr)*v0(P,Ot),fn=Uj(f,ca,br,2,P,Di,Pr,Math.abs(Vn[0]),OI,Fn,ft,pe?0:this.viewRotation_,kr);e:if(fn){const Ft=[];let gn,pn,rn,rt,Gt;if(D)for(gn=0,pn=fn.length;gn<pn;++gn){Gt=fn[gn],rn=Gt[4],rt=this.createLabel(rn,A,"",D),I=Gt[2]+(Vn[0]<0?-On:On),T=Ni*rt.height+(.5-Ni)*2*On*Vn[1]/Vn[0]-no;const qt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Gt[0],Gt[1],rt.width,rt.height,I,T,0,0,Gt[3],ps,!1,Ja,!1,Q);if(u&&R==="declutter"&&u.collides(qt.declutterBox))break e;Ft.push([e,t,rt,qt,1,null,null])}if(V)for(gn=0,pn=fn.length;gn<pn;++gn){Gt=fn[gn],rn=Gt[4],rt=this.createLabel(rn,A,V,""),I=Gt[2],T=Ni*rt.height-no;const qt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Gt[0],Gt[1],rt.width,rt.height,I,T,0,0,Gt[3],ps,!1,Ja,!1,Q);if(u&&R==="declutter"&&u.collides(qt.declutterBox))break e;Ft.push([e,t,rt,qt,1,null,null])}u&&R!=="none"&&u.load(Ft.map(qI));for(let qt=0,Mi=Ft.length;qt<Mi;++qt)this.replayImageOrLabel_.apply(this,Ft[qt])}}++p;break;case Ie.END_GEOMETRY:if(o!==void 0){Q=$[1];const Ot=o(Q,W,R);if(Ot)return Ot}++p;break;case Ie.FILL:ue?j++:this.fill_(e),++p;break;case Ie.MOVE_TO_LINE_TO:for(x=$[1],S=$[2],se=f[x],ne=f[x+1],e.moveTo(se,ne),k=se+.5|0,N=ne+.5|0,x+=2;x<S;x+=2)se=f[x],ne=f[x+1],M=se+.5|0,F=ne+.5|0,(x==S-2||M!==k||F!==N)&&(e.lineTo(se,ne),k=M,N=F);++p;break;case Ie.SET_FILL_STYLE:this.alignAndScaleFill_=$[2],j&&(this.fill_(e),j=0,B&&(e.stroke(),B=0)),e.fillStyle=$[1],++p;break;case Ie.SET_STROKE_STYLE:B&&(e.stroke(),B=0),this.setStrokeStyle_(e,$),++p;break;case Ie.STROKE:ue?B++:e.stroke(),++p;break;default:++p;break}}j&&this.fill_(e),B&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const $a=["Polygon","Circle","LineString","Image","Text","Default"],rP=["Image","Text"],$j=$a.filter(n=>!rP.includes(n));class Kj{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Er(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new Wj(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,u=Hs(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Jt(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let p;this.renderBuffer_!==void 0&&(p=Qi(),Jh(p,e),s1(p,t*(this.renderBuffer_+r),p));const y=Hj(r);let x;function S(F,U,P){const A=f.getImageData(0,0,l,l).data;for(let D=0,V=y.length;D<V;D++)if(A[y[D]]>0){if(!o||P==="none"||x!=="Image"&&x!=="Text"||o.includes(F)){const j=(y[D]-3)/4,B=r-j%l,L=r-(j/l|0),le=s(F,U,B*B+L*L);if(le)return le}f.clearRect(0,0,l,l);break}}const I=Object.keys(this.executorsByZIndex_).map(Number);I.sort(Bs);let T,R,k,N,M;for(T=I.length-1;T>=0;--T){const F=I[T].toString();for(k=this.executorsByZIndex_[F],R=$a.length-1;R>=0;--R)if(x=$a[R],N=k[x],N!==void 0&&(M=N.executeHitDetection(f,u,i,S,p),M))return M}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return Xo(l,0,8,2,e,l),l}isEmpty(){return su(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(l?S5:Bs),o=o||$a;const h=$a.length;for(let f=0,p=u.length;f<p;++f){const y=u[f].toString(),x=this.executorsByZIndex_[y];for(let S=0,I=o.length;S<I;++S){const T=o[S],R=x[T];if(R!==void 0){const k=l===null?void 0:R.getZIndexContext(),N=k?k.getContext():e,M=this.maxExtent_&&T!=="Image"&&T!=="Text";if(M&&(N.save(),this.clip(N,i)),!k||T==="Text"||T==="Image"?R.execute(N,t,i,r,s,l):k.pushFunction(F=>R.execute(F,t,i,r,s,l)),M&&N.restore(),k){k.offset();const F=u[f]*h+$a.indexOf(T);this.deferredZIndexContexts_[F]||(this.deferredZIndexContexts_[F]=[]),this.deferredZIndexContexts_[F].push(k)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Bs);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const x0={};function Hj(n){if(x0[n]!==void 0)return x0[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let u=i[l];u||(u=[],i[l]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return x0[n]=r,r}function ZI(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let C1=class sP extends Vm{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;at(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||it(o)),at(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),at(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=Be.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?Be.LOADED:Be.IDLE:u=Be.LOADING:u=Be.LOADED),this.color_=e.color!==void 0?uu(e.color):null,this.iconImage_=Fp(o,l,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const p=this.getImage(1);if(p.width&&p.height)h=p.width,f=p.height;else if(p instanceof HTMLImageElement){this.initialOptions_=e;const y=()=>{if(this.unlistenImageChange(y),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale(ZI(x[0],x[1],e.width,e.height))};this.listenImageChange(y);return}}h!==void 0&&this.setScale(ZI(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new sP({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=Fp(null,e,this.crossOrigin_,Be.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Be.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Be.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Ge.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Ge.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Yr=.5;function Xj(n,e,t,i,r,s,o,l,u){const h=r,f=n[0]*Yr,p=n[1]*Yr,y=Jt(f,p);y.imageSmoothingEnabled=!1;const x=y.canvas,S=new oj(y,Yr,r,null,o,l,null),I=t.length,T=Math.floor((256*256*256-1)/I),R={};for(let N=1;N<=I;++N){const M=t[N-1],F=M.getStyleFunction()||i;if(!F)continue;let U=F(M,s);if(!U)continue;Array.isArray(U)||(U=[U]);const A=(N*T).toString(16).padStart(7,"#00000");for(let D=0,V=U.length;D<V;++D){const j=U[D],B=j.getGeometryFunction()(M);if(!B||!ri(h,B.getExtent()))continue;const L=j.clone(),le=L.getFill();le&&le.setColor(A);const pe=L.getStroke();pe&&(pe.setColor(A),pe.setLineDash(null)),L.setText(void 0);const ge=j.getImage();if(ge){const ne=ge.getImageSize();if(!ne)continue;const W=Jt(ne[0],ne[1],void 0,{alpha:!1}),$=W.canvas;W.fillStyle=A,W.fillRect(0,0,$.width,$.height),L.setImage(new C1({img:$,anchor:ge.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ge.getOrigin(),opacity:1,size:ge.getSize(),scale:ge.getScale(),rotation:ge.getRotation(),rotateWithView:ge.getRotateWithView()}))}const ue=L.getZIndex()||0;let Q=R[ue];Q||(Q={},R[ue]=Q,Q.Polygon=[],Q.Circle=[],Q.LineString=[],Q.Point=[]);const se=B.getType();if(se==="GeometryCollection"){const ne=B.getGeometriesArrayRecursive();for(let W=0,$=ne.length;W<$;++W){const ie=ne[W];Q[ie.getType().replace("Multi","")].push(ie,L)}}else Q[se.replace("Multi","")].push(B,L)}}const k=Object.keys(R).map(Number).sort(Bs);for(let N=0,M=k.length;N<M;++N){const F=R[k[N]];for(const U in F){const P=F[U];for(let A=0,D=P.length;A<D;A+=2){S.setStyle(P[A+1]);for(let V=0,j=e.length;V<j;++V)S.setTransform(e[V]),S.drawGeometry(P[A])}}}return y.getImageData(0,0,x.width,x.height)}function qj(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Yr),s=Math.floor(Math.round(n[1])*Yr),o=(Nt(r,0,t.width-1)+Nt(s,0,t.height-1)*t.width)*4,l=t.data[o],u=t.data[o+1],f=t.data[o+2]+256*(u+256*l),p=Math.floor((256*256*256-1)/e.length);f&&f%p===0&&i.push(e[f/p-1])}return i}class oP extends Zs{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const Yj=5;class Zj extends Jd{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=Yj}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return tt()}getData(e){return null}prepareFrame(e){return tt()}renderFrame(e,t){return tt()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Be.LOADED||t.getState()===Be.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Be.LOADED&&t!=Be.ERROR&&e.addEventListener(Ge.CHANGE,this.boundHandleImageChange_),t==Be.IDLE&&(e.load(),t=e.getState()),t==Be.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const QI=[];let Dc=null;function Qj(){Dc=Jt(1,1,void 0,{willReadFrequently:!0})}class aP extends Zj{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Er(),this.pixelTransform=Er(),this.inversePixelTransform=Er(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Dc||Qj(),Dc.clearRect(0,0,1,1);let r;try{Dc.drawImage(e,t,i,1,1,0,0,1,1),r=Dc.getImageData(0,0,1,1).data}catch{return Dc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&aa(uu(e.style.backgroundColor),uu(i)))){const l=e.firstElementChild;Wo(l)&&(o=l.getContext("2d"))}if(o&&x4(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Ti?zb():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Jt();const u=o.canvas;s.appendChild(u),l=u.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Pl(i),s=Nm(i),o=km(i),l=Pm(i);un(t.coordinateToPixelTransform,r),un(t.coordinateToPixelTransform,s),un(t.coordinateToPixelTransform,o),un(t.coordinateToPixelTransform,l);const u=this.inversePixelTransform;un(u,r),un(u,s),un(u,o),un(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(dt(i)/r*o),u=Math.round(Bn(i)/r*o);Hs(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-u/2),Rb(this.inversePixelTransform,this.pixelTransform);const h=v4(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=u?(f.width=l,f.height=u):this.context.clearRect(0,0,l,u),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new oP(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Xi.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Xi.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new iP),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Xi.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Xi.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const u=s/2,h=o/2,f=r/t,p=-f,y=-e[0]+l,x=-e[1];return Hs(this.tempTransform,u,h,f,p,-i,y,x)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class Jj extends aP{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Qi(),this.wrappedRenderedExtent_=Qi(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,u=s.projection,h=s.rotation,f=u.getExtent(),p=this.getLayer().getSource(),y=this.getLayer().getDeclutter(),x=t.pixelRatio,S=t.viewHints,I=!(S[Mn.ANIMATING]||S[Mn.INTERACTING]),T=this.context,R=Math.round(dt(r)/l*x),k=Math.round(Bn(r)/l*x),N=p.getWrapX()&&u.canWrapX(),M=N?dt(f):null,F=N?Math.ceil((r[2]-f[2])/M)+1:1;let U=N?Math.floor((r[0]-f[0])/M):0;do{let P=this.getRenderTransform(o,l,0,x,R,k,U*M);t.declutter&&(P=P.slice(0)),e.execute(T,[T.canvas.width,T.canvas.height],P,h,I,i===void 0?$a:i?rP:$j,i?y&&t.declutter[y]:void 0)}while(++U<F)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Jt(this.context.canvas.width,this.context.canvas.height,QI))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Fm(this.context),QI.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(Xi.PRERENDER)||this.getLayer().hasListener(Xi.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const u=Go(i.extent);l=ri(u,e.extent),this.clipped_=l&&!zh(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],p=i[0]*Yr,y=i[1]*Yr;f.push(this.getRenderTransform(r,s,o,Yr,p,y,0).slice());const x=h.getSource(),S=l.getExtent();if(x.getWrapX()&&l.canWrapX()&&!zh(S,u)){let I=u[0];const T=dt(S);let R=0,k;for(;I<S[0];)--R,k=T*R,f.push(this.getRenderTransform(r,s,o,Yr,p,y,k).slice()),I+=T;for(R=0,I=u[2];I>S[2];)++R,k=T*R,f.push(this.getRenderTransform(r,s,o,Yr,p,y,k).slice()),I-=T}this.hitDetectionImageData_=Xj(i,f,this.renderedFeatures_,h.getStyleFunction(),u,s,o,FI(s,this.renderedPixelRatio_))}t(qj(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},f=function(y,x,S){const I=it(y),T=h[I];if(T){if(T!==!0&&S<T.distanceSq){if(S===0)return h[I]=!0,s.splice(s.lastIndexOf(T),1),r(y,u,x);T.geometry=x,T.distanceSq=S}}else{if(S===0)return h[I]=!0,r(y,u,x);s.push(h[I]={feature:y,layer:u,geometry:x,distanceSq:S,callback:r})}},p=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,p?t.declutter?.[p]?.all().map(y=>y.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Mn.ANIMATING],s=e.viewHints[Mn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,f=h.projection,p=h.resolution,y=e.pixelRatio,x=t.getRevision(),S=t.getRenderBuffer();let I=t.getRenderOrder();I===void 0&&(I=lj);const T=h.center.slice(),R=s1(u,S*p),k=R.slice(),N=[R.slice()],M=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!zh(M,e.extent)){const le=dt(M),pe=Math.max(dt(R)/2,le);R[0]=M[0]-pe,R[2]=M[2]+pe,_b(T,f);const ge=mb(N[0],f);ge[0]<M[0]&&ge[2]<M[2]?N.push([ge[0]+le,ge[1],ge[2]+le,ge[3]]):ge[0]>M[0]&&ge[2]>M[2]&&N.push([ge[0]-le,ge[1],ge[2]-le,ge[3]])}if(this.ready&&this.renderedResolution_==p&&this.renderedRevision_==x&&this.renderedRenderOrder_==I&&this.renderedFrameDeclutter_===!!e.declutter&&zh(this.wrappedRenderedExtent_,R))return aa(this.renderedExtent_,k)||(this.hitDetectionImageData_=null,this.renderedExtent_=k),this.renderedCenter_=T,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const F=new zj(Xb(p,y),R,p,y);let U;for(let le=0,pe=N.length;le<pe;++le)i.loadFeatures(N[le],p,f);const P=FI(p,y);let A=!0;const D=(le,pe)=>{let ge;const ue=le.getStyleFunction()||t.getStyleFunction();if(ue&&(ge=ue(le,p)),ge){const Q=this.renderFeature(le,P,ge,F,U,this.getLayer().getDeclutter(),pe);A=A&&!Q}},V=Cb(R),j=i.getFeaturesInExtent(V);I&&j.sort(I);for(let le=0,pe=j.length;le<pe;++le)D(j[le],le);this.renderedFeatures_=j,this.ready=A;const B=F.finish(),L=new Kj(R,p,y,i.getOverlaps(),B,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=p,this.renderedRevision_=x,this.renderedRenderOrder_=I,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=k,this.wrappedRenderedExtent_=R,this.renderedCenter_=T,this.renderedProjection_=f,this.renderedPixelRatio_=y,this.replayGroup_=L,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)u=VI(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||u;else u=VI(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return u}}let Nl=0;const Un=1<<Nl++,qe=1<<Nl++,ni=1<<Nl++,pr=1<<Nl++,yl=1<<Nl++,Gh=1<<Nl++,Ug=Math.pow(2,Nl)-1,R1={[Un]:"boolean",[qe]:"number",[ni]:"string",[pr]:"color",[yl]:"number[]",[Gh]:"size"},e3=Object.keys(R1).map(Number).sort(Bs);function t3(n){return n in R1}function Wh(n){const e=[];for(const t of e3)$h(n,t)&&e.push(R1[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function $h(n,e){return(n&e)===e}function Ao(n,e){return n===e}class Qt{constructor(e,t){if(!t3(e))throw new Error(`literal expressions must have a specific type, got ${Wh(e)}`);this.type=e,this.value=t}}class n3{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function lP(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function In(n,e,t){switch(typeof n){case"boolean":{if(Ao(e,ni))return new Qt(ni,n?"true":"false");if(!$h(e,Un))throw new Error(`got a boolean, but expected ${Wh(e)}`);return new Qt(Un,n)}case"number":{if(Ao(e,Gh))return new Qt(Gh,oi(n));if(Ao(e,Un))return new Qt(Un,!!n);if(Ao(e,ni))return new Qt(ni,n.toString());if(!$h(e,qe))throw new Error(`got a number, but expected ${Wh(e)}`);return new Qt(qe,n)}case"string":{if(Ao(e,pr))return new Qt(pr,x1(n));if(Ao(e,Un))return new Qt(Un,!!n);if(!$h(e,ni))throw new Error(`got a string, but expected ${Wh(e)}`);return new Qt(ni,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return f3(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Ao(e,Gh)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Qt(Gh,n)}if(Ao(e,pr)){if(n.length===3)return new Qt(pr,[...n,1]);if(n.length===4)return new Qt(pr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!$h(e,yl))throw new Error(`got an array of numbers, but expected ${Wh(e)}`);return new Qt(yl,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},i3={[te.Get]:Oe(Ue(1,1/0),JI),[te.Var]:Oe(Ue(1,1),r3),[te.Has]:Oe(Ue(1,1/0),JI),[te.Id]:Oe(s3,wc),[te.Concat]:Oe(Ue(2,1/0),ot(ni)),[te.GeometryType]:Oe(o3,wc),[te.LineMetric]:Oe(wc),[te.Resolution]:Oe(w0,wc),[te.Zoom]:Oe(w0,wc),[te.Time]:Oe(w0,wc),[te.Any]:Oe(Ue(2,1/0),ot(Un)),[te.All]:Oe(Ue(2,1/0),ot(Un)),[te.Not]:Oe(Ue(1,1),ot(Un)),[te.Equal]:Oe(Ue(2,2),ot(Ug)),[te.NotEqual]:Oe(Ue(2,2),ot(Ug)),[te.GreaterThan]:Oe(Ue(2,2),ot(qe)),[te.GreaterThanOrEqualTo]:Oe(Ue(2,2),ot(qe)),[te.LessThan]:Oe(Ue(2,2),ot(qe)),[te.LessThanOrEqualTo]:Oe(Ue(2,2),ot(qe)),[te.Multiply]:Oe(Ue(2,1/0),eC),[te.Coalesce]:Oe(Ue(2,1/0),eC),[te.Divide]:Oe(Ue(2,2),ot(qe)),[te.Add]:Oe(Ue(2,1/0),ot(qe)),[te.Subtract]:Oe(Ue(2,2),ot(qe)),[te.Clamp]:Oe(Ue(3,3),ot(qe)),[te.Mod]:Oe(Ue(2,2),ot(qe)),[te.Pow]:Oe(Ue(2,2),ot(qe)),[te.Abs]:Oe(Ue(1,1),ot(qe)),[te.Floor]:Oe(Ue(1,1),ot(qe)),[te.Ceil]:Oe(Ue(1,1),ot(qe)),[te.Round]:Oe(Ue(1,1),ot(qe)),[te.Sin]:Oe(Ue(1,1),ot(qe)),[te.Cos]:Oe(Ue(1,1),ot(qe)),[te.Atan]:Oe(Ue(1,2),ot(qe)),[te.Sqrt]:Oe(Ue(1,1),ot(qe)),[te.Match]:Oe(Ue(4,1/0),tC,l3),[te.Between]:Oe(Ue(3,3),ot(qe)),[te.Interpolate]:Oe(Ue(6,1/0),tC,c3),[te.Case]:Oe(Ue(3,1/0),a3,u3),[te.In]:Oe(Ue(2,2),h3),[te.Number]:Oe(Ue(1,1/0),ot(Ug)),[te.String]:Oe(Ue(1,1/0),ot(Ug)),[te.Array]:Oe(Ue(1,1/0),ot(qe)),[te.Color]:Oe(Ue(1,4),ot(qe)),[te.Band]:Oe(Ue(1,3),ot(qe)),[te.Palette]:Oe(Ue(2,2),d3),[te.ToString]:Oe(Ue(1,1),ot(Un|qe|ni|pr))};function JI(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Qt(qe,o);break}case"string":{r[s]=new Qt(ni,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function r3(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Qt(ni,i)]}function s3(n,e,t){t.featureId=!0}function o3(n,e,t){t.geometryType=!0}function w0(n,e,t){t.mapState=!0}function wc(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Ue(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function eC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=In(n[s+1],e,t);r[s]=o}return r}function ot(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=In(e[o+1],n,i);s[o]=l}return s}}function a3(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function tC(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function l3(n,e,t){const i=n.length-1,r=ni|qe|Un,s=In(n[1],r,t),o=In(n[n.length-1],e,t),l=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=In(n[u+2],s.type,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=In(n[u+3],o.type,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...l,o]}function c3(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Qt(qe,r);let o;try{o=In(n[2],qe,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const l=new Array(n.length-3);for(let u=0;u<l.length;u+=2){try{const h=In(n[u+3],qe,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=In(n[u+4],e,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function u3(n,e,t){const i=In(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=In(n[s+1],Un,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=In(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function h3(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=ni}else r=qe;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const u=In(i[l],r,t);s[l]=u}catch(u){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${u.message}`)}return[In(n[1],r,t),...s]}function d3(n,e,t){let i;try{i=In(n[1],qe,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=In(r[o],pr,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(l instanceof Qt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Oe(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new n3(t,r,...s)}}function f3(n,e,t){const i=n[0],r=i3[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function cP(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return cP(n.getGeometries()[0]);default:return""}}function uP(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Qs(n,e,t){const i=In(n,e,t);return Cr(i)}function Cr(n,e){if(n instanceof Qt){if(n.type===pr&&typeof n.value=="string"){const i=x1(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return g3(n);case te.Get:case te.Var:case te.Has:return p3(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Cr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return y3(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return m3(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return _3(n);case te.Case:return v3(n);case te.Match:return x3(n);case te.Interpolate:return w3(n);case te.ToString:return E3(n);default:throw new Error(`Unsupported operator ${t}`)}}function g3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function p3(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;o=o[f]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function m3(n,e){const t=n.operator,i=Cr(n.args[0]),r=Cr(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function y3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),l=r[1](s),u=r[2](s);return o>=l&&o<=u};case te.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function _3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const u=r[2](s);return o>u?u:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function v3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function x3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function w3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,u;for(let h=2;h<t;h+=2){const f=i[h](r);let p=i[h+1](r);const y=Array.isArray(p);if(y&&(p=$4(p)),f>=o)return h===2?p:y?T3(s,o,l,u,f,p):Kh(s,o,l,u,f,p);l=f,u=p}return u}}function E3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);if(t===te.ToString)return s=>{const o=r[0](s);return n.args[0].type===pr?w1(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function Kh(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,u=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function T3(n,e,t,i,r,s){if(r-t===0)return i;const l=NI(i),u=NI(s);let h=u[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[Kh(n,e,t,l[0],r,u[0]),Kh(n,e,t,l[1],r,u[1]),l[2]+Kh(n,e,t,0,r,h),Kh(n,e,t,i[3],r,s[3])];return K4(f)}function S3(n){return!0}function I3(n){const e=lP(),t=C3(n,e),i=uP();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=cP(r.getGeometry())),t(i)}}function nC(n){const e=lP(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Pv(n[o],e);const r=uP(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[u]=f,u+=1)}return s.length=u,s}}function C3(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Qs(s.filter,Un,e):S3;let l;if(Array.isArray(s.style)){const u=s.style.length;l=new Array(u);for(let h=0;h<u;++h)l[h]=Pv(s.style[h],e)}else l=[Pv(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const u=i[l].filter;if(u(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function Pv(n,e){const t=bd(n,"",e),i=Pd(n,"",e),r=R3(n,e),s=A3(n,e),o=si(n,"z-index",e);if(!t&&!i&&!r&&!s&&!su(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new Zi;return function(u){let h=!0;if(t){const f=t(u);f&&(h=!1),l.setFill(f)}if(i){const f=i(u);f&&(h=!1),l.setStroke(f)}if(r){const f=r(u);f&&(h=!1),l.setText(f)}if(s){const f=s(u);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(u)),h?null:l}}function bd(n,e,t){let i;if(e+"fill-pattern-src"in n)i=N3(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=A1(n,e+"fill-color",t)}if(!i)return null;const r=new Ir;return function(s){const o=i(s);return o===v1?null:(r.setColor(o),r)}}function Pd(n,e,t){const i=si(n,e+"stroke-width",t),r=A1(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Ms(n,e+"stroke-line-cap",t),o=Ms(n,e+"stroke-line-join",t),l=hP(n,e+"stroke-line-dash",t),u=si(n,e+"stroke-line-dash-offset",t),h=si(n,e+"stroke-miter-limit",t),f=new Pu;return function(p){if(r){const y=r(p);if(y===v1)return null;f.setColor(y)}if(i&&f.setWidth(i(p)),s){const y=s(p);if(y!=="butt"&&y!=="round"&&y!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(y)}if(o){const y=o(p);if(y!=="bevel"&&y!=="round"&&y!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(y)}return l&&f.setLineDash(l(p)),u&&f.setLineDashOffset(u(p)),h&&f.setMiterLimit(h(p)),f}}function R3(n,e){const t="text-",i=Ms(n,t+"value",e);if(!i)return null;const r=bd(n,t,e),s=bd(n,t+"background-",e),o=Pd(n,t,e),l=Pd(n,t+"background-",e),u=Ms(n,t+"font",e),h=si(n,t+"max-angle",e),f=si(n,t+"offset-x",e),p=si(n,t+"offset-y",e),y=qc(n,t+"overflow",e),x=Ms(n,t+"placement",e),S=si(n,t+"repeat",e),I=zm(n,t+"scale",e),T=qc(n,t+"rotate-with-view",e),R=si(n,t+"rotation",e),k=Ms(n,t+"align",e),N=Ms(n,t+"justify",e),M=Ms(n,t+"baseline",e),F=qc(n,t+"keep-upright",e),U=hP(n,t+"padding",e),P=Um(n,t+"declutter-mode"),A=new rf({declutterMode:P});return function(D){if(A.setText(i(D)),r&&A.setFill(r(D)),s&&A.setBackgroundFill(s(D)),o&&A.setStroke(o(D)),l&&A.setBackgroundStroke(l(D)),u&&A.setFont(u(D)),h&&A.setMaxAngle(h(D)),f&&A.setOffsetX(f(D)),p&&A.setOffsetY(p(D)),y&&A.setOverflow(y(D)),x){const V=x(D);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");A.setPlacement(V)}if(S&&A.setRepeat(S(D)),I&&A.setScale(I(D)),T&&A.setRotateWithView(T(D)),R&&A.setRotation(R(D)),k){const V=k(D);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");A.setTextAlign(V)}if(N){const V=N(D);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");A.setJustify(V)}if(M){const V=M(D);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");A.setTextBaseline(V)}return U&&A.setPadding(U(D)),F&&A.setKeepUpright(F(D)),A}}function A3(n,e){return"icon-src"in n?b3(n,e):"shape-points"in n?P3(n,e):"circle-radius"in n?k3(n,e):null}function b3(n,e){const t="icon-",i=t+"src",r=dP(n[i],i),s=zp(n,t+"anchor",e),o=zm(n,t+"scale",e),l=si(n,t+"opacity",e),u=zp(n,t+"displacement",e),h=si(n,t+"rotation",e),f=qc(n,t+"rotate-with-view",e),p=rC(n,t+"anchor-origin"),y=sC(n,t+"anchor-x-units"),x=sC(n,t+"anchor-y-units"),S=O3(n,t+"color"),I=M3(n,t+"cross-origin"),T=L3(n,t+"offset"),R=rC(n,t+"offset-origin"),k=Up(n,t+"width"),N=Up(n,t+"height"),M=D3(n,t+"size"),F=Um(n,t+"declutter-mode"),U=new C1({src:r,anchorOrigin:p,anchorXUnits:y,anchorYUnits:x,color:S,crossOrigin:I,offset:T,offsetOrigin:R,height:N,width:k,size:M,declutterMode:F});return function(P){return l&&U.setOpacity(l(P)),u&&U.setDisplacement(u(P)),h&&U.setRotation(h(P)),f&&U.setRotateWithView(f(P)),o&&U.setScale(o(P)),s&&U.setAnchor(s(P)),U}}function P3(n,e){const t="shape-",i=t+"points",r=t+"radius",s=kv(n[i],i),o=kv(n[r],r),l=bd(n,t,e),u=Pd(n,t,e),h=zm(n,t+"scale",e),f=zp(n,t+"displacement",e),p=si(n,t+"rotation",e),y=qc(n,t+"rotate-with-view",e),x=Up(n,t+"radius2"),S=Up(n,t+"angle"),I=Um(n,t+"declutter-mode"),T=new jm({points:s,radius:o,radius2:x,angle:S,declutterMode:I});return function(R){return l&&T.setFill(l(R)),u&&T.setStroke(u(R)),f&&T.setDisplacement(f(R)),p&&T.setRotation(p(R)),y&&T.setRotateWithView(y(R)),h&&T.setScale(h(R)),T}}function k3(n,e){const t="circle-",i=bd(n,t,e),r=Pd(n,t,e),s=si(n,t+"radius",e),o=zm(n,t+"scale",e),l=zp(n,t+"displacement",e),u=si(n,t+"rotation",e),h=qc(n,t+"rotate-with-view",e),f=Um(n,t+"declutter-mode"),p=new kl({radius:5,declutterMode:f});return function(y){return s&&p.setRadius(s(y)),i&&p.setFill(i(y)),r&&p.setStroke(r(y)),l&&p.setDisplacement(l(y)),u&&p.setRotation(u(y)),h&&p.setRotateWithView(h(y)),o&&p.setScale(o(y)),p}}function si(n,e,t){if(!(e in n))return;const i=Qs(n[e],qe,t);return function(r){return kv(i(r),e)}}function Ms(n,e,t){if(!(e in n))return null;const i=Qs(n[e],ni,t);return function(r){return dP(i(r),e)}}function N3(n,e,t){const i=Ms(n,e+"pattern-src",t),r=iC(n,e+"pattern-offset",t),s=iC(n,e+"pattern-size",t),o=A1(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function qc(n,e,t){if(!(e in n))return null;const i=Qs(n[e],Un,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function A1(n,e,t){if(!(e in n))return null;const i=Qs(n[e],pr,t);return function(r){return fP(i(r),e)}}function hP(n,e,t){if(!(e in n))return null;const i=Qs(n[e],yl,t);return function(r){return of(i(r),e)}}function zp(n,e,t){if(!(e in n))return null;const i=Qs(n[e],yl,t);return function(r){const s=of(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function iC(n,e,t){if(!(e in n))return null;const i=Qs(n[e],yl,t);return function(r){return gP(i(r),e)}}function zm(n,e,t){if(!(e in n))return null;const i=Qs(n[e],yl|qe,t);return function(r){return F3(i(r),e)}}function Up(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function D3(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return oi(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function M3(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function rC(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function sC(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function L3(n,e){const t=n[e];if(t!==void 0)return of(t,e)}function Um(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function O3(n,e){const t=n[e];if(t!==void 0)return fP(t,e)}function of(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function dP(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function kv(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function fP(n,e){if(typeof n=="string")return n;const t=of(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function gP(n,e){const t=of(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function F3(n,e){return typeof n=="number"?n:gP(n,e)}const hr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function oC(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,p=l?l[1]:0;let y=n[0]+u/2+f,x=n[2]-u/2+f,S=n[1]+h/2+p,I=n[3]-h/2+p;y>x&&(y=(x+y)/2,x=y),S>I&&(S=(I+S)/2,I=S);let T=Nt(i[0],y,x),R=Nt(i[1],S,I);if(o&&t&&r){const k=30*r;T+=-k*Math.log(1+Math.max(0,y-i[0])/k)+k*Math.log(1+Math.max(0,i[0]-x)/k),R+=-k*Math.log(1+Math.max(0,S-i[1])/k)+k*Math.log(1+Math.max(0,i[1]-I)/k)}return[T,R]})}function V3(n){return n}function pP(n){return Math.pow(n,3)}function ku(n){return 1-pP(1-n)}function j3(n){return 3*n*n-2*n*n*n}function z3(n){return n}function b1(n,e,t,i){const r=dt(e)/t[0],s=Bn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function P1(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Nt(i,t/2,e*2)}function U3(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const u=n[0],h=n[n.length-1],f=t?b1(u,t,o,i):u;if(l)return e?P1(r,f,h):Nt(r,h,f);const p=Math.min(f,r),y=Math.floor(i1(n,p,s));return n[y]>f&&y<n.length-1?n[y+1]:n[y]}})}function B3(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,u,h){if(o!==void 0){const f=r?b1(e,r,u,s):e;if(h)return i?P1(o,f,t):Nt(o,t,f);const p=1e-9,y=Math.ceil(Math.log(e/f)/Math.log(n)-p),x=-l*(.5-p)+.5,S=Math.min(f,o),I=Math.floor(Math.log(e/S)/Math.log(n)+x),T=Math.max(y,I),R=e/Math.pow(n,T);return Nt(R,t,f)}})}function aC(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,u){if(s!==void 0){const h=i?b1(n,i,l,r):n;return!t||!u?Nt(s,e,h):P1(s,h,e)}})}function k1(n){if(n!==void 0)return 0}function lC(n){if(n!==void 0)return n}function G3(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function W3(n){const e=Ho(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const $3=42,N1=256,E0=0;class Zr extends cs{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=d1(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Ib(),e.center&&(e.center=Ds(e.center,this.projection_)),e.extent&&(e.extent=Go(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in hr)delete t[l];this.setProperties(t,!0);const i=H3(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=K3(e),s=i.constraint,o=X3(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ds(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ds(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&Bg(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],p={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||j3,callback:i};if(f.center&&(p.sourceCenter=o,p.targetCenter=f.center.slice(),o=p.targetCenter),f.zoom!==void 0?(p.sourceResolution=l,p.targetResolution=this.getResolutionForZoom(f.zoom),l=p.targetResolution):f.resolution&&(p.sourceResolution=l,p.targetResolution=f.resolution,l=p.targetResolution),f.rotation!==void 0){p.sourceRotation=u;const y=ol(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=u+y,u=p.targetRotation}q3(p)?p.complete=!0:s+=p.duration,h.push(p)}this.animations_.push(h),this.setHint(Mn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Mn.ANIMATING]>0}getInteracting(){return this.hints_[Mn.INTERACTING]>0}cancelAnimations(){this.setHint(Mn.ANIMATING,-this.hints_[Mn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&Bg(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let f=u.duration>0?h/u.duration:1;f>=1?(u.complete=!0,f=1):s=!1;const p=u.easing(f);if(u.sourceCenter){const y=u.sourceCenter[0],x=u.sourceCenter[1],S=u.targetCenter[0],I=u.targetCenter[1];this.nextCenter_=u.targetCenter;const T=y+p*(S-y),R=x+p*(I-x);this.targetCenter_=[T,R]}if(u.sourceResolution&&u.targetResolution){const y=p===1?u.targetResolution:u.sourceResolution+p*(u.targetResolution-u.sourceResolution);if(u.anchor){const x=this.getViewportSize_(this.getRotation()),S=this.constraints_.resolution(y,0,x,!0);this.targetCenter_=this.calculateCenterZoom(S,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const y=p===1?ol(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+p*(u.targetRotation-u.sourceRotation);if(u.anchor){const x=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(x,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Mn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Bg(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],a1(i,e-this.getRotation()),V5(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Sv(e,this.getProjection())}getCenterInternal(){return this.get(hr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return Cb(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();at(t,"The view center is not defined");const i=this.getResolution();at(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return at(r!==void 0,"The view rotation is not defined"),vv(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(hr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Go(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=dt(e)/t[0],r=Bn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(hr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=T0(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=i1(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Nt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Nt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(at(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){at(!Dm(e),"Cannot fit empty extent provided as `geometry`");const r=Go(e,this.getProjection());i=zI(r)}else if(e.getType()==="Circle"){const r=Go(e.getExtent(),this.getProjection());i=zI(r),i.rotate(this.getRotation(),fl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,u=1/0,h=-1/0,f=-1/0;for(let p=0,y=s.length;p<y;p+=o){const x=s[p]*i-s[p+1]*r,S=s[p]*r+s[p+1]*i;l=Math.min(l,x),u=Math.min(u,S),h=Math.max(h,x),f=Math.max(f,S)}return[l,u,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),f=Math.sin(h),p=Math.cos(h),y=fl(l);y[0]+=(r[1]-r[3])/2*u,y[1]+=(r[0]-r[2])/2*u;const x=y[0]*p-y[1]*f,S=y[1]*p+y[0]*f,I=this.getConstrainedCenter([x,S],u),T=t.callback?t.callback:xd;t.duration!==void 0?this.animateInternal({resolution:u,center:I,duration:t.duration,easing:t.easing},T):(this.targetResolution_=u,this.targetCenter_=I,this.applyTargetState_(!1,!0),Bg(T,!0))}centerOn(e,t,i){this.centerOnInternal(Ds(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(T0(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),u=T0(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Sv(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ds(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ds(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ds(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(hr.ROTATION)!==r&&this.set(hr.ROTATION,r),this.get(hr.RESOLUTION)!==o&&(this.set(hr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(hr.CENTER)||!Pp(this.get(hr.CENTER),l))&&this.set(hr.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Pp(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:e,easing:ku,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Mn.INTERACTING,1)}endInteraction(e,t,i){i=i&&Ds(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Mn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Bg(n,e){setTimeout(function(){n(e)},0)}function K3(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return oC(n.extent,n.constrainOnlyCenter,t)}const e=d1(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,oC(t,!1,!1)}return V3}function H3(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:E0,l=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,p=n.showFullExtent!==void 0?n.showFullExtent:!1,y=d1(n.projection,"EPSG:3857"),x=y.getExtent();let S=n.constrainOnlyCenter,I=n.extent;if(!h&&!I&&y.isGlobal()&&(S=!1,I=x),n.resolutions!==void 0){const T=n.resolutions;t=T[o],i=T[l]!==void 0?T[l]:T[T.length-1],n.constrainResolution?e=U3(T,f,!S&&I,p):e=aC(t,i,f,!S&&I,p)}else{const R=(x?Math.max(dt(x),Bn(x)):360*lu.degrees/y.getMetersPerUnit())/N1/Math.pow(2,E0),k=R/Math.pow(2,28-E0);t=n.maxResolution,t!==void 0?o=0:t=R/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,l):i=R/Math.pow(u,l):i=k),l=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,l-o),n.constrainResolution?e=B3(u,t,i,f,!S&&I,p):e=aC(t,i,f,!S&&I,p)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function X3(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?W3():t===!1?lC:typeof t=="number"?G3(t):lC}return k1}function q3(n){return!(n.sourceCenter&&n.targetCenter&&!Pp(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function T0(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-u*o,f=u*s+l*o;return[h,f]}const ht={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class mP extends cs{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[ht.OPACITY]=e.opacity!==void 0?e.opacity:1,at(typeof t[ht.OPACITY]=="number","Layer opacity must be a number"),t[ht.VISIBLE]=e.visible!==void 0?e.visible:!0,t[ht.Z_INDEX]=e.zIndex,t[ht.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[ht.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[ht.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[ht.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Nt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return tt()}getLayerStatesArray(e){return tt()}getExtent(){return this.get(ht.EXTENT)}getMaxResolution(){return this.get(ht.MAX_RESOLUTION)}getMinResolution(){return this.get(ht.MIN_RESOLUTION)}getMinZoom(){return this.get(ht.MIN_ZOOM)}getMaxZoom(){return this.get(ht.MAX_ZOOM)}getOpacity(){return this.get(ht.OPACITY)}getSourceState(){return tt()}getVisible(){return this.get(ht.VISIBLE)}getZIndex(){return this.get(ht.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(ht.EXTENT,e)}setMaxResolution(e){this.set(ht.MAX_RESOLUTION,e)}setMinResolution(e){this.set(ht.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(ht.MAX_ZOOM,e)}setMinZoom(e){this.set(ht.MIN_ZOOM,e)}setOpacity(e){at(typeof e=="number","Layer opacity must be a number"),this.set(ht.OPACITY,e)}setVisible(e){this.set(ht.VISIBLE,e)}setZIndex(e){this.set(ht.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Bm extends mP{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(ht.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(ht.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Rt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=nt(e,Ge.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Zr?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return D1(r,t.viewState)&&(!s||ri(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof Zr?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(ht.MAP,e)}getMapInternal(){return this.get(ht.MAP)}setMap(e){this.mapPrecomposeKey_&&(Rt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Rt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=nt(e,Xi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=nt(this,Ge.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);at(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(ht.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function D1(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const cC={RENDER_ORDER:"renderOrder"};class yP extends Bm{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(cC.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new eP(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(cC.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?nP:e;const t=Y3(e);this.styleFunction_=e===null?void 0:Nj(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function Y3(n){if(n===void 0)return nP;if(!n)return null;if(typeof n=="function"||n instanceof Zi)return n;if(!Array.isArray(n))return nC([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Zi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Zi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return I3(r)}return nC(n)}class M1 extends yP{constructor(e){super(e)}createRenderer(){return new Jj(this)}}const bo={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Vo extends Zs{constructor(e,t){super(e),this.layer=t}}const S0={LAYERS:"layers"};class Nu extends mP{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(S0.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Hi(i.slice(),{unique:!0}):at(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Hi(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Rt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(nt(e,ei.ADD,this.handleLayersAdd_,this),nt(e,ei.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Rt);Qd(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new Vo(bo.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[nt(e,ru.PROPERTYCHANGE,this.handleLayerChange_,this),nt(e,Ge.CHANGE,this.handleLayerChange_,this)];e instanceof Nu&&t.push(nt(e,bo.ADDLAYER,this.handleLayerGroupAdd_,this),nt(e,bo.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[it(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Vo(bo.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Vo(bo.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Vo(bo.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=it(t);this.listenerKeys_[i].forEach(Rt),delete this.listenerKeys_[i],this.dispatchEvent(new Vo(bo.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(S0.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Vo(bo.REMOVELAYER,i[r]))}this.set(S0.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=sl(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}}const Ce={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class L1 extends Am{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Ge.CHANGE)}release(){this.setState(Ce.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Ce.EMPTY){if(this.state!==Ce.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){tt()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:pP(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Nv(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const Z3=new Error("disposed"),Q3=[256,256];class uC extends L1{constructor(e){const t=Ce.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Nv(this.data_);return e?[e.width,e.height]:Q3}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Ce.IDLE&&this.state!==Ce.ERROR)return;this.state=Ce.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Ce.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Ce.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(Z3),this.controller_=null),super.disposeInternal()}}class _P extends L1{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Ti?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Ce.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Ce.ERROR,this.unlistenImage_(),this.image_=J3(),this.changed()}handleImageLoad_(){if(Ti)this.state=Ce.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Ce.LOADED:this.state=Ce.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Ce.ERROR&&(this.state=Ce.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ce.IDLE&&(this.state=Ce.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=H4(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function J3(){const n=Jt(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let I0;const Yc=[];function hC(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function C0(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function e6(){if(I0===void 0){const n=Jt(6,6,Yc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",hC(n,4,5,4,0),hC(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;I0=C0(e,0)||C0(e,4)||C0(e,8),Fm(n),Yc.push(n.canvas)}return I0}function dC(n,e,t,i){const r=Om(t,e,n);let s=Dp(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const u=n.getExtent();if(!u||au(u,r)){const h=Dp(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function t6(n,e,t,i){const r=fl(t);let s=dC(n,e,r,i);return(!isFinite(s)||s<=0)&&gb(t,function(o){return s=dC(n,e,o,i),isFinite(s)&&s>0}),s}function n6(n,e,t,i,r,s,o,l,u,h,f,p,y,x){const S=Jt(Math.round(t*n),Math.round(t*e),Yc);if(p||(S.imageSmoothingEnabled=!1),u.length===0)return S.canvas;S.scale(t,t);function I(F){return Math.round(F*t)/t}S.globalCompositeOperation="lighter";const T=Qi();u.forEach(function(F,U,P){k5(T,F.extent)});let R;const k=t/i,N=(p?1:1+Math.pow(2,-24))/k;R=Jt(Math.round(dt(T)*k),Math.round(Bn(T)*k),Yc),p||(R.imageSmoothingEnabled=!1),u.forEach(function(F,U,P){if(F.image.width>0&&F.image.height>0){if(F.clipExtent){R.save();const B=(F.clipExtent[0]-T[0])*k,L=-(F.clipExtent[3]-T[3])*k,le=dt(F.clipExtent)*k,pe=Bn(F.clipExtent)*k;R.rect(p?B:Math.round(B),p?L:Math.round(L),p?le:Math.round(B+le)-Math.round(B),p?pe:Math.round(L+pe)-Math.round(L)),R.clip()}const A=(F.extent[0]-T[0])*k,D=-(F.extent[3]-T[3])*k,V=dt(F.extent)*k,j=Bn(F.extent)*k;R.drawImage(F.image,h,h,F.image.width-2*h,F.image.height-2*h,p?A:Math.round(A),p?D:Math.round(D),p?V:Math.round(A+V)-Math.round(A),p?j:Math.round(D+j)-Math.round(D)),F.clipExtent&&R.restore()}});const M=Pl(o);return l.getTriangles().forEach(function(F,U,P){const A=F.source,D=F.target;let V=A[0][0],j=A[0][1],B=A[1][0],L=A[1][1],le=A[2][0],pe=A[2][1];const ge=I((D[0][0]-M[0])/s),ue=I(-(D[0][1]-M[1])/s),Q=I((D[1][0]-M[0])/s),se=I(-(D[1][1]-M[1])/s),ne=I((D[2][0]-M[0])/s),W=I(-(D[2][1]-M[1])/s),$=V,ie=j;V=0,j=0,B-=$,L-=ie,le-=$,pe-=ie;const me=[[B,L,0,0,Q-ge],[le,pe,0,0,ne-ge],[0,0,B,L,se-ue],[0,0,le,pe,W-ue]],xe=F5(me);if(!xe)return;if(S.save(),S.beginPath(),e6()||!p){S.moveTo(Q,se);const Me=4,Ve=ge-Q,We=ue-se;for(let lt=0;lt<Me;lt++)S.lineTo(Q+I((lt+1)*Ve/Me),se+I(lt*We/(Me-1))),lt!=Me-1&&S.lineTo(Q+I((lt+1)*Ve/Me),se+I((lt+1)*We/(Me-1)));S.lineTo(ne,W)}else S.moveTo(Q,se),S.lineTo(ge,ue),S.lineTo(ne,W);S.clip(),S.transform(xe[0],xe[2],xe[1],xe[3],ge,ue),S.translate(T[0]-$,T[3]-ie);let ke;if(R)ke=R.canvas,S.scale(N,-N);else{const Me=u[0],Ve=Me.extent;ke=Me.image,S.scale(dt(Ve)/ke.width,-Bn(Ve)/ke.height)}S.drawImage(ke,0,0),S.restore()}),R&&(Fm(R),Yc.push(R.canvas)),f&&(S.save(),S.globalCompositeOperation="source-over",S.strokeStyle="black",S.lineWidth=1,l.getTriangles().forEach(function(F,U,P){const A=F.target,D=(A[0][0]-M[0])/s,V=-(A[0][1]-M[1])/s,j=(A[1][0]-M[0])/s,B=-(A[1][1]-M[1])/s,L=(A[2][0]-M[0])/s,le=-(A[2][1]-M[1])/s;S.beginPath(),S.moveTo(j,B),S.lineTo(D,V),S.lineTo(L,le),S.closePath(),S.stroke()}),S.restore()),S.canvas}const i6=10,fC=.25;class r6{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let u={};const h=l?g4(N=>un(l,Om(N,this.targetProj_,this.sourceProj_))):Mp(this.targetProj_,this.sourceProj_);this.transformInv_=function(N){const M=N[0]+"/"+N[1];return u[M]||(u[M]=h(N)),u[M]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&dt(r)>=dt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?dt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?dt(this.targetProj_.getExtent()):null;const f=Pl(i),p=Nm(i),y=km(i),x=Pm(i),S=this.transformInv_(f),I=this.transformInv_(p),T=this.transformInv_(y),R=this.transformInv_(x),k=i6+(o?Math.max(0,Math.ceil(Math.log2(_v(i)/(o*o*256*256)))):0);if(this.addQuad_(f,p,y,x,S,I,T,R,k),this.wrapsXInSource_){let N=1/0;this.triangles_.forEach(function(M,F,U){N=Math.min(N,M.source[0][0],M.source[1][0],M.source[2][0])}),this.triangles_.forEach(M=>{if(Math.max(M.source[0][0],M.source[1][0],M.source[2][0])-N>this.sourceWorldWidth_/2){const F=[[M.source[0][0],M.source[0][1]],[M.source[1][0],M.source[1][1]],[M.source[2][0],M.source[2][1]]];F[0][0]-N>this.sourceWorldWidth_/2&&(F[0][0]-=this.sourceWorldWidth_),F[1][0]-N>this.sourceWorldWidth_/2&&(F[1][0]-=this.sourceWorldWidth_),F[2][0]-N>this.sourceWorldWidth_/2&&(F[2][0]-=this.sourceWorldWidth_);const U=Math.min(F[0][0],F[1][0],F[2][0]);Math.max(F[0][0],F[1][0],F[2][0])-U<this.sourceWorldWidth_/2&&(M.source=F)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,u,h){const f=fI([s,o,l,u]),p=this.sourceWorldWidth_?dt(f)/this.sourceWorldWidth_:null,y=this.sourceWorldWidth_,x=this.sourceProj_.canWrapX()&&p>.5&&p<1;let S=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const T=fI([e,t,i,r]);S=dt(T)/this.targetWorldWidth_>fC||S}!x&&this.sourceProj_.isGlobal()&&p&&(S=p>fC||S)}if(!S&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!ri(f,this.maxSourceExtent_))return;let I=0;if(!S&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)S=!0;else if(I=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),I!=1&&I!=2&&I!=4&&I!=8)return}if(h>0){if(!S){const T=[(e[0]+i[0])/2,(e[1]+i[1])/2],R=this.transformInv_(T);let k;x?k=(ol(s[0],y)+ol(l[0],y))/2-ol(R[0],y):k=(s[0]+l[0])/2-R[0];const N=(s[1]+l[1])/2-R[1];S=k*k+N*N>this.errorThresholdSquared_}if(S){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const T=[(t[0]+i[0])/2,(t[1]+i[1])/2],R=this.transformInv_(T),k=[(r[0]+e[0])/2,(r[1]+e[1])/2],N=this.transformInv_(k);this.addQuad_(e,t,T,k,s,o,R,N,h-1),this.addQuad_(k,T,i,r,N,R,l,u,h-1)}else{const T=[(e[0]+t[0])/2,(e[1]+t[1])/2],R=this.transformInv_(T),k=[(i[0]+r[0])/2,(i[1]+r[1])/2],N=this.transformInv_(k);this.addQuad_(e,T,k,r,s,R,N,u,h-1),this.addQuad_(T,t,i,k,R,o,l,N,h-1)}return}}if(x){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(I&11)==0&&this.addTriangle_(e,i,r,s,l,u),(I&14)==0&&this.addTriangle_(e,i,t,s,l,o),I&&((I&13)==0&&this.addTriangle_(t,r,e,o,u,s),(I&7)==0&&this.addTriangle_(t,r,i,o,u,l))}calculateSourceExtent(){const e=Qi();return this.triangles_.forEach(function(t,i,r){const s=t.source;Jh(e,s[0]),Jh(e,s[1]),Jh(e,s[2])}),e}getTriangles(){return this.triangles_}}const s6=.5;class vP extends L1{constructor(e,t,i,r,s,o,l,u,h,f,p,y){super(s,Ce.IDLE,y),this.renderEdges_=p!==void 0?p:!1,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const x=r.getTileCoordExtent(this.wrappedTileCoord_),S=this.targetTileGrid_.getExtent();let I=this.sourceTileGrid_.getExtent();const T=S?sl(x,S):x;if(_v(T)===0){this.state=Ce.EMPTY;return}const R=e.getExtent();R&&(I?I=sl(I,R):I=R);const k=r.getResolution(this.wrappedTileCoord_[0]),N=t6(e,i,T,k);if(!isFinite(N)||N<=0){this.state=Ce.EMPTY;return}const M=f!==void 0?f:s6;if(this.triangulation_=new r6(e,i,T,I,N*M,k),this.triangulation_.getTriangles().length===0){this.state=Ce.EMPTY;return}this.sourceZ_=t.getZForResolution(N);let F=this.triangulation_.calculateSourceExtent();if(I&&(e.canWrapX()?(F[1]=Nt(F[1],I[1],I[3]),F[3]=Nt(F[3],I[1],I[3])):F=sl(F,I)),!_v(F))this.state=Ce.EMPTY;else{let U=0,P=0;e.canWrapX()&&(U=dt(R),P=Math.floor((F[0]-R[0])/U)),yb(F.slice(),e,!0).forEach(D=>{const V=t.getTileRangeForExtentAndZ(D,this.sourceZ_);for(let j=V.minX;j<=V.maxX;j++)for(let B=V.minY;B<=V.maxY;B++){const L=h(this.sourceZ_,j,B,l);if(L){const le=P*U;this.sourceTiles_.push({tile:L,offset:le})}}++P}),this.sourceTiles_.length===0&&(this.state=Ce.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Ce.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Ce.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=n6(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Ce.LOADED}this.changed()}load(){if(this.state==Ce.IDLE){this.state=Ce.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Ce.IDLE||i==Ce.LOADING){e++;const r=nt(t,Ge.CHANGE,s=>{const o=t.getState();(o==Ce.LOADED||o==Ce.ERROR||o==Ce.EMPTY)&&(Rt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Ce.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Rt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Fm(this.canvas_.getContext("2d")),Yc.push(this.canvas_),this.canvas_=null),super.release()}}class O1{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Ec(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new O1(n,e,t,i)}class gC{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Cm&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return at(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return at(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){at(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function Bp(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function o6(n,e,t){return n+"/"+e+"/"+t}function ap(n,e,t,i,r){return`${it(n)},${e},${o6(t,i,r)}`}function a6(n){return l6(n[0],n[1],n[2])}function l6(n,e,t){return(e<<n)+t}function c6(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function R0(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function u6(n,e,t){const i=n[t];return i?i.delete(e):!1}function pC(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=sl(e,Go(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=sl(e,r))}return e}class h6 extends aP{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Qi(),this.tempTileRange_=new O1(0,0,0,0),this.tempTileCoord_=Bp(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new gC(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new gC(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),u=ap(l,l.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const f=r.viewState.projection,p=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!p||op(p,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=un(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!au(s,r))return null;const o=t.viewState,l=i.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const p=u.getTileCoordForCoordAndZ(r,f),y=this.getTile(f,p[1],p[2],t);if(!y||y.getState()!==Ce.LOADED)continue;const x=u.getOrigin(f),S=oi(u.getTileSize(f)),I=u.getResolution(f);let T;if(y instanceof _P||y instanceof vP)T=y.getImage();else if(y instanceof uC){if(T=Nv(y.getData()),!T)continue}else continue;const R=Math.floor(h*((r[0]-x[0])/I-p[1]*S[0])),k=Math.floor(h*((x[1]-r[1])/I-p[2]*S[1])),N=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(T,R+N,k+N)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(o.projection),f=it(u);f in e.wantedTiles||(e.wantedTiles[f]={});const p=e.wantedTiles[f],y=l.getMapInternal(),x=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),y?y.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),S=o.rotation,I=S?pb(o.center,o.resolution,S,e.size):void 0;for(let T=i;T>=x;--T){const R=h.getTileRangeForExtentAndZ(t,T,this.tempTileRange_),k=h.getResolution(T);for(let N=R.minX;N<=R.maxX;++N)for(let M=R.minY;M<=R.maxY;++M){if(S&&!h.tileCoordIntersectsViewport([T,N,M],I))continue;const F=this.getTile(T,N,M,e);if(!F||!R0(r,F,T))continue;const P=F.getKey();if(p[P]=!0,F.getState()===Ce.IDLE&&!e.tileQueue.isKeyQueued(P)){const A=Bp(T,N,M,this.tempTileCoord_);e.tileQueue.enqueue([F,f,h.getTileCoordCenter(A),k])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let u=0;u<l.length;++u){const h=ap(this.getLayer().getSource(),l[u],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Ce.LOADED)return f.endTransition(it(this)),R0(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let p=s.minY;p<=s.maxY;++p){const y=ap(u,h,i,f,p);let x=!1;if(l.containsKey(y)){const S=l.peek(y);S.getState()===Ce.LOADED&&(R0(r,S,i),x=!0)}x||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,u=e.pixelRatio,h=this.getLayer(),f=h.getSource(),p=f.getTileGridForProjection(s),y=p.getZForResolution(o,f.zDirection),x=p.getResolution(y),S=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==S&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=S):this.renderedSourceKey_=S;let I=e.extent;const T=f.getTilePixelRatio(u);this.prepareContainer(e,t);const R=this.context.canvas.width,k=this.context.canvas.height,N=i.extent&&Go(i.extent);N&&(I=sl(I,Go(i.extent)));const M=x*R/2/T,F=x*k/2/T,U=[l[0]-M,l[1]-F,l[0]+M,l[1]+F],P={};this.renderedTiles.length=0;const A=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const Q=p.getZForResolution(r.nextResolution,f.zDirection),se=pC(e,e.nextExtent);this.enqueueTiles(e,se,Q,P,A)}const D=pC(e,I);if(this.enqueueTiles(e,D,y,P,0),A>0&&setTimeout(()=>{this.enqueueTiles(e,D,y-1,P,A-1)},0),!(y in P))return this.container;const V=it(this),j=e.time;for(const Q of P[y]){const se=Q.getState();if(se===Ce.EMPTY)continue;const ne=Q.tileCoord;if(se===Ce.LOADED&&Q.getAlpha(V,j)===1){Q.endTransition(V);continue}if(se!==Ce.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,P)){u6(P,Q,y),e.animate=!0;continue}if(this.findAltTiles_(p,ne,y+1,P))continue;const ie=p.getMinZoom();for(let me=y-1;me>=ie&&!this.findAltTiles_(p,ne,me,P);--me);}const B=x/o*u/T,L=this.getRenderContext(e);Hs(this.tempTransform,R/2,k/2,B,B,0,-R/2,-k/2),i.extent&&this.clipUnrotated(L,e,N),f.getInterpolate()||(L.imageSmoothingEnabled=!1),this.preRender(L,e);const le=Object.keys(P).map(Number);le.sort(Bs);let pe;const ge=[],ue=[];for(let Q=le.length-1;Q>=0;--Q){const se=le[Q],ne=f.getTilePixelSize(se,u,s),$=p.getResolution(se)/x,ie=ne[0]*$*B,me=ne[1]*$*B,xe=p.getTileCoordForCoordAndZ(Pl(U),se),ke=p.getTileCoordExtent(xe),Me=un(this.tempTransform,[T*(ke[0]-U[0])/x,T*(U[3]-ke[3])/x]),Ve=T*f.getGutterForProjection(s);for(const We of P[se]){if(We.getState()!==Ce.LOADED)continue;const lt=We.tileCoord,er=xe[1]-lt[1],fs=Math.round(Me[0]-(er-1)*ie),Wn=xe[2]-lt[2],$n=Math.round(Me[1]-(Wn-1)*me),hn=Math.round(Me[0]-er*ie),dn=Math.round(Me[1]-Wn*me),Kn=fs-hn,bi=$n-dn,yt=le.length===1;let ct=!1;pe=[hn,dn,hn+Kn,dn,hn+Kn,dn+bi,hn,dn+bi];for(let nn=0,Pi=ge.length;nn<Pi;++nn)if(!yt&&se<ue[nn]){const St=ge[nn];ri([hn,dn,hn+Kn,dn+bi],[St[0],St[3],St[4],St[7]])&&(ct||(L.save(),ct=!0),L.beginPath(),L.moveTo(pe[0],pe[1]),L.lineTo(pe[2],pe[3]),L.lineTo(pe[4],pe[5]),L.lineTo(pe[6],pe[7]),L.moveTo(St[6],St[7]),L.lineTo(St[4],St[5]),L.lineTo(St[2],St[3]),L.lineTo(St[0],St[1]),L.clip())}ge.push(pe),ue.push(se),this.drawTile(We,e,hn,dn,Kn,bi,Ve,yt),ct&&L.restore(),this.renderedTiles.unshift(We),this.updateUsedTiles(e.usedTiles,f,We)}}if(this.renderedResolution=x,this.extentChanged=!this.renderedExtent_||!wd(this.renderedExtent_,U),this.renderedExtent_=U,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&L.restore(),L.imageSmoothingEnabled=!0,this.renderComplete){const Q=(se,ne)=>{const W=it(f),$=ne.wantedTiles[W],ie=$?Object.keys($).length:0;this.updateCacheSize(ie),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(Q)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,u){let h;if(e instanceof uC){if(h=Nv(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),p=it(this),y=t.layerStatesArray[t.layerIndex],x=y.opacity*(u?e.getAlpha(p,t.time):1),S=x!==f.globalAlpha;S&&(f.save(),f.globalAlpha=x),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),S&&f.restore(),x!==y.opacity?t.animate=!0:u&&e.endTransition(p)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=it(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Gg={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class d6 extends Bm{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Gg.PRELOAD)}setPreload(e){this.set(Gg.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Gg.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Gg.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class A0 extends d6{constructor(e){super(e)}createRenderer(){return new h6(this,{cacheSize:this.getCacheSize()})}}const Tc=[0,0,0],Po=5;class xP{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,at(C5(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,at(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Pl(i)),at(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,at(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:N1,at(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new O1(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,u=r.maxY;l<=u;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Ec(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Ec(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Ec(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),f=Math.floor(o*u);if(t<r)return Ec(h,h,f,f,i);const p=Math.floor(u*(s+1))-1,y=Math.floor(u*(o+1))-1;return Ec(h,p,f,y,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Tc);const r=Tc[1],s=Tc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Tc);const o=Tc[1],l=Tc[2];return Ec(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=oi(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=oi(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=l+s[1]*r;return ta(o,l,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),u=this.getOrigin(o),h=oi(this.getTileSize(o),this.tmpSize_);let f=l*(e-u[0])/i/h[0],p=l*(u[1]-t)/i/h[1];return r?(f=Mg(f,Po)-1,p=Mg(p,Po)-1):(f=Dg(f,Po),p=Dg(p,Po)),Bp(o,f,p,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),u=oi(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/u[0],f=(o[1]-t)/l/u[1];return r?(h=Mg(h,Po)-1,f=Mg(f,Po)-1):(h=Dg(h,Po),f=Dg(f,Po)),Bp(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=i1(this.resolutions_,e,t||0);return Nt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return Lb(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function wP(n){let e=n.getDefaultTileGrid();return e||(e=m6(n),n.setDefaultTileGrid(e)),e}function f6(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=F1(t);if(!au(s,r)){const o=dt(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function g6(n,e,t,i){i=i!==void 0?i:"top-left";const r=EP(n,e,t);return new xP({extent:n,origin:D5(n,i),resolutions:r,tileSize:t})}function p6(n){const e=n||{},t=e.extent||ai("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:EP(t,e.maxZoom,e.tileSize,e.maxResolution)};return new xP(i)}function EP(n,e,t,i){e=e!==void 0?e:$3,t=oi(t!==void 0?t:N1);const r=Bn(n),s=dt(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let u=0;u<o;++u)l[u]=i/Math.pow(2,u);return l}function m6(n,e,t,i){const r=F1(n);return g6(r,e,t,i)}function F1(n){n=ai(n);let e=n.getExtent();if(!e){const t=180*lu.degrees/n.getMetersPerUnit();e=ta(-t,-t,t,t)}return e}function EX(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const y6=/\{z\}/g,_6=/\{x\}/g,v6=/\{y\}/g,x6=/\{-y\}/g;function w6(n,e,t,i,r){return n.replace(y6,e.toString()).replace(_6,t.toString()).replace(v6,i.toString()).replace(x6,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function E6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function T6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return w6(n,o,t[1],t[2],s)})}function S6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=T6(n[r],e);return I6(i)}function I6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=a6(e),s=ol(r,n.length);return n[s](e,t,i)})}class C6 extends tP{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&oi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||it(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return tt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:wP(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=oi(r.getTileSize(e),this.tmpSize);return s==1?o:kj(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=f6(r,e,i)),c6(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class R6 extends Zs{constructor(e,t){super(e),this.tile=t}}const b0={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class V1 extends C6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===V1.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=it(t),r=t.getState();let s;r==Ce.LOADING?(this.tileLoadingKeys_[i]=!0,s=b0.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Ce.ERROR?b0.TILELOADERROR:r==Ce.LOADED?b0.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new R6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=E6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(S6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class A6 extends V1{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:TP,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:_P,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!op(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||op(t,e)))return this.tileGrid;const i=it(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=wP(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(l,h!==void 0?Ce.IDLE:Ce.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(Ge.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||op(l,s))return this.getTileInternal(e,t,i,r,l||s);const u=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),p=this.getTileGridForProjection(s),y=this.getTileCoordForTileUrlFunction(u,s),x=new vP(l,f,s,p,u,y,this.getTilePixelRatio(r),this.getGutter(),(S,I,T,R)=>this.getTileInternal(S,I,T,R,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return x.key=h,x}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),u=ap(this,l,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,l);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=ai(e);if(i){const r=it(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function TP(n,e){if(Ti){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Dv extends A6{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:p6({extent:F1(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const b6="modulepreload",P6=function(n){return"/visapp/"+n},mC={},Wg=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=P6(h),h in mC)return;mC[h]=!0;const f=h.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":b6,f||(y.as="script"),y.crossOrigin="",y.href=h,l&&y.setAttribute("nonce",l),document.head.appendChild(y),f)return new Promise((x,S)=>{y.addEventListener("load",x),y.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},k6='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class N6 extends Dv{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[k6];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Ti&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||TP)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const Gp=1/0;class D6{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Qd(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){at(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=Gp?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[u]?h:u;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,u;for(l=0;l<s;++l)o=t[l],u=e(o),u==Gp?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class M6 extends D6{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Ge.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Ce.LOADED||i===Ce.ERROR||i===Ce.EMPTY){i!==Ce.ERROR&&t.removeEventListener(Ge.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Ce.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function L6(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Gp;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Mc extends Zs{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Oo extends Mc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Mt={SINGLECLICK:"singleclick",CLICK:Ge.CLICK,DBLCLICK:Ge.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Mv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class O6 extends Am{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=nt(i,Mv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=nt(i,Mv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Ge.TOUCHMOVE,this.boundHandleTouchMove_,jb?{passive:!1}:!1)}emulateClick_(e){let t=new Oo(Mt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Oo(Mt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Oo(Mt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Mt.POINTERUP||t.type==Mt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Mt.POINTERDOWN||t.type==Mt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Oo(Mt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Oo(Mt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(nt(i,Mt.POINTERMOVE,this.handlePointerMove_,this),nt(i,Mt.POINTERUP,this.handlePointerUp_,this),nt(this.element_,Mt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(nt(this.element_.getRootNode(),Mt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Oo(Mt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Oo(Mt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Rt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Ge.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Rt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Fo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Nn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Gm extends cs{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Rt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==xd&&this.listenerKeys.push(nt(e,Fo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class F6 extends Gm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(Ge.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+nf+" "+E1+(this.collapsed_&&this.collapsible_?" "+DI:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>R5(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!aa(t,this.renderedAttributions_)){O4(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(DI),this.collapsed_?kI(this.collapseLabel_,this.label_):kI(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class V6 extends Gm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Ge.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+nf+" "+E1,u=this.element;u.className=l,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Fg)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:ku}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Fg);!s&&i===0?this.element.classList.add(Fg):s&&i!==0&&this.element.classList.remove(Fg)}this.label_.style.transform=r}this.rotation_=i}}class j6 extends Gm{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Ge.CLICK,this.handleClick_.bind(this,i),!1);const p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=h,p.appendChild(typeof l=="string"?document.createTextNode(l):l),p.addEventListener(Ge.CLICK,this.handleClick_.bind(this,-i),!1);const y=t+" "+nf+" "+E1,x=this.element;x.className=y,x.appendChild(f),x.appendChild(p),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:ku})):i.setZoom(s)}}}function z6(n){n=n||{};const e=new Hi;return(n.zoom===void 0||n.zoom)&&e.push(new j6(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new V6(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new F6(n.attributionOptions)),e}class U6{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const yC={ACTIVE:"active"};class af extends cs{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(yC.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(yC.ACTIVE,e)}setMap(e){this.map_=e}}function B6(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:z3,center:n.getConstrainedCenter(r)})}}function j1(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:ku})}class G6 extends af{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Mt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();j1(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function Lv(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const W6=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},$6=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},SP=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?$6(n):!0},K6=vd,IP=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(M4&&Fb&&e.ctrlKey)},CP=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},H6=function(n){const e=n.originalEvent;return Fb?e.metaKey:e.ctrlKey},X6=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},RP=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},P0=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},q6=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class lf extends af{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Mt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Mt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Mt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Mt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function z1(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class Y6 extends lf{constructor(e){super({stopDown:Rm}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Lv(CP,q6);this.condition_=e.onFocusOnly?Lv(SP,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(z1(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();j5(s,l.getResolution()),a1(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:ku})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class Z6 extends lf{constructor(e){e=e||{},super({stopDown:Rm}),this.condition_=e.condition?e.condition:W6,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!P0(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===k1)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return P0(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return P0(e)&&IP(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class Q6 extends Cm{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Ad([r])}getGeometry(){return this.geometry_}}const Sc={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class bh extends Zs{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class J6 extends lf{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new Q6(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??IP,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new bh(Sc.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new bh(t?Sc.BOXEND:Sc.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new bh(Sc.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new bh(Sc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new bh(Sc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class ez extends J6{constructor(e){e=e||{};const t=e.condition?e.condition:X6;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:ku})}}const Oa={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class tz extends af{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return CP(t)&&RP(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Ge.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Oa.DOWN||r==Oa.LEFT||r==Oa.RIGHT||r==Oa.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==Oa.DOWN?h=-l:r==Oa.LEFT?u=-l:r==Oa.RIGHT?u=l:h=l;const f=[u,h];a1(f,o.getRotation()),B6(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class nz extends af{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!H6(t)&&RP(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Ge.KEYDOWN||e.type==Ge.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();j1(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const iz=40,rz=300;class sz extends af{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:K6;this.condition_=e.onFocusOnly?Lv(SP,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Ge.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=iz;break;case WheelEvent.DOM_DELTA_PAGE:s*=rz;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Nt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),j1(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class oz extends lf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Rm),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==k1&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(z1(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class az extends lf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Rm),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(z1(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function lz(n){n=n||{};const e=new Hi,t=new U6(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new Z6),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new G6({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new Y6({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new oz),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new az({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new tz),e.push(new nz({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new sz({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new ez({duration:n.zoomDuration})),e}class cz extends Cm{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){tt()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Hs(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),Rb(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,u){let h;const f=t.viewState;function p(M,F,U,P){return s.call(o,F,M?U:null,P)}const y=f.projection,x=_b(e.slice(),y),S=[[0,0]];if(y.canWrapX()&&r){const M=y.getExtent(),F=dt(M);S.push([-F,0],[F,0])}const I=t.layerStatesArray,T=I.length,R=[],k=[];for(let M=0;M<S.length;M++)for(let F=T-1;F>=0;--F){const U=I[F],P=U.layer;if(P.hasRenderer()&&D1(U,f)&&l.call(u,P)){const A=P.getRenderer(),D=P.getSource();if(A&&D){const V=D.getWrapX()?x:e,j=p.bind(null,U.managed);k[0]=V[0]+S[M][0],k[1]=V[1]+S[M][1],h=A.forEachFeatureAtCoordinate(k,t,i,j,R)}if(h)return h}}if(R.length===0)return;const N=1/R.length;return R.forEach((M,F)=>M.distanceSq+=F*N),R.sort((M,F)=>M.distanceSq-F.distanceSq),R.some(M=>h=M.callback(M.feature,M.layer,M.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,vd,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){tt()}scheduleExpireIconCache(e){qi.canExpireCache()&&e.postRenderFunctions.push(uz)}}function uz(n,e){qi.expire()}class hz extends cz{constructor(e){super(e),this.fontChangeListenerKey_=nt(kc,ru.PROPERTYCHANGE,e.redrawText,e),this.element_=Ti?zb():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=nf+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new oP(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Rt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Xi.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof yP&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const p=t[h];e.layerIndex=h;const y=p.layer,x=y.getSourceState();if(!D1(p,r)||x!="ready"&&x!="undefined"){y.unrender();continue}const S=y.render(e,o);S&&(S!==o&&(this.children_.push(S),o=S),s.push(p))}this.declutter(e,s),F4(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Wo(u)){const h=u.getContext("2d");for(const f of this.children_){const p=f.firstElementChild||f,y=f.style.backgroundColor;if(y&&(!Wo(p)||p.width>0)&&(h.fillStyle=y,h.fillRect(0,0,u.width,u.height)),Wo(p)&&p.width>0){const x=f.style.opacity||p.style.opacity;h.globalAlpha=x===""?1:Number(x);const S=p.style.transform;if(S)h.setTransform(...Iv(S));else{const I=parseFloat(p.style.width)/p.width,T=parseFloat(p.style.height)/p.height;h.setTransform(I,0,0,T,0,0)}h.drawImage(p,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Xi.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function AP(n){if(n instanceof Bm){n.setMapInternal(null);return}n instanceof Nu&&n.getLayers().forEach(AP)}function bP(n,e){if(n instanceof Bm){n.setMapInternal(e);return}if(n instanceof Nu){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)bP(t[i],e)}}let dz=class extends cs{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=fz(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:L4,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Er(),this.pixelToCoordinateTransform_=Er(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ti||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ti||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ti?new Hi:z6()),this.interactions=t.interactions||(Ti?new Hi:lz({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new M6(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Nn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Nn.VIEW,this.handleViewChanged_),this.addChangeListener(Nn.SIZE,this.handleSizeChanged_),this.addChangeListener(Nn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Zr)&&e.view.then(function(r){i.setView(new Zr(r))}),this.controls.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(ei.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(ei.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){bP(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:vd,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof Nu?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:vd,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(Nn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Sv(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?un(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Nn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Hi){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ds(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?un(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Nn.SIZE)}getView(){return this.get(Nn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return L6(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Oo(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Mv.POINTERDOWN||i===Ge.WHEEL||i===Ge.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Mn.ANIMATING]||o[Mn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Xi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Xi.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Mc(Fo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Mc(Fo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Rt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Ge.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Ge.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Wo(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Wo(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new hz(this)),!Wo(t)){this.mapBrowserEventHandler_=new O6(this,this.moveTolerance_);for(const r in Mt)this.mapBrowserEventHandler_.addEventListener(Mt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Ge.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Ge.WHEEL,this.boundHandleBrowserEvent_,jb?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[nt(i,Ge.KEYDOWN,this.handleBrowserEvent,this),nt(i,Ge.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Rt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Rt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=nt(e,ru.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=nt(e,Ge.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Rt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Vo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[nt(e,ru.PROPERTYCHANGE,this.render,this),nt(e,Ge.CHANGE,this.render,this),nt(e,"addlayer",this.handleLayerAdd_,this),nt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){AP(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&$I(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:vv(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:it(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=vv(l.nextCenter,l.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Dm(this.previousExtent_)&&!wd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Mc(Fo.MOVESTART,this,r)),this.previousExtent_=bm(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Mn.ANIMATING]&&!s.viewHints[Mn.INTERACTING]&&!wd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Mc(Fo.MOVEEND,this,s)),cb(s.extent,this.previousExtent_))),this.dispatchEvent(new Mc(Fo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Fo.LOADSTART)||this.hasListener(Fo.LOADEND)||this.hasListener(Xi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Vo("removelayer",t)),this.set(Nn.LAYERGROUP,e)}setSize(e){this.set(Nn.SIZE,e)}setTarget(e){this.set(Nn.TARGET,e)}setView(e){if(!e||e instanceof Zr){this.set(Nn.VIEW,e);return}this.set(Nn.VIEW,new Zr);const t=this;e.then(function(i){t.setView(new Zr(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Wo(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!$I(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&vb("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!aa(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function fz(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Nu({layers:n.layers});t[Nn.LAYERGROUP]=i,t[Nn.TARGET]=n.target,t[Nn.VIEW]=n.view instanceof Zr?n.view:new Zr;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Hi(n.controls.slice()):(at(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Hi(n.interactions.slice()):(at(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Hi(n.overlays.slice()):(at(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Hi,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const k0="units",gz=[1,2,5],Ph=25.4/.28;class pz extends Gm{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+nf,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(k0,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(k0)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(k0,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Dp(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||Ph)/Ph,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Ph)/Ph:void 0;let h=l*o,f="";if(r=="degrees"){const N=lu.degrees;h*=N,h<N/60?(f="",o*=3600):h<N?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let p=3*Math.floor(Math.log(l*o)/Math.log(10)),y,x,S,I=0,T,R;for(;;){S=Math.floor(p/3);const N=Math.pow(10,S);if(y=gz[(p%3+3)%3]*N,x=Math.round(y/o),isNaN(x)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&x>=u){y=I,x=T,S=R;break}else if(x>=l)break;I=y,T=x,R=S,++p}const k=this.scaleBar_?this.createScaleBar(x,y,f):y.toFixed(S<0?-S:0)+" "+f;this.renderedHTML_!=k&&(this.innerElement_.innerHTML=k,this.renderedHTML_=k),this.renderedWidth_!=x&&(this.innerElement_.style.width=x+"px",this.renderedWidth_=x),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,u=[this.createMarker("absolute")];for(let f=0;f<o;++f){const p=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${p}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return u.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),u=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=Dp(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Ph,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const mz={},_C=n=>{let e;const t=new Set,i=(f,p)=>{const y=typeof f=="function"?f(e):f;if(!Object.is(y,e)){const x=e;e=p??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(S=>S(e,x))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(mz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},yz=n=>n?_C(n):_C;var N0={exports:{}},D0={},M0={exports:{}},L0={};var vC;function _z(){if(vC)return L0;vC=1;var n=Hd();function e(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(p,y){var x=y(),S=i({inst:{value:x,getSnapshot:y}}),I=S[0].inst,T=S[1];return s(function(){I.value=x,I.getSnapshot=y,u(I)&&T({inst:I})},[p,x,y]),r(function(){return u(I)&&T({inst:I}),p(function(){u(I)&&T({inst:I})})},[p]),o(x),x}function u(p){var y=p.getSnapshot;p=p.value;try{var x=y();return!t(p,x)}catch{return!0}}function h(p,y){return y()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return L0.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,L0}var xC;function vz(){return xC||(xC=1,M0.exports=_z()),M0.exports}var wC;function xz(){if(wC)return D0;wC=1;var n=Hd(),e=vz();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return D0.useSyncExternalStoreWithSelector=function(h,f,p,y,x){var S=s(null);if(S.current===null){var I={hasValue:!1,value:null};S.current=I}else I=S.current;S=l(function(){function R(U){if(!k){if(k=!0,N=U,U=y(U),x!==void 0&&I.hasValue){var P=I.value;if(x(P,U))return M=P}return M=U}if(P=M,i(N,U))return P;var A=y(U);return x!==void 0&&x(P,A)?(N=U,P):(N=U,M=A)}var k=!1,N,M,F=p===void 0?null:p;return[function(){return R(f())},F===null?void 0:function(){return R(F())}]},[f,p,y,x]);var T=r(h,S[0],S[1]);return o(function(){I.hasValue=!0,I.value=T},[T]),u(T),T},D0}var EC;function wz(){return EC||(EC=1,N0.exports=xz()),N0.exports}var Ez=wz();const Tz=Ex(Ez),PP={},{useDebugValue:Sz}=YM,{useSyncExternalStoreWithSelector:Iz}=Tz;let TC=!1;const Cz=n=>n;function Rz(n,e=Cz,t){(PP?"production":void 0)!=="production"&&t&&!TC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),TC=!0);const i=Iz(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return Sz(i),i}const SC=n=>{(PP?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?yz(n):n,t=(i,r)=>Rz(e,i,r);return Object.assign(t,e),t},us=n=>n?SC(n):SC;var kP=Symbol.for("immer-nothing"),IC=Symbol.for("immer-draftable"),Ri=Symbol.for("immer-state");function mr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var kd=Object.getPrototypeOf;function fu(n){return!!n&&!!n[Ri]}function _l(n){return n?NP(n)||Array.isArray(n)||!!n[IC]||!!n.constructor?.[IC]||cf(n)||$m(n):!1}var Az=Object.prototype.constructor.toString(),CC=new WeakMap;function NP(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=CC.get(t);return i===void 0&&(i=Function.toString.call(t),CC.set(t,i)),i===Az}function Wp(n,e,t=!0){Wm(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function Wm(n){const e=n[Ri];return e?e.type_:Array.isArray(n)?1:cf(n)?2:$m(n)?3:0}function Ov(n,e){return Wm(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function DP(n,e,t){const i=Wm(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function bz(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function cf(n){return n instanceof Map}function $m(n){return n instanceof Set}function Ua(n){return n.copy_||n.base_}function Fv(n,e){if(cf(n))return new Map(n);if($m(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=NP(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Ri];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(kd(n),i)}else{const i=kd(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function U1(n,e=!1){return Km(n)||fu(n)||!_l(n)||(Wm(n)>1&&Object.defineProperties(n,{set:$g,add:$g,clear:$g,delete:$g}),Object.freeze(n),e&&Object.values(n).forEach(t=>U1(t,!0))),n}function Pz(){mr(2)}var $g={value:Pz};function Km(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var kz={};function vl(n){const e=kz[n];return e||mr(0,n),e}var Nd;function MP(){return Nd}function Nz(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function RC(n,e){e&&(vl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Vv(n){jv(n),n.drafts_.forEach(Dz),n.drafts_=null}function jv(n){n===Nd&&(Nd=n.parent_)}function AC(n){return Nd=Nz(Nd,n)}function Dz(n){const e=n[Ri];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function bC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Ri].modified_&&(Vv(e),mr(4)),_l(n)&&(n=$p(e,n),e.parent_||Kp(e,n)),e.patches_&&vl("Patches").generateReplacementPatches_(t[Ri].base_,n,e.patches_,e.inversePatches_)):n=$p(e,t,[]),Vv(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==kP?n:void 0}function $p(n,e,t){if(Km(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Ri];if(!r)return Wp(e,(s,o)=>PC(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return Kp(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),Wp(o,(u,h)=>PC(n,r,s,u,h,t,l),i),Kp(n,s,!1),t&&n.patches_&&vl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function PC(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=Km(r);if(!(l&&!o)){if(fu(r)){const u=s&&e&&e.type_!==3&&!Ov(e.assigned_,i)?s.concat(i):void 0,h=$p(n,r,u);if(DP(t,i,h),fu(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(_l(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;$p(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(cf(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&Kp(n,r)}}}function Kp(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&U1(e,t)}function Mz(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:MP(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=B1;t&&(r=[i],s=Dd);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var B1={get(n,e){if(e===Ri)return n;const t=Ua(n);if(!Ov(t,e))return Lz(n,t,e);const i=t[e];return n.finalized_||!_l(i)?i:i===O0(n.base_,e)?(F0(n),n.copy_[e]=Uv(i,n)):i},has(n,e){return e in Ua(n)},ownKeys(n){return Reflect.ownKeys(Ua(n))},set(n,e,t){const i=LP(Ua(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=O0(Ua(n),e),s=r?.[Ri];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(bz(t,r)&&(t!==void 0||Ov(n.base_,e)))return!0;F0(n),zv(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return O0(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,F0(n),zv(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Ua(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){mr(11)},getPrototypeOf(n){return kd(n.base_)},setPrototypeOf(){mr(12)}},Dd={};Wp(B1,(n,e)=>{Dd[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Dd.deleteProperty=function(n,e){return Dd.set.call(this,n,e,void 0)};Dd.set=function(n,e,t){return B1.set.call(this,n[0],e,t,n[0])};function O0(n,e){const t=n[Ri];return(t?Ua(t):n)[e]}function Lz(n,e,t){const i=LP(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function LP(n,e){if(!(e in n))return;let t=kd(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=kd(t)}}function zv(n){n.modified_||(n.modified_=!0,n.parent_&&zv(n.parent_))}function F0(n){n.copy_||(n.copy_=Fv(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var Oz=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,f=>t.call(this,f,...h))}}typeof t!="function"&&mr(6),i!==void 0&&typeof i!="function"&&mr(7);let r;if(_l(e)){const s=AC(this),o=Uv(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?Vv(s):jv(s)}return RC(s,i),bC(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===kP&&(r=void 0),this.autoFreeze_&&U1(r,!0),i){const s=[],o=[];vl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else mr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){_l(n)||mr(8),fu(n)&&(n=Fz(n));const e=AC(this),t=Uv(n,void 0);return t[Ri].isManual_=!0,jv(e),t}finishDraft(n,e){const t=n&&n[Ri];(!t||!t.isManual_)&&mr(9);const{scope_:i}=t;return RC(i,e),bC(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=vl("Patches").applyPatches_;return fu(n)?i(n,e):this.produce(n,r=>i(r,e))}};function Uv(n,e){const t=cf(n)?vl("MapSet").proxyMap_(n,e):$m(n)?vl("MapSet").proxySet_(n,e):Mz(n,e);return(e?e.scope_:MP()).drafts_.push(t),t}function Fz(n){return fu(n)||mr(10,n),OP(n)}function OP(n){if(!_l(n)||Km(n))return n;const e=n[Ri];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Fv(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=Fv(n,!0);return Wp(t,(r,s)=>{DP(t,r,OP(s))},i),e&&(e.finalized_=!1),t}var Vz=new Oz,jz=Vz.produce;const zz=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?jz(r):r;return e(l,s,...o)},n(i.setState,t,i)),Hm=zz,wi=us()(Hm((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),FP={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await Wg(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-C7VWr_jB.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Boothellingen:{name:"Boothellingen",factory:async()=>{const{createBoothellingenLayer:n}=await Wg(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-BZ5vrPC_.js");return{createBoothellingenLayer:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await Wg(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-B6L5OoX_.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await Wg(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-I8lsoYHS.js");return{createViswaterLayer:e}},__vite__mapDeps([3,1]));return n()},immediateLoad:!1}};function Uz(){return Object.values(FP).filter(n=>n.immediateLoad)}const Js=us()(Hm((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),qo=us()(Hm((n,e)=>({visible:{OpenStreetMap:!0,Luchtfoto:!1,"Labels Overlay":!1,Aanlegsteigers:!1,Boothellingen:!1,Dieptekaart:!1,Viswater:!1,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=FP[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=Js.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),ii=us()(Hm(n=>({layerControlOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchFormLocationSource:null,catchFormInitialPhotos:[],catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e?.location||null,t.catchFormLocationSource=e?.locationSource||null,t.catchFormInitialPhotos=e?.photos||[]})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null,e.catchFormLocationSource=null,e.catchFormInitialPhotos=[]})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),Bz={};function Gz(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Md=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Md(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Md(i)(t)}}}},Wz=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:T=>T,version:0,merge:(T,R)=>({...R,...T}),...e},o=!1;const l=new Set,u=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...T)},i,r);const f=Md(s.serialize),p=()=>{const T=s.partialize({...i()});let R;const k=f({state:T,version:s.version}).then(N=>h.setItem(s.name,N)).catch(N=>{R=N});if(R)throw R;return k},y=r.setState;r.setState=(T,R)=>{y(T,R),p()};const x=n((...T)=>{t(...T),p()},i,r);let S;const I=()=>{var T;if(!h)return;o=!1,l.forEach(k=>k(i()));const R=((T=s.onRehydrateStorage)==null?void 0:T.call(s,i()))||void 0;return Md(h.getItem.bind(h))(s.name).then(k=>{if(k)return s.deserialize(k)}).then(k=>{if(k)if(typeof k.version=="number"&&k.version!==s.version){if(s.migrate)return s.migrate(k.state,k.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return k.state}).then(k=>{var N;return S=s.merge(k,(N=i())!=null?N:x),t(S,!0),p()}).then(()=>{R?.(S,void 0),o=!0,u.forEach(k=>k(S))}).catch(k=>{R?.(void 0,k)})};return r.persist={setOptions:T=>{s={...s,...T},T.getStorage&&(h=T.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:T=>(l.add(T),()=>{l.delete(T)}),onFinishHydration:T=>(u.add(T),()=>{u.delete(T)})},I(),S||x},$z=(n,e)=>(t,i,r)=>{let s={storage:Gz(()=>localStorage),partialize:I=>I,version:0,merge:(I,T)=>({...T,...I}),...e},o=!1;const l=new Set,u=new Set;let h=s.storage;if(!h)return n((...I)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...I)},i,r);const f=()=>{const I=s.partialize({...i()});return h.setItem(s.name,{state:I,version:s.version})},p=r.setState;r.setState=(I,T)=>{p(I,T),f()};const y=n((...I)=>{t(...I),f()},i,r);r.getInitialState=()=>y;let x;const S=()=>{var I,T;if(!h)return;o=!1,l.forEach(k=>{var N;return k((N=i())!=null?N:y)});const R=((T=s.onRehydrateStorage)==null?void 0:T.call(s,(I=i())!=null?I:y))||void 0;return Md(h.getItem.bind(h))(s.name).then(k=>{if(k)if(typeof k.version=="number"&&k.version!==s.version){if(s.migrate)return[!0,s.migrate(k.state,k.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,k.state];return[!1,void 0]}).then(k=>{var N;const[M,F]=k;if(x=s.merge(F,(N=i())!=null?N:y),t(x,!0),M)return f()}).then(()=>{R?.(x,void 0),x=i(),o=!0,u.forEach(k=>k(x))}).catch(k=>{R?.(void 0,k)})};return r.persist={setOptions:I=>{s={...s,...I},I.storage&&(h=I.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>S(),hasHydrated:()=>o,onHydrate:I=>(l.add(I),()=>{l.delete(I)}),onFinishHydration:I=>(u.add(I),()=>{u.delete(I)})},s.skipHydration||S(),x||y},Kz=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((Bz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Wz(n,e)):$z(n,e),uf=Kz,Ut=us()(uf(n=>({defaultBackground:"OpenStreetMap",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e})}),{name:"visapp-settings"})),VP=us()(uf((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),Ld=us((n,e)=>({current:null,pressureHistory:[],hourlyForecast:[],loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code",hourly:"temperature_2m,wind_speed_10m,wind_direction_10m,surface_pressure,weather_code",past_hours:"24",forecast_hours:"48",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();let l=[],u=[];o.hourly?.time&&o.hourly?.surface_pressure&&(l=o.hourly.time.map((h,f)=>({time:h,pressure:o.hourly.surface_pressure[f]})),u=o.hourly.time.map((h,f)=>({time:h,temperature:o.hourly.temperature_2m[f],windSpeed:o.hourly.wind_speed_10m[f],windDirection:o.hourly.wind_direction_10m[f],pressure:o.hourly.surface_pressure[f],weatherCode:o.hourly.weather_code[f]}))),o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},pressureHistory:l,hourlyForecast:u,loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"},getFishingScore:()=>{const{current:t}=e();if(!t)return 1;let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),Math.max(0,Math.min(3,i/2))},getPressureTrend:()=>{const{pressureHistory:t}=e();if(t.length<6)return"stable";const i=t.slice(-6),r=t.slice(-12,-6);if(r.length===0)return"stable";const s=i.reduce((u,h)=>u+h.pressure,0)/i.length,o=r.reduce((u,h)=>u+h.pressure,0)/r.length,l=s-o;return l>2?"rising":l<-2?"falling":"stable"},getWeatherAtTime:t=>{const{hourlyForecast:i}=e();if(i.length===0)return null;t.toISOString().slice(0,13)+"";let r=i[0],s=1/0;for(const o of i){const l=new Date(o.time).getTime(),u=Math.abs(l-t.getTime());u<s&&(s=u,r=o)}return r}})),jP=us()(uf(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),kC=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],NC=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],Hz=us()(uf((n,e)=>({presets:kC,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=qo.getState().setLayerVisibility;NC.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=qo.getState().visible,r=NC.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:kC})}}),{name:"visapp-presets"})),Xz=()=>{};var DC={};const zP=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},qz=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},UP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,f=s>>2,p=(s&3)<<4|l>>4;let y=(l&15)<<2|h>>6,x=h&63;u||(x=64,o||(y=64)),i.push(t[f],t[p],t[y],t[x])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(zP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):qz(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||p==null)throw new Yz;const y=s<<2|l>>4;if(i.push(y),h!==64){const x=l<<4&240|h>>2;if(i.push(x),p!==64){const S=h<<6&192|p;i.push(S)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Yz extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Zz=function(n){const e=zP(n);return UP.encodeByteArray(e,!0)},Hp=function(n){return Zz(n).replace(/\./g,"")},BP=function(n){try{return UP.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function GP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Qz=()=>GP().__FIREBASE_DEFAULTS__,Jz=()=>{if(typeof process>"u"||typeof DC>"u")return;const n=DC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},eU=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&BP(n[1]);return e&&JSON.parse(e)},Xm=()=>{try{return Xz()||Qz()||Jz()||eU()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},WP=n=>Xm()?.emulatorHosts?.[n],$P=n=>{const e=WP(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},KP=()=>Xm()?.config,HP=n=>Xm()?.[`_${n}`];class tU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Dl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function G1(n){return(await fetch(n,{credentials:"include"})).ok}function XP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Hp(JSON.stringify(t)),Hp(JSON.stringify(o)),""].join(".")}const td={};function nU(){const n={prod:[],emulator:[]};for(const e of Object.keys(td))td[e]?n.emulator.push(e):n.prod.push(e);return n}function iU(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let MC=!1;function W1(n,e){if(typeof window>"u"||typeof document>"u"||!Dl(window.location.host)||td[n]===e||td[n]||MC)return;td[n]=e;function t(y){return`__firebase__banner__${y}`}const i="__firebase__banner",s=nU().prod.length>0;function o(){const y=document.getElementById(i);y&&y.remove()}function l(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,x){y.setAttribute("width","24"),y.setAttribute("id",x),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{MC=!0,o()},y}function f(y,x){y.setAttribute("id",x),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function p(){const y=iU(i),x=t("text"),S=document.getElementById(x)||document.createElement("span"),I=t("learnmore"),T=document.getElementById(I)||document.createElement("a"),R=t("preprendIcon"),k=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const N=y.element;l(N),f(T,I);const M=h();u(k,R),N.append(k,S,T,M),document.body.appendChild(N)}s?(S.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function en(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(en())}function qP(){const n=Xm()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oU(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function aU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function lU(){const n=en();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function YP(){return!qP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ZP(){return!qP()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function QP(){try{return typeof indexedDB=="object"}catch{return!1}}function cU(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const uU="FirebaseError";class hs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=uU,Object.setPrototypeOf(this,hs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hf.prototype.create)}}class hf{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?hU(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new hs(r,l,i)}}function hU(n,e){return n.replace(dU,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const dU=/\{\$([^}]+)}/g;function fU(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function xl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(LC(s)&&LC(o)){if(!xl(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function LC(n){return n!==null&&typeof n=="object"}function df(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function gU(n,e){const t=new pU(n,e);return t.subscribe.bind(t)}class pU{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");mU(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=V0),r.error===void 0&&(r.error=V0),r.complete===void 0&&(r.complete=V0);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function mU(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function V0(){}function eo(n){return n&&n._delegate?n._delegate:n}class na{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ba="[DEFAULT]";class yU{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new tU;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vU(e))try{this.getOrInitializeService({instanceIdentifier:Ba})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ba){return this.instances.has(e)}getOptions(e=Ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:_U(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ba){return this.component?this.component.multipleInstances?e:Ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _U(n){return n===Ba?void 0:n}function vU(n){return n.instantiationMode==="EAGER"}class xU{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new yU(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var He;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(He||(He={}));const wU={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},EU=He.INFO,TU={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},SU=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=TU[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $1{constructor(e){this.name=e,this._logLevel=EU,this._logHandler=SU,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wU[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const IU=(n,e)=>e.some(t=>n instanceof t);let OC,FC;function CU(){return OC||(OC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function RU(){return FC||(FC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const JP=new WeakMap,Bv=new WeakMap,ek=new WeakMap,j0=new WeakMap,K1=new WeakMap;function AU(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Yo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&JP.set(t,n)}).catch(()=>{}),K1.set(e,n),e}function bU(n){if(Bv.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Bv.set(n,e)}let Gv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Bv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ek.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Yo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function PU(n){Gv=n(Gv)}function kU(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(z0(this),e,...t);return ek.set(i,e.sort?e.sort():[e]),Yo(i)}:RU().includes(n)?function(...e){return n.apply(z0(this),e),Yo(JP.get(this))}:function(...e){return Yo(n.apply(z0(this),e))}}function NU(n){return typeof n=="function"?kU(n):(n instanceof IDBTransaction&&bU(n),IU(n,CU())?new Proxy(n,Gv):n)}function Yo(n){if(n instanceof IDBRequest)return AU(n);if(j0.has(n))return j0.get(n);const e=NU(n);return e!==n&&(j0.set(n,e),K1.set(e,n)),e}const z0=n=>K1.get(n);function DU(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Yo(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Yo(o.result),u.oldVersion,u.newVersion,Yo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const MU=["get","getKey","getAll","getAllKeys","count"],LU=["put","add","delete","clear"],U0=new Map;function VC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(U0.get(e))return U0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=LU.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||MU.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&u.done]))[0]};return U0.set(e,s),s}PU(n=>({...n,get:(e,t,i)=>VC(e,t)||n.get(e,t,i),has:(e,t)=>!!VC(e,t)||n.has(e,t)}));class OU{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(FU(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function FU(n){return n.getComponent()?.type==="VERSION"}const Wv="@firebase/app",jC="0.14.6";const Xs=new $1("@firebase/app"),VU="@firebase/app-compat",jU="@firebase/analytics-compat",zU="@firebase/analytics",UU="@firebase/app-check-compat",BU="@firebase/app-check",GU="@firebase/auth",WU="@firebase/auth-compat",$U="@firebase/database",KU="@firebase/data-connect",HU="@firebase/database-compat",XU="@firebase/functions",qU="@firebase/functions-compat",YU="@firebase/installations",ZU="@firebase/installations-compat",QU="@firebase/messaging",JU="@firebase/messaging-compat",e9="@firebase/performance",t9="@firebase/performance-compat",n9="@firebase/remote-config",i9="@firebase/remote-config-compat",r9="@firebase/storage",s9="@firebase/storage-compat",o9="@firebase/firestore",a9="@firebase/ai",l9="@firebase/firestore-compat",c9="firebase",u9="12.6.0";const $v="[DEFAULT]",h9={[Wv]:"fire-core",[VU]:"fire-core-compat",[zU]:"fire-analytics",[jU]:"fire-analytics-compat",[BU]:"fire-app-check",[UU]:"fire-app-check-compat",[GU]:"fire-auth",[WU]:"fire-auth-compat",[$U]:"fire-rtdb",[KU]:"fire-data-connect",[HU]:"fire-rtdb-compat",[XU]:"fire-fn",[qU]:"fire-fn-compat",[YU]:"fire-iid",[ZU]:"fire-iid-compat",[QU]:"fire-fcm",[JU]:"fire-fcm-compat",[e9]:"fire-perf",[t9]:"fire-perf-compat",[n9]:"fire-rc",[i9]:"fire-rc-compat",[r9]:"fire-gcs",[s9]:"fire-gcs-compat",[o9]:"fire-fst",[l9]:"fire-fst-compat",[a9]:"fire-vertex","fire-js":"fire-js",[c9]:"fire-js-all"};const Xp=new Map,d9=new Map,Kv=new Map;function zC(n,e){try{n.container.addComponent(e)}catch(t){Xs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function wl(n){const e=n.name;if(Kv.has(e))return Xs.debug(`There were multiple attempts to register component ${e}.`),!1;Kv.set(e,n);for(const t of Xp.values())zC(t,n);for(const t of d9.values())zC(t,n);return!0}function qm(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ki(n){return n==null?!1:n.settings!==void 0}const f9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zo=new hf("app","Firebase",f9);class g9{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new na("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zo.create("app-deleted",{appName:this._name})}}const Ml=u9;function tk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:$v,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Zo.create("bad-app-name",{appName:String(r)});if(t||(t=KP()),!t)throw Zo.create("no-options");const s=Xp.get(r);if(s){if(xl(t,s.options)&&xl(i,s.config))return s;throw Zo.create("duplicate-app",{appName:r})}const o=new xU(r);for(const u of Kv.values())o.addComponent(u);const l=new g9(t,i,o);return Xp.set(r,l),l}function H1(n=$v){const e=Xp.get(n);if(!e&&n===$v&&KP())return tk();if(!e)throw Zo.create("no-app",{appName:n});return e}function rs(n,e,t){let i=h9[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xs.warn(o.join(" "));return}wl(new na(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const p9="firebase-heartbeat-database",m9=1,Od="firebase-heartbeat-store";let B0=null;function nk(){return B0||(B0=DU(p9,m9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Od)}catch(t){console.warn(t)}}}}).catch(n=>{throw Zo.create("idb-open",{originalErrorMessage:n.message})})),B0}async function y9(n){try{const t=(await nk()).transaction(Od),i=await t.objectStore(Od).get(ik(n));return await t.done,i}catch(e){if(e instanceof hs)Xs.warn(e.message);else{const t=Zo.create("idb-get",{originalErrorMessage:e?.message});Xs.warn(t.message)}}}async function UC(n,e){try{const i=(await nk()).transaction(Od,"readwrite");await i.objectStore(Od).put(e,ik(n)),await i.done}catch(t){if(t instanceof hs)Xs.warn(t.message);else{const i=Zo.create("idb-set",{originalErrorMessage:t?.message});Xs.warn(i.message)}}}function ik(n){return`${n.name}!${n.options.appId}`}const _9=1024,v9=30;class x9{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new E9(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=BC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>v9){const r=T9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=BC(),{heartbeatsToSend:t,unsentEntries:i}=w9(this._heartbeatsCache.heartbeats),r=Hp(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Xs.warn(e),""}}}function BC(){return new Date().toISOString().substring(0,10)}function w9(n,e=_9){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),GC(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),GC(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class E9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return QP()?cU().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await y9(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return UC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return UC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function GC(n){return Hp(JSON.stringify({version:2,heartbeats:n})).length}function T9(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function S9(n){wl(new na("platform-logger",e=>new OU(e),"PRIVATE")),wl(new na("heartbeat",e=>new x9(e),"PRIVATE")),rs(Wv,jC,n),rs(Wv,jC,"esm2020"),rs("fire-js","")}S9("");function rk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const I9=rk,sk=new hf("auth","Firebase",rk());const qp=new $1("@firebase/auth");function C9(n,...e){qp.logLevel<=He.WARN&&qp.warn(`Auth (${Ml}): ${n}`,...e)}function lp(n,...e){qp.logLevel<=He.ERROR&&qp.error(`Auth (${Ml}): ${n}`,...e)}function os(n,...e){throw q1(n,...e)}function Tr(n,...e){return q1(n,...e)}function X1(n,e,t){const i={...I9(),[e]:t};return new hf("auth","Firebase",i).create(e,{appName:n.name})}function al(n){return X1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function R9(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&os(n,"argument-error"),X1(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function q1(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return sk.create(n,...e)}function Fe(n,e,...t){if(!n)throw q1(e,...t)}function Fs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw lp(e),new Error(e)}function qs(n,e){n||Fs(e)}function Hv(){return typeof self<"u"&&self.location?.href||""}function A9(){return WC()==="http:"||WC()==="https:"}function WC(){return typeof self<"u"&&self.location?.protocol||null}function b9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(A9()||oU()||"connection"in navigator)?navigator.onLine:!0}function P9(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class ff{constructor(e,t){this.shortDelay=e,this.longDelay=t,qs(t>e,"Short delay should be less than long delay!"),this.isMobile=rU()||aU()}get(){return b9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Y1(n,e){qs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class ok{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const k9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const N9=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],D9=new ff(3e4,6e4);function Z1(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Du(n,e,t,i,r={}){return ak(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=df({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return sU()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(h.credentials="include"),ok.fetch()(await lk(n,n.config.apiHost,t,l),h)})}async function ak(n,e,t){n._canInitEmulator=!1;const i={...k9,...e};try{const r=new L9(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Kg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Kg(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Kg(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Kg(n,"user-disabled",o);const f=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw X1(n,f,h);os(n,f)}}catch(r){if(r instanceof hs)throw r;os(n,"network-request-failed",{message:String(r)})}}async function M9(n,e,t,i,r={}){const s=await Du(n,e,t,i,r);return"mfaPendingCredential"in s&&os(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function lk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?Y1(n.config,r):`${n.config.apiScheme}://${r}`;return N9.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class L9{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Tr(this.auth,"network-request-failed")),D9.get())})}}function Kg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Tr(n,e,i);return r.customData._tokenResponse=t,r}async function O9(n,e){return Du(n,"POST","/v1/accounts:delete",e)}async function Yp(n,e){return Du(n,"POST","/v1/accounts:lookup",e)}function nd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function F9(n,e=!1){const t=eo(n),i=await t.getIdToken(e),r=Q1(i);Fe(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:nd(G0(r.auth_time)),issuedAtTime:nd(G0(r.iat)),expirationTime:nd(G0(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function G0(n){return Number(n)*1e3}function Q1(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return lp("JWT malformed, contained fewer than 3 sections"),null;try{const r=BP(t);return r?JSON.parse(r):(lp("Failed to decode base64 JWT payload"),null)}catch(r){return lp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function $C(n){const e=Q1(n);return Fe(e,"internal-error"),Fe(typeof e.exp<"u","internal-error"),Fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Fd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof hs&&V9(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function V9({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class j9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Xv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=nd(this.lastLoginAt),this.creationTime=nd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Zp(n){const e=n.auth,t=await n.getIdToken(),i=await Fd(n,Yp(e,{idToken:t}));Fe(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?ck(r.providerUserInfo):[],o=U9(n.providerData,s),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Xv(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function z9(n){const e=eo(n);await Zp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function U9(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function ck(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function B9(n,e){const t=await ak(n,{},async()=>{const i=df({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await lk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:i};return n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(u.credentials="include"),ok.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function G9(n,e){return Du(n,"POST","/v2/accounts:revokeToken",Z1(n,e))}class Zc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Fe(e.idToken,"internal-error"),Fe(typeof e.idToken<"u","internal-error"),Fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$C(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Fe(e.length!==0,"internal-error");const t=$C(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await B9(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Zc;return i&&(Fe(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Fe(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Fe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zc,this.toJSON())}_performRefresh(){return Fs("not implemented")}}function ko(n,e){Fe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class _r{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new j9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Xv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Fd(this,this.stsTokenManager.getToken(this.auth,e));return Fe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return F9(this,e)}reload(){return z9(this)}_assign(e){this!==e&&(Fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _r({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Zp(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ki(this.auth.app))return Promise.reject(al(this.auth));const e=await this.getIdToken();return await Fd(this,O9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:p,emailVerified:y,isAnonymous:x,providerData:S,stsTokenManager:I}=t;Fe(p&&I,e,"internal-error");const T=Zc.fromJSON(this.name,I);Fe(typeof p=="string",e,"internal-error"),ko(i,e.name),ko(r,e.name),Fe(typeof y=="boolean",e,"internal-error"),Fe(typeof x=="boolean",e,"internal-error"),ko(s,e.name),ko(o,e.name),ko(l,e.name),ko(u,e.name),ko(h,e.name),ko(f,e.name);const R=new _r({uid:p,auth:e,email:r,emailVerified:y,displayName:i,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:T,createdAt:h,lastLoginAt:f});return S&&Array.isArray(S)&&(R.providerData=S.map(k=>({...k}))),u&&(R._redirectEventId=u),R}static async _fromIdTokenResponse(e,t,i=!1){const r=new Zc;r.updateFromServerResponse(t);const s=new _r({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Zp(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Fe(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?ck(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new Zc;l.updateFromIdToken(i);const u=new _r({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Xv(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const KC=new Map;function Vs(n){qs(n instanceof Function,"Expected a class definition");let e=KC.get(n);return e?(qs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,KC.set(n,e),e)}class uk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}uk.type="NONE";const HC=uk;function cp(n,e,t){return`firebase:${n}:${e}:${t}`}class Qc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=cp(this.userKey,r.apiKey,s),this.fullPersistenceKey=cp("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Yp(this.auth,{idToken:e}).catch(()=>{});return t?_r._fromGetAccountInfoResponse(this.auth,t,e):null}return _r._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Qc(Vs(HC),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Vs(HC);const o=cp(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let p;if(typeof f=="string"){const y=await Yp(e,{idToken:f}).catch(()=>{});if(!y)break;p=await _r._fromGetAccountInfoResponse(e,y,f)}else p=_r._fromJSON(e,f);h!==s&&(l=p),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Qc(s,e,i):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Qc(s,e,i))}}function XC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(hk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mk(e))return"Blackberry";if(yk(e))return"Webos";if(dk(e))return"Safari";if((e.includes("chrome/")||fk(e))&&!e.includes("edge/"))return"Chrome";if(pk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function hk(n=en()){return/firefox\//i.test(n)}function dk(n=en()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fk(n=en()){return/crios\//i.test(n)}function gk(n=en()){return/iemobile/i.test(n)}function pk(n=en()){return/android/i.test(n)}function mk(n=en()){return/blackberry/i.test(n)}function yk(n=en()){return/webos/i.test(n)}function J1(n=en()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function W9(n=en()){return J1(n)&&!!window.navigator?.standalone}function $9(){return lU()&&document.documentMode===10}function _k(n=en()){return J1(n)||pk(n)||yk(n)||mk(n)||/windows phone/i.test(n)||gk(n)}function vk(n,e=[]){let t;switch(n){case"Browser":t=XC(en());break;case"Worker":t=`${XC(en())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ml}/${i}`}class K9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function H9(n,e={}){return Du(n,"GET","/v2/passwordPolicy",Z1(n,e))}const X9=6;class q9{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??X9,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class Y9{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qC(this),this.idTokenSubscription=new qC(this),this.beforeStateQueue=new K9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=sk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Qc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Yp(this,{idToken:e}),i=await _r._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ki(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Zp(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=P9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ki(this.app))return Promise.reject(al(this));const t=e?eo(e):null;return t&&Fe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ki(this.app)?Promise.reject(al(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ki(this.app)?Promise.reject(al(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await H9(this),t=new q9(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new hf("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await G9(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vs(e)||this._popupRedirectResolver;Fe(t,this,"argument-error"),this.redirectPersistenceManager=await Qc.create(this,[Vs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Fe(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Ki(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&C9(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ym(n){return eo(n)}class qC{constructor(e){this.auth=e,this.observer=null,this.addObserver=gU(t=>this.observer=t)}get next(){return Fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ew={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Z9(n){ew=n}function Q9(n){return ew.loadJS(n)}function J9(){return ew.gapiScript}function eB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function tB(n,e){const t=qm(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(xl(s,e??{}))return r;os(r,"already-initialized")}return t.initialize({options:e})}function nB(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Vs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function iB(n,e,t){const i=Ym(n);Fe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=xk(e),{host:o,port:l}=rB(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Fe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Fe(xl(h,i.config.emulator)&&xl(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Dl(o)?(G1(`${s}//${o}${u}`),W1("Auth",!0)):sB()}function xk(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function rB(n){const e=xk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:YC(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:YC(o)}}}function YC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function sB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class wk{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fs("not implemented")}_getIdTokenResponse(e){return Fs("not implemented")}_linkToIdToken(e,t){return Fs("not implemented")}_getReauthenticationResolver(e){return Fs("not implemented")}}async function Jc(n,e){return M9(n,"POST","/v1/accounts:signInWithIdp",Z1(n,e))}const oB="http://localhost";class El extends wk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new El(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):os("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new El(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Jc(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Jc(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Jc(e,t)}buildRequest(){const e={requestUri:oB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=df(t)}return e}}class tw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class gf extends tw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class jo extends gf{constructor(){super("facebook.com")}static credential(e){return El._fromParams({providerId:jo.PROVIDER_ID,signInMethod:jo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jo.credentialFromTaggedObject(e)}static credentialFromError(e){return jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jo.credential(e.oauthAccessToken)}catch{return null}}}jo.FACEBOOK_SIGN_IN_METHOD="facebook.com";jo.PROVIDER_ID="facebook.com";class Ls extends gf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return El._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ls.credential(t,i)}catch{return null}}}Ls.GOOGLE_SIGN_IN_METHOD="google.com";Ls.PROVIDER_ID="google.com";class zo extends gf{constructor(){super("github.com")}static credential(e){return El._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zo.credential(e.oauthAccessToken)}catch{return null}}}zo.GITHUB_SIGN_IN_METHOD="github.com";zo.PROVIDER_ID="github.com";class Uo extends gf{constructor(){super("twitter.com")}static credential(e,t){return El._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Uo.credential(t,i)}catch{return null}}}Uo.TWITTER_SIGN_IN_METHOD="twitter.com";Uo.PROVIDER_ID="twitter.com";class gu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await _r._fromIdTokenResponse(e,i,r),o=ZC(i);return new gu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=ZC(i);return new gu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function ZC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Qp extends hs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Qp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Qp(e,t,i,r)}}function Ek(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Qp._fromErrorAndOperation(n,s,e,i):s})}async function aB(n,e,t=!1){const i=await Fd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return gu._forOperation(n,"link",i)}async function lB(n,e,t=!1){const{auth:i}=n;if(Ki(i.app))return Promise.reject(al(i));const r="reauthenticate";try{const s=await Fd(n,Ek(i,r,e,n),t);Fe(s.idToken,i,"internal-error");const o=Q1(s.idToken);Fe(o,i,"internal-error");const{sub:l}=o;return Fe(n.uid===l,i,"user-mismatch"),gu._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&os(i,"user-mismatch"),s}}async function cB(n,e,t=!1){if(Ki(n.app))return Promise.reject(al(n));const i="signIn",r=await Ek(n,i,e),s=await gu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function uB(n,e,t,i){return eo(n).onIdTokenChanged(e,t,i)}function hB(n,e,t){return eo(n).beforeAuthStateChanged(e,t)}function dB(n,e,t,i){return eo(n).onAuthStateChanged(e,t,i)}function fB(n){return eo(n).signOut()}const Jp="__sak";class Tk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Jp,"1"),this.storage.removeItem(Jp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const gB=1e3,pB=10;class Sk extends Tk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_k(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);$9()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,pB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},gB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Sk.type="LOCAL";const mB=Sk;class Ik extends Tk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ik.type="SESSION";const Ck=Ik;function yB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Zm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Zm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),u=await yB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Zm.receivers=[];function nw(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class _B{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=nw("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(p){const y=p;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(y.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function ss(){return window}function vB(n){ss().location.href=n}function Rk(){return typeof ss().WorkerGlobalScope<"u"&&typeof ss().importScripts=="function"}async function xB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wB(){return navigator?.serviceWorker?.controller||null}function EB(){return Rk()?self:null}const Ak="firebaseLocalStorageDb",TB=1,em="firebaseLocalStorage",bk="fbase_key";class pf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Qm(n,e){return n.transaction([em],e?"readwrite":"readonly").objectStore(em)}function SB(){const n=indexedDB.deleteDatabase(Ak);return new pf(n).toPromise()}function qv(){const n=indexedDB.open(Ak,TB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(em,{keyPath:bk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(em)?e(i):(i.close(),await SB(),e(await qv()))})})}async function QC(n,e,t){const i=Qm(n,!0).put({[bk]:e,value:t});return new pf(i).toPromise()}async function IB(n,e){const t=Qm(n,!1).get(e),i=await new pf(t).toPromise();return i===void 0?null:i.value}function JC(n,e){const t=Qm(n,!0).delete(e);return new pf(t).toPromise()}const CB=800,RB=3;class Pk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await qv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>RB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Rk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Zm._getInstance(EB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await xB(),!this.activeServiceWorker)return;this.sender=new _B(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await qv();return await QC(e,Jp,"1"),await JC(e,Jp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>QC(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>IB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>JC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=Qm(r,!1).getAll();return new pf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),CB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Pk.type="LOCAL";const AB=Pk;new ff(3e4,6e4);function kk(n,e){return e?Vs(e):(Fe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class iw extends wk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function bB(n){return cB(n.auth,new iw(n),n.bypassAuthState)}function PB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),lB(t,new iw(n),n.bypassAuthState)}async function kB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),aB(t,new iw(n),n.bypassAuthState)}class Nk{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return bB;case"linkViaPopup":case"linkViaRedirect":return kB;case"reauthViaPopup":case"reauthViaRedirect":return PB;default:os(this.auth,"internal-error")}}resolve(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const NB=new ff(2e3,1e4);async function DB(n,e,t){if(Ki(n.app))return Promise.reject(Tr(n,"operation-not-supported-in-this-environment"));const i=Ym(n);R9(n,e,tw);const r=kk(i,t);return new tl(i,"signInViaPopup",e,r).executeNotNull()}class tl extends Nk{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,tl.currentPopupAction&&tl.currentPopupAction.cancel(),tl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Fe(e,this.auth,"internal-error"),e}async onExecution(){qs(this.filter.length===1,"Popup operations only handle one event");const e=nw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,NB.get())};e()}}tl.currentPopupAction=null;const MB="pendingRedirect",up=new Map;class LB extends Nk{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=up.get(this.auth._key());if(!e){try{const i=await OB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}up.set(this.auth._key(),e)}return this.bypassAuthState||up.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function OB(n,e){const t=jB(e),i=VB(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function FB(n,e){up.set(n._key(),e)}function VB(n){return Vs(n._redirectPersistence)}function jB(n){return cp(MB,n.config.apiKey,n.name)}async function zB(n,e,t=!1){if(Ki(n.app))return Promise.reject(al(n));const i=Ym(n),r=kk(i,e),o=await new LB(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const UB=600*1e3;class BB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!GB(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Dk(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Tr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=UB&&this.cachedEventUids.clear(),this.cachedEventUids.has(eR(e))}saveEventToCache(e){this.cachedEventUids.add(eR(e)),this.lastProcessedEventTime=Date.now()}}function eR(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Dk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function GB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Dk(n);default:return!1}}async function WB(n,e={}){return Du(n,"GET","/v1/projects",e)}const $B=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,KB=/^https?/;async function HB(n){if(n.config.emulator)return;const{authorizedDomains:e}=await WB(n);for(const t of e)try{if(XB(t))return}catch{}os(n,"unauthorized-domain")}function XB(n){const e=Hv(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!KB.test(t))return!1;if($B.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const qB=new ff(3e4,6e4);function tR(){const n=ss().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function YB(n){return new Promise((e,t)=>{function i(){tR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tR(),t(Tr(n,"network-request-failed"))},timeout:qB.get()})}if(ss().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ss().gapi?.load)i();else{const r=eB("iframefcb");return ss()[r]=()=>{gapi.load?i():t(Tr(n,"network-request-failed"))},Q9(`${J9()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw hp=null,e})}let hp=null;function ZB(n){return hp=hp||YB(n),hp}const QB=new ff(5e3,15e3),JB="__/auth/iframe",e8="emulator/auth/iframe",t8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},n8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function i8(n){const e=n.config;Fe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Y1(e,e8):`https://${n.config.authDomain}/${JB}`,i={apiKey:e.apiKey,appName:n.name,v:Ml},r=n8.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${df(i).slice(1)}`}async function r8(n){const e=await ZB(n),t=ss().gapi;return Fe(t,n,"internal-error"),e.open({where:document.body,url:i8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:t8,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Tr(n,"network-request-failed"),l=ss().setTimeout(()=>{s(o)},QB.get());function u(){ss().clearTimeout(l),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const s8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},o8=500,a8=600,l8="_blank",c8="http://localhost";class nR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function u8(n,e,t,i=o8,r=a8){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u={...s8,width:i.toString(),height:r.toString(),top:s,left:o},h=en().toLowerCase();t&&(l=fk(h)?l8:t),hk(h)&&(e=e||c8,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[x,S])=>`${y}${x}=${S},`,"");if(W9(h)&&l!=="_self")return h8(e||"",l),new nR(null);const p=window.open(e||"",l,f);Fe(p,n,"popup-blocked");try{p.focus()}catch{}return new nR(p)}function h8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const d8="__/auth/handler",f8="emulator/auth/handler",g8=encodeURIComponent("fac");async function iR(n,e,t,i,r,s){Fe(n.config.authDomain,n,"auth-domain-config-required"),Fe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ml,eventId:r};if(e instanceof tw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",fU(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof gf){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),h=u?`#${g8}=${encodeURIComponent(u)}`:"";return`${p8(n)}?${df(l).slice(1)}${h}`}function p8({config:n}){return n.emulator?Y1(n,f8):`https://${n.authDomain}/${d8}`}const W0="webStorageSupport";class m8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ck,this._completeRedirectFn=zB,this._overrideRedirectResult=FB}async _openPopup(e,t,i,r){qs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await iR(e,t,i,Hv(),r);return u8(e,s,nw())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await iR(e,t,i,Hv(),r);return vB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(qs(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await r8(e),i=new BB(e);return t.register("authEvent",r=>(Fe(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(W0,{type:W0},r=>{const s=r?.[0]?.[W0];s!==void 0&&t(!!s),os(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=HB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return _k()||dk()||J1()}}const y8=m8;var rR="@firebase/auth",sR="1.12.0";class _8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function v8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function x8(n){wl(new na("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Fe(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vk(n)},h=new Y9(i,r,s,u);return nB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),wl(new na("auth-internal",e=>{const t=Ym(e.getProvider("auth").getImmediate());return(i=>new _8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),rs(rR,sR,v8(n)),rs(rR,sR,"esm2020")}const w8=300,E8=HP("authIdTokenMaxAge")||w8;let oR=null;const T8=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>E8)return;const r=t?.token;oR!==r&&(oR=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function S8(n=H1()){const e=qm(n,"auth");if(e.isInitialized())return e.getImmediate();const t=tB(n,{popupRedirectResolver:y8,persistence:[AB,mB,Ck]}),i=HP("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=T8(s.toString());hB(t,o,()=>o(t.currentUser)),uB(t,l=>o(l))}}const r=WP("auth");return r&&iB(t,`http://${r}`),t}function I8(){return document.getElementsByTagName("head")?.[0]??document}Z9({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Tr("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",I8().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});x8("Browser");var C8="firebase",R8="12.7.0";rs(C8,R8,"app");var aR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var rw;(function(){var n;function e(P,A){function D(){}D.prototype=A.prototype,P.F=A.prototype,P.prototype=new D,P.prototype.constructor=P,P.D=function(V,j,B){for(var L=Array(arguments.length-2),le=2;le<arguments.length;le++)L[le-2]=arguments[le];return A.prototype[j].apply(V,L)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(P,A,D){D||(D=0);const V=Array(16);if(typeof A=="string")for(var j=0;j<16;++j)V[j]=A.charCodeAt(D++)|A.charCodeAt(D++)<<8|A.charCodeAt(D++)<<16|A.charCodeAt(D++)<<24;else for(j=0;j<16;++j)V[j]=A[D++]|A[D++]<<8|A[D++]<<16|A[D++]<<24;A=P.g[0],D=P.g[1],j=P.g[2];let B=P.g[3],L;L=A+(B^D&(j^B))+V[0]+3614090360&4294967295,A=D+(L<<7&4294967295|L>>>25),L=B+(j^A&(D^j))+V[1]+3905402710&4294967295,B=A+(L<<12&4294967295|L>>>20),L=j+(D^B&(A^D))+V[2]+606105819&4294967295,j=B+(L<<17&4294967295|L>>>15),L=D+(A^j&(B^A))+V[3]+3250441966&4294967295,D=j+(L<<22&4294967295|L>>>10),L=A+(B^D&(j^B))+V[4]+4118548399&4294967295,A=D+(L<<7&4294967295|L>>>25),L=B+(j^A&(D^j))+V[5]+1200080426&4294967295,B=A+(L<<12&4294967295|L>>>20),L=j+(D^B&(A^D))+V[6]+2821735955&4294967295,j=B+(L<<17&4294967295|L>>>15),L=D+(A^j&(B^A))+V[7]+4249261313&4294967295,D=j+(L<<22&4294967295|L>>>10),L=A+(B^D&(j^B))+V[8]+1770035416&4294967295,A=D+(L<<7&4294967295|L>>>25),L=B+(j^A&(D^j))+V[9]+2336552879&4294967295,B=A+(L<<12&4294967295|L>>>20),L=j+(D^B&(A^D))+V[10]+4294925233&4294967295,j=B+(L<<17&4294967295|L>>>15),L=D+(A^j&(B^A))+V[11]+2304563134&4294967295,D=j+(L<<22&4294967295|L>>>10),L=A+(B^D&(j^B))+V[12]+1804603682&4294967295,A=D+(L<<7&4294967295|L>>>25),L=B+(j^A&(D^j))+V[13]+4254626195&4294967295,B=A+(L<<12&4294967295|L>>>20),L=j+(D^B&(A^D))+V[14]+2792965006&4294967295,j=B+(L<<17&4294967295|L>>>15),L=D+(A^j&(B^A))+V[15]+1236535329&4294967295,D=j+(L<<22&4294967295|L>>>10),L=A+(j^B&(D^j))+V[1]+4129170786&4294967295,A=D+(L<<5&4294967295|L>>>27),L=B+(D^j&(A^D))+V[6]+3225465664&4294967295,B=A+(L<<9&4294967295|L>>>23),L=j+(A^D&(B^A))+V[11]+643717713&4294967295,j=B+(L<<14&4294967295|L>>>18),L=D+(B^A&(j^B))+V[0]+3921069994&4294967295,D=j+(L<<20&4294967295|L>>>12),L=A+(j^B&(D^j))+V[5]+3593408605&4294967295,A=D+(L<<5&4294967295|L>>>27),L=B+(D^j&(A^D))+V[10]+38016083&4294967295,B=A+(L<<9&4294967295|L>>>23),L=j+(A^D&(B^A))+V[15]+3634488961&4294967295,j=B+(L<<14&4294967295|L>>>18),L=D+(B^A&(j^B))+V[4]+3889429448&4294967295,D=j+(L<<20&4294967295|L>>>12),L=A+(j^B&(D^j))+V[9]+568446438&4294967295,A=D+(L<<5&4294967295|L>>>27),L=B+(D^j&(A^D))+V[14]+3275163606&4294967295,B=A+(L<<9&4294967295|L>>>23),L=j+(A^D&(B^A))+V[3]+4107603335&4294967295,j=B+(L<<14&4294967295|L>>>18),L=D+(B^A&(j^B))+V[8]+1163531501&4294967295,D=j+(L<<20&4294967295|L>>>12),L=A+(j^B&(D^j))+V[13]+2850285829&4294967295,A=D+(L<<5&4294967295|L>>>27),L=B+(D^j&(A^D))+V[2]+4243563512&4294967295,B=A+(L<<9&4294967295|L>>>23),L=j+(A^D&(B^A))+V[7]+1735328473&4294967295,j=B+(L<<14&4294967295|L>>>18),L=D+(B^A&(j^B))+V[12]+2368359562&4294967295,D=j+(L<<20&4294967295|L>>>12),L=A+(D^j^B)+V[5]+4294588738&4294967295,A=D+(L<<4&4294967295|L>>>28),L=B+(A^D^j)+V[8]+2272392833&4294967295,B=A+(L<<11&4294967295|L>>>21),L=j+(B^A^D)+V[11]+1839030562&4294967295,j=B+(L<<16&4294967295|L>>>16),L=D+(j^B^A)+V[14]+4259657740&4294967295,D=j+(L<<23&4294967295|L>>>9),L=A+(D^j^B)+V[1]+2763975236&4294967295,A=D+(L<<4&4294967295|L>>>28),L=B+(A^D^j)+V[4]+1272893353&4294967295,B=A+(L<<11&4294967295|L>>>21),L=j+(B^A^D)+V[7]+4139469664&4294967295,j=B+(L<<16&4294967295|L>>>16),L=D+(j^B^A)+V[10]+3200236656&4294967295,D=j+(L<<23&4294967295|L>>>9),L=A+(D^j^B)+V[13]+681279174&4294967295,A=D+(L<<4&4294967295|L>>>28),L=B+(A^D^j)+V[0]+3936430074&4294967295,B=A+(L<<11&4294967295|L>>>21),L=j+(B^A^D)+V[3]+3572445317&4294967295,j=B+(L<<16&4294967295|L>>>16),L=D+(j^B^A)+V[6]+76029189&4294967295,D=j+(L<<23&4294967295|L>>>9),L=A+(D^j^B)+V[9]+3654602809&4294967295,A=D+(L<<4&4294967295|L>>>28),L=B+(A^D^j)+V[12]+3873151461&4294967295,B=A+(L<<11&4294967295|L>>>21),L=j+(B^A^D)+V[15]+530742520&4294967295,j=B+(L<<16&4294967295|L>>>16),L=D+(j^B^A)+V[2]+3299628645&4294967295,D=j+(L<<23&4294967295|L>>>9),L=A+(j^(D|~B))+V[0]+4096336452&4294967295,A=D+(L<<6&4294967295|L>>>26),L=B+(D^(A|~j))+V[7]+1126891415&4294967295,B=A+(L<<10&4294967295|L>>>22),L=j+(A^(B|~D))+V[14]+2878612391&4294967295,j=B+(L<<15&4294967295|L>>>17),L=D+(B^(j|~A))+V[5]+4237533241&4294967295,D=j+(L<<21&4294967295|L>>>11),L=A+(j^(D|~B))+V[12]+1700485571&4294967295,A=D+(L<<6&4294967295|L>>>26),L=B+(D^(A|~j))+V[3]+2399980690&4294967295,B=A+(L<<10&4294967295|L>>>22),L=j+(A^(B|~D))+V[10]+4293915773&4294967295,j=B+(L<<15&4294967295|L>>>17),L=D+(B^(j|~A))+V[1]+2240044497&4294967295,D=j+(L<<21&4294967295|L>>>11),L=A+(j^(D|~B))+V[8]+1873313359&4294967295,A=D+(L<<6&4294967295|L>>>26),L=B+(D^(A|~j))+V[15]+4264355552&4294967295,B=A+(L<<10&4294967295|L>>>22),L=j+(A^(B|~D))+V[6]+2734768916&4294967295,j=B+(L<<15&4294967295|L>>>17),L=D+(B^(j|~A))+V[13]+1309151649&4294967295,D=j+(L<<21&4294967295|L>>>11),L=A+(j^(D|~B))+V[4]+4149444226&4294967295,A=D+(L<<6&4294967295|L>>>26),L=B+(D^(A|~j))+V[11]+3174756917&4294967295,B=A+(L<<10&4294967295|L>>>22),L=j+(A^(B|~D))+V[2]+718787259&4294967295,j=B+(L<<15&4294967295|L>>>17),L=D+(B^(j|~A))+V[9]+3951481745&4294967295,P.g[0]=P.g[0]+A&4294967295,P.g[1]=P.g[1]+(j+(L<<21&4294967295|L>>>11))&4294967295,P.g[2]=P.g[2]+j&4294967295,P.g[3]=P.g[3]+B&4294967295}i.prototype.v=function(P,A){A===void 0&&(A=P.length);const D=A-this.blockSize,V=this.C;let j=this.h,B=0;for(;B<A;){if(j==0)for(;B<=D;)r(this,P,B),B+=this.blockSize;if(typeof P=="string"){for(;B<A;)if(V[j++]=P.charCodeAt(B++),j==this.blockSize){r(this,V),j=0;break}}else for(;B<A;)if(V[j++]=P[B++],j==this.blockSize){r(this,V),j=0;break}}this.h=j,this.o+=A},i.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var A=1;A<P.length-8;++A)P[A]=0;A=this.o*8;for(var D=P.length-8;D<P.length;++D)P[D]=A&255,A/=256;for(this.v(P),P=Array(16),A=0,D=0;D<4;++D)for(let V=0;V<32;V+=8)P[A++]=this.g[D]>>>V&255;return P};function s(P,A){var D=l;return Object.prototype.hasOwnProperty.call(D,P)?D[P]:D[P]=A(P)}function o(P,A){this.h=A;const D=[];let V=!0;for(let j=P.length-1;j>=0;j--){const B=P[j]|0;V&&B==A||(D[j]=B,V=!1)}this.g=D}var l={};function u(P){return-128<=P&&P<128?s(P,function(A){return new o([A|0],A<0?-1:0)}):new o([P|0],P<0?-1:0)}function h(P){if(isNaN(P)||!isFinite(P))return p;if(P<0)return T(h(-P));const A=[];let D=1;for(let V=0;P>=D;V++)A[V]=P/D|0,D*=4294967296;return new o(A,0)}function f(P,A){if(P.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(P.charAt(0)=="-")return T(f(P.substring(1),A));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=h(Math.pow(A,8));let V=p;for(let B=0;B<P.length;B+=8){var j=Math.min(8,P.length-B);const L=parseInt(P.substring(B,B+j),A);j<8?(j=h(Math.pow(A,j)),V=V.j(j).add(h(L))):(V=V.j(D),V=V.add(h(L)))}return V}var p=u(0),y=u(1),x=u(16777216);n=o.prototype,n.m=function(){if(I(this))return-T(this).m();let P=0,A=1;for(let D=0;D<this.g.length;D++){const V=this.i(D);P+=(V>=0?V:4294967296+V)*A,A*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(S(this))return"0";if(I(this))return"-"+T(this).toString(P);const A=h(Math.pow(P,6));var D=this;let V="";for(;;){const j=M(D,A).g;D=R(D,j.j(A));let B=((D.g.length>0?D.g[0]:D.h)>>>0).toString(P);if(D=j,S(D))return B+V;for(;B.length<6;)B="0"+B;V=B+V}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function S(P){if(P.h!=0)return!1;for(let A=0;A<P.g.length;A++)if(P.g[A]!=0)return!1;return!0}function I(P){return P.h==-1}n.l=function(P){return P=R(this,P),I(P)?-1:S(P)?0:1};function T(P){const A=P.g.length,D=[];for(let V=0;V<A;V++)D[V]=~P.g[V];return new o(D,~P.h).add(y)}n.abs=function(){return I(this)?T(this):this},n.add=function(P){const A=Math.max(this.g.length,P.g.length),D=[];let V=0;for(let j=0;j<=A;j++){let B=V+(this.i(j)&65535)+(P.i(j)&65535),L=(B>>>16)+(this.i(j)>>>16)+(P.i(j)>>>16);V=L>>>16,B&=65535,L&=65535,D[j]=L<<16|B}return new o(D,D[D.length-1]&-2147483648?-1:0)};function R(P,A){return P.add(T(A))}n.j=function(P){if(S(this)||S(P))return p;if(I(this))return I(P)?T(this).j(T(P)):T(T(this).j(P));if(I(P))return T(this.j(T(P)));if(this.l(x)<0&&P.l(x)<0)return h(this.m()*P.m());const A=this.g.length+P.g.length,D=[];for(var V=0;V<2*A;V++)D[V]=0;for(V=0;V<this.g.length;V++)for(let j=0;j<P.g.length;j++){const B=this.i(V)>>>16,L=this.i(V)&65535,le=P.i(j)>>>16,pe=P.i(j)&65535;D[2*V+2*j]+=L*pe,k(D,2*V+2*j),D[2*V+2*j+1]+=B*pe,k(D,2*V+2*j+1),D[2*V+2*j+1]+=L*le,k(D,2*V+2*j+1),D[2*V+2*j+2]+=B*le,k(D,2*V+2*j+2)}for(P=0;P<A;P++)D[P]=D[2*P+1]<<16|D[2*P];for(P=A;P<2*A;P++)D[P]=0;return new o(D,0)};function k(P,A){for(;(P[A]&65535)!=P[A];)P[A+1]+=P[A]>>>16,P[A]&=65535,A++}function N(P,A){this.g=P,this.h=A}function M(P,A){if(S(A))throw Error("division by zero");if(S(P))return new N(p,p);if(I(P))return A=M(T(P),A),new N(T(A.g),T(A.h));if(I(A))return A=M(P,T(A)),new N(T(A.g),A.h);if(P.g.length>30){if(I(P)||I(A))throw Error("slowDivide_ only works with positive integers.");for(var D=y,V=A;V.l(P)<=0;)D=F(D),V=F(V);var j=U(D,1),B=U(V,1);for(V=U(V,2),D=U(D,2);!S(V);){var L=B.add(V);L.l(P)<=0&&(j=j.add(D),B=L),V=U(V,1),D=U(D,1)}return A=R(P,j.j(A)),new N(j,A)}for(j=p;P.l(A)>=0;){for(D=Math.max(1,Math.floor(P.m()/A.m())),V=Math.ceil(Math.log(D)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),B=h(D),L=B.j(A);I(L)||L.l(P)>0;)D-=V,B=h(D),L=B.j(A);S(B)&&(B=y),j=j.add(B),P=R(P,L)}return new N(j,P)}n.B=function(P){return M(this,P).h},n.and=function(P){const A=Math.max(this.g.length,P.g.length),D=[];for(let V=0;V<A;V++)D[V]=this.i(V)&P.i(V);return new o(D,this.h&P.h)},n.or=function(P){const A=Math.max(this.g.length,P.g.length),D=[];for(let V=0;V<A;V++)D[V]=this.i(V)|P.i(V);return new o(D,this.h|P.h)},n.xor=function(P){const A=Math.max(this.g.length,P.g.length),D=[];for(let V=0;V<A;V++)D[V]=this.i(V)^P.i(V);return new o(D,this.h^P.h)};function F(P){const A=P.g.length+1,D=[];for(let V=0;V<A;V++)D[V]=P.i(V)<<1|P.i(V-1)>>>31;return new o(D,P.h)}function U(P,A){const D=A>>5;A%=32;const V=P.g.length-D,j=[];for(let B=0;B<V;B++)j[B]=A>0?P.i(B+D)>>>A|P.i(B+D+1)<<32-A:P.i(B+D);return new o(j,P.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,rw=o}).apply(typeof aR<"u"?aR:typeof self<"u"?self:typeof window<"u"?window:{});var Hg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Mk,Hh,Lk,dp,Yv,Ok,Fk,Vk;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hg=="object"&&Hg];for(var E=0;E<g.length;++E){var C=g[E];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=t(this);function r(g,E){if(E)e:{var C=i;g=g.split(".");for(var O=0;O<g.length-1;O++){var X=g[O];if(!(X in C))break e;C=C[X]}g=g[g.length-1],O=C[g],E=E(O),E!=O&&E!=null&&e(C,g,{configurable:!0,writable:!0,value:E})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(E){var C=[],O;for(O in E)Object.prototype.hasOwnProperty.call(E,O)&&C.push([O,E[O]]);return C}});var s=s||{},o=this||self;function l(g){var E=typeof g;return E=="object"&&g!=null||E=="function"}function u(g,E,C){return g.call.apply(g.bind,arguments)}function h(g,E,C){return h=u,h.apply(null,arguments)}function f(g,E){var C=Array.prototype.slice.call(arguments,1);return function(){var O=C.slice();return O.push.apply(O,arguments),g.apply(this,O)}}function p(g,E){function C(){}C.prototype=E.prototype,g.Z=E.prototype,g.prototype=new C,g.prototype.constructor=g,g.Ob=function(O,X,ee){for(var de=Array(arguments.length-2),je=2;je<arguments.length;je++)de[je-2]=arguments[je];return E.prototype[X].apply(O,de)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function x(g){const E=g.length;if(E>0){const C=Array(E);for(let O=0;O<E;O++)C[O]=g[O];return C}return[]}function S(g,E){for(let O=1;O<arguments.length;O++){const X=arguments[O];var C=typeof X;if(C=C!="object"?C:X?Array.isArray(X)?"array":C:"null",C=="array"||C=="object"&&typeof X.length=="number"){C=g.length||0;const ee=X.length||0;g.length=C+ee;for(let de=0;de<ee;de++)g[C+de]=X[de]}else g.push(X)}}class I{constructor(E,C){this.i=E,this.j=C,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function T(g){o.setTimeout(()=>{throw g},0)}function R(){var g=P;let E=null;return g.g&&(E=g.g,g.g=g.g.next,g.g||(g.h=null),E.next=null),E}class k{constructor(){this.h=this.g=null}add(E,C){const O=N.get();O.set(E,C),this.h?this.h.next=O:this.g=O,this.h=O}}var N=new I(()=>new M,g=>g.reset());class M{constructor(){this.next=this.g=this.h=null}set(E,C){this.h=E,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let F,U=!1,P=new k,A=()=>{const g=Promise.resolve(void 0);F=()=>{g.then(D)}};function D(){for(var g;g=R();){try{g.h.call(g.g)}catch(C){T(C)}var E=N;E.j(g),E.h<100&&(E.h++,g.next=E.g,E.g=g)}U=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(g,E){this.type=g,this.g=this.target=E,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,E=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const C=()=>{};o.addEventListener("test",C,E),o.removeEventListener("test",C,E)}catch{}return g})();function L(g){return/^[\s\xa0]*$/.test(g)}function le(g,E){j.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,E)}p(le,j),le.prototype.init=function(g,E){const C=this.type=g.type,O=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=E,E=g.relatedTarget,E||(C=="mouseover"?E=g.fromElement:C=="mouseout"&&(E=g.toElement)),this.relatedTarget=E,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&le.Z.h.call(this)},le.prototype.h=function(){le.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var pe="closure_listenable_"+(Math.random()*1e6|0),ge=0;function ue(g,E,C,O,X){this.listener=g,this.proxy=null,this.src=E,this.type=C,this.capture=!!O,this.ha=X,this.key=++ge,this.da=this.fa=!1}function Q(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function se(g,E,C){for(const O in g)E.call(C,g[O],O,g)}function ne(g,E){for(const C in g)E.call(void 0,g[C],C,g)}function W(g){const E={};for(const C in g)E[C]=g[C];return E}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(g,E){let C,O;for(let X=1;X<arguments.length;X++){O=arguments[X];for(C in O)g[C]=O[C];for(let ee=0;ee<$.length;ee++)C=$[ee],Object.prototype.hasOwnProperty.call(O,C)&&(g[C]=O[C])}}function me(g){this.src=g,this.g={},this.h=0}me.prototype.add=function(g,E,C,O,X){const ee=g.toString();g=this.g[ee],g||(g=this.g[ee]=[],this.h++);const de=ke(g,E,O,X);return de>-1?(E=g[de],C||(E.fa=!1)):(E=new ue(E,this.src,ee,!!O,X),E.fa=C,g.push(E)),E};function xe(g,E){const C=E.type;if(C in g.g){var O=g.g[C],X=Array.prototype.indexOf.call(O,E,void 0),ee;(ee=X>=0)&&Array.prototype.splice.call(O,X,1),ee&&(Q(E),g.g[C].length==0&&(delete g.g[C],g.h--))}}function ke(g,E,C,O){for(let X=0;X<g.length;++X){const ee=g[X];if(!ee.da&&ee.listener==E&&ee.capture==!!C&&ee.ha==O)return X}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),Ve={};function We(g,E,C,O,X){if(Array.isArray(E)){for(let ee=0;ee<E.length;ee++)We(g,E[ee],C,O,X);return null}return C=bi(C),g&&g[pe]?g.J(E,C,l(O)?!!O.capture:!1,X):lt(g,E,C,!1,O,X)}function lt(g,E,C,O,X,ee){if(!E)throw Error("Invalid event type");const de=l(X)?!!X.capture:!!X;let je=dn(g);if(je||(g[Me]=je=new me(g)),C=je.add(E,C,O,de,ee),C.proxy)return C;if(O=er(),C.proxy=O,O.src=g,O.listener=C,g.addEventListener)B||(X=de),X===void 0&&(X=!1),g.addEventListener(E.toString(),O,X);else if(g.attachEvent)g.attachEvent($n(E.toString()),O);else if(g.addListener&&g.removeListener)g.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return C}function er(){function g(C){return E.call(g.src,g.listener,C)}const E=hn;return g}function fs(g,E,C,O,X){if(Array.isArray(E))for(var ee=0;ee<E.length;ee++)fs(g,E[ee],C,O,X);else O=l(O)?!!O.capture:!!O,C=bi(C),g&&g[pe]?(g=g.i,ee=String(E).toString(),ee in g.g&&(E=g.g[ee],C=ke(E,C,O,X),C>-1&&(Q(E[C]),Array.prototype.splice.call(E,C,1),E.length==0&&(delete g.g[ee],g.h--)))):g&&(g=dn(g))&&(E=g.g[E.toString()],g=-1,E&&(g=ke(E,C,O,X)),(C=g>-1?E[g]:null)&&Wn(C))}function Wn(g){if(typeof g!="number"&&g&&!g.da){var E=g.src;if(E&&E[pe])xe(E.i,g);else{var C=g.type,O=g.proxy;E.removeEventListener?E.removeEventListener(C,O,g.capture):E.detachEvent?E.detachEvent($n(C),O):E.addListener&&E.removeListener&&E.removeListener(O),(C=dn(E))?(xe(C,g),C.h==0&&(C.src=null,E[Me]=null)):Q(g)}}}function $n(g){return g in Ve?Ve[g]:Ve[g]="on"+g}function hn(g,E){if(g.da)g=!0;else{E=new le(E,this);const C=g.listener,O=g.ha||g.src;g.fa&&Wn(g),g=C.call(O,E)}return g}function dn(g){return g=g[Me],g instanceof me?g:null}var Kn="__closure_events_fn_"+(Math.random()*1e9>>>0);function bi(g){return typeof g=="function"?g:(g[Kn]||(g[Kn]=function(E){return g.handleEvent(E)}),g[Kn])}function yt(){V.call(this),this.i=new me(this),this.M=this,this.G=null}p(yt,V),yt.prototype[pe]=!0,yt.prototype.removeEventListener=function(g,E,C,O){fs(this,g,E,C,O)};function ct(g,E){var C,O=g.G;if(O)for(C=[];O;O=O.G)C.push(O);if(g=g.M,O=E.type||E,typeof E=="string")E=new j(E,g);else if(E instanceof j)E.target=E.target||g;else{var X=E;E=new j(O,g),ie(E,X)}X=!0;let ee,de;if(C)for(de=C.length-1;de>=0;de--)ee=E.g=C[de],X=nn(ee,O,!0,E)&&X;if(ee=E.g=g,X=nn(ee,O,!0,E)&&X,X=nn(ee,O,!1,E)&&X,C)for(de=0;de<C.length;de++)ee=E.g=C[de],X=nn(ee,O,!1,E)&&X}yt.prototype.N=function(){if(yt.Z.N.call(this),this.i){var g=this.i;for(const E in g.g){const C=g.g[E];for(let O=0;O<C.length;O++)Q(C[O]);delete g.g[E],g.h--}}this.G=null},yt.prototype.J=function(g,E,C,O){return this.i.add(String(g),E,!1,C,O)},yt.prototype.K=function(g,E,C,O){return this.i.add(String(g),E,!0,C,O)};function nn(g,E,C,O){if(E=g.i.g[String(E)],!E)return!0;E=E.concat();let X=!0;for(let ee=0;ee<E.length;++ee){const de=E[ee];if(de&&!de.da&&de.capture==C){const je=de.listener,Vt=de.ha||de.src;de.fa&&xe(g.i,de),X=je.call(Vt,O)!==!1&&X}}return X&&!O.defaultPrevented}function Pi(g,E){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:o.setTimeout(g,E||0)}function St(g){g.g=Pi(()=>{g.g=null,g.i&&(g.i=!1,St(g))},g.l);const E=g.h;g.h=null,g.m.apply(null,E)}class to extends V{constructor(E,C){super(),this.m=E,this.l=C,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:St(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ki(g){V.call(this),this.h=g,this.g={}}p(ki,V);var Rr=[];function tr(g){se(g.g,function(E,C){this.g.hasOwnProperty(C)&&Wn(E)},g),g.g={}}ki.prototype.N=function(){ki.Z.N.call(this),tr(this)},ki.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ar=o.JSON.stringify,ca=o.JSON.parse,br=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function Ni(){}function Ol(){}var Pr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gs(){j.call(this,"d")}p(gs,j);function no(){j.call(this,"c")}p(no,j);var On={},ps=null;function kr(){return ps=ps||new yt}On.Ia="serverreachability";function Nr(g){j.call(this,On.Ia,g)}p(Nr,j);function Fn(g){const E=kr();ct(E,new Nr(E))}On.STAT_EVENT="statevent";function Vn(g,E){j.call(this,On.STAT_EVENT,g),this.stat=E}p(Vn,j);function ft(g){const E=kr();ct(E,new Vn(E,g))}On.Ja="timingevent";function io(g,E){j.call(this,On.Ja,g),this.size=E}p(io,j);function nr(g,E){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},E)}function Ot(){this.g=!0}Ot.prototype.ua=function(){this.g=!1};function Di(g,E,C,O,X,ee){g.info(function(){if(g.g)if(ee){var de="",je=ee.split("&");for(let ut=0;ut<je.length;ut++){var Vt=je[ut].split("=");if(Vt.length>1){const Wt=Vt[0];Vt=Vt[1];const pi=Wt.split("_");de=pi.length>=2&&pi[1]=="type"?de+(Wt+"="+Vt+"&"):de+(Wt+"=redacted&")}}}else de=null;else de=ee;return"XMLHTTP REQ ("+O+") [attempt "+X+"]: "+E+`
`+C+`
`+de})}function fn(g,E,C,O,X,ee,de){g.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+X+"]: "+E+`
`+C+`
`+ee+" "+de})}function Ft(g,E,C,O){g.info(function(){return"XMLHTTP TEXT ("+E+"): "+pn(g,C)+(O?" "+O:"")})}function gn(g,E){g.info(function(){return"TIMEOUT: "+E})}Ot.prototype.info=function(){};function pn(g,E){if(!g.g)return E;if(!E)return null;try{const ee=JSON.parse(E);if(ee){for(g=0;g<ee.length;g++)if(Array.isArray(ee[g])){var C=ee[g];if(!(C.length<2)){var O=C[1];if(Array.isArray(O)&&!(O.length<1)){var X=O[0];if(X!="noop"&&X!="stop"&&X!="close")for(let de=1;de<O.length;de++)O[de]=""}}}}return Ar(ee)}catch{return E}}var rn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Gt;function qt(){}p(qt,Ni),qt.prototype.g=function(){return new XMLHttpRequest},Gt=new qt;function Mi(g){return encodeURIComponent(String(g))}function Fl(g){var E=1;g=g.split(":");const C=[];for(;E>0&&g.length;)C.push(g.shift()),E--;return g.length&&C.push(g.join(":")),C}function Li(g,E,C,O){this.j=g,this.i=E,this.l=C,this.S=O||1,this.V=new ki(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new xf}function xf(){this.i=null,this.g="",this.h=!1}var wf={},Ou={};function ir(g,E,C){g.M=1,g.A=ys(Oi(E)),g.u=C,g.R=!0,Fu(g,null)}function Fu(g,E){g.F=Date.now(),ua(g),g.B=Oi(g.A);var C=g.B,O=g.S;Array.isArray(O)||(O=[String(O)]),Hu(C.i,"t",O),g.C=0,C=g.j.L,g.h=new xf,g.g=kf(g.j,C?E:null,!g.u),g.P>0&&(g.O=new to(h(g.Y,g,g.g),g.P)),E=g.V,C=g.g,O=g.ba;var X="readystatechange";Array.isArray(X)||(X&&(Rr[0]=X.toString()),X=Rr);for(let ee=0;ee<X.length;ee++){const de=We(C,X[ee],O||E.handleEvent,!1,E.h||E);if(!de)break;E.g[de.key]=de}E=g.J?W(g.J):{},g.u?(g.v||(g.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,E)):(g.v="GET",g.g.ea(g.B,g.v,null,E)),Fn(),Di(g.i,g.v,g.B,g.l,g.S,g.u)}Li.prototype.ba=function(g){g=g.target;const E=this.O;E&&jr(g)==3?E.j():this.Y(g)},Li.prototype.Y=function(g){try{if(g==this.g)e:{const je=jr(this.g),Vt=this.g.ya(),ut=this.g.ca();if(!(je<3)&&(je!=3||this.g&&(this.h.h||this.g.la()||bf(this.g)))){this.K||je!=4||Vt==7||(Vt==8||ut<=0?Fn(3):Fn(2)),Vl(this);var E=this.g.ca();this.X=E;var C=Ef(this);if(this.o=E==200,fn(this.i,this.v,this.B,this.l,this.S,je,E),this.o){if(this.U&&!this.L){t:{if(this.g){var O,X=this.g;if((O=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(O)){var ee=O;break t}}ee=null}if(g=ee)Ft(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,vt(this,g);else{this.o=!1,this.m=3,ft(12),ms(this),ha(this);break e}}if(this.R){g=!0;let Wt;for(;!this.K&&this.C<C.length;)if(Wt=Sf(this,C),Wt==Ou){je==4&&(this.m=4,ft(14),g=!1),Ft(this.i,this.l,null,"[Incomplete Response]");break}else if(Wt==wf){this.m=4,ft(15),Ft(this.i,this.l,C,"[Invalid Chunk]"),g=!1;break}else Ft(this.i,this.l,Wt,null),vt(this,Wt);if(Tf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),je!=4||C.length!=0||this.h.h||(this.m=1,ft(16),g=!1),this.o=this.o&&g,!g)Ft(this.i,this.l,C,"[Invalid Chunked Response]"),ms(this),ha(this);else if(C.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),xa(de),de.P=!0,ft(11))}}else Ft(this.i,this.l,C,null),vt(this,C);je==4&&ms(this),this.o&&!this.K&&(je==4?Xl(this.j,this):(this.o=!1,ua(this)))}else qu(this.g),E==400&&C.indexOf("Unknown SID")>0?(this.m=3,ft(12)):(this.m=0,ft(13)),ms(this),ha(this)}}}catch{}};function Ef(g){if(!Tf(g))return g.g.la();const E=bf(g.g);if(E==="")return"";let C="";const O=E.length,X=jr(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ms(g),ha(g),"";g.h.i=new o.TextDecoder}for(let ee=0;ee<O;ee++)g.h.h=!0,C+=g.h.i.decode(E[ee],{stream:!(X&&ee==O-1)});return E.length=0,g.h.g+=C,g.C=0,g.h.g}function Tf(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Sf(g,E){var C=g.C,O=E.indexOf(`
`,C);return O==-1?Ou:(C=Number(E.substring(C,O)),isNaN(C)?wf:(O+=1,O+C>E.length?Ou:(E=E.slice(O,O+C),g.C=O+C,E)))}Li.prototype.cancel=function(){this.K=!0,ms(this)};function ua(g){g.T=Date.now()+g.H,Vu(g,g.H)}function Vu(g,E){if(g.D!=null)throw Error("WatchDog timer not null");g.D=nr(h(g.aa,g),E)}function Vl(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Li.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(gn(this.i,this.B),this.M!=2&&(Fn(),ft(17)),ms(this),this.m=2,ha(this)):Vu(this,this.T-g)};function ha(g){g.j.I==0||g.K||Xl(g.j,g)}function ms(g){Vl(g);var E=g.O;E&&typeof E.dispose=="function"&&E.dispose(),g.O=null,tr(g.V),g.g&&(E=g.g,g.g=null,E.abort(),E.dispose())}function vt(g,E){try{var C=g.j;if(C.I!=0&&(C.g==g||zu(C.h,g))){if(!g.L&&zu(C.h,g)&&C.I==3){try{var O=C.Ba.g.parse(E)}catch{O=null}if(Array.isArray(O)&&O.length==3){var X=O;if(X[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<g.F)Hl(C),fi(C);else break e;Br(C),ft(18)}}else C.xa=X[1],0<C.xa-C.K&&X[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=nr(h(C.Va,C),6e3));da(C.h)<=1&&C.ta&&(C.ta=void 0)}else gi(C,11)}else if((g.L||C.g==g)&&Hl(C),!L(E))for(X=C.Ba.g.parse(E),E=0;E<X.length;E++){let ut=X[E];const Wt=ut[0];if(!(Wt<=C.K))if(C.K=Wt,ut=ut[1],C.I==2)if(ut[0]=="c"){C.M=ut[1],C.ba=ut[2];const pi=ut[3];pi!=null&&(C.ka=pi,C.j.info("VER="+C.ka));const Es=ut[4];Es!=null&&(C.za=Es,C.j.info("SVER="+C.za));const Gr=ut[5];Gr!=null&&typeof Gr=="number"&&Gr>0&&(O=1.5*Gr,C.O=O,C.j.info("backChannelRequestTimeoutMs_="+O)),O=C;const Wr=g.g;if(Wr){const Zl=Wr.g?Wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zl){var ee=O.h;ee.g||Zl.indexOf("spdy")==-1&&Zl.indexOf("quic")==-1&&Zl.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(zl(ee,ee.h),ee.h=null))}if(O.G){const Qu=Wr.g?Wr.g.getResponseHeader("X-HTTP-Session-Id"):null;Qu&&(O.wa=Qu,st(O.J,O.G,Qu))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-g.F,C.j.info("Handshake RTT: "+C.T+"ms")),O=C;var de=g;if(O.na=Zu(O,O.L?O.ba:null,O.W),de.L){fa(O.h,de);var je=de,Vt=O.O;Vt&&(je.H=Vt),je.D&&(Vl(je),ua(je)),O.g=de}else Cn(O);C.i.length>0&&ws(C)}else ut[0]!="stop"&&ut[0]!="close"||gi(C,7);else C.I==3&&(ut[0]=="stop"||ut[0]=="close"?ut[0]=="stop"?gi(C,7):$l(C):ut[0]!="noop"&&C.l&&C.l.qa(ut),C.A=0)}}Fn(4)}catch{}}var vy=class{constructor(g,E){this.g=g,this.map=E}};function jl(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ju(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function da(g){return g.h?1:g.g?g.g.size:0}function zu(g,E){return g.h?g.h==E:g.g?g.g.has(E):!1}function zl(g,E){g.g?g.g.add(E):g.h=E}function fa(g,E){g.h&&g.h==E?g.h=null:g.g&&g.g.has(E)&&g.g.delete(E)}jl.prototype.cancel=function(){if(this.i=ui(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function ui(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let E=g.i;for(const C of g.g.values())E=E.concat(C.G);return E}return x(g.i)}var If=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hi(g,E){if(g){g=g.split("&");for(let C=0;C<g.length;C++){const O=g[C].indexOf("=");let X,ee=null;O>=0?(X=g[C].substring(0,O),ee=g[C].substring(O+1)):X=g[C],E(X,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Dr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;g instanceof Dr?(this.l=g.l,ga(this,g.j),this.o=g.o,this.g=g.g,Mr(this,g.u),this.h=g.h,ro(this,Xu(g.i)),this.m=g.m):g&&(E=String(g).match(If))?(this.l=!1,ga(this,E[1]||"",!0),this.o=pa(E[2]||""),this.g=pa(E[3]||"",!0),Mr(this,E[4]),this.h=pa(E[5]||"",!0),ro(this,E[6]||"",!0),this.m=pa(E[7]||"")):(this.l=!1,this.i=new Xe(null,this.l))}Dr.prototype.toString=function(){const g=[];var E=this.j;E&&g.push(ma(E,Bu,!0),":");var C=this.g;return(C||E=="file")&&(g.push("//"),(E=this.o)&&g.push(ma(E,Bu,!0),"@"),g.push(Mi(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&g.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&g.push("/"),g.push(ma(C,C.charAt(0)=="/"?ya:Gu,!0))),(C=this.i.toString())&&g.push("?",C),(C=this.m)&&g.push("#",ma(C,Wu)),g.join("")},Dr.prototype.resolve=function(g){const E=Oi(this);let C=!!g.j;C?ga(E,g.j):C=!!g.o,C?E.o=g.o:C=!!g.g,C?E.g=g.g:C=g.u!=null;var O=g.h;if(C)Mr(E,g.u);else if(C=!!g.h){if(O.charAt(0)!="/")if(this.g&&!this.h)O="/"+O;else{var X=E.h.lastIndexOf("/");X!=-1&&(O=E.h.slice(0,X+1)+O)}if(X=O,X==".."||X==".")O="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){O=X.lastIndexOf("/",0)==0,X=X.split("/");const ee=[];for(let de=0;de<X.length;){const je=X[de++];je=="."?O&&de==X.length&&ee.push(""):je==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),O&&de==X.length&&ee.push("")):(ee.push(je),O=!0)}O=ee.join("/")}else O=X}return C?E.h=O:C=g.i.toString()!=="",C?ro(E,Xu(g.i)):C=!!g.m,C&&(E.m=g.m),E};function Oi(g){return new Dr(g)}function ga(g,E,C){g.j=C?pa(E,!0):E,g.j&&(g.j=g.j.replace(/:$/,""))}function Mr(g,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);g.u=E}else g.u=null}function ro(g,E,C){E instanceof Xe?(g.i=E,Bl(g.i,g.l)):(C||(E=ma(E,xy)),g.i=new Xe(E,g.l))}function st(g,E,C){g.i.set(E,C)}function ys(g){return st(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function pa(g,E){return g?E?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ma(g,E,C){return typeof g=="string"?(g=encodeURI(g).replace(E,Uu),C&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Uu(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Bu=/[#\/\?@]/g,Gu=/[#\?:]/g,ya=/[#\?]/g,xy=/[#\?@]/g,Wu=/#/g;function Xe(g,E){this.h=this.g=null,this.i=g||null,this.j=!!E}function Lr(g){g.g||(g.g=new Map,g.h=0,g.i&&hi(g.i,function(E,C){g.add(decodeURIComponent(E.replace(/\+/g," ")),C)}))}n=Xe.prototype,n.add=function(g,E){Lr(this),this.i=null,g=Or(this,g);let C=this.g.get(g);return C||this.g.set(g,C=[]),C.push(E),this.h+=1,this};function $u(g,E){Lr(g),E=Or(g,E),g.g.has(E)&&(g.i=null,g.h-=g.g.get(E).length,g.g.delete(E))}function Ul(g,E){return Lr(g),E=Or(g,E),g.g.has(E)}n.forEach=function(g,E){Lr(this),this.g.forEach(function(C,O){C.forEach(function(X){g.call(E,X,O,this)},this)},this)};function Ku(g,E){Lr(g);let C=[];if(typeof E=="string")Ul(g,E)&&(C=C.concat(g.g.get(Or(g,E))));else for(g=Array.from(g.g.values()),E=0;E<g.length;E++)C=C.concat(g[E]);return C}n.set=function(g,E){return Lr(this),this.i=null,g=Or(this,g),Ul(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[E]),this.h+=1,this},n.get=function(g,E){return g?(g=Ku(this,g),g.length>0?String(g[0]):E):E};function Hu(g,E,C){$u(g,E),C.length>0&&(g.i=null,g.g.set(Or(g,E),x(C)),g.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],E=Array.from(this.g.keys());for(let O=0;O<E.length;O++){var C=E[O];const X=Mi(C);C=Ku(this,C);for(let ee=0;ee<C.length;ee++){let de=X;C[ee]!==""&&(de+="="+Mi(C[ee])),g.push(de)}}return this.i=g.join("&")};function Xu(g){const E=new Xe;return E.i=g.i,g.g&&(E.g=new Map(g.g),E.h=g.h),E}function Or(g,E){return E=String(E),g.j&&(E=E.toLowerCase()),E}function Bl(g,E){E&&!g.j&&(Lr(g),g.i=null,g.g.forEach(function(C,O){const X=O.toLowerCase();O!=X&&($u(this,O),Hu(this,X,C))},g)),g.j=E}function Fr(g,E){const C=new Ot;if(o.Image){const O=new Image;O.onload=f(mn,C,"TestLoadImage: loaded",!0,E,O),O.onerror=f(mn,C,"TestLoadImage: error",!1,E,O),O.onabort=f(mn,C,"TestLoadImage: abort",!1,E,O),O.ontimeout=f(mn,C,"TestLoadImage: timeout",!1,E,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=g}else E(!1)}function Vr(g,E){const C=new Ot,O=new AbortController,X=setTimeout(()=>{O.abort(),mn(C,"TestPingServer: timeout",!1,E)},1e4);fetch(g,{signal:O.signal}).then(ee=>{clearTimeout(X),ee.ok?mn(C,"TestPingServer: ok",!0,E):mn(C,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(X),mn(C,"TestPingServer: error",!1,E)})}function mn(g,E,C,O,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),O(C)}catch{}}function _a(){this.g=new br}function _s(g){this.i=g.Sb||null,this.h=g.ab||!1}p(_s,Ni),_s.prototype.g=function(){return new di(this.i,this.h)};function di(g,E){yt.call(this),this.H=g,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(di,yt),n=di.prototype,n.open=function(g,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=E,this.readyState=1,rr(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(E.body=g),(this.H||o).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,so(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,rr(this)),this.g&&(this.readyState=3,rr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Cf(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Cf(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var E=g.value?g.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!g.done}))&&(this.response=this.responseText+=E)}g.done?so(this):rr(this),this.readyState==3&&Cf(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,so(this))},n.Na=function(g){this.g&&(this.response=g,so(this))},n.ga=function(){this.g&&so(this)};function so(g){g.readyState=4,g.l=null,g.j=null,g.B=null,rr(g)}n.setRequestHeader=function(g,E){this.A.append(g,E)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],E=this.h.entries();for(var C=E.next();!C.done;)C=C.value,g.push(C[0]+": "+C[1]),C=E.next();return g.join(`\r
`)};function rr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Rf(g){let E="";return se(g,function(C,O){E+=O,E+=":",E+=C,E+=`\r
`}),E}function Gl(g,E,C){e:{for(O in C){var O=!1;break e}O=!0}O||(C=Rf(C),typeof g=="string"?C!=null&&Mi(C):st(g,E,C))}function pt(g){yt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(pt,yt);var Af=/^https?$/i,wy=["POST","PUT"];n=pt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,E,C,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);E=E?E.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Gt.g(),this.g.onreadystatechange=y(h(this.Ca,this));try{this.B=!0,this.g.open(E,String(g),!0),this.B=!1}catch(ee){oo(this,ee);return}if(g=C||"",C=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var X in O)C.set(X,O[X]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const ee of O.keys())C.set(ee,O.get(ee));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(C.keys()).find(ee=>ee.toLowerCase()=="content-type"),X=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(wy,E,void 0)>=0)||O||X||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,de]of C)this.g.setRequestHeader(ee,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(ee){oo(this,ee)}};function oo(g,E){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=E,g.o=5,ao(g),xs(g)}function ao(g){g.A||(g.A=!0,ct(g,"complete"),ct(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ct(this,"complete"),ct(this,"abort"),xs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xs(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?vs(this):this.Xa())},n.Xa=function(){vs(this)};function vs(g){if(g.h&&typeof s<"u"){if(g.v&&jr(g)==4)setTimeout(g.Ca.bind(g),0);else if(ct(g,"readystatechange"),jr(g)==4){g.h=!1;try{const ee=g.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var C;if(!(C=E)){var O;if(O=ee===0){let de=String(g.D).match(If)[1]||null;!de&&o.self&&o.self.location&&(de=o.self.location.protocol.slice(0,-1)),O=!Af.test(de?de.toLowerCase():"")}C=O}if(C)ct(g,"complete"),ct(g,"success");else{g.o=6;try{var X=jr(g)>2?g.g.statusText:""}catch{X=""}g.l=X+" ["+g.ca()+"]",ao(g)}}finally{xs(g)}}}}function xs(g,E){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const C=g.g;g.g=null,E||ct(g,"ready");try{C.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function jr(g){return g.g?g.g.readyState:0}n.ca=function(){try{return jr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var E=this.g.responseText;return g&&E.indexOf(g)==0&&(E=E.substring(g.length)),ca(E)}};function bf(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function qu(g){const E={};g=(g.g&&jr(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<g.length;O++){if(L(g[O]))continue;var C=Fl(g[O]);const X=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ee=E[X]||[];E[X]=ee,ee.push(C)}ne(E,function(O){return O.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function zr(g,E,C){return C&&C.internalChannelParams&&C.internalChannelParams[g]||E}function Wl(g){this.za=0,this.i=[],this.j=new Ot,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=zr("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=zr("baseRetryDelayMs",5e3,g),this.Za=zr("retryDelaySeedMs",1e4,g),this.Ta=zr("forwardChannelMaxRetries",2,g),this.va=zr("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new jl(g&&g.concurrentRequestLimit),this.Ba=new _a,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Wl.prototype,n.ka=8,n.I=1,n.connect=function(g,E,C,O){ft(0),this.W=g,this.H=E||{},C&&O!==void 0&&(this.H.OSID=C,this.H.OAID=O),this.F=this.X,this.J=Zu(this,null,this.W),ws(this)};function $l(g){if(Kl(g),g.I==3){var E=g.V++,C=Oi(g.J);if(st(C,"SID",g.M),st(C,"RID",E),st(C,"TYPE","terminate"),Ur(g,C),E=new Li(g,g.j,E),E.M=2,E.A=ys(Oi(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(E.A.toString(),"")}catch{}!C&&o.Image&&(new Image().src=E.A,C=!0),C||(E.g=kf(E.j,null),E.g.ea(E.A)),E.F=Date.now(),ua(E)}wa(g)}function fi(g){g.g&&(xa(g),g.g.cancel(),g.g=null)}function Kl(g){fi(g),g.v&&(o.clearTimeout(g.v),g.v=null),Hl(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function ws(g){if(!ju(g.h)&&!g.m){g.m=!0;var E=g.Ea;F||A(),U||(F(),U=!0),P.add(E,g),g.D=0}}function Pf(g,E){return da(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=E.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=nr(h(g.Ea,g,E),ql(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const X=new Li(this,this.j,g);let ee=this.o;if(this.U&&(ee?(ee=W(ee),ie(ee,this.U)):ee=this.U),this.u!==null||this.R||(X.J=ee,ee=null),this.S)e:{for(var E=0,C=0;C<this.i.length;C++){t:{var O=this.i[C];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(E+=O,E>4096){E=C;break e}if(E===4096||C===this.i.length-1){E=C+1;break e}}E=1e3}else E=1e3;E=Yu(this,X,E),C=Oi(this.J),st(C,"RID",g),st(C,"CVER",22),this.G&&st(C,"X-HTTP-Session-Id",this.G),Ur(this,C),ee&&(this.R?E="headers="+Mi(Rf(ee))+"&"+E:this.u&&Gl(C,this.u,ee)),zl(this.h,X),this.Ra&&st(C,"TYPE","init"),this.S?(st(C,"$req",E),st(C,"SID","null"),X.U=!0,ir(X,C,null)):ir(X,C,E),this.I=2}}else this.I==3&&(g?va(this,g):this.i.length==0||ju(this.h)||va(this))};function va(g,E){var C;E?C=E.l:C=g.V++;const O=Oi(g.J);st(O,"SID",g.M),st(O,"RID",C),st(O,"AID",g.K),Ur(g,O),g.u&&g.o&&Gl(O,g.u,g.o),C=new Li(g,g.j,C,g.D+1),g.u===null&&(C.J=g.o),E&&(g.i=E.G.concat(g.i)),E=Yu(g,C,1e3),C.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),zl(g.h,C),ir(C,O,E)}function Ur(g,E){g.H&&se(g.H,function(C,O){st(E,O,C)}),g.l&&se({},function(C,O){st(E,O,C)})}function Yu(g,E,C){C=Math.min(g.i.length,C);const O=g.l?h(g.l.Ka,g.l,g):null;e:{var X=g.i;let je=-1;for(;;){const Vt=["count="+C];je==-1?C>0?(je=X[0].g,Vt.push("ofs="+je)):je=0:Vt.push("ofs="+je);let ut=!0;for(let Wt=0;Wt<C;Wt++){var ee=X[Wt].g;const pi=X[Wt].map;if(ee-=je,ee<0)je=Math.max(0,X[Wt].g-100),ut=!1;else try{ee="req"+ee+"_"||"";try{var de=pi instanceof Map?pi:Object.entries(pi);for(const[Es,Gr]of de){let Wr=Gr;l(Gr)&&(Wr=Ar(Gr)),Vt.push(ee+Es+"="+encodeURIComponent(Wr))}}catch(Es){throw Vt.push(ee+"type="+encodeURIComponent("_badmap")),Es}}catch{O&&O(pi)}}if(ut){de=Vt.join("&");break e}}de=void 0}return g=g.i.splice(0,C),E.G=g,de}function Cn(g){if(!g.g&&!g.v){g.Y=1;var E=g.Da;F||A(),U||(F(),U=!0),P.add(E,g),g.A=0}}function Br(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=nr(h(g.Da,g),ql(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,lo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=nr(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ft(10),fi(this),lo(this))};function xa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function lo(g){g.g=new Li(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var E=Oi(g.na);st(E,"RID","rpc"),st(E,"SID",g.M),st(E,"AID",g.K),st(E,"CI",g.F?"0":"1"),!g.F&&g.ia&&st(E,"TO",g.ia),st(E,"TYPE","xmlhttp"),Ur(g,E),g.u&&g.o&&Gl(E,g.u,g.o),g.O&&(g.g.H=g.O);var C=g.g;g=g.ba,C.M=1,C.A=ys(Oi(E)),C.u=null,C.R=!0,Fu(C,g)}n.Va=function(){this.C!=null&&(this.C=null,fi(this),Br(this),ft(19))};function Hl(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function Xl(g,E){var C=null;if(g.g==E){Hl(g),xa(g),g.g=null;var O=2}else if(zu(g.h,E))C=E.G,fa(g.h,E),O=1;else return;if(g.I!=0){if(E.o)if(O==1){C=E.u?E.u.length:0,E=Date.now()-E.F;var X=g.D;O=kr(),ct(O,new io(O,C)),ws(g)}else Cn(g);else if(X=E.m,X==3||X==0&&E.X>0||!(O==1&&Pf(g,E)||O==2&&Br(g)))switch(C&&C.length>0&&(E=g.h,E.i=E.i.concat(C)),X){case 1:gi(g,5);break;case 4:gi(g,10);break;case 3:gi(g,6);break;default:gi(g,2)}}}function ql(g,E){let C=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(C*=2),C*E}function gi(g,E){if(g.j.info("Error code "+E),E==2){var C=h(g.bb,g),O=g.Ua;const X=!O;O=new Dr(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ga(O,"https"),ys(O),X?Fr(O.toString(),C):Vr(O.toString(),C)}else ft(2);g.I=0,g.l&&g.l.pa(E),wa(g),Kl(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function wa(g){if(g.I=0,g.ja=[],g.l){const E=ui(g.h);(E.length!=0||g.i.length!=0)&&(S(g.ja,E),S(g.ja,g.i),g.h.i.length=0,x(g.i),g.i.length=0),g.l.oa()}}function Zu(g,E,C){var O=C instanceof Dr?Oi(C):new Dr(C);if(O.g!="")E&&(O.g=E+"."+O.g),Mr(O,O.u);else{var X=o.location;O=X.protocol,E=E?E+"."+X.hostname:X.hostname,X=+X.port;const ee=new Dr(null);O&&ga(ee,O),E&&(ee.g=E),X&&Mr(ee,X),C&&(ee.h=C),O=ee}return C=g.G,E=g.wa,C&&E&&st(O,C,E),st(O,"VER",g.ka),Ur(g,O),O}function kf(g,E,C){if(E&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=g.Aa&&!g.ma?new pt(new _s({ab:C})):new pt(g.ma),E.Fa(g.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Nf(){}n=Nf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Yl(){}Yl.prototype.g=function(g,E){return new yn(g,E)};function yn(g,E){yt.call(this),this.g=new Wl(E),this.l=g,this.h=E&&E.messageUrlParams||null,g=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(g?g["X-WebChannel-Content-Type"]=E.messageContentType:g={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(g?g["X-WebChannel-Client-Profile"]=E.sa:g={"X-WebChannel-Client-Profile":E.sa}),this.g.U=g,(g=E&&E.Qb)&&!L(g)&&(this.g.u=g),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!L(E)&&(this.g.G=E,g=this.h,g!==null&&E in g&&(g=this.h,E in g&&delete g[E])),this.j=new co(this)}p(yn,yt),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){$l(this.g)},yn.prototype.o=function(g){var E=this.g;if(typeof g=="string"){var C={};C.__data__=g,g=C}else this.v&&(C={},C.__data__=Ar(g),g=C);E.i.push(new vy(E.Ya++,g)),E.I==3&&ws(E)},yn.prototype.N=function(){this.g.l=null,delete this.j,$l(this.g),delete this.g,yn.Z.N.call(this)};function Df(g){gs.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var E=g.__sm__;if(E){e:{for(const C in E){g=C;break e}g=void 0}(this.i=g)&&(g=this.i,E=E!==null&&g in E?E[g]:void 0),this.data=E}else this.data=g}p(Df,gs);function Mf(){no.call(this),this.status=1}p(Mf,no);function co(g){this.g=g}p(co,Nf),co.prototype.ra=function(){ct(this.g,"a")},co.prototype.qa=function(g){ct(this.g,new Df(g))},co.prototype.pa=function(g){ct(this.g,new Mf)},co.prototype.oa=function(){ct(this.g,"b")},Yl.prototype.createWebChannel=Yl.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,Vk=function(){return new Yl},Fk=function(){return kr()},Ok=On,Yv={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},rn.NO_ERROR=0,rn.TIMEOUT=8,rn.HTTP_ERROR=6,dp=rn,rt.COMPLETE="complete",Lk=rt,Ol.EventType=Pr,Pr.OPEN="a",Pr.CLOSE="b",Pr.ERROR="c",Pr.MESSAGE="d",yt.prototype.listen=yt.prototype.J,Hh=Ol,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,Mk=pt}).apply(typeof Hg<"u"?Hg:typeof self<"u"?self:typeof window<"u"?window:{});const lR="@firebase/firestore",cR="4.9.3";let wn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};wn.UNAUTHENTICATED=new wn(null),wn.GOOGLE_CREDENTIALS=new wn("google-credentials-uid"),wn.FIRST_PARTY=new wn("first-party-uid"),wn.MOCK_USER=new wn("mock-user");let Mu="12.7.0";const Tl=new $1("@firebase/firestore");function Lc(){return Tl.logLevel}function fe(n,...e){if(Tl.logLevel<=He.DEBUG){const t=e.map(sw);Tl.debug(`Firestore (${Mu}): ${n}`,...t)}}function Ei(n,...e){if(Tl.logLevel<=He.ERROR){const t=e.map(sw);Tl.error(`Firestore (${Mu}): ${n}`,...t)}}function Jm(n,...e){if(Tl.logLevel<=He.WARN){const t=e.map(sw);Tl.warn(`Firestore (${Mu}): ${n}`,...t)}}function sw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Re(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,jk(n,i,t)}function jk(n,e,t){let i=`FIRESTORE (${Mu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ei(i),new Error(i)}function De(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||jk(e,r,i)}function Tt(n,e){return n}const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends hs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ll{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class zk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class A8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(wn.UNAUTHENTICATED)))}shutdown(){}}class b8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class P8{constructor(e){this.t=e,this.currentUser=wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){De(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new ll;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ll,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},l=u=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ll)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(De(typeof i.accessToken=="string",31837,{l:i}),new zk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return De(e===null||typeof e=="string",2055,{h:e}),new wn(e)}}class k8{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class N8{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new k8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(wn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class uR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class D8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ki(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){De(this.o===void 0,3512);const i=s=>{s.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new uR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(De(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new uR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function M8(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Uk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=M8(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function Ke(n,e){return n<e?-1:n>e?1:0}function Zv(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return $0(r)===$0(s)?Ke(r,s):$0(r)?1:-1}return Ke(n.length,e.length)}const L8=55296,O8=57343;function $0(n){const e=n.charCodeAt(0);return e>=L8&&e<=O8}function pu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function Bk(n){return n+"\0"}const hR="__name__";class qr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Re(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Re(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return qr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=qr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return Ke(e.length,t.length)}static compareSegments(e,t){const i=qr.isNumericId(e),r=qr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?qr.extractNumericId(e).compare(qr.extractNumericId(t)):Zv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return rw.fromString(e.substring(4,e.length-2))}}class Ct extends qr{construct(e,t,i){return new Ct(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Se(ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Ct(t)}static emptyPath(){return new Ct([])}}const F8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bt extends qr{construct(e,t,i){return new Bt(e,t,i)}static isValidIdentifier(e){return F8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hR}static keyField(){return new Bt([hR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Se(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Se(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Se(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new Se(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bt(t)}static emptyPath(){return new Bt([])}}class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(Ct.fromString(e))}static fromName(e){return new Ee(Ct.fromString(e).popFirst(5))}static empty(){return new Ee(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new Ct(e.slice()))}}function V8(n,e,t,i){if(e===!0&&i===!0)throw new Se(ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function j8(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function z8(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Re(12329,{type:typeof n})}function Gk(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Se(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=z8(n);throw new Se(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Xt(n,e){const t={typeString:n};return e&&(t.value=e),t}function mf(n,e){if(!j8(n))throw new Se(ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Se(ae.INVALID_ARGUMENT,t);return!0}const dR=-62135596800,fR=1e6;class Pt{static now(){return Pt.fromMillis(Date.now())}static fromDate(e){return Pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*fR);return new Pt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Se(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Se(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<dR)throw new Se(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/fR}_compareTo(e){return this.seconds===e.seconds?Ke(this.nanoseconds,e.nanoseconds):Ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(mf(e,Pt._jsonSchema))return new Pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-dR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Pt._jsonSchemaVersion="firestore/timestamp/1.0",Pt._jsonSchema={type:Xt("string",Pt._jsonSchemaVersion),seconds:Xt("number"),nanoseconds:Xt("number")};class Qe{static fromTimestamp(e){return new Qe(e)}static min(){return new Qe(new Pt(0,0))}static max(){return new Qe(new Pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Vd=-1;class tm{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Qv(n){return n.fields.find((e=>e.kind===2))}function Ga(n){return n.fields.filter((e=>e.kind!==2))}tm.UNKNOWN_ID=-1;class fp{constructor(e,t){this.fieldPath=e,this.kind=t}}class jd{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new jd(0,Ai.min())}}function U8(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Qe.fromTimestamp(i===1e9?new Pt(t+1,0):new Pt(t,i));return new Ai(r,Ee.empty(),e)}function Wk(n){return new Ai(n.readTime,n.key,Vd)}class Ai{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ai(Qe.min(),Ee.empty(),Vd)}static max(){return new Ai(Qe.max(),Ee.empty(),Vd)}}function ow(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:Ke(n.largestBatchId,e.largestBatchId))}const $k="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Kk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ey(n){if(n.code!==ae.FAILED_PRECONDITION||n.message!==$k)throw n;fe("LocalStore","Unexpectedly lost primary lease")}class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Z(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Z?t:Z.resolve(t)}catch(t){return Z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.reject(t)}static resolve(e){return new Z(((t,i)=>{t(e)}))}static reject(e){return new Z(((t,i)=>{i(e)}))}static waitFor(e){return new Z(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=Z.resolve(!1);for(const i of e)t=t.next((r=>r?Z.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Z(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new Z(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const vi="SimpleDb";class ty{static open(e,t,i,r){try{return new ty(t,e.transaction(r,i))}catch(s){throw new id(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ll,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new id(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=aw(i.target.error);this.S.reject(new id(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(fe(vi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new G8(t)}}class Qo{static delete(e){return fe(vi,"Removing database:",e),Ka(GP().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!QP())return!1;if(Qo.F())return!0;const e=en(),t=Qo.M(e),i=0<t&&t<10,r=Hk(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Qo.M(en())===12.2&&Ei("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(fe(vi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new id(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Se(ae.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Se(ae.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new id(e,o))},r.onupgradeneeded=s=>{fe(vi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{fe(vi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=ty.open(this.db,e,s?"readonly":"readwrite",i),u=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),Z.reject(h)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,h=u.name!=="FirebaseError"&&o<3;if(fe(vi,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Hk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class B8{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ka(this.U.delete())}}class id extends Se{constructor(e,t){super(ae.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ll(n){return n.name==="IndexedDbTransactionError"}class G8{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(fe(vi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(fe(vi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ka(i)}add(e){return fe(vi,"ADD",this.store.name,e,e),Ka(this.store.add(e))}get(e){return Ka(this.store.get(e)).next((t=>(t===void 0&&(t=null),fe(vi,"GET",this.store.name,e,t),t)))}delete(e){return fe(vi,"DELETE",this.store.name,e),Ka(this.store.delete(e))}count(){return fe(vi,"COUNT",this.store.name),Ka(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Z(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Z(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){fe(vi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Z(((i,r)=>{t.onerror=s=>{const o=aw(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Z(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new B8(l),h=t(l.primaryKey,l.value,u);if(h instanceof Z){const f=h.catch((p=>(u.done(),Z.reject(p))));i.push(f)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}})).next((()=>Z.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ka(n){return new Z(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=aw(i.target.error);t(r)}}))}let gR=!1;function aw(n){const e=Qo.M(en());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Se("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return gR||(gR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const rd="IndexBackfiller";class W8{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){fe(rd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();fe(rd,`Documents written: ${t}`)}catch(t){Ll(t)?fe(rd,"Ignoring IndexedDB error during index backfill: ",t):await ey(t)}await this.re(6e4)}))}}class $8{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Z.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return fe(rd,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(fe(rd,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=Wk(s);ow(o,i)>0&&(i=o)})),new Ai(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class vr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}vr.ce=-1;const cl=-1;function ny(n){return n==null}function nm(n){return n===0&&1/n==-1/0}const im="";function Gn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=pR(e)),e=K8(n.get(t),e);return pR(e)}function K8(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case im:t+="";break;default:t+=s}}return t}function pR(n){return n+im+""}function Jr(n){const e=n.length;if(De(e>=2,64408,{path:n}),e===2)return De(n.charAt(0)===im&&n.charAt(1)==="",56145,{path:n}),Ct.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(im,s);switch((o<0||o>t)&&Re(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Re(61167,{path:n})}s=o+2}return new Ct(i)}const Wa="remoteDocuments",yf="owner",Ic="owner",zd="mutationQueues",H8="userId",fr="mutations",mR="batchId",nl="userMutationsIndex",yR=["userId","batchId"];function gp(n,e){return[n,Gn(e)]}function Xk(n,e,t){return[n,Gn(e),t]}const X8={},mu="documentMutations",rm="remoteDocumentsV14",q8=["prefixPath","collectionGroup","readTime","documentId"],pp="documentKeyIndex",Y8=["prefixPath","collectionGroup","documentId"],qk="collectionGroupIndex",Z8=["collectionGroup","readTime","prefixPath","documentId"],Ud="remoteDocumentGlobal",Jv="remoteDocumentGlobalKey",yu="targets",Yk="queryTargetsIndex",Q8=["canonicalId","targetId"],_u="targetDocuments",J8=["targetId","path"],lw="documentTargetsIndex",eG=["path","targetId"],sm="targetGlobalKey",ul="targetGlobal",Bd="collectionParents",tG=["collectionId","parent"],vu="clientMetadata",nG="clientId",iy="bundles",iG="bundleId",ry="namedQueries",rG="name",cw="indexConfiguration",sG="indexId",ex="collectionGroupIndex",oG="collectionGroup",sd="indexState",aG=["indexId","uid"],Zk="sequenceNumberIndex",lG=["uid","sequenceNumber"],od="indexEntries",cG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Qk="documentKeyIndex",uG=["indexId","uid","orderedDocumentKey"],sy="documentOverlays",hG=["userId","collectionPath","documentId"],tx="collectionPathOverlayIndex",dG=["userId","collectionPath","largestBatchId"],Jk="collectionGroupOverlayIndex",fG=["userId","collectionGroup","largestBatchId"],uw="globals",gG="name",eN=[zd,fr,mu,Wa,yu,yf,ul,_u,vu,Ud,Bd,iy,ry],pG=[...eN,sy],tN=[zd,fr,mu,rm,yu,yf,ul,_u,vu,Ud,Bd,iy,ry,sy],nN=tN,hw=[...nN,cw,sd,od],mG=hw,iN=[...hw,uw],yG=iN;class nx extends Kk{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function tn(n,e){const t=Tt(n);return Qo.O(t.le,e)}function _R(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function dw(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function _G(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class li{constructor(e,t){this.comparator=e,this.root=t||En.EMPTY}insert(e,t){return new li(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new li(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Xg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Xg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Xg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Xg(this.root,e,this.comparator,!0)}}class Xg{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??En.RED,this.left=r??En.EMPTY,this.right=s??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new En(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return En.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Re(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw Re(57766)}get value(){throw Re(16141)}get color(){throw Re(16727)}get left(){throw Re(29726)}get right(){throw Re(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new En(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class mt{constructor(e){this.comparator=e,this.data=new li(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vR(this.data.getIterator())}getIteratorFrom(e){return new vR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new mt(this.comparator);return t.data=e,t}}class vR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Cc(n){return n.hasNext()?n.getNext():void 0}class js{constructor(e){this.fields=e,e.sort(Bt.comparator)}static empty(){return new js([])}unionWith(e){let t=new mt(Bt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new js(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class vG extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ci{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new vG("Invalid base64 string: "+s):s}})(e);return new ci(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new ci(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ci.EMPTY_BYTE_STRING=new ci("");const xG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ia(n){if(De(!!n,39018),typeof n=="string"){let e=0;const t=xG.exec(n);if(De(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ht(n.seconds),nanos:Ht(n.nanos)}}function Ht(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function xu(n){return typeof n=="string"?ci.fromBase64String(n):ci.fromUint8Array(n)}const rN="server_timestamp",sN="__type__",oN="__previous_value__",aN="__local_write_time__";function fw(n){return(n?.mapValue?.fields||{})[sN]?.stringValue===rN}function lN(n){const e=n.mapValue.fields[oN];return fw(e)?lN(e):e}function om(n){const e=ia(n.mapValue.fields[aN].timestampValue);return new Pt(e.seconds,e.nanos)}class wG{constructor(e,t,i,r,s,o,l,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const am="(default)";class wu{constructor(e,t){this.projectId=e,this.database=t||am}static empty(){return new wu("","")}get isDefaultDatabase(){return this.database===am}isEqual(e){return e instanceof wu&&e.projectId===this.projectId&&e.database===this.database}}const cN="__type__",uN="__max__",Ko={mapValue:{fields:{__type__:{stringValue:uN}}}},hN="__vector__",lm="value",mp={nullValue:"NULL_VALUE"};function Eu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?fw(n)?4:dN(n)?9007199254740991:oy(n)?10:11:Re(28295,{value:n})}function as(n,e){if(n===e)return!0;const t=Eu(n);if(t!==Eu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return om(n).isEqual(om(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ia(r.timestampValue),l=ia(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return xu(r.bytesValue).isEqual(xu(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Ht(r.geoPointValue.latitude)===Ht(s.geoPointValue.latitude)&&Ht(r.geoPointValue.longitude)===Ht(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Ht(r.integerValue)===Ht(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Ht(r.doubleValue),l=Ht(s.doubleValue);return o===l?nm(o)===nm(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return pu(n.arrayValue.values||[],e.arrayValue.values||[],as);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(_R(o)!==_R(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!as(o[u],l[u])))return!1;return!0})(n,e);default:return Re(52216,{left:n})}}function Gd(n,e){return(n.values||[]).find((t=>as(t,e)))!==void 0}function ra(n,e){if(n===e)return 0;const t=Eu(n),i=Eu(e);if(t!==i)return Ke(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ke(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=Ht(s.integerValue||s.doubleValue),u=Ht(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return xR(n.timestampValue,e.timestampValue);case 4:return xR(om(n),om(e));case 5:return Zv(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=xu(s),u=xu(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=Ke(l[h],u[h]);if(f!==0)return f}return Ke(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=Ke(Ht(s.latitude),Ht(o.latitude));return l!==0?l:Ke(Ht(s.longitude),Ht(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return wR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[lm]?.arrayValue,f=u[lm]?.arrayValue,p=Ke(h?.values?.length||0,f?.values?.length||0);return p!==0?p:wR(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Ko.mapValue&&o===Ko.mapValue)return 0;if(s===Ko.mapValue)return 1;if(o===Ko.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const y=Zv(u[p],f[p]);if(y!==0)return y;const x=ra(l[u[p]],h[f[p]]);if(x!==0)return x}return Ke(u.length,f.length)})(n.mapValue,e.mapValue);default:throw Re(23264,{he:t})}}function xR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ke(n,e);const t=ia(n),i=ia(e),r=Ke(t.seconds,i.seconds);return r!==0?r:Ke(t.nanos,i.nanos)}function wR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=ra(t[r],i[r]);if(s)return s}return Ke(t.length,i.length)}function Tu(n){return ix(n)}function ix(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ia(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return xu(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ee.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=ix(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${ix(t.fields[o])}`;return r+"}"})(n.mapValue):Re(61005,{value:n})}function gw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function rx(n){return!!n&&"integerValue"in n}function Wd(n){return!!n&&"arrayValue"in n}function ER(n){return!!n&&"nullValue"in n}function TR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function K0(n){return!!n&&"mapValue"in n}function oy(n){return(n?.mapValue?.fields||{})[cN]?.stringValue===hN}function ad(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return dw(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=ad(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ad(n.arrayValue.values[t]);return e}return{...n}}function dN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===uN}const fN={mapValue:{fields:{[cN]:{stringValue:hN},[lm]:{arrayValue:{}}}}};function EG(n){return"nullValue"in n?mp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?gw(wu.empty(),Ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?oy(n)?fN:{mapValue:{}}:Re(35942,{value:n})}function TG(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?gw(wu.empty(),Ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?fN:"mapValue"in n?oy(n)?{mapValue:{}}:Ko:Re(61959,{value:n})}function SR(n,e){const t=ra(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function IR(n,e){const t=ra(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class yr{constructor(e){this.value=e}static empty(){return new yr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!K0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ad(t)}setAll(e){let t=Bt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=ad(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());K0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return as(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];K0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){dw(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new yr(ad(this.value))}}class Tn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Qe.min(),Qe.min(),Qe.min(),yr.empty(),0)}static newFoundDocument(e,t,i,r){return new Tn(e,1,t,Qe.min(),i,r,0)}static newNoDocument(e,t){return new Tn(e,2,t,Qe.min(),Qe.min(),yr.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Qe.min(),Qe.min(),yr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Su{constructor(e,t){this.position=e,this.inclusive=t}}function CR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Ee.comparator(Ee.fromName(o.referenceValue),t.key):i=ra(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function RR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!as(n.position[t],e.position[t]))return!1;return!0}class cm{constructor(e,t="asc"){this.field=e,this.dir=t}}function SG(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class gN{}class Ye extends gN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new IG(e,t,i):t==="array-contains"?new AG(e,i):t==="in"?new xN(e,i):t==="not-in"?new bG(e,i):t==="array-contains-any"?new PG(e,i):new Ye(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new CG(e,i):new RG(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ra(t,this.value)):t!==null&&Eu(this.value)===Eu(t)&&this.matchesComparison(ra(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gt extends gN{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gt(e,t)}matches(e){return Iu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Iu(n){return n.op==="and"}function sx(n){return n.op==="or"}function pw(n){return pN(n)&&Iu(n)}function pN(n){for(const e of n.filters)if(e instanceof gt)return!1;return!0}function ox(n){if(n instanceof Ye)return n.field.canonicalString()+n.op.toString()+Tu(n.value);if(pw(n))return n.filters.map((e=>ox(e))).join(",");{const e=n.filters.map((t=>ox(t))).join(",");return`${n.op}(${e})`}}function mN(n,e){return n instanceof Ye?(function(i,r){return r instanceof Ye&&i.op===r.op&&i.field.isEqual(r.field)&&as(i.value,r.value)})(n,e):n instanceof gt?(function(i,r){return r instanceof gt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&mN(o,r.filters[l])),!0):!1})(n,e):void Re(19439)}function yN(n,e){const t=n.filters.concat(e);return gt.create(t,n.op)}function _N(n){return n instanceof Ye?(function(t){return`${t.field.canonicalString()} ${t.op} ${Tu(t.value)}`})(n):n instanceof gt?(function(t){return t.op.toString()+" {"+t.getFilters().map(_N).join(" ,")+"}"})(n):"Filter"}class IG extends Ye{constructor(e,t,i){super(e,t,i),this.key=Ee.fromName(i.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class CG extends Ye{constructor(e,t){super(e,"in",t),this.keys=vN("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class RG extends Ye{constructor(e,t){super(e,"not-in",t),this.keys=vN("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function vN(n,e){return(e.arrayValue?.values||[]).map((t=>Ee.fromName(t.referenceValue)))}class AG extends Ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Wd(t)&&Gd(t.arrayValue,this.value)}}class xN extends Ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Gd(this.value.arrayValue,t)}}class bG extends Ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Gd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Gd(this.value.arrayValue,t)}}class PG extends Ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Wd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Gd(this.value.arrayValue,i)))}}class kG{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function ax(n,e=null,t=[],i=[],r=null,s=null,o=null){return new kG(n,e,t,i,r,s,o)}function Sl(n){const e=Tt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>ox(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),ny(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Tu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Tu(i))).join(",")),e.Te=t}return e.Te}function _f(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!SG(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!mN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!RR(n.startAt,e.startAt)&&RR(n.endAt,e.endAt)}function NG(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function um(n,e){return n.filters.filter((t=>t instanceof Ye&&t.field.isEqual(e)))}function AR(n,e,t){let i=mp,r=!0;for(const s of um(n,e)){let o=mp,l=!0;switch(s.op){case"<":case"<=":o=EG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=mp}SR({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];SR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function bR(n,e,t){let i=Ko,r=!0;for(const s of um(n,e)){let o=Ko,l=!0;switch(s.op){case">=":case">":o=TG(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Ko}IR({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];IR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class ay{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function DG(n,e,t,i,r,s,o,l){return new ay(n,e,t,i,r,s,o,l)}function wN(n){return new ay(n)}function PR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function MG(n){return n.collectionGroup!==null}function ld(n){const e=Tt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new mt(Bt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new cm(s,i))})),t.has(Bt.keyField().canonicalString())||e.Ie.push(new cm(Bt.keyField(),i))}return e.Ie}function $s(n){const e=Tt(n);return e.Ee||(e.Ee=LG(e,ld(n))),e.Ee}function LG(n,e){if(n.limitType==="F")return ax(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new cm(r.field,s)}));const t=n.endAt?new Su(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Su(n.startAt.position,n.startAt.inclusive):null;return ax(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function lx(n,e,t){return new ay(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function EN(n,e){return _f($s(n),$s(e))&&n.limitType===e.limitType}function TN(n){return`${Sl($s(n))}|lt:${n.limitType}`}function kh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>_N(r))).join(", ")}]`),ny(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Tu(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Tu(r))).join(",")),`Target(${i})`})($s(n))}; limitType=${n.limitType})`}function ly(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ee.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of ld(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,u){const h=CR(o,l,u);return o.inclusive?h<=0:h<0})(i.startAt,ld(i),r)||i.endAt&&!(function(o,l,u){const h=CR(o,l,u);return o.inclusive?h>=0:h>0})(i.endAt,ld(i),r))})(n,e)}function OG(n){return(e,t)=>{let i=!1;for(const r of ld(n)){const s=FG(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function FG(n,e,t){const i=n.field.isKeyField()?Ee.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?ra(u,h):Re(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Re(19790,{direction:n.dir})}}class la{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){dw(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return _G(this.inner)}size(){return this.innerSize}}const VG=new li(Ee.comparator);function il(){return VG}const SN=new li(Ee.comparator);function qg(...n){let e=SN;for(const t of n)e=e.insert(t.key,t);return e}function jG(n){let e=SN;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function es(){return cd()}function IN(){return cd()}function cd(){return new la((n=>n.toString()),((n,e)=>n.isEqual(e)))}const zG=new li(Ee.comparator),UG=new mt(Ee.comparator);function Sn(...n){let e=UG;for(const t of n)e=e.add(t);return e}const BG=new mt(Ke);function GG(){return BG}function WG(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nm(e)?"-0":e}}function $G(n){return{integerValue:""+n}}class cy{constructor(){this._=void 0}}function KG(n,e,t){return n instanceof $d?(function(r,s){const o={fields:{[sN]:{stringValue:rN},[aN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&fw(s)&&(s=lN(s)),s&&(o.fields[oN]=s),{mapValue:o}})(t,e):n instanceof Cu?CN(n,e):n instanceof Ru?RN(n,e):(function(r,s){const o=XG(r,s),l=kR(o)+kR(r.Ae);return rx(o)&&rx(r.Ae)?$G(l):WG(r.serializer,l)})(n,e)}function HG(n,e,t){return n instanceof Cu?CN(n,e):n instanceof Ru?RN(n,e):t}function XG(n,e){return n instanceof Kd?(function(i){return rx(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class $d extends cy{}class Cu extends cy{constructor(e){super(),this.elements=e}}function CN(n,e){const t=AN(e);for(const i of n.elements)t.some((r=>as(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Ru extends cy{constructor(e){super(),this.elements=e}}function RN(n,e){let t=AN(e);for(const i of n.elements)t=t.filter((r=>!as(r,i)));return{arrayValue:{values:t}}}class Kd extends cy{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function kR(n){return Ht(n.integerValue||n.doubleValue)}function AN(n){return Wd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class qG{constructor(e,t){this.field=e,this.transform=t}}function YG(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Cu&&r instanceof Cu||i instanceof Ru&&r instanceof Ru?pu(i.elements,r.elements,as):i instanceof Kd&&r instanceof Kd?as(i.Ae,r.Ae):i instanceof $d&&r instanceof $d})(n.transform,e.transform)}class ZG{constructor(e,t){this.version=e,this.transformResults=t}}class xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xr}static exists(e){return new xr(void 0,e)}static updateTime(e){return new xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class uy{}function bN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new mw(n.key,xr.none()):new vf(n.key,n.data,xr.none());{const t=n.data,i=yr.empty();let r=new mt(Bt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Lu(n.key,i,new js(r.toArray()),xr.none())}}function QG(n,e,t){n instanceof vf?(function(r,s,o){const l=r.value.clone(),u=DR(r.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Lu?(function(r,s,o){if(!yp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=DR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(PN(r)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function ud(n,e,t,i){return n instanceof vf?(function(s,o,l,u){if(!yp(s.precondition,o))return l;const h=s.value.clone(),f=MR(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Lu?(function(s,o,l,u){if(!yp(s.precondition,o))return l;const h=MR(s.fieldTransforms,u,o),f=o.data;return f.setAll(PN(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((p=>p.field)))})(n,e,t,i):(function(s,o,l){return yp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function NR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&pu(i,r,((s,o)=>YG(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class vf extends uy{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Lu extends uy{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function PN(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function DR(n,e,t){const i=new Map;De(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,HG(o,l,t[r]))}return i}function MR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,KG(s,o,e))}return i}class mw extends uy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class kN extends uy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class yw{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&QG(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=ud(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=ud(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=IN();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const u=bN(o,l);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Qe.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Sn())}isEqual(e){return this.batchId===e.batchId&&pu(this.mutations,e.mutations,((t,i)=>NR(t,i)))&&pu(this.baseMutations,e.baseMutations,((t,i)=>NR(t,i)))}}class _w{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){De(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return zG})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new _w(e,t,i,r)}}class vw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var Kt,Ze;function JG(n){switch(n){case ae.OK:return Re(64938);case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return Re(15467,{code:n})}}function e7(n){if(n===void 0)return Ei("GRPC error has no .code"),ae.UNKNOWN;switch(n){case Kt.OK:return ae.OK;case Kt.CANCELLED:return ae.CANCELLED;case Kt.UNKNOWN:return ae.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return ae.INTERNAL;case Kt.UNAVAILABLE:return ae.UNAVAILABLE;case Kt.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case Kt.NOT_FOUND:return ae.NOT_FOUND;case Kt.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case Kt.ABORTED:return ae.ABORTED;case Kt.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case Kt.DATA_LOSS:return ae.DATA_LOSS;default:return Re(39323,{code:n})}}(Ze=Kt||(Kt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";new rw([4294967295,4294967295],0);const t7={asc:"ASCENDING",desc:"DESCENDING"},n7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},i7={and:"AND",or:"OR"};class r7{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function s7(n,e){return n.useProto3Json||ny(e)?e:{value:e}}function cx(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function o7(n,e){return cx(n,e.toTimestamp())}function Sr(n){return De(!!n,49232),Qe.fromTimestamp((function(t){const i=ia(t);return new Pt(i.seconds,i.nanos)})(n))}function NN(n,e){return ux(n,e).canonicalString()}function ux(n,e){const t=(function(r){return new Ct(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function DN(n){const e=Ct.fromString(n);return De(m7(e),10190,{key:e.toString()}),e}function hm(n,e){return NN(n.databaseId,e.path)}function _p(n,e){const t=DN(e);if(t.get(1)!==n.databaseId.projectId)throw new Se(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Se(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee(ON(t))}function MN(n,e){return NN(n.databaseId,e)}function LN(n){const e=DN(n);return e.length===4?Ct.emptyPath():ON(e)}function a7(n){return new Ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ON(n){return De(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function LR(n,e,t){return{name:hm(n,e),fields:t.value.mapValue.fields}}function l7(n,e,t){const i=_p(n,e.name),r=Sr(e.updateTime),s=e.createTime?Sr(e.createTime):Qe.min(),o=new yr({mapValue:{fields:e.fields}}),l=Tn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function dm(n,e){let t;if(e instanceof vf)t={update:LR(n,e.key,e.value)};else if(e instanceof mw)t={delete:hm(n,e.key)};else if(e instanceof Lu)t={update:LR(n,e.key,e.data),updateMask:p7(e.fieldMask)};else{if(!(e instanceof kN))return Re(16599,{Vt:e.type});t={verify:hm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof $d)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Cu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ru)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Kd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Re(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:o7(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Re(27497)})(n,e.precondition)),t}function hx(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?xr.updateTime(Sr(s.updateTime)):s.exists!==void 0?xr.exists(s.exists):xr.none()})(e.currentDocument):xr.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let u=null;if("setToServerValue"in l)De(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new $d;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new Cu(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Ru(f)}else"increment"in l?u=new Kd(o,l.increment):Re(16584,{proto:l});const h=Bt.fromServerFormat(l.fieldPath);return new qG(h,u)})(n,r))):[];if(e.update){e.update.name;const r=_p(n,e.update.name),s=new yr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new js(h.map((f=>Bt.fromServerFormat(f))))})(e.updateMask);return new Lu(r,s,o,t,i)}return new vf(r,s,t,i)}if(e.delete){const r=_p(n,e.delete);return new mw(r,t)}if(e.verify){const r=_p(n,e.verify);return new kN(r,t)}return Re(1463,{proto:e})}function c7(n,e){return n&&n.length>0?(De(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Sr(r.updateTime):Sr(s);return o.isEqual(Qe.min())&&(o=Sr(s)),new ZG(o,r.transformResults||[])})(t,e)))):[]}function u7(n,e){return{documents:[MN(n,e.path)]}}function h7(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=MN(n,r);const s=(function(h){if(h.length!==0)return jN(gt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(y){return{field:Oc(y.field),direction:d7(y.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=s7(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function FN(n){let e=LN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){De(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(p){const y=VN(p);return y instanceof gt&&pw(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((y=>(function(S){return new cm(Fc(S.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(y)))})(t.orderBy));let l=null;t.limit&&(l=(function(p){let y;return y=typeof p=="object"?p.value:p,ny(y)?null:y})(t.limit));let u=null;t.startAt&&(u=(function(p){const y=!!p.before,x=p.values||[];return new Su(x,y)})(t.startAt));let h=null;return t.endAt&&(h=(function(p){const y=!p.before,x=p.values||[];return new Su(x,y)})(t.endAt)),DG(e,r,o,s,l,"F",u,h)}function VN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Fc(t.unaryFilter.field);return Ye.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Fc(t.unaryFilter.field);return Ye.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Fc(t.unaryFilter.field);return Ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fc(t.unaryFilter.field);return Ye.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Re(61313);default:return Re(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ye.create(Fc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Re(58110);default:return Re(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return gt.create(t.compositeFilter.filters.map((i=>VN(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Re(1026)}})(t.compositeFilter.op))})(n):Re(30097,{filter:n})}function d7(n){return t7[n]}function f7(n){return n7[n]}function g7(n){return i7[n]}function Oc(n){return{fieldPath:n.canonicalString()}}function Fc(n){return Bt.fromServerFormat(n.fieldPath)}function jN(n){return n instanceof Ye?(function(t){if(t.op==="=="){if(TR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NAN"}};if(ER(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(TR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NOT_NAN"}};if(ER(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oc(t.field),op:f7(t.op),value:t.value}}})(n):n instanceof gt?(function(t){const i=t.getFilters().map((r=>jN(r)));return i.length===1?i[0]:{compositeFilter:{op:g7(t.op),filters:i}}})(n):Re(54877,{filter:n})}function p7(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function m7(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Kc{constructor(e,t,i,r,s=Qe.min(),o=Qe.min(),l=ci.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Kc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class zN{constructor(e){this.yt=e}}function y7(n,e){let t;if(e.document)t=l7(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Ee.fromSegments(e.noDocument.path),r=Cl(e.noDocument.readTime);t=Tn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Re(56709);{const i=Ee.fromSegments(e.unknownDocument.path),r=Cl(e.unknownDocument.version);t=Tn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new Pt(r[0],r[1]);return Qe.fromTimestamp(s)})(e.readTime)),t}function OR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:fm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:hm(s,o.key),fields:o.data.value.mapValue.fields,updateTime:cx(s,o.version.toTimestamp()),createTime:cx(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Il(e.version)};else{if(!e.isUnknownDocument())return Re(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Il(e.version)}}return i}function fm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Il(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Cl(n){const e=new Pt(n.seconds,n.nanoseconds);return Qe.fromTimestamp(e)}function Ha(n,e){const t=(e.baseMutations||[]).map((s=>hx(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>hx(n.yt,s))),r=Pt.fromMillis(e.localWriteTimeMs);return new yw(e.batchId,r,t,i)}function Xh(n){const e=Cl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Cl(n.lastLimboFreeSnapshotVersion):Qe.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return De(o===1,1966,{count:o}),$s(wN(LN(s.documents[0])))})(n.query):(function(s){return $s(FN(s))})(n.query),new Kc(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ci.fromBase64String(n.resumeToken))}function UN(n,e){const t=Il(e.snapshotVersion),i=Il(e.lastLimboFreeSnapshotVersion);let r;r=NG(e.target)?u7(n.yt,e.target):h7(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Sl(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function BN(n){const e=FN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?lx(e,e.limit,"L"):e}function H0(n,e){return new vw(e.largestBatchId,hx(n.yt,e.overlayMutation))}function FR(n,e){const t=e.path.lastSegment();return[n,Gn(e.path.popLast()),t]}function VR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Il(i.readTime),documentKey:Gn(i.documentKey.path),largestBatchId:i.largestBatchId}}class _7{getBundleMetadata(e,t){return jR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Cl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return jR(e).put((function(r){return{bundleId:r.id,createTime:Il(Sr(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return zR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:BN(s.bundledQuery),readTime:Cl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return zR(e).put((function(r){return{name:r.name,readTime:Il(Sr(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function jR(n){return tn(n,iy)}function zR(n){return tn(n,ry)}class hy{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new hy(e,i)}getOverlay(e,t){return Nh(e).get(FR(this.userId,t)).next((i=>i?H0(this.serializer,i):null))}getOverlays(e,t){const i=es();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new vw(t,o);r.push(this.St(e,l))})),Z.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Gn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Nh(e).Z(tx,l))})),Z.waitFor(s)}getOverlaysForCollection(e,t,i){const r=es(),s=Gn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Nh(e).J(tx,o).next((l=>{for(const u of l){const h=H0(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=es();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Nh(e).ee({index:Jk,range:l},((u,h,f)=>{const p=H0(this.serializer,h);s.size()<r||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Nh(e).put((function(r,s,o){const[l,u,h]=FR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:dm(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Nh(n){return tn(n,sy)}class v7{bt(e){return tn(e,uw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?ci.fromUint8Array(i):ci.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Xa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ht(e.integerValue));else if("doubleValue"in e){const i=Ht(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),nm(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ia(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(xu(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?dN(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):oy(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Re(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=lm,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ht(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ee.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Xa.Kt=new Xa;const Rc=255;function x7(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function UR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=x7(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class w7{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=UR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=UR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Rc),this.sn(255)}_n(){this.an(Rc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Rc?(this.sn(Rc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Rc?(this.an(Rc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class E7{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class T7{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Dh{constructor(){this.cn=new w7,this.ln=new E7(this.cn),this.hn=new T7(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class qa{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new qa(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:vp(this.En),directionalValue:vp(this.dn),orderedDocumentKey:vp(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function No(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=BR(n.En,e.En),t!==0?t:(t=BR(n.dn,e.dn),t!==0?t:Ee.comparator(n.In,e.In)))}function BR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function vp(n){return ZP()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function GR(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class WR{constructor(e){this.mn=new mt(((t,i)=>Bt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(De(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Qv(e);if(t!==void 0&&!this.wn(t))return!1;const i=Ga(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=i[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new mt(Bt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new fp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new fp(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new fp(i.field,i.dir==="asc"?0:1)));return new tm(tm.UNKNOWN_ID,this.collectionId,t,jd.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function GN(n){if(De(n instanceof Ye||n instanceof gt,20012),n instanceof Ye){if(n instanceof xN){const t=n.value.arrayValue?.values?.map((i=>Ye.create(n.field,"==",i)))||[];return gt.create(t,"or")}return n}const e=n.filters.map((t=>GN(t)));return gt.create(e,n.op)}function S7(n){if(n.getFilters().length===0)return[];const e=gx(GN(n));return De(WN(e),7391),dx(e)||fx(e)?[e]:e.getFilters()}function dx(n){return n instanceof Ye}function fx(n){return n instanceof gt&&pw(n)}function WN(n){return dx(n)||fx(n)||(function(t){if(t instanceof gt&&sx(t)){for(const i of t.getFilters())if(!dx(i)&&!fx(i))return!1;return!0}return!1})(n)}function gx(n){if(De(n instanceof Ye||n instanceof gt,34018),n instanceof Ye)return n;if(n.filters.length===1)return gx(n.filters[0]);const e=n.filters.map((i=>gx(i)));let t=gt.create(e,n.op);return t=gm(t),WN(t)?t:(De(t instanceof gt,64498),De(Iu(t),40251),De(t.filters.length>1,57927),t.filters.reduce(((i,r)=>xw(i,r))))}function xw(n,e){let t;return De(n instanceof Ye||n instanceof gt,38388),De(e instanceof Ye||e instanceof gt,25473),t=n instanceof Ye?e instanceof Ye?(function(r,s){return gt.create([r,s],"and")})(n,e):$R(n,e):e instanceof Ye?$R(e,n):(function(r,s){if(De(r.filters.length>0&&s.filters.length>0,48005),Iu(r)&&Iu(s))return yN(r,s.getFilters());const o=sx(r)?r:s,l=sx(r)?s:r,u=o.filters.map((h=>xw(h,l)));return gt.create(u,"or")})(n,e),gm(t)}function $R(n,e){if(Iu(e))return yN(e,n.getFilters());{const t=e.filters.map((i=>xw(n,i)));return gt.create(t,"or")}}function gm(n){if(De(n instanceof Ye||n instanceof gt,11850),n instanceof Ye)return n;const e=n.getFilters();if(e.length===1)return gm(e[0]);if(pN(n))return n;const t=e.map((r=>gm(r))),i=[];return t.forEach((r=>{r instanceof Ye?i.push(r):r instanceof gt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:gt.create(i,n.op)}class I7{constructor(){this.Cn=new ww}addToCollectionParentIndex(e,t){return this.Cn.add(t),Z.resolve()}getCollectionParents(e,t){return Z.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Z.resolve()}deleteFieldIndex(e,t){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,t){return Z.resolve()}getDocumentsMatchingTarget(e,t){return Z.resolve(null)}getIndexType(e,t){return Z.resolve(0)}getFieldIndexes(e,t){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,t){return Z.resolve(Ai.min())}getMinOffsetFromCollectionGroup(e,t){return Z.resolve(Ai.min())}updateCollectionGroup(e,t,i){return Z.resolve()}updateIndexEntries(e,t){return Z.resolve()}}class ww{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new mt(Ct.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new mt(Ct.comparator)).toArray()}}const KR="IndexedDbIndexManager",Yg=new Uint8Array(0);class C7{constructor(e,t){this.databaseId=t,this.vn=new ww,this.Fn=new la((i=>Sl(i)),((i,r)=>_f(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Gn(r)};return HR(e).put(s)}return Z.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[Bk(t),""],!1,!0);return HR(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Jr(o.parent))}return i}))}addFieldIndex(e,t){const i=Mh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=bc(e);return s.next((l=>{o.put(VR(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Mh(e),r=bc(e),s=Ac(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Mh(e),i=Ac(e),r=bc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Z.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new WR(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Ac(e);let r=!0;const s=new Map;return Z.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=Sn();const l=[];return Z.forEach(s,((u,h)=>{fe(KR,`Using index ${(function(N){return`id=${N.indexId}|cg=${N.collectionGroup}|f=${N.fields.map((M=>`${M.fieldPath}:${M.kind}`)).join(",")}`})(u)} to execute ${Sl(t)}`);const f=(function(N,M){const F=Qv(M);if(F===void 0)return null;for(const U of um(N,F.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null})(h,u),p=(function(N,M){const F=new Map;for(const U of Ga(M))for(const P of um(N,U.fieldPath))switch(P.op){case"==":case"in":F.set(U.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return F.set(U.fieldPath.canonicalString(),P.value),Array.from(F.values())}return null})(h,u),y=(function(N,M){const F=[];let U=!0;for(const P of Ga(M)){const A=P.kind===0?AR(N,P.fieldPath,N.startAt):bR(N,P.fieldPath,N.startAt);F.push(A.value),U&&(U=A.inclusive)}return new Su(F,U)})(h,u),x=(function(N,M){const F=[];let U=!0;for(const P of Ga(M)){const A=P.kind===0?bR(N,P.fieldPath,N.endAt):AR(N,P.fieldPath,N.endAt);F.push(A.value),U&&(U=A.inclusive)}return new Su(F,U)})(h,u),S=this.On(u,h,y),I=this.On(u,h,x),T=this.Nn(u,h,p),R=this.Bn(u.indexId,f,S,y.inclusive,I,x.inclusive,T);return Z.forEach(R,(k=>i.Y(k,t.limit).next((N=>{N.forEach((M=>{const F=Ee.fromSegments(M.documentKey);o.has(F)||(o=o.add(F),l.push(F))}))}))))})).next((()=>l))}return Z.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=S7(gt.create(e.filters,"and")).map((i=>ax(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let p=0;p<u;++p){const y=t?this.Ln(t[p/h]):Yg,x=this.kn(e,y,i[p%h],r),S=this.qn(e,y,s[p%h],o),I=l.map((T=>this.kn(e,y,T,!0)));f.push(...this.createRange(x,S,I))}return f}kn(e,t,i,r){const s=new qa(e,Ee.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new qa(e,Ee.empty(),t,i);return r?s.An():s}xn(e,t){const i=new WR(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Z.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new mt(Bt.comparator),f=!1;for(const p of u.filters)for(const y of p.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?f=!0:h=h.add(y.field));for(const p of u.orderBy)p.field.isKeyField()||(h=h.add(p.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Dh;for(const r of Ga(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);Xa.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Dh;return Xa.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Dh;return Xa.Kt.Dt(gw(this.databaseId,t),i.Pn((function(s){const o=Ga(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Dh);let s=0;for(const o of Ga(e)){const l=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&Wd(l))r=this.Kn(r,o,l);else{const h=u.Pn(o.kind);Xa.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const u=new Dh;u.seed(l.un()),Xa.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof Ye&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Mh(e),r=bc(e);return(t?i.J(ex,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Z.forEach(s,(l=>r.get([l.indexId,this.uid]).next((u=>{o.push((function(f,p){const y=p?new jd(p.sequenceNumber,new Ai(Cl(p.readTime),new Ee(Jr(p.documentKey)),p.largestBatchId)):jd.empty(),x=f.fields.map((([S,I])=>new fp(Bt.fromServerFormat(S),I)));return new tm(f.indexId,f.collectionGroup,x,y)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:Ke(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Mh(e),s=bc(e);return this.Gn(e).next((o=>r.J(ex,IDBKeyRange.bound(t,t)).next((l=>Z.forEach(l,(u=>s.put(VR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Z.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Z.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),Z.forEach(l,(u=>this.zn(e,r,u).next((h=>{const f=this.jn(s,u);return h.isEqual(f)?Z.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,i,r){return Ac(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Ac(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Ac(e);let s=new mt(No);return r.ee({index:Qk,range:IDBKeyRange.only([i.indexId,this.uid,vp(this.$n(i,t))])},((o,l)=>{s=s.add(new qa(i.indexId,t,GR(l.arrayValue),GR(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new mt(No);const r=this.Qn(t,e);if(r==null)return i;const s=Qv(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Wd(o))for(const l of o.arrayValue.values||[])i=i.add(new qa(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new qa(t.indexId,e.key,Yg,r));return i}Jn(e,t,i,r,s){fe(KR,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,f,p,y){const x=u.getIterator(),S=h.getIterator();let I=Cc(x),T=Cc(S);for(;I||T;){let R=!1,k=!1;if(I&&T){const N=f(I,T);N<0?k=!0:N>0&&(R=!0)}else I!=null?k=!0:R=!0;R?(p(T),T=Cc(S)):k?(y(I),I=Cc(x)):(I=Cc(x),T=Cc(S))}})(r,s,No,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),Z.waitFor(o)}Gn(e){let t=1;return bc(e).ee({index:Zk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>No(o,l))).filter(((o,l,u)=>!l||No(o,u[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=No(o,e),u=No(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,Yg,Ee.empty()),u=r[o+1].Vn(this.uid,Yg,Ee.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return No(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(XR)}getMinOffset(e,t){return Z.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Re(44426))))).next(XR)}}function HR(n){return tn(n,Bd)}function Ac(n){return tn(n,od)}function Mh(n){return tn(n,cw)}function bc(n){return tn(n,sd)}function XR(n){De(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;ow(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ai(e.readTime,e.documentKey,t)}const qR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$N=41943040;class Jn{static withCacheSize(e){return new Jn(e,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function KN(n,e,t){const i=n.store(fr),r=n.store(mu),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.ee({range:o},((f,p,y)=>(l++,y.delete())));s.push(u.next((()=>{De(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const p=Xk(e,f.key.path,t.batchId);s.push(r.delete(p)),h.push(f.key)}return Z.waitFor(s).next((()=>h))}function pm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Re(14731);e=n.noDocument}return JSON.stringify(e).length}Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn($N,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);class dy{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){De(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new dy(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).ee({index:nl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Vc(e),o=Do(e);return o.add({}).next((l=>{De(typeof l=="number",49019);const u=new yw(l,t,i,r),h=(function(x,S,I){const T=I.baseMutations.map((k=>dm(x.yt,k))),R=I.mutations.map((k=>dm(x.yt,k)));return{userId:S,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:T,mutations:R}})(this.serializer,this.userId,u),f=[];let p=new mt(((y,x)=>Ke(y.canonicalString(),x.canonicalString())));for(const y of r){const x=Xk(this.userId,y.key.path,l);p=p.add(y.key.path.popLast()),f.push(o.put(h)),f.push(s.put(x,X8))}return p.forEach((y=>{f.push(this.indexManager.addToCollectionParentIndex(e,y))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),Z.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return Do(e).get(t).next((i=>i?(De(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Ha(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Z.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Do(e).ee({index:nl,range:r},((o,l,u)=>{l.userId===this.userId&&(De(l.batchId>=i,47524,{tr:i}),s=Ha(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=cl;return Do(e).ee({index:nl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,cl],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).J(nl,t).next((i=>i.map((r=>Ha(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=gp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Vc(e).ee({range:r},((o,l,u)=>{const[h,f,p]=o,y=Jr(f);if(h===this.userId&&t.path.isEqual(y))return Do(e).get(p).next((x=>{if(!x)throw Re(61480,{nr:o,batchId:p});De(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:p}),s.push(Ha(this.serializer,x))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt(Ke);const r=[];return t.forEach((s=>{const o=gp(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=Vc(e).ee({range:l},((h,f,p)=>{const[y,x,S]=h,I=Jr(x);y===this.userId&&s.path.isEqual(I)?i=i.add(S):p.done()}));r.push(u)})),Z.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=gp(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new mt(Ke);return Vc(e).ee({range:o},((u,h,f)=>{const[p,y,x]=u,S=Jr(y);p===this.userId&&i.isPrefixOf(S)?S.length===r&&(l=l.add(x)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(Do(e).get(s).next((o=>{if(o===null)throw Re(35274,{batchId:s});De(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Ha(this.serializer,o))})))})),Z.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return KN(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Z.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Z.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Vc(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const u=Jr(s[1]);r.push(u)}else l.done()})).next((()=>{De(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return HN(e,this.userId,t)}_r(e){return XN(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:cl,lastStreamToken:""}))}}function HN(n,e,t){const i=gp(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Vc(n).ee({range:s,X:!0},((l,u,h)=>{const[f,p,y]=l;f===e&&p===r&&(o=!0),h.done()})).next((()=>o))}function Do(n){return tn(n,fr)}function Vc(n){return tn(n,mu)}function XN(n){return tn(n,zd)}class Rl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Rl(0)}static cr(){return new Rl(-1)}}class R7{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Rl(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Qe.fromTimestamp(new Pt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Pc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(De(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return Pc(e).ee(((o,l)=>{const u=Xh(l);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>Z.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Pc(e).ee(((i,r)=>{const s=Xh(r);t(s)}))}lr(e){return YR(e).get(sm).next((t=>(De(t!==null,2888),t)))}hr(e,t){return YR(e).put(sm,t)}Pr(e,t){return Pc(e).put(UN(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Sl(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Pc(e).ee({range:r,index:Yk},((o,l,u)=>{const h=Xh(l);_f(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Bo(e);return t.forEach((o=>{const l=Gn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),Z.waitFor(r)}removeMatchingKeys(e,t,i){const r=Bo(e);return Z.forEach(t,(s=>{const o=Gn(s.path);return Z.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Bo(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Bo(e);let s=Sn();return r.ee({range:i,X:!0},((o,l,u)=>{const h=Jr(o[1]),f=new Ee(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Gn(t.path),r=IDBKeyRange.bound([i],[Bk(i)],!1,!0);let s=0;return Bo(e).ee({index:lw,X:!0,range:r},(([o,l],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return Pc(e).get(t).next((i=>i?Xh(i):null))}}function Pc(n){return tn(n,yu)}function YR(n){return tn(n,ul)}function Bo(n){return tn(n,_u)}const ZR="LruGarbageCollector",A7=1048576;function QR([n,e],[t,i]){const r=Ke(n,t);return r===0?Ke(e,i):r}class b7{constructor(e){this.Ir=e,this.buffer=new mt(QR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();QR(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class P7{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){fe(ZR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ll(t)?fe(ZR,"Ignoring IndexedDB error during garbage collection: ",t):await ey(t)}await this.Vr(3e5)}))}}class k7{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Z.resolve(vr.ce);const i=new b7(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(qR)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),r=this.params.maximumSequenceNumbersToCollect):r=p,o=Date.now(),this.nthSequenceNumber(e,r)))).next((p=>(i=p,l=Date.now(),this.removeTargets(e,i,t)))).next((p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((p=>(h=Date.now(),Lc()<=He.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:p}))))}}function N7(n,e){return new k7(n,e)}class D7{constructor(e,t){this.db=e,this.garbageCollector=N7(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return Zg(e,i)}removeReference(e,t,i){return Zg(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Zg(e,t)}br(e,t){return(function(r,s){let o=!1;return XN(r).te((l=>HN(r,l,s).next((u=>(u&&(o=!0),Z.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Qe.min()),Bo(e).delete((function(p){return[0,Gn(p.path)]})(o)))))}));r.push(u)}})).next((()=>Z.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Zg(e,t)}Sr(e,t){const i=Bo(e);let r,s=vr.ce;return i.ee({index:lw},(([o,l],{path:u,sequenceNumber:h})=>{o===0?(s!==vr.ce&&t(new Ee(Jr(r)),s),s=h,r=u):s=vr.ce})).next((()=>{s!==vr.ce&&t(new Ee(Jr(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Zg(n,e){return Bo(n).put((function(i,r){return{targetId:0,path:Gn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class qN{constructor(){this.changes=new la((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Z.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class M7{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Fa(e).put(i)}removeEntry(e,t,i){return Fa(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],fm(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Tn.newInvalidDocument(t);return Fa(e).ee({index:pp,range:IDBKeyRange.only(Lh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Tn.newInvalidDocument(t)};return Fa(e).ee({index:pp,range:IDBKeyRange.only(Lh(t))},((r,s)=>{i={document:this.Cr(t,s),size:pm(s)}})).next((()=>i))}getEntries(e,t){let i=il();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=il(),r=new li(Ee.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,pm(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Z.resolve();let r=new mt(tA);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Lh(r.first()),Lh(r.last())),o=r.getIterator();let l=o.getNext();return Fa(e).ee({index:pp,range:s},((u,h,f)=>{const p=Ee.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&tA(l,p)<0;)i(l,null),l=o.getNext();l&&l.isEqual(p)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Lh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),fm(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fa(e).J(IDBKeyRange.bound(l,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=il();for(const p of h){const y=this.Cr(Ee.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);y.isFoundDocument()&&(ly(t,y)||r.has(y.key))&&(f=f.insert(y.key,y))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=il();const o=eA(t,i),l=eA(t,Ai.max());return Fa(e).ee({index:qk,range:IDBKeyRange.bound(o,l,!0)},((u,h,f)=>{const p=this.Cr(Ee.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(p.key,p),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new L7(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return JR(e).get(Jv).next((t=>(De(!!t,20021),t)))}Dr(e,t){return JR(e).put(Jv,t)}Cr(e,t){if(t){const i=y7(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Qe.min())))return i}return Tn.newInvalidDocument(e)}}function YN(n){return new M7(n)}class L7 extends qN{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new la((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new mt(((s,o)=>Ke(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=OR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=pm(u);i+=h-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=l.size,this.trackRemovals){const u=OR(this.Nr.serializer,o.convertToNoDocument(Qe.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Z.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function JR(n){return tn(n,Ud)}function Fa(n){return tn(n,rm)}function Lh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function eA(n,e){const t=e.documentKey.path.toArray();return[n,fm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function tA(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=Ke(t[s],i[s]),r)return r;return r=Ke(t.length,i.length),r||(r=Ke(t[t.length-2],i[i.length-2]),r||Ke(t[t.length-1],i[i.length-1]))}class O7{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ZN{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&ud(i.mutation,r,js.empty(),Pt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Sn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Sn()){const r=es();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=qg();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=es();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Sn())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=il();const o=cd(),l=(function(){return cd()})();return t.forEach(((u,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Lu)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),ud(f.mutation,h,f.mutation.getFieldMask(),Pt.now())):o.set(h.key,js.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new O7(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=cd();let r=new li(((o,l)=>o-l)),s=Sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=i.get(u)||js.empty();f=l.applyToLocalView(h,f),i.set(u,f);const p=(r.get(l.batchId)||Sn()).add(u);r=r.insert(l.batchId,p)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,p=IN();f.forEach((y=>{if(!s.has(y)){const x=bN(t.get(y),i.get(y));x!==null&&p.set(y,x),s=s.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return Z.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):MG(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Z.resolve(es());let l=Vd,u=s;return o.next((h=>Z.forEach(h,((f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(f)?Z.resolve():this.remoteDocumentCache.getEntry(e,f).next((y=>{u=u.insert(f,y)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Sn()))).next((f=>({batchId:l,changes:jG(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next((i=>{let r=qg();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=qg();return this.indexManager.getCollectionParents(e,s).next((l=>Z.forEach(l,(u=>{const h=(function(p,y){return new ay(y,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((p,y)=>{o=o.insert(p,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Tn.newInvalidDocument(f)))}));let l=qg();return o.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&ud(f.mutation,h,js.empty(),Pt.now()),ly(t,h)&&(l=l.insert(u,h))})),l}))}}class F7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Z.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Sr(r.createTime)}})(t)),Z.resolve()}getNamedQuery(e,t){return Z.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:BN(r.bundledQuery),readTime:Sr(r.readTime)}})(t)),Z.resolve()}}class V7{constructor(){this.overlays=new li(Ee.comparator),this.qr=new Map}getOverlay(e,t){return Z.resolve(this.overlays.get(t))}getOverlays(e,t){const i=es();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Z.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Z.resolve()}getOverlaysForCollection(e,t,i){const r=es(),s=t.length+1,o=new Ee(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return Z.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new li(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=es(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=es(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return Z.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new vw(t,i));let s=this.qr.get(t);s===void 0&&(s=Sn(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class j7{constructor(){this.sessionToken=ci.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Z.resolve()}}class Ew{constructor(){this.Qr=new mt(cn.$r),this.Ur=new mt(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new cn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new cn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ee(new Ct([])),i=new cn(t,e),r=new cn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ee(new Ct([])),i=new cn(t,e),r=new cn(t,e+1);let s=Sn();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new cn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class cn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ee.comparator(e.key,t.key)||Ke(e.Yr,t.Yr)}static Kr(e,t){return Ke(e.Yr,t.Yr)||Ee.comparator(e.key,t.key)}}class z7{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new mt(cn.$r)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new yw(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new cn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Z.resolve(o)}lookupMutationBatch(e,t){return Z.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?cl:this.tr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new cn(t,0),r=new cn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),Z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt(Ke);return t.forEach((r=>{const s=new cn(r,0),o=new cn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),Z.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Ee.isDocumentKey(s)||(s=s.child(""));const o=new cn(new Ee(s),0);let l=new mt(Ke);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(u.Yr)),!0)}),o),Z.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){De(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Z.forEach(t.mutations,(r=>{const s=new cn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new cn(t,0),r=this.Zr.firstAfterOrEqual(i);return Z.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class U7{constructor(e){this.ri=e,this.docs=(function(){return new li(Ee.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Z.resolve(i?i.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let i=il();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Tn.newInvalidDocument(r))})),Z.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=il();const o=t.path,l=new Ee(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||ow(Wk(f),i)<=0||(r.has(f.key)||ly(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Z.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Re(9500)}ii(e,t){return Z.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new B7(this)}getSize(e){return Z.resolve(this.size)}}class B7 extends qN{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Z.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class G7{constructor(e){this.persistence=e,this.si=new la((t=>Sl(t)),_f),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.oi=0,this._i=new Ew,this.targetCount=0,this.ai=Rl.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Z.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Rl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Z.resolve()}updateTargetData(e,t){return this.Pr(t),Z.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),Z.waitFor(s).next((()=>r))}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Z.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Z.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Z.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Z.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Z.resolve(i)}containsKey(e,t){return Z.resolve(this._i.containsKey(t))}}class QN{constructor(e,t){this.ui={},this.overlays={},this.ci=new vr(0),this.li=!1,this.li=!0,this.hi=new j7,this.referenceDelegate=e(this),this.Pi=new G7(this),this.indexManager=new I7,this.remoteDocumentCache=(function(r){return new U7(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new zN(t),this.Ii=new F7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new V7,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new z7(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe("MemoryPersistence","Starting transaction:",e);const r=new W7(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Z.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class W7 extends Kk{constructor(e){super(),this.currentSequenceNumber=e}}class fy{constructor(e){this.persistence=e,this.Ri=new Ew,this.Vi=null}static mi(e){return new fy(e)}get fi(){if(this.Vi)return this.Vi;throw Re(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Z.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Z.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Z.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.fi,(i=>{const r=Ee.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Qe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Z.or([()=>Z.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class $7{constructor(e){this.serializer=e}k(e,t,i,r){const s=new ty("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(yf)})(e),(function(u){u.createObjectStore(zd,{keyPath:H8}),u.createObjectStore(fr,{keyPath:mR,autoIncrement:!0}).createIndex(nl,yR,{unique:!0}),u.createObjectStore(mu)})(e),nA(e),(function(u){u.createObjectStore(Wa)})(e));let o=Z.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(_u),u.deleteObjectStore(yu),u.deleteObjectStore(ul)})(e),nA(e)),o=o.next((()=>(function(u){const h=u.store(ul),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Qe.min().toTimestamp(),targetCount:0};return h.put(sm,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(fr).J().next((p=>{u.deleteObjectStore(fr),u.createObjectStore(fr,{keyPath:mR,autoIncrement:!0}).createIndex(nl,yR,{unique:!0});const y=h.store(fr),x=p.map((S=>y.put(S)));return Z.waitFor(x)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(vu,{keyPath:nG})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Ud)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(iy,{keyPath:iG})})(e),(function(u){u.createObjectStore(ry,{keyPath:rG})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(sy,{keyPath:hG});h.createIndex(tx,dG,{unique:!1}),h.createIndex(Jk,fG,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(rm,{keyPath:q8});h.createIndex(pp,Y8),h.createIndex(qk,Z8)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Wa)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(cw,{keyPath:sG,autoIncrement:!0}).createIndex(ex,oG,{unique:!1}),u.createObjectStore(sd,{keyPath:aG}).createIndex(Zk,lG,{unique:!1}),u.createObjectStore(od,{keyPath:cG}).createIndex(Qk,uG,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(sd).clear()})).next((()=>{t.objectStore(od).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(uw,{keyPath:gG})})(e)}))),i<18&&r>=18&&ZP()&&(o=o.next((()=>{t.objectStore(sd).clear()})).next((()=>{t.objectStore(od).clear()}))),o}wi(e){let t=0;return e.store(Wa).ee(((i,r)=>{t+=pm(r)})).next((()=>{const i={byteSize:t};return e.store(Ud).put(Jv,i)}))}yi(e){const t=e.store(zd),i=e.store(fr);return t.J().next((r=>Z.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,cl],[s.userId,s.lastAcknowledgedBatchId]);return i.J(nl,o).next((l=>Z.forEach(l,(u=>{De(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=Ha(this.serializer,u);return KN(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(_u),i=e.store(Wa);return e.store(ul).get(sm).next((r=>{const s=[];return i.ee(((o,l)=>{const u=new Ct(o),h=(function(p){return[0,Gn(p)]})(u);s.push(t.get(h).next((f=>f?Z.resolve():(p=>t.put({targetId:0,path:Gn(p),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>Z.waitFor(s)))}))}bi(e,t){e.createObjectStore(Bd,{keyPath:tG});const i=t.store(Bd),r=new ww,s=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:Gn(u)})}};return t.store(Wa).ee({X:!0},((o,l)=>{const u=new Ct(o);return s(u.popLast())})).next((()=>t.store(mu).ee({X:!0},(([o,l,u],h)=>{const f=Jr(l);return s(f.popLast())}))))}Di(e){const t=e.store(yu);return t.ee(((i,r)=>{const s=Xh(r),o=UN(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(Wa),r=[];return i.ee(((s,o)=>{const l=t.store(rm),u=(function(p){return p.document?new Ee(Ct.fromString(p.document.name).popFirst(5)):p.noDocument?Ee.fromSegments(p.noDocument.path):p.unknownDocument?Ee.fromSegments(p.unknownDocument.path):Re(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>Z.waitFor(r)))}Fi(e,t){const i=t.store(fr),r=YN(this.serializer),s=new QN(fy.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((u=>{let h=l.get(u.userId)??Sn();Ha(this.serializer,u).keys().forEach((f=>h=h.add(f))),l.set(u.userId,h)})),Z.forEach(l,((u,h)=>{const f=new wn(h),p=hy.wt(this.serializer,f),y=s.getIndexManager(f),x=dy.wt(f,this.serializer,y,s.referenceDelegate);return new ZN(r,x,p,y).recalculateAndSaveOverlaysForDocumentKeys(new nx(t,vr.ce),u).next()}))}))}}function nA(n){n.createObjectStore(_u,{keyPath:J8}).createIndex(lw,eG,{unique:!0}),n.createObjectStore(yu,{keyPath:"targetId"}).createIndex(Yk,Q8,{unique:!0}),n.createObjectStore(ul)}const Mo="IndexedDbPersistence",X0=18e5,q0=5e3,Y0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",K7="main";class Tw{constructor(e,t,i,r,s,o,l,u,h,f,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=y=>Promise.resolve(),!Tw.v())throw new Se(ae.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new D7(this,r),this.$i=t+K7,this.serializer=new zN(u),this.Ui=new Qo(this.$i,this.Ni,new $7(this.serializer)),this.hi=new v7,this.Pi=new R7(this.referenceDelegate,this.serializer),this.remoteDocumentCache=YN(this.serializer),this.Ii=new _7,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&Ei(Mo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Se(ae.FAILED_PRECONDITION,Y0);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new vr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Qg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ll(e))return fe(Mo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe(Mo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Oh(e).get(Ic).next((t=>Z.resolve(this.es(t))))}ts(e){return Qg(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,X0)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=tn(t,vu);return i.J().next((r=>{const s=this.ss(r,X0),o=r.filter((l=>s.indexOf(l)===-1));return Z.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Z.resolve(!0):Oh(e).get(Ic).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,q0)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Se(ae.FAILED_PRECONDITION,Y0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Qg(e).J().next((i=>this.ss(i,q0).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&fe(Mo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[yf,vu],(e=>{const t=new nx(e,vr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Qg(e).J().next((t=>this.ss(t,X0).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return dy.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new C7(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return hy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe(Mo,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?yG:u===17?iN:u===16?mG:u===15?hw:u===14?nN:u===13?tN:u===12?pG:u===11?eN:void Re(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new nx(l,this.ci?this.ci.next():vr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Ei(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Se(ae.FAILED_PRECONDITION,$k);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return Oh(e).get(Ic).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,q0)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Se(ae.FAILED_PRECONDITION,Y0)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Oh(e).put(Ic,t)}static v(){return Qo.v()}Zi(e){const t=Oh(e);return t.get(Ic).next((i=>this.es(i)?(fe(Mo,"Releasing primary lease."),t.delete(Ic)):Z.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Ei(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;YP()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return fe(Mo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ei(Mo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ei("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Oh(n){return tn(n,yf)}function Qg(n){return tn(n,vu)}function H7(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Sw{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Sn(),r=Sn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Sw(e,t.fromCache,i,r)}}class X7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class JN{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return YP()?8:Hk(en())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new X7;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Lc()<=He.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",kh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Z.resolve()):(Lc()<=He.DEBUG&&fe("QueryEngine","Query:",kh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Lc()<=He.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",kh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$s(t))):Z.resolve())}ys(e,t){if(PR(t))return Z.resolve(null);let i=$s(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=lx(t,null,"F"),i=$s(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Sn(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,l);return this.Cs(t,h,o,u.readTime)?this.ys(e,lx(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return PR(t)||r.isEqual(Qe.min())?Z.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Z.resolve(null):(Lc()<=He.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),kh(t)),this.vs(e,o,t,U8(r,Vd)).next((l=>l)))}))}Ds(e,t){let i=new mt(OG(e));return t.forEach(((r,s)=>{ly(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Lc()<=He.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",kh(t)),this.ps.getDocumentsMatchingQuery(e,t,Ai.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const q7="LocalStore";class Y7{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new li(Ke),this.xs=new la((s=>Sl(s)),_f),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZN(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function eD(n,e,t,i){return new Y7(n,e,t,i)}async function Z7(n,e){const t=Tt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let u=Sn();for(const h of r){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function Q7(n,e){const t=Tt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,f){const p=h.batch,y=p.keys();let x=Z.resolve();return y.forEach((S=>{x=x.next((()=>f.getEntry(u,S))).next((I=>{const T=h.docVersions.get(S);De(T!==null,48541),I.version.compareTo(T)<0&&(p.applyToRemoteDocument(I,h),I.isValidDocument()&&(I.setReadTime(h.commitVersion),f.addEntry(I)))}))})),x.next((()=>l.mutationQueue.removeMutationBatch(u,p)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let u=Sn();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function J7(n){const e=Tt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function eW(n,e){const t=Tt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=cl),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class iA{constructor(){this.activeTargetIds=GG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tD{constructor(){this.Mo=new iA,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new iA,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class tW{Oo(e){}shutdown(){}}const rA="ConnectivityMonitor";class sA{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){fe(rA,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){fe(rA,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Jg=null;function px(){return Jg===null?Jg=(function(){return 268435456+Math.round(2147483648*Math.random())})():Jg++,"0x"+Jg.toString(16)}const Z0="RestConnection",nW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class iW{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===am?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=px(),l=this.zo(e,t.toUriEncodedString());fe(Z0,`Sending RPC '${e}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(l),f=Dl(h);return this.Jo(e,l,u,i,f).then((p=>(fe(Z0,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw Jm(Z0,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",i),p}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=nW[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class rW{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const kn="WebChannelConnection";class sW extends iW{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=px();return new Promise(((l,u)=>{const h=new Mk;h.setWithCredentials(!0),h.listenOnce(Lk.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case dp.NO_ERROR:const p=h.getResponseJson();fe(kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case dp.TIMEOUT:fe(kn,`RPC '${e}' ${o} timed out`),u(new Se(ae.DEADLINE_EXCEEDED,"Request time out"));break;case dp.HTTP_ERROR:const y=h.getStatus();if(fe(kn,`RPC '${e}' ${o} failed with status:`,y,"response text:",h.getResponseText()),y>0){let x=h.getResponseJson();Array.isArray(x)&&(x=x[0]);const S=x?.error;if(S&&S.status&&S.message){const I=(function(R){const k=R.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(k)>=0?k:ae.UNKNOWN})(S.status);u(new Se(I,S.message))}else u(new Se(ae.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Se(ae.UNAVAILABLE,"Connection failed."));break;default:Re(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{fe(kn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);fe(kn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=px(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Vk(),l=Fk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const f=s.join("");fe(kn,`Creating RPC '${e}' stream ${r}: ${f}`,u);const p=o.createWebChannel(f,u);this.I_(p);let y=!1,x=!1;const S=new rW({Yo:T=>{x?fe(kn,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(y||(fe(kn,`Opening RPC '${e}' stream ${r} transport.`),p.open(),y=!0),fe(kn,`RPC '${e}' stream ${r} sending:`,T),p.send(T))},Zo:()=>p.close()}),I=(T,R,k)=>{T.listen(R,(N=>{try{k(N)}catch(M){setTimeout((()=>{throw M}),0)}}))};return I(p,Hh.EventType.OPEN,(()=>{x||(fe(kn,`RPC '${e}' stream ${r} transport opened.`),S.o_())})),I(p,Hh.EventType.CLOSE,(()=>{x||(x=!0,fe(kn,`RPC '${e}' stream ${r} transport closed`),S.a_(),this.E_(p))})),I(p,Hh.EventType.ERROR,(T=>{x||(x=!0,Jm(kn,`RPC '${e}' stream ${r} transport errored. Name:`,T.name,"Message:",T.message),S.a_(new Se(ae.UNAVAILABLE,"The operation could not be completed")))})),I(p,Hh.EventType.MESSAGE,(T=>{if(!x){const R=T.data[0];De(!!R,16349);const k=R,N=k?.error||k[0]?.error;if(N){fe(kn,`RPC '${e}' stream ${r} received error:`,N);const M=N.status;let F=(function(A){const D=Kt[A];if(D!==void 0)return e7(D)})(M),U=N.message;F===void 0&&(F=ae.INTERNAL,U="Unknown error status: "+M+" with message "+N.message),x=!0,S.a_(new Se(F,U)),p.close()}else fe(kn,`RPC '${e}' stream ${r} received:`,R),S.u_(R)}})),I(l,Ok.STAT_EVENT,(T=>{T.stat===Yv.PROXY?fe(kn,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===Yv.NOPROXY&&fe(kn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function oW(){return typeof window<"u"?window:null}function xp(){return typeof document<"u"?document:null}function nD(n){return new r7(n,!0)}class iD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&fe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const oA="PersistentStream";class aW{constructor(e,t,i,r,s,o,l,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new iD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ae.RESOURCE_EXHAUSTED?(Ei(t.toString()),Ei("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Se(ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return fe(oA,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(fe(oA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class lW extends aW{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return De(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,De(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){De(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=c7(e.writeResults,e.commitTime),i=Sr(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=a7(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>dm(this.serializer,i)))};this.q_(t)}}class cW{}class uW extends cW{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Se(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,ux(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Se(ae.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,ux(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Se(ae.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class hW{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ei(t),this.aa=!1):fe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const gy="RemoteStore";class dW{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{my(this)&&(fe(gy,"Restarting streams for network reachability change."),await(async function(u){const h=Tt(u);h.Ea.add(4),await py(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Iw(h)})(this))}))})),this.Ra=new hW(i,r)}}async function Iw(n){if(my(n))for(const e of n.da)await e(!0)}async function py(n){for(const e of n.da)await e(!1)}function my(n){return Tt(n).Ea.size===0}async function rD(n,e,t){if(!Ll(e))throw e;n.Ea.add(1),await py(n),n.Ra.set("Offline"),t||(t=()=>J7(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{fe(gy,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Iw(n)}))}function sD(n,e){return e().catch((t=>rD(n,t,e)))}async function yy(n){const e=Tt(n),t=sa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:cl;for(;fW(e);)try{const r=await eW(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,gW(e,r)}catch(r){await rD(e,r)}oD(e)&&aD(e)}function fW(n){return my(n)&&n.Ta.length<10}function gW(n,e){n.Ta.push(e);const t=sa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function oD(n){return my(n)&&!sa(n).x_()&&n.Ta.length>0}function aD(n){sa(n).start()}async function pW(n){sa(n).ra()}async function mW(n){const e=sa(n);for(const t of n.Ta)e.ea(t.mutations)}async function yW(n,e,t){const i=n.Ta.shift(),r=_w.from(i,e,t);await sD(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await yy(n)}async function _W(n,e){e&&sa(n).X_&&await(async function(i,r){if((function(o){return JG(o)&&o!==ae.ABORTED})(r.code)){const s=i.Ta.shift();sa(i).B_(),await sD(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await yy(i)}})(n,e),oD(n)&&aD(n)}async function vW(n,e){const t=Tt(n);e?(t.Ea.delete(2),await Iw(t)):e||(t.Ea.add(2),await py(t),t.Ra.set("Unknown"))}function sa(n){return n.fa||(n.fa=(function(t,i,r){const s=Tt(t);return s.sa(),new lW(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:pW.bind(null,n),r_:_W.bind(null,n),ta:mW.bind(null,n),na:yW.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await yy(n)):(await n.fa.stop(),n.Ta.length>0&&(fe(gy,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Cw{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new ll,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new Cw(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xW(n,e){if(Ei("AsyncQueue",`${e}: ${n}`),Ll(n))return new Se(ae.UNAVAILABLE,`${e}: ${n}`);throw n}class wW{constructor(){this.queries=aA(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Tt(t),s=r.queries;r.queries=aA(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(i)}))})(this,new Se(ae.ABORTED,"Firestore shutting down"))}}function aA(){return new la((n=>TN(n)),EN)}function EW(n){n.Ca.forEach((e=>{e.next()}))}var lA,cA;(cA=lA||(lA={})).Ma="default",cA.Cache="cache";const TW="SyncEngine";class SW{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new la((l=>TN(l)),EN),this.Iu=new Map,this.Eu=new Set,this.du=new li(Ee.comparator),this.Au=new Map,this.Ru=new Ew,this.Vu={},this.mu=new Map,this.fu=Rl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function uA(n,e,t){const i=Tt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const u=Tt(o);u.onlineState=l;let h=!1;u.queries.forEach(((f,p)=>{for(const y of p.Sa)y.va(l)&&(h=!0)})),h&&EW(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function IW(n,e){const t=Tt(n),i=e.batch.batchId;try{const r=await Q7(t.localStore,e);cD(t,i,null),lD(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Rw(t,r)}catch(r){await ey(r)}}async function CW(n,e,t){const i=Tt(n);try{const r=await(function(o,l){const u=Tt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next((p=>(De(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);cD(i,e,t),lD(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Rw(i,r)}catch(r){await ey(r)}}function lD(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function cD(n,e,t){const i=Tt(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function Rw(n,e,t){const i=Tt(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){r.push(h);const f=Sw.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const f=Tt(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>Z.forEach(h,(y=>Z.forEach(y.Es,(x=>f.persistence.referenceDelegate.addReference(p,y.targetId,x))).next((()=>Z.forEach(y.ds,(x=>f.persistence.referenceDelegate.removeReference(p,y.targetId,x)))))))))}catch(p){if(!Ll(p))throw p;fe(q7,"Failed to update sequence numbers: "+p)}for(const p of h){const y=p.targetId;if(!p.fromCache){const x=f.Ms.get(y),S=x.snapshotVersion,I=x.withLastLimboFreeSnapshotVersion(S);f.Ms=f.Ms.insert(y,I)}}})(i.localStore,s))}async function RW(n,e){const t=Tt(n);if(!t.currentUser.isEqual(e)){fe(TW,"User change. New user:",e.toKey());const i=await Z7(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new Se(ae.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Rw(t,i.Ls)}}function AW(n){const e=Tt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IW.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=CW.bind(null,e),e}class mx{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nD(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return eD(this.persistence,new JN,e.initialUser,this.serializer)}Cu(e){return new QN(fy.mi,this.serializer)}Du(e){return new tD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}mx.provider={build:()=>new mx};class bW extends mx{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await AW(this.xu.syncEngine),await yy(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return eD(this.persistence,new JN,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new P7(i,e.asyncQueue,t)}Mu(e,t){const i=new $8(t,this.persistence);return new W8(e.asyncQueue,i)}Cu(e){const t=H7(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new Tw(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,oW(),xp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new tD}}class yx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>uA(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=RW.bind(null,this.syncEngine),await vW(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new wW})()}createDatastore(e){const t=nD(e.databaseInfo.databaseId),i=(function(s){return new sW(s)})(e.databaseInfo);return(function(s,o,l,u){return new uW(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new dW(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>uA(this.syncEngine,t,0)),(function(){return sA.v()?new sA:new tW})())}createSyncEngine(e,t){return(function(r,s,o,l,u,h,f){const p=new SW(r,s,o,l,u,h);return f&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Tt(t);fe(gy,"RemoteStore shutting down."),i.Ea.add(5),await py(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}yx.provider={build:()=>new yx};const hA="FirestoreClient";class PW{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=wn.UNAUTHENTICATED,this.clientId=Uk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{fe(hA,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(fe(hA,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ll;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=xW(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function uD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const dA=new Map;const hD="firestore.googleapis.com",fA=!0;class gA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Se(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hD,this.ssl=fA}else this.host=e.host,this.ssl=e.ssl??fA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$N;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<A7)throw new Se(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}V8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uD(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dD{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new A8;switch(i.type){case"firstParty":return new N8(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Se(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=dA.get(t);i&&(fe("ComponentProvider","Removing Datastore"),dA.delete(t),i.terminate())})(this),Promise.resolve()}}function kW(n,e,t,i={}){n=Gk(n,dD);const r=Dl(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(G1(`https://${l}`),W1("Firestore",!0)),s.host!==hD&&s.host!==l&&Jm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:r,emulatorOptions:i};if(!xl(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=wn.MOCK_USER;else{h=XP(i.mockUserToken,n._app?.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new Se(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new wn(p)}n._authCredentials=new b8(new zk(h,f))}}class Aw{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Aw(this.firestore,e,this._query)}}class ts{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new bw(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ts(this.firestore,e,this._key)}toJSON(){return{type:ts._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(mf(t,ts._jsonSchema))return new ts(e,i||null,new Ee(Ct.fromString(t.referencePath)))}}ts._jsonSchemaVersion="firestore/documentReference/1.0",ts._jsonSchema={type:Xt("string",ts._jsonSchemaVersion),referencePath:Xt("string")};class bw extends Aw{constructor(e,t,i){super(e,t,wN(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ts(this.firestore,null,new Ee(e))}withConverter(e){return new bw(this.firestore,e,this._path)}}const pA="AsyncQueue";class mA{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new iD(this,"async_queue_retry"),this._c=()=>{const i=xp();i&&fe(pA,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=xp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=xp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ll;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ll(e))throw e;fe(pA,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ei("INTERNAL UNHANDLED ERROR: ",yA(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Cw.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Re(47125,{Pc:yA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function yA(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class fD extends dD{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new mA,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new mA(e),this._firestoreClient=void 0,await e}}}function NW(n,e){const t=typeof n=="object"?n:H1(),i=typeof n=="string"?n:am,r=qm(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=$P("firestore");s&&kW(r,...s)}return r}function DW(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new wG(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,uD(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new PW(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function MW(n,e){Jm("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return LW(n,yx.provider,{build:i=>new bW(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function LW(n,e,t){if((n=Gk(n,fD))._firestoreClient||n._terminated)throw new Se(ae.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Se(ae.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},DW(n)}class Os{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Os(ci.fromBase64String(e))}catch(t){throw new Se(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Os(ci.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Os._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(mf(e,Os._jsonSchema))return Os.fromBase64String(e.bytes)}}Os._jsonSchemaVersion="firestore/bytes/1.0",Os._jsonSchema={type:Xt("string",Os._jsonSchemaVersion),bytes:Xt("string")};class gD{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Se(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Se(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Se(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ke(this._lat,e._lat)||Ke(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:hl._jsonSchemaVersion}}static fromJSON(e){if(mf(e,hl._jsonSchema))return new hl(e.latitude,e.longitude)}}hl._jsonSchemaVersion="firestore/geoPoint/1.0",hl._jsonSchema={type:Xt("string",hl._jsonSchemaVersion),latitude:Xt("number"),longitude:Xt("number")};class dl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:dl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(mf(e,dl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new dl(e.vectorValues);throw new Se(ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}dl._jsonSchemaVersion="firestore/vectorValue/1.0",dl._jsonSchema={type:Xt("string",dl._jsonSchemaVersion),vectorValues:Xt("object")};const OW=new RegExp("[~\\*/\\[\\]]");function FW(n,e,t){if(e.search(OW)>=0)throw _A(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new gD(...e.split("."))._internalPath}catch{throw _A(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function _A(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new Se(ae.INVALID_ARGUMENT,s+n+o)}class pD{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ts(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new VW(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(mD("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class VW extends pD{data(){return super.data()}}function mD(n,e){return typeof e=="string"?FW(n,e):e instanceof gD?e._internalPath:e._delegate._internalPath}class ep{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class eu extends pD{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(mD("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=eu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}eu._jsonSchemaVersion="firestore/documentSnapshot/1.0",eu._jsonSchema={type:Xt("string",eu._jsonSchemaVersion),bundleSource:Xt("string","DocumentSnapshot"),bundleName:Xt("string"),bundle:Xt("string")};class wp extends eu{data(e={}){return super.data(e)}}class hd{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ep(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new wp(this._firestore,this._userDataWriter,i.key,i,new ep(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Se(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const u=new wp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new ep(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new wp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new ep(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:jW(l.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Uk.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function jW(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re(61501,{type:n})}}hd._jsonSchemaVersion="firestore/querySnapshot/1.0",hd._jsonSchema={type:Xt("string",hd._jsonSchemaVersion),bundleSource:Xt("string","QuerySnapshot"),bundleName:Xt("string"),bundle:Xt("string")};(function(e,t=!0){(function(r){Mu=r})(Ml),wl(new na("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new fD(new P8(i.getProvider("auth-internal")),new D8(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Se(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wu(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),rs(lR,cR,e),rs(lR,cR,"esm2020")})();const yD="firebasestorage.googleapis.com",zW="storageBucket",UW=120*1e3,BW=600*1e3;class ds extends hs{constructor(e,t,i=0){super(Q0(e),`Firebase Storage: ${t} (${Q0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Q0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ls;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ls||(ls={}));function Q0(n){return"storage/"+n}function GW(){const n="An unknown error occurred, please check the error payload for server response.";return new ds(ls.UNKNOWN,n)}function WW(){return new ds(ls.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function $W(){return new ds(ls.CANCELED,"User canceled the upload/download.")}function KW(n){return new ds(ls.INVALID_URL,"Invalid URL '"+n+"'.")}function HW(n){return new ds(ls.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function vA(n){return new ds(ls.INVALID_ARGUMENT,n)}function _D(){return new ds(ls.APP_DELETED,"The Firebase app was deleted.")}function XW(n){return new ds(ls.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class wr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=wr.makeFromUrl(e,t)}catch{return new wr(e,"")}if(i.path==="")return i;throw HW(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(M){M.path_=decodeURIComponent(M.path)}const f="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",x=new RegExp(`^https?://${p}/${f}/b/${r}/o${y}`,"i"),S={bucket:1,path:3},I=t===yD?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",R=new RegExp(`^https?://${I}/${r}/${T}`,"i"),N=[{regex:l,indices:u,postModify:s},{regex:x,indices:S,postModify:h},{regex:R,indices:{bucket:1,path:2},postModify:h}];for(let M=0;M<N.length;M++){const F=N[M],U=F.regex.exec(e);if(U){const P=U[F.indices.bucket];let A=U[F.indices.path];A||(A=""),i=new wr(P,A),F.postModify(i);break}}if(i==null)throw KW(e);return i}}class qW{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function YW(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function f(...T){h||(h=!0,e.apply(null,T))}function p(T){r=setTimeout(()=>{r=null,n(x,u())},T)}function y(){s&&clearTimeout(s)}function x(T,...R){if(h){y();return}if(T){y(),f.call(null,T,...R);return}if(u()||o){y(),f.call(null,T,...R);return}i<64&&(i*=2);let N;l===1?(l=2,N=0):N=(i+Math.random())*1e3,p(N)}let S=!1;function I(T){S||(S=!0,y(),!h&&(r!==null?(T||(l=2),clearTimeout(r),p(0)):T||(l=1)))}return p(0),s=setTimeout(()=>{o=!0,I(!0)},t),I}function ZW(n){n(!1)}function QW(n){return n!==void 0}function xA(n,e,t,i){if(i<e)throw vA(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw vA(`Invalid value for '${n}'. Expected ${t} or less.`)}function JW(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var mm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(mm||(mm={}));function e$(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class t${constructor(e,t,i,r,s,o,l,u,h,f,p,y=!0,x=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=p,this.retry=y,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,I)=>{this.resolve_=S,this.reject_=I,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new tp(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===mm.NO_ERROR,u=s.getStatus();if(!l||e$(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===mm.ABORT;i(!1,new tp(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new tp(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());QW(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=GW();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?_D():$W();o(u)}else{const u=WW();o(u)}};this.canceled_?t(!1,new tp(!1,null,!0)):this.backoffId_=YW(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&ZW(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class tp{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function n$(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function i$(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function r$(n,e){e&&(n["X-Firebase-GMPID"]=e)}function s$(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function o$(n,e,t,i,r,s,o=!0,l=!1){const u=JW(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return r$(f,e),n$(f,t),i$(f,s),s$(f,i),new t$(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function a$(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function l$(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class ym{constructor(e,t){this._service=e,t instanceof wr?this._location=t:this._location=wr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ym(e,t)}get root(){const e=new wr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return l$(this._location.path)}get storage(){return this._service}get parent(){const e=a$(this._location.path);if(e===null)return null;const t=new wr(this._location.bucket,e);return new ym(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw XW(e)}}function wA(n,e){const t=e?.[zW];return t==null?null:wr.makeFromBucketSpec(t,n)}function c$(n,e,t,i={}){n.host=`${e}:${t}`;const r=Dl(e);r&&(G1(`https://${n.host}/b`),W1("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:XP(s,n.app.options.projectId))}class u${constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=yD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=UW,this._maxUploadRetryTime=BW,this._requests=new Set,r!=null?this._bucket=wr.makeFromBucketSpec(r,this._host):this._bucket=wA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=wr.makeFromBucketSpec(this._url,e):this._bucket=wA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){xA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){xA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Ki(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ym(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new qW(_D());{const o=o$(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const EA="@firebase/storage",TA="0.14.0";const vD="storage";function h$(n=H1(),e){n=eo(n);const i=qm(n,vD).getImmediate({identifier:e}),r=$P("storage");return r&&d$(i,...r),i}function d$(n,e,t,i={}){c$(n,e,t,i)}function f$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new u$(t,i,r,e,Ml)}function g$(){wl(new na(vD,f$,"PUBLIC").setMultipleInstances(!0)),rs(EA,TA,""),rs(EA,TA,"esm2020")}g$();const p$={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},Pw=tk(p$),J0=S8(Pw),m$=NW(Pw);h$(Pw);MW(m$).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const y$="visvriend2024",_$=new Ls,xD=us()(uf((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===y$;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await DB(J0,_$);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await fB(J0),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{dB(J0,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})}));function v$({target:n}){const e=q.useRef(null),t=q.useRef(null),i=Js(s=>s.setMap),r=Ut(s=>s.showScaleBar);return q.useEffect(()=>{if(!e.current){const s=new dz({target:n,controls:[],view:new Zr({center:gl([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),q.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new pz({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const x$=["OpenStreetMap","Luchtfoto"];function w$(){const n=q.useRef(null),e=q.useRef(!1);v$({target:"map"});const t=Js(u=>u.map),i=qo(u=>u.registerLayer),r=qo(u=>u.setLayerVisibility),s=Ut(u=>u.defaultBackground),o=Ut(u=>u.gpsAutoStart),l=wi(u=>u.startTracking);return q.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const u=new A0({properties:{title:"OpenStreetMap",type:"base"},visible:!0,source:new N6}),h=new A0({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Dv({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),f=new A0({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Dv({url:"https://{a-d}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})});t.addLayer(u),t.addLayer(h),t.addLayer(f),i("OpenStreetMap",u),i("Luchtfoto",h),i("Labels Overlay",f),t.updateSize(),p();async function p(){const y=Uz();console.log(`Loading ${y.length} immediate layers...`),(await Promise.allSettled(y.map(async S=>{try{const I=await S.factory();return I?{name:S.name,layer:I}:null}catch(I){return console.warn(`Failed to create ${S.name}:`,I),null}}))).forEach(S=>{if(S.status==="fulfilled"&&S.value){const{name:I,layer:T}=S.value;t.addLayer(T),i(I,T)}})}},[t,i]),q.useEffect(()=>{if(!t||e.current)return;const u=setTimeout(()=>{const h=s||"OpenStreetMap";x$.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(u)},[t,s,r]),q.useEffect(()=>{if(!t||!o)return;const u=setTimeout(()=>l(),500);return()=>clearTimeout(u)},[t,o,l]),_.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const E$=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),T$=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),SA=n=>{const e=T$(n);return e.charAt(0).toUpperCase()+e.slice(1)},wD=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),S$=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var I$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const C$=q.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},u)=>q.createElement("svg",{ref:u,...I$,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:wD("lucide",r),...!s&&!S$(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>q.createElement(h,f)),...Array.isArray(s)?s:[s]]));const Ae=(n,e)=>{const t=q.forwardRef(({className:i,...r},s)=>q.createElement(C$,{ref:s,iconNode:e,className:wD(`lucide-${E$(SA(n))}`,`lucide-${n}`,i),...r}));return t.displayName=SA(n),t};const R$=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],ED=Ae("anchor",R$);const A$=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],b$=Ae("book-open",A$);const P$=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],kw=Ae("camera",P$);const k$=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],TD=Ae("chart-column",k$);const N$=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],_x=Ae("check",N$);const D$=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],M$=Ae("chevron-down",D$);const L$=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],O$=Ae("chevron-right",L$);const F$=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],SD=Ae("chevron-up",F$);const V$=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],IA=Ae("clock",V$);const j$=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],z$=Ae("cloud-lightning",j$);const U$=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],B$=Ae("cloud-rain",U$);const G$=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],W$=Ae("cloud-snow",G$);const $$=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],dd=Ae("cloud",$$);const K$=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ID=Ae("external-link",K$);const H$=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],X$=Ae("eye-off",H$);const q$=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Y$=Ae("eye",q$);const Z$=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Q$=Ae("file-text",Z$);const J$=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],Ys=Ae("fish",J$);const eK=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],tK=Ae("image-plus",eK);const nK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],CD=Ae("info",nK);const iK=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],_m=Ae("layers",iK);const rK=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],sK=Ae("loader-circle",rK);const oK=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],aK=Ae("locate-fixed",oK);const lK=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],cK=Ae("lock",lK);const uK=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],hK=Ae("log-out",uK);const dK=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Al=Ae("map-pin",dK);const fK=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],_y=Ae("map",fK);const gK=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],pK=Ae("menu",gK);const mK=[["path",{d:"M5 12h14",key:"1ays0h"}]],yK=Ae("minus",mK);const _K=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],vK=Ae("moon",_K);const xK=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],RD=Ae("navigation",xK);const wK=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],EK=Ae("pause",wK);const TK=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],SK=Ae("person-standing",TK);const IK=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],CK=Ae("play",IK);const RK=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],AK=Ae("plus",RK);const bK=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],PK=Ae("rotate-ccw",bK);const kK=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],NK=Ae("ruler",kK);const DK=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],MK=Ae("save",DK);const LK=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],OK=Ae("scale",LK);const FK=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],CA=Ae("search",FK);const VK=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],jK=Ae("settings",VK);const zK=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],UK=Ae("ship",zK);const BK=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],GK=Ae("sparkles",BK);const WK=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],vx=Ae("star",WK);const $K=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],KK=Ae("sun",$K);const HK=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],XK=Ae("tag",HK);const qK=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],AD=Ae("thermometer",qK);const YK=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],ZK=Ae("trending-down",YK);const QK=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],JK=Ae("trending-up",QK);const eH=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],tH=Ae("user",eH);const nH=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],xx=Ae("waves",nH);const iH=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],bD=Ae("wind",iH);const rH=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ji=Ae("x",rH);async function sH(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e(null);return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,p=r.getUint16(f)===18761,y=oH(r,f,p);e(y);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e(null)},t.onerror=()=>e(null),t.readAsArrayBuffer(n)})}function oH(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null;for(let p=0;p<r;p++){const y=i+2+p*12;if(n.getUint16(y,t)===34853){s=e+n.getUint32(y+8,t);break}}if(!s)return null;const o=n.getUint16(s,t);let l=null,u=null,h=null,f=null;for(let p=0;p<o;p++){const y=s+2+p*12,x=n.getUint16(y,t),S=n.getUint16(y+2,t),I=n.getUint32(y+4,t),T=y+8;switch(x){case 1:l=String.fromCharCode(n.getUint8(T));break;case 2:u=RA(n,e+n.getUint32(T,t),3,t);break;case 3:h=String.fromCharCode(n.getUint8(T));break;case 4:f=RA(n,e+n.getUint32(T,t),3,t);break}}if(u&&f&&l&&h){const p=AA(u[0],u[1],u[2],l),y=AA(f[0],f[1],f[2],h);if(!isNaN(p)&&!isNaN(y))return{lat:p,lng:y}}return null}catch{return null}}function RA(n,e,t,i){const r=[];for(let s=0;s<t;s++){const o=n.getUint32(e+s*8,i),l=n.getUint32(e+s*8+4,i);r.push(l===0?0:o/l)}return r}function AA(n,e,t,i){let r=n+e/60+t/3600;return(i==="S"||i==="W")&&(r=-r),r}const PD=200,aH=.7;async function lH(n,e=PD){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,u=r.height;l>u?l>e&&(u=Math.round(u*e/l),l=e):u>e&&(l=Math.round(l*e/u),u=e),s.width=l,s.height=u,o?.drawImage(r,0,0,l,u),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",aH)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function cH(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function kD(n){const e=await lH(n,PD),t=await cH(e);return{thumbnailBlob:e,thumbnailBase64:t}}function ND(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function uH(){const n=Js(N=>N.map),e=ii(N=>N.openCatchForm),[t,i]=q.useState(null),[r,s]=q.useState(!1),[o,l]=q.useState(!1),u=q.useRef(null),h=q.useRef(null);q.useEffect(()=>{if(!n)return;const N=n.getViewport();if(!N)return;const M=600,F=15,U=L=>{if(L.touches.length!==1)return;const le=L.touches[0];h.current={x:le.clientX,y:le.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const pe=window.__olMap;if(!pe)return;const ge=N.getBoundingClientRect(),ue=[h.current.x-ge.left,h.current.y-ge.top],Q=pe.getCoordinateFromPixel(ue);if(Q){const se=SI(Q);L.preventDefault(),i({pixel:[h.current.x,h.current.y],coordinate:se}),s(!0),l(!1),setTimeout(()=>l(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},M)},P=L=>{if(!u.current||!h.current)return;const le=L.touches[0],pe=le.clientX-h.current.x,ge=le.clientY-h.current.y;Math.sqrt(pe*pe+ge*ge)>F&&(clearTimeout(u.current),u.current=null)},A=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null},D=L=>{r&&L.preventDefault()},V=L=>{L.button===0&&(h.current={x:L.clientX,y:L.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const le=window.__olMap;if(!le)return;const pe=N.getBoundingClientRect(),ge=[h.current.x-pe.left,h.current.y-pe.top],ue=le.getCoordinateFromPixel(ge);if(ue){const Q=SI(ue);i({pixel:[h.current.x,h.current.y],coordinate:Q}),s(!0),l(!1),setTimeout(()=>l(!0),300)}},M))},j=L=>{if(!u.current||!h.current)return;const le=L.clientX-h.current.x,pe=L.clientY-h.current.y;Math.sqrt(le*le+pe*pe)>F&&(clearTimeout(u.current),u.current=null)},B=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null};return N.addEventListener("touchstart",U,{passive:!1}),N.addEventListener("touchmove",P,{passive:!0}),N.addEventListener("touchend",A),N.addEventListener("touchcancel",A),N.addEventListener("contextmenu",D),N.addEventListener("mousedown",V),N.addEventListener("mousemove",j),N.addEventListener("mouseup",B),N.addEventListener("mouseleave",B),()=>{N.removeEventListener("touchstart",U),N.removeEventListener("touchmove",P),N.removeEventListener("touchend",A),N.removeEventListener("touchcancel",A),N.removeEventListener("contextmenu",D),N.removeEventListener("mousedown",V),N.removeEventListener("mousemove",j),N.removeEventListener("mouseup",B),N.removeEventListener("mouseleave",B),u.current&&clearTimeout(u.current)}},[n,r]);const f=()=>{o&&(s(!1),i(null),l(!1))},p=()=>{s(!1),i(null),l(!1)},y=q.useRef(null),x=()=>{if(!t)return;const[N,M]=t.coordinate;e({location:{lat:M,lng:N},locationSource:"map"}),p()},S=()=>{y.current?.click()},I=async N=>{const M=N.target.files?.[0];if(!(!M||!t)){try{const F=await sH(M),{thumbnailBase64:U}=await kD(M),P={id:ND(),thumbnailBase64:U,createdAt:new Date().toISOString(),pendingUpload:!0};if(F)e({location:F,locationSource:"photo",photos:[P]});else{const[A,D]=t.coordinate;e({location:{lat:D,lng:A},locationSource:"map",photos:[P]})}}catch(F){console.error("Failed to process photo:",F);const[U,P]=t.coordinate;e({location:{lat:P,lng:U},locationSource:"map"})}N.target.value="",p()}},T=()=>{if(!t)return;const[N,M]=t.coordinate,F=`https://www.google.com/maps?q=${M},${N}`;window.open(F,"_blank"),p()},R=()=>{if(!t)return;const[N,M]=t.coordinate,F=`https://www.google.com/maps?layer=c&cbll=${M},${N}`;window.open(F,"_blank"),p()},k=N=>{const[M,F]=N;return`${F.toFixed(5)}N, ${M.toFixed(5)}E`};return _.jsx(Ii,{children:r&&t&&_.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),_.jsxs(ze.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(t.pixel[0],window.innerWidth-220),top:Math.min(t.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[_.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:_.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[_.jsx(Al,{size:16}),_.jsx("span",{className:"text-xs font-mono",children:k(t.coordinate)})]})}),_.jsxs("div",{className:"bg-white",children:[_.jsxs("button",{onClick:S,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(kw,{size:20,className:"text-green-500"}),_.jsx("span",{className:"font-medium",children:"Maak foto"})]}),_.jsxs("button",{onClick:x,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(Ys,{size:20,className:"text-orange-500"}),_.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),_.jsxs("button",{onClick:R,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(SK,{size:20,className:"text-yellow-600"}),_.jsx("span",{className:"font-medium",children:"Street View"})]}),_.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(ID,{size:20,className:"text-blue-600"}),_.jsx("span",{className:"font-medium",children:"Google Maps"})]})]}),_.jsx("input",{ref:y,type:"file",accept:"image/*",capture:"environment",onChange:I,className:"hidden"}),_.jsx("div",{className:"bg-white",children:_.jsxs("button",{onClick:p,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[_.jsx(Ji,{size:18}),_.jsx("span",{children:"Annuleren"})]})})]})]})})}function hH(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=wi(),s=q.useCallback(l=>{i(l)},[i]),o=q.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return q.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function dH(){const{tracking:n,toggle:e}=hH();return _.jsx(ze.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:_.jsx(aK,{size:22,strokeWidth:2})})}const fH="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function gH(){const n=Js(y=>y.map),e=wi(y=>y.position),t=wi(y=>y.accuracy),i=wi(y=>y.tracking),r=wi(y=>y.smoothHeading),s=Ut(y=>y.showAccuracyCircle),o=wi(y=>y.firstFix),l=wi(y=>y.resetFirstFix),u=q.useRef(null),h=q.useRef(null),f=q.useRef(null),p=q.useMemo(()=>y=>new Zi({image:new C1({src:fH,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return q.useEffect(()=>{if(!n||!i&&!e)return;const y=gl([5.1214,52.0907]);return u.current=new ou({geometry:new pl(y)}),u.current.setStyle(p(0)),h.current=new ou({geometry:new pl(y)}),f.current=new M1({source:new I1({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,p]),q.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const y=gl([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const x=n.getView().getResolution()||1,S=Math.min(t/x,80);h.current.setStyle(new Zi({image:new kl({radius:S,fill:new Ir({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new Zi({}));if(o&&i){n.getView().setCenter(y),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:y,duration:150})},[n,i,e,t,o,l,s]),q.useEffect(()=>{if(!u.current)return;const y=r!==null?r*Math.PI/180:0;u.current.setStyle(p(y))},[r,p]),null}function pH(){const n=Js(N=>N.map),[e,t]=q.useState(!1),[i,r]=q.useState(""),[s,o]=q.useState([]),[l,u]=q.useState(!1),[h,f]=q.useState(!1),p=q.useRef(null),y=q.useRef(null),x=q.useRef();q.useEffect(()=>{e&&p.current&&p.current.focus()},[e]),q.useEffect(()=>{if(!e)return;const N=M=>{y.current&&!y.current.contains(M.target)&&S()};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[e]),q.useEffect(()=>{if(!e)return;const N=M=>{M.key==="Escape"&&S()};return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},[e]),q.useEffect(()=>{if(x.current&&clearTimeout(x.current),i.length<2){o([]);return}return x.current=window.setTimeout(async()=>{f(!0);try{const M=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();M.response?.docs&&o(M.response.docs)}catch(N){console.error("Search error:",N),o([])}finally{f(!1)}},300),()=>{x.current&&clearTimeout(x.current)}},[i]);const S=()=>{t(!1),r(""),o([]),u(!1)},I=async N=>{try{const F=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(N)}`)).json();if(F.response?.docs?.[0]?.centroide_ll){const P=F.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(P)return{lng:parseFloat(P[1]),lat:parseFloat(P[2])}}}catch(M){console.error("Lookup error:",M)}return null},T=async N=>{if(!n)return;const M=await I(N.id);M&&n.getView().animate({center:gl([M.lng,M.lat]),zoom:16,duration:1e3}),S()},R=async(N,M)=>{M.stopPropagation();const F=await I(N.id);if(F){const U=`https://www.google.com/maps?q=${F.lat},${F.lng}`;window.open(U,"_blank")}S()},k={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?_.jsxs("div",{ref:y,className:"fixed left-[52px] right-14 z-[850]",style:k,children:[_.jsxs(ze.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[_.jsx(CA,{size:18,className:"search-icon"}),_.jsx("input",{ref:p,type:"text",value:i,onChange:N=>{r(N.target.value),u(!0)},onFocus:()=>u(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),_.jsx("button",{onClick:S,className:"search-clear",title:"Sluiten",children:_.jsx(Ji,{size:18})})]}),_.jsx(Ii,{children:l&&s.length>0&&_.jsx(ze.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(N=>_.jsxs("li",{className:"search-result-item",children:[_.jsx("div",{className:"search-result-content",onClick:()=>T(N),children:_.jsx("span",{className:"search-result-text",children:N.weergavenaam})}),_.jsx("button",{className:"search-navigate-btn",onClick:M=>R(N,M),title:"Open in Google Maps",children:_.jsx(ID,{size:20})})]},N.id))})}),l&&h&&_.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):_.jsx(ze.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:k,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:_.jsx(CA,{size:22,className:"text-gray-600"})})}function mH({size:n=18}){return _.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[_.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),_.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),_.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),_.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function yH(){const[n,e]=q.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=ii(),{user:r,loading:s,signInWithGoogle:o,logout:l}=xD(),u=Ut(T=>T.showCatchButton),h=Ut(T=>T.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},p=()=>e(!1),y=()=>{p(),t()},x=()=>{p(),i()},S=()=>{p(),o()},I=()=>{p(),l()};return _.jsxs(_.Fragment,{children:[_.jsx(ze.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?_.jsx(Ji,{size:22,className:"text-white"}):_.jsx(pK,{size:22,className:"text-gray-600"})}),_.jsx(Ii,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:p}),_.jsxs(ze.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[_.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-blue-500",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?_.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:_.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):r?_.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:_.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?_.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):_.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:_.jsx(tH,{size:16,className:"text-white"})}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),_.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),_.jsx("button",{onClick:I,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:_.jsx(hK,{size:16})})]})}):_.jsxs("button",{onClick:S,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[_.jsx(mH,{size:18}),_.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),_.jsx("div",{className:"py-1",children:_.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[_.jsx(CD,{size:18,className:"text-blue-500"}),_.jsx("span",{children:"Info & handleiding"})]})}),_.jsx("div",{className:"py-1 border-t border-gray-100",children:_.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx(Ys,{size:18,className:"text-green-500"}),_.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),_.jsx("button",{onClick:()=>h(!u),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${u?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:_.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${u?"left-[22px]":"left-0.5"}`})})]})}),_.jsx("div",{className:"mt-auto border-t border-gray-100",children:_.jsxs("button",{onClick:x,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[_.jsx(jK,{size:18,className:"text-gray-500"}),_.jsx("span",{children:"Instellingen"})]})}),_.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.5"})]})]})})]})}function _H(){const{infoPanelOpen:n,toggleInfoPanel:e}=ii(),[t,i]=q.useState("info"),r=[{id:"info",label:"Info",icon:_.jsx(CD,{size:14})},{id:"functies",label:"Functies",icon:_.jsx(Q$,{size:14})},{id:"handleiding",label:"Handleiding",icon:_.jsx(b$,{size:14})}];return _.jsx(Ii,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),_.jsxs(ze.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.5"}),_.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:_.jsx(Ji,{size:18,className:"text-white",strokeWidth:2.5})})]}),_.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>_.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&_.jsx(vH,{}),t==="functies"&&_.jsx(xH,{}),t==="handleiding"&&_.jsx(wH,{}),_.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:_.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.5 - Voor jou en je vismaat"})})]})]})]})})}function vH(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),_.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),_.jsxs("ul",{className:"space-y-2 text-gray-600",children:[_.jsxs("li",{children:[_.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),_.jsxs("li",{children:[_.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),_.jsxs("div",{className:"text-gray-600 space-y-2",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function xH(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(_y,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsxs("li",{children:[_.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(Ys,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Registreer soort, gewicht en lengte"}),_.jsx("li",{children:"Vismethode en aas bijhouden"}),_.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),_.jsx("li",{children:"GPS locatie per vangst"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(Al,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Markeer je beste visplekken"}),_.jsx("li",{children:"Voeg notities en ratings toe"}),_.jsx("li",{children:"Welke vis zit waar?"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(dd,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Live weergegevens op je locatie"}),_.jsx("li",{children:"Windsnelheid en richting"}),_.jsx("li",{children:"Luchtdruk"}),_.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(RD,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Live GPS tracking"}),_.jsx("li",{children:"Zoek adressen en plaatsen"}),_.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function wH(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),_.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[_.jsxs("li",{children:["Tik op de ",_.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),_.jsxs("li",{children:["Gebruik het ",_.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),_.jsxs("li",{children:["Tik op de ",_.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[_.jsxs("li",{children:["Gebruik de ",_.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),_.jsxs("li",{children:["Check de ",_.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),_.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),_.jsxs("li",{children:["Markeer succesvolle plekken als ",_.jsx("strong",{children:"favoriet"})]})]})]})]})}const EH=gl([5.1214,52.0907]),TH=8;function SH(){const n=Js(r=>r.map),e=qo(r=>r.setLayerVisibility),t=wi(r=>r.stopTracking),i=()=>{t(),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Labels Overlay",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:EH,zoom:TH,rotation:0,duration:500})};return _.jsx(ze.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:_.jsx(PK,{size:18,className:"text-gray-600"})})}const IH={Map:_y,Fish:Ys,Anchor:ED,Layers:_m,Star:vx},CH={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},RH={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function AH(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=Hz(),[r,s]=q.useState(!1),[o,l]=q.useState(null),[u,h]=q.useState(!1),[f,p]=q.useState(""),y=I=>{e(I),s(!1)},x=(I,T)=>{I.stopPropagation();const{useLayerStore:R}=require("../../store"),k=R.getState().visible,N=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(M=>k[M]);t(T,{layers:N}),l(T),setTimeout(()=>l(null),2e3)},S=()=>{f.trim()&&(i(f.trim()),p(""),h(!1))};return _.jsxs(_.Fragment,{children:[_.jsx(ze.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?_.jsx(SD,{size:20,className:"text-blue-600"}):_.jsx(_m,{size:20,className:"text-gray-600"})}),_.jsx(Ii,{children:r&&_.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),_.jsxs(ze.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[_.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),_.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(I=>{const T=IH[I.icon]||_m,R=CH[I.icon]||"text-blue-600",k=RH[I.icon]||"hover:bg-blue-50",N=o===I.id;return _.jsxs("button",{onClick:()=>y(I.id),className:`w-full h-9 flex items-center gap-2 px-2 ${k} rounded text-left transition-colors border-0 outline-none bg-transparent ${N?"bg-green-50":""}`,children:[_.jsx(T,{size:16,className:`${R} flex-shrink-0`}),_.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:I.name}),N?_.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:_.jsx(_x,{size:14,className:"text-green-500"})}):_.jsx("span",{onClick:M=>x(M,I.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:_.jsx(MK,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},I.id)})}),_.jsx("div",{className:"border-t border-gray-200 p-2",children:u?_.jsxs("div",{className:"flex gap-1",children:[_.jsx("input",{type:"text",value:f,onChange:I=>p(I.target.value),onKeyDown:I=>{I.key==="Enter"&&S(),I.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400"}),_.jsx("button",{onClick:S,disabled:!f.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):_.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",children:[_.jsx(AK,{size:14}),_.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const bA={lat:52.1326,lng:5.2913};function bH({size:n=18,className:e=""}){return _.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[_.jsx("path",{d:"M3 12h18"}),_.jsx("path",{d:"M21 12c-1.5 0-3-1-3-3s1.5-3 3-3"}),_.jsx("path",{d:"M21 12c-1.5 0-3 1-3 3s1.5 3 3 3"}),_.jsx("circle",{cx:"4",cy:"12",r:"1.5",fill:"currentColor"}),_.jsx("path",{d:"M8 12l2-3"}),_.jsx("path",{d:"M8 12l2 3"}),_.jsx("path",{d:"M12 12l2-3"}),_.jsx("path",{d:"M12 12l2 3"}),_.jsx("path",{d:"M16 12l1.5-2"}),_.jsx("path",{d:"M16 12l1.5 2"})]})}function PA({size:n=16,className:e="",clipPercent:t=100}){const i=`fish-clip-${Math.random().toString(36).substr(2,9)}`;return _.jsxs("svg",{width:n*(t/100),height:n,viewBox:`0 0 ${24*(t/100)} 24`,fill:"currentColor",className:e,style:{overflow:"hidden"},children:[_.jsx("defs",{children:_.jsx("clipPath",{id:i,children:_.jsx("rect",{x:"0",y:"0",width:24*(t/100),height:"24"})})}),_.jsxs("g",{clipPath:`url(#${i})`,children:[_.jsx("path",{d:"M6.5 12c0-3.5 3-6 7-6 2.5 0 4.5 1 6 2.5.8.8 1.5 1.8 2 3-.5 1.2-1.2 2.2-2 3-1.5 1.5-3.5 2.5-6 2.5-4 0-7-2.5-7-5z"}),_.jsx("path",{d:"M2.5 12l3-3v6l-3-3z"}),_.jsx("circle",{cx:"17",cy:"11",r:"1",fill:"white"})]})]})}function PH({value:n,maxFish:e=3,color:t}){const i=Math.floor(n),r=n%1>=.5,s=[];for(let o=0;o<i&&o<e;o++)s.push(_.jsx(PA,{size:16,className:t},o));return r&&i<e&&s.push(_.jsx(PA,{size:16,className:t,clipPercent:50},"half")),_.jsx("div",{className:"flex items-center gap-0.5",children:s.length>0?s:_.jsx(bH,{size:18,className:t})})}function DD({phase:n,size:e=20}){const t=n<.5,i=n<.5?n*2:(1-n)*2;return _.jsx("div",{className:"relative rounded-full bg-gray-700 overflow-hidden",style:{width:e,height:e},children:_.jsx("div",{className:"absolute inset-0 bg-yellow-100",style:{clipPath:t?`inset(0 ${(1-i)*100}% 0 0)`:`inset(0 0 0 ${(1-i)*100}%)`}})})}function kH({activity:n,label:e}){const t=()=>n>=.8?"bg-green-500":n>=.6?"bg-lime-500":n>=.4?"bg-amber-500":"bg-red-400";return _.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"text-[10px] text-gray-500 w-12",children:e}),_.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:_.jsx("div",{className:`h-full ${t()} transition-all`,style:{width:`${n*100}%`}})})]})}function Nw(n){const e=29.53058867,t=new Date("2000-01-06T18:14:00Z");return(n.getTime()-t.getTime())/(1e3*60*60*24)%e/e}function wx(n){const e=Nw(n),t=n.getHours(),i=Math.floor((e*24+12)%24),r=(i+6)%24,s=(i+18)%24,o=[i,(i+12)%24],l=[r,s];let u=.3;return(e<.1||e>.9||e>.4&&e<.6)&&(u+=.3),o.forEach(h=>{const f=Math.abs(t-h);f<=1||f>=23?u+=.3:(f<=2||f>=22)&&(u+=.15)}),l.forEach(h=>{const f=Math.abs(t-h);f<=.5?u+=.15:f<=1&&(u+=.08)}),{major:o,minor:l,overall:Math.min(1,u)}}function NH({data:n,onClose:e}){if(n.length===0)return null;const t=n.map(T=>T.pressure),i=Math.min(...t)-2,r=Math.max(...t)+2,s=r-i,o=300,l=120,u={top:10,right:10,bottom:25,left:35},h=o-u.left-u.right,f=l-u.top-u.bottom,p=n.map((T,R)=>{const k=u.left+R/(n.length-1)*h,N=u.top+f-(T.pressure-i)/s*f;return{x:k,y:N,time:T.time,pressure:T.pressure}}),y=p.map((T,R)=>`${R===0?"M":"L"} ${T.x} ${T.y}`).join(" "),x=new Date,S=n.findIndex(T=>new Date(T.time)>=x)||Math.floor(n.length/3),I=T=>new Date(T).getHours().toString().padStart(2,"0")+":00";return _.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:_.jsxs(ze.div,{className:"bg-white rounded-xl shadow-xl p-4 max-w-sm w-full",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:T=>T.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-3",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(TD,{size:18,className:"text-blue-500"}),"Luchtdruk (72 uur)"]}),_.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:18,className:"text-gray-500"})})]}),_.jsxs("svg",{width:o,height:l,className:"w-full",children:[[0,.25,.5,.75,1].map(T=>{const R=u.top+T*f,k=Math.round(r-T*s);return _.jsxs("g",{children:[_.jsx("line",{x1:u.left,y1:R,x2:o-u.right,y2:R,stroke:"#e5e7eb",strokeWidth:"1"}),_.jsx("text",{x:u.left-4,y:R+4,fontSize:"9",fill:"#9ca3af",textAnchor:"end",children:k})]},T)}),[0,Math.floor(n.length/3),Math.floor(2*n.length/3),n.length-1].map(T=>{if(T>=n.length)return null;const R=u.left+T/(n.length-1)*h;return _.jsx("text",{x:R,y:l-5,fontSize:"8",fill:"#9ca3af",textAnchor:"middle",children:I(n[T].time)},T)}),_.jsx("path",{d:`${p.slice(0,S+1).map((T,R)=>`${R===0?"M":"L"} ${T.x} ${T.y}`).join(" ")} L ${p[S]?.x||u.left} ${l-u.bottom} L ${u.left} ${l-u.bottom} Z`,fill:"rgba(59, 130, 246, 0.15)"}),S<p.length-1&&_.jsx("path",{d:`${p.slice(S).map((T,R)=>`${R===0?"M":"L"} ${T.x} ${T.y}`).join(" ")} L ${p[p.length-1].x} ${l-u.bottom} L ${p[S].x} ${l-u.bottom} Z`,fill:"rgba(59, 130, 246, 0.08)"}),_.jsx("path",{d:y,fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),p[S]&&_.jsxs(_.Fragment,{children:[_.jsx("line",{x1:p[S].x,y1:u.top,x2:p[S].x,y2:l-u.bottom,stroke:"#f59e0b",strokeWidth:"1",strokeDasharray:"3,3"}),_.jsx("circle",{cx:p[S].x,cy:p[S].y,r:"4",fill:"#f59e0b"}),_.jsx("text",{x:p[S].x,y:u.top-2,fontSize:"8",fill:"#f59e0b",textAnchor:"middle",children:"Nu"})]})]}),_.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Dalende druk = vaak beter bijten"})]})})}function DH({onClose:n}){const e=new Date,t=Nw(e),i=wx(e),r=Array.from({length:24},(l,u)=>{const h=new Date(e);return h.setHours(u,0,0,0),{hour:u,activity:wx(h).overall}}),s=l=>l<.03||l>.97?"Nieuwe maan":l<.22?"Wassende sikkel":l<.28?"Eerste kwartier":l<.47?"Wassende maan":l<.53?"Volle maan":l<.72?"Afnemende maan":l<.78?"Laatste kwartier":"Afnemende sikkel",o=l=>`${l.toString().padStart(2,"0")}:00`;return _.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(ze.div,{className:"bg-white rounded-xl shadow-xl p-4 max-w-sm w-full max-h-[80vh] overflow-y-auto",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:l=>l.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(vK,{size:18,className:"text-blue-500"}),"Solunar Activiteit"]}),_.jsx("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:18,className:"text-gray-500"})})]}),_.jsxs("div",{className:"flex items-center gap-3 mb-4 p-3 bg-gray-50 rounded-lg",children:[_.jsx(DD,{phase:t,size:40}),_.jsxs("div",{children:[_.jsx("div",{className:"font-medium text-gray-800",children:s(t)}),_.jsxs("div",{className:"text-xs text-gray-500",children:[Math.round(t*100),"% cyclus"]})]})]}),_.jsxs("div",{className:"mb-4",children:[_.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Beste tijden vandaag"}),_.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_.jsxs("div",{className:"bg-green-50 p-2 rounded-lg",children:[_.jsx("div",{className:"text-xs text-green-600 font-medium",children:"Major periodes"}),_.jsx("div",{className:"text-sm text-green-800",children:i.major.map(l=>o(l)).join(", ")})]}),_.jsxs("div",{className:"bg-amber-50 p-2 rounded-lg",children:[_.jsx("div",{className:"text-xs text-amber-600 font-medium",children:"Minor periodes"}),_.jsx("div",{className:"text-sm text-amber-800",children:i.minor.map(l=>o(l)).join(", ")})]})]})]}),_.jsxs("div",{className:"mb-3",children:[_.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Activiteit per uur"}),_.jsx("div",{className:"flex items-end gap-0.5 h-16",children:r.map(({hour:l,activity:u})=>_.jsx("div",{className:`flex-1 rounded-t transition-all ${u>=.7?"bg-green-500":u>=.5?"bg-lime-500":u>=.3?"bg-amber-500":"bg-red-400"} ${l===e.getHours()?"ring-2 ring-blue-500":""}`,style:{height:`${u*100}%`},title:`${o(l)}: ${Math.round(u*100)}%`},l))}),_.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400 mt-1",children:[_.jsx("span",{children:"00:00"}),_.jsx("span",{children:"06:00"}),_.jsx("span",{children:"12:00"}),_.jsx("span",{children:"18:00"}),_.jsx("span",{children:"24:00"})]})]}),_.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Gebaseerd op maanfase en -positie"})]})})}function MH(){const{current:n,loading:e,fetchWeather:t,getFishingCondition:i,getFishingScore:r,pressureHistory:s,getPressureTrend:o}=Ld(),l=wi(U=>U.position),u=Ut(U=>U.showWeatherWidget),[h,f]=q.useState(!1),[p,y]=q.useState(!1),x={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};if(q.useEffect(()=>{const U=l||bA;t(U.lat,U.lng)},[]),q.useEffect(()=>{l&&t(l.lat,l.lng)},[l,t]),q.useEffect(()=>{const U=l||bA,P=setInterval(()=>{t(U.lat,U.lng)},600*1e3);return()=>clearInterval(P)},[l,t]),!u||!n&&!e)return null;const S=i(),I=r?r():S==="excellent"?3:S==="good"?2:S==="moderate"?1:0,T=wx(new Date),R=Nw(new Date),k=Math.min(3,I/2+T.overall*1.5),N=U=>U>=2.5?"text-green-500":U>=1.5?"text-lime-500":U>=.8?"text-amber-500":"text-red-500",M=U=>U>=2.5?"bg-green-50 border-green-200":U>=1.5?"bg-lime-50 border-lime-200":U>=.8?"bg-amber-50 border-amber-200":"bg-red-50 border-red-200",F=U=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(U/45)%8];return _.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:`fixed left-2 z-[700] bg-white/95 backdrop-blur-sm rounded-xl shadow-sm p-3 min-w-[140px] border ${M(k)}`,style:x,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e?_.jsx("div",{className:"text-sm text-gray-500",children:"Laden..."}):n?_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex items-center justify-between pb-2 border-b border-gray-100",children:[_.jsx(PH,{value:k,color:N(k)}),_.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-1 p-1 hover:bg-white/50 rounded transition-colors border-0 outline-none bg-transparent",title:"Solunar info",children:[_.jsx(DD,{phase:R,size:16}),_.jsx(O$,{size:12,className:"text-gray-400"})]})]}),_.jsx(kH,{activity:T.overall,label:"Activiteit"}),_.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[_.jsx(AD,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.temperature),"C"]})]}),_.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[_.jsx(bD,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",F(n.windDirection)]})]}),_.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 text-sm text-gray-500 hover:text-blue-500 transition-colors w-full border-0 outline-none bg-transparent p-0",children:[_.jsx(TD,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.pressure)," hPa"]}),(()=>{const U=o();return U==="rising"?_.jsx(JK,{size:14,className:"text-green-500 ml-auto"}):U==="falling"?_.jsx(ZK,{size:14,className:"text-red-500 ml-auto"}):_.jsx(yK,{size:14,className:"text-gray-400 ml-auto"})})()]})]}):null}),_.jsx(Ii,{children:h&&s.length>0&&_.jsx(NH,{data:s,onClose:()=>f(!1)})}),_.jsx(Ii,{children:p&&_.jsx(DH,{onClose:()=>y(!1)})})]})}function LH(){const n=Ld(o=>o.current);if(!Ut(o=>o.showWeatherWidget)||!n)return null;const t=Math.round(n.windSpeed),i=n.windDirection,r=()=>t<12?"#22c55e":t<20?"#84cc16":t<30?"#eab308":t<40?"#f97316":"#ef4444",s=()=>t<5?"Stil":t<12?"Zwak":t<20?"Matig":t<30?"Vrij krachtig":t<40?"Krachtig":"Hard";return _.jsxs(ze.div,{className:"fixed bottom-28 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},children:[_.jsxs("div",{className:"relative w-16 h-16",children:[_.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-gray-200"}),_.jsx("span",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-0.5 text-[8px] font-bold text-gray-400",children:"N"}),_.jsx("span",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-0.5 text-[8px] font-bold text-gray-400",children:"Z"}),_.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-0.5 text-[8px] font-bold text-gray-400",children:"W"}),_.jsx("span",{className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-0.5 text-[8px] font-bold text-gray-400",children:"O"}),_.jsx(ze.div,{className:"absolute inset-2 flex items-center justify-center",style:{transform:`rotate(${i}deg)`},animate:{rotate:i},transition:{type:"spring",stiffness:100},children:_.jsx("svg",{viewBox:"0 0 24 24",className:"w-full h-full",style:{color:r()},children:_.jsx("path",{d:"M12 2l-6 10h4v10h4V12h4L12 2z",fill:"currentColor"})})}),_.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:_.jsx("div",{className:"bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-sm",children:_.jsx("span",{className:"text-xs font-bold",style:{color:r()},children:t})})})]}),_.jsx("div",{className:"text-center mt-1",children:_.jsx("span",{className:"text-[10px] text-gray-500",children:s()})})]})}const fd=[{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12},{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456},{id:"HARVLGTHVSNS",name:"Harlingen",lat:53.1747,lng:5.4083},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664}];function OH(n,e){const t=[],i=29.53058867,r=new Date("2000-01-06T18:14:00Z"),o=(n.getTime()-r.getTime())/(1e3*60*60*24)%i/i,l=e.lng/15*60,u=745;let h=o*u*2%1440;h=(h+l)%1440;for(let f=0;f<4;f++){const p=f%2===0,y=f*(u/2),x=(h+y)%1440,S=Math.floor(x/60),I=Math.floor(x%60),T=Math.abs(Math.sin(o*Math.PI*2)),R=p?1.8:.4,k=T*.5;t.push({time:`${S.toString().padStart(2,"0")}:${I.toString().padStart(2,"0")}`,height:p?R+k:R-k*.5,type:p?"high":"low"})}return t.sort((f,p)=>f.time.localeCompare(p.time))}function FH(n,e){let t=fd[0],i=1/0;for(const r of fd){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}function VH({tides:n,currentHour:e}){const r={top:10,right:10,bottom:20,left:30},s=[];for(let l=0;l<24;l++){const u=r.left+l/23*(280-r.left-r.right),h=`${l.toString().padStart(2,"0")}:00`;let f=n[n.length-1],p=n[0];for(let k=0;k<n.length;k++)n[k].time<=h&&(f=n[k],p=n[(k+1)%n.length]);const y=parseInt(f.time.split(":")[0]),x=parseInt(p.time.split(":")[0])||24,S=(l-y)/(x-y||12),I=(1-Math.cos(S*Math.PI))/2,T=f.height+(p.height-f.height)*I,R=r.top+(1-T/2.5)*(80-r.top-r.bottom);s.push({x:u,y:R,time:h,height:T})}const o=s.map((l,u)=>`${u===0?"M":"L"} ${l.x} ${l.y}`).join(" ");return _.jsxs("svg",{width:280,height:80,className:"w-full",children:[[.5,1,1.5,2].map(l=>{const u=r.top+(1-l/2.5)*(80-r.top-r.bottom);return _.jsxs("g",{children:[_.jsx("line",{x1:r.left,y1:u,x2:280-r.right,y2:u,stroke:"#e5e7eb",strokeWidth:"1"}),_.jsxs("text",{x:r.left-4,y:u+3,fontSize:"8",fill:"#9ca3af",textAnchor:"end",children:[l,"m"]})]},l)}),[0,6,12,18,24].map(l=>{const u=r.left+l/24*(280-r.left-r.right);return _.jsxs("text",{x:u,y:75,fontSize:"8",fill:"#9ca3af",textAnchor:"middle",children:[l.toString().padStart(2,"0"),":00"]},l)}),_.jsx("path",{d:`${o} L ${280-r.right} ${80-r.bottom} L ${r.left} ${80-r.bottom} Z`,fill:"rgba(59, 130, 246, 0.15)"}),_.jsx("path",{d:o,fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),e>=0&&e<24&&_.jsxs(_.Fragment,{children:[_.jsx("line",{x1:r.left+e/23*(280-r.left-r.right),y1:r.top,x2:r.left+e/23*(280-r.left-r.right),y2:80-r.bottom,stroke:"#f59e0b",strokeWidth:"1",strokeDasharray:"3,3"}),_.jsx("circle",{cx:r.left+e/23*(280-r.left-r.right),cy:s[e]?.y||r.top,r:"4",fill:"#f59e0b"})]}),n.map((l,u)=>{const h=parseInt(l.time.split(":")[0]),f=r.left+h/23*(280-r.left-r.right),p=r.top+(1-l.height/2.5)*(80-r.top-r.bottom);return _.jsx("g",{children:_.jsx("circle",{cx:f,cy:p,r:"3",fill:l.type==="high"?"#22c55e":"#ef4444"})},u)})]})}function jH(){const[n,e]=q.useState(!1),[t,i]=q.useState(!1),[r,s]=q.useState(fd[0]),o=wi(x=>x.position),l=Ut(x=>x.showWeatherWidget);if(q.useEffect(()=>{o&&s(FH(o.lat,o.lng))},[o]),!l)return null;const u=new Date,h=OH(u,r),f=u.getHours(),p=`${f.toString().padStart(2,"0")}:${u.getMinutes().toString().padStart(2,"0")}`,y=h.find(x=>x.time>p)||h[0];return _.jsxs(_.Fragment,{children:[_.jsxs(ze.button,{className:"fixed bottom-44 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none",onClick:()=>i(!0),whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsx(xx,{size:18,className:"text-blue-500"}),_.jsxs("div",{className:"text-left",children:[_.jsx("div",{className:"text-[10px] text-gray-500",children:r.name}),_.jsx("div",{className:"text-xs font-medium",children:y.type==="high"?_.jsxs("span",{className:"text-green-600 flex items-center gap-0.5",children:[_.jsx(SD,{size:12}),y.time]}):_.jsxs("span",{className:"text-red-500 flex items-center gap-0.5",children:[_.jsx(M$,{size:12}),y.time]})})]})]}),_.jsx(Ii,{children:t&&_.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>i(!1),children:_.jsxs(ze.div,{className:"bg-white rounded-xl shadow-xl p-4 max-w-sm w-full",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:x=>x.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(xx,{size:18,className:"text-blue-500"}),"Getijden"]}),_.jsx("button",{onClick:()=>i(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:18,className:"text-gray-500"})})]}),_.jsxs("div",{className:"mb-4",children:[_.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Meetstation"}),_.jsx("select",{value:r.id,onChange:x=>{const S=fd.find(I=>I.id===x.target.value);S&&s(S)},className:"w-full p-2 border border-gray-200 rounded-lg text-sm",children:fd.map(x=>_.jsx("option",{value:x.id,children:x.name},x.id))})]}),_.jsx("div",{className:"mb-4",children:_.jsx(VH,{tides:h,currentHour:f})}),_.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:h.map((x,S)=>_.jsxs("div",{className:`p-2 rounded-lg ${x.type==="high"?"bg-green-50":"bg-red-50"}`,children:[_.jsx("div",{className:`text-xs font-medium ${x.type==="high"?"text-green-600":"text-red-600"}`,children:x.type==="high"?"Hoogwater":"Laagwater"}),_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsx("span",{className:"text-sm font-medium",children:x.time}),_.jsxs("span",{className:"text-xs text-gray-500",children:[x.height.toFixed(1),"m"]})]})]},S))}),_.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Geschatte tijden gebaseerd op maanstand"})]})})})]})}function kA(n){return n===0?_.jsx(KK,{size:16,className:"text-yellow-500"}):n<=3?_.jsx(dd,{size:16,className:"text-gray-400"}):n<=49?_.jsx(dd,{size:16,className:"text-gray-500"}):n<=69?_.jsx(B$,{size:16,className:"text-blue-500"}):n<=79?_.jsx(W$,{size:16,className:"text-cyan-500"}):n<=99?_.jsx(z$,{size:16,className:"text-purple-500"}):_.jsx(dd,{size:16,className:"text-gray-400"})}function zH(n){return n===0?"Helder":n<=3?"Bewolkt":n<=49?"Mist":n<=59?"Motregen":n<=69?"Regen":n<=79?"Sneeuw":n<=99?"Onweer":"Onbekend"}function UH(){const n=Ld(R=>R.hourlyForecast),e=Ld(R=>R.getWeatherAtTime),t=Ut(R=>R.showWeatherWidget),[i,r]=q.useState(!1),[s,o]=q.useState(0),[l,u]=q.useState(!1),h=new Date,f=n.findIndex(R=>new Date(R.time)>=h),p=s-24,y=new Date(h.getTime()+p*60*60*1e3),x=e(y);if(q.useEffect(()=>{if(!l)return;const R=setInterval(()=>{o(k=>k>=72?(u(!1),72):k+1)},200);return()=>clearInterval(R)},[l]),!t||n.length===0)return null;const S=R=>R.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"}),I=R=>{const k=new Date,N=new Date(k);N.setDate(N.getDate()+1);const M=new Date(k);return M.setDate(M.getDate()-1),R.toDateString()===k.toDateString()?"Vandaag":R.toDateString()===N.toDateString()?"Morgen":R.toDateString()===M.toDateString()?"Gisteren":R.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},T=R=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(R/45)%8];return _.jsxs(_.Fragment,{children:[_.jsxs(ze.button,{className:"fixed bottom-60 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none",onClick:()=>r(!0),whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsx(IA,{size:18,className:"text-blue-500"}),_.jsx("span",{className:"text-xs text-gray-600",children:"Forecast"})]}),_.jsx(Ii,{children:i&&_.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-end justify-center bg-black/30",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>r(!1),children:_.jsxs(ze.div,{className:"bg-white rounded-t-2xl shadow-xl p-4 w-full max-w-md",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:R=>R.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(IA,{size:18,className:"text-blue-500"}),"Weersvoorspelling"]}),_.jsx("button",{onClick:()=>r(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(Ji,{size:18,className:"text-gray-500"})})]}),_.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsxs("div",{children:[_.jsx("div",{className:"text-lg font-bold text-gray-800",children:S(y)}),_.jsx("div",{className:"text-sm text-gray-500",children:I(y)})]}),x&&_.jsxs("div",{className:"flex items-center gap-2",children:[kA(x.weatherCode),_.jsx("span",{className:"text-sm text-gray-600",children:zH(x.weatherCode)})]})]}),x&&_.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-3",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(AD,{size:16,className:"text-orange-500"}),_.jsxs("span",{className:"text-sm font-medium",children:[Math.round(x.temperature),"C"]})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(bD,{size:16,className:"text-blue-500"}),_.jsxs("span",{className:"text-sm font-medium",children:[Math.round(x.windSpeed)," km/u"]})]}),_.jsx("div",{className:"text-right text-sm text-gray-500",children:T(x.windDirection)})]})]}),_.jsxs("div",{className:"mb-4",children:[_.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[_.jsx("span",{children:"-24u"}),_.jsx("span",{className:"font-medium text-blue-500",children:"Nu"}),_.jsx("span",{children:"+48u"})]}),_.jsxs("div",{className:"relative",children:[_.jsx("input",{type:"range",min:"0",max:"72",value:s,onChange:R=>o(parseInt(R.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, #93c5fd 0%, #93c5fd ${24/72*100}%, #3b82f6 ${24/72*100}%, #3b82f6 ${s/72*100}%, #e5e7eb ${s/72*100}%, #e5e7eb 100%)`}}),_.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-1 h-4 bg-blue-600 rounded",style:{left:`${24/72*100}%`}})]})]}),_.jsxs("div",{className:"flex items-center justify-center gap-4",children:[_.jsx("button",{onClick:()=>o(0),className:"px-3 py-1.5 text-xs text-gray-600 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:"Start"}),_.jsx("button",{onClick:()=>u(!l),className:"p-2 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors border-0 outline-none",children:l?_.jsx(EK,{size:16}):_.jsx(CK,{size:16})}),_.jsx("button",{onClick:()=>o(24),className:"px-3 py-1.5 text-xs text-gray-600 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:"Nu"})]}),_.jsx("div",{className:"mt-4 overflow-x-auto",children:_.jsx("div",{className:"flex gap-2 pb-2",children:n.slice(f,f+12).map((R,k)=>{const N=new Date(R.time),M=Math.abs(N.getTime()-y.getTime())<1800*1e3;return _.jsxs("button",{onClick:()=>{const F=(N.getTime()-h.getTime())/36e5;o(24+Math.round(F))},className:`flex flex-col items-center p-2 rounded-lg min-w-[50px] transition-colors border-0 outline-none ${M?"bg-blue-100":"bg-gray-50 hover:bg-gray-100"}`,children:[_.jsxs("span",{className:"text-[10px] text-gray-500",children:[N.getHours().toString().padStart(2,"0"),":00"]}),kA(R.weatherCode),_.jsxs("span",{className:"text-xs font-medium",children:[Math.round(R.temperature),""]})]},k)})})})]})})})]})}const vm=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],BH=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],GH=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],ev=5;function WH({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=q.useRef(null),s=q.useRef(null),o=async u=>{const h=u.target.files;if(!h||h.length===0)return;const f=ev-n.length,p=Array.from(h).slice(0,f);for(const y of p)try{const{thumbnailBase64:x}=await kD(y),S={id:ND(),thumbnailBase64:x,createdAt:new Date().toISOString(),pendingUpload:!0};e(S)}catch(x){console.error("Failed to process image:",x)}u.target.value=""},l=n.length<ev;return _.jsxs("div",{className:"space-y-2",children:[_.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",ev,")"]}),_.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(u=>_.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[_.jsx("img",{src:u.thumbnailUrl||u.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&_.jsx("button",{type:"button",onClick:()=>t(u.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:_.jsx(Ji,{size:12,className:"text-white"})}),u.pendingUpload&&_.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},u.id)),l&&!i&&_.jsxs(_.Fragment,{children:[_.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[_.jsx(kw,{size:20,className:"text-gray-400"}),_.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),_.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[_.jsx(tK,{size:20,className:"text-gray-400"}),_.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),_.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),_.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}const $H={Snoek:{colors:["green","yellow","spotted"],pattern:"elongated with spots"},Snoekbaars:{colors:["gray","silver","striped"],pattern:"elongated with stripes"},Baars:{colors:["green","black","striped","red-fins"],pattern:"oval with stripes"},Karper:{colors:["brown","gold","orange"],pattern:"large oval"},Brasem:{colors:["silver","bronze"],pattern:"flat oval"},Voorn:{colors:["silver","red-fins"],pattern:"small oval"},Zeelt:{colors:["green","brown","slimy"],pattern:"elongated"},Meerval:{colors:["dark","brown","black"],pattern:"large with whiskers"},Aal:{colors:["dark","silver-belly"],pattern:"snake-like"},Forel:{colors:["spotted","pink","silver"],pattern:"streamlined with spots"}};async function KH(n){return new Promise(e=>{const t=new Image;t.onload=()=>{const i=document.createElement("canvas"),r=i.getContext("2d");if(!r){e([]);return}const s=100;i.width=s,i.height=s;const o=(t.width-s)/2,l=(t.height-s)/2;r.drawImage(t,o,l,s,s,0,0,s,s);const h=r.getImageData(0,0,s,s).data;let f=0,p=0,y=0,x=0,S=0,I=0;const T=h.length/4;for(let M=0;M<h.length;M+=4){const F=h[M],U=h[M+1],P=h[M+2];f+=F,p+=U,U>F&&U>P&&y++,F>100&&U>80&&U<150&&P<100&&x++,F>150&&U>150&&P>150&&S++,F<80&&U<80&&P<80&&I++}const R=[];y/T>.2&&R.push("green"),x/T>.2&&R.push("brown"),S/T>.2&&R.push("silver"),I/T>.3&&R.push("dark");const k=f/T,N=p/T;k>150&&N>100&&N<180&&R.push("gold"),e(R)},t.src=n})}function HH(n){const e=[];for(const[t,i]of Object.entries($H)){let r=0;for(const s of n)i.colors.some(o=>o.includes(s)||s.includes(o))&&r++;r>0&&e.push({species:t,score:r/i.colors.length})}return e.sort((t,i)=>i.score-t.score)}async function XH(n){try{const e=await KH(n),t=HH(e);if(t.length===0)return{species:"",confidence:0,suggestions:vm.slice(0,5).map(o=>o.name)};const i=t[0],r=t.slice(0,5).map(o=>o.species),s=["Snoek","Baars","Karper","Snoekbaars","Brasem"];for(const o of s)!r.includes(o)&&r.length<5&&r.push(o);return{species:i.score>.3?i.species:"",confidence:i.score,suggestions:r.slice(0,5)}}catch(e){return console.error("Fish recognition error:",e),{species:"",confidence:0,suggestions:vm.slice(0,5).map(t=>t.name)}}}function qH(n){return{Snoek:{avgWeight:3e3,avgLength:70},Snoekbaars:{avgWeight:2500,avgLength:60},Baars:{avgWeight:500,avgLength:30},Karper:{avgWeight:8e3,avgLength:60},Brasem:{avgWeight:2e3,avgLength:45},Voorn:{avgWeight:300,avgLength:25},Zeelt:{avgWeight:1500,avgLength:40},Meerval:{avgWeight:15e3,avgLength:120},Aal:{avgWeight:800,avgLength:60},Forel:{avgWeight:1e3,avgLength:40},Kolblei:{avgWeight:500,avgLength:30},Winde:{avgWeight:1e3,avgLength:40},Kopvoorn:{avgWeight:800,avgLength:35},Ruisvoorn:{avgWeight:400,avgLength:25},Blankvoorn:{avgWeight:300,avgLength:25}}[n]||null}function YH({onClose:n,initialLocation:e,initialLocationSource:t,initialPhotos:i=[]}){const r=VP(ie=>ie.addCatch),s=Ld(ie=>ie.current),o=wi(ie=>ie.position),[l,u]=q.useState(e||(o?{lat:o.lat,lng:o.lng}:null)),[h,f]=q.useState(t||(o?"gps":null)),[p,y]=q.useState(""),[x,S]=q.useState(""),[I,T]=q.useState(""),[R,k]=q.useState(""),[N,M]=q.useState(""),[F,U]=q.useState(""),[P,A]=q.useState(i),[D,V]=q.useState(!1),[j,B]=q.useState([]),[L,le]=q.useState(0),pe=async ie=>{if(A(me=>[...me,ie]),ie.dataUrl&&!p){V(!0);try{const me=await XH(ie.dataUrl);if(B(me.suggestions),le(me.confidence),me.species&&me.confidence>.4){y(me.species);const xe=qH(me.species)}}catch(me){console.error("AI recognition failed:",me)}finally{V(!1)}}},ge=ie=>{y(ie),B([])},ue=ie=>{A(me=>me.filter(xe=>xe.id!==ie))},Q=()=>{o&&(u({lat:o.lat,lng:o.lng}),f("gps"))},se=ie=>{if(ie.preventDefault(),!p||!l){alert("Selecteer een vissoort en zorg dat er een locatie is");return}r({location:l,species:p,weight:x?parseInt(x):void 0,length:I?parseInt(I):void 0,photos:P.length>0?P:void 0,method:R||"Anders",bait:N||void 0,notes:F||void 0,weather:s?{temp:s.temperature,windSpeed:s.windSpeed,windDirection:s.windDirection,pressure:s.pressure}:void 0}),n()},W=(()=>{switch(h){case"gps":return{icon:RD,label:"GPS",color:"text-blue-500"};case"photo":return{icon:kw,label:"Foto EXIF",color:"text-green-500"};case"map":return{icon:_y,label:"Kaart",color:"text-orange-500"};default:return{icon:Al,label:"Locatie",color:"text-gray-500"}}})(),$=W.icon;return _.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(ze.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:ie=>ie.stopPropagation(),children:[_.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Ys,{className:"text-white",size:24}),_.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),_.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:_.jsx(Ji,{size:20})})]}),_.jsxs("form",{onSubmit:se,className:"p-4 space-y-4",children:[_.jsx("div",{className:"space-y-2",children:l?_.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-gray-50 p-2 rounded-lg",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx($,{size:16,className:W.color}),_.jsxs("span",{className:"text-gray-600",children:[l.lat.toFixed(5),", ",l.lng.toFixed(5)]})]}),_.jsx("span",{className:`text-xs ${W.color} font-medium`,children:W.label})]}):_.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-red-50 p-2 rounded-lg text-red-600",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Al,{size:16}),_.jsx("span",{children:"Geen locatie"})]}),o&&_.jsx("button",{type:"button",onClick:Q,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded-md border-0 outline-none",children:"Gebruik GPS"})]})}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:["Vissoort *",D&&_.jsxs("span",{className:"flex items-center gap-1 text-xs text-blue-500",children:[_.jsx(sK,{size:12,className:"animate-spin"}),"AI analyseert..."]})]}),_.jsx(Ii,{children:j.length>0&&!p&&_.jsxs(ze.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-2 p-2 bg-blue-50 rounded-lg border border-blue-200",children:[_.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mb-2",children:[_.jsx(GK,{size:12}),_.jsxs("span",{children:["AI suggesties ",L>.3?`(${Math.round(L*100)}% zeker)`:""]})]}),_.jsx("div",{className:"flex flex-wrap gap-1",children:j.map(ie=>_.jsx("button",{type:"button",onClick:()=>ge(ie),className:"px-2 py-1 text-xs bg-white border border-blue-300 text-blue-700 rounded-full hover:bg-blue-100 transition-colors",children:ie},ie))})]})}),_.jsxs("select",{value:p,onChange:ie=>{y(ie.target.value),B([])},className:"form-select",required:!0,children:[_.jsx("option",{value:"",children:"Selecteer vissoort..."}),vm.map(ie=>_.jsx("option",{value:ie.name,children:ie.name},ie.name))]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(OK,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),_.jsx("input",{type:"number",value:x,onChange:ie=>S(ie.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(NK,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),_.jsx("input",{type:"number",value:I,onChange:ie=>T(ie.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),_.jsxs("select",{value:R,onChange:ie=>k(ie.target.value),className:"form-select",children:[_.jsx("option",{value:"",children:"Selecteer methode..."}),BH.map(ie=>_.jsx("option",{value:ie,children:ie},ie))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),_.jsxs("select",{value:N,onChange:ie=>M(ie.target.value),className:"form-select",children:[_.jsx("option",{value:"",children:"Selecteer aas..."}),GH.map(ie=>_.jsx("option",{value:ie,children:ie},ie))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),_.jsx("textarea",{value:F,onChange:ie=>U(ie.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),_.jsx(WH,{photos:P,onAddPhoto:pe,onRemovePhoto:ue}),_.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function ZH(){const n=ii(h=>h.catchFormOpen),e=ii(h=>h.catchFormLocation),t=ii(h=>h.catchFormLocationSource),i=ii(h=>h.catchFormInitialPhotos),r=ii(h=>h.openCatchForm),s=ii(h=>h.closeCatchForm),o=wi(h=>h.position),l=Ut(h=>h.showCatchButton),u=()=>{o?r({location:{lat:o.lat,lng:o.lng},locationSource:"gps"}):r()};return _.jsxs(_.Fragment,{children:[l&&_.jsx(ze.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:u,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:_.jsx(Ys,{size:22,strokeWidth:2})}),_.jsx(Ii,{children:n&&_.jsx(YH,{onClose:s,initialLocation:e||void 0,initialLocationSource:t||void 0,initialPhotos:i})})]})}function QH(){const n=Js(r=>r.map),e=VP(r=>r.catches),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new I1,t.current=new M1({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=gl([r.location.lng,r.location.lat]),o=new ou({geometry:new pl(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new Zi({image:new kl({radius:14,fill:new Ir({color:"#22c55e"}),stroke:new Pu({color:"#fff",width:2})}),text:new rf({text:l,font:"bold 12px sans-serif",fill:new Ir({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function JH(){const n=Js(r=>r.map),e=jP(r=>r.spots),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new I1,t.current=new M1({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=gl([r.location.lng,r.location.lat]),o=new ou({geometry:new pl(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new Zi({image:new kl({radius:12,fill:new Ir({color:l}),stroke:new Pu({color:"#fff",width:2})}),text:new rf({text:"",font:"bold 14px sans-serif",fill:new Ir({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function eX({onClose:n,initialLocation:e}){const t=jP(T=>T.addSpot),[i,r]=q.useState(""),[s,o]=q.useState(""),[l,u]=q.useState([]),[h,f]=q.useState(""),[p,y]=q.useState(3),x=e,S=T=>{u(R=>R.includes(T)?R.filter(k=>k!==T):[...R,T])},I=T=>{if(T.preventDefault(),!i||!x){alert("Geef een naam op voor deze locatie");return}t({name:i,location:x,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:p}),n()};return _.jsx(ze.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(ze.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:T=>T.stopPropagation(),children:[_.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(vx,{className:"text-white",size:24}),_.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),_.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:_.jsx(Ji,{size:20})})]}),_.jsxs("form",{onSubmit:I,className:"p-4 space-y-4",children:[x&&_.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[_.jsx(Al,{size:16}),_.jsxs("span",{children:[x.lat.toFixed(5),", ",x.lng.toFixed(5)]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),_.jsx("input",{type:"text",value:i,onChange:T=>r(T.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),_.jsx("input",{type:"text",value:s,onChange:T=>o(T.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),_.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(T=>_.jsx("button",{type:"button",onClick:()=>y(T),className:"p-1 border-0 outline-none bg-transparent",children:_.jsx(vx,{size:28,className:T<=p?"text-yellow-400 fill-yellow-400":"text-gray-300"})},T))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),_.jsx("div",{className:"flex flex-wrap gap-2",children:vm.slice(0,12).map(T=>_.jsx("button",{type:"button",onClick:()=>S(T.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(T.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:T.name},T.name))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),_.jsx("textarea",{value:h,onChange:T=>f(T.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),_.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const tX=[{name:"Aanlegsteigers",icon:ED,color:"#2196F3"},{name:"Boothellingen",icon:UK,color:"#4CAF50"},{name:"Dieptekaart",icon:xx,color:"#00BCD4"},{name:"Viswater",icon:Al,color:"#9C27B0"}],NA=[{name:"OpenStreetMap",label:"Kaart"},{name:"Luchtfoto",label:"Satelliet"}];function nX(){const[n,e]=q.useState(!1),t=qo(l=>l.visible),i=qo(l=>l.toggleLayer),r=qo(l=>l.setLayerVisibility),s=l=>{NA.forEach(u=>{r(u.name,u.name===l)}),l==="Luchtfoto"?r("Labels Overlay",!0):r("Labels Overlay",!1)},o=()=>{r("Labels Overlay",!t["Labels Overlay"])};return _.jsxs("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:[_.jsx(ze.button,{className:"w-11 h-11 bg-white/90 hover:bg-white backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:_.jsx(_m,{size:22})}),_.jsx(Ii,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(ze.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),_.jsxs(ze.div,{className:"absolute bottom-12 right-0 bg-white rounded-xl shadow-lg overflow-hidden min-w-[200px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},children:[_.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Kaartlagen"})}),_.jsxs("div",{className:"p-2",children:[_.jsxs("div",{className:"mb-2 pb-2 border-b border-gray-100",children:[_.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Achtergrond"}),_.jsx("div",{className:"flex gap-1",children:NA.map(l=>_.jsx("button",{className:`flex-1 px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t[l.name]?"bg-blue-500 text-white":"bg-transparent text-gray-600 hover:bg-blue-50"}`,onClick:()=>s(l.name),children:l.label},l.name))}),t.Luchtfoto&&_.jsxs("button",{onClick:o,className:`mt-1.5 w-full flex items-center justify-between px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t["Labels Overlay"]?"bg-blue-50 text-blue-600":"bg-transparent text-gray-500 hover:bg-blue-50"}`,children:[_.jsxs("span",{className:"flex items-center gap-1.5",children:[_.jsx(XK,{size:12}),"Labels overlay"]}),t["Labels Overlay"]&&_.jsx(_x,{size:12})]})]}),_.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Kaartlagen"}),_.jsx("div",{className:"space-y-0.5",children:tX.map(l=>{const u=l.icon,h=t[l.name];return _.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-colors border-0 outline-none ${h?"bg-blue-50":"bg-transparent hover:bg-blue-50"}`,onClick:()=>i(l.name),children:[_.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center transition-colors",style:{backgroundColor:h?l.color:"#e5e7eb"},children:_.jsx(u,{size:14,className:"text-white"})}),_.jsx("span",{className:`text-sm ${h?"text-blue-700":"text-gray-600"}`,children:l.name}),_.jsx("div",{className:"ml-auto",children:_.jsx("div",{className:"w-4 h-4 rounded flex items-center justify-center transition-all",style:{backgroundColor:h?"#3b82f6":"transparent",border:h?"2px solid #3b82f6":"2px solid #93c5fd"},children:h&&_.jsx(_x,{size:10,className:"text-white",strokeWidth:3})})})]},l.name)})})]})]})]})})]})}function iX(){const n=ii(y=>y.settingsPanelOpen),e=ii(y=>y.toggleSettingsPanel),t=Ut(y=>y.showCatchButton),i=Ut(y=>y.setShowCatchButton),r=Ut(y=>y.showCatches),s=Ut(y=>y.setShowCatches),o=Ut(y=>y.showFavoriteSpots),l=Ut(y=>y.setShowFavoriteSpots),u=Ut(y=>y.defaultBackground),h=Ut(y=>y.setDefaultBackground),f=Ut(y=>y.showWeatherWidget),p=Ut(y=>y.setShowWeatherWidget);return n?_.jsx(ze.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:_.jsxs(ze.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:y=>y.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),_.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:_.jsx(Ji,{size:20,className:"text-white"})})]}),_.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),_.jsx(np,{icon:_.jsx(Ys,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),_.jsx(np,{icon:_.jsx(Ys,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),_.jsx(np,{icon:_.jsx(Al,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:_.jsx(_y,{size:18,className:"text-gray-500"})}),_.jsxs("div",{className:"flex-1",children:[_.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),_.jsxs("select",{value:u,onChange:y=>h(y.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-400",children:[_.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),_.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weer"}),_.jsx(np,{icon:_.jsx(dd,{size:18,className:"text-blue-400"}),label:"Weer widget",description:"Toon temperatuur, wind en luchtdruk",checked:f,onChange:p})]})]}),_.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function np({icon:n,label:e,description:t,checked:i,onChange:r}){return _.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),_.jsxs("div",{className:"flex-1",children:[_.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),_.jsx("p",{className:"text-xs text-gray-400",children:t})]}),_.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-blue-500":"bg-gray-300"}`,children:_.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function rX({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=xD(),[l,u]=q.useState(""),[h,f]=q.useState(!1),[p,y]=q.useState(!1),[x,S]=q.useState(null);if(q.useEffect(()=>{o()},[o]),s)return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center",children:_.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return _.jsx(_.Fragment,{children:n});const I=R=>{R.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},T=async()=>{try{S(null),await i()}catch{S("Google login mislukt"),setTimeout(()=>S(null),3e3)}};return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center p-4",children:_.jsxs(ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[_.jsxs("div",{className:"flex flex-col items-center mb-6",children:[_.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:_.jsx(Ys,{size:40,className:"text-white"})}),_.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),_.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),_.jsxs(ze.button,{onClick:T,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[_.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),_.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),_.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),_.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),x&&_.jsx(ze.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:x}),_.jsxs("div",{className:"flex items-center gap-3 my-4",children:[_.jsx("div",{className:"flex-1 h-px bg-gray-200"}),_.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),_.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),_.jsxs("form",{onSubmit:I,className:"space-y-4",children:[_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:_.jsx(cK,{size:20})}),_.jsx("input",{type:p?"text":"password",value:l,onChange:R=>u(R.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-blue-400"}`}),_.jsx("button",{type:"button",onClick:()=>y(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p?_.jsx(X$,{size:20}):_.jsx(Y$,{size:20})})]}),h&&_.jsx(ze.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),_.jsx(ze.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),_.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function sX(){const n=ii(i=>i.spotFormOpen),e=ii(i=>i.spotFormLocation),t=ii(i=>i.closeSpotForm);return _.jsx(rX,{children:_.jsxs("div",{className:"h-screen w-screen overflow-hidden",children:[_.jsx(w$,{}),_.jsx(gH,{}),_.jsx(QH,{}),_.jsx(JH,{}),_.jsx(uH,{}),_.jsx(MH,{}),_.jsx(LH,{}),_.jsx(jH,{}),_.jsx(UH,{}),_.jsx(pH,{}),_.jsx(yH,{}),_.jsx(AH,{}),_.jsx(SH,{}),_.jsx(nX,{}),_.jsx(ZH,{}),_.jsx(dH,{}),_.jsx(_H,{}),_.jsx(iX,{}),_.jsx(Ii,{children:n&&_.jsx(eX,{onClose:t,initialLocation:e||void 0})})]})})}const oX="1.2.5";console.log(`%c VisApp v${oX}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");qM.createRoot(document.getElementById("root")).render(_.jsx(sX,{}));export{vX as $,Db as A,Rt as B,kl as C,nt as D,Ge as E,Ir as F,S4 as G,bm as H,k5 as I,fl as J,Pb as K,Nb as L,fX as M,Lp as N,k4 as O,pX as P,Mb as Q,Hc as R,Zi as S,A6 as T,pl as U,I1 as V,hb as W,uX as X,hX as Y,gX as Z,xX as _,M1 as a,AI as a0,wj as a1,Ej as a2,_X as a3,yX as a4,Ad as a5,mX as a6,dX as a7,gr as a8,ou as a9,tt as aa,op as ab,Mp as ac,Yb as ad,bv as ae,su as af,I4 as ag,Pu as b,Bn as c,EX as d,Qi as e,ai as f,dt as g,dC as h,s1 as i,a6 as j,A0 as k,g1 as l,ol as m,r1 as n,ub as o,bb as p,kb as q,cX as r,b4 as s,Om as t,PI as u,$c as v,bI as w,P4 as x,y1 as y,m1 as z};
//# sourceMappingURL=index-BzlpKFYH.js.map
