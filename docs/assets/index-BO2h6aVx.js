const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-DnCOFawU.js","assets/GeoJSON-BqEpCaDU.js","assets/boothellingenOL-44x4W8zu.js","assets/dieptekaartOL-DVFFw_nX.js","assets/common-DpNHzTjJ.js","assets/viswaterOL-DNXDXYcT.js","assets/hillshadeLayers-o35ZrfoA.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Px(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Y0={exports:{}},Rh={},Z0={exports:{}},$e={};var YT;function QM(){if(YT)return $e;YT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function _(G){return G===null||typeof G!="object"?null:(G=p&&G[p]||G["@@iterator"],typeof G=="function"?G:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,C={};function T(G,$,ie){this.props=G,this.context=$,this.refs=C,this.updater=ie||x}T.prototype.isReactComponent={},T.prototype.setState=function(G,$){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,$,"setState")},T.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function b(){}b.prototype=T.prototype;function k(G,$,ie){this.props=G,this.context=$,this.refs=C,this.updater=ie||x}var A=k.prototype=new b;A.constructor=k,S(A,T.prototype),A.isPureReactComponent=!0;var L=Array.isArray,O=Object.prototype.hasOwnProperty,B={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function I(G,$,ie){var fe,ye={},Ie=null,Re=null;if($!=null)for(fe in $.ref!==void 0&&(Re=$.ref),$.key!==void 0&&(Ie=""+$.key),$)O.call($,fe)&&!M.hasOwnProperty(fe)&&(ye[fe]=$[fe]);var Me=arguments.length-2;if(Me===1)ye.children=ie;else if(1<Me){for(var Ge=Array(Me),ct=0;ct<Me;ct++)Ge[ct]=arguments[ct+2];ye.children=Ge}if(G&&G.defaultProps)for(fe in Me=G.defaultProps,Me)ye[fe]===void 0&&(ye[fe]=Me[fe]);return{$$typeof:n,type:G,key:Ie,ref:Re,props:ye,_owner:B.current}}function N(G,$){return{$$typeof:n,type:G.type,key:$,ref:G.ref,props:G.props,_owner:G._owner}}function F(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function V(G){var $={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(ie){return $[ie]})}var U=/\/+/g;function D(G,$){return typeof G=="object"&&G!==null&&G.key!=null?V(""+G.key):$.toString(36)}function se(G,$,ie,fe,ye){var Ie=typeof G;(Ie==="undefined"||Ie==="boolean")&&(G=null);var Re=!1;if(G===null)Re=!0;else switch(Ie){case"string":case"number":Re=!0;break;case"object":switch(G.$$typeof){case n:case e:Re=!0}}if(Re)return Re=G,ye=ye(Re),G=fe===""?"."+D(Re,0):fe,L(ye)?(ie="",G!=null&&(ie=G.replace(U,"$&/")+"/"),se(ye,$,ie,"",function(ct){return ct})):ye!=null&&(F(ye)&&(ye=N(ye,ie+(!ye.key||Re&&Re.key===ye.key?"":(""+ye.key).replace(U,"$&/")+"/")+G)),$.push(ye)),1;if(Re=0,fe=fe===""?".":fe+":",L(G))for(var Me=0;Me<G.length;Me++){Ie=G[Me];var Ge=fe+D(Ie,Me);Re+=se(Ie,$,ie,Ge,ye)}else if(Ge=_(G),typeof Ge=="function")for(G=Ge.call(G),Me=0;!(Ie=G.next()).done;)Ie=Ie.value,Ge=fe+D(Ie,Me++),Re+=se(Ie,$,ie,Ge,ye);else if(Ie==="object")throw $=String(G),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Re}function de(G,$,ie){if(G==null)return G;var fe=[],ye=0;return se(G,fe,"","",function(Ie){return $.call(ie,Ie,ye++)}),fe}function me(G){if(G._status===-1){var $=G._result;$=$(),$.then(function(ie){(G._status===0||G._status===-1)&&(G._status=1,G._result=ie)},function(ie){(G._status===0||G._status===-1)&&(G._status=2,G._result=ie)}),G._status===-1&&(G._status=0,G._result=$)}if(G._status===1)return G._result.default;throw G._result}var ue={current:null},J={transition:null},Z={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:J,ReactCurrentOwner:B};function ne(){throw Error("act(...) is not supported in production builds of React.")}return $e.Children={map:de,forEach:function(G,$,ie){de(G,function(){$.apply(this,arguments)},ie)},count:function(G){var $=0;return de(G,function(){$++}),$},toArray:function(G){return de(G,function($){return $})||[]},only:function(G){if(!F(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},$e.Component=T,$e.Fragment=t,$e.Profiler=r,$e.PureComponent=k,$e.StrictMode=i,$e.Suspense=u,$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z,$e.act=ne,$e.cloneElement=function(G,$,ie){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var fe=S({},G.props),ye=G.key,Ie=G.ref,Re=G._owner;if($!=null){if($.ref!==void 0&&(Ie=$.ref,Re=B.current),$.key!==void 0&&(ye=""+$.key),G.type&&G.type.defaultProps)var Me=G.type.defaultProps;for(Ge in $)O.call($,Ge)&&!M.hasOwnProperty(Ge)&&(fe[Ge]=$[Ge]===void 0&&Me!==void 0?Me[Ge]:$[Ge])}var Ge=arguments.length-2;if(Ge===1)fe.children=ie;else if(1<Ge){Me=Array(Ge);for(var ct=0;ct<Ge;ct++)Me[ct]=arguments[ct+2];fe.children=Me}return{$$typeof:n,type:G.type,key:ye,ref:Ie,props:fe,_owner:Re}},$e.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:s,_context:G},G.Consumer=G},$e.createElement=I,$e.createFactory=function(G){var $=I.bind(null,G);return $.type=G,$},$e.createRef=function(){return{current:null}},$e.forwardRef=function(G){return{$$typeof:l,render:G}},$e.isValidElement=F,$e.lazy=function(G){return{$$typeof:f,_payload:{_status:-1,_result:G},_init:me}},$e.memo=function(G,$){return{$$typeof:h,type:G,compare:$===void 0?null:$}},$e.startTransition=function(G){var $=J.transition;J.transition={};try{G()}finally{J.transition=$}},$e.unstable_act=ne,$e.useCallback=function(G,$){return ue.current.useCallback(G,$)},$e.useContext=function(G){return ue.current.useContext(G)},$e.useDebugValue=function(){},$e.useDeferredValue=function(G){return ue.current.useDeferredValue(G)},$e.useEffect=function(G,$){return ue.current.useEffect(G,$)},$e.useId=function(){return ue.current.useId()},$e.useImperativeHandle=function(G,$,ie){return ue.current.useImperativeHandle(G,$,ie)},$e.useInsertionEffect=function(G,$){return ue.current.useInsertionEffect(G,$)},$e.useLayoutEffect=function(G,$){return ue.current.useLayoutEffect(G,$)},$e.useMemo=function(G,$){return ue.current.useMemo(G,$)},$e.useReducer=function(G,$,ie){return ue.current.useReducer(G,$,ie)},$e.useRef=function(G){return ue.current.useRef(G)},$e.useState=function(G){return ue.current.useState(G)},$e.useSyncExternalStore=function(G,$,ie){return ue.current.useSyncExternalStore(G,$,ie)},$e.useTransition=function(){return ue.current.useTransition()},$e.version="18.3.1",$e}var ZT;function Qd(){return ZT||(ZT=1,Z0.exports=QM()),Z0.exports}var QT;function JM(){if(QT)return Rh;QT=1;var n=Qd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var f,p={},_=null,x=null;h!==void 0&&(_=""+h),u.key!==void 0&&(_=""+u.key),u.ref!==void 0&&(x=u.ref);for(f in u)i.call(u,f)&&!s.hasOwnProperty(f)&&(p[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)p[f]===void 0&&(p[f]=u[f]);return{$$typeof:e,type:l,key:_,ref:x,props:p,_owner:r.current}}return Rh.Fragment=t,Rh.jsx=o,Rh.jsxs=o,Rh}var JT;function eL(){return JT||(JT=1,Y0.exports=JM()),Y0.exports}var y=eL(),Dg={},Q0={exports:{}},ei={},J0={exports:{}},e_={};var eS;function tL(){return eS||(eS=1,(function(n){function e(J,Z){var ne=J.length;J.push(Z);e:for(;0<ne;){var G=ne-1>>>1,$=J[G];if(0<r($,Z))J[G]=Z,J[ne]=$,ne=G;else break e}}function t(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var Z=J[0],ne=J.pop();if(ne!==Z){J[0]=ne;e:for(var G=0,$=J.length,ie=$>>>1;G<ie;){var fe=2*(G+1)-1,ye=J[fe],Ie=fe+1,Re=J[Ie];if(0>r(ye,ne))Ie<$&&0>r(Re,ye)?(J[G]=Re,J[Ie]=ne,G=Ie):(J[G]=ye,J[fe]=ne,G=fe);else if(Ie<$&&0>r(Re,ne))J[G]=Re,J[Ie]=ne,G=Ie;else break e}}return Z}function r(J,Z){var ne=J.sortIndex-Z.sortIndex;return ne!==0?ne:J.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,p=null,_=3,x=!1,S=!1,C=!1,T=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(J){for(var Z=t(h);Z!==null;){if(Z.callback===null)i(h);else if(Z.startTime<=J)i(h),Z.sortIndex=Z.expirationTime,e(u,Z);else break;Z=t(h)}}function L(J){if(C=!1,A(J),!S)if(t(u)!==null)S=!0,me(O);else{var Z=t(h);Z!==null&&ue(L,Z.startTime-J)}}function O(J,Z){S=!1,C&&(C=!1,b(I),I=-1),x=!0;var ne=_;try{for(A(Z),p=t(u);p!==null&&(!(p.expirationTime>Z)||J&&!V());){var G=p.callback;if(typeof G=="function"){p.callback=null,_=p.priorityLevel;var $=G(p.expirationTime<=Z);Z=n.unstable_now(),typeof $=="function"?p.callback=$:p===t(u)&&i(u),A(Z)}else i(u);p=t(u)}if(p!==null)var ie=!0;else{var fe=t(h);fe!==null&&ue(L,fe.startTime-Z),ie=!1}return ie}finally{p=null,_=ne,x=!1}}var B=!1,M=null,I=-1,N=5,F=-1;function V(){return!(n.unstable_now()-F<N)}function U(){if(M!==null){var J=n.unstable_now();F=J;var Z=!0;try{Z=M(!0,J)}finally{Z?D():(B=!1,M=null)}}else B=!1}var D;if(typeof k=="function")D=function(){k(U)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,de=se.port2;se.port1.onmessage=U,D=function(){de.postMessage(null)}}else D=function(){T(U,0)};function me(J){M=J,B||(B=!0,D())}function ue(J,Z){I=T(function(){J(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_continueExecution=function(){S||x||(S=!0,me(O))},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(J){switch(_){case 1:case 2:case 3:var Z=3;break;default:Z=_}var ne=_;_=Z;try{return J()}finally{_=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(J,Z){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var ne=_;_=J;try{return Z()}finally{_=ne}},n.unstable_scheduleCallback=function(J,Z,ne){var G=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?G+ne:G):ne=G,J){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,J={id:f++,callback:Z,priorityLevel:J,startTime:ne,expirationTime:$,sortIndex:-1},ne>G?(J.sortIndex=ne,e(h,J),t(u)===null&&J===t(h)&&(C?(b(I),I=-1):C=!0,ue(L,ne-G))):(J.sortIndex=$,e(u,J),S||x||(S=!0,me(O))),J},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(J){var Z=_;return function(){var ne=_;_=Z;try{return J.apply(this,arguments)}finally{_=ne}}}})(e_)),e_}var tS;function nL(){return tS||(tS=1,J0.exports=tL()),J0.exports}var nS;function iL(){if(nS)return ei;nS=1;var n=Qd(),e=nL();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)i.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function _(a){return u.call(p,a)?!0:u.call(f,a)?!1:h.test(a)?p[a]=!0:(f[a]=!0,!1)}function x(a,c,d,m){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return m?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function S(a,c,d,m){if(c===null||typeof c>"u"||x(a,c,d,m))return!0;if(m)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function C(a,c,d,m,v,w,P){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=w,this.removeEmptyString=P}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){T[a]=new C(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];T[c]=new C(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){T[a]=new C(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){T[a]=new C(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){T[a]=new C(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){T[a]=new C(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){T[a]=new C(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){T[a]=new C(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){T[a]=new C(a,5,!1,a.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function k(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(b,k);T[c]=new C(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(b,k);T[c]=new C(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(b,k);T[c]=new C(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){T[a]=new C(a,1,!1,a.toLowerCase(),null,!1,!1)}),T.xlinkHref=new C("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){T[a]=new C(a,1,!1,a.toLowerCase(),null,!0,!0)});function A(a,c,d,m){var v=T.hasOwnProperty(c)?T[c]:null;(v!==null?v.type!==0:m||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(S(c,d,v,m)&&(d=null),m||v===null?_(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):v.mustUseProperty?a[v.propertyName]=d===null?v.type===3?!1:"":d:(c=v.attributeName,m=v.attributeNamespace,d===null?a.removeAttribute(c):(v=v.type,d=v===3||v===4&&d===!0?"":""+d,m?a.setAttributeNS(m,c,d):a.setAttribute(c,d))))}var L=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),B=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),V=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),de=Symbol.for("react.memo"),me=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),J=Symbol.iterator;function Z(a){return a===null||typeof a!="object"?null:(a=J&&a[J]||a["@@iterator"],typeof a=="function"?a:null)}var ne=Object.assign,G;function $(a){if(G===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);G=c&&c[1]||""}return`
`+G+a}var ie=!1;function fe(a,c){if(!a||ie)return"";ie=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(ee){var m=ee}Reflect.construct(a,[],c)}else{try{c.call()}catch(ee){m=ee}a.call(c.prototype)}else{try{throw Error()}catch(ee){m=ee}a()}}catch(ee){if(ee&&m&&typeof ee.stack=="string"){for(var v=ee.stack.split(`
`),w=m.stack.split(`
`),P=v.length-1,z=w.length-1;1<=P&&0<=z&&v[P]!==w[z];)z--;for(;1<=P&&0<=z;P--,z--)if(v[P]!==w[z]){if(P!==1||z!==1)do if(P--,z--,0>z||v[P]!==w[z]){var W=`
`+v[P].replace(" at new "," at ");return a.displayName&&W.includes("<anonymous>")&&(W=W.replace("<anonymous>",a.displayName)),W}while(1<=P&&0<=z);break}}}finally{ie=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?$(a):""}function ye(a){switch(a.tag){case 5:return $(a.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return a=fe(a.type,!1),a;case 11:return a=fe(a.type.render,!1),a;case 1:return a=fe(a.type,!0),a;default:return""}}function Ie(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case M:return"Fragment";case B:return"Portal";case N:return"Profiler";case I:return"StrictMode";case D:return"Suspense";case se:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case V:return(a.displayName||"Context")+".Consumer";case F:return(a._context.displayName||"Context")+".Provider";case U:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case de:return c=a.displayName||null,c!==null?c:Ie(a.type)||"Memo";case me:c=a._payload,a=a._init;try{return Ie(a(c))}catch{}}return null}function Re(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ie(c);case 8:return c===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Me(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ge(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ct(a){var c=Ge(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),m=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,w=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return v.call(this)},set:function(P){m=""+P,w.call(this,P)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(P){m=""+P},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function tr(a){a._valueTracker||(a._valueTracker=ct(a))}function ps(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),m="";return a&&(m=Ge(a)?a.checked?"true":"false":a.value),a=m,a!==d?(c.setValue(a),!0):!1}function Hn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Kn(a,c){var d=c.checked;return ne({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function hn(a,c){var d=c.defaultValue==null?"":c.defaultValue,m=c.checked!=null?c.checked:c.defaultChecked;d=Me(c.value!=null?c.value:d),a._wrapperState={initialChecked:m,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function dn(a,c){c=c.checked,c!=null&&A(a,"checked",c,!1)}function qn(a,c){dn(a,c);var d=Me(c.value),m=c.type;if(d!=null)m==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(m==="submit"||m==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?_t(a,c.type,d):c.hasOwnProperty("defaultValue")&&_t(a,c.type,Me(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Pi(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var m=c.type;if(!(m!=="submit"&&m!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function _t(a,c,d){(c!=="number"||Hn(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ut=Array.isArray;function nn(a,c,d,m){if(a=a.options,c){c={};for(var v=0;v<d.length;v++)c["$"+d[v]]=!0;for(d=0;d<a.length;d++)v=c.hasOwnProperty("$"+a[d].value),a[d].selected!==v&&(a[d].selected=v),v&&m&&(a[d].defaultSelected=!0)}else{for(d=""+Me(d),c=null,v=0;v<a.length;v++){if(a[v].value===d){a[v].selected=!0,m&&(a[v].defaultSelected=!0);return}c!==null||a[v].disabled||(c=a[v])}c!==null&&(c.selected=!0)}}function ki(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function It(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(t(92));if(ut(d)){if(1<d.length)throw Error(t(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:Me(d)}}function io(a,c){var d=Me(c.value),m=Me(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),m!=null&&(a.defaultValue=""+m)}function Ni(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function Ar(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nr(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?Ar(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Pr,ua=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,m,v){MSApp.execUnsafeLocalFunction(function(){return a(c,d,m,v)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(Pr=Pr||document.createElement("div"),Pr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Pr.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function kr(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var Di={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ol=["Webkit","ms","Moz","O"];Object.keys(Di).forEach(function(a){Ol.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Di[c]=Di[a]})});function Nr(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||Di.hasOwnProperty(a)&&Di[a]?(""+c).trim():c+"px"}function ms(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var m=d.indexOf("--")===0,v=Nr(d,c[d],m);d==="float"&&(d="cssFloat"),m?a.setProperty(d,v):a[d]=v}}var ro=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fn(a,c){if(c){if(ro[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function ys(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dr=null;function Mr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Vn=null,zn=null,gt=null;function so(a){if(a=dh(a)){if(typeof Vn!="function")throw Error(t(280));var c=a.stateNode;c&&(c=qf(c),Vn(a.stateNode,a.type,c))}}function ir(a){zn?gt?gt.push(a):gt=[a]:zn=a}function jt(){if(zn){var a=zn,c=gt;if(gt=zn=null,so(a),c)for(a=0;a<c.length;a++)so(c[a])}}function Mi(a,c){return a(c)}function fn(){}var Ft=!1;function gn(a,c,d){if(Ft)return a(c,d);Ft=!0;try{return Mi(a,c,d)}finally{Ft=!1,(zn!==null||gt!==null)&&(fn(),jt())}}function pn(a,c){var d=a.stateNode;if(d===null)return null;var m=qf(d);if(m===null)return null;d=m[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,c,typeof d));return d}var rn=!1;if(l)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){rn=!0}}),window.addEventListener("test",rt,rt),window.removeEventListener("test",rt,rt)}catch{rn=!1}function Gt(a,c,d,m,v,w,P,z,W){var ee=Array.prototype.slice.call(arguments,3);try{c.apply(d,ee)}catch(ae){this.onError(ae)}}var Xt=!1,Li=null,jl=!1,Oi=null,Cf={onError:function(a){Xt=!0,Li=a}};function Rf(a,c,d,m,v,w,P,z,W){Xt=!1,Li=null,Gt.apply(Cf,arguments)}function zu(a,c,d,m,v,w,P,z,W){if(Rf.apply(this,arguments),Xt){if(Xt){var ee=Li;Xt=!1,Li=null}else throw Error(t(198));jl||(jl=!0,Oi=ee)}}function rr(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function Uu(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function bf(a){if(rr(a)!==a)throw Error(t(188))}function Af(a){var c=a.alternate;if(!c){if(c=rr(a),c===null)throw Error(t(188));return c!==a?null:a}for(var d=a,m=c;;){var v=d.return;if(v===null)break;var w=v.alternate;if(w===null){if(m=v.return,m!==null){d=m;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===d)return bf(v),a;if(w===m)return bf(v),c;w=w.sibling}throw Error(t(188))}if(d.return!==m.return)d=v,m=w;else{for(var P=!1,z=v.child;z;){if(z===d){P=!0,d=v,m=w;break}if(z===m){P=!0,m=v,d=w;break}z=z.sibling}if(!P){for(z=w.child;z;){if(z===d){P=!0,d=w,m=v;break}if(z===m){P=!0,m=w,d=v;break}z=z.sibling}if(!P)throw Error(t(189))}}if(d.alternate!==m)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:c}function Pf(a){return a=Af(a),a!==null?ha(a):null}function ha(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=ha(a);if(c!==null)return c;a=a.sibling}return null}var Bu=e.unstable_scheduleCallback,Fl=e.unstable_cancelCallback,da=e.unstable_shouldYield,_s=e.unstable_requestPaint,xt=e.unstable_now,Ry=e.unstable_getCurrentPriorityLevel,Vl=e.unstable_ImmediatePriority,Gu=e.unstable_UserBlockingPriority,fa=e.unstable_NormalPriority,Wu=e.unstable_LowPriority,zl=e.unstable_IdlePriority,ga=null,fi=null;function kf(a){if(fi&&typeof fi.onCommitFiberRoot=="function")try{fi.onCommitFiberRoot(ga,a,void 0,(a.current.flags&128)===128)}catch{}}var gi=Math.clz32?Math.clz32:pa,Lr=Math.log,ji=Math.LN2;function pa(a){return a>>>=0,a===0?32:31-(Lr(a)/ji|0)|0}var Or=64,oo=4194304;function st(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function vs(a,c){var d=a.pendingLanes;if(d===0)return 0;var m=0,v=a.suspendedLanes,w=a.pingedLanes,P=d&268435455;if(P!==0){var z=P&~v;z!==0?m=st(z):(w&=P,w!==0&&(m=st(w)))}else P=d&~v,P!==0?m=st(P):w!==0&&(m=st(w));if(m===0)return 0;if(c!==0&&c!==m&&(c&v)===0&&(v=m&-m,w=c&-c,v>=w||v===16&&(w&4194240)!==0))return c;if((m&4)!==0&&(m|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=m;0<c;)d=31-gi(c),v=1<<d,m|=a[d],c&=~v;return m}function ma(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ya(a,c){for(var d=a.suspendedLanes,m=a.pingedLanes,v=a.expirationTimes,w=a.pendingLanes;0<w;){var P=31-gi(w),z=1<<P,W=v[P];W===-1?((z&d)===0||(z&m)!==0)&&(v[P]=ma(z,c)):W<=c&&(a.expiredLanes|=z),w&=~z}}function $u(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Hu(){var a=Or;return Or<<=1,(Or&4194240)===0&&(Or=64),a}function Ku(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function _a(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-gi(c),a[c]=d}function by(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var m=a.eventTimes;for(a=a.expirationTimes;0<d;){var v=31-gi(d),w=1<<v;c[v]=0,m[v]=-1,a[v]=-1,d&=~w}}function qu(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var m=31-gi(d),v=1<<m;v&c|a[m]&c&&(a[m]|=c),d&=~v}}var qe=0;function jr(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Xu,Ul,Yu,Zu,Qu,Fr=!1,Bl=[],Vr=null,zr=null,mn=null,va=new Map,xs=new Map,pi=[],Nf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ao(a,c){switch(a){case"focusin":case"focusout":Vr=null;break;case"dragenter":case"dragleave":zr=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":va.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":xs.delete(c.pointerId)}}function sr(a,c,d,m,v,w){return a===null||a.nativeEvent!==w?(a={blockedOn:c,domEventName:d,eventSystemFlags:m,nativeEvent:w,targetContainers:[v]},c!==null&&(c=dh(c),c!==null&&Ul(c)),a):(a.eventSystemFlags|=m,c=a.targetContainers,v!==null&&c.indexOf(v)===-1&&c.push(v),a)}function Df(a,c,d,m,v){switch(c){case"focusin":return Vr=sr(Vr,a,c,d,m,v),!0;case"dragenter":return zr=sr(zr,a,c,d,m,v),!0;case"mouseover":return mn=sr(mn,a,c,d,m,v),!0;case"pointerover":var w=v.pointerId;return va.set(w,sr(va.get(w)||null,a,c,d,m,v)),!0;case"gotpointercapture":return w=v.pointerId,xs.set(w,sr(xs.get(w)||null,a,c,d,m,v)),!0}return!1}function Gl(a){var c=Ta(a.target);if(c!==null){var d=rr(c);if(d!==null){if(c=d.tag,c===13){if(c=Uu(d),c!==null){a.blockedOn=c,Qu(a.priority,function(){Yu(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function mt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=Wl(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var m=new d.constructor(d.type,d);Dr=m,d.target.dispatchEvent(m),Dr=null}else return c=dh(d),c!==null&&Ul(c),a.blockedOn=d,!1;c.shift()}return!0}function Mf(a,c,d){mt(a)&&d.delete(c)}function Ay(){Fr=!1,Vr!==null&&mt(Vr)&&(Vr=null),zr!==null&&mt(zr)&&(zr=null),mn!==null&&mt(mn)&&(mn=null),va.forEach(Mf),xs.forEach(Mf)}function lo(a,c){a.blockedOn===c&&(a.blockedOn=null,Fr||(Fr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ay)))}function co(a){function c(v){return lo(v,a)}if(0<Bl.length){lo(Bl[0],a);for(var d=1;d<Bl.length;d++){var m=Bl[d];m.blockedOn===a&&(m.blockedOn=null)}}for(Vr!==null&&lo(Vr,a),zr!==null&&lo(zr,a),mn!==null&&lo(mn,a),va.forEach(c),xs.forEach(c),d=0;d<pi.length;d++)m=pi[d],m.blockedOn===a&&(m.blockedOn=null);for(;0<pi.length&&(d=pi[0],d.blockedOn===null);)Gl(d),d.blockedOn===null&&pi.shift()}var ws=L.ReactCurrentBatchConfig,Es=!0;function Ur(a,c,d,m){var v=qe,w=ws.transition;ws.transition=null;try{qe=1,Ju(a,c,d,m)}finally{qe=v,ws.transition=w}}function Lf(a,c,d,m){var v=qe,w=ws.transition;ws.transition=null;try{qe=4,Ju(a,c,d,m)}finally{qe=v,ws.transition=w}}function Ju(a,c,d,m){if(Es){var v=Wl(a,c,d,m);if(v===null)zy(a,c,m,Br,d),ao(a,m);else if(Df(v,a,c,d,m))m.stopPropagation();else if(ao(a,m),c&4&&-1<Nf.indexOf(a)){for(;v!==null;){var w=dh(v);if(w!==null&&Xu(w),w=Wl(a,c,d,m),w===null&&zy(a,c,m,Br,d),w===v)break;v=w}v!==null&&m.stopPropagation()}else zy(a,c,m,null,d)}}var Br=null;function Wl(a,c,d,m){if(Br=null,a=Mr(m),a=Ta(a),a!==null)if(c=rr(a),c===null)a=null;else if(d=c.tag,d===13){if(a=Uu(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return Br=a,null}function $l(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ry()){case Vl:return 1;case Gu:return 4;case fa:case Wu:return 16;case zl:return 536870912;default:return 16}default:return 16}}var mi=null,Hl=null,Ts=null;function Of(){if(Ts)return Ts;var a,c=Hl,d=c.length,m,v="value"in mi?mi.value:mi.textContent,w=v.length;for(a=0;a<d&&c[a]===v[a];a++);var P=d-a;for(m=1;m<=P&&c[d-m]===v[w-m];m++);return Ts=v.slice(a,1<m?1-m:void 0)}function xa(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Gr(){return!0}function eh(){return!1}function Cn(a){function c(d,m,v,w,P){this._reactName=d,this._targetInst=v,this.type=m,this.nativeEvent=w,this.target=P,this.currentTarget=null;for(var z in a)a.hasOwnProperty(z)&&(d=a[z],this[z]=d?d(w):w[z]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Gr:eh,this.isPropagationStopped=eh,this}return ne(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Gr)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Gr)},persist:function(){},isPersistent:Gr}),c}var Wr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wa=Cn(Wr),uo=ne({},Wr,{view:0,detail:0}),Kl=Cn(uo),ql,Xl,yi,Ea=ne({},uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ze,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==yi&&(yi&&a.type==="mousemove"?(ql=a.screenX-yi.screenX,Xl=a.screenY-yi.screenY):Xl=ql=0,yi=a),ql)},movementY:function(a){return"movementY"in a?a.movementY:Xl}}),th=Cn(Ea),jf=ne({},Ea,{dataTransfer:0}),Ff=Cn(jf),Yl=ne({},uo,{relatedTarget:0}),yn=Cn(Yl),Vf=ne({},Wr,{animationName:0,elapsedTime:0,pseudoElement:0}),zf=Cn(Vf),ho=ne({},Wr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=Cn(ho),E=ne({},Wr,{data:0}),R=Cn(E),j={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},te={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ge(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=te[a])?!!c[a]:!1}function ze(){return ge}var Vt=ne({},uo,{key:function(a){if(a.key){var c=j[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=xa(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?X[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ze,charCode:function(a){return a.type==="keypress"?xa(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?xa(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ht=Cn(Vt),Wt=ne({},Ea,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_i=Cn(Wt),Ss=ne({},uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ze}),$r=Cn(Ss),Hr=ne({},Wr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zl=Cn(Hr),nh=ne({},Ea,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),HD=Cn(nh),KD=[9,13,27,32],Py=l&&"CompositionEvent"in window,ih=null;l&&"documentMode"in document&&(ih=document.documentMode);var qD=l&&"TextEvent"in window&&!ih,Bw=l&&(!Py||ih&&8<ih&&11>=ih),Gw=" ",Ww=!1;function $w(a,c){switch(a){case"keyup":return KD.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hw(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ql=!1;function XD(a,c){switch(a){case"compositionend":return Hw(c);case"keypress":return c.which!==32?null:(Ww=!0,Gw);case"textInput":return a=c.data,a===Gw&&Ww?null:a;default:return null}}function YD(a,c){if(Ql)return a==="compositionend"||!Py&&$w(a,c)?(a=Of(),Ts=Hl=mi=null,Ql=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Bw&&c.locale!=="ko"?null:c.data;default:return null}}var ZD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kw(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!ZD[a.type]:c==="textarea"}function qw(a,c,d,m){ir(m),c=$f(c,"onChange"),0<c.length&&(d=new wa("onChange","change",null,d,m),a.push({event:d,listeners:c}))}var rh=null,sh=null;function QD(a){dE(a,0)}function Uf(a){var c=ic(a);if(ps(c))return a}function JD(a,c){if(a==="change")return c}var Xw=!1;if(l){var ky;if(l){var Ny="oninput"in document;if(!Ny){var Yw=document.createElement("div");Yw.setAttribute("oninput","return;"),Ny=typeof Yw.oninput=="function"}ky=Ny}else ky=!1;Xw=ky&&(!document.documentMode||9<document.documentMode)}function Zw(){rh&&(rh.detachEvent("onpropertychange",Qw),sh=rh=null)}function Qw(a){if(a.propertyName==="value"&&Uf(sh)){var c=[];qw(c,sh,a,Mr(a)),gn(QD,c)}}function eM(a,c,d){a==="focusin"?(Zw(),rh=c,sh=d,rh.attachEvent("onpropertychange",Qw)):a==="focusout"&&Zw()}function tM(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Uf(sh)}function nM(a,c){if(a==="click")return Uf(c)}function iM(a,c){if(a==="input"||a==="change")return Uf(c)}function rM(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var or=typeof Object.is=="function"?Object.is:rM;function oh(a,c){if(or(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),m=Object.keys(c);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var v=d[m];if(!u.call(c,v)||!or(a[v],c[v]))return!1}return!0}function Jw(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function eE(a,c){var d=Jw(a);a=0;for(var m;d;){if(d.nodeType===3){if(m=a+d.textContent.length,a<=c&&m>=c)return{node:d,offset:c-a};a=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Jw(d)}}function tE(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?tE(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function nE(){for(var a=window,c=Hn();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=Hn(a.document)}return c}function Dy(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function sM(a){var c=nE(),d=a.focusedElem,m=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&tE(d.ownerDocument.documentElement,d)){if(m!==null&&Dy(d)){if(c=m.start,a=m.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var v=d.textContent.length,w=Math.min(m.start,v);m=m.end===void 0?w:Math.min(m.end,v),!a.extend&&w>m&&(v=m,m=w,w=v),v=eE(d,w);var P=eE(d,m);v&&P&&(a.rangeCount!==1||a.anchorNode!==v.node||a.anchorOffset!==v.offset||a.focusNode!==P.node||a.focusOffset!==P.offset)&&(c=c.createRange(),c.setStart(v.node,v.offset),a.removeAllRanges(),w>m?(a.addRange(c),a.extend(P.node,P.offset)):(c.setEnd(P.node,P.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var oM=l&&"documentMode"in document&&11>=document.documentMode,Jl=null,My=null,ah=null,Ly=!1;function iE(a,c,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Ly||Jl==null||Jl!==Hn(m)||(m=Jl,"selectionStart"in m&&Dy(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),ah&&oh(ah,m)||(ah=m,m=$f(My,"onSelect"),0<m.length&&(c=new wa("onSelect","select",null,c,d),a.push({event:c,listeners:m}),c.target=Jl)))}function Bf(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var ec={animationend:Bf("Animation","AnimationEnd"),animationiteration:Bf("Animation","AnimationIteration"),animationstart:Bf("Animation","AnimationStart"),transitionend:Bf("Transition","TransitionEnd")},Oy={},rE={};l&&(rE=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function Gf(a){if(Oy[a])return Oy[a];if(!ec[a])return a;var c=ec[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in rE)return Oy[a]=c[d];return a}var sE=Gf("animationend"),oE=Gf("animationiteration"),aE=Gf("animationstart"),lE=Gf("transitionend"),cE=new Map,uE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fo(a,c){cE.set(a,c),s(c,[a])}for(var jy=0;jy<uE.length;jy++){var Fy=uE[jy],aM=Fy.toLowerCase(),lM=Fy[0].toUpperCase()+Fy.slice(1);fo(aM,"on"+lM)}fo(sE,"onAnimationEnd"),fo(oE,"onAnimationIteration"),fo(aE,"onAnimationStart"),fo("dblclick","onDoubleClick"),fo("focusin","onFocus"),fo("focusout","onBlur"),fo(lE,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cM=new Set("cancel close invalid load scroll toggle".split(" ").concat(lh));function hE(a,c,d){var m=a.type||"unknown-event";a.currentTarget=d,zu(m,c,void 0,a),a.currentTarget=null}function dE(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var m=a[d],v=m.event;m=m.listeners;e:{var w=void 0;if(c)for(var P=m.length-1;0<=P;P--){var z=m[P],W=z.instance,ee=z.currentTarget;if(z=z.listener,W!==w&&v.isPropagationStopped())break e;hE(v,z,ee),w=W}else for(P=0;P<m.length;P++){if(z=m[P],W=z.instance,ee=z.currentTarget,z=z.listener,W!==w&&v.isPropagationStopped())break e;hE(v,z,ee),w=W}}}if(jl)throw a=Oi,jl=!1,Oi=null,a}function wt(a,c){var d=c[Hy];d===void 0&&(d=c[Hy]=new Set);var m=a+"__bubble";d.has(m)||(fE(c,a,2,!1),d.add(m))}function Vy(a,c,d){var m=0;c&&(m|=4),fE(d,a,m,c)}var Wf="_reactListening"+Math.random().toString(36).slice(2);function ch(a){if(!a[Wf]){a[Wf]=!0,i.forEach(function(d){d!=="selectionchange"&&(cM.has(d)||Vy(d,!1,a),Vy(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Wf]||(c[Wf]=!0,Vy("selectionchange",!1,c))}}function fE(a,c,d,m){switch($l(c)){case 1:var v=Ur;break;case 4:v=Lf;break;default:v=Ju}d=v.bind(null,c,d,a),v=void 0,!rn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(v=!0),m?v!==void 0?a.addEventListener(c,d,{capture:!0,passive:v}):a.addEventListener(c,d,!0):v!==void 0?a.addEventListener(c,d,{passive:v}):a.addEventListener(c,d,!1)}function zy(a,c,d,m,v){var w=m;if((c&1)===0&&(c&2)===0&&m!==null)e:for(;;){if(m===null)return;var P=m.tag;if(P===3||P===4){var z=m.stateNode.containerInfo;if(z===v||z.nodeType===8&&z.parentNode===v)break;if(P===4)for(P=m.return;P!==null;){var W=P.tag;if((W===3||W===4)&&(W=P.stateNode.containerInfo,W===v||W.nodeType===8&&W.parentNode===v))return;P=P.return}for(;z!==null;){if(P=Ta(z),P===null)return;if(W=P.tag,W===5||W===6){m=w=P;continue e}z=z.parentNode}}m=m.return}gn(function(){var ee=w,ae=Mr(d),ce=[];e:{var oe=cE.get(a);if(oe!==void 0){var _e=wa,xe=a;switch(a){case"keypress":if(xa(d)===0)break e;case"keydown":case"keyup":_e=ht;break;case"focusin":xe="focus",_e=yn;break;case"focusout":xe="blur",_e=yn;break;case"beforeblur":case"afterblur":_e=yn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=th;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=Ff;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=$r;break;case sE:case oE:case aE:_e=zf;break;case lE:_e=Zl;break;case"scroll":_e=Kl;break;case"wheel":_e=HD;break;case"copy":case"cut":case"paste":_e=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=_i}var we=(c&4)!==0,zt=!we&&a==="scroll",q=we?oe!==null?oe+"Capture":null:oe;we=[];for(var H=ee,Y;H!==null;){Y=H;var he=Y.stateNode;if(Y.tag===5&&he!==null&&(Y=he,q!==null&&(he=pn(H,q),he!=null&&we.push(uh(H,he,Y)))),zt)break;H=H.return}0<we.length&&(oe=new _e(oe,xe,null,d,ae),ce.push({event:oe,listeners:we}))}}if((c&7)===0){e:{if(oe=a==="mouseover"||a==="pointerover",_e=a==="mouseout"||a==="pointerout",oe&&d!==Dr&&(xe=d.relatedTarget||d.fromElement)&&(Ta(xe)||xe[Is]))break e;if((_e||oe)&&(oe=ae.window===ae?ae:(oe=ae.ownerDocument)?oe.defaultView||oe.parentWindow:window,_e?(xe=d.relatedTarget||d.toElement,_e=ee,xe=xe?Ta(xe):null,xe!==null&&(zt=rr(xe),xe!==zt||xe.tag!==5&&xe.tag!==6)&&(xe=null)):(_e=null,xe=ee),_e!==xe)){if(we=th,he="onMouseLeave",q="onMouseEnter",H="mouse",(a==="pointerout"||a==="pointerover")&&(we=_i,he="onPointerLeave",q="onPointerEnter",H="pointer"),zt=_e==null?oe:ic(_e),Y=xe==null?oe:ic(xe),oe=new we(he,H+"leave",_e,d,ae),oe.target=zt,oe.relatedTarget=Y,he=null,Ta(ae)===ee&&(we=new we(q,H+"enter",xe,d,ae),we.target=Y,we.relatedTarget=zt,he=we),zt=he,_e&&xe)t:{for(we=_e,q=xe,H=0,Y=we;Y;Y=tc(Y))H++;for(Y=0,he=q;he;he=tc(he))Y++;for(;0<H-Y;)we=tc(we),H--;for(;0<Y-H;)q=tc(q),Y--;for(;H--;){if(we===q||q!==null&&we===q.alternate)break t;we=tc(we),q=tc(q)}we=null}else we=null;_e!==null&&gE(ce,oe,_e,we,!1),xe!==null&&zt!==null&&gE(ce,zt,xe,we,!0)}}e:{if(oe=ee?ic(ee):window,_e=oe.nodeName&&oe.nodeName.toLowerCase(),_e==="select"||_e==="input"&&oe.type==="file")var Te=JD;else if(Kw(oe))if(Xw)Te=iM;else{Te=tM;var ke=eM}else(_e=oe.nodeName)&&_e.toLowerCase()==="input"&&(oe.type==="checkbox"||oe.type==="radio")&&(Te=nM);if(Te&&(Te=Te(a,ee))){qw(ce,Te,d,ae);break e}ke&&ke(a,oe,ee),a==="focusout"&&(ke=oe._wrapperState)&&ke.controlled&&oe.type==="number"&&_t(oe,"number",oe.value)}switch(ke=ee?ic(ee):window,a){case"focusin":(Kw(ke)||ke.contentEditable==="true")&&(Jl=ke,My=ee,ah=null);break;case"focusout":ah=My=Jl=null;break;case"mousedown":Ly=!0;break;case"contextmenu":case"mouseup":case"dragend":Ly=!1,iE(ce,d,ae);break;case"selectionchange":if(oM)break;case"keydown":case"keyup":iE(ce,d,ae)}var Ne;if(Py)e:{switch(a){case"compositionstart":var Oe="onCompositionStart";break e;case"compositionend":Oe="onCompositionEnd";break e;case"compositionupdate":Oe="onCompositionUpdate";break e}Oe=void 0}else Ql?$w(a,d)&&(Oe="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Oe="onCompositionStart");Oe&&(Bw&&d.locale!=="ko"&&(Ql||Oe!=="onCompositionStart"?Oe==="onCompositionEnd"&&Ql&&(Ne=Of()):(mi=ae,Hl="value"in mi?mi.value:mi.textContent,Ql=!0)),ke=$f(ee,Oe),0<ke.length&&(Oe=new R(Oe,a,null,d,ae),ce.push({event:Oe,listeners:ke}),Ne?Oe.data=Ne:(Ne=Hw(d),Ne!==null&&(Oe.data=Ne)))),(Ne=qD?XD(a,d):YD(a,d))&&(ee=$f(ee,"onBeforeInput"),0<ee.length&&(ae=new R("onBeforeInput","beforeinput",null,d,ae),ce.push({event:ae,listeners:ee}),ae.data=Ne))}dE(ce,c)})}function uh(a,c,d){return{instance:a,listener:c,currentTarget:d}}function $f(a,c){for(var d=c+"Capture",m=[];a!==null;){var v=a,w=v.stateNode;v.tag===5&&w!==null&&(v=w,w=pn(a,d),w!=null&&m.unshift(uh(a,w,v)),w=pn(a,c),w!=null&&m.push(uh(a,w,v))),a=a.return}return m}function tc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function gE(a,c,d,m,v){for(var w=c._reactName,P=[];d!==null&&d!==m;){var z=d,W=z.alternate,ee=z.stateNode;if(W!==null&&W===m)break;z.tag===5&&ee!==null&&(z=ee,v?(W=pn(d,w),W!=null&&P.unshift(uh(d,W,z))):v||(W=pn(d,w),W!=null&&P.push(uh(d,W,z)))),d=d.return}P.length!==0&&a.push({event:c,listeners:P})}var uM=/\r\n?/g,hM=/\u0000|\uFFFD/g;function pE(a){return(typeof a=="string"?a:""+a).replace(uM,`
`).replace(hM,"")}function Hf(a,c,d){if(c=pE(c),pE(a)!==c&&d)throw Error(t(425))}function Kf(){}var Uy=null,By=null;function Gy(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Wy=typeof setTimeout=="function"?setTimeout:void 0,dM=typeof clearTimeout=="function"?clearTimeout:void 0,mE=typeof Promise=="function"?Promise:void 0,fM=typeof queueMicrotask=="function"?queueMicrotask:typeof mE<"u"?function(a){return mE.resolve(null).then(a).catch(gM)}:Wy;function gM(a){setTimeout(function(){throw a})}function $y(a,c){var d=c,m=0;do{var v=d.nextSibling;if(a.removeChild(d),v&&v.nodeType===8)if(d=v.data,d==="/$"){if(m===0){a.removeChild(v),co(c);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=v}while(d);co(c)}function go(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function yE(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var nc=Math.random().toString(36).slice(2),Kr="__reactFiber$"+nc,hh="__reactProps$"+nc,Is="__reactContainer$"+nc,Hy="__reactEvents$"+nc,pM="__reactListeners$"+nc,mM="__reactHandles$"+nc;function Ta(a){var c=a[Kr];if(c)return c;for(var d=a.parentNode;d;){if(c=d[Is]||d[Kr]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=yE(a);a!==null;){if(d=a[Kr])return d;a=yE(a)}return c}a=d,d=a.parentNode}return null}function dh(a){return a=a[Kr]||a[Is],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ic(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function qf(a){return a[hh]||null}var Ky=[],rc=-1;function po(a){return{current:a}}function Et(a){0>rc||(a.current=Ky[rc],Ky[rc]=null,rc--)}function vt(a,c){rc++,Ky[rc]=a.current,a.current=c}var mo={},Rn=po(mo),Xn=po(!1),Sa=mo;function sc(a,c){var d=a.type.contextTypes;if(!d)return mo;var m=a.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===c)return m.__reactInternalMemoizedMaskedChildContext;var v={},w;for(w in d)v[w]=c[w];return m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=v),v}function Yn(a){return a=a.childContextTypes,a!=null}function Xf(){Et(Xn),Et(Rn)}function _E(a,c,d){if(Rn.current!==mo)throw Error(t(168));vt(Rn,c),vt(Xn,d)}function vE(a,c,d){var m=a.stateNode;if(c=c.childContextTypes,typeof m.getChildContext!="function")return d;m=m.getChildContext();for(var v in m)if(!(v in c))throw Error(t(108,Re(a)||"Unknown",v));return ne({},d,m)}function Yf(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||mo,Sa=Rn.current,vt(Rn,a),vt(Xn,Xn.current),!0}function xE(a,c,d){var m=a.stateNode;if(!m)throw Error(t(169));d?(a=vE(a,c,Sa),m.__reactInternalMemoizedMergedChildContext=a,Et(Xn),Et(Rn),vt(Rn,a)):Et(Xn),vt(Xn,d)}var Cs=null,Zf=!1,qy=!1;function wE(a){Cs===null?Cs=[a]:Cs.push(a)}function yM(a){Zf=!0,wE(a)}function yo(){if(!qy&&Cs!==null){qy=!0;var a=0,c=qe;try{var d=Cs;for(qe=1;a<d.length;a++){var m=d[a];do m=m(!0);while(m!==null)}Cs=null,Zf=!1}catch(v){throw Cs!==null&&(Cs=Cs.slice(a+1)),Bu(Vl,yo),v}finally{qe=c,qy=!1}}return null}var oc=[],ac=0,Qf=null,Jf=0,Fi=[],Vi=0,Ia=null,Rs=1,bs="";function Ca(a,c){oc[ac++]=Jf,oc[ac++]=Qf,Qf=a,Jf=c}function EE(a,c,d){Fi[Vi++]=Rs,Fi[Vi++]=bs,Fi[Vi++]=Ia,Ia=a;var m=Rs;a=bs;var v=32-gi(m)-1;m&=~(1<<v),d+=1;var w=32-gi(c)+v;if(30<w){var P=v-v%5;w=(m&(1<<P)-1).toString(32),m>>=P,v-=P,Rs=1<<32-gi(c)+v|d<<v|m,bs=w+a}else Rs=1<<w|d<<v|m,bs=a}function Xy(a){a.return!==null&&(Ca(a,1),EE(a,1,0))}function Yy(a){for(;a===Qf;)Qf=oc[--ac],oc[ac]=null,Jf=oc[--ac],oc[ac]=null;for(;a===Ia;)Ia=Fi[--Vi],Fi[Vi]=null,bs=Fi[--Vi],Fi[Vi]=null,Rs=Fi[--Vi],Fi[Vi]=null}var vi=null,xi=null,Ct=!1,ar=null;function TE(a,c){var d=Gi(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function SE(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,vi=a,xi=go(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,vi=a,xi=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Ia!==null?{id:Rs,overflow:bs}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=Gi(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,vi=a,xi=null,!0):!1;default:return!1}}function Zy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Qy(a){if(Ct){var c=xi;if(c){var d=c;if(!SE(a,c)){if(Zy(a))throw Error(t(418));c=go(d.nextSibling);var m=vi;c&&SE(a,c)?TE(m,d):(a.flags=a.flags&-4097|2,Ct=!1,vi=a)}}else{if(Zy(a))throw Error(t(418));a.flags=a.flags&-4097|2,Ct=!1,vi=a}}}function IE(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;vi=a}function eg(a){if(a!==vi)return!1;if(!Ct)return IE(a),Ct=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!Gy(a.type,a.memoizedProps)),c&&(c=xi)){if(Zy(a))throw CE(),Error(t(418));for(;c;)TE(a,c),c=go(c.nextSibling)}if(IE(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){xi=go(a.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}xi=null}}else xi=vi?go(a.stateNode.nextSibling):null;return!0}function CE(){for(var a=xi;a;)a=go(a.nextSibling)}function lc(){xi=vi=null,Ct=!1}function Jy(a){ar===null?ar=[a]:ar.push(a)}var _M=L.ReactCurrentBatchConfig;function fh(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var m=d.stateNode}if(!m)throw Error(t(147,a));var v=m,w=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===w?c.ref:(c=function(P){var z=v.refs;P===null?delete z[w]:z[w]=P},c._stringRef=w,c)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function tg(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function RE(a){var c=a._init;return c(a._payload)}function bE(a){function c(q,H){if(a){var Y=q.deletions;Y===null?(q.deletions=[H],q.flags|=16):Y.push(H)}}function d(q,H){if(!a)return null;for(;H!==null;)c(q,H),H=H.sibling;return null}function m(q,H){for(q=new Map;H!==null;)H.key!==null?q.set(H.key,H):q.set(H.index,H),H=H.sibling;return q}function v(q,H){return q=Io(q,H),q.index=0,q.sibling=null,q}function w(q,H,Y){return q.index=Y,a?(Y=q.alternate,Y!==null?(Y=Y.index,Y<H?(q.flags|=2,H):Y):(q.flags|=2,H)):(q.flags|=1048576,H)}function P(q){return a&&q.alternate===null&&(q.flags|=2),q}function z(q,H,Y,he){return H===null||H.tag!==6?(H=W0(Y,q.mode,he),H.return=q,H):(H=v(H,Y),H.return=q,H)}function W(q,H,Y,he){var Te=Y.type;return Te===M?ae(q,H,Y.props.children,he,Y.key):H!==null&&(H.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===me&&RE(Te)===H.type)?(he=v(H,Y.props),he.ref=fh(q,H,Y),he.return=q,he):(he=Ig(Y.type,Y.key,Y.props,null,q.mode,he),he.ref=fh(q,H,Y),he.return=q,he)}function ee(q,H,Y,he){return H===null||H.tag!==4||H.stateNode.containerInfo!==Y.containerInfo||H.stateNode.implementation!==Y.implementation?(H=$0(Y,q.mode,he),H.return=q,H):(H=v(H,Y.children||[]),H.return=q,H)}function ae(q,H,Y,he,Te){return H===null||H.tag!==7?(H=Ma(Y,q.mode,he,Te),H.return=q,H):(H=v(H,Y),H.return=q,H)}function ce(q,H,Y){if(typeof H=="string"&&H!==""||typeof H=="number")return H=W0(""+H,q.mode,Y),H.return=q,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case O:return Y=Ig(H.type,H.key,H.props,null,q.mode,Y),Y.ref=fh(q,null,H),Y.return=q,Y;case B:return H=$0(H,q.mode,Y),H.return=q,H;case me:var he=H._init;return ce(q,he(H._payload),Y)}if(ut(H)||Z(H))return H=Ma(H,q.mode,Y,null),H.return=q,H;tg(q,H)}return null}function oe(q,H,Y,he){var Te=H!==null?H.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Te!==null?null:z(q,H,""+Y,he);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case O:return Y.key===Te?W(q,H,Y,he):null;case B:return Y.key===Te?ee(q,H,Y,he):null;case me:return Te=Y._init,oe(q,H,Te(Y._payload),he)}if(ut(Y)||Z(Y))return Te!==null?null:ae(q,H,Y,he,null);tg(q,Y)}return null}function _e(q,H,Y,he,Te){if(typeof he=="string"&&he!==""||typeof he=="number")return q=q.get(Y)||null,z(H,q,""+he,Te);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case O:return q=q.get(he.key===null?Y:he.key)||null,W(H,q,he,Te);case B:return q=q.get(he.key===null?Y:he.key)||null,ee(H,q,he,Te);case me:var ke=he._init;return _e(q,H,Y,ke(he._payload),Te)}if(ut(he)||Z(he))return q=q.get(Y)||null,ae(H,q,he,Te,null);tg(H,he)}return null}function xe(q,H,Y,he){for(var Te=null,ke=null,Ne=H,Oe=H=0,an=null;Ne!==null&&Oe<Y.length;Oe++){Ne.index>Oe?(an=Ne,Ne=null):an=Ne.sibling;var et=oe(q,Ne,Y[Oe],he);if(et===null){Ne===null&&(Ne=an);break}a&&Ne&&et.alternate===null&&c(q,Ne),H=w(et,H,Oe),ke===null?Te=et:ke.sibling=et,ke=et,Ne=an}if(Oe===Y.length)return d(q,Ne),Ct&&Ca(q,Oe),Te;if(Ne===null){for(;Oe<Y.length;Oe++)Ne=ce(q,Y[Oe],he),Ne!==null&&(H=w(Ne,H,Oe),ke===null?Te=Ne:ke.sibling=Ne,ke=Ne);return Ct&&Ca(q,Oe),Te}for(Ne=m(q,Ne);Oe<Y.length;Oe++)an=_e(Ne,q,Oe,Y[Oe],he),an!==null&&(a&&an.alternate!==null&&Ne.delete(an.key===null?Oe:an.key),H=w(an,H,Oe),ke===null?Te=an:ke.sibling=an,ke=an);return a&&Ne.forEach(function(Co){return c(q,Co)}),Ct&&Ca(q,Oe),Te}function we(q,H,Y,he){var Te=Z(Y);if(typeof Te!="function")throw Error(t(150));if(Y=Te.call(Y),Y==null)throw Error(t(151));for(var ke=Te=null,Ne=H,Oe=H=0,an=null,et=Y.next();Ne!==null&&!et.done;Oe++,et=Y.next()){Ne.index>Oe?(an=Ne,Ne=null):an=Ne.sibling;var Co=oe(q,Ne,et.value,he);if(Co===null){Ne===null&&(Ne=an);break}a&&Ne&&Co.alternate===null&&c(q,Ne),H=w(Co,H,Oe),ke===null?Te=Co:ke.sibling=Co,ke=Co,Ne=an}if(et.done)return d(q,Ne),Ct&&Ca(q,Oe),Te;if(Ne===null){for(;!et.done;Oe++,et=Y.next())et=ce(q,et.value,he),et!==null&&(H=w(et,H,Oe),ke===null?Te=et:ke.sibling=et,ke=et);return Ct&&Ca(q,Oe),Te}for(Ne=m(q,Ne);!et.done;Oe++,et=Y.next())et=_e(Ne,q,Oe,et.value,he),et!==null&&(a&&et.alternate!==null&&Ne.delete(et.key===null?Oe:et.key),H=w(et,H,Oe),ke===null?Te=et:ke.sibling=et,ke=et);return a&&Ne.forEach(function(ZM){return c(q,ZM)}),Ct&&Ca(q,Oe),Te}function zt(q,H,Y,he){if(typeof Y=="object"&&Y!==null&&Y.type===M&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case O:e:{for(var Te=Y.key,ke=H;ke!==null;){if(ke.key===Te){if(Te=Y.type,Te===M){if(ke.tag===7){d(q,ke.sibling),H=v(ke,Y.props.children),H.return=q,q=H;break e}}else if(ke.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===me&&RE(Te)===ke.type){d(q,ke.sibling),H=v(ke,Y.props),H.ref=fh(q,ke,Y),H.return=q,q=H;break e}d(q,ke);break}else c(q,ke);ke=ke.sibling}Y.type===M?(H=Ma(Y.props.children,q.mode,he,Y.key),H.return=q,q=H):(he=Ig(Y.type,Y.key,Y.props,null,q.mode,he),he.ref=fh(q,H,Y),he.return=q,q=he)}return P(q);case B:e:{for(ke=Y.key;H!==null;){if(H.key===ke)if(H.tag===4&&H.stateNode.containerInfo===Y.containerInfo&&H.stateNode.implementation===Y.implementation){d(q,H.sibling),H=v(H,Y.children||[]),H.return=q,q=H;break e}else{d(q,H);break}else c(q,H);H=H.sibling}H=$0(Y,q.mode,he),H.return=q,q=H}return P(q);case me:return ke=Y._init,zt(q,H,ke(Y._payload),he)}if(ut(Y))return xe(q,H,Y,he);if(Z(Y))return we(q,H,Y,he);tg(q,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,H!==null&&H.tag===6?(d(q,H.sibling),H=v(H,Y),H.return=q,q=H):(d(q,H),H=W0(Y,q.mode,he),H.return=q,q=H),P(q)):d(q,H)}return zt}var cc=bE(!0),AE=bE(!1),ng=po(null),ig=null,uc=null,e0=null;function t0(){e0=uc=ig=null}function n0(a){var c=ng.current;Et(ng),a._currentValue=c}function i0(a,c,d){for(;a!==null;){var m=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),a===d)break;a=a.return}}function hc(a,c){ig=a,e0=uc=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(Zn=!0),a.firstContext=null)}function zi(a){var c=a._currentValue;if(e0!==a)if(a={context:a,memoizedValue:c,next:null},uc===null){if(ig===null)throw Error(t(308));uc=a,ig.dependencies={lanes:0,firstContext:a}}else uc=uc.next=a;return c}var Ra=null;function r0(a){Ra===null?Ra=[a]:Ra.push(a)}function PE(a,c,d,m){var v=c.interleaved;return v===null?(d.next=d,r0(c)):(d.next=v.next,v.next=d),c.interleaved=d,As(a,m)}function As(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var _o=!1;function s0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kE(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Ps(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function vo(a,c,d){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(Je&2)!==0){var v=m.pending;return v===null?c.next=c:(c.next=v.next,v.next=c),m.pending=c,As(a,d)}return v=m.interleaved,v===null?(c.next=c,r0(m)):(c.next=v.next,v.next=c),m.interleaved=c,As(a,d)}function rg(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,qu(a,d)}}function NE(a,c){var d=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var v=null,w=null;if(d=d.firstBaseUpdate,d!==null){do{var P={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};w===null?v=w=P:w=w.next=P,d=d.next}while(d!==null);w===null?v=w=c:w=w.next=c}else v=w=c;d={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:m.shared,effects:m.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function sg(a,c,d,m){var v=a.updateQueue;_o=!1;var w=v.firstBaseUpdate,P=v.lastBaseUpdate,z=v.shared.pending;if(z!==null){v.shared.pending=null;var W=z,ee=W.next;W.next=null,P===null?w=ee:P.next=ee,P=W;var ae=a.alternate;ae!==null&&(ae=ae.updateQueue,z=ae.lastBaseUpdate,z!==P&&(z===null?ae.firstBaseUpdate=ee:z.next=ee,ae.lastBaseUpdate=W))}if(w!==null){var ce=v.baseState;P=0,ae=ee=W=null,z=w;do{var oe=z.lane,_e=z.eventTime;if((m&oe)===oe){ae!==null&&(ae=ae.next={eventTime:_e,lane:0,tag:z.tag,payload:z.payload,callback:z.callback,next:null});e:{var xe=a,we=z;switch(oe=c,_e=d,we.tag){case 1:if(xe=we.payload,typeof xe=="function"){ce=xe.call(_e,ce,oe);break e}ce=xe;break e;case 3:xe.flags=xe.flags&-65537|128;case 0:if(xe=we.payload,oe=typeof xe=="function"?xe.call(_e,ce,oe):xe,oe==null)break e;ce=ne({},ce,oe);break e;case 2:_o=!0}}z.callback!==null&&z.lane!==0&&(a.flags|=64,oe=v.effects,oe===null?v.effects=[z]:oe.push(z))}else _e={eventTime:_e,lane:oe,tag:z.tag,payload:z.payload,callback:z.callback,next:null},ae===null?(ee=ae=_e,W=ce):ae=ae.next=_e,P|=oe;if(z=z.next,z===null){if(z=v.shared.pending,z===null)break;oe=z,z=oe.next,oe.next=null,v.lastBaseUpdate=oe,v.shared.pending=null}}while(!0);if(ae===null&&(W=ce),v.baseState=W,v.firstBaseUpdate=ee,v.lastBaseUpdate=ae,c=v.shared.interleaved,c!==null){v=c;do P|=v.lane,v=v.next;while(v!==c)}else w===null&&(v.shared.lanes=0);Pa|=P,a.lanes=P,a.memoizedState=ce}}function DE(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var m=a[c],v=m.callback;if(v!==null){if(m.callback=null,m=d,typeof v!="function")throw Error(t(191,v));v.call(m)}}}var gh={},qr=po(gh),ph=po(gh),mh=po(gh);function ba(a){if(a===gh)throw Error(t(174));return a}function o0(a,c){switch(vt(mh,c),vt(ph,a),vt(qr,gh),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:nr(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=nr(c,a)}Et(qr),vt(qr,c)}function dc(){Et(qr),Et(ph),Et(mh)}function ME(a){ba(mh.current);var c=ba(qr.current),d=nr(c,a.type);c!==d&&(vt(ph,a),vt(qr,d))}function a0(a){ph.current===a&&(Et(qr),Et(ph))}var At=po(0);function og(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var l0=[];function c0(){for(var a=0;a<l0.length;a++)l0[a]._workInProgressVersionPrimary=null;l0.length=0}var ag=L.ReactCurrentDispatcher,u0=L.ReactCurrentBatchConfig,Aa=0,Pt=null,Yt=null,sn=null,lg=!1,yh=!1,_h=0,vM=0;function bn(){throw Error(t(321))}function h0(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!or(a[d],c[d]))return!1;return!0}function d0(a,c,d,m,v,w){if(Aa=w,Pt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,ag.current=a===null||a.memoizedState===null?TM:SM,a=d(m,v),yh){w=0;do{if(yh=!1,_h=0,25<=w)throw Error(t(301));w+=1,sn=Yt=null,c.updateQueue=null,ag.current=IM,a=d(m,v)}while(yh)}if(ag.current=hg,c=Yt!==null&&Yt.next!==null,Aa=0,sn=Yt=Pt=null,lg=!1,c)throw Error(t(300));return a}function f0(){var a=_h!==0;return _h=0,a}function Xr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?Pt.memoizedState=sn=a:sn=sn.next=a,sn}function Ui(){if(Yt===null){var a=Pt.alternate;a=a!==null?a.memoizedState:null}else a=Yt.next;var c=sn===null?Pt.memoizedState:sn.next;if(c!==null)sn=c,Yt=a;else{if(a===null)throw Error(t(310));Yt=a,a={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},sn===null?Pt.memoizedState=sn=a:sn=sn.next=a}return sn}function vh(a,c){return typeof c=="function"?c(a):c}function g0(a){var c=Ui(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=Yt,v=m.baseQueue,w=d.pending;if(w!==null){if(v!==null){var P=v.next;v.next=w.next,w.next=P}m.baseQueue=v=w,d.pending=null}if(v!==null){w=v.next,m=m.baseState;var z=P=null,W=null,ee=w;do{var ae=ee.lane;if((Aa&ae)===ae)W!==null&&(W=W.next={lane:0,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),m=ee.hasEagerState?ee.eagerState:a(m,ee.action);else{var ce={lane:ae,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null};W===null?(z=W=ce,P=m):W=W.next=ce,Pt.lanes|=ae,Pa|=ae}ee=ee.next}while(ee!==null&&ee!==w);W===null?P=m:W.next=z,or(m,c.memoizedState)||(Zn=!0),c.memoizedState=m,c.baseState=P,c.baseQueue=W,d.lastRenderedState=m}if(a=d.interleaved,a!==null){v=a;do w=v.lane,Pt.lanes|=w,Pa|=w,v=v.next;while(v!==a)}else v===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function p0(a){var c=Ui(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=d.dispatch,v=d.pending,w=c.memoizedState;if(v!==null){d.pending=null;var P=v=v.next;do w=a(w,P.action),P=P.next;while(P!==v);or(w,c.memoizedState)||(Zn=!0),c.memoizedState=w,c.baseQueue===null&&(c.baseState=w),d.lastRenderedState=w}return[w,m]}function LE(){}function OE(a,c){var d=Pt,m=Ui(),v=c(),w=!or(m.memoizedState,v);if(w&&(m.memoizedState=v,Zn=!0),m=m.queue,m0(VE.bind(null,d,m,a),[a]),m.getSnapshot!==c||w||sn!==null&&sn.memoizedState.tag&1){if(d.flags|=2048,xh(9,FE.bind(null,d,m,v,c),void 0,null),on===null)throw Error(t(349));(Aa&30)!==0||jE(d,c,v)}return v}function jE(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function FE(a,c,d,m){c.value=d,c.getSnapshot=m,zE(c)&&UE(a)}function VE(a,c,d){return d(function(){zE(c)&&UE(a)})}function zE(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!or(a,d)}catch{return!0}}function UE(a){var c=As(a,1);c!==null&&hr(c,a,1,-1)}function BE(a){var c=Xr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vh,lastRenderedState:a},c.queue=a,a=a.dispatch=EM.bind(null,Pt,a),[c.memoizedState,a]}function xh(a,c,d,m){return a={tag:a,create:c,destroy:d,deps:m,next:null},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(m=d.next,d.next=a,a.next=m,c.lastEffect=a)),a}function GE(){return Ui().memoizedState}function cg(a,c,d,m){var v=Xr();Pt.flags|=a,v.memoizedState=xh(1|c,d,void 0,m===void 0?null:m)}function ug(a,c,d,m){var v=Ui();m=m===void 0?null:m;var w=void 0;if(Yt!==null){var P=Yt.memoizedState;if(w=P.destroy,m!==null&&h0(m,P.deps)){v.memoizedState=xh(c,d,w,m);return}}Pt.flags|=a,v.memoizedState=xh(1|c,d,w,m)}function WE(a,c){return cg(8390656,8,a,c)}function m0(a,c){return ug(2048,8,a,c)}function $E(a,c){return ug(4,2,a,c)}function HE(a,c){return ug(4,4,a,c)}function KE(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function qE(a,c,d){return d=d!=null?d.concat([a]):null,ug(4,4,KE.bind(null,c,a),d)}function y0(){}function XE(a,c){var d=Ui();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&h0(c,m[1])?m[0]:(d.memoizedState=[a,c],a)}function YE(a,c){var d=Ui();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&h0(c,m[1])?m[0]:(a=a(),d.memoizedState=[a,c],a)}function ZE(a,c,d){return(Aa&21)===0?(a.baseState&&(a.baseState=!1,Zn=!0),a.memoizedState=d):(or(d,c)||(d=Hu(),Pt.lanes|=d,Pa|=d,a.baseState=!0),c)}function xM(a,c){var d=qe;qe=d!==0&&4>d?d:4,a(!0);var m=u0.transition;u0.transition={};try{a(!1),c()}finally{qe=d,u0.transition=m}}function QE(){return Ui().memoizedState}function wM(a,c,d){var m=To(a);if(d={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null},JE(a))eT(c,d);else if(d=PE(a,c,d,m),d!==null){var v=Bn();hr(d,a,m,v),tT(d,c,m)}}function EM(a,c,d){var m=To(a),v={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null};if(JE(a))eT(c,v);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=c.lastRenderedReducer,w!==null))try{var P=c.lastRenderedState,z=w(P,d);if(v.hasEagerState=!0,v.eagerState=z,or(z,P)){var W=c.interleaved;W===null?(v.next=v,r0(c)):(v.next=W.next,W.next=v),c.interleaved=v;return}}catch{}d=PE(a,c,v,m),d!==null&&(v=Bn(),hr(d,a,m,v),tT(d,c,m))}}function JE(a){var c=a.alternate;return a===Pt||c!==null&&c===Pt}function eT(a,c){yh=lg=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function tT(a,c,d){if((d&4194240)!==0){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,qu(a,d)}}var hg={readContext:zi,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useInsertionEffect:bn,useLayoutEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useMutableSource:bn,useSyncExternalStore:bn,useId:bn,unstable_isNewReconciler:!1},TM={readContext:zi,useCallback:function(a,c){return Xr().memoizedState=[a,c===void 0?null:c],a},useContext:zi,useEffect:WE,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,cg(4194308,4,KE.bind(null,c,a),d)},useLayoutEffect:function(a,c){return cg(4194308,4,a,c)},useInsertionEffect:function(a,c){return cg(4,2,a,c)},useMemo:function(a,c){var d=Xr();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var m=Xr();return c=d!==void 0?d(c):c,m.memoizedState=m.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},m.queue=a,a=a.dispatch=wM.bind(null,Pt,a),[m.memoizedState,a]},useRef:function(a){var c=Xr();return a={current:a},c.memoizedState=a},useState:BE,useDebugValue:y0,useDeferredValue:function(a){return Xr().memoizedState=a},useTransition:function(){var a=BE(!1),c=a[0];return a=xM.bind(null,a[1]),Xr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var m=Pt,v=Xr();if(Ct){if(d===void 0)throw Error(t(407));d=d()}else{if(d=c(),on===null)throw Error(t(349));(Aa&30)!==0||jE(m,c,d)}v.memoizedState=d;var w={value:d,getSnapshot:c};return v.queue=w,WE(VE.bind(null,m,w,a),[a]),m.flags|=2048,xh(9,FE.bind(null,m,w,d,c),void 0,null),d},useId:function(){var a=Xr(),c=on.identifierPrefix;if(Ct){var d=bs,m=Rs;d=(m&~(1<<32-gi(m)-1)).toString(32)+d,c=":"+c+"R"+d,d=_h++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=vM++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},SM={readContext:zi,useCallback:XE,useContext:zi,useEffect:m0,useImperativeHandle:qE,useInsertionEffect:$E,useLayoutEffect:HE,useMemo:YE,useReducer:g0,useRef:GE,useState:function(){return g0(vh)},useDebugValue:y0,useDeferredValue:function(a){var c=Ui();return ZE(c,Yt.memoizedState,a)},useTransition:function(){var a=g0(vh)[0],c=Ui().memoizedState;return[a,c]},useMutableSource:LE,useSyncExternalStore:OE,useId:QE,unstable_isNewReconciler:!1},IM={readContext:zi,useCallback:XE,useContext:zi,useEffect:m0,useImperativeHandle:qE,useInsertionEffect:$E,useLayoutEffect:HE,useMemo:YE,useReducer:p0,useRef:GE,useState:function(){return p0(vh)},useDebugValue:y0,useDeferredValue:function(a){var c=Ui();return Yt===null?c.memoizedState=a:ZE(c,Yt.memoizedState,a)},useTransition:function(){var a=p0(vh)[0],c=Ui().memoizedState;return[a,c]},useMutableSource:LE,useSyncExternalStore:OE,useId:QE,unstable_isNewReconciler:!1};function lr(a,c){if(a&&a.defaultProps){c=ne({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function _0(a,c,d,m){c=a.memoizedState,d=d(m,c),d=d==null?c:ne({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var dg={isMounted:function(a){return(a=a._reactInternals)?rr(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var m=Bn(),v=To(a),w=Ps(m,v);w.payload=c,d!=null&&(w.callback=d),c=vo(a,w,v),c!==null&&(hr(c,a,v,m),rg(c,a,v))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var m=Bn(),v=To(a),w=Ps(m,v);w.tag=1,w.payload=c,d!=null&&(w.callback=d),c=vo(a,w,v),c!==null&&(hr(c,a,v,m),rg(c,a,v))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=Bn(),m=To(a),v=Ps(d,m);v.tag=2,c!=null&&(v.callback=c),c=vo(a,v,m),c!==null&&(hr(c,a,m,d),rg(c,a,m))}};function nT(a,c,d,m,v,w,P){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,w,P):c.prototype&&c.prototype.isPureReactComponent?!oh(d,m)||!oh(v,w):!0}function iT(a,c,d){var m=!1,v=mo,w=c.contextType;return typeof w=="object"&&w!==null?w=zi(w):(v=Yn(c)?Sa:Rn.current,m=c.contextTypes,w=(m=m!=null)?sc(a,v):mo),c=new c(d,w),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=dg,a.stateNode=c,c._reactInternals=a,m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=w),c}function rT(a,c,d,m){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,m),c.state!==a&&dg.enqueueReplaceState(c,c.state,null)}function v0(a,c,d,m){var v=a.stateNode;v.props=d,v.state=a.memoizedState,v.refs={},s0(a);var w=c.contextType;typeof w=="object"&&w!==null?v.context=zi(w):(w=Yn(c)?Sa:Rn.current,v.context=sc(a,w)),v.state=a.memoizedState,w=c.getDerivedStateFromProps,typeof w=="function"&&(_0(a,c,w,d),v.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(c=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),c!==v.state&&dg.enqueueReplaceState(v,v.state,null),sg(a,d,v,m),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function fc(a,c){try{var d="",m=c;do d+=ye(m),m=m.return;while(m);var v=d}catch(w){v=`
Error generating stack: `+w.message+`
`+w.stack}return{value:a,source:c,stack:v,digest:null}}function x0(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function w0(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var CM=typeof WeakMap=="function"?WeakMap:Map;function sT(a,c,d){d=Ps(-1,d),d.tag=3,d.payload={element:null};var m=c.value;return d.callback=function(){vg||(vg=!0,O0=m),w0(a,c)},d}function oT(a,c,d){d=Ps(-1,d),d.tag=3;var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var v=c.value;d.payload=function(){return m(v)},d.callback=function(){w0(a,c)}}var w=a.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(d.callback=function(){w0(a,c),typeof m!="function"&&(wo===null?wo=new Set([this]):wo.add(this));var P=c.stack;this.componentDidCatch(c.value,{componentStack:P!==null?P:""})}),d}function aT(a,c,d){var m=a.pingCache;if(m===null){m=a.pingCache=new CM;var v=new Set;m.set(c,v)}else v=m.get(c),v===void 0&&(v=new Set,m.set(c,v));v.has(d)||(v.add(d),a=zM.bind(null,a,c,d),c.then(a,a))}function lT(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function cT(a,c,d,m,v){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=Ps(-1,1),c.tag=2,vo(d,c,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=v,a)}var RM=L.ReactCurrentOwner,Zn=!1;function Un(a,c,d,m){c.child=a===null?AE(c,null,d,m):cc(c,a.child,d,m)}function uT(a,c,d,m,v){d=d.render;var w=c.ref;return hc(c,v),m=d0(a,c,d,m,w,v),d=f0(),a!==null&&!Zn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,ks(a,c,v)):(Ct&&d&&Xy(c),c.flags|=1,Un(a,c,m,v),c.child)}function hT(a,c,d,m,v){if(a===null){var w=d.type;return typeof w=="function"&&!G0(w)&&w.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=w,dT(a,c,w,m,v)):(a=Ig(d.type,null,m,c,c.mode,v),a.ref=c.ref,a.return=c,c.child=a)}if(w=a.child,(a.lanes&v)===0){var P=w.memoizedProps;if(d=d.compare,d=d!==null?d:oh,d(P,m)&&a.ref===c.ref)return ks(a,c,v)}return c.flags|=1,a=Io(w,m),a.ref=c.ref,a.return=c,c.child=a}function dT(a,c,d,m,v){if(a!==null){var w=a.memoizedProps;if(oh(w,m)&&a.ref===c.ref)if(Zn=!1,c.pendingProps=m=w,(a.lanes&v)!==0)(a.flags&131072)!==0&&(Zn=!0);else return c.lanes=a.lanes,ks(a,c,v)}return E0(a,c,d,m,v)}function fT(a,c,d){var m=c.pendingProps,v=m.children,w=a!==null?a.memoizedState:null;if(m.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(pc,wi),wi|=d;else{if((d&1073741824)===0)return a=w!==null?w.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,vt(pc,wi),wi|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=w!==null?w.baseLanes:d,vt(pc,wi),wi|=m}else w!==null?(m=w.baseLanes|d,c.memoizedState=null):m=d,vt(pc,wi),wi|=m;return Un(a,c,v,d),c.child}function gT(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function E0(a,c,d,m,v){var w=Yn(d)?Sa:Rn.current;return w=sc(c,w),hc(c,v),d=d0(a,c,d,m,w,v),m=f0(),a!==null&&!Zn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,ks(a,c,v)):(Ct&&m&&Xy(c),c.flags|=1,Un(a,c,d,v),c.child)}function pT(a,c,d,m,v){if(Yn(d)){var w=!0;Yf(c)}else w=!1;if(hc(c,v),c.stateNode===null)gg(a,c),iT(c,d,m),v0(c,d,m,v),m=!0;else if(a===null){var P=c.stateNode,z=c.memoizedProps;P.props=z;var W=P.context,ee=d.contextType;typeof ee=="object"&&ee!==null?ee=zi(ee):(ee=Yn(d)?Sa:Rn.current,ee=sc(c,ee));var ae=d.getDerivedStateFromProps,ce=typeof ae=="function"||typeof P.getSnapshotBeforeUpdate=="function";ce||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(z!==m||W!==ee)&&rT(c,P,m,ee),_o=!1;var oe=c.memoizedState;P.state=oe,sg(c,m,P,v),W=c.memoizedState,z!==m||oe!==W||Xn.current||_o?(typeof ae=="function"&&(_0(c,d,ae,m),W=c.memoizedState),(z=_o||nT(c,d,z,m,oe,W,ee))?(ce||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(c.flags|=4194308)):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=W),P.props=m,P.state=W,P.context=ee,m=z):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{P=c.stateNode,kE(a,c),z=c.memoizedProps,ee=c.type===c.elementType?z:lr(c.type,z),P.props=ee,ce=c.pendingProps,oe=P.context,W=d.contextType,typeof W=="object"&&W!==null?W=zi(W):(W=Yn(d)?Sa:Rn.current,W=sc(c,W));var _e=d.getDerivedStateFromProps;(ae=typeof _e=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(z!==ce||oe!==W)&&rT(c,P,m,W),_o=!1,oe=c.memoizedState,P.state=oe,sg(c,m,P,v);var xe=c.memoizedState;z!==ce||oe!==xe||Xn.current||_o?(typeof _e=="function"&&(_0(c,d,_e,m),xe=c.memoizedState),(ee=_o||nT(c,d,ee,m,oe,xe,W)||!1)?(ae||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(m,xe,W),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(m,xe,W)),typeof P.componentDidUpdate=="function"&&(c.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof P.componentDidUpdate!="function"||z===a.memoizedProps&&oe===a.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&oe===a.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=xe),P.props=m,P.state=xe,P.context=W,m=ee):(typeof P.componentDidUpdate!="function"||z===a.memoizedProps&&oe===a.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&oe===a.memoizedState||(c.flags|=1024),m=!1)}return T0(a,c,d,m,w,v)}function T0(a,c,d,m,v,w){gT(a,c);var P=(c.flags&128)!==0;if(!m&&!P)return v&&xE(c,d,!1),ks(a,c,w);m=c.stateNode,RM.current=c;var z=P&&typeof d.getDerivedStateFromError!="function"?null:m.render();return c.flags|=1,a!==null&&P?(c.child=cc(c,a.child,null,w),c.child=cc(c,null,z,w)):Un(a,c,z,w),c.memoizedState=m.state,v&&xE(c,d,!0),c.child}function mT(a){var c=a.stateNode;c.pendingContext?_E(a,c.pendingContext,c.pendingContext!==c.context):c.context&&_E(a,c.context,!1),o0(a,c.containerInfo)}function yT(a,c,d,m,v){return lc(),Jy(v),c.flags|=256,Un(a,c,d,m),c.child}var S0={dehydrated:null,treeContext:null,retryLane:0};function I0(a){return{baseLanes:a,cachePool:null,transitions:null}}function _T(a,c,d){var m=c.pendingProps,v=At.current,w=!1,P=(c.flags&128)!==0,z;if((z=P)||(z=a!==null&&a.memoizedState===null?!1:(v&2)!==0),z?(w=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),vt(At,v&1),a===null)return Qy(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(P=m.children,a=m.fallback,w?(m=c.mode,w=c.child,P={mode:"hidden",children:P},(m&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=P):w=Cg(P,m,0,null),a=Ma(a,m,d,null),w.return=c,a.return=c,w.sibling=a,c.child=w,c.child.memoizedState=I0(d),c.memoizedState=S0,a):C0(c,P));if(v=a.memoizedState,v!==null&&(z=v.dehydrated,z!==null))return bM(a,c,P,m,z,v,d);if(w){w=m.fallback,P=c.mode,v=a.child,z=v.sibling;var W={mode:"hidden",children:m.children};return(P&1)===0&&c.child!==v?(m=c.child,m.childLanes=0,m.pendingProps=W,c.deletions=null):(m=Io(v,W),m.subtreeFlags=v.subtreeFlags&14680064),z!==null?w=Io(z,w):(w=Ma(w,P,d,null),w.flags|=2),w.return=c,m.return=c,m.sibling=w,c.child=m,m=w,w=c.child,P=a.child.memoizedState,P=P===null?I0(d):{baseLanes:P.baseLanes|d,cachePool:null,transitions:P.transitions},w.memoizedState=P,w.childLanes=a.childLanes&~d,c.memoizedState=S0,m}return w=a.child,a=w.sibling,m=Io(w,{mode:"visible",children:m.children}),(c.mode&1)===0&&(m.lanes=d),m.return=c,m.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=m,c.memoizedState=null,m}function C0(a,c){return c=Cg({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function fg(a,c,d,m){return m!==null&&Jy(m),cc(c,a.child,null,d),a=C0(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function bM(a,c,d,m,v,w,P){if(d)return c.flags&256?(c.flags&=-257,m=x0(Error(t(422))),fg(a,c,P,m)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(w=m.fallback,v=c.mode,m=Cg({mode:"visible",children:m.children},v,0,null),w=Ma(w,v,P,null),w.flags|=2,m.return=c,w.return=c,m.sibling=w,c.child=m,(c.mode&1)!==0&&cc(c,a.child,null,P),c.child.memoizedState=I0(P),c.memoizedState=S0,w);if((c.mode&1)===0)return fg(a,c,P,null);if(v.data==="$!"){if(m=v.nextSibling&&v.nextSibling.dataset,m)var z=m.dgst;return m=z,w=Error(t(419)),m=x0(w,m,void 0),fg(a,c,P,m)}if(z=(P&a.childLanes)!==0,Zn||z){if(m=on,m!==null){switch(P&-P){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(m.suspendedLanes|P))!==0?0:v,v!==0&&v!==w.retryLane&&(w.retryLane=v,As(a,v),hr(m,a,v,-1))}return B0(),m=x0(Error(t(421))),fg(a,c,P,m)}return v.data==="$?"?(c.flags|=128,c.child=a.child,c=UM.bind(null,a),v._reactRetry=c,null):(a=w.treeContext,xi=go(v.nextSibling),vi=c,Ct=!0,ar=null,a!==null&&(Fi[Vi++]=Rs,Fi[Vi++]=bs,Fi[Vi++]=Ia,Rs=a.id,bs=a.overflow,Ia=c),c=C0(c,m.children),c.flags|=4096,c)}function vT(a,c,d){a.lanes|=c;var m=a.alternate;m!==null&&(m.lanes|=c),i0(a.return,c,d)}function R0(a,c,d,m,v){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:v}:(w.isBackwards=c,w.rendering=null,w.renderingStartTime=0,w.last=m,w.tail=d,w.tailMode=v)}function xT(a,c,d){var m=c.pendingProps,v=m.revealOrder,w=m.tail;if(Un(a,c,m.children,d),m=At.current,(m&2)!==0)m=m&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&vT(a,d,c);else if(a.tag===19)vT(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}if(vt(At,m),(c.mode&1)===0)c.memoizedState=null;else switch(v){case"forwards":for(d=c.child,v=null;d!==null;)a=d.alternate,a!==null&&og(a)===null&&(v=d),d=d.sibling;d=v,d===null?(v=c.child,c.child=null):(v=d.sibling,d.sibling=null),R0(c,!1,v,d,w);break;case"backwards":for(d=null,v=c.child,c.child=null;v!==null;){if(a=v.alternate,a!==null&&og(a)===null){c.child=v;break}a=v.sibling,v.sibling=d,d=v,v=a}R0(c,!0,d,null,w);break;case"together":R0(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function gg(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function ks(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),Pa|=c.lanes,(d&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,d=Io(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=Io(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function AM(a,c,d){switch(c.tag){case 3:mT(c),lc();break;case 5:ME(c);break;case 1:Yn(c.type)&&Yf(c);break;case 4:o0(c,c.stateNode.containerInfo);break;case 10:var m=c.type._context,v=c.memoizedProps.value;vt(ng,m._currentValue),m._currentValue=v;break;case 13:if(m=c.memoizedState,m!==null)return m.dehydrated!==null?(vt(At,At.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?_T(a,c,d):(vt(At,At.current&1),a=ks(a,c,d),a!==null?a.sibling:null);vt(At,At.current&1);break;case 19:if(m=(d&c.childLanes)!==0,(a.flags&128)!==0){if(m)return xT(a,c,d);c.flags|=128}if(v=c.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),vt(At,At.current),m)break;return null;case 22:case 23:return c.lanes=0,fT(a,c,d)}return ks(a,c,d)}var wT,b0,ET,TT;wT=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},b0=function(){},ET=function(a,c,d,m){var v=a.memoizedProps;if(v!==m){a=c.stateNode,ba(qr.current);var w=null;switch(d){case"input":v=Kn(a,v),m=Kn(a,m),w=[];break;case"select":v=ne({},v,{value:void 0}),m=ne({},m,{value:void 0}),w=[];break;case"textarea":v=ki(a,v),m=ki(a,m),w=[];break;default:typeof v.onClick!="function"&&typeof m.onClick=="function"&&(a.onclick=Kf)}Fn(d,m);var P;d=null;for(ee in v)if(!m.hasOwnProperty(ee)&&v.hasOwnProperty(ee)&&v[ee]!=null)if(ee==="style"){var z=v[ee];for(P in z)z.hasOwnProperty(P)&&(d||(d={}),d[P]="")}else ee!=="dangerouslySetInnerHTML"&&ee!=="children"&&ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&ee!=="autoFocus"&&(r.hasOwnProperty(ee)?w||(w=[]):(w=w||[]).push(ee,null));for(ee in m){var W=m[ee];if(z=v?.[ee],m.hasOwnProperty(ee)&&W!==z&&(W!=null||z!=null))if(ee==="style")if(z){for(P in z)!z.hasOwnProperty(P)||W&&W.hasOwnProperty(P)||(d||(d={}),d[P]="");for(P in W)W.hasOwnProperty(P)&&z[P]!==W[P]&&(d||(d={}),d[P]=W[P])}else d||(w||(w=[]),w.push(ee,d)),d=W;else ee==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,z=z?z.__html:void 0,W!=null&&z!==W&&(w=w||[]).push(ee,W)):ee==="children"?typeof W!="string"&&typeof W!="number"||(w=w||[]).push(ee,""+W):ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&(r.hasOwnProperty(ee)?(W!=null&&ee==="onScroll"&&wt("scroll",a),w||z===W||(w=[])):(w=w||[]).push(ee,W))}d&&(w=w||[]).push("style",d);var ee=w;(c.updateQueue=ee)&&(c.flags|=4)}},TT=function(a,c,d,m){d!==m&&(c.flags|=4)};function wh(a,c){if(!Ct)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function An(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,m=0;if(c)for(var v=a.child;v!==null;)d|=v.lanes|v.childLanes,m|=v.subtreeFlags&14680064,m|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)d|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=m,a.childLanes=d,c}function PM(a,c,d){var m=c.pendingProps;switch(Yy(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return An(c),null;case 1:return Yn(c.type)&&Xf(),An(c),null;case 3:return m=c.stateNode,dc(),Et(Xn),Et(Rn),c0(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(eg(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,ar!==null&&(V0(ar),ar=null))),b0(a,c),An(c),null;case 5:a0(c);var v=ba(mh.current);if(d=c.type,a!==null&&c.stateNode!=null)ET(a,c,d,m,v),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!m){if(c.stateNode===null)throw Error(t(166));return An(c),null}if(a=ba(qr.current),eg(c)){m=c.stateNode,d=c.type;var w=c.memoizedProps;switch(m[Kr]=c,m[hh]=w,a=(c.mode&1)!==0,d){case"dialog":wt("cancel",m),wt("close",m);break;case"iframe":case"object":case"embed":wt("load",m);break;case"video":case"audio":for(v=0;v<lh.length;v++)wt(lh[v],m);break;case"source":wt("error",m);break;case"img":case"image":case"link":wt("error",m),wt("load",m);break;case"details":wt("toggle",m);break;case"input":hn(m,w),wt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!w.multiple},wt("invalid",m);break;case"textarea":It(m,w),wt("invalid",m)}Fn(d,w),v=null;for(var P in w)if(w.hasOwnProperty(P)){var z=w[P];P==="children"?typeof z=="string"?m.textContent!==z&&(w.suppressHydrationWarning!==!0&&Hf(m.textContent,z,a),v=["children",z]):typeof z=="number"&&m.textContent!==""+z&&(w.suppressHydrationWarning!==!0&&Hf(m.textContent,z,a),v=["children",""+z]):r.hasOwnProperty(P)&&z!=null&&P==="onScroll"&&wt("scroll",m)}switch(d){case"input":tr(m),Pi(m,w,!0);break;case"textarea":tr(m),Ni(m);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(m.onclick=Kf)}m=v,c.updateQueue=m,m!==null&&(c.flags|=4)}else{P=v.nodeType===9?v:v.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Ar(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=P.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof m.is=="string"?a=P.createElement(d,{is:m.is}):(a=P.createElement(d),d==="select"&&(P=a,m.multiple?P.multiple=!0:m.size&&(P.size=m.size))):a=P.createElementNS(a,d),a[Kr]=c,a[hh]=m,wT(a,c,!1,!1),c.stateNode=a;e:{switch(P=ys(d,m),d){case"dialog":wt("cancel",a),wt("close",a),v=m;break;case"iframe":case"object":case"embed":wt("load",a),v=m;break;case"video":case"audio":for(v=0;v<lh.length;v++)wt(lh[v],a);v=m;break;case"source":wt("error",a),v=m;break;case"img":case"image":case"link":wt("error",a),wt("load",a),v=m;break;case"details":wt("toggle",a),v=m;break;case"input":hn(a,m),v=Kn(a,m),wt("invalid",a);break;case"option":v=m;break;case"select":a._wrapperState={wasMultiple:!!m.multiple},v=ne({},m,{value:void 0}),wt("invalid",a);break;case"textarea":It(a,m),v=ki(a,m),wt("invalid",a);break;default:v=m}Fn(d,v),z=v;for(w in z)if(z.hasOwnProperty(w)){var W=z[w];w==="style"?ms(a,W):w==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,W!=null&&ua(a,W)):w==="children"?typeof W=="string"?(d!=="textarea"||W!=="")&&kr(a,W):typeof W=="number"&&kr(a,""+W):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(r.hasOwnProperty(w)?W!=null&&w==="onScroll"&&wt("scroll",a):W!=null&&A(a,w,W,P))}switch(d){case"input":tr(a),Pi(a,m,!1);break;case"textarea":tr(a),Ni(a);break;case"option":m.value!=null&&a.setAttribute("value",""+Me(m.value));break;case"select":a.multiple=!!m.multiple,w=m.value,w!=null?nn(a,!!m.multiple,w,!1):m.defaultValue!=null&&nn(a,!!m.multiple,m.defaultValue,!0);break;default:typeof v.onClick=="function"&&(a.onclick=Kf)}switch(d){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return An(c),null;case 6:if(a&&c.stateNode!=null)TT(a,c,a.memoizedProps,m);else{if(typeof m!="string"&&c.stateNode===null)throw Error(t(166));if(d=ba(mh.current),ba(qr.current),eg(c)){if(m=c.stateNode,d=c.memoizedProps,m[Kr]=c,(w=m.nodeValue!==d)&&(a=vi,a!==null))switch(a.tag){case 3:Hf(m.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Hf(m.nodeValue,d,(a.mode&1)!==0)}w&&(c.flags|=4)}else m=(d.nodeType===9?d:d.ownerDocument).createTextNode(m),m[Kr]=c,c.stateNode=m}return An(c),null;case 13:if(Et(At),m=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Ct&&xi!==null&&(c.mode&1)!==0&&(c.flags&128)===0)CE(),lc(),c.flags|=98560,w=!1;else if(w=eg(c),m!==null&&m.dehydrated!==null){if(a===null){if(!w)throw Error(t(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[Kr]=c}else lc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;An(c),w=!1}else ar!==null&&(V0(ar),ar=null),w=!0;if(!w)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(m=m!==null,m!==(a!==null&&a.memoizedState!==null)&&m&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(At.current&1)!==0?Zt===0&&(Zt=3):B0())),c.updateQueue!==null&&(c.flags|=4),An(c),null);case 4:return dc(),b0(a,c),a===null&&ch(c.stateNode.containerInfo),An(c),null;case 10:return n0(c.type._context),An(c),null;case 17:return Yn(c.type)&&Xf(),An(c),null;case 19:if(Et(At),w=c.memoizedState,w===null)return An(c),null;if(m=(c.flags&128)!==0,P=w.rendering,P===null)if(m)wh(w,!1);else{if(Zt!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(P=og(a),P!==null){for(c.flags|=128,wh(w,!1),m=P.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),c.subtreeFlags=0,m=d,d=c.child;d!==null;)w=d,a=m,w.flags&=14680066,P=w.alternate,P===null?(w.childLanes=0,w.lanes=a,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=P.childLanes,w.lanes=P.lanes,w.child=P.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=P.memoizedProps,w.memoizedState=P.memoizedState,w.updateQueue=P.updateQueue,w.type=P.type,a=P.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return vt(At,At.current&1|2),c.child}a=a.sibling}w.tail!==null&&xt()>mc&&(c.flags|=128,m=!0,wh(w,!1),c.lanes=4194304)}else{if(!m)if(a=og(P),a!==null){if(c.flags|=128,m=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),wh(w,!0),w.tail===null&&w.tailMode==="hidden"&&!P.alternate&&!Ct)return An(c),null}else 2*xt()-w.renderingStartTime>mc&&d!==1073741824&&(c.flags|=128,m=!0,wh(w,!1),c.lanes=4194304);w.isBackwards?(P.sibling=c.child,c.child=P):(d=w.last,d!==null?d.sibling=P:c.child=P,w.last=P)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=xt(),c.sibling=null,d=At.current,vt(At,m?d&1|2:d&1),c):(An(c),null);case 22:case 23:return U0(),m=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==m&&(c.flags|=8192),m&&(c.mode&1)!==0?(wi&1073741824)!==0&&(An(c),c.subtreeFlags&6&&(c.flags|=8192)):An(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function kM(a,c){switch(Yy(c),c.tag){case 1:return Yn(c.type)&&Xf(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return dc(),Et(Xn),Et(Rn),c0(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return a0(c),null;case 13:if(Et(At),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));lc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return Et(At),null;case 4:return dc(),null;case 10:return n0(c.type._context),null;case 22:case 23:return U0(),null;case 24:return null;default:return null}}var pg=!1,Pn=!1,NM=typeof WeakSet=="function"?WeakSet:Set,ve=null;function gc(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(m){Mt(a,c,m)}else d.current=null}function A0(a,c,d){try{d()}catch(m){Mt(a,c,m)}}var ST=!1;function DM(a,c){if(Uy=Es,a=nE(),Dy(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var v=m.anchorOffset,w=m.focusNode;m=m.focusOffset;try{d.nodeType,w.nodeType}catch{d=null;break e}var P=0,z=-1,W=-1,ee=0,ae=0,ce=a,oe=null;t:for(;;){for(var _e;ce!==d||v!==0&&ce.nodeType!==3||(z=P+v),ce!==w||m!==0&&ce.nodeType!==3||(W=P+m),ce.nodeType===3&&(P+=ce.nodeValue.length),(_e=ce.firstChild)!==null;)oe=ce,ce=_e;for(;;){if(ce===a)break t;if(oe===d&&++ee===v&&(z=P),oe===w&&++ae===m&&(W=P),(_e=ce.nextSibling)!==null)break;ce=oe,oe=ce.parentNode}ce=_e}d=z===-1||W===-1?null:{start:z,end:W}}else d=null}d=d||{start:0,end:0}}else d=null;for(By={focusedElem:a,selectionRange:d},Es=!1,ve=c;ve!==null;)if(c=ve,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,ve=a;else for(;ve!==null;){c=ve;try{var xe=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(xe!==null){var we=xe.memoizedProps,zt=xe.memoizedState,q=c.stateNode,H=q.getSnapshotBeforeUpdate(c.elementType===c.type?we:lr(c.type,we),zt);q.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var Y=c.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Mt(c,c.return,he)}if(a=c.sibling,a!==null){a.return=c.return,ve=a;break}ve=c.return}return xe=ST,ST=!1,xe}function Eh(a,c,d){var m=c.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var v=m=m.next;do{if((v.tag&a)===a){var w=v.destroy;v.destroy=void 0,w!==void 0&&A0(c,d,w)}v=v.next}while(v!==m)}}function mg(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var m=d.create;d.destroy=m()}d=d.next}while(d!==c)}}function P0(a){var c=a.ref;if(c!==null){var d=a.stateNode;a.tag,a=d,typeof c=="function"?c(a):c.current=a}}function IT(a){var c=a.alternate;c!==null&&(a.alternate=null,IT(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[Kr],delete c[hh],delete c[Hy],delete c[pM],delete c[mM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function CT(a){return a.tag===5||a.tag===3||a.tag===4}function RT(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||CT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function k0(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=Kf));else if(m!==4&&(a=a.child,a!==null))for(k0(a,c,d),a=a.sibling;a!==null;)k0(a,c,d),a=a.sibling}function N0(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(m!==4&&(a=a.child,a!==null))for(N0(a,c,d),a=a.sibling;a!==null;)N0(a,c,d),a=a.sibling}var _n=null,cr=!1;function xo(a,c,d){for(d=d.child;d!==null;)bT(a,c,d),d=d.sibling}function bT(a,c,d){if(fi&&typeof fi.onCommitFiberUnmount=="function")try{fi.onCommitFiberUnmount(ga,d)}catch{}switch(d.tag){case 5:Pn||gc(d,c);case 6:var m=_n,v=cr;_n=null,xo(a,c,d),_n=m,cr=v,_n!==null&&(cr?(a=_n,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):_n.removeChild(d.stateNode));break;case 18:_n!==null&&(cr?(a=_n,d=d.stateNode,a.nodeType===8?$y(a.parentNode,d):a.nodeType===1&&$y(a,d),co(a)):$y(_n,d.stateNode));break;case 4:m=_n,v=cr,_n=d.stateNode.containerInfo,cr=!0,xo(a,c,d),_n=m,cr=v;break;case 0:case 11:case 14:case 15:if(!Pn&&(m=d.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){v=m=m.next;do{var w=v,P=w.destroy;w=w.tag,P!==void 0&&((w&2)!==0||(w&4)!==0)&&A0(d,c,P),v=v.next}while(v!==m)}xo(a,c,d);break;case 1:if(!Pn&&(gc(d,c),m=d.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=d.memoizedProps,m.state=d.memoizedState,m.componentWillUnmount()}catch(z){Mt(d,c,z)}xo(a,c,d);break;case 21:xo(a,c,d);break;case 22:d.mode&1?(Pn=(m=Pn)||d.memoizedState!==null,xo(a,c,d),Pn=m):xo(a,c,d);break;default:xo(a,c,d)}}function AT(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new NM),c.forEach(function(m){var v=BM.bind(null,a,m);d.has(m)||(d.add(m),m.then(v,v))})}}function ur(a,c){var d=c.deletions;if(d!==null)for(var m=0;m<d.length;m++){var v=d[m];try{var w=a,P=c,z=P;e:for(;z!==null;){switch(z.tag){case 5:_n=z.stateNode,cr=!1;break e;case 3:_n=z.stateNode.containerInfo,cr=!0;break e;case 4:_n=z.stateNode.containerInfo,cr=!0;break e}z=z.return}if(_n===null)throw Error(t(160));bT(w,P,v),_n=null,cr=!1;var W=v.alternate;W!==null&&(W.return=null),v.return=null}catch(ee){Mt(v,c,ee)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)PT(c,a),c=c.sibling}function PT(a,c){var d=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(ur(c,a),Yr(a),m&4){try{Eh(3,a,a.return),mg(3,a)}catch(we){Mt(a,a.return,we)}try{Eh(5,a,a.return)}catch(we){Mt(a,a.return,we)}}break;case 1:ur(c,a),Yr(a),m&512&&d!==null&&gc(d,d.return);break;case 5:if(ur(c,a),Yr(a),m&512&&d!==null&&gc(d,d.return),a.flags&32){var v=a.stateNode;try{kr(v,"")}catch(we){Mt(a,a.return,we)}}if(m&4&&(v=a.stateNode,v!=null)){var w=a.memoizedProps,P=d!==null?d.memoizedProps:w,z=a.type,W=a.updateQueue;if(a.updateQueue=null,W!==null)try{z==="input"&&w.type==="radio"&&w.name!=null&&dn(v,w),ys(z,P);var ee=ys(z,w);for(P=0;P<W.length;P+=2){var ae=W[P],ce=W[P+1];ae==="style"?ms(v,ce):ae==="dangerouslySetInnerHTML"?ua(v,ce):ae==="children"?kr(v,ce):A(v,ae,ce,ee)}switch(z){case"input":qn(v,w);break;case"textarea":io(v,w);break;case"select":var oe=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!w.multiple;var _e=w.value;_e!=null?nn(v,!!w.multiple,_e,!1):oe!==!!w.multiple&&(w.defaultValue!=null?nn(v,!!w.multiple,w.defaultValue,!0):nn(v,!!w.multiple,w.multiple?[]:"",!1))}v[hh]=w}catch(we){Mt(a,a.return,we)}}break;case 6:if(ur(c,a),Yr(a),m&4){if(a.stateNode===null)throw Error(t(162));v=a.stateNode,w=a.memoizedProps;try{v.nodeValue=w}catch(we){Mt(a,a.return,we)}}break;case 3:if(ur(c,a),Yr(a),m&4&&d!==null&&d.memoizedState.isDehydrated)try{co(c.containerInfo)}catch(we){Mt(a,a.return,we)}break;case 4:ur(c,a),Yr(a);break;case 13:ur(c,a),Yr(a),v=a.child,v.flags&8192&&(w=v.memoizedState!==null,v.stateNode.isHidden=w,!w||v.alternate!==null&&v.alternate.memoizedState!==null||(L0=xt())),m&4&&AT(a);break;case 22:if(ae=d!==null&&d.memoizedState!==null,a.mode&1?(Pn=(ee=Pn)||ae,ur(c,a),Pn=ee):ur(c,a),Yr(a),m&8192){if(ee=a.memoizedState!==null,(a.stateNode.isHidden=ee)&&!ae&&(a.mode&1)!==0)for(ve=a,ae=a.child;ae!==null;){for(ce=ve=ae;ve!==null;){switch(oe=ve,_e=oe.child,oe.tag){case 0:case 11:case 14:case 15:Eh(4,oe,oe.return);break;case 1:gc(oe,oe.return);var xe=oe.stateNode;if(typeof xe.componentWillUnmount=="function"){m=oe,d=oe.return;try{c=m,xe.props=c.memoizedProps,xe.state=c.memoizedState,xe.componentWillUnmount()}catch(we){Mt(m,d,we)}}break;case 5:gc(oe,oe.return);break;case 22:if(oe.memoizedState!==null){DT(ce);continue}}_e!==null?(_e.return=oe,ve=_e):DT(ce)}ae=ae.sibling}e:for(ae=null,ce=a;;){if(ce.tag===5){if(ae===null){ae=ce;try{v=ce.stateNode,ee?(w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(z=ce.stateNode,W=ce.memoizedProps.style,P=W!=null&&W.hasOwnProperty("display")?W.display:null,z.style.display=Nr("display",P))}catch(we){Mt(a,a.return,we)}}}else if(ce.tag===6){if(ae===null)try{ce.stateNode.nodeValue=ee?"":ce.memoizedProps}catch(we){Mt(a,a.return,we)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===a)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===a)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===a)break e;ae===ce&&(ae=null),ce=ce.return}ae===ce&&(ae=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:ur(c,a),Yr(a),m&4&&AT(a);break;case 21:break;default:ur(c,a),Yr(a)}}function Yr(a){var c=a.flags;if(c&2){try{e:{for(var d=a.return;d!==null;){if(CT(d)){var m=d;break e}d=d.return}throw Error(t(160))}switch(m.tag){case 5:var v=m.stateNode;m.flags&32&&(kr(v,""),m.flags&=-33);var w=RT(a);N0(a,w,v);break;case 3:case 4:var P=m.stateNode.containerInfo,z=RT(a);k0(a,z,P);break;default:throw Error(t(161))}}catch(W){Mt(a,a.return,W)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function MM(a,c,d){ve=a,kT(a)}function kT(a,c,d){for(var m=(a.mode&1)!==0;ve!==null;){var v=ve,w=v.child;if(v.tag===22&&m){var P=v.memoizedState!==null||pg;if(!P){var z=v.alternate,W=z!==null&&z.memoizedState!==null||Pn;z=pg;var ee=Pn;if(pg=P,(Pn=W)&&!ee)for(ve=v;ve!==null;)P=ve,W=P.child,P.tag===22&&P.memoizedState!==null?MT(v):W!==null?(W.return=P,ve=W):MT(v);for(;w!==null;)ve=w,kT(w),w=w.sibling;ve=v,pg=z,Pn=ee}NT(a)}else(v.subtreeFlags&8772)!==0&&w!==null?(w.return=v,ve=w):NT(a)}}function NT(a){for(;ve!==null;){var c=ve;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Pn||mg(5,c);break;case 1:var m=c.stateNode;if(c.flags&4&&!Pn)if(d===null)m.componentDidMount();else{var v=c.elementType===c.type?d.memoizedProps:lr(c.type,d.memoizedProps);m.componentDidUpdate(v,d.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var w=c.updateQueue;w!==null&&DE(c,w,m);break;case 3:var P=c.updateQueue;if(P!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}DE(c,P,d)}break;case 5:var z=c.stateNode;if(d===null&&c.flags&4){d=z;var W=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":W.autoFocus&&d.focus();break;case"img":W.src&&(d.src=W.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var ee=c.alternate;if(ee!==null){var ae=ee.memoizedState;if(ae!==null){var ce=ae.dehydrated;ce!==null&&co(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Pn||c.flags&512&&P0(c)}catch(oe){Mt(c,c.return,oe)}}if(c===a){ve=null;break}if(d=c.sibling,d!==null){d.return=c.return,ve=d;break}ve=c.return}}function DT(a){for(;ve!==null;){var c=ve;if(c===a){ve=null;break}var d=c.sibling;if(d!==null){d.return=c.return,ve=d;break}ve=c.return}}function MT(a){for(;ve!==null;){var c=ve;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{mg(4,c)}catch(W){Mt(c,d,W)}break;case 1:var m=c.stateNode;if(typeof m.componentDidMount=="function"){var v=c.return;try{m.componentDidMount()}catch(W){Mt(c,v,W)}}var w=c.return;try{P0(c)}catch(W){Mt(c,w,W)}break;case 5:var P=c.return;try{P0(c)}catch(W){Mt(c,P,W)}}}catch(W){Mt(c,c.return,W)}if(c===a){ve=null;break}var z=c.sibling;if(z!==null){z.return=c.return,ve=z;break}ve=c.return}}var LM=Math.ceil,yg=L.ReactCurrentDispatcher,D0=L.ReactCurrentOwner,Bi=L.ReactCurrentBatchConfig,Je=0,on=null,$t=null,vn=0,wi=0,pc=po(0),Zt=0,Th=null,Pa=0,_g=0,M0=0,Sh=null,Qn=null,L0=0,mc=1/0,Ns=null,vg=!1,O0=null,wo=null,xg=!1,Eo=null,wg=0,Ih=0,j0=null,Eg=-1,Tg=0;function Bn(){return(Je&6)!==0?xt():Eg!==-1?Eg:Eg=xt()}function To(a){return(a.mode&1)===0?1:(Je&2)!==0&&vn!==0?vn&-vn:_M.transition!==null?(Tg===0&&(Tg=Hu()),Tg):(a=qe,a!==0||(a=window.event,a=a===void 0?16:$l(a.type)),a)}function hr(a,c,d,m){if(50<Ih)throw Ih=0,j0=null,Error(t(185));_a(a,d,m),((Je&2)===0||a!==on)&&(a===on&&((Je&2)===0&&(_g|=d),Zt===4&&So(a,vn)),Jn(a,m),d===1&&Je===0&&(c.mode&1)===0&&(mc=xt()+500,Zf&&yo()))}function Jn(a,c){var d=a.callbackNode;ya(a,c);var m=vs(a,a===on?vn:0);if(m===0)d!==null&&Fl(d),a.callbackNode=null,a.callbackPriority=0;else if(c=m&-m,a.callbackPriority!==c){if(d!=null&&Fl(d),c===1)a.tag===0?yM(OT.bind(null,a)):wE(OT.bind(null,a)),fM(function(){(Je&6)===0&&yo()}),d=null;else{switch(jr(m)){case 1:d=Vl;break;case 4:d=Gu;break;case 16:d=fa;break;case 536870912:d=zl;break;default:d=fa}d=WT(d,LT.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function LT(a,c){if(Eg=-1,Tg=0,(Je&6)!==0)throw Error(t(327));var d=a.callbackNode;if(yc()&&a.callbackNode!==d)return null;var m=vs(a,a===on?vn:0);if(m===0)return null;if((m&30)!==0||(m&a.expiredLanes)!==0||c)c=Sg(a,m);else{c=m;var v=Je;Je|=2;var w=FT();(on!==a||vn!==c)&&(Ns=null,mc=xt()+500,Na(a,c));do try{FM();break}catch(z){jT(a,z)}while(!0);t0(),yg.current=w,Je=v,$t!==null?c=0:(on=null,vn=0,c=Zt)}if(c!==0){if(c===2&&(v=$u(a),v!==0&&(m=v,c=F0(a,v))),c===1)throw d=Th,Na(a,0),So(a,m),Jn(a,xt()),d;if(c===6)So(a,m);else{if(v=a.current.alternate,(m&30)===0&&!OM(v)&&(c=Sg(a,m),c===2&&(w=$u(a),w!==0&&(m=w,c=F0(a,w))),c===1))throw d=Th,Na(a,0),So(a,m),Jn(a,xt()),d;switch(a.finishedWork=v,a.finishedLanes=m,c){case 0:case 1:throw Error(t(345));case 2:Da(a,Qn,Ns);break;case 3:if(So(a,m),(m&130023424)===m&&(c=L0+500-xt(),10<c)){if(vs(a,0)!==0)break;if(v=a.suspendedLanes,(v&m)!==m){Bn(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=Wy(Da.bind(null,a,Qn,Ns),c);break}Da(a,Qn,Ns);break;case 4:if(So(a,m),(m&4194240)===m)break;for(c=a.eventTimes,v=-1;0<m;){var P=31-gi(m);w=1<<P,P=c[P],P>v&&(v=P),m&=~w}if(m=v,m=xt()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*LM(m/1960))-m,10<m){a.timeoutHandle=Wy(Da.bind(null,a,Qn,Ns),m);break}Da(a,Qn,Ns);break;case 5:Da(a,Qn,Ns);break;default:throw Error(t(329))}}}return Jn(a,xt()),a.callbackNode===d?LT.bind(null,a):null}function F0(a,c){var d=Sh;return a.current.memoizedState.isDehydrated&&(Na(a,c).flags|=256),a=Sg(a,c),a!==2&&(c=Qn,Qn=d,c!==null&&V0(c)),a}function V0(a){Qn===null?Qn=a:Qn.push.apply(Qn,a)}function OM(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var m=0;m<d.length;m++){var v=d[m],w=v.getSnapshot;v=v.value;try{if(!or(w(),v))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function So(a,c){for(c&=~M0,c&=~_g,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-gi(c),m=1<<d;a[d]=-1,c&=~m}}function OT(a){if((Je&6)!==0)throw Error(t(327));yc();var c=vs(a,0);if((c&1)===0)return Jn(a,xt()),null;var d=Sg(a,c);if(a.tag!==0&&d===2){var m=$u(a);m!==0&&(c=m,d=F0(a,m))}if(d===1)throw d=Th,Na(a,0),So(a,c),Jn(a,xt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Da(a,Qn,Ns),Jn(a,xt()),null}function z0(a,c){var d=Je;Je|=1;try{return a(c)}finally{Je=d,Je===0&&(mc=xt()+500,Zf&&yo())}}function ka(a){Eo!==null&&Eo.tag===0&&(Je&6)===0&&yc();var c=Je;Je|=1;var d=Bi.transition,m=qe;try{if(Bi.transition=null,qe=1,a)return a()}finally{qe=m,Bi.transition=d,Je=c,(Je&6)===0&&yo()}}function U0(){wi=pc.current,Et(pc)}function Na(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,dM(d)),$t!==null)for(d=$t.return;d!==null;){var m=d;switch(Yy(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Xf();break;case 3:dc(),Et(Xn),Et(Rn),c0();break;case 5:a0(m);break;case 4:dc();break;case 13:Et(At);break;case 19:Et(At);break;case 10:n0(m.type._context);break;case 22:case 23:U0()}d=d.return}if(on=a,$t=a=Io(a.current,null),vn=wi=c,Zt=0,Th=null,M0=_g=Pa=0,Qn=Sh=null,Ra!==null){for(c=0;c<Ra.length;c++)if(d=Ra[c],m=d.interleaved,m!==null){d.interleaved=null;var v=m.next,w=d.pending;if(w!==null){var P=w.next;w.next=v,m.next=P}d.pending=m}Ra=null}return a}function jT(a,c){do{var d=$t;try{if(t0(),ag.current=hg,lg){for(var m=Pt.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}lg=!1}if(Aa=0,sn=Yt=Pt=null,yh=!1,_h=0,D0.current=null,d===null||d.return===null){Zt=1,Th=c,$t=null;break}e:{var w=a,P=d.return,z=d,W=c;if(c=vn,z.flags|=32768,W!==null&&typeof W=="object"&&typeof W.then=="function"){var ee=W,ae=z,ce=ae.tag;if((ae.mode&1)===0&&(ce===0||ce===11||ce===15)){var oe=ae.alternate;oe?(ae.updateQueue=oe.updateQueue,ae.memoizedState=oe.memoizedState,ae.lanes=oe.lanes):(ae.updateQueue=null,ae.memoizedState=null)}var _e=lT(P);if(_e!==null){_e.flags&=-257,cT(_e,P,z,w,c),_e.mode&1&&aT(w,ee,c),c=_e,W=ee;var xe=c.updateQueue;if(xe===null){var we=new Set;we.add(W),c.updateQueue=we}else xe.add(W);break e}else{if((c&1)===0){aT(w,ee,c),B0();break e}W=Error(t(426))}}else if(Ct&&z.mode&1){var zt=lT(P);if(zt!==null){(zt.flags&65536)===0&&(zt.flags|=256),cT(zt,P,z,w,c),Jy(fc(W,z));break e}}w=W=fc(W,z),Zt!==4&&(Zt=2),Sh===null?Sh=[w]:Sh.push(w),w=P;do{switch(w.tag){case 3:w.flags|=65536,c&=-c,w.lanes|=c;var q=sT(w,W,c);NE(w,q);break e;case 1:z=W;var H=w.type,Y=w.stateNode;if((w.flags&128)===0&&(typeof H.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(wo===null||!wo.has(Y)))){w.flags|=65536,c&=-c,w.lanes|=c;var he=oT(w,z,c);NE(w,he);break e}}w=w.return}while(w!==null)}zT(d)}catch(Te){c=Te,$t===d&&d!==null&&($t=d=d.return);continue}break}while(!0)}function FT(){var a=yg.current;return yg.current=hg,a===null?hg:a}function B0(){(Zt===0||Zt===3||Zt===2)&&(Zt=4),on===null||(Pa&268435455)===0&&(_g&268435455)===0||So(on,vn)}function Sg(a,c){var d=Je;Je|=2;var m=FT();(on!==a||vn!==c)&&(Ns=null,Na(a,c));do try{jM();break}catch(v){jT(a,v)}while(!0);if(t0(),Je=d,yg.current=m,$t!==null)throw Error(t(261));return on=null,vn=0,Zt}function jM(){for(;$t!==null;)VT($t)}function FM(){for(;$t!==null&&!da();)VT($t)}function VT(a){var c=GT(a.alternate,a,wi);a.memoizedProps=a.pendingProps,c===null?zT(a):$t=c,D0.current=null}function zT(a){var c=a;do{var d=c.alternate;if(a=c.return,(c.flags&32768)===0){if(d=PM(d,c,wi),d!==null){$t=d;return}}else{if(d=kM(d,c),d!==null){d.flags&=32767,$t=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Zt=6,$t=null;return}}if(c=c.sibling,c!==null){$t=c;return}$t=c=a}while(c!==null);Zt===0&&(Zt=5)}function Da(a,c,d){var m=qe,v=Bi.transition;try{Bi.transition=null,qe=1,VM(a,c,d,m)}finally{Bi.transition=v,qe=m}return null}function VM(a,c,d,m){do yc();while(Eo!==null);if((Je&6)!==0)throw Error(t(327));d=a.finishedWork;var v=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var w=d.lanes|d.childLanes;if(by(a,w),a===on&&($t=on=null,vn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||xg||(xg=!0,WT(fa,function(){return yc(),null})),w=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||w){w=Bi.transition,Bi.transition=null;var P=qe;qe=1;var z=Je;Je|=4,D0.current=null,DM(a,d),PT(d,a),sM(By),Es=!!Uy,By=Uy=null,a.current=d,MM(d),_s(),Je=z,qe=P,Bi.transition=w}else a.current=d;if(xg&&(xg=!1,Eo=a,wg=v),w=a.pendingLanes,w===0&&(wo=null),kf(d.stateNode),Jn(a,xt()),c!==null)for(m=a.onRecoverableError,d=0;d<c.length;d++)v=c[d],m(v.value,{componentStack:v.stack,digest:v.digest});if(vg)throw vg=!1,a=O0,O0=null,a;return(wg&1)!==0&&a.tag!==0&&yc(),w=a.pendingLanes,(w&1)!==0?a===j0?Ih++:(Ih=0,j0=a):Ih=0,yo(),null}function yc(){if(Eo!==null){var a=jr(wg),c=Bi.transition,d=qe;try{if(Bi.transition=null,qe=16>a?16:a,Eo===null)var m=!1;else{if(a=Eo,Eo=null,wg=0,(Je&6)!==0)throw Error(t(331));var v=Je;for(Je|=4,ve=a.current;ve!==null;){var w=ve,P=w.child;if((ve.flags&16)!==0){var z=w.deletions;if(z!==null){for(var W=0;W<z.length;W++){var ee=z[W];for(ve=ee;ve!==null;){var ae=ve;switch(ae.tag){case 0:case 11:case 15:Eh(8,ae,w)}var ce=ae.child;if(ce!==null)ce.return=ae,ve=ce;else for(;ve!==null;){ae=ve;var oe=ae.sibling,_e=ae.return;if(IT(ae),ae===ee){ve=null;break}if(oe!==null){oe.return=_e,ve=oe;break}ve=_e}}}var xe=w.alternate;if(xe!==null){var we=xe.child;if(we!==null){xe.child=null;do{var zt=we.sibling;we.sibling=null,we=zt}while(we!==null)}}ve=w}}if((w.subtreeFlags&2064)!==0&&P!==null)P.return=w,ve=P;else e:for(;ve!==null;){if(w=ve,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:Eh(9,w,w.return)}var q=w.sibling;if(q!==null){q.return=w.return,ve=q;break e}ve=w.return}}var H=a.current;for(ve=H;ve!==null;){P=ve;var Y=P.child;if((P.subtreeFlags&2064)!==0&&Y!==null)Y.return=P,ve=Y;else e:for(P=H;ve!==null;){if(z=ve,(z.flags&2048)!==0)try{switch(z.tag){case 0:case 11:case 15:mg(9,z)}}catch(Te){Mt(z,z.return,Te)}if(z===P){ve=null;break e}var he=z.sibling;if(he!==null){he.return=z.return,ve=he;break e}ve=z.return}}if(Je=v,yo(),fi&&typeof fi.onPostCommitFiberRoot=="function")try{fi.onPostCommitFiberRoot(ga,a)}catch{}m=!0}return m}finally{qe=d,Bi.transition=c}}return!1}function UT(a,c,d){c=fc(d,c),c=sT(a,c,1),a=vo(a,c,1),c=Bn(),a!==null&&(_a(a,1,c),Jn(a,c))}function Mt(a,c,d){if(a.tag===3)UT(a,a,d);else for(;c!==null;){if(c.tag===3){UT(c,a,d);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(wo===null||!wo.has(m))){a=fc(d,a),a=oT(c,a,1),c=vo(c,a,1),a=Bn(),c!==null&&(_a(c,1,a),Jn(c,a));break}}c=c.return}}function zM(a,c,d){var m=a.pingCache;m!==null&&m.delete(c),c=Bn(),a.pingedLanes|=a.suspendedLanes&d,on===a&&(vn&d)===d&&(Zt===4||Zt===3&&(vn&130023424)===vn&&500>xt()-L0?Na(a,0):M0|=d),Jn(a,c)}function BT(a,c){c===0&&((a.mode&1)===0?c=1:(c=oo,oo<<=1,(oo&130023424)===0&&(oo=4194304)));var d=Bn();a=As(a,c),a!==null&&(_a(a,c,d),Jn(a,d))}function UM(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),BT(a,d)}function BM(a,c){var d=0;switch(a.tag){case 13:var m=a.stateNode,v=a.memoizedState;v!==null&&(d=v.retryLane);break;case 19:m=a.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(c),BT(a,d)}var GT;GT=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Xn.current)Zn=!0;else{if((a.lanes&d)===0&&(c.flags&128)===0)return Zn=!1,AM(a,c,d);Zn=(a.flags&131072)!==0}else Zn=!1,Ct&&(c.flags&1048576)!==0&&EE(c,Jf,c.index);switch(c.lanes=0,c.tag){case 2:var m=c.type;gg(a,c),a=c.pendingProps;var v=sc(c,Rn.current);hc(c,d),v=d0(null,c,m,a,v,d);var w=f0();return c.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Yn(m)?(w=!0,Yf(c)):w=!1,c.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,s0(c),v.updater=dg,c.stateNode=v,v._reactInternals=c,v0(c,m,a,d),c=T0(null,c,m,!0,w,d)):(c.tag=0,Ct&&w&&Xy(c),Un(null,c,v,d),c=c.child),c;case 16:m=c.elementType;e:{switch(gg(a,c),a=c.pendingProps,v=m._init,m=v(m._payload),c.type=m,v=c.tag=WM(m),a=lr(m,a),v){case 0:c=E0(null,c,m,a,d);break e;case 1:c=pT(null,c,m,a,d);break e;case 11:c=uT(null,c,m,a,d);break e;case 14:c=hT(null,c,m,lr(m.type,a),d);break e}throw Error(t(306,m,""))}return c;case 0:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:lr(m,v),E0(a,c,m,v,d);case 1:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:lr(m,v),pT(a,c,m,v,d);case 3:e:{if(mT(c),a===null)throw Error(t(387));m=c.pendingProps,w=c.memoizedState,v=w.element,kE(a,c),sg(c,m,null,d);var P=c.memoizedState;if(m=P.element,w.isDehydrated)if(w={element:m,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},c.updateQueue.baseState=w,c.memoizedState=w,c.flags&256){v=fc(Error(t(423)),c),c=yT(a,c,m,d,v);break e}else if(m!==v){v=fc(Error(t(424)),c),c=yT(a,c,m,d,v);break e}else for(xi=go(c.stateNode.containerInfo.firstChild),vi=c,Ct=!0,ar=null,d=AE(c,null,m,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(lc(),m===v){c=ks(a,c,d);break e}Un(a,c,m,d)}c=c.child}return c;case 5:return ME(c),a===null&&Qy(c),m=c.type,v=c.pendingProps,w=a!==null?a.memoizedProps:null,P=v.children,Gy(m,v)?P=null:w!==null&&Gy(m,w)&&(c.flags|=32),gT(a,c),Un(a,c,P,d),c.child;case 6:return a===null&&Qy(c),null;case 13:return _T(a,c,d);case 4:return o0(c,c.stateNode.containerInfo),m=c.pendingProps,a===null?c.child=cc(c,null,m,d):Un(a,c,m,d),c.child;case 11:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:lr(m,v),uT(a,c,m,v,d);case 7:return Un(a,c,c.pendingProps,d),c.child;case 8:return Un(a,c,c.pendingProps.children,d),c.child;case 12:return Un(a,c,c.pendingProps.children,d),c.child;case 10:e:{if(m=c.type._context,v=c.pendingProps,w=c.memoizedProps,P=v.value,vt(ng,m._currentValue),m._currentValue=P,w!==null)if(or(w.value,P)){if(w.children===v.children&&!Xn.current){c=ks(a,c,d);break e}}else for(w=c.child,w!==null&&(w.return=c);w!==null;){var z=w.dependencies;if(z!==null){P=w.child;for(var W=z.firstContext;W!==null;){if(W.context===m){if(w.tag===1){W=Ps(-1,d&-d),W.tag=2;var ee=w.updateQueue;if(ee!==null){ee=ee.shared;var ae=ee.pending;ae===null?W.next=W:(W.next=ae.next,ae.next=W),ee.pending=W}}w.lanes|=d,W=w.alternate,W!==null&&(W.lanes|=d),i0(w.return,d,c),z.lanes|=d;break}W=W.next}}else if(w.tag===10)P=w.type===c.type?null:w.child;else if(w.tag===18){if(P=w.return,P===null)throw Error(t(341));P.lanes|=d,z=P.alternate,z!==null&&(z.lanes|=d),i0(P,d,c),P=w.sibling}else P=w.child;if(P!==null)P.return=w;else for(P=w;P!==null;){if(P===c){P=null;break}if(w=P.sibling,w!==null){w.return=P.return,P=w;break}P=P.return}w=P}Un(a,c,v.children,d),c=c.child}return c;case 9:return v=c.type,m=c.pendingProps.children,hc(c,d),v=zi(v),m=m(v),c.flags|=1,Un(a,c,m,d),c.child;case 14:return m=c.type,v=lr(m,c.pendingProps),v=lr(m.type,v),hT(a,c,m,v,d);case 15:return dT(a,c,c.type,c.pendingProps,d);case 17:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:lr(m,v),gg(a,c),c.tag=1,Yn(m)?(a=!0,Yf(c)):a=!1,hc(c,d),iT(c,m,v),v0(c,m,v,d),T0(null,c,m,!0,a,d);case 19:return xT(a,c,d);case 22:return fT(a,c,d)}throw Error(t(156,c.tag))};function WT(a,c){return Bu(a,c)}function GM(a,c,d,m){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gi(a,c,d,m){return new GM(a,c,d,m)}function G0(a){return a=a.prototype,!(!a||!a.isReactComponent)}function WM(a){if(typeof a=="function")return G0(a)?1:0;if(a!=null){if(a=a.$$typeof,a===U)return 11;if(a===de)return 14}return 2}function Io(a,c){var d=a.alternate;return d===null?(d=Gi(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function Ig(a,c,d,m,v,w){var P=2;if(m=a,typeof a=="function")G0(a)&&(P=1);else if(typeof a=="string")P=5;else e:switch(a){case M:return Ma(d.children,v,w,c);case I:P=8,v|=8;break;case N:return a=Gi(12,d,c,v|2),a.elementType=N,a.lanes=w,a;case D:return a=Gi(13,d,c,v),a.elementType=D,a.lanes=w,a;case se:return a=Gi(19,d,c,v),a.elementType=se,a.lanes=w,a;case ue:return Cg(d,v,w,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case F:P=10;break e;case V:P=9;break e;case U:P=11;break e;case de:P=14;break e;case me:P=16,m=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=Gi(P,d,c,v),c.elementType=a,c.type=m,c.lanes=w,c}function Ma(a,c,d,m){return a=Gi(7,a,m,c),a.lanes=d,a}function Cg(a,c,d,m){return a=Gi(22,a,m,c),a.elementType=ue,a.lanes=d,a.stateNode={isHidden:!1},a}function W0(a,c,d){return a=Gi(6,a,null,c),a.lanes=d,a}function $0(a,c,d){return c=Gi(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function $M(a,c,d,m,v){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ku(0),this.expirationTimes=Ku(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ku(0),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function H0(a,c,d,m,v,w,P,z,W){return a=new $M(a,c,d,z,W),c===1?(c=1,w===!0&&(c|=8)):c=0,w=Gi(3,null,null,c),a.current=w,w.stateNode=a,w.memoizedState={element:m,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},s0(w),a}function HM(a,c,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:m==null?null:""+m,children:a,containerInfo:c,implementation:d}}function $T(a){if(!a)return mo;a=a._reactInternals;e:{if(rr(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Yn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(Yn(d))return vE(a,d,c)}return c}function HT(a,c,d,m,v,w,P,z,W){return a=H0(d,m,!0,a,v,w,P,z,W),a.context=$T(null),d=a.current,m=Bn(),v=To(d),w=Ps(m,v),w.callback=c??null,vo(d,w,v),a.current.lanes=v,_a(a,v,m),Jn(a,m),a}function Rg(a,c,d,m){var v=c.current,w=Bn(),P=To(v);return d=$T(d),c.context===null?c.context=d:c.pendingContext=d,c=Ps(w,P),c.payload={element:a},m=m===void 0?null:m,m!==null&&(c.callback=m),a=vo(v,c,P),a!==null&&(hr(a,v,P,w),rg(a,v,P)),P}function bg(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function KT(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function K0(a,c){KT(a,c),(a=a.alternate)&&KT(a,c)}function KM(){return null}var qT=typeof reportError=="function"?reportError:function(a){console.error(a)};function q0(a){this._internalRoot=a}Ag.prototype.render=q0.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));Rg(a,c,null,null)},Ag.prototype.unmount=q0.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;ka(function(){Rg(null,a,null,null)}),c[Is]=null}};function Ag(a){this._internalRoot=a}Ag.prototype.unstable_scheduleHydration=function(a){if(a){var c=Zu();a={blockedOn:null,target:a,priority:c};for(var d=0;d<pi.length&&c!==0&&c<pi[d].priority;d++);pi.splice(d,0,a),d===0&&Gl(a)}};function X0(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Pg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function XT(){}function qM(a,c,d,m,v){if(v){if(typeof m=="function"){var w=m;m=function(){var ee=bg(P);w.call(ee)}}var P=HT(c,m,a,0,null,!1,!1,"",XT);return a._reactRootContainer=P,a[Is]=P.current,ch(a.nodeType===8?a.parentNode:a),ka(),P}for(;v=a.lastChild;)a.removeChild(v);if(typeof m=="function"){var z=m;m=function(){var ee=bg(W);z.call(ee)}}var W=H0(a,0,!1,null,null,!1,!1,"",XT);return a._reactRootContainer=W,a[Is]=W.current,ch(a.nodeType===8?a.parentNode:a),ka(function(){Rg(c,W,d,m)}),W}function kg(a,c,d,m,v){var w=d._reactRootContainer;if(w){var P=w;if(typeof v=="function"){var z=v;v=function(){var W=bg(P);z.call(W)}}Rg(c,P,a,v)}else P=qM(d,c,a,v,m);return bg(P)}Xu=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=st(c.pendingLanes);d!==0&&(qu(c,d|1),Jn(c,xt()),(Je&6)===0&&(mc=xt()+500,yo()))}break;case 13:ka(function(){var m=As(a,1);if(m!==null){var v=Bn();hr(m,a,1,v)}}),K0(a,1)}},Ul=function(a){if(a.tag===13){var c=As(a,134217728);if(c!==null){var d=Bn();hr(c,a,134217728,d)}K0(a,134217728)}},Yu=function(a){if(a.tag===13){var c=To(a),d=As(a,c);if(d!==null){var m=Bn();hr(d,a,c,m)}K0(a,c)}},Zu=function(){return qe},Qu=function(a,c){var d=qe;try{return qe=a,c()}finally{qe=d}},Vn=function(a,c,d){switch(c){case"input":if(qn(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var m=d[c];if(m!==a&&m.form===a.form){var v=qf(m);if(!v)throw Error(t(90));ps(m),qn(m,v)}}}break;case"textarea":io(a,d);break;case"select":c=d.value,c!=null&&nn(a,!!d.multiple,c,!1)}},Mi=z0,fn=ka;var XM={usingClientEntryPoint:!1,Events:[dh,ic,qf,ir,jt,z0]},Ch={findFiberByHostInstance:Ta,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},YM={bundleType:Ch.bundleType,version:Ch.version,rendererPackageName:Ch.rendererPackageName,rendererConfig:Ch.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Pf(a),a===null?null:a.stateNode},findFiberByHostInstance:Ch.findFiberByHostInstance||KM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ng=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ng.isDisabled&&Ng.supportsFiber)try{ga=Ng.inject(YM),fi=Ng}catch{}}return ei.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XM,ei.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!X0(c))throw Error(t(200));return HM(a,c,null,d)},ei.createRoot=function(a,c){if(!X0(a))throw Error(t(299));var d=!1,m="",v=qT;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onRecoverableError!==void 0&&(v=c.onRecoverableError)),c=H0(a,1,!1,null,null,d,!1,m,v),a[Is]=c.current,ch(a.nodeType===8?a.parentNode:a),new q0(c)},ei.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Pf(c),a=a===null?null:a.stateNode,a},ei.flushSync=function(a){return ka(a)},ei.hydrate=function(a,c,d){if(!Pg(c))throw Error(t(200));return kg(null,a,c,!0,d)},ei.hydrateRoot=function(a,c,d){if(!X0(a))throw Error(t(405));var m=d!=null&&d.hydratedSources||null,v=!1,w="",P=qT;if(d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(P=d.onRecoverableError)),c=HT(c,null,a,1,d??null,v,!1,w,P),a[Is]=c.current,ch(a),m)for(a=0;a<m.length;a++)d=m[a],v=d._getVersion,v=v(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,v]:c.mutableSourceEagerHydrationData.push(d,v);return new Ag(c)},ei.render=function(a,c,d){if(!Pg(c))throw Error(t(200));return kg(null,a,c,!1,d)},ei.unmountComponentAtNode=function(a){if(!Pg(a))throw Error(t(40));return a._reactRootContainer?(ka(function(){kg(null,null,a,!1,function(){a._reactRootContainer=null,a[Is]=null})}),!0):!1},ei.unstable_batchedUpdates=z0,ei.unstable_renderSubtreeIntoContainer=function(a,c,d,m){if(!Pg(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return kg(a,c,d,!1,m)},ei.version="18.3.1-next-f1338f8080-20240426",ei}var iS;function rL(){if(iS)return Q0.exports;iS=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Q0.exports=iL(),Q0.exports}var rS;function sL(){if(rS)return Dg;rS=1;var n=rL();return Dg.createRoot=n.createRoot,Dg.hydrateRoot=n.hydrateRoot,Dg}var oL=sL();const aL=Px(oL);var K=Qd();const lL=Px(K),kx=K.createContext({});function Nx(n){const e=K.useRef(null);return e.current===null&&(e.current=n()),e.current}const bm=K.createContext(null),Dx=K.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class cL extends K.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function uL({children:n,isPresent:e}){const t=K.useId(),i=K.useRef(null),r=K.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=K.useContext(Dx);return K.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),y.jsx(cL,{isPresent:e,childRef:i,sizeRef:r,children:K.cloneElement(n,{ref:i})})}const hL=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=Nx(dL),u=K.useId(),h=K.useCallback(p=>{l.set(p,!0);for(const _ of l.values())if(!_)return;i&&i()},[l,i]),f=K.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:p=>(l.set(p,!1),()=>l.delete(p))}),s?[Math.random(),h]:[t,h]);return K.useMemo(()=>{l.forEach((p,_)=>l.set(_,!1))},[t]),K.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=y.jsx(uL,{isPresent:t,children:n})),y.jsx(bm.Provider,{value:f,children:n})};function dL(){return new Map}function Vb(n=!0){const e=K.useContext(bm);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=K.useId();K.useEffect(()=>{n&&r(s)},[n]);const o=K.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Mg=n=>n.key||"";function sS(n){const e=[];return K.Children.forEach(n,t=>{K.isValidElement(t)&&e.push(t)}),e}const Mx=typeof window<"u",zb=Mx?K.useLayoutEffect:K.useEffect,On=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,u]=Vb(o),h=K.useMemo(()=>sS(n),[n]),f=o&&!l?[]:h.map(Mg),p=K.useRef(!0),_=K.useRef(h),x=Nx(()=>new Map),[S,C]=K.useState(h),[T,b]=K.useState(h);zb(()=>{p.current=!1,_.current=h;for(let L=0;L<T.length;L++){const O=Mg(T[L]);f.includes(O)?x.delete(O):x.get(O)!==!0&&x.set(O,!1)}},[T,f.length,f.join("-")]);const k=[];if(h!==S){let L=[...h];for(let O=0;O<T.length;O++){const B=T[O],M=Mg(B);f.includes(M)||(L.splice(O,0,B),k.push(B))}s==="wait"&&k.length&&(L=k),b(sS(L)),C(h);return}const{forceRender:A}=K.useContext(kx);return y.jsx(y.Fragment,{children:T.map(L=>{const O=Mg(L),B=o&&!l?!1:h===T||f.includes(O),M=()=>{if(x.has(O))x.set(O,!0);else return;let I=!0;x.forEach(N=>{N||(I=!1)}),I&&(A?.(),b(_.current),o&&u?.(),i&&i())};return y.jsx(hL,{isPresent:B,initial:!p.current||t?void 0:!1,custom:B?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:B?void 0:M,children:L},O)})})},Ci=n=>n;let Ub=Ci;function Lx(n){let e;return()=>(e===void 0&&(e=n()),e)}const iu=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},Bs=n=>n*1e3,Gs=n=>n/1e3,fL={useManualTiming:!1};function gL(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,f=!1,p=!1)=>{const x=p&&i?e:t;return f&&s.add(h),x.has(h)||x.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Lg=["read","resolveKeyframes","update","preRender","render","postRender"],pL=40;function Bb(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Lg.reduce((b,k)=>(b[k]=gL(s),b),{}),{read:l,resolveKeyframes:u,update:h,preRender:f,render:p,postRender:_}=o,x=()=>{const b=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(b-r.timestamp,pL),1),r.timestamp=b,r.isProcessing=!0,l.process(r),u.process(r),h.process(r),f.process(r),p.process(r),_.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(x))},S=()=>{t=!0,i=!0,r.isProcessing||n(x)};return{schedule:Lg.reduce((b,k)=>{const A=o[k];return b[k]=(L,O=!1,B=!1)=>(t||S(),A.schedule(L,O,B)),b},{}),cancel:b=>{for(let k=0;k<Lg.length;k++)o[Lg[k]].cancel(b)},state:r,steps:o}}const{schedule:Tt,cancel:ea,state:xn,steps:t_}=Bb(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ci,!0),Gb=K.createContext({strict:!1}),oS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ru={};for(const n in oS)ru[n]={isEnabled:e=>oS[n].some(t=>!!e[t])};function mL(n){for(const e in n)ru[e]={...ru[e],...n[e]}}const yL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Pp(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||yL.has(n)}let Wb=n=>!Pp(n);function _L(n){n&&(Wb=e=>e.startsWith("on")?!Pp(e):n(e))}try{_L(require("@emotion/is-prop-valid").default)}catch{}function vL(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(Wb(r)||t===!0&&Pp(r)||!e&&!Pp(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function xL(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const Am=K.createContext({});function yd(n){return typeof n=="string"||Array.isArray(n)}function Pm(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const Ox=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],jx=["initial",...Ox];function km(n){return Pm(n.animate)||jx.some(e=>yd(n[e]))}function $b(n){return!!(km(n)||n.variants)}function wL(n,e){if(km(n)){const{initial:t,animate:i}=n;return{initial:t===!1||yd(t)?t:void 0,animate:yd(i)?i:void 0}}return n.inherit!==!1?e:{}}function EL(n){const{initial:e,animate:t}=wL(n,K.useContext(Am));return K.useMemo(()=>({initial:e,animate:t}),[aS(e),aS(t)])}function aS(n){return Array.isArray(n)?n.join(" "):n}const TL=Symbol.for("motionComponentSymbol");function zc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function SL(n,e,t){return K.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):zc(t)&&(t.current=i))},[e])}const Fx=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),IL="framerAppearId",Hb="data-"+Fx(IL),{schedule:Vx}=Bb(queueMicrotask,!1),Kb=K.createContext({});function CL(n,e,t,i,r){var s,o;const{visualElement:l}=K.useContext(Am),u=K.useContext(Gb),h=K.useContext(bm),f=K.useContext(Dx).reducedMotion,p=K.useRef(null);i=i||u.renderer,!p.current&&i&&(p.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const _=p.current,x=K.useContext(Kb);_&&!_.projection&&r&&(_.type==="html"||_.type==="svg")&&RL(p.current,t,r,x);const S=K.useRef(!1);K.useInsertionEffect(()=>{_&&S.current&&_.update(t,h)});const C=t[Hb],T=K.useRef(!!C&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,C))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,C)));return zb(()=>{_&&(S.current=!0,window.MotionIsMounted=!0,_.updateFeatures(),Vx.render(_.render),T.current&&_.animationState&&_.animationState.animateChanges())}),K.useEffect(()=>{_&&(!T.current&&_.animationState&&_.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)===null||b===void 0||b.call(window,C)}),T.current=!1))}),_}function RL(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:qb(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&zc(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function qb(n){if(n)return n.options.allowProjection!==!1?n.projection:qb(n.parent)}function bL({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&mL(n);function l(h,f){let p;const _={...K.useContext(Dx),...h,layoutId:AL(h)},{isStatic:x}=_,S=EL(h),C=i(h,x);if(!x&&Mx){PL();const T=kL(_);p=T.MeasureLayout,S.visualElement=CL(r,C,_,e,T.ProjectionNode)}return y.jsxs(Am.Provider,{value:S,children:[p&&S.visualElement?y.jsx(p,{visualElement:S.visualElement,..._}):null,t(r,h,SL(C,S.visualElement,f),C,x,S.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=K.forwardRef(l);return u[TL]=r,u}function AL({layoutId:n}){const e=K.useContext(kx).id;return e&&n!==void 0?e+"-"+n:n}function PL(n,e){K.useContext(Gb).strict}function kL(n){const{drag:e,layout:t}=ru;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const NL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function zx(n){return typeof n!="string"||n.includes("-")?!1:!!(NL.indexOf(n)>-1||/[A-Z]/u.test(n))}function lS(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function Ux(n,e,t,i){if(typeof e=="function"){const[r,s]=lS(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=lS(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const lv=n=>Array.isArray(n),DL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),ML=n=>lv(n)?n[n.length-1]||0:n,jn=n=>!!(n&&n.getVelocity);function up(n){const e=jn(n)?n.get():n;return DL(e)?e.toValue():e}function LL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:OL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const Xb=n=>(e,t)=>{const i=K.useContext(Am),r=K.useContext(bm),s=()=>LL(n,e,i,r);return t?s():Nx(s)};function OL(n,e,t,i){const r={},s=i(n,{});for(const _ in s)r[_]=up(s[_]);let{initial:o,animate:l}=n;const u=km(n),h=$b(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const p=f?l:o;if(p&&typeof p!="boolean"&&!Pm(p)){const _=Array.isArray(p)?p:[p];for(let x=0;x<_.length;x++){const S=Ux(n,_[x]);if(S){const{transitionEnd:C,transition:T,...b}=S;for(const k in b){let A=b[k];if(Array.isArray(A)){const L=f?A.length-1:0;A=A[L]}A!==null&&(r[k]=A)}for(const k in C)r[k]=C[k]}}}return r}const Nu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Al=new Set(Nu),Yb=n=>e=>typeof e=="string"&&e.startsWith(n),Zb=Yb("--"),jL=Yb("var(--"),Bx=n=>jL(n)?FL.test(n.split("/*")[0].trim()):!1,FL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Qb=(n,e)=>e&&typeof n=="number"?e.transform(n):n,qs=(n,e,t)=>t>e?e:t<n?n:t,Du={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},_d={...Du,transform:n=>qs(0,1,n)},Og={...Du,default:1},Jd=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),jo=Jd("deg"),rs=Jd("%"),De=Jd("px"),VL=Jd("vh"),zL=Jd("vw"),cS={...rs,parse:n=>rs.parse(n)/100,transform:n=>rs.transform(n*100)},UL={borderWidth:De,borderTopWidth:De,borderRightWidth:De,borderBottomWidth:De,borderLeftWidth:De,borderRadius:De,radius:De,borderTopLeftRadius:De,borderTopRightRadius:De,borderBottomRightRadius:De,borderBottomLeftRadius:De,width:De,maxWidth:De,height:De,maxHeight:De,top:De,right:De,bottom:De,left:De,padding:De,paddingTop:De,paddingRight:De,paddingBottom:De,paddingLeft:De,margin:De,marginTop:De,marginRight:De,marginBottom:De,marginLeft:De,backgroundPositionX:De,backgroundPositionY:De},BL={rotate:jo,rotateX:jo,rotateY:jo,rotateZ:jo,scale:Og,scaleX:Og,scaleY:Og,scaleZ:Og,skew:jo,skewX:jo,skewY:jo,distance:De,translateX:De,translateY:De,translateZ:De,x:De,y:De,z:De,perspective:De,transformPerspective:De,opacity:_d,originX:cS,originY:cS,originZ:De},uS={...Du,transform:Math.round},Gx={...UL,...BL,zIndex:uS,size:De,fillOpacity:_d,strokeOpacity:_d,numOctaves:uS},GL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},WL=Nu.length;function $L(n,e,t){let i="",r=!0;for(let s=0;s<WL;s++){const o=Nu[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=Qb(l,Gx[o]);if(!u){r=!1;const f=GL[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function Wx(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const u in e){const h=e[u];if(Al.has(u)){o=!0;continue}else if(Zb(u)){r[u]=h;continue}else{const f=Qb(h,Gx[u]);u.startsWith("origin")?(l=!0,s[u]=f):i[u]=f}}if(e.transform||(o||t?i.transform=$L(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${u} ${h} ${f}`}}const HL={offset:"stroke-dashoffset",array:"stroke-dasharray"},KL={offset:"strokeDashoffset",array:"strokeDasharray"};function qL(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?HL:KL;n[s.offset]=De.transform(-i);const o=De.transform(e),l=De.transform(t);n[s.array]=`${o} ${l}`}function hS(n,e,t){return typeof n=="string"?n:De.transform(e+t*n)}function XL(n,e,t){const i=hS(e,n.x,n.width),r=hS(t,n.y,n.height);return`${i} ${r}`}function $x(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...h},f,p){if(Wx(n,h,p),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:_,style:x,dimensions:S}=n;_.transform&&(S&&(x.transform=_.transform),delete _.transform),S&&(r!==void 0||s!==void 0||x.transform)&&(x.transformOrigin=XL(S,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(_.x=e),t!==void 0&&(_.y=t),i!==void 0&&(_.scale=i),o!==void 0&&qL(_,o,l,u,!1)}const Hx=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Jb=()=>({...Hx(),attrs:{}}),Kx=n=>typeof n=="string"&&n.toLowerCase()==="svg";function e2(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const t2=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function n2(n,e,t,i){e2(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(t2.has(r)?r:Fx(r),e.attrs[r])}const kp={};function YL(n){Object.assign(kp,n)}function i2(n,{layout:e,layoutId:t}){return Al.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!kp[n]||n==="opacity")}function qx(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(jn(r[o])||e.style&&jn(e.style[o])||i2(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function r2(n,e,t){const i=qx(n,e,t);for(const r in n)if(jn(n[r])||jn(e[r])){const s=Nu.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function ZL(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const dS=["x","y","width","height","cx","cy","r"],QL={useVisualState:Xb({scrapeMotionValuesFromProps:r2,createRenderState:Jb,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(Al.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<dS.length;l++){const u=dS[l];n[u]!==e[u]&&(o=!0)}o&&Tt.read(()=>{ZL(t,i),Tt.render(()=>{$x(i,r,Kx(t.tagName),n.transformTemplate),n2(t,i)})})}})},JL={useVisualState:Xb({scrapeMotionValuesFromProps:qx,createRenderState:Hx})};function s2(n,e,t){for(const i in e)!jn(e[i])&&!i2(i,t)&&(n[i]=e[i])}function eO({transformTemplate:n},e){return K.useMemo(()=>{const t=Hx();return Wx(t,e,n),Object.assign({},t.vars,t.style)},[e])}function tO(n,e){const t=n.style||{},i={};return s2(i,t,n),Object.assign(i,eO(n,e)),i}function nO(n,e){const t={},i=tO(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function iO(n,e,t,i){const r=K.useMemo(()=>{const s=Jb();return $x(s,e,Kx(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};s2(s,n.style,n),r.style={...s,...r.style}}return r}function rO(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(zx(t)?iO:nO)(i,s,o,t),h=vL(i,typeof t=="string",n),f=t!==K.Fragment?{...h,...u,ref:r}:{},{children:p}=i,_=K.useMemo(()=>jn(p)?p.get():p,[p]);return K.createElement(t,{...f,children:_})}}function sO(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...zx(i)?QL:JL,preloadedFeatures:n,useRender:rO(r),createVisualElement:e,Component:i};return bL(o)}}function o2(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function Nm(n,e,t){const i=n.getProps();return Ux(i,e,t!==void 0?t:i.custom,n)}const oO=Lx(()=>window.ScrollTimeline!==void 0);class aO{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(oO()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class lO extends aO{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Xx(n,e){return n?n[e]||n.default||n:void 0}const cv=2e4;function a2(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<cv;)e+=t,i=n.next(e);return e>=cv?1/0:e}function Yx(n){return typeof n=="function"}function fS(n,e){n.timeline=e,n.onfinish=null}const Zx=n=>Array.isArray(n)&&typeof n[0]=="number",cO={linearEasing:void 0};function uO(n,e){const t=Lx(n);return()=>{var i;return(i=cO[e])!==null&&i!==void 0?i:t()}}const Np=uO(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),l2=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(iu(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function c2(n){return!!(typeof n=="function"&&Np()||!n||typeof n=="string"&&(n in uv||Np())||Zx(n)||Array.isArray(n)&&n.every(c2))}const Uh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,uv={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Uh([0,.65,.55,1]),circOut:Uh([.55,0,1,.45]),backIn:Uh([.31,.01,.66,-.59]),backOut:Uh([.33,1.53,.69,.99])};function u2(n,e){if(n)return typeof n=="function"&&Np()?l2(n,e):Zx(n)?Uh(n):Array.isArray(n)?n.map(t=>u2(t,e)||uv.easeOut):uv[n]}const fr={x:!1,y:!1};function h2(){return fr.x||fr.y}function hO(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function d2(n,e){const t=hO(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function gS(n){return e=>{e.pointerType==="touch"||h2()||n(e)}}function dO(n,e,t={}){const[i,r,s]=d2(n,t),o=gS(l=>{const{target:u}=l,h=e(l);if(typeof h!="function"||!u)return;const f=gS(p=>{h(p),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const f2=(n,e)=>e?n===e?!0:f2(n,e.parentElement):!1,Qx=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,fO=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function gO(n){return fO.has(n.tagName)||n.tabIndex!==-1}const Bh=new WeakSet;function pS(n){return e=>{e.key==="Enter"&&n(e)}}function n_(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const pO=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=pS(()=>{if(Bh.has(t))return;n_(t,"down");const r=pS(()=>{n_(t,"up")}),s=()=>n_(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function mS(n){return Qx(n)&&!h2()}function mO(n,e,t={}){const[i,r,s]=d2(n,t),o=l=>{const u=l.currentTarget;if(!mS(l)||Bh.has(u))return;Bh.add(u);const h=e(l),f=(x,S)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",_),!(!mS(x)||!Bh.has(u))&&(Bh.delete(u),typeof h=="function"&&h(x,{success:S}))},p=x=>{f(x,t.useGlobalTarget||f2(u,x.target))},_=x=>{f(x,!1)};window.addEventListener("pointerup",p,r),window.addEventListener("pointercancel",_,r)};return i.forEach(l=>{!gO(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>pO(h,r),r)}),s}function yO(n){return n==="x"||n==="y"?fr[n]?null:(fr[n]=!0,()=>{fr[n]=!1}):fr.x||fr.y?null:(fr.x=fr.y=!0,()=>{fr.x=fr.y=!1})}const g2=new Set(["width","height","top","left","right","bottom",...Nu]);let hp;function _O(){hp=void 0}const ss={now:()=>(hp===void 0&&ss.set(xn.isProcessing||fL.useManualTiming?xn.timestamp:performance.now()),hp),set:n=>{hp=n,queueMicrotask(_O)}};function Jx(n,e){n.indexOf(e)===-1&&n.push(e)}function e1(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class t1{constructor(){this.subscriptions=[]}add(e){return Jx(this.subscriptions,e),()=>e1(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function p2(n,e){return e?n*(1e3/e):0}const yS=30,vO=n=>!isNaN(parseFloat(n));class xO{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=ss.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ss.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=vO(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new t1);const i=this.events[e].add(t);return e==="change"?()=>{i(),Tt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ss.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>yS)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,yS);return p2(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function vd(n,e){return new xO(n,e)}function wO(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,vd(t))}function EO(n,e){const t=Nm(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=ML(s[o]);wO(n,o,l)}}function TO(n){return!!(jn(n)&&n.add)}function hv(n,e){const t=n.getValue("willChange");if(TO(t))return t.add(e)}function m2(n){return n.props[Hb]}const y2=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,SO=1e-7,IO=12;function CO(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=y2(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>SO&&++l<IO);return o}function ef(n,e,t,i){if(n===e&&t===i)return Ci;const r=s=>CO(s,0,1,n,t);return s=>s===0||s===1?s:y2(r(s),e,i)}const _2=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,v2=n=>e=>1-n(1-e),x2=ef(.33,1.53,.69,.99),n1=v2(x2),w2=_2(n1),E2=n=>(n*=2)<1?.5*n1(n):.5*(2-Math.pow(2,-10*(n-1))),i1=n=>1-Math.sin(Math.acos(n)),T2=v2(i1),S2=_2(i1),I2=n=>/^0[^.\s]+$/u.test(n);function RO(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||I2(n):!0}const Jh=n=>Math.round(n*1e5)/1e5,r1=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function bO(n){return n==null}const AO=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,s1=(n,e)=>t=>!!(typeof t=="string"&&AO.test(t)&&t.startsWith(n)||e&&!bO(t)&&Object.prototype.hasOwnProperty.call(t,e)),C2=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(r1);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},PO=n=>qs(0,255,n),i_={...Du,transform:n=>Math.round(PO(n))},Za={test:s1("rgb","red"),parse:C2("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+i_.transform(n)+", "+i_.transform(e)+", "+i_.transform(t)+", "+Jh(_d.transform(i))+")"};function kO(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const dv={test:s1("#"),parse:kO,transform:Za.transform},Uc={test:s1("hsl","hue"),parse:C2("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+rs.transform(Jh(e))+", "+rs.transform(Jh(t))+", "+Jh(_d.transform(i))+")"},Dn={test:n=>Za.test(n)||dv.test(n)||Uc.test(n),parse:n=>Za.test(n)?Za.parse(n):Uc.test(n)?Uc.parse(n):dv.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Za.transform(n):Uc.transform(n)},NO=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function DO(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(r1))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(NO))===null||t===void 0?void 0:t.length)||0)>0}const R2="number",b2="color",MO="var",LO="var(",_S="${}",OO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function xd(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(OO,u=>(Dn.test(u)?(i.color.push(s),r.push(b2),t.push(Dn.parse(u))):u.startsWith(LO)?(i.var.push(s),r.push(MO),t.push(u)):(i.number.push(s),r.push(R2),t.push(parseFloat(u))),++s,_S)).split(_S);return{values:t,split:l,indexes:i,types:r}}function A2(n){return xd(n).values}function P2(n){const{split:e,types:t}=xd(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===R2?s+=Jh(r[o]):l===b2?s+=Dn.transform(r[o]):s+=r[o]}return s}}const jO=n=>typeof n=="number"?0:n;function FO(n){const e=A2(n);return P2(n)(e.map(jO))}const ta={test:DO,parse:A2,createTransformer:P2,getAnimatableNone:FO},VO=new Set(["brightness","contrast","saturate","opacity"]);function zO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(r1)||[];if(!i)return n;const r=t.replace(i,"");let s=VO.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const UO=/\b([a-z-]*)\(.*?\)/gu,fv={...ta,getAnimatableNone:n=>{const e=n.match(UO);return e?e.map(zO).join(" "):n}},BO={...Gx,color:Dn,backgroundColor:Dn,outlineColor:Dn,fill:Dn,stroke:Dn,borderColor:Dn,borderTopColor:Dn,borderRightColor:Dn,borderBottomColor:Dn,borderLeftColor:Dn,filter:fv,WebkitFilter:fv},o1=n=>BO[n];function k2(n,e){let t=o1(n);return t!==fv&&(t=ta),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const GO=new Set(["auto","none","0"]);function WO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!GO.has(s)&&xd(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=k2(t,r)}const vS=n=>n===Du||n===De,xS=(n,e)=>parseFloat(n.split(", ")[e]),wS=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return xS(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?xS(s[1],n):0}},$O=new Set(["x","y","z"]),HO=Nu.filter(n=>!$O.has(n));function KO(n){const e=[];return HO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const su={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:wS(4,13),y:wS(5,14)};su.translateX=su.x;su.translateY=su.y;const sl=new Set;let gv=!1,pv=!1;function N2(){if(pv){const n=Array.from(sl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=KO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}pv=!1,gv=!1,sl.forEach(n=>n.complete()),sl.clear()}function D2(){sl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(pv=!0)})}function qO(){D2(),N2()}class a1{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(sl.add(this),gv||(gv=!0,Tt.read(D2),Tt.resolveKeyframes(N2))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),sl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,sl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const M2=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),XO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function YO(n){const e=XO.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function L2(n,e,t=1){const[i,r]=YO(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return M2(o)?parseFloat(o):o}return Bx(r)?L2(r,e,t+1):r}const O2=n=>e=>e.test(n),ZO={test:n=>n==="auto",parse:n=>n},j2=[Du,De,rs,jo,zL,VL,ZO],ES=n=>j2.find(O2(n));class F2 extends a1{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),Bx(h))){const f=L2(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!g2.has(i)||e.length!==2)return;const[r,s]=e,o=ES(r),l=ES(s);if(o!==l)if(vS(o)&&vS(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)RO(e[r])&&i.push(r);i.length&&WO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=su[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=su[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const TS=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ta.test(n)||n==="0")&&!n.startsWith("url("));function QO(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function JO(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=TS(r,e),l=TS(s,e);return!o||!l?!1:QO(n)||(t==="spring"||Yx(t))&&i}const e5=n=>n!==null;function Dm(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(e5),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const t5=40;class V2{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ss.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>t5?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&qO(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ss.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:u,isGenerator:h}=this.options;if(!h&&!JO(e,i,r,s))if(o)this.options.duration=0;else{u&&u(Dm(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Nt=(n,e,t)=>n+(e-n)*t;function r_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function n5({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;r=r_(u,l,n+1/3),s=r_(u,l,n),o=r_(u,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Dp(n,e){return t=>t>0?e:n}const s_=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},i5=[dv,Za,Uc],r5=n=>i5.find(e=>e.test(n));function SS(n){const e=r5(n);if(!e)return!1;let t=e.parse(n);return e===Uc&&(t=n5(t)),t}const IS=(n,e)=>{const t=SS(n),i=SS(e);if(!t||!i)return Dp(n,e);const r={...t};return s=>(r.red=s_(t.red,i.red,s),r.green=s_(t.green,i.green,s),r.blue=s_(t.blue,i.blue,s),r.alpha=Nt(t.alpha,i.alpha,s),Za.transform(r))},s5=(n,e)=>t=>e(n(t)),tf=(...n)=>n.reduce(s5),mv=new Set(["none","hidden"]);function o5(n,e){return mv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function a5(n,e){return t=>Nt(n,e,t)}function l1(n){return typeof n=="number"?a5:typeof n=="string"?Bx(n)?Dp:Dn.test(n)?IS:u5:Array.isArray(n)?z2:typeof n=="object"?Dn.test(n)?IS:l5:Dp}function z2(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>l1(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function l5(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=l1(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function c5(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],u=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const u5=(n,e)=>{const t=ta.createTransformer(e),i=xd(n),r=xd(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?mv.has(n)&&!r.values.length||mv.has(e)&&!i.values.length?o5(n,e):tf(z2(c5(i,r),r.values),t):Dp(n,e)};function U2(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Nt(n,e,t):l1(n)(n,e)}const h5=5;function B2(n,e,t){const i=Math.max(e-h5,0);return p2(t-n(i),e-i)}const Ot={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},o_=.001;function d5({duration:n=Ot.duration,bounce:e=Ot.bounce,velocity:t=Ot.velocity,mass:i=Ot.mass}){let r,s,o=1-e;o=qs(Ot.minDamping,Ot.maxDamping,o),n=qs(Ot.minDuration,Ot.maxDuration,Gs(n)),o<1?(r=h=>{const f=h*o,p=f*n,_=f-t,x=yv(h,o),S=Math.exp(-p);return o_-_/x*S},s=h=>{const p=h*o*n,_=p*t+t,x=Math.pow(o,2)*Math.pow(h,2)*n,S=Math.exp(-p),C=yv(Math.pow(h,2),o);return(-r(h)+o_>0?-1:1)*((_-x)*S)/C}):(r=h=>{const f=Math.exp(-h*n),p=(h-t)*n+1;return-o_+f*p},s=h=>{const f=Math.exp(-h*n),p=(t-h)*(n*n);return f*p});const l=5/n,u=g5(r,s,l);if(n=Bs(n),isNaN(u))return{stiffness:Ot.stiffness,damping:Ot.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const f5=12;function g5(n,e,t){let i=t;for(let r=1;r<f5;r++)i=i-n(i)/e(i);return i}function yv(n,e){return n*Math.sqrt(1-e*e)}const p5=["duration","bounce"],m5=["stiffness","damping","mass"];function CS(n,e){return e.some(t=>n[t]!==void 0)}function y5(n){let e={velocity:Ot.velocity,stiffness:Ot.stiffness,damping:Ot.damping,mass:Ot.mass,isResolvedFromDuration:!1,...n};if(!CS(n,m5)&&CS(n,p5))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*qs(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Ot.mass,stiffness:r,damping:s}}else{const t=d5(n);e={...e,...t,mass:Ot.mass},e.isResolvedFromDuration=!0}return e}function G2(n=Ot.visualDuration,e=Ot.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:p,velocity:_,isResolvedFromDuration:x}=y5({...t,velocity:-Gs(t.velocity||0)}),S=_||0,C=h/(2*Math.sqrt(u*f)),T=o-s,b=Gs(Math.sqrt(u/f)),k=Math.abs(T)<5;i||(i=k?Ot.restSpeed.granular:Ot.restSpeed.default),r||(r=k?Ot.restDelta.granular:Ot.restDelta.default);let A;if(C<1){const O=yv(b,C);A=B=>{const M=Math.exp(-C*b*B);return o-M*((S+C*b*T)/O*Math.sin(O*B)+T*Math.cos(O*B))}}else if(C===1)A=O=>o-Math.exp(-b*O)*(T+(S+b*T)*O);else{const O=b*Math.sqrt(C*C-1);A=B=>{const M=Math.exp(-C*b*B),I=Math.min(O*B,300);return o-M*((S+C*b*T)*Math.sinh(I)+O*T*Math.cosh(I))/O}}const L={calculatedDuration:x&&p||null,next:O=>{const B=A(O);if(x)l.done=O>=p;else{let M=0;C<1&&(M=O===0?Bs(S):B2(A,O,B));const I=Math.abs(M)<=i,N=Math.abs(o-B)<=r;l.done=I&&N}return l.value=l.done?o:B,l},toString:()=>{const O=Math.min(a2(L),cv),B=l2(M=>L.next(O*M).value,O,30);return O+"ms "+B}};return L}function RS({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:f}){const p=n[0],_={done:!1,value:p},x=I=>l!==void 0&&I<l||u!==void 0&&I>u,S=I=>l===void 0?u:u===void 0||Math.abs(l-I)<Math.abs(u-I)?l:u;let C=t*e;const T=p+C,b=o===void 0?T:o(T);b!==T&&(C=b-p);const k=I=>-C*Math.exp(-I/i),A=I=>b+k(I),L=I=>{const N=k(I),F=A(I);_.done=Math.abs(N)<=h,_.value=_.done?b:F};let O,B;const M=I=>{x(_.value)&&(O=I,B=G2({keyframes:[_.value,S(_.value)],velocity:B2(A,I,_.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return M(0),{calculatedDuration:null,next:I=>{let N=!1;return!B&&O===void 0&&(N=!0,L(I),M(I)),O!==void 0&&I>=O?B.next(I-O):(!N&&L(I),_)}}}const _5=ef(.42,0,1,1),v5=ef(0,0,.58,1),W2=ef(.42,0,.58,1),x5=n=>Array.isArray(n)&&typeof n[0]!="number",w5={linear:Ci,easeIn:_5,easeInOut:W2,easeOut:v5,circIn:i1,circInOut:S2,circOut:T2,backIn:n1,backInOut:w2,backOut:x2,anticipate:E2},bS=n=>{if(Zx(n)){Ub(n.length===4);const[e,t,i,r]=n;return ef(e,t,i,r)}else if(typeof n=="string")return w5[n];return n};function E5(n,e,t){const i=[],r=t||U2,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ci:e;l=tf(u,l)}i.push(l)}return i}function T5(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(Ub(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=E5(e,i,r),u=l.length,h=f=>{if(o&&f<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(f<n[p+1]);p++);const _=iu(n[p],n[p+1],f);return l[p](_)};return t?f=>h(qs(n[0],n[s-1],f)):h}function S5(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=iu(0,e,i);n.push(Nt(t,1,r))}}function I5(n){const e=[0];return S5(e,n.length-1),e}function C5(n,e){return n.map(t=>t*e)}function R5(n,e){return n.map(()=>e||W2).splice(0,n.length-1)}function Mp({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=x5(i)?i.map(bS):bS(i),s={done:!1,value:e[0]},o=C5(t&&t.length===e.length?t:I5(e),n),l=T5(o,e,{ease:Array.isArray(r)?r:R5(e,r)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const b5=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Tt.update(e,!0),stop:()=>ea(e),now:()=>xn.isProcessing?xn.timestamp:ss.now()}},A5={decay:RS,inertia:RS,tween:Mp,keyframes:Mp,spring:G2},P5=n=>n/100;class c1 extends V2{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||a1,l=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=Yx(t)?t:A5[t]||Mp;let u,h;l!==Mp&&typeof e[0]!="number"&&(u=tf(P5,U2(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=a2(f));const{calculatedDuration:p}=f,_=p+r,x=_*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:p,resolvedDuration:_,totalDuration:x}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:I}=this.options;return{done:!0,value:I[I.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:p}=i;if(this.startTime===null)return s.next(0);const{delay:_,repeat:x,repeatType:S,repeatDelay:C,onUpdate:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const b=this.currentTime-_*(this.speed>=0?1:-1),k=this.speed>=0?b<0:b>f;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let A=this.currentTime,L=s;if(x){const I=Math.min(this.currentTime,f)/p;let N=Math.floor(I),F=I%1;!F&&I>=1&&(F=1),F===1&&N--,N=Math.min(N,x+1),N%2&&(S==="reverse"?(F=1-F,C&&(F-=C/p)):S==="mirror"&&(L=o)),A=qs(0,1,F)*p}const O=k?{done:!1,value:u[0]}:L.next(A);l&&(O.value=l(O.value));let{done:B}=O;!k&&h!==null&&(B=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const M=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&B);return M&&r!==void 0&&(O.value=Dm(u,this.options,r)),T&&T(O.value),M&&this.finish(),O}get duration(){const{resolved:e}=this;return e?Gs(e.calculatedDuration):0}get time(){return Gs(this.currentTime)}set time(e){e=Bs(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Gs(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=b5,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const k5=new Set(["opacity","clipPath","filter","transform"]);function N5(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=u2(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const D5=Lx(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Lp=10,M5=2e4;function L5(n){return Yx(n.type)||n.type==="spring"||!c2(n.ease)}function O5(n,e){const t=new c1({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<M5;)i=t.sample(s),r.push(i.value),s+=Lp;return{times:void 0,keyframes:r,duration:s-Lp,ease:"linear"}}const $2={anticipate:E2,backInOut:w2,circInOut:S2};function j5(n){return n in $2}class AS extends V2{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new F2(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:u,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&Np()&&j5(s)&&(s=$2[s]),L5(this.options)){const{onComplete:p,onUpdate:_,motionValue:x,element:S,...C}=this.options,T=O5(e,C);e=T.keyframes,e.length===1&&(e[1]=e[0]),i=T.duration,r=T.times,s=T.ease,o="keyframes"}const f=N5(l.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(fS(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:p}=this.options;l.set(Dm(e,this.options,t)),p&&p(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Gs(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Gs(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=Bs(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Ci;const{animation:i}=t;fS(i,e)}return Ci}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:p,element:_,...x}=this.options,S=new c1({...x,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),C=Bs(this.time);h.setWithVelocity(S.sample(C-Lp).value,S.sample(C).value,Lp)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return D5()&&i&&k5.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const F5={type:"spring",stiffness:500,damping:25,restSpeed:10},V5=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),z5={type:"keyframes",duration:.8},U5={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},B5=(n,{keyframes:e})=>e.length>2?z5:Al.has(n)?n.startsWith("scale")?V5(e[1]):F5:U5;function G5({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const u1=(n,e,t,i={},r,s)=>o=>{const l=Xx(i,n)||{},u=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-Bs(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:_=>{e.set(_),l.onUpdate&&l.onUpdate(_)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};G5(l)||(f={...f,...B5(n,f)}),f.duration&&(f.duration=Bs(f.duration)),f.repeatDelay&&(f.repeatDelay=Bs(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(p=!0)),p&&!s&&e.get()!==void 0){const _=Dm(f.keyframes,l);if(_!==void 0)return Tt.update(()=>{f.onUpdate(_),f.onComplete()}),new lO([])}return!s&&AS.supports(f)?new AS(f):new c1(f)};function W5({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function H2(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...u}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const p in u){const _=n.getValue(p,(s=n.latestValues[p])!==null&&s!==void 0?s:null),x=u[p];if(x===void 0||f&&W5(f,p))continue;const S={delay:t,...Xx(o||{},p)};let C=!1;if(window.MotionHandoffAnimation){const b=m2(n);if(b){const k=window.MotionHandoffAnimation(b,p,Tt);k!==null&&(S.startTime=k,C=!0)}}hv(n,p),_.start(u1(p,_,x,n.shouldReduceMotion&&g2.has(p)?{type:!1}:S,n,C));const T=_.animation;T&&h.push(T)}return l&&Promise.all(h).then(()=>{Tt.update(()=>{l&&EO(n,l)})}),h}function _v(n,e,t={}){var i;const r=Nm(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(H2(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:p,staggerDirection:_}=s;return $5(n,e,f+h,p,_,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function $5(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(H5).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(_v(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function H5(n,e){return n.sortNodePosition(e)}function K5(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>_v(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=_v(n,e,t);else{const r=typeof e=="function"?Nm(n,e,t.custom):e;i=Promise.all(H2(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const q5=jx.length;function K2(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?K2(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<q5;t++){const i=jx[t],r=n.props[i];(yd(r)||r===!1)&&(e[i]=r)}return e}const X5=[...Ox].reverse(),Y5=Ox.length;function Z5(n){return e=>Promise.all(e.map(({animation:t,options:i})=>K5(n,t,i)))}function Q5(n){let e=Z5(n),t=PS(),i=!0;const r=u=>(h,f)=>{var p;const _=Nm(n,f,u==="exit"?(p=n.presenceContext)===null||p===void 0?void 0:p.custom:void 0);if(_){const{transition:x,transitionEnd:S,...C}=_;h={...h,...C,...S}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,f=K2(n.parent)||{},p=[],_=new Set;let x={},S=1/0;for(let T=0;T<Y5;T++){const b=X5[T],k=t[b],A=h[b]!==void 0?h[b]:f[b],L=yd(A),O=b===u?k.isActive:null;O===!1&&(S=T);let B=A===f[b]&&A!==h[b]&&L;if(B&&i&&n.manuallyAnimateOnMount&&(B=!1),k.protectedKeys={...x},!k.isActive&&O===null||!A&&!k.prevProp||Pm(A)||typeof A=="boolean")continue;const M=J5(k.prevProp,A);let I=M||b===u&&k.isActive&&!B&&L||T>S&&L,N=!1;const F=Array.isArray(A)?A:[A];let V=F.reduce(r(b),{});O===!1&&(V={});const{prevResolvedValues:U={}}=k,D={...U,...V},se=ue=>{I=!0,_.has(ue)&&(N=!0,_.delete(ue)),k.needsAnimating[ue]=!0;const J=n.getValue(ue);J&&(J.liveStyle=!1)};for(const ue in D){const J=V[ue],Z=U[ue];if(x.hasOwnProperty(ue))continue;let ne=!1;lv(J)&&lv(Z)?ne=!o2(J,Z):ne=J!==Z,ne?J!=null?se(ue):_.add(ue):J!==void 0&&_.has(ue)?se(ue):k.protectedKeys[ue]=!0}k.prevProp=A,k.prevResolvedValues=V,k.isActive&&(x={...x,...V}),i&&n.blockInitialAnimation&&(I=!1),I&&(!(B&&M)||N)&&p.push(...F.map(ue=>({animation:ue,options:{type:b}})))}if(_.size){const T={};_.forEach(b=>{const k=n.getBaseTarget(b),A=n.getValue(b);A&&(A.liveStyle=!0),T[b]=k??null}),p.push({animation:T})}let C=!!p.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(C=!1),i=!1,C?e(p):Promise.resolve()}function l(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(_=>{var x;return(x=_.animationState)===null||x===void 0?void 0:x.setActive(u,h)}),t[u].isActive=h;const p=o(u);for(const _ in t)t[_].protectedKeys={};return p}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=PS(),i=!0}}}function J5(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!o2(e,n):!1}function La(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function PS(){return{animate:La(!0),whileInView:La(),whileHover:La(),whileTap:La(),whileDrag:La(),whileFocus:La(),exit:La()}}let aa=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class ej extends aa{constructor(e){super(e),e.animationState||(e.animationState=Q5(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Pm(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let tj=0;class nj extends aa{constructor(){super(...arguments),this.id=tj++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const ij={animation:{Feature:ej},exit:{Feature:nj}};function wd(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function nf(n){return{point:{x:n.pageX,y:n.pageY}}}const rj=n=>e=>Qx(e)&&n(e,nf(e));function ed(n,e,t,i){return wd(n,e,rj(t),i)}const kS=(n,e)=>Math.abs(n-e);function sj(n,e){const t=kS(n.x,e.x),i=kS(n.y,e.y);return Math.sqrt(t**2+i**2)}class q2{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=l_(this.lastMoveEventInfo,this.history),_=this.startEvent!==null,x=sj(p.offset,{x:0,y:0})>=3;if(!_&&!x)return;const{point:S}=p,{timestamp:C}=xn;this.history.push({...S,timestamp:C});const{onStart:T,onMove:b}=this.handlers;_||(T&&T(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,p)},this.handlePointerMove=(p,_)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=a_(_,this.transformPagePoint),Tt.update(this.updatePoint,!0)},this.handlePointerUp=(p,_)=>{this.end();const{onEnd:x,onSessionEnd:S,resumeAnimation:C}=this.handlers;if(this.dragSnapToOrigin&&C&&C(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=l_(p.type==="pointercancel"?this.lastMoveEventInfo:a_(_,this.transformPagePoint),this.history);this.startEvent&&x&&x(p,T),S&&S(p,T)},!Qx(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=nf(e),l=a_(o,this.transformPagePoint),{point:u}=l,{timestamp:h}=xn;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,l_(l,this.history)),this.removeListeners=tf(ed(this.contextWindow,"pointermove",this.handlePointerMove),ed(this.contextWindow,"pointerup",this.handlePointerUp),ed(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ea(this.updatePoint)}}function a_(n,e){return e?{point:e(n.point)}:n}function NS(n,e){return{x:n.x-e.x,y:n.y-e.y}}function l_({point:n},e){return{point:n,delta:NS(n,X2(e)),offset:NS(n,oj(e)),velocity:aj(e,.1)}}function oj(n){return n[0]}function X2(n){return n[n.length-1]}function aj(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=X2(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>Bs(e)));)t--;if(!i)return{x:0,y:0};const s=Gs(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const Y2=1e-4,lj=1-Y2,cj=1+Y2,Z2=.01,uj=0-Z2,hj=0+Z2;function Ri(n){return n.max-n.min}function dj(n,e,t){return Math.abs(n-e)<=t}function DS(n,e,t,i=.5){n.origin=i,n.originPoint=Nt(e.min,e.max,n.origin),n.scale=Ri(t)/Ri(e),n.translate=Nt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=lj&&n.scale<=cj||isNaN(n.scale))&&(n.scale=1),(n.translate>=uj&&n.translate<=hj||isNaN(n.translate))&&(n.translate=0)}function td(n,e,t,i){DS(n.x,e.x,t.x,i?i.originX:void 0),DS(n.y,e.y,t.y,i?i.originY:void 0)}function MS(n,e,t){n.min=t.min+e.min,n.max=n.min+Ri(e)}function fj(n,e,t){MS(n.x,e.x,t.x),MS(n.y,e.y,t.y)}function LS(n,e,t){n.min=e.min-t.min,n.max=n.min+Ri(e)}function nd(n,e,t){LS(n.x,e.x,t.x),LS(n.y,e.y,t.y)}function gj(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?Nt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?Nt(t,n,i.max):Math.min(n,t)),n}function OS(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function pj(n,{top:e,left:t,bottom:i,right:r}){return{x:OS(n.x,t,r),y:OS(n.y,e,i)}}function jS(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function mj(n,e){return{x:jS(n.x,e.x),y:jS(n.y,e.y)}}function yj(n,e){let t=.5;const i=Ri(n),r=Ri(e);return r>i?t=iu(e.min,e.max-i,n.min):i>r&&(t=iu(n.min,n.max-r,e.min)),qs(0,1,t)}function _j(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const vv=.35;function vj(n=vv){return n===!1?n=0:n===!0&&(n=vv),{x:FS(n,"left","right"),y:FS(n,"top","bottom")}}function FS(n,e,t){return{min:VS(n,e),max:VS(n,t)}}function VS(n,e){return typeof n=="number"?n:n[e]||0}const zS=()=>({translate:0,scale:1,origin:0,originPoint:0}),Bc=()=>({x:zS(),y:zS()}),US=()=>({min:0,max:0}),Ut=()=>({x:US(),y:US()});function Hi(n){return[n("x"),n("y")]}function Q2({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function xj({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function wj(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function c_(n){return n===void 0||n===1}function xv({scale:n,scaleX:e,scaleY:t}){return!c_(n)||!c_(e)||!c_(t)}function Va(n){return xv(n)||J2(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function J2(n){return BS(n.x)||BS(n.y)}function BS(n){return n&&n!=="0%"}function Op(n,e,t){const i=n-t,r=e*i;return t+r}function GS(n,e,t,i,r){return r!==void 0&&(n=Op(n,r,i)),Op(n,t,i)+e}function wv(n,e=0,t=1,i,r){n.min=GS(n.min,e,t,i,r),n.max=GS(n.max,e,t,i,r)}function eA(n,{x:e,y:t}){wv(n.x,e.translate,e.scale,e.originPoint),wv(n.y,t.translate,t.scale,t.originPoint)}const WS=.999999999999,$S=1.0000000000001;function Ej(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Wc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,eA(n,o)),i&&Va(s.latestValues)&&Wc(n,s.latestValues))}e.x<$S&&e.x>WS&&(e.x=1),e.y<$S&&e.y>WS&&(e.y=1)}function Gc(n,e){n.min=n.min+e,n.max=n.max+e}function HS(n,e,t,i,r=.5){const s=Nt(n.min,n.max,r);wv(n,e,t,s,i)}function Wc(n,e){HS(n.x,e.x,e.scaleX,e.scale,e.originX),HS(n.y,e.y,e.scaleY,e.scale,e.originY)}function tA(n,e){return Q2(wj(n.getBoundingClientRect(),e))}function Tj(n,e,t){const i=tA(n,t),{scroll:r}=e;return r&&(Gc(i.x,r.offset.x),Gc(i.y,r.offset.y)),i}const nA=({current:n})=>n?n.ownerDocument.defaultView:null,Sj=new WeakMap;class Ij{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(nf(f).point)},s=(f,p)=>{const{drag:_,dragPropagation:x,onDragStart:S}=this.getProps();if(_&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=yO(_),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Hi(T=>{let b=this.getAxisMotionValue(T).get()||0;if(rs.test(b)){const{projection:k}=this.visualElement;if(k&&k.layout){const A=k.layout.layoutBox[T];A&&(b=Ri(A)*(parseFloat(b)/100))}}this.originPoint[T]=b}),S&&Tt.postRender(()=>S(f,p)),hv(this.visualElement,"transform");const{animationState:C}=this.visualElement;C&&C.setActive("whileDrag",!0)},o=(f,p)=>{const{dragPropagation:_,dragDirectionLock:x,onDirectionLock:S,onDrag:C}=this.getProps();if(!_&&!this.openDragLock)return;const{offset:T}=p;if(x&&this.currentDirection===null){this.currentDirection=Cj(T),this.currentDirection!==null&&S&&S(this.currentDirection);return}this.updateAxis("x",p.point,T),this.updateAxis("y",p.point,T),this.visualElement.render(),C&&C(f,p)},l=(f,p)=>this.stop(f,p),u=()=>Hi(f=>{var p;return this.getAnimationState(f)==="paused"&&((p=this.getAxisMotionValue(f).animation)===null||p===void 0?void 0:p.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new q2(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:nA(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Tt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!jg(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=gj(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&zc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=pj(r.layoutBox,t):this.constraints=!1,this.elastic=vj(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Hi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=_j(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!zc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=Tj(i,r.root,this.visualElement.getTransformPagePoint());let o=mj(r.layout.layoutBox,s);if(t){const l=t(xj(o));this.hasMutatedConstraints=!!l,l&&(o=Q2(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=Hi(f=>{if(!jg(f,t,this.currentDirection))return;let p=u&&u[f]||{};o&&(p={min:0,max:0});const _=r?200:1e6,x=r?40:1e7,S={type:"inertia",velocity:i?e[f]:0,bounceStiffness:_,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...s,...p};return this.startAxisValueAnimation(f,S)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return hv(this.visualElement,e),i.start(u1(e,i,0,t,this.visualElement,!1))}stopAnimation(){Hi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Hi(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Hi(t=>{const{drag:i}=this.getProps();if(!jg(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-Nt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!zc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Hi(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();r[o]=yj({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Hi(o=>{if(!jg(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(Nt(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;Sj.set(this.visualElement,this);const e=this.visualElement.current,t=ed(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();zc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Tt.read(i);const o=wd(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(Hi(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=u[f].translate,p.set(p.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=vv,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function jg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function Cj(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class Rj extends aa{constructor(e){super(e),this.removeGroupControls=Ci,this.removeListeners=Ci,this.controls=new Ij(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ci}unmount(){this.removeGroupControls(),this.removeListeners()}}const KS=n=>(e,t)=>{n&&Tt.postRender(()=>n(e,t))};class bj extends aa{constructor(){super(...arguments),this.removePointerDownListener=Ci}onPointerDown(e){this.session=new q2(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:nA(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:KS(e),onStart:KS(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Tt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=ed(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const dp={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function qS(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const bh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(De.test(n))n=parseFloat(n);else return n;const t=qS(n,e.target.x),i=qS(n,e.target.y);return`${t}% ${i}%`}},Aj={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=ta.parse(n);if(r.length>5)return i;const s=ta.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=u;const h=Nt(l,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class Pj extends K.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;YL(kj),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),dp.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Tt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Vx.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function iA(n){const[e,t]=Vb(),i=K.useContext(kx);return y.jsx(Pj,{...n,layoutGroup:i,switchLayoutGroup:K.useContext(Kb),isPresent:e,safeToRemove:t})}const kj={borderRadius:{...bh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:bh,borderTopRightRadius:bh,borderBottomLeftRadius:bh,borderBottomRightRadius:bh,boxShadow:Aj};function Nj(n,e,t){const i=jn(n)?n:vd(n);return i.start(u1("",i,e,t)),i.animation}function Dj(n){return n instanceof SVGElement&&n.tagName!=="svg"}const Mj=(n,e)=>n.depth-e.depth;class Lj{constructor(){this.children=[],this.isDirty=!1}add(e){Jx(this.children,e),this.isDirty=!0}remove(e){e1(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Mj),this.isDirty=!1,this.children.forEach(e)}}function Oj(n,e){const t=ss.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(ea(i),n(s-e))};return Tt.read(i,!0),()=>ea(i)}const rA=["TopLeft","TopRight","BottomLeft","BottomRight"],jj=rA.length,XS=n=>typeof n=="string"?parseFloat(n):n,YS=n=>typeof n=="number"||De.test(n);function Fj(n,e,t,i,r,s){r?(n.opacity=Nt(0,t.opacity!==void 0?t.opacity:1,Vj(i)),n.opacityExit=Nt(e.opacity!==void 0?e.opacity:1,0,zj(i))):s&&(n.opacity=Nt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<jj;o++){const l=`border${rA[o]}Radius`;let u=ZS(e,l),h=ZS(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||YS(u)===YS(h)?(n[l]=Math.max(Nt(XS(u),XS(h),i),0),(rs.test(h)||rs.test(u))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=Nt(e.rotate||0,t.rotate||0,i))}function ZS(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Vj=sA(0,.5,T2),zj=sA(.5,.95,Ci);function sA(n,e,t){return i=>i<n?0:i>e?1:t(iu(n,e,i))}function QS(n,e){n.min=e.min,n.max=e.max}function Wi(n,e){QS(n.x,e.x),QS(n.y,e.y)}function JS(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function eI(n,e,t,i,r){return n-=e,n=Op(n,1/t,i),r!==void 0&&(n=Op(n,1/r,i)),n}function Uj(n,e=0,t=1,i=.5,r,s=n,o=n){if(rs.test(e)&&(e=parseFloat(e),e=Nt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=Nt(s.min,s.max,i);n===s&&(l-=e),n.min=eI(n.min,e,t,l,r),n.max=eI(n.max,e,t,l,r)}function tI(n,e,[t,i,r],s,o){Uj(n,e[t],e[i],e[r],e.scale,s,o)}const Bj=["x","scaleX","originX"],Gj=["y","scaleY","originY"];function nI(n,e,t,i){tI(n.x,e,Bj,t?t.x:void 0,i?i.x:void 0),tI(n.y,e,Gj,t?t.y:void 0,i?i.y:void 0)}function iI(n){return n.translate===0&&n.scale===1}function oA(n){return iI(n.x)&&iI(n.y)}function rI(n,e){return n.min===e.min&&n.max===e.max}function Wj(n,e){return rI(n.x,e.x)&&rI(n.y,e.y)}function sI(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function aA(n,e){return sI(n.x,e.x)&&sI(n.y,e.y)}function oI(n){return Ri(n.x)/Ri(n.y)}function aI(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class $j{constructor(){this.members=[]}add(e){Jx(this.members,e),e.scheduleRender()}remove(e){if(e1(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Hj(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:p,rotateY:_,skewX:x,skewY:S}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),p&&(i+=`rotateX(${p}deg) `),_&&(i+=`rotateY(${_}deg) `),x&&(i+=`skewX(${x}deg) `),S&&(i+=`skewY(${S}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(i+=`scale(${l}, ${u})`),i||"none"}const za={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Gh=typeof window<"u"&&window.MotionDebug!==void 0,u_=["","X","Y","Z"],Kj={visibility:"hidden"},lI=1e3;let qj=0;function h_(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function lA(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=m2(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Tt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&lA(i)}function cA({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=qj++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Gh&&(za.totalNodes=za.resolvedTargetDeltas=za.recalculatedProjection=0),this.nodes.forEach(Zj),this.nodes.forEach(nF),this.nodes.forEach(iF),this.nodes.forEach(Qj),Gh&&window.MotionDebug.record(za)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new Lj)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new t1),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Dj(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||u)&&(this.isLayoutDirty=!0),n){let p;const _=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=Oj(_,250),dp.hasAnimatedSinceResize&&(dp.hasAnimatedSinceResize=!1,this.nodes.forEach(uI))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:_,hasRelativeTargetChanged:x,layout:S})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const C=this.options.transition||f.getDefaultTransition()||lF,{onLayoutAnimationStart:T,onLayoutAnimationComplete:b}=f.getProps(),k=!this.targetLayout||!aA(this.targetLayout,S)||x,A=!_&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||A||_&&(k||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,A);const L={...Xx(C,"layout"),onPlay:T,onComplete:b};(f.shouldReduceMotion||this.options.layoutRoot)&&(L.delay=0,L.type=!1),this.startAnimation(L)}else _||uI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=S})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ea(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(rF),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&lA(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(cI);return}this.isUpdating||this.nodes.forEach(eF),this.isUpdating=!1,this.nodes.forEach(tF),this.nodes.forEach(Xj),this.nodes.forEach(Yj),this.clearAllSnapshots();const l=ss.now();xn.delta=qs(0,1e3/60,l-xn.timestamp),xn.timestamp=l,xn.isProcessing=!0,t_.update.process(xn),t_.preRender.process(xn),t_.render.process(xn),xn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Vx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Jj),this.sharedNodes.forEach(sF)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Tt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Tt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!oA(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||Va(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),cF(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(uF))){const{scroll:f}=this.root;f&&(Gc(u.x,f.offset.x),Gc(u.y,f.offset.y))}return u}removeElementScroll(o){var l;const u=Ut();if(Wi(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:p,options:_}=f;f!==this.root&&p&&_.layoutScroll&&(p.wasRoot&&Wi(u,o),Gc(u.x,p.offset.x),Gc(u.y,p.offset.y))}return u}applyTransform(o,l=!1){const u=Ut();Wi(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Wc(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Va(f.latestValues)&&Wc(u,f.latestValues)}return Va(this.latestValues)&&Wc(u,this.latestValues),u}removeTransform(o){const l=Ut();Wi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Va(h.latestValues))continue;xv(h.latestValues)&&h.updateSnapshot();const f=Ut(),p=h.measurePageBox();Wi(f,p),nI(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return Va(this.latestValues)&&nI(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==xn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:_}=this.options;if(!(!this.layout||!(p||_))){if(this.resolvedRelativeTargetAt=xn.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),nd(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),Wi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),fj(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Wi(this.target,this.layout.layoutBox),eA(this.target,this.targetDelta)):Wi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),nd(this.relativeTargetOrigin,this.target,x.target),Wi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Gh&&za.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||xv(this.parent.latestValues)||J2(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===xn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;Wi(this.layoutCorrected,this.layout.layoutBox);const _=this.treeScale.x,x=this.treeScale.y;Ej(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:S}=l;if(!S){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(JS(this.prevProjectionDelta.x,this.projectionDelta.x),JS(this.prevProjectionDelta.y,this.projectionDelta.y)),td(this.projectionDelta,this.layoutCorrected,S,this.latestValues),(this.treeScale.x!==_||this.treeScale.y!==x||!aI(this.projectionDelta.x,this.prevProjectionDelta.x)||!aI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",S)),Gh&&za.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Bc(),this.projectionDelta=Bc(),this.projectionDeltaWithTransform=Bc()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},p=Bc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const _=Ut(),x=u?u.source:void 0,S=this.layout?this.layout.source:void 0,C=x!==S,T=this.getStack(),b=!T||T.members.length<=1,k=!!(C&&!b&&this.options.crossfade===!0&&!this.path.some(aF));this.animationProgress=0;let A;this.mixTargetDelta=L=>{const O=L/1e3;hI(p.x,o.x,O),hI(p.y,o.y,O),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(nd(_,this.layout.layoutBox,this.relativeParent.layout.layoutBox),oF(this.relativeTarget,this.relativeTargetOrigin,_,O),A&&Wj(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=Ut()),Wi(A,this.relativeTarget)),C&&(this.animationValues=f,Fj(f,h,this.latestValues,O,k,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=O},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ea(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Tt.update(()=>{dp.hasAnimatedSinceResize=!0,this.currentAnimation=Nj(0,lI,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(lI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:f}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&uA(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Ut();const p=Ri(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const _=Ri(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+_}Wi(l,u),Wc(l,f),td(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new $j),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&h_("z",o,h,this.animationValues);for(let f=0;f<u_.length;f++)h_(`rotate${u_[f]}`,o,h,this.animationValues),h_(`skew${u_[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Kj;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=up(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const C={};return this.options.layoutId&&(C.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,C.pointerEvents=up(o?.pointerEvents)||""),this.hasProjected&&!Va(this.latestValues)&&(C.transform=f?f({},""):"none",this.hasProjected=!1),C}const _=p.animationValues||p.latestValues;this.applyTransformsToTarget(),h.transform=Hj(this.projectionDeltaWithTransform,this.treeScale,_),f&&(h.transform=f(_,h.transform));const{x,y:S}=this.projectionDelta;h.transformOrigin=`${x.origin*100}% ${S.origin*100}% 0`,p.animationValues?h.opacity=p===this?(u=(l=_.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:_.opacityExit:h.opacity=p===this?_.opacity!==void 0?_.opacity:"":_.opacityExit!==void 0?_.opacityExit:0;for(const C in kp){if(_[C]===void 0)continue;const{correct:T,applyTo:b}=kp[C],k=h.transform==="none"?_[C]:T(_[C],p);if(b){const A=b.length;for(let L=0;L<A;L++)h[b[L]]=k}else h[C]=k}return this.options.layoutId&&(h.pointerEvents=p===this?up(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(cI),this.root.sharedNodes.clear()}}}function Xj(n){n.updateLayout()}function Yj(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?Hi(p=>{const _=o?t.measuredBox[p]:t.layoutBox[p],x=Ri(_);_.min=i[p].min,_.max=_.min+x}):uA(s,t.layoutBox,i)&&Hi(p=>{const _=o?t.measuredBox[p]:t.layoutBox[p],x=Ri(i[p]);_.max=_.min+x,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[p].max=n.relativeTarget[p].min+x)});const l=Bc();td(l,i,t.layoutBox);const u=Bc();o?td(u,n.applyTransform(r,!0),t.measuredBox):td(u,i,t.layoutBox);const h=!oA(l);let f=!1;if(!n.resumeFrom){const p=n.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:_,layout:x}=p;if(_&&x){const S=Ut();nd(S,t.layoutBox,_.layoutBox);const C=Ut();nd(C,i,x.layoutBox),aA(S,C)||(f=!0),p.options.layoutRoot&&(n.relativeTarget=C,n.relativeTargetOrigin=S,n.relativeParent=p)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function Zj(n){Gh&&za.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function Qj(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function Jj(n){n.clearSnapshot()}function cI(n){n.clearMeasurements()}function eF(n){n.isLayoutDirty=!1}function tF(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function uI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function nF(n){n.resolveTargetDelta()}function iF(n){n.calcProjection()}function rF(n){n.resetSkewAndRotation()}function sF(n){n.removeLeadSnapshot()}function hI(n,e,t){n.translate=Nt(e.translate,0,t),n.scale=Nt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function dI(n,e,t,i){n.min=Nt(e.min,t.min,i),n.max=Nt(e.max,t.max,i)}function oF(n,e,t,i){dI(n.x,e.x,t.x,i),dI(n.y,e.y,t.y,i)}function aF(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const lF={duration:.45,ease:[.4,0,.1,1]},fI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),gI=fI("applewebkit/")&&!fI("chrome/")?Math.round:Ci;function pI(n){n.min=gI(n.min),n.max=gI(n.max)}function cF(n){pI(n.x),pI(n.y)}function uA(n,e,t){return n==="position"||n==="preserve-aspect"&&!dj(oI(e),oI(t),.2)}function uF(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const hF=cA({attachResizeListener:(n,e)=>wd(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),d_={current:void 0},hA=cA({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!d_.current){const n=new hF({});n.mount(window),n.setOptions({layoutScroll:!0}),d_.current=n}return d_.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),dF={pan:{Feature:bj},drag:{Feature:Rj,ProjectionNode:hA,MeasureLayout:iA}};function mI(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Tt.postRender(()=>s(e,nf(e)))}class fF extends aa{mount(){const{current:e}=this.node;e&&(this.unmount=dO(e,t=>(mI(this.node,t,"Start"),i=>mI(this.node,i,"End"))))}unmount(){}}class gF extends aa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=tf(wd(this.node.current,"focus",()=>this.onFocus()),wd(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function yI(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Tt.postRender(()=>s(e,nf(e)))}class pF extends aa{mount(){const{current:e}=this.node;e&&(this.unmount=mO(e,t=>(yI(this.node,t,"Start"),(i,{success:r})=>yI(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Ev=new WeakMap,f_=new WeakMap,mF=n=>{const e=Ev.get(n.target);e&&e(n)},yF=n=>{n.forEach(mF)};function _F({root:n,...e}){const t=n||document;f_.has(t)||f_.set(t,{});const i=f_.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(yF,{root:n,...e})),i[r]}function vF(n,e,t){const i=_F(e);return Ev.set(n,t),i.observe(n),()=>{Ev.delete(n),i.unobserve(n)}}const xF={some:0,all:1};class wF extends aa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:xF[r]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),_=h?f:p;_&&_(u)};return vF(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(EF(e,t))&&this.startObserver()}unmount(){}}function EF({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const TF={inView:{Feature:wF},tap:{Feature:pF},focus:{Feature:gF},hover:{Feature:fF}},SF={layout:{ProjectionNode:hA,MeasureLayout:iA}},Tv={current:null},dA={current:!1};function IF(){if(dA.current=!0,!!Mx)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Tv.current=n.matches;n.addListener(e),e()}else Tv.current=!1}const CF=[...j2,Dn,ta],RF=n=>CF.find(O2(n)),_I=new WeakMap;function bF(n,e,t){for(const i in e){const r=e[i],s=t[i];if(jn(r))n.addValue(i,r);else if(jn(s))n.addValue(i,vd(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,vd(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const vI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class AF{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=a1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=ss.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,Tt.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=km(t),this.isVariantNode=$b(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,..._}=this.scrapeMotionValuesFromProps(t,{},this);for(const x in _){const S=_[x];u[x]!==void 0&&jn(S)&&S.set(u[x],!1)}}mount(e){this.current=e,_I.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),dA.current||IF(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Tv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){_I.delete(this.current),this.projection&&this.projection.unmount(),ea(this.notifyUpdate),ea(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Al.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Tt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in ru){const t=ru[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<vI.length;i++){const r=vI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=bF(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=vd(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(M2(r)||I2(r))?r=parseFloat(r):!RF(r)&&ta.test(t)&&(r=k2(e,t)),this.setBaseTarget(e,jn(r)?r.get():r)),jn(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=Ux(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!jn(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new t1),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class fA extends AF{constructor(){super(...arguments),this.KeyframeResolver=F2}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;jn(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function PF(n){return window.getComputedStyle(n)}class kF extends fA{constructor(){super(...arguments),this.type="html",this.renderInstance=e2}readValueFromInstance(e,t){if(Al.has(t)){const i=o1(t);return i&&i.default||0}else{const i=PF(e),r=(Zb(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return tA(e,t)}build(e,t,i){Wx(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return qx(e,t,i)}}class NF extends fA{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Al.has(t)){const i=o1(t);return i&&i.default||0}return t=t2.has(t)?t:Fx(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return r2(e,t,i)}build(e,t,i){$x(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){n2(e,t,i,r)}mount(e){this.isSVGTag=Kx(e.tagName),super.mount(e)}}const DF=(n,e)=>zx(n)?new NF(e):new kF(e,{allowProjection:n!==K.Fragment}),MF=sO({...ij,...TF,...dF,...SF},DF),Ue=xL(MF),ni={ADD:"add",REMOVE:"remove"},ou={PROPERTYCHANGE:"propertychange"},Be={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Mm{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function LF(n,e,t){let i,r;t=t||Ws;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function Ws(n,e){return n>e?1:n<e?-1:0}function OF(n,e){return n<e?1:n>e?-1:0}function h1(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function jF(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function d1(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function la(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function FF(n,e,t){const i=e||Ws;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Ed(){return!0}function Lm(){return!1}function Td(){}function gA(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!la(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function pA(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function rf(n){for(const e in n)delete n[e]}function au(n){let e;for(e in n)return!1;return!e}class eo{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class sf extends Mm{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new eo(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let u;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,Td);delete o[i]}return u}disposeInternal(){this.listeners_&&rf(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=Td,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function nt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function jp(n,e,t,i){return nt(n,e,t,i,!0)}function bt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),rf(n))}class of extends sf{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Be.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=nt(this,e[s],t);return r}return nt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=jp(this,e[s],t)}else i=jp(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)VF(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}of.prototype.on;of.prototype.once;of.prototype.un;function VF(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)bt(n[e]);else bt(n)}function tt(){throw new Error("Unimplemented abstract method.")}let zF=0;function it(n){return n.ol_uid||(n.ol_uid=String(++zF))}class xI extends eo{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class hs extends of{constructor(e){super(),this.on,this.once,this.un,it(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new xI(i,e,t)),i=ou.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new xI(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],au(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const wI={LENGTH:"length"};class Fg extends eo{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Xi extends hs{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(wI.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Fg(ni.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Fg(ni.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Fg(ni.REMOVE,r,e)),this.dispatchEvent(new Fg(ni.ADD,t,e))}updateLength_(){this.set(wI.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function lt(n,e){if(!n)throw new Error(e)}class lu extends hs{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new lu(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(bt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=nt(e,Be.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?UF(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function UF(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(lt(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const ln={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function EI(n){const e=er();for(let t=0,i=n.length;t<i;++t)id(e,n[t]);return e}function f1(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function mA(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function yA(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function cu(n,e){return _A(n,e[0],e[1])}function Wh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function _A(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function Sv(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let u=ln.UNKNOWN;return o<t?u=u|ln.LEFT:o>r&&(u=u|ln.RIGHT),l<i?u=u|ln.BELOW:l>s&&(u=u|ln.ABOVE),u===ln.UNKNOWN&&(u=ln.INTERSECTING),u}function er(){return[1/0,1/0,-1/0,-1/0]}function na(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Om(n){return na(1/0,1/0,-1/0,-1/0,n)}function vA(n,e){const t=n[0],i=n[1];return na(t,i,t,i,e)}function g1(n,e,t,i,r){const s=Om(r);return xA(s,n,e,t,i)}function Sd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function BF(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function id(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function xA(n,e,t,i,r){for(;t<i;t+=r)GF(n,e[t],e[t+1]);return n}function GF(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function wA(n,e){let t;return t=e(jm(n)),t||(t=e(Fm(n)),t)||(t=e(Vm(n)),t)||(t=e(Pl(n)),t)?t:!1}function Iv(n){let e=0;return zm(n)||(e=ft(n)*Wn(n)),e}function jm(n){return[n[0],n[1]]}function Fm(n){return[n[2],n[1]]}function gl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function WF(n,e){let t;if(e==="bottom-left")t=jm(n);else if(e==="bottom-right")t=Fm(n);else if(e==="top-left")t=Pl(n);else if(e==="top-right")t=Vm(n);else throw new Error("Invalid corner");return t}function Cv(n,e,t,i,r){const[s,o,l,u,h,f,p,_]=EA(n,e,t,i);return na(Math.min(s,l,h,p),Math.min(o,u,f,_),Math.max(s,l,h,p),Math.max(o,u,f,_),r)}function EA(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),u=r*o,h=r*l,f=s*o,p=s*l,_=n[0],x=n[1];return[_-u+p,x-h-f,_-u-p,x-h+f,_+u-p,x+h+f,_+u+p,x+h-f,_-u+p,x-h-f]}function Wn(n){return n[3]-n[1]}function ol(n,e,t){const i=t||er();return oi(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Om(i),i}function Pl(n){return[n[0],n[3]]}function Vm(n){return[n[2],n[3]]}function ft(n){return n[2]-n[0]}function oi(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function zm(n){return n[2]<n[0]||n[3]<n[1]}function $F(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function HF(n,e,t){let i=!1;const r=Sv(n,e),s=Sv(n,t);if(r===ln.INTERSECTING||s===ln.INTERSECTING)i=!0;else{const o=n[0],l=n[1],u=n[2],h=n[3],f=e[0],p=e[1],_=t[0],x=t[1],S=(x-p)/(_-f);let C,T;s&ln.ABOVE&&!(r&ln.ABOVE)&&(C=_-(x-h)/S,i=C>=o&&C<=u),!i&&s&ln.RIGHT&&!(r&ln.RIGHT)&&(T=x-(_-u)*S,i=T>=l&&T<=h),!i&&s&ln.BELOW&&!(r&ln.BELOW)&&(C=_-(x-l)/S,i=C>=o&&C<=u),!i&&s&ln.LEFT&&!(r&ln.LEFT)&&(T=x-(_-o)*S,i=T>=l&&T<=h)}return i}function TA(n,e){const t=e.getExtent(),i=gl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=ft(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function SA(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];TA(n,e);const r=ft(i);if(ft(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Dt(n,e,t){return Math.min(Math.max(n,e),t)}function KF(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const u=((n-t)*o+(e-i)*l)/(o*o+l*l);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=l*u)}return Xc(n,e,t,i)}function Xc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function qF(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const u=Math.abs(n[l][i]);u>s&&(s=u,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const u=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function TI(n){return n*180/Math.PI}function Xo(n){return n*Math.PI/180}function al(n,e){const t=n%e;return t*e<0?t+e:t}function Ti(n,e,t){return n+t*(e-n)}function af(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function Oq(n,e){return Math.round(af(n,e))}function Vg(n,e){return Math.floor(af(n,e))}function zg(n,e){return Math.ceil(af(n,e))}function Rv(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function XF(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Fp(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function p1(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function YF(n,e){return n[0]*=e,n[1]*=e,n}function IA(n,e){if(e.canWrapX()){const t=ft(e.getExtent()),i=ZF(n,e,t);i&&(n[0]-=i*t)}return n}function ZF(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||ft(i),r=Math.floor((n[0]-i[0])/t)),r}function CA(...n){console.warn(...n)}const uu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class m1{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||uu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const lf=6378137,$c=Math.PI*lf,QF=[-$c,-$c,$c,$c],JF=[-180,-85,180,85],Ug=lf*Math.log(Math.tan(Math.PI/2));class _c extends m1{constructor(e){super({code:e,units:"m",extent:QF,global:!0,worldExtent:JF,getPointResolution:function(t,i){return t/Math.cosh(i[1]/lf)}})}}const SI=[new _c("EPSG:3857"),new _c("EPSG:102100"),new _c("EPSG:102113"),new _c("EPSG:900913"),new _c("http://www.opengis.net/def/crs/EPSG/0/3857"),new _c("http://www.opengis.net/gml/srs/epsg.xml#3857")];function eV(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=$c*n[s]/180;let o=lf*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Ug?o=Ug:o<-Ug&&(o=-Ug),e[s+1]=o}return e}function tV(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/$c,e[s+1]=360*Math.atan(Math.exp(n[s+1]/lf))/Math.PI-90;return e}const nV=6378137,II=[-180,-90,180,90],iV=Math.PI*nV/180;class Oa extends m1{constructor(e,t){super({code:e,units:"degrees",extent:II,axisOrientation:t,global:!0,metersPerUnit:iV,worldExtent:II})}}const CI=[new Oa("CRS:84"),new Oa("EPSG:4326","neu"),new Oa("urn:ogc:def:crs:OGC:1.3:CRS84"),new Oa("urn:ogc:def:crs:OGC:2:84"),new Oa("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Oa("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Oa("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let bv={};function rV(n){return bv[n]||bv[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function sV(n,e){bv[n]=e}let Yc={};function Id(n,e,t){const i=n.getCode(),r=e.getCode();i in Yc||(Yc[i]={}),Yc[i][r]=t}function g_(n,e){return n in Yc&&e in Yc[n]?Yc[n][e]:null}const Vp=.9996,Qi=.00669438,Um=Qi*Qi,Bm=Um*Qi,Qa=Qi/(1-Qi),RI=Math.sqrt(1-Qi),hu=(1-RI)/(1+RI),RA=hu*hu,y1=RA*hu,_1=y1*hu,bA=_1*hu,AA=1-Qi/4-3*Um/64-5*Bm/256,oV=3*Qi/8+3*Um/32+45*Bm/1024,aV=15*Um/256+45*Bm/1024,lV=35*Bm/3072,cV=3/2*hu-27/32*y1+269/512*bA,uV=21/16*RA-55/32*_1,hV=151/96*y1-417/128*bA,dV=1097/512*_1,zp=6378137;function fV(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/Vp/(zp*AA),l=o+cV*Math.sin(2*o)+uV*Math.sin(4*o)+hV*Math.sin(6*o)+dV*Math.sin(8*o),u=Math.sin(l),h=u*u,f=Math.cos(l),p=u/f,_=p*p,x=_*_,S=1-Qi*h,C=Math.sqrt(1-Qi*h),T=zp/C,b=(1-Qi)/S,k=Qa*f**2,A=k*k,L=i/(T*Vp),O=L*L,B=O*L,M=B*L,I=M*L,N=I*L,F=l-p/b*(O/2-M/24*(5+3*_+10*k-4*A-9*Qa))+N/720*(61+90*_+298*k+45*x-252*Qa-3*A);let V=(L-B/6*(1+2*_+k)+I/120*(5-2*k+28*_-3*A+8*Qa+24*x))/f;return V=Rv(V+Xo(PA(t.number)),-Math.PI,Math.PI),[TI(V),TI(F)]}const bI=-80,AI=84,gV=-180,pV=180;function mV(n,e,t){n=Rv(n,gV,pV),e<bI?e=bI:e>AI&&(e=AI);const i=Xo(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,u=l*l,h=Xo(n),f=PA(t.number),p=Xo(f),_=zp/Math.sqrt(1-Qi*r**2),x=Qa*s**2,S=s*Rv(h-p,-Math.PI,Math.PI),C=S*S,T=C*S,b=T*S,k=b*S,A=k*S,L=zp*(AA*i-oV*Math.sin(2*i)+aV*Math.sin(4*i)-lV*Math.sin(6*i)),O=Vp*_*(S+T/6*(1-l+x)+k/120*(5-18*l+u+72*x-58*Qa))+5e5;let B=Vp*(L+_*o*(C/2+b/24*(5-l+9*x+4*x**2)+A/720*(61-58*l+u+600*x-330*Qa)));return t.north||(B+=1e7),[O,B]}function PA(n){return(n-1)*6-180+3}const yV=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function kA(n){let e=0;for(const r of yV){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function PI(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const u=t[l],h=t[l+1],f=n(u,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function _V(n){return kA(n)?new m1({code:n,units:"m"}):null}function vV(n){const e=kA(n.getCode());return e?{forward:PI(mV,e),inverse:PI(fV,e)}:null}const xV=63710088e-1;function kI(n,e,t){t=t||xV;const i=Xo(n[1]),r=Xo(e[1]),s=(r-i)/2,o=Xo(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const wV=[vV],EV=[_V];let Av=!0;function NA(n){Av=!1}function v1(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function Pv(n){sV(n.getCode(),n),Id(n,n,v1)}function TV(n){n.forEach(Pv)}function ci(n){if(typeof n!="string")return n;const e=rV(n);if(e)return e;for(const t of EV){const i=t(n);if(i)return i}return null}function Up(n,e,t,i){n=ci(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/uu[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=w1(n,ci("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=kI(h.slice(0,2),h.slice(2,4)),p=kI(h.slice(4,6),h.slice(6,8));r=(f+p)/2}const u=i?uu[i]:n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function NI(n){TV(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Id(e,t,v1)})})}function SV(n,e,t,i){n.forEach(function(r){e.forEach(function(s){Id(r,s,t),Id(s,r,i)})})}function x1(n,e){return n?typeof n=="string"?ci(n):n:ci(e)}function IV(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),u=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=u?e[o+h]:l[h]}return t})}function pl(n,e){return NA(),Gm(n,"EPSG:4326","EPSG:3857")}function kv(n,e){const t=Gm(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=al(i+180,360)-180),t}function fp(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||w1(n,e)===v1)&&t}function w1(n,e){const t=n.getCode(),i=e.getCode();let r=g_(t,i);if(r)return r;let s=null,o=null;for(const u of wV)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=p_(s.inverse,o.forward);else{const u=g_(t,l);u&&(r=p_(u,o.forward))}else{const u=g_(l,i);u&&(r=p_(s.inverse,u))}return r&&(Pv(n),Pv(e),Id(n,e,r)),r}function p_(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Bp(n,e){const t=ci(n),i=ci(e);return w1(t,i)}function Gm(n,e,t){const i=Bp(e,t);if(!i){const r=ci(e).getCode(),s=ci(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Nv(n,e){return n}function Ls(n,e){return Av&&!Fp(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Av=!1,CA("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function DA(n,e){return n}function $o(n,e){return n}function CV(){NI(SI),NI(CI),SV(CI,SI,eV,tV)}CV();new Array(6);function Tr(){return[1,0,0,1,0,0]}function RV(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function un(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Xs(n,e,t,i,r,s,o,l){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-l*i*u+e,n[5]=o*r*u+l*r*h+t,n}function MA(n,e){const t=bV(e);lt(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*l)/t,n[5]=-(i*u-r*l)/t,n}function bV(n){return n[0]*n[3]-n[1]*n[2]}const AV=[1e5,1e5,1e5,1e5,2,2];function PV(n){return"matrix("+n.join(", ")+")"}function Dv(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function kV(n,e){const t=Dv(n),i=Dv(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*AV[r])!==0)return!1;return!0}function Yo(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let u=e;u<t;u+=i){const h=n[u],f=n[u+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let p=2;p<o;p++)s[l++]=n[u+p]}return s&&s.length!=l&&(s.length=l),s}function LA(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),u=Math.sin(r),h=s[0],f=s[1];let p=0;for(let _=e;_<t;_+=i){const x=n[_]-h,S=n[_+1]-f;o[p++]=h+x*l-S*u,o[p++]=f+x*u+S*l;for(let C=_+2;C<_+i;++C)o[p++]=n[C]}return o&&o.length!=p&&(o.length=p),o}function NV(n,e,t,i,r,s,o,l){l=l||[];const u=o[0],h=o[1];let f=0;for(let p=e;p<t;p+=i){const _=n[p]-u,x=n[p+1]-h;l[f++]=u+r*_,l[f++]=h+s*x;for(let S=p+2;S<p+i;++S)l[f++]=n[S]}return l&&l.length!=f&&(l.length=f),l}function DV(n,e,t,i,r,s,o){o=o||[];let l=0;for(let u=e;u<t;u+=i){o[l++]=n[u]+r,o[l++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const DI=Tr(),MV=[NaN,NaN];class LV extends hs{constructor(){super(),this.extent_=er(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=gA((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return tt()}closestPointXY(e,t,i,r){return tt()}containsXY(e,t){return this.closestPointXY(e,t,MV,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return tt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Om(t),this.extentRevision_=this.getRevision()}return $F(this.extent_,e)}rotate(e,t){tt()}scale(e,t,i){tt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return tt()}getType(){return tt()}applyTransform(e){tt()}intersectsExtent(e){return tt()}translate(e,t){tt()}transform(e,t){const i=ci(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const u=i.getExtent(),h=i.getWorldExtent(),f=Wn(h)/Wn(u);Xs(DI,h[0],h[3],f,-f,0,0,0);const p=Yo(s,0,s.length,l,DI,o),_=Bp(i,t);return _?_(p,p,l):p}:Bp(i,t);return this.applyTransform(r),this}}class E1 extends LV{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return g1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return tt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=MI(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){tt()}setLayout(e,t,i){let r;if(e)r=MI(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=OV(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();LA(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=gl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();NV(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();DV(i,0,i.length,r,e,t,i),this.changed()}}}function OV(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function MI(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function jV(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Yo(i,0,i.length,r,e,t)}function LI(n,e,t,i,r,s,o){const l=n[e],u=n[e+1],h=n[t]-l,f=n[t+1]-u;let p;if(h===0&&f===0)p=e;else{const _=((r-l)*h+(s-u)*f)/(h*h+f*f);if(_>1)p=t;else if(_>0){for(let x=0;x<i;++x)o[x]=Ti(n[e+x],n[t+x],_);o.length=i;return}else p=e}for(let _=0;_<i;++_)o[_]=n[p+_];o.length=i}function OA(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],u=n[e+1],h=Xc(s,o,l,u);h>r&&(r=h),s=l,o=u}return r}function jA(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=OA(n,e,l,i,r),e=l}return r}function jq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=jA(n,e,l,i,r),e=l[l.length-1]}return r}function FA(n,e,t,i,r,s,o,l,u,h,f){if(e==t)return h;let p,_;if(r===0){if(_=Xc(o,l,n[e],n[e+1]),_<h){for(p=0;p<i;++p)u[p]=n[e+p];return u.length=i,_}return h}f=f||[NaN,NaN];let x=e+i;for(;x<t;)if(LI(n,x-i,x,i,o,l,f),_=Xc(o,l,f[0],f[1]),_<h){for(h=_,p=0;p<i;++p)u[p]=f[p];u.length=i,x+=i}else x+=i*Math.max((Math.sqrt(_)-Math.sqrt(h))/r|0,1);if(s&&(LI(n,t-i,e,i,o,l,f),_=Xc(o,l,f[0],f[1]),_<h)){for(h=_,p=0;p<i;++p)u[p]=f[p];u.length=i}return h}function VA(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,_=t.length;p<_;++p){const x=t[p];h=FA(n,e,x,i,r,s,o,l,u,h,f),e=x}return h}function Fq(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,_=t.length;p<_;++p){const x=t[p];h=VA(n,e,x,i,r,s,o,l,u,h,f),e=x[x.length-1]}return h}function FV(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function zA(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function UA(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=zA(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function Vq(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=UA(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function Hc(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Gp(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=Hc(n,e,u,i,r[s]),e=u}return r.length=s,r}function OI(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:Gp(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function jI(n,e,t,i,r,s,o){let l,u;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,u=r;else if(h!==0){let f=n[e],p=n[e+1],_=0;const x=[0];for(let T=e+i;T<t;T+=i){const b=n[T],k=n[T+1];_+=Math.sqrt((b-f)*(b-f)+(k-p)*(k-p)),x.push(_),f=b,p=k}const S=r*_,C=LF(x,S);C<0?(u=(S-x[-C-2])/(x[-C-1]-x[-C-2]),l=e+(-C-2)*i):l=e+C*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:u===void 0?n[l+f]:Ti(n[l+f],n[l+i+f],u);return s}function FI(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,u=t/i;for(;l<u;){const _=l+u>>1;r<n[(_+1)*i-1]?u=_:l=_+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],p=(r-h)/(f-h);o=[];for(let _=0;_<i-1;++_)o.push(Ti(n[(l-1)*i+_],n[l*i+_],p));return o.push(r),o}function zq(n,e,t,i,r,s,o){if(o)return FI(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let u=0,h=t.length;u<h;++u){const f=t[u];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return FI(n,e,f,i,r,!1);e=f}}return null}function VV(n,e,t,i,r){return!wA(r,function(o){return!Ja(n,e,t,i,o[0],o[1])})}function Ja(n,e,t,i,r,s){let o=0,l=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];u<=s?f>s&&(h-l)*(s-u)-(r-l)*(f-u)>0&&o++:f<=s&&(h-l)*(s-u)-(r-l)*(f-u)<0&&o--,l=h,u=f}return o!==0}function T1(n,e,t,i,r,s){if(t.length===0||!Ja(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(Ja(n,t[o-1],t[o],i,r,s))return!1;return!0}function Uq(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const u=t[o];if(T1(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function zV(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function S1(n,e,t,i,r,s){return s=s??xA(er(),n,e,t,i),oi(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:zV(n,e,t,i,function(o,l){return HF(r,o,l)}):!1}function Bq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(S1(n,e,t[s],i,r))return!0;e=t[s]}return!1}function BA(n,e,t,i,r){return!!(S1(n,e,t,i,r)||Ja(n,e,t,i,r[0],r[1])||Ja(n,e,t,i,r[0],r[3])||Ja(n,e,t,i,r[2],r[1])||Ja(n,e,t,i,r[2],r[3]))}function GA(n,e,t,i,r){if(!BA(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(VV(n,t[s-1],t[s],i,r)&&!S1(n,t[s-1],t[s],i,r))return!1;return!0}function Gq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(GA(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function UV(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const u=n[l],h=n[l+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function I1(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(l);u[0]=1,u[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const p=h.pop(),_=h.pop();let x=0;const S=n[_],C=n[_+1],T=n[p],b=n[p+1];for(let k=_+i;k<p;k+=i){const A=n[k],L=n[k+1],O=KF(A,L,S,C,T,b);O>x&&(f=k,x=O)}x>r&&(u[(f-e)/i]=1,_+i<f&&h.push(_,f),f+i<p&&h.push(f,p))}for(let p=0;p<l;++p)u[p]&&(s[o++]=n[e+p*i],s[o++]=n[e+p*i+1]);return o}function BV(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=I1(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Ua(n,e){return e*Math.round(n/e)}function GV(n,e,t,i,r,s,o){if(e==t)return o;let l=Ua(n[e],r),u=Ua(n[e+1],r);e+=i,s[o++]=l,s[o++]=u;let h,f;do if(h=Ua(n[e],r),f=Ua(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==u);for(;e<t;){const p=Ua(n[e],r),_=Ua(n[e+1],r);if(e+=i,p==h&&_==f)continue;const x=h-l,S=f-u,C=p-l,T=_-u;if(x*T==S*C&&(x<0&&C<x||x==C||x>0&&C>x)&&(S<0&&T<S||S==T||S>0&&T>S)){h=p,f=_;continue}s[o++]=h,s[o++]=f,l=h,u=f,h=p,f=_}return s[o++]=h,s[o++]=f,o}function C1(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=GV(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Wq(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u],p=[];o=C1(n,e,f,i,r,s,o,p),l.push(p),e=f[f.length-1]}return o}class ml extends E1{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new ml(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Xc(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let u=0;u<l;++u)i[u]=s[u];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return vA(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return _A(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=FV(this.flatCoordinates,0,e,this.stride),this.changed()}}const Yi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},yl=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",WV=yl.includes("safari")&&!yl.includes("chrom");WV&&(yl.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(yl));const $V=yl.includes("webkit")&&!yl.includes("edge"),WA=yl.includes("macintosh"),HV=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ii=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,R1=typeof Image<"u"&&Image.prototype.decode,$A=typeof createImageBitmap=="function",HA=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Ve={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Jt(n,e,t,i){let r;return t&&t.length?r=t.shift():Ii?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let m_;function Wp(){return m_||(m_=Jt(1,1)),m_}function Wm(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function VI(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function KV(n){for(;n.lastChild;)n.lastChild.remove()}function qV(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function KA(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Ho(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const b1=[NaN,NaN,NaN,0];let y_;function XV(){return y_||(y_=Jt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),y_}const YV=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,ZV=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,QV=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,JV=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Bg(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function rd(n){throw new Error('failed to parse "'+n+'" as color')}function qA(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(ZV)||n.match(YV)||n.match(QV);if(s){const o=s[4],l=100/255;return[Dt(Bg(s[1],l)+.5|0,0,255),Dt(Bg(s[2],l)+.5|0,0,255),Dt(Bg(s[3],l)+.5|0,0,255),o!==void 0?Dt(Bg(o,100),0,1):1]}rd(n)}if(n.startsWith("#")){if(JV.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let f=parseInt(s.substring(u,u+o),16);o===1&&(f+=f<<4),l[u/o]=f}return l[3]=l[3]/255,l}rd(n)}const e=XV();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&rd(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return qA(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=af(r[3]/255,3),r}function e4(n){return typeof n=="string"?n:P1(n)}const t4=1024,Ah={};let __=0;function n4(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function v_(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function x_(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function w_(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function E_(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function zI(n){const e=w_(n[0]),t=w_(n[1]),i=w_(n[2]),r=E_(e*.222488403+t*.716873169+i*.06060791),s=500*(E_(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-E_(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function i4(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=x_(e),s=x_(e+t/500*Math.cos(i)),o=x_(e-t/200*Math.sin(i)),l=v_(s*3.021973625-r*1.617392459-o*.404875592),u=v_(s*-.943766287+r*1.916279586+o*.027607165),h=v_(s*.069407491-r*.22898585+o*1.159737864);return[Dt(l+.5|0,0,255),Dt(u+.5|0,0,255),Dt(h+.5|0,0,255),n[3]]}function A1(n){if(n==="none")return b1;if(Ah.hasOwnProperty(n))return Ah[n];if(__>=t4){let t=0;for(const i in Ah)(t++&3)===0&&(delete Ah[i],--__)}const e=qA(n);e.length!==4&&rd(n);for(const t of e)isNaN(t)&&rd(n);return Ah[n]=e,++__,e}function du(n){return Array.isArray(n)?n:A1(n)}function P1(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}class $q extends sf{constructor(e,t,i,r){super(),this.extent=e,this.pixelRatio_=i,this.resolution=t,this.state=typeof r=="function"?Ve.IDLE:r,this.image_=null,this.loader=typeof r=="function"?r:null}changed(){this.dispatchEvent(Be.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Ve.IDLE&&this.loader){this.state=Ve.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;pA(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||$A&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=Ve.LOADED}).catch(i=>{this.state=Ve.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function r4(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[jp(i,Be.LOAD,function(){o=!0,s||e()})];return i.src&&R1?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):l.push(jp(i,Be.ERROR,t)),function(){r=!1,l.forEach(bt)}}function s4(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function XA(n,e){return e&&(n.src=e),n.src&&R1?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):s4(n)}function Hq(n,e){return e&&(n.src=e),n.src&&R1&&$A?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):XA(n)}class o4{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=T_(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=T_(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=T_(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Ve.IDLE&&r.load(),r.getImageState()===Ve.LOADING?r.ready().then(()=>{this.patternCache_[o]=Wp().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Wp().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function T_(n,e,t){const i=t?du(t):"null";return e+":"+n+":"+i}const Zi=new o4;let Ph=null;class YA extends sf{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Ve.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Ve.LOADED){Ph||(Ph=Jt(1,1,void 0,{willReadFrequently:!0})),Ph.drawImage(this.image_,0,0);try{Ph.getImageData(0,0,1,1),this.tainted_=!1}catch{Ph=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Be.CHANGE)}handleImageError_(){this.imageState_=Ve.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Ve.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Jt(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Ve.IDLE){this.image_||this.initializeImage_(),this.imageState_=Ve.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&XA(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Ve.LOADED)return;const t=this.image_,i=Jt(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=e4(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Ve.LOADED||this.imageState_===Ve.ERROR)e();else{const t=()=>{(this.imageState_===Ve.LOADED||this.imageState_===Ve.ERROR)&&(this.removeEventListener(Be.CHANGE,t),e())};this.addEventListener(Be.CHANGE,t)}})),this.ready_}}function $p(n,e,t,i,r,s){let o=e===void 0?void 0:Zi.get(e,t,r);return o||(o=new YA(n,n&&"src"in n?n.src||void 0:e,t,i,r),Zi.set(e,t,r,o,s)),s&&o&&!Zi.getPattern(e,t,r)&&Zi.set(e,t,r,o,s),o}function es(n){return n?Array.isArray(n)?P1(n):typeof n=="object"&&"src"in n?a4(n):n:null}function a4(n){if(!n.offset||!n.size)return Zi.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Zi.getPattern(e,void 0,n.color);if(t)return t;const i=Zi.get(n.src,"anonymous",null);if(i.getImageState()!==Ve.LOADED)return null;const r=Jt(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),$p(r.canvas,e,void 0,Ve.LOADED,n.color,!0),Zi.getPattern(e,void 0,n.color)}class ZA{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Gg="ol-hidden",cf="ol-unselectable",k1="ol-control",UI="ol-collapsed",l4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),BI=["style","variant","weight","size","lineHeight","family"],Mv={normal:400,bold:700},Lv=function(n){const e=n.match(l4);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=BI.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[BI[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in Mv&&(t.weight=Mv[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},QA="10px sans-serif",ii="#000",fu="round",$s=[],Hs=0,gu="round",Cd=10,Rd="#000",bd="center",Hp="middle",el=[0,0,0,0],Ad=1,Nc=new hs;let kh=null,GI;const Ov={},c4=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function u4(n,e,t){return`${n} ${e} 16px "${t}"`}const h4=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=Lv(s),u=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const p=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),_=Mv[f.weight]||f.weight;return p===u&&f.style===l.style&&_==h})}async function r(){await t.ready;let s=!0;const o=Nc.getProperties(),l=Object.keys(o).filter(u=>o[u]<100);for(let u=l.length-1;u>=0;--u){const h=l[u];let f=o[h];f<100&&(await i(h)?(rf(Ov),Nc.set(h,100)):(f+=10,Nc.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Ii?self.fonts:document.fonts);const o=Lv(s);if(!o)return;const l=o.families;let u=!1;for(const h of l){if(c4.has(h))continue;const f=u4(o.style,o.weight,h);Nc.get(f)===void 0&&(Nc.set(f,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),d4=(function(){let n;return function(e){let t=Ov[e];if(t==null){if(Ii){const i=Lv(e),r=JA(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);Ov[e]=t}return t}})();function JA(n,e){return kh||(kh=Jt(1,1)),n!=GI&&(kh.font=n,GI=kh.font),kh.measureText(e)}function eP(n,e){return JA(n,e).width}function WI(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,eP(n,s)),0);return t[e]=i,i}function f4(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,u=0;for(let h=0,f=e.length;h<=f;h+=2){const p=e[h];if(p===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=u,u=0;continue}const _=e[h+1]||n.font,x=eP(_,p);t.push(x),o+=x;const S=d4(_);i.push(S),u=Math.max(u,S)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function g4(n,e,t,i,r,s,o,l,u,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=p=>p.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(f[0],f[1]),p4(i,n)):f[0]<0||f[1]<0?(n.translate(u,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,u,h,o*f[0],l*f[1]),n.restore()}function p4(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class m4 extends ZA{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?af(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Tr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Yo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,p=s.length;f<p;f+=2){const _=s[f]-this.imageAnchorX_,x=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const S=_+this.imageAnchorX_,C=x+this.imageAnchorY_;Xs(l,S,C,1,1,h,-S,-C),o.save(),o.transform.apply(o,l),o.translate(S,C),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,_,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Yo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=Yo(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let u=l.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oi(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=jV(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oi(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(oi(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oi(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!oi(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,u=s.length;l<u;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),la(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:bd;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:es(i||ii)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),f=s||$s;this.strokeState_={lineCap:r!==void 0?r:fu,lineDash:this.pixelRatio_===1?f:f.map(p=>p*this.pixelRatio_),lineDashOffset:(o||Hs)*this.pixelRatio_,lineJoin:l!==void 0?l:gu,lineWidth:(u!==void 0?u:Ad)*this.pixelRatio_,miterLimit:h!==void 0?h:Cd,strokeStyle:es(i||Rd)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const x=t.getColor();this.textFillState_={fillStyle:es(x||ii)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const x=i.getColor(),S=i.getLineCap(),C=i.getLineDash(),T=i.getLineDashOffset(),b=i.getLineJoin(),k=i.getWidth(),A=i.getMiterLimit();this.textStrokeState_={lineCap:S!==void 0?S:fu,lineDash:C||$s,lineDashOffset:T||Hs,lineJoin:b!==void 0?b:gu,lineWidth:k!==void 0?k:Ad,miterLimit:A!==void 0?A:Cd,strokeStyle:es(x||Rd)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),f=e.getText(),p=e.getTextAlign(),_=e.getTextBaseline();this.textState_={font:r!==void 0?r:QA,textAlign:p!==void 0?p:bd,textBaseline:_!==void 0?_:Hp},this.text_=f!==void 0?Array.isArray(f)?f.reduce((x,S,C)=>x+=C%2?" ":S,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const y4=.5,tP={Point:I4,LineString:E4,Polygon:R4,MultiPoint:C4,MultiLineString:T4,MultiPolygon:S4,GeometryCollection:w4,Circle:v4};function _4(n,e){return parseInt(it(n),10)-parseInt(it(e),10)}function $I(n,e){const t=nP(n,e);return t*t}function nP(n,e){return y4*n/e}function v4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}function HI(n,e,t,i,r,s,o,l){const u=[],h=t.getImage();if(h){let _=!0;const x=h.getImageState();x==Ve.LOADED||x==Ve.ERROR?_=!1:x==Ve.IDLE&&h.load(),_&&u.push(h.ready())}const f=t.getFill();f&&f.loading()&&u.push(f.ready());const p=u.length>0;return p&&Promise.all(u).then(()=>r(null)),x4(n,e,t,i,s,o,l),p}function x4(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const u=l.simplifyTransformed(i,r);if(t.getRenderer())iP(n,u,t,e,o);else{const f=tP[u.getType()];f(n,u,t,e,o,s)}}function iP(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,u=o.length;l<u;++l)iP(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function w4(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,u;for(l=0,u=o.length;l<u;++l){const h=tP[o[l].getType()];h(n,o[l],t,i,r,s)}}function E4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function T4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function S4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}function I4(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=Ve.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function C4(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=Ve.LOADED)return;const p=n.getBuilder(t.getZIndex(),"Image");p.setImageStyle(o,f),p.drawMultiPoint(e,i,r)}if(h){const p=n.getBuilder(t.getZIndex(),"Text");p.setTextStyle(u,f),p.drawText(e,i,r)}}function R4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}let b4=!1;function A4(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=b4,l.onload=function(u){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function KI(n,e){return function(t,i,r,s,o){A4(n,e,t,i,r,(l,u)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function P4(n,e){return[[-1/0,-1/0,1/0,1/0]]}function k4(n,e,t,i){const r=[];let s=er();for(let o=0,l=t.length;o<l;++o){const u=t[o];s=g1(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function N1(n,e,t,i,r,s,o){let l,u,h,f,p,_,x;const S=r[s+1],C=[];for(let k=0,A=t.length;k<A;++k){const L=t[k];for(f=n[L-i],_=n[L-i+1],l=e;l<L;l+=i)p=n[l],x=n[l+1],(S<=_&&x<=S||_<=S&&S<=x)&&(h=(S-_)/(x-_)*(p-f)+f,C.push(h)),f=p,_=x}let T=NaN,b=-1/0;for(C.sort(Ws),f=C[0],l=1,u=C.length;l<u;++l){p=C[l];const k=Math.abs(p-f);k>b&&(h=(f+p)/2,T1(n,e,t,i,h,S)&&(T=h,b=k)),f=p}return isNaN(T)&&(T=r[s]),o?(o.push(T,S,b),o):[T,S,b]}function N4(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const u=t[o];s=N1(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function D4(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function D1(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],u=n[e+1];r+=(l-s)*(u+o),s=l,o=u}return r===0?void 0:r>0}function rP(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=D1(n,e,l,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function Kq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!rP(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function jv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=D1(n,e,l,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&D4(n,e,l,i),e=l}return e}function qq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=jv(n,e,t[s],i,r);return e}function M4(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const u=e[o],h=D1(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function sP(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,u=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=u*h-l*f,l=h,u=f}return r/2}function oP(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=sP(n,e,l,i),e=l}return r}function Xq(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=oP(n,e,l,i),e=l[l.length-1]}return r}class Pd extends E1{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Pd(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<yA(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(OA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),FA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return sP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Hc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=I1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Pd(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=zA(this.flatCoordinates,0,e,this.stride),this.changed()}}class kd extends E1{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?d1(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new kd(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<yA(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),VA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return T1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return oP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),jv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Gp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=gl(this.getExtent());this.flatInteriorPoint_=N1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new ml(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Pd(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const u=i[o],h=new Pd(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;rP(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=jv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=C1(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new kd(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return GA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=UA(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function qI(n){if(zm(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new kd(s,"XY",[s.length])}const XI=Tr();class pr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?vA(this.flatCoordinates_):g1(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=gl(this.getExtent());this.flatInteriorPoints_=N1(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=M4(this.flatCoordinates_,this.ends_),t=k4(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=N4(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=jI(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=jI(e,t,o,2,.5);d1(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ci(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Wn(i)/Wn(t);Xs(XI,i[0],i[3],r,-r,0,0,0),Yo(this.flatCoordinates_,0,this.flatCoordinates_.length,2,XI,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new pr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=gA((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=I1(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=BV(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=C1(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new pr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}pr.prototype.getFlatCoordinates=pr.prototype.getOrientedFlatCoordinates;function aP(n,e,t=0,i=n.length-1,r=L4){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,f=Math.log(u),p=.5*Math.exp(2*f/3),_=.5*Math.sqrt(f*p*(u-p)/u)*(h-u/2<0?-1:1),x=Math.max(t,Math.floor(e-h*p/u+_)),S=Math.min(i,Math.floor(e+(u-h)*p/u+_));aP(n,e,x,S,r)}const s=n[e];let o=t,l=i;for(Nh(n,t,e),r(n[i],s)>0&&Nh(n,t,i);o<l;){for(Nh(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?Nh(n,t,l):(l++,Nh(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function Nh(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function L4(n,e){return n<e?-1:n>e?1:0}let lP=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!$g(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],u=t.leaf?r(l):l;$g(e,u)&&(t.leaf?i.push(l):I_(e,u)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!$g(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if($g(e,o)){if(t.leaf||I_(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Dc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=O4(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&I_(i,r)?(s.push(i),o.push(l),l=0,u=i,i=i.children[0]):u?(l++,i=u.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=Dc(e.slice(t,i+1)),vc(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=Dc([]),l.leaf=!1,l.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));YI(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const p=Math.min(f+h-1,i);YI(e,f,p,u,this.compareMinY);for(let _=f;_<=p;_+=u){const x=Math.min(_+u-1,p);l.children.push(this._build(e,_,x,r-1))}}return vc(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let u=0;u<t.children.length;u++){const h=t.children[u],f=S_(h),p=V4(e,h)-f;p<o?(o=p,s=f<s?f:s,l=h):p===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Hh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=Dc(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,vc(i,this.toBBox),vc(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=Dc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,vc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const u=$h(e,0,l,this.toBBox),h=$h(e,l,i,this.toBBox),f=z4(u,h),p=S_(u)+S_(h);f<s?(s=f,r=l,o=p<o?p:o):f===s&&p<o&&(o=p,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:j4,s=e.leaf?this.compareMinY:F4,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=$h(e,0,t,s),l=$h(e,i-t,i,s);let u=Wg(o)+Wg(l);for(let h=t;h<i-t;h++){const f=e.children[h];Hh(o,e.leaf?s(f):f),u+=Wg(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];Hh(l,e.leaf?s(f):f),u+=Wg(l)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Hh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():vc(e[t],this.toBBox)}};function O4(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function vc(n,e){$h(n,0,n.children.length,e,n)}function $h(n,e,t,i,r){r||(r=Dc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Hh(r,n.leaf?i(o):o)}return r}function Hh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function j4(n,e){return n.minX-e.minX}function F4(n,e){return n.minY-e.minY}function S_(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Wg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function V4(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function z4(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function I_(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function $g(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Dc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function YI(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;aP(n,o,e,t,r),s.push(e,o,o,t)}}class ZI{constructor(e){this.rbush_=new lP(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[it(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=u,this.items_[it(l)]=u}this.rbush_.load(i)}remove(e){const t=it(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[it(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Sd(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return au(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return na(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class cP extends hs{constructor(e){super(),this.projection=ci(e.projection),this.attributions_=QI(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=QI(e),this.changed()}setState(e){this.state_=e,this.changed()}}function QI(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const $i={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Ro extends eo{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class M1 extends cP{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Td,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(lt(this.format_,"`format` must be set when `url` is set"),this.loader_=KI(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:P4;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new ZI:null,this.loadedExtentsRtree_=new ZI,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Xi(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=it(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Ro($i.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof pr||(this.featureChangeKeys_[e]=[nt(t,Be.CHANGE,this.handleFeatureChange_,this),nt(t,ou.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof pr){const s=this.idIndex_[r];s instanceof pr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(lt(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],u=it(l);this.addToIndex_(u,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],u=it(l);this.setupChangeEvents_(u,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener($i.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Ro($i.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener($i.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener($i.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(ni.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(ni.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(bt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Ro($i.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof pr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof pr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),au(this.nullGeometryFeatures_)||d1(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=SA(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||Ed,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const f=h.getGeometry(),p=l;if(l=f instanceof pr?0:f.closestPointXY(i,r,o,l),l<p){s=h;const _=Math.sqrt(l);u[0]=i-_,u[1]=r-_,u[2]=i+_,u[3]=r+_}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=it(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new Ro($i.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:it(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&au(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const u=s[o];r.forEachInExtent(u,function(f){return Wh(f.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Ro($i.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ro($i.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ro($i.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Sd(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=it(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(bt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener($i.REMOVEFEATURE)&&this.dispatchEvent(new Ro($i.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){lt(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(KI(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Cr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Cr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=$p(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Ve.IDLE&&t.load(),t.getImageState()===Ve.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?it(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:du(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Mu{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Mu({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function JI(n){return n[0]>0&&n[1]>0}function U4(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function li(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class $m{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=li(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new $m({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return tt()}getImage(e){return tt()}getHitDetectionImage(){return tt()}getPixelRatio(e){return 1}getImageState(){return tt()}getImageSize(){return tt()}getOrigin(){return tt()}getSize(){return tt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=li(e)}listenImageChange(e){tt()}load(){tt()}unlistenImageChange(e){tt()}ready(){return Promise.resolve()}}class Hm extends $m{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Ve.LOADING:Ve.LOADED,this.imageState_===Ve.LOADING&&this.ready().then(()=>this.imageState_=Ve.LOADED),this.render()}clone(){const e=this.getScale(),t=new Hm({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Zi.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=Jt(o,o);this.draw_(s,l,e),r=l.canvas,Zi.set(i,null,null,new YA(r,void 0,null,Ve.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const B=r;r=s,s=B}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,u=s*Math.sin(l),h=Math.sqrt(s*s-u*u),f=r-h,p=Math.sqrt(u*u+f*f),_=p/u;if(e==="miter"&&_<=i)return _*t;const x=t/2/_,S=t/2*(f/p),T=Math.sqrt((r+x)*(r+x)+S*S)-r;if(this.radius2_===void 0||e==="bevel")return T*2;const b=r*Math.sin(l),k=Math.sqrt(r*r-b*b),A=s-k,O=Math.sqrt(b*b+A*A)/b;if(O<=i){const B=O*t/2-s-r;return 2*Math.max(T,B)}return T*2}createRenderOptions(){let e=fu,t=gu,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=es(this.stroke_.getColor()??Rd),l=this.stroke_.getWidth()??Ad,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??gu,e=this.stroke_.getLineCap()??fu,i=this.stroke_.getMiterLimit()??Cd);const u=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ii),t.fillStyle=es(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=du(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Jt(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const u=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ii,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class kl extends Hm{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new kl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Ji{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=eC,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Ji({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=eC,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function B4(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(lt(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let C_=null;function uP(n,e){if(!C_){const t=new Cr({color:"rgba(255,255,255,0.4)"}),i=new Mu({color:"#3399CC",width:1.25});C_=[new Ji({image:new kl({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return C_}function eC(n){return n.getGeometry()}const G4="#333";class uf{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=li(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Cr({color:G4}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new uf({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Cr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=li(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Mn={ANIMATING:0,INTERACTING:1},be={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Hg=[be.FILL],Ko=[be.STROKE],tl=[be.BEGIN_PATH],tC=[be.CLOSE_PATH];class hf extends ZA{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,u=e.length;l<u;l+=t)r[0]=e[l],r[1]=e[l+1],cu(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let u=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],p=e[t+1];const _=this.tmpCoordinate_;let x=!0,S,C,T;for(S=t+r;S<i;S+=r)_[0]=e[S],_[1]=e[S+1],T=Sv(h,_),T!==C?(x&&(l[u++]=f,l[u++]=p,x=!1),l[u++]=_[0],l[u++]=_[1]):T===ln.INTERSECTING?(l[u++]=_[0],l[u++]=_[1],x=!1):x=!0,f=_[0],p=_[1],C=T;return(s&&x||S===t+r)&&(l[u++]=f,l[u++]=p),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),u=this.coordinates.length;let h,f,p,_,x;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),_=[];const S=e.getEndss();x=0;for(let C=0,T=S.length;C<T;++C){const b=[];x=this.drawCustomCoordinates_(h,x,S[C],l,b),_.push(b)}this.instructions.push([be.CUSTOM,u,_,e,i,OI,s]),this.hitDetectionInstructions.push([be.CUSTOM,u,_,e,r||i,OI,s]);break;case"Polygon":case"MultiLineString":p=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),x=this.drawCustomCoordinates_(h,0,e.getEnds(),l,p),this.instructions.push([be.CUSTOM,u,p,e,i,Gp,s]),this.hitDetectionInstructions.push([be.CUSTOM,u,p,e,r||i,Gp,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([be.CUSTOM,u,f,e,i,Hc,s]),this.hitDetectionInstructions.push([be.CUSTOM,u,f,e,r||i,Hc,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>u&&(this.instructions.push([be.CUSTOM,u,f,e,i,Hc,s]),this.hitDetectionInstructions.push([be.CUSTOM,u,f,e,r||i,Hc,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([be.CUSTOM,u,f,e,i,void 0,s]),this.hitDetectionInstructions.push([be.CUSTOM,u,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[be.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[be.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==be.END_GEOMETRY?o=t:s==be.BEGIN_GEOMETRY&&(r[2]=t,jF(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=es(i||ii)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=es(i||Rd);const r=e.getLineCap();t.lineCap=r!==void 0?r:fu;const s=e.getLineDash();t.lineDash=s?s.slice():$s;const o=e.getLineDashOffset();t.lineDashOffset=o||Hs;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:gu;const u=e.getWidth();t.lineWidth=u!==void 0?u:Ad;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Cd,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[be.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[be.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!la(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[be.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=mA(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;f1(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class W4 extends hf{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!cu(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([be.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([be.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||cu(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([be.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([be.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class $4 extends hf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[be.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,$s,Hs],tl);const l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push(Ko),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,$s,Hs],tl);const l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,_=l.length;p<_;++p)f=this.drawFlatCoordinates_(u,f,l[p],h);this.hitDetectionInstructions.push(Ko),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Ko),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Ko),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(tl)}}class nC extends hf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,u=i.length;this.instructions.push(tl),this.hitDetectionInstructions.push(tl);for(let h=0;h<u;++h){const f=i[h],p=this.coordinates.length,_=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),x=[be.MOVE_TO_LINE_TO,p,_];this.instructions.push(x),this.hitDetectionInstructions.push(x),l&&(this.instructions.push(tC),this.hitDetectionInstructions.push(tC)),t=f}return o&&(this.instructions.push(Hg),this.hitDetectionInstructions.push(Hg)),l&&(this.instructions.push(Ko),this.hitDetectionInstructions.push(Ko)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_FILL_STYLE,ii]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,$s,Hs]);const l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);const f=[be.CIRCLE,h];this.instructions.push(tl,f),this.hitDetectionInstructions.push(tl,f),r.fillStyle!==void 0&&(this.instructions.push(Hg),this.hitDetectionInstructions.push(Hg)),r.strokeStyle!==void 0&&(this.instructions.push(Ko),this.hitDetectionInstructions.push(Ko)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_FILL_STYLE,ii]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,$s,Hs]);const l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_FILL_STYLE,ii]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,$s,Hs]);const l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,_=l.length;p<_;++p)f=this.drawFlatCoordinatess_(u,f,l[p],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Ua(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function H4(n,e,t,i,r){const s=[];let o=t,l=0,u=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=u.slice(-2),p=e[o+r],_=e[o+r+1],x=Math.sqrt((p-h)*(p-h)+(_-f)*(_-f));if(l+=x,l>=n){const S=(n-l+x)/x,C=Ti(h,p,S),T=Ti(f,_,S);u.push(C,T),s.push(u),u=[C,T],l==n&&(o+=r),l=0}else if(l<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const S=x-l,C=Ti(h,p,S/x),T=Ti(f,_,S/x);u.push(C,T),s.push(u),u=[C,T],l=0,o+=r}}return l>0&&s.push(u),s}function K4(n,e,t,i,r){let s=t,o=t,l=0,u=0,h=t,f,p,_,x,S,C,T,b,k,A;for(p=t;p<i;p+=r){const L=e[p],O=e[p+1];S!==void 0&&(k=L-S,A=O-C,x=Math.sqrt(k*k+A*A),T!==void 0&&(u+=_,f=Math.acos((T*k+b*A)/(_*x)),f>n&&(u>l&&(l=u,s=h,o=p),u=0,h=p-r)),_=x,T=k,b=A),S=L,C=O}return u+=x,u>l?[h,p]:[s,o]}const Kp={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class q4 extends hf{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ii]={fillStyle:ii},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let u=l.length;const h=e.getType();let f=null,p=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!oi(this.maxExtent,e.getExtent()))return;let _;if(f=e.getFlatCoordinates(),h=="LineString")_=[f.length];else if(h=="MultiLineString")_=e.getEnds();else if(h=="Polygon")_=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const T=e.getEndss();_=[];for(let b=0,k=T.length;b<k;++b)_.push(T[b][0])}this.beginGeometry(e,t,i);const x=o.repeat,S=x?void 0:o.textAlign;let C=0;for(let T=0,b=_.length;T<b;++T){let k;x?k=H4(x*this.resolution,f,C,_[T],p):k=[f.slice(C,_[T])];for(let A=0,L=k.length;A<L;++A){const O=k[A];let B=0,M=O.length;if(S==null){const N=K4(o.maxAngle,O,0,O.length,2);B=N[0],M=N[1]}for(let N=B;N<M;N+=p)l.push(O[N],O[N+1]);const I=l.length;C=_[T],this.drawChars_(u,I),u=I}}this.endGeometry(t)}else{let _=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),p=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||_.push(f[2]/this.resolution),p=3;break;case"MultiPolygon":const L=e.getFlatInteriorPoints();f=[];for(let O=0,B=L.length;O<B;O+=3)o.overflow||_.push(L[O+2]/this.resolution),f.push(L[O],L[O+1]);if(f.length===0)return;p=2;break}const x=this.appendFlatPointCoordinates(f,p);if(x===u)return;if(_&&(x-u)/2!==f.length/p){let L=u/2;_=_.filter((O,B)=>{const M=l[(L+B)*2]===f[B*p]&&l[(L+B)*2+1]===f[B*p+1];return M||--L,M})}this.saveTextStates_();const S=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,C=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let T=o.padding;if(T!=el&&(o.scale[0]<0||o.scale[1]<0)){let L=o.padding[0],O=o.padding[1],B=o.padding[2],M=o.padding[3];o.scale[0]<0&&(O=-O,M=-M),o.scale[1]<0&&(L=-L,B=-B),T=[L,O,B,M]}const b=this.pixelRatio;this.instructions.push([be.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,T==el?el:T.map(function(L){return L*b}),S,C,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]);const k=1/b,A=S?S.slice(0):null;A&&(A[1]=ii),this.hitDetectionInstructions.push([be.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[k,k],NaN,this.declutterMode_,this.declutterImageWithText_,T,A,C,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ii:this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||bd,justify:t.justify,textBaseline:t.textBaseline||Hp,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=Kp[r.textBaseline],f=this.textOffsetY_*u,p=this.text_,_=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([be.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,u,f,s,_*u,p,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([be.DRAW_CHARS,e,t,h,r.overflow,l&&ii,r.maxAngle,u,f,s,_*u,p,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=es(o.getColor()||ii)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const C=l.getLineDash(),T=l.getLineDashOffset(),b=l.getWidth(),k=l.getMiterLimit();s.lineCap=l.getLineCap()||fu,s.lineDash=C?C.slice():$s,s.lineDashOffset=T===void 0?Hs:T,s.lineJoin=l.getLineJoin()||gu,s.lineWidth=b===void 0?Ad:b,s.miterLimit=k===void 0?Cd:k,s.strokeStyle=es(l.getColor()||Rd)}i=this.textState_;const u=e.getFont()||QA;h4(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Hp,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||el,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),p=e.getOffsetY(),_=e.getRotateWithView(),x=e.getKeepUpright(),S=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=p===void 0?0:p,this.textRotateWithView_=_===void 0?!1:_,this.textKeepUpright_=x===void 0?!0:x,this.textRotation_=S===void 0?0:S,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:it(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+it(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const X4={Circle:nC,Default:hf,Image:W4,LineString:$4,Polygon:nC,Text:q4};class Y4{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=X4[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function Z4(n,e,t,i,r,s,o,l,u,h,f,p,_=!0){let x=n[e],S=n[e+1],C=0,T=0,b=0,k=0;function A(){C=x,T=S,e+=i,x=n[e],S=n[e+1],k+=b,b=Math.sqrt((x-C)*(x-C)+(S-T)*(S-T))}do A();while(e<t-i&&k+b<s);let L=b===0?0:(s-k)/b;const O=Ti(C,x,L),B=Ti(T,S,L),M=e-i,I=k,N=s+l*u(h,r,f);for(;e<t-i&&k+b<N;)A();L=b===0?0:(N-k)/b;const F=Ti(C,x,L),V=Ti(T,S,L);let U=!1;if(_)if(p){const ue=[O,B,F,V];LA(ue,0,4,2,p,ue,ue),U=ue[0]>ue[2]}else U=O>F;const D=Math.PI,se=[],de=M+i===e;e=M,b=0,k=I,x=n[e],S=n[e+1];let me;if(de){A(),me=Math.atan2(S-T,x-C),U&&(me+=me>0?-D:D);const ue=(F+O)/2,J=(V+B)/2;return se[0]=[ue,J,(N-s)/2,me,r],se}r=r.replace(/\n/g," ");for(let ue=0,J=r.length;ue<J;){A();let Z=Math.atan2(S-T,x-C);if(U&&(Z+=Z>0?-D:D),me!==void 0){let ye=Z-me;if(ye+=ye>D?-2*D:ye<-D?2*D:0,Math.abs(ye)>o)return null}me=Z;const ne=ue;let G=0;for(;ue<J;++ue){const ye=U?J-ue-1:ue,Ie=l*u(h,r[ye],f);if(e+i<t&&k+b<s+G+Ie/2)break;G+=Ie}if(ue===ne)continue;const $=U?r.substring(J-ne,J-ue):r.substring(ne,ue);L=b===0?0:(s+G/2-k)/b;const ie=Ti(C,x,L),fe=Ti(T,S,L);se.push([ie,fe,G/2,Z,$]),s+=G}return se}class hP{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Wp(),{get:(e,t)=>{if(typeof Wp()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const xc=er(),bo=[],Ds=[],Ms=[],Ao=[];function iC(n){return n[3].declutterBox}const rC=new RegExp("[-----]");function R_(n,e){return e==="start"?e=rC.test(n)?"right":"left":e==="end"&&(e=rC.test(n)?"left":"right"),Kp[e]}function Q4(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function J4(n,e,t){return t%2===0&&(n+=e),n}class e3{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Tr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new hP:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,f=[u.scale[0]*h,u.scale[1]*h],p=u.justify?Kp[u.justify]:R_(Array.isArray(e)?e[0]:e,u.textAlign||bd),_=r&&o.lineWidth?o.lineWidth:0,x=Array.isArray(e)?e:String(e).split(`
`).reduce(Q4,[]),{width:S,height:C,widths:T,heights:b,lineWidths:k}=f4(u,x),A=S+_,L=[],O=(A+2)*f[0],B=(C+_)*f[1],M={width:O<0?Math.floor(O):Math.ceil(O),height:B<0?Math.floor(B):Math.ceil(B),contextInstructions:L};(f[0]!=1||f[1]!=1)&&L.push("scale",f),r&&(L.push("strokeStyle",o.strokeStyle),L.push("lineWidth",_),L.push("lineCap",o.lineCap),L.push("lineJoin",o.lineJoin),L.push("miterLimit",o.miterLimit),L.push("setLineDash",[o.lineDash]),L.push("lineDashOffset",o.lineDashOffset)),i&&L.push("fillStyle",l.fillStyle),L.push("textBaseline","middle"),L.push("textAlign","center");const I=.5-p;let N=p*A+I*_;const F=[],V=[];let U=0,D=0,se=0,de=0,me;for(let ue=0,J=x.length;ue<J;ue+=2){const Z=x[ue];if(Z===`
`){D+=U,U=0,N=p*A+I*_,++de;continue}const ne=x[ue+1]||u.font;ne!==me&&(r&&F.push("font",ne),i&&V.push("font",ne),me=ne),U=Math.max(U,b[se]);const G=[Z,N+I*T[se]+p*(T[se]-k[de]),.5*(_+U)+D];N+=T[se],r&&F.push("strokeText",G),i&&V.push("fillText",G),++se}return Array.prototype.push.apply(L,F),Array.prototype.push.apply(L,V),this.labels_[s]=M,M}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,u,h,f,p,_,x,S,C,T){l*=_[0],u*=_[1];let b=i-l,k=r-u;const A=s+h>e?e-h:s,L=o+f>t?t-f:o,O=S[3]+A*_[0]+S[1],B=S[0]+L*_[1]+S[2],M=b-S[3],I=k-S[0];(C||p!==0)&&(bo[0]=M,Ao[0]=M,bo[1]=I,Ds[1]=I,Ds[0]=M+O,Ms[0]=Ds[0],Ms[1]=I+B,Ao[1]=Ms[1]);let N;return p!==0?(N=Xs(Tr(),i,r,1,1,p,-i,-r),un(N,bo),un(N,Ds),un(N,Ms),un(N,Ao),na(Math.min(bo[0],Ds[0],Ms[0],Ao[0]),Math.min(bo[1],Ds[1],Ms[1],Ao[1]),Math.max(bo[0],Ds[0],Ms[0],Ao[0]),Math.max(bo[1],Ds[1],Ms[1],Ao[1]),xc)):na(Math.min(M,M+O),Math.min(I,I+B),Math.max(M,M+O),Math.max(I,I+B),xc),x&&(b=Math.round(b),k=Math.round(k)),{drawImageX:b,drawImageY:k,drawImageW:A,drawImageH:L,originX:h,originY:f,declutterBox:{minX:xc[0],minY:xc[1],maxX:xc[2],maxY:xc[3],value:T},canvasTransform:N,scale:_}}replayImageOrLabel_(e,t,i,r,s,o,l){const u=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(u&&this.replayTextBackground_(e,bo,Ds,Ms,Ao,o,l),g4(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=un(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],u=this.pixelRatio,h=R_(Array.isArray(e)?e[0]:e,s.textAlign||bd),f=Kp[s.textBaseline||Hp],p=l&&l.lineWidth?l.lineWidth:0,_=o.width/u-2*s.scale[0],x=h*_+2*(.5-h)*p,S=f*o.height/u+2*(.5-f)*p;return{label:o,anchorX:x,anchorY:S}}execute_(e,t,i,r,s,o,l,u){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&la(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=Yo(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),RV(this.renderedTransform_,i));let p=0;const _=r.length;let x=0,S,C,T,b,k,A,L,O,B,M,I,N,F,V=0,U=0;const D=this.coordinateCache_,se=this.viewRotation_,de=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,me={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:se},ue=this.instructions!=r||this.overlaps?0:200;let J,Z,ne,G;for(;p<_;){const $=r[p];switch($[0]){case be.BEGIN_GEOMETRY:J=$[1],G=$[3],J.getGeometry()?l!==void 0&&!oi(l,G.getExtent())?p=$[2]+1:++p:p=$[2],h&&(h.zIndex=$[4]);break;case be.BEGIN_PATH:V>ue&&(this.fill_(e),V=0),U>ue&&(e.stroke(),U=0),!V&&!U&&(e.beginPath(),k=NaN,A=NaN),++p;break;case be.CIRCLE:x=$[1];const fe=f[x],ye=f[x+1],Ie=f[x+2],Re=f[x+3],Me=Ie-fe,Ge=Re-ye,ct=Math.sqrt(Me*Me+Ge*Ge);e.moveTo(fe+ct,ye),e.arc(fe,ye,ct,0,2*Math.PI,!0),++p;break;case be.CLOSE_PATH:e.closePath(),++p;break;case be.CUSTOM:x=$[1],S=$[2];const tr=$[3],ps=$[4],Hn=$[5];me.geometry=tr,me.feature=J,p in D||(D[p]=[]);const Kn=D[p];Hn?Hn(f,x,S,2,Kn):(Kn[0]=f[x],Kn[1]=f[x+1],Kn.length=2),h&&(h.zIndex=$[6]),ps(Kn,me),++p;break;case be.DRAW_IMAGE:x=$[1],S=$[2],B=$[3],C=$[4],T=$[5];let hn=$[6];const dn=$[7],qn=$[8],Pi=$[9],_t=$[10];let ut=$[11];const nn=$[12];let ki=$[13];b=$[14]||"declutter";const It=$[15];if(!B&&$.length>=20){M=$[19],I=$[20],N=$[21],F=$[22];const jt=this.drawLabelWithPointPlacement_(M,I,N,F);B=jt.label,$[3]=B;const Mi=$[23];C=(jt.anchorX-Mi)*this.pixelRatio,$[4]=C;const fn=$[24];T=(jt.anchorY-fn)*this.pixelRatio,$[5]=T,hn=B.height,$[6]=hn,ki=B.width,$[13]=ki}let io;$.length>25&&(io=$[25]);let Ni,Ar,nr;$.length>17?(Ni=$[16],Ar=$[17],nr=$[18]):(Ni=el,Ar=null,nr=null),_t&&de?ut+=se:!_t&&!de&&(ut-=se);let Pr=0;for(;x<S;x+=2){if(io&&io[Pr++]<ki/this.pixelRatio)continue;const jt=this.calculateImageOrLabelDimensions_(B.width,B.height,f[x],f[x+1],ki,hn,C,T,qn,Pi,ut,nn,s,Ni,!!Ar||!!nr,J),Mi=[e,t,B,jt,dn,Ar,nr];if(u){let fn,Ft,gn;if(It){const rt=S-x;if(!It[rt]){It[rt]={args:Mi,declutterMode:b};continue}const Gt=It[rt];fn=Gt.args,Ft=Gt.declutterMode,delete It[rt],gn=iC(fn)}let pn,rn;if(fn&&(Ft!=="declutter"||!u.collides(gn))&&(pn=!0),(b!=="declutter"||!u.collides(jt.declutterBox))&&(rn=!0),Ft==="declutter"&&b==="declutter"){const rt=pn&&rn;pn=rt,rn=rt}pn&&(Ft!=="none"&&u.insert(gn),this.replayImageOrLabel_.apply(this,fn)),rn&&(b!=="none"&&u.insert(jt.declutterBox),this.replayImageOrLabel_.apply(this,Mi))}else this.replayImageOrLabel_.apply(this,Mi)}++p;break;case be.DRAW_CHARS:const ua=$[1],kr=$[2],Di=$[3],Ol=$[4];F=$[5];const Nr=$[6],ms=$[7],ro=$[8];N=$[9];const Fn=$[10];M=$[11],Array.isArray(M)&&(M=M.reduce(J4,"")),I=$[12];const ys=[$[13],$[13]];b=$[14]||"declutter";const Dr=$[15],Mr=this.textStates[I],Vn=Mr.font,zn=[Mr.scale[0]*ms,Mr.scale[1]*ms];let gt;Vn in this.widths_?gt=this.widths_[Vn]:(gt={},this.widths_[Vn]=gt);const so=UV(f,ua,kr,2),ir=Math.abs(zn[0])*WI(Vn,M,gt);if(Ol||ir<=so){const jt=this.textStates[I].textAlign,Mi=(so-ir)*R_(M,jt),fn=Z4(f,ua,kr,2,M,Mi,Nr,Math.abs(zn[0]),WI,Vn,gt,de?0:this.viewRotation_,Dr);e:if(fn){const Ft=[];let gn,pn,rn,rt,Gt;if(N)for(gn=0,pn=fn.length;gn<pn;++gn){Gt=fn[gn],rn=Gt[4],rt=this.createLabel(rn,I,"",N),C=Gt[2]+(zn[0]<0?-Fn:Fn),T=Di*rt.height+(.5-Di)*2*Fn*zn[1]/zn[0]-ro;const Xt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Gt[0],Gt[1],rt.width,rt.height,C,T,0,0,Gt[3],ys,!1,el,!1,J);if(u&&b==="declutter"&&u.collides(Xt.declutterBox))break e;Ft.push([e,t,rt,Xt,1,null,null])}if(F)for(gn=0,pn=fn.length;gn<pn;++gn){Gt=fn[gn],rn=Gt[4],rt=this.createLabel(rn,I,F,""),C=Gt[2],T=Di*rt.height-ro;const Xt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Gt[0],Gt[1],rt.width,rt.height,C,T,0,0,Gt[3],ys,!1,el,!1,J);if(u&&b==="declutter"&&u.collides(Xt.declutterBox))break e;Ft.push([e,t,rt,Xt,1,null,null])}u&&b!=="none"&&u.load(Ft.map(iC));for(let Xt=0,Li=Ft.length;Xt<Li;++Xt)this.replayImageOrLabel_.apply(this,Ft[Xt])}}++p;break;case be.END_GEOMETRY:if(o!==void 0){J=$[1];const jt=o(J,G,b);if(jt)return jt}++p;break;case be.FILL:ue?V++:this.fill_(e),++p;break;case be.MOVE_TO_LINE_TO:for(x=$[1],S=$[2],Z=f[x],ne=f[x+1],e.moveTo(Z,ne),k=Z+.5|0,A=ne+.5|0,x+=2;x<S;x+=2)Z=f[x],ne=f[x+1],L=Z+.5|0,O=ne+.5|0,(x==S-2||L!==k||O!==A)&&(e.lineTo(Z,ne),k=L,A=O);++p;break;case be.SET_FILL_STYLE:this.alignAndScaleFill_=$[2],V&&(this.fill_(e),V=0,U&&(e.stroke(),U=0)),e.fillStyle=$[1],++p;break;case be.SET_STROKE_STYLE:U&&(e.stroke(),U=0),this.setStrokeStyle_(e,$),++p;break;case be.STROKE:ue?U++:e.stroke(),++p;break;default:++p;break}}V&&this.fill_(e),U&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Ha=["Polygon","Circle","LineString","Image","Text","Default"],dP=["Image","Text"],t3=Ha.filter(n=>!dP.includes(n));class n3{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Tr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new e3(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,u=Xs(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Jt(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let p;this.renderBuffer_!==void 0&&(p=er(),id(p,e),f1(p,t*(this.renderBuffer_+r),p));const _=i3(r);let x;function S(O,B,M){const I=f.getImageData(0,0,l,l).data;for(let N=0,F=_.length;N<F;N++)if(I[_[N]]>0){if(!o||M==="none"||x!=="Image"&&x!=="Text"||o.includes(O)){const V=(_[N]-3)/4,U=r-V%l,D=r-(V/l|0),se=s(O,B,U*U+D*D);if(se)return se}f.clearRect(0,0,l,l);break}}const C=Object.keys(this.executorsByZIndex_).map(Number);C.sort(Ws);let T,b,k,A,L;for(T=C.length-1;T>=0;--T){const O=C[T].toString();for(k=this.executorsByZIndex_[O],b=Ha.length-1;b>=0;--b)if(x=Ha[b],A=k[x],A!==void 0&&(L=A.executeHitDetection(f,u,i,S,p),L))return L}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return Yo(l,0,8,2,e,l),l}isEmpty(){return au(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(l?OF:Ws),o=o||Ha;const h=Ha.length;for(let f=0,p=u.length;f<p;++f){const _=u[f].toString(),x=this.executorsByZIndex_[_];for(let S=0,C=o.length;S<C;++S){const T=o[S],b=x[T];if(b!==void 0){const k=l===null?void 0:b.getZIndexContext(),A=k?k.getContext():e,L=this.maxExtent_&&T!=="Image"&&T!=="Text";if(L&&(A.save(),this.clip(A,i)),!k||T==="Text"||T==="Image"?b.execute(A,t,i,r,s,l):k.pushFunction(O=>b.execute(O,t,i,r,s,l)),L&&A.restore(),k){k.offset();const O=u[f]*h+Ha.indexOf(T);this.deferredZIndexContexts_[O]||(this.deferredZIndexContexts_[O]=[]),this.deferredZIndexContexts_[O].push(k)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Ws);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const b_={};function i3(n){if(b_[n]!==void 0)return b_[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let u=i[l];u||(u=[],i[l]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return b_[n]=r,r}function sC(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let L1=class fP extends $m{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;lt(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||it(o)),lt(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),lt(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=Ve.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?Ve.LOADED:Ve.IDLE:u=Ve.LOADING:u=Ve.LOADED),this.color_=e.color!==void 0?du(e.color):null,this.iconImage_=$p(o,l,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const p=this.getImage(1);if(p.width&&p.height)h=p.width,f=p.height;else if(p instanceof HTMLImageElement){this.initialOptions_=e;const _=()=>{if(this.unlistenImageChange(_),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale(sC(x[0],x[1],e.width,e.height))};this.listenImageChange(_);return}}h!==void 0&&this.setScale(sC(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new fP({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=$p(null,e,this.crossOrigin_,Ve.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Ve.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Ve.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Be.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Be.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Qr=.5;function r3(n,e,t,i,r,s,o,l,u){const h=r,f=n[0]*Qr,p=n[1]*Qr,_=Jt(f,p);_.imageSmoothingEnabled=!1;const x=_.canvas,S=new m4(_,Qr,r,null,o,l,null),C=t.length,T=Math.floor((256*256*256-1)/C),b={};for(let A=1;A<=C;++A){const L=t[A-1],O=L.getStyleFunction()||i;if(!O)continue;let B=O(L,s);if(!B)continue;Array.isArray(B)||(B=[B]);const I=(A*T).toString(16).padStart(7,"#00000");for(let N=0,F=B.length;N<F;++N){const V=B[N],U=V.getGeometryFunction()(L);if(!U||!oi(h,U.getExtent()))continue;const D=V.clone(),se=D.getFill();se&&se.setColor(I);const de=D.getStroke();de&&(de.setColor(I),de.setLineDash(null)),D.setText(void 0);const me=V.getImage();if(me){const ne=me.getImageSize();if(!ne)continue;const G=Jt(ne[0],ne[1],void 0,{alpha:!1}),$=G.canvas;G.fillStyle=I,G.fillRect(0,0,$.width,$.height),D.setImage(new L1({img:$,anchor:me.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:me.getOrigin(),opacity:1,size:me.getSize(),scale:me.getScale(),rotation:me.getRotation(),rotateWithView:me.getRotateWithView()}))}const ue=D.getZIndex()||0;let J=b[ue];J||(J={},b[ue]=J,J.Polygon=[],J.Circle=[],J.LineString=[],J.Point=[]);const Z=U.getType();if(Z==="GeometryCollection"){const ne=U.getGeometriesArrayRecursive();for(let G=0,$=ne.length;G<$;++G){const ie=ne[G];J[ie.getType().replace("Multi","")].push(ie,D)}}else J[Z.replace("Multi","")].push(U,D)}}const k=Object.keys(b).map(Number).sort(Ws);for(let A=0,L=k.length;A<L;++A){const O=b[k[A]];for(const B in O){const M=O[B];for(let I=0,N=M.length;I<N;I+=2){S.setStyle(M[I+1]);for(let F=0,V=e.length;F<V;++F)S.setTransform(e[F]),S.drawGeometry(M[I])}}}return _.getImageData(0,0,x.width,x.height)}function s3(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Qr),s=Math.floor(Math.round(n[1])*Qr),o=(Dt(r,0,t.width-1)+Dt(s,0,t.height-1)*t.width)*4,l=t.data[o],u=t.data[o+1],f=t.data[o+2]+256*(u+256*l),p=Math.floor((256*256*256-1)/e.length);f&&f%p===0&&i.push(e[f/p-1])}return i}class gP extends eo{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const o3=5;class a3 extends of{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=o3}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return tt()}getData(e){return null}prepareFrame(e){return tt()}renderFrame(e,t){return tt()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Ve.LOADED||t.getState()===Ve.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Ve.LOADED&&t!=Ve.ERROR&&e.addEventListener(Be.CHANGE,this.boundHandleImageChange_),t==Ve.IDLE&&(e.load(),t=e.getState()),t==Ve.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const oC=[];let Mc=null;function l3(){Mc=Jt(1,1,void 0,{willReadFrequently:!0})}class pP extends a3{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Tr(),this.pixelTransform=Tr(),this.inversePixelTransform=Tr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Mc||l3(),Mc.clearRect(0,0,1,1);let r;try{Mc.drawImage(e,t,i,1,1,0,0,1,1),r=Mc.getImageData(0,0,1,1).data}catch{return Mc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&la(du(e.style.backgroundColor),du(i)))){const l=e.firstElementChild;Ho(l)&&(o=l.getContext("2d"))}if(o&&kV(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Ii?KA():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Jt();const u=o.canvas;s.appendChild(u),l=u.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Pl(i),s=Vm(i),o=Fm(i),l=jm(i);un(t.coordinateToPixelTransform,r),un(t.coordinateToPixelTransform,s),un(t.coordinateToPixelTransform,o),un(t.coordinateToPixelTransform,l);const u=this.inversePixelTransform;un(u,r),un(u,s),un(u,o),un(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(ft(i)/r*o),u=Math.round(Wn(i)/r*o);Xs(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-u/2),MA(this.inversePixelTransform,this.pixelTransform);const h=PV(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=u?(f.width=l,f.height=u):this.context.clearRect(0,0,l,u),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new gP(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Yi.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Yi.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new hP),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Yi.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Yi.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const u=s/2,h=o/2,f=r/t,p=-f,_=-e[0]+l,x=-e[1];return Xs(this.tempTransform,u,h,f,p,-i,_,x)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class c3 extends pP{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=er(),this.wrappedRenderedExtent_=er(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,u=s.projection,h=s.rotation,f=u.getExtent(),p=this.getLayer().getSource(),_=this.getLayer().getDeclutter(),x=t.pixelRatio,S=t.viewHints,C=!(S[Mn.ANIMATING]||S[Mn.INTERACTING]),T=this.context,b=Math.round(ft(r)/l*x),k=Math.round(Wn(r)/l*x),A=p.getWrapX()&&u.canWrapX(),L=A?ft(f):null,O=A?Math.ceil((r[2]-f[2])/L)+1:1;let B=A?Math.floor((r[0]-f[0])/L):0;do{let M=this.getRenderTransform(o,l,0,x,b,k,B*L);t.declutter&&(M=M.slice(0)),e.execute(T,[T.canvas.width,T.canvas.height],M,h,C,i===void 0?Ha:i?dP:t3,i?_&&t.declutter[_]:void 0)}while(++B<O)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Jt(this.context.canvas.width,this.context.canvas.height,oC))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Wm(this.context),oC.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(Yi.PRERENDER)||this.getLayer().hasListener(Yi.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const u=$o(i.extent);l=oi(u,e.extent),this.clipped_=l&&!Wh(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],p=i[0]*Qr,_=i[1]*Qr;f.push(this.getRenderTransform(r,s,o,Qr,p,_,0).slice());const x=h.getSource(),S=l.getExtent();if(x.getWrapX()&&l.canWrapX()&&!Wh(S,u)){let C=u[0];const T=ft(S);let b=0,k;for(;C<S[0];)--b,k=T*b,f.push(this.getRenderTransform(r,s,o,Qr,p,_,k).slice()),C+=T;for(b=0,C=u[2];C>S[2];)++b,k=T*b,f.push(this.getRenderTransform(r,s,o,Qr,p,_,k).slice()),C-=T}this.hitDetectionImageData_=r3(i,f,this.renderedFeatures_,h.getStyleFunction(),u,s,o,$I(s,this.renderedPixelRatio_))}t(s3(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},f=function(_,x,S){const C=it(_),T=h[C];if(T){if(T!==!0&&S<T.distanceSq){if(S===0)return h[C]=!0,s.splice(s.lastIndexOf(T),1),r(_,u,x);T.geometry=x,T.distanceSq=S}}else{if(S===0)return h[C]=!0,r(_,u,x);s.push(h[C]={feature:_,layer:u,geometry:x,distanceSq:S,callback:r})}},p=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,p?t.declutter?.[p]?.all().map(_=>_.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Mn.ANIMATING],s=e.viewHints[Mn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,f=h.projection,p=h.resolution,_=e.pixelRatio,x=t.getRevision(),S=t.getRenderBuffer();let C=t.getRenderOrder();C===void 0&&(C=_4);const T=h.center.slice(),b=f1(u,S*p),k=b.slice(),A=[b.slice()],L=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Wh(L,e.extent)){const se=ft(L),de=Math.max(ft(b)/2,se);b[0]=L[0]-de,b[2]=L[2]+de,IA(T,f);const me=TA(A[0],f);me[0]<L[0]&&me[2]<L[2]?A.push([me[0]+se,me[1],me[2]+se,me[3]]):me[0]>L[0]&&me[2]>L[2]&&A.push([me[0]-se,me[1],me[2]-se,me[3]])}if(this.ready&&this.renderedResolution_==p&&this.renderedRevision_==x&&this.renderedRenderOrder_==C&&this.renderedFrameDeclutter_===!!e.declutter&&Wh(this.wrappedRenderedExtent_,b))return la(this.renderedExtent_,k)||(this.hitDetectionImageData_=null,this.renderedExtent_=k),this.renderedCenter_=T,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const O=new Y4(nP(p,_),b,p,_);let B;for(let se=0,de=A.length;se<de;++se)i.loadFeatures(A[se],p,f);const M=$I(p,_);let I=!0;const N=(se,de)=>{let me;const ue=se.getStyleFunction()||t.getStyleFunction();if(ue&&(me=ue(se,p)),me){const J=this.renderFeature(se,M,me,O,B,this.getLayer().getDeclutter(),de);I=I&&!J}},F=DA(b),V=i.getFeaturesInExtent(F);C&&V.sort(C);for(let se=0,de=V.length;se<de;++se)N(V[se],se);this.renderedFeatures_=V,this.ready=I;const U=O.finish(),D=new n3(b,p,_,i.getOverlaps(),U,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=p,this.renderedRevision_=x,this.renderedRenderOrder_=C,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=k,this.wrappedRenderedExtent_=b,this.renderedCenter_=T,this.renderedProjection_=f,this.renderedPixelRatio_=_,this.replayGroup_=D,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)u=HI(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||u;else u=HI(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return u}}let Nl=0;const Gn=1<<Nl++,Xe=1<<Nl++,ri=1<<Nl++,mr=1<<Nl++,_l=1<<Nl++,Kh=1<<Nl++,Kg=Math.pow(2,Nl)-1,O1={[Gn]:"boolean",[Xe]:"number",[ri]:"string",[mr]:"color",[_l]:"number[]",[Kh]:"size"},u3=Object.keys(O1).map(Number).sort(Ws);function h3(n){return n in O1}function qh(n){const e=[];for(const t of u3)Xh(n,t)&&e.push(O1[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Xh(n,e){return(n&e)===e}function Po(n,e){return n===e}class Qt{constructor(e,t){if(!h3(e))throw new Error(`literal expressions must have a specific type, got ${qh(e)}`);this.type=e,this.value=t}}class d3{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function mP(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function In(n,e,t){switch(typeof n){case"boolean":{if(Po(e,ri))return new Qt(ri,n?"true":"false");if(!Xh(e,Gn))throw new Error(`got a boolean, but expected ${qh(e)}`);return new Qt(Gn,n)}case"number":{if(Po(e,Kh))return new Qt(Kh,li(n));if(Po(e,Gn))return new Qt(Gn,!!n);if(Po(e,ri))return new Qt(ri,n.toString());if(!Xh(e,Xe))throw new Error(`got a number, but expected ${qh(e)}`);return new Qt(Xe,n)}case"string":{if(Po(e,mr))return new Qt(mr,A1(n));if(Po(e,Gn))return new Qt(Gn,!!n);if(!Xh(e,ri))throw new Error(`got a string, but expected ${qh(e)}`);return new Qt(ri,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return T3(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Po(e,Kh)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Qt(Kh,n)}if(Po(e,mr)){if(n.length===3)return new Qt(mr,[...n,1]);if(n.length===4)return new Qt(mr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Xh(e,_l))throw new Error(`got an array of numbers, but expected ${qh(e)}`);return new Qt(_l,n)}const re={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},f3={[re.Get]:je(We(1,1/0),aC),[re.Var]:je(We(1,1),g3),[re.Has]:je(We(1,1/0),aC),[re.Id]:je(p3,wc),[re.Concat]:je(We(2,1/0),ot(ri)),[re.GeometryType]:je(m3,wc),[re.LineMetric]:je(wc),[re.Resolution]:je(A_,wc),[re.Zoom]:je(A_,wc),[re.Time]:je(A_,wc),[re.Any]:je(We(2,1/0),ot(Gn)),[re.All]:je(We(2,1/0),ot(Gn)),[re.Not]:je(We(1,1),ot(Gn)),[re.Equal]:je(We(2,2),ot(Kg)),[re.NotEqual]:je(We(2,2),ot(Kg)),[re.GreaterThan]:je(We(2,2),ot(Xe)),[re.GreaterThanOrEqualTo]:je(We(2,2),ot(Xe)),[re.LessThan]:je(We(2,2),ot(Xe)),[re.LessThanOrEqualTo]:je(We(2,2),ot(Xe)),[re.Multiply]:je(We(2,1/0),lC),[re.Coalesce]:je(We(2,1/0),lC),[re.Divide]:je(We(2,2),ot(Xe)),[re.Add]:je(We(2,1/0),ot(Xe)),[re.Subtract]:je(We(2,2),ot(Xe)),[re.Clamp]:je(We(3,3),ot(Xe)),[re.Mod]:je(We(2,2),ot(Xe)),[re.Pow]:je(We(2,2),ot(Xe)),[re.Abs]:je(We(1,1),ot(Xe)),[re.Floor]:je(We(1,1),ot(Xe)),[re.Ceil]:je(We(1,1),ot(Xe)),[re.Round]:je(We(1,1),ot(Xe)),[re.Sin]:je(We(1,1),ot(Xe)),[re.Cos]:je(We(1,1),ot(Xe)),[re.Atan]:je(We(1,2),ot(Xe)),[re.Sqrt]:je(We(1,1),ot(Xe)),[re.Match]:je(We(4,1/0),cC,_3),[re.Between]:je(We(3,3),ot(Xe)),[re.Interpolate]:je(We(6,1/0),cC,v3),[re.Case]:je(We(3,1/0),y3,x3),[re.In]:je(We(2,2),w3),[re.Number]:je(We(1,1/0),ot(Kg)),[re.String]:je(We(1,1/0),ot(Kg)),[re.Array]:je(We(1,1/0),ot(Xe)),[re.Color]:je(We(1,4),ot(Xe)),[re.Band]:je(We(1,3),ot(Xe)),[re.Palette]:je(We(2,2),E3),[re.ToString]:je(We(1,1),ot(Gn|Xe|ri|mr))};function aC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Qt(Xe,o);break}case"string":{r[s]=new Qt(ri,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function g3(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Qt(ri,i)]}function p3(n,e,t){t.featureId=!0}function m3(n,e,t){t.geometryType=!0}function A_(n,e,t){t.mapState=!0}function wc(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function We(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function lC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=In(n[s+1],e,t);r[s]=o}return r}function ot(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=In(e[o+1],n,i);s[o]=l}return s}}function y3(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function cC(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function _3(n,e,t){const i=n.length-1,r=ri|Xe|Gn,s=In(n[1],r,t),o=In(n[n.length-1],e,t),l=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=In(n[u+2],s.type,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=In(n[u+3],o.type,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...l,o]}function v3(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Qt(Xe,r);let o;try{o=In(n[2],Xe,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const l=new Array(n.length-3);for(let u=0;u<l.length;u+=2){try{const h=In(n[u+3],Xe,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=In(n[u+4],e,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function x3(n,e,t){const i=In(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=In(n[s+1],Gn,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=In(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function w3(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=ri}else r=Xe;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const u=In(i[l],r,t);s[l]=u}catch(u){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${u.message}`)}return[In(n[1],r,t),...s]}function E3(n,e,t){let i;try{i=In(n[1],Xe,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=In(r[o],mr,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(l instanceof Qt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function je(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new d3(t,r,...s)}}function T3(n,e,t){const i=n[0],r=f3[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function yP(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return yP(n.getGeometries()[0]);default:return""}}function _P(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function to(n,e,t){const i=In(n,e,t);return Rr(i)}function Rr(n,e){if(n instanceof Qt){if(n.type===mr&&typeof n.value=="string"){const i=A1(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case re.Number:case re.String:case re.Coalesce:return S3(n);case re.Get:case re.Var:case re.Has:return I3(n);case re.Id:return i=>i.featureId;case re.GeometryType:return i=>i.geometryType;case re.Concat:{const i=n.args.map(r=>Rr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case re.Resolution:return i=>i.resolution;case re.Any:case re.All:case re.Between:case re.In:case re.Not:return R3(n);case re.Equal:case re.NotEqual:case re.LessThan:case re.LessThanOrEqualTo:case re.GreaterThan:case re.GreaterThanOrEqualTo:return C3(n);case re.Multiply:case re.Divide:case re.Add:case re.Subtract:case re.Clamp:case re.Mod:case re.Pow:case re.Abs:case re.Floor:case re.Ceil:case re.Round:case re.Sin:case re.Cos:case re.Atan:case re.Sqrt:return b3(n);case re.Case:return A3(n);case re.Match:return P3(n);case re.Interpolate:return k3(n);case re.ToString:return N3(n);default:throw new Error(`Unsupported operator ${t}`)}}function S3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Rr(n.args[s]);switch(t){case re.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case re.Number:case re.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function I3(n,e){const i=n.args[0].value;switch(n.operator){case re.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;o=o[f]}return o};case re.Var:return r=>r.variables[i];case re.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function C3(n,e){const t=n.operator,i=Rr(n.args[0]),r=Rr(n.args[1]);switch(t){case re.Equal:return s=>i(s)===r(s);case re.NotEqual:return s=>i(s)!==r(s);case re.LessThan:return s=>i(s)<r(s);case re.LessThanOrEqualTo:return s=>i(s)<=r(s);case re.GreaterThan:return s=>i(s)>r(s);case re.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function R3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Rr(n.args[s]);switch(t){case re.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case re.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case re.Between:return s=>{const o=r[0](s),l=r[1](s),u=r[2](s);return o>=l&&o<=u};case re.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case re.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function b3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Rr(n.args[s]);switch(t){case re.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case re.Divide:return s=>r[0](s)/r[1](s);case re.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case re.Subtract:return s=>r[0](s)-r[1](s);case re.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const u=r[2](s);return o>u?u:o};case re.Mod:return s=>r[0](s)%r[1](s);case re.Pow:return s=>Math.pow(r[0](s),r[1](s));case re.Abs:return s=>Math.abs(r[0](s));case re.Floor:return s=>Math.floor(r[0](s));case re.Ceil:return s=>Math.ceil(r[0](s));case re.Round:return s=>Math.round(r[0](s));case re.Sin:return s=>Math.sin(r[0](s));case re.Cos:return s=>Math.cos(r[0](s));case re.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case re.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function A3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Rr(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function P3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Rr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function k3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Rr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,u;for(let h=2;h<t;h+=2){const f=i[h](r);let p=i[h+1](r);const _=Array.isArray(p);if(_&&(p=n4(p)),f>=o)return h===2?p:_?D3(s,o,l,u,f,p):Yh(s,o,l,u,f,p);l=f,u=p}return u}}function N3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Rr(n.args[s]);if(t===re.ToString)return s=>{const o=r[0](s);return n.args[0].type===mr?P1(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function Yh(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,u=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function D3(n,e,t,i,r,s){if(r-t===0)return i;const l=zI(i),u=zI(s);let h=u[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[Yh(n,e,t,l[0],r,u[0]),Yh(n,e,t,l[1],r,u[1]),l[2]+Yh(n,e,t,0,r,h),Yh(n,e,t,i[3],r,s[3])];return i4(f)}function M3(n){return!0}function L3(n){const e=mP(),t=O3(n,e),i=_P();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=yP(r.getGeometry())),t(i)}}function uC(n){const e=mP(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Fv(n[o],e);const r=_P(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[u]=f,u+=1)}return s.length=u,s}}function O3(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?to(s.filter,Gn,e):M3;let l;if(Array.isArray(s.style)){const u=s.style.length;l=new Array(u);for(let h=0;h<u;++h)l[h]=Fv(s.style[h],e)}else l=[Fv(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const u=i[l].filter;if(u(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function Fv(n,e){const t=Nd(n,"",e),i=Dd(n,"",e),r=j3(n,e),s=F3(n,e),o=ai(n,"z-index",e);if(!t&&!i&&!r&&!s&&!au(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new Ji;return function(u){let h=!0;if(t){const f=t(u);f&&(h=!1),l.setFill(f)}if(i){const f=i(u);f&&(h=!1),l.setStroke(f)}if(r){const f=r(u);f&&(h=!1),l.setText(f)}if(s){const f=s(u);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(u)),h?null:l}}function Nd(n,e,t){let i;if(e+"fill-pattern-src"in n)i=B3(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=j1(n,e+"fill-color",t)}if(!i)return null;const r=new Cr;return function(s){const o=i(s);return o===b1?null:(r.setColor(o),r)}}function Dd(n,e,t){const i=ai(n,e+"stroke-width",t),r=j1(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Os(n,e+"stroke-line-cap",t),o=Os(n,e+"stroke-line-join",t),l=vP(n,e+"stroke-line-dash",t),u=ai(n,e+"stroke-line-dash-offset",t),h=ai(n,e+"stroke-miter-limit",t),f=new Mu;return function(p){if(r){const _=r(p);if(_===b1)return null;f.setColor(_)}if(i&&f.setWidth(i(p)),s){const _=s(p);if(_!=="butt"&&_!=="round"&&_!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(_)}if(o){const _=o(p);if(_!=="bevel"&&_!=="round"&&_!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(_)}return l&&f.setLineDash(l(p)),u&&f.setLineDashOffset(u(p)),h&&f.setMiterLimit(h(p)),f}}function j3(n,e){const t="text-",i=Os(n,t+"value",e);if(!i)return null;const r=Nd(n,t,e),s=Nd(n,t+"background-",e),o=Dd(n,t,e),l=Dd(n,t+"background-",e),u=Os(n,t+"font",e),h=ai(n,t+"max-angle",e),f=ai(n,t+"offset-x",e),p=ai(n,t+"offset-y",e),_=Zc(n,t+"overflow",e),x=Os(n,t+"placement",e),S=ai(n,t+"repeat",e),C=Km(n,t+"scale",e),T=Zc(n,t+"rotate-with-view",e),b=ai(n,t+"rotation",e),k=Os(n,t+"align",e),A=Os(n,t+"justify",e),L=Os(n,t+"baseline",e),O=Zc(n,t+"keep-upright",e),B=vP(n,t+"padding",e),M=qm(n,t+"declutter-mode"),I=new uf({declutterMode:M});return function(N){if(I.setText(i(N)),r&&I.setFill(r(N)),s&&I.setBackgroundFill(s(N)),o&&I.setStroke(o(N)),l&&I.setBackgroundStroke(l(N)),u&&I.setFont(u(N)),h&&I.setMaxAngle(h(N)),f&&I.setOffsetX(f(N)),p&&I.setOffsetY(p(N)),_&&I.setOverflow(_(N)),x){const F=x(N);if(F!=="point"&&F!=="line")throw new Error("Expected point or line for text-placement");I.setPlacement(F)}if(S&&I.setRepeat(S(N)),C&&I.setScale(C(N)),T&&I.setRotateWithView(T(N)),b&&I.setRotation(b(N)),k){const F=k(N);if(F!=="left"&&F!=="center"&&F!=="right"&&F!=="end"&&F!=="start")throw new Error("Expected left, right, center, start, or end for text-align");I.setTextAlign(F)}if(A){const F=A(N);if(F!=="left"&&F!=="right"&&F!=="center")throw new Error("Expected left, right, or center for text-justify");I.setJustify(F)}if(L){const F=L(N);if(F!=="bottom"&&F!=="top"&&F!=="middle"&&F!=="alphabetic"&&F!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");I.setTextBaseline(F)}return B&&I.setPadding(B(N)),O&&I.setKeepUpright(O(N)),I}}function F3(n,e){return"icon-src"in n?V3(n,e):"shape-points"in n?z3(n,e):"circle-radius"in n?U3(n,e):null}function V3(n,e){const t="icon-",i=t+"src",r=xP(n[i],i),s=qp(n,t+"anchor",e),o=Km(n,t+"scale",e),l=ai(n,t+"opacity",e),u=qp(n,t+"displacement",e),h=ai(n,t+"rotation",e),f=Zc(n,t+"rotate-with-view",e),p=dC(n,t+"anchor-origin"),_=fC(n,t+"anchor-x-units"),x=fC(n,t+"anchor-y-units"),S=H3(n,t+"color"),C=W3(n,t+"cross-origin"),T=$3(n,t+"offset"),b=dC(n,t+"offset-origin"),k=Xp(n,t+"width"),A=Xp(n,t+"height"),L=G3(n,t+"size"),O=qm(n,t+"declutter-mode"),B=new L1({src:r,anchorOrigin:p,anchorXUnits:_,anchorYUnits:x,color:S,crossOrigin:C,offset:T,offsetOrigin:b,height:A,width:k,size:L,declutterMode:O});return function(M){return l&&B.setOpacity(l(M)),u&&B.setDisplacement(u(M)),h&&B.setRotation(h(M)),f&&B.setRotateWithView(f(M)),o&&B.setScale(o(M)),s&&B.setAnchor(s(M)),B}}function z3(n,e){const t="shape-",i=t+"points",r=t+"radius",s=Vv(n[i],i),o=Vv(n[r],r),l=Nd(n,t,e),u=Dd(n,t,e),h=Km(n,t+"scale",e),f=qp(n,t+"displacement",e),p=ai(n,t+"rotation",e),_=Zc(n,t+"rotate-with-view",e),x=Xp(n,t+"radius2"),S=Xp(n,t+"angle"),C=qm(n,t+"declutter-mode"),T=new Hm({points:s,radius:o,radius2:x,angle:S,declutterMode:C});return function(b){return l&&T.setFill(l(b)),u&&T.setStroke(u(b)),f&&T.setDisplacement(f(b)),p&&T.setRotation(p(b)),_&&T.setRotateWithView(_(b)),h&&T.setScale(h(b)),T}}function U3(n,e){const t="circle-",i=Nd(n,t,e),r=Dd(n,t,e),s=ai(n,t+"radius",e),o=Km(n,t+"scale",e),l=qp(n,t+"displacement",e),u=ai(n,t+"rotation",e),h=Zc(n,t+"rotate-with-view",e),f=qm(n,t+"declutter-mode"),p=new kl({radius:5,declutterMode:f});return function(_){return s&&p.setRadius(s(_)),i&&p.setFill(i(_)),r&&p.setStroke(r(_)),l&&p.setDisplacement(l(_)),u&&p.setRotation(u(_)),h&&p.setRotateWithView(h(_)),o&&p.setScale(o(_)),p}}function ai(n,e,t){if(!(e in n))return;const i=to(n[e],Xe,t);return function(r){return Vv(i(r),e)}}function Os(n,e,t){if(!(e in n))return null;const i=to(n[e],ri,t);return function(r){return xP(i(r),e)}}function B3(n,e,t){const i=Os(n,e+"pattern-src",t),r=hC(n,e+"pattern-offset",t),s=hC(n,e+"pattern-size",t),o=j1(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function Zc(n,e,t){if(!(e in n))return null;const i=to(n[e],Gn,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function j1(n,e,t){if(!(e in n))return null;const i=to(n[e],mr,t);return function(r){return wP(i(r),e)}}function vP(n,e,t){if(!(e in n))return null;const i=to(n[e],_l,t);return function(r){return df(i(r),e)}}function qp(n,e,t){if(!(e in n))return null;const i=to(n[e],_l,t);return function(r){const s=df(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function hC(n,e,t){if(!(e in n))return null;const i=to(n[e],_l,t);return function(r){return EP(i(r),e)}}function Km(n,e,t){if(!(e in n))return null;const i=to(n[e],_l|Xe,t);return function(r){return K3(i(r),e)}}function Xp(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function G3(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return li(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function W3(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function dC(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function fC(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function $3(n,e){const t=n[e];if(t!==void 0)return df(t,e)}function qm(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function H3(n,e){const t=n[e];if(t!==void 0)return wP(t,e)}function df(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function xP(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function Vv(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function wP(n,e){if(typeof n=="string")return n;const t=df(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function EP(n,e){const t=df(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function K3(n,e){return typeof n=="number"?n:EP(n,e)}const dr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function gC(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,p=l?l[1]:0;let _=n[0]+u/2+f,x=n[2]-u/2+f,S=n[1]+h/2+p,C=n[3]-h/2+p;_>x&&(_=(x+_)/2,x=_),S>C&&(S=(C+S)/2,C=S);let T=Dt(i[0],_,x),b=Dt(i[1],S,C);if(o&&t&&r){const k=30*r;T+=-k*Math.log(1+Math.max(0,_-i[0])/k)+k*Math.log(1+Math.max(0,i[0]-x)/k),b+=-k*Math.log(1+Math.max(0,S-i[1])/k)+k*Math.log(1+Math.max(0,i[1]-C)/k)}return[T,b]})}function q3(n){return n}function TP(n){return Math.pow(n,3)}function Lu(n){return 1-TP(1-n)}function X3(n){return 3*n*n-2*n*n*n}function Y3(n){return n}function F1(n,e,t,i){const r=ft(e)/t[0],s=Wn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function V1(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Dt(i,t/2,e*2)}function Z3(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const u=n[0],h=n[n.length-1],f=t?F1(u,t,o,i):u;if(l)return e?V1(r,f,h):Dt(r,h,f);const p=Math.min(f,r),_=Math.floor(h1(n,p,s));return n[_]>f&&_<n.length-1?n[_+1]:n[_]}})}function Q3(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,u,h){if(o!==void 0){const f=r?F1(e,r,u,s):e;if(h)return i?V1(o,f,t):Dt(o,t,f);const p=1e-9,_=Math.ceil(Math.log(e/f)/Math.log(n)-p),x=-l*(.5-p)+.5,S=Math.min(f,o),C=Math.floor(Math.log(e/S)/Math.log(n)+x),T=Math.max(_,C),b=e/Math.pow(n,T);return Dt(b,t,f)}})}function pC(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,u){if(s!==void 0){const h=i?F1(n,i,l,r):n;return!t||!u?Dt(s,e,h):V1(s,h,e)}})}function z1(n){if(n!==void 0)return 0}function mC(n){if(n!==void 0)return n}function J3(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function e6(n){const e=Xo(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const t6=42,U1=256,P_=0;class Jr extends hs{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=x1(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&NA(),e.center&&(e.center=Ls(e.center,this.projection_)),e.extent&&(e.extent=$o(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in dr)delete t[l];this.setProperties(t,!0);const i=i6(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=n6(e),s=i.constraint,o=r6(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ls(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ls(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&qg(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],p={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||X3,callback:i};if(f.center&&(p.sourceCenter=o,p.targetCenter=f.center.slice(),o=p.targetCenter),f.zoom!==void 0?(p.sourceResolution=l,p.targetResolution=this.getResolutionForZoom(f.zoom),l=p.targetResolution):f.resolution&&(p.sourceResolution=l,p.targetResolution=f.resolution,l=p.targetResolution),f.rotation!==void 0){p.sourceRotation=u;const _=al(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=u+_,u=p.targetRotation}s6(p)?p.complete=!0:s+=p.duration,h.push(p)}this.animations_.push(h),this.setHint(Mn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Mn.ANIMATING]>0}getInteracting(){return this.hints_[Mn.INTERACTING]>0}cancelAnimations(){this.setHint(Mn.ANIMATING,-this.hints_[Mn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&qg(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let f=u.duration>0?h/u.duration:1;f>=1?(u.complete=!0,f=1):s=!1;const p=u.easing(f);if(u.sourceCenter){const _=u.sourceCenter[0],x=u.sourceCenter[1],S=u.targetCenter[0],C=u.targetCenter[1];this.nextCenter_=u.targetCenter;const T=_+p*(S-_),b=x+p*(C-x);this.targetCenter_=[T,b]}if(u.sourceResolution&&u.targetResolution){const _=p===1?u.targetResolution:u.sourceResolution+p*(u.targetResolution-u.sourceResolution);if(u.anchor){const x=this.getViewportSize_(this.getRotation()),S=this.constraints_.resolution(_,0,x,!0);this.targetCenter_=this.calculateCenterZoom(S,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=_,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const _=p===1?al(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+p*(u.targetRotation-u.sourceRotation);if(u.anchor){const x=this.constraints_.rotation(_,!0);this.targetCenter_=this.calculateCenterRotate(x,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=_}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Mn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&qg(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],p1(i,e-this.getRotation()),XF(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Nv(e,this.getProjection())}getCenterInternal(){return this.get(dr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return DA(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();lt(t,"The view center is not defined");const i=this.getResolution();lt(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return lt(r!==void 0,"The view rotation is not defined"),Cv(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(dr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal($o(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=ft(e)/t[0],r=Wn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(dr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=k_(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=h1(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Dt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Dt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(lt(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){lt(!zm(e),"Cannot fit empty extent provided as `geometry`");const r=$o(e,this.getProjection());i=qI(r)}else if(e.getType()==="Circle"){const r=$o(e.getExtent(),this.getProjection());i=qI(r),i.rotate(this.getRotation(),gl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,u=1/0,h=-1/0,f=-1/0;for(let p=0,_=s.length;p<_;p+=o){const x=s[p]*i-s[p+1]*r,S=s[p]*r+s[p+1]*i;l=Math.min(l,x),u=Math.min(u,S),h=Math.max(h,x),f=Math.max(f,S)}return[l,u,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),f=Math.sin(h),p=Math.cos(h),_=gl(l);_[0]+=(r[1]-r[3])/2*u,_[1]+=(r[0]-r[2])/2*u;const x=_[0]*p-_[1]*f,S=_[1]*p+_[0]*f,C=this.getConstrainedCenter([x,S],u),T=t.callback?t.callback:Td;t.duration!==void 0?this.animateInternal({resolution:u,center:C,duration:t.duration,easing:t.easing},T):(this.targetResolution_=u,this.targetCenter_=C,this.applyTargetState_(!1,!0),qg(T,!0))}centerOn(e,t,i){this.centerOnInternal(Ls(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(k_(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),u=k_(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Nv(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ls(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ls(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ls(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(dr.ROTATION)!==r&&this.set(dr.ROTATION,r),this.get(dr.RESOLUTION)!==o&&(this.set(dr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(dr.CENTER)||!Fp(this.get(dr.CENTER),l))&&this.set(dr.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Fp(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:e,easing:Lu,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Mn.INTERACTING,1)}endInteraction(e,t,i){i=i&&Ls(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Mn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function qg(n,e){setTimeout(function(){n(e)},0)}function n6(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return gC(n.extent,n.constrainOnlyCenter,t)}const e=x1(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,gC(t,!1,!1)}return q3}function i6(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:P_,l=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,p=n.showFullExtent!==void 0?n.showFullExtent:!1,_=x1(n.projection,"EPSG:3857"),x=_.getExtent();let S=n.constrainOnlyCenter,C=n.extent;if(!h&&!C&&_.isGlobal()&&(S=!1,C=x),n.resolutions!==void 0){const T=n.resolutions;t=T[o],i=T[l]!==void 0?T[l]:T[T.length-1],n.constrainResolution?e=Z3(T,f,!S&&C,p):e=pC(t,i,f,!S&&C,p)}else{const b=(x?Math.max(ft(x),Wn(x)):360*uu.degrees/_.getMetersPerUnit())/U1/Math.pow(2,P_),k=b/Math.pow(2,28-P_);t=n.maxResolution,t!==void 0?o=0:t=b/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,l):i=b/Math.pow(u,l):i=k),l=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,l-o),n.constrainResolution?e=Q3(u,t,i,f,!S&&C,p):e=pC(t,i,f,!S&&C,p)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function r6(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?e6():t===!1?mC:typeof t=="number"?J3(t):mC}return z1}function s6(n){return!(n.sourceCenter&&n.targetCenter&&!Fp(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function k_(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-u*o,f=u*s+l*o;return[h,f]}const dt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class SP extends hs{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[dt.OPACITY]=e.opacity!==void 0?e.opacity:1,lt(typeof t[dt.OPACITY]=="number","Layer opacity must be a number"),t[dt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[dt.Z_INDEX]=e.zIndex,t[dt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[dt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[dt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[dt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Dt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return tt()}getLayerStatesArray(e){return tt()}getExtent(){return this.get(dt.EXTENT)}getMaxResolution(){return this.get(dt.MAX_RESOLUTION)}getMinResolution(){return this.get(dt.MIN_RESOLUTION)}getMinZoom(){return this.get(dt.MIN_ZOOM)}getMaxZoom(){return this.get(dt.MAX_ZOOM)}getOpacity(){return this.get(dt.OPACITY)}getSourceState(){return tt()}getVisible(){return this.get(dt.VISIBLE)}getZIndex(){return this.get(dt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(dt.EXTENT,e)}setMaxResolution(e){this.set(dt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(dt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(dt.MAX_ZOOM,e)}setMinZoom(e){this.set(dt.MIN_ZOOM,e)}setOpacity(e){lt(typeof e=="number","Layer opacity must be a number"),this.set(dt.OPACITY,e)}setVisible(e){this.set(dt.VISIBLE,e)}setZIndex(e){this.set(dt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Xm extends SP{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(dt.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(dt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(bt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=nt(e,Be.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Jr?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return B1(r,t.viewState)&&(!s||oi(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof Jr?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(dt.MAP,e)}getMapInternal(){return this.get(dt.MAP)}setMap(e){this.mapPrecomposeKey_&&(bt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(bt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=nt(e,Yi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=nt(this,Be.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);lt(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(dt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function B1(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const yC={RENDER_ORDER:"renderOrder"};class IP extends Xm{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(yC.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new lP(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(yC.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?uP:e;const t=o6(e);this.styleFunction_=e===null?void 0:B4(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function o6(n){if(n===void 0)return uP;if(!n)return null;if(typeof n=="function"||n instanceof Ji)return n;if(!Array.isArray(n))return uC([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Ji){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Ji))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return L3(r)}return uC(n)}class G1 extends IP{constructor(e){super(e)}createRenderer(){return new c3(this)}}const ko={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class zo extends eo{constructor(e,t){super(e),this.layer=t}}const N_={LAYERS:"layers"};class Ou extends SP{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(N_.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Xi(i.slice(),{unique:!0}):lt(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Xi(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(bt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(nt(e,ni.ADD,this.handleLayersAdd_,this),nt(e,ni.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(bt);rf(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new zo(ko.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[nt(e,ou.PROPERTYCHANGE,this.handleLayerChange_,this),nt(e,Be.CHANGE,this.handleLayerChange_,this)];e instanceof Ou&&t.push(nt(e,ko.ADDLAYER,this.handleLayerGroupAdd_,this),nt(e,ko.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[it(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new zo(ko.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new zo(ko.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new zo(ko.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=it(t);this.listenerKeys_[i].forEach(bt),delete this.listenerKeys_[i],this.dispatchEvent(new zo(ko.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(N_.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new zo(ko.REMOVELAYER,i[r]))}this.set(N_.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=ol(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}}const Ae={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class W1 extends sf{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Be.CHANGE)}release(){this.setState(Ae.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Ae.EMPTY){if(this.state!==Ae.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){tt()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:TP(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function zv(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const a6=new Error("disposed"),l6=[256,256];class _C extends W1{constructor(e){const t=Ae.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=zv(this.data_);return e?[e.width,e.height]:l6}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Ae.IDLE&&this.state!==Ae.ERROR)return;this.state=Ae.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Ae.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Ae.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(a6),this.controller_=null),super.disposeInternal()}}class CP extends W1{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Ii?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Ae.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Ae.ERROR,this.unlistenImage_(),this.image_=c6(),this.changed()}handleImageLoad_(){if(Ii)this.state=Ae.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Ae.LOADED:this.state=Ae.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Ae.ERROR&&(this.state=Ae.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ae.IDLE&&(this.state=Ae.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=r4(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function c6(){const n=Jt(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let D_;const Qc=[];function vC(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function M_(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function u6(){if(D_===void 0){const n=Jt(6,6,Qc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",vC(n,4,5,4,0),vC(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;D_=M_(e,0)||M_(e,4)||M_(e,8),Wm(n),Qc.push(n.canvas)}return D_}function xC(n,e,t,i){const r=Gm(t,e,n);let s=Up(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const u=n.getExtent();if(!u||cu(u,r)){const h=Up(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function h6(n,e,t,i){const r=gl(t);let s=xC(n,e,r,i);return(!isFinite(s)||s<=0)&&wA(t,function(o){return s=xC(n,e,o,i),isFinite(s)&&s>0}),s}function d6(n,e,t,i,r,s,o,l,u,h,f,p,_,x){const S=Jt(Math.round(t*n),Math.round(t*e),Qc);if(p||(S.imageSmoothingEnabled=!1),u.length===0)return S.canvas;S.scale(t,t);function C(O){return Math.round(O*t)/t}S.globalCompositeOperation="lighter";const T=er();u.forEach(function(O,B,M){BF(T,O.extent)});let b;const k=t/i,A=(p?1:1+Math.pow(2,-24))/k;(!_||u.length!==1||h!==0)&&(b=Jt(Math.round(ft(T)*k),Math.round(Wn(T)*k),Qc),p||(b.imageSmoothingEnabled=!1),u.forEach(function(O,B,M){if(O.image.width>0&&O.image.height>0){if(O.clipExtent){b.save();const U=(O.clipExtent[0]-T[0])*k,D=-(O.clipExtent[3]-T[3])*k,se=ft(O.clipExtent)*k,de=Wn(O.clipExtent)*k;b.rect(p?U:Math.round(U),p?D:Math.round(D),p?se:Math.round(U+se)-Math.round(U),p?de:Math.round(D+de)-Math.round(D)),b.clip()}const I=(O.extent[0]-T[0])*k,N=-(O.extent[3]-T[3])*k,F=ft(O.extent)*k,V=Wn(O.extent)*k;b.drawImage(O.image,h,h,O.image.width-2*h,O.image.height-2*h,p?I:Math.round(I),p?N:Math.round(N),p?F:Math.round(I+F)-Math.round(I),p?V:Math.round(N+V)-Math.round(N)),O.clipExtent&&b.restore()}}));const L=Pl(o);return l.getTriangles().forEach(function(O,B,M){const I=O.source,N=O.target;let F=I[0][0],V=I[0][1],U=I[1][0],D=I[1][1],se=I[2][0],de=I[2][1];const me=C((N[0][0]-L[0])/s),ue=C(-(N[0][1]-L[1])/s),J=C((N[1][0]-L[0])/s),Z=C(-(N[1][1]-L[1])/s),ne=C((N[2][0]-L[0])/s),G=C(-(N[2][1]-L[1])/s),$=F,ie=V;F=0,V=0,U-=$,D-=ie,se-=$,de-=ie;const fe=[[U,D,0,0,J-me],[se,de,0,0,ne-me],[0,0,U,D,Z-ue],[0,0,se,de,G-ue]],ye=qF(fe);if(!ye)return;if(S.save(),S.beginPath(),u6()||!p){S.moveTo(J,Z);const Re=4,Me=me-J,Ge=ue-Z;for(let ct=0;ct<Re;ct++)S.lineTo(J+C((ct+1)*Me/Re),Z+C(ct*Ge/(Re-1))),ct!=Re-1&&S.lineTo(J+C((ct+1)*Me/Re),Z+C((ct+1)*Ge/(Re-1)));S.lineTo(ne,G)}else S.moveTo(J,Z),S.lineTo(me,ue),S.lineTo(ne,G);S.clip(),S.transform(ye[0],ye[2],ye[1],ye[3],me,ue),S.translate(T[0]-$,T[3]-ie);let Ie;if(b)Ie=b.canvas,S.scale(A,-A);else{const Re=u[0],Me=Re.extent;Ie=Re.image,S.scale(ft(Me)/Ie.width,-Wn(Me)/Ie.height)}S.drawImage(Ie,0,0),S.restore()}),b&&(Wm(b),Qc.push(b.canvas)),f&&(S.save(),S.globalCompositeOperation="source-over",S.strokeStyle="black",S.lineWidth=1,l.getTriangles().forEach(function(O,B,M){const I=O.target,N=(I[0][0]-L[0])/s,F=-(I[0][1]-L[1])/s,V=(I[1][0]-L[0])/s,U=-(I[1][1]-L[1])/s,D=(I[2][0]-L[0])/s,se=-(I[2][1]-L[1])/s;S.beginPath(),S.moveTo(V,U),S.lineTo(N,F),S.lineTo(D,se),S.closePath(),S.stroke()}),S.restore()),S.canvas}const f6=10,wC=.25;class g6{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let u={};const h=l?IV(A=>un(l,Gm(A,this.targetProj_,this.sourceProj_))):Bp(this.targetProj_,this.sourceProj_);this.transformInv_=function(A){const L=A[0]+"/"+A[1];return u[L]||(u[L]=h(A)),u[L]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ft(r)>=ft(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ft(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ft(this.targetProj_.getExtent()):null;const f=Pl(i),p=Vm(i),_=Fm(i),x=jm(i),S=this.transformInv_(f),C=this.transformInv_(p),T=this.transformInv_(_),b=this.transformInv_(x),k=f6+(o?Math.max(0,Math.ceil(Math.log2(Iv(i)/(o*o*256*256)))):0);if(this.addQuad_(f,p,_,x,S,C,T,b,k),this.wrapsXInSource_){let A=1/0;this.triangles_.forEach(function(L,O,B){A=Math.min(A,L.source[0][0],L.source[1][0],L.source[2][0])}),this.triangles_.forEach(L=>{if(Math.max(L.source[0][0],L.source[1][0],L.source[2][0])-A>this.sourceWorldWidth_/2){const O=[[L.source[0][0],L.source[0][1]],[L.source[1][0],L.source[1][1]],[L.source[2][0],L.source[2][1]]];O[0][0]-A>this.sourceWorldWidth_/2&&(O[0][0]-=this.sourceWorldWidth_),O[1][0]-A>this.sourceWorldWidth_/2&&(O[1][0]-=this.sourceWorldWidth_),O[2][0]-A>this.sourceWorldWidth_/2&&(O[2][0]-=this.sourceWorldWidth_);const B=Math.min(O[0][0],O[1][0],O[2][0]);Math.max(O[0][0],O[1][0],O[2][0])-B<this.sourceWorldWidth_/2&&(L.source=O)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,u,h){const f=EI([s,o,l,u]),p=this.sourceWorldWidth_?ft(f)/this.sourceWorldWidth_:null,_=this.sourceWorldWidth_,x=this.sourceProj_.canWrapX()&&p>.5&&p<1;let S=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const T=EI([e,t,i,r]);S=ft(T)/this.targetWorldWidth_>wC||S}!x&&this.sourceProj_.isGlobal()&&p&&(S=p>wC||S)}if(!S&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!oi(f,this.maxSourceExtent_))return;let C=0;if(!S&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)S=!0;else if(C=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),C!=1&&C!=2&&C!=4&&C!=8)return}if(h>0){if(!S){const T=[(e[0]+i[0])/2,(e[1]+i[1])/2],b=this.transformInv_(T);let k;x?k=(al(s[0],_)+al(l[0],_))/2-al(b[0],_):k=(s[0]+l[0])/2-b[0];const A=(s[1]+l[1])/2-b[1];S=k*k+A*A>this.errorThresholdSquared_}if(S){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const T=[(t[0]+i[0])/2,(t[1]+i[1])/2],b=this.transformInv_(T),k=[(r[0]+e[0])/2,(r[1]+e[1])/2],A=this.transformInv_(k);this.addQuad_(e,t,T,k,s,o,b,A,h-1),this.addQuad_(k,T,i,r,A,b,l,u,h-1)}else{const T=[(e[0]+t[0])/2,(e[1]+t[1])/2],b=this.transformInv_(T),k=[(i[0]+r[0])/2,(i[1]+r[1])/2],A=this.transformInv_(k);this.addQuad_(e,T,k,r,s,b,A,u,h-1),this.addQuad_(T,t,i,k,b,o,l,A,h-1)}return}}if(x){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(C&11)==0&&this.addTriangle_(e,i,r,s,l,u),(C&14)==0&&this.addTriangle_(e,i,t,s,l,o),C&&((C&13)==0&&this.addTriangle_(t,r,e,o,u,s),(C&7)==0&&this.addTriangle_(t,r,i,o,u,l))}calculateSourceExtent(){const e=er();return this.triangles_.forEach(function(t,i,r){const s=t.source;id(e,s[0]),id(e,s[1]),id(e,s[2])}),e}getTriangles(){return this.triangles_}}const p6=.5;class RP extends W1{constructor(e,t,i,r,s,o,l,u,h,f,p,_){super(s,Ae.IDLE,_),this.renderEdges_=p!==void 0?p:!1,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const x=r.getTileCoordExtent(this.wrappedTileCoord_),S=this.targetTileGrid_.getExtent();let C=this.sourceTileGrid_.getExtent();const T=S?ol(x,S):x;if(Iv(T)===0){this.state=Ae.EMPTY;return}const b=e.getExtent();b&&(C?C=ol(C,b):C=b);const k=r.getResolution(this.wrappedTileCoord_[0]),A=h6(e,i,T,k);if(!isFinite(A)||A<=0){this.state=Ae.EMPTY;return}const L=f!==void 0?f:p6;if(this.triangulation_=new g6(e,i,T,C,A*L,k),this.triangulation_.getTriangles().length===0){this.state=Ae.EMPTY;return}this.sourceZ_=t.getZForResolution(A);let O=this.triangulation_.calculateSourceExtent();if(C&&(e.canWrapX()?(O[1]=Dt(O[1],C[1],C[3]),O[3]=Dt(O[3],C[1],C[3])):O=ol(O,C)),!Iv(O))this.state=Ae.EMPTY;else{let B=0,M=0;e.canWrapX()&&(B=ft(b),M=Math.floor((O[0]-b[0])/B)),SA(O.slice(),e,!0).forEach(N=>{const F=t.getTileRangeForExtentAndZ(N,this.sourceZ_);for(let V=F.minX;V<=F.maxX;V++)for(let U=F.minY;U<=F.maxY;U++){const D=h(this.sourceZ_,V,U,l);if(D){const se=M*B;this.sourceTiles_.push({tile:D,offset:se})}}++M}),this.sourceTiles_.length===0&&(this.state=Ae.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Ae.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Ae.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=d6(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Ae.LOADED}this.changed()}load(){if(this.state==Ae.IDLE){this.state=Ae.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Ae.IDLE||i==Ae.LOADING){e++;const r=nt(t,Be.CHANGE,s=>{const o=t.getState();(o==Ae.LOADED||o==Ae.ERROR||o==Ae.EMPTY)&&(bt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Ae.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(bt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Wm(this.canvas_.getContext("2d")),Qc.push(this.canvas_),this.canvas_=null),super.release()}}class $1{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Ec(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new $1(n,e,t,i)}class EC{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Mm&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return lt(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return lt(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){lt(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function Yp(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function m6(n,e,t){return n+"/"+e+"/"+t}function gp(n,e,t,i,r){return`${it(n)},${e},${m6(t,i,r)}`}function y6(n){return _6(n[0],n[1],n[2])}function _6(n,e,t){return(e<<n)+t}function v6(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function L_(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function x6(n,e,t){const i=n[t];return i?i.delete(e):!1}function TC(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=ol(e,$o(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=ol(e,r))}return e}class w6 extends pP{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=er(),this.tempTileRange_=new $1(0,0,0,0),this.tempTileCoord_=Yp(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new EC(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new EC(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),u=gp(l,l.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const f=r.viewState.projection,p=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!p||fp(p,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=un(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!cu(s,r))return null;const o=t.viewState,l=i.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const p=u.getTileCoordForCoordAndZ(r,f),_=this.getTile(f,p[1],p[2],t);if(!_||_.getState()!==Ae.LOADED)continue;const x=u.getOrigin(f),S=li(u.getTileSize(f)),C=u.getResolution(f);let T;if(_ instanceof CP||_ instanceof RP)T=_.getImage();else if(_ instanceof _C){if(T=zv(_.getData()),!T)continue}else continue;const b=Math.floor(h*((r[0]-x[0])/C-p[1]*S[0])),k=Math.floor(h*((x[1]-r[1])/C-p[2]*S[1])),A=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(T,b+A,k+A)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(o.projection),f=it(u);f in e.wantedTiles||(e.wantedTiles[f]={});const p=e.wantedTiles[f],_=l.getMapInternal(),x=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),_?_.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),S=o.rotation,C=S?EA(o.center,o.resolution,S,e.size):void 0;for(let T=i;T>=x;--T){const b=h.getTileRangeForExtentAndZ(t,T,this.tempTileRange_),k=h.getResolution(T);for(let A=b.minX;A<=b.maxX;++A)for(let L=b.minY;L<=b.maxY;++L){if(S&&!h.tileCoordIntersectsViewport([T,A,L],C))continue;const O=this.getTile(T,A,L,e);if(!O||!L_(r,O,T))continue;const M=O.getKey();if(p[M]=!0,O.getState()===Ae.IDLE&&!e.tileQueue.isKeyQueued(M)){const I=Yp(T,A,L,this.tempTileCoord_);e.tileQueue.enqueue([O,f,h.getTileCoordCenter(I),k])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let u=0;u<l.length;++u){const h=gp(this.getLayer().getSource(),l[u],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Ae.LOADED)return f.endTransition(it(this)),L_(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let p=s.minY;p<=s.maxY;++p){const _=gp(u,h,i,f,p);let x=!1;if(l.containsKey(_)){const S=l.peek(_);S.getState()===Ae.LOADED&&(L_(r,S,i),x=!0)}x||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,u=e.pixelRatio,h=this.getLayer(),f=h.getSource(),p=f.getTileGridForProjection(s),_=p.getZForResolution(o,f.zDirection),x=p.getResolution(_),S=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==S&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=S):this.renderedSourceKey_=S;let C=e.extent;const T=f.getTilePixelRatio(u);this.prepareContainer(e,t);const b=this.context.canvas.width,k=this.context.canvas.height,A=i.extent&&$o(i.extent);A&&(C=ol(C,$o(i.extent)));const L=x*b/2/T,O=x*k/2/T,B=[l[0]-L,l[1]-O,l[0]+L,l[1]+O],M={};this.renderedTiles.length=0;const I=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const J=p.getZForResolution(r.nextResolution,f.zDirection),Z=TC(e,e.nextExtent);this.enqueueTiles(e,Z,J,M,I)}const N=TC(e,C);if(this.enqueueTiles(e,N,_,M,0),I>0&&setTimeout(()=>{this.enqueueTiles(e,N,_-1,M,I-1)},0),!(_ in M))return this.container;const F=it(this),V=e.time;for(const J of M[_]){const Z=J.getState();if(Z===Ae.EMPTY)continue;const ne=J.tileCoord;if(Z===Ae.LOADED&&J.getAlpha(F,V)===1){J.endTransition(F);continue}if(Z!==Ae.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,M)){x6(M,J,_),e.animate=!0;continue}if(this.findAltTiles_(p,ne,_+1,M))continue;const ie=p.getMinZoom();for(let fe=_-1;fe>=ie&&!this.findAltTiles_(p,ne,fe,M);--fe);}const U=x/o*u/T,D=this.getRenderContext(e);Xs(this.tempTransform,b/2,k/2,U,U,0,-b/2,-k/2),i.extent&&this.clipUnrotated(D,e,A),f.getInterpolate()||(D.imageSmoothingEnabled=!1),this.preRender(D,e);const se=Object.keys(M).map(Number);se.sort(Ws);let de;const me=[],ue=[];for(let J=se.length-1;J>=0;--J){const Z=se[J],ne=f.getTilePixelSize(Z,u,s),$=p.getResolution(Z)/x,ie=ne[0]*$*U,fe=ne[1]*$*U,ye=p.getTileCoordForCoordAndZ(Pl(B),Z),Ie=p.getTileCoordExtent(ye),Re=un(this.tempTransform,[T*(Ie[0]-B[0])/x,T*(B[3]-Ie[3])/x]),Me=T*f.getGutterForProjection(s);for(const Ge of M[Z]){if(Ge.getState()!==Ae.LOADED)continue;const ct=Ge.tileCoord,tr=ye[1]-ct[1],ps=Math.round(Re[0]-(tr-1)*ie),Hn=ye[2]-ct[2],Kn=Math.round(Re[1]-(Hn-1)*fe),hn=Math.round(Re[0]-tr*ie),dn=Math.round(Re[1]-Hn*fe),qn=ps-hn,Pi=Kn-dn,_t=se.length===1;let ut=!1;de=[hn,dn,hn+qn,dn,hn+qn,dn+Pi,hn,dn+Pi];for(let nn=0,ki=me.length;nn<ki;++nn)if(!_t&&Z<ue[nn]){const It=me[nn];oi([hn,dn,hn+qn,dn+Pi],[It[0],It[3],It[4],It[7]])&&(ut||(D.save(),ut=!0),D.beginPath(),D.moveTo(de[0],de[1]),D.lineTo(de[2],de[3]),D.lineTo(de[4],de[5]),D.lineTo(de[6],de[7]),D.moveTo(It[6],It[7]),D.lineTo(It[4],It[5]),D.lineTo(It[2],It[3]),D.lineTo(It[0],It[1]),D.clip())}me.push(de),ue.push(Z),this.drawTile(Ge,e,hn,dn,qn,Pi,Me,_t),ut&&D.restore(),this.renderedTiles.unshift(Ge),this.updateUsedTiles(e.usedTiles,f,Ge)}}if(this.renderedResolution=x,this.extentChanged=!this.renderedExtent_||!Sd(this.renderedExtent_,B),this.renderedExtent_=B,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&D.restore(),D.imageSmoothingEnabled=!0,this.renderComplete){const J=(Z,ne)=>{const G=it(f),$=ne.wantedTiles[G],ie=$?Object.keys($).length:0;this.updateCacheSize(ie),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(J)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,u){let h;if(e instanceof _C){if(h=zv(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),p=it(this),_=t.layerStatesArray[t.layerIndex],x=_.opacity*(u?e.getAlpha(p,t.time):1),S=x!==f.globalAlpha;S&&(f.save(),f.globalAlpha=x),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),S&&f.restore(),x!==_.opacity?t.animate=!0:u&&e.endTransition(p)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=it(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Xg={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class E6 extends Xm{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Xg.PRELOAD)}setPreload(e){this.set(Xg.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Xg.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Xg.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Yg extends E6{constructor(e){super(e)}createRenderer(){return new w6(this,{cacheSize:this.getCacheSize()})}}const Tc=[0,0,0],No=5;class bP{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,lt(FF(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,lt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Pl(i)),lt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,lt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:U1,lt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new $1(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,u=r.maxY;l<=u;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Ec(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Ec(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Ec(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),f=Math.floor(o*u);if(t<r)return Ec(h,h,f,f,i);const p=Math.floor(u*(s+1))-1,_=Math.floor(u*(o+1))-1;return Ec(h,p,f,_,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Tc);const r=Tc[1],s=Tc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Tc);const o=Tc[1],l=Tc[2];return Ec(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=li(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=li(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=l+s[1]*r;return na(o,l,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),u=this.getOrigin(o),h=li(this.getTileSize(o),this.tmpSize_);let f=l*(e-u[0])/i/h[0],p=l*(u[1]-t)/i/h[1];return r?(f=zg(f,No)-1,p=zg(p,No)-1):(f=Vg(f,No),p=Vg(p,No)),Yp(o,f,p,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),u=li(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/u[0],f=(o[1]-t)/l/u[1];return r?(h=zg(h,No)-1,f=zg(f,No)-1):(h=Vg(h,No),f=Vg(f,No)),Yp(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=h1(this.resolutions_,e,t||0);return Dt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return BA(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function AP(n){let e=n.getDefaultTileGrid();return e||(e=C6(n),n.setDefaultTileGrid(e)),e}function T6(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=H1(t);if(!cu(s,r)){const o=ft(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function S6(n,e,t,i){i=i!==void 0?i:"top-left";const r=PP(n,e,t);return new bP({extent:n,origin:WF(n,i),resolutions:r,tileSize:t})}function I6(n){const e=n||{},t=e.extent||ci("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:PP(t,e.maxZoom,e.tileSize,e.maxResolution)};return new bP(i)}function PP(n,e,t,i){e=e!==void 0?e:t6,t=li(t!==void 0?t:U1);const r=Wn(n),s=ft(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let u=0;u<o;++u)l[u]=i/Math.pow(2,u);return l}function C6(n,e,t,i){const r=H1(n);return S6(r,e,t,i)}function H1(n){n=ci(n);let e=n.getExtent();if(!e){const t=180*uu.degrees/n.getMetersPerUnit();e=na(-t,-t,t,t)}return e}function Zq(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const R6=/\{z\}/g,b6=/\{x\}/g,A6=/\{y\}/g,P6=/\{-y\}/g;function k6(n,e,t,i,r){return n.replace(R6,e.toString()).replace(b6,t.toString()).replace(A6,i.toString()).replace(P6,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function N6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function D6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return k6(n,o,t[1],t[2],s)})}function M6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=D6(n[r],e);return L6(i)}function L6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=y6(e),s=al(r,n.length);return n[s](e,t,i)})}class O6 extends cP{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&li(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||it(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return tt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:AP(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=li(r.getTileSize(e),this.tmpSize);return s==1?o:U4(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=T6(r,e,i)),v6(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class j6 extends eo{constructor(e,t){super(e),this.tile=t}}const O_={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class K1 extends O6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===K1.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=it(t),r=t.getState();let s;r==Ae.LOADING?(this.tileLoadingKeys_[i]=!0,s=O_.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Ae.ERROR?O_.TILELOADERROR:r==Ae.LOADED?O_.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new j6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=N6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(M6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class F6 extends K1{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:kP,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:CP,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!fp(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||fp(t,e)))return this.tileGrid;const i=it(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=AP(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(l,h!==void 0?Ae.IDLE:Ae.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(Be.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||fp(l,s))return this.getTileInternal(e,t,i,r,l||s);const u=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),p=this.getTileGridForProjection(s),_=this.getTileCoordForTileUrlFunction(u,s),x=new RP(l,f,s,p,u,_,this.getTilePixelRatio(r),this.getGutter(),(S,C,T,b)=>this.getTileInternal(S,C,T,b,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return x.key=h,x}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),u=gp(this,l,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,l);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=ci(e);if(i){const r=it(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function kP(n,e){if(Ii){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class pp extends F6{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:I6({extent:H1(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const V6="modulepreload",z6=function(n){return"/visapp/"+n},SC={},Sc=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=z6(h),h in SC)return;SC[h]=!0;const f=h.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const _=document.createElement("link");if(_.rel=f?"stylesheet":V6,f||(_.as="script"),_.crossOrigin="",_.href=h,l&&_.setAttribute("nonce",l),document.head.appendChild(_),f)return new Promise((x,S)=>{_.addEventListener("load",x),_.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},U6='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class B6 extends pp{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[U6];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Ii&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||kP)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const Zp=1/0;class G6{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,rf(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){lt(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=Zp?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[u]?h:u;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,u;for(l=0;l<s;++l)o=t[l],u=e(o),u==Zp?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class W6 extends G6{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Be.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Ae.LOADED||i===Ae.ERROR||i===Ae.EMPTY){i!==Ae.ERROR&&t.removeEventListener(Be.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Ae.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function $6(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Zp;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Lc extends eo{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Fo extends Lc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Lt={SINGLECLICK:"singleclick",CLICK:Be.CLICK,DBLCLICK:Be.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Uv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class H6 extends sf{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=nt(i,Uv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=nt(i,Uv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Be.TOUCHMOVE,this.boundHandleTouchMove_,HA?{passive:!1}:!1)}emulateClick_(e){let t=new Fo(Lt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Fo(Lt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Fo(Lt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Lt.POINTERUP||t.type==Lt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Lt.POINTERDOWN||t.type==Lt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Fo(Lt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(bt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Fo(Lt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(nt(i,Lt.POINTERMOVE,this.handlePointerMove_,this),nt(i,Lt.POINTERUP,this.handlePointerUp_,this),nt(this.element_,Lt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(nt(this.element_.getRootNode(),Lt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Fo(Lt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Fo(Lt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(bt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Be.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(bt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(bt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Vo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Nn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Ym extends hs{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)bt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Td&&this.listenerKeys.push(nt(e,Vo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class K6 extends Ym{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(Be.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+cf+" "+k1+(this.collapsed_&&this.collapsible_?" "+UI:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>pA(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!la(t,this.renderedAttributions_)){KV(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(UI),this.collapsed_?VI(this.collapseLabel_,this.label_):VI(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class q6 extends Ym{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Be.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+cf+" "+k1,u=this.element;u.className=l,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Gg)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Lu}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Gg);!s&&i===0?this.element.classList.add(Gg):s&&i!==0&&this.element.classList.remove(Gg)}this.label_.style.transform=r}this.rotation_=i}}class X6 extends Ym{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Be.CLICK,this.handleClick_.bind(this,i),!1);const p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=h,p.appendChild(typeof l=="string"?document.createTextNode(l):l),p.addEventListener(Be.CLICK,this.handleClick_.bind(this,-i),!1);const _=t+" "+cf+" "+k1,x=this.element;x.className=_,x.appendChild(f),x.appendChild(p),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Lu})):i.setZoom(s)}}}function Y6(n){n=n||{};const e=new Xi;return(n.zoom===void 0||n.zoom)&&e.push(new X6(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new q6(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new K6(n.attributionOptions)),e}class Z6{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const IC={ACTIVE:"active"};class ff extends hs{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(IC.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(IC.ACTIVE,e)}setMap(e){this.map_=e}}function Q6(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:Y3,center:n.getConstrainedCenter(r)})}}function q1(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Lu})}class J6 extends ff{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Lt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();q1(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function Bv(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const e9=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},t9=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},NP=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?t9(n):!0},n9=Ed,DP=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!($V&&WA&&e.ctrlKey)},MP=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},i9=function(n){const e=n.originalEvent;return WA?e.metaKey:e.ctrlKey},r9=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},LP=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},j_=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},s9=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class gf extends ff{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Lt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Lt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Lt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Lt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function X1(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class o9 extends gf{constructor(e){super({stopDown:Lm}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Bv(MP,s9);this.condition_=e.onFocusOnly?Bv(NP,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(X1(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();YF(s,l.getResolution()),p1(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:Lu})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class a9 extends gf{constructor(e){e=e||{},super({stopDown:Lm}),this.condition_=e.condition?e.condition:e9,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!j_(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===z1)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return j_(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return j_(e)&&DP(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class l9 extends Mm{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new kd([r])}getGeometry(){return this.geometry_}}const Ic={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Dh extends eo{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class c9 extends gf{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new l9(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??DP,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Dh(Ic.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Dh(t?Ic.BOXEND:Ic.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Dh(Ic.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Dh(Ic.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Dh(Ic.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class u9 extends c9{constructor(e){e=e||{};const t=e.condition?e.condition:r9;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:Lu})}}const ja={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class h9 extends ff{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return MP(t)&&LP(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Be.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==ja.DOWN||r==ja.LEFT||r==ja.RIGHT||r==ja.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==ja.DOWN?h=-l:r==ja.LEFT?u=-l:r==ja.RIGHT?u=l:h=l;const f=[u,h];p1(f,o.getRotation()),Q6(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class d9 extends ff{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!i9(t)&&LP(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Be.KEYDOWN||e.type==Be.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();q1(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const f9=40,g9=300;class p9 extends ff{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:n9;this.condition_=e.onFocusOnly?Bv(NP,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Be.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=f9;break;case WheelEvent.DOM_DELTA_PAGE:s*=g9;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),q1(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class m9 extends gf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Lm),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==z1&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(X1(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class y9 extends gf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Lm),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(X1(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function _9(n){n=n||{};const e=new Xi,t=new Z6(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new a9),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new J6({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new o9({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new m9),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new y9({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new h9),e.push(new d9({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new p9({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new u9({duration:n.zoomDuration})),e}class v9 extends Mm{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){tt()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Xs(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),MA(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,u){let h;const f=t.viewState;function p(L,O,B,M){return s.call(o,O,L?B:null,M)}const _=f.projection,x=IA(e.slice(),_),S=[[0,0]];if(_.canWrapX()&&r){const L=_.getExtent(),O=ft(L);S.push([-O,0],[O,0])}const C=t.layerStatesArray,T=C.length,b=[],k=[];for(let L=0;L<S.length;L++)for(let O=T-1;O>=0;--O){const B=C[O],M=B.layer;if(M.hasRenderer()&&B1(B,f)&&l.call(u,M)){const I=M.getRenderer(),N=M.getSource();if(I&&N){const F=N.getWrapX()?x:e,V=p.bind(null,B.managed);k[0]=F[0]+S[L][0],k[1]=F[1]+S[L][1],h=I.forEachFeatureAtCoordinate(k,t,i,V,b)}if(h)return h}}if(b.length===0)return;const A=1/b.length;return b.forEach((L,O)=>L.distanceSq+=O*A),b.sort((L,O)=>L.distanceSq-O.distanceSq),b.some(L=>h=L.callback(L.feature,L.layer,L.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,Ed,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){tt()}scheduleExpireIconCache(e){Zi.canExpireCache()&&e.postRenderFunctions.push(x9)}}function x9(n,e){Zi.expire()}class w9 extends v9{constructor(e){super(e),this.fontChangeListenerKey_=nt(Nc,ou.PROPERTYCHANGE,e.redrawText,e),this.element_=Ii?KA():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=cf+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new gP(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){bt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Yi.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof IP&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const p=t[h];e.layerIndex=h;const _=p.layer,x=_.getSourceState();if(!B1(p,r)||x!="ready"&&x!="undefined"){_.unrender();continue}const S=_.render(e,o);S&&(S!==o&&(this.children_.push(S),o=S),s.push(p))}this.declutter(e,s),qV(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Ho(u)){const h=u.getContext("2d");for(const f of this.children_){const p=f.firstElementChild||f,_=f.style.backgroundColor;if(_&&(!Ho(p)||p.width>0)&&(h.fillStyle=_,h.fillRect(0,0,u.width,u.height)),Ho(p)&&p.width>0){const x=f.style.opacity||p.style.opacity;h.globalAlpha=x===""?1:Number(x);const S=p.style.transform;if(S)h.setTransform(...Dv(S));else{const C=parseFloat(p.style.width)/p.width,T=parseFloat(p.style.height)/p.height;h.setTransform(C,0,0,T,0,0)}h.drawImage(p,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Yi.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function OP(n){if(n instanceof Xm){n.setMapInternal(null);return}n instanceof Ou&&n.getLayers().forEach(OP)}function jP(n,e){if(n instanceof Xm){n.setMapInternal(e);return}if(n instanceof Ou){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)jP(t[i],e)}}let E9=class extends hs{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=T9(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:HV,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Tr(),this.pixelToCoordinateTransform_=Tr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ii||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ii||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ii?new Xi:Y6()),this.interactions=t.interactions||(Ii?new Xi:_9({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new W6(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Nn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Nn.VIEW,this.handleViewChanged_),this.addChangeListener(Nn.SIZE,this.handleSizeChanged_),this.addChangeListener(Nn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Jr)&&e.view.then(function(r){i.setView(new Jr(r))}),this.controls.addEventListener(ni.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(ni.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(ni.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(ni.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(ni.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(ni.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){jP(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Ed,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof Ou?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:Ed,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(Nn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Nv(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?un(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Nn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Xi){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ls(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?un(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Nn.SIZE)}getView(){return this.get(Nn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return $6(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Fo(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Uv.POINTERDOWN||i===Be.WHEEL||i===Be.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Mn.ANIMATING]||o[Mn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Yi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Yi.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Lc(Vo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Lc(Vo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)bt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Be.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Be.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Ho(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Ho(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new w9(this)),!Ho(t)){this.mapBrowserEventHandler_=new H6(this,this.moveTolerance_);for(const r in Lt)this.mapBrowserEventHandler_.addEventListener(Lt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Be.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Be.WHEEL,this.boundHandleBrowserEvent_,HA?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[nt(i,Be.KEYDOWN,this.handleBrowserEvent,this),nt(i,Be.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(bt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(bt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=nt(e,ou.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=nt(e,Be.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(bt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new zo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[nt(e,ou.PROPERTYCHANGE,this.render,this),nt(e,Be.CHANGE,this.render,this),nt(e,"addlayer",this.handleLayerAdd_,this),nt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){OP(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&JI(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Cv(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:it(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=Cv(l.nextCenter,l.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!zm(this.previousExtent_)&&!Sd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Lc(Vo.MOVESTART,this,r)),this.previousExtent_=Om(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Mn.ANIMATING]&&!s.viewHints[Mn.INTERACTING]&&!Sd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Lc(Vo.MOVEEND,this,s)),mA(s.extent,this.previousExtent_))),this.dispatchEvent(new Lc(Vo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Vo.LOADSTART)||this.hasListener(Vo.LOADEND)||this.hasListener(Yi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new zo("removelayer",t)),this.set(Nn.LAYERGROUP,e)}setSize(e){this.set(Nn.SIZE,e)}setTarget(e){this.set(Nn.TARGET,e)}setView(e){if(!e||e instanceof Jr){this.set(Nn.VIEW,e);return}this.set(Nn.VIEW,new Jr);const t=this;e.then(function(i){t.setView(new Jr(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Ho(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!JI(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&CA("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!la(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function T9(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Ou({layers:n.layers});t[Nn.LAYERGROUP]=i,t[Nn.TARGET]=n.target,t[Nn.VIEW]=n.view instanceof Jr?n.view:new Jr;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Xi(n.controls.slice()):(lt(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Xi(n.interactions.slice()):(lt(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Xi(n.overlays.slice()):(lt(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Xi,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const F_="units",S9=[1,2,5],Mh=25.4/.28;class I9 extends Ym{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+cf,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(F_,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(F_)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(F_,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Up(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||Mh)/Mh,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Mh)/Mh:void 0;let h=l*o,f="";if(r=="degrees"){const A=uu.degrees;h*=A,h<A/60?(f="",o*=3600):h<A?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let p=3*Math.floor(Math.log(l*o)/Math.log(10)),_,x,S,C=0,T,b;for(;;){S=Math.floor(p/3);const A=Math.pow(10,S);if(_=S9[(p%3+3)%3]*A,x=Math.round(_/o),isNaN(x)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&x>=u){_=C,x=T,S=b;break}else if(x>=l)break;C=_,T=x,b=S,++p}const k=this.scaleBar_?this.createScaleBar(x,_,f):_.toFixed(S<0?-S:0)+" "+f;this.renderedHTML_!=k&&(this.innerElement_.innerHTML=k,this.renderedHTML_=k),this.renderedWidth_!=x&&(this.innerElement_.style.width=x+"px",this.renderedWidth_=x),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,u=[this.createMarker("absolute")];for(let f=0;f<o;++f){const p=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${p}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return u.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),u=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=Up(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Mh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const C9={},CC=n=>{let e;const t=new Set,i=(f,p)=>{const _=typeof f=="function"?f(e):f;if(!Object.is(_,e)){const x=e;e=p??(typeof _!="object"||_===null)?_:Object.assign({},e,_),t.forEach(S=>S(e,x))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(C9?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},R9=n=>n?CC(n):CC;var V_={exports:{}},z_={},U_={exports:{}},B_={};var RC;function b9(){if(RC)return B_;RC=1;var n=Qd();function e(p,_){return p===_&&(p!==0||1/p===1/_)||p!==p&&_!==_}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(p,_){var x=_(),S=i({inst:{value:x,getSnapshot:_}}),C=S[0].inst,T=S[1];return s(function(){C.value=x,C.getSnapshot=_,u(C)&&T({inst:C})},[p,x,_]),r(function(){return u(C)&&T({inst:C}),p(function(){u(C)&&T({inst:C})})},[p]),o(x),x}function u(p){var _=p.getSnapshot;p=p.value;try{var x=_();return!t(p,x)}catch{return!0}}function h(p,_){return _()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return B_.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,B_}var bC;function A9(){return bC||(bC=1,U_.exports=b9()),U_.exports}var AC;function P9(){if(AC)return z_;AC=1;var n=Qd(),e=A9();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return z_.useSyncExternalStoreWithSelector=function(h,f,p,_,x){var S=s(null);if(S.current===null){var C={hasValue:!1,value:null};S.current=C}else C=S.current;S=l(function(){function b(B){if(!k){if(k=!0,A=B,B=_(B),x!==void 0&&C.hasValue){var M=C.value;if(x(M,B))return L=M}return L=B}if(M=L,i(A,B))return M;var I=_(B);return x!==void 0&&x(M,I)?(A=B,M):(A=B,L=I)}var k=!1,A,L,O=p===void 0?null:p;return[function(){return b(f())},O===null?void 0:function(){return b(O())}]},[f,p,_,x]);var T=r(h,S[0],S[1]);return o(function(){C.hasValue=!0,C.value=T},[T]),u(T),T},z_}var PC;function k9(){return PC||(PC=1,V_.exports=P9()),V_.exports}var N9=k9();const D9=Px(N9),FP={},{useDebugValue:M9}=lL,{useSyncExternalStoreWithSelector:L9}=D9;let kC=!1;const O9=n=>n;function j9(n,e=O9,t){(FP?"production":void 0)!=="production"&&t&&!kC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),kC=!0);const i=L9(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return M9(i),i}const NC=n=>{(FP?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?R9(n):n,t=(i,r)=>j9(e,i,r);return Object.assign(t,e),t},br=n=>n?NC(n):NC;var VP=Symbol.for("immer-nothing"),DC=Symbol.for("immer-draftable"),bi=Symbol.for("immer-state");function yr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Md=Object.getPrototypeOf;function pu(n){return!!n&&!!n[bi]}function vl(n){return n?zP(n)||Array.isArray(n)||!!n[DC]||!!n.constructor?.[DC]||pf(n)||Qm(n):!1}var F9=Object.prototype.constructor.toString(),MC=new WeakMap;function zP(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=MC.get(t);return i===void 0&&(i=Function.toString.call(t),MC.set(t,i)),i===F9}function Qp(n,e,t=!0){Zm(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function Zm(n){const e=n[bi];return e?e.type_:Array.isArray(n)?1:pf(n)?2:Qm(n)?3:0}function Gv(n,e){return Zm(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function UP(n,e,t){const i=Zm(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function V9(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function pf(n){return n instanceof Map}function Qm(n){return n instanceof Set}function Ba(n){return n.copy_||n.base_}function Wv(n,e){if(pf(n))return new Map(n);if(Qm(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=zP(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[bi];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Md(n),i)}else{const i=Md(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function Y1(n,e=!1){return Jm(n)||pu(n)||!vl(n)||(Zm(n)>1&&Object.defineProperties(n,{set:Zg,add:Zg,clear:Zg,delete:Zg}),Object.freeze(n),e&&Object.values(n).forEach(t=>Y1(t,!0))),n}function z9(){yr(2)}var Zg={value:z9};function Jm(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var U9={};function xl(n){const e=U9[n];return e||yr(0,n),e}var Ld;function BP(){return Ld}function B9(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function LC(n,e){e&&(xl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function $v(n){Hv(n),n.drafts_.forEach(G9),n.drafts_=null}function Hv(n){n===Ld&&(Ld=n.parent_)}function OC(n){return Ld=B9(Ld,n)}function G9(n){const e=n[bi];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function jC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[bi].modified_&&($v(e),yr(4)),vl(n)&&(n=Jp(e,n),e.parent_||em(e,n)),e.patches_&&xl("Patches").generateReplacementPatches_(t[bi].base_,n,e.patches_,e.inversePatches_)):n=Jp(e,t,[]),$v(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==VP?n:void 0}function Jp(n,e,t){if(Jm(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[bi];if(!r)return Qp(e,(s,o)=>FC(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return em(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),Qp(o,(u,h)=>FC(n,r,s,u,h,t,l),i),em(n,s,!1),t&&n.patches_&&xl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function FC(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=Jm(r);if(!(l&&!o)){if(pu(r)){const u=s&&e&&e.type_!==3&&!Gv(e.assigned_,i)?s.concat(i):void 0,h=Jp(n,r,u);if(UP(t,i,h),pu(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(vl(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;Jp(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(pf(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&em(n,r)}}}function em(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&Y1(e,t)}function W9(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:BP(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=Z1;t&&(r=[i],s=Od);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var Z1={get(n,e){if(e===bi)return n;const t=Ba(n);if(!Gv(t,e))return $9(n,t,e);const i=t[e];return n.finalized_||!vl(i)?i:i===G_(n.base_,e)?(W_(n),n.copy_[e]=qv(i,n)):i},has(n,e){return e in Ba(n)},ownKeys(n){return Reflect.ownKeys(Ba(n))},set(n,e,t){const i=GP(Ba(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=G_(Ba(n),e),s=r?.[bi];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(V9(t,r)&&(t!==void 0||Gv(n.base_,e)))return!0;W_(n),Kv(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return G_(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,W_(n),Kv(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Ba(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){yr(11)},getPrototypeOf(n){return Md(n.base_)},setPrototypeOf(){yr(12)}},Od={};Qp(Z1,(n,e)=>{Od[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Od.deleteProperty=function(n,e){return Od.set.call(this,n,e,void 0)};Od.set=function(n,e,t){return Z1.set.call(this,n[0],e,t,n[0])};function G_(n,e){const t=n[bi];return(t?Ba(t):n)[e]}function $9(n,e,t){const i=GP(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function GP(n,e){if(!(e in n))return;let t=Md(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Md(t)}}function Kv(n){n.modified_||(n.modified_=!0,n.parent_&&Kv(n.parent_))}function W_(n){n.copy_||(n.copy_=Wv(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var H9=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,f=>t.call(this,f,...h))}}typeof t!="function"&&yr(6),i!==void 0&&typeof i!="function"&&yr(7);let r;if(vl(e)){const s=OC(this),o=qv(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?$v(s):Hv(s)}return LC(s,i),jC(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===VP&&(r=void 0),this.autoFreeze_&&Y1(r,!0),i){const s=[],o=[];xl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else yr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){vl(n)||yr(8),pu(n)&&(n=K9(n));const e=OC(this),t=qv(n,void 0);return t[bi].isManual_=!0,Hv(e),t}finishDraft(n,e){const t=n&&n[bi];(!t||!t.isManual_)&&yr(9);const{scope_:i}=t;return LC(i,e),jC(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=xl("Patches").applyPatches_;return pu(n)?i(n,e):this.produce(n,r=>i(r,e))}};function qv(n,e){const t=pf(n)?xl("MapSet").proxyMap_(n,e):Qm(n)?xl("MapSet").proxySet_(n,e):W9(n,e);return(e?e.scope_:BP()).drafts_.push(t),t}function K9(n){return pu(n)||yr(10,n),WP(n)}function WP(n){if(!vl(n)||Jm(n))return n;const e=n[bi];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Wv(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=Wv(n,!0);return Qp(t,(r,s)=>{UP(t,r,WP(s))},i),e&&(e.finalized_=!1),t}var q9=new H9,X9=q9.produce;const Y9=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?X9(r):r;return e(l,s,...o)},n(i.setState,t,i)),ey=Y9,si=br()(ey((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),$P={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await Sc(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-DnCOFawU.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Boothellingen:{name:"Boothellingen",factory:async()=>{const{createBoothellingenLayer:n}=await Sc(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-44x4W8zu.js");return{createBoothellingenLayer:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await Sc(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-DVFFw_nX.js");return{createDieptekaartLayer:e}},__vite__mapDeps([3,4]));return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await Sc(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-DNXDXYcT.js");return{createViswaterLayer:e}},__vite__mapDeps([5,1]));return n()},immediateLoad:!1},"AHN4 Hillshade":{name:"AHN4 Hillshade",factory:async()=>{const{createAHN4MultiHillshadeLayer:n}=await Sc(async()=>{const{createAHN4MultiHillshadeLayer:e}=await import("./hillshadeLayers-o35ZrfoA.js");return{createAHN4MultiHillshadeLayer:e}},__vite__mapDeps([6,4]));return n()},immediateLoad:!0},"Hydro Overlay":{name:"Hydro Overlay",factory:async()=>{const{createHydroOverlayLayer:n}=await Sc(async()=>{const{createHydroOverlayLayer:e}=await import("./hydroOverlayOL-CY22BIIQ.js");return{createHydroOverlayLayer:e}},[]);return n()},immediateLoad:!0}};function Z9(){return Object.values($P).filter(n=>n.immediateLoad)}const ds=br()(ey((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Ki=br()(ey((n,e)=>({visible:{OpenStreetMap:!0,Luchtfoto:!1,"Labels Overlay":!1,Aanlegsteigers:!1,Boothellingen:!1,Dieptekaart:!1,Viswater:!1,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=$P[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=ds.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),Ln=br()(ey(n=>({layerControlOpen:!1,layerPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchFormLocationSource:null,catchFormInitialPhotos:[],catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleLayerPanel:()=>{n(e=>{const t=e.layerPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.layerPanelOpen=!0)})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e?.location||null,t.catchFormLocationSource=e?.locationSource||null,t.catchFormInitialPhotos=e?.photos||[]})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null,e.catchFormLocationSource=null,e.catchFormInitialPhotos=[]})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),Q9={};function J9(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const jd=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return jd(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return jd(i)(t)}}}},ez=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:T=>T,version:0,merge:(T,b)=>({...b,...T}),...e},o=!1;const l=new Set,u=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...T)},i,r);const f=jd(s.serialize),p=()=>{const T=s.partialize({...i()});let b;const k=f({state:T,version:s.version}).then(A=>h.setItem(s.name,A)).catch(A=>{b=A});if(b)throw b;return k},_=r.setState;r.setState=(T,b)=>{_(T,b),p()};const x=n((...T)=>{t(...T),p()},i,r);let S;const C=()=>{var T;if(!h)return;o=!1,l.forEach(k=>k(i()));const b=((T=s.onRehydrateStorage)==null?void 0:T.call(s,i()))||void 0;return jd(h.getItem.bind(h))(s.name).then(k=>{if(k)return s.deserialize(k)}).then(k=>{if(k)if(typeof k.version=="number"&&k.version!==s.version){if(s.migrate)return s.migrate(k.state,k.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return k.state}).then(k=>{var A;return S=s.merge(k,(A=i())!=null?A:x),t(S,!0),p()}).then(()=>{b?.(S,void 0),o=!0,u.forEach(k=>k(S))}).catch(k=>{b?.(void 0,k)})};return r.persist={setOptions:T=>{s={...s,...T},T.getStorage&&(h=T.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>C(),hasHydrated:()=>o,onHydrate:T=>(l.add(T),()=>{l.delete(T)}),onFinishHydration:T=>(u.add(T),()=>{u.delete(T)})},C(),S||x},tz=(n,e)=>(t,i,r)=>{let s={storage:J9(()=>localStorage),partialize:C=>C,version:0,merge:(C,T)=>({...T,...C}),...e},o=!1;const l=new Set,u=new Set;let h=s.storage;if(!h)return n((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...C)},i,r);const f=()=>{const C=s.partialize({...i()});return h.setItem(s.name,{state:C,version:s.version})},p=r.setState;r.setState=(C,T)=>{p(C,T),f()};const _=n((...C)=>{t(...C),f()},i,r);r.getInitialState=()=>_;let x;const S=()=>{var C,T;if(!h)return;o=!1,l.forEach(k=>{var A;return k((A=i())!=null?A:_)});const b=((T=s.onRehydrateStorage)==null?void 0:T.call(s,(C=i())!=null?C:_))||void 0;return jd(h.getItem.bind(h))(s.name).then(k=>{if(k)if(typeof k.version=="number"&&k.version!==s.version){if(s.migrate)return[!0,s.migrate(k.state,k.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,k.state];return[!1,void 0]}).then(k=>{var A;const[L,O]=k;if(x=s.merge(O,(A=i())!=null?A:_),t(x,!0),L)return f()}).then(()=>{b?.(x,void 0),x=i(),o=!0,u.forEach(k=>k(x))}).catch(k=>{b?.(void 0,k)})};return r.persist={setOptions:C=>{s={...s,...C},C.storage&&(h=C.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>S(),hasHydrated:()=>o,onHydrate:C=>(l.add(C),()=>{l.delete(C)}),onFinishHydration:C=>(u.add(C),()=>{u.delete(C)})},s.skipHydration||S(),x||_},nz=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((Q9?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),ez(n,e)):tz(n,e),mf=nz,at=br()(mf(n=>({defaultBackground:"Terrein",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,showWindIndicator:!1,showTideWidget:!1,showForecastSlider:!1,showWaterDataWidget:!1,widgetOrder:["wind","tide","forecast","waterData"],fontScale:100,showFontSliders:!1,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e}),setShowWindIndicator:e=>n({showWindIndicator:e}),setShowTideWidget:e=>n({showTideWidget:e}),setShowForecastSlider:e=>n({showForecastSlider:e}),setShowWaterDataWidget:e=>n({showWaterDataWidget:e}),setWidgetOrder:e=>n({widgetOrder:e}),setFontScale:e=>n({fontScale:e}),setShowFontSliders:e=>n({showFontSliders:e})}),{name:"visapp-settings",version:2,migrate:(n,e)=>{const t=n;return e<2?{...t,defaultBackground:"Terrein"}:t}})),HP=br()(mf((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),KP=br((n,e)=>({current:null,pressureHistory:[],hourlyForecast:[],precipitation15min:[],loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code,precipitation",hourly:"temperature_2m,wind_speed_10m,wind_direction_10m,surface_pressure,weather_code,precipitation_probability,precipitation",minutely_15:"precipitation",past_hours:"24",forecast_hours:"48",past_minutely_15:"0",forecast_minutely_15:"8",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();let l=[],u=[],h=[];o.hourly?.time&&o.hourly?.surface_pressure&&(l=o.hourly.time.map((f,p)=>({time:f,pressure:o.hourly.surface_pressure[p]})),u=o.hourly.time.map((f,p)=>({time:f,temperature:o.hourly.temperature_2m[p],windSpeed:o.hourly.wind_speed_10m[p],windDirection:o.hourly.wind_direction_10m[p],pressure:o.hourly.surface_pressure[p],weatherCode:o.hourly.weather_code[p],precipitationProbability:o.hourly.precipitation_probability?.[p]||0,precipitation:o.hourly.precipitation?.[p]||0}))),o.minutely_15?.time&&o.minutely_15?.precipitation&&(h=o.minutely_15.time.map((f,p)=>({time:f,precipitation:o.minutely_15.precipitation[p]||0}))),o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},pressureHistory:l,hourlyForecast:u,precipitation15min:h,loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"},getFishingScore:()=>{const{current:t}=e();if(!t)return 1;let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),Math.max(0,Math.min(3,i/2))},getPressureTrend:()=>{const{pressureHistory:t}=e();if(t.length<6)return"stable";const i=t.slice(-6),r=t.slice(-12,-6);if(r.length===0)return"stable";const s=i.reduce((u,h)=>u+h.pressure,0)/i.length,o=r.reduce((u,h)=>u+h.pressure,0)/r.length,l=s-o;return l>2?"rising":l<-2?"falling":"stable"},getWeatherAtTime:t=>{const{hourlyForecast:i}=e();if(i.length===0)return null;t.toISOString().slice(0,13)+"";let r=i[0],s=1/0;for(const o of i){const l=new Date(o.time).getTime(),u=Math.abs(l-t.getTime());u<s&&(s=u,r=o)}return r}})),qP=br()(mf(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),VC=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],zC=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],iz=br()(mf((n,e)=>({presets:VC,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=Ki.getState().setLayerVisibility;zC.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=Ki.getState().visible,r=zC.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:VC})}}),{name:"visapp-presets"})),rz=()=>{};var UC={};const XP=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},sz=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},YP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,f=s>>2,p=(s&3)<<4|l>>4;let _=(l&15)<<2|h>>6,x=h&63;u||(x=64,o||(_=64)),i.push(t[f],t[p],t[_],t[x])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(XP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):sz(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||p==null)throw new oz;const _=s<<2|l>>4;if(i.push(_),h!==64){const x=l<<4&240|h>>2;if(i.push(x),p!==64){const S=h<<6&192|p;i.push(S)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class oz extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const az=function(n){const e=XP(n);return YP.encodeByteArray(e,!0)},tm=function(n){return az(n).replace(/\./g,"")},ZP=function(n){try{return YP.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function QP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const lz=()=>QP().__FIREBASE_DEFAULTS__,cz=()=>{if(typeof process>"u"||typeof UC>"u")return;const n=UC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},uz=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&ZP(n[1]);return e&&JSON.parse(e)},ty=()=>{try{return rz()||lz()||cz()||uz()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},JP=n=>ty()?.emulatorHosts?.[n],ek=n=>{const e=JP(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},tk=()=>ty()?.config,nk=n=>ty()?.[`_${n}`];class hz{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Dl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Q1(n){return(await fetch(n,{credentials:"include"})).ok}function ik(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[tm(JSON.stringify(t)),tm(JSON.stringify(o)),""].join(".")}const sd={};function dz(){const n={prod:[],emulator:[]};for(const e of Object.keys(sd))sd[e]?n.emulator.push(e):n.prod.push(e);return n}function fz(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let BC=!1;function J1(n,e){if(typeof window>"u"||typeof document>"u"||!Dl(window.location.host)||sd[n]===e||sd[n]||BC)return;sd[n]=e;function t(_){return`__firebase__banner__${_}`}const i="__firebase__banner",s=dz().prod.length>0;function o(){const _=document.getElementById(i);_&&_.remove()}function l(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function u(_,x){_.setAttribute("width","24"),_.setAttribute("id",x),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{BC=!0,o()},_}function f(_,x){_.setAttribute("id",x),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function p(){const _=fz(i),x=t("text"),S=document.getElementById(x)||document.createElement("span"),C=t("learnmore"),T=document.getElementById(C)||document.createElement("a"),b=t("preprendIcon"),k=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const A=_.element;l(A),f(T,C);const L=h();u(k,b),A.append(k,S,T,L),document.body.appendChild(A)}s?(S.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function en(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gz(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(en())}function rk(){const n=ty()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pz(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function mz(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function yz(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _z(){const n=en();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function sk(){return!rk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ok(){return!rk()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ak(){try{return typeof indexedDB=="object"}catch{return!1}}function vz(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const xz="FirebaseError";class fs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=xz,Object.setPrototypeOf(this,fs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yf.prototype.create)}}class yf{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?wz(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new fs(r,l,i)}}function wz(n,e){return n.replace(Ez,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const Ez=/\{\$([^}]+)}/g;function Tz(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function wl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(GC(s)&&GC(o)){if(!wl(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function GC(n){return n!==null&&typeof n=="object"}function _f(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Sz(n,e){const t=new Iz(n,e);return t.subscribe.bind(t)}class Iz{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Cz(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=$_),r.error===void 0&&(r.error=$_),r.complete===void 0&&(r.complete=$_);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Cz(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function $_(){}function no(n){return n&&n._delegate?n._delegate:n}class ia{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ga="[DEFAULT]";class Rz{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new hz;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Az(e))try{this.getOrInitializeService({instanceIdentifier:Ga})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ga){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ga){return this.instances.has(e)}getOptions(e=Ga){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:bz(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ga){return this.component?this.component.multipleInstances?e:Ga:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bz(n){return n===Ga?void 0:n}function Az(n){return n.instantiationMode==="EAGER"}class Pz{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Rz(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ke;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ke||(Ke={}));const kz={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},Nz=Ke.INFO,Dz={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},Mz=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=Dz[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ew{constructor(e){this.name=e,this._logLevel=Nz,this._logHandler=Mz,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const Lz=(n,e)=>e.some(t=>n instanceof t);let WC,$C;function Oz(){return WC||(WC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jz(){return $C||($C=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lk=new WeakMap,Xv=new WeakMap,ck=new WeakMap,H_=new WeakMap,tw=new WeakMap;function Fz(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Zo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&lk.set(t,n)}).catch(()=>{}),tw.set(e,n),e}function Vz(n){if(Xv.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Xv.set(n,e)}let Yv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Xv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ck.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function zz(n){Yv=n(Yv)}function Uz(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(K_(this),e,...t);return ck.set(i,e.sort?e.sort():[e]),Zo(i)}:jz().includes(n)?function(...e){return n.apply(K_(this),e),Zo(lk.get(this))}:function(...e){return Zo(n.apply(K_(this),e))}}function Bz(n){return typeof n=="function"?Uz(n):(n instanceof IDBTransaction&&Vz(n),Lz(n,Oz())?new Proxy(n,Yv):n)}function Zo(n){if(n instanceof IDBRequest)return Fz(n);if(H_.has(n))return H_.get(n);const e=Bz(n);return e!==n&&(H_.set(n,e),tw.set(e,n)),e}const K_=n=>tw.get(n);function Gz(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Zo(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Zo(o.result),u.oldVersion,u.newVersion,Zo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const Wz=["get","getKey","getAll","getAllKeys","count"],$z=["put","add","delete","clear"],q_=new Map;function HC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(q_.get(e))return q_.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=$z.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Wz.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&u.done]))[0]};return q_.set(e,s),s}zz(n=>({...n,get:(e,t,i)=>HC(e,t)||n.get(e,t,i),has:(e,t)=>!!HC(e,t)||n.has(e,t)}));class Hz{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Kz(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Kz(n){return n.getComponent()?.type==="VERSION"}const Zv="@firebase/app",KC="0.14.6";const Ys=new ew("@firebase/app"),qz="@firebase/app-compat",Xz="@firebase/analytics-compat",Yz="@firebase/analytics",Zz="@firebase/app-check-compat",Qz="@firebase/app-check",Jz="@firebase/auth",eU="@firebase/auth-compat",tU="@firebase/database",nU="@firebase/data-connect",iU="@firebase/database-compat",rU="@firebase/functions",sU="@firebase/functions-compat",oU="@firebase/installations",aU="@firebase/installations-compat",lU="@firebase/messaging",cU="@firebase/messaging-compat",uU="@firebase/performance",hU="@firebase/performance-compat",dU="@firebase/remote-config",fU="@firebase/remote-config-compat",gU="@firebase/storage",pU="@firebase/storage-compat",mU="@firebase/firestore",yU="@firebase/ai",_U="@firebase/firestore-compat",vU="firebase",xU="12.6.0";const Qv="[DEFAULT]",wU={[Zv]:"fire-core",[qz]:"fire-core-compat",[Yz]:"fire-analytics",[Xz]:"fire-analytics-compat",[Qz]:"fire-app-check",[Zz]:"fire-app-check-compat",[Jz]:"fire-auth",[eU]:"fire-auth-compat",[tU]:"fire-rtdb",[nU]:"fire-data-connect",[iU]:"fire-rtdb-compat",[rU]:"fire-fn",[sU]:"fire-fn-compat",[oU]:"fire-iid",[aU]:"fire-iid-compat",[lU]:"fire-fcm",[cU]:"fire-fcm-compat",[uU]:"fire-perf",[hU]:"fire-perf-compat",[dU]:"fire-rc",[fU]:"fire-rc-compat",[gU]:"fire-gcs",[pU]:"fire-gcs-compat",[mU]:"fire-fst",[_U]:"fire-fst-compat",[yU]:"fire-vertex","fire-js":"fire-js",[vU]:"fire-js-all"};const nm=new Map,EU=new Map,Jv=new Map;function qC(n,e){try{n.container.addComponent(e)}catch(t){Ys.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function El(n){const e=n.name;if(Jv.has(e))return Ys.debug(`There were multiple attempts to register component ${e}.`),!1;Jv.set(e,n);for(const t of nm.values())qC(t,n);for(const t of EU.values())qC(t,n);return!0}function ny(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function qi(n){return n==null?!1:n.settings!==void 0}const TU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qo=new yf("app","Firebase",TU);class SU{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ia("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qo.create("app-deleted",{appName:this._name})}}const Ml=xU;function uk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Qv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Qo.create("bad-app-name",{appName:String(r)});if(t||(t=tk()),!t)throw Qo.create("no-options");const s=nm.get(r);if(s){if(wl(t,s.options)&&wl(i,s.config))return s;throw Qo.create("duplicate-app",{appName:r})}const o=new Pz(r);for(const u of Jv.values())o.addComponent(u);const l=new SU(t,i,o);return nm.set(r,l),l}function nw(n=Qv){const e=nm.get(n);if(!e&&n===Qv&&tk())return uk();if(!e)throw Qo.create("no-app",{appName:n});return e}function os(n,e,t){let i=wU[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ys.warn(o.join(" "));return}El(new ia(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const IU="firebase-heartbeat-database",CU=1,Fd="firebase-heartbeat-store";let X_=null;function hk(){return X_||(X_=Gz(IU,CU,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Fd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Qo.create("idb-open",{originalErrorMessage:n.message})})),X_}async function RU(n){try{const t=(await hk()).transaction(Fd),i=await t.objectStore(Fd).get(dk(n));return await t.done,i}catch(e){if(e instanceof fs)Ys.warn(e.message);else{const t=Qo.create("idb-get",{originalErrorMessage:e?.message});Ys.warn(t.message)}}}async function XC(n,e){try{const i=(await hk()).transaction(Fd,"readwrite");await i.objectStore(Fd).put(e,dk(n)),await i.done}catch(t){if(t instanceof fs)Ys.warn(t.message);else{const i=Qo.create("idb-set",{originalErrorMessage:t?.message});Ys.warn(i.message)}}}function dk(n){return`${n.name}!${n.options.appId}`}const bU=1024,AU=30;class PU{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new NU(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=YC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>AU){const r=DU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ys.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=YC(),{heartbeatsToSend:t,unsentEntries:i}=kU(this._heartbeatsCache.heartbeats),r=tm(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Ys.warn(e),""}}}function YC(){return new Date().toISOString().substring(0,10)}function kU(n,e=bU){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),ZC(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),ZC(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class NU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ak()?vz().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await RU(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return XC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return XC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ZC(n){return tm(JSON.stringify({version:2,heartbeats:n})).length}function DU(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function MU(n){El(new ia("platform-logger",e=>new Hz(e),"PRIVATE")),El(new ia("heartbeat",e=>new PU(e),"PRIVATE")),os(Zv,KC,n),os(Zv,KC,"esm2020"),os("fire-js","")}MU("");function fk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const LU=fk,gk=new yf("auth","Firebase",fk());const im=new ew("@firebase/auth");function OU(n,...e){im.logLevel<=Ke.WARN&&im.warn(`Auth (${Ml}): ${n}`,...e)}function mp(n,...e){im.logLevel<=Ke.ERROR&&im.error(`Auth (${Ml}): ${n}`,...e)}function ls(n,...e){throw rw(n,...e)}function Sr(n,...e){return rw(n,...e)}function iw(n,e,t){const i={...LU(),[e]:t};return new yf("auth","Firebase",i).create(e,{appName:n.name})}function ll(n){return iw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jU(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&ls(n,"argument-error"),iw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function rw(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return gk.create(n,...e)}function Fe(n,e,...t){if(!n)throw rw(e,...t)}function Vs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw mp(e),new Error(e)}function Zs(n,e){n||Vs(e)}function ex(){return typeof self<"u"&&self.location?.href||""}function FU(){return QC()==="http:"||QC()==="https:"}function QC(){return typeof self<"u"&&self.location?.protocol||null}function VU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(FU()||mz()||"connection"in navigator)?navigator.onLine:!0}function zU(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class vf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Zs(t>e,"Short delay should be less than long delay!"),this.isMobile=gz()||yz()}get(){return VU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function sw(n,e){Zs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class pk{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const UU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const BU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],GU=new vf(3e4,6e4);function ow(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ju(n,e,t,i,r={}){return mk(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=_f({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return pz()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(h.credentials="include"),pk.fetch()(await yk(n,n.config.apiHost,t,l),h)})}async function mk(n,e,t){n._canInitEmulator=!1;const i={...UU,...e};try{const r=new $U(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Qg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qg(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Qg(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Qg(n,"user-disabled",o);const f=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw iw(n,f,h);ls(n,f)}}catch(r){if(r instanceof fs)throw r;ls(n,"network-request-failed",{message:String(r)})}}async function WU(n,e,t,i,r={}){const s=await ju(n,e,t,i,r);return"mfaPendingCredential"in s&&ls(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function yk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?sw(n.config,r):`${n.config.apiScheme}://${r}`;return BU.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class $U{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Sr(this.auth,"network-request-failed")),GU.get())})}}function Qg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Sr(n,e,i);return r.customData._tokenResponse=t,r}async function HU(n,e){return ju(n,"POST","/v1/accounts:delete",e)}async function rm(n,e){return ju(n,"POST","/v1/accounts:lookup",e)}function od(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function KU(n,e=!1){const t=no(n),i=await t.getIdToken(e),r=aw(i);Fe(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:od(Y_(r.auth_time)),issuedAtTime:od(Y_(r.iat)),expirationTime:od(Y_(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Y_(n){return Number(n)*1e3}function aw(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return mp("JWT malformed, contained fewer than 3 sections"),null;try{const r=ZP(t);return r?JSON.parse(r):(mp("Failed to decode base64 JWT payload"),null)}catch(r){return mp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function JC(n){const e=aw(n);return Fe(e,"internal-error"),Fe(typeof e.exp<"u","internal-error"),Fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Vd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof fs&&qU(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function qU({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class XU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class tx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=od(this.lastLoginAt),this.creationTime=od(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function sm(n){const e=n.auth,t=await n.getIdToken(),i=await Vd(n,rm(e,{idToken:t}));Fe(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?_k(r.providerUserInfo):[],o=ZU(n.providerData,s),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new tx(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function YU(n){const e=no(n);await sm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ZU(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function _k(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function QU(n,e){const t=await mk(n,{},async()=>{const i=_f({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await yk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:i};return n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(u.credentials="include"),pk.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function JU(n,e){return ju(n,"POST","/v2/accounts:revokeToken",ow(n,e))}class Jc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Fe(e.idToken,"internal-error"),Fe(typeof e.idToken<"u","internal-error"),Fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):JC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Fe(e.length!==0,"internal-error");const t=JC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await QU(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Jc;return i&&(Fe(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Fe(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Fe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Jc,this.toJSON())}_performRefresh(){return Vs("not implemented")}}function Do(n,e){Fe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class vr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new XU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new tx(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Vd(this,this.stsTokenManager.getToken(this.auth,e));return Fe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return KU(this,e)}reload(){return YU(this)}_assign(e){this!==e&&(Fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new vr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await sm(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qi(this.auth.app))return Promise.reject(ll(this.auth));const e=await this.getIdToken();return await Vd(this,HU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:p,emailVerified:_,isAnonymous:x,providerData:S,stsTokenManager:C}=t;Fe(p&&C,e,"internal-error");const T=Jc.fromJSON(this.name,C);Fe(typeof p=="string",e,"internal-error"),Do(i,e.name),Do(r,e.name),Fe(typeof _=="boolean",e,"internal-error"),Fe(typeof x=="boolean",e,"internal-error"),Do(s,e.name),Do(o,e.name),Do(l,e.name),Do(u,e.name),Do(h,e.name),Do(f,e.name);const b=new vr({uid:p,auth:e,email:r,emailVerified:_,displayName:i,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:T,createdAt:h,lastLoginAt:f});return S&&Array.isArray(S)&&(b.providerData=S.map(k=>({...k}))),u&&(b._redirectEventId=u),b}static async _fromIdTokenResponse(e,t,i=!1){const r=new Jc;r.updateFromServerResponse(t);const s=new vr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await sm(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Fe(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?_k(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new Jc;l.updateFromIdToken(i);const u=new vr({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new tx(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const eR=new Map;function zs(n){Zs(n instanceof Function,"Expected a class definition");let e=eR.get(n);return e?(Zs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,eR.set(n,e),e)}class vk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}vk.type="NONE";const tR=vk;function yp(n,e,t){return`firebase:${n}:${e}:${t}`}class eu{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=yp(this.userKey,r.apiKey,s),this.fullPersistenceKey=yp("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await rm(this.auth,{idToken:e}).catch(()=>{});return t?vr._fromGetAccountInfoResponse(this.auth,t,e):null}return vr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new eu(zs(tR),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||zs(tR);const o=yp(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let p;if(typeof f=="string"){const _=await rm(e,{idToken:f}).catch(()=>{});if(!_)break;p=await vr._fromGetAccountInfoResponse(e,_,f)}else p=vr._fromJSON(e,f);h!==s&&(l=p),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new eu(s,e,i):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new eu(s,e,i))}}function nR(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Tk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ik(e))return"Blackberry";if(Ck(e))return"Webos";if(wk(e))return"Safari";if((e.includes("chrome/")||Ek(e))&&!e.includes("edge/"))return"Chrome";if(Sk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function xk(n=en()){return/firefox\//i.test(n)}function wk(n=en()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ek(n=en()){return/crios\//i.test(n)}function Tk(n=en()){return/iemobile/i.test(n)}function Sk(n=en()){return/android/i.test(n)}function Ik(n=en()){return/blackberry/i.test(n)}function Ck(n=en()){return/webos/i.test(n)}function lw(n=en()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function eB(n=en()){return lw(n)&&!!window.navigator?.standalone}function tB(){return _z()&&document.documentMode===10}function Rk(n=en()){return lw(n)||Sk(n)||Ck(n)||Ik(n)||/windows phone/i.test(n)||Tk(n)}function bk(n,e=[]){let t;switch(n){case"Browser":t=nR(en());break;case"Worker":t=`${nR(en())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ml}/${i}`}class nB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function iB(n,e={}){return ju(n,"GET","/v2/passwordPolicy",ow(n,e))}const rB=6;class sB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??rB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class oB{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new iR(this),this.idTokenSubscription=new iR(this),this.beforeStateQueue=new nB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=zs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await eu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await rm(this,{idToken:e}),i=await vr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(qi(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await sm(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(qi(this.app))return Promise.reject(ll(this));const t=e?no(e):null;return t&&Fe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return qi(this.app)?Promise.reject(ll(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return qi(this.app)?Promise.reject(ll(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await iB(this),t=new sB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new yf("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await JU(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&zs(e)||this._popupRedirectResolver;Fe(t,this,"argument-error"),this.redirectPersistenceManager=await eu.create(this,[zs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Fe(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(qi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&OU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function iy(n){return no(n)}class iR{constructor(e){this.auth=e,this.observer=null,this.addObserver=Sz(t=>this.observer=t)}get next(){return Fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let cw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function aB(n){cw=n}function lB(n){return cw.loadJS(n)}function cB(){return cw.gapiScript}function uB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function hB(n,e){const t=ny(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(wl(s,e??{}))return r;ls(r,"already-initialized")}return t.initialize({options:e})}function dB(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(zs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function fB(n,e,t){const i=iy(n);Fe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=Ak(e),{host:o,port:l}=gB(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Fe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Fe(wl(h,i.config.emulator)&&wl(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Dl(o)?(Q1(`${s}//${o}${u}`),J1("Auth",!0)):pB()}function Ak(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function gB(n){const e=Ak(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:rR(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:rR(o)}}}function rR(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function pB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Pk{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Vs("not implemented")}_getIdTokenResponse(e){return Vs("not implemented")}_linkToIdToken(e,t){return Vs("not implemented")}_getReauthenticationResolver(e){return Vs("not implemented")}}async function tu(n,e){return WU(n,"POST","/v1/accounts:signInWithIdp",ow(n,e))}const mB="http://localhost";class Tl extends Pk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Tl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ls("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new Tl(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return tu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,tu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,tu(e,t)}buildRequest(){const e={requestUri:mB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=_f(t)}return e}}class uw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class xf extends uw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Uo extends xf{constructor(){super("facebook.com")}static credential(e){return Tl._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uo.PROVIDER_ID="facebook.com";class js extends xf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Tl._fromParams({providerId:js.PROVIDER_ID,signInMethod:js.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return js.credentialFromTaggedObject(e)}static credentialFromError(e){return js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return js.credential(t,i)}catch{return null}}}js.GOOGLE_SIGN_IN_METHOD="google.com";js.PROVIDER_ID="google.com";class Bo extends xf{constructor(){super("github.com")}static credential(e){return Tl._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bo.credential(e.oauthAccessToken)}catch{return null}}}Bo.GITHUB_SIGN_IN_METHOD="github.com";Bo.PROVIDER_ID="github.com";class Go extends xf{constructor(){super("twitter.com")}static credential(e,t){return Tl._fromParams({providerId:Go.PROVIDER_ID,signInMethod:Go.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Go.credentialFromTaggedObject(e)}static credentialFromError(e){return Go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Go.credential(t,i)}catch{return null}}}Go.TWITTER_SIGN_IN_METHOD="twitter.com";Go.PROVIDER_ID="twitter.com";class mu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await vr._fromIdTokenResponse(e,i,r),o=sR(i);return new mu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=sR(i);return new mu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function sR(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class om extends fs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,om.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new om(e,t,i,r)}}function kk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?om._fromErrorAndOperation(n,s,e,i):s})}async function yB(n,e,t=!1){const i=await Vd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return mu._forOperation(n,"link",i)}async function _B(n,e,t=!1){const{auth:i}=n;if(qi(i.app))return Promise.reject(ll(i));const r="reauthenticate";try{const s=await Vd(n,kk(i,r,e,n),t);Fe(s.idToken,i,"internal-error");const o=aw(s.idToken);Fe(o,i,"internal-error");const{sub:l}=o;return Fe(n.uid===l,i,"user-mismatch"),mu._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&ls(i,"user-mismatch"),s}}async function vB(n,e,t=!1){if(qi(n.app))return Promise.reject(ll(n));const i="signIn",r=await kk(n,i,e),s=await mu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function xB(n,e,t,i){return no(n).onIdTokenChanged(e,t,i)}function wB(n,e,t){return no(n).beforeAuthStateChanged(e,t)}function EB(n,e,t,i){return no(n).onAuthStateChanged(e,t,i)}function TB(n){return no(n).signOut()}const am="__sak";class Nk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(am,"1"),this.storage.removeItem(am),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const SB=1e3,IB=10;class Dk extends Nk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Rk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);tB()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,IB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},SB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Dk.type="LOCAL";const CB=Dk;class Mk extends Nk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Mk.type="SESSION";const Lk=Mk;function RB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ry{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new ry(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),u=await RB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ry.receivers=[];function hw(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class bB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=hw("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(p){const _=p;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(_.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function as(){return window}function AB(n){as().location.href=n}function Ok(){return typeof as().WorkerGlobalScope<"u"&&typeof as().importScripts=="function"}async function PB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function kB(){return navigator?.serviceWorker?.controller||null}function NB(){return Ok()?self:null}const jk="firebaseLocalStorageDb",DB=1,lm="firebaseLocalStorage",Fk="fbase_key";class wf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function sy(n,e){return n.transaction([lm],e?"readwrite":"readonly").objectStore(lm)}function MB(){const n=indexedDB.deleteDatabase(jk);return new wf(n).toPromise()}function nx(){const n=indexedDB.open(jk,DB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(lm,{keyPath:Fk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(lm)?e(i):(i.close(),await MB(),e(await nx()))})})}async function oR(n,e,t){const i=sy(n,!0).put({[Fk]:e,value:t});return new wf(i).toPromise()}async function LB(n,e){const t=sy(n,!1).get(e),i=await new wf(t).toPromise();return i===void 0?null:i.value}function aR(n,e){const t=sy(n,!0).delete(e);return new wf(t).toPromise()}const OB=800,jB=3;class Vk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await nx(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>jB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ok()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ry._getInstance(NB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await PB(),!this.activeServiceWorker)return;this.sender=new bB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||kB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await nx();return await oR(e,am,"1"),await aR(e,am),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>oR(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>LB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>aR(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=sy(r,!1).getAll();return new wf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),OB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Vk.type="LOCAL";const FB=Vk;new vf(3e4,6e4);function zk(n,e){return e?zs(e):(Fe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class dw extends Pk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return tu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return tu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return tu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function VB(n){return vB(n.auth,new dw(n),n.bypassAuthState)}function zB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),_B(t,new dw(n),n.bypassAuthState)}async function UB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),yB(t,new dw(n),n.bypassAuthState)}class Uk{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return VB;case"linkViaPopup":case"linkViaRedirect":return UB;case"reauthViaPopup":case"reauthViaRedirect":return zB;default:ls(this.auth,"internal-error")}}resolve(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const BB=new vf(2e3,1e4);async function GB(n,e,t){if(qi(n.app))return Promise.reject(Sr(n,"operation-not-supported-in-this-environment"));const i=iy(n);jU(n,e,uw);const r=zk(i,t);return new nl(i,"signInViaPopup",e,r).executeNotNull()}class nl extends Uk{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,nl.currentPopupAction&&nl.currentPopupAction.cancel(),nl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Fe(e,this.auth,"internal-error"),e}async onExecution(){Zs(this.filter.length===1,"Popup operations only handle one event");const e=hw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Sr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Sr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Sr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,BB.get())};e()}}nl.currentPopupAction=null;const WB="pendingRedirect",_p=new Map;class $B extends Uk{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=_p.get(this.auth._key());if(!e){try{const i=await HB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}_p.set(this.auth._key(),e)}return this.bypassAuthState||_p.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function HB(n,e){const t=XB(e),i=qB(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function KB(n,e){_p.set(n._key(),e)}function qB(n){return zs(n._redirectPersistence)}function XB(n){return yp(WB,n.config.apiKey,n.name)}async function YB(n,e,t=!1){if(qi(n.app))return Promise.reject(ll(n));const i=iy(n),r=zk(i,e),o=await new $B(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const ZB=600*1e3;class QB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!JB(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Bk(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Sr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ZB&&this.cachedEventUids.clear(),this.cachedEventUids.has(lR(e))}saveEventToCache(e){this.cachedEventUids.add(lR(e)),this.lastProcessedEventTime=Date.now()}}function lR(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Bk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function JB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Bk(n);default:return!1}}async function e8(n,e={}){return ju(n,"GET","/v1/projects",e)}const t8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,n8=/^https?/;async function i8(n){if(n.config.emulator)return;const{authorizedDomains:e}=await e8(n);for(const t of e)try{if(r8(t))return}catch{}ls(n,"unauthorized-domain")}function r8(n){const e=ex(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!n8.test(t))return!1;if(t8.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const s8=new vf(3e4,6e4);function cR(){const n=as().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function o8(n){return new Promise((e,t)=>{function i(){cR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cR(),t(Sr(n,"network-request-failed"))},timeout:s8.get()})}if(as().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(as().gapi?.load)i();else{const r=uB("iframefcb");return as()[r]=()=>{gapi.load?i():t(Sr(n,"network-request-failed"))},lB(`${cB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw vp=null,e})}let vp=null;function a8(n){return vp=vp||o8(n),vp}const l8=new vf(5e3,15e3),c8="__/auth/iframe",u8="emulator/auth/iframe",h8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function f8(n){const e=n.config;Fe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?sw(e,u8):`https://${n.config.authDomain}/${c8}`,i={apiKey:e.apiKey,appName:n.name,v:Ml},r=d8.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${_f(i).slice(1)}`}async function g8(n){const e=await a8(n),t=as().gapi;return Fe(t,n,"internal-error"),e.open({where:document.body,url:f8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:h8,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Sr(n,"network-request-failed"),l=as().setTimeout(()=>{s(o)},l8.get());function u(){as().clearTimeout(l),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const p8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},m8=500,y8=600,_8="_blank",v8="http://localhost";class uR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function x8(n,e,t,i=m8,r=y8){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u={...p8,width:i.toString(),height:r.toString(),top:s,left:o},h=en().toLowerCase();t&&(l=Ek(h)?_8:t),xk(h)&&(e=e||v8,u.scrollbars="yes");const f=Object.entries(u).reduce((_,[x,S])=>`${_}${x}=${S},`,"");if(eB(h)&&l!=="_self")return w8(e||"",l),new uR(null);const p=window.open(e||"",l,f);Fe(p,n,"popup-blocked");try{p.focus()}catch{}return new uR(p)}function w8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const E8="__/auth/handler",T8="emulator/auth/handler",S8=encodeURIComponent("fac");async function hR(n,e,t,i,r,s){Fe(n.config.authDomain,n,"auth-domain-config-required"),Fe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ml,eventId:r};if(e instanceof uw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Tz(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof xf){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),h=u?`#${S8}=${encodeURIComponent(u)}`:"";return`${I8(n)}?${_f(l).slice(1)}${h}`}function I8({config:n}){return n.emulator?sw(n,T8):`https://${n.authDomain}/${E8}`}const Z_="webStorageSupport";class C8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Lk,this._completeRedirectFn=YB,this._overrideRedirectResult=KB}async _openPopup(e,t,i,r){Zs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await hR(e,t,i,ex(),r);return x8(e,s,hw())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await hR(e,t,i,ex(),r);return AB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Zs(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await g8(e),i=new QB(e);return t.register("authEvent",r=>(Fe(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Z_,{type:Z_},r=>{const s=r?.[0]?.[Z_];s!==void 0&&t(!!s),ls(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=i8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Rk()||wk()||lw()}}const R8=C8;var dR="@firebase/auth",fR="1.12.0";class b8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function A8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function P8(n){El(new ia("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Fe(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bk(n)},h=new oB(i,r,s,u);return dB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),El(new ia("auth-internal",e=>{const t=iy(e.getProvider("auth").getImmediate());return(i=>new b8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),os(dR,fR,A8(n)),os(dR,fR,"esm2020")}const k8=300,N8=nk("authIdTokenMaxAge")||k8;let gR=null;const D8=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>N8)return;const r=t?.token;gR!==r&&(gR=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function M8(n=nw()){const e=ny(n,"auth");if(e.isInitialized())return e.getImmediate();const t=hB(n,{popupRedirectResolver:R8,persistence:[FB,CB,Lk]}),i=nk("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=D8(s.toString());wB(t,o,()=>o(t.currentUser)),xB(t,l=>o(l))}}const r=JP("auth");return r&&fB(t,`http://${r}`),t}function L8(){return document.getElementsByTagName("head")?.[0]??document}aB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Sr("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",L8().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});P8("Browser");var O8="firebase",j8="12.7.0";os(O8,j8,"app");var pR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var fw;(function(){var n;function e(M,I){function N(){}N.prototype=I.prototype,M.F=I.prototype,M.prototype=new N,M.prototype.constructor=M,M.D=function(F,V,U){for(var D=Array(arguments.length-2),se=2;se<arguments.length;se++)D[se-2]=arguments[se];return I.prototype[V].apply(F,D)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(M,I,N){N||(N=0);const F=Array(16);if(typeof I=="string")for(var V=0;V<16;++V)F[V]=I.charCodeAt(N++)|I.charCodeAt(N++)<<8|I.charCodeAt(N++)<<16|I.charCodeAt(N++)<<24;else for(V=0;V<16;++V)F[V]=I[N++]|I[N++]<<8|I[N++]<<16|I[N++]<<24;I=M.g[0],N=M.g[1],V=M.g[2];let U=M.g[3],D;D=I+(U^N&(V^U))+F[0]+3614090360&4294967295,I=N+(D<<7&4294967295|D>>>25),D=U+(V^I&(N^V))+F[1]+3905402710&4294967295,U=I+(D<<12&4294967295|D>>>20),D=V+(N^U&(I^N))+F[2]+606105819&4294967295,V=U+(D<<17&4294967295|D>>>15),D=N+(I^V&(U^I))+F[3]+3250441966&4294967295,N=V+(D<<22&4294967295|D>>>10),D=I+(U^N&(V^U))+F[4]+4118548399&4294967295,I=N+(D<<7&4294967295|D>>>25),D=U+(V^I&(N^V))+F[5]+1200080426&4294967295,U=I+(D<<12&4294967295|D>>>20),D=V+(N^U&(I^N))+F[6]+2821735955&4294967295,V=U+(D<<17&4294967295|D>>>15),D=N+(I^V&(U^I))+F[7]+4249261313&4294967295,N=V+(D<<22&4294967295|D>>>10),D=I+(U^N&(V^U))+F[8]+1770035416&4294967295,I=N+(D<<7&4294967295|D>>>25),D=U+(V^I&(N^V))+F[9]+2336552879&4294967295,U=I+(D<<12&4294967295|D>>>20),D=V+(N^U&(I^N))+F[10]+4294925233&4294967295,V=U+(D<<17&4294967295|D>>>15),D=N+(I^V&(U^I))+F[11]+2304563134&4294967295,N=V+(D<<22&4294967295|D>>>10),D=I+(U^N&(V^U))+F[12]+1804603682&4294967295,I=N+(D<<7&4294967295|D>>>25),D=U+(V^I&(N^V))+F[13]+4254626195&4294967295,U=I+(D<<12&4294967295|D>>>20),D=V+(N^U&(I^N))+F[14]+2792965006&4294967295,V=U+(D<<17&4294967295|D>>>15),D=N+(I^V&(U^I))+F[15]+1236535329&4294967295,N=V+(D<<22&4294967295|D>>>10),D=I+(V^U&(N^V))+F[1]+4129170786&4294967295,I=N+(D<<5&4294967295|D>>>27),D=U+(N^V&(I^N))+F[6]+3225465664&4294967295,U=I+(D<<9&4294967295|D>>>23),D=V+(I^N&(U^I))+F[11]+643717713&4294967295,V=U+(D<<14&4294967295|D>>>18),D=N+(U^I&(V^U))+F[0]+3921069994&4294967295,N=V+(D<<20&4294967295|D>>>12),D=I+(V^U&(N^V))+F[5]+3593408605&4294967295,I=N+(D<<5&4294967295|D>>>27),D=U+(N^V&(I^N))+F[10]+38016083&4294967295,U=I+(D<<9&4294967295|D>>>23),D=V+(I^N&(U^I))+F[15]+3634488961&4294967295,V=U+(D<<14&4294967295|D>>>18),D=N+(U^I&(V^U))+F[4]+3889429448&4294967295,N=V+(D<<20&4294967295|D>>>12),D=I+(V^U&(N^V))+F[9]+568446438&4294967295,I=N+(D<<5&4294967295|D>>>27),D=U+(N^V&(I^N))+F[14]+3275163606&4294967295,U=I+(D<<9&4294967295|D>>>23),D=V+(I^N&(U^I))+F[3]+4107603335&4294967295,V=U+(D<<14&4294967295|D>>>18),D=N+(U^I&(V^U))+F[8]+1163531501&4294967295,N=V+(D<<20&4294967295|D>>>12),D=I+(V^U&(N^V))+F[13]+2850285829&4294967295,I=N+(D<<5&4294967295|D>>>27),D=U+(N^V&(I^N))+F[2]+4243563512&4294967295,U=I+(D<<9&4294967295|D>>>23),D=V+(I^N&(U^I))+F[7]+1735328473&4294967295,V=U+(D<<14&4294967295|D>>>18),D=N+(U^I&(V^U))+F[12]+2368359562&4294967295,N=V+(D<<20&4294967295|D>>>12),D=I+(N^V^U)+F[5]+4294588738&4294967295,I=N+(D<<4&4294967295|D>>>28),D=U+(I^N^V)+F[8]+2272392833&4294967295,U=I+(D<<11&4294967295|D>>>21),D=V+(U^I^N)+F[11]+1839030562&4294967295,V=U+(D<<16&4294967295|D>>>16),D=N+(V^U^I)+F[14]+4259657740&4294967295,N=V+(D<<23&4294967295|D>>>9),D=I+(N^V^U)+F[1]+2763975236&4294967295,I=N+(D<<4&4294967295|D>>>28),D=U+(I^N^V)+F[4]+1272893353&4294967295,U=I+(D<<11&4294967295|D>>>21),D=V+(U^I^N)+F[7]+4139469664&4294967295,V=U+(D<<16&4294967295|D>>>16),D=N+(V^U^I)+F[10]+3200236656&4294967295,N=V+(D<<23&4294967295|D>>>9),D=I+(N^V^U)+F[13]+681279174&4294967295,I=N+(D<<4&4294967295|D>>>28),D=U+(I^N^V)+F[0]+3936430074&4294967295,U=I+(D<<11&4294967295|D>>>21),D=V+(U^I^N)+F[3]+3572445317&4294967295,V=U+(D<<16&4294967295|D>>>16),D=N+(V^U^I)+F[6]+76029189&4294967295,N=V+(D<<23&4294967295|D>>>9),D=I+(N^V^U)+F[9]+3654602809&4294967295,I=N+(D<<4&4294967295|D>>>28),D=U+(I^N^V)+F[12]+3873151461&4294967295,U=I+(D<<11&4294967295|D>>>21),D=V+(U^I^N)+F[15]+530742520&4294967295,V=U+(D<<16&4294967295|D>>>16),D=N+(V^U^I)+F[2]+3299628645&4294967295,N=V+(D<<23&4294967295|D>>>9),D=I+(V^(N|~U))+F[0]+4096336452&4294967295,I=N+(D<<6&4294967295|D>>>26),D=U+(N^(I|~V))+F[7]+1126891415&4294967295,U=I+(D<<10&4294967295|D>>>22),D=V+(I^(U|~N))+F[14]+2878612391&4294967295,V=U+(D<<15&4294967295|D>>>17),D=N+(U^(V|~I))+F[5]+4237533241&4294967295,N=V+(D<<21&4294967295|D>>>11),D=I+(V^(N|~U))+F[12]+1700485571&4294967295,I=N+(D<<6&4294967295|D>>>26),D=U+(N^(I|~V))+F[3]+2399980690&4294967295,U=I+(D<<10&4294967295|D>>>22),D=V+(I^(U|~N))+F[10]+4293915773&4294967295,V=U+(D<<15&4294967295|D>>>17),D=N+(U^(V|~I))+F[1]+2240044497&4294967295,N=V+(D<<21&4294967295|D>>>11),D=I+(V^(N|~U))+F[8]+1873313359&4294967295,I=N+(D<<6&4294967295|D>>>26),D=U+(N^(I|~V))+F[15]+4264355552&4294967295,U=I+(D<<10&4294967295|D>>>22),D=V+(I^(U|~N))+F[6]+2734768916&4294967295,V=U+(D<<15&4294967295|D>>>17),D=N+(U^(V|~I))+F[13]+1309151649&4294967295,N=V+(D<<21&4294967295|D>>>11),D=I+(V^(N|~U))+F[4]+4149444226&4294967295,I=N+(D<<6&4294967295|D>>>26),D=U+(N^(I|~V))+F[11]+3174756917&4294967295,U=I+(D<<10&4294967295|D>>>22),D=V+(I^(U|~N))+F[2]+718787259&4294967295,V=U+(D<<15&4294967295|D>>>17),D=N+(U^(V|~I))+F[9]+3951481745&4294967295,M.g[0]=M.g[0]+I&4294967295,M.g[1]=M.g[1]+(V+(D<<21&4294967295|D>>>11))&4294967295,M.g[2]=M.g[2]+V&4294967295,M.g[3]=M.g[3]+U&4294967295}i.prototype.v=function(M,I){I===void 0&&(I=M.length);const N=I-this.blockSize,F=this.C;let V=this.h,U=0;for(;U<I;){if(V==0)for(;U<=N;)r(this,M,U),U+=this.blockSize;if(typeof M=="string"){for(;U<I;)if(F[V++]=M.charCodeAt(U++),V==this.blockSize){r(this,F),V=0;break}}else for(;U<I;)if(F[V++]=M[U++],V==this.blockSize){r(this,F),V=0;break}}this.h=V,this.o+=I},i.prototype.A=function(){var M=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);M[0]=128;for(var I=1;I<M.length-8;++I)M[I]=0;I=this.o*8;for(var N=M.length-8;N<M.length;++N)M[N]=I&255,I/=256;for(this.v(M),M=Array(16),I=0,N=0;N<4;++N)for(let F=0;F<32;F+=8)M[I++]=this.g[N]>>>F&255;return M};function s(M,I){var N=l;return Object.prototype.hasOwnProperty.call(N,M)?N[M]:N[M]=I(M)}function o(M,I){this.h=I;const N=[];let F=!0;for(let V=M.length-1;V>=0;V--){const U=M[V]|0;F&&U==I||(N[V]=U,F=!1)}this.g=N}var l={};function u(M){return-128<=M&&M<128?s(M,function(I){return new o([I|0],I<0?-1:0)}):new o([M|0],M<0?-1:0)}function h(M){if(isNaN(M)||!isFinite(M))return p;if(M<0)return T(h(-M));const I=[];let N=1;for(let F=0;M>=N;F++)I[F]=M/N|0,N*=4294967296;return new o(I,0)}function f(M,I){if(M.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(M.charAt(0)=="-")return T(f(M.substring(1),I));if(M.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=h(Math.pow(I,8));let F=p;for(let U=0;U<M.length;U+=8){var V=Math.min(8,M.length-U);const D=parseInt(M.substring(U,U+V),I);V<8?(V=h(Math.pow(I,V)),F=F.j(V).add(h(D))):(F=F.j(N),F=F.add(h(D)))}return F}var p=u(0),_=u(1),x=u(16777216);n=o.prototype,n.m=function(){if(C(this))return-T(this).m();let M=0,I=1;for(let N=0;N<this.g.length;N++){const F=this.i(N);M+=(F>=0?F:4294967296+F)*I,I*=4294967296}return M},n.toString=function(M){if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(S(this))return"0";if(C(this))return"-"+T(this).toString(M);const I=h(Math.pow(M,6));var N=this;let F="";for(;;){const V=L(N,I).g;N=b(N,V.j(I));let U=((N.g.length>0?N.g[0]:N.h)>>>0).toString(M);if(N=V,S(N))return U+F;for(;U.length<6;)U="0"+U;F=U+F}},n.i=function(M){return M<0?0:M<this.g.length?this.g[M]:this.h};function S(M){if(M.h!=0)return!1;for(let I=0;I<M.g.length;I++)if(M.g[I]!=0)return!1;return!0}function C(M){return M.h==-1}n.l=function(M){return M=b(this,M),C(M)?-1:S(M)?0:1};function T(M){const I=M.g.length,N=[];for(let F=0;F<I;F++)N[F]=~M.g[F];return new o(N,~M.h).add(_)}n.abs=function(){return C(this)?T(this):this},n.add=function(M){const I=Math.max(this.g.length,M.g.length),N=[];let F=0;for(let V=0;V<=I;V++){let U=F+(this.i(V)&65535)+(M.i(V)&65535),D=(U>>>16)+(this.i(V)>>>16)+(M.i(V)>>>16);F=D>>>16,U&=65535,D&=65535,N[V]=D<<16|U}return new o(N,N[N.length-1]&-2147483648?-1:0)};function b(M,I){return M.add(T(I))}n.j=function(M){if(S(this)||S(M))return p;if(C(this))return C(M)?T(this).j(T(M)):T(T(this).j(M));if(C(M))return T(this.j(T(M)));if(this.l(x)<0&&M.l(x)<0)return h(this.m()*M.m());const I=this.g.length+M.g.length,N=[];for(var F=0;F<2*I;F++)N[F]=0;for(F=0;F<this.g.length;F++)for(let V=0;V<M.g.length;V++){const U=this.i(F)>>>16,D=this.i(F)&65535,se=M.i(V)>>>16,de=M.i(V)&65535;N[2*F+2*V]+=D*de,k(N,2*F+2*V),N[2*F+2*V+1]+=U*de,k(N,2*F+2*V+1),N[2*F+2*V+1]+=D*se,k(N,2*F+2*V+1),N[2*F+2*V+2]+=U*se,k(N,2*F+2*V+2)}for(M=0;M<I;M++)N[M]=N[2*M+1]<<16|N[2*M];for(M=I;M<2*I;M++)N[M]=0;return new o(N,0)};function k(M,I){for(;(M[I]&65535)!=M[I];)M[I+1]+=M[I]>>>16,M[I]&=65535,I++}function A(M,I){this.g=M,this.h=I}function L(M,I){if(S(I))throw Error("division by zero");if(S(M))return new A(p,p);if(C(M))return I=L(T(M),I),new A(T(I.g),T(I.h));if(C(I))return I=L(M,T(I)),new A(T(I.g),I.h);if(M.g.length>30){if(C(M)||C(I))throw Error("slowDivide_ only works with positive integers.");for(var N=_,F=I;F.l(M)<=0;)N=O(N),F=O(F);var V=B(N,1),U=B(F,1);for(F=B(F,2),N=B(N,2);!S(F);){var D=U.add(F);D.l(M)<=0&&(V=V.add(N),U=D),F=B(F,1),N=B(N,1)}return I=b(M,V.j(I)),new A(V,I)}for(V=p;M.l(I)>=0;){for(N=Math.max(1,Math.floor(M.m()/I.m())),F=Math.ceil(Math.log(N)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),U=h(N),D=U.j(I);C(D)||D.l(M)>0;)N-=F,U=h(N),D=U.j(I);S(U)&&(U=_),V=V.add(U),M=b(M,D)}return new A(V,M)}n.B=function(M){return L(this,M).h},n.and=function(M){const I=Math.max(this.g.length,M.g.length),N=[];for(let F=0;F<I;F++)N[F]=this.i(F)&M.i(F);return new o(N,this.h&M.h)},n.or=function(M){const I=Math.max(this.g.length,M.g.length),N=[];for(let F=0;F<I;F++)N[F]=this.i(F)|M.i(F);return new o(N,this.h|M.h)},n.xor=function(M){const I=Math.max(this.g.length,M.g.length),N=[];for(let F=0;F<I;F++)N[F]=this.i(F)^M.i(F);return new o(N,this.h^M.h)};function O(M){const I=M.g.length+1,N=[];for(let F=0;F<I;F++)N[F]=M.i(F)<<1|M.i(F-1)>>>31;return new o(N,M.h)}function B(M,I){const N=I>>5;I%=32;const F=M.g.length-N,V=[];for(let U=0;U<F;U++)V[U]=I>0?M.i(U+N)>>>I|M.i(U+N+1)<<32-I:M.i(U+N);return new o(V,M.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,fw=o}).apply(typeof pR<"u"?pR:typeof self<"u"?self:typeof window<"u"?window:{});var Jg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Gk,Zh,Wk,xp,ix,$k,Hk,Kk;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Jg=="object"&&Jg];for(var E=0;E<g.length;++E){var R=g[E];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var i=t(this);function r(g,E){if(E)e:{var R=i;g=g.split(".");for(var j=0;j<g.length-1;j++){var X=g[j];if(!(X in R))break e;R=R[X]}g=g[g.length-1],j=R[g],E=E(j),E!=j&&E!=null&&e(R,g,{configurable:!0,writable:!0,value:E})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(E){var R=[],j;for(j in E)Object.prototype.hasOwnProperty.call(E,j)&&R.push([j,E[j]]);return R}});var s=s||{},o=this||self;function l(g){var E=typeof g;return E=="object"&&g!=null||E=="function"}function u(g,E,R){return g.call.apply(g.bind,arguments)}function h(g,E,R){return h=u,h.apply(null,arguments)}function f(g,E){var R=Array.prototype.slice.call(arguments,1);return function(){var j=R.slice();return j.push.apply(j,arguments),g.apply(this,j)}}function p(g,E){function R(){}R.prototype=E.prototype,g.Z=E.prototype,g.prototype=new R,g.prototype.constructor=g,g.Ob=function(j,X,te){for(var ge=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)ge[ze-2]=arguments[ze];return E.prototype[X].apply(j,ge)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function x(g){const E=g.length;if(E>0){const R=Array(E);for(let j=0;j<E;j++)R[j]=g[j];return R}return[]}function S(g,E){for(let j=1;j<arguments.length;j++){const X=arguments[j];var R=typeof X;if(R=R!="object"?R:X?Array.isArray(X)?"array":R:"null",R=="array"||R=="object"&&typeof X.length=="number"){R=g.length||0;const te=X.length||0;g.length=R+te;for(let ge=0;ge<te;ge++)g[R+ge]=X[ge]}else g.push(X)}}class C{constructor(E,R){this.i=E,this.j=R,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function T(g){o.setTimeout(()=>{throw g},0)}function b(){var g=M;let E=null;return g.g&&(E=g.g,g.g=g.g.next,g.g||(g.h=null),E.next=null),E}class k{constructor(){this.h=this.g=null}add(E,R){const j=A.get();j.set(E,R),this.h?this.h.next=j:this.g=j,this.h=j}}var A=new C(()=>new L,g=>g.reset());class L{constructor(){this.next=this.g=this.h=null}set(E,R){this.h=E,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let O,B=!1,M=new k,I=()=>{const g=Promise.resolve(void 0);O=()=>{g.then(N)}};function N(){for(var g;g=b();){try{g.h.call(g.g)}catch(R){T(R)}var E=A;E.j(g),E.h<100&&(E.h++,g.next=E.g,E.g=g)}B=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(g,E){this.type=g,this.g=this.target=E,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,E=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const R=()=>{};o.addEventListener("test",R,E),o.removeEventListener("test",R,E)}catch{}return g})();function D(g){return/^[\s\xa0]*$/.test(g)}function se(g,E){V.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,E)}p(se,V),se.prototype.init=function(g,E){const R=this.type=g.type,j=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=E,E=g.relatedTarget,E||(R=="mouseover"?E=g.fromElement:R=="mouseout"&&(E=g.toElement)),this.relatedTarget=E,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&se.Z.h.call(this)},se.prototype.h=function(){se.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var de="closure_listenable_"+(Math.random()*1e6|0),me=0;function ue(g,E,R,j,X){this.listener=g,this.proxy=null,this.src=E,this.type=R,this.capture=!!j,this.ha=X,this.key=++me,this.da=this.fa=!1}function J(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Z(g,E,R){for(const j in g)E.call(R,g[j],j,g)}function ne(g,E){for(const R in g)E.call(void 0,g[R],R,g)}function G(g){const E={};for(const R in g)E[R]=g[R];return E}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(g,E){let R,j;for(let X=1;X<arguments.length;X++){j=arguments[X];for(R in j)g[R]=j[R];for(let te=0;te<$.length;te++)R=$[te],Object.prototype.hasOwnProperty.call(j,R)&&(g[R]=j[R])}}function fe(g){this.src=g,this.g={},this.h=0}fe.prototype.add=function(g,E,R,j,X){const te=g.toString();g=this.g[te],g||(g=this.g[te]=[],this.h++);const ge=Ie(g,E,j,X);return ge>-1?(E=g[ge],R||(E.fa=!1)):(E=new ue(E,this.src,te,!!j,X),E.fa=R,g.push(E)),E};function ye(g,E){const R=E.type;if(R in g.g){var j=g.g[R],X=Array.prototype.indexOf.call(j,E,void 0),te;(te=X>=0)&&Array.prototype.splice.call(j,X,1),te&&(J(E),g.g[R].length==0&&(delete g.g[R],g.h--))}}function Ie(g,E,R,j){for(let X=0;X<g.length;++X){const te=g[X];if(!te.da&&te.listener==E&&te.capture==!!R&&te.ha==j)return X}return-1}var Re="closure_lm_"+(Math.random()*1e6|0),Me={};function Ge(g,E,R,j,X){if(Array.isArray(E)){for(let te=0;te<E.length;te++)Ge(g,E[te],R,j,X);return null}return R=Pi(R),g&&g[de]?g.J(E,R,l(j)?!!j.capture:!1,X):ct(g,E,R,!1,j,X)}function ct(g,E,R,j,X,te){if(!E)throw Error("Invalid event type");const ge=l(X)?!!X.capture:!!X;let ze=dn(g);if(ze||(g[Re]=ze=new fe(g)),R=ze.add(E,R,j,ge,te),R.proxy)return R;if(j=tr(),R.proxy=j,j.src=g,j.listener=R,g.addEventListener)U||(X=ge),X===void 0&&(X=!1),g.addEventListener(E.toString(),j,X);else if(g.attachEvent)g.attachEvent(Kn(E.toString()),j);else if(g.addListener&&g.removeListener)g.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return R}function tr(){function g(R){return E.call(g.src,g.listener,R)}const E=hn;return g}function ps(g,E,R,j,X){if(Array.isArray(E))for(var te=0;te<E.length;te++)ps(g,E[te],R,j,X);else j=l(j)?!!j.capture:!!j,R=Pi(R),g&&g[de]?(g=g.i,te=String(E).toString(),te in g.g&&(E=g.g[te],R=Ie(E,R,j,X),R>-1&&(J(E[R]),Array.prototype.splice.call(E,R,1),E.length==0&&(delete g.g[te],g.h--)))):g&&(g=dn(g))&&(E=g.g[E.toString()],g=-1,E&&(g=Ie(E,R,j,X)),(R=g>-1?E[g]:null)&&Hn(R))}function Hn(g){if(typeof g!="number"&&g&&!g.da){var E=g.src;if(E&&E[de])ye(E.i,g);else{var R=g.type,j=g.proxy;E.removeEventListener?E.removeEventListener(R,j,g.capture):E.detachEvent?E.detachEvent(Kn(R),j):E.addListener&&E.removeListener&&E.removeListener(j),(R=dn(E))?(ye(R,g),R.h==0&&(R.src=null,E[Re]=null)):J(g)}}}function Kn(g){return g in Me?Me[g]:Me[g]="on"+g}function hn(g,E){if(g.da)g=!0;else{E=new se(E,this);const R=g.listener,j=g.ha||g.src;g.fa&&Hn(g),g=R.call(j,E)}return g}function dn(g){return g=g[Re],g instanceof fe?g:null}var qn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Pi(g){return typeof g=="function"?g:(g[qn]||(g[qn]=function(E){return g.handleEvent(E)}),g[qn])}function _t(){F.call(this),this.i=new fe(this),this.M=this,this.G=null}p(_t,F),_t.prototype[de]=!0,_t.prototype.removeEventListener=function(g,E,R,j){ps(this,g,E,R,j)};function ut(g,E){var R,j=g.G;if(j)for(R=[];j;j=j.G)R.push(j);if(g=g.M,j=E.type||E,typeof E=="string")E=new V(E,g);else if(E instanceof V)E.target=E.target||g;else{var X=E;E=new V(j,g),ie(E,X)}X=!0;let te,ge;if(R)for(ge=R.length-1;ge>=0;ge--)te=E.g=R[ge],X=nn(te,j,!0,E)&&X;if(te=E.g=g,X=nn(te,j,!0,E)&&X,X=nn(te,j,!1,E)&&X,R)for(ge=0;ge<R.length;ge++)te=E.g=R[ge],X=nn(te,j,!1,E)&&X}_t.prototype.N=function(){if(_t.Z.N.call(this),this.i){var g=this.i;for(const E in g.g){const R=g.g[E];for(let j=0;j<R.length;j++)J(R[j]);delete g.g[E],g.h--}}this.G=null},_t.prototype.J=function(g,E,R,j){return this.i.add(String(g),E,!1,R,j)},_t.prototype.K=function(g,E,R,j){return this.i.add(String(g),E,!0,R,j)};function nn(g,E,R,j){if(E=g.i.g[String(E)],!E)return!0;E=E.concat();let X=!0;for(let te=0;te<E.length;++te){const ge=E[te];if(ge&&!ge.da&&ge.capture==R){const ze=ge.listener,Vt=ge.ha||ge.src;ge.fa&&ye(g.i,ge),X=ze.call(Vt,j)!==!1&&X}}return X&&!j.defaultPrevented}function ki(g,E){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:o.setTimeout(g,E||0)}function It(g){g.g=ki(()=>{g.g=null,g.i&&(g.i=!1,It(g))},g.l);const E=g.h;g.h=null,g.m.apply(null,E)}class io extends F{constructor(E,R){super(),this.m=E,this.l=R,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ni(g){F.call(this),this.h=g,this.g={}}p(Ni,F);var Ar=[];function nr(g){Z(g.g,function(E,R){this.g.hasOwnProperty(R)&&Hn(E)},g),g.g={}}Ni.prototype.N=function(){Ni.Z.N.call(this),nr(this)},Ni.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pr=o.JSON.stringify,ua=o.JSON.parse,kr=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function Di(){}function Ol(){}var Nr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ms(){V.call(this,"d")}p(ms,V);function ro(){V.call(this,"c")}p(ro,V);var Fn={},ys=null;function Dr(){return ys=ys||new _t}Fn.Ia="serverreachability";function Mr(g){V.call(this,Fn.Ia,g)}p(Mr,V);function Vn(g){const E=Dr();ut(E,new Mr(E))}Fn.STAT_EVENT="statevent";function zn(g,E){V.call(this,Fn.STAT_EVENT,g),this.stat=E}p(zn,V);function gt(g){const E=Dr();ut(E,new zn(E,g))}Fn.Ja="timingevent";function so(g,E){V.call(this,Fn.Ja,g),this.size=E}p(so,V);function ir(g,E){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},E)}function jt(){this.g=!0}jt.prototype.ua=function(){this.g=!1};function Mi(g,E,R,j,X,te){g.info(function(){if(g.g)if(te){var ge="",ze=te.split("&");for(let ht=0;ht<ze.length;ht++){var Vt=ze[ht].split("=");if(Vt.length>1){const Wt=Vt[0];Vt=Vt[1];const _i=Wt.split("_");ge=_i.length>=2&&_i[1]=="type"?ge+(Wt+"="+Vt+"&"):ge+(Wt+"=redacted&")}}}else ge=null;else ge=te;return"XMLHTTP REQ ("+j+") [attempt "+X+"]: "+E+`
`+R+`
`+ge})}function fn(g,E,R,j,X,te,ge){g.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+X+"]: "+E+`
`+R+`
`+te+" "+ge})}function Ft(g,E,R,j){g.info(function(){return"XMLHTTP TEXT ("+E+"): "+pn(g,R)+(j?" "+j:"")})}function gn(g,E){g.info(function(){return"TIMEOUT: "+E})}jt.prototype.info=function(){};function pn(g,E){if(!g.g)return E;if(!E)return null;try{const te=JSON.parse(E);if(te){for(g=0;g<te.length;g++)if(Array.isArray(te[g])){var R=te[g];if(!(R.length<2)){var j=R[1];if(Array.isArray(j)&&!(j.length<1)){var X=j[0];if(X!="noop"&&X!="stop"&&X!="close")for(let ge=1;ge<j.length;ge++)j[ge]=""}}}}return Pr(te)}catch{return E}}var rn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Gt;function Xt(){}p(Xt,Di),Xt.prototype.g=function(){return new XMLHttpRequest},Gt=new Xt;function Li(g){return encodeURIComponent(String(g))}function jl(g){var E=1;g=g.split(":");const R=[];for(;E>0&&g.length;)R.push(g.shift()),E--;return g.length&&R.push(g.join(":")),R}function Oi(g,E,R,j){this.j=g,this.i=E,this.l=R,this.S=j||1,this.V=new Ni(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Cf}function Cf(){this.i=null,this.g="",this.h=!1}var Rf={},zu={};function rr(g,E,R){g.M=1,g.A=vs(ji(E)),g.u=R,g.R=!0,Uu(g,null)}function Uu(g,E){g.F=Date.now(),ha(g),g.B=ji(g.A);var R=g.B,j=g.S;Array.isArray(j)||(j=[String(j)]),Zu(R.i,"t",j),g.C=0,R=g.j.L,g.h=new Cf,g.g=jf(g.j,R?E:null,!g.u),g.P>0&&(g.O=new io(h(g.Y,g,g.g),g.P)),E=g.V,R=g.g,j=g.ba;var X="readystatechange";Array.isArray(X)||(X&&(Ar[0]=X.toString()),X=Ar);for(let te=0;te<X.length;te++){const ge=Ge(R,X[te],j||E.handleEvent,!1,E.h||E);if(!ge)break;E.g[ge.key]=ge}E=g.J?G(g.J):{},g.u?(g.v||(g.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,E)):(g.v="GET",g.g.ea(g.B,g.v,null,E)),Vn(),Mi(g.i,g.v,g.B,g.l,g.S,g.u)}Oi.prototype.ba=function(g){g=g.target;const E=this.O;E&&Ur(g)==3?E.j():this.Y(g)},Oi.prototype.Y=function(g){try{if(g==this.g)e:{const ze=Ur(this.g),Vt=this.g.ya(),ht=this.g.ca();if(!(ze<3)&&(ze!=3||this.g&&(this.h.h||this.g.la()||Lf(this.g)))){this.K||ze!=4||Vt==7||(Vt==8||ht<=0?Vn(3):Vn(2)),Fl(this);var E=this.g.ca();this.X=E;var R=bf(this);if(this.o=E==200,fn(this.i,this.v,this.B,this.l,this.S,ze,E),this.o){if(this.U&&!this.L){t:{if(this.g){var j,X=this.g;if((j=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(j)){var te=j;break t}}te=null}if(g=te)Ft(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,xt(this,g);else{this.o=!1,this.m=3,gt(12),_s(this),da(this);break e}}if(this.R){g=!0;let Wt;for(;!this.K&&this.C<R.length;)if(Wt=Pf(this,R),Wt==zu){ze==4&&(this.m=4,gt(14),g=!1),Ft(this.i,this.l,null,"[Incomplete Response]");break}else if(Wt==Rf){this.m=4,gt(15),Ft(this.i,this.l,R,"[Invalid Chunk]"),g=!1;break}else Ft(this.i,this.l,Wt,null),xt(this,Wt);if(Af(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ze!=4||R.length!=0||this.h.h||(this.m=1,gt(16),g=!1),this.o=this.o&&g,!g)Ft(this.i,this.l,R,"[Invalid Chunked Response]"),_s(this),da(this);else if(R.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),wa(ge),ge.P=!0,gt(11))}}else Ft(this.i,this.l,R,null),xt(this,R);ze==4&&_s(this),this.o&&!this.K&&(ze==4?ql(this.j,this):(this.o=!1,ha(this)))}else Ju(this.g),E==400&&R.indexOf("Unknown SID")>0?(this.m=3,gt(12)):(this.m=0,gt(13)),_s(this),da(this)}}}catch{}};function bf(g){if(!Af(g))return g.g.la();const E=Lf(g.g);if(E==="")return"";let R="";const j=E.length,X=Ur(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return _s(g),da(g),"";g.h.i=new o.TextDecoder}for(let te=0;te<j;te++)g.h.h=!0,R+=g.h.i.decode(E[te],{stream:!(X&&te==j-1)});return E.length=0,g.h.g+=R,g.C=0,g.h.g}function Af(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Pf(g,E){var R=g.C,j=E.indexOf(`
`,R);return j==-1?zu:(R=Number(E.substring(R,j)),isNaN(R)?Rf:(j+=1,j+R>E.length?zu:(E=E.slice(j,j+R),g.C=j+R,E)))}Oi.prototype.cancel=function(){this.K=!0,_s(this)};function ha(g){g.T=Date.now()+g.H,Bu(g,g.H)}function Bu(g,E){if(g.D!=null)throw Error("WatchDog timer not null");g.D=ir(h(g.aa,g),E)}function Fl(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Oi.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(gn(this.i,this.B),this.M!=2&&(Vn(),gt(17)),_s(this),this.m=2,da(this)):Bu(this,this.T-g)};function da(g){g.j.I==0||g.K||ql(g.j,g)}function _s(g){Fl(g);var E=g.O;E&&typeof E.dispose=="function"&&E.dispose(),g.O=null,nr(g.V),g.g&&(E=g.g,g.g=null,E.abort(),E.dispose())}function xt(g,E){try{var R=g.j;if(R.I!=0&&(R.g==g||Wu(R.h,g))){if(!g.L&&Wu(R.h,g)&&R.I==3){try{var j=R.Ba.g.parse(E)}catch{j=null}if(Array.isArray(j)&&j.length==3){var X=j;if(X[0]==0){e:if(!R.v){if(R.g)if(R.g.F+3e3<g.F)Kl(R),mi(R);else break e;Wr(R),gt(18)}}else R.xa=X[1],0<R.xa-R.K&&X[2]<37500&&R.F&&R.A==0&&!R.C&&(R.C=ir(h(R.Va,R),6e3));fa(R.h)<=1&&R.ta&&(R.ta=void 0)}else yi(R,11)}else if((g.L||R.g==g)&&Kl(R),!D(E))for(X=R.Ba.g.parse(E),E=0;E<X.length;E++){let ht=X[E];const Wt=ht[0];if(!(Wt<=R.K))if(R.K=Wt,ht=ht[1],R.I==2)if(ht[0]=="c"){R.M=ht[1],R.ba=ht[2];const _i=ht[3];_i!=null&&(R.ka=_i,R.j.info("VER="+R.ka));const Ss=ht[4];Ss!=null&&(R.za=Ss,R.j.info("SVER="+R.za));const $r=ht[5];$r!=null&&typeof $r=="number"&&$r>0&&(j=1.5*$r,R.O=j,R.j.info("backChannelRequestTimeoutMs_="+j)),j=R;const Hr=g.g;if(Hr){const Zl=Hr.g?Hr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zl){var te=j.h;te.g||Zl.indexOf("spdy")==-1&&Zl.indexOf("quic")==-1&&Zl.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(zl(te,te.h),te.h=null))}if(j.G){const nh=Hr.g?Hr.g.getResponseHeader("X-HTTP-Session-Id"):null;nh&&(j.wa=nh,st(j.J,j.G,nh))}}R.I=3,R.l&&R.l.ra(),R.aa&&(R.T=Date.now()-g.F,R.j.info("Handshake RTT: "+R.T+"ms")),j=R;var ge=g;if(j.na=th(j,j.L?j.ba:null,j.W),ge.L){ga(j.h,ge);var ze=ge,Vt=j.O;Vt&&(ze.H=Vt),ze.D&&(Fl(ze),ha(ze)),j.g=ge}else Cn(j);R.i.length>0&&Ts(R)}else ht[0]!="stop"&&ht[0]!="close"||yi(R,7);else R.I==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?yi(R,7):$l(R):ht[0]!="noop"&&R.l&&R.l.qa(ht),R.A=0)}}Vn(4)}catch{}}var Ry=class{constructor(g,E){this.g=g,this.map=E}};function Vl(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Gu(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function fa(g){return g.h?1:g.g?g.g.size:0}function Wu(g,E){return g.h?g.h==E:g.g?g.g.has(E):!1}function zl(g,E){g.g?g.g.add(E):g.h=E}function ga(g,E){g.h&&g.h==E?g.h=null:g.g&&g.g.has(E)&&g.g.delete(E)}Vl.prototype.cancel=function(){if(this.i=fi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function fi(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let E=g.i;for(const R of g.g.values())E=E.concat(R.G);return E}return x(g.i)}var kf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gi(g,E){if(g){g=g.split("&");for(let R=0;R<g.length;R++){const j=g[R].indexOf("=");let X,te=null;j>=0?(X=g[R].substring(0,j),te=g[R].substring(j+1)):X=g[R],E(X,te?decodeURIComponent(te.replace(/\+/g," ")):"")}}}function Lr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;g instanceof Lr?(this.l=g.l,pa(this,g.j),this.o=g.o,this.g=g.g,Or(this,g.u),this.h=g.h,oo(this,Qu(g.i)),this.m=g.m):g&&(E=String(g).match(kf))?(this.l=!1,pa(this,E[1]||"",!0),this.o=ma(E[2]||""),this.g=ma(E[3]||"",!0),Or(this,E[4]),this.h=ma(E[5]||"",!0),oo(this,E[6]||"",!0),this.m=ma(E[7]||"")):(this.l=!1,this.i=new qe(null,this.l))}Lr.prototype.toString=function(){const g=[];var E=this.j;E&&g.push(ya(E,Hu,!0),":");var R=this.g;return(R||E=="file")&&(g.push("//"),(E=this.o)&&g.push(ya(E,Hu,!0),"@"),g.push(Li(R).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.u,R!=null&&g.push(":",String(R))),(R=this.h)&&(this.g&&R.charAt(0)!="/"&&g.push("/"),g.push(ya(R,R.charAt(0)=="/"?_a:Ku,!0))),(R=this.i.toString())&&g.push("?",R),(R=this.m)&&g.push("#",ya(R,qu)),g.join("")},Lr.prototype.resolve=function(g){const E=ji(this);let R=!!g.j;R?pa(E,g.j):R=!!g.o,R?E.o=g.o:R=!!g.g,R?E.g=g.g:R=g.u!=null;var j=g.h;if(R)Or(E,g.u);else if(R=!!g.h){if(j.charAt(0)!="/")if(this.g&&!this.h)j="/"+j;else{var X=E.h.lastIndexOf("/");X!=-1&&(j=E.h.slice(0,X+1)+j)}if(X=j,X==".."||X==".")j="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){j=X.lastIndexOf("/",0)==0,X=X.split("/");const te=[];for(let ge=0;ge<X.length;){const ze=X[ge++];ze=="."?j&&ge==X.length&&te.push(""):ze==".."?((te.length>1||te.length==1&&te[0]!="")&&te.pop(),j&&ge==X.length&&te.push("")):(te.push(ze),j=!0)}j=te.join("/")}else j=X}return R?E.h=j:R=g.i.toString()!=="",R?oo(E,Qu(g.i)):R=!!g.m,R&&(E.m=g.m),E};function ji(g){return new Lr(g)}function pa(g,E,R){g.j=R?ma(E,!0):E,g.j&&(g.j=g.j.replace(/:$/,""))}function Or(g,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);g.u=E}else g.u=null}function oo(g,E,R){E instanceof qe?(g.i=E,Bl(g.i,g.l)):(R||(E=ya(E,by)),g.i=new qe(E,g.l))}function st(g,E,R){g.i.set(E,R)}function vs(g){return st(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function ma(g,E){return g?E?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ya(g,E,R){return typeof g=="string"?(g=encodeURI(g).replace(E,$u),R&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function $u(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Hu=/[#\/\?@]/g,Ku=/[#\?:]/g,_a=/[#\?]/g,by=/[#\?@]/g,qu=/#/g;function qe(g,E){this.h=this.g=null,this.i=g||null,this.j=!!E}function jr(g){g.g||(g.g=new Map,g.h=0,g.i&&gi(g.i,function(E,R){g.add(decodeURIComponent(E.replace(/\+/g," ")),R)}))}n=qe.prototype,n.add=function(g,E){jr(this),this.i=null,g=Fr(this,g);let R=this.g.get(g);return R||this.g.set(g,R=[]),R.push(E),this.h+=1,this};function Xu(g,E){jr(g),E=Fr(g,E),g.g.has(E)&&(g.i=null,g.h-=g.g.get(E).length,g.g.delete(E))}function Ul(g,E){return jr(g),E=Fr(g,E),g.g.has(E)}n.forEach=function(g,E){jr(this),this.g.forEach(function(R,j){R.forEach(function(X){g.call(E,X,j,this)},this)},this)};function Yu(g,E){jr(g);let R=[];if(typeof E=="string")Ul(g,E)&&(R=R.concat(g.g.get(Fr(g,E))));else for(g=Array.from(g.g.values()),E=0;E<g.length;E++)R=R.concat(g[E]);return R}n.set=function(g,E){return jr(this),this.i=null,g=Fr(this,g),Ul(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[E]),this.h+=1,this},n.get=function(g,E){return g?(g=Yu(this,g),g.length>0?String(g[0]):E):E};function Zu(g,E,R){Xu(g,E),R.length>0&&(g.i=null,g.g.set(Fr(g,E),x(R)),g.h+=R.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],E=Array.from(this.g.keys());for(let j=0;j<E.length;j++){var R=E[j];const X=Li(R);R=Yu(this,R);for(let te=0;te<R.length;te++){let ge=X;R[te]!==""&&(ge+="="+Li(R[te])),g.push(ge)}}return this.i=g.join("&")};function Qu(g){const E=new qe;return E.i=g.i,g.g&&(E.g=new Map(g.g),E.h=g.h),E}function Fr(g,E){return E=String(E),g.j&&(E=E.toLowerCase()),E}function Bl(g,E){E&&!g.j&&(jr(g),g.i=null,g.g.forEach(function(R,j){const X=j.toLowerCase();j!=X&&(Xu(this,j),Zu(this,X,R))},g)),g.j=E}function Vr(g,E){const R=new jt;if(o.Image){const j=new Image;j.onload=f(mn,R,"TestLoadImage: loaded",!0,E,j),j.onerror=f(mn,R,"TestLoadImage: error",!1,E,j),j.onabort=f(mn,R,"TestLoadImage: abort",!1,E,j),j.ontimeout=f(mn,R,"TestLoadImage: timeout",!1,E,j),o.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=g}else E(!1)}function zr(g,E){const R=new jt,j=new AbortController,X=setTimeout(()=>{j.abort(),mn(R,"TestPingServer: timeout",!1,E)},1e4);fetch(g,{signal:j.signal}).then(te=>{clearTimeout(X),te.ok?mn(R,"TestPingServer: ok",!0,E):mn(R,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(X),mn(R,"TestPingServer: error",!1,E)})}function mn(g,E,R,j,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),j(R)}catch{}}function va(){this.g=new kr}function xs(g){this.i=g.Sb||null,this.h=g.ab||!1}p(xs,Di),xs.prototype.g=function(){return new pi(this.i,this.h)};function pi(g,E){_t.call(this),this.H=g,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(pi,_t),n=pi.prototype,n.open=function(g,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=E,this.readyState=1,sr(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(E.body=g),(this.H||o).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,sr(this)),this.g&&(this.readyState=3,sr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Nf(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Nf(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var E=g.value?g.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!g.done}))&&(this.response=this.responseText+=E)}g.done?ao(this):sr(this),this.readyState==3&&Nf(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,ao(this))},n.Na=function(g){this.g&&(this.response=g,ao(this))},n.ga=function(){this.g&&ao(this)};function ao(g){g.readyState=4,g.l=null,g.j=null,g.B=null,sr(g)}n.setRequestHeader=function(g,E){this.A.append(g,E)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],E=this.h.entries();for(var R=E.next();!R.done;)R=R.value,g.push(R[0]+": "+R[1]),R=E.next();return g.join(`\r
`)};function sr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(pi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Df(g){let E="";return Z(g,function(R,j){E+=j,E+=":",E+=R,E+=`\r
`}),E}function Gl(g,E,R){e:{for(j in R){var j=!1;break e}j=!0}j||(R=Df(R),typeof g=="string"?R!=null&&Li(R):st(g,E,R))}function mt(g){_t.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(mt,_t);var Mf=/^https?$/i,Ay=["POST","PUT"];n=mt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,E,R,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);E=E?E.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Gt.g(),this.g.onreadystatechange=_(h(this.Ca,this));try{this.B=!0,this.g.open(E,String(g),!0),this.B=!1}catch(te){lo(this,te);return}if(g=R||"",R=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var X in j)R.set(X,j[X]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const te of j.keys())R.set(te,j.get(te));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(R.keys()).find(te=>te.toLowerCase()=="content-type"),X=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(Ay,E,void 0)>=0)||j||X||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,ge]of R)this.g.setRequestHeader(te,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(te){lo(this,te)}};function lo(g,E){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=E,g.o=5,co(g),Es(g)}function co(g){g.A||(g.A=!0,ut(g,"complete"),ut(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ut(this,"complete"),ut(this,"abort"),Es(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Es(this,!0)),mt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ws(this):this.Xa())},n.Xa=function(){ws(this)};function ws(g){if(g.h&&typeof s<"u"){if(g.v&&Ur(g)==4)setTimeout(g.Ca.bind(g),0);else if(ut(g,"readystatechange"),Ur(g)==4){g.h=!1;try{const te=g.ca();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var R;if(!(R=E)){var j;if(j=te===0){let ge=String(g.D).match(kf)[1]||null;!ge&&o.self&&o.self.location&&(ge=o.self.location.protocol.slice(0,-1)),j=!Mf.test(ge?ge.toLowerCase():"")}R=j}if(R)ut(g,"complete"),ut(g,"success");else{g.o=6;try{var X=Ur(g)>2?g.g.statusText:""}catch{X=""}g.l=X+" ["+g.ca()+"]",co(g)}}finally{Es(g)}}}}function Es(g,E){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const R=g.g;g.g=null,E||ut(g,"ready");try{R.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ur(g){return g.g?g.g.readyState:0}n.ca=function(){try{return Ur(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var E=this.g.responseText;return g&&E.indexOf(g)==0&&(E=E.substring(g.length)),ua(E)}};function Lf(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Ju(g){const E={};g=(g.g&&Ur(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<g.length;j++){if(D(g[j]))continue;var R=jl(g[j]);const X=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const te=E[X]||[];E[X]=te,te.push(R)}ne(E,function(j){return j.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Br(g,E,R){return R&&R.internalChannelParams&&R.internalChannelParams[g]||E}function Wl(g){this.za=0,this.i=[],this.j=new jt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Br("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Br("baseRetryDelayMs",5e3,g),this.Za=Br("retryDelaySeedMs",1e4,g),this.Ta=Br("forwardChannelMaxRetries",2,g),this.va=Br("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Vl(g&&g.concurrentRequestLimit),this.Ba=new va,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Wl.prototype,n.ka=8,n.I=1,n.connect=function(g,E,R,j){gt(0),this.W=g,this.H=E||{},R&&j!==void 0&&(this.H.OSID=R,this.H.OAID=j),this.F=this.X,this.J=th(this,null,this.W),Ts(this)};function $l(g){if(Hl(g),g.I==3){var E=g.V++,R=ji(g.J);if(st(R,"SID",g.M),st(R,"RID",E),st(R,"TYPE","terminate"),Gr(g,R),E=new Oi(g,g.j,E),E.M=2,E.A=vs(ji(R)),R=!1,o.navigator&&o.navigator.sendBeacon)try{R=o.navigator.sendBeacon(E.A.toString(),"")}catch{}!R&&o.Image&&(new Image().src=E.A,R=!0),R||(E.g=jf(E.j,null),E.g.ea(E.A)),E.F=Date.now(),ha(E)}Ea(g)}function mi(g){g.g&&(wa(g),g.g.cancel(),g.g=null)}function Hl(g){mi(g),g.v&&(o.clearTimeout(g.v),g.v=null),Kl(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function Ts(g){if(!Gu(g.h)&&!g.m){g.m=!0;var E=g.Ea;O||I(),B||(O(),B=!0),M.add(E,g),g.D=0}}function Of(g,E){return fa(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=E.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=ir(h(g.Ea,g,E),Xl(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const X=new Oi(this,this.j,g);let te=this.o;if(this.U&&(te?(te=G(te),ie(te,this.U)):te=this.U),this.u!==null||this.R||(X.J=te,te=null),this.S)e:{for(var E=0,R=0;R<this.i.length;R++){t:{var j=this.i[R];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(E+=j,E>4096){E=R;break e}if(E===4096||R===this.i.length-1){E=R+1;break e}}E=1e3}else E=1e3;E=eh(this,X,E),R=ji(this.J),st(R,"RID",g),st(R,"CVER",22),this.G&&st(R,"X-HTTP-Session-Id",this.G),Gr(this,R),te&&(this.R?E="headers="+Li(Df(te))+"&"+E:this.u&&Gl(R,this.u,te)),zl(this.h,X),this.Ra&&st(R,"TYPE","init"),this.S?(st(R,"$req",E),st(R,"SID","null"),X.U=!0,rr(X,R,null)):rr(X,R,E),this.I=2}}else this.I==3&&(g?xa(this,g):this.i.length==0||Gu(this.h)||xa(this))};function xa(g,E){var R;E?R=E.l:R=g.V++;const j=ji(g.J);st(j,"SID",g.M),st(j,"RID",R),st(j,"AID",g.K),Gr(g,j),g.u&&g.o&&Gl(j,g.u,g.o),R=new Oi(g,g.j,R,g.D+1),g.u===null&&(R.J=g.o),E&&(g.i=E.G.concat(g.i)),E=eh(g,R,1e3),R.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),zl(g.h,R),rr(R,j,E)}function Gr(g,E){g.H&&Z(g.H,function(R,j){st(E,j,R)}),g.l&&Z({},function(R,j){st(E,j,R)})}function eh(g,E,R){R=Math.min(g.i.length,R);const j=g.l?h(g.l.Ka,g.l,g):null;e:{var X=g.i;let ze=-1;for(;;){const Vt=["count="+R];ze==-1?R>0?(ze=X[0].g,Vt.push("ofs="+ze)):ze=0:Vt.push("ofs="+ze);let ht=!0;for(let Wt=0;Wt<R;Wt++){var te=X[Wt].g;const _i=X[Wt].map;if(te-=ze,te<0)ze=Math.max(0,X[Wt].g-100),ht=!1;else try{te="req"+te+"_"||"";try{var ge=_i instanceof Map?_i:Object.entries(_i);for(const[Ss,$r]of ge){let Hr=$r;l($r)&&(Hr=Pr($r)),Vt.push(te+Ss+"="+encodeURIComponent(Hr))}}catch(Ss){throw Vt.push(te+"type="+encodeURIComponent("_badmap")),Ss}}catch{j&&j(_i)}}if(ht){ge=Vt.join("&");break e}}ge=void 0}return g=g.i.splice(0,R),E.G=g,ge}function Cn(g){if(!g.g&&!g.v){g.Y=1;var E=g.Da;O||I(),B||(O(),B=!0),M.add(E,g),g.A=0}}function Wr(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=ir(h(g.Da,g),Xl(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,uo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=ir(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,gt(10),mi(this),uo(this))};function wa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function uo(g){g.g=new Oi(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var E=ji(g.na);st(E,"RID","rpc"),st(E,"SID",g.M),st(E,"AID",g.K),st(E,"CI",g.F?"0":"1"),!g.F&&g.ia&&st(E,"TO",g.ia),st(E,"TYPE","xmlhttp"),Gr(g,E),g.u&&g.o&&Gl(E,g.u,g.o),g.O&&(g.g.H=g.O);var R=g.g;g=g.ba,R.M=1,R.A=vs(ji(E)),R.u=null,R.R=!0,Uu(R,g)}n.Va=function(){this.C!=null&&(this.C=null,mi(this),Wr(this),gt(19))};function Kl(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function ql(g,E){var R=null;if(g.g==E){Kl(g),wa(g),g.g=null;var j=2}else if(Wu(g.h,E))R=E.G,ga(g.h,E),j=1;else return;if(g.I!=0){if(E.o)if(j==1){R=E.u?E.u.length:0,E=Date.now()-E.F;var X=g.D;j=Dr(),ut(j,new so(j,R)),Ts(g)}else Cn(g);else if(X=E.m,X==3||X==0&&E.X>0||!(j==1&&Of(g,E)||j==2&&Wr(g)))switch(R&&R.length>0&&(E=g.h,E.i=E.i.concat(R)),X){case 1:yi(g,5);break;case 4:yi(g,10);break;case 3:yi(g,6);break;default:yi(g,2)}}}function Xl(g,E){let R=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(R*=2),R*E}function yi(g,E){if(g.j.info("Error code "+E),E==2){var R=h(g.bb,g),j=g.Ua;const X=!j;j=new Lr(j||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||pa(j,"https"),vs(j),X?Vr(j.toString(),R):zr(j.toString(),R)}else gt(2);g.I=0,g.l&&g.l.pa(E),Ea(g),Hl(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Ea(g){if(g.I=0,g.ja=[],g.l){const E=fi(g.h);(E.length!=0||g.i.length!=0)&&(S(g.ja,E),S(g.ja,g.i),g.h.i.length=0,x(g.i),g.i.length=0),g.l.oa()}}function th(g,E,R){var j=R instanceof Lr?ji(R):new Lr(R);if(j.g!="")E&&(j.g=E+"."+j.g),Or(j,j.u);else{var X=o.location;j=X.protocol,E=E?E+"."+X.hostname:X.hostname,X=+X.port;const te=new Lr(null);j&&pa(te,j),E&&(te.g=E),X&&Or(te,X),R&&(te.h=R),j=te}return R=g.G,E=g.wa,R&&E&&st(j,R,E),st(j,"VER",g.ka),Gr(g,j),j}function jf(g,E,R){if(E&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=g.Aa&&!g.ma?new mt(new xs({ab:R})):new mt(g.ma),E.Fa(g.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ff(){}n=Ff.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Yl(){}Yl.prototype.g=function(g,E){return new yn(g,E)};function yn(g,E){_t.call(this),this.g=new Wl(E),this.l=g,this.h=E&&E.messageUrlParams||null,g=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(g?g["X-WebChannel-Content-Type"]=E.messageContentType:g={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(g?g["X-WebChannel-Client-Profile"]=E.sa:g={"X-WebChannel-Client-Profile":E.sa}),this.g.U=g,(g=E&&E.Qb)&&!D(g)&&(this.g.u=g),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!D(E)&&(this.g.G=E,g=this.h,g!==null&&E in g&&(g=this.h,E in g&&delete g[E])),this.j=new ho(this)}p(yn,_t),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){$l(this.g)},yn.prototype.o=function(g){var E=this.g;if(typeof g=="string"){var R={};R.__data__=g,g=R}else this.v&&(R={},R.__data__=Pr(g),g=R);E.i.push(new Ry(E.Ya++,g)),E.I==3&&Ts(E)},yn.prototype.N=function(){this.g.l=null,delete this.j,$l(this.g),delete this.g,yn.Z.N.call(this)};function Vf(g){ms.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var E=g.__sm__;if(E){e:{for(const R in E){g=R;break e}g=void 0}(this.i=g)&&(g=this.i,E=E!==null&&g in E?E[g]:void 0),this.data=E}else this.data=g}p(Vf,ms);function zf(){ro.call(this),this.status=1}p(zf,ro);function ho(g){this.g=g}p(ho,Ff),ho.prototype.ra=function(){ut(this.g,"a")},ho.prototype.qa=function(g){ut(this.g,new Vf(g))},ho.prototype.pa=function(g){ut(this.g,new zf)},ho.prototype.oa=function(){ut(this.g,"b")},Yl.prototype.createWebChannel=Yl.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,Kk=function(){return new Yl},Hk=function(){return Dr()},$k=Fn,ix={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},rn.NO_ERROR=0,rn.TIMEOUT=8,rn.HTTP_ERROR=6,xp=rn,rt.COMPLETE="complete",Wk=rt,Ol.EventType=Nr,Nr.OPEN="a",Nr.CLOSE="b",Nr.ERROR="c",Nr.MESSAGE="d",_t.prototype.listen=_t.prototype.J,Zh=Ol,mt.prototype.listenOnce=mt.prototype.K,mt.prototype.getLastError=mt.prototype.Ha,mt.prototype.getLastErrorCode=mt.prototype.ya,mt.prototype.getStatus=mt.prototype.ca,mt.prototype.getResponseJson=mt.prototype.La,mt.prototype.getResponseText=mt.prototype.la,mt.prototype.send=mt.prototype.ea,mt.prototype.setWithCredentials=mt.prototype.Fa,Gk=mt}).apply(typeof Jg<"u"?Jg:typeof self<"u"?self:typeof window<"u"?window:{});const mR="@firebase/firestore",yR="4.9.3";let wn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};wn.UNAUTHENTICATED=new wn(null),wn.GOOGLE_CREDENTIALS=new wn("google-credentials-uid"),wn.FIRST_PARTY=new wn("first-party-uid"),wn.MOCK_USER=new wn("mock-user");let Fu="12.7.0";const Sl=new ew("@firebase/firestore");function Oc(){return Sl.logLevel}function pe(n,...e){if(Sl.logLevel<=Ke.DEBUG){const t=e.map(gw);Sl.debug(`Firestore (${Fu}): ${n}`,...t)}}function Si(n,...e){if(Sl.logLevel<=Ke.ERROR){const t=e.map(gw);Sl.error(`Firestore (${Fu}): ${n}`,...t)}}function oy(n,...e){if(Sl.logLevel<=Ke.WARN){const t=e.map(gw);Sl.warn(`Firestore (${Fu}): ${n}`,...t)}}function gw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Pe(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,qk(n,i,t)}function qk(n,e,t){let i=`FIRESTORE (${Fu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Si(i),new Error(i)}function Le(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||qk(e,r,i)}function St(n,e){return n}const le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends fs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class cl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Xk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class F8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(wn.UNAUTHENTICATED)))}shutdown(){}}class V8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class z8{constructor(e){this.t=e,this.currentUser=wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Le(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new cl;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new cl,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},l=u=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new cl)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Le(typeof i.accessToken=="string",31837,{l:i}),new Xk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Le(e===null||typeof e=="string",2055,{h:e}),new wn(e)}}class U8{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class B8{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new U8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(wn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class _R{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class G8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Le(this.o===void 0,3512);const i=s=>{s.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,pe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new _R(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Le(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new _R(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function W8(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Yk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=W8(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function He(n,e){return n<e?-1:n>e?1:0}function rx(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return Q_(r)===Q_(s)?He(r,s):Q_(r)?1:-1}return He(n.length,e.length)}const $8=55296,H8=57343;function Q_(n){const e=n.charCodeAt(0);return e>=$8&&e<=H8}function yu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function Zk(n){return n+"\0"}const vR="__name__";class Zr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Pe(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Pe(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Zr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Zr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Zr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return He(e.length,t.length)}static compareSegments(e,t){const i=Zr.isNumericId(e),r=Zr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Zr.extractNumericId(e).compare(Zr.extractNumericId(t)):rx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return fw.fromString(e.substring(4,e.length-2))}}class Rt extends Zr{construct(e,t,i){return new Rt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Se(le.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Rt(t)}static emptyPath(){return new Rt([])}}const K8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bt extends Zr{construct(e,t,i){return new Bt(e,t,i)}static isValidIdentifier(e){return K8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===vR}static keyField(){return new Bt([vR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Se(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Se(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Se(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new Se(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bt(t)}static emptyPath(){return new Bt([])}}class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(Rt.fromString(e))}static fromName(e){return new Ee(Rt.fromString(e).popFirst(5))}static empty(){return new Ee(Rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Rt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new Rt(e.slice()))}}function q8(n,e,t,i){if(e===!0&&i===!0)throw new Se(le.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function X8(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Y8(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Pe(12329,{type:typeof n})}function Qk(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Se(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Y8(n);throw new Se(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function qt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ef(n,e){if(!X8(n))throw new Se(le.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Se(le.INVALID_ARGUMENT,t);return!0}const xR=-62135596800,wR=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*wR);return new kt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Se(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Se(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<xR)throw new Se(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wR}_compareTo(e){return this.seconds===e.seconds?He(this.nanoseconds,e.nanoseconds):He(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ef(e,kt._jsonSchema))return new kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}kt._jsonSchemaVersion="firestore/timestamp/1.0",kt._jsonSchema={type:qt("string",kt._jsonSchemaVersion),seconds:qt("number"),nanoseconds:qt("number")};class Qe{static fromTimestamp(e){return new Qe(e)}static min(){return new Qe(new kt(0,0))}static max(){return new Qe(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const zd=-1;class cm{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function sx(n){return n.fields.find((e=>e.kind===2))}function Wa(n){return n.fields.filter((e=>e.kind!==2))}cm.UNKNOWN_ID=-1;class wp{constructor(e,t){this.fieldPath=e,this.kind=t}}class Ud{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ud(0,Ai.min())}}function Z8(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Qe.fromTimestamp(i===1e9?new kt(t+1,0):new kt(t,i));return new Ai(r,Ee.empty(),e)}function Jk(n){return new Ai(n.readTime,n.key,zd)}class Ai{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ai(Qe.min(),Ee.empty(),zd)}static max(){return new Ai(Qe.max(),Ee.empty(),zd)}}function pw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:He(n.largestBatchId,e.largestBatchId))}const eN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class tN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ay(n){if(n.code!==le.FAILED_PRECONDITION||n.message!==eN)throw n;pe("LocalStore","Unexpectedly lost primary lease")}class Q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Q(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Q?t:Q.resolve(t)}catch(t){return Q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Q.reject(t)}static resolve(e){return new Q(((t,i)=>{t(e)}))}static reject(e){return new Q(((t,i)=>{i(e)}))}static waitFor(e){return new Q(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=Q.resolve(!1);for(const i of e)t=t.next((r=>r?Q.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Q(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new Q(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const Ei="SimpleDb";class ly{static open(e,t,i,r){try{return new ly(t,e.transaction(r,i))}catch(s){throw new ad(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new cl,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ad(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=mw(i.target.error);this.S.reject(new ad(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(pe(Ei,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new J8(t)}}class Jo{static delete(e){return pe(Ei,"Removing database:",e),Ka(QP().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ak())return!1;if(Jo.F())return!0;const e=en(),t=Jo.M(e),i=0<t&&t<10,r=nN(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Jo.M(en())===12.2&&Si("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(pe(Ei,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new ad(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Se(le.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Se(le.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new ad(e,o))},r.onupgradeneeded=s=>{pe(Ei,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{pe(Ei,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=ly.open(this.db,e,s?"readonly":"readwrite",i),u=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),Q.reject(h)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,h=u.name!=="FirebaseError"&&o<3;if(pe(Ei,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function nN(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Q8{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ka(this.U.delete())}}class ad extends Se{constructor(e,t){super(le.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ll(n){return n.name==="IndexedDbTransactionError"}class J8{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(pe(Ei,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(pe(Ei,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ka(i)}add(e){return pe(Ei,"ADD",this.store.name,e,e),Ka(this.store.add(e))}get(e){return Ka(this.store.get(e)).next((t=>(t===void 0&&(t=null),pe(Ei,"GET",this.store.name,e,t),t)))}delete(e){return pe(Ei,"DELETE",this.store.name,e),Ka(this.store.delete(e))}count(){return pe(Ei,"COUNT",this.store.name),Ka(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Q(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Q(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){pe(Ei,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Q(((i,r)=>{t.onerror=s=>{const o=mw(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Q(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new Q8(l),h=t(l.primaryKey,l.value,u);if(h instanceof Q){const f=h.catch((p=>(u.done(),Q.reject(p))));i.push(f)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}})).next((()=>Q.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ka(n){return new Q(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=mw(i.target.error);t(r)}}))}let ER=!1;function mw(n){const e=Jo.M(en());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Se("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ER||(ER=!0,setTimeout((()=>{throw i}),0)),i}}return n}const ld="IndexBackfiller";class e7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){pe(ld,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();pe(ld,`Documents written: ${t}`)}catch(t){Ll(t)?pe(ld,"Ignoring IndexedDB error during index backfill: ",t):await ay(t)}await this.re(6e4)}))}}class t7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Q.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return pe(ld,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(pe(ld,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=Jk(s);pw(o,i)>0&&(i=o)})),new Ai(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class xr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}xr.ce=-1;const ul=-1;function cy(n){return n==null}function um(n){return n===0&&1/n==-1/0}const hm="";function $n(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=TR(e)),e=n7(n.get(t),e);return TR(e)}function n7(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case hm:t+="";break;default:t+=s}}return t}function TR(n){return n+hm+""}function ts(n){const e=n.length;if(Le(e>=2,64408,{path:n}),e===2)return Le(n.charAt(0)===hm&&n.charAt(1)==="",56145,{path:n}),Rt.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(hm,s);switch((o<0||o>t)&&Pe(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Pe(61167,{path:n})}s=o+2}return new Rt(i)}const $a="remoteDocuments",Tf="owner",Cc="owner",Bd="mutationQueues",i7="userId",gr="mutations",SR="batchId",il="userMutationsIndex",IR=["userId","batchId"];function Ep(n,e){return[n,$n(e)]}function iN(n,e,t){return[n,$n(e),t]}const r7={},_u="documentMutations",dm="remoteDocumentsV14",s7=["prefixPath","collectionGroup","readTime","documentId"],Tp="documentKeyIndex",o7=["prefixPath","collectionGroup","documentId"],rN="collectionGroupIndex",a7=["collectionGroup","readTime","prefixPath","documentId"],Gd="remoteDocumentGlobal",ox="remoteDocumentGlobalKey",vu="targets",sN="queryTargetsIndex",l7=["canonicalId","targetId"],xu="targetDocuments",c7=["targetId","path"],yw="documentTargetsIndex",u7=["path","targetId"],fm="targetGlobalKey",hl="targetGlobal",Wd="collectionParents",h7=["collectionId","parent"],wu="clientMetadata",d7="clientId",uy="bundles",f7="bundleId",hy="namedQueries",g7="name",_w="indexConfiguration",p7="indexId",ax="collectionGroupIndex",m7="collectionGroup",cd="indexState",y7=["indexId","uid"],oN="sequenceNumberIndex",_7=["uid","sequenceNumber"],ud="indexEntries",v7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],aN="documentKeyIndex",x7=["indexId","uid","orderedDocumentKey"],dy="documentOverlays",w7=["userId","collectionPath","documentId"],lx="collectionPathOverlayIndex",E7=["userId","collectionPath","largestBatchId"],lN="collectionGroupOverlayIndex",T7=["userId","collectionGroup","largestBatchId"],vw="globals",S7="name",cN=[Bd,gr,_u,$a,vu,Tf,hl,xu,wu,Gd,Wd,uy,hy],I7=[...cN,dy],uN=[Bd,gr,_u,dm,vu,Tf,hl,xu,wu,Gd,Wd,uy,hy,dy],hN=uN,xw=[...hN,_w,cd,ud],C7=xw,dN=[...xw,vw],R7=dN;class cx extends tN{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function tn(n,e){const t=St(n);return Jo.O(t.le,e)}function CR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ww(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function b7(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ui{constructor(e,t){this.comparator=e,this.root=t||En.EMPTY}insert(e,t){return new ui(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new ui(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ep(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ep(this.root,e,this.comparator,!1)}getReverseIterator(){return new ep(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ep(this.root,e,this.comparator,!0)}}class ep{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??En.RED,this.left=r??En.EMPTY,this.right=s??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new En(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return En.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Pe(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw Pe(57766)}get value(){throw Pe(16141)}get color(){throw Pe(16727)}get left(){throw Pe(29726)}get right(){throw Pe(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new En(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class yt{constructor(e){this.comparator=e,this.data=new ui(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new RR(this.data.getIterator())}getIteratorFrom(e){return new RR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof yt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new yt(this.comparator);return t.data=e,t}}class RR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Rc(n){return n.hasNext()?n.getNext():void 0}class Us{constructor(e){this.fields=e,e.sort(Bt.comparator)}static empty(){return new Us([])}unionWith(e){let t=new yt(Bt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Us(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return yu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class A7 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class hi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new A7("Invalid base64 string: "+s):s}})(e);return new hi(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new hi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return He(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}hi.EMPTY_BYTE_STRING=new hi("");const P7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ra(n){if(Le(!!n,39018),typeof n=="string"){let e=0;const t=P7.exec(n);if(Le(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Kt(n.seconds),nanos:Kt(n.nanos)}}function Kt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Eu(n){return typeof n=="string"?hi.fromBase64String(n):hi.fromUint8Array(n)}const fN="server_timestamp",gN="__type__",pN="__previous_value__",mN="__local_write_time__";function Ew(n){return(n?.mapValue?.fields||{})[gN]?.stringValue===fN}function yN(n){const e=n.mapValue.fields[pN];return Ew(e)?yN(e):e}function gm(n){const e=ra(n.mapValue.fields[mN].timestampValue);return new kt(e.seconds,e.nanos)}class k7{constructor(e,t,i,r,s,o,l,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const pm="(default)";class Tu{constructor(e,t){this.projectId=e,this.database=t||pm}static empty(){return new Tu("","")}get isDefaultDatabase(){return this.database===pm}isEqual(e){return e instanceof Tu&&e.projectId===this.projectId&&e.database===this.database}}const _N="__type__",vN="__max__",qo={mapValue:{fields:{__type__:{stringValue:vN}}}},xN="__vector__",mm="value",Sp={nullValue:"NULL_VALUE"};function Su(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ew(n)?4:wN(n)?9007199254740991:fy(n)?10:11:Pe(28295,{value:n})}function cs(n,e){if(n===e)return!0;const t=Su(n);if(t!==Su(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return gm(n).isEqual(gm(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ra(r.timestampValue),l=ra(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return Eu(r.bytesValue).isEqual(Eu(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Kt(r.geoPointValue.latitude)===Kt(s.geoPointValue.latitude)&&Kt(r.geoPointValue.longitude)===Kt(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Kt(r.integerValue)===Kt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Kt(r.doubleValue),l=Kt(s.doubleValue);return o===l?um(o)===um(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return yu(n.arrayValue.values||[],e.arrayValue.values||[],cs);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(CR(o)!==CR(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!cs(o[u],l[u])))return!1;return!0})(n,e);default:return Pe(52216,{left:n})}}function $d(n,e){return(n.values||[]).find((t=>cs(t,e)))!==void 0}function sa(n,e){if(n===e)return 0;const t=Su(n),i=Su(e);if(t!==i)return He(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return He(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=Kt(s.integerValue||s.doubleValue),u=Kt(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return bR(n.timestampValue,e.timestampValue);case 4:return bR(gm(n),gm(e));case 5:return rx(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=Eu(s),u=Eu(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=He(l[h],u[h]);if(f!==0)return f}return He(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=He(Kt(s.latitude),Kt(o.latitude));return l!==0?l:He(Kt(s.longitude),Kt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return AR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[mm]?.arrayValue,f=u[mm]?.arrayValue,p=He(h?.values?.length||0,f?.values?.length||0);return p!==0?p:AR(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===qo.mapValue&&o===qo.mapValue)return 0;if(s===qo.mapValue)return 1;if(o===qo.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const _=rx(u[p],f[p]);if(_!==0)return _;const x=sa(l[u[p]],h[f[p]]);if(x!==0)return x}return He(u.length,f.length)})(n.mapValue,e.mapValue);default:throw Pe(23264,{he:t})}}function bR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return He(n,e);const t=ra(n),i=ra(e),r=He(t.seconds,i.seconds);return r!==0?r:He(t.nanos,i.nanos)}function AR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=sa(t[r],i[r]);if(s)return s}return He(t.length,i.length)}function Iu(n){return ux(n)}function ux(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ra(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Eu(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ee.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=ux(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${ux(t.fields[o])}`;return r+"}"})(n.mapValue):Pe(61005,{value:n})}function Tw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function hx(n){return!!n&&"integerValue"in n}function Hd(n){return!!n&&"arrayValue"in n}function PR(n){return!!n&&"nullValue"in n}function kR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function J_(n){return!!n&&"mapValue"in n}function fy(n){return(n?.mapValue?.fields||{})[_N]?.stringValue===xN}function hd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ww(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=hd(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hd(n.arrayValue.values[t]);return e}return{...n}}function wN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===vN}const EN={mapValue:{fields:{[_N]:{stringValue:xN},[mm]:{arrayValue:{}}}}};function N7(n){return"nullValue"in n?Sp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Tw(Tu.empty(),Ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?fy(n)?EN:{mapValue:{}}:Pe(35942,{value:n})}function D7(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Tw(Tu.empty(),Ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?EN:"mapValue"in n?fy(n)?{mapValue:{}}:qo:Pe(61959,{value:n})}function NR(n,e){const t=sa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function DR(n,e){const t=sa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class _r{constructor(e){this.value=e}static empty(){return new _r({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!J_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hd(t)}setAll(e){let t=Bt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=hd(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());J_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return cs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];J_(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){ww(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new _r(hd(this.value))}}class Tn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Qe.min(),Qe.min(),Qe.min(),_r.empty(),0)}static newFoundDocument(e,t,i,r){return new Tn(e,1,t,Qe.min(),i,r,0)}static newNoDocument(e,t){return new Tn(e,2,t,Qe.min(),Qe.min(),_r.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Qe.min(),Qe.min(),_r.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_r.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_r.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Cu{constructor(e,t){this.position=e,this.inclusive=t}}function MR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Ee.comparator(Ee.fromName(o.referenceValue),t.key):i=sa(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function LR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!cs(n.position[t],e.position[t]))return!1;return!0}class ym{constructor(e,t="asc"){this.field=e,this.dir=t}}function M7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class TN{}class Ye extends TN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new L7(e,t,i):t==="array-contains"?new F7(e,i):t==="in"?new AN(e,i):t==="not-in"?new V7(e,i):t==="array-contains-any"?new z7(e,i):new Ye(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new O7(e,i):new j7(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(sa(t,this.value)):t!==null&&Su(this.value)===Su(t)&&this.matchesComparison(sa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pt extends TN{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new pt(e,t)}matches(e){return Ru(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ru(n){return n.op==="and"}function dx(n){return n.op==="or"}function Sw(n){return SN(n)&&Ru(n)}function SN(n){for(const e of n.filters)if(e instanceof pt)return!1;return!0}function fx(n){if(n instanceof Ye)return n.field.canonicalString()+n.op.toString()+Iu(n.value);if(Sw(n))return n.filters.map((e=>fx(e))).join(",");{const e=n.filters.map((t=>fx(t))).join(",");return`${n.op}(${e})`}}function IN(n,e){return n instanceof Ye?(function(i,r){return r instanceof Ye&&i.op===r.op&&i.field.isEqual(r.field)&&cs(i.value,r.value)})(n,e):n instanceof pt?(function(i,r){return r instanceof pt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&IN(o,r.filters[l])),!0):!1})(n,e):void Pe(19439)}function CN(n,e){const t=n.filters.concat(e);return pt.create(t,n.op)}function RN(n){return n instanceof Ye?(function(t){return`${t.field.canonicalString()} ${t.op} ${Iu(t.value)}`})(n):n instanceof pt?(function(t){return t.op.toString()+" {"+t.getFilters().map(RN).join(" ,")+"}"})(n):"Filter"}class L7 extends Ye{constructor(e,t,i){super(e,t,i),this.key=Ee.fromName(i.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class O7 extends Ye{constructor(e,t){super(e,"in",t),this.keys=bN("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class j7 extends Ye{constructor(e,t){super(e,"not-in",t),this.keys=bN("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function bN(n,e){return(e.arrayValue?.values||[]).map((t=>Ee.fromName(t.referenceValue)))}class F7 extends Ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Hd(t)&&$d(t.arrayValue,this.value)}}class AN extends Ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&$d(this.value.arrayValue,t)}}class V7 extends Ye{constructor(e,t){super(e,"not-in",t)}matches(e){if($d(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!$d(this.value.arrayValue,t)}}class z7 extends Ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Hd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>$d(this.value.arrayValue,i)))}}class U7{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function gx(n,e=null,t=[],i=[],r=null,s=null,o=null){return new U7(n,e,t,i,r,s,o)}function Il(n){const e=St(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>fx(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),cy(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Iu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Iu(i))).join(",")),e.Te=t}return e.Te}function Sf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!M7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!IN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!LR(n.startAt,e.startAt)&&LR(n.endAt,e.endAt)}function B7(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function _m(n,e){return n.filters.filter((t=>t instanceof Ye&&t.field.isEqual(e)))}function OR(n,e,t){let i=Sp,r=!0;for(const s of _m(n,e)){let o=Sp,l=!0;switch(s.op){case"<":case"<=":o=N7(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=Sp}NR({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];NR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function jR(n,e,t){let i=qo,r=!0;for(const s of _m(n,e)){let o=qo,l=!0;switch(s.op){case">=":case">":o=D7(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=qo}DR({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];DR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class gy{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function G7(n,e,t,i,r,s,o,l){return new gy(n,e,t,i,r,s,o,l)}function PN(n){return new gy(n)}function FR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function W7(n){return n.collectionGroup!==null}function dd(n){const e=St(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new yt(Bt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new ym(s,i))})),t.has(Bt.keyField().canonicalString())||e.Ie.push(new ym(Bt.keyField(),i))}return e.Ie}function Ks(n){const e=St(n);return e.Ee||(e.Ee=$7(e,dd(n))),e.Ee}function $7(n,e){if(n.limitType==="F")return gx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new ym(r.field,s)}));const t=n.endAt?new Cu(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Cu(n.startAt.position,n.startAt.inclusive):null;return gx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function px(n,e,t){return new gy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function kN(n,e){return Sf(Ks(n),Ks(e))&&n.limitType===e.limitType}function NN(n){return`${Il(Ks(n))}|lt:${n.limitType}`}function Lh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>RN(r))).join(", ")}]`),cy(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Iu(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Iu(r))).join(",")),`Target(${i})`})(Ks(n))}; limitType=${n.limitType})`}function py(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ee.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of dd(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,u){const h=MR(o,l,u);return o.inclusive?h<=0:h<0})(i.startAt,dd(i),r)||i.endAt&&!(function(o,l,u){const h=MR(o,l,u);return o.inclusive?h>=0:h>0})(i.endAt,dd(i),r))})(n,e)}function H7(n){return(e,t)=>{let i=!1;for(const r of dd(n)){const s=K7(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function K7(n,e,t){const i=n.field.isKeyField()?Ee.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?sa(u,h):Pe(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Pe(19790,{direction:n.dir})}}class ca{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ww(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return b7(this.inner)}size(){return this.innerSize}}const q7=new ui(Ee.comparator);function rl(){return q7}const DN=new ui(Ee.comparator);function tp(...n){let e=DN;for(const t of n)e=e.insert(t.key,t);return e}function X7(n){let e=DN;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function ns(){return fd()}function MN(){return fd()}function fd(){return new ca((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Y7=new ui(Ee.comparator),Z7=new yt(Ee.comparator);function Sn(...n){let e=Z7;for(const t of n)e=e.add(t);return e}const Q7=new yt(He);function J7(){return Q7}function eG(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:um(e)?"-0":e}}function tG(n){return{integerValue:""+n}}class my{constructor(){this._=void 0}}function nG(n,e,t){return n instanceof Kd?(function(r,s){const o={fields:{[gN]:{stringValue:fN},[mN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Ew(s)&&(s=yN(s)),s&&(o.fields[pN]=s),{mapValue:o}})(t,e):n instanceof bu?LN(n,e):n instanceof Au?ON(n,e):(function(r,s){const o=rG(r,s),l=VR(o)+VR(r.Ae);return hx(o)&&hx(r.Ae)?tG(l):eG(r.serializer,l)})(n,e)}function iG(n,e,t){return n instanceof bu?LN(n,e):n instanceof Au?ON(n,e):t}function rG(n,e){return n instanceof qd?(function(i){return hx(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class Kd extends my{}class bu extends my{constructor(e){super(),this.elements=e}}function LN(n,e){const t=jN(e);for(const i of n.elements)t.some((r=>cs(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Au extends my{constructor(e){super(),this.elements=e}}function ON(n,e){let t=jN(e);for(const i of n.elements)t=t.filter((r=>!cs(r,i)));return{arrayValue:{values:t}}}class qd extends my{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function VR(n){return Kt(n.integerValue||n.doubleValue)}function jN(n){return Hd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class sG{constructor(e,t){this.field=e,this.transform=t}}function oG(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof bu&&r instanceof bu||i instanceof Au&&r instanceof Au?yu(i.elements,r.elements,cs):i instanceof qd&&r instanceof qd?cs(i.Ae,r.Ae):i instanceof Kd&&r instanceof Kd})(n.transform,e.transform)}class aG{constructor(e,t){this.version=e,this.transformResults=t}}class wr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new wr}static exists(e){return new wr(void 0,e)}static updateTime(e){return new wr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ip(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class yy{}function FN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Iw(n.key,wr.none()):new If(n.key,n.data,wr.none());{const t=n.data,i=_r.empty();let r=new yt(Bt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Vu(n.key,i,new Us(r.toArray()),wr.none())}}function lG(n,e,t){n instanceof If?(function(r,s,o){const l=r.value.clone(),u=UR(r.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Vu?(function(r,s,o){if(!Ip(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=UR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(VN(r)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function gd(n,e,t,i){return n instanceof If?(function(s,o,l,u){if(!Ip(s.precondition,o))return l;const h=s.value.clone(),f=BR(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Vu?(function(s,o,l,u){if(!Ip(s.precondition,o))return l;const h=BR(s.fieldTransforms,u,o),f=o.data;return f.setAll(VN(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((p=>p.field)))})(n,e,t,i):(function(s,o,l){return Ip(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function zR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&yu(i,r,((s,o)=>oG(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class If extends yy{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Vu extends yy{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function VN(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function UR(n,e,t){const i=new Map;Le(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,iG(o,l,t[r]))}return i}function BR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,nG(s,o,e))}return i}class Iw extends yy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zN extends yy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Cw{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&lG(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=gd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=gd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=MN();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const u=FN(o,l);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Qe.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Sn())}isEqual(e){return this.batchId===e.batchId&&yu(this.mutations,e.mutations,((t,i)=>zR(t,i)))&&yu(this.baseMutations,e.baseMutations,((t,i)=>zR(t,i)))}}class Rw{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Le(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return Y7})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new Rw(e,t,i,r)}}class bw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var Ht,Ze;function cG(n){switch(n){case le.OK:return Pe(64938);case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0;default:return Pe(15467,{code:n})}}function uG(n){if(n===void 0)return Si("GRPC error has no .code"),le.UNKNOWN;switch(n){case Ht.OK:return le.OK;case Ht.CANCELLED:return le.CANCELLED;case Ht.UNKNOWN:return le.UNKNOWN;case Ht.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case Ht.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case Ht.INTERNAL:return le.INTERNAL;case Ht.UNAVAILABLE:return le.UNAVAILABLE;case Ht.UNAUTHENTICATED:return le.UNAUTHENTICATED;case Ht.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case Ht.NOT_FOUND:return le.NOT_FOUND;case Ht.ALREADY_EXISTS:return le.ALREADY_EXISTS;case Ht.PERMISSION_DENIED:return le.PERMISSION_DENIED;case Ht.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case Ht.ABORTED:return le.ABORTED;case Ht.OUT_OF_RANGE:return le.OUT_OF_RANGE;case Ht.UNIMPLEMENTED:return le.UNIMPLEMENTED;case Ht.DATA_LOSS:return le.DATA_LOSS;default:return Pe(39323,{code:n})}}(Ze=Ht||(Ht={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";new fw([4294967295,4294967295],0);const hG={asc:"ASCENDING",desc:"DESCENDING"},dG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fG={and:"AND",or:"OR"};class gG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function pG(n,e){return n.useProto3Json||cy(e)?e:{value:e}}function mx(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mG(n,e){return mx(n,e.toTimestamp())}function Ir(n){return Le(!!n,49232),Qe.fromTimestamp((function(t){const i=ra(t);return new kt(i.seconds,i.nanos)})(n))}function UN(n,e){return yx(n,e).canonicalString()}function yx(n,e){const t=(function(r){return new Rt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function BN(n){const e=Rt.fromString(n);return Le(CG(e),10190,{key:e.toString()}),e}function vm(n,e){return UN(n.databaseId,e.path)}function Cp(n,e){const t=BN(e);if(t.get(1)!==n.databaseId.projectId)throw new Se(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Se(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee($N(t))}function GN(n,e){return UN(n.databaseId,e)}function WN(n){const e=BN(n);return e.length===4?Rt.emptyPath():$N(e)}function yG(n){return new Rt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function $N(n){return Le(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function GR(n,e,t){return{name:vm(n,e),fields:t.value.mapValue.fields}}function _G(n,e,t){const i=Cp(n,e.name),r=Ir(e.updateTime),s=e.createTime?Ir(e.createTime):Qe.min(),o=new _r({mapValue:{fields:e.fields}}),l=Tn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function xm(n,e){let t;if(e instanceof If)t={update:GR(n,e.key,e.value)};else if(e instanceof Iw)t={delete:vm(n,e.key)};else if(e instanceof Vu)t={update:GR(n,e.key,e.data),updateMask:IG(e.fieldMask)};else{if(!(e instanceof zN))return Pe(16599,{Vt:e.type});t={verify:vm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof Kd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof bu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Au)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof qd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Pe(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:mG(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Pe(27497)})(n,e.precondition)),t}function _x(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?wr.updateTime(Ir(s.updateTime)):s.exists!==void 0?wr.exists(s.exists):wr.none()})(e.currentDocument):wr.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let u=null;if("setToServerValue"in l)Le(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new Kd;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new bu(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Au(f)}else"increment"in l?u=new qd(o,l.increment):Pe(16584,{proto:l});const h=Bt.fromServerFormat(l.fieldPath);return new sG(h,u)})(n,r))):[];if(e.update){e.update.name;const r=Cp(n,e.update.name),s=new _r({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new Us(h.map((f=>Bt.fromServerFormat(f))))})(e.updateMask);return new Vu(r,s,o,t,i)}return new If(r,s,t,i)}if(e.delete){const r=Cp(n,e.delete);return new Iw(r,t)}if(e.verify){const r=Cp(n,e.verify);return new zN(r,t)}return Pe(1463,{proto:e})}function vG(n,e){return n&&n.length>0?(Le(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Ir(r.updateTime):Ir(s);return o.isEqual(Qe.min())&&(o=Ir(s)),new aG(o,r.transformResults||[])})(t,e)))):[]}function xG(n,e){return{documents:[GN(n,e.path)]}}function wG(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=GN(n,r);const s=(function(h){if(h.length!==0)return qN(pt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(_){return{field:jc(_.field),direction:EG(_.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=pG(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function HN(n){let e=WN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Le(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(p){const _=KN(p);return _ instanceof pt&&Sw(_)?_.getFilters():[_]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((_=>(function(S){return new ym(Fc(S.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(_)))})(t.orderBy));let l=null;t.limit&&(l=(function(p){let _;return _=typeof p=="object"?p.value:p,cy(_)?null:_})(t.limit));let u=null;t.startAt&&(u=(function(p){const _=!!p.before,x=p.values||[];return new Cu(x,_)})(t.startAt));let h=null;return t.endAt&&(h=(function(p){const _=!p.before,x=p.values||[];return new Cu(x,_)})(t.endAt)),G7(e,r,o,s,l,"F",u,h)}function KN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Fc(t.unaryFilter.field);return Ye.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Fc(t.unaryFilter.field);return Ye.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Fc(t.unaryFilter.field);return Ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fc(t.unaryFilter.field);return Ye.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pe(61313);default:return Pe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ye.create(Fc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pe(58110);default:return Pe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return pt.create(t.compositeFilter.filters.map((i=>KN(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Pe(1026)}})(t.compositeFilter.op))})(n):Pe(30097,{filter:n})}function EG(n){return hG[n]}function TG(n){return dG[n]}function SG(n){return fG[n]}function jc(n){return{fieldPath:n.canonicalString()}}function Fc(n){return Bt.fromServerFormat(n.fieldPath)}function qN(n){return n instanceof Ye?(function(t){if(t.op==="=="){if(kR(t.value))return{unaryFilter:{field:jc(t.field),op:"IS_NAN"}};if(PR(t.value))return{unaryFilter:{field:jc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(kR(t.value))return{unaryFilter:{field:jc(t.field),op:"IS_NOT_NAN"}};if(PR(t.value))return{unaryFilter:{field:jc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jc(t.field),op:TG(t.op),value:t.value}}})(n):n instanceof pt?(function(t){const i=t.getFilters().map((r=>qN(r)));return i.length===1?i[0]:{compositeFilter:{op:SG(t.op),filters:i}}})(n):Pe(54877,{filter:n})}function IG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function CG(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Kc{constructor(e,t,i,r,s=Qe.min(),o=Qe.min(),l=hi.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Kc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class XN{constructor(e){this.yt=e}}function RG(n,e){let t;if(e.document)t=_G(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Ee.fromSegments(e.noDocument.path),r=Rl(e.noDocument.readTime);t=Tn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Pe(56709);{const i=Ee.fromSegments(e.unknownDocument.path),r=Rl(e.unknownDocument.version);t=Tn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new kt(r[0],r[1]);return Qe.fromTimestamp(s)})(e.readTime)),t}function WR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:wm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:vm(s,o.key),fields:o.data.value.mapValue.fields,updateTime:mx(s,o.version.toTimestamp()),createTime:mx(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Cl(e.version)};else{if(!e.isUnknownDocument())return Pe(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Cl(e.version)}}return i}function wm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Cl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Rl(n){const e=new kt(n.seconds,n.nanoseconds);return Qe.fromTimestamp(e)}function qa(n,e){const t=(e.baseMutations||[]).map((s=>_x(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>_x(n.yt,s))),r=kt.fromMillis(e.localWriteTimeMs);return new Cw(e.batchId,r,t,i)}function Qh(n){const e=Rl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Rl(n.lastLimboFreeSnapshotVersion):Qe.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return Le(o===1,1966,{count:o}),Ks(PN(WN(s.documents[0])))})(n.query):(function(s){return Ks(HN(s))})(n.query),new Kc(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,hi.fromBase64String(n.resumeToken))}function YN(n,e){const t=Cl(e.snapshotVersion),i=Cl(e.lastLimboFreeSnapshotVersion);let r;r=B7(e.target)?xG(n.yt,e.target):wG(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Il(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function ZN(n){const e=HN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?px(e,e.limit,"L"):e}function ev(n,e){return new bw(e.largestBatchId,_x(n.yt,e.overlayMutation))}function $R(n,e){const t=e.path.lastSegment();return[n,$n(e.path.popLast()),t]}function HR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Cl(i.readTime),documentKey:$n(i.documentKey.path),largestBatchId:i.largestBatchId}}class bG{getBundleMetadata(e,t){return KR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Rl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return KR(e).put((function(r){return{bundleId:r.id,createTime:Cl(Ir(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return qR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:ZN(s.bundledQuery),readTime:Rl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return qR(e).put((function(r){return{name:r.name,readTime:Cl(Ir(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function KR(n){return tn(n,uy)}function qR(n){return tn(n,hy)}class _y{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new _y(e,i)}getOverlay(e,t){return Oh(e).get($R(this.userId,t)).next((i=>i?ev(this.serializer,i):null))}getOverlays(e,t){const i=ns();return Q.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new bw(t,o);r.push(this.St(e,l))})),Q.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add($n(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Oh(e).Z(lx,l))})),Q.waitFor(s)}getOverlaysForCollection(e,t,i){const r=ns(),s=$n(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Oh(e).J(lx,o).next((l=>{for(const u of l){const h=ev(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=ns();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Oh(e).ee({index:lN,range:l},((u,h,f)=>{const p=ev(this.serializer,h);s.size()<r||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Oh(e).put((function(r,s,o){const[l,u,h]=$R(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:xm(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Oh(n){return tn(n,dy)}class AG{bt(e){return tn(e,vw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?hi.fromUint8Array(i):hi.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Xa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Kt(e.integerValue));else if("doubleValue"in e){const i=Kt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),um(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ra(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Eu(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?wN(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):fy(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Pe(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=mm,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Kt(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ee.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Xa.Kt=new Xa;const bc=255;function PG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function XR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=PG(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class kG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=XR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=XR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(bc),this.sn(255)}_n(){this.an(bc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===bc?(this.sn(bc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===bc?(this.an(bc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class NG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class DG{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class jh{constructor(){this.cn=new kG,this.ln=new NG(this.cn),this.hn=new DG(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Ya{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Ya(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Rp(this.En),directionalValue:Rp(this.dn),orderedDocumentKey:Rp(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Mo(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=YR(n.En,e.En),t!==0?t:(t=YR(n.dn,e.dn),t!==0?t:Ee.comparator(n.In,e.In)))}function YR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Rp(n){return ok()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function ZR(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class QR{constructor(e){this.mn=new yt(((t,i)=>Bt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Le(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=sx(e);if(t!==void 0&&!this.wn(t))return!1;const i=Wa(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=i[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new yt(Bt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new wp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new wp(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new wp(i.field,i.dir==="asc"?0:1)));return new cm(cm.UNKNOWN_ID,this.collectionId,t,Ud.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function QN(n){if(Le(n instanceof Ye||n instanceof pt,20012),n instanceof Ye){if(n instanceof AN){const t=n.value.arrayValue?.values?.map((i=>Ye.create(n.field,"==",i)))||[];return pt.create(t,"or")}return n}const e=n.filters.map((t=>QN(t)));return pt.create(e,n.op)}function MG(n){if(n.getFilters().length===0)return[];const e=wx(QN(n));return Le(JN(e),7391),vx(e)||xx(e)?[e]:e.getFilters()}function vx(n){return n instanceof Ye}function xx(n){return n instanceof pt&&Sw(n)}function JN(n){return vx(n)||xx(n)||(function(t){if(t instanceof pt&&dx(t)){for(const i of t.getFilters())if(!vx(i)&&!xx(i))return!1;return!0}return!1})(n)}function wx(n){if(Le(n instanceof Ye||n instanceof pt,34018),n instanceof Ye)return n;if(n.filters.length===1)return wx(n.filters[0]);const e=n.filters.map((i=>wx(i)));let t=pt.create(e,n.op);return t=Em(t),JN(t)?t:(Le(t instanceof pt,64498),Le(Ru(t),40251),Le(t.filters.length>1,57927),t.filters.reduce(((i,r)=>Aw(i,r))))}function Aw(n,e){let t;return Le(n instanceof Ye||n instanceof pt,38388),Le(e instanceof Ye||e instanceof pt,25473),t=n instanceof Ye?e instanceof Ye?(function(r,s){return pt.create([r,s],"and")})(n,e):JR(n,e):e instanceof Ye?JR(e,n):(function(r,s){if(Le(r.filters.length>0&&s.filters.length>0,48005),Ru(r)&&Ru(s))return CN(r,s.getFilters());const o=dx(r)?r:s,l=dx(r)?s:r,u=o.filters.map((h=>Aw(h,l)));return pt.create(u,"or")})(n,e),Em(t)}function JR(n,e){if(Ru(e))return CN(e,n.getFilters());{const t=e.filters.map((i=>Aw(n,i)));return pt.create(t,"or")}}function Em(n){if(Le(n instanceof Ye||n instanceof pt,11850),n instanceof Ye)return n;const e=n.getFilters();if(e.length===1)return Em(e[0]);if(SN(n))return n;const t=e.map((r=>Em(r))),i=[];return t.forEach((r=>{r instanceof Ye?i.push(r):r instanceof pt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:pt.create(i,n.op)}class LG{constructor(){this.Cn=new Pw}addToCollectionParentIndex(e,t){return this.Cn.add(t),Q.resolve()}getCollectionParents(e,t){return Q.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Q.resolve()}deleteFieldIndex(e,t){return Q.resolve()}deleteAllFieldIndexes(e){return Q.resolve()}createTargetIndexes(e,t){return Q.resolve()}getDocumentsMatchingTarget(e,t){return Q.resolve(null)}getIndexType(e,t){return Q.resolve(0)}getFieldIndexes(e,t){return Q.resolve([])}getNextCollectionGroupToUpdate(e){return Q.resolve(null)}getMinOffset(e,t){return Q.resolve(Ai.min())}getMinOffsetFromCollectionGroup(e,t){return Q.resolve(Ai.min())}updateCollectionGroup(e,t,i){return Q.resolve()}updateIndexEntries(e,t){return Q.resolve()}}class Pw{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new yt(Rt.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new yt(Rt.comparator)).toArray()}}const eb="IndexedDbIndexManager",np=new Uint8Array(0);class OG{constructor(e,t){this.databaseId=t,this.vn=new Pw,this.Fn=new ca((i=>Il(i)),((i,r)=>Sf(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:$n(r)};return tb(e).put(s)}return Q.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[Zk(t),""],!1,!0);return tb(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(ts(o.parent))}return i}))}addFieldIndex(e,t){const i=Fh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=Pc(e);return s.next((l=>{o.put(HR(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Fh(e),r=Pc(e),s=Ac(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Fh(e),i=Ac(e),r=Pc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Q.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new QR(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Ac(e);let r=!0;const s=new Map;return Q.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=Sn();const l=[];return Q.forEach(s,((u,h)=>{pe(eb,`Using index ${(function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map((L=>`${L.fieldPath}:${L.kind}`)).join(",")}`})(u)} to execute ${Il(t)}`);const f=(function(A,L){const O=sx(L);if(O===void 0)return null;for(const B of _m(A,O.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null})(h,u),p=(function(A,L){const O=new Map;for(const B of Wa(L))for(const M of _m(A,B.fieldPath))switch(M.op){case"==":case"in":O.set(B.fieldPath.canonicalString(),M.value);break;case"not-in":case"!=":return O.set(B.fieldPath.canonicalString(),M.value),Array.from(O.values())}return null})(h,u),_=(function(A,L){const O=[];let B=!0;for(const M of Wa(L)){const I=M.kind===0?OR(A,M.fieldPath,A.startAt):jR(A,M.fieldPath,A.startAt);O.push(I.value),B&&(B=I.inclusive)}return new Cu(O,B)})(h,u),x=(function(A,L){const O=[];let B=!0;for(const M of Wa(L)){const I=M.kind===0?jR(A,M.fieldPath,A.endAt):OR(A,M.fieldPath,A.endAt);O.push(I.value),B&&(B=I.inclusive)}return new Cu(O,B)})(h,u),S=this.On(u,h,_),C=this.On(u,h,x),T=this.Nn(u,h,p),b=this.Bn(u.indexId,f,S,_.inclusive,C,x.inclusive,T);return Q.forEach(b,(k=>i.Y(k,t.limit).next((A=>{A.forEach((L=>{const O=Ee.fromSegments(L.documentKey);o.has(O)||(o=o.add(O),l.push(O))}))}))))})).next((()=>l))}return Q.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=MG(pt.create(e.filters,"and")).map((i=>gx(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let p=0;p<u;++p){const _=t?this.Ln(t[p/h]):np,x=this.kn(e,_,i[p%h],r),S=this.qn(e,_,s[p%h],o),C=l.map((T=>this.kn(e,_,T,!0)));f.push(...this.createRange(x,S,C))}return f}kn(e,t,i,r){const s=new Ya(e,Ee.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Ya(e,Ee.empty(),t,i);return r?s.An():s}xn(e,t){const i=new QR(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Q.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new yt(Bt.comparator),f=!1;for(const p of u.filters)for(const _ of p.getFlattenedFilters())_.field.isKeyField()||(_.op==="array-contains"||_.op==="array-contains-any"?f=!0:h=h.add(_.field));for(const p of u.orderBy)p.field.isKeyField()||(h=h.add(p.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new jh;for(const r of Wa(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);Xa.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new jh;return Xa.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new jh;return Xa.Kt.Dt(Tw(this.databaseId,t),i.Pn((function(s){const o=Wa(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new jh);let s=0;for(const o of Wa(e)){const l=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&Hd(l))r=this.Kn(r,o,l);else{const h=u.Pn(o.kind);Xa.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const u=new jh;u.seed(l.un()),Xa.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof Ye&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Fh(e),r=Pc(e);return(t?i.J(ax,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Q.forEach(s,(l=>r.get([l.indexId,this.uid]).next((u=>{o.push((function(f,p){const _=p?new Ud(p.sequenceNumber,new Ai(Rl(p.readTime),new Ee(ts(p.documentKey)),p.largestBatchId)):Ud.empty(),x=f.fields.map((([S,C])=>new wp(Bt.fromServerFormat(S),C)));return new cm(f.indexId,f.collectionGroup,x,_)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:He(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Fh(e),s=Pc(e);return this.Gn(e).next((o=>r.J(ax,IDBKeyRange.bound(t,t)).next((l=>Q.forEach(l,(u=>s.put(HR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Q.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Q.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),Q.forEach(l,(u=>this.zn(e,r,u).next((h=>{const f=this.jn(s,u);return h.isEqual(f)?Q.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,i,r){return Ac(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Ac(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Ac(e);let s=new yt(Mo);return r.ee({index:aN,range:IDBKeyRange.only([i.indexId,this.uid,Rp(this.$n(i,t))])},((o,l)=>{s=s.add(new Ya(i.indexId,t,ZR(l.arrayValue),ZR(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new yt(Mo);const r=this.Qn(t,e);if(r==null)return i;const s=sx(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Hd(o))for(const l of o.arrayValue.values||[])i=i.add(new Ya(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new Ya(t.indexId,e.key,np,r));return i}Jn(e,t,i,r,s){pe(eb,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,f,p,_){const x=u.getIterator(),S=h.getIterator();let C=Rc(x),T=Rc(S);for(;C||T;){let b=!1,k=!1;if(C&&T){const A=f(C,T);A<0?k=!0:A>0&&(b=!0)}else C!=null?k=!0:b=!0;b?(p(T),T=Rc(S)):k?(_(C),C=Rc(x)):(C=Rc(x),T=Rc(S))}})(r,s,Mo,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),Q.waitFor(o)}Gn(e){let t=1;return Pc(e).ee({index:oN,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>Mo(o,l))).filter(((o,l,u)=>!l||Mo(o,u[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=Mo(o,e),u=Mo(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,np,Ee.empty()),u=r[o+1].Vn(this.uid,np,Ee.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return Mo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(nb)}getMinOffset(e,t){return Q.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Pe(44426))))).next(nb)}}function tb(n){return tn(n,Wd)}function Ac(n){return tn(n,ud)}function Fh(n){return tn(n,_w)}function Pc(n){return tn(n,cd)}function nb(n){Le(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;pw(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ai(e.readTime,e.documentKey,t)}const ib={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},eD=41943040;class ti{static withCacheSize(e){return new ti(e,ti.DEFAULT_COLLECTION_PERCENTILE,ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function tD(n,e,t){const i=n.store(gr),r=n.store(_u),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.ee({range:o},((f,p,_)=>(l++,_.delete())));s.push(u.next((()=>{Le(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const p=iN(e,f.key.path,t.batchId);s.push(r.delete(p)),h.push(f.key)}return Q.waitFor(s).next((()=>h))}function Tm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Pe(14731);e=n.noDocument}return JSON.stringify(e).length}ti.DEFAULT_COLLECTION_PERCENTILE=10,ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ti.DEFAULT=new ti(eD,ti.DEFAULT_COLLECTION_PERCENTILE,ti.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ti.DISABLED=new ti(-1,0,0);class vy{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){Le(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new vy(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Lo(e).ee({index:il,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Vc(e),o=Lo(e);return o.add({}).next((l=>{Le(typeof l=="number",49019);const u=new Cw(l,t,i,r),h=(function(x,S,C){const T=C.baseMutations.map((k=>xm(x.yt,k))),b=C.mutations.map((k=>xm(x.yt,k)));return{userId:S,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:T,mutations:b}})(this.serializer,this.userId,u),f=[];let p=new yt(((_,x)=>He(_.canonicalString(),x.canonicalString())));for(const _ of r){const x=iN(this.userId,_.key.path,l);p=p.add(_.key.path.popLast()),f.push(o.put(h)),f.push(s.put(x,r7))}return p.forEach((_=>{f.push(this.indexManager.addToCollectionParentIndex(e,_))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),Q.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return Lo(e).get(t).next((i=>i?(Le(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),qa(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Q.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Lo(e).ee({index:il,range:r},((o,l,u)=>{l.userId===this.userId&&(Le(l.batchId>=i,47524,{tr:i}),s=qa(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ul;return Lo(e).ee({index:il,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ul],[this.userId,Number.POSITIVE_INFINITY]);return Lo(e).J(il,t).next((i=>i.map((r=>qa(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Ep(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Vc(e).ee({range:r},((o,l,u)=>{const[h,f,p]=o,_=ts(f);if(h===this.userId&&t.path.isEqual(_))return Lo(e).get(p).next((x=>{if(!x)throw Pe(61480,{nr:o,batchId:p});Le(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:p}),s.push(qa(this.serializer,x))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(He);const r=[];return t.forEach((s=>{const o=Ep(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=Vc(e).ee({range:l},((h,f,p)=>{const[_,x,S]=h,C=ts(x);_===this.userId&&s.path.isEqual(C)?i=i.add(S):p.done()}));r.push(u)})),Q.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=Ep(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new yt(He);return Vc(e).ee({range:o},((u,h,f)=>{const[p,_,x]=u,S=ts(_);p===this.userId&&i.isPrefixOf(S)?S.length===r&&(l=l.add(x)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(Lo(e).get(s).next((o=>{if(o===null)throw Pe(35274,{batchId:s});Le(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(qa(this.serializer,o))})))})),Q.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return tD(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Q.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Q.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Vc(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const u=ts(s[1]);r.push(u)}else l.done()})).next((()=>{Le(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return nD(e,this.userId,t)}_r(e){return iD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:ul,lastStreamToken:""}))}}function nD(n,e,t){const i=Ep(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Vc(n).ee({range:s,X:!0},((l,u,h)=>{const[f,p,_]=l;f===e&&p===r&&(o=!0),h.done()})).next((()=>o))}function Lo(n){return tn(n,gr)}function Vc(n){return tn(n,_u)}function iD(n){return tn(n,Bd)}class bl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new bl(0)}static cr(){return new bl(-1)}}class jG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new bl(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Qe.fromTimestamp(new kt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>kc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Le(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return kc(e).ee(((o,l)=>{const u=Qh(l);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>Q.waitFor(s))).next((()=>r))}forEachTarget(e,t){return kc(e).ee(((i,r)=>{const s=Qh(r);t(s)}))}lr(e){return rb(e).get(fm).next((t=>(Le(t!==null,2888),t)))}hr(e,t){return rb(e).put(fm,t)}Pr(e,t){return kc(e).put(YN(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Il(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return kc(e).ee({range:r,index:sN},((o,l,u)=>{const h=Qh(l);Sf(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Wo(e);return t.forEach((o=>{const l=$n(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),Q.waitFor(r)}removeMatchingKeys(e,t,i){const r=Wo(e);return Q.forEach(t,(s=>{const o=$n(s.path);return Q.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Wo(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Wo(e);let s=Sn();return r.ee({range:i,X:!0},((o,l,u)=>{const h=ts(o[1]),f=new Ee(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=$n(t.path),r=IDBKeyRange.bound([i],[Zk(i)],!1,!0);let s=0;return Wo(e).ee({index:yw,X:!0,range:r},(([o,l],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return kc(e).get(t).next((i=>i?Qh(i):null))}}function kc(n){return tn(n,vu)}function rb(n){return tn(n,hl)}function Wo(n){return tn(n,xu)}const sb="LruGarbageCollector",FG=1048576;function ob([n,e],[t,i]){const r=He(n,t);return r===0?He(e,i):r}class VG{constructor(e){this.Ir=e,this.buffer=new yt(ob),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();ob(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class zG{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){pe(sb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ll(t)?pe(sb,"Ignoring IndexedDB error during garbage collection: ",t):await ay(t)}await this.Vr(3e5)}))}}class UG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Q.resolve(xr.ce);const i=new VG(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),Q.resolve(ib)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ib):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),r=this.params.maximumSequenceNumbersToCollect):r=p,o=Date.now(),this.nthSequenceNumber(e,r)))).next((p=>(i=p,l=Date.now(),this.removeTargets(e,i,t)))).next((p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((p=>(h=Date.now(),Oc()<=Ke.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Q.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:p}))))}}function BG(n,e){return new UG(n,e)}class GG{constructor(e,t){this.db=e,this.garbageCollector=BG(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return ip(e,i)}removeReference(e,t,i){return ip(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return ip(e,t)}br(e,t){return(function(r,s){let o=!1;return iD(r).te((l=>nD(r,l,s).next((u=>(u&&(o=!0),Q.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Qe.min()),Wo(e).delete((function(p){return[0,$n(p.path)]})(o)))))}));r.push(u)}})).next((()=>Q.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return ip(e,t)}Sr(e,t){const i=Wo(e);let r,s=xr.ce;return i.ee({index:yw},(([o,l],{path:u,sequenceNumber:h})=>{o===0?(s!==xr.ce&&t(new Ee(ts(r)),s),s=h,r=u):s=xr.ce})).next((()=>{s!==xr.ce&&t(new Ee(ts(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ip(n,e){return Wo(n).put((function(i,r){return{targetId:0,path:$n(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class rD{constructor(){this.changes=new ca((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Q.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class WG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Fa(e).put(i)}removeEntry(e,t,i){return Fa(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],wm(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Tn.newInvalidDocument(t);return Fa(e).ee({index:Tp,range:IDBKeyRange.only(Vh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Tn.newInvalidDocument(t)};return Fa(e).ee({index:Tp,range:IDBKeyRange.only(Vh(t))},((r,s)=>{i={document:this.Cr(t,s),size:Tm(s)}})).next((()=>i))}getEntries(e,t){let i=rl();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=rl(),r=new ui(Ee.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,Tm(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Q.resolve();let r=new yt(cb);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Vh(r.first()),Vh(r.last())),o=r.getIterator();let l=o.getNext();return Fa(e).ee({index:Tp,range:s},((u,h,f)=>{const p=Ee.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&cb(l,p)<0;)i(l,null),l=o.getNext();l&&l.isEqual(p)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Vh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),wm(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fa(e).J(IDBKeyRange.bound(l,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=rl();for(const p of h){const _=this.Cr(Ee.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);_.isFoundDocument()&&(py(t,_)||r.has(_.key))&&(f=f.insert(_.key,_))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=rl();const o=lb(t,i),l=lb(t,Ai.max());return Fa(e).ee({index:rN,range:IDBKeyRange.bound(o,l,!0)},((u,h,f)=>{const p=this.Cr(Ee.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(p.key,p),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new $G(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return ab(e).get(ox).next((t=>(Le(!!t,20021),t)))}Dr(e,t){return ab(e).put(ox,t)}Cr(e,t){if(t){const i=RG(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Qe.min())))return i}return Tn.newInvalidDocument(e)}}function sD(n){return new WG(n)}class $G extends rD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ca((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new yt(((s,o)=>He(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=WR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=Tm(u);i+=h-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=l.size,this.trackRemovals){const u=WR(this.Nr.serializer,o.convertToNoDocument(Qe.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Q.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function ab(n){return tn(n,Gd)}function Fa(n){return tn(n,dm)}function Vh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function lb(n,e){const t=e.documentKey.path.toArray();return[n,wm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function cb(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=He(t[s],i[s]),r)return r;return r=He(t.length,i.length),r||(r=He(t[t.length-2],i[i.length-2]),r||He(t[t.length-1],i[i.length-1]))}class HG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class oD{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&gd(i.mutation,r,Us.empty(),kt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Sn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Sn()){const r=ns();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=tp();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=ns();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Sn())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=rl();const o=fd(),l=(function(){return fd()})();return t.forEach(((u,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Vu)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),gd(f.mutation,h,f.mutation.getFieldMask(),kt.now())):o.set(h.key,Us.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new HG(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=fd();let r=new ui(((o,l)=>o-l)),s=Sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=i.get(u)||Us.empty();f=l.applyToLocalView(h,f),i.set(u,f);const p=(r.get(l.batchId)||Sn()).add(u);r=r.insert(l.batchId,p)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,p=MN();f.forEach((_=>{if(!s.has(_)){const x=FN(t.get(_),i.get(_));x!==null&&p.set(_,x),s=s.add(_)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return Q.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):W7(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Q.resolve(ns());let l=zd,u=s;return o.next((h=>Q.forEach(h,((f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(f)?Q.resolve():this.remoteDocumentCache.getEntry(e,f).next((_=>{u=u.insert(f,_)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Sn()))).next((f=>({batchId:l,changes:X7(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next((i=>{let r=tp();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=tp();return this.indexManager.getCollectionParents(e,s).next((l=>Q.forEach(l,(u=>{const h=(function(p,_){return new gy(_,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((p,_)=>{o=o.insert(p,_)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Tn.newInvalidDocument(f)))}));let l=tp();return o.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&gd(f.mutation,h,Us.empty(),kt.now()),py(t,h)&&(l=l.insert(u,h))})),l}))}}class KG{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Q.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Ir(r.createTime)}})(t)),Q.resolve()}getNamedQuery(e,t){return Q.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:ZN(r.bundledQuery),readTime:Ir(r.readTime)}})(t)),Q.resolve()}}class qG{constructor(){this.overlays=new ui(Ee.comparator),this.qr=new Map}getOverlay(e,t){return Q.resolve(this.overlays.get(t))}getOverlays(e,t){const i=ns();return Q.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Q.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Q.resolve()}getOverlaysForCollection(e,t,i){const r=ns(),s=t.length+1,o=new Ee(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return Q.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new ui(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=ns(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=ns(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return Q.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new bw(t,i));let s=this.qr.get(t);s===void 0&&(s=Sn(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class XG{constructor(){this.sessionToken=hi.EMPTY_BYTE_STRING}getSessionToken(e){return Q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Q.resolve()}}class kw{constructor(){this.Qr=new yt(cn.$r),this.Ur=new yt(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new cn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new cn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ee(new Rt([])),i=new cn(t,e),r=new cn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ee(new Rt([])),i=new cn(t,e),r=new cn(t,e+1);let s=Sn();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new cn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class cn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ee.comparator(e.key,t.key)||He(e.Yr,t.Yr)}static Kr(e,t){return He(e.Yr,t.Yr)||Ee.comparator(e.key,t.key)}}class YG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new yt(cn.$r)}checkEmpty(e){return Q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Cw(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new cn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Q.resolve(o)}lookupMutationBatch(e,t){return Q.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Q.resolve(this.mutationQueue.length===0?ul:this.tr-1)}getAllMutationBatches(e){return Q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new cn(t,0),r=new cn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),Q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(He);return t.forEach((r=>{const s=new cn(r,0),o=new cn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),Q.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Ee.isDocumentKey(s)||(s=s.child(""));const o=new cn(new Ee(s),0);let l=new yt(He);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(u.Yr)),!0)}),o),Q.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Le(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Q.forEach(t.mutations,(r=>{const s=new cn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new cn(t,0),r=this.Zr.firstAfterOrEqual(i);return Q.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Q.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ZG{constructor(e){this.ri=e,this.docs=(function(){return new ui(Ee.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Q.resolve(i?i.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let i=rl();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Tn.newInvalidDocument(r))})),Q.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=rl();const o=t.path,l=new Ee(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||pw(Jk(f),i)<=0||(r.has(f.key)||py(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Q.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Pe(9500)}ii(e,t){return Q.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new QG(this)}getSize(e){return Q.resolve(this.size)}}class QG extends rD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Q.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class JG{constructor(e){this.persistence=e,this.si=new ca((t=>Il(t)),Sf),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.oi=0,this._i=new kw,this.targetCount=0,this.ai=bl.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Q.resolve()}getLastRemoteSnapshotVersion(e){return Q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Q.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new bl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Q.resolve()}updateTargetData(e,t){return this.Pr(t),Q.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Q.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),Q.waitFor(s).next((()=>r))}getTargetCount(e){return Q.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Q.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Q.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Q.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Q.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Q.resolve(i)}containsKey(e,t){return Q.resolve(this._i.containsKey(t))}}class aD{constructor(e,t){this.ui={},this.overlays={},this.ci=new xr(0),this.li=!1,this.li=!0,this.hi=new XG,this.referenceDelegate=e(this),this.Pi=new JG(this),this.indexManager=new LG,this.remoteDocumentCache=(function(r){return new ZG(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new XN(t),this.Ii=new KG(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new qG,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new YG(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){pe("MemoryPersistence","Starting transaction:",e);const r=new eW(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Q.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class eW extends tN{constructor(e){super(),this.currentSequenceNumber=e}}class xy{constructor(e){this.persistence=e,this.Ri=new kw,this.Vi=null}static mi(e){return new xy(e)}get fi(){if(this.Vi)return this.Vi;throw Pe(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Q.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Q.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Q.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Q.forEach(this.fi,(i=>{const r=Ee.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Qe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Q.or([()=>Q.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class tW{constructor(e){this.serializer=e}k(e,t,i,r){const s=new ly("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(Tf)})(e),(function(u){u.createObjectStore(Bd,{keyPath:i7}),u.createObjectStore(gr,{keyPath:SR,autoIncrement:!0}).createIndex(il,IR,{unique:!0}),u.createObjectStore(_u)})(e),ub(e),(function(u){u.createObjectStore($a)})(e));let o=Q.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(xu),u.deleteObjectStore(vu),u.deleteObjectStore(hl)})(e),ub(e)),o=o.next((()=>(function(u){const h=u.store(hl),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Qe.min().toTimestamp(),targetCount:0};return h.put(fm,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(gr).J().next((p=>{u.deleteObjectStore(gr),u.createObjectStore(gr,{keyPath:SR,autoIncrement:!0}).createIndex(il,IR,{unique:!0});const _=h.store(gr),x=p.map((S=>_.put(S)));return Q.waitFor(x)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(wu,{keyPath:d7})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Gd)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(uy,{keyPath:f7})})(e),(function(u){u.createObjectStore(hy,{keyPath:g7})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(dy,{keyPath:w7});h.createIndex(lx,E7,{unique:!1}),h.createIndex(lN,T7,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(dm,{keyPath:s7});h.createIndex(Tp,o7),h.createIndex(rN,a7)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore($a)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(_w,{keyPath:p7,autoIncrement:!0}).createIndex(ax,m7,{unique:!1}),u.createObjectStore(cd,{keyPath:y7}).createIndex(oN,_7,{unique:!1}),u.createObjectStore(ud,{keyPath:v7}).createIndex(aN,x7,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(cd).clear()})).next((()=>{t.objectStore(ud).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(vw,{keyPath:S7})})(e)}))),i<18&&r>=18&&ok()&&(o=o.next((()=>{t.objectStore(cd).clear()})).next((()=>{t.objectStore(ud).clear()}))),o}wi(e){let t=0;return e.store($a).ee(((i,r)=>{t+=Tm(r)})).next((()=>{const i={byteSize:t};return e.store(Gd).put(ox,i)}))}yi(e){const t=e.store(Bd),i=e.store(gr);return t.J().next((r=>Q.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,ul],[s.userId,s.lastAcknowledgedBatchId]);return i.J(il,o).next((l=>Q.forEach(l,(u=>{Le(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=qa(this.serializer,u);return tD(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(xu),i=e.store($a);return e.store(hl).get(fm).next((r=>{const s=[];return i.ee(((o,l)=>{const u=new Rt(o),h=(function(p){return[0,$n(p)]})(u);s.push(t.get(h).next((f=>f?Q.resolve():(p=>t.put({targetId:0,path:$n(p),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>Q.waitFor(s)))}))}bi(e,t){e.createObjectStore(Wd,{keyPath:h7});const i=t.store(Wd),r=new Pw,s=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:$n(u)})}};return t.store($a).ee({X:!0},((o,l)=>{const u=new Rt(o);return s(u.popLast())})).next((()=>t.store(_u).ee({X:!0},(([o,l,u],h)=>{const f=ts(l);return s(f.popLast())}))))}Di(e){const t=e.store(vu);return t.ee(((i,r)=>{const s=Qh(r),o=YN(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store($a),r=[];return i.ee(((s,o)=>{const l=t.store(dm),u=(function(p){return p.document?new Ee(Rt.fromString(p.document.name).popFirst(5)):p.noDocument?Ee.fromSegments(p.noDocument.path):p.unknownDocument?Ee.fromSegments(p.unknownDocument.path):Pe(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>Q.waitFor(r)))}Fi(e,t){const i=t.store(gr),r=sD(this.serializer),s=new aD(xy.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((u=>{let h=l.get(u.userId)??Sn();qa(this.serializer,u).keys().forEach((f=>h=h.add(f))),l.set(u.userId,h)})),Q.forEach(l,((u,h)=>{const f=new wn(h),p=_y.wt(this.serializer,f),_=s.getIndexManager(f),x=vy.wt(f,this.serializer,_,s.referenceDelegate);return new oD(r,x,p,_).recalculateAndSaveOverlaysForDocumentKeys(new cx(t,xr.ce),u).next()}))}))}}function ub(n){n.createObjectStore(xu,{keyPath:c7}).createIndex(yw,u7,{unique:!0}),n.createObjectStore(vu,{keyPath:"targetId"}).createIndex(sN,l7,{unique:!0}),n.createObjectStore(hl)}const Oo="IndexedDbPersistence",tv=18e5,nv=5e3,iv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",nW="main";class Nw{constructor(e,t,i,r,s,o,l,u,h,f,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=_=>Promise.resolve(),!Nw.v())throw new Se(le.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new GG(this,r),this.$i=t+nW,this.serializer=new XN(u),this.Ui=new Jo(this.$i,this.Ni,new tW(this.serializer)),this.hi=new AG,this.Pi=new jG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=sD(this.serializer),this.Ii=new bG,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&Si(Oo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Se(le.FAILED_PRECONDITION,iv);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new xr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>rp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ll(e))return pe(Oo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return pe(Oo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return zh(e).get(Cc).next((t=>Q.resolve(this.es(t))))}ts(e){return rp(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,tv)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=tn(t,wu);return i.J().next((r=>{const s=this.ss(r,tv),o=r.filter((l=>s.indexOf(l)===-1));return Q.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Q.resolve(!0):zh(e).get(Cc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,nv)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Se(le.FAILED_PRECONDITION,iv);return!1}}return!(!this.networkEnabled||!this.inForeground)||rp(e).J().next((i=>this.ss(i,nv).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&pe(Oo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Tf,wu],(e=>{const t=new cx(e,xr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>rp(e).J().next((t=>this.ss(t,tv).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return vy.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new OG(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return _y.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){pe(Oo,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?R7:u===17?dN:u===16?C7:u===15?xw:u===14?hN:u===13?uN:u===12?I7:u===11?cN:void Pe(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new cx(l,this.ci?this.ci.next():xr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Si(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Se(le.FAILED_PRECONDITION,eN);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return zh(e).get(Cc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,nv)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Se(le.FAILED_PRECONDITION,iv)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return zh(e).put(Cc,t)}static v(){return Jo.v()}Zi(e){const t=zh(e);return t.get(Cc).next((i=>this.es(i)?(pe(Oo,"Releasing primary lease."),t.delete(Cc)):Q.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Si(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;sk()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return pe(Oo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Si(Oo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Si("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function zh(n){return tn(n,Tf)}function rp(n){return tn(n,wu)}function iW(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Dw{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Sn(),r=Sn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Dw(e,t.fromCache,i,r)}}class rW{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class lD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return sk()?8:nN(en())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new rW;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Oc()<=Ke.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",Lh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Q.resolve()):(Oc()<=Ke.DEBUG&&pe("QueryEngine","Query:",Lh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Oc()<=Ke.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",Lh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ks(t))):Q.resolve())}ys(e,t){if(FR(t))return Q.resolve(null);let i=Ks(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=px(t,null,"F"),i=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Sn(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,l);return this.Cs(t,h,o,u.readTime)?this.ys(e,px(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return FR(t)||r.isEqual(Qe.min())?Q.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Q.resolve(null):(Oc()<=Ke.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Lh(t)),this.vs(e,o,t,Z8(r,zd)).next((l=>l)))}))}Ds(e,t){let i=new yt(H7(e));return t.forEach(((r,s)=>{py(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Oc()<=Ke.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",Lh(t)),this.ps.getDocumentsMatchingQuery(e,t,Ai.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const sW="LocalStore";class oW{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new ui(He),this.xs=new ca((s=>Il(s)),Sf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function cD(n,e,t,i){return new oW(n,e,t,i)}async function aW(n,e){const t=St(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let u=Sn();for(const h of r){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function lW(n,e){const t=St(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,f){const p=h.batch,_=p.keys();let x=Q.resolve();return _.forEach((S=>{x=x.next((()=>f.getEntry(u,S))).next((C=>{const T=h.docVersions.get(S);Le(T!==null,48541),C.version.compareTo(T)<0&&(p.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),f.addEntry(C)))}))})),x.next((()=>l.mutationQueue.removeMutationBatch(u,p)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let u=Sn();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function cW(n){const e=St(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function uW(n,e){const t=St(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ul),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class hb{constructor(){this.activeTargetIds=J7()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class uD{constructor(){this.Mo=new hb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new hb,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class hW{Oo(e){}shutdown(){}}const db="ConnectivityMonitor";class fb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){pe(db,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){pe(db,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let sp=null;function Ex(){return sp===null?sp=(function(){return 268435456+Math.round(2147483648*Math.random())})():sp++,"0x"+sp.toString(16)}const rv="RestConnection",dW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class fW{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===pm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=Ex(),l=this.zo(e,t.toUriEncodedString());pe(rv,`Sending RPC '${e}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(l),f=Dl(h);return this.Jo(e,l,u,i,f).then((p=>(pe(rv,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw oy(rv,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",i),p}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Fu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=dW[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class gW{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const kn="WebChannelConnection";class pW extends fW{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=Ex();return new Promise(((l,u)=>{const h=new Gk;h.setWithCredentials(!0),h.listenOnce(Wk.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case xp.NO_ERROR:const p=h.getResponseJson();pe(kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case xp.TIMEOUT:pe(kn,`RPC '${e}' ${o} timed out`),u(new Se(le.DEADLINE_EXCEEDED,"Request time out"));break;case xp.HTTP_ERROR:const _=h.getStatus();if(pe(kn,`RPC '${e}' ${o} failed with status:`,_,"response text:",h.getResponseText()),_>0){let x=h.getResponseJson();Array.isArray(x)&&(x=x[0]);const S=x?.error;if(S&&S.status&&S.message){const C=(function(b){const k=b.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(k)>=0?k:le.UNKNOWN})(S.status);u(new Se(C,S.message))}else u(new Se(le.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Se(le.UNAVAILABLE,"Connection failed."));break;default:Pe(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{pe(kn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);pe(kn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=Ex(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Kk(),l=Hk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const f=s.join("");pe(kn,`Creating RPC '${e}' stream ${r}: ${f}`,u);const p=o.createWebChannel(f,u);this.I_(p);let _=!1,x=!1;const S=new gW({Yo:T=>{x?pe(kn,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(_||(pe(kn,`Opening RPC '${e}' stream ${r} transport.`),p.open(),_=!0),pe(kn,`RPC '${e}' stream ${r} sending:`,T),p.send(T))},Zo:()=>p.close()}),C=(T,b,k)=>{T.listen(b,(A=>{try{k(A)}catch(L){setTimeout((()=>{throw L}),0)}}))};return C(p,Zh.EventType.OPEN,(()=>{x||(pe(kn,`RPC '${e}' stream ${r} transport opened.`),S.o_())})),C(p,Zh.EventType.CLOSE,(()=>{x||(x=!0,pe(kn,`RPC '${e}' stream ${r} transport closed`),S.a_(),this.E_(p))})),C(p,Zh.EventType.ERROR,(T=>{x||(x=!0,oy(kn,`RPC '${e}' stream ${r} transport errored. Name:`,T.name,"Message:",T.message),S.a_(new Se(le.UNAVAILABLE,"The operation could not be completed")))})),C(p,Zh.EventType.MESSAGE,(T=>{if(!x){const b=T.data[0];Le(!!b,16349);const k=b,A=k?.error||k[0]?.error;if(A){pe(kn,`RPC '${e}' stream ${r} received error:`,A);const L=A.status;let O=(function(I){const N=Ht[I];if(N!==void 0)return uG(N)})(L),B=A.message;O===void 0&&(O=le.INTERNAL,B="Unknown error status: "+L+" with message "+A.message),x=!0,S.a_(new Se(O,B)),p.close()}else pe(kn,`RPC '${e}' stream ${r} received:`,b),S.u_(b)}})),C(l,$k.STAT_EVENT,(T=>{T.stat===ix.PROXY?pe(kn,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===ix.NOPROXY&&pe(kn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function mW(){return typeof window<"u"?window:null}function bp(){return typeof document<"u"?document:null}function hD(n){return new gG(n,!0)}class dD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&pe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const gb="PersistentStream";class yW{constructor(e,t,i,r,s,o,l,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new dD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===le.RESOURCE_EXHAUSTED?(Si(t.toString()),Si("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Se(le.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return pe(gb,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(pe(gb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class _W extends yW{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Le(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Le(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Le(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=vG(e.writeResults,e.commitTime),i=Ir(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=yG(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>xm(this.serializer,i)))};this.q_(t)}}class vW{}class xW extends vW{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Se(le.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,yx(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Se(le.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,yx(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Se(le.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class wW{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Si(t),this.aa=!1):pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const wy="RemoteStore";class EW{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{Ty(this)&&(pe(wy,"Restarting streams for network reachability change."),await(async function(u){const h=St(u);h.Ea.add(4),await Ey(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Mw(h)})(this))}))})),this.Ra=new wW(i,r)}}async function Mw(n){if(Ty(n))for(const e of n.da)await e(!0)}async function Ey(n){for(const e of n.da)await e(!1)}function Ty(n){return St(n).Ea.size===0}async function fD(n,e,t){if(!Ll(e))throw e;n.Ea.add(1),await Ey(n),n.Ra.set("Offline"),t||(t=()=>cW(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{pe(wy,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Mw(n)}))}function gD(n,e){return e().catch((t=>fD(n,t,e)))}async function Sy(n){const e=St(n),t=oa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ul;for(;TW(e);)try{const r=await uW(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,SW(e,r)}catch(r){await fD(e,r)}pD(e)&&mD(e)}function TW(n){return Ty(n)&&n.Ta.length<10}function SW(n,e){n.Ta.push(e);const t=oa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function pD(n){return Ty(n)&&!oa(n).x_()&&n.Ta.length>0}function mD(n){oa(n).start()}async function IW(n){oa(n).ra()}async function CW(n){const e=oa(n);for(const t of n.Ta)e.ea(t.mutations)}async function RW(n,e,t){const i=n.Ta.shift(),r=Rw.from(i,e,t);await gD(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Sy(n)}async function bW(n,e){e&&oa(n).X_&&await(async function(i,r){if((function(o){return cG(o)&&o!==le.ABORTED})(r.code)){const s=i.Ta.shift();oa(i).B_(),await gD(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await Sy(i)}})(n,e),pD(n)&&mD(n)}async function AW(n,e){const t=St(n);e?(t.Ea.delete(2),await Mw(t)):e||(t.Ea.add(2),await Ey(t),t.Ra.set("Unknown"))}function oa(n){return n.fa||(n.fa=(function(t,i,r){const s=St(t);return s.sa(),new _W(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:IW.bind(null,n),r_:bW.bind(null,n),ta:CW.bind(null,n),na:RW.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Sy(n)):(await n.fa.stop(),n.Ta.length>0&&(pe(wy,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Lw{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new cl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new Lw(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function PW(n,e){if(Si("AsyncQueue",`${e}: ${n}`),Ll(n))return new Se(le.UNAVAILABLE,`${e}: ${n}`);throw n}class kW{constructor(){this.queries=pb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=St(t),s=r.queries;r.queries=pb(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(i)}))})(this,new Se(le.ABORTED,"Firestore shutting down"))}}function pb(){return new ca((n=>NN(n)),kN)}function NW(n){n.Ca.forEach((e=>{e.next()}))}var mb,yb;(yb=mb||(mb={})).Ma="default",yb.Cache="cache";const DW="SyncEngine";class MW{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ca((l=>NN(l)),kN),this.Iu=new Map,this.Eu=new Set,this.du=new ui(Ee.comparator),this.Au=new Map,this.Ru=new kw,this.Vu={},this.mu=new Map,this.fu=bl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function _b(n,e,t){const i=St(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const u=St(o);u.onlineState=l;let h=!1;u.queries.forEach(((f,p)=>{for(const _ of p.Sa)_.va(l)&&(h=!0)})),h&&NW(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function LW(n,e){const t=St(n),i=e.batch.batchId;try{const r=await lW(t.localStore,e);_D(t,i,null),yD(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ow(t,r)}catch(r){await ay(r)}}async function OW(n,e,t){const i=St(n);try{const r=await(function(o,l){const u=St(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next((p=>(Le(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);_D(i,e,t),yD(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ow(i,r)}catch(r){await ay(r)}}function yD(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function _D(n,e,t){const i=St(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function Ow(n,e,t){const i=St(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){r.push(h);const f=Dw.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const f=St(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>Q.forEach(h,(_=>Q.forEach(_.Es,(x=>f.persistence.referenceDelegate.addReference(p,_.targetId,x))).next((()=>Q.forEach(_.ds,(x=>f.persistence.referenceDelegate.removeReference(p,_.targetId,x)))))))))}catch(p){if(!Ll(p))throw p;pe(sW,"Failed to update sequence numbers: "+p)}for(const p of h){const _=p.targetId;if(!p.fromCache){const x=f.Ms.get(_),S=x.snapshotVersion,C=x.withLastLimboFreeSnapshotVersion(S);f.Ms=f.Ms.insert(_,C)}}})(i.localStore,s))}async function jW(n,e){const t=St(n);if(!t.currentUser.isEqual(e)){pe(DW,"User change. New user:",e.toKey());const i=await aW(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new Se(le.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ow(t,i.Ls)}}function FW(n){const e=St(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=LW.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=OW.bind(null,e),e}class Tx{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hD(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return cD(this.persistence,new lD,e.initialUser,this.serializer)}Cu(e){return new aD(xy.mi,this.serializer)}Du(e){return new uD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Tx.provider={build:()=>new Tx};class VW extends Tx{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await FW(this.xu.syncEngine),await Sy(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return cD(this.persistence,new lD,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new zG(i,e.asyncQueue,t)}Mu(e,t){const i=new t7(t,this.persistence);return new e7(e.asyncQueue,i)}Cu(e){const t=iW(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?ti.withCacheSize(this.cacheSizeBytes):ti.DEFAULT;return new Nw(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,mW(),bp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new uD}}class Sx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>_b(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=jW.bind(null,this.syncEngine),await AW(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new kW})()}createDatastore(e){const t=hD(e.databaseInfo.databaseId),i=(function(s){return new pW(s)})(e.databaseInfo);return(function(s,o,l,u){return new xW(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new EW(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>_b(this.syncEngine,t,0)),(function(){return fb.v()?new fb:new hW})())}createSyncEngine(e,t){return(function(r,s,o,l,u,h,f){const p=new MW(r,s,o,l,u,h);return f&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=St(t);pe(wy,"RemoteStore shutting down."),i.Ea.add(5),await Ey(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Sx.provider={build:()=>new Sx};const vb="FirestoreClient";class zW{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=wn.UNAUTHENTICATED,this.clientId=Yk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{pe(vb,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(pe(vb,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=PW(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function vD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const xb=new Map;const xD="firestore.googleapis.com",wb=!0;class Eb{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Se(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=xD,this.ssl=wb}else this.host=e.host,this.ssl=e.ssl??wb;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=eD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FG)throw new Se(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}q8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vD(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Se(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Se(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Se(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wD{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Eb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Eb(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new F8;switch(i.type){case"firstParty":return new B8(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Se(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=xb.get(t);i&&(pe("ComponentProvider","Removing Datastore"),xb.delete(t),i.terminate())})(this),Promise.resolve()}}function UW(n,e,t,i={}){n=Qk(n,wD);const r=Dl(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(Q1(`https://${l}`),J1("Firestore",!0)),s.host!==xD&&s.host!==l&&oy("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:r,emulatorOptions:i};if(!wl(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=wn.MOCK_USER;else{h=ik(i.mockUserToken,n._app?.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new Se(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new wn(p)}n._authCredentials=new V8(new Xk(h,f))}}class jw{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new jw(this.firestore,e,this._query)}}class is{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fw(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new is(this.firestore,e,this._key)}toJSON(){return{type:is._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Ef(t,is._jsonSchema))return new is(e,i||null,new Ee(Rt.fromString(t.referencePath)))}}is._jsonSchemaVersion="firestore/documentReference/1.0",is._jsonSchema={type:qt("string",is._jsonSchemaVersion),referencePath:qt("string")};class Fw extends jw{constructor(e,t,i){super(e,t,PN(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new is(this.firestore,null,new Ee(e))}withConverter(e){return new Fw(this.firestore,e,this._path)}}const Tb="AsyncQueue";class Sb{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new dD(this,"async_queue_retry"),this._c=()=>{const i=bp();i&&pe(Tb,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=bp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=bp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new cl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ll(e))throw e;pe(Tb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Si("INTERNAL UNHANDLED ERROR: ",Ib(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Lw.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Pe(47125,{Pc:Ib(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Ib(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class ED extends wD{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Sb,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Sb(e),this._firestoreClient=void 0,await e}}}function BW(n,e){const t=typeof n=="object"?n:nw(),i=typeof n=="string"?n:pm,r=ny(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=ek("firestore");s&&UW(r,...s)}return r}function GW(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new k7(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,vD(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new zW(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function WW(n,e){oy("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return $W(n,Sx.provider,{build:i=>new VW(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function $W(n,e,t){if((n=Qk(n,ED))._firestoreClient||n._terminated)throw new Se(le.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Se(le.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},GW(n)}class Fs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fs(hi.fromBase64String(e))}catch(t){throw new Se(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Fs(hi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Fs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ef(e,Fs._jsonSchema))return Fs.fromBase64String(e.bytes)}}Fs._jsonSchemaVersion="firestore/bytes/1.0",Fs._jsonSchema={type:qt("string",Fs._jsonSchemaVersion),bytes:qt("string")};class TD{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Se(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class dl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Se(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Se(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return He(this._lat,e._lat)||He(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:dl._jsonSchemaVersion}}static fromJSON(e){if(Ef(e,dl._jsonSchema))return new dl(e.latitude,e.longitude)}}dl._jsonSchemaVersion="firestore/geoPoint/1.0",dl._jsonSchema={type:qt("string",dl._jsonSchemaVersion),latitude:qt("number"),longitude:qt("number")};class fl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:fl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ef(e,fl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new fl(e.vectorValues);throw new Se(le.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fl._jsonSchemaVersion="firestore/vectorValue/1.0",fl._jsonSchema={type:qt("string",fl._jsonSchemaVersion),vectorValues:qt("object")};const HW=new RegExp("[~\\*/\\[\\]]");function KW(n,e,t){if(e.search(HW)>=0)throw Cb(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new TD(...e.split("."))._internalPath}catch{throw Cb(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function Cb(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new Se(le.INVALID_ARGUMENT,s+n+o)}class SD{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new is(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new qW(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ID("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class qW extends SD{data(){return super.data()}}function ID(n,e){return typeof e=="string"?KW(n,e):e instanceof TD?e._internalPath:e._delegate._internalPath}class op{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nu extends SD{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ap(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(ID("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(le.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=nu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}nu._jsonSchemaVersion="firestore/documentSnapshot/1.0",nu._jsonSchema={type:qt("string",nu._jsonSchemaVersion),bundleSource:qt("string","DocumentSnapshot"),bundleName:qt("string"),bundle:qt("string")};class Ap extends nu{data(e={}){return super.data(e)}}class pd{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new op(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Ap(this._firestore,this._userDataWriter,i.key,i,new op(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Se(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const u=new Ap(r._firestore,r._userDataWriter,l.doc.key,l.doc,new op(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new Ap(r._firestore,r._userDataWriter,l.doc.key,l.doc,new op(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:XW(l.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(le.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=pd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Yk.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function XW(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pe(61501,{type:n})}}pd._jsonSchemaVersion="firestore/querySnapshot/1.0",pd._jsonSchema={type:qt("string",pd._jsonSchemaVersion),bundleSource:qt("string","QuerySnapshot"),bundleName:qt("string"),bundle:qt("string")};(function(e,t=!0){(function(r){Fu=r})(Ml),El(new ia("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new ED(new z8(i.getProvider("auth-internal")),new G8(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Se(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tu(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),os(mR,yR,e),os(mR,yR,"esm2020")})();const CD="firebasestorage.googleapis.com",YW="storageBucket",ZW=120*1e3,QW=600*1e3;class gs extends fs{constructor(e,t,i=0){super(sv(e),`Firebase Storage: ${t} (${sv(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,gs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return sv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var us;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(us||(us={}));function sv(n){return"storage/"+n}function JW(){const n="An unknown error occurred, please check the error payload for server response.";return new gs(us.UNKNOWN,n)}function e$(){return new gs(us.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function t$(){return new gs(us.CANCELED,"User canceled the upload/download.")}function n$(n){return new gs(us.INVALID_URL,"Invalid URL '"+n+"'.")}function i$(n){return new gs(us.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Rb(n){return new gs(us.INVALID_ARGUMENT,n)}function RD(){return new gs(us.APP_DELETED,"The Firebase app was deleted.")}function r$(n){return new gs(us.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Er{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Er.makeFromUrl(e,t)}catch{return new Er(e,"")}if(i.path==="")return i;throw i$(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(L){L.path_=decodeURIComponent(L.path)}const f="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",x=new RegExp(`^https?://${p}/${f}/b/${r}/o${_}`,"i"),S={bucket:1,path:3},C=t===CD?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",b=new RegExp(`^https?://${C}/${r}/${T}`,"i"),A=[{regex:l,indices:u,postModify:s},{regex:x,indices:S,postModify:h},{regex:b,indices:{bucket:1,path:2},postModify:h}];for(let L=0;L<A.length;L++){const O=A[L],B=O.regex.exec(e);if(B){const M=B[O.indices.bucket];let I=B[O.indices.path];I||(I=""),i=new Er(M,I),O.postModify(i);break}}if(i==null)throw n$(e);return i}}class s${constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function o$(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function f(...T){h||(h=!0,e.apply(null,T))}function p(T){r=setTimeout(()=>{r=null,n(x,u())},T)}function _(){s&&clearTimeout(s)}function x(T,...b){if(h){_();return}if(T){_(),f.call(null,T,...b);return}if(u()||o){_(),f.call(null,T,...b);return}i<64&&(i*=2);let A;l===1?(l=2,A=0):A=(i+Math.random())*1e3,p(A)}let S=!1;function C(T){S||(S=!0,_(),!h&&(r!==null?(T||(l=2),clearTimeout(r),p(0)):T||(l=1)))}return p(0),s=setTimeout(()=>{o=!0,C(!0)},t),C}function a$(n){n(!1)}function l$(n){return n!==void 0}function bb(n,e,t,i){if(i<e)throw Rb(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Rb(`Invalid value for '${n}'. Expected ${t} or less.`)}function c$(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var Sm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Sm||(Sm={}));function u$(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class h${constructor(e,t,i,r,s,o,l,u,h,f,p,_=!0,x=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=p,this.retry=_,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,C)=>{this.resolve_=S,this.reject_=C,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new ap(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===Sm.NO_ERROR,u=s.getStatus();if(!l||u$(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===Sm.ABORT;i(!1,new ap(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new ap(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());l$(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=JW();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?RD():t$();o(u)}else{const u=e$();o(u)}};this.canceled_?t(!1,new ap(!1,null,!0)):this.backoffId_=o$(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&a$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ap{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function d$(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function f$(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function g$(n,e){e&&(n["X-Firebase-GMPID"]=e)}function p$(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function m$(n,e,t,i,r,s,o=!0,l=!1){const u=c$(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return g$(f,e),d$(f,t),f$(f,s),p$(f,i),new h$(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function y$(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function _$(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Im{constructor(e,t){this._service=e,t instanceof Er?this._location=t:this._location=Er.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Im(e,t)}get root(){const e=new Er(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return _$(this._location.path)}get storage(){return this._service}get parent(){const e=y$(this._location.path);if(e===null)return null;const t=new Er(this._location.bucket,e);return new Im(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw r$(e)}}function Ab(n,e){const t=e?.[YW];return t==null?null:Er.makeFromBucketSpec(t,n)}function v$(n,e,t,i={}){n.host=`${e}:${t}`;const r=Dl(e);r&&(Q1(`https://${n.host}/b`),J1("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:ik(s,n.app.options.projectId))}class x${constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=CD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ZW,this._maxUploadRetryTime=QW,this._requests=new Set,r!=null?this._bucket=Er.makeFromBucketSpec(r,this._host):this._bucket=Ab(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Er.makeFromBucketSpec(this._url,e):this._bucket=Ab(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){bb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){bb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(qi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Im(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new s$(RD());{const o=m$(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const Pb="@firebase/storage",kb="0.14.0";const bD="storage";function w$(n=nw(),e){n=no(n);const i=ny(n,bD).getImmediate({identifier:e}),r=ek("storage");return r&&E$(i,...r),i}function E$(n,e,t,i={}){v$(n,e,t,i)}function T$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new x$(t,i,r,e,Ml)}function S$(){El(new ia(bD,T$,"PUBLIC").setMultipleInstances(!0)),os(Pb,kb,""),os(Pb,kb,"esm2020")}S$();const I$={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},Vw=uk(I$),ov=M8(Vw),C$=BW(Vw);w$(Vw);WW(C$).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const R$="visvriend2024",b$=new js,AD=br()(mf((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===R$;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await GB(ov,b$);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await TB(ov),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{EB(ov,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})})),zw="https://waterwebservices.rijkswaterstaat.nl/ONLINEWAARNEMINGENSERVICES_DBO",Xd=[{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556,x:97580,y:497920},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664,x:75580,y:458220},{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12,x:65150,y:444150},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961,x:30410,y:385360},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456,x:109200,y:553200},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083,x:158e3,y:576500},{id:"TERSLNZE",name:"Terschelling",lat:53.4397,lng:5.3281,x:155e3,y:606e3},{id:"TEXLHORS",name:"Texel Hors",lat:52.9983,lng:4.6981,x:106e3,y:557e3},{id:"EEMHVN",name:"Eemhaven",lat:51.9,lng:4.4833,x:9e4,y:436e3},{id:"KATSVR",name:"Kats",lat:51.5694,lng:3.9389,x:53e3,y:399e3}];function A$(n,e){let t=Xd[0],i=1/0;for(const r of Xd){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}async function P$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"T"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${zw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching water temperature:",r),null}}async function k$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"GOLFHTE"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${zw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching wave height:",r),null}}async function N$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"STROOMSHD"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${zw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0){const l=o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null;return l!==null?{speed:l,direction:0}:null}}return null}catch(r){return console.error("Error fetching current speed:",r),null}}async function D$(n){const[e,t,i]=await Promise.all([P$(n),k$(n),N$(n)]);return{temperature:e??void 0,waveHeight:t??void 0,currentSpeed:i?.speed??void 0,currentDirection:i?.direction??void 0,timestamp:new Date,station:n}}function Nb(n){const e=new Date().getMonth(),i=[5,4,5,8,12,16,18,19,17,13,9,6][e]+(Math.random()*2-1),r=30+Math.random()*80,s=Math.random()*60,o=Math.random()*360;return{temperature:Math.round(i*10)/10,waveHeight:Math.round(r),currentSpeed:Math.round(s),currentDirection:Math.round(o),timestamp:new Date,station:n}}const Db=br((n,e)=>({station:Xd[1],waterData:null,lastUpdated:null,isLoading:!1,error:null,useSimulatedData:!0,setStation:t=>n({station:t}),setStationByPosition:(t,i)=>{const r=A$(t,i);n({station:r})},fetchData:async()=>{const{station:t,useSimulatedData:i}=e();if(t){n({isLoading:!0,error:null});try{let r;i?r=Nb(t):r=await D$(t),n({waterData:r,lastUpdated:new Date,isLoading:!1})}catch(r){console.error("Error fetching water data:",r);const s=Nb(t);n({waterData:s,lastUpdated:new Date,isLoading:!1,error:"Kon geen live data ophalen, gesimuleerde data wordt getoond"})}}},setUseSimulatedData:t=>n({useSimulatedData:t})}));function M$({target:n}){const e=K.useRef(null),t=K.useRef(null),i=ds(s=>s.setMap),r=at(s=>s.showScaleBar);return K.useEffect(()=>{if(!e.current){const s=new E9({target:n,controls:[],view:new Jr({center:pl([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),K.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new I9({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const L$=["OpenStreetMap","Luchtfoto","Terrein"];function O$(){const n=K.useRef(null),e=K.useRef(!1);M$({target:"map"});const t=ds(u=>u.map),i=Ki(u=>u.registerLayer),r=Ki(u=>u.setLayerVisibility);Ki(u=>u.setLayerOpacity);const s=at(u=>u.defaultBackground),o=at(u=>u.gpsAutoStart),l=si(u=>u.startTracking);return K.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const u=at.getState().defaultBackground||"Terrein",h=u==="OpenStreetMap",f=u==="Luchtfoto",p=u==="Terrein";console.log("Background setting:",u);const _=new Yg({properties:{title:"Terrein",type:"base"},visible:p,source:new pp({url:"https://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors, SRTM | Map style:  OpenTopoMap (CC-BY-SA)",maxZoom:17})}),x=new Yg({properties:{title:"OpenStreetMap",type:"base"},visible:h,source:new B6}),S=new Yg({properties:{title:"Luchtfoto",type:"base"},visible:f,source:new pp({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),C=new Yg({properties:{title:"Labels Overlay",type:"overlay"},visible:f,source:new pp({url:"https://{a-d}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})});t.addLayer(_),t.addLayer(x),t.addLayer(S),t.addLayer(C),i("Terrein",_),i("OpenStreetMap",x),i("Luchtfoto",S),i("Labels Overlay",C),r("Terrein",p),r("OpenStreetMap",h),r("Luchtfoto",f),r("Labels Overlay",f),t.updateSize(),T();async function T(){const b=Z9();console.log(`Loading ${b.length} immediate layers...`),(await Promise.allSettled(b.map(async A=>{try{const L=await A.factory();return L?{name:A.name,layer:L}:null}catch(L){return console.warn(`Failed to create ${A.name}:`,L),null}}))).forEach(A=>{if(A.status==="fulfilled"&&A.value){const{name:L,layer:O}=A.value;t.addLayer(O),i(L,O)}})}},[t,i]),K.useEffect(()=>{if(!t||e.current)return;const u=setTimeout(()=>{const h=s||"OpenStreetMap";L$.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(u)},[t,s,r]),K.useEffect(()=>{if(!t||!o)return;const u=setTimeout(()=>l(),500);return()=>clearTimeout(u)},[t,o,l]),y.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const j$=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),F$=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),Mb=n=>{const e=F$(n);return e.charAt(0).toUpperCase()+e.slice(1)},PD=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),V$=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var z$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const U$=K.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},u)=>K.createElement("svg",{ref:u,...z$,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:PD("lucide",r),...!s&&!V$(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>K.createElement(h,f)),...Array.isArray(s)?s:[s]]));const Ce=(n,e)=>{const t=K.forwardRef(({className:i,...r},s)=>K.createElement(U$,{ref:s,iconNode:e,className:PD(`lucide-${j$(Mb(n))}`,`lucide-${n}`,i),...r}));return t.displayName=Mb(n),t};const B$=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],kD=Ce("anchor",B$);const G$=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],W$=Ce("book-open",G$);const $$=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Uw=Ce("camera",$$);const H$=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],K$=Ce("chart-column",H$);const q$=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Cm=Ce("check",q$);const X$=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Y$=Ce("chevron-down",X$);const Z$=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Q$=Ce("chevron-left",Z$);const J$=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],qc=Ce("chevron-right",J$);const eH=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ND=Ce("chevron-up",eH);const tH=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],nH=Ce("cloud-fog",tH);const iH=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],rH=Ce("cloud-lightning",iH);const sH=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],Iy=Ce("cloud-rain",sH);const oH=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],aH=Ce("cloud-snow",oH);const lH=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],Pu=Ce("cloud",lH);const cH=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],DD=Ce("droplets",cH);const uH=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],MD=Ce("external-link",uH);const hH=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],dH=Ce("eye-off",hH);const fH=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],gH=Ce("eye",fH);const pH=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],mH=Ce("file-text",pH);const yH=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],Qs=Ce("fish",yH);const _H=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],LD=Ce("gauge",_H);const vH=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],xH=Ce("image-plus",vH);const wH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],OD=Ce("info",wH);const EH=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Yd=Ce("layers",EH);const TH=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],SH=Ce("loader-circle",TH);const IH=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],CH=Ce("locate-fixed",IH);const RH=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],bH=Ce("lock",RH);const AH=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],PH=Ce("log-out",AH);const kH=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Js=Ce("map-pin",kH);const NH=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Cy=Ce("map",NH);const DH=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],MH=Ce("menu",DH);const LH=[["path",{d:"M5 12h14",key:"1ays0h"}]],jD=Ce("minus",LH);const OH=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],jH=Ce("mountain",OH);const FH=[["polygon",{points:"12 2 19 21 12 17 5 21 12 2",key:"x8c0qg"}]],VH=Ce("navigation-2",FH);const zH=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],ku=Ce("navigation",zH);const UH=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],BH=Ce("pause",UH);const GH=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],WH=Ce("person-standing",GH);const $H=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],HH=Ce("play",$H);const KH=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],qH=Ce("plus",KH);const XH=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],YH=Ce("refresh-cw",XH);const ZH=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],QH=Ce("rotate-ccw",ZH);const JH=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],eK=Ce("ruler",JH);const tK=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],nK=Ce("save",tK);const iK=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],rK=Ce("scale",iK);const sK=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ix=Ce("search",sK);const oK=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],aK=Ce("settings",oK);const lK=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],cK=Ce("ship",lK);const uK=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],hK=Ce("sparkles",uK);const dK=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Cx=Ce("star",dK);const fK=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],gK=Ce("sun",fK);const pK=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],mK=Ce("tag",pK);const yK=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],_K=Ce("thermometer",yK);const vK=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],FD=Ce("trending-down",vK);const xK=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],VD=Ce("trending-up",xK);const wK=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],EK=Ce("type",wK);const TK=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],SK=Ce("user",TK);const IK=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],Zd=Ce("waves",IK);const CK=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],Rx=Ce("wind",CK);const RK=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],di=Ce("x",RK);async function bK(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e(null);return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,p=r.getUint16(f)===18761,_=AK(r,f,p);e(_);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e(null)},t.onerror=()=>e(null),t.readAsArrayBuffer(n)})}function AK(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null;for(let p=0;p<r;p++){const _=i+2+p*12;if(n.getUint16(_,t)===34853){s=e+n.getUint32(_+8,t);break}}if(!s)return null;const o=n.getUint16(s,t);let l=null,u=null,h=null,f=null;for(let p=0;p<o;p++){const _=s+2+p*12,x=n.getUint16(_,t),S=n.getUint16(_+2,t),C=n.getUint32(_+4,t),T=_+8;switch(x){case 1:l=String.fromCharCode(n.getUint8(T));break;case 2:u=Lb(n,e+n.getUint32(T,t),3,t);break;case 3:h=String.fromCharCode(n.getUint8(T));break;case 4:f=Lb(n,e+n.getUint32(T,t),3,t);break}}if(u&&f&&l&&h){const p=Ob(u[0],u[1],u[2],l),_=Ob(f[0],f[1],f[2],h);if(!isNaN(p)&&!isNaN(_))return{lat:p,lng:_}}return null}catch{return null}}function Lb(n,e,t,i){const r=[];for(let s=0;s<t;s++){const o=n.getUint32(e+s*8,i),l=n.getUint32(e+s*8+4,i);r.push(l===0?0:o/l)}return r}function Ob(n,e,t,i){let r=n+e/60+t/3600;return(i==="S"||i==="W")&&(r=-r),r}const zD=200,PK=.7;async function kK(n,e=zD){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,u=r.height;l>u?l>e&&(u=Math.round(u*e/l),l=e):u>e&&(l=Math.round(l*e/u),u=e),s.width=l,s.height=u,o?.drawImage(r,0,0,l,u),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",PK)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function NK(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function UD(n){const e=await kK(n,zD),t=await NK(e);return{thumbnailBlob:e,thumbnailBase64:t}}function BD(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function DK(){const n=ds(D=>D.map),e=Ln(D=>D.openCatchForm),t=at(D=>D.showWeatherWidget),i=at(D=>D.setShowWeatherWidget),r=at(D=>D.showWindIndicator),s=at(D=>D.setShowWindIndicator),o=at(D=>D.showTideWidget),l=at(D=>D.setShowTideWidget),u=at(D=>D.showForecastSlider),h=at(D=>D.setShowForecastSlider),[f,p]=K.useState(null),[_,x]=K.useState(!1),[S,C]=K.useState(!1),[T,b]=K.useState(!1),k=K.useRef(null),A=K.useRef(null);K.useEffect(()=>{if(!n)return;const D=n.getViewport();if(!D)return;const se=600,de=15,me=ie=>{if(ie.touches.length!==1)return;const fe=ie.touches[0];A.current={x:fe.clientX,y:fe.clientY},k.current&&clearTimeout(k.current),k.current=window.setTimeout(()=>{if(!A.current)return;const ye=window.__olMap;if(!ye)return;const Ie=D.getBoundingClientRect(),Re=[A.current.x-Ie.left,A.current.y-Ie.top],Me=ye.getCoordinateFromPixel(Re);if(Me){const Ge=kv(Me);ie.preventDefault(),p({pixel:[A.current.x,A.current.y],coordinate:Ge}),x(!0),C(!1),setTimeout(()=>C(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},se)},ue=ie=>{if(!k.current||!A.current)return;const fe=ie.touches[0],ye=fe.clientX-A.current.x,Ie=fe.clientY-A.current.y;Math.sqrt(ye*ye+Ie*Ie)>de&&(clearTimeout(k.current),k.current=null)},J=()=>{k.current&&(clearTimeout(k.current),k.current=null),A.current=null},Z=ie=>{_&&ie.preventDefault()},ne=ie=>{ie.button===0&&(A.current={x:ie.clientX,y:ie.clientY},k.current&&clearTimeout(k.current),k.current=window.setTimeout(()=>{if(!A.current)return;const fe=window.__olMap;if(!fe)return;const ye=D.getBoundingClientRect(),Ie=[A.current.x-ye.left,A.current.y-ye.top],Re=fe.getCoordinateFromPixel(Ie);if(Re){const Me=kv(Re);p({pixel:[A.current.x,A.current.y],coordinate:Me}),x(!0),C(!1),setTimeout(()=>C(!0),300)}},se))},G=ie=>{if(!k.current||!A.current)return;const fe=ie.clientX-A.current.x,ye=ie.clientY-A.current.y;Math.sqrt(fe*fe+ye*ye)>de&&(clearTimeout(k.current),k.current=null)},$=()=>{k.current&&(clearTimeout(k.current),k.current=null),A.current=null};return D.addEventListener("touchstart",me,{passive:!1}),D.addEventListener("touchmove",ue,{passive:!0}),D.addEventListener("touchend",J),D.addEventListener("touchcancel",J),D.addEventListener("contextmenu",Z),D.addEventListener("mousedown",ne),D.addEventListener("mousemove",G),D.addEventListener("mouseup",$),D.addEventListener("mouseleave",$),()=>{D.removeEventListener("touchstart",me),D.removeEventListener("touchmove",ue),D.removeEventListener("touchend",J),D.removeEventListener("touchcancel",J),D.removeEventListener("contextmenu",Z),D.removeEventListener("mousedown",ne),D.removeEventListener("mousemove",G),D.removeEventListener("mouseup",$),D.removeEventListener("mouseleave",$),k.current&&clearTimeout(k.current)}},[n,_]);const L=()=>{S&&(x(!1),p(null),C(!1))},O=()=>{x(!1),p(null),C(!1),b(!1)},B=K.useRef(null),M=()=>{if(!f)return;const[D,se]=f.coordinate;e({location:{lat:se,lng:D},locationSource:"map"}),O()},I=()=>{B.current?.click()},N=async D=>{const se=D.target.files?.[0];if(!(!se||!f)){try{const de=await bK(se),{thumbnailBase64:me}=await UD(se),ue={id:BD(),thumbnailBase64:me,createdAt:new Date().toISOString(),pendingUpload:!0};if(de)e({location:de,locationSource:"photo",photos:[ue]});else{const[J,Z]=f.coordinate;e({location:{lat:Z,lng:J},locationSource:"map",photos:[ue]})}}catch(de){console.error("Failed to process photo:",de);const[me,ue]=f.coordinate;e({location:{lat:ue,lng:me},locationSource:"map"})}D.target.value="",O()}},F=()=>{if(!f)return;const[D,se]=f.coordinate,de=`https://www.google.com/maps?q=${se},${D}`;window.open(de,"_blank"),O()},V=()=>{if(!f)return;const[D,se]=f.coordinate,de=`https://www.google.com/maps?layer=c&cbll=${se},${D}`;window.open(de,"_blank"),O()},U=D=>{const[se,de]=D;return`${de.toFixed(5)}N, ${se.toFixed(5)}E`};return y.jsx(On,{children:_&&f&&y.jsxs(y.Fragment,{children:[y.jsx(Ue.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:L}),y.jsxs(Ue.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(f.pixel[0],window.innerWidth-220),top:Math.min(f.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[y.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:y.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[y.jsx(Js,{size:16}),y.jsx("span",{className:"text-xs font-mono",children:U(f.coordinate)})]})}),y.jsxs("div",{className:"bg-white",children:[y.jsxs("button",{onClick:I,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(Uw,{size:20,className:"text-green-500"}),y.jsx("span",{className:"font-medium",children:"Maak foto"})]}),y.jsxs("button",{onClick:M,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(Qs,{size:20,className:"text-orange-500"}),y.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),y.jsxs("button",{onClick:V,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(WH,{size:20,className:"text-yellow-600"}),y.jsx("span",{className:"font-medium",children:"Street View"})]}),y.jsxs("button",{onClick:F,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(MD,{size:20,className:"text-blue-600"}),y.jsx("span",{className:"font-medium",children:"Google Maps"})]}),y.jsxs("button",{onClick:()=>b(!T),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(Pu,{size:20,className:"text-purple-500"}),y.jsx("span",{className:"font-medium",children:"Widgets"}),y.jsx(qc,{size:16,className:`ml-auto text-gray-400 transition-transform ${T?"rotate-90":""}`})]}),y.jsx(On,{children:T&&y.jsx(Ue.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden bg-gray-50",children:y.jsxs("div",{className:"py-1",children:[y.jsx(lp,{icon:y.jsx(Pu,{size:16,className:"text-blue-500"}),label:"Weer widget",checked:t,onChange:i}),y.jsx(lp,{icon:y.jsx(Rx,{size:16,className:"text-cyan-500"}),label:"Wind indicator",checked:r,onChange:s}),y.jsx(lp,{icon:y.jsx(Zd,{size:16,className:"text-blue-400"}),label:"Getijden widget",checked:o,onChange:l}),y.jsx(lp,{icon:y.jsx(K$,{size:16,className:"text-orange-500"}),label:"Voorspelling schuif",checked:u,onChange:h})]})})})]}),y.jsx("input",{ref:B,type:"file",accept:"image/*",capture:"environment",onChange:N,className:"hidden"}),y.jsx("div",{className:"bg-white",children:y.jsxs("button",{onClick:O,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[y.jsx(di,{size:18}),y.jsx("span",{children:"Annuleren"})]})})]})]})})}function lp({icon:n,label:e,checked:t,onChange:i}){return y.jsxs("button",{onClick:()=>i(!t),className:"w-full px-4 py-2.5 flex items-center gap-3 hover:bg-gray-100 transition-colors border-0 outline-none bg-transparent",children:[n,y.jsx("span",{className:"text-sm text-gray-700 flex-1 text-left",children:e}),y.jsx("div",{className:`w-9 h-5 rounded-full transition-colors ${t?"bg-blue-500":"bg-gray-300"}`,children:y.jsx("div",{className:`w-4 h-4 mt-0.5 rounded-full bg-white shadow transition-transform ${t?"ml-4.5 translate-x-0":"ml-0.5"}`,style:{marginLeft:t?"18px":"2px"}})})]})}function MK(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=si(),s=K.useCallback(l=>{i(l)},[i]),o=K.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return K.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function LK(){const{tracking:n,toggle:e}=MK();return y.jsx(Ue.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:y.jsx(CH,{size:22,strokeWidth:2})})}const OK="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function jK(){const n=ds(_=>_.map),e=si(_=>_.position),t=si(_=>_.accuracy),i=si(_=>_.tracking),r=si(_=>_.smoothHeading),s=at(_=>_.showAccuracyCircle),o=si(_=>_.firstFix),l=si(_=>_.resetFirstFix),u=K.useRef(null),h=K.useRef(null),f=K.useRef(null),p=K.useMemo(()=>_=>new Ji({image:new L1({src:OK,scale:.9,rotation:_,rotateWithView:!1,anchor:[.5,.5]})}),[]);return K.useEffect(()=>{if(!n||!i&&!e)return;const _=pl([5.1214,52.0907]);return u.current=new lu({geometry:new ml(_)}),u.current.setStyle(p(0)),h.current=new lu({geometry:new ml(_)}),f.current=new G1({source:new M1({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,p]),K.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const _=pl([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(_),h.current.getGeometry()?.setCoordinates(_),s&&t){const x=n.getView().getResolution()||1,S=Math.min(t/x,80);h.current.setStyle(new Ji({image:new kl({radius:S,fill:new Cr({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new Ji({}));if(o&&i){n.getView().setCenter(_),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:_,duration:150})},[n,i,e,t,o,l,s]),K.useEffect(()=>{if(!u.current)return;const _=r!==null?r*Math.PI/180:0;u.current.setStyle(p(_))},[r,p]),null}function FK(){const n=ds(A=>A.map),[e,t]=K.useState(!1),[i,r]=K.useState(""),[s,o]=K.useState([]),[l,u]=K.useState(!1),[h,f]=K.useState(!1),p=K.useRef(null),_=K.useRef(null),x=K.useRef();K.useEffect(()=>{e&&p.current&&p.current.focus()},[e]),K.useEffect(()=>{if(!e)return;const A=L=>{_.current&&!_.current.contains(L.target)&&S()};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[e]),K.useEffect(()=>{if(!e)return;const A=L=>{L.key==="Escape"&&S()};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[e]),K.useEffect(()=>{if(x.current&&clearTimeout(x.current),i.length<2){o([]);return}return x.current=window.setTimeout(async()=>{f(!0);try{const L=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();L.response?.docs&&o(L.response.docs)}catch(A){console.error("Search error:",A),o([])}finally{f(!1)}},300),()=>{x.current&&clearTimeout(x.current)}},[i]);const S=()=>{t(!1),r(""),o([]),u(!1)},C=async A=>{try{const O=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(A)}`)).json();if(O.response?.docs?.[0]?.centroide_ll){const M=O.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(M)return{lng:parseFloat(M[1]),lat:parseFloat(M[2])}}}catch(L){console.error("Lookup error:",L)}return null},T=async A=>{if(!n)return;const L=await C(A.id);L&&n.getView().animate({center:pl([L.lng,L.lat]),zoom:16,duration:1e3}),S()},b=async(A,L)=>{L.stopPropagation();const O=await C(A.id);if(O){const B=`https://www.google.com/maps?q=${O.lat},${O.lng}`;window.open(B,"_blank")}S()},k={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?y.jsxs("div",{ref:_,className:"fixed left-[52px] right-14 z-[850]",style:k,children:[y.jsxs(Ue.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[y.jsx(Ix,{size:18,className:"search-icon"}),y.jsx("input",{ref:p,type:"text",value:i,onChange:A=>{r(A.target.value),u(!0)},onFocus:()=>u(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),y.jsx("button",{onClick:S,className:"search-clear",title:"Sluiten",children:y.jsx(di,{size:18})})]}),y.jsx(On,{children:l&&s.length>0&&y.jsx(Ue.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(A=>y.jsxs("li",{className:"search-result-item",children:[y.jsx("div",{className:"search-result-content",onClick:()=>T(A),children:y.jsx("span",{className:"search-result-text",children:A.weergavenaam})}),y.jsx("button",{className:"search-navigate-btn",onClick:L=>b(A,L),title:"Open in Google Maps",children:y.jsx(MD,{size:20})})]},A.id))})}),l&&h&&y.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):y.jsx(Ue.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:k,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:y.jsx(Ix,{size:22,className:"text-gray-600"})})}function VK({size:n=18}){return y.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[y.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),y.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),y.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),y.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function zK(){const[n,e]=K.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=Ln(),{user:r,loading:s,signInWithGoogle:o,logout:l}=AD(),u=at(T=>T.showCatchButton),h=at(T=>T.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},p=()=>e(!1),_=()=>{p(),t()},x=()=>{p(),i()},S=()=>{p(),o()},C=()=>{p(),l()};return y.jsxs(y.Fragment,{children:[y.jsx(Ue.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?y.jsx(di,{size:22,className:"text-white"}):y.jsx(MH,{size:22,className:"text-gray-600"})}),y.jsx(On,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Ue.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:p}),y.jsxs(Ue.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[y.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-blue-500",children:y.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?y.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:y.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):r?y.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:y.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?y.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):y.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:y.jsx(SK,{size:16,className:"text-white"})}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),y.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),y.jsx("button",{onClick:C,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:y.jsx(PH,{size:16})})]})}):y.jsxs("button",{onClick:S,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[y.jsx(VK,{size:18}),y.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),y.jsx("div",{className:"py-1",children:y.jsxs("button",{onClick:_,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[y.jsx(OD,{size:18,className:"text-blue-500"}),y.jsx("span",{children:"Info & handleiding"})]})}),y.jsx("div",{className:"py-1 border-t border-gray-100",children:y.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(Qs,{size:18,className:"text-green-500"}),y.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),y.jsx("button",{onClick:()=>h(!u),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${u?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:y.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${u?"left-[22px]":"left-0.5"}`})})]})}),y.jsx("div",{className:"mt-auto border-t border-gray-100",children:y.jsxs("button",{onClick:x,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[y.jsx(aK,{size:18,className:"text-gray-500"}),y.jsx("span",{children:"Instellingen"})]})}),y.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.5"})]})]})})]})}function UK(){const{infoPanelOpen:n,toggleInfoPanel:e}=Ln(),[t,i]=K.useState("info"),r=[{id:"info",label:"Info",icon:y.jsx(OD,{size:14})},{id:"functies",label:"Functies",icon:y.jsx(mH,{size:14})},{id:"handleiding",label:"Handleiding",icon:y.jsx(W$,{size:14})}];return y.jsx(On,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Ue.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),y.jsxs(Ue.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[y.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.5"}),y.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:y.jsx(di,{size:18,className:"text-white",strokeWidth:2.5})})]}),y.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>y.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),y.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&y.jsx(BK,{}),t==="functies"&&y.jsx(GK,{}),t==="handleiding"&&y.jsx(WK,{}),y.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:y.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.5 - Voor jou en je vismaat"})})]})]})]})})}function BK(){return y.jsxs(y.Fragment,{children:[y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),y.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),y.jsxs("ul",{className:"space-y-2 text-gray-600",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),y.jsxs("li",{children:[y.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),y.jsxs("div",{className:"text-gray-600 space-y-2",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function GK(){return y.jsxs(y.Fragment,{children:[y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(Cy,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(Qs,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:"Registreer soort, gewicht en lengte"}),y.jsx("li",{children:"Vismethode en aas bijhouden"}),y.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),y.jsx("li",{children:"GPS locatie per vangst"})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(Js,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:"Markeer je beste visplekken"}),y.jsx("li",{children:"Voeg notities en ratings toe"}),y.jsx("li",{children:"Welke vis zit waar?"})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(Pu,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:"Live weergegevens op je locatie"}),y.jsx("li",{children:"Windsnelheid en richting"}),y.jsx("li",{children:"Luchtdruk"}),y.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(ku,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:"Live GPS tracking"}),y.jsx("li",{children:"Zoek adressen en plaatsen"}),y.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function WK(){return y.jsxs(y.Fragment,{children:[y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),y.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[y.jsxs("li",{children:["Tik op de ",y.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),y.jsxs("li",{children:["Gebruik het ",y.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),y.jsxs("li",{children:["Tik op de ",y.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),y.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),y.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),y.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[y.jsxs("li",{children:["Gebruik de ",y.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),y.jsxs("li",{children:["Check de ",y.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),y.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),y.jsxs("li",{children:["Markeer succesvolle plekken als ",y.jsx("strong",{children:"favoriet"})]})]})]})]})}const $K=pl([5.1214,52.0907]),HK=8;function KK(){const n=ds(r=>r.map),e=Ki(r=>r.setLayerVisibility),t=si(r=>r.stopTracking),i=()=>{t(),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Labels Overlay",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:$K,zoom:HK,rotation:0,duration:500})};return y.jsx(Ue.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:y.jsx(QH,{size:18,className:"text-gray-600"})})}const qK={Map:Cy,Fish:Qs,Anchor:kD,Layers:Yd,Star:Cx},XK={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},YK={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function ZK(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=iz(),[r,s]=K.useState(!1),[o,l]=K.useState(null),[u,h]=K.useState(!1),[f,p]=K.useState(""),_=C=>{e(C),s(!1)},x=(C,T)=>{C.stopPropagation();const{useLayerStore:b}=require("../../store"),k=b.getState().visible,A=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(L=>k[L]);t(T,{layers:A}),l(T),setTimeout(()=>l(null),2e3)},S=()=>{f.trim()&&(i(f.trim()),p(""),h(!1))};return y.jsxs(y.Fragment,{children:[y.jsx(Ue.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?y.jsx(ND,{size:20,className:"text-blue-600"}):y.jsx(Yd,{size:20,className:"text-gray-600"})}),y.jsx(On,{children:r&&y.jsxs(y.Fragment,{children:[y.jsx(Ue.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),y.jsxs(Ue.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[y.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:y.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),y.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(C=>{const T=qK[C.icon]||Yd,b=XK[C.icon]||"text-blue-600",k=YK[C.icon]||"hover:bg-blue-50",A=o===C.id;return y.jsxs("button",{onClick:()=>_(C.id),className:`w-full h-9 flex items-center gap-2 px-2 ${k} rounded text-left transition-colors border-0 outline-none bg-transparent ${A?"bg-green-50":""}`,children:[y.jsx(T,{size:16,className:`${b} flex-shrink-0`}),y.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:C.name}),A?y.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:y.jsx(Cm,{size:14,className:"text-green-500"})}):y.jsx("span",{onClick:L=>x(L,C.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:y.jsx(nK,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},C.id)})}),y.jsx("div",{className:"border-t border-gray-200 p-2",children:u?y.jsxs("div",{className:"flex gap-1",children:[y.jsx("input",{type:"text",value:f,onChange:C=>p(C.target.value),onKeyDown:C=>{C.key==="Enter"&&S(),C.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400"}),y.jsx("button",{onClick:S,disabled:!f.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):y.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",children:[y.jsx(qH,{size:14}),y.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const md={lat:52.1326,lng:5.2913},QK={0:"Helder",1:"Overwegend helder",2:"Halfbewolkt",3:"Bewolkt",45:"Mist",48:"Rijpmist",51:"Lichte motregen",53:"Motregen",55:"Zware motregen",61:"Lichte regen",63:"Regen",65:"Zware regen",71:"Lichte sneeuw",73:"Sneeuw",75:"Zware sneeuw",80:"Lichte buien",81:"Buien",82:"Zware buien",95:"Onweer",96:"Onweer met hagel",99:"Zwaar onweer"};function GD({code:n,size:e=18}){return n===0?y.jsx(gK,{size:e,className:"text-yellow-500"}):n>=1&&n<=3?y.jsx(Pu,{size:e,className:"text-gray-400"}):n===45||n===48?y.jsx(nH,{size:e,className:"text-gray-400"}):n>=51&&n<=67||n>=80&&n<=82?y.jsx(Iy,{size:e,className:"text-blue-500"}):n>=71&&n<=77||n>=85&&n<=86?y.jsx(aH,{size:e,className:"text-cyan-500"}):n>=95?y.jsx(rH,{size:e,className:"text-purple-500"}):y.jsx(Pu,{size:e,className:"text-gray-400"})}function JK({degrees:n,size:e=14}){return y.jsx("div",{style:{transform:`rotate(${n+180}deg)`},className:"inline-flex",children:y.jsx(ku,{size:e,className:"text-blue-500"})})}function eq({size:n=16,className:e=""}){return y.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[y.jsx("path",{d:"M2 12h16"}),y.jsx("path",{d:"M18 12l4-4"}),y.jsx("path",{d:"M18 12l4 4"}),y.jsx("circle",{cx:"3",cy:"12",r:"1.5",fill:"currentColor"}),y.jsx("path",{d:"M6 12l1.5-3"}),y.jsx("path",{d:"M6 12l1.5 3"}),y.jsx("path",{d:"M10 12l1.5-3"}),y.jsx("path",{d:"M10 12l1.5 3"}),y.jsx("path",{d:"M14 12l1.5-2.5"}),y.jsx("path",{d:"M14 12l1.5 2.5"})]})}function bx({size:n=16,className:e="",clipPercent:t=100}){const i=`fish-clip-${Math.random().toString(36).substr(2,9)}`;return y.jsxs("svg",{width:n*(t/100),height:n,viewBox:`0 0 ${24*(t/100)} 24`,fill:"currentColor",className:e,style:{overflow:"hidden"},children:[y.jsx("defs",{children:y.jsx("clipPath",{id:i,children:y.jsx("rect",{x:"0",y:"0",width:24*(t/100),height:"24"})})}),y.jsxs("g",{clipPath:`url(#${i})`,children:[y.jsx("ellipse",{cx:"12",cy:"12",rx:"8",ry:"5"}),y.jsx("path",{d:"M3 12L0 7V17L3 12Z"}),y.jsx("circle",{cx:"17",cy:"10.5",r:"1.2",fill:"white"}),y.jsx("circle",{cx:"17.3",cy:"10.5",r:"0.5",fill:"black"}),y.jsx("path",{d:"M10 7L12 4L14 7",fill:"currentColor"}),y.jsx("path",{d:"M11 17L12 19L13 17",fill:"currentColor"})]})]})}function WD({value:n,maxFish:e=3,color:t}){const i=Math.floor(n),r=n%1,s=[];for(let o=0;o<i&&o<e;o++)s.push(y.jsx(bx,{size:18,className:t},o));return r>=.5&&i<e&&s.push(y.jsx(bx,{size:18,className:t,clipPercent:60},"half")),y.jsx("div",{className:"flex items-center gap-1",children:s.length>0?s:y.jsx(eq,{size:18,className:t})})}function Ax(n){const e=29.53058867,t=new Date("2000-01-06T18:14:00Z");return(n.getTime()-t.getTime())/(1e3*60*60*24)%e/e}function tq(n){return n<.03||n>.97?"Nieuwe maan":n<.22?"Wassende sikkel":n<.28?"Eerste kwartier":n<.47?"Wassende maan":n<.53?"Volle maan":n<.72?"Afnemende maan":n<.78?"Laatste kwartier":"Afnemende sikkel"}const nq="https://svs.gsfc.nasa.gov/vis/a000000/a004700/a004720/lroc_color_poles_1k.jpg";function iq({phase:n,size:e=20}){const t=n<=.5?n*2:(1-n)*2,i=n<.5;let r;return n<=.5?r=1-n*4:r=(n-.5)*4-1,r=Math.max(-1,Math.min(1,r)),y.jsxs("div",{className:"relative rounded-full overflow-hidden",style:{width:e,height:e,boxShadow:`0 ${e*.05}px ${e*.15}px rgba(0,0,0,0.4)`},children:[y.jsx("div",{className:"absolute inset-0 rounded-full",style:{backgroundImage:`url(${nq})`,backgroundSize:"cover",backgroundPosition:"center",filter:"contrast(1.1) brightness(1.05)"}}),y.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`
            radial-gradient(circle at 30% 25%, rgba(200,200,190,0.4) 0%, transparent 25%),
            radial-gradient(circle at 70% 60%, rgba(180,180,170,0.3) 0%, transparent 20%),
            radial-gradient(circle at 45% 75%, rgba(160,160,150,0.3) 0%, transparent 15%),
            radial-gradient(circle at 60% 30%, rgba(170,170,160,0.25) 0%, transparent 18%),
            radial-gradient(circle at 25% 55%, rgba(190,190,180,0.2) 0%, transparent 12%),
            linear-gradient(135deg, #d4d4c8 0%, #a8a89c 50%, #8c8c80 100%)
          `,mixBlendMode:"overlay"}}),y.jsxs("svg",{className:"absolute inset-0",viewBox:"0 0 100 100",style:{width:e,height:e},children:[y.jsx("defs",{children:y.jsxs("linearGradient",{id:`moonShadow-${e}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[y.jsx("stop",{offset:"0%",stopColor:"rgba(5,5,15,0.97)"}),y.jsx("stop",{offset:"40%",stopColor:"rgba(5,5,15,0.95)"}),y.jsx("stop",{offset:"100%",stopColor:"rgba(5,5,15,0)"})]})}),n<.03||n>.97?y.jsx("circle",{cx:"50",cy:"50",r:"50",fill:"rgba(5,5,15,0.95)"}):n>.47&&n<.53?null:y.jsx("ellipse",{cx:50+r*50,cy:"50",rx:Math.abs(50*(1-Math.abs(r*.8))),ry:"50",fill:"rgba(5,5,15,0.95)",style:{transform:"none"}})]}),t>.1&&y.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none",style:{background:i?`radial-gradient(circle at ${85-r*20}% 50%, rgba(255,255,240,0.15) 0%, transparent 50%)`:`radial-gradient(circle at ${15-r*20}% 50%, rgba(255,255,240,0.15) 0%, transparent 50%)`}})]})}function rq(n){const e=Ax(n),t=n.getHours(),i=Math.floor((e*24+12)%24),r=(i+6)%24,s=(i+18)%24,o=(i+12)%24,l=[i,o],u=[r,s];let h=.3;return(e<.1||e>.9||e>.4&&e<.6)&&(h+=.3),l.forEach(f=>{const p=Math.abs(t-f);p<=1||p>=23?h+=.3:(p<=2||p>=22)&&(h+=.15)}),u.forEach(f=>{Math.abs(t-f)<=1&&(h-=.1)}),{activity:Math.max(.1,Math.min(1,h)),besteTijden:l,slechteTijden:u}}function sq(n){return n<.1||n>.9||n>.4&&n<.6?{type:"Springtij",color:"text-green-600"}:n>.2&&n<.3||n>.7&&n<.8?{type:"Doodtij",color:"text-orange-600"}:{type:"Normaal",color:"text-blue-600"}}function $D(n,e){const t=[],i=29.53058867,r=new Date("2000-01-06T18:14:00Z"),s=745;for(let o=0;o<e;o++){const l=new Date(n);l.setDate(l.getDate()+o),l.setHours(0,0,0,0);const h=(l.getTime()-r.getTime())/(1e3*60*60*24)%i/i;let f=h*s*2%1440;for(let p=0;p<4;p++){const _=p%2===0,x=p*(s/2);let S=f+x;const C=Math.floor(S/1440);S=S%1440;const T=Math.floor(S/60),b=Math.floor(S%60),k=new Date(l);k.setDate(k.getDate()+C),k.setHours(T,b,0,0);const A=Math.abs(Math.sin(h*Math.PI*2)),L=_?1.8:.4,O=A*.5;t.push({time:k,height:_?L+O:L-O*.5,type:_?"high":"low"})}}return t.sort((o,l)=>o.time.getTime()-l.time.getTime())}function oq({data:n,showHeader:e=!1}){if(!n||n.length===0)return null;const t=Math.max(...n.map(s=>s.precipitation),.5),i=n.some(s=>s.precipitation>0),r=s=>{const o=new Date(s);return`${o.getHours()}:${o.getMinutes().toString().padStart(2,"0")}`};return y.jsxs("div",{className:"space-y-1",children:[e&&y.jsx("div",{className:"flex items-center justify-between",children:y.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag komende 2 uur"})}),!i&&y.jsx("div",{className:"text-[10px] text-green-600 font-medium text-right",children:"Droog"}),y.jsxs("div",{className:"relative h-10 bg-gray-100 rounded-lg overflow-hidden",children:[y.jsx("div",{className:"absolute inset-0 flex",children:[...Array(8)].map((s,o)=>y.jsx("div",{className:"flex-1 border-r border-gray-200/50"},o))}),y.jsx("div",{className:"absolute inset-0 flex items-end px-0.5",children:n.map((s,o)=>{const l=s.precipitation/t*100,u=s.precipitation>2?"bg-blue-600":s.precipitation>.5?"bg-blue-500":s.precipitation>0?"bg-blue-400":"bg-transparent";return y.jsx("div",{className:"flex-1 mx-px",title:`${r(s.time)}: ${s.precipitation.toFixed(1)} mm`,children:y.jsx("div",{className:`w-full rounded-t transition-all ${u}`,style:{height:`${Math.max(l,s.precipitation>0?8:0)}%`}})},o)})}),y.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-1 text-[8px] text-gray-400",children:[y.jsx("span",{children:"Nu"}),y.jsx("span",{children:"+1u"}),y.jsx("span",{children:"+2u"})]})]}),i&&y.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-gray-500",children:[y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-400"}),y.jsx("span",{children:"Licht"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-500"}),y.jsx("span",{children:"Matig"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-600"}),y.jsx("span",{children:"Zwaar"})]})]})]})}function aq({hourly:n}){const e=new Date,t=e.getHours(),i=n.filter(r=>new Date(r.time)>=e).slice(0,8);return i.length===0?null:y.jsxs("div",{className:"space-y-1",children:[y.jsx("div",{className:"text-[10px] text-gray-500",children:"Komende uren"}),y.jsx("div",{className:"flex gap-1 overflow-x-auto py-1 -mx-1 px-1",children:i.map((r,s)=>{const o=new Date(r.time),l=o.getHours()===t;return y.jsxs("div",{className:`flex flex-col items-center p-1.5 rounded-lg min-w-[36px] ${l?"bg-blue-100":"bg-gray-50"}`,children:[y.jsx("span",{className:"text-[9px] text-gray-500",children:l?"Nu":`${o.getHours()}:00`}),y.jsx(GD,{code:r.weatherCode,size:14}),y.jsxs("span",{className:"text-[10px] font-medium",children:[Math.round(r.temperature),""]}),r.precipitationProbability>20&&y.jsxs("span",{className:"text-[8px] text-blue-500",children:[r.precipitationProbability,"%"]})]},r.time)})})]})}const lq=[{name:"Amsterdam",lat:52.3676,lng:4.9041},{name:"Rotterdam",lat:51.9244,lng:4.4777},{name:"Den Haag",lat:52.0705,lng:4.3007},{name:"Utrecht",lat:52.0907,lng:5.1214},{name:"Eindhoven",lat:51.4416,lng:5.4697},{name:"Groningen",lat:53.2194,lng:6.5665},{name:"Tilburg",lat:51.5555,lng:5.0913},{name:"Almere",lat:52.3508,lng:5.2647},{name:"Breda",lat:51.5719,lng:4.7683},{name:"Nijmegen",lat:51.8126,lng:5.8372},{name:"Arnhem",lat:51.9851,lng:5.8987},{name:"Haarlem",lat:52.3874,lng:4.6462},{name:"Enschede",lat:52.2215,lng:6.8937},{name:"Zwolle",lat:52.5168,lng:6.083},{name:"Maastricht",lat:50.8514,lng:5.6909},{name:"Leiden",lat:52.1601,lng:4.497},{name:"Dordrecht",lat:51.8133,lng:4.6901},{name:"Zoetermeer",lat:52.0575,lng:4.4931},{name:"Leeuwarden",lat:53.2012,lng:5.7999},{name:"Den Bosch",lat:51.6978,lng:5.3037}];function cq({hourlyData:n,onClose:e,onLocationChange:t}){const[i,r]=K.useState(new Date),[s,o]=K.useState(""),[l,u]=K.useState(!1),[h,f]=K.useState(null),p=new Date,_=K.useMemo(()=>{const I=new Date(p);return I.setHours(I.getHours(),0,0,0),I},[]),x=K.useMemo(()=>{const I=new Date(_);return I.setHours(I.getHours()+48),I},[_]),S=x.getTime()-_.getTime(),C=(i.getTime()-_.getTime())/S*100,T=n.filter(I=>{const N=new Date(I.time);return N>=_&&N<=x}),b=lq.filter(I=>I.name.toLowerCase().includes(s.toLowerCase())).slice(0,6),k=I=>{const N=new Date;N.setHours(0,0,0,0);const F=new Date(I);F.setHours(0,0,0,0);const V=Math.floor((F.getTime()-N.getTime())/(1440*60*1e3));return V===0?"Vandaag":V===1?"Morgen":V===2?"Overmorgen":I.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},A=I=>`${I.getHours().toString().padStart(2,"0")}:00`,L=T.find(I=>{const N=new Date(I.time);return N.getHours()===i.getHours()&&N.getDate()===i.getDate()}),O=Math.max(...T.map(I=>I.precipitation),1),B=T.some(I=>I.precipitation>0),M=I=>{f(I.name),u(!1),o(""),t&&t(I.lat,I.lng,I.name)};return y.jsx(Ue.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:y.jsx(Ue.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:I=>I.stopPropagation(),children:y.jsxs("div",{className:"p-4 space-y-3",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Iy,{size:20,className:"text-blue-500"}),y.jsx("span",{className:"font-semibold text-gray-800",children:"Neerslag 48 uur"}),!B&&y.jsx("span",{className:"text-xs text-green-600 font-medium bg-green-50 px-2 py-0.5 rounded-full",children:"Droog"})]}),y.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:y.jsx(di,{size:16,className:"text-gray-500"})})]}),y.jsxs("div",{className:"relative",children:[y.jsxs("button",{onClick:()=>u(!l),className:"w-full flex items-center gap-2 px-3 py-2 bg-gray-50 hover:bg-gray-100 rounded-xl transition-colors border-0 outline-none text-left",children:[y.jsx(Js,{size:16,className:"text-gray-400"}),y.jsx("span",{className:"flex-1 text-sm text-gray-700",children:h||"Huidige locatie"}),y.jsx(Ix,{size:14,className:"text-gray-400"})]}),l&&y.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white rounded-xl shadow-lg border border-gray-100 z-10 overflow-hidden",children:[y.jsx("div",{className:"p-2 border-b border-gray-100",children:y.jsx("input",{type:"text",value:s,onChange:I=>o(I.target.value),placeholder:"Zoek plaats...",className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg outline-none focus:ring-2 focus:ring-blue-400",autoFocus:!0})}),y.jsxs("div",{className:"max-h-40 overflow-y-auto",children:[y.jsxs("button",{onClick:()=>{f(null),u(!1),t&&t(md.lat,md.lng,"Huidige locatie")},className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 border-0 outline-none bg-transparent text-left",children:[y.jsx(ku,{size:14,className:"text-blue-500"}),y.jsx("span",{className:"text-sm text-gray-700",children:"Huidige locatie"})]}),b.map(I=>y.jsxs("button",{onClick:()=>M(I),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 border-0 outline-none bg-transparent text-left",children:[y.jsx(Js,{size:14,className:"text-gray-400"}),y.jsx("span",{className:"text-sm text-gray-700",children:I.name})]},I.name))]})]})]}),y.jsxs("div",{className:"bg-blue-50 rounded-xl p-3 flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("div",{className:"text-xs text-gray-500",children:k(i)}),y.jsx("div",{className:"text-xl font-bold text-blue-600",children:A(i)})]}),y.jsxs("div",{className:"text-right",children:[y.jsx("div",{className:"text-2xl font-bold text-blue-600",children:L?`${L.precipitation.toFixed(1)} mm`:"0 mm"}),L&&L.precipitationProbability>0&&y.jsxs("div",{className:"text-xs text-blue-500",children:[L.precipitationProbability,"% kans"]})]})]}),y.jsxs("div",{className:"relative bg-gray-100 rounded-xl p-2 h-28",children:[y.jsx("div",{className:"absolute top-1 left-2 text-[9px] font-medium text-amber-600",children:" Nu"}),y.jsx("div",{className:"absolute inset-2 pt-3 flex items-end gap-px",children:T.map((I,N)=>{const F=I.precipitation/O*100,V=new Date(I.time),U=V.getHours()===i.getHours()&&V.getDate()===i.getDate(),D=N===0,se=I.precipitation>2?"bg-blue-600":I.precipitation>.5?"bg-blue-500":I.precipitation>0?"bg-blue-400":"bg-gray-200";return y.jsx("div",{className:"flex-1 cursor-pointer h-full flex flex-col justify-end",onClick:()=>r(V),children:y.jsx("div",{className:`w-full rounded-t transition-all ${se} ${U?"ring-2 ring-amber-400 ring-offset-1":""} ${D?"ring-1 ring-amber-500":""}`,style:{height:`${Math.max(F,I.precipitation>0?8:3)}%`}})},N)})}),y.jsxs("div",{className:"absolute bottom-0.5 left-2 right-2 flex justify-between text-[8px] text-gray-400",children:[y.jsx("span",{children:"Nu"}),y.jsx("span",{children:"+24u"}),y.jsx("span",{children:"+48u"})]})]}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("input",{type:"range",min:"0",max:"100",value:C,onChange:I=>r(new Date(_.getTime()+parseFloat(I.target.value)/100*S)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[y.jsx("span",{className:C<5?"text-amber-600 font-medium":"",children:"Nu"}),y.jsxs("span",{children:[k(i)," ",A(i)]}),y.jsx("span",{children:"+48u"})]})]}),y.jsxs("div",{className:"flex items-center justify-center gap-4 text-[10px] text-gray-400",children:[y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-400"}),y.jsx("span",{children:"Licht"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-500"}),y.jsx("span",{children:"Matig"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-600"}),y.jsx("span",{children:"Zwaar"})]})]})]})})})}function uq({onClose:n}){const[e,t]=K.useState(new Date),i=si(I=>I.position),r=[{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12},{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664}],s=(I,N)=>{let F=r[5],V=1/0;for(const U of r){const D=Math.sqrt(Math.pow(U.lat-I,2)+Math.pow(U.lng-N,2));D<V&&(V=D,F=U)}return F},[o,l]=K.useState(()=>i?s(i.lat,i.lng):r[5]),u=new Date,h=K.useMemo(()=>{const I=new Date;return I.setDate(I.getDate()-1),I.setHours(0,0,0,0),I},[]),f=K.useMemo(()=>{const I=new Date;return I.setDate(I.getDate()+2),I.setHours(23,59,59,999),I},[]),p=K.useMemo(()=>{const I=new Date(h);return $D(I,4)},[h]),_=f.getTime()-h.getTime(),x=(e.getTime()-h.getTime())/_*100,S=I=>{if(p.length<2)return 1;let N=p[0],F=p[1];for(let de=0;de<p.length-1;de++)if(p[de].time<=I&&p[de+1].time>I){N=p[de],F=p[de+1];break}const V=F.time.getTime()-N.time.getTime(),U=I.getTime()-N.time.getTime(),D=Math.max(0,Math.min(1,U/V)),se=(1-Math.cos(D*Math.PI))/2;return N.height+(F.height-N.height)*se},C=K.useMemo(()=>{const I=[];for(let F=0;F<=200;F++){const V=new Date(h.getTime()+F/200*_),U=S(V);I.push({x:F/200*100,y:U,time:V})}return I},[h,_,p]),T=Math.min(...C.map(I=>I.y)),k=Math.max(...C.map(I=>I.y))-T||1,A=I=>{const N=new Date;N.setHours(0,0,0,0);const F=new Date(I);F.setHours(0,0,0,0);const V=Math.floor((F.getTime()-N.getTime())/(1440*60*1e3));return V===0?"Vandaag":V===1?"Morgen":V===-1?"Gisteren":I.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},L=I=>I.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"}),O=S(e),B=(u.getTime()-h.getTime())/_*100,M=(e.getTime()-h.getTime())/_*100;return y.jsx(Ue.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:y.jsx(Ue.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-md overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:I=>I.stopPropagation(),children:y.jsxs("div",{className:"p-4 space-y-3",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Zd,{size:20,className:"text-blue-500"}),y.jsx("span",{className:"font-semibold text-gray-800",children:"Getijden"})]}),y.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:y.jsx(di,{size:16,className:"text-gray-500"})})]}),y.jsx("select",{value:o.id,onChange:I=>{const N=r.find(F=>F.id===I.target.value);N&&l(N)},className:"w-full p-2.5 border border-gray-200 rounded-xl text-sm bg-white/80 outline-none focus:ring-2 focus:ring-blue-400",children:r.map(I=>y.jsx("option",{value:I.id,children:I.name},I.id))}),y.jsxs("div",{className:"relative bg-gradient-to-b from-blue-50 to-blue-100 rounded-xl p-3 h-32",children:[y.jsxs("svg",{className:"absolute inset-3 w-[calc(100%-24px)] h-[calc(100%-24px)]",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[y.jsx("path",{d:`M 0 100 ${C.map(I=>`L ${I.x} ${100-(I.y-T)/k*80}`).join(" ")} L 100 100 Z`,fill:"url(#waterGradient)",opacity:"0.6"}),y.jsx("path",{d:`M ${C.map(I=>`${I.x} ${100-(I.y-T)/k*80}`).join(" L ")}`,fill:"none",stroke:"#3b82f6",strokeWidth:"1.5"}),B>=0&&B<=100&&y.jsx("line",{x1:B,y1:"0",x2:B,y2:"100",stroke:"#f59e0b",strokeWidth:"1",strokeDasharray:"3,3"}),y.jsx("line",{x1:M,y1:"0",x2:M,y2:"100",stroke:"#ef4444",strokeWidth:"1.5"}),y.jsx("circle",{cx:M,cy:100-(O-T)/k*80,r:"3",fill:"#ef4444"}),y.jsx("defs",{children:y.jsxs("linearGradient",{id:"waterGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[y.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),y.jsx("stop",{offset:"100%",stopColor:"#93c5fd"})]})})]}),y.jsxs("div",{className:"absolute bottom-1 left-3 right-3 flex justify-between text-[9px] text-gray-500",children:[y.jsx("span",{children:A(h)}),y.jsx("span",{children:A(u)}),y.jsx("span",{children:A(f)})]}),y.jsxs("div",{className:"absolute top-2 right-3 bg-white/90 rounded-lg px-2 py-1 shadow-sm",children:[y.jsxs("div",{className:"text-[10px] text-gray-500",children:[A(e)," ",L(e)]}),y.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[O.toFixed(2),"m"]})]})]}),y.jsx("input",{type:"range",min:"0",max:"100",value:x,onChange:I=>{const N=new Date(h.getTime()+parseFloat(I.target.value)/100*_);t(N)},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>t(new Date),className:"flex-1 px-3 py-2 text-sm bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-xl transition-colors border-0 outline-none font-medium",children:"Nu"}),p.filter(I=>I.time>u).slice(0,2).map((I,N)=>y.jsxs("button",{onClick:()=>t(I.time),className:`flex-1 px-2 py-2 text-sm rounded-xl transition-colors border-0 outline-none font-medium ${I.type==="high"?"bg-green-50 hover:bg-green-100 text-green-600":"bg-red-50 hover:bg-red-100 text-red-600"}`,children:[I.type==="high"?"HW":"LW"," ",L(I.time)]},N))]}),y.jsx("div",{className:"text-[10px] text-gray-400 text-center",children:"Berekening op basis van maanstand"})]})})})}function hq({pressureHistory:n,currentPressure:e,trend:t,onClose:i}){const[r,s]=K.useState(12),o=new Date,l=n.slice(-72),u=Math.min(...l.map(T=>T.pressure),990),h=Math.max(...l.map(T=>T.pressure),1040),f=h-u||20,p=T=>{if(T>=l.length-1||T<1)return .5;const b=l[T].pressure-l[T-1].pressure,k=l[T].pressure;let A=.5;return b>.5?A+=.3:b<-.5&&(A-=.2),k>=1010&&k<=1025&&(A+=.2),k>1020&&Math.abs(b)<.3&&(A+=.2),Math.max(0,Math.min(1,A))},x=[...l.map((T,b)=>({hour:b,activity:p(b)}))].sort((T,b)=>b.activity-T.activity).slice(0,5),S=()=>t==="rising"?y.jsx(VD,{size:16,className:"text-green-500"}):t==="falling"?y.jsx(FD,{size:16,className:"text-red-500"}):y.jsx(jD,{size:16,className:"text-gray-400"}),C=()=>t==="rising"?"Stijgend - Goed voor vissen!":t==="falling"?"Dalend - Minder activiteit":"Stabiel";return y.jsx(Ue.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i,children:y.jsx(Ue.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:T=>T.stopPropagation(),children:y.jsxs("div",{className:"p-4 space-y-4",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(LD,{size:20,className:"text-purple-500"}),y.jsx("span",{className:"font-semibold text-gray-800",children:"Luchtdruk"})]}),y.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:y.jsx(di,{size:16,className:"text-gray-500"})})]}),y.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-4",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[Math.round(e)," hPa"]}),y.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[S(),y.jsx("span",{className:"text-sm text-gray-600",children:C()})]})]}),y.jsxs("div",{className:"text-right",children:[y.jsx(WD,{value:p(l.length-1)*3,color:p(l.length-1)>.7?"text-green-500":p(l.length-1)>.4?"text-amber-500":"text-red-500"}),y.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:"Nu"})]})]})}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("div",{className:"text-[10px] text-gray-500",children:"Druk & visactiviteit (48 uur)"}),y.jsxs("div",{className:"relative bg-gray-100 rounded-xl p-2 h-32",children:[y.jsxs("svg",{className:"absolute inset-2 w-[calc(100%-16px)] h-[calc(100%-16px)]",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[l.slice(-48).map((T,b)=>{const k=p(l.length-48+b),A=b/47*100,L=k*30,O=k>.7?"#22c55e":k>.4?"#f59e0b":"#ef4444";return y.jsx("rect",{x:A-1,y:100-L,width:2,height:L,fill:O,opacity:"0.3"},b)}),y.jsx("path",{d:`M ${l.slice(-48).map((T,b)=>{const k=b/47*100,A=100-(T.pressure-u)/f*80;return`${k} ${A}`}).join(" L ")}`,fill:"none",stroke:"#8b5cf6",strokeWidth:"2"}),y.jsx("rect",{x:"0",y:100-(1025-u)/f*80,width:"100",height:15/f*80,fill:"#22c55e",opacity:"0.1"})]}),y.jsx("div",{className:"absolute top-1 left-2 text-[9px] text-gray-400",children:Math.round(h)}),y.jsx("div",{className:"absolute bottom-4 left-2 text-[9px] text-gray-400",children:Math.round(u)}),y.jsxs("div",{className:"absolute bottom-0.5 left-2 right-2 flex justify-between text-[8px] text-gray-400",children:[y.jsx("span",{children:"-48u"}),y.jsx("span",{children:"-24u"}),y.jsx("span",{children:"Nu"})]})]})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsxs("div",{className:"text-[10px] text-gray-500 flex items-center gap-1",children:[y.jsx(bx,{size:12,className:"text-green-500"}),"Beste vistijden (op basis van druk)"]}),y.jsx("div",{className:"flex flex-wrap gap-1",children:x.slice(0,4).map((T,b)=>{const k=new Date(l[T.hour]?.time||o),A=k.getDate()===o.getDate();return y.jsxs("div",{className:"bg-green-50 rounded-lg px-2 py-1 text-xs",children:[y.jsxs("span",{className:"text-green-700 font-medium",children:[A?"Vandaag":"Morgen"," ",k.getHours(),":00"]}),y.jsxs("span",{className:"text-green-500 ml-1",children:[Math.round(T.activity*100),"%"]})]},b)})})]}),y.jsxs("div",{className:"flex items-center justify-center gap-4 text-[10px] text-gray-400",children:[y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-3 h-1.5 rounded-sm bg-green-400 opacity-50"}),y.jsx("span",{children:"Actief"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-3 h-1.5 rounded-sm bg-amber-400 opacity-50"}),y.jsx("span",{children:"Matig"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-8 h-3 rounded-sm bg-green-500 opacity-20"}),y.jsx("span",{children:"Optimale zone"})]})]})]})})})}function dq({onClose:n}){const[e,t]=K.useState(!0),[i,r]=K.useState(0),[s,o]=K.useState([]),l=si(T=>T.position);K.useEffect(()=>{(async()=>{try{const k=await(await fetch("https://api.rainviewer.com/public/weather-maps.json")).json();if(k.radar?.past){const A=k.radar.past.map(L=>`https://tilecache.rainviewer.com${L.path}/256/{z}/{x}/{y}/2/1_1.png`);k.radar?.nowcast&&A.push(...k.radar.nowcast.map(L=>`https://tilecache.rainviewer.com${L.path}/256/{z}/{x}/{y}/2/1_1.png`)),o(A)}}catch(b){console.error("Failed to fetch radar data:",b)}})()},[]),K.useEffect(()=>{if(!e||s.length===0)return;const T=setInterval(()=>{r(b=>(b+1)%s.length)},500);return()=>clearInterval(T)},[e,s.length]);const u=l?.lat||52.1326,h=l?.lng||5.2913,f=7,p=Math.pow(2,f),_=Math.floor((h+180)/360*p),x=Math.floor((1-Math.log(Math.tan(u*Math.PI/180)+1/Math.cos(u*Math.PI/180))/Math.PI)/2*p),S=()=>s.length===0?null:s[i]?.replace("{z}",f.toString()).replace("{x}",_.toString()).replace("{y}",x.toString()),C=()=>{if(s.length===0)return"Laden...";const b=i-12;return b<-5?`-${Math.abs(b)*5} min`:b<0?`-${Math.abs(b)*5} min`:b===0?"Nu":`+${b*5} min`};return y.jsx(Ue.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:y.jsx(Ue.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:T=>T.stopPropagation(),children:y.jsxs("div",{className:"p-4 space-y-3",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Iy,{size:20,className:"text-blue-500"}),y.jsx("span",{className:"font-semibold text-gray-800",children:"Buienradar"})]}),y.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:y.jsx(di,{size:16,className:"text-gray-500"})})]}),y.jsxs("div",{className:"relative bg-gray-200 rounded-xl overflow-hidden",style:{aspectRatio:"1/1"},children:[y.jsx("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-3",children:[-1,0,1].map(T=>[-1,0,1].map(b=>y.jsx("img",{src:`https://tile.openstreetmap.org/${f}/${_+b}/${x+T}.png`,alt:"",className:"w-full h-full object-cover",style:{filter:"saturate(0.3) brightness(1.1)"}},`${b}-${T}`)))}),S()&&y.jsx("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-3",children:[-1,0,1].map(T=>[-1,0,1].map(b=>y.jsx("img",{src:s[i]?.replace("{z}",f.toString()).replace("{x}",(_+b).toString()).replace("{y}",(x+T).toString()),alt:"",className:"w-full h-full object-cover",style:{mixBlendMode:"multiply"}},`radar-${b}-${T}`)))}),y.jsx("div",{className:"absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-sm font-medium",children:C()}),y.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:y.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full border-2 border-white shadow-lg"})})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("input",{type:"range",min:"0",max:Math.max(0,s.length-1),value:i,onChange:T=>{t(!1),r(parseInt(T.target.value))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[y.jsx("span",{children:"-1 uur"}),y.jsx("span",{children:"Nu"}),y.jsx("span",{children:"+30 min"})]})]}),y.jsx("div",{className:"flex items-center justify-center gap-3",children:y.jsxs("button",{onClick:()=>t(!e),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-xl transition-colors border-0 outline-none",children:[e?y.jsx(BH,{size:16}):y.jsx(HH,{size:16}),y.jsx("span",{className:"text-sm font-medium",children:e?"Pauzeren":"Afspelen"})]})}),y.jsxs("div",{className:"flex items-center justify-center gap-2 text-[10px] text-gray-500",children:[y.jsx("span",{children:"Licht"}),y.jsxs("div",{className:"flex h-2",children:[y.jsx("div",{className:"w-4 bg-blue-200 rounded-l"}),y.jsx("div",{className:"w-4 bg-blue-400"}),y.jsx("div",{className:"w-4 bg-blue-600"}),y.jsx("div",{className:"w-4 bg-purple-600"}),y.jsx("div",{className:"w-4 bg-red-500 rounded-r"})]}),y.jsx("span",{children:"Zwaar"})]})]})})})}function fq(){const{current:n,loading:e,fetchWeather:t,getFishingScore:i,pressureHistory:r,getPressureTrend:s,hourlyForecast:o,precipitation15min:l}=KP(),u=si(Z=>Z.position),h=at(Z=>Z.showWeatherWidget),{waterData:f,station:p,fetchData:_}=Db(),[x,S]=K.useState(!1),[C,T]=K.useState(!1),[b,k]=K.useState(!1),[A,L]=K.useState(0),[O,B]=K.useState(!1),[M,I]=K.useState(!1);K.useEffect(()=>{const Z=u||md;t(Z.lat,Z.lng),_()},[]),K.useEffect(()=>{u&&t(u.lat,u.lng)},[u,t]),K.useEffect(()=>{const Z=u||md,ne=setInterval(()=>{t(Z.lat,Z.lng),_()},600*1e3);return()=>clearInterval(ne)},[u,t,_]);const N=new Date;Ax(N);const F=rq(N),U=K.useMemo(()=>{const Z=new Date;return Z.setHours(0,0,0,0),$D(Z,2)},[]).filter(Z=>Z.time>N).slice(0,4),D=i?i():1,se=Math.min(3,D/2+F.activity*1.5),de=Z=>Z>=2.5?"text-green-500":Z>=1.5?"text-lime-500":Z>=.8?"text-amber-500":"text-red-500",me=Z=>Z>=2.5?"Uitstekend":Z>=1.5?"Goed":Z>=.8?"Matig":"Slecht",ue=Z=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(Z/45)%8],J=Z=>Z.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return h?y.jsxs(y.Fragment,{children:[x&&y.jsx("div",{className:"fixed inset-0 z-[1499]",onClick:()=>S(!1)}),y.jsxs(Ue.div,{className:"fixed left-2 z-[1500] bg-white shadow-lg border border-gray-200 select-none rounded-xl",style:x?{top:"0.5rem",bottom:"0.5rem",width:"220px",overflowY:"auto"}:{top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[e&&!n?y.jsxs("div",{className:"p-3 flex items-center gap-2",children:[y.jsx(YH,{size:16,className:"animate-spin text-blue-500"}),y.jsx("span",{className:"text-sm text-gray-500",children:"Laden..."})]}):n?y.jsxs("div",{className:"p-2.5",children:[y.jsxs("button",{onClick:()=>S(!x),className:"w-full border-0 outline-none bg-transparent p-0",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(GD,{code:n.weatherCode,size:24}),y.jsx("div",{className:"flex flex-col leading-tight",children:y.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[Math.round(n.temperature),""]})})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx(Rx,{size:14,className:"text-gray-400"}),y.jsx("span",{className:"text-sm text-gray-600",children:Math.round(n.windSpeed)}),y.jsx(JK,{degrees:n.windDirection,size:12})]}),y.jsx("div",{className:"ml-auto",children:x?y.jsx(ND,{size:16,className:"text-gray-400"}):y.jsx(Y$,{size:16,className:"text-gray-400"})})]}),y.jsxs("div",{className:"flex items-center gap-2 mt-1.5 pt-1.5 border-t border-gray-200/50",children:[y.jsx(WD,{value:se,color:de(se)}),y.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:y.jsx("div",{className:`h-full transition-all ${se>=2.5?"bg-green-500":se>=1.5?"bg-lime-500":se>=.8?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.max(se/3*100,5)}%`}})}),y.jsx("span",{className:`text-[10px] font-medium ${de(se)}`,children:me(se)})]})]}),y.jsx(On,{children:x&&y.jsx(Ue.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:y.jsxs("div",{className:"pt-3 mt-2 border-t border-gray-200/50 space-y-3",children:[y.jsx("div",{className:"text-xs text-gray-600",children:QK[n.weatherCode]||"Onbekend"}),(()=>{const Z=new Date;Z.setDate(Z.getDate()+A);const ne=Ax(Z),G=sq(ne),$=A===0?"Vandaag":A===1?"Morgen":A===-1?"Gisteren":Z.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric",month:"short"});return y.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-3",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(iq,{phase:ne,size:40}),y.jsxs("div",{className:"flex-1",children:[y.jsx("div",{className:"text-gray-800 text-sm font-medium",children:tq(ne)}),y.jsxs("div",{className:"text-gray-500 text-[10px]",children:[Math.round(ne*100),"% verlicht"]}),y.jsx("div",{className:`text-[10px] font-medium ${G.color}`,children:G.type})]}),y.jsxs("div",{className:"text-right",children:[y.jsx("div",{className:"text-xs text-gray-600",children:$}),A!==0&&y.jsx("button",{onClick:()=>L(0),className:"text-[10px] text-blue-500 hover:underline border-0 bg-transparent p-0 outline-none",children:"Vandaag"})]})]}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("input",{type:"range",min:"-14",max:"14",value:A,onChange:ie=>L(parseInt(ie.target.value)),className:"w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[y.jsx("span",{children:"-14d"}),y.jsx("span",{children:"Nu"}),y.jsx("span",{children:"+14d"})]})]})]})})(),y.jsxs("div",{className:"space-y-1",children:[y.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[y.jsx("span",{className:"text-gray-500",children:"Maanactiviteit"}),y.jsxs("span",{className:"text-gray-600",children:[Math.round(F.activity*100),"%"]})]}),y.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:y.jsx("div",{className:`h-full transition-all ${F.activity>=.7?"bg-green-500":F.activity>=.5?"bg-lime-500":F.activity>=.3?"bg-amber-500":"bg-red-400"}`,style:{width:`${F.activity*100}%`}})})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(DD,{size:14,className:"text-cyan-500"}),y.jsx("select",{value:p?.id||"",onChange:Z=>{Z.stopPropagation();const ne=Xd.find(G=>G.id===Z.target.value);if(ne){const{setStation:G,fetchData:$}=Db.getState();G(ne),setTimeout(()=>$(),50)}},className:"flex-1 px-2 py-1 text-xs border border-gray-200 rounded-lg bg-white/80 outline-none focus:ring-1 focus:ring-cyan-400",children:Xd.map(Z=>y.jsx("option",{value:Z.id,children:Z.name},Z.id))})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f?.temperature!==void 0&&y.jsxs("div",{className:"bg-cyan-50 rounded-lg p-2",children:[y.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[y.jsx(_K,{size:12,className:"text-cyan-500"}),y.jsx("span",{children:"Water"})]}),y.jsxs("div",{className:"text-sm font-bold text-cyan-600",children:[f.temperature.toFixed(1),"C"]})]}),f?.waveHeight!==void 0&&y.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[y.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[y.jsx(Zd,{size:12,className:"text-blue-500"}),y.jsx("span",{children:"Golven"})]}),y.jsxs("div",{className:"text-sm font-bold text-blue-600",children:[f.waveHeight," cm"]})]}),f?.currentSpeed!==void 0&&y.jsxs("div",{className:"bg-green-50 rounded-lg p-2",children:[y.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[y.jsx(ku,{size:12,className:"text-green-500"}),y.jsx("span",{children:"Stroming"})]}),y.jsxs("div",{className:"text-sm font-bold text-green-600",children:[f.currentSpeed," cm/s"]})]}),f?.currentDirection!==void 0&&y.jsxs("div",{className:"bg-purple-50 rounded-lg p-2",children:[y.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[y.jsx(ku,{size:12,className:"text-purple-500",style:{transform:`rotate(${f.currentDirection}deg)`}}),y.jsx("span",{children:"Richting"})]}),y.jsxs("div",{className:"text-sm font-bold text-purple-600",children:[Math.round(f.currentDirection),""]})]})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[y.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600",children:[y.jsx(Rx,{size:12,className:"text-gray-400"}),y.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",ue(n.windDirection)]})]}),y.jsxs("button",{onClick:()=>B(!0),className:"flex items-center gap-1.5 text-gray-600 hover:bg-purple-50 rounded-lg p-1 -m-1 transition-colors border-0 bg-transparent cursor-pointer",children:[y.jsx(LD,{size:12,className:"text-purple-500"}),y.jsxs("span",{children:[Math.round(n.pressure)," hPa"]}),(()=>{const Z=s();return Z==="rising"?y.jsx(VD,{size:12,className:"text-green-500"}):Z==="falling"?y.jsx(FD,{size:12,className:"text-red-500"}):y.jsx(jD,{size:12,className:"text-gray-400"})})(),y.jsx(qc,{size:10,className:"text-gray-400 ml-auto"})]})]}),y.jsxs("button",{onClick:()=>I(!0),className:"w-full flex items-center gap-2 p-2 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors border-0 cursor-pointer",children:[y.jsx(Iy,{size:16,className:"text-blue-500"}),y.jsx("span",{className:"text-sm text-blue-700 font-medium",children:"Buienradar"}),y.jsx("span",{className:"text-xs text-blue-500 ml-auto",children:"Live kaart"}),y.jsx(qc,{size:14,className:"text-blue-400"})]}),l.length>0&&y.jsx("button",{onClick:()=>k(!0),className:"w-full border-0 bg-transparent p-0 cursor-pointer text-left",children:y.jsxs("div",{className:"hover:bg-gray-50 rounded-lg p-1 -m-1 transition-colors",children:[y.jsxs("div",{className:"flex items-center justify-between mb-1",children:[y.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag komende 2 uur"}),y.jsx(qc,{size:12,className:"text-gray-400"})]}),y.jsx(oq,{data:l})]})}),o.length>0&&y.jsx(aq,{hourly:o}),U.length>0&&y.jsx("button",{onClick:()=>T(!0),className:"w-full border-0 bg-transparent p-0 cursor-pointer text-left",children:y.jsxs("div",{className:"space-y-1 hover:bg-gray-50 rounded-lg p-1 -m-1 transition-colors",children:[y.jsxs("div",{className:"text-[10px] text-gray-500 flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx(Zd,{size:12}),y.jsx("span",{children:"Volgende getijden"})]}),y.jsx(qc,{size:12,className:"text-gray-400"})]}),y.jsx("div",{className:"flex gap-1",children:U.map((Z,ne)=>y.jsxs("div",{className:`flex-1 p-1.5 rounded text-center ${Z.type==="high"?"bg-green-50":"bg-red-50"}`,children:[y.jsx("div",{className:`text-[9px] font-medium ${Z.type==="high"?"text-green-600":"text-red-600"}`,children:Z.type==="high"?"HW":"LW"}),y.jsx("div",{className:"text-[10px] font-medium",children:J(Z.time)})]},ne))})]})}),p&&y.jsxs("div",{className:"text-[9px] text-gray-400 text-center",children:["Waterdata: ",p.name]})]})})})]}):y.jsxs("button",{onClick:()=>{const Z=u||md;t(Z.lat,Z.lng)},className:"p-3 flex items-center gap-2 border-0 outline-none bg-transparent",children:[y.jsx(Pu,{size:18,className:"text-gray-400"}),y.jsx("span",{className:"text-sm text-gray-500",children:"Weer laden"})]}),y.jsx(On,{children:C&&y.jsx(uq,{onClose:()=>T(!1)})}),y.jsx(On,{children:b&&o.length>0&&y.jsx(cq,{hourlyData:o,onClose:()=>k(!1)})}),y.jsx(On,{children:O&&n&&y.jsx(hq,{pressureHistory:r,currentPressure:n.pressure,trend:s(),onClose:()=>B(!1)})}),y.jsx(On,{children:M&&y.jsx(dq,{onClose:()=>I(!1)})})]})]}):null}const Rm=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],gq=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],pq=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],av=5;function mq({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=K.useRef(null),s=K.useRef(null),o=async u=>{const h=u.target.files;if(!h||h.length===0)return;const f=av-n.length,p=Array.from(h).slice(0,f);for(const _ of p)try{const{thumbnailBase64:x}=await UD(_),S={id:BD(),thumbnailBase64:x,createdAt:new Date().toISOString(),pendingUpload:!0};e(S)}catch(x){console.error("Failed to process image:",x)}u.target.value=""},l=n.length<av;return y.jsxs("div",{className:"space-y-2",children:[y.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",av,")"]}),y.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(u=>y.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[y.jsx("img",{src:u.thumbnailUrl||u.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&y.jsx("button",{type:"button",onClick:()=>t(u.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:y.jsx(di,{size:12,className:"text-white"})}),u.pendingUpload&&y.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},u.id)),l&&!i&&y.jsxs(y.Fragment,{children:[y.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[y.jsx(Uw,{size:20,className:"text-gray-400"}),y.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),y.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[y.jsx(xH,{size:20,className:"text-gray-400"}),y.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),y.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),y.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}const yq={Snoek:{colors:["green","yellow","spotted"],pattern:"elongated with spots"},Snoekbaars:{colors:["gray","silver","striped"],pattern:"elongated with stripes"},Baars:{colors:["green","black","striped","red-fins"],pattern:"oval with stripes"},Karper:{colors:["brown","gold","orange"],pattern:"large oval"},Brasem:{colors:["silver","bronze"],pattern:"flat oval"},Voorn:{colors:["silver","red-fins"],pattern:"small oval"},Zeelt:{colors:["green","brown","slimy"],pattern:"elongated"},Meerval:{colors:["dark","brown","black"],pattern:"large with whiskers"},Aal:{colors:["dark","silver-belly"],pattern:"snake-like"},Forel:{colors:["spotted","pink","silver"],pattern:"streamlined with spots"}};async function _q(n){return new Promise(e=>{const t=new Image;t.onload=()=>{const i=document.createElement("canvas"),r=i.getContext("2d");if(!r){e([]);return}const s=100;i.width=s,i.height=s;const o=(t.width-s)/2,l=(t.height-s)/2;r.drawImage(t,o,l,s,s,0,0,s,s);const h=r.getImageData(0,0,s,s).data;let f=0,p=0,_=0,x=0,S=0,C=0;const T=h.length/4;for(let L=0;L<h.length;L+=4){const O=h[L],B=h[L+1],M=h[L+2];f+=O,p+=B,B>O&&B>M&&_++,O>100&&B>80&&B<150&&M<100&&x++,O>150&&B>150&&M>150&&S++,O<80&&B<80&&M<80&&C++}const b=[];_/T>.2&&b.push("green"),x/T>.2&&b.push("brown"),S/T>.2&&b.push("silver"),C/T>.3&&b.push("dark");const k=f/T,A=p/T;k>150&&A>100&&A<180&&b.push("gold"),e(b)},t.src=n})}function vq(n){const e=[];for(const[t,i]of Object.entries(yq)){let r=0;for(const s of n)i.colors.some(o=>o.includes(s)||s.includes(o))&&r++;r>0&&e.push({species:t,score:r/i.colors.length})}return e.sort((t,i)=>i.score-t.score)}async function xq(n){try{const e=await _q(n),t=vq(e);if(t.length===0)return{species:"",confidence:0,suggestions:Rm.slice(0,5).map(o=>o.name)};const i=t[0],r=t.slice(0,5).map(o=>o.species),s=["Snoek","Baars","Karper","Snoekbaars","Brasem"];for(const o of s)!r.includes(o)&&r.length<5&&r.push(o);return{species:i.score>.3?i.species:"",confidence:i.score,suggestions:r.slice(0,5)}}catch(e){return console.error("Fish recognition error:",e),{species:"",confidence:0,suggestions:Rm.slice(0,5).map(t=>t.name)}}}function wq(n){return{Snoek:{avgWeight:3e3,avgLength:70},Snoekbaars:{avgWeight:2500,avgLength:60},Baars:{avgWeight:500,avgLength:30},Karper:{avgWeight:8e3,avgLength:60},Brasem:{avgWeight:2e3,avgLength:45},Voorn:{avgWeight:300,avgLength:25},Zeelt:{avgWeight:1500,avgLength:40},Meerval:{avgWeight:15e3,avgLength:120},Aal:{avgWeight:800,avgLength:60},Forel:{avgWeight:1e3,avgLength:40},Kolblei:{avgWeight:500,avgLength:30},Winde:{avgWeight:1e3,avgLength:40},Kopvoorn:{avgWeight:800,avgLength:35},Ruisvoorn:{avgWeight:400,avgLength:25},Blankvoorn:{avgWeight:300,avgLength:25}}[n]||null}function Eq({onClose:n,initialLocation:e,initialLocationSource:t,initialPhotos:i=[]}){const r=HP(ie=>ie.addCatch),s=KP(ie=>ie.current),o=si(ie=>ie.position),[l,u]=K.useState(e||(o?{lat:o.lat,lng:o.lng}:null)),[h,f]=K.useState(t||(o?"gps":null)),[p,_]=K.useState(""),[x,S]=K.useState(""),[C,T]=K.useState(""),[b,k]=K.useState(""),[A,L]=K.useState(""),[O,B]=K.useState(""),[M,I]=K.useState(i),[N,F]=K.useState(!1),[V,U]=K.useState([]),[D,se]=K.useState(0),de=async ie=>{if(I(fe=>[...fe,ie]),ie.dataUrl&&!p){F(!0);try{const fe=await xq(ie.dataUrl);if(U(fe.suggestions),se(fe.confidence),fe.species&&fe.confidence>.4){_(fe.species);const ye=wq(fe.species)}}catch(fe){console.error("AI recognition failed:",fe)}finally{F(!1)}}},me=ie=>{_(ie),U([])},ue=ie=>{I(fe=>fe.filter(ye=>ye.id!==ie))},J=()=>{o&&(u({lat:o.lat,lng:o.lng}),f("gps"))},Z=ie=>{if(ie.preventDefault(),!p||!l){alert("Selecteer een vissoort en zorg dat er een locatie is");return}r({location:l,species:p,weight:x?parseInt(x):void 0,length:C?parseInt(C):void 0,photos:M.length>0?M:void 0,method:b||"Anders",bait:A||void 0,notes:O||void 0,weather:s?{temp:s.temperature,windSpeed:s.windSpeed,windDirection:s.windDirection,pressure:s.pressure}:void 0}),n()},G=(()=>{switch(h){case"gps":return{icon:ku,label:"GPS",color:"text-blue-500"};case"photo":return{icon:Uw,label:"Foto EXIF",color:"text-green-500"};case"map":return{icon:Cy,label:"Kaart",color:"text-orange-500"};default:return{icon:Js,label:"Locatie",color:"text-gray-500"}}})(),$=G.icon;return y.jsx(Ue.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:y.jsxs(Ue.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:ie=>ie.stopPropagation(),children:[y.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Qs,{className:"text-white",size:24}),y.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),y.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:y.jsx(di,{size:20})})]}),y.jsxs("form",{onSubmit:Z,className:"p-4 space-y-4",children:[y.jsx("div",{className:"space-y-2",children:l?y.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-gray-50 p-2 rounded-lg",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx($,{size:16,className:G.color}),y.jsxs("span",{className:"text-gray-600",children:[l.lat.toFixed(5),", ",l.lng.toFixed(5)]})]}),y.jsx("span",{className:`text-xs ${G.color} font-medium`,children:G.label})]}):y.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-red-50 p-2 rounded-lg text-red-600",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Js,{size:16}),y.jsx("span",{children:"Geen locatie"})]}),o&&y.jsx("button",{type:"button",onClick:J,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded-md border-0 outline-none",children:"Gebruik GPS"})]})}),y.jsxs("div",{children:[y.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:["Vissoort *",N&&y.jsxs("span",{className:"flex items-center gap-1 text-xs text-blue-500",children:[y.jsx(SH,{size:12,className:"animate-spin"}),"AI analyseert..."]})]}),y.jsx(On,{children:V.length>0&&!p&&y.jsxs(Ue.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-2 p-2 bg-blue-50 rounded-lg border border-blue-200",children:[y.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mb-2",children:[y.jsx(hK,{size:12}),y.jsxs("span",{children:["AI suggesties ",D>.3?`(${Math.round(D*100)}% zeker)`:""]})]}),y.jsx("div",{className:"flex flex-wrap gap-1",children:V.map(ie=>y.jsx("button",{type:"button",onClick:()=>me(ie),className:"px-2 py-1 text-xs bg-white border border-blue-300 text-blue-700 rounded-full hover:bg-blue-100 transition-colors",children:ie},ie))})]})}),y.jsxs("select",{value:p,onChange:ie=>{_(ie.target.value),U([])},className:"form-select",required:!0,children:[y.jsx("option",{value:"",children:"Selecteer vissoort..."}),Rm.map(ie=>y.jsx("option",{value:ie.name,children:ie.name},ie.name))]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{children:[y.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[y.jsx(rK,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),y.jsx("input",{type:"number",value:x,onChange:ie=>S(ie.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),y.jsxs("div",{children:[y.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[y.jsx(eK,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),y.jsx("input",{type:"number",value:C,onChange:ie=>T(ie.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),y.jsxs("select",{value:b,onChange:ie=>k(ie.target.value),className:"form-select",children:[y.jsx("option",{value:"",children:"Selecteer methode..."}),gq.map(ie=>y.jsx("option",{value:ie,children:ie},ie))]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),y.jsxs("select",{value:A,onChange:ie=>L(ie.target.value),className:"form-select",children:[y.jsx("option",{value:"",children:"Selecteer aas..."}),pq.map(ie=>y.jsx("option",{value:ie,children:ie},ie))]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),y.jsx("textarea",{value:O,onChange:ie=>B(ie.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),y.jsx(mq,{photos:M,onAddPhoto:de,onRemovePhoto:ue}),y.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function Tq(){const n=Ln(h=>h.catchFormOpen),e=Ln(h=>h.catchFormLocation),t=Ln(h=>h.catchFormLocationSource),i=Ln(h=>h.catchFormInitialPhotos),r=Ln(h=>h.openCatchForm),s=Ln(h=>h.closeCatchForm),o=si(h=>h.position),l=at(h=>h.showCatchButton),u=()=>{o?r({location:{lat:o.lat,lng:o.lng},locationSource:"gps"}):r()};return y.jsxs(y.Fragment,{children:[l&&y.jsx(Ue.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:u,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:y.jsx(Qs,{size:22,strokeWidth:2})}),y.jsx(On,{children:n&&y.jsx(Eq,{onClose:s,initialLocation:e||void 0,initialLocationSource:t||void 0,initialPhotos:i})})]})}function Sq(){const n=ds(r=>r.map),e=HP(r=>r.catches),t=K.useRef(null),i=K.useRef(null);return K.useEffect(()=>{if(n)return i.current=new M1,t.current=new G1({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),K.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=pl([r.location.lng,r.location.lat]),o=new lu({geometry:new ml(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new Ji({image:new kl({radius:14,fill:new Cr({color:"#22c55e"}),stroke:new Mu({color:"#fff",width:2})}),text:new uf({text:l,font:"bold 12px sans-serif",fill:new Cr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function Iq(){const n=ds(r=>r.map),e=qP(r=>r.spots),t=K.useRef(null),i=K.useRef(null);return K.useEffect(()=>{if(n)return i.current=new M1,t.current=new G1({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),K.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=pl([r.location.lng,r.location.lat]),o=new lu({geometry:new ml(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new Ji({image:new kl({radius:12,fill:new Cr({color:l}),stroke:new Mu({color:"#fff",width:2})}),text:new uf({text:"",font:"bold 14px sans-serif",fill:new Cr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function Cq({onClose:n,initialLocation:e}){const t=qP(T=>T.addSpot),[i,r]=K.useState(""),[s,o]=K.useState(""),[l,u]=K.useState([]),[h,f]=K.useState(""),[p,_]=K.useState(3),x=e,S=T=>{u(b=>b.includes(T)?b.filter(k=>k!==T):[...b,T])},C=T=>{if(T.preventDefault(),!i||!x){alert("Geef een naam op voor deze locatie");return}t({name:i,location:x,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:p}),n()};return y.jsx(Ue.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:y.jsxs(Ue.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:T=>T.stopPropagation(),children:[y.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Cx,{className:"text-white",size:24}),y.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),y.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:y.jsx(di,{size:20})})]}),y.jsxs("form",{onSubmit:C,className:"p-4 space-y-4",children:[x&&y.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[y.jsx(Js,{size:16}),y.jsxs("span",{children:[x.lat.toFixed(5),", ",x.lng.toFixed(5)]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),y.jsx("input",{type:"text",value:i,onChange:T=>r(T.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),y.jsx("input",{type:"text",value:s,onChange:T=>o(T.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),y.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(T=>y.jsx("button",{type:"button",onClick:()=>_(T),className:"p-1 border-0 outline-none bg-transparent",children:y.jsx(Cx,{size:28,className:T<=p?"text-yellow-400 fill-yellow-400":"text-gray-300"})},T))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),y.jsx("div",{className:"flex flex-wrap gap-2",children:Rm.slice(0,12).map(T=>y.jsx("button",{type:"button",onClick:()=>S(T.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(T.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:T.name},T.name))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),y.jsx("textarea",{value:h,onChange:T=>f(T.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),y.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const Rq=[{name:"Aanlegsteigers",icon:kD,color:"#2196F3"},{name:"Boothellingen",icon:cK,color:"#4CAF50"},{name:"Dieptekaart",icon:Zd,color:"#00BCD4"},{name:"Viswater",icon:Js,color:"#9C27B0"}],jb=[{name:"Terrein",label:"Terrein"},{name:"OpenStreetMap",label:"Kaart"},{name:"Luchtfoto",label:"Satelliet"}];function bq(){const n=Ln(x=>x.layerPanelOpen),e=Ln(x=>x.toggleLayerPanel),t=Ki(x=>x.visible),i=Ki(x=>x.opacity),r=Ki(x=>x.toggleLayer),s=Ki(x=>x.setLayerVisibility),o=Ki(x=>x.setLayerOpacity),l=x=>{jb.forEach(S=>{s(S.name,S.name===x)}),x==="Luchtfoto"?s("Labels Overlay",!0):s("Labels Overlay",!1)},u=()=>{s("Labels Overlay",!t["Labels Overlay"])},h=i["AHN4 Hillshade"]??.5,f=t["AHN4 Hillshade"],p=i["Hydro Overlay"]??.8,_=t["Hydro Overlay"];return y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:y.jsx(Ue.button,{className:"w-11 h-11 bg-white/90 hover:bg-white backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:y.jsx(Yd,{size:22})})}),y.jsx(On,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Ue.div,{className:"fixed inset-0 z-[1000]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),y.jsxs(Ue.div,{className:"fixed top-2 right-2 z-[1001] bg-white rounded-lg shadow-lg overflow-hidden w-[280px] max-h-[calc(100vh-100px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[y.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Yd,{size:14,className:"text-white"}),y.jsx("span",{className:"font-medium text-white text-sm",children:"Kaartlagen"})]}),y.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors",children:y.jsx(di,{size:16,className:"text-white",strokeWidth:2.5})})]}),y.jsxs("div",{className:"p-2 overflow-y-auto flex-1",children:[y.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[y.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1.5 px-1 uppercase tracking-wide",children:"Achtergrond"}),y.jsx("div",{className:"flex gap-1",children:jb.map(x=>y.jsx("button",{className:`flex-1 px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t[x.name]?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-blue-50"}`,onClick:()=>l(x.name),children:x.label},x.name))}),t.Luchtfoto&&y.jsxs("button",{onClick:u,className:`mt-1.5 w-full flex items-center justify-between px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t["Labels Overlay"]?"bg-blue-50 text-blue-600":"bg-transparent text-gray-500 hover:bg-blue-50"}`,children:[y.jsxs("span",{className:"flex items-center gap-1.5",children:[y.jsx(mK,{size:12}),"Labels overlay"]}),t["Labels Overlay"]&&y.jsx(Cm,{size:12})]})]}),y.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[y.jsx("div",{className:"text-xs font-medium text-amber-600 mb-1.5 px-1 uppercase tracking-wide",children:"Hoogtekaart"}),y.jsx(Fb,{name:"AHN4 Hillshade",icon:jH,color:"#f59e0b",visible:f,opacity:h,onToggle:()=>r("AHN4 Hillshade"),onOpacityChange:x=>o("AHN4 Hillshade",x)})]}),y.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[y.jsx("div",{className:"text-xs font-medium text-cyan-600 mb-1.5 px-1 uppercase tracking-wide",children:"Water"}),y.jsx(Fb,{name:"Hydro Overlay",icon:DD,color:"#0891b2",visible:_,opacity:p,onToggle:()=>r("Hydro Overlay"),onOpacityChange:x=>o("Hydro Overlay",x)})]}),y.jsxs("div",{children:[y.jsx("div",{className:"text-xs font-medium text-blue-600 mb-1.5 px-1 uppercase tracking-wide",children:"Vislagen"}),y.jsx("div",{className:"space-y-0.5",children:Rq.map(x=>{const S=x.icon,C=t[x.name];return y.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors border-0 outline-none ${C?"bg-blue-50":"bg-transparent hover:bg-blue-50"}`,onClick:()=>r(x.name),children:[y.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center transition-colors",style:{backgroundColor:C?x.color:"#e5e7eb"},children:y.jsx(S,{size:12,className:"text-white"})}),y.jsx("span",{className:`text-sm ${C?"text-blue-700":"text-gray-600"}`,children:x.name}),y.jsx("div",{className:"ml-auto",children:y.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all",style:{backgroundColor:C?x.color:"white",border:`2px solid ${C?x.color:"#d1d5db"}`},children:C&&y.jsx(Cm,{size:10,className:"text-white",strokeWidth:3})})})]},x.name)})})]})]})]})]})})]})}function Fb({name:n,icon:e,color:t,visible:i,opacity:r,onToggle:s,onOpacityChange:o}){return y.jsxs("div",{children:[y.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors border-0 outline-none ${i?"bg-gray-50":"bg-transparent hover:bg-gray-50"}`,onClick:s,children:[y.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center transition-colors",style:{backgroundColor:i?t:"#e5e7eb"},children:y.jsx(e,{size:12,className:"text-white"})}),y.jsx("span",{className:`text-sm ${i?"text-gray-800":"text-gray-600"}`,children:n}),y.jsx("div",{className:"ml-auto",children:y.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all",style:{backgroundColor:i?t:"white",border:`2px solid ${i?t:"#d1d5db"}`},children:i&&y.jsx(Cm,{size:10,className:"text-white",strokeWidth:3})})})]}),i&&y.jsx("div",{className:"mt-1 px-2 pb-1",children:y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[10px] text-gray-400 w-16",children:"Transparantie"}),y.jsx("input",{type:"range",min:"10",max:"100",value:r*100,onChange:l=>o(parseInt(l.target.value)/100),className:"flex-1 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{accentColor:t}}),y.jsxs("span",{className:"text-[10px] text-gray-400 w-6 text-right",children:[Math.round(r*100),"%"]})]})})]})}function Aq(){const n=Ln(T=>T.settingsPanelOpen),e=Ln(T=>T.toggleSettingsPanel),t=at(T=>T.showCatchButton),i=at(T=>T.setShowCatchButton),r=at(T=>T.showCatches),s=at(T=>T.setShowCatches),o=at(T=>T.showFavoriteSpots),l=at(T=>T.setShowFavoriteSpots),u=at(T=>T.defaultBackground),h=at(T=>T.setDefaultBackground),f=at(T=>T.fontScale),p=at(T=>T.setFontScale),_=at(T=>T.showFontSliders),x=at(T=>T.setShowFontSliders),S=Ki(T=>T.setLayerVisibility),C=T=>{h(T),S("Terrein",T==="Terrein"),S("OpenStreetMap",T==="OpenStreetMap"),S("Luchtfoto",T==="Luchtfoto"),S("Labels Overlay",T==="Luchtfoto")};return n?y.jsx(Ue.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:y.jsxs(Ue.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:T=>T.stopPropagation(),children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[y.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),y.jsx("button",{onClick:e,className:"p-1.5 rounded-lg bg-blue-600 hover:bg-blue-700 transition-colors border-0 outline-none",children:y.jsx(di,{size:18,className:"text-white"})})]}),y.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[y.jsxs("div",{className:"space-y-3",children:[y.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),y.jsx(cp,{icon:y.jsx(Qs,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),y.jsx(cp,{icon:y.jsx(Qs,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),y.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[y.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),y.jsx(cp,{icon:y.jsx(Js,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),y.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[y.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:y.jsx(Cy,{size:18,className:"text-gray-500"})}),y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),y.jsxs("select",{value:u,onChange:T=>C(T.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-400",children:[y.jsx("option",{value:"Terrein",children:"Terrein (relif)"}),y.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),y.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),y.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[y.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weergave"}),y.jsx(cp,{icon:y.jsx(EK,{size:18,className:"text-purple-500"}),label:"Tekstgrootte aanpassen",description:"Toon schuifbalk voor tekstgrootte",checked:_,onChange:x}),_&&y.jsxs("div",{className:"flex items-center gap-3 pl-2",children:[y.jsx("span",{className:"text-xs text-gray-500",children:"T"}),y.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:f,onChange:T=>p(parseInt(T.target.value)),className:"flex-1"}),y.jsx("span",{className:"text-lg text-gray-500",children:"T"}),y.jsxs("span",{className:"text-xs text-gray-500 w-10",children:[f,"%"]})]}),y.jsx("p",{className:"text-xs text-gray-400 pl-2",children:"Widgets via lang drukken op kaart  Widgets"})]})]}),y.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function cp({icon:n,label:e,description:t,checked:i,onChange:r}){return y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),y.jsx("p",{className:"text-xs text-gray-400",children:t})]}),y.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-blue-500":"bg-gray-300"}`,children:y.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function Pq(){const n=ds(S=>S.map),[e,t]=K.useState([]),[i,r]=K.useState(0),[s,o]=K.useState(!1),[l,u]=K.useState(null),h=e.length,f=e[i]||"";K.useEffect(()=>{if(!n)return;const S=async C=>{const T=[];if(n.forEachFeatureAtPixel(C.pixel,(b,k)=>{const A=b.getProperties(),L=k?.get("title")||"";let O="";if(L==="Aanlegsteigers"||A.layerType==="aanlegsteiger"){const B=A.name||"Aanlegsteiger",M=A.operator||"",I=A.access||"",N=A.fee||"",F=A.capacity||"",V=A.website||"";O=`<strong class="text-blue-800">${B}</strong>`,M&&(O+=`<br/><span class="text-sm text-gray-600">Beheerder: ${M}</span>`),I&&(O+=`<br/><span class="text-sm text-gray-600">Toegang: ${I==="yes"?"Openbaar":I==="private"?"Priv":I}</span>`),N&&(O+=`<br/><span class="text-sm text-gray-600">Kosten: ${N==="yes"?"Betaald":N==="no"?"Gratis":N}</span>`),F&&(O+=`<br/><span class="text-sm text-gray-600">Capaciteit: ${F} boten</span>`),V&&(O+=`<br/><a href="${V}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Website</a>`)}else if(L==="Boothellingen"||A.layerType==="boothelling"){const B=A.name||"Boothelling",M=A.operator||"",I=A.access||"",N=A.fee||"",F=A.surface||"",V=A.website||"";O=`<strong class="text-green-800">${B}</strong>`,M&&(O+=`<br/><span class="text-sm text-gray-600">Beheerder: ${M}</span>`),I&&(O+=`<br/><span class="text-sm text-gray-600">Toegang: ${I==="yes"||I==="public"?"Openbaar":I==="private"?"Priv":I}</span>`),N&&(O+=`<br/><span class="text-sm text-gray-600">Kosten: ${N==="yes"?"Betaald":N==="no"?"Gratis":N}</span>`),F&&(O+=`<br/><span class="text-sm text-gray-600">Ondergrond: ${F}</span>`),V&&(O+=`<br/><a href="${V}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Website</a>`)}else if(L==="Viswater"||A.layerType==="viswater"){const B=A.name||"Viswater",M=A.fishing||"",I=A.access||"",N=A.operator||"";O=`<strong class="text-purple-800">${B}</strong>`,M&&(O+=`<br/><span class="text-sm text-purple-700">Type: ${M}</span>`),N&&(O+=`<br/><span class="text-sm text-gray-600">Beheerder: ${N}</span>`),I&&(O+=`<br/><span class="text-sm text-gray-600">Toegang: ${I}</span>`)}else(A.name||A.title)&&(O=`<strong class="text-gray-800">${A.name||A.title}</strong>`,A.description&&(O+=`<br/><span class="text-sm text-gray-600">${A.description}</span>`));O&&T.push({content:O,coordinate:C.coordinate})}),T.length>0){t(T.map(k=>k.content)),r(0),o(!0);const b=kv(T[0].coordinate);u(`https://www.google.com/maps/dir/?api=1&destination=${b[1]},${b[0]}`)}};return n.on("singleclick",S),()=>{n.un("singleclick",S)}},[n]);const p=()=>{o(!1),t([]),r(0),u(null)},_=()=>{i<h-1&&r(i+1)},x=()=>{i>0&&r(i-1)};return y.jsx(On,{children:s&&f&&y.jsxs(Ue.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},className:"fixed bottom-0 left-0 right-0 z-[1200] bg-white rounded-t-2xl shadow-lg max-h-[50vh] overflow-hidden",children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100 bg-gradient-to-r from-blue-500 to-blue-600",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[h>1&&y.jsxs("div",{className:"flex items-center gap-1 mr-2",children:[y.jsx("button",{onClick:x,disabled:i===0,className:"p-1 rounded bg-blue-600 hover:bg-blue-700 disabled:opacity-50 border-0 outline-none",children:y.jsx(Q$,{size:16,className:"text-white"})}),y.jsxs("span",{className:"text-white text-xs px-1",children:[i+1,"/",h]}),y.jsx("button",{onClick:_,disabled:i===h-1,className:"p-1 rounded bg-blue-600 hover:bg-blue-700 disabled:opacity-50 border-0 outline-none",children:y.jsx(qc,{size:16,className:"text-white"})})]}),y.jsx("span",{className:"font-medium text-white text-sm",children:"Info"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[l&&y.jsx("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 rounded bg-blue-600 hover:bg-blue-700 border-0 outline-none",title:"Navigeer met Google Maps",onClick:S=>S.stopPropagation(),children:y.jsx(VH,{size:16,className:"text-white"})}),y.jsx("button",{onClick:p,className:"p-1.5 rounded bg-blue-600 hover:bg-blue-700 border-0 outline-none",children:y.jsx(di,{size:16,className:"text-white"})})]})]}),y.jsx("div",{className:"p-4 overflow-y-auto",style:{maxHeight:"calc(50vh - 56px)"},dangerouslySetInnerHTML:{__html:f}})]})})}function kq({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=AD(),[l,u]=K.useState(""),[h,f]=K.useState(!1),[p,_]=K.useState(!1),[x,S]=K.useState(null);if(K.useEffect(()=>{o()},[o]),s)return y.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center",children:y.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return y.jsx(y.Fragment,{children:n});const C=b=>{b.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},T=async()=>{try{S(null),await i()}catch{S("Google login mislukt"),setTimeout(()=>S(null),3e3)}};return y.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center p-4",children:y.jsxs(Ue.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[y.jsxs("div",{className:"flex flex-col items-center mb-6",children:[y.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:y.jsx(Qs,{size:40,className:"text-white"})}),y.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),y.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),y.jsxs(Ue.button,{onClick:T,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[y.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[y.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),y.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),y.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),y.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),x&&y.jsx(Ue.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:x}),y.jsxs("div",{className:"flex items-center gap-3 my-4",children:[y.jsx("div",{className:"flex-1 h-px bg-gray-200"}),y.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),y.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),y.jsxs("form",{onSubmit:C,className:"space-y-4",children:[y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:y.jsx(bH,{size:20})}),y.jsx("input",{type:p?"text":"password",value:l,onChange:b=>u(b.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-blue-400"}`}),y.jsx("button",{type:"button",onClick:()=>_(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p?y.jsx(dH,{size:20}):y.jsx(gH,{size:20})})]}),h&&y.jsx(Ue.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),y.jsx(Ue.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),y.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function Nq(){const n=Ln(s=>s.spotFormOpen),e=Ln(s=>s.spotFormLocation),t=Ln(s=>s.closeSpotForm),r=14*at(s=>s.fontScale)/100;return y.jsx(kq,{children:y.jsxs("div",{className:"h-screen w-screen overflow-hidden",style:{fontSize:`${r}px`},children:[y.jsx(O$,{}),y.jsx(jK,{}),y.jsx(Sq,{}),y.jsx(Iq,{}),y.jsx(Pq,{}),y.jsx(DK,{}),y.jsx(fq,{}),y.jsx(FK,{}),y.jsx(zK,{}),y.jsx(ZK,{}),y.jsx(KK,{}),y.jsx(bq,{}),y.jsx(Tq,{}),y.jsx(LK,{}),y.jsx(UK,{}),y.jsx(Aq,{}),y.jsx(On,{children:n&&y.jsx(Cq,{onClose:t,initialLocation:e||void 0})})]})})}const Dq="1.2.32";console.log(`%c VisApp v${Dq}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");aL.createRoot(document.getElementById("root")).render(y.jsx(Nq,{}));export{qq as $,zA as A,bt as B,kl as C,nt as D,Be as E,Cr as F,LV as G,Om as H,BF as I,gl as J,jA as K,VA as L,zq as M,Gp as N,BV as O,Bq as P,UA as Q,Xc as R,Ji as S,F6 as T,ml as U,M1 as V,_A as W,jq as X,Fq as Y,Uq as Z,Xq as _,G1 as a,OI as a0,k4 as a1,N4 as a2,Kq as a3,Wq as a4,kd as a5,Gq as a6,Vq as a7,pr as a8,lu as a9,zg as aA,Cv as aB,eo as aC,Hq as aD,pp as aE,tt as aa,fp as ab,Bp as ac,rP as ad,jv as ae,au as af,OV as ag,pP as ah,ol as ai,$o as aj,Mn as ak,zm as al,Ve as am,un as an,cu as ao,oi as ap,Wh as aq,Xs as ar,Xm as as,$q as at,g6 as au,d6 as av,p6 as aw,cP as ax,h1 as ay,Sd as az,Mu as b,Wn as c,Zq as d,er as e,ci as f,ft as g,xC as h,f1 as i,y6 as j,Yg as k,E1 as l,al as m,d1 as n,yA as o,OA as p,FA as q,Oq as r,zV as s,Gm as t,FI as u,Hc as v,jI as w,UV as x,I1 as y,S1 as z};
//# sourceMappingURL=index-BO2h6aVx.js.map
