const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-CuMa98Rt.js","assets/GeoJSON-DQdleVAJ.js","assets/iconStyles-BfRxaMb_.js","assets/boothellingenOL-D91mXJQT.js","assets/viswaterOL-ChKya8gm.js","assets/hillshadeLayers-DnU3sskJ.js","assets/common-DpNHzTjJ.js","assets/pdokWaterOL-D9f5Au-N.js","assets/TileWMS-CRF_oLXH.js","assets/zeevisstekkenOL-DJyM5ti7.js","assets/vaarwegmarkeringenOL-CE794Wv5.js","assets/bathymetrieOL-Db01RDSu.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Xv(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var f_={exports:{}},Dh={},g_={exports:{}},Ke={};var yS;function IL(){if(yS)return Ke;yS=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator;function _(W){return W===null||typeof W!="object"?null:(W=m&&W[m]||W["@@iterator"],typeof W=="function"?W:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,I={};function T(W,G,oe){this.props=W,this.context=G,this.refs=I,this.updater=oe||v}T.prototype.isReactComponent={},T.prototype.setState=function(W,G){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,G,"setState")},T.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function R(){}R.prototype=T.prototype;function M(W,G,oe){this.props=W,this.context=G,this.refs=I,this.updater=oe||v}var N=M.prototype=new R;N.constructor=M,S(N,T.prototype),N.isPureReactComponent=!0;var L=Array.isArray,A=Object.prototype.hasOwnProperty,z={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function b(W,G,oe){var ge,xe={},Te=null,Me=null;if(G!=null)for(ge in G.ref!==void 0&&(Me=G.ref),G.key!==void 0&&(Te=""+G.key),G)A.call(G,ge)&&!P.hasOwnProperty(ge)&&(xe[ge]=G[ge]);var le=arguments.length-2;if(le===1)xe.children=oe;else if(1<le){for(var Re=Array(le),He=0;He<le;He++)Re[He]=arguments[He+2];xe.children=Re}if(W&&W.defaultProps)for(ge in le=W.defaultProps,le)xe[ge]===void 0&&(xe[ge]=le[ge]);return{$$typeof:n,type:W,key:Te,ref:Me,props:xe,_owner:z.current}}function k(W,G){return{$$typeof:n,type:W.type,key:G,ref:W.ref,props:W.props,_owner:W._owner}}function F(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function V(W){var G={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(oe){return G[oe]})}var U=/\/+/g;function O(W,G){return typeof W=="object"&&W!==null&&W.key!=null?V(""+W.key):G.toString(36)}function se(W,G,oe,ge,xe){var Te=typeof W;(Te==="undefined"||Te==="boolean")&&(W=null);var Me=!1;if(W===null)Me=!0;else switch(Te){case"string":case"number":Me=!0;break;case"object":switch(W.$$typeof){case n:case e:Me=!0}}if(Me)return Me=W,xe=xe(Me),W=ge===""?"."+O(Me,0):ge,L(xe)?(oe="",W!=null&&(oe=W.replace(U,"$&/")+"/"),se(xe,G,oe,"",function(He){return He})):xe!=null&&(F(xe)&&(xe=k(xe,oe+(!xe.key||Me&&Me.key===xe.key?"":(""+xe.key).replace(U,"$&/")+"/")+W)),G.push(xe)),1;if(Me=0,ge=ge===""?".":ge+":",L(W))for(var le=0;le<W.length;le++){Te=W[le];var Re=ge+O(Te,le);Me+=se(Te,G,oe,Re,xe)}else if(Re=_(W),typeof Re=="function")for(W=Re.call(W),le=0;!(Te=W.next()).done;)Te=Te.value,Re=ge+O(Te,le++),Me+=se(Te,G,oe,Re,xe);else if(Te==="object")throw G=String(W),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.");return Me}function pe(W,G,oe){if(W==null)return W;var ge=[],xe=0;return se(W,ge,"","",function(Te){return G.call(oe,Te,xe++)}),ge}function J(W){if(W._status===-1){var G=W._result;G=G(),G.then(function(oe){(W._status===0||W._status===-1)&&(W._status=1,W._result=oe)},function(oe){(W._status===0||W._status===-1)&&(W._status=2,W._result=oe)}),W._status===-1&&(W._status=0,W._result=G)}if(W._status===1)return W._result.default;throw W._result}var re={current:null},Y={transition:null},H={ReactCurrentDispatcher:re,ReactCurrentBatchConfig:Y,ReactCurrentOwner:z};function X(){throw Error("act(...) is not supported in production builds of React.")}return Ke.Children={map:pe,forEach:function(W,G,oe){pe(W,function(){G.apply(this,arguments)},oe)},count:function(W){var G=0;return pe(W,function(){G++}),G},toArray:function(W){return pe(W,function(G){return G})||[]},only:function(W){if(!F(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Ke.Component=T,Ke.Fragment=t,Ke.Profiler=r,Ke.PureComponent=M,Ke.StrictMode=i,Ke.Suspense=u,Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,Ke.act=X,Ke.cloneElement=function(W,G,oe){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var ge=S({},W.props),xe=W.key,Te=W.ref,Me=W._owner;if(G!=null){if(G.ref!==void 0&&(Te=G.ref,Me=z.current),G.key!==void 0&&(xe=""+G.key),W.type&&W.type.defaultProps)var le=W.type.defaultProps;for(Re in G)A.call(G,Re)&&!P.hasOwnProperty(Re)&&(ge[Re]=G[Re]===void 0&&le!==void 0?le[Re]:G[Re])}var Re=arguments.length-2;if(Re===1)ge.children=oe;else if(1<Re){le=Array(Re);for(var He=0;He<Re;He++)le[He]=arguments[He+2];ge.children=le}return{$$typeof:n,type:W.type,key:xe,ref:Te,props:ge,_owner:Me}},Ke.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:s,_context:W},W.Consumer=W},Ke.createElement=b,Ke.createFactory=function(W){var G=b.bind(null,W);return G.type=W,G},Ke.createRef=function(){return{current:null}},Ke.forwardRef=function(W){return{$$typeof:l,render:W}},Ke.isValidElement=F,Ke.lazy=function(W){return{$$typeof:f,_payload:{_status:-1,_result:W},_init:J}},Ke.memo=function(W,G){return{$$typeof:h,type:W,compare:G===void 0?null:G}},Ke.startTransition=function(W){var G=Y.transition;Y.transition={};try{W()}finally{Y.transition=G}},Ke.unstable_act=X,Ke.useCallback=function(W,G){return re.current.useCallback(W,G)},Ke.useContext=function(W){return re.current.useContext(W)},Ke.useDebugValue=function(){},Ke.useDeferredValue=function(W){return re.current.useDeferredValue(W)},Ke.useEffect=function(W,G){return re.current.useEffect(W,G)},Ke.useId=function(){return re.current.useId()},Ke.useImperativeHandle=function(W,G,oe){return re.current.useImperativeHandle(W,G,oe)},Ke.useInsertionEffect=function(W,G){return re.current.useInsertionEffect(W,G)},Ke.useLayoutEffect=function(W,G){return re.current.useLayoutEffect(W,G)},Ke.useMemo=function(W,G){return re.current.useMemo(W,G)},Ke.useReducer=function(W,G,oe){return re.current.useReducer(W,G,oe)},Ke.useRef=function(W){return re.current.useRef(W)},Ke.useState=function(W){return re.current.useState(W)},Ke.useSyncExternalStore=function(W,G,oe){return re.current.useSyncExternalStore(W,G,oe)},Ke.useTransition=function(){return re.current.useTransition()},Ke.version="18.3.1",Ke}var _S;function cf(){return _S||(_S=1,g_.exports=IL()),g_.exports}var xS;function bL(){if(xS)return Dh;xS=1;var n=cf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var f,m={},_=null,v=null;h!==void 0&&(_=""+h),u.key!==void 0&&(_=""+u.key),u.ref!==void 0&&(v=u.ref);for(f in u)i.call(u,f)&&!s.hasOwnProperty(f)&&(m[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)m[f]===void 0&&(m[f]=u[f]);return{$$typeof:e,type:l,key:_,ref:v,props:m,_owner:r.current}}return Dh.Fragment=t,Dh.jsx=o,Dh.jsxs=o,Dh}var vS;function CL(){return vS||(vS=1,f_.exports=bL()),f_.exports}var g=CL(),$g={},p_={exports:{}},ri={},m_={exports:{}},y_={};var wS;function RL(){return wS||(wS=1,(function(n){function e(Y,H){var X=Y.length;Y.push(H);e:for(;0<X;){var W=X-1>>>1,G=Y[W];if(0<r(G,H))Y[W]=H,Y[X]=G,X=W;else break e}}function t(Y){return Y.length===0?null:Y[0]}function i(Y){if(Y.length===0)return null;var H=Y[0],X=Y.pop();if(X!==H){Y[0]=X;e:for(var W=0,G=Y.length,oe=G>>>1;W<oe;){var ge=2*(W+1)-1,xe=Y[ge],Te=ge+1,Me=Y[Te];if(0>r(xe,X))Te<G&&0>r(Me,xe)?(Y[W]=Me,Y[Te]=X,W=Te):(Y[W]=xe,Y[ge]=X,W=ge);else if(Te<G&&0>r(Me,X))Y[W]=Me,Y[Te]=X,W=Te;else break e}}return H}function r(Y,H){var X=Y.sortIndex-H.sortIndex;return X!==0?X:Y.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,m=null,_=3,v=!1,S=!1,I=!1,T=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Y){for(var H=t(h);H!==null;){if(H.callback===null)i(h);else if(H.startTime<=Y)i(h),H.sortIndex=H.expirationTime,e(u,H);else break;H=t(h)}}function L(Y){if(I=!1,N(Y),!S)if(t(u)!==null)S=!0,J(A);else{var H=t(h);H!==null&&re(L,H.startTime-Y)}}function A(Y,H){S=!1,I&&(I=!1,R(b),b=-1),v=!0;var X=_;try{for(N(H),m=t(u);m!==null&&(!(m.expirationTime>H)||Y&&!V());){var W=m.callback;if(typeof W=="function"){m.callback=null,_=m.priorityLevel;var G=W(m.expirationTime<=H);H=n.unstable_now(),typeof G=="function"?m.callback=G:m===t(u)&&i(u),N(H)}else i(u);m=t(u)}if(m!==null)var oe=!0;else{var ge=t(h);ge!==null&&re(L,ge.startTime-H),oe=!1}return oe}finally{m=null,_=X,v=!1}}var z=!1,P=null,b=-1,k=5,F=-1;function V(){return!(n.unstable_now()-F<k)}function U(){if(P!==null){var Y=n.unstable_now();F=Y;var H=!0;try{H=P(!0,Y)}finally{H?O():(z=!1,P=null)}}else z=!1}var O;if(typeof M=="function")O=function(){M(U)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,pe=se.port2;se.port1.onmessage=U,O=function(){pe.postMessage(null)}}else O=function(){T(U,0)};function J(Y){P=Y,z||(z=!0,O())}function re(Y,H){b=T(function(){Y(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_continueExecution=function(){S||v||(S=!0,J(A))},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(Y){switch(_){case 1:case 2:case 3:var H=3;break;default:H=_}var X=_;_=H;try{return Y()}finally{_=X}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Y,H){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var X=_;_=Y;try{return H()}finally{_=X}},n.unstable_scheduleCallback=function(Y,H,X){var W=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?W+X:W):X=W,Y){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=X+G,Y={id:f++,callback:H,priorityLevel:Y,startTime:X,expirationTime:G,sortIndex:-1},X>W?(Y.sortIndex=X,e(h,Y),t(u)===null&&Y===t(h)&&(I?(R(b),b=-1):I=!0,re(L,X-W))):(Y.sortIndex=G,e(u,Y),S||v||(S=!0,J(A))),Y},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(Y){var H=_;return function(){var X=_;_=H;try{return Y.apply(this,arguments)}finally{_=X}}}})(y_)),y_}var ES;function AL(){return ES||(ES=1,m_.exports=RL()),m_.exports}var TS;function PL(){if(TS)return ri;TS=1;var n=cf(),e=AL();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)i.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function _(a){return u.call(m,a)?!0:u.call(f,a)?!1:h.test(a)?m[a]=!0:(f[a]=!0,!1)}function v(a,c,d,y){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return y?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function S(a,c,d,y){if(c===null||typeof c>"u"||v(a,c,d,y))return!0;if(y)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function I(a,c,d,y,x,w,D){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=y,this.attributeNamespace=x,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=w,this.removeEmptyString=D}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){T[a]=new I(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];T[c]=new I(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){T[a]=new I(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){T[a]=new I(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){T[a]=new I(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){T[a]=new I(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){T[a]=new I(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){T[a]=new I(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){T[a]=new I(a,5,!1,a.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function M(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(R,M);T[c]=new I(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(R,M);T[c]=new I(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(R,M);T[c]=new I(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){T[a]=new I(a,1,!1,a.toLowerCase(),null,!1,!1)}),T.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){T[a]=new I(a,1,!1,a.toLowerCase(),null,!0,!0)});function N(a,c,d,y){var x=T.hasOwnProperty(c)?T[c]:null;(x!==null?x.type!==0:y||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(S(c,d,x,y)&&(d=null),y||x===null?_(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):x.mustUseProperty?a[x.propertyName]=d===null?x.type===3?!1:"":d:(c=x.attributeName,y=x.attributeNamespace,d===null?a.removeAttribute(c):(x=x.type,d=x===3||x===4&&d===!0?"":""+d,y?a.setAttributeNS(y,c,d):a.setAttribute(c,d))))}var L=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),z=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),V=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),re=Symbol.for("react.offscreen"),Y=Symbol.iterator;function H(a){return a===null||typeof a!="object"?null:(a=Y&&a[Y]||a["@@iterator"],typeof a=="function"?a:null)}var X=Object.assign,W;function G(a){if(W===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);W=c&&c[1]||""}return`
`+W+a}var oe=!1;function ge(a,c){if(!a||oe)return"";oe=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(ne){var y=ne}Reflect.construct(a,[],c)}else{try{c.call()}catch(ne){y=ne}a.call(c.prototype)}else{try{throw Error()}catch(ne){y=ne}a()}}catch(ne){if(ne&&y&&typeof ne.stack=="string"){for(var x=ne.stack.split(`
`),w=y.stack.split(`
`),D=x.length-1,B=w.length-1;1<=D&&0<=B&&x[D]!==w[B];)B--;for(;1<=D&&0<=B;D--,B--)if(x[D]!==w[B]){if(D!==1||B!==1)do if(D--,B--,0>B||x[D]!==w[B]){var $=`
`+x[D].replace(" at new "," at ");return a.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",a.displayName)),$}while(1<=D&&0<=B);break}}}finally{oe=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?G(a):""}function xe(a){switch(a.tag){case 5:return G(a.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return a=ge(a.type,!1),a;case 11:return a=ge(a.type.render,!1),a;case 1:return a=ge(a.type,!0),a;default:return""}}function Te(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case P:return"Fragment";case z:return"Portal";case k:return"Profiler";case b:return"StrictMode";case O:return"Suspense";case se:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case V:return(a.displayName||"Context")+".Consumer";case F:return(a._context.displayName||"Context")+".Provider";case U:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case pe:return c=a.displayName||null,c!==null?c:Te(a.type)||"Memo";case J:c=a._payload,a=a._init;try{return Te(a(c))}catch{}}return null}function Me(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Te(c);case 8:return c===b?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function le(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Re(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function He(a){var c=Re(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),y=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,w=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return x.call(this)},set:function(D){y=""+D,w.call(this,D)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return y},setValue:function(D){y=""+D},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function Wt(a){a._valueTracker||(a._valueTracker=He(a))}function sr(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),y="";return a&&(y=Re(a)?a.checked?"true":"false":a.value),a=y,a!==d?(c.setValue(a),!0):!1}function Yn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Zn(a,c){var d=c.checked;return X({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function fn(a,c){var d=c.defaultValue==null?"":c.defaultValue,y=c.checked!=null?c.checked:c.defaultChecked;d=le(c.value!=null?c.value:d),a._wrapperState={initialChecked:y,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function gn(a,c){c=c.checked,c!=null&&N(a,"checked",c,!1)}function Qn(a,c){gn(a,c);var d=le(c.value),y=c.type;if(d!=null)y==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(y==="submit"||y==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?_t(a,c.type,d):c.hasOwnProperty("defaultValue")&&_t(a,c.type,le(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Mi(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var y=c.type;if(!(y!=="submit"&&y!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function _t(a,c,d){(c!=="number"||Yn(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ht=Array.isArray;function rn(a,c,d,y){if(a=a.options,c){c={};for(var x=0;x<d.length;x++)c["$"+d[x]]=!0;for(d=0;d<a.length;d++)x=c.hasOwnProperty("$"+a[d].value),a[d].selected!==x&&(a[d].selected=x),x&&y&&(a[d].defaultSelected=!0)}else{for(d=""+le(d),c=null,x=0;x<a.length;x++){if(a[x].value===d){a[x].selected=!0,y&&(a[x].defaultSelected=!0);return}c!==null||a[x].disabled||(c=a[x])}c!==null&&(c.selected=!0)}}function Li(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return X({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function bt(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(t(92));if(ht(d)){if(1<d.length)throw Error(t(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:le(d)}}function ao(a,c){var d=le(c.value),y=le(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),y!=null&&(a.defaultValue=""+y)}function Oi(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function Mr(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function or(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?Mr(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Lr,ya=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,y,x){MSApp.execUnsafeLocalFunction(function(){return a(c,d,y,x)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(Lr=Lr||document.createElement("div"),Lr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Lr.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function Or(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var ji={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gl=["Webkit","ms","Moz","O"];Object.keys(ji).forEach(function(a){Gl.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),ji[c]=ji[a]})});function jr(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||ji.hasOwnProperty(a)&&ji[a]?(""+c).trim():c+"px"}function ws(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var y=d.indexOf("--")===0,x=jr(d,c[d],y);d==="float"&&(d="cssFloat"),y?a.setProperty(d,x):a[d]=x}}var lo=X({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Un(a,c){if(c){if(lo[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function Es(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fr=null;function Vr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Bn=null,Wn=null,gt=null;function co(a){if(a=_h(a)){if(typeof Bn!="function")throw Error(t(280));var c=a.stateNode;c&&(c=og(c),Bn(a.stateNode,a.type,c))}}function ar(a){Wn?gt?gt.push(a):gt=[a]:Wn=a}function jt(){if(Wn){var a=Wn,c=gt;if(gt=Wn=null,co(a),c)for(a=0;a<c.length;a++)co(c[a])}}function Fi(a,c){return a(c)}function pn(){}var Ft=!1;function mn(a,c,d){if(Ft)return a(c,d);Ft=!0;try{return Fi(a,c,d)}finally{Ft=!1,(Wn!==null||gt!==null)&&(pn(),jt())}}function yn(a,c){var d=a.stateNode;if(d===null)return null;var y=og(d);if(y===null)return null;d=y[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(a=a.type,y=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!y;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,c,typeof d));return d}var sn=!1;if(l)try{var ot={};Object.defineProperty(ot,"passive",{get:function(){sn=!0}}),window.addEventListener("test",ot,ot),window.removeEventListener("test",ot,ot)}catch{sn=!1}function Gt(a,c,d,y,x,w,D,B,$){var ne=Array.prototype.slice.call(arguments,3);try{c.apply(d,ne)}catch(ue){this.onError(ue)}}var Yt=!1,Vi=null,$l=!1,zi=null,Ff={onError:function(a){Yt=!0,Vi=a}};function Vf(a,c,d,y,x,w,D,B,$){Yt=!1,Vi=null,Gt.apply(Ff,arguments)}function Hu(a,c,d,y,x,w,D,B,$){if(Vf.apply(this,arguments),Yt){if(Yt){var ne=Vi;Yt=!1,Vi=null}else throw Error(t(198));$l||($l=!0,zi=ne)}}function lr(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function Ku(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function zf(a){if(lr(a)!==a)throw Error(t(188))}function Uf(a){var c=a.alternate;if(!c){if(c=lr(a),c===null)throw Error(t(188));return c!==a?null:a}for(var d=a,y=c;;){var x=d.return;if(x===null)break;var w=x.alternate;if(w===null){if(y=x.return,y!==null){d=y;continue}break}if(x.child===w.child){for(w=x.child;w;){if(w===d)return zf(x),a;if(w===y)return zf(x),c;w=w.sibling}throw Error(t(188))}if(d.return!==y.return)d=x,y=w;else{for(var D=!1,B=x.child;B;){if(B===d){D=!0,d=x,y=w;break}if(B===y){D=!0,y=x,d=w;break}B=B.sibling}if(!D){for(B=w.child;B;){if(B===d){D=!0,d=w,y=x;break}if(B===y){D=!0,y=w,d=x;break}B=B.sibling}if(!D)throw Error(t(189))}}if(d.alternate!==y)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:c}function Bf(a){return a=Uf(a),a!==null?_a(a):null}function _a(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=_a(a);if(c!==null)return c;a=a.sibling}return null}var qu=e.unstable_scheduleCallback,Hl=e.unstable_cancelCallback,xa=e.unstable_shouldYield,Ts=e.unstable_requestPaint,vt=e.unstable_now,G0=e.unstable_getCurrentPriorityLevel,Kl=e.unstable_ImmediatePriority,Xu=e.unstable_UserBlockingPriority,va=e.unstable_NormalPriority,Yu=e.unstable_LowPriority,ql=e.unstable_IdlePriority,wa=null,mi=null;function Wf(a){if(mi&&typeof mi.onCommitFiberRoot=="function")try{mi.onCommitFiberRoot(wa,a,void 0,(a.current.flags&128)===128)}catch{}}var yi=Math.clz32?Math.clz32:Ea,zr=Math.log,Ui=Math.LN2;function Ea(a){return a>>>=0,a===0?32:31-(zr(a)/Ui|0)|0}var Ur=64,uo=4194304;function at(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Ss(a,c){var d=a.pendingLanes;if(d===0)return 0;var y=0,x=a.suspendedLanes,w=a.pingedLanes,D=d&268435455;if(D!==0){var B=D&~x;B!==0?y=at(B):(w&=D,w!==0&&(y=at(w)))}else D=d&~x,D!==0?y=at(D):w!==0&&(y=at(w));if(y===0)return 0;if(c!==0&&c!==y&&(c&x)===0&&(x=y&-y,w=c&-c,x>=w||x===16&&(w&4194240)!==0))return c;if((y&4)!==0&&(y|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=y;0<c;)d=31-yi(c),x=1<<d,y|=a[d],c&=~x;return y}function Ta(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sa(a,c){for(var d=a.suspendedLanes,y=a.pingedLanes,x=a.expirationTimes,w=a.pendingLanes;0<w;){var D=31-yi(w),B=1<<D,$=x[D];$===-1?((B&d)===0||(B&y)!==0)&&(x[D]=Ta(B,c)):$<=c&&(a.expiredLanes|=B),w&=~B}}function Zu(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Qu(){var a=Ur;return Ur<<=1,(Ur&4194240)===0&&(Ur=64),a}function Ju(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function Ia(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-yi(c),a[c]=d}function $0(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var y=a.eventTimes;for(a=a.expirationTimes;0<d;){var x=31-yi(d),w=1<<x;c[x]=0,y[x]=-1,a[x]=-1,d&=~w}}function eh(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var y=31-yi(d),x=1<<y;x&c|a[y]&c&&(a[y]|=c),d&=~x}}var Ye=0;function Br(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var th,Xl,nh,ih,rh,Wr=!1,Yl=[],Gr=null,$r=null,_n=null,ba=new Map,Is=new Map,_i=[],Gf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ho(a,c){switch(a){case"focusin":case"focusout":Gr=null;break;case"dragenter":case"dragleave":$r=null;break;case"mouseover":case"mouseout":_n=null;break;case"pointerover":case"pointerout":ba.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Is.delete(c.pointerId)}}function cr(a,c,d,y,x,w){return a===null||a.nativeEvent!==w?(a={blockedOn:c,domEventName:d,eventSystemFlags:y,nativeEvent:w,targetContainers:[x]},c!==null&&(c=_h(c),c!==null&&Xl(c)),a):(a.eventSystemFlags|=y,c=a.targetContainers,x!==null&&c.indexOf(x)===-1&&c.push(x),a)}function $f(a,c,d,y,x){switch(c){case"focusin":return Gr=cr(Gr,a,c,d,y,x),!0;case"dragenter":return $r=cr($r,a,c,d,y,x),!0;case"mouseover":return _n=cr(_n,a,c,d,y,x),!0;case"pointerover":var w=x.pointerId;return ba.set(w,cr(ba.get(w)||null,a,c,d,y,x)),!0;case"gotpointercapture":return w=x.pointerId,Is.set(w,cr(Is.get(w)||null,a,c,d,y,x)),!0}return!1}function Zl(a){var c=Pa(a.target);if(c!==null){var d=lr(c);if(d!==null){if(c=d.tag,c===13){if(c=Ku(d),c!==null){a.blockedOn=c,rh(a.priority,function(){nh(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function mt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=Ql(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var y=new d.constructor(d.type,d);Fr=y,d.target.dispatchEvent(y),Fr=null}else return c=_h(d),c!==null&&Xl(c),a.blockedOn=d,!1;c.shift()}return!0}function Hf(a,c,d){mt(a)&&d.delete(c)}function H0(){Wr=!1,Gr!==null&&mt(Gr)&&(Gr=null),$r!==null&&mt($r)&&($r=null),_n!==null&&mt(_n)&&(_n=null),ba.forEach(Hf),Is.forEach(Hf)}function fo(a,c){a.blockedOn===c&&(a.blockedOn=null,Wr||(Wr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,H0)))}function go(a){function c(x){return fo(x,a)}if(0<Yl.length){fo(Yl[0],a);for(var d=1;d<Yl.length;d++){var y=Yl[d];y.blockedOn===a&&(y.blockedOn=null)}}for(Gr!==null&&fo(Gr,a),$r!==null&&fo($r,a),_n!==null&&fo(_n,a),ba.forEach(c),Is.forEach(c),d=0;d<_i.length;d++)y=_i[d],y.blockedOn===a&&(y.blockedOn=null);for(;0<_i.length&&(d=_i[0],d.blockedOn===null);)Zl(d),d.blockedOn===null&&_i.shift()}var bs=L.ReactCurrentBatchConfig,Cs=!0;function Hr(a,c,d,y){var x=Ye,w=bs.transition;bs.transition=null;try{Ye=1,sh(a,c,d,y)}finally{Ye=x,bs.transition=w}}function Kf(a,c,d,y){var x=Ye,w=bs.transition;bs.transition=null;try{Ye=4,sh(a,c,d,y)}finally{Ye=x,bs.transition=w}}function sh(a,c,d,y){if(Cs){var x=Ql(a,c,d,y);if(x===null)iy(a,c,y,Kr,d),ho(a,y);else if($f(x,a,c,d,y))y.stopPropagation();else if(ho(a,y),c&4&&-1<Gf.indexOf(a)){for(;x!==null;){var w=_h(x);if(w!==null&&th(w),w=Ql(a,c,d,y),w===null&&iy(a,c,y,Kr,d),w===x)break;x=w}x!==null&&y.stopPropagation()}else iy(a,c,y,null,d)}}var Kr=null;function Ql(a,c,d,y){if(Kr=null,a=Vr(y),a=Pa(a),a!==null)if(c=lr(a),c===null)a=null;else if(d=c.tag,d===13){if(a=Ku(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return Kr=a,null}function Jl(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(G0()){case Kl:return 1;case Xu:return 4;case va:case Yu:return 16;case ql:return 536870912;default:return 16}default:return 16}}var xi=null,ec=null,Rs=null;function qf(){if(Rs)return Rs;var a,c=ec,d=c.length,y,x="value"in xi?xi.value:xi.textContent,w=x.length;for(a=0;a<d&&c[a]===x[a];a++);var D=d-a;for(y=1;y<=D&&c[d-y]===x[w-y];y++);return Rs=x.slice(a,1<y?1-y:void 0)}function Ca(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function qr(){return!0}function oh(){return!1}function An(a){function c(d,y,x,w,D){this._reactName=d,this._targetInst=x,this.type=y,this.nativeEvent=w,this.target=D,this.currentTarget=null;for(var B in a)a.hasOwnProperty(B)&&(d=a[B],this[B]=d?d(w):w[B]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?qr:oh,this.isPropagationStopped=oh,this}return X(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=qr)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=qr)},persist:function(){},isPersistent:qr}),c}var Xr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ra=An(Xr),po=X({},Xr,{view:0,detail:0}),tc=An(po),nc,ic,vi,Aa=X({},po,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Be,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==vi&&(vi&&a.type==="mousemove"?(nc=a.screenX-vi.screenX,ic=a.screenY-vi.screenY):ic=nc=0,vi=a),nc)},movementY:function(a){return"movementY"in a?a.movementY:ic}}),ah=An(Aa),Xf=X({},Aa,{dataTransfer:0}),Yf=An(Xf),rc=X({},po,{relatedTarget:0}),xn=An(rc),Zf=X({},Xr,{animationName:0,elapsedTime:0,pseudoElement:0}),Qf=An(Zf),mo=X({},Xr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),p=An(mo),E=X({},Xr,{data:0}),C=An(E),j={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Q={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ie={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function me(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=ie[a])?!!c[a]:!1}function Be(){return me}var Vt=X({},po,{key:function(a){if(a.key){var c=j[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=Ca(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Q[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Be,charCode:function(a){return a.type==="keypress"?Ca(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Ca(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),dt=An(Vt),$t=X({},Aa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wi=An($t),As=X({},po,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Be}),Yr=An(As),Zr=X({},Xr,{propertyName:0,elapsedTime:0,pseudoElement:0}),sc=An(Zr),lh=X({},Aa,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),xM=An(lh),vM=[9,13,27,32],K0=l&&"CompositionEvent"in window,ch=null;l&&"documentMode"in document&&(ch=document.documentMode);var wM=l&&"TextEvent"in window&&!ch,cE=l&&(!K0||ch&&8<ch&&11>=ch),uE=" ",hE=!1;function dE(a,c){switch(a){case"keyup":return vM.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fE(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var oc=!1;function EM(a,c){switch(a){case"compositionend":return fE(c);case"keypress":return c.which!==32?null:(hE=!0,uE);case"textInput":return a=c.data,a===uE&&hE?null:a;default:return null}}function TM(a,c){if(oc)return a==="compositionend"||!K0&&dE(a,c)?(a=qf(),Rs=ec=xi=null,oc=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return cE&&c.locale!=="ko"?null:c.data;default:return null}}var SM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gE(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!SM[a.type]:c==="textarea"}function pE(a,c,d,y){ar(y),c=ig(c,"onChange"),0<c.length&&(d=new Ra("onChange","change",null,d,y),a.push({event:d,listeners:c}))}var uh=null,hh=null;function IM(a){DE(a,0)}function Jf(a){var c=hc(a);if(sr(c))return a}function bM(a,c){if(a==="change")return c}var mE=!1;if(l){var q0;if(l){var X0="oninput"in document;if(!X0){var yE=document.createElement("div");yE.setAttribute("oninput","return;"),X0=typeof yE.oninput=="function"}q0=X0}else q0=!1;mE=q0&&(!document.documentMode||9<document.documentMode)}function _E(){uh&&(uh.detachEvent("onpropertychange",xE),hh=uh=null)}function xE(a){if(a.propertyName==="value"&&Jf(hh)){var c=[];pE(c,hh,a,Vr(a)),mn(IM,c)}}function CM(a,c,d){a==="focusin"?(_E(),uh=c,hh=d,uh.attachEvent("onpropertychange",xE)):a==="focusout"&&_E()}function RM(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Jf(hh)}function AM(a,c){if(a==="click")return Jf(c)}function PM(a,c){if(a==="input"||a==="change")return Jf(c)}function kM(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var ur=typeof Object.is=="function"?Object.is:kM;function dh(a,c){if(ur(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),y=Object.keys(c);if(d.length!==y.length)return!1;for(y=0;y<d.length;y++){var x=d[y];if(!u.call(c,x)||!ur(a[x],c[x]))return!1}return!0}function vE(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function wE(a,c){var d=vE(a);a=0;for(var y;d;){if(d.nodeType===3){if(y=a+d.textContent.length,a<=c&&y>=c)return{node:d,offset:c-a};a=y}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=vE(d)}}function EE(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?EE(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function TE(){for(var a=window,c=Yn();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=Yn(a.document)}return c}function Y0(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function NM(a){var c=TE(),d=a.focusedElem,y=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&EE(d.ownerDocument.documentElement,d)){if(y!==null&&Y0(d)){if(c=y.start,a=y.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var x=d.textContent.length,w=Math.min(y.start,x);y=y.end===void 0?w:Math.min(y.end,x),!a.extend&&w>y&&(x=y,y=w,w=x),x=wE(d,w);var D=wE(d,y);x&&D&&(a.rangeCount!==1||a.anchorNode!==x.node||a.anchorOffset!==x.offset||a.focusNode!==D.node||a.focusOffset!==D.offset)&&(c=c.createRange(),c.setStart(x.node,x.offset),a.removeAllRanges(),w>y?(a.addRange(c),a.extend(D.node,D.offset)):(c.setEnd(D.node,D.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var DM=l&&"documentMode"in document&&11>=document.documentMode,ac=null,Z0=null,fh=null,Q0=!1;function SE(a,c,d){var y=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Q0||ac==null||ac!==Yn(y)||(y=ac,"selectionStart"in y&&Y0(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),fh&&dh(fh,y)||(fh=y,y=ig(Z0,"onSelect"),0<y.length&&(c=new Ra("onSelect","select",null,c,d),a.push({event:c,listeners:y}),c.target=ac)))}function eg(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var lc={animationend:eg("Animation","AnimationEnd"),animationiteration:eg("Animation","AnimationIteration"),animationstart:eg("Animation","AnimationStart"),transitionend:eg("Transition","TransitionEnd")},J0={},IE={};l&&(IE=document.createElement("div").style,"AnimationEvent"in window||(delete lc.animationend.animation,delete lc.animationiteration.animation,delete lc.animationstart.animation),"TransitionEvent"in window||delete lc.transitionend.transition);function tg(a){if(J0[a])return J0[a];if(!lc[a])return a;var c=lc[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in IE)return J0[a]=c[d];return a}var bE=tg("animationend"),CE=tg("animationiteration"),RE=tg("animationstart"),AE=tg("transitionend"),PE=new Map,kE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yo(a,c){PE.set(a,c),s(c,[a])}for(var ey=0;ey<kE.length;ey++){var ty=kE[ey],MM=ty.toLowerCase(),LM=ty[0].toUpperCase()+ty.slice(1);yo(MM,"on"+LM)}yo(bE,"onAnimationEnd"),yo(CE,"onAnimationIteration"),yo(RE,"onAnimationStart"),yo("dblclick","onDoubleClick"),yo("focusin","onFocus"),yo("focusout","onBlur"),yo(AE,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OM=new Set("cancel close invalid load scroll toggle".split(" ").concat(gh));function NE(a,c,d){var y=a.type||"unknown-event";a.currentTarget=d,Hu(y,c,void 0,a),a.currentTarget=null}function DE(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var y=a[d],x=y.event;y=y.listeners;e:{var w=void 0;if(c)for(var D=y.length-1;0<=D;D--){var B=y[D],$=B.instance,ne=B.currentTarget;if(B=B.listener,$!==w&&x.isPropagationStopped())break e;NE(x,B,ne),w=$}else for(D=0;D<y.length;D++){if(B=y[D],$=B.instance,ne=B.currentTarget,B=B.listener,$!==w&&x.isPropagationStopped())break e;NE(x,B,ne),w=$}}}if($l)throw a=zi,$l=!1,zi=null,a}function wt(a,c){var d=c[cy];d===void 0&&(d=c[cy]=new Set);var y=a+"__bubble";d.has(y)||(ME(c,a,2,!1),d.add(y))}function ny(a,c,d){var y=0;c&&(y|=4),ME(d,a,y,c)}var ng="_reactListening"+Math.random().toString(36).slice(2);function ph(a){if(!a[ng]){a[ng]=!0,i.forEach(function(d){d!=="selectionchange"&&(OM.has(d)||ny(d,!1,a),ny(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[ng]||(c[ng]=!0,ny("selectionchange",!1,c))}}function ME(a,c,d,y){switch(Jl(c)){case 1:var x=Hr;break;case 4:x=Kf;break;default:x=sh}d=x.bind(null,c,d,a),x=void 0,!sn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(x=!0),y?x!==void 0?a.addEventListener(c,d,{capture:!0,passive:x}):a.addEventListener(c,d,!0):x!==void 0?a.addEventListener(c,d,{passive:x}):a.addEventListener(c,d,!1)}function iy(a,c,d,y,x){var w=y;if((c&1)===0&&(c&2)===0&&y!==null)e:for(;;){if(y===null)return;var D=y.tag;if(D===3||D===4){var B=y.stateNode.containerInfo;if(B===x||B.nodeType===8&&B.parentNode===x)break;if(D===4)for(D=y.return;D!==null;){var $=D.tag;if(($===3||$===4)&&($=D.stateNode.containerInfo,$===x||$.nodeType===8&&$.parentNode===x))return;D=D.return}for(;B!==null;){if(D=Pa(B),D===null)return;if($=D.tag,$===5||$===6){y=w=D;continue e}B=B.parentNode}}y=y.return}mn(function(){var ne=w,ue=Vr(d),de=[];e:{var ce=PE.get(a);if(ce!==void 0){var _e=Ra,Ee=a;switch(a){case"keypress":if(Ca(d)===0)break e;case"keydown":case"keyup":_e=dt;break;case"focusin":Ee="focus",_e=xn;break;case"focusout":Ee="blur",_e=xn;break;case"beforeblur":case"afterblur":_e=xn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=ah;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=Yf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=Yr;break;case bE:case CE:case RE:_e=Qf;break;case AE:_e=sc;break;case"scroll":_e=tc;break;case"wheel":_e=xM;break;case"copy":case"cut":case"paste":_e=p;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=wi}var Se=(c&4)!==0,zt=!Se&&a==="scroll",Z=Se?ce!==null?ce+"Capture":null:ce;Se=[];for(var K=ne,ee;K!==null;){ee=K;var fe=ee.stateNode;if(ee.tag===5&&fe!==null&&(ee=fe,Z!==null&&(fe=yn(K,Z),fe!=null&&Se.push(mh(K,fe,ee)))),zt)break;K=K.return}0<Se.length&&(ce=new _e(ce,Ee,null,d,ue),de.push({event:ce,listeners:Se}))}}if((c&7)===0){e:{if(ce=a==="mouseover"||a==="pointerover",_e=a==="mouseout"||a==="pointerout",ce&&d!==Fr&&(Ee=d.relatedTarget||d.fromElement)&&(Pa(Ee)||Ee[Ps]))break e;if((_e||ce)&&(ce=ue.window===ue?ue:(ce=ue.ownerDocument)?ce.defaultView||ce.parentWindow:window,_e?(Ee=d.relatedTarget||d.toElement,_e=ne,Ee=Ee?Pa(Ee):null,Ee!==null&&(zt=lr(Ee),Ee!==zt||Ee.tag!==5&&Ee.tag!==6)&&(Ee=null)):(_e=null,Ee=ne),_e!==Ee)){if(Se=ah,fe="onMouseLeave",Z="onMouseEnter",K="mouse",(a==="pointerout"||a==="pointerover")&&(Se=wi,fe="onPointerLeave",Z="onPointerEnter",K="pointer"),zt=_e==null?ce:hc(_e),ee=Ee==null?ce:hc(Ee),ce=new Se(fe,K+"leave",_e,d,ue),ce.target=zt,ce.relatedTarget=ee,fe=null,Pa(ue)===ne&&(Se=new Se(Z,K+"enter",Ee,d,ue),Se.target=ee,Se.relatedTarget=zt,fe=Se),zt=fe,_e&&Ee)t:{for(Se=_e,Z=Ee,K=0,ee=Se;ee;ee=cc(ee))K++;for(ee=0,fe=Z;fe;fe=cc(fe))ee++;for(;0<K-ee;)Se=cc(Se),K--;for(;0<ee-K;)Z=cc(Z),ee--;for(;K--;){if(Se===Z||Z!==null&&Se===Z.alternate)break t;Se=cc(Se),Z=cc(Z)}Se=null}else Se=null;_e!==null&&LE(de,ce,_e,Se,!1),Ee!==null&&zt!==null&&LE(de,zt,Ee,Se,!0)}}e:{if(ce=ne?hc(ne):window,_e=ce.nodeName&&ce.nodeName.toLowerCase(),_e==="select"||_e==="input"&&ce.type==="file")var be=bM;else if(gE(ce))if(mE)be=PM;else{be=RM;var Ne=CM}else(_e=ce.nodeName)&&_e.toLowerCase()==="input"&&(ce.type==="checkbox"||ce.type==="radio")&&(be=AM);if(be&&(be=be(a,ne))){pE(de,be,d,ue);break e}Ne&&Ne(a,ce,ne),a==="focusout"&&(Ne=ce._wrapperState)&&Ne.controlled&&ce.type==="number"&&_t(ce,"number",ce.value)}switch(Ne=ne?hc(ne):window,a){case"focusin":(gE(Ne)||Ne.contentEditable==="true")&&(ac=Ne,Z0=ne,fh=null);break;case"focusout":fh=Z0=ac=null;break;case"mousedown":Q0=!0;break;case"contextmenu":case"mouseup":case"dragend":Q0=!1,SE(de,d,ue);break;case"selectionchange":if(DM)break;case"keydown":case"keyup":SE(de,d,ue)}var De;if(K0)e:{switch(a){case"compositionstart":var Fe="onCompositionStart";break e;case"compositionend":Fe="onCompositionEnd";break e;case"compositionupdate":Fe="onCompositionUpdate";break e}Fe=void 0}else oc?dE(a,d)&&(Fe="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Fe="onCompositionStart");Fe&&(cE&&d.locale!=="ko"&&(oc||Fe!=="onCompositionStart"?Fe==="onCompositionEnd"&&oc&&(De=qf()):(xi=ue,ec="value"in xi?xi.value:xi.textContent,oc=!0)),Ne=ig(ne,Fe),0<Ne.length&&(Fe=new C(Fe,a,null,d,ue),de.push({event:Fe,listeners:Ne}),De?Fe.data=De:(De=fE(d),De!==null&&(Fe.data=De)))),(De=wM?EM(a,d):TM(a,d))&&(ne=ig(ne,"onBeforeInput"),0<ne.length&&(ue=new C("onBeforeInput","beforeinput",null,d,ue),de.push({event:ue,listeners:ne}),ue.data=De))}DE(de,c)})}function mh(a,c,d){return{instance:a,listener:c,currentTarget:d}}function ig(a,c){for(var d=c+"Capture",y=[];a!==null;){var x=a,w=x.stateNode;x.tag===5&&w!==null&&(x=w,w=yn(a,d),w!=null&&y.unshift(mh(a,w,x)),w=yn(a,c),w!=null&&y.push(mh(a,w,x))),a=a.return}return y}function cc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function LE(a,c,d,y,x){for(var w=c._reactName,D=[];d!==null&&d!==y;){var B=d,$=B.alternate,ne=B.stateNode;if($!==null&&$===y)break;B.tag===5&&ne!==null&&(B=ne,x?($=yn(d,w),$!=null&&D.unshift(mh(d,$,B))):x||($=yn(d,w),$!=null&&D.push(mh(d,$,B)))),d=d.return}D.length!==0&&a.push({event:c,listeners:D})}var jM=/\r\n?/g,FM=/\u0000|\uFFFD/g;function OE(a){return(typeof a=="string"?a:""+a).replace(jM,`
`).replace(FM,"")}function rg(a,c,d){if(c=OE(c),OE(a)!==c&&d)throw Error(t(425))}function sg(){}var ry=null,sy=null;function oy(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var ay=typeof setTimeout=="function"?setTimeout:void 0,VM=typeof clearTimeout=="function"?clearTimeout:void 0,jE=typeof Promise=="function"?Promise:void 0,zM=typeof queueMicrotask=="function"?queueMicrotask:typeof jE<"u"?function(a){return jE.resolve(null).then(a).catch(UM)}:ay;function UM(a){setTimeout(function(){throw a})}function ly(a,c){var d=c,y=0;do{var x=d.nextSibling;if(a.removeChild(d),x&&x.nodeType===8)if(d=x.data,d==="/$"){if(y===0){a.removeChild(x),go(c);return}y--}else d!=="$"&&d!=="$?"&&d!=="$!"||y++;d=x}while(d);go(c)}function _o(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function FE(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var uc=Math.random().toString(36).slice(2),Qr="__reactFiber$"+uc,yh="__reactProps$"+uc,Ps="__reactContainer$"+uc,cy="__reactEvents$"+uc,BM="__reactListeners$"+uc,WM="__reactHandles$"+uc;function Pa(a){var c=a[Qr];if(c)return c;for(var d=a.parentNode;d;){if(c=d[Ps]||d[Qr]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=FE(a);a!==null;){if(d=a[Qr])return d;a=FE(a)}return c}a=d,d=a.parentNode}return null}function _h(a){return a=a[Qr]||a[Ps],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function hc(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function og(a){return a[yh]||null}var uy=[],dc=-1;function xo(a){return{current:a}}function Et(a){0>dc||(a.current=uy[dc],uy[dc]=null,dc--)}function xt(a,c){dc++,uy[dc]=a.current,a.current=c}var vo={},Pn=xo(vo),Jn=xo(!1),ka=vo;function fc(a,c){var d=a.type.contextTypes;if(!d)return vo;var y=a.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===c)return y.__reactInternalMemoizedMaskedChildContext;var x={},w;for(w in d)x[w]=c[w];return y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=x),x}function ei(a){return a=a.childContextTypes,a!=null}function ag(){Et(Jn),Et(Pn)}function VE(a,c,d){if(Pn.current!==vo)throw Error(t(168));xt(Pn,c),xt(Jn,d)}function zE(a,c,d){var y=a.stateNode;if(c=c.childContextTypes,typeof y.getChildContext!="function")return d;y=y.getChildContext();for(var x in y)if(!(x in c))throw Error(t(108,Me(a)||"Unknown",x));return X({},d,y)}function lg(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||vo,ka=Pn.current,xt(Pn,a),xt(Jn,Jn.current),!0}function UE(a,c,d){var y=a.stateNode;if(!y)throw Error(t(169));d?(a=zE(a,c,ka),y.__reactInternalMemoizedMergedChildContext=a,Et(Jn),Et(Pn),xt(Pn,a)):Et(Jn),xt(Jn,d)}var ks=null,cg=!1,hy=!1;function BE(a){ks===null?ks=[a]:ks.push(a)}function GM(a){cg=!0,BE(a)}function wo(){if(!hy&&ks!==null){hy=!0;var a=0,c=Ye;try{var d=ks;for(Ye=1;a<d.length;a++){var y=d[a];do y=y(!0);while(y!==null)}ks=null,cg=!1}catch(x){throw ks!==null&&(ks=ks.slice(a+1)),qu(Kl,wo),x}finally{Ye=c,hy=!1}}return null}var gc=[],pc=0,ug=null,hg=0,Bi=[],Wi=0,Na=null,Ns=1,Ds="";function Da(a,c){gc[pc++]=hg,gc[pc++]=ug,ug=a,hg=c}function WE(a,c,d){Bi[Wi++]=Ns,Bi[Wi++]=Ds,Bi[Wi++]=Na,Na=a;var y=Ns;a=Ds;var x=32-yi(y)-1;y&=~(1<<x),d+=1;var w=32-yi(c)+x;if(30<w){var D=x-x%5;w=(y&(1<<D)-1).toString(32),y>>=D,x-=D,Ns=1<<32-yi(c)+x|d<<x|y,Ds=w+a}else Ns=1<<w|d<<x|y,Ds=a}function dy(a){a.return!==null&&(Da(a,1),WE(a,1,0))}function fy(a){for(;a===ug;)ug=gc[--pc],gc[pc]=null,hg=gc[--pc],gc[pc]=null;for(;a===Na;)Na=Bi[--Wi],Bi[Wi]=null,Ds=Bi[--Wi],Bi[Wi]=null,Ns=Bi[--Wi],Bi[Wi]=null}var Ei=null,Ti=null,Ct=!1,hr=null;function GE(a,c){var d=Ki(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function $E(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,Ei=a,Ti=_o(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,Ei=a,Ti=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Na!==null?{id:Ns,overflow:Ds}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=Ki(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,Ei=a,Ti=null,!0):!1;default:return!1}}function gy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function py(a){if(Ct){var c=Ti;if(c){var d=c;if(!$E(a,c)){if(gy(a))throw Error(t(418));c=_o(d.nextSibling);var y=Ei;c&&$E(a,c)?GE(y,d):(a.flags=a.flags&-4097|2,Ct=!1,Ei=a)}}else{if(gy(a))throw Error(t(418));a.flags=a.flags&-4097|2,Ct=!1,Ei=a}}}function HE(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Ei=a}function dg(a){if(a!==Ei)return!1;if(!Ct)return HE(a),Ct=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!oy(a.type,a.memoizedProps)),c&&(c=Ti)){if(gy(a))throw KE(),Error(t(418));for(;c;)GE(a,c),c=_o(c.nextSibling)}if(HE(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){Ti=_o(a.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}Ti=null}}else Ti=Ei?_o(a.stateNode.nextSibling):null;return!0}function KE(){for(var a=Ti;a;)a=_o(a.nextSibling)}function mc(){Ti=Ei=null,Ct=!1}function my(a){hr===null?hr=[a]:hr.push(a)}var $M=L.ReactCurrentBatchConfig;function xh(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var y=d.stateNode}if(!y)throw Error(t(147,a));var x=y,w=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===w?c.ref:(c=function(D){var B=x.refs;D===null?delete B[w]:B[w]=D},c._stringRef=w,c)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function fg(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function qE(a){var c=a._init;return c(a._payload)}function XE(a){function c(Z,K){if(a){var ee=Z.deletions;ee===null?(Z.deletions=[K],Z.flags|=16):ee.push(K)}}function d(Z,K){if(!a)return null;for(;K!==null;)c(Z,K),K=K.sibling;return null}function y(Z,K){for(Z=new Map;K!==null;)K.key!==null?Z.set(K.key,K):Z.set(K.index,K),K=K.sibling;return Z}function x(Z,K){return Z=Ao(Z,K),Z.index=0,Z.sibling=null,Z}function w(Z,K,ee){return Z.index=ee,a?(ee=Z.alternate,ee!==null?(ee=ee.index,ee<K?(Z.flags|=2,K):ee):(Z.flags|=2,K)):(Z.flags|=1048576,K)}function D(Z){return a&&Z.alternate===null&&(Z.flags|=2),Z}function B(Z,K,ee,fe){return K===null||K.tag!==6?(K=a_(ee,Z.mode,fe),K.return=Z,K):(K=x(K,ee),K.return=Z,K)}function $(Z,K,ee,fe){var be=ee.type;return be===P?ue(Z,K,ee.props.children,fe,ee.key):K!==null&&(K.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===J&&qE(be)===K.type)?(fe=x(K,ee.props),fe.ref=xh(Z,K,ee),fe.return=Z,fe):(fe=jg(ee.type,ee.key,ee.props,null,Z.mode,fe),fe.ref=xh(Z,K,ee),fe.return=Z,fe)}function ne(Z,K,ee,fe){return K===null||K.tag!==4||K.stateNode.containerInfo!==ee.containerInfo||K.stateNode.implementation!==ee.implementation?(K=l_(ee,Z.mode,fe),K.return=Z,K):(K=x(K,ee.children||[]),K.return=Z,K)}function ue(Z,K,ee,fe,be){return K===null||K.tag!==7?(K=Ua(ee,Z.mode,fe,be),K.return=Z,K):(K=x(K,ee),K.return=Z,K)}function de(Z,K,ee){if(typeof K=="string"&&K!==""||typeof K=="number")return K=a_(""+K,Z.mode,ee),K.return=Z,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case A:return ee=jg(K.type,K.key,K.props,null,Z.mode,ee),ee.ref=xh(Z,null,K),ee.return=Z,ee;case z:return K=l_(K,Z.mode,ee),K.return=Z,K;case J:var fe=K._init;return de(Z,fe(K._payload),ee)}if(ht(K)||H(K))return K=Ua(K,Z.mode,ee,null),K.return=Z,K;fg(Z,K)}return null}function ce(Z,K,ee,fe){var be=K!==null?K.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number")return be!==null?null:B(Z,K,""+ee,fe);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case A:return ee.key===be?$(Z,K,ee,fe):null;case z:return ee.key===be?ne(Z,K,ee,fe):null;case J:return be=ee._init,ce(Z,K,be(ee._payload),fe)}if(ht(ee)||H(ee))return be!==null?null:ue(Z,K,ee,fe,null);fg(Z,ee)}return null}function _e(Z,K,ee,fe,be){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return Z=Z.get(ee)||null,B(K,Z,""+fe,be);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case A:return Z=Z.get(fe.key===null?ee:fe.key)||null,$(K,Z,fe,be);case z:return Z=Z.get(fe.key===null?ee:fe.key)||null,ne(K,Z,fe,be);case J:var Ne=fe._init;return _e(Z,K,ee,Ne(fe._payload),be)}if(ht(fe)||H(fe))return Z=Z.get(ee)||null,ue(K,Z,fe,be,null);fg(K,fe)}return null}function Ee(Z,K,ee,fe){for(var be=null,Ne=null,De=K,Fe=K=0,ln=null;De!==null&&Fe<ee.length;Fe++){De.index>Fe?(ln=De,De=null):ln=De.sibling;var nt=ce(Z,De,ee[Fe],fe);if(nt===null){De===null&&(De=ln);break}a&&De&&nt.alternate===null&&c(Z,De),K=w(nt,K,Fe),Ne===null?be=nt:Ne.sibling=nt,Ne=nt,De=ln}if(Fe===ee.length)return d(Z,De),Ct&&Da(Z,Fe),be;if(De===null){for(;Fe<ee.length;Fe++)De=de(Z,ee[Fe],fe),De!==null&&(K=w(De,K,Fe),Ne===null?be=De:Ne.sibling=De,Ne=De);return Ct&&Da(Z,Fe),be}for(De=y(Z,De);Fe<ee.length;Fe++)ln=_e(De,Z,Fe,ee[Fe],fe),ln!==null&&(a&&ln.alternate!==null&&De.delete(ln.key===null?Fe:ln.key),K=w(ln,K,Fe),Ne===null?be=ln:Ne.sibling=ln,Ne=ln);return a&&De.forEach(function(Po){return c(Z,Po)}),Ct&&Da(Z,Fe),be}function Se(Z,K,ee,fe){var be=H(ee);if(typeof be!="function")throw Error(t(150));if(ee=be.call(ee),ee==null)throw Error(t(151));for(var Ne=be=null,De=K,Fe=K=0,ln=null,nt=ee.next();De!==null&&!nt.done;Fe++,nt=ee.next()){De.index>Fe?(ln=De,De=null):ln=De.sibling;var Po=ce(Z,De,nt.value,fe);if(Po===null){De===null&&(De=ln);break}a&&De&&Po.alternate===null&&c(Z,De),K=w(Po,K,Fe),Ne===null?be=Po:Ne.sibling=Po,Ne=Po,De=ln}if(nt.done)return d(Z,De),Ct&&Da(Z,Fe),be;if(De===null){for(;!nt.done;Fe++,nt=ee.next())nt=de(Z,nt.value,fe),nt!==null&&(K=w(nt,K,Fe),Ne===null?be=nt:Ne.sibling=nt,Ne=nt);return Ct&&Da(Z,Fe),be}for(De=y(Z,De);!nt.done;Fe++,nt=ee.next())nt=_e(De,Z,Fe,nt.value,fe),nt!==null&&(a&&nt.alternate!==null&&De.delete(nt.key===null?Fe:nt.key),K=w(nt,K,Fe),Ne===null?be=nt:Ne.sibling=nt,Ne=nt);return a&&De.forEach(function(SL){return c(Z,SL)}),Ct&&Da(Z,Fe),be}function zt(Z,K,ee,fe){if(typeof ee=="object"&&ee!==null&&ee.type===P&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case A:e:{for(var be=ee.key,Ne=K;Ne!==null;){if(Ne.key===be){if(be=ee.type,be===P){if(Ne.tag===7){d(Z,Ne.sibling),K=x(Ne,ee.props.children),K.return=Z,Z=K;break e}}else if(Ne.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===J&&qE(be)===Ne.type){d(Z,Ne.sibling),K=x(Ne,ee.props),K.ref=xh(Z,Ne,ee),K.return=Z,Z=K;break e}d(Z,Ne);break}else c(Z,Ne);Ne=Ne.sibling}ee.type===P?(K=Ua(ee.props.children,Z.mode,fe,ee.key),K.return=Z,Z=K):(fe=jg(ee.type,ee.key,ee.props,null,Z.mode,fe),fe.ref=xh(Z,K,ee),fe.return=Z,Z=fe)}return D(Z);case z:e:{for(Ne=ee.key;K!==null;){if(K.key===Ne)if(K.tag===4&&K.stateNode.containerInfo===ee.containerInfo&&K.stateNode.implementation===ee.implementation){d(Z,K.sibling),K=x(K,ee.children||[]),K.return=Z,Z=K;break e}else{d(Z,K);break}else c(Z,K);K=K.sibling}K=l_(ee,Z.mode,fe),K.return=Z,Z=K}return D(Z);case J:return Ne=ee._init,zt(Z,K,Ne(ee._payload),fe)}if(ht(ee))return Ee(Z,K,ee,fe);if(H(ee))return Se(Z,K,ee,fe);fg(Z,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"?(ee=""+ee,K!==null&&K.tag===6?(d(Z,K.sibling),K=x(K,ee),K.return=Z,Z=K):(d(Z,K),K=a_(ee,Z.mode,fe),K.return=Z,Z=K),D(Z)):d(Z,K)}return zt}var yc=XE(!0),YE=XE(!1),gg=xo(null),pg=null,_c=null,yy=null;function _y(){yy=_c=pg=null}function xy(a){var c=gg.current;Et(gg),a._currentValue=c}function vy(a,c,d){for(;a!==null;){var y=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),a===d)break;a=a.return}}function xc(a,c){pg=a,yy=_c=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(ti=!0),a.firstContext=null)}function Gi(a){var c=a._currentValue;if(yy!==a)if(a={context:a,memoizedValue:c,next:null},_c===null){if(pg===null)throw Error(t(308));_c=a,pg.dependencies={lanes:0,firstContext:a}}else _c=_c.next=a;return c}var Ma=null;function wy(a){Ma===null?Ma=[a]:Ma.push(a)}function ZE(a,c,d,y){var x=c.interleaved;return x===null?(d.next=d,wy(c)):(d.next=x.next,x.next=d),c.interleaved=d,Ms(a,y)}function Ms(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var Eo=!1;function Ey(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function QE(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Ls(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function To(a,c,d){var y=a.updateQueue;if(y===null)return null;if(y=y.shared,(tt&2)!==0){var x=y.pending;return x===null?c.next=c:(c.next=x.next,x.next=c),y.pending=c,Ms(a,d)}return x=y.interleaved,x===null?(c.next=c,wy(y)):(c.next=x.next,x.next=c),y.interleaved=c,Ms(a,d)}function mg(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var y=c.lanes;y&=a.pendingLanes,d|=y,c.lanes=d,eh(a,d)}}function JE(a,c){var d=a.updateQueue,y=a.alternate;if(y!==null&&(y=y.updateQueue,d===y)){var x=null,w=null;if(d=d.firstBaseUpdate,d!==null){do{var D={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};w===null?x=w=D:w=w.next=D,d=d.next}while(d!==null);w===null?x=w=c:w=w.next=c}else x=w=c;d={baseState:y.baseState,firstBaseUpdate:x,lastBaseUpdate:w,shared:y.shared,effects:y.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function yg(a,c,d,y){var x=a.updateQueue;Eo=!1;var w=x.firstBaseUpdate,D=x.lastBaseUpdate,B=x.shared.pending;if(B!==null){x.shared.pending=null;var $=B,ne=$.next;$.next=null,D===null?w=ne:D.next=ne,D=$;var ue=a.alternate;ue!==null&&(ue=ue.updateQueue,B=ue.lastBaseUpdate,B!==D&&(B===null?ue.firstBaseUpdate=ne:B.next=ne,ue.lastBaseUpdate=$))}if(w!==null){var de=x.baseState;D=0,ue=ne=$=null,B=w;do{var ce=B.lane,_e=B.eventTime;if((y&ce)===ce){ue!==null&&(ue=ue.next={eventTime:_e,lane:0,tag:B.tag,payload:B.payload,callback:B.callback,next:null});e:{var Ee=a,Se=B;switch(ce=c,_e=d,Se.tag){case 1:if(Ee=Se.payload,typeof Ee=="function"){de=Ee.call(_e,de,ce);break e}de=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=Se.payload,ce=typeof Ee=="function"?Ee.call(_e,de,ce):Ee,ce==null)break e;de=X({},de,ce);break e;case 2:Eo=!0}}B.callback!==null&&B.lane!==0&&(a.flags|=64,ce=x.effects,ce===null?x.effects=[B]:ce.push(B))}else _e={eventTime:_e,lane:ce,tag:B.tag,payload:B.payload,callback:B.callback,next:null},ue===null?(ne=ue=_e,$=de):ue=ue.next=_e,D|=ce;if(B=B.next,B===null){if(B=x.shared.pending,B===null)break;ce=B,B=ce.next,ce.next=null,x.lastBaseUpdate=ce,x.shared.pending=null}}while(!0);if(ue===null&&($=de),x.baseState=$,x.firstBaseUpdate=ne,x.lastBaseUpdate=ue,c=x.shared.interleaved,c!==null){x=c;do D|=x.lane,x=x.next;while(x!==c)}else w===null&&(x.shared.lanes=0);ja|=D,a.lanes=D,a.memoizedState=de}}function eT(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var y=a[c],x=y.callback;if(x!==null){if(y.callback=null,y=d,typeof x!="function")throw Error(t(191,x));x.call(y)}}}var vh={},Jr=xo(vh),wh=xo(vh),Eh=xo(vh);function La(a){if(a===vh)throw Error(t(174));return a}function Ty(a,c){switch(xt(Eh,c),xt(wh,a),xt(Jr,vh),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:or(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=or(c,a)}Et(Jr),xt(Jr,c)}function vc(){Et(Jr),Et(wh),Et(Eh)}function tT(a){La(Eh.current);var c=La(Jr.current),d=or(c,a.type);c!==d&&(xt(wh,a),xt(Jr,d))}function Sy(a){wh.current===a&&(Et(Jr),Et(wh))}var Pt=xo(0);function _g(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Iy=[];function by(){for(var a=0;a<Iy.length;a++)Iy[a]._workInProgressVersionPrimary=null;Iy.length=0}var xg=L.ReactCurrentDispatcher,Cy=L.ReactCurrentBatchConfig,Oa=0,kt=null,Zt=null,on=null,vg=!1,Th=!1,Sh=0,HM=0;function kn(){throw Error(t(321))}function Ry(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!ur(a[d],c[d]))return!1;return!0}function Ay(a,c,d,y,x,w){if(Oa=w,kt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,xg.current=a===null||a.memoizedState===null?YM:ZM,a=d(y,x),Th){w=0;do{if(Th=!1,Sh=0,25<=w)throw Error(t(301));w+=1,on=Zt=null,c.updateQueue=null,xg.current=QM,a=d(y,x)}while(Th)}if(xg.current=Tg,c=Zt!==null&&Zt.next!==null,Oa=0,on=Zt=kt=null,vg=!1,c)throw Error(t(300));return a}function Py(){var a=Sh!==0;return Sh=0,a}function es(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?kt.memoizedState=on=a:on=on.next=a,on}function $i(){if(Zt===null){var a=kt.alternate;a=a!==null?a.memoizedState:null}else a=Zt.next;var c=on===null?kt.memoizedState:on.next;if(c!==null)on=c,Zt=a;else{if(a===null)throw Error(t(310));Zt=a,a={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},on===null?kt.memoizedState=on=a:on=on.next=a}return on}function Ih(a,c){return typeof c=="function"?c(a):c}function ky(a){var c=$i(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var y=Zt,x=y.baseQueue,w=d.pending;if(w!==null){if(x!==null){var D=x.next;x.next=w.next,w.next=D}y.baseQueue=x=w,d.pending=null}if(x!==null){w=x.next,y=y.baseState;var B=D=null,$=null,ne=w;do{var ue=ne.lane;if((Oa&ue)===ue)$!==null&&($=$.next={lane:0,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),y=ne.hasEagerState?ne.eagerState:a(y,ne.action);else{var de={lane:ue,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null};$===null?(B=$=de,D=y):$=$.next=de,kt.lanes|=ue,ja|=ue}ne=ne.next}while(ne!==null&&ne!==w);$===null?D=y:$.next=B,ur(y,c.memoizedState)||(ti=!0),c.memoizedState=y,c.baseState=D,c.baseQueue=$,d.lastRenderedState=y}if(a=d.interleaved,a!==null){x=a;do w=x.lane,kt.lanes|=w,ja|=w,x=x.next;while(x!==a)}else x===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function Ny(a){var c=$i(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var y=d.dispatch,x=d.pending,w=c.memoizedState;if(x!==null){d.pending=null;var D=x=x.next;do w=a(w,D.action),D=D.next;while(D!==x);ur(w,c.memoizedState)||(ti=!0),c.memoizedState=w,c.baseQueue===null&&(c.baseState=w),d.lastRenderedState=w}return[w,y]}function nT(){}function iT(a,c){var d=kt,y=$i(),x=c(),w=!ur(y.memoizedState,x);if(w&&(y.memoizedState=x,ti=!0),y=y.queue,Dy(oT.bind(null,d,y,a),[a]),y.getSnapshot!==c||w||on!==null&&on.memoizedState.tag&1){if(d.flags|=2048,bh(9,sT.bind(null,d,y,x,c),void 0,null),an===null)throw Error(t(349));(Oa&30)!==0||rT(d,c,x)}return x}function rT(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=kt.updateQueue,c===null?(c={lastEffect:null,stores:null},kt.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function sT(a,c,d,y){c.value=d,c.getSnapshot=y,aT(c)&&lT(a)}function oT(a,c,d){return d(function(){aT(c)&&lT(a)})}function aT(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!ur(a,d)}catch{return!0}}function lT(a){var c=Ms(a,1);c!==null&&pr(c,a,1,-1)}function cT(a){var c=es();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ih,lastRenderedState:a},c.queue=a,a=a.dispatch=XM.bind(null,kt,a),[c.memoizedState,a]}function bh(a,c,d,y){return a={tag:a,create:c,destroy:d,deps:y,next:null},c=kt.updateQueue,c===null?(c={lastEffect:null,stores:null},kt.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(y=d.next,d.next=a,a.next=y,c.lastEffect=a)),a}function uT(){return $i().memoizedState}function wg(a,c,d,y){var x=es();kt.flags|=a,x.memoizedState=bh(1|c,d,void 0,y===void 0?null:y)}function Eg(a,c,d,y){var x=$i();y=y===void 0?null:y;var w=void 0;if(Zt!==null){var D=Zt.memoizedState;if(w=D.destroy,y!==null&&Ry(y,D.deps)){x.memoizedState=bh(c,d,w,y);return}}kt.flags|=a,x.memoizedState=bh(1|c,d,w,y)}function hT(a,c){return wg(8390656,8,a,c)}function Dy(a,c){return Eg(2048,8,a,c)}function dT(a,c){return Eg(4,2,a,c)}function fT(a,c){return Eg(4,4,a,c)}function gT(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function pT(a,c,d){return d=d!=null?d.concat([a]):null,Eg(4,4,gT.bind(null,c,a),d)}function My(){}function mT(a,c){var d=$i();c=c===void 0?null:c;var y=d.memoizedState;return y!==null&&c!==null&&Ry(c,y[1])?y[0]:(d.memoizedState=[a,c],a)}function yT(a,c){var d=$i();c=c===void 0?null:c;var y=d.memoizedState;return y!==null&&c!==null&&Ry(c,y[1])?y[0]:(a=a(),d.memoizedState=[a,c],a)}function _T(a,c,d){return(Oa&21)===0?(a.baseState&&(a.baseState=!1,ti=!0),a.memoizedState=d):(ur(d,c)||(d=Qu(),kt.lanes|=d,ja|=d,a.baseState=!0),c)}function KM(a,c){var d=Ye;Ye=d!==0&&4>d?d:4,a(!0);var y=Cy.transition;Cy.transition={};try{a(!1),c()}finally{Ye=d,Cy.transition=y}}function xT(){return $i().memoizedState}function qM(a,c,d){var y=Co(a);if(d={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null},vT(a))wT(c,d);else if(d=ZE(a,c,d,y),d!==null){var x=$n();pr(d,a,y,x),ET(d,c,y)}}function XM(a,c,d){var y=Co(a),x={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null};if(vT(a))wT(c,x);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=c.lastRenderedReducer,w!==null))try{var D=c.lastRenderedState,B=w(D,d);if(x.hasEagerState=!0,x.eagerState=B,ur(B,D)){var $=c.interleaved;$===null?(x.next=x,wy(c)):(x.next=$.next,$.next=x),c.interleaved=x;return}}catch{}d=ZE(a,c,x,y),d!==null&&(x=$n(),pr(d,a,y,x),ET(d,c,y))}}function vT(a){var c=a.alternate;return a===kt||c!==null&&c===kt}function wT(a,c){Th=vg=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function ET(a,c,d){if((d&4194240)!==0){var y=c.lanes;y&=a.pendingLanes,d|=y,c.lanes=d,eh(a,d)}}var Tg={readContext:Gi,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useInsertionEffect:kn,useLayoutEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useMutableSource:kn,useSyncExternalStore:kn,useId:kn,unstable_isNewReconciler:!1},YM={readContext:Gi,useCallback:function(a,c){return es().memoizedState=[a,c===void 0?null:c],a},useContext:Gi,useEffect:hT,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,wg(4194308,4,gT.bind(null,c,a),d)},useLayoutEffect:function(a,c){return wg(4194308,4,a,c)},useInsertionEffect:function(a,c){return wg(4,2,a,c)},useMemo:function(a,c){var d=es();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var y=es();return c=d!==void 0?d(c):c,y.memoizedState=y.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},y.queue=a,a=a.dispatch=qM.bind(null,kt,a),[y.memoizedState,a]},useRef:function(a){var c=es();return a={current:a},c.memoizedState=a},useState:cT,useDebugValue:My,useDeferredValue:function(a){return es().memoizedState=a},useTransition:function(){var a=cT(!1),c=a[0];return a=KM.bind(null,a[1]),es().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var y=kt,x=es();if(Ct){if(d===void 0)throw Error(t(407));d=d()}else{if(d=c(),an===null)throw Error(t(349));(Oa&30)!==0||rT(y,c,d)}x.memoizedState=d;var w={value:d,getSnapshot:c};return x.queue=w,hT(oT.bind(null,y,w,a),[a]),y.flags|=2048,bh(9,sT.bind(null,y,w,d,c),void 0,null),d},useId:function(){var a=es(),c=an.identifierPrefix;if(Ct){var d=Ds,y=Ns;d=(y&~(1<<32-yi(y)-1)).toString(32)+d,c=":"+c+"R"+d,d=Sh++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=HM++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},ZM={readContext:Gi,useCallback:mT,useContext:Gi,useEffect:Dy,useImperativeHandle:pT,useInsertionEffect:dT,useLayoutEffect:fT,useMemo:yT,useReducer:ky,useRef:uT,useState:function(){return ky(Ih)},useDebugValue:My,useDeferredValue:function(a){var c=$i();return _T(c,Zt.memoizedState,a)},useTransition:function(){var a=ky(Ih)[0],c=$i().memoizedState;return[a,c]},useMutableSource:nT,useSyncExternalStore:iT,useId:xT,unstable_isNewReconciler:!1},QM={readContext:Gi,useCallback:mT,useContext:Gi,useEffect:Dy,useImperativeHandle:pT,useInsertionEffect:dT,useLayoutEffect:fT,useMemo:yT,useReducer:Ny,useRef:uT,useState:function(){return Ny(Ih)},useDebugValue:My,useDeferredValue:function(a){var c=$i();return Zt===null?c.memoizedState=a:_T(c,Zt.memoizedState,a)},useTransition:function(){var a=Ny(Ih)[0],c=$i().memoizedState;return[a,c]},useMutableSource:nT,useSyncExternalStore:iT,useId:xT,unstable_isNewReconciler:!1};function dr(a,c){if(a&&a.defaultProps){c=X({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function Ly(a,c,d,y){c=a.memoizedState,d=d(y,c),d=d==null?c:X({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var Sg={isMounted:function(a){return(a=a._reactInternals)?lr(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var y=$n(),x=Co(a),w=Ls(y,x);w.payload=c,d!=null&&(w.callback=d),c=To(a,w,x),c!==null&&(pr(c,a,x,y),mg(c,a,x))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var y=$n(),x=Co(a),w=Ls(y,x);w.tag=1,w.payload=c,d!=null&&(w.callback=d),c=To(a,w,x),c!==null&&(pr(c,a,x,y),mg(c,a,x))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=$n(),y=Co(a),x=Ls(d,y);x.tag=2,c!=null&&(x.callback=c),c=To(a,x,y),c!==null&&(pr(c,a,y,d),mg(c,a,y))}};function TT(a,c,d,y,x,w,D){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(y,w,D):c.prototype&&c.prototype.isPureReactComponent?!dh(d,y)||!dh(x,w):!0}function ST(a,c,d){var y=!1,x=vo,w=c.contextType;return typeof w=="object"&&w!==null?w=Gi(w):(x=ei(c)?ka:Pn.current,y=c.contextTypes,w=(y=y!=null)?fc(a,x):vo),c=new c(d,w),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Sg,a.stateNode=c,c._reactInternals=a,y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=x,a.__reactInternalMemoizedMaskedChildContext=w),c}function IT(a,c,d,y){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,y),c.state!==a&&Sg.enqueueReplaceState(c,c.state,null)}function Oy(a,c,d,y){var x=a.stateNode;x.props=d,x.state=a.memoizedState,x.refs={},Ey(a);var w=c.contextType;typeof w=="object"&&w!==null?x.context=Gi(w):(w=ei(c)?ka:Pn.current,x.context=fc(a,w)),x.state=a.memoizedState,w=c.getDerivedStateFromProps,typeof w=="function"&&(Ly(a,c,w,d),x.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(c=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),c!==x.state&&Sg.enqueueReplaceState(x,x.state,null),yg(a,d,x,y),x.state=a.memoizedState),typeof x.componentDidMount=="function"&&(a.flags|=4194308)}function wc(a,c){try{var d="",y=c;do d+=xe(y),y=y.return;while(y);var x=d}catch(w){x=`
Error generating stack: `+w.message+`
`+w.stack}return{value:a,source:c,stack:x,digest:null}}function jy(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function Fy(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var JM=typeof WeakMap=="function"?WeakMap:Map;function bT(a,c,d){d=Ls(-1,d),d.tag=3,d.payload={element:null};var y=c.value;return d.callback=function(){kg||(kg=!0,Jy=y),Fy(a,c)},d}function CT(a,c,d){d=Ls(-1,d),d.tag=3;var y=a.type.getDerivedStateFromError;if(typeof y=="function"){var x=c.value;d.payload=function(){return y(x)},d.callback=function(){Fy(a,c)}}var w=a.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(d.callback=function(){Fy(a,c),typeof y!="function"&&(Io===null?Io=new Set([this]):Io.add(this));var D=c.stack;this.componentDidCatch(c.value,{componentStack:D!==null?D:""})}),d}function RT(a,c,d){var y=a.pingCache;if(y===null){y=a.pingCache=new JM;var x=new Set;y.set(c,x)}else x=y.get(c),x===void 0&&(x=new Set,y.set(c,x));x.has(d)||(x.add(d),a=fL.bind(null,a,c,d),c.then(a,a))}function AT(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function PT(a,c,d,y,x){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=Ls(-1,1),c.tag=2,To(d,c,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=x,a)}var eL=L.ReactCurrentOwner,ti=!1;function Gn(a,c,d,y){c.child=a===null?YE(c,null,d,y):yc(c,a.child,d,y)}function kT(a,c,d,y,x){d=d.render;var w=c.ref;return xc(c,x),y=Ay(a,c,d,y,w,x),d=Py(),a!==null&&!ti?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~x,Os(a,c,x)):(Ct&&d&&dy(c),c.flags|=1,Gn(a,c,y,x),c.child)}function NT(a,c,d,y,x){if(a===null){var w=d.type;return typeof w=="function"&&!o_(w)&&w.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=w,DT(a,c,w,y,x)):(a=jg(d.type,null,y,c,c.mode,x),a.ref=c.ref,a.return=c,c.child=a)}if(w=a.child,(a.lanes&x)===0){var D=w.memoizedProps;if(d=d.compare,d=d!==null?d:dh,d(D,y)&&a.ref===c.ref)return Os(a,c,x)}return c.flags|=1,a=Ao(w,y),a.ref=c.ref,a.return=c,c.child=a}function DT(a,c,d,y,x){if(a!==null){var w=a.memoizedProps;if(dh(w,y)&&a.ref===c.ref)if(ti=!1,c.pendingProps=y=w,(a.lanes&x)!==0)(a.flags&131072)!==0&&(ti=!0);else return c.lanes=a.lanes,Os(a,c,x)}return Vy(a,c,d,y,x)}function MT(a,c,d){var y=c.pendingProps,x=y.children,w=a!==null?a.memoizedState:null;if(y.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},xt(Tc,Si),Si|=d;else{if((d&1073741824)===0)return a=w!==null?w.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,xt(Tc,Si),Si|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=w!==null?w.baseLanes:d,xt(Tc,Si),Si|=y}else w!==null?(y=w.baseLanes|d,c.memoizedState=null):y=d,xt(Tc,Si),Si|=y;return Gn(a,c,x,d),c.child}function LT(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function Vy(a,c,d,y,x){var w=ei(d)?ka:Pn.current;return w=fc(c,w),xc(c,x),d=Ay(a,c,d,y,w,x),y=Py(),a!==null&&!ti?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~x,Os(a,c,x)):(Ct&&y&&dy(c),c.flags|=1,Gn(a,c,d,x),c.child)}function OT(a,c,d,y,x){if(ei(d)){var w=!0;lg(c)}else w=!1;if(xc(c,x),c.stateNode===null)bg(a,c),ST(c,d,y),Oy(c,d,y,x),y=!0;else if(a===null){var D=c.stateNode,B=c.memoizedProps;D.props=B;var $=D.context,ne=d.contextType;typeof ne=="object"&&ne!==null?ne=Gi(ne):(ne=ei(d)?ka:Pn.current,ne=fc(c,ne));var ue=d.getDerivedStateFromProps,de=typeof ue=="function"||typeof D.getSnapshotBeforeUpdate=="function";de||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(B!==y||$!==ne)&&IT(c,D,y,ne),Eo=!1;var ce=c.memoizedState;D.state=ce,yg(c,y,D,x),$=c.memoizedState,B!==y||ce!==$||Jn.current||Eo?(typeof ue=="function"&&(Ly(c,d,ue,y),$=c.memoizedState),(B=Eo||TT(c,d,B,y,ce,$,ne))?(de||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(c.flags|=4194308)):(typeof D.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=$),D.props=y,D.state=$,D.context=ne,y=B):(typeof D.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{D=c.stateNode,QE(a,c),B=c.memoizedProps,ne=c.type===c.elementType?B:dr(c.type,B),D.props=ne,de=c.pendingProps,ce=D.context,$=d.contextType,typeof $=="object"&&$!==null?$=Gi($):($=ei(d)?ka:Pn.current,$=fc(c,$));var _e=d.getDerivedStateFromProps;(ue=typeof _e=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(B!==de||ce!==$)&&IT(c,D,y,$),Eo=!1,ce=c.memoizedState,D.state=ce,yg(c,y,D,x);var Ee=c.memoizedState;B!==de||ce!==Ee||Jn.current||Eo?(typeof _e=="function"&&(Ly(c,d,_e,y),Ee=c.memoizedState),(ne=Eo||TT(c,d,ne,y,ce,Ee,$)||!1)?(ue||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(y,Ee,$),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(y,Ee,$)),typeof D.componentDidUpdate=="function"&&(c.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof D.componentDidUpdate!="function"||B===a.memoizedProps&&ce===a.memoizedState||(c.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||B===a.memoizedProps&&ce===a.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=Ee),D.props=y,D.state=Ee,D.context=$,y=ne):(typeof D.componentDidUpdate!="function"||B===a.memoizedProps&&ce===a.memoizedState||(c.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||B===a.memoizedProps&&ce===a.memoizedState||(c.flags|=1024),y=!1)}return zy(a,c,d,y,w,x)}function zy(a,c,d,y,x,w){LT(a,c);var D=(c.flags&128)!==0;if(!y&&!D)return x&&UE(c,d,!1),Os(a,c,w);y=c.stateNode,eL.current=c;var B=D&&typeof d.getDerivedStateFromError!="function"?null:y.render();return c.flags|=1,a!==null&&D?(c.child=yc(c,a.child,null,w),c.child=yc(c,null,B,w)):Gn(a,c,B,w),c.memoizedState=y.state,x&&UE(c,d,!0),c.child}function jT(a){var c=a.stateNode;c.pendingContext?VE(a,c.pendingContext,c.pendingContext!==c.context):c.context&&VE(a,c.context,!1),Ty(a,c.containerInfo)}function FT(a,c,d,y,x){return mc(),my(x),c.flags|=256,Gn(a,c,d,y),c.child}var Uy={dehydrated:null,treeContext:null,retryLane:0};function By(a){return{baseLanes:a,cachePool:null,transitions:null}}function VT(a,c,d){var y=c.pendingProps,x=Pt.current,w=!1,D=(c.flags&128)!==0,B;if((B=D)||(B=a!==null&&a.memoizedState===null?!1:(x&2)!==0),B?(w=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(x|=1),xt(Pt,x&1),a===null)return py(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(D=y.children,a=y.fallback,w?(y=c.mode,w=c.child,D={mode:"hidden",children:D},(y&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=D):w=Fg(D,y,0,null),a=Ua(a,y,d,null),w.return=c,a.return=c,w.sibling=a,c.child=w,c.child.memoizedState=By(d),c.memoizedState=Uy,a):Wy(c,D));if(x=a.memoizedState,x!==null&&(B=x.dehydrated,B!==null))return tL(a,c,D,y,B,x,d);if(w){w=y.fallback,D=c.mode,x=a.child,B=x.sibling;var $={mode:"hidden",children:y.children};return(D&1)===0&&c.child!==x?(y=c.child,y.childLanes=0,y.pendingProps=$,c.deletions=null):(y=Ao(x,$),y.subtreeFlags=x.subtreeFlags&14680064),B!==null?w=Ao(B,w):(w=Ua(w,D,d,null),w.flags|=2),w.return=c,y.return=c,y.sibling=w,c.child=y,y=w,w=c.child,D=a.child.memoizedState,D=D===null?By(d):{baseLanes:D.baseLanes|d,cachePool:null,transitions:D.transitions},w.memoizedState=D,w.childLanes=a.childLanes&~d,c.memoizedState=Uy,y}return w=a.child,a=w.sibling,y=Ao(w,{mode:"visible",children:y.children}),(c.mode&1)===0&&(y.lanes=d),y.return=c,y.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=y,c.memoizedState=null,y}function Wy(a,c){return c=Fg({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function Ig(a,c,d,y){return y!==null&&my(y),yc(c,a.child,null,d),a=Wy(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function tL(a,c,d,y,x,w,D){if(d)return c.flags&256?(c.flags&=-257,y=jy(Error(t(422))),Ig(a,c,D,y)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(w=y.fallback,x=c.mode,y=Fg({mode:"visible",children:y.children},x,0,null),w=Ua(w,x,D,null),w.flags|=2,y.return=c,w.return=c,y.sibling=w,c.child=y,(c.mode&1)!==0&&yc(c,a.child,null,D),c.child.memoizedState=By(D),c.memoizedState=Uy,w);if((c.mode&1)===0)return Ig(a,c,D,null);if(x.data==="$!"){if(y=x.nextSibling&&x.nextSibling.dataset,y)var B=y.dgst;return y=B,w=Error(t(419)),y=jy(w,y,void 0),Ig(a,c,D,y)}if(B=(D&a.childLanes)!==0,ti||B){if(y=an,y!==null){switch(D&-D){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=(x&(y.suspendedLanes|D))!==0?0:x,x!==0&&x!==w.retryLane&&(w.retryLane=x,Ms(a,x),pr(y,a,x,-1))}return s_(),y=jy(Error(t(421))),Ig(a,c,D,y)}return x.data==="$?"?(c.flags|=128,c.child=a.child,c=gL.bind(null,a),x._reactRetry=c,null):(a=w.treeContext,Ti=_o(x.nextSibling),Ei=c,Ct=!0,hr=null,a!==null&&(Bi[Wi++]=Ns,Bi[Wi++]=Ds,Bi[Wi++]=Na,Ns=a.id,Ds=a.overflow,Na=c),c=Wy(c,y.children),c.flags|=4096,c)}function zT(a,c,d){a.lanes|=c;var y=a.alternate;y!==null&&(y.lanes|=c),vy(a.return,c,d)}function Gy(a,c,d,y,x){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:d,tailMode:x}:(w.isBackwards=c,w.rendering=null,w.renderingStartTime=0,w.last=y,w.tail=d,w.tailMode=x)}function UT(a,c,d){var y=c.pendingProps,x=y.revealOrder,w=y.tail;if(Gn(a,c,y.children,d),y=Pt.current,(y&2)!==0)y=y&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&zT(a,d,c);else if(a.tag===19)zT(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}y&=1}if(xt(Pt,y),(c.mode&1)===0)c.memoizedState=null;else switch(x){case"forwards":for(d=c.child,x=null;d!==null;)a=d.alternate,a!==null&&_g(a)===null&&(x=d),d=d.sibling;d=x,d===null?(x=c.child,c.child=null):(x=d.sibling,d.sibling=null),Gy(c,!1,x,d,w);break;case"backwards":for(d=null,x=c.child,c.child=null;x!==null;){if(a=x.alternate,a!==null&&_g(a)===null){c.child=x;break}a=x.sibling,x.sibling=d,d=x,x=a}Gy(c,!0,d,null,w);break;case"together":Gy(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function bg(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function Os(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),ja|=c.lanes,(d&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,d=Ao(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=Ao(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function nL(a,c,d){switch(c.tag){case 3:jT(c),mc();break;case 5:tT(c);break;case 1:ei(c.type)&&lg(c);break;case 4:Ty(c,c.stateNode.containerInfo);break;case 10:var y=c.type._context,x=c.memoizedProps.value;xt(gg,y._currentValue),y._currentValue=x;break;case 13:if(y=c.memoizedState,y!==null)return y.dehydrated!==null?(xt(Pt,Pt.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?VT(a,c,d):(xt(Pt,Pt.current&1),a=Os(a,c,d),a!==null?a.sibling:null);xt(Pt,Pt.current&1);break;case 19:if(y=(d&c.childLanes)!==0,(a.flags&128)!==0){if(y)return UT(a,c,d);c.flags|=128}if(x=c.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),xt(Pt,Pt.current),y)break;return null;case 22:case 23:return c.lanes=0,MT(a,c,d)}return Os(a,c,d)}var BT,$y,WT,GT;BT=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},$y=function(){},WT=function(a,c,d,y){var x=a.memoizedProps;if(x!==y){a=c.stateNode,La(Jr.current);var w=null;switch(d){case"input":x=Zn(a,x),y=Zn(a,y),w=[];break;case"select":x=X({},x,{value:void 0}),y=X({},y,{value:void 0}),w=[];break;case"textarea":x=Li(a,x),y=Li(a,y),w=[];break;default:typeof x.onClick!="function"&&typeof y.onClick=="function"&&(a.onclick=sg)}Un(d,y);var D;d=null;for(ne in x)if(!y.hasOwnProperty(ne)&&x.hasOwnProperty(ne)&&x[ne]!=null)if(ne==="style"){var B=x[ne];for(D in B)B.hasOwnProperty(D)&&(d||(d={}),d[D]="")}else ne!=="dangerouslySetInnerHTML"&&ne!=="children"&&ne!=="suppressContentEditableWarning"&&ne!=="suppressHydrationWarning"&&ne!=="autoFocus"&&(r.hasOwnProperty(ne)?w||(w=[]):(w=w||[]).push(ne,null));for(ne in y){var $=y[ne];if(B=x?.[ne],y.hasOwnProperty(ne)&&$!==B&&($!=null||B!=null))if(ne==="style")if(B){for(D in B)!B.hasOwnProperty(D)||$&&$.hasOwnProperty(D)||(d||(d={}),d[D]="");for(D in $)$.hasOwnProperty(D)&&B[D]!==$[D]&&(d||(d={}),d[D]=$[D])}else d||(w||(w=[]),w.push(ne,d)),d=$;else ne==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,B=B?B.__html:void 0,$!=null&&B!==$&&(w=w||[]).push(ne,$)):ne==="children"?typeof $!="string"&&typeof $!="number"||(w=w||[]).push(ne,""+$):ne!=="suppressContentEditableWarning"&&ne!=="suppressHydrationWarning"&&(r.hasOwnProperty(ne)?($!=null&&ne==="onScroll"&&wt("scroll",a),w||B===$||(w=[])):(w=w||[]).push(ne,$))}d&&(w=w||[]).push("style",d);var ne=w;(c.updateQueue=ne)&&(c.flags|=4)}},GT=function(a,c,d,y){d!==y&&(c.flags|=4)};function Ch(a,c){if(!Ct)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var y=null;d!==null;)d.alternate!==null&&(y=d),d=d.sibling;y===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:y.sibling=null}}function Nn(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,y=0;if(c)for(var x=a.child;x!==null;)d|=x.lanes|x.childLanes,y|=x.subtreeFlags&14680064,y|=x.flags&14680064,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)d|=x.lanes|x.childLanes,y|=x.subtreeFlags,y|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=y,a.childLanes=d,c}function iL(a,c,d){var y=c.pendingProps;switch(fy(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nn(c),null;case 1:return ei(c.type)&&ag(),Nn(c),null;case 3:return y=c.stateNode,vc(),Et(Jn),Et(Pn),by(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(a===null||a.child===null)&&(dg(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,hr!==null&&(n_(hr),hr=null))),$y(a,c),Nn(c),null;case 5:Sy(c);var x=La(Eh.current);if(d=c.type,a!==null&&c.stateNode!=null)WT(a,c,d,y,x),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!y){if(c.stateNode===null)throw Error(t(166));return Nn(c),null}if(a=La(Jr.current),dg(c)){y=c.stateNode,d=c.type;var w=c.memoizedProps;switch(y[Qr]=c,y[yh]=w,a=(c.mode&1)!==0,d){case"dialog":wt("cancel",y),wt("close",y);break;case"iframe":case"object":case"embed":wt("load",y);break;case"video":case"audio":for(x=0;x<gh.length;x++)wt(gh[x],y);break;case"source":wt("error",y);break;case"img":case"image":case"link":wt("error",y),wt("load",y);break;case"details":wt("toggle",y);break;case"input":fn(y,w),wt("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!w.multiple},wt("invalid",y);break;case"textarea":bt(y,w),wt("invalid",y)}Un(d,w),x=null;for(var D in w)if(w.hasOwnProperty(D)){var B=w[D];D==="children"?typeof B=="string"?y.textContent!==B&&(w.suppressHydrationWarning!==!0&&rg(y.textContent,B,a),x=["children",B]):typeof B=="number"&&y.textContent!==""+B&&(w.suppressHydrationWarning!==!0&&rg(y.textContent,B,a),x=["children",""+B]):r.hasOwnProperty(D)&&B!=null&&D==="onScroll"&&wt("scroll",y)}switch(d){case"input":Wt(y),Mi(y,w,!0);break;case"textarea":Wt(y),Oi(y);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(y.onclick=sg)}y=x,c.updateQueue=y,y!==null&&(c.flags|=4)}else{D=x.nodeType===9?x:x.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Mr(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=D.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof y.is=="string"?a=D.createElement(d,{is:y.is}):(a=D.createElement(d),d==="select"&&(D=a,y.multiple?D.multiple=!0:y.size&&(D.size=y.size))):a=D.createElementNS(a,d),a[Qr]=c,a[yh]=y,BT(a,c,!1,!1),c.stateNode=a;e:{switch(D=Es(d,y),d){case"dialog":wt("cancel",a),wt("close",a),x=y;break;case"iframe":case"object":case"embed":wt("load",a),x=y;break;case"video":case"audio":for(x=0;x<gh.length;x++)wt(gh[x],a);x=y;break;case"source":wt("error",a),x=y;break;case"img":case"image":case"link":wt("error",a),wt("load",a),x=y;break;case"details":wt("toggle",a),x=y;break;case"input":fn(a,y),x=Zn(a,y),wt("invalid",a);break;case"option":x=y;break;case"select":a._wrapperState={wasMultiple:!!y.multiple},x=X({},y,{value:void 0}),wt("invalid",a);break;case"textarea":bt(a,y),x=Li(a,y),wt("invalid",a);break;default:x=y}Un(d,x),B=x;for(w in B)if(B.hasOwnProperty(w)){var $=B[w];w==="style"?ws(a,$):w==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&ya(a,$)):w==="children"?typeof $=="string"?(d!=="textarea"||$!=="")&&Or(a,$):typeof $=="number"&&Or(a,""+$):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(r.hasOwnProperty(w)?$!=null&&w==="onScroll"&&wt("scroll",a):$!=null&&N(a,w,$,D))}switch(d){case"input":Wt(a),Mi(a,y,!1);break;case"textarea":Wt(a),Oi(a);break;case"option":y.value!=null&&a.setAttribute("value",""+le(y.value));break;case"select":a.multiple=!!y.multiple,w=y.value,w!=null?rn(a,!!y.multiple,w,!1):y.defaultValue!=null&&rn(a,!!y.multiple,y.defaultValue,!0);break;default:typeof x.onClick=="function"&&(a.onclick=sg)}switch(d){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Nn(c),null;case 6:if(a&&c.stateNode!=null)GT(a,c,a.memoizedProps,y);else{if(typeof y!="string"&&c.stateNode===null)throw Error(t(166));if(d=La(Eh.current),La(Jr.current),dg(c)){if(y=c.stateNode,d=c.memoizedProps,y[Qr]=c,(w=y.nodeValue!==d)&&(a=Ei,a!==null))switch(a.tag){case 3:rg(y.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&rg(y.nodeValue,d,(a.mode&1)!==0)}w&&(c.flags|=4)}else y=(d.nodeType===9?d:d.ownerDocument).createTextNode(y),y[Qr]=c,c.stateNode=y}return Nn(c),null;case 13:if(Et(Pt),y=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Ct&&Ti!==null&&(c.mode&1)!==0&&(c.flags&128)===0)KE(),mc(),c.flags|=98560,w=!1;else if(w=dg(c),y!==null&&y.dehydrated!==null){if(a===null){if(!w)throw Error(t(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[Qr]=c}else mc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Nn(c),w=!1}else hr!==null&&(n_(hr),hr=null),w=!0;if(!w)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(y=y!==null,y!==(a!==null&&a.memoizedState!==null)&&y&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(Pt.current&1)!==0?Qt===0&&(Qt=3):s_())),c.updateQueue!==null&&(c.flags|=4),Nn(c),null);case 4:return vc(),$y(a,c),a===null&&ph(c.stateNode.containerInfo),Nn(c),null;case 10:return xy(c.type._context),Nn(c),null;case 17:return ei(c.type)&&ag(),Nn(c),null;case 19:if(Et(Pt),w=c.memoizedState,w===null)return Nn(c),null;if(y=(c.flags&128)!==0,D=w.rendering,D===null)if(y)Ch(w,!1);else{if(Qt!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(D=_g(a),D!==null){for(c.flags|=128,Ch(w,!1),y=D.updateQueue,y!==null&&(c.updateQueue=y,c.flags|=4),c.subtreeFlags=0,y=d,d=c.child;d!==null;)w=d,a=y,w.flags&=14680066,D=w.alternate,D===null?(w.childLanes=0,w.lanes=a,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=D.childLanes,w.lanes=D.lanes,w.child=D.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=D.memoizedProps,w.memoizedState=D.memoizedState,w.updateQueue=D.updateQueue,w.type=D.type,a=D.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return xt(Pt,Pt.current&1|2),c.child}a=a.sibling}w.tail!==null&&vt()>Sc&&(c.flags|=128,y=!0,Ch(w,!1),c.lanes=4194304)}else{if(!y)if(a=_g(D),a!==null){if(c.flags|=128,y=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),Ch(w,!0),w.tail===null&&w.tailMode==="hidden"&&!D.alternate&&!Ct)return Nn(c),null}else 2*vt()-w.renderingStartTime>Sc&&d!==1073741824&&(c.flags|=128,y=!0,Ch(w,!1),c.lanes=4194304);w.isBackwards?(D.sibling=c.child,c.child=D):(d=w.last,d!==null?d.sibling=D:c.child=D,w.last=D)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=vt(),c.sibling=null,d=Pt.current,xt(Pt,y?d&1|2:d&1),c):(Nn(c),null);case 22:case 23:return r_(),y=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==y&&(c.flags|=8192),y&&(c.mode&1)!==0?(Si&1073741824)!==0&&(Nn(c),c.subtreeFlags&6&&(c.flags|=8192)):Nn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function rL(a,c){switch(fy(c),c.tag){case 1:return ei(c.type)&&ag(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return vc(),Et(Jn),Et(Pn),by(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return Sy(c),null;case 13:if(Et(Pt),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));mc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return Et(Pt),null;case 4:return vc(),null;case 10:return xy(c.type._context),null;case 22:case 23:return r_(),null;case 24:return null;default:return null}}var Cg=!1,Dn=!1,sL=typeof WeakSet=="function"?WeakSet:Set,ve=null;function Ec(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(y){Mt(a,c,y)}else d.current=null}function Hy(a,c,d){try{d()}catch(y){Mt(a,c,y)}}var $T=!1;function oL(a,c){if(ry=Cs,a=TE(),Y0(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var y=d.getSelection&&d.getSelection();if(y&&y.rangeCount!==0){d=y.anchorNode;var x=y.anchorOffset,w=y.focusNode;y=y.focusOffset;try{d.nodeType,w.nodeType}catch{d=null;break e}var D=0,B=-1,$=-1,ne=0,ue=0,de=a,ce=null;t:for(;;){for(var _e;de!==d||x!==0&&de.nodeType!==3||(B=D+x),de!==w||y!==0&&de.nodeType!==3||($=D+y),de.nodeType===3&&(D+=de.nodeValue.length),(_e=de.firstChild)!==null;)ce=de,de=_e;for(;;){if(de===a)break t;if(ce===d&&++ne===x&&(B=D),ce===w&&++ue===y&&($=D),(_e=de.nextSibling)!==null)break;de=ce,ce=de.parentNode}de=_e}d=B===-1||$===-1?null:{start:B,end:$}}else d=null}d=d||{start:0,end:0}}else d=null;for(sy={focusedElem:a,selectionRange:d},Cs=!1,ve=c;ve!==null;)if(c=ve,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,ve=a;else for(;ve!==null;){c=ve;try{var Ee=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Ee!==null){var Se=Ee.memoizedProps,zt=Ee.memoizedState,Z=c.stateNode,K=Z.getSnapshotBeforeUpdate(c.elementType===c.type?Se:dr(c.type,Se),zt);Z.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var ee=c.stateNode.containerInfo;ee.nodeType===1?ee.textContent="":ee.nodeType===9&&ee.documentElement&&ee.removeChild(ee.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(fe){Mt(c,c.return,fe)}if(a=c.sibling,a!==null){a.return=c.return,ve=a;break}ve=c.return}return Ee=$T,$T=!1,Ee}function Rh(a,c,d){var y=c.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var x=y=y.next;do{if((x.tag&a)===a){var w=x.destroy;x.destroy=void 0,w!==void 0&&Hy(c,d,w)}x=x.next}while(x!==y)}}function Rg(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var y=d.create;d.destroy=y()}d=d.next}while(d!==c)}}function Ky(a){var c=a.ref;if(c!==null){var d=a.stateNode;a.tag,a=d,typeof c=="function"?c(a):c.current=a}}function HT(a){var c=a.alternate;c!==null&&(a.alternate=null,HT(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[Qr],delete c[yh],delete c[cy],delete c[BM],delete c[WM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function KT(a){return a.tag===5||a.tag===3||a.tag===4}function qT(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||KT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function qy(a,c,d){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=sg));else if(y!==4&&(a=a.child,a!==null))for(qy(a,c,d),a=a.sibling;a!==null;)qy(a,c,d),a=a.sibling}function Xy(a,c,d){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(y!==4&&(a=a.child,a!==null))for(Xy(a,c,d),a=a.sibling;a!==null;)Xy(a,c,d),a=a.sibling}var vn=null,fr=!1;function So(a,c,d){for(d=d.child;d!==null;)XT(a,c,d),d=d.sibling}function XT(a,c,d){if(mi&&typeof mi.onCommitFiberUnmount=="function")try{mi.onCommitFiberUnmount(wa,d)}catch{}switch(d.tag){case 5:Dn||Ec(d,c);case 6:var y=vn,x=fr;vn=null,So(a,c,d),vn=y,fr=x,vn!==null&&(fr?(a=vn,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):vn.removeChild(d.stateNode));break;case 18:vn!==null&&(fr?(a=vn,d=d.stateNode,a.nodeType===8?ly(a.parentNode,d):a.nodeType===1&&ly(a,d),go(a)):ly(vn,d.stateNode));break;case 4:y=vn,x=fr,vn=d.stateNode.containerInfo,fr=!0,So(a,c,d),vn=y,fr=x;break;case 0:case 11:case 14:case 15:if(!Dn&&(y=d.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){x=y=y.next;do{var w=x,D=w.destroy;w=w.tag,D!==void 0&&((w&2)!==0||(w&4)!==0)&&Hy(d,c,D),x=x.next}while(x!==y)}So(a,c,d);break;case 1:if(!Dn&&(Ec(d,c),y=d.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=d.memoizedProps,y.state=d.memoizedState,y.componentWillUnmount()}catch(B){Mt(d,c,B)}So(a,c,d);break;case 21:So(a,c,d);break;case 22:d.mode&1?(Dn=(y=Dn)||d.memoizedState!==null,So(a,c,d),Dn=y):So(a,c,d);break;default:So(a,c,d)}}function YT(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new sL),c.forEach(function(y){var x=pL.bind(null,a,y);d.has(y)||(d.add(y),y.then(x,x))})}}function gr(a,c){var d=c.deletions;if(d!==null)for(var y=0;y<d.length;y++){var x=d[y];try{var w=a,D=c,B=D;e:for(;B!==null;){switch(B.tag){case 5:vn=B.stateNode,fr=!1;break e;case 3:vn=B.stateNode.containerInfo,fr=!0;break e;case 4:vn=B.stateNode.containerInfo,fr=!0;break e}B=B.return}if(vn===null)throw Error(t(160));XT(w,D,x),vn=null,fr=!1;var $=x.alternate;$!==null&&($.return=null),x.return=null}catch(ne){Mt(x,c,ne)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)ZT(c,a),c=c.sibling}function ZT(a,c){var d=a.alternate,y=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(gr(c,a),ts(a),y&4){try{Rh(3,a,a.return),Rg(3,a)}catch(Se){Mt(a,a.return,Se)}try{Rh(5,a,a.return)}catch(Se){Mt(a,a.return,Se)}}break;case 1:gr(c,a),ts(a),y&512&&d!==null&&Ec(d,d.return);break;case 5:if(gr(c,a),ts(a),y&512&&d!==null&&Ec(d,d.return),a.flags&32){var x=a.stateNode;try{Or(x,"")}catch(Se){Mt(a,a.return,Se)}}if(y&4&&(x=a.stateNode,x!=null)){var w=a.memoizedProps,D=d!==null?d.memoizedProps:w,B=a.type,$=a.updateQueue;if(a.updateQueue=null,$!==null)try{B==="input"&&w.type==="radio"&&w.name!=null&&gn(x,w),Es(B,D);var ne=Es(B,w);for(D=0;D<$.length;D+=2){var ue=$[D],de=$[D+1];ue==="style"?ws(x,de):ue==="dangerouslySetInnerHTML"?ya(x,de):ue==="children"?Or(x,de):N(x,ue,de,ne)}switch(B){case"input":Qn(x,w);break;case"textarea":ao(x,w);break;case"select":var ce=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!w.multiple;var _e=w.value;_e!=null?rn(x,!!w.multiple,_e,!1):ce!==!!w.multiple&&(w.defaultValue!=null?rn(x,!!w.multiple,w.defaultValue,!0):rn(x,!!w.multiple,w.multiple?[]:"",!1))}x[yh]=w}catch(Se){Mt(a,a.return,Se)}}break;case 6:if(gr(c,a),ts(a),y&4){if(a.stateNode===null)throw Error(t(162));x=a.stateNode,w=a.memoizedProps;try{x.nodeValue=w}catch(Se){Mt(a,a.return,Se)}}break;case 3:if(gr(c,a),ts(a),y&4&&d!==null&&d.memoizedState.isDehydrated)try{go(c.containerInfo)}catch(Se){Mt(a,a.return,Se)}break;case 4:gr(c,a),ts(a);break;case 13:gr(c,a),ts(a),x=a.child,x.flags&8192&&(w=x.memoizedState!==null,x.stateNode.isHidden=w,!w||x.alternate!==null&&x.alternate.memoizedState!==null||(Qy=vt())),y&4&&YT(a);break;case 22:if(ue=d!==null&&d.memoizedState!==null,a.mode&1?(Dn=(ne=Dn)||ue,gr(c,a),Dn=ne):gr(c,a),ts(a),y&8192){if(ne=a.memoizedState!==null,(a.stateNode.isHidden=ne)&&!ue&&(a.mode&1)!==0)for(ve=a,ue=a.child;ue!==null;){for(de=ve=ue;ve!==null;){switch(ce=ve,_e=ce.child,ce.tag){case 0:case 11:case 14:case 15:Rh(4,ce,ce.return);break;case 1:Ec(ce,ce.return);var Ee=ce.stateNode;if(typeof Ee.componentWillUnmount=="function"){y=ce,d=ce.return;try{c=y,Ee.props=c.memoizedProps,Ee.state=c.memoizedState,Ee.componentWillUnmount()}catch(Se){Mt(y,d,Se)}}break;case 5:Ec(ce,ce.return);break;case 22:if(ce.memoizedState!==null){eS(de);continue}}_e!==null?(_e.return=ce,ve=_e):eS(de)}ue=ue.sibling}e:for(ue=null,de=a;;){if(de.tag===5){if(ue===null){ue=de;try{x=de.stateNode,ne?(w=x.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(B=de.stateNode,$=de.memoizedProps.style,D=$!=null&&$.hasOwnProperty("display")?$.display:null,B.style.display=jr("display",D))}catch(Se){Mt(a,a.return,Se)}}}else if(de.tag===6){if(ue===null)try{de.stateNode.nodeValue=ne?"":de.memoizedProps}catch(Se){Mt(a,a.return,Se)}}else if((de.tag!==22&&de.tag!==23||de.memoizedState===null||de===a)&&de.child!==null){de.child.return=de,de=de.child;continue}if(de===a)break e;for(;de.sibling===null;){if(de.return===null||de.return===a)break e;ue===de&&(ue=null),de=de.return}ue===de&&(ue=null),de.sibling.return=de.return,de=de.sibling}}break;case 19:gr(c,a),ts(a),y&4&&YT(a);break;case 21:break;default:gr(c,a),ts(a)}}function ts(a){var c=a.flags;if(c&2){try{e:{for(var d=a.return;d!==null;){if(KT(d)){var y=d;break e}d=d.return}throw Error(t(160))}switch(y.tag){case 5:var x=y.stateNode;y.flags&32&&(Or(x,""),y.flags&=-33);var w=qT(a);Xy(a,w,x);break;case 3:case 4:var D=y.stateNode.containerInfo,B=qT(a);qy(a,B,D);break;default:throw Error(t(161))}}catch($){Mt(a,a.return,$)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function aL(a,c,d){ve=a,QT(a)}function QT(a,c,d){for(var y=(a.mode&1)!==0;ve!==null;){var x=ve,w=x.child;if(x.tag===22&&y){var D=x.memoizedState!==null||Cg;if(!D){var B=x.alternate,$=B!==null&&B.memoizedState!==null||Dn;B=Cg;var ne=Dn;if(Cg=D,(Dn=$)&&!ne)for(ve=x;ve!==null;)D=ve,$=D.child,D.tag===22&&D.memoizedState!==null?tS(x):$!==null?($.return=D,ve=$):tS(x);for(;w!==null;)ve=w,QT(w),w=w.sibling;ve=x,Cg=B,Dn=ne}JT(a)}else(x.subtreeFlags&8772)!==0&&w!==null?(w.return=x,ve=w):JT(a)}}function JT(a){for(;ve!==null;){var c=ve;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Dn||Rg(5,c);break;case 1:var y=c.stateNode;if(c.flags&4&&!Dn)if(d===null)y.componentDidMount();else{var x=c.elementType===c.type?d.memoizedProps:dr(c.type,d.memoizedProps);y.componentDidUpdate(x,d.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var w=c.updateQueue;w!==null&&eT(c,w,y);break;case 3:var D=c.updateQueue;if(D!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}eT(c,D,d)}break;case 5:var B=c.stateNode;if(d===null&&c.flags&4){d=B;var $=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&d.focus();break;case"img":$.src&&(d.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var ne=c.alternate;if(ne!==null){var ue=ne.memoizedState;if(ue!==null){var de=ue.dehydrated;de!==null&&go(de)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Dn||c.flags&512&&Ky(c)}catch(ce){Mt(c,c.return,ce)}}if(c===a){ve=null;break}if(d=c.sibling,d!==null){d.return=c.return,ve=d;break}ve=c.return}}function eS(a){for(;ve!==null;){var c=ve;if(c===a){ve=null;break}var d=c.sibling;if(d!==null){d.return=c.return,ve=d;break}ve=c.return}}function tS(a){for(;ve!==null;){var c=ve;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{Rg(4,c)}catch($){Mt(c,d,$)}break;case 1:var y=c.stateNode;if(typeof y.componentDidMount=="function"){var x=c.return;try{y.componentDidMount()}catch($){Mt(c,x,$)}}var w=c.return;try{Ky(c)}catch($){Mt(c,w,$)}break;case 5:var D=c.return;try{Ky(c)}catch($){Mt(c,D,$)}}}catch($){Mt(c,c.return,$)}if(c===a){ve=null;break}var B=c.sibling;if(B!==null){B.return=c.return,ve=B;break}ve=c.return}}var lL=Math.ceil,Ag=L.ReactCurrentDispatcher,Yy=L.ReactCurrentOwner,Hi=L.ReactCurrentBatchConfig,tt=0,an=null,Ht=null,wn=0,Si=0,Tc=xo(0),Qt=0,Ah=null,ja=0,Pg=0,Zy=0,Ph=null,ni=null,Qy=0,Sc=1/0,js=null,kg=!1,Jy=null,Io=null,Ng=!1,bo=null,Dg=0,kh=0,e_=null,Mg=-1,Lg=0;function $n(){return(tt&6)!==0?vt():Mg!==-1?Mg:Mg=vt()}function Co(a){return(a.mode&1)===0?1:(tt&2)!==0&&wn!==0?wn&-wn:$M.transition!==null?(Lg===0&&(Lg=Qu()),Lg):(a=Ye,a!==0||(a=window.event,a=a===void 0?16:Jl(a.type)),a)}function pr(a,c,d,y){if(50<kh)throw kh=0,e_=null,Error(t(185));Ia(a,d,y),((tt&2)===0||a!==an)&&(a===an&&((tt&2)===0&&(Pg|=d),Qt===4&&Ro(a,wn)),ii(a,y),d===1&&tt===0&&(c.mode&1)===0&&(Sc=vt()+500,cg&&wo()))}function ii(a,c){var d=a.callbackNode;Sa(a,c);var y=Ss(a,a===an?wn:0);if(y===0)d!==null&&Hl(d),a.callbackNode=null,a.callbackPriority=0;else if(c=y&-y,a.callbackPriority!==c){if(d!=null&&Hl(d),c===1)a.tag===0?GM(iS.bind(null,a)):BE(iS.bind(null,a)),zM(function(){(tt&6)===0&&wo()}),d=null;else{switch(Br(y)){case 1:d=Kl;break;case 4:d=Xu;break;case 16:d=va;break;case 536870912:d=ql;break;default:d=va}d=hS(d,nS.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function nS(a,c){if(Mg=-1,Lg=0,(tt&6)!==0)throw Error(t(327));var d=a.callbackNode;if(Ic()&&a.callbackNode!==d)return null;var y=Ss(a,a===an?wn:0);if(y===0)return null;if((y&30)!==0||(y&a.expiredLanes)!==0||c)c=Og(a,y);else{c=y;var x=tt;tt|=2;var w=sS();(an!==a||wn!==c)&&(js=null,Sc=vt()+500,Va(a,c));do try{hL();break}catch(B){rS(a,B)}while(!0);_y(),Ag.current=w,tt=x,Ht!==null?c=0:(an=null,wn=0,c=Qt)}if(c!==0){if(c===2&&(x=Zu(a),x!==0&&(y=x,c=t_(a,x))),c===1)throw d=Ah,Va(a,0),Ro(a,y),ii(a,vt()),d;if(c===6)Ro(a,y);else{if(x=a.current.alternate,(y&30)===0&&!cL(x)&&(c=Og(a,y),c===2&&(w=Zu(a),w!==0&&(y=w,c=t_(a,w))),c===1))throw d=Ah,Va(a,0),Ro(a,y),ii(a,vt()),d;switch(a.finishedWork=x,a.finishedLanes=y,c){case 0:case 1:throw Error(t(345));case 2:za(a,ni,js);break;case 3:if(Ro(a,y),(y&130023424)===y&&(c=Qy+500-vt(),10<c)){if(Ss(a,0)!==0)break;if(x=a.suspendedLanes,(x&y)!==y){$n(),a.pingedLanes|=a.suspendedLanes&x;break}a.timeoutHandle=ay(za.bind(null,a,ni,js),c);break}za(a,ni,js);break;case 4:if(Ro(a,y),(y&4194240)===y)break;for(c=a.eventTimes,x=-1;0<y;){var D=31-yi(y);w=1<<D,D=c[D],D>x&&(x=D),y&=~w}if(y=x,y=vt()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*lL(y/1960))-y,10<y){a.timeoutHandle=ay(za.bind(null,a,ni,js),y);break}za(a,ni,js);break;case 5:za(a,ni,js);break;default:throw Error(t(329))}}}return ii(a,vt()),a.callbackNode===d?nS.bind(null,a):null}function t_(a,c){var d=Ph;return a.current.memoizedState.isDehydrated&&(Va(a,c).flags|=256),a=Og(a,c),a!==2&&(c=ni,ni=d,c!==null&&n_(c)),a}function n_(a){ni===null?ni=a:ni.push.apply(ni,a)}function cL(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var y=0;y<d.length;y++){var x=d[y],w=x.getSnapshot;x=x.value;try{if(!ur(w(),x))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ro(a,c){for(c&=~Zy,c&=~Pg,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-yi(c),y=1<<d;a[d]=-1,c&=~y}}function iS(a){if((tt&6)!==0)throw Error(t(327));Ic();var c=Ss(a,0);if((c&1)===0)return ii(a,vt()),null;var d=Og(a,c);if(a.tag!==0&&d===2){var y=Zu(a);y!==0&&(c=y,d=t_(a,y))}if(d===1)throw d=Ah,Va(a,0),Ro(a,c),ii(a,vt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,za(a,ni,js),ii(a,vt()),null}function i_(a,c){var d=tt;tt|=1;try{return a(c)}finally{tt=d,tt===0&&(Sc=vt()+500,cg&&wo())}}function Fa(a){bo!==null&&bo.tag===0&&(tt&6)===0&&Ic();var c=tt;tt|=1;var d=Hi.transition,y=Ye;try{if(Hi.transition=null,Ye=1,a)return a()}finally{Ye=y,Hi.transition=d,tt=c,(tt&6)===0&&wo()}}function r_(){Si=Tc.current,Et(Tc)}function Va(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,VM(d)),Ht!==null)for(d=Ht.return;d!==null;){var y=d;switch(fy(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&ag();break;case 3:vc(),Et(Jn),Et(Pn),by();break;case 5:Sy(y);break;case 4:vc();break;case 13:Et(Pt);break;case 19:Et(Pt);break;case 10:xy(y.type._context);break;case 22:case 23:r_()}d=d.return}if(an=a,Ht=a=Ao(a.current,null),wn=Si=c,Qt=0,Ah=null,Zy=Pg=ja=0,ni=Ph=null,Ma!==null){for(c=0;c<Ma.length;c++)if(d=Ma[c],y=d.interleaved,y!==null){d.interleaved=null;var x=y.next,w=d.pending;if(w!==null){var D=w.next;w.next=x,y.next=D}d.pending=y}Ma=null}return a}function rS(a,c){do{var d=Ht;try{if(_y(),xg.current=Tg,vg){for(var y=kt.memoizedState;y!==null;){var x=y.queue;x!==null&&(x.pending=null),y=y.next}vg=!1}if(Oa=0,on=Zt=kt=null,Th=!1,Sh=0,Yy.current=null,d===null||d.return===null){Qt=1,Ah=c,Ht=null;break}e:{var w=a,D=d.return,B=d,$=c;if(c=wn,B.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var ne=$,ue=B,de=ue.tag;if((ue.mode&1)===0&&(de===0||de===11||de===15)){var ce=ue.alternate;ce?(ue.updateQueue=ce.updateQueue,ue.memoizedState=ce.memoizedState,ue.lanes=ce.lanes):(ue.updateQueue=null,ue.memoizedState=null)}var _e=AT(D);if(_e!==null){_e.flags&=-257,PT(_e,D,B,w,c),_e.mode&1&&RT(w,ne,c),c=_e,$=ne;var Ee=c.updateQueue;if(Ee===null){var Se=new Set;Se.add($),c.updateQueue=Se}else Ee.add($);break e}else{if((c&1)===0){RT(w,ne,c),s_();break e}$=Error(t(426))}}else if(Ct&&B.mode&1){var zt=AT(D);if(zt!==null){(zt.flags&65536)===0&&(zt.flags|=256),PT(zt,D,B,w,c),my(wc($,B));break e}}w=$=wc($,B),Qt!==4&&(Qt=2),Ph===null?Ph=[w]:Ph.push(w),w=D;do{switch(w.tag){case 3:w.flags|=65536,c&=-c,w.lanes|=c;var Z=bT(w,$,c);JE(w,Z);break e;case 1:B=$;var K=w.type,ee=w.stateNode;if((w.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||ee!==null&&typeof ee.componentDidCatch=="function"&&(Io===null||!Io.has(ee)))){w.flags|=65536,c&=-c,w.lanes|=c;var fe=CT(w,B,c);JE(w,fe);break e}}w=w.return}while(w!==null)}aS(d)}catch(be){c=be,Ht===d&&d!==null&&(Ht=d=d.return);continue}break}while(!0)}function sS(){var a=Ag.current;return Ag.current=Tg,a===null?Tg:a}function s_(){(Qt===0||Qt===3||Qt===2)&&(Qt=4),an===null||(ja&268435455)===0&&(Pg&268435455)===0||Ro(an,wn)}function Og(a,c){var d=tt;tt|=2;var y=sS();(an!==a||wn!==c)&&(js=null,Va(a,c));do try{uL();break}catch(x){rS(a,x)}while(!0);if(_y(),tt=d,Ag.current=y,Ht!==null)throw Error(t(261));return an=null,wn=0,Qt}function uL(){for(;Ht!==null;)oS(Ht)}function hL(){for(;Ht!==null&&!xa();)oS(Ht)}function oS(a){var c=uS(a.alternate,a,Si);a.memoizedProps=a.pendingProps,c===null?aS(a):Ht=c,Yy.current=null}function aS(a){var c=a;do{var d=c.alternate;if(a=c.return,(c.flags&32768)===0){if(d=iL(d,c,Si),d!==null){Ht=d;return}}else{if(d=rL(d,c),d!==null){d.flags&=32767,Ht=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Qt=6,Ht=null;return}}if(c=c.sibling,c!==null){Ht=c;return}Ht=c=a}while(c!==null);Qt===0&&(Qt=5)}function za(a,c,d){var y=Ye,x=Hi.transition;try{Hi.transition=null,Ye=1,dL(a,c,d,y)}finally{Hi.transition=x,Ye=y}return null}function dL(a,c,d,y){do Ic();while(bo!==null);if((tt&6)!==0)throw Error(t(327));d=a.finishedWork;var x=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var w=d.lanes|d.childLanes;if($0(a,w),a===an&&(Ht=an=null,wn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Ng||(Ng=!0,hS(va,function(){return Ic(),null})),w=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||w){w=Hi.transition,Hi.transition=null;var D=Ye;Ye=1;var B=tt;tt|=4,Yy.current=null,oL(a,d),ZT(d,a),NM(sy),Cs=!!ry,sy=ry=null,a.current=d,aL(d),Ts(),tt=B,Ye=D,Hi.transition=w}else a.current=d;if(Ng&&(Ng=!1,bo=a,Dg=x),w=a.pendingLanes,w===0&&(Io=null),Wf(d.stateNode),ii(a,vt()),c!==null)for(y=a.onRecoverableError,d=0;d<c.length;d++)x=c[d],y(x.value,{componentStack:x.stack,digest:x.digest});if(kg)throw kg=!1,a=Jy,Jy=null,a;return(Dg&1)!==0&&a.tag!==0&&Ic(),w=a.pendingLanes,(w&1)!==0?a===e_?kh++:(kh=0,e_=a):kh=0,wo(),null}function Ic(){if(bo!==null){var a=Br(Dg),c=Hi.transition,d=Ye;try{if(Hi.transition=null,Ye=16>a?16:a,bo===null)var y=!1;else{if(a=bo,bo=null,Dg=0,(tt&6)!==0)throw Error(t(331));var x=tt;for(tt|=4,ve=a.current;ve!==null;){var w=ve,D=w.child;if((ve.flags&16)!==0){var B=w.deletions;if(B!==null){for(var $=0;$<B.length;$++){var ne=B[$];for(ve=ne;ve!==null;){var ue=ve;switch(ue.tag){case 0:case 11:case 15:Rh(8,ue,w)}var de=ue.child;if(de!==null)de.return=ue,ve=de;else for(;ve!==null;){ue=ve;var ce=ue.sibling,_e=ue.return;if(HT(ue),ue===ne){ve=null;break}if(ce!==null){ce.return=_e,ve=ce;break}ve=_e}}}var Ee=w.alternate;if(Ee!==null){var Se=Ee.child;if(Se!==null){Ee.child=null;do{var zt=Se.sibling;Se.sibling=null,Se=zt}while(Se!==null)}}ve=w}}if((w.subtreeFlags&2064)!==0&&D!==null)D.return=w,ve=D;else e:for(;ve!==null;){if(w=ve,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:Rh(9,w,w.return)}var Z=w.sibling;if(Z!==null){Z.return=w.return,ve=Z;break e}ve=w.return}}var K=a.current;for(ve=K;ve!==null;){D=ve;var ee=D.child;if((D.subtreeFlags&2064)!==0&&ee!==null)ee.return=D,ve=ee;else e:for(D=K;ve!==null;){if(B=ve,(B.flags&2048)!==0)try{switch(B.tag){case 0:case 11:case 15:Rg(9,B)}}catch(be){Mt(B,B.return,be)}if(B===D){ve=null;break e}var fe=B.sibling;if(fe!==null){fe.return=B.return,ve=fe;break e}ve=B.return}}if(tt=x,wo(),mi&&typeof mi.onPostCommitFiberRoot=="function")try{mi.onPostCommitFiberRoot(wa,a)}catch{}y=!0}return y}finally{Ye=d,Hi.transition=c}}return!1}function lS(a,c,d){c=wc(d,c),c=bT(a,c,1),a=To(a,c,1),c=$n(),a!==null&&(Ia(a,1,c),ii(a,c))}function Mt(a,c,d){if(a.tag===3)lS(a,a,d);else for(;c!==null;){if(c.tag===3){lS(c,a,d);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Io===null||!Io.has(y))){a=wc(d,a),a=CT(c,a,1),c=To(c,a,1),a=$n(),c!==null&&(Ia(c,1,a),ii(c,a));break}}c=c.return}}function fL(a,c,d){var y=a.pingCache;y!==null&&y.delete(c),c=$n(),a.pingedLanes|=a.suspendedLanes&d,an===a&&(wn&d)===d&&(Qt===4||Qt===3&&(wn&130023424)===wn&&500>vt()-Qy?Va(a,0):Zy|=d),ii(a,c)}function cS(a,c){c===0&&((a.mode&1)===0?c=1:(c=uo,uo<<=1,(uo&130023424)===0&&(uo=4194304)));var d=$n();a=Ms(a,c),a!==null&&(Ia(a,c,d),ii(a,d))}function gL(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),cS(a,d)}function pL(a,c){var d=0;switch(a.tag){case 13:var y=a.stateNode,x=a.memoizedState;x!==null&&(d=x.retryLane);break;case 19:y=a.stateNode;break;default:throw Error(t(314))}y!==null&&y.delete(c),cS(a,d)}var uS;uS=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Jn.current)ti=!0;else{if((a.lanes&d)===0&&(c.flags&128)===0)return ti=!1,nL(a,c,d);ti=(a.flags&131072)!==0}else ti=!1,Ct&&(c.flags&1048576)!==0&&WE(c,hg,c.index);switch(c.lanes=0,c.tag){case 2:var y=c.type;bg(a,c),a=c.pendingProps;var x=fc(c,Pn.current);xc(c,d),x=Ay(null,c,y,a,x,d);var w=Py();return c.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,ei(y)?(w=!0,lg(c)):w=!1,c.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,Ey(c),x.updater=Sg,c.stateNode=x,x._reactInternals=c,Oy(c,y,a,d),c=zy(null,c,y,!0,w,d)):(c.tag=0,Ct&&w&&dy(c),Gn(null,c,x,d),c=c.child),c;case 16:y=c.elementType;e:{switch(bg(a,c),a=c.pendingProps,x=y._init,y=x(y._payload),c.type=y,x=c.tag=yL(y),a=dr(y,a),x){case 0:c=Vy(null,c,y,a,d);break e;case 1:c=OT(null,c,y,a,d);break e;case 11:c=kT(null,c,y,a,d);break e;case 14:c=NT(null,c,y,dr(y.type,a),d);break e}throw Error(t(306,y,""))}return c;case 0:return y=c.type,x=c.pendingProps,x=c.elementType===y?x:dr(y,x),Vy(a,c,y,x,d);case 1:return y=c.type,x=c.pendingProps,x=c.elementType===y?x:dr(y,x),OT(a,c,y,x,d);case 3:e:{if(jT(c),a===null)throw Error(t(387));y=c.pendingProps,w=c.memoizedState,x=w.element,QE(a,c),yg(c,y,null,d);var D=c.memoizedState;if(y=D.element,w.isDehydrated)if(w={element:y,isDehydrated:!1,cache:D.cache,pendingSuspenseBoundaries:D.pendingSuspenseBoundaries,transitions:D.transitions},c.updateQueue.baseState=w,c.memoizedState=w,c.flags&256){x=wc(Error(t(423)),c),c=FT(a,c,y,d,x);break e}else if(y!==x){x=wc(Error(t(424)),c),c=FT(a,c,y,d,x);break e}else for(Ti=_o(c.stateNode.containerInfo.firstChild),Ei=c,Ct=!0,hr=null,d=YE(c,null,y,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(mc(),y===x){c=Os(a,c,d);break e}Gn(a,c,y,d)}c=c.child}return c;case 5:return tT(c),a===null&&py(c),y=c.type,x=c.pendingProps,w=a!==null?a.memoizedProps:null,D=x.children,oy(y,x)?D=null:w!==null&&oy(y,w)&&(c.flags|=32),LT(a,c),Gn(a,c,D,d),c.child;case 6:return a===null&&py(c),null;case 13:return VT(a,c,d);case 4:return Ty(c,c.stateNode.containerInfo),y=c.pendingProps,a===null?c.child=yc(c,null,y,d):Gn(a,c,y,d),c.child;case 11:return y=c.type,x=c.pendingProps,x=c.elementType===y?x:dr(y,x),kT(a,c,y,x,d);case 7:return Gn(a,c,c.pendingProps,d),c.child;case 8:return Gn(a,c,c.pendingProps.children,d),c.child;case 12:return Gn(a,c,c.pendingProps.children,d),c.child;case 10:e:{if(y=c.type._context,x=c.pendingProps,w=c.memoizedProps,D=x.value,xt(gg,y._currentValue),y._currentValue=D,w!==null)if(ur(w.value,D)){if(w.children===x.children&&!Jn.current){c=Os(a,c,d);break e}}else for(w=c.child,w!==null&&(w.return=c);w!==null;){var B=w.dependencies;if(B!==null){D=w.child;for(var $=B.firstContext;$!==null;){if($.context===y){if(w.tag===1){$=Ls(-1,d&-d),$.tag=2;var ne=w.updateQueue;if(ne!==null){ne=ne.shared;var ue=ne.pending;ue===null?$.next=$:($.next=ue.next,ue.next=$),ne.pending=$}}w.lanes|=d,$=w.alternate,$!==null&&($.lanes|=d),vy(w.return,d,c),B.lanes|=d;break}$=$.next}}else if(w.tag===10)D=w.type===c.type?null:w.child;else if(w.tag===18){if(D=w.return,D===null)throw Error(t(341));D.lanes|=d,B=D.alternate,B!==null&&(B.lanes|=d),vy(D,d,c),D=w.sibling}else D=w.child;if(D!==null)D.return=w;else for(D=w;D!==null;){if(D===c){D=null;break}if(w=D.sibling,w!==null){w.return=D.return,D=w;break}D=D.return}w=D}Gn(a,c,x.children,d),c=c.child}return c;case 9:return x=c.type,y=c.pendingProps.children,xc(c,d),x=Gi(x),y=y(x),c.flags|=1,Gn(a,c,y,d),c.child;case 14:return y=c.type,x=dr(y,c.pendingProps),x=dr(y.type,x),NT(a,c,y,x,d);case 15:return DT(a,c,c.type,c.pendingProps,d);case 17:return y=c.type,x=c.pendingProps,x=c.elementType===y?x:dr(y,x),bg(a,c),c.tag=1,ei(y)?(a=!0,lg(c)):a=!1,xc(c,d),ST(c,y,x),Oy(c,y,x,d),zy(null,c,y,!0,a,d);case 19:return UT(a,c,d);case 22:return MT(a,c,d)}throw Error(t(156,c.tag))};function hS(a,c){return qu(a,c)}function mL(a,c,d,y){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ki(a,c,d,y){return new mL(a,c,d,y)}function o_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function yL(a){if(typeof a=="function")return o_(a)?1:0;if(a!=null){if(a=a.$$typeof,a===U)return 11;if(a===pe)return 14}return 2}function Ao(a,c){var d=a.alternate;return d===null?(d=Ki(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function jg(a,c,d,y,x,w){var D=2;if(y=a,typeof a=="function")o_(a)&&(D=1);else if(typeof a=="string")D=5;else e:switch(a){case P:return Ua(d.children,x,w,c);case b:D=8,x|=8;break;case k:return a=Ki(12,d,c,x|2),a.elementType=k,a.lanes=w,a;case O:return a=Ki(13,d,c,x),a.elementType=O,a.lanes=w,a;case se:return a=Ki(19,d,c,x),a.elementType=se,a.lanes=w,a;case re:return Fg(d,x,w,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case F:D=10;break e;case V:D=9;break e;case U:D=11;break e;case pe:D=14;break e;case J:D=16,y=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=Ki(D,d,c,x),c.elementType=a,c.type=y,c.lanes=w,c}function Ua(a,c,d,y){return a=Ki(7,a,y,c),a.lanes=d,a}function Fg(a,c,d,y){return a=Ki(22,a,y,c),a.elementType=re,a.lanes=d,a.stateNode={isHidden:!1},a}function a_(a,c,d){return a=Ki(6,a,null,c),a.lanes=d,a}function l_(a,c,d){return c=Ki(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function _L(a,c,d,y,x){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ju(0),this.expirationTimes=Ju(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ju(0),this.identifierPrefix=y,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function c_(a,c,d,y,x,w,D,B,$){return a=new _L(a,c,d,B,$),c===1?(c=1,w===!0&&(c|=8)):c=0,w=Ki(3,null,null,c),a.current=w,w.stateNode=a,w.memoizedState={element:y,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ey(w),a}function xL(a,c,d){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:y==null?null:""+y,children:a,containerInfo:c,implementation:d}}function dS(a){if(!a)return vo;a=a._reactInternals;e:{if(lr(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(ei(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(ei(d))return zE(a,d,c)}return c}function fS(a,c,d,y,x,w,D,B,$){return a=c_(d,y,!0,a,x,w,D,B,$),a.context=dS(null),d=a.current,y=$n(),x=Co(d),w=Ls(y,x),w.callback=c??null,To(d,w,x),a.current.lanes=x,Ia(a,x,y),ii(a,y),a}function Vg(a,c,d,y){var x=c.current,w=$n(),D=Co(x);return d=dS(d),c.context===null?c.context=d:c.pendingContext=d,c=Ls(w,D),c.payload={element:a},y=y===void 0?null:y,y!==null&&(c.callback=y),a=To(x,c,D),a!==null&&(pr(a,x,D,w),mg(a,x,D)),D}function zg(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function gS(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function u_(a,c){gS(a,c),(a=a.alternate)&&gS(a,c)}function vL(){return null}var pS=typeof reportError=="function"?reportError:function(a){console.error(a)};function h_(a){this._internalRoot=a}Ug.prototype.render=h_.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));Vg(a,c,null,null)},Ug.prototype.unmount=h_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;Fa(function(){Vg(null,a,null,null)}),c[Ps]=null}};function Ug(a){this._internalRoot=a}Ug.prototype.unstable_scheduleHydration=function(a){if(a){var c=ih();a={blockedOn:null,target:a,priority:c};for(var d=0;d<_i.length&&c!==0&&c<_i[d].priority;d++);_i.splice(d,0,a),d===0&&Zl(a)}};function d_(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Bg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function mS(){}function wL(a,c,d,y,x){if(x){if(typeof y=="function"){var w=y;y=function(){var ne=zg(D);w.call(ne)}}var D=fS(c,y,a,0,null,!1,!1,"",mS);return a._reactRootContainer=D,a[Ps]=D.current,ph(a.nodeType===8?a.parentNode:a),Fa(),D}for(;x=a.lastChild;)a.removeChild(x);if(typeof y=="function"){var B=y;y=function(){var ne=zg($);B.call(ne)}}var $=c_(a,0,!1,null,null,!1,!1,"",mS);return a._reactRootContainer=$,a[Ps]=$.current,ph(a.nodeType===8?a.parentNode:a),Fa(function(){Vg(c,$,d,y)}),$}function Wg(a,c,d,y,x){var w=d._reactRootContainer;if(w){var D=w;if(typeof x=="function"){var B=x;x=function(){var $=zg(D);B.call($)}}Vg(c,D,a,x)}else D=wL(d,c,a,x,y);return zg(D)}th=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=at(c.pendingLanes);d!==0&&(eh(c,d|1),ii(c,vt()),(tt&6)===0&&(Sc=vt()+500,wo()))}break;case 13:Fa(function(){var y=Ms(a,1);if(y!==null){var x=$n();pr(y,a,1,x)}}),u_(a,1)}},Xl=function(a){if(a.tag===13){var c=Ms(a,134217728);if(c!==null){var d=$n();pr(c,a,134217728,d)}u_(a,134217728)}},nh=function(a){if(a.tag===13){var c=Co(a),d=Ms(a,c);if(d!==null){var y=$n();pr(d,a,c,y)}u_(a,c)}},ih=function(){return Ye},rh=function(a,c){var d=Ye;try{return Ye=a,c()}finally{Ye=d}},Bn=function(a,c,d){switch(c){case"input":if(Qn(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var y=d[c];if(y!==a&&y.form===a.form){var x=og(y);if(!x)throw Error(t(90));sr(y),Qn(y,x)}}}break;case"textarea":ao(a,d);break;case"select":c=d.value,c!=null&&rn(a,!!d.multiple,c,!1)}},Fi=i_,pn=Fa;var EL={usingClientEntryPoint:!1,Events:[_h,hc,og,ar,jt,i_]},Nh={findFiberByHostInstance:Pa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TL={bundleType:Nh.bundleType,version:Nh.version,rendererPackageName:Nh.rendererPackageName,rendererConfig:Nh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Bf(a),a===null?null:a.stateNode},findFiberByHostInstance:Nh.findFiberByHostInstance||vL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gg.isDisabled&&Gg.supportsFiber)try{wa=Gg.inject(TL),mi=Gg}catch{}}return ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EL,ri.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d_(c))throw Error(t(200));return xL(a,c,null,d)},ri.createRoot=function(a,c){if(!d_(a))throw Error(t(299));var d=!1,y="",x=pS;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(x=c.onRecoverableError)),c=c_(a,1,!1,null,null,d,!1,y,x),a[Ps]=c.current,ph(a.nodeType===8?a.parentNode:a),new h_(c)},ri.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Bf(c),a=a===null?null:a.stateNode,a},ri.flushSync=function(a){return Fa(a)},ri.hydrate=function(a,c,d){if(!Bg(c))throw Error(t(200));return Wg(null,a,c,!0,d)},ri.hydrateRoot=function(a,c,d){if(!d_(a))throw Error(t(405));var y=d!=null&&d.hydratedSources||null,x=!1,w="",D=pS;if(d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(D=d.onRecoverableError)),c=fS(c,null,a,1,d??null,x,!1,w,D),a[Ps]=c.current,ph(a),y)for(a=0;a<y.length;a++)d=y[a],x=d._getVersion,x=x(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,x]:c.mutableSourceEagerHydrationData.push(d,x);return new Ug(c)},ri.render=function(a,c,d){if(!Bg(c))throw Error(t(200));return Wg(null,a,c,!1,d)},ri.unmountComponentAtNode=function(a){if(!Bg(a))throw Error(t(40));return a._reactRootContainer?(Fa(function(){Wg(null,null,a,!1,function(){a._reactRootContainer=null,a[Ps]=null})}),!0):!1},ri.unstable_batchedUpdates=i_,ri.unstable_renderSubtreeIntoContainer=function(a,c,d,y){if(!Bg(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Wg(a,c,d,!1,y)},ri.version="18.3.1-next-f1338f8080-20240426",ri}var SS;function kL(){if(SS)return p_.exports;SS=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),p_.exports=PL(),p_.exports}var IS;function NL(){if(IS)return $g;IS=1;var n=kL();return $g.createRoot=n.createRoot,$g.hydrateRoot=n.hydrateRoot,$g}var DL=NL();const ML=Xv(DL);var q=cf();const LL=Xv(q),Yv=q.createContext({});function Zv(n){const e=q.useRef(null);return e.current===null&&(e.current=n()),e.current}const Um=q.createContext(null),Qv=q.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class OL extends q.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function jL({children:n,isPresent:e}){const t=q.useId(),i=q.useRef(null),r=q.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=q.useContext(Qv);return q.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),g.jsx(OL,{isPresent:e,childRef:i,sizeRef:r,children:q.cloneElement(n,{ref:i})})}const FL=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=Zv(VL),u=q.useId(),h=q.useCallback(m=>{l.set(m,!0);for(const _ of l.values())if(!_)return;i&&i()},[l,i]),f=q.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:m=>(l.set(m,!1),()=>l.delete(m))}),s?[Math.random(),h]:[t,h]);return q.useMemo(()=>{l.forEach((m,_)=>l.set(_,!1))},[t]),q.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=g.jsx(jL,{isPresent:t,children:n})),g.jsx(Um.Provider,{value:f,children:n})};function VL(){return new Map}function dR(n=!0){const e=q.useContext(Um);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=q.useId();q.useEffect(()=>{n&&r(s)},[n]);const o=q.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Hg=n=>n.key||"";function bS(n){const e=[];return q.Children.forEach(n,t=>{q.isValidElement(t)&&e.push(t)}),e}const Jv=typeof window<"u",fR=Jv?q.useLayoutEffect:q.useEffect,dn=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,u]=dR(o),h=q.useMemo(()=>bS(n),[n]),f=o&&!l?[]:h.map(Hg),m=q.useRef(!0),_=q.useRef(h),v=Zv(()=>new Map),[S,I]=q.useState(h),[T,R]=q.useState(h);fR(()=>{m.current=!1,_.current=h;for(let L=0;L<T.length;L++){const A=Hg(T[L]);f.includes(A)?v.delete(A):v.get(A)!==!0&&v.set(A,!1)}},[T,f.length,f.join("-")]);const M=[];if(h!==S){let L=[...h];for(let A=0;A<T.length;A++){const z=T[A],P=Hg(z);f.includes(P)||(L.splice(A,0,z),M.push(z))}s==="wait"&&M.length&&(L=M),R(bS(L)),I(h);return}const{forceRender:N}=q.useContext(Yv);return g.jsx(g.Fragment,{children:T.map(L=>{const A=Hg(L),z=o&&!l?!1:h===T||f.includes(A),P=()=>{if(v.has(A))v.set(A,!0);else return;let b=!0;v.forEach(k=>{k||(b=!1)}),b&&(N?.(),R(_.current),o&&u?.(),i&&i())};return g.jsx(FL,{isPresent:z,initial:!m.current||t?void 0:!1,custom:z?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:z?void 0:P,children:L},A)})})},Ai=n=>n;let gR=Ai;function e1(n){let e;return()=>(e===void 0&&(e=n()),e)}const uu=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},Ks=n=>n*1e3,qs=n=>n/1e3,zL={useManualTiming:!1};function UL(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,f=!1,m=!1)=>{const v=m&&i?e:t;return f&&s.add(h),v.has(h)||v.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Kg=["read","resolveKeyframes","update","preRender","render","postRender"],BL=40;function pR(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Kg.reduce((R,M)=>(R[M]=UL(s),R),{}),{read:l,resolveKeyframes:u,update:h,preRender:f,render:m,postRender:_}=o,v=()=>{const R=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(R-r.timestamp,BL),1),r.timestamp=R,r.isProcessing=!0,l.process(r),u.process(r),h.process(r),f.process(r),m.process(r),_.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(v))},S=()=>{t=!0,i=!0,r.isProcessing||n(v)};return{schedule:Kg.reduce((R,M)=>{const N=o[M];return R[M]=(L,A=!1,z=!1)=>(t||S(),N.schedule(L,A,z)),R},{}),cancel:R=>{for(let M=0;M<Kg.length;M++)o[Kg[M]].cancel(R)},state:r,steps:o}}const{schedule:St,cancel:ra,state:En,steps:__}=pR(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ai,!0),mR=q.createContext({strict:!1}),CS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},hu={};for(const n in CS)hu[n]={isEnabled:e=>CS[n].some(t=>!!e[t])};function WL(n){for(const e in n)hu[e]={...hu[e],...n[e]}}const GL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Vp(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||GL.has(n)}let yR=n=>!Vp(n);function $L(n){n&&(yR=e=>e.startsWith("on")?!Vp(e):n(e))}try{$L(require("@emotion/is-prop-valid").default)}catch{}function HL(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(yR(r)||t===!0&&Vp(r)||!e&&!Vp(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function KL(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const Bm=q.createContext({});function Id(n){return typeof n=="string"||Array.isArray(n)}function Wm(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const t1=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],n1=["initial",...t1];function Gm(n){return Wm(n.animate)||n1.some(e=>Id(n[e]))}function _R(n){return!!(Gm(n)||n.variants)}function qL(n,e){if(Gm(n)){const{initial:t,animate:i}=n;return{initial:t===!1||Id(t)?t:void 0,animate:Id(i)?i:void 0}}return n.inherit!==!1?e:{}}function XL(n){const{initial:e,animate:t}=qL(n,q.useContext(Bm));return q.useMemo(()=>({initial:e,animate:t}),[RS(e),RS(t)])}function RS(n){return Array.isArray(n)?n.join(" "):n}const YL=Symbol.for("motionComponentSymbol");function qc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function ZL(n,e,t){return q.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):qc(t)&&(t.current=i))},[e])}const i1=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),QL="framerAppearId",xR="data-"+i1(QL),{schedule:r1}=pR(queueMicrotask,!1),vR=q.createContext({});function JL(n,e,t,i,r){var s,o;const{visualElement:l}=q.useContext(Bm),u=q.useContext(mR),h=q.useContext(Um),f=q.useContext(Qv).reducedMotion,m=q.useRef(null);i=i||u.renderer,!m.current&&i&&(m.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const _=m.current,v=q.useContext(vR);_&&!_.projection&&r&&(_.type==="html"||_.type==="svg")&&eO(m.current,t,r,v);const S=q.useRef(!1);q.useInsertionEffect(()=>{_&&S.current&&_.update(t,h)});const I=t[xR],T=q.useRef(!!I&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,I))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,I)));return fR(()=>{_&&(S.current=!0,window.MotionIsMounted=!0,_.updateFeatures(),r1.render(_.render),T.current&&_.animationState&&_.animationState.animateChanges())}),q.useEffect(()=>{_&&(!T.current&&_.animationState&&_.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{var R;(R=window.MotionHandoffMarkAsComplete)===null||R===void 0||R.call(window,I)}),T.current=!1))}),_}function eO(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:wR(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&qc(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function wR(n){if(n)return n.options.allowProjection!==!1?n.projection:wR(n.parent)}function tO({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&WL(n);function l(h,f){let m;const _={...q.useContext(Qv),...h,layoutId:nO(h)},{isStatic:v}=_,S=XL(h),I=i(h,v);if(!v&&Jv){iO();const T=rO(_);m=T.MeasureLayout,S.visualElement=JL(r,I,_,e,T.ProjectionNode)}return g.jsxs(Bm.Provider,{value:S,children:[m&&S.visualElement?g.jsx(m,{visualElement:S.visualElement,..._}):null,t(r,h,ZL(I,S.visualElement,f),I,v,S.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=q.forwardRef(l);return u[YL]=r,u}function nO({layoutId:n}){const e=q.useContext(Yv).id;return e&&n!==void 0?e+"-"+n:n}function iO(n,e){q.useContext(mR).strict}function rO(n){const{drag:e,layout:t}=hu;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const sO=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function s1(n){return typeof n!="string"||n.includes("-")?!1:!!(sO.indexOf(n)>-1||/[A-Z]/u.test(n))}function AS(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function o1(n,e,t,i){if(typeof e=="function"){const[r,s]=AS(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=AS(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const Ax=n=>Array.isArray(n),oO=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),aO=n=>Ax(n)?n[n.length-1]||0:n,Fn=n=>!!(n&&n.getVelocity);function vp(n){const e=Fn(n)?n.get():n;return oO(e)?e.toValue():e}function lO({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:cO(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const ER=n=>(e,t)=>{const i=q.useContext(Bm),r=q.useContext(Um),s=()=>lO(n,e,i,r);return t?s():Zv(s)};function cO(n,e,t,i){const r={},s=i(n,{});for(const _ in s)r[_]=vp(s[_]);let{initial:o,animate:l}=n;const u=Gm(n),h=_R(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const m=f?l:o;if(m&&typeof m!="boolean"&&!Wm(m)){const _=Array.isArray(m)?m:[m];for(let v=0;v<_.length;v++){const S=o1(n,_[v]);if(S){const{transitionEnd:I,transition:T,...R}=S;for(const M in R){let N=R[M];if(Array.isArray(N)){const L=f?N.length-1:0;N=N[L]}N!==null&&(r[M]=N)}for(const M in I)r[M]=I[M]}}}return r}const Fu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Fl=new Set(Fu),TR=n=>e=>typeof e=="string"&&e.startsWith(n),SR=TR("--"),uO=TR("var(--"),a1=n=>uO(n)?hO.test(n.split("/*")[0].trim()):!1,hO=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,IR=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Js=(n,e,t)=>t>e?e:t<n?n:t,Vu={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},bd={...Vu,transform:n=>Js(0,1,n)},qg={...Vu,default:1},uf=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Uo=uf("deg"),us=uf("%"),Le=uf("px"),dO=uf("vh"),fO=uf("vw"),PS={...us,parse:n=>us.parse(n)/100,transform:n=>us.transform(n*100)},gO={borderWidth:Le,borderTopWidth:Le,borderRightWidth:Le,borderBottomWidth:Le,borderLeftWidth:Le,borderRadius:Le,radius:Le,borderTopLeftRadius:Le,borderTopRightRadius:Le,borderBottomRightRadius:Le,borderBottomLeftRadius:Le,width:Le,maxWidth:Le,height:Le,maxHeight:Le,top:Le,right:Le,bottom:Le,left:Le,padding:Le,paddingTop:Le,paddingRight:Le,paddingBottom:Le,paddingLeft:Le,margin:Le,marginTop:Le,marginRight:Le,marginBottom:Le,marginLeft:Le,backgroundPositionX:Le,backgroundPositionY:Le},pO={rotate:Uo,rotateX:Uo,rotateY:Uo,rotateZ:Uo,scale:qg,scaleX:qg,scaleY:qg,scaleZ:qg,skew:Uo,skewX:Uo,skewY:Uo,distance:Le,translateX:Le,translateY:Le,translateZ:Le,x:Le,y:Le,z:Le,perspective:Le,transformPerspective:Le,opacity:bd,originX:PS,originY:PS,originZ:Le},kS={...Vu,transform:Math.round},l1={...gO,...pO,zIndex:kS,size:Le,fillOpacity:bd,strokeOpacity:bd,numOctaves:kS},mO={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},yO=Fu.length;function _O(n,e,t){let i="",r=!0;for(let s=0;s<yO;s++){const o=Fu[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=IR(l,l1[o]);if(!u){r=!1;const f=mO[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function c1(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const u in e){const h=e[u];if(Fl.has(u)){o=!0;continue}else if(SR(u)){r[u]=h;continue}else{const f=IR(h,l1[u]);u.startsWith("origin")?(l=!0,s[u]=f):i[u]=f}}if(e.transform||(o||t?i.transform=_O(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${u} ${h} ${f}`}}const xO={offset:"stroke-dashoffset",array:"stroke-dasharray"},vO={offset:"strokeDashoffset",array:"strokeDasharray"};function wO(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?xO:vO;n[s.offset]=Le.transform(-i);const o=Le.transform(e),l=Le.transform(t);n[s.array]=`${o} ${l}`}function NS(n,e,t){return typeof n=="string"?n:Le.transform(e+t*n)}function EO(n,e,t){const i=NS(e,n.x,n.width),r=NS(t,n.y,n.height);return`${i} ${r}`}function u1(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...h},f,m){if(c1(n,h,m),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:_,style:v,dimensions:S}=n;_.transform&&(S&&(v.transform=_.transform),delete _.transform),S&&(r!==void 0||s!==void 0||v.transform)&&(v.transformOrigin=EO(S,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(_.x=e),t!==void 0&&(_.y=t),i!==void 0&&(_.scale=i),o!==void 0&&wO(_,o,l,u,!1)}const h1=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),bR=()=>({...h1(),attrs:{}}),d1=n=>typeof n=="string"&&n.toLowerCase()==="svg";function CR(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const RR=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function AR(n,e,t,i){CR(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(RR.has(r)?r:i1(r),e.attrs[r])}const zp={};function TO(n){Object.assign(zp,n)}function PR(n,{layout:e,layoutId:t}){return Fl.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!zp[n]||n==="opacity")}function f1(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(Fn(r[o])||e.style&&Fn(e.style[o])||PR(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function kR(n,e,t){const i=f1(n,e,t);for(const r in n)if(Fn(n[r])||Fn(e[r])){const s=Fu.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function SO(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const DS=["x","y","width","height","cx","cy","r"],IO={useVisualState:ER({scrapeMotionValuesFromProps:kR,createRenderState:bR,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(Fl.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<DS.length;l++){const u=DS[l];n[u]!==e[u]&&(o=!0)}o&&St.read(()=>{SO(t,i),St.render(()=>{u1(i,r,d1(t.tagName),n.transformTemplate),AR(t,i)})})}})},bO={useVisualState:ER({scrapeMotionValuesFromProps:f1,createRenderState:h1})};function NR(n,e,t){for(const i in e)!Fn(e[i])&&!PR(i,t)&&(n[i]=e[i])}function CO({transformTemplate:n},e){return q.useMemo(()=>{const t=h1();return c1(t,e,n),Object.assign({},t.vars,t.style)},[e])}function RO(n,e){const t=n.style||{},i={};return NR(i,t,n),Object.assign(i,CO(n,e)),i}function AO(n,e){const t={},i=RO(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function PO(n,e,t,i){const r=q.useMemo(()=>{const s=bR();return u1(s,e,d1(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};NR(s,n.style,n),r.style={...s,...r.style}}return r}function kO(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(s1(t)?PO:AO)(i,s,o,t),h=HL(i,typeof t=="string",n),f=t!==q.Fragment?{...h,...u,ref:r}:{},{children:m}=i,_=q.useMemo(()=>Fn(m)?m.get():m,[m]);return q.createElement(t,{...f,children:_})}}function NO(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...s1(i)?IO:bO,preloadedFeatures:n,useRender:kO(r),createVisualElement:e,Component:i};return tO(o)}}function DR(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function $m(n,e,t){const i=n.getProps();return o1(i,e,t!==void 0?t:i.custom,n)}const DO=e1(()=>window.ScrollTimeline!==void 0);class MO{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(DO()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class LO extends MO{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function g1(n,e){return n?n[e]||n.default||n:void 0}const Px=2e4;function MR(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<Px;)e+=t,i=n.next(e);return e>=Px?1/0:e}function p1(n){return typeof n=="function"}function MS(n,e){n.timeline=e,n.onfinish=null}const m1=n=>Array.isArray(n)&&typeof n[0]=="number",OO={linearEasing:void 0};function jO(n,e){const t=e1(n);return()=>{var i;return(i=OO[e])!==null&&i!==void 0?i:t()}}const Up=jO(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),LR=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(uu(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function OR(n){return!!(typeof n=="function"&&Up()||!n||typeof n=="string"&&(n in kx||Up())||m1(n)||Array.isArray(n)&&n.every(OR))}const qh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,kx={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:qh([0,.65,.55,1]),circOut:qh([.55,0,1,.45]),backIn:qh([.31,.01,.66,-.59]),backOut:qh([.33,1.53,.69,.99])};function jR(n,e){if(n)return typeof n=="function"&&Up()?LR(n,e):m1(n)?qh(n):Array.isArray(n)?n.map(t=>jR(t,e)||kx.easeOut):kx[n]}const yr={x:!1,y:!1};function FR(){return yr.x||yr.y}function FO(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function VR(n,e){const t=FO(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function LS(n){return e=>{e.pointerType==="touch"||FR()||n(e)}}function VO(n,e,t={}){const[i,r,s]=VR(n,t),o=LS(l=>{const{target:u}=l,h=e(l);if(typeof h!="function"||!u)return;const f=LS(m=>{h(m),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const zR=(n,e)=>e?n===e?!0:zR(n,e.parentElement):!1,y1=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,zO=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function UO(n){return zO.has(n.tagName)||n.tabIndex!==-1}const Xh=new WeakSet;function OS(n){return e=>{e.key==="Enter"&&n(e)}}function x_(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const BO=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=OS(()=>{if(Xh.has(t))return;x_(t,"down");const r=OS(()=>{x_(t,"up")}),s=()=>x_(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function jS(n){return y1(n)&&!FR()}function WO(n,e,t={}){const[i,r,s]=VR(n,t),o=l=>{const u=l.currentTarget;if(!jS(l)||Xh.has(u))return;Xh.add(u);const h=e(l),f=(v,S)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",_),!(!jS(v)||!Xh.has(u))&&(Xh.delete(u),typeof h=="function"&&h(v,{success:S}))},m=v=>{f(v,t.useGlobalTarget||zR(u,v.target))},_=v=>{f(v,!1)};window.addEventListener("pointerup",m,r),window.addEventListener("pointercancel",_,r)};return i.forEach(l=>{!UO(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>BO(h,r),r)}),s}function GO(n){return n==="x"||n==="y"?yr[n]?null:(yr[n]=!0,()=>{yr[n]=!1}):yr.x||yr.y?null:(yr.x=yr.y=!0,()=>{yr.x=yr.y=!1})}const UR=new Set(["width","height","top","left","right","bottom",...Fu]);let wp;function $O(){wp=void 0}const hs={now:()=>(wp===void 0&&hs.set(En.isProcessing||zL.useManualTiming?En.timestamp:performance.now()),wp),set:n=>{wp=n,queueMicrotask($O)}};function _1(n,e){n.indexOf(e)===-1&&n.push(e)}function x1(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class v1{constructor(){this.subscriptions=[]}add(e){return _1(this.subscriptions,e),()=>x1(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function BR(n,e){return e?n*(1e3/e):0}const FS=30,HO=n=>!isNaN(parseFloat(n));class KO{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=hs.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=hs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=HO(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new v1);const i=this.events[e].add(t);return e==="change"?()=>{i(),St.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=hs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>FS)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,FS);return BR(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Cd(n,e){return new KO(n,e)}function qO(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Cd(t))}function XO(n,e){const t=$m(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=aO(s[o]);qO(n,o,l)}}function YO(n){return!!(Fn(n)&&n.add)}function Nx(n,e){const t=n.getValue("willChange");if(YO(t))return t.add(e)}function WR(n){return n.props[xR]}const GR=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,ZO=1e-7,QO=12;function JO(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=GR(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>ZO&&++l<QO);return o}function hf(n,e,t,i){if(n===e&&t===i)return Ai;const r=s=>JO(s,0,1,n,t);return s=>s===0||s===1?s:GR(r(s),e,i)}const $R=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,HR=n=>e=>1-n(1-e),KR=hf(.33,1.53,.69,.99),w1=HR(KR),qR=$R(w1),XR=n=>(n*=2)<1?.5*w1(n):.5*(2-Math.pow(2,-10*(n-1))),E1=n=>1-Math.sin(Math.acos(n)),YR=HR(E1),ZR=$R(E1),QR=n=>/^0[^.\s]+$/u.test(n);function ej(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||QR(n):!0}const ad=n=>Math.round(n*1e5)/1e5,T1=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function tj(n){return n==null}const nj=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,S1=(n,e)=>t=>!!(typeof t=="string"&&nj.test(t)&&t.startsWith(n)||e&&!tj(t)&&Object.prototype.hasOwnProperty.call(t,e)),JR=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(T1);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},ij=n=>Js(0,255,n),v_={...Vu,transform:n=>Math.round(ij(n))},sl={test:S1("rgb","red"),parse:JR("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+v_.transform(n)+", "+v_.transform(e)+", "+v_.transform(t)+", "+ad(bd.transform(i))+")"};function rj(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const Dx={test:S1("#"),parse:rj,transform:sl.transform},Xc={test:S1("hsl","hue"),parse:JR("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+us.transform(ad(e))+", "+us.transform(ad(t))+", "+ad(bd.transform(i))+")"},On={test:n=>sl.test(n)||Dx.test(n)||Xc.test(n),parse:n=>sl.test(n)?sl.parse(n):Xc.test(n)?Xc.parse(n):Dx.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?sl.transform(n):Xc.transform(n)},sj=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function oj(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(T1))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(sj))===null||t===void 0?void 0:t.length)||0)>0}const eA="number",tA="color",aj="var",lj="var(",VS="${}",cj=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Rd(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(cj,u=>(On.test(u)?(i.color.push(s),r.push(tA),t.push(On.parse(u))):u.startsWith(lj)?(i.var.push(s),r.push(aj),t.push(u)):(i.number.push(s),r.push(eA),t.push(parseFloat(u))),++s,VS)).split(VS);return{values:t,split:l,indexes:i,types:r}}function nA(n){return Rd(n).values}function iA(n){const{split:e,types:t}=Rd(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===eA?s+=ad(r[o]):l===tA?s+=On.transform(r[o]):s+=r[o]}return s}}const uj=n=>typeof n=="number"?0:n;function hj(n){const e=nA(n);return iA(n)(e.map(uj))}const sa={test:oj,parse:nA,createTransformer:iA,getAnimatableNone:hj},dj=new Set(["brightness","contrast","saturate","opacity"]);function fj(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(T1)||[];if(!i)return n;const r=t.replace(i,"");let s=dj.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const gj=/\b([a-z-]*)\(.*?\)/gu,Mx={...sa,getAnimatableNone:n=>{const e=n.match(gj);return e?e.map(fj).join(" "):n}},pj={...l1,color:On,backgroundColor:On,outlineColor:On,fill:On,stroke:On,borderColor:On,borderTopColor:On,borderRightColor:On,borderBottomColor:On,borderLeftColor:On,filter:Mx,WebkitFilter:Mx},I1=n=>pj[n];function rA(n,e){let t=I1(n);return t!==Mx&&(t=sa),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const mj=new Set(["auto","none","0"]);function yj(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!mj.has(s)&&Rd(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=rA(t,r)}const zS=n=>n===Vu||n===Le,US=(n,e)=>parseFloat(n.split(", ")[e]),BS=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return US(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?US(s[1],n):0}},_j=new Set(["x","y","z"]),xj=Fu.filter(n=>!_j.has(n));function vj(n){const e=[];return xj.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const du={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:BS(4,13),y:BS(5,14)};du.translateX=du.x;du.translateY=du.y;const fl=new Set;let Lx=!1,Ox=!1;function sA(){if(Ox){const n=Array.from(fl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=vj(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}Ox=!1,Lx=!1,fl.forEach(n=>n.complete()),fl.clear()}function oA(){fl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(Ox=!0)})}function wj(){oA(),sA()}class b1{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(fl.add(this),Lx||(Lx=!0,St.read(oA),St.resolveKeyframes(sA))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),fl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,fl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const aA=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),Ej=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Tj(n){const e=Ej.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function lA(n,e,t=1){const[i,r]=Tj(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return aA(o)?parseFloat(o):o}return a1(r)?lA(r,e,t+1):r}const cA=n=>e=>e.test(n),Sj={test:n=>n==="auto",parse:n=>n},uA=[Vu,Le,us,Uo,fO,dO,Sj],WS=n=>uA.find(cA(n));class hA extends b1{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),a1(h))){const f=lA(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!UR.has(i)||e.length!==2)return;const[r,s]=e,o=WS(r),l=WS(s);if(o!==l)if(zS(o)&&zS(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)ej(e[r])&&i.push(r);i.length&&yj(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=du[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=du[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const GS=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(sa.test(n)||n==="0")&&!n.startsWith("url("));function Ij(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function bj(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=GS(r,e),l=GS(s,e);return!o||!l?!1:Ij(n)||(t==="spring"||p1(t))&&i}const Cj=n=>n!==null;function Hm(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(Cj),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const Rj=40;class dA{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=hs.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Rj?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&wj(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=hs.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:u,isGenerator:h}=this.options;if(!h&&!bj(e,i,r,s))if(o)this.options.duration=0;else{u&&u(Hm(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Dt=(n,e,t)=>n+(e-n)*t;function w_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Aj({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;r=w_(u,l,n+1/3),s=w_(u,l,n),o=w_(u,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Bp(n,e){return t=>t>0?e:n}const E_=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},Pj=[Dx,sl,Xc],kj=n=>Pj.find(e=>e.test(n));function $S(n){const e=kj(n);if(!e)return!1;let t=e.parse(n);return e===Xc&&(t=Aj(t)),t}const HS=(n,e)=>{const t=$S(n),i=$S(e);if(!t||!i)return Bp(n,e);const r={...t};return s=>(r.red=E_(t.red,i.red,s),r.green=E_(t.green,i.green,s),r.blue=E_(t.blue,i.blue,s),r.alpha=Dt(t.alpha,i.alpha,s),sl.transform(r))},Nj=(n,e)=>t=>e(n(t)),df=(...n)=>n.reduce(Nj),jx=new Set(["none","hidden"]);function Dj(n,e){return jx.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function Mj(n,e){return t=>Dt(n,e,t)}function C1(n){return typeof n=="number"?Mj:typeof n=="string"?a1(n)?Bp:On.test(n)?HS:jj:Array.isArray(n)?fA:typeof n=="object"?On.test(n)?HS:Lj:Bp}function fA(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>C1(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function Lj(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=C1(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function Oj(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],u=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const jj=(n,e)=>{const t=sa.createTransformer(e),i=Rd(n),r=Rd(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?jx.has(n)&&!r.values.length||jx.has(e)&&!i.values.length?Dj(n,e):df(fA(Oj(i,r),r.values),t):Bp(n,e)};function gA(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Dt(n,e,t):C1(n)(n,e)}const Fj=5;function pA(n,e,t){const i=Math.max(e-Fj,0);return BR(t-n(i),e-i)}const Ot={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},T_=.001;function Vj({duration:n=Ot.duration,bounce:e=Ot.bounce,velocity:t=Ot.velocity,mass:i=Ot.mass}){let r,s,o=1-e;o=Js(Ot.minDamping,Ot.maxDamping,o),n=Js(Ot.minDuration,Ot.maxDuration,qs(n)),o<1?(r=h=>{const f=h*o,m=f*n,_=f-t,v=Fx(h,o),S=Math.exp(-m);return T_-_/v*S},s=h=>{const m=h*o*n,_=m*t+t,v=Math.pow(o,2)*Math.pow(h,2)*n,S=Math.exp(-m),I=Fx(Math.pow(h,2),o);return(-r(h)+T_>0?-1:1)*((_-v)*S)/I}):(r=h=>{const f=Math.exp(-h*n),m=(h-t)*n+1;return-T_+f*m},s=h=>{const f=Math.exp(-h*n),m=(t-h)*(n*n);return f*m});const l=5/n,u=Uj(r,s,l);if(n=Ks(n),isNaN(u))return{stiffness:Ot.stiffness,damping:Ot.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const zj=12;function Uj(n,e,t){let i=t;for(let r=1;r<zj;r++)i=i-n(i)/e(i);return i}function Fx(n,e){return n*Math.sqrt(1-e*e)}const Bj=["duration","bounce"],Wj=["stiffness","damping","mass"];function KS(n,e){return e.some(t=>n[t]!==void 0)}function Gj(n){let e={velocity:Ot.velocity,stiffness:Ot.stiffness,damping:Ot.damping,mass:Ot.mass,isResolvedFromDuration:!1,...n};if(!KS(n,Wj)&&KS(n,Bj))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Js(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Ot.mass,stiffness:r,damping:s}}else{const t=Vj(n);e={...e,...t,mass:Ot.mass},e.isResolvedFromDuration=!0}return e}function mA(n=Ot.visualDuration,e=Ot.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:m,velocity:_,isResolvedFromDuration:v}=Gj({...t,velocity:-qs(t.velocity||0)}),S=_||0,I=h/(2*Math.sqrt(u*f)),T=o-s,R=qs(Math.sqrt(u/f)),M=Math.abs(T)<5;i||(i=M?Ot.restSpeed.granular:Ot.restSpeed.default),r||(r=M?Ot.restDelta.granular:Ot.restDelta.default);let N;if(I<1){const A=Fx(R,I);N=z=>{const P=Math.exp(-I*R*z);return o-P*((S+I*R*T)/A*Math.sin(A*z)+T*Math.cos(A*z))}}else if(I===1)N=A=>o-Math.exp(-R*A)*(T+(S+R*T)*A);else{const A=R*Math.sqrt(I*I-1);N=z=>{const P=Math.exp(-I*R*z),b=Math.min(A*z,300);return o-P*((S+I*R*T)*Math.sinh(b)+A*T*Math.cosh(b))/A}}const L={calculatedDuration:v&&m||null,next:A=>{const z=N(A);if(v)l.done=A>=m;else{let P=0;I<1&&(P=A===0?Ks(S):pA(N,A,z));const b=Math.abs(P)<=i,k=Math.abs(o-z)<=r;l.done=b&&k}return l.value=l.done?o:z,l},toString:()=>{const A=Math.min(MR(L),Px),z=LR(P=>L.next(A*P).value,A,30);return A+"ms "+z}};return L}function qS({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:f}){const m=n[0],_={done:!1,value:m},v=b=>l!==void 0&&b<l||u!==void 0&&b>u,S=b=>l===void 0?u:u===void 0||Math.abs(l-b)<Math.abs(u-b)?l:u;let I=t*e;const T=m+I,R=o===void 0?T:o(T);R!==T&&(I=R-m);const M=b=>-I*Math.exp(-b/i),N=b=>R+M(b),L=b=>{const k=M(b),F=N(b);_.done=Math.abs(k)<=h,_.value=_.done?R:F};let A,z;const P=b=>{v(_.value)&&(A=b,z=mA({keyframes:[_.value,S(_.value)],velocity:pA(N,b,_.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return P(0),{calculatedDuration:null,next:b=>{let k=!1;return!z&&A===void 0&&(k=!0,L(b),P(b)),A!==void 0&&b>=A?z.next(b-A):(!k&&L(b),_)}}}const $j=hf(.42,0,1,1),Hj=hf(0,0,.58,1),yA=hf(.42,0,.58,1),Kj=n=>Array.isArray(n)&&typeof n[0]!="number",qj={linear:Ai,easeIn:$j,easeInOut:yA,easeOut:Hj,circIn:E1,circInOut:ZR,circOut:YR,backIn:w1,backInOut:qR,backOut:KR,anticipate:XR},XS=n=>{if(m1(n)){gR(n.length===4);const[e,t,i,r]=n;return hf(e,t,i,r)}else if(typeof n=="string")return qj[n];return n};function Xj(n,e,t){const i=[],r=t||gA,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ai:e;l=df(u,l)}i.push(l)}return i}function Yj(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(gR(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=Xj(e,i,r),u=l.length,h=f=>{if(o&&f<n[0])return e[0];let m=0;if(u>1)for(;m<n.length-2&&!(f<n[m+1]);m++);const _=uu(n[m],n[m+1],f);return l[m](_)};return t?f=>h(Js(n[0],n[s-1],f)):h}function Zj(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=uu(0,e,i);n.push(Dt(t,1,r))}}function Qj(n){const e=[0];return Zj(e,n.length-1),e}function Jj(n,e){return n.map(t=>t*e)}function e5(n,e){return n.map(()=>e||yA).splice(0,n.length-1)}function Wp({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=Kj(i)?i.map(XS):XS(i),s={done:!1,value:e[0]},o=Jj(t&&t.length===e.length?t:Qj(e),n),l=Yj(o,e,{ease:Array.isArray(r)?r:e5(e,r)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const t5=n=>{const e=({timestamp:t})=>n(t);return{start:()=>St.update(e,!0),stop:()=>ra(e),now:()=>En.isProcessing?En.timestamp:hs.now()}},n5={decay:qS,inertia:qS,tween:Wp,keyframes:Wp,spring:mA},i5=n=>n/100;class R1 extends dA{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||b1,l=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=p1(t)?t:n5[t]||Wp;let u,h;l!==Wp&&typeof e[0]!="number"&&(u=df(i5,gA(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=MR(f));const{calculatedDuration:m}=f,_=m+r,v=_*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:m,resolvedDuration:_,totalDuration:v}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:b}=this.options;return{done:!0,value:b[b.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:m}=i;if(this.startTime===null)return s.next(0);const{delay:_,repeat:v,repeatType:S,repeatDelay:I,onUpdate:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const R=this.currentTime-_*(this.speed>=0?1:-1),M=this.speed>=0?R<0:R>f;this.currentTime=Math.max(R,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let N=this.currentTime,L=s;if(v){const b=Math.min(this.currentTime,f)/m;let k=Math.floor(b),F=b%1;!F&&b>=1&&(F=1),F===1&&k--,k=Math.min(k,v+1),k%2&&(S==="reverse"?(F=1-F,I&&(F-=I/m)):S==="mirror"&&(L=o)),N=Js(0,1,F)*m}const A=M?{done:!1,value:u[0]}:L.next(N);l&&(A.value=l(A.value));let{done:z}=A;!M&&h!==null&&(z=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&z);return P&&r!==void 0&&(A.value=Hm(u,this.options,r)),T&&T(A.value),P&&this.finish(),A}get duration(){const{resolved:e}=this;return e?qs(e.calculatedDuration):0}get time(){return qs(this.currentTime)}set time(e){e=Ks(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=qs(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=t5,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const r5=new Set(["opacity","clipPath","filter","transform"]);function s5(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=jR(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const o5=e1(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Gp=10,a5=2e4;function l5(n){return p1(n.type)||n.type==="spring"||!OR(n.ease)}function c5(n,e){const t=new R1({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<a5;)i=t.sample(s),r.push(i.value),s+=Gp;return{times:void 0,keyframes:r,duration:s-Gp,ease:"linear"}}const _A={anticipate:XR,backInOut:qR,circInOut:ZR};function u5(n){return n in _A}class YS extends dA{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new hA(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:u,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&Up()&&u5(s)&&(s=_A[s]),l5(this.options)){const{onComplete:m,onUpdate:_,motionValue:v,element:S,...I}=this.options,T=c5(e,I);e=T.keyframes,e.length===1&&(e[1]=e[0]),i=T.duration,r=T.times,s=T.ease,o="keyframes"}const f=s5(l.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(MS(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:m}=this.options;l.set(Hm(e,this.options,t)),m&&m(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return qs(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return qs(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=Ks(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Ai;const{animation:i}=t;MS(i,e)}return Ai}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:m,element:_,...v}=this.options,S=new R1({...v,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),I=Ks(this.time);h.setWithVelocity(S.sample(I-Gp).value,S.sample(I).value,Gp)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return o5()&&i&&r5.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const h5={type:"spring",stiffness:500,damping:25,restSpeed:10},d5=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),f5={type:"keyframes",duration:.8},g5={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},p5=(n,{keyframes:e})=>e.length>2?f5:Fl.has(n)?n.startsWith("scale")?d5(e[1]):h5:g5;function m5({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const A1=(n,e,t,i={},r,s)=>o=>{const l=g1(i,n)||{},u=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-Ks(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:_=>{e.set(_),l.onUpdate&&l.onUpdate(_)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};m5(l)||(f={...f,...p5(n,f)}),f.duration&&(f.duration=Ks(f.duration)),f.repeatDelay&&(f.repeatDelay=Ks(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let m=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(m=!0)),m&&!s&&e.get()!==void 0){const _=Hm(f.keyframes,l);if(_!==void 0)return St.update(()=>{f.onUpdate(_),f.onComplete()}),new LO([])}return!s&&YS.supports(f)?new YS(f):new R1(f)};function y5({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function xA(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...u}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const m in u){const _=n.getValue(m,(s=n.latestValues[m])!==null&&s!==void 0?s:null),v=u[m];if(v===void 0||f&&y5(f,m))continue;const S={delay:t,...g1(o||{},m)};let I=!1;if(window.MotionHandoffAnimation){const R=WR(n);if(R){const M=window.MotionHandoffAnimation(R,m,St);M!==null&&(S.startTime=M,I=!0)}}Nx(n,m),_.start(A1(m,_,v,n.shouldReduceMotion&&UR.has(m)?{type:!1}:S,n,I));const T=_.animation;T&&h.push(T)}return l&&Promise.all(h).then(()=>{St.update(()=>{l&&XO(n,l)})}),h}function Vx(n,e,t={}){var i;const r=$m(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(xA(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:m,staggerDirection:_}=s;return _5(n,e,f+h,m,_,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function _5(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(x5).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(Vx(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function x5(n,e){return n.sortNodePosition(e)}function v5(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>Vx(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=Vx(n,e,t);else{const r=typeof e=="function"?$m(n,e,t.custom):e;i=Promise.all(xA(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const w5=n1.length;function vA(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?vA(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<w5;t++){const i=n1[t],r=n.props[i];(Id(r)||r===!1)&&(e[i]=r)}return e}const E5=[...t1].reverse(),T5=t1.length;function S5(n){return e=>Promise.all(e.map(({animation:t,options:i})=>v5(n,t,i)))}function I5(n){let e=S5(n),t=ZS(),i=!0;const r=u=>(h,f)=>{var m;const _=$m(n,f,u==="exit"?(m=n.presenceContext)===null||m===void 0?void 0:m.custom:void 0);if(_){const{transition:v,transitionEnd:S,...I}=_;h={...h,...I,...S}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,f=vA(n.parent)||{},m=[],_=new Set;let v={},S=1/0;for(let T=0;T<T5;T++){const R=E5[T],M=t[R],N=h[R]!==void 0?h[R]:f[R],L=Id(N),A=R===u?M.isActive:null;A===!1&&(S=T);let z=N===f[R]&&N!==h[R]&&L;if(z&&i&&n.manuallyAnimateOnMount&&(z=!1),M.protectedKeys={...v},!M.isActive&&A===null||!N&&!M.prevProp||Wm(N)||typeof N=="boolean")continue;const P=b5(M.prevProp,N);let b=P||R===u&&M.isActive&&!z&&L||T>S&&L,k=!1;const F=Array.isArray(N)?N:[N];let V=F.reduce(r(R),{});A===!1&&(V={});const{prevResolvedValues:U={}}=M,O={...U,...V},se=re=>{b=!0,_.has(re)&&(k=!0,_.delete(re)),M.needsAnimating[re]=!0;const Y=n.getValue(re);Y&&(Y.liveStyle=!1)};for(const re in O){const Y=V[re],H=U[re];if(v.hasOwnProperty(re))continue;let X=!1;Ax(Y)&&Ax(H)?X=!DR(Y,H):X=Y!==H,X?Y!=null?se(re):_.add(re):Y!==void 0&&_.has(re)?se(re):M.protectedKeys[re]=!0}M.prevProp=N,M.prevResolvedValues=V,M.isActive&&(v={...v,...V}),i&&n.blockInitialAnimation&&(b=!1),b&&(!(z&&P)||k)&&m.push(...F.map(re=>({animation:re,options:{type:R}})))}if(_.size){const T={};_.forEach(R=>{const M=n.getBaseTarget(R),N=n.getValue(R);N&&(N.liveStyle=!0),T[R]=M??null}),m.push({animation:T})}let I=!!m.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(I=!1),i=!1,I?e(m):Promise.resolve()}function l(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(_=>{var v;return(v=_.animationState)===null||v===void 0?void 0:v.setActive(u,h)}),t[u].isActive=h;const m=o(u);for(const _ in t)t[_].protectedKeys={};return m}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=ZS(),i=!0}}}function b5(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!DR(e,n):!1}function Ba(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function ZS(){return{animate:Ba(!0),whileInView:Ba(),whileHover:Ba(),whileTap:Ba(),whileDrag:Ba(),whileFocus:Ba(),exit:Ba()}}let ga=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class C5 extends ga{constructor(e){super(e),e.animationState||(e.animationState=I5(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Wm(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let R5=0;class A5 extends ga{constructor(){super(...arguments),this.id=R5++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const P5={animation:{Feature:C5},exit:{Feature:A5}};function Ad(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function ff(n){return{point:{x:n.pageX,y:n.pageY}}}const k5=n=>e=>y1(e)&&n(e,ff(e));function ld(n,e,t,i){return Ad(n,e,k5(t),i)}const QS=(n,e)=>Math.abs(n-e);function N5(n,e){const t=QS(n.x,e.x),i=QS(n.y,e.y);return Math.sqrt(t**2+i**2)}class wA{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=I_(this.lastMoveEventInfo,this.history),_=this.startEvent!==null,v=N5(m.offset,{x:0,y:0})>=3;if(!_&&!v)return;const{point:S}=m,{timestamp:I}=En;this.history.push({...S,timestamp:I});const{onStart:T,onMove:R}=this.handlers;_||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),R&&R(this.lastMoveEvent,m)},this.handlePointerMove=(m,_)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=S_(_,this.transformPagePoint),St.update(this.updatePoint,!0)},this.handlePointerUp=(m,_)=>{this.end();const{onEnd:v,onSessionEnd:S,resumeAnimation:I}=this.handlers;if(this.dragSnapToOrigin&&I&&I(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=I_(m.type==="pointercancel"?this.lastMoveEventInfo:S_(_,this.transformPagePoint),this.history);this.startEvent&&v&&v(m,T),S&&S(m,T)},!y1(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=ff(e),l=S_(o,this.transformPagePoint),{point:u}=l,{timestamp:h}=En;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,I_(l,this.history)),this.removeListeners=df(ld(this.contextWindow,"pointermove",this.handlePointerMove),ld(this.contextWindow,"pointerup",this.handlePointerUp),ld(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ra(this.updatePoint)}}function S_(n,e){return e?{point:e(n.point)}:n}function JS(n,e){return{x:n.x-e.x,y:n.y-e.y}}function I_({point:n},e){return{point:n,delta:JS(n,EA(e)),offset:JS(n,D5(e)),velocity:M5(e,.1)}}function D5(n){return n[0]}function EA(n){return n[n.length-1]}function M5(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=EA(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>Ks(e)));)t--;if(!i)return{x:0,y:0};const s=qs(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const TA=1e-4,L5=1-TA,O5=1+TA,SA=.01,j5=0-SA,F5=0+SA;function Pi(n){return n.max-n.min}function V5(n,e,t){return Math.abs(n-e)<=t}function eI(n,e,t,i=.5){n.origin=i,n.originPoint=Dt(e.min,e.max,n.origin),n.scale=Pi(t)/Pi(e),n.translate=Dt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=L5&&n.scale<=O5||isNaN(n.scale))&&(n.scale=1),(n.translate>=j5&&n.translate<=F5||isNaN(n.translate))&&(n.translate=0)}function cd(n,e,t,i){eI(n.x,e.x,t.x,i?i.originX:void 0),eI(n.y,e.y,t.y,i?i.originY:void 0)}function tI(n,e,t){n.min=t.min+e.min,n.max=n.min+Pi(e)}function z5(n,e,t){tI(n.x,e.x,t.x),tI(n.y,e.y,t.y)}function nI(n,e,t){n.min=e.min-t.min,n.max=n.min+Pi(e)}function ud(n,e,t){nI(n.x,e.x,t.x),nI(n.y,e.y,t.y)}function U5(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?Dt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?Dt(t,n,i.max):Math.min(n,t)),n}function iI(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function B5(n,{top:e,left:t,bottom:i,right:r}){return{x:iI(n.x,t,r),y:iI(n.y,e,i)}}function rI(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function W5(n,e){return{x:rI(n.x,e.x),y:rI(n.y,e.y)}}function G5(n,e){let t=.5;const i=Pi(n),r=Pi(e);return r>i?t=uu(e.min,e.max-i,n.min):i>r&&(t=uu(n.min,n.max-r,e.min)),Js(0,1,t)}function $5(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const zx=.35;function H5(n=zx){return n===!1?n=0:n===!0&&(n=zx),{x:sI(n,"left","right"),y:sI(n,"top","bottom")}}function sI(n,e,t){return{min:oI(n,e),max:oI(n,t)}}function oI(n,e){return typeof n=="number"?n:n[e]||0}const aI=()=>({translate:0,scale:1,origin:0,originPoint:0}),Yc=()=>({x:aI(),y:aI()}),lI=()=>({min:0,max:0}),Ut=()=>({x:lI(),y:lI()});function Yi(n){return[n("x"),n("y")]}function IA({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function K5({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function q5(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function b_(n){return n===void 0||n===1}function Ux({scale:n,scaleX:e,scaleY:t}){return!b_(n)||!b_(e)||!b_(t)}function Ka(n){return Ux(n)||bA(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function bA(n){return cI(n.x)||cI(n.y)}function cI(n){return n&&n!=="0%"}function $p(n,e,t){const i=n-t,r=e*i;return t+r}function uI(n,e,t,i,r){return r!==void 0&&(n=$p(n,r,i)),$p(n,t,i)+e}function Bx(n,e=0,t=1,i,r){n.min=uI(n.min,e,t,i,r),n.max=uI(n.max,e,t,i,r)}function CA(n,{x:e,y:t}){Bx(n.x,e.translate,e.scale,e.originPoint),Bx(n.y,t.translate,t.scale,t.originPoint)}const hI=.999999999999,dI=1.0000000000001;function X5(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Qc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,CA(n,o)),i&&Ka(s.latestValues)&&Qc(n,s.latestValues))}e.x<dI&&e.x>hI&&(e.x=1),e.y<dI&&e.y>hI&&(e.y=1)}function Zc(n,e){n.min=n.min+e,n.max=n.max+e}function fI(n,e,t,i,r=.5){const s=Dt(n.min,n.max,r);Bx(n,e,t,s,i)}function Qc(n,e){fI(n.x,e.x,e.scaleX,e.scale,e.originX),fI(n.y,e.y,e.scaleY,e.scale,e.originY)}function RA(n,e){return IA(q5(n.getBoundingClientRect(),e))}function Y5(n,e,t){const i=RA(n,t),{scroll:r}=e;return r&&(Zc(i.x,r.offset.x),Zc(i.y,r.offset.y)),i}const AA=({current:n})=>n?n.ownerDocument.defaultView:null,Z5=new WeakMap;class Q5{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(ff(f).point)},s=(f,m)=>{const{drag:_,dragPropagation:v,onDragStart:S}=this.getProps();if(_&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=GO(_),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Yi(T=>{let R=this.getAxisMotionValue(T).get()||0;if(us.test(R)){const{projection:M}=this.visualElement;if(M&&M.layout){const N=M.layout.layoutBox[T];N&&(R=Pi(N)*(parseFloat(R)/100))}}this.originPoint[T]=R}),S&&St.postRender(()=>S(f,m)),Nx(this.visualElement,"transform");const{animationState:I}=this.visualElement;I&&I.setActive("whileDrag",!0)},o=(f,m)=>{const{dragPropagation:_,dragDirectionLock:v,onDirectionLock:S,onDrag:I}=this.getProps();if(!_&&!this.openDragLock)return;const{offset:T}=m;if(v&&this.currentDirection===null){this.currentDirection=J5(T),this.currentDirection!==null&&S&&S(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),I&&I(f,m)},l=(f,m)=>this.stop(f,m),u=()=>Yi(f=>{var m;return this.getAnimationState(f)==="paused"&&((m=this.getAxisMotionValue(f).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new wA(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:AA(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&St.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Xg(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=U5(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&qc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=B5(r.layoutBox,t):this.constraints=!1,this.elastic=H5(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Yi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=$5(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!qc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=Y5(i,r.root,this.visualElement.getTransformPagePoint());let o=W5(r.layout.layoutBox,s);if(t){const l=t(K5(o));this.hasMutatedConstraints=!!l,l&&(o=IA(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=Yi(f=>{if(!Xg(f,t,this.currentDirection))return;let m=u&&u[f]||{};o&&(m={min:0,max:0});const _=r?200:1e6,v=r?40:1e7,S={type:"inertia",velocity:i?e[f]:0,bounceStiffness:_,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...s,...m};return this.startAxisValueAnimation(f,S)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return Nx(this.visualElement,e),i.start(A1(e,i,0,t,this.visualElement,!1))}stopAnimation(){Yi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Yi(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Yi(t=>{const{drag:i}=this.getProps();if(!Xg(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-Dt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!qc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Yi(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();r[o]=G5({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Yi(o=>{if(!Xg(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(Dt(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;Z5.set(this.visualElement,this);const e=this.visualElement.current,t=ld(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();qc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),St.read(i);const o=Ad(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(Yi(f=>{const m=this.getAxisMotionValue(f);m&&(this.originPoint[f]+=u[f].translate,m.set(m.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=zx,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function Xg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function J5(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class eF extends ga{constructor(e){super(e),this.removeGroupControls=Ai,this.removeListeners=Ai,this.controls=new Q5(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ai}unmount(){this.removeGroupControls(),this.removeListeners()}}const gI=n=>(e,t)=>{n&&St.postRender(()=>n(e,t))};class tF extends ga{constructor(){super(...arguments),this.removePointerDownListener=Ai}onPointerDown(e){this.session=new wA(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:AA(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:gI(e),onStart:gI(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&St.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=ld(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ep={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pI(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Mh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Le.test(n))n=parseFloat(n);else return n;const t=pI(n,e.target.x),i=pI(n,e.target.y);return`${t}% ${i}%`}},nF={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=sa.parse(n);if(r.length>5)return i;const s=sa.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=u;const h=Dt(l,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class iF extends q.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;TO(rF),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Ep.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||St.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),r1.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function PA(n){const[e,t]=dR(),i=q.useContext(Yv);return g.jsx(iF,{...n,layoutGroup:i,switchLayoutGroup:q.useContext(vR),isPresent:e,safeToRemove:t})}const rF={borderRadius:{...Mh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Mh,borderTopRightRadius:Mh,borderBottomLeftRadius:Mh,borderBottomRightRadius:Mh,boxShadow:nF};function sF(n,e,t){const i=Fn(n)?n:Cd(n);return i.start(A1("",i,e,t)),i.animation}function oF(n){return n instanceof SVGElement&&n.tagName!=="svg"}const aF=(n,e)=>n.depth-e.depth;class lF{constructor(){this.children=[],this.isDirty=!1}add(e){_1(this.children,e),this.isDirty=!0}remove(e){x1(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(aF),this.isDirty=!1,this.children.forEach(e)}}function cF(n,e){const t=hs.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(ra(i),n(s-e))};return St.read(i,!0),()=>ra(i)}const kA=["TopLeft","TopRight","BottomLeft","BottomRight"],uF=kA.length,mI=n=>typeof n=="string"?parseFloat(n):n,yI=n=>typeof n=="number"||Le.test(n);function hF(n,e,t,i,r,s){r?(n.opacity=Dt(0,t.opacity!==void 0?t.opacity:1,dF(i)),n.opacityExit=Dt(e.opacity!==void 0?e.opacity:1,0,fF(i))):s&&(n.opacity=Dt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<uF;o++){const l=`border${kA[o]}Radius`;let u=_I(e,l),h=_I(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||yI(u)===yI(h)?(n[l]=Math.max(Dt(mI(u),mI(h),i),0),(us.test(h)||us.test(u))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=Dt(e.rotate||0,t.rotate||0,i))}function _I(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const dF=NA(0,.5,YR),fF=NA(.5,.95,Ai);function NA(n,e,t){return i=>i<n?0:i>e?1:t(uu(n,e,i))}function xI(n,e){n.min=e.min,n.max=e.max}function qi(n,e){xI(n.x,e.x),xI(n.y,e.y)}function vI(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function wI(n,e,t,i,r){return n-=e,n=$p(n,1/t,i),r!==void 0&&(n=$p(n,1/r,i)),n}function gF(n,e=0,t=1,i=.5,r,s=n,o=n){if(us.test(e)&&(e=parseFloat(e),e=Dt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=Dt(s.min,s.max,i);n===s&&(l-=e),n.min=wI(n.min,e,t,l,r),n.max=wI(n.max,e,t,l,r)}function EI(n,e,[t,i,r],s,o){gF(n,e[t],e[i],e[r],e.scale,s,o)}const pF=["x","scaleX","originX"],mF=["y","scaleY","originY"];function TI(n,e,t,i){EI(n.x,e,pF,t?t.x:void 0,i?i.x:void 0),EI(n.y,e,mF,t?t.y:void 0,i?i.y:void 0)}function SI(n){return n.translate===0&&n.scale===1}function DA(n){return SI(n.x)&&SI(n.y)}function II(n,e){return n.min===e.min&&n.max===e.max}function yF(n,e){return II(n.x,e.x)&&II(n.y,e.y)}function bI(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function MA(n,e){return bI(n.x,e.x)&&bI(n.y,e.y)}function CI(n){return Pi(n.x)/Pi(n.y)}function RI(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class _F{constructor(){this.members=[]}add(e){_1(this.members,e),e.scheduleRender()}remove(e){if(x1(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function xF(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:m,rotateY:_,skewX:v,skewY:S}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),m&&(i+=`rotateX(${m}deg) `),_&&(i+=`rotateY(${_}deg) `),v&&(i+=`skewX(${v}deg) `),S&&(i+=`skewY(${S}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(i+=`scale(${l}, ${u})`),i||"none"}const qa={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Yh=typeof window<"u"&&window.MotionDebug!==void 0,C_=["","X","Y","Z"],vF={visibility:"hidden"},AI=1e3;let wF=0;function R_(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function LA(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=WR(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",St,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&LA(i)}function OA({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=wF++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Yh&&(qa.totalNodes=qa.resolvedTargetDeltas=qa.recalculatedProjection=0),this.nodes.forEach(SF),this.nodes.forEach(AF),this.nodes.forEach(PF),this.nodes.forEach(IF),Yh&&window.MotionDebug.record(qa)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new lF)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new v1),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=oF(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||u)&&(this.isLayoutDirty=!0),n){let m;const _=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=cF(_,250),Ep.hasAnimatedSinceResize&&(Ep.hasAnimatedSinceResize=!1,this.nodes.forEach(kI))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:_,hasRelativeTargetChanged:v,layout:S})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||f.getDefaultTransition()||LF,{onLayoutAnimationStart:T,onLayoutAnimationComplete:R}=f.getProps(),M=!this.targetLayout||!MA(this.targetLayout,S)||v,N=!_&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||N||_&&(M||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,N);const L={...g1(I,"layout"),onPlay:T,onComplete:R};(f.shouldReduceMotion||this.options.layoutRoot)&&(L.delay=0,L.type=!1),this.startAnimation(L)}else _||kI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=S})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ra(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(kF),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&LA(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const m=this.path[f];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(PI);return}this.isUpdating||this.nodes.forEach(CF),this.isUpdating=!1,this.nodes.forEach(RF),this.nodes.forEach(EF),this.nodes.forEach(TF),this.clearAllSnapshots();const l=hs.now();En.delta=Js(0,1e3/60,l-En.timestamp),En.timestamp=l,En.isProcessing=!0,__.update.process(En),__.preRender.process(En),__.render.process(En),En.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,r1.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(bF),this.sharedNodes.forEach(NF)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,St.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){St.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!DA(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||Ka(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),OF(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(jF))){const{scroll:f}=this.root;f&&(Zc(u.x,f.offset.x),Zc(u.y,f.offset.y))}return u}removeElementScroll(o){var l;const u=Ut();if(qi(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:m,options:_}=f;f!==this.root&&m&&_.layoutScroll&&(m.wasRoot&&qi(u,o),Zc(u.x,m.offset.x),Zc(u.y,m.offset.y))}return u}applyTransform(o,l=!1){const u=Ut();qi(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Qc(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Ka(f.latestValues)&&Qc(u,f.latestValues)}return Ka(this.latestValues)&&Qc(u,this.latestValues),u}removeTransform(o){const l=Ut();qi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Ka(h.latestValues))continue;Ux(h.latestValues)&&h.updateSnapshot();const f=Ut(),m=h.measurePageBox();qi(f,m),TI(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return Ka(this.latestValues)&&TI(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==En.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:_}=this.options;if(!(!this.layout||!(m||_))){if(this.resolvedRelativeTargetAt=En.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),ud(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),qi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),z5(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):qi(this.target,this.layout.layoutBox),CA(this.target,this.targetDelta)):qi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),ud(this.relativeTargetOrigin,this.target,v.target),qi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Yh&&qa.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Ux(this.parent.latestValues)||bA(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===En.timestamp&&(h=!1),h)return;const{layout:f,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||m))return;qi(this.layoutCorrected,this.layout.layoutBox);const _=this.treeScale.x,v=this.treeScale.y;X5(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:S}=l;if(!S){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(vI(this.prevProjectionDelta.x,this.projectionDelta.x),vI(this.prevProjectionDelta.y,this.projectionDelta.y)),cd(this.projectionDelta,this.layoutCorrected,S,this.latestValues),(this.treeScale.x!==_||this.treeScale.y!==v||!RI(this.projectionDelta.x,this.prevProjectionDelta.x)||!RI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",S)),Yh&&qa.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Yc(),this.projectionDelta=Yc(),this.projectionDeltaWithTransform=Yc()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},m=Yc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const _=Ut(),v=u?u.source:void 0,S=this.layout?this.layout.source:void 0,I=v!==S,T=this.getStack(),R=!T||T.members.length<=1,M=!!(I&&!R&&this.options.crossfade===!0&&!this.path.some(MF));this.animationProgress=0;let N;this.mixTargetDelta=L=>{const A=L/1e3;NI(m.x,o.x,A),NI(m.y,o.y,A),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ud(_,this.layout.layoutBox,this.relativeParent.layout.layoutBox),DF(this.relativeTarget,this.relativeTargetOrigin,_,A),N&&yF(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=Ut()),qi(N,this.relativeTarget)),I&&(this.animationValues=f,hF(f,h,this.latestValues,A,M,R)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ra(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=St.update(()=>{Ep.hasAnimatedSinceResize=!0,this.currentAnimation=sF(0,AI,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(AI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:f}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&jA(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Ut();const m=Pi(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+m;const _=Pi(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+_}qi(l,u),Qc(l,f),cd(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new _F),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&R_("z",o,h,this.animationValues);for(let f=0;f<C_.length;f++)R_(`rotate${C_[f]}`,o,h,this.animationValues),R_(`skew${C_[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return vF;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=vp(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const I={};return this.options.layoutId&&(I.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,I.pointerEvents=vp(o?.pointerEvents)||""),this.hasProjected&&!Ka(this.latestValues)&&(I.transform=f?f({},""):"none",this.hasProjected=!1),I}const _=m.animationValues||m.latestValues;this.applyTransformsToTarget(),h.transform=xF(this.projectionDeltaWithTransform,this.treeScale,_),f&&(h.transform=f(_,h.transform));const{x:v,y:S}=this.projectionDelta;h.transformOrigin=`${v.origin*100}% ${S.origin*100}% 0`,m.animationValues?h.opacity=m===this?(u=(l=_.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:_.opacityExit:h.opacity=m===this?_.opacity!==void 0?_.opacity:"":_.opacityExit!==void 0?_.opacityExit:0;for(const I in zp){if(_[I]===void 0)continue;const{correct:T,applyTo:R}=zp[I],M=h.transform==="none"?_[I]:T(_[I],m);if(R){const N=R.length;for(let L=0;L<N;L++)h[R[L]]=M}else h[I]=M}return this.options.layoutId&&(h.pointerEvents=m===this?vp(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(PI),this.root.sharedNodes.clear()}}}function EF(n){n.updateLayout()}function TF(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?Yi(m=>{const _=o?t.measuredBox[m]:t.layoutBox[m],v=Pi(_);_.min=i[m].min,_.max=_.min+v}):jA(s,t.layoutBox,i)&&Yi(m=>{const _=o?t.measuredBox[m]:t.layoutBox[m],v=Pi(i[m]);_.max=_.min+v,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[m].max=n.relativeTarget[m].min+v)});const l=Yc();cd(l,i,t.layoutBox);const u=Yc();o?cd(u,n.applyTransform(r,!0),t.measuredBox):cd(u,i,t.layoutBox);const h=!DA(l);let f=!1;if(!n.resumeFrom){const m=n.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:_,layout:v}=m;if(_&&v){const S=Ut();ud(S,t.layoutBox,_.layoutBox);const I=Ut();ud(I,i,v.layoutBox),MA(S,I)||(f=!0),m.options.layoutRoot&&(n.relativeTarget=I,n.relativeTargetOrigin=S,n.relativeParent=m)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function SF(n){Yh&&qa.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function IF(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function bF(n){n.clearSnapshot()}function PI(n){n.clearMeasurements()}function CF(n){n.isLayoutDirty=!1}function RF(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function kI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function AF(n){n.resolveTargetDelta()}function PF(n){n.calcProjection()}function kF(n){n.resetSkewAndRotation()}function NF(n){n.removeLeadSnapshot()}function NI(n,e,t){n.translate=Dt(e.translate,0,t),n.scale=Dt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function DI(n,e,t,i){n.min=Dt(e.min,t.min,i),n.max=Dt(e.max,t.max,i)}function DF(n,e,t,i){DI(n.x,e.x,t.x,i),DI(n.y,e.y,t.y,i)}function MF(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const LF={duration:.45,ease:[.4,0,.1,1]},MI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),LI=MI("applewebkit/")&&!MI("chrome/")?Math.round:Ai;function OI(n){n.min=LI(n.min),n.max=LI(n.max)}function OF(n){OI(n.x),OI(n.y)}function jA(n,e,t){return n==="position"||n==="preserve-aspect"&&!V5(CI(e),CI(t),.2)}function jF(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const FF=OA({attachResizeListener:(n,e)=>Ad(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),A_={current:void 0},FA=OA({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!A_.current){const n=new FF({});n.mount(window),n.setOptions({layoutScroll:!0}),A_.current=n}return A_.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),VF={pan:{Feature:tF},drag:{Feature:eF,ProjectionNode:FA,MeasureLayout:PA}};function jI(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&St.postRender(()=>s(e,ff(e)))}class zF extends ga{mount(){const{current:e}=this.node;e&&(this.unmount=VO(e,t=>(jI(this.node,t,"Start"),i=>jI(this.node,i,"End"))))}unmount(){}}class UF extends ga{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=df(Ad(this.node.current,"focus",()=>this.onFocus()),Ad(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function FI(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&St.postRender(()=>s(e,ff(e)))}class BF extends ga{mount(){const{current:e}=this.node;e&&(this.unmount=WO(e,t=>(FI(this.node,t,"Start"),(i,{success:r})=>FI(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Wx=new WeakMap,P_=new WeakMap,WF=n=>{const e=Wx.get(n.target);e&&e(n)},GF=n=>{n.forEach(WF)};function $F({root:n,...e}){const t=n||document;P_.has(t)||P_.set(t,{});const i=P_.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(GF,{root:n,...e})),i[r]}function HF(n,e,t){const i=$F(e);return Wx.set(n,t),i.observe(n),()=>{Wx.delete(n),i.unobserve(n)}}const KF={some:0,all:1};class qF extends ga{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:KF[r]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:m}=this.node.getProps(),_=h?f:m;_&&_(u)};return HF(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(XF(e,t))&&this.startObserver()}unmount(){}}function XF({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const YF={inView:{Feature:qF},tap:{Feature:BF},focus:{Feature:UF},hover:{Feature:zF}},ZF={layout:{ProjectionNode:FA,MeasureLayout:PA}},Gx={current:null},VA={current:!1};function QF(){if(VA.current=!0,!!Jv)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Gx.current=n.matches;n.addListener(e),e()}else Gx.current=!1}const JF=[...uA,On,sa],e4=n=>JF.find(cA(n)),VI=new WeakMap;function t4(n,e,t){for(const i in e){const r=e[i],s=t[i];if(Fn(r))n.addValue(i,r);else if(Fn(s))n.addValue(i,Cd(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,Cd(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const zI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class n4{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=b1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=hs.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,St.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=Gm(t),this.isVariantNode=_R(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:m,..._}=this.scrapeMotionValuesFromProps(t,{},this);for(const v in _){const S=_[v];u[v]!==void 0&&Fn(S)&&S.set(u[v],!1)}}mount(e){this.current=e,VI.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),VA.current||QF(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Gx.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){VI.delete(this.current),this.projection&&this.projection.unmount(),ra(this.notifyUpdate),ra(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Fl.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&St.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in hu){const t=hu[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<zI.length;i++){const r=zI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=t4(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=Cd(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(aA(r)||QR(r))?r=parseFloat(r):!e4(r)&&sa.test(t)&&(r=rA(e,t)),this.setBaseTarget(e,Fn(r)?r.get():r)),Fn(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=o1(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Fn(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new v1),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class zA extends n4{constructor(){super(...arguments),this.KeyframeResolver=hA}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Fn(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function i4(n){return window.getComputedStyle(n)}class r4 extends zA{constructor(){super(...arguments),this.type="html",this.renderInstance=CR}readValueFromInstance(e,t){if(Fl.has(t)){const i=I1(t);return i&&i.default||0}else{const i=i4(e),r=(SR(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return RA(e,t)}build(e,t,i){c1(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return f1(e,t,i)}}class s4 extends zA{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Fl.has(t)){const i=I1(t);return i&&i.default||0}return t=RR.has(t)?t:i1(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return kR(e,t,i)}build(e,t,i){u1(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){AR(e,t,i,r)}mount(e){this.isSVGTag=d1(e.tagName),super.mount(e)}}const o4=(n,e)=>s1(n)?new s4(e):new r4(e,{allowProjection:n!==q.Fragment}),a4=NO({...P5,...YF,...VF,...ZF},o4),je=KL(a4),oi={ADD:"add",REMOVE:"remove"},fu={PROPERTYCHANGE:"propertychange"},Ge={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Km{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function l4(n,e,t){let i,r;t=t||Xs;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function Xs(n,e){return n>e?1:n<e?-1:0}function c4(n,e){return n<e?1:n>e?-1:0}function P1(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function u4(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function k1(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function pa(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function h4(n,e,t){const i=e||Xs;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Pd(){return!0}function qm(){return!1}function kd(){}function UA(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!pa(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function BA(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function gf(n){for(const e in n)delete n[e]}function gu(n){let e;for(e in n)return!1;return!e}class ro{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class pf extends Km{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new ro(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let u;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,kd);delete o[i]}return u}disposeInternal(){this.listeners_&&gf(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=kd,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function rt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Hp(n,e,t,i){return rt(n,e,t,i,!0)}function At(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),gf(n))}class mf extends pf{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Ge.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=rt(this,e[s],t);return r}return rt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Hp(this,e[s],t)}else i=Hp(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)d4(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}mf.prototype.on;mf.prototype.once;mf.prototype.un;function d4(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)At(n[e]);else At(n)}function it(){throw new Error("Unimplemented abstract method.")}let f4=0;function st(n){return n.ol_uid||(n.ol_uid=String(++f4))}class UI extends ro{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class _s extends mf{constructor(e){super(),this.on,this.once,this.un,st(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new UI(i,e,t)),i=fu.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new UI(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],gu(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const BI={LENGTH:"length"};class Yg extends ro{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Ji extends _s{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(BI.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Yg(oi.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Yg(oi.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Yg(oi.REMOVE,r,e)),this.dispatchEvent(new Yg(oi.ADD,t,e))}updateLength_(){this.set(BI.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function ut(n,e){if(!n)throw new Error(e)}class El extends _s{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new El(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(At(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=rt(e,Ge.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?g4(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function g4(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(ut(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const cn={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function WI(n){const e=ir();for(let t=0,i=n.length;t<i;++t)hd(e,n[t]);return e}function N1(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function WA(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function GA(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function pu(n,e){return $A(n,e[0],e[1])}function Zh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function $A(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function $x(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let u=cn.UNKNOWN;return o<t?u=u|cn.LEFT:o>r&&(u=u|cn.RIGHT),l<i?u=u|cn.BELOW:l>s&&(u=u|cn.ABOVE),u===cn.UNKNOWN&&(u=cn.INTERSECTING),u}function ir(){return[1/0,1/0,-1/0,-1/0]}function oa(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Xm(n){return oa(1/0,1/0,-1/0,-1/0,n)}function HA(n,e){const t=n[0],i=n[1];return oa(t,i,t,i,e)}function D1(n,e,t,i,r){const s=Xm(r);return KA(s,n,e,t,i)}function Nd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function p4(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function hd(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function KA(n,e,t,i,r){for(;t<i;t+=r)m4(n,e[t],e[t+1]);return n}function m4(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function qA(n,e){let t;return t=e(Ym(n)),t||(t=e(Zm(n)),t)||(t=e(Qm(n)),t)||(t=e(Vl(n)),t)?t:!1}function Hx(n){let e=0;return Jm(n)||(e=ct(n)*Kn(n)),e}function Ym(n){return[n[0],n[1]]}function Zm(n){return[n[2],n[1]]}function Tl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function y4(n,e){let t;if(e==="bottom-left")t=Ym(n);else if(e==="bottom-right")t=Zm(n);else if(e==="top-left")t=Vl(n);else if(e==="top-right")t=Qm(n);else throw new Error("Invalid corner");return t}function Kx(n,e,t,i,r){const[s,o,l,u,h,f,m,_]=XA(n,e,t,i);return oa(Math.min(s,l,h,m),Math.min(o,u,f,_),Math.max(s,l,h,m),Math.max(o,u,f,_),r)}function XA(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),u=r*o,h=r*l,f=s*o,m=s*l,_=n[0],v=n[1];return[_-u+m,v-h-f,_-u-m,v-h+f,_+u-m,v+h+f,_+u+m,v+h-f,_-u+m,v-h-f]}function Kn(n){return n[3]-n[1]}function gl(n,e,t){const i=t||ir();return ui(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Xm(i),i}function Vl(n){return[n[0],n[3]]}function Qm(n){return[n[2],n[3]]}function ct(n){return n[2]-n[0]}function ui(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Jm(n){return n[2]<n[0]||n[3]<n[1]}function _4(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function x4(n,e,t){let i=!1;const r=$x(n,e),s=$x(n,t);if(r===cn.INTERSECTING||s===cn.INTERSECTING)i=!0;else{const o=n[0],l=n[1],u=n[2],h=n[3],f=e[0],m=e[1],_=t[0],v=t[1],S=(v-m)/(_-f);let I,T;s&cn.ABOVE&&!(r&cn.ABOVE)&&(I=_-(v-h)/S,i=I>=o&&I<=u),!i&&s&cn.RIGHT&&!(r&cn.RIGHT)&&(T=v-(_-u)*S,i=T>=l&&T<=h),!i&&s&cn.BELOW&&!(r&cn.BELOW)&&(I=_-(v-l)/S,i=I>=o&&I<=u),!i&&s&cn.LEFT&&!(r&cn.LEFT)&&(T=v-(_-o)*S,i=T>=l&&T<=h)}return i}function YA(n,e){const t=e.getExtent(),i=Tl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=ct(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function ZA(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];YA(n,e);const r=ct(i);if(ct(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Tt(n,e,t){return Math.min(Math.max(n,e),t)}function v4(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const u=((n-t)*o+(e-i)*l)/(o*o+l*l);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=l*u)}return nu(n,e,t,i)}function nu(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function w4(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const u=Math.abs(n[l][i]);u>s&&(s=u,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const u=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function GI(n){return n*180/Math.PI}function Jo(n){return n*Math.PI/180}function pl(n,e){const t=n%e;return t*e<0?t+e:t}function bi(n,e,t){return n+t*(e-n)}function yf(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function ZX(n,e){return Math.round(yf(n,e))}function Zg(n,e){return Math.floor(yf(n,e))}function Qg(n,e){return Math.ceil(yf(n,e))}function qx(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function E4(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Kp(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function M1(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function T4(n,e){return n[0]*=e,n[1]*=e,n}function QA(n,e){if(e.canWrapX()){const t=ct(e.getExtent()),i=JA(n,e,t);i&&(n[0]-=i*t)}return n}function JA(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||ct(i),r=Math.floor((n[0]-i[0])/t)),r}function eP(...n){console.warn(...n)}const mu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class L1{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||mu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const _f=6378137,Jc=Math.PI*_f,S4=[-Jc,-Jc,Jc,Jc],I4=[-180,-85,180,85],Jg=_f*Math.log(Math.tan(Math.PI/2));class bc extends L1{constructor(e){super({code:e,units:"m",extent:S4,global:!0,worldExtent:I4,getPointResolution:function(t,i){return t/Math.cosh(i[1]/_f)}})}}const $I=[new bc("EPSG:3857"),new bc("EPSG:102100"),new bc("EPSG:102113"),new bc("EPSG:900913"),new bc("http://www.opengis.net/def/crs/EPSG/0/3857"),new bc("http://www.opengis.net/gml/srs/epsg.xml#3857")];function b4(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Jc*n[s]/180;let o=_f*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Jg?o=Jg:o<-Jg&&(o=-Jg),e[s+1]=o}return e}function C4(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Jc,e[s+1]=360*Math.atan(Math.exp(n[s+1]/_f))/Math.PI-90;return e}const R4=6378137,HI=[-180,-90,180,90],A4=Math.PI*R4/180;class Wa extends L1{constructor(e,t){super({code:e,units:"degrees",extent:HI,axisOrientation:t,global:!0,metersPerUnit:A4,worldExtent:HI})}}const KI=[new Wa("CRS:84"),new Wa("EPSG:4326","neu"),new Wa("urn:ogc:def:crs:OGC:1.3:CRS84"),new Wa("urn:ogc:def:crs:OGC:2:84"),new Wa("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Wa("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Wa("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Xx={};function P4(n){return Xx[n]||Xx[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function k4(n,e){Xx[n]=e}let iu={};function Sl(n,e,t){const i=n.getCode(),r=e.getCode();i in iu||(iu[i]={}),iu[i][r]=t}function k_(n,e){return n in iu&&e in iu[n]?iu[n][e]:null}const qp=.9996,nr=.00669438,e0=nr*nr,t0=e0*nr,ol=nr/(1-nr),qI=Math.sqrt(1-nr),yu=(1-qI)/(1+qI),tP=yu*yu,O1=tP*yu,j1=O1*yu,nP=j1*yu,iP=1-nr/4-3*e0/64-5*t0/256,N4=3*nr/8+3*e0/32+45*t0/1024,D4=15*e0/256+45*t0/1024,M4=35*t0/3072,L4=3/2*yu-27/32*O1+269/512*nP,O4=21/16*tP-55/32*j1,j4=151/96*O1-417/128*nP,F4=1097/512*j1,Xp=6378137;function V4(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/qp/(Xp*iP),l=o+L4*Math.sin(2*o)+O4*Math.sin(4*o)+j4*Math.sin(6*o)+F4*Math.sin(8*o),u=Math.sin(l),h=u*u,f=Math.cos(l),m=u/f,_=m*m,v=_*_,S=1-nr*h,I=Math.sqrt(1-nr*h),T=Xp/I,R=(1-nr)/S,M=ol*f**2,N=M*M,L=i/(T*qp),A=L*L,z=A*L,P=z*L,b=P*L,k=b*L,F=l-m/R*(A/2-P/24*(5+3*_+10*M-4*N-9*ol))+k/720*(61+90*_+298*M+45*v-252*ol-3*N);let V=(L-z/6*(1+2*_+M)+b/120*(5-2*M+28*_-3*N+8*ol+24*v))/f;return V=qx(V+Jo(rP(t.number)),-Math.PI,Math.PI),[GI(V),GI(F)]}const XI=-80,YI=84,z4=-180,U4=180;function B4(n,e,t){n=qx(n,z4,U4),e<XI?e=XI:e>YI&&(e=YI);const i=Jo(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,u=l*l,h=Jo(n),f=rP(t.number),m=Jo(f),_=Xp/Math.sqrt(1-nr*r**2),v=ol*s**2,S=s*qx(h-m,-Math.PI,Math.PI),I=S*S,T=I*S,R=T*S,M=R*S,N=M*S,L=Xp*(iP*i-N4*Math.sin(2*i)+D4*Math.sin(4*i)-M4*Math.sin(6*i)),A=qp*_*(S+T/6*(1-l+v)+M/120*(5-18*l+u+72*v-58*ol))+5e5;let z=qp*(L+_*o*(I/2+R/24*(5-l+9*v+4*v**2)+N/720*(61-58*l+u+600*v-330*ol)));return t.north||(z+=1e7),[A,z]}function rP(n){return(n-1)*6-180+3}const W4=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function sP(n){let e=0;for(const r of W4){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function ZI(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const u=t[l],h=t[l+1],f=n(u,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function G4(n){return sP(n)?new L1({code:n,units:"m"}):null}function $4(n){const e=sP(n.getCode());return e?{forward:ZI(B4,e),inverse:ZI(V4,e)}:null}const H4=63710088e-1;function QI(n,e,t){t=t||H4;const i=Jo(n[1]),r=Jo(e[1]),s=(r-i)/2,o=Jo(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const K4=[$4],q4=[G4];let Yx=!0;function oP(n){Yx=!1}function F1(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function Zx(n){k4(n.getCode(),n),Sl(n,n,F1)}function X4(n){n.forEach(Zx)}function Vn(n){if(typeof n!="string")return n;const e=P4(n);if(e)return e;for(const t of q4){const i=t(n);if(i)return i}return null}function Yp(n,e,t,i){n=Vn(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/mu[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=z1(n,Vn("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=QI(h.slice(0,2),h.slice(2,4)),m=QI(h.slice(4,6),h.slice(6,8));r=(f+m)/2}const u=i?mu[i]:n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function JI(n){X4(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Sl(e,t,F1)})})}function Y4(n,e,t,i){n.forEach(function(r){e.forEach(function(s){Sl(r,s,t),Sl(s,r,i)})})}function V1(n,e){return n?typeof n=="string"?Vn(n):n:Vn(e)}function Qx(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),u=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=u?e[o+h]:l[h]}return t})}function QX(n,e,t,i){const r=Vn(n),s=Vn(e);Sl(r,s,Qx(t)),Sl(s,r,Qx(i))}function aa(n,e){return oP(),n0(n,"EPSG:4326","EPSG:3857")}function Jx(n,e){const t=n0(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=pl(i+180,360)-180),t}function Tp(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||z1(n,e)===F1)&&t}function z1(n,e){const t=n.getCode(),i=e.getCode();let r=k_(t,i);if(r)return r;let s=null,o=null;for(const u of K4)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=N_(s.inverse,o.forward);else{const u=k_(t,l);u&&(r=N_(u,o.forward))}else{const u=k_(l,i);u&&(r=N_(s.inverse,u))}return r&&(Zx(n),Zx(e),Sl(n,e,r)),r}function N_(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Zp(n,e){const t=Vn(n),i=Vn(e);return z1(t,i)}function n0(n,e,t){const i=Zp(e,t);if(!i){const r=Vn(e).getCode(),s=Vn(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function ev(n,e){return n}function zs(n,e){return Yx&&!Kp(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Yx=!1,eP("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function aP(n,e){return n}function Xo(n,e){return n}function JX(n,e,t){return function(i){let r,s;if(n.canWrapX()){const o=n.getExtent(),l=ct(o);i=i.slice(0),s=JA(i,n,l),s&&(i[0]=i[0]-s*l),i[0]=Tt(i[0],o[0],o[2]),i[1]=Tt(i[1],o[1],o[3]),r=t(i)}else r=t(i);return s&&e.canWrapX()&&(r[0]+=s*ct(e.getExtent())),r}}function Z4(){JI($I),JI(KI),Y4(KI,$I,b4,C4)}Z4();new Array(6);function Cr(){return[1,0,0,1,0,0]}function Q4(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function hn(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function eo(n,e,t,i,r,s,o,l){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-l*i*u+e,n[5]=o*r*u+l*r*h+t,n}function lP(n,e){const t=J4(e);ut(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*l)/t,n[5]=-(i*u-r*l)/t,n}function J4(n){return n[0]*n[3]-n[1]*n[2]}const eV=[1e5,1e5,1e5,1e5,2,2];function tV(n){return"matrix("+n.join(", ")+")"}function tv(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function nV(n,e){const t=tv(n),i=tv(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*eV[r])!==0)return!1;return!0}function ea(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let u=e;u<t;u+=i){const h=n[u],f=n[u+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let m=2;m<o;m++)s[l++]=n[u+m]}return s&&s.length!=l&&(s.length=l),s}function cP(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),u=Math.sin(r),h=s[0],f=s[1];let m=0;for(let _=e;_<t;_+=i){const v=n[_]-h,S=n[_+1]-f;o[m++]=h+v*l-S*u,o[m++]=f+v*u+S*l;for(let I=_+2;I<_+i;++I)o[m++]=n[I]}return o&&o.length!=m&&(o.length=m),o}function iV(n,e,t,i,r,s,o,l){l=l||[];const u=o[0],h=o[1];let f=0;for(let m=e;m<t;m+=i){const _=n[m]-u,v=n[m+1]-h;l[f++]=u+r*_,l[f++]=h+s*v;for(let S=m+2;S<m+i;++S)l[f++]=n[S]}return l&&l.length!=f&&(l.length=f),l}function rV(n,e,t,i,r,s,o){o=o||[];let l=0;for(let u=e;u<t;u+=i){o[l++]=n[u]+r,o[l++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const eb=Cr(),sV=[NaN,NaN];class oV extends _s{constructor(){super(),this.extent_=ir(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=UA((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return it()}closestPointXY(e,t,i,r){return it()}containsXY(e,t){return this.closestPointXY(e,t,sV,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return it()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Xm(t),this.extentRevision_=this.getRevision()}return _4(this.extent_,e)}rotate(e,t){it()}scale(e,t,i){it()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return it()}getType(){return it()}applyTransform(e){it()}intersectsExtent(e){return it()}translate(e,t){it()}transform(e,t){const i=Vn(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const u=i.getExtent(),h=i.getWorldExtent(),f=Kn(h)/Kn(u);eo(eb,h[0],h[3],f,-f,0,0,0);const m=ea(s,0,s.length,l,eb,o),_=Zp(i,t);return _?_(m,m,l):m}:Zp(i,t);return this.applyTransform(r),this}}class U1 extends oV{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return D1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return it()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=tb(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){it()}setLayout(e,t,i){let r;if(e)r=tb(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=aV(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();cP(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=Tl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();iV(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();rV(i,0,i.length,r,e,t,i),this.changed()}}}function aV(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function tb(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function lV(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return ea(i,0,i.length,r,e,t)}function nb(n,e,t,i,r,s,o){const l=n[e],u=n[e+1],h=n[t]-l,f=n[t+1]-u;let m;if(h===0&&f===0)m=e;else{const _=((r-l)*h+(s-u)*f)/(h*h+f*f);if(_>1)m=t;else if(_>0){for(let v=0;v<i;++v)o[v]=bi(n[e+v],n[t+v],_);o.length=i;return}else m=e}for(let _=0;_<i;++_)o[_]=n[m+_];o.length=i}function uP(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],u=n[e+1],h=nu(s,o,l,u);h>r&&(r=h),s=l,o=u}return r}function hP(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=uP(n,e,l,i,r),e=l}return r}function eY(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=hP(n,e,l,i,r),e=l[l.length-1]}return r}function dP(n,e,t,i,r,s,o,l,u,h,f){if(e==t)return h;let m,_;if(r===0){if(_=nu(o,l,n[e],n[e+1]),_<h){for(m=0;m<i;++m)u[m]=n[e+m];return u.length=i,_}return h}f=f||[NaN,NaN];let v=e+i;for(;v<t;)if(nb(n,v-i,v,i,o,l,f),_=nu(o,l,f[0],f[1]),_<h){for(h=_,m=0;m<i;++m)u[m]=f[m];u.length=i,v+=i}else v+=i*Math.max((Math.sqrt(_)-Math.sqrt(h))/r|0,1);if(s&&(nb(n,t-i,e,i,o,l,f),_=nu(o,l,f[0],f[1]),_<h)){for(h=_,m=0;m<i;++m)u[m]=f[m];u.length=i}return h}function fP(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let m=0,_=t.length;m<_;++m){const v=t[m];h=dP(n,e,v,i,r,s,o,l,u,h,f),e=v}return h}function tY(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let m=0,_=t.length;m<_;++m){const v=t[m];h=fP(n,e,v,i,r,s,o,l,u,h,f),e=v[v.length-1]}return h}function cV(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function gP(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function pP(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=gP(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function nY(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=pP(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function eu(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Qp(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=eu(n,e,u,i,r[s]),e=u}return r.length=s,r}function ib(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:Qp(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function rb(n,e,t,i,r,s,o){let l,u;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,u=r;else if(h!==0){let f=n[e],m=n[e+1],_=0;const v=[0];for(let T=e+i;T<t;T+=i){const R=n[T],M=n[T+1];_+=Math.sqrt((R-f)*(R-f)+(M-m)*(M-m)),v.push(_),f=R,m=M}const S=r*_,I=l4(v,S);I<0?(u=(S-v[-I-2])/(v[-I-1]-v[-I-2]),l=e+(-I-2)*i):l=e+I*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:u===void 0?n[l+f]:bi(n[l+f],n[l+i+f],u);return s}function sb(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,u=t/i;for(;l<u;){const _=l+u>>1;r<n[(_+1)*i-1]?u=_:l=_+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],m=(r-h)/(f-h);o=[];for(let _=0;_<i-1;++_)o.push(bi(n[(l-1)*i+_],n[l*i+_],m));return o.push(r),o}function iY(n,e,t,i,r,s,o){if(o)return sb(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let u=0,h=t.length;u<h;++u){const f=t[u];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return sb(n,e,f,i,r,!1);e=f}}return null}function uV(n,e,t,i,r){return!qA(r,function(o){return!al(n,e,t,i,o[0],o[1])})}function al(n,e,t,i,r,s){let o=0,l=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];u<=s?f>s&&(h-l)*(s-u)-(r-l)*(f-u)>0&&o++:f<=s&&(h-l)*(s-u)-(r-l)*(f-u)<0&&o--,l=h,u=f}return o!==0}function B1(n,e,t,i,r,s){if(t.length===0||!al(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(al(n,t[o-1],t[o],i,r,s))return!1;return!0}function rY(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const u=t[o];if(B1(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function hV(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function W1(n,e,t,i,r,s){return s=s??KA(ir(),n,e,t,i),ui(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:hV(n,e,t,i,function(o,l){return x4(r,o,l)}):!1}function sY(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(W1(n,e,t[s],i,r))return!0;e=t[s]}return!1}function mP(n,e,t,i,r){return!!(W1(n,e,t,i,r)||al(n,e,t,i,r[0],r[1])||al(n,e,t,i,r[0],r[3])||al(n,e,t,i,r[2],r[1])||al(n,e,t,i,r[2],r[3]))}function yP(n,e,t,i,r){if(!mP(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(uV(n,t[s-1],t[s],i,r)&&!W1(n,t[s-1],t[s],i,r))return!1;return!0}function oY(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(yP(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function dV(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const u=n[l],h=n[l+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function G1(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(l);u[0]=1,u[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const m=h.pop(),_=h.pop();let v=0;const S=n[_],I=n[_+1],T=n[m],R=n[m+1];for(let M=_+i;M<m;M+=i){const N=n[M],L=n[M+1],A=v4(N,L,S,I,T,R);A>v&&(f=M,v=A)}v>r&&(u[(f-e)/i]=1,_+i<f&&h.push(_,f),f+i<m&&h.push(f,m))}for(let m=0;m<l;++m)u[m]&&(s[o++]=n[e+m*i],s[o++]=n[e+m*i+1]);return o}function fV(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=G1(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Xa(n,e){return e*Math.round(n/e)}function gV(n,e,t,i,r,s,o){if(e==t)return o;let l=Xa(n[e],r),u=Xa(n[e+1],r);e+=i,s[o++]=l,s[o++]=u;let h,f;do if(h=Xa(n[e],r),f=Xa(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==u);for(;e<t;){const m=Xa(n[e],r),_=Xa(n[e+1],r);if(e+=i,m==h&&_==f)continue;const v=h-l,S=f-u,I=m-l,T=_-u;if(v*T==S*I&&(v<0&&I<v||v==I||v>0&&I>v)&&(S<0&&T<S||S==T||S>0&&T>S)){h=m,f=_;continue}s[o++]=h,s[o++]=f,l=h,u=f,h=m,f=_}return s[o++]=h,s[o++]=f,o}function $1(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=gV(n,e,f,i,r,s,o),l.push(o),e=f}return o}function aY(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u],m=[];o=$1(n,e,f,i,r,s,o,m),l.push(m),e=f[f.length-1]}return o}class la extends U1{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new la(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=nu(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let u=0;u<l;++u)i[u]=s[u];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return HA(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return $A(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=cV(this.flatCoordinates,0,e,this.stride),this.changed()}}const er={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Il=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",pV=Il.includes("safari")&&!Il.includes("chrom");pV&&(Il.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Il));const mV=Il.includes("webkit")&&!Il.includes("edge"),_P=Il.includes("macintosh"),yV=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ri=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,H1=typeof Image<"u"&&Image.prototype.decode,xP=typeof createImageBitmap=="function",vP=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Ue={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function en(n,e,t,i){let r;return t&&t.length?r=t.shift():Ri?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let D_;function Jp(){return D_||(D_=en(1,1)),D_}function i0(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function ob(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function _V(n){for(;n.lastChild;)n.lastChild.remove()}function xV(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function wP(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Yo(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const K1=[NaN,NaN,NaN,0];let M_;function vV(){return M_||(M_=en(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),M_}const wV=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,EV=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,TV=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,SV=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function ep(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function dd(n){throw new Error('failed to parse "'+n+'" as color')}function EP(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(EV)||n.match(wV)||n.match(TV);if(s){const o=s[4],l=100/255;return[Tt(ep(s[1],l)+.5|0,0,255),Tt(ep(s[2],l)+.5|0,0,255),Tt(ep(s[3],l)+.5|0,0,255),o!==void 0?Tt(ep(o,100),0,1):1]}dd(n)}if(n.startsWith("#")){if(SV.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let f=parseInt(s.substring(u,u+o),16);o===1&&(f+=f<<4),l[u/o]=f}return l[3]=l[3]/255,l}dd(n)}const e=vV();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&dd(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return EP(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=yf(r[3]/255,3),r}function IV(n){return typeof n=="string"?n:X1(n)}const bV=1024,Lh={};let L_=0;function CV(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function O_(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function j_(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function F_(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function V_(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function ab(n){const e=F_(n[0]),t=F_(n[1]),i=F_(n[2]),r=V_(e*.222488403+t*.716873169+i*.06060791),s=500*(V_(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-V_(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function RV(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=j_(e),s=j_(e+t/500*Math.cos(i)),o=j_(e-t/200*Math.sin(i)),l=O_(s*3.021973625-r*1.617392459-o*.404875592),u=O_(s*-.943766287+r*1.916279586+o*.027607165),h=O_(s*.069407491-r*.22898585+o*1.159737864);return[Tt(l+.5|0,0,255),Tt(u+.5|0,0,255),Tt(h+.5|0,0,255),n[3]]}function q1(n){if(n==="none")return K1;if(Lh.hasOwnProperty(n))return Lh[n];if(L_>=bV){let t=0;for(const i in Lh)(t++&3)===0&&(delete Lh[i],--L_)}const e=EP(n);e.length!==4&&dd(n);for(const t of e)isNaN(t)&&dd(n);return Lh[n]=e,++L_,e}function _u(n){return Array.isArray(n)?n:q1(n)}function X1(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}class lY extends pf{constructor(e,t,i,r){super(),this.extent=e,this.pixelRatio_=i,this.resolution=t,this.state=typeof r=="function"?Ue.IDLE:r,this.image_=null,this.loader=typeof r=="function"?r:null}changed(){this.dispatchEvent(Ge.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Ue.IDLE&&this.loader){this.state=Ue.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;BA(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||xP&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=Ue.LOADED}).catch(i=>{this.state=Ue.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function AV(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[Hp(i,Ge.LOAD,function(){o=!0,s||e()})];return i.src&&H1?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):l.push(Hp(i,Ge.ERROR,t)),function(){r=!1,l.forEach(At)}}function PV(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function TP(n,e){return e&&(n.src=e),n.src&&H1?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):PV(n)}function cY(n,e){return e&&(n.src=e),n.src&&H1&&xP?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):TP(n)}class kV{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=z_(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=z_(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=z_(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Ue.IDLE&&r.load(),r.getImageState()===Ue.LOADING?r.ready().then(()=>{this.patternCache_[o]=Jp().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Jp().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function z_(n,e,t){const i=t?_u(t):"null";return e+":"+n+":"+i}const tr=new kV;let Oh=null;class SP extends pf{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Ue.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Ue.LOADED){Oh||(Oh=en(1,1,void 0,{willReadFrequently:!0})),Oh.drawImage(this.image_,0,0);try{Oh.getImageData(0,0,1,1),this.tainted_=!1}catch{Oh=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Ge.CHANGE)}handleImageError_(){this.imageState_=Ue.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Ue.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=en(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Ue.IDLE){this.image_||this.initializeImage_(),this.imageState_=Ue.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&TP(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Ue.LOADED)return;const t=this.image_,i=en(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=IV(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Ue.LOADED||this.imageState_===Ue.ERROR)e();else{const t=()=>{(this.imageState_===Ue.LOADED||this.imageState_===Ue.ERROR)&&(this.removeEventListener(Ge.CHANGE,t),e())};this.addEventListener(Ge.CHANGE,t)}})),this.ready_}}function em(n,e,t,i,r,s){let o=e===void 0?void 0:tr.get(e,t,r);return o||(o=new SP(n,n&&"src"in n?n.src||void 0:e,t,i,r),tr.set(e,t,r,o,s)),s&&o&&!tr.getPattern(e,t,r)&&tr.set(e,t,r,o,s),o}function os(n){return n?Array.isArray(n)?X1(n):typeof n=="object"&&"src"in n?NV(n):n:null}function NV(n){if(!n.offset||!n.size)return tr.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=tr.getPattern(e,void 0,n.color);if(t)return t;const i=tr.get(n.src,"anonymous",null);if(i.getImageState()!==Ue.LOADED)return null;const r=en(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),em(r.canvas,e,void 0,Ue.LOADED,n.color,!0),tr.getPattern(e,void 0,n.color)}class IP{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const tp="ol-hidden",xf="ol-unselectable",Y1="ol-control",lb="ol-collapsed",DV=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),cb=["style","variant","weight","size","lineHeight","family"],nv={normal:400,bold:700},iv=function(n){const e=n.match(DV);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=cb.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[cb[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in nv&&(t.weight=nv[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},bP="10px sans-serif",ai="#000",xu="round",Ys=[],Zs=0,vu="round",Dd=10,Md="#000",Ld="center",tm="middle",ll=[0,0,0,0],Od=1,Vc=new _s;let jh=null,ub;const rv={},MV=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function LV(n,e,t){return`${n} ${e} 16px "${t}"`}const OV=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=iv(s),u=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const m=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),_=nv[f.weight]||f.weight;return m===u&&f.style===l.style&&_==h})}async function r(){await t.ready;let s=!0;const o=Vc.getProperties(),l=Object.keys(o).filter(u=>o[u]<100);for(let u=l.length-1;u>=0;--u){const h=l[u];let f=o[h];f<100&&(await i(h)?(gf(rv),Vc.set(h,100)):(f+=10,Vc.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Ri?self.fonts:document.fonts);const o=iv(s);if(!o)return;const l=o.families;let u=!1;for(const h of l){if(MV.has(h))continue;const f=LV(o.style,o.weight,h);Vc.get(f)===void 0&&(Vc.set(f,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),jV=(function(){let n;return function(e){let t=rv[e];if(t==null){if(Ri){const i=iv(e),r=CP(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);rv[e]=t}return t}})();function CP(n,e){return jh||(jh=en(1,1)),n!=ub&&(jh.font=n,ub=jh.font),jh.measureText(e)}function RP(n,e){return CP(n,e).width}function hb(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,RP(n,s)),0);return t[e]=i,i}function FV(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,u=0;for(let h=0,f=e.length;h<=f;h+=2){const m=e[h];if(m===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=u,u=0;continue}const _=e[h+1]||n.font,v=RP(_,m);t.push(v),o+=v;const S=jV(_);i.push(S),u=Math.max(u,S)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function VV(n,e,t,i,r,s,o,l,u,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=m=>m.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(f[0],f[1]),zV(i,n)):f[0]<0||f[1]<0?(n.translate(u,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,u,h,o*f[0],l*f[1]),n.restore()}function zV(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class UV extends IP{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?yf(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Cr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=ea(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,m=s.length;f<m;f+=2){const _=s[f]-this.imageAnchorX_,v=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const S=_+this.imageAnchorX_,I=v+this.imageAnchorY_;eo(l,S,I,1,1,h,-S,-I),o.save(),o.transform.apply(o,l),o.translate(S,I),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,_,v,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=ea(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=ea(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let u=l.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ui(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=lV(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ui(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(ui(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ui(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ui(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,u=s.length;l<u;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),pa(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Ld;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:os(i||ai)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),f=s||Ys;this.strokeState_={lineCap:r!==void 0?r:xu,lineDash:this.pixelRatio_===1?f:f.map(m=>m*this.pixelRatio_),lineDashOffset:(o||Zs)*this.pixelRatio_,lineJoin:l!==void 0?l:vu,lineWidth:(u!==void 0?u:Od)*this.pixelRatio_,miterLimit:h!==void 0?h:Dd,strokeStyle:os(i||Md)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const v=t.getColor();this.textFillState_={fillStyle:os(v||ai)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const v=i.getColor(),S=i.getLineCap(),I=i.getLineDash(),T=i.getLineDashOffset(),R=i.getLineJoin(),M=i.getWidth(),N=i.getMiterLimit();this.textStrokeState_={lineCap:S!==void 0?S:xu,lineDash:I||Ys,lineDashOffset:T||Zs,lineJoin:R!==void 0?R:vu,lineWidth:M!==void 0?M:Od,miterLimit:N!==void 0?N:Dd,strokeStyle:os(v||Md)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),f=e.getText(),m=e.getTextAlign(),_=e.getTextBaseline();this.textState_={font:r!==void 0?r:bP,textAlign:m!==void 0?m:Ld,textBaseline:_!==void 0?_:tm},this.text_=f!==void 0?Array.isArray(f)?f.reduce((v,S,I)=>v+=I%2?" ":S,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const BV=.5,AP={Point:YV,LineString:KV,Polygon:QV,MultiPoint:ZV,MultiLineString:qV,MultiPolygon:XV,GeometryCollection:HV,Circle:GV};function WV(n,e){return parseInt(st(n),10)-parseInt(st(e),10)}function db(n,e){const t=PP(n,e);return t*t}function PP(n,e){return BV*n/e}function GV(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}function fb(n,e,t,i,r,s,o,l){const u=[],h=t.getImage();if(h){let _=!0;const v=h.getImageState();v==Ue.LOADED||v==Ue.ERROR?_=!1:v==Ue.IDLE&&h.load(),_&&u.push(h.ready())}const f=t.getFill();f&&f.loading()&&u.push(f.ready());const m=u.length>0;return m&&Promise.all(u).then(()=>r(null)),$V(n,e,t,i,s,o,l),m}function $V(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const u=l.simplifyTransformed(i,r);if(t.getRenderer())kP(n,u,t,e,o);else{const f=AP[u.getType()];f(n,u,t,e,o,s)}}function kP(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,u=o.length;l<u;++l)kP(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function HV(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,u;for(l=0,u=o.length;l<u;++l){const h=AP[o[l].getType()];h(n,o[l],t,i,r,s)}}function KV(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function qV(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function XV(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}function YV(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=Ue.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function ZV(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=Ue.LOADED)return;const m=n.getBuilder(t.getZIndex(),"Image");m.setImageStyle(o,f),m.drawMultiPoint(e,i,r)}if(h){const m=n.getBuilder(t.getZIndex(),"Text");m.setTextStyle(u,f),m.drawText(e,i,r)}}function QV(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}let JV=!1;function e3(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=JV,l.onload=function(u){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function gb(n,e){return function(t,i,r,s,o){e3(n,e,t,i,r,(l,u)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function t3(n,e){return[[-1/0,-1/0,1/0,1/0]]}function n3(n,e,t,i){const r=[];let s=ir();for(let o=0,l=t.length;o<l;++o){const u=t[o];s=D1(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function Z1(n,e,t,i,r,s,o){let l,u,h,f,m,_,v;const S=r[s+1],I=[];for(let M=0,N=t.length;M<N;++M){const L=t[M];for(f=n[L-i],_=n[L-i+1],l=e;l<L;l+=i)m=n[l],v=n[l+1],(S<=_&&v<=S||_<=S&&S<=v)&&(h=(S-_)/(v-_)*(m-f)+f,I.push(h)),f=m,_=v}let T=NaN,R=-1/0;for(I.sort(Xs),f=I[0],l=1,u=I.length;l<u;++l){m=I[l];const M=Math.abs(m-f);M>R&&(h=(f+m)/2,B1(n,e,t,i,h,S)&&(T=h,R=M)),f=m}return isNaN(T)&&(T=r[s]),o?(o.push(T,S,R),o):[T,S,R]}function i3(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const u=t[o];s=Z1(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function r3(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function Q1(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],u=n[e+1];r+=(l-s)*(u+o),s=l,o=u}return r===0?void 0:r>0}function NP(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=Q1(n,e,l,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function uY(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!NP(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function sv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=Q1(n,e,l,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&r3(n,e,l,i),e=l}return e}function hY(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=sv(n,e,t[s],i,r);return e}function s3(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const u=e[o],h=Q1(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function DP(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,u=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=u*h-l*f,l=h,u=f}return r/2}function MP(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=DP(n,e,l,i),e=l}return r}function dY(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=MP(n,e,l,i),e=l[l.length-1]}return r}class jd extends U1{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new jd(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<GA(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(uP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),dP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return DP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return eu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=G1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new jd(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=gP(this.flatCoordinates,0,e,this.stride),this.changed()}}class Fd extends U1{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?k1(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Fd(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<GA(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(hP(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),fP(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return B1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return MP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),sv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Qp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Tl(this.getExtent());this.flatInteriorPoint_=Z1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new la(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new jd(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const u=i[o],h=new jd(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;NP(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=sv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=$1(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Fd(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return yP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=pP(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function pb(n){if(Jm(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Fd(s,"XY",[s.length])}const mb=Cr();class xr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?HA(this.flatCoordinates_):D1(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Tl(this.getExtent());this.flatInteriorPoints_=Z1(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=s3(this.flatCoordinates_,this.ends_),t=n3(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=i3(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=rb(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=rb(e,t,o,2,.5);k1(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Vn(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Kn(i)/Kn(t);eo(mb,i[0],i[3],r,-r,0,0,0),ea(this.flatCoordinates_,0,this.flatCoordinates_.length,2,mb,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new xr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=UA((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=G1(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=fV(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=$1(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new xr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}xr.prototype.getFlatCoordinates=xr.prototype.getOrientedFlatCoordinates;function LP(n,e,t=0,i=n.length-1,r=o3){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,f=Math.log(u),m=.5*Math.exp(2*f/3),_=.5*Math.sqrt(f*m*(u-m)/u)*(h-u/2<0?-1:1),v=Math.max(t,Math.floor(e-h*m/u+_)),S=Math.min(i,Math.floor(e+(u-h)*m/u+_));LP(n,e,v,S,r)}const s=n[e];let o=t,l=i;for(Fh(n,t,e),r(n[i],s)>0&&Fh(n,t,i);o<l;){for(Fh(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?Fh(n,t,l):(l++,Fh(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function Fh(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function o3(n,e){return n<e?-1:n>e?1:0}let OP=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!ip(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],u=t.leaf?r(l):l;ip(e,u)&&(t.leaf?i.push(l):B_(e,u)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!ip(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(ip(e,o)){if(t.leaf||B_(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=zc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=a3(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&B_(i,r)?(s.push(i),o.push(l),l=0,u=i,i=i.children[0]):u?(l++,i=u.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=zc(e.slice(t,i+1)),Cc(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=zc([]),l.leaf=!1,l.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));yb(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const m=Math.min(f+h-1,i);yb(e,f,m,u,this.compareMinY);for(let _=f;_<=m;_+=u){const v=Math.min(_+u-1,m);l.children.push(this._build(e,_,v,r-1))}}return Cc(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let u=0;u<t.children.length;u++){const h=t.children[u],f=U_(h),m=u3(e,h)-f;m<o?(o=m,s=f<s?f:s,l=h):m===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Jh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=zc(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,Cc(i,this.toBBox),Cc(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=zc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Cc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const u=Qh(e,0,l,this.toBBox),h=Qh(e,l,i,this.toBBox),f=h3(u,h),m=U_(u)+U_(h);f<s?(s=f,r=l,o=m<o?m:o):f===s&&m<o&&(o=m,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:l3,s=e.leaf?this.compareMinY:c3,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Qh(e,0,t,s),l=Qh(e,i-t,i,s);let u=np(o)+np(l);for(let h=t;h<i-t;h++){const f=e.children[h];Jh(o,e.leaf?s(f):f),u+=np(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];Jh(l,e.leaf?s(f):f),u+=np(l)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Jh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():Cc(e[t],this.toBBox)}};function a3(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function Cc(n,e){Qh(n,0,n.children.length,e,n)}function Qh(n,e,t,i,r){r||(r=zc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Jh(r,n.leaf?i(o):o)}return r}function Jh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function l3(n,e){return n.minX-e.minX}function c3(n,e){return n.minY-e.minY}function U_(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function np(n){return n.maxX-n.minX+(n.maxY-n.minY)}function u3(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function h3(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function B_(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function ip(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function zc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function yb(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;LP(n,o,e,t,r),s.push(e,o,o,t)}}class _b{constructor(e){this.rbush_=new OP(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[st(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=u,this.items_[st(l)]=u}this.rbush_.load(i)}remove(e){const t=st(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[st(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Nd(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return gu(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return oa(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class jP extends _s{constructor(e){super(),this.projection=Vn(e.projection),this.attributions_=xb(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=xb(e),this.changed()}setState(e){this.state_=e,this.changed()}}function xb(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const Xi={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class ko extends ro{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class r0 extends jP{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=kd,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(ut(this.format_,"`format` must be set when `url` is set"),this.loader_=gb(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:t3;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new _b:null,this.loadedExtentsRtree_=new _b,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Ji(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=st(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new ko(Xi.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof xr||(this.featureChangeKeys_[e]=[rt(t,Ge.CHANGE,this.handleFeatureChange_,this),rt(t,fu.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof xr){const s=this.idIndex_[r];s instanceof xr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(ut(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],u=st(l);this.addToIndex_(u,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],u=st(l);this.setupChangeEvents_(u,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(Xi.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new ko(Xi.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Xi.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(Xi.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(oi.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(oi.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(At);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new ko(Xi.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof xr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof xr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),gu(this.nullGeometryFeatures_)||k1(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=ZA(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||Pd,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const f=h.getGeometry(),m=l;if(l=f instanceof xr?0:f.closestPointXY(i,r,o,l),l<m){s=h;const _=Math.sqrt(l);u[0]=i-_,u[1]=r-_,u[2]=i+_,u[3]=r+_}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=st(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new ko(Xi.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:st(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&gu(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const u=s[o];r.forEachInExtent(u,function(f){return Zh(f.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new ko(Xi.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new ko(Xi.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new ko(Xi.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Nd(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=st(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(At),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(Xi.REMOVEFEATURE)&&this.dispatchEvent(new ko(Xi.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){ut(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(gb(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class ki{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new ki({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=em(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Ue.IDLE&&t.load(),t.getImageState()===Ue.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?st(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:_u(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class ca{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new ca({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function vb(n){return n[0]>0&&n[1]>0}function d3(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function fi(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class s0{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=fi(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new s0({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return it()}getImage(e){return it()}getHitDetectionImage(){return it()}getPixelRatio(e){return 1}getImageState(){return it()}getImageSize(){return it()}getOrigin(){return it()}getSize(){return it()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=fi(e)}listenImageChange(e){it()}load(){it()}unlistenImageChange(e){it()}ready(){return Promise.resolve()}}class o0 extends s0{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Ue.LOADING:Ue.LOADED,this.imageState_===Ue.LOADING&&this.ready().then(()=>this.imageState_=Ue.LOADED),this.render()}clone(){const e=this.getScale(),t=new o0({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=tr.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=en(o,o);this.draw_(s,l,e),r=l.canvas,tr.set(i,null,null,new SP(r,void 0,null,Ue.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const z=r;r=s,s=z}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,u=s*Math.sin(l),h=Math.sqrt(s*s-u*u),f=r-h,m=Math.sqrt(u*u+f*f),_=m/u;if(e==="miter"&&_<=i)return _*t;const v=t/2/_,S=t/2*(f/m),T=Math.sqrt((r+v)*(r+v)+S*S)-r;if(this.radius2_===void 0||e==="bevel")return T*2;const R=r*Math.sin(l),M=Math.sqrt(r*r-R*R),N=s-M,A=Math.sqrt(R*R+N*N)/R;if(A<=i){const z=A*t/2-s-r;return 2*Math.max(T,z)}return T*2}createRenderOptions(){let e=xu,t=vu,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=os(this.stroke_.getColor()??Md),l=this.stroke_.getWidth()??Od,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??vu,e=this.stroke_.getLineCap()??xu,i=this.stroke_.getMiterLimit()??Dd);const u=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ai),t.fillStyle=os(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=_u(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=en(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const u=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ai,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class to extends o0{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new to({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class qn{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=wb,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new qn({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=wb,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function f3(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(ut(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let W_=null;function FP(n,e){if(!W_){const t=new ki({color:"rgba(255,255,255,0.4)"}),i=new ca({color:"#3399CC",width:1.25});W_=[new qn({image:new to({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return W_}function wb(n){return n.getGeometry()}const g3="#333";class vf{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=fi(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new ki({color:g3}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new vf({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof ki?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=fi(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const jn={ANIMATING:0,INTERACTING:1},Ae={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},rp=[Ae.FILL],Zo=[Ae.STROKE],cl=[Ae.BEGIN_PATH],Eb=[Ae.CLOSE_PATH];class wf extends IP{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,u=e.length;l<u;l+=t)r[0]=e[l],r[1]=e[l+1],pu(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let u=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],m=e[t+1];const _=this.tmpCoordinate_;let v=!0,S,I,T;for(S=t+r;S<i;S+=r)_[0]=e[S],_[1]=e[S+1],T=$x(h,_),T!==I?(v&&(l[u++]=f,l[u++]=m,v=!1),l[u++]=_[0],l[u++]=_[1]):T===cn.INTERSECTING?(l[u++]=_[0],l[u++]=_[1],v=!1):v=!0,f=_[0],m=_[1],I=T;return(s&&v||S===t+r)&&(l[u++]=f,l[u++]=m),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),u=this.coordinates.length;let h,f,m,_,v;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),_=[];const S=e.getEndss();v=0;for(let I=0,T=S.length;I<T;++I){const R=[];v=this.drawCustomCoordinates_(h,v,S[I],l,R),_.push(R)}this.instructions.push([Ae.CUSTOM,u,_,e,i,ib,s]),this.hitDetectionInstructions.push([Ae.CUSTOM,u,_,e,r||i,ib,s]);break;case"Polygon":case"MultiLineString":m=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),v=this.drawCustomCoordinates_(h,0,e.getEnds(),l,m),this.instructions.push([Ae.CUSTOM,u,m,e,i,Qp,s]),this.hitDetectionInstructions.push([Ae.CUSTOM,u,m,e,r||i,Qp,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Ae.CUSTOM,u,f,e,i,eu,s]),this.hitDetectionInstructions.push([Ae.CUSTOM,u,f,e,r||i,eu,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>u&&(this.instructions.push([Ae.CUSTOM,u,f,e,i,eu,s]),this.hitDetectionInstructions.push([Ae.CUSTOM,u,f,e,r||i,eu,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Ae.CUSTOM,u,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Ae.CUSTOM,u,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Ae.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ae.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Ae.END_GEOMETRY?o=t:s==Ae.BEGIN_GEOMETRY&&(r[2]=t,u4(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=os(i||ai)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=os(i||Md);const r=e.getLineCap();t.lineCap=r!==void 0?r:xu;const s=e.getLineDash();t.lineDash=s?s.slice():Ys;const o=e.getLineDashOffset();t.lineDashOffset=o||Zs;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:vu;const u=e.getWidth();t.lineWidth=u!==void 0?u:Od;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Dd,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Ae.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ae.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!pa(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Ae.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=WA(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;N1(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class p3 extends wf{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!pu(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Ae.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ae.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||pu(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ae.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ae.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class m3 extends wf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Ae.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ae.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ys,Zs],cl);const l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push(Zo),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ae.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ys,Zs],cl);const l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let m=0,_=l.length;m<_;++m)f=this.drawFlatCoordinates_(u,f,l[m],h);this.hitDetectionInstructions.push(Zo),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Zo),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Zo),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(cl)}}class Tb extends wf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,u=i.length;this.instructions.push(cl),this.hitDetectionInstructions.push(cl);for(let h=0;h<u;++h){const f=i[h],m=this.coordinates.length,_=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),v=[Ae.MOVE_TO_LINE_TO,m,_];this.instructions.push(v),this.hitDetectionInstructions.push(v),l&&(this.instructions.push(Eb),this.hitDetectionInstructions.push(Eb)),t=f}return o&&(this.instructions.push(rp),this.hitDetectionInstructions.push(rp)),l&&(this.instructions.push(Zo),this.hitDetectionInstructions.push(Zo)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ae.SET_FILL_STYLE,ai]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ae.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ys,Zs]);const l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);const f=[Ae.CIRCLE,h];this.instructions.push(cl,f),this.hitDetectionInstructions.push(cl,f),r.fillStyle!==void 0&&(this.instructions.push(rp),this.hitDetectionInstructions.push(rp)),r.strokeStyle!==void 0&&(this.instructions.push(Zo),this.hitDetectionInstructions.push(Zo)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ae.SET_FILL_STYLE,ai]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ae.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ys,Zs]);const l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ae.SET_FILL_STYLE,ai]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ae.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ys,Zs]);const l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let m=0,_=l.length;m<_;++m)f=this.drawFlatCoordinatess_(u,f,l[m],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Xa(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function y3(n,e,t,i,r){const s=[];let o=t,l=0,u=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=u.slice(-2),m=e[o+r],_=e[o+r+1],v=Math.sqrt((m-h)*(m-h)+(_-f)*(_-f));if(l+=v,l>=n){const S=(n-l+v)/v,I=bi(h,m,S),T=bi(f,_,S);u.push(I,T),s.push(u),u=[I,T],l==n&&(o+=r),l=0}else if(l<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const S=v-l,I=bi(h,m,S/v),T=bi(f,_,S/v);u.push(I,T),s.push(u),u=[I,T],l=0,o+=r}}return l>0&&s.push(u),s}function _3(n,e,t,i,r){let s=t,o=t,l=0,u=0,h=t,f,m,_,v,S,I,T,R,M,N;for(m=t;m<i;m+=r){const L=e[m],A=e[m+1];S!==void 0&&(M=L-S,N=A-I,v=Math.sqrt(M*M+N*N),T!==void 0&&(u+=_,f=Math.acos((T*M+R*N)/(_*v)),f>n&&(u>l&&(l=u,s=h,o=m),u=0,h=m-r)),_=v,T=M,R=N),S=L,I=A}return u+=v,u>l?[h,m]:[s,o]}const nm={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class x3 extends wf{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ai]={fillStyle:ai},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let u=l.length;const h=e.getType();let f=null,m=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!ui(this.maxExtent,e.getExtent()))return;let _;if(f=e.getFlatCoordinates(),h=="LineString")_=[f.length];else if(h=="MultiLineString")_=e.getEnds();else if(h=="Polygon")_=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const T=e.getEndss();_=[];for(let R=0,M=T.length;R<M;++R)_.push(T[R][0])}this.beginGeometry(e,t,i);const v=o.repeat,S=v?void 0:o.textAlign;let I=0;for(let T=0,R=_.length;T<R;++T){let M;v?M=y3(v*this.resolution,f,I,_[T],m):M=[f.slice(I,_[T])];for(let N=0,L=M.length;N<L;++N){const A=M[N];let z=0,P=A.length;if(S==null){const k=_3(o.maxAngle,A,0,A.length,2);z=k[0],P=k[1]}for(let k=z;k<P;k+=m)l.push(A[k],A[k+1]);const b=l.length;I=_[T],this.drawChars_(u,b),u=b}}this.endGeometry(t)}else{let _=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),m=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||_.push(f[2]/this.resolution),m=3;break;case"MultiPolygon":const L=e.getFlatInteriorPoints();f=[];for(let A=0,z=L.length;A<z;A+=3)o.overflow||_.push(L[A+2]/this.resolution),f.push(L[A],L[A+1]);if(f.length===0)return;m=2;break}const v=this.appendFlatPointCoordinates(f,m);if(v===u)return;if(_&&(v-u)/2!==f.length/m){let L=u/2;_=_.filter((A,z)=>{const P=l[(L+z)*2]===f[z*m]&&l[(L+z)*2+1]===f[z*m+1];return P||--L,P})}this.saveTextStates_();const S=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,I=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let T=o.padding;if(T!=ll&&(o.scale[0]<0||o.scale[1]<0)){let L=o.padding[0],A=o.padding[1],z=o.padding[2],P=o.padding[3];o.scale[0]<0&&(A=-A,P=-P),o.scale[1]<0&&(L=-L,z=-z),T=[L,A,z,P]}const R=this.pixelRatio;this.instructions.push([Ae.DRAW_IMAGE,u,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,T==ll?ll:T.map(function(L){return L*R}),S,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]);const M=1/R,N=S?S.slice(0):null;N&&(N[1]=ai),this.hitDetectionInstructions.push([Ae.DRAW_IMAGE,u,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[M,M],NaN,this.declutterMode_,this.declutterImageWithText_,T,N,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ai:this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Ld,justify:t.justify,textBaseline:t.textBaseline||tm,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=nm[r.textBaseline],f=this.textOffsetY_*u,m=this.text_,_=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Ae.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,u,f,s,_*u,m,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ae.DRAW_CHARS,e,t,h,r.overflow,l&&ai,r.maxAngle,u,f,s,_*u,m,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=os(o.getColor()||ai)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const I=l.getLineDash(),T=l.getLineDashOffset(),R=l.getWidth(),M=l.getMiterLimit();s.lineCap=l.getLineCap()||xu,s.lineDash=I?I.slice():Ys,s.lineDashOffset=T===void 0?Zs:T,s.lineJoin=l.getLineJoin()||vu,s.lineWidth=R===void 0?Od:R,s.miterLimit=M===void 0?Dd:M,s.strokeStyle=os(l.getColor()||Md)}i=this.textState_;const u=e.getFont()||bP;OV(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||tm,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||ll,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),m=e.getOffsetY(),_=e.getRotateWithView(),v=e.getKeepUpright(),S=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=m===void 0?0:m,this.textRotateWithView_=_===void 0?!1:_,this.textKeepUpright_=v===void 0?!0:v,this.textRotation_=S===void 0?0:S,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:st(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+st(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const v3={Circle:Tb,Default:wf,Image:p3,LineString:m3,Polygon:Tb,Text:x3};class w3{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=v3[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function E3(n,e,t,i,r,s,o,l,u,h,f,m,_=!0){let v=n[e],S=n[e+1],I=0,T=0,R=0,M=0;function N(){I=v,T=S,e+=i,v=n[e],S=n[e+1],M+=R,R=Math.sqrt((v-I)*(v-I)+(S-T)*(S-T))}do N();while(e<t-i&&M+R<s);let L=R===0?0:(s-M)/R;const A=bi(I,v,L),z=bi(T,S,L),P=e-i,b=M,k=s+l*u(h,r,f);for(;e<t-i&&M+R<k;)N();L=R===0?0:(k-M)/R;const F=bi(I,v,L),V=bi(T,S,L);let U=!1;if(_)if(m){const re=[A,z,F,V];cP(re,0,4,2,m,re,re),U=re[0]>re[2]}else U=A>F;const O=Math.PI,se=[],pe=P+i===e;e=P,R=0,M=b,v=n[e],S=n[e+1];let J;if(pe){N(),J=Math.atan2(S-T,v-I),U&&(J+=J>0?-O:O);const re=(F+A)/2,Y=(V+z)/2;return se[0]=[re,Y,(k-s)/2,J,r],se}r=r.replace(/\n/g," ");for(let re=0,Y=r.length;re<Y;){N();let H=Math.atan2(S-T,v-I);if(U&&(H+=H>0?-O:O),J!==void 0){let xe=H-J;if(xe+=xe>O?-2*O:xe<-O?2*O:0,Math.abs(xe)>o)return null}J=H;const X=re;let W=0;for(;re<Y;++re){const xe=U?Y-re-1:re,Te=l*u(h,r[xe],f);if(e+i<t&&M+R<s+W+Te/2)break;W+=Te}if(re===X)continue;const G=U?r.substring(Y-X,Y-re):r.substring(X,re);L=R===0?0:(s+W/2-M)/R;const oe=bi(I,v,L),ge=bi(T,S,L);se.push([oe,ge,W/2,H,G]),s+=W}return se}class VP{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Jp(),{get:(e,t)=>{if(typeof Jp()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Rc=ir(),No=[],Fs=[],Vs=[],Do=[];function Sb(n){return n[3].declutterBox}const Ib=new RegExp("[-----]");function G_(n,e){return e==="start"?e=Ib.test(n)?"right":"left":e==="end"&&(e=Ib.test(n)?"left":"right"),nm[e]}function T3(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function S3(n,e,t){return t%2===0&&(n+=e),n}class I3{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Cr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new VP:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,f=[u.scale[0]*h,u.scale[1]*h],m=u.justify?nm[u.justify]:G_(Array.isArray(e)?e[0]:e,u.textAlign||Ld),_=r&&o.lineWidth?o.lineWidth:0,v=Array.isArray(e)?e:String(e).split(`
`).reduce(T3,[]),{width:S,height:I,widths:T,heights:R,lineWidths:M}=FV(u,v),N=S+_,L=[],A=(N+2)*f[0],z=(I+_)*f[1],P={width:A<0?Math.floor(A):Math.ceil(A),height:z<0?Math.floor(z):Math.ceil(z),contextInstructions:L};(f[0]!=1||f[1]!=1)&&L.push("scale",f),r&&(L.push("strokeStyle",o.strokeStyle),L.push("lineWidth",_),L.push("lineCap",o.lineCap),L.push("lineJoin",o.lineJoin),L.push("miterLimit",o.miterLimit),L.push("setLineDash",[o.lineDash]),L.push("lineDashOffset",o.lineDashOffset)),i&&L.push("fillStyle",l.fillStyle),L.push("textBaseline","middle"),L.push("textAlign","center");const b=.5-m;let k=m*N+b*_;const F=[],V=[];let U=0,O=0,se=0,pe=0,J;for(let re=0,Y=v.length;re<Y;re+=2){const H=v[re];if(H===`
`){O+=U,U=0,k=m*N+b*_,++pe;continue}const X=v[re+1]||u.font;X!==J&&(r&&F.push("font",X),i&&V.push("font",X),J=X),U=Math.max(U,R[se]);const W=[H,k+b*T[se]+m*(T[se]-M[pe]),.5*(_+U)+O];k+=T[se],r&&F.push("strokeText",W),i&&V.push("fillText",W),++se}return Array.prototype.push.apply(L,F),Array.prototype.push.apply(L,V),this.labels_[s]=P,P}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,u,h,f,m,_,v,S,I,T){l*=_[0],u*=_[1];let R=i-l,M=r-u;const N=s+h>e?e-h:s,L=o+f>t?t-f:o,A=S[3]+N*_[0]+S[1],z=S[0]+L*_[1]+S[2],P=R-S[3],b=M-S[0];(I||m!==0)&&(No[0]=P,Do[0]=P,No[1]=b,Fs[1]=b,Fs[0]=P+A,Vs[0]=Fs[0],Vs[1]=b+z,Do[1]=Vs[1]);let k;return m!==0?(k=eo(Cr(),i,r,1,1,m,-i,-r),hn(k,No),hn(k,Fs),hn(k,Vs),hn(k,Do),oa(Math.min(No[0],Fs[0],Vs[0],Do[0]),Math.min(No[1],Fs[1],Vs[1],Do[1]),Math.max(No[0],Fs[0],Vs[0],Do[0]),Math.max(No[1],Fs[1],Vs[1],Do[1]),Rc)):oa(Math.min(P,P+A),Math.min(b,b+z),Math.max(P,P+A),Math.max(b,b+z),Rc),v&&(R=Math.round(R),M=Math.round(M)),{drawImageX:R,drawImageY:M,drawImageW:N,drawImageH:L,originX:h,originY:f,declutterBox:{minX:Rc[0],minY:Rc[1],maxX:Rc[2],maxY:Rc[3],value:T},canvasTransform:k,scale:_}}replayImageOrLabel_(e,t,i,r,s,o,l){const u=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(u&&this.replayTextBackground_(e,No,Fs,Vs,Do,o,l),VV(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=hn(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],u=this.pixelRatio,h=G_(Array.isArray(e)?e[0]:e,s.textAlign||Ld),f=nm[s.textBaseline||tm],m=l&&l.lineWidth?l.lineWidth:0,_=o.width/u-2*s.scale[0],v=h*_+2*(.5-h)*m,S=f*o.height/u+2*(.5-f)*m;return{label:o,anchorX:v,anchorY:S}}execute_(e,t,i,r,s,o,l,u){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&pa(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=ea(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Q4(this.renderedTransform_,i));let m=0;const _=r.length;let v=0,S,I,T,R,M,N,L,A,z,P,b,k,F,V=0,U=0;const O=this.coordinateCache_,se=this.viewRotation_,pe=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,J={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:se},re=this.instructions!=r||this.overlaps?0:200;let Y,H,X,W;for(;m<_;){const G=r[m];switch(G[0]){case Ae.BEGIN_GEOMETRY:Y=G[1],W=G[3],Y.getGeometry()?l!==void 0&&!ui(l,W.getExtent())?m=G[2]+1:++m:m=G[2],h&&(h.zIndex=G[4]);break;case Ae.BEGIN_PATH:V>re&&(this.fill_(e),V=0),U>re&&(e.stroke(),U=0),!V&&!U&&(e.beginPath(),M=NaN,N=NaN),++m;break;case Ae.CIRCLE:v=G[1];const ge=f[v],xe=f[v+1],Te=f[v+2],Me=f[v+3],le=Te-ge,Re=Me-xe,He=Math.sqrt(le*le+Re*Re);e.moveTo(ge+He,xe),e.arc(ge,xe,He,0,2*Math.PI,!0),++m;break;case Ae.CLOSE_PATH:e.closePath(),++m;break;case Ae.CUSTOM:v=G[1],S=G[2];const Wt=G[3],sr=G[4],Yn=G[5];J.geometry=Wt,J.feature=Y,m in O||(O[m]=[]);const Zn=O[m];Yn?Yn(f,v,S,2,Zn):(Zn[0]=f[v],Zn[1]=f[v+1],Zn.length=2),h&&(h.zIndex=G[6]),sr(Zn,J),++m;break;case Ae.DRAW_IMAGE:v=G[1],S=G[2],z=G[3],I=G[4],T=G[5];let fn=G[6];const gn=G[7],Qn=G[8],Mi=G[9],_t=G[10];let ht=G[11];const rn=G[12];let Li=G[13];R=G[14]||"declutter";const bt=G[15];if(!z&&G.length>=20){P=G[19],b=G[20],k=G[21],F=G[22];const jt=this.drawLabelWithPointPlacement_(P,b,k,F);z=jt.label,G[3]=z;const Fi=G[23];I=(jt.anchorX-Fi)*this.pixelRatio,G[4]=I;const pn=G[24];T=(jt.anchorY-pn)*this.pixelRatio,G[5]=T,fn=z.height,G[6]=fn,Li=z.width,G[13]=Li}let ao;G.length>25&&(ao=G[25]);let Oi,Mr,or;G.length>17?(Oi=G[16],Mr=G[17],or=G[18]):(Oi=ll,Mr=null,or=null),_t&&pe?ht+=se:!_t&&!pe&&(ht-=se);let Lr=0;for(;v<S;v+=2){if(ao&&ao[Lr++]<Li/this.pixelRatio)continue;const jt=this.calculateImageOrLabelDimensions_(z.width,z.height,f[v],f[v+1],Li,fn,I,T,Qn,Mi,ht,rn,s,Oi,!!Mr||!!or,Y),Fi=[e,t,z,jt,gn,Mr,or];if(u){let pn,Ft,mn;if(bt){const ot=S-v;if(!bt[ot]){bt[ot]={args:Fi,declutterMode:R};continue}const Gt=bt[ot];pn=Gt.args,Ft=Gt.declutterMode,delete bt[ot],mn=Sb(pn)}let yn,sn;if(pn&&(Ft!=="declutter"||!u.collides(mn))&&(yn=!0),(R!=="declutter"||!u.collides(jt.declutterBox))&&(sn=!0),Ft==="declutter"&&R==="declutter"){const ot=yn&&sn;yn=ot,sn=ot}yn&&(Ft!=="none"&&u.insert(mn),this.replayImageOrLabel_.apply(this,pn)),sn&&(R!=="none"&&u.insert(jt.declutterBox),this.replayImageOrLabel_.apply(this,Fi))}else this.replayImageOrLabel_.apply(this,Fi)}++m;break;case Ae.DRAW_CHARS:const ya=G[1],Or=G[2],ji=G[3],Gl=G[4];F=G[5];const jr=G[6],ws=G[7],lo=G[8];k=G[9];const Un=G[10];P=G[11],Array.isArray(P)&&(P=P.reduce(S3,"")),b=G[12];const Es=[G[13],G[13]];R=G[14]||"declutter";const Fr=G[15],Vr=this.textStates[b],Bn=Vr.font,Wn=[Vr.scale[0]*ws,Vr.scale[1]*ws];let gt;Bn in this.widths_?gt=this.widths_[Bn]:(gt={},this.widths_[Bn]=gt);const co=dV(f,ya,Or,2),ar=Math.abs(Wn[0])*hb(Bn,P,gt);if(Gl||ar<=co){const jt=this.textStates[b].textAlign,Fi=(co-ar)*G_(P,jt),pn=E3(f,ya,Or,2,P,Fi,jr,Math.abs(Wn[0]),hb,Bn,gt,pe?0:this.viewRotation_,Fr);e:if(pn){const Ft=[];let mn,yn,sn,ot,Gt;if(k)for(mn=0,yn=pn.length;mn<yn;++mn){Gt=pn[mn],sn=Gt[4],ot=this.createLabel(sn,b,"",k),I=Gt[2]+(Wn[0]<0?-Un:Un),T=ji*ot.height+(.5-ji)*2*Un*Wn[1]/Wn[0]-lo;const Yt=this.calculateImageOrLabelDimensions_(ot.width,ot.height,Gt[0],Gt[1],ot.width,ot.height,I,T,0,0,Gt[3],Es,!1,ll,!1,Y);if(u&&R==="declutter"&&u.collides(Yt.declutterBox))break e;Ft.push([e,t,ot,Yt,1,null,null])}if(F)for(mn=0,yn=pn.length;mn<yn;++mn){Gt=pn[mn],sn=Gt[4],ot=this.createLabel(sn,b,F,""),I=Gt[2],T=ji*ot.height-lo;const Yt=this.calculateImageOrLabelDimensions_(ot.width,ot.height,Gt[0],Gt[1],ot.width,ot.height,I,T,0,0,Gt[3],Es,!1,ll,!1,Y);if(u&&R==="declutter"&&u.collides(Yt.declutterBox))break e;Ft.push([e,t,ot,Yt,1,null,null])}u&&R!=="none"&&u.load(Ft.map(Sb));for(let Yt=0,Vi=Ft.length;Yt<Vi;++Yt)this.replayImageOrLabel_.apply(this,Ft[Yt])}}++m;break;case Ae.END_GEOMETRY:if(o!==void 0){Y=G[1];const jt=o(Y,W,R);if(jt)return jt}++m;break;case Ae.FILL:re?V++:this.fill_(e),++m;break;case Ae.MOVE_TO_LINE_TO:for(v=G[1],S=G[2],H=f[v],X=f[v+1],e.moveTo(H,X),M=H+.5|0,N=X+.5|0,v+=2;v<S;v+=2)H=f[v],X=f[v+1],L=H+.5|0,A=X+.5|0,(v==S-2||L!==M||A!==N)&&(e.lineTo(H,X),M=L,N=A);++m;break;case Ae.SET_FILL_STYLE:this.alignAndScaleFill_=G[2],V&&(this.fill_(e),V=0,U&&(e.stroke(),U=0)),e.fillStyle=G[1],++m;break;case Ae.SET_STROKE_STYLE:U&&(e.stroke(),U=0),this.setStrokeStyle_(e,G),++m;break;case Ae.STROKE:re?U++:e.stroke(),++m;break;default:++m;break}}V&&this.fill_(e),U&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const el=["Polygon","Circle","LineString","Image","Text","Default"],zP=["Image","Text"],b3=el.filter(n=>!zP.includes(n));class C3{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Cr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new I3(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,u=eo(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=en(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let m;this.renderBuffer_!==void 0&&(m=ir(),hd(m,e),N1(m,t*(this.renderBuffer_+r),m));const _=R3(r);let v;function S(A,z,P){const b=f.getImageData(0,0,l,l).data;for(let k=0,F=_.length;k<F;k++)if(b[_[k]]>0){if(!o||P==="none"||v!=="Image"&&v!=="Text"||o.includes(A)){const V=(_[k]-3)/4,U=r-V%l,O=r-(V/l|0),se=s(A,z,U*U+O*O);if(se)return se}f.clearRect(0,0,l,l);break}}const I=Object.keys(this.executorsByZIndex_).map(Number);I.sort(Xs);let T,R,M,N,L;for(T=I.length-1;T>=0;--T){const A=I[T].toString();for(M=this.executorsByZIndex_[A],R=el.length-1;R>=0;--R)if(v=el[R],N=M[v],N!==void 0&&(L=N.executeHitDetection(f,u,i,S,m),L))return L}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return ea(l,0,8,2,e,l),l}isEmpty(){return gu(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(l?c4:Xs),o=o||el;const h=el.length;for(let f=0,m=u.length;f<m;++f){const _=u[f].toString(),v=this.executorsByZIndex_[_];for(let S=0,I=o.length;S<I;++S){const T=o[S],R=v[T];if(R!==void 0){const M=l===null?void 0:R.getZIndexContext(),N=M?M.getContext():e,L=this.maxExtent_&&T!=="Image"&&T!=="Text";if(L&&(N.save(),this.clip(N,i)),!M||T==="Text"||T==="Image"?R.execute(N,t,i,r,s,l):M.pushFunction(A=>R.execute(A,t,i,r,s,l)),L&&N.restore(),M){M.offset();const A=u[f]*h+el.indexOf(T);this.deferredZIndexContexts_[A]||(this.deferredZIndexContexts_[A]=[]),this.deferredZIndexContexts_[A].push(M)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Xs);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const $_={};function R3(n){if($_[n]!==void 0)return $_[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let u=i[l];u||(u=[],i[l]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return $_[n]=r,r}function bb(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let a0=class UP extends s0{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;ut(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||st(o)),ut(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),ut(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=Ue.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?Ue.LOADED:Ue.IDLE:u=Ue.LOADING:u=Ue.LOADED),this.color_=e.color!==void 0?_u(e.color):null,this.iconImage_=em(o,l,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const m=this.getImage(1);if(m.width&&m.height)h=m.width,f=m.height;else if(m instanceof HTMLImageElement){this.initialOptions_=e;const _=()=>{if(this.unlistenImageChange(_),!this.initialOptions_)return;const v=this.iconImage_.getSize();this.setScale(bb(v[0],v[1],e.width,e.height))};this.listenImageChange(_);return}}h!==void 0&&this.setScale(bb(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new UP({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=em(null,e,this.crossOrigin_,Ue.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Ue.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Ue.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Ge.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Ge.CHANGE,e)}ready(){return this.iconImage_.ready()}};const rs=.5;function A3(n,e,t,i,r,s,o,l,u){const h=r,f=n[0]*rs,m=n[1]*rs,_=en(f,m);_.imageSmoothingEnabled=!1;const v=_.canvas,S=new UV(_,rs,r,null,o,l,null),I=t.length,T=Math.floor((256*256*256-1)/I),R={};for(let N=1;N<=I;++N){const L=t[N-1],A=L.getStyleFunction()||i;if(!A)continue;let z=A(L,s);if(!z)continue;Array.isArray(z)||(z=[z]);const b=(N*T).toString(16).padStart(7,"#00000");for(let k=0,F=z.length;k<F;++k){const V=z[k],U=V.getGeometryFunction()(L);if(!U||!ui(h,U.getExtent()))continue;const O=V.clone(),se=O.getFill();se&&se.setColor(b);const pe=O.getStroke();pe&&(pe.setColor(b),pe.setLineDash(null)),O.setText(void 0);const J=V.getImage();if(J){const X=J.getImageSize();if(!X)continue;const W=en(X[0],X[1],void 0,{alpha:!1}),G=W.canvas;W.fillStyle=b,W.fillRect(0,0,G.width,G.height),O.setImage(new a0({img:G,anchor:J.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:J.getOrigin(),opacity:1,size:J.getSize(),scale:J.getScale(),rotation:J.getRotation(),rotateWithView:J.getRotateWithView()}))}const re=O.getZIndex()||0;let Y=R[re];Y||(Y={},R[re]=Y,Y.Polygon=[],Y.Circle=[],Y.LineString=[],Y.Point=[]);const H=U.getType();if(H==="GeometryCollection"){const X=U.getGeometriesArrayRecursive();for(let W=0,G=X.length;W<G;++W){const oe=X[W];Y[oe.getType().replace("Multi","")].push(oe,O)}}else Y[H.replace("Multi","")].push(U,O)}}const M=Object.keys(R).map(Number).sort(Xs);for(let N=0,L=M.length;N<L;++N){const A=R[M[N]];for(const z in A){const P=A[z];for(let b=0,k=P.length;b<k;b+=2){S.setStyle(P[b+1]);for(let F=0,V=e.length;F<V;++F)S.setTransform(e[F]),S.drawGeometry(P[b])}}}return _.getImageData(0,0,v.width,v.height)}function P3(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*rs),s=Math.floor(Math.round(n[1])*rs),o=(Tt(r,0,t.width-1)+Tt(s,0,t.height-1)*t.width)*4,l=t.data[o],u=t.data[o+1],f=t.data[o+2]+256*(u+256*l),m=Math.floor((256*256*256-1)/e.length);f&&f%m===0&&i.push(e[f/m-1])}return i}class BP extends ro{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const k3=5;class N3 extends mf{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=k3}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return it()}getData(e){return null}prepareFrame(e){return it()}renderFrame(e,t){return it()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Ue.LOADED||t.getState()===Ue.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Ue.LOADED&&t!=Ue.ERROR&&e.addEventListener(Ge.CHANGE,this.boundHandleImageChange_),t==Ue.IDLE&&(e.load(),t=e.getState()),t==Ue.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const Cb=[];let Uc=null;function D3(){Uc=en(1,1,void 0,{willReadFrequently:!0})}class WP extends N3{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Cr(),this.pixelTransform=Cr(),this.inversePixelTransform=Cr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Uc||D3(),Uc.clearRect(0,0,1,1);let r;try{Uc.drawImage(e,t,i,1,1,0,0,1,1),r=Uc.getImageData(0,0,1,1).data}catch{return Uc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&pa(_u(e.style.backgroundColor),_u(i)))){const l=e.firstElementChild;Yo(l)&&(o=l.getContext("2d"))}if(o&&nV(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Ri?wP():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=en();const u=o.canvas;s.appendChild(u),l=u.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Vl(i),s=Qm(i),o=Zm(i),l=Ym(i);hn(t.coordinateToPixelTransform,r),hn(t.coordinateToPixelTransform,s),hn(t.coordinateToPixelTransform,o),hn(t.coordinateToPixelTransform,l);const u=this.inversePixelTransform;hn(u,r),hn(u,s),hn(u,o),hn(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(ct(i)/r*o),u=Math.round(Kn(i)/r*o);eo(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-u/2),lP(this.inversePixelTransform,this.pixelTransform);const h=tV(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=u?(f.width=l,f.height=u):this.context.clearRect(0,0,l,u),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new BP(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(er.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(er.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new VP),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(er.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(er.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const u=s/2,h=o/2,f=r/t,m=-f,_=-e[0]+l,v=-e[1];return eo(this.tempTransform,u,h,f,m,-i,_,v)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class M3 extends WP{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=ir(),this.wrappedRenderedExtent_=ir(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,u=s.projection,h=s.rotation,f=u.getExtent(),m=this.getLayer().getSource(),_=this.getLayer().getDeclutter(),v=t.pixelRatio,S=t.viewHints,I=!(S[jn.ANIMATING]||S[jn.INTERACTING]),T=this.context,R=Math.round(ct(r)/l*v),M=Math.round(Kn(r)/l*v),N=m.getWrapX()&&u.canWrapX(),L=N?ct(f):null,A=N?Math.ceil((r[2]-f[2])/L)+1:1;let z=N?Math.floor((r[0]-f[0])/L):0;do{let P=this.getRenderTransform(o,l,0,v,R,M,z*L);t.declutter&&(P=P.slice(0)),e.execute(T,[T.canvas.width,T.canvas.height],P,h,I,i===void 0?el:i?zP:b3,i?_&&t.declutter[_]:void 0)}while(++z<A)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=en(this.context.canvas.width,this.context.canvas.height,Cb))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,i0(this.context),Cb.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(er.PRERENDER)||this.getLayer().hasListener(er.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const u=Xo(i.extent);l=ui(u,e.extent),this.clipped_=l&&!Zh(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],m=i[0]*rs,_=i[1]*rs;f.push(this.getRenderTransform(r,s,o,rs,m,_,0).slice());const v=h.getSource(),S=l.getExtent();if(v.getWrapX()&&l.canWrapX()&&!Zh(S,u)){let I=u[0];const T=ct(S);let R=0,M;for(;I<S[0];)--R,M=T*R,f.push(this.getRenderTransform(r,s,o,rs,m,_,M).slice()),I+=T;for(R=0,I=u[2];I>S[2];)++R,M=T*R,f.push(this.getRenderTransform(r,s,o,rs,m,_,M).slice()),I-=T}this.hitDetectionImageData_=A3(i,f,this.renderedFeatures_,h.getStyleFunction(),u,s,o,db(s,this.renderedPixelRatio_))}t(P3(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},f=function(_,v,S){const I=st(_),T=h[I];if(T){if(T!==!0&&S<T.distanceSq){if(S===0)return h[I]=!0,s.splice(s.lastIndexOf(T),1),r(_,u,v);T.geometry=v,T.distanceSq=S}}else{if(S===0)return h[I]=!0,r(_,u,v);s.push(h[I]={feature:_,layer:u,geometry:v,distanceSq:S,callback:r})}},m=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,m?t.declutter?.[m]?.all().map(_=>_.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[jn.ANIMATING],s=e.viewHints[jn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,f=h.projection,m=h.resolution,_=e.pixelRatio,v=t.getRevision(),S=t.getRenderBuffer();let I=t.getRenderOrder();I===void 0&&(I=WV);const T=h.center.slice(),R=N1(u,S*m),M=R.slice(),N=[R.slice()],L=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Zh(L,e.extent)){const se=ct(L),pe=Math.max(ct(R)/2,se);R[0]=L[0]-pe,R[2]=L[2]+pe,QA(T,f);const J=YA(N[0],f);J[0]<L[0]&&J[2]<L[2]?N.push([J[0]+se,J[1],J[2]+se,J[3]]):J[0]>L[0]&&J[2]>L[2]&&N.push([J[0]-se,J[1],J[2]-se,J[3]])}if(this.ready&&this.renderedResolution_==m&&this.renderedRevision_==v&&this.renderedRenderOrder_==I&&this.renderedFrameDeclutter_===!!e.declutter&&Zh(this.wrappedRenderedExtent_,R))return pa(this.renderedExtent_,M)||(this.hitDetectionImageData_=null,this.renderedExtent_=M),this.renderedCenter_=T,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const A=new w3(PP(m,_),R,m,_);let z;for(let se=0,pe=N.length;se<pe;++se)i.loadFeatures(N[se],m,f);const P=db(m,_);let b=!0;const k=(se,pe)=>{let J;const re=se.getStyleFunction()||t.getStyleFunction();if(re&&(J=re(se,m)),J){const Y=this.renderFeature(se,P,J,A,z,this.getLayer().getDeclutter(),pe);b=b&&!Y}},F=aP(R),V=i.getFeaturesInExtent(F);I&&V.sort(I);for(let se=0,pe=V.length;se<pe;++se)k(V[se],se);this.renderedFeatures_=V,this.ready=b;const U=A.finish(),O=new C3(R,m,_,i.getOverlaps(),U,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=m,this.renderedRevision_=v,this.renderedRenderOrder_=I,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=M,this.wrappedRenderedExtent_=R,this.renderedCenter_=T,this.renderedProjection_=f,this.renderedPixelRatio_=_,this.replayGroup_=O,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)u=fb(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||u;else u=fb(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return u}}let zl=0;const Hn=1<<zl++,Ze=1<<zl++,li=1<<zl++,vr=1<<zl++,bl=1<<zl++,ed=1<<zl++,sp=Math.pow(2,zl)-1,J1={[Hn]:"boolean",[Ze]:"number",[li]:"string",[vr]:"color",[bl]:"number[]",[ed]:"size"},L3=Object.keys(J1).map(Number).sort(Xs);function O3(n){return n in J1}function td(n){const e=[];for(const t of L3)nd(n,t)&&e.push(J1[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function nd(n,e){return(n&e)===e}function Mo(n,e){return n===e}class Jt{constructor(e,t){if(!O3(e))throw new Error(`literal expressions must have a specific type, got ${td(e)}`);this.type=e,this.value=t}}class j3{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function GP(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Rn(n,e,t){switch(typeof n){case"boolean":{if(Mo(e,li))return new Jt(li,n?"true":"false");if(!nd(e,Hn))throw new Error(`got a boolean, but expected ${td(e)}`);return new Jt(Hn,n)}case"number":{if(Mo(e,ed))return new Jt(ed,fi(n));if(Mo(e,Hn))return new Jt(Hn,!!n);if(Mo(e,li))return new Jt(li,n.toString());if(!nd(e,Ze))throw new Error(`got a number, but expected ${td(e)}`);return new Jt(Ze,n)}case"string":{if(Mo(e,vr))return new Jt(vr,q1(n));if(Mo(e,Hn))return new Jt(Hn,!!n);if(!nd(e,li))throw new Error(`got a string, but expected ${td(e)}`);return new Jt(li,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return q3(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Mo(e,ed)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Jt(ed,n)}if(Mo(e,vr)){if(n.length===3)return new Jt(vr,[...n,1]);if(n.length===4)return new Jt(vr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!nd(e,bl))throw new Error(`got an array of numbers, but expected ${td(e)}`);return new Jt(bl,n)}const ae={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},F3={[ae.Get]:Ve($e(1,1/0),Rb),[ae.Var]:Ve($e(1,1),V3),[ae.Has]:Ve($e(1,1/0),Rb),[ae.Id]:Ve(z3,Ac),[ae.Concat]:Ve($e(2,1/0),lt(li)),[ae.GeometryType]:Ve(U3,Ac),[ae.LineMetric]:Ve(Ac),[ae.Resolution]:Ve(H_,Ac),[ae.Zoom]:Ve(H_,Ac),[ae.Time]:Ve(H_,Ac),[ae.Any]:Ve($e(2,1/0),lt(Hn)),[ae.All]:Ve($e(2,1/0),lt(Hn)),[ae.Not]:Ve($e(1,1),lt(Hn)),[ae.Equal]:Ve($e(2,2),lt(sp)),[ae.NotEqual]:Ve($e(2,2),lt(sp)),[ae.GreaterThan]:Ve($e(2,2),lt(Ze)),[ae.GreaterThanOrEqualTo]:Ve($e(2,2),lt(Ze)),[ae.LessThan]:Ve($e(2,2),lt(Ze)),[ae.LessThanOrEqualTo]:Ve($e(2,2),lt(Ze)),[ae.Multiply]:Ve($e(2,1/0),Ab),[ae.Coalesce]:Ve($e(2,1/0),Ab),[ae.Divide]:Ve($e(2,2),lt(Ze)),[ae.Add]:Ve($e(2,1/0),lt(Ze)),[ae.Subtract]:Ve($e(2,2),lt(Ze)),[ae.Clamp]:Ve($e(3,3),lt(Ze)),[ae.Mod]:Ve($e(2,2),lt(Ze)),[ae.Pow]:Ve($e(2,2),lt(Ze)),[ae.Abs]:Ve($e(1,1),lt(Ze)),[ae.Floor]:Ve($e(1,1),lt(Ze)),[ae.Ceil]:Ve($e(1,1),lt(Ze)),[ae.Round]:Ve($e(1,1),lt(Ze)),[ae.Sin]:Ve($e(1,1),lt(Ze)),[ae.Cos]:Ve($e(1,1),lt(Ze)),[ae.Atan]:Ve($e(1,2),lt(Ze)),[ae.Sqrt]:Ve($e(1,1),lt(Ze)),[ae.Match]:Ve($e(4,1/0),Pb,W3),[ae.Between]:Ve($e(3,3),lt(Ze)),[ae.Interpolate]:Ve($e(6,1/0),Pb,G3),[ae.Case]:Ve($e(3,1/0),B3,$3),[ae.In]:Ve($e(2,2),H3),[ae.Number]:Ve($e(1,1/0),lt(sp)),[ae.String]:Ve($e(1,1/0),lt(sp)),[ae.Array]:Ve($e(1,1/0),lt(Ze)),[ae.Color]:Ve($e(1,4),lt(Ze)),[ae.Band]:Ve($e(1,3),lt(Ze)),[ae.Palette]:Ve($e(2,2),K3),[ae.ToString]:Ve($e(1,1),lt(Hn|Ze|li|vr))};function Rb(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Jt(Ze,o);break}case"string":{r[s]=new Jt(li,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function V3(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Jt(li,i)]}function z3(n,e,t){t.featureId=!0}function U3(n,e,t){t.geometryType=!0}function H_(n,e,t){t.mapState=!0}function Ac(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function $e(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function Ab(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Rn(n[s+1],e,t);r[s]=o}return r}function lt(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=Rn(e[o+1],n,i);s[o]=l}return s}}function B3(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function Pb(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function W3(n,e,t){const i=n.length-1,r=li|Ze|Hn,s=Rn(n[1],r,t),o=Rn(n[n.length-1],e,t),l=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=Rn(n[u+2],s.type,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=Rn(n[u+3],o.type,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...l,o]}function G3(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Jt(Ze,r);let o;try{o=Rn(n[2],Ze,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const l=new Array(n.length-3);for(let u=0;u<l.length;u+=2){try{const h=Rn(n[u+3],Ze,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=Rn(n[u+4],e,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function $3(n,e,t){const i=Rn(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Rn(n[s+1],Hn,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Rn(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function H3(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=li}else r=Ze;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const u=Rn(i[l],r,t);s[l]=u}catch(u){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${u.message}`)}return[Rn(n[1],r,t),...s]}function K3(n,e,t){let i;try{i=Rn(n[1],Ze,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=Rn(r[o],vr,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(l instanceof Jt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Ve(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new j3(t,r,...s)}}function q3(n,e,t){const i=n[0],r=F3[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function $P(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return $P(n.getGeometries()[0]);default:return""}}function HP(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function so(n,e,t){const i=Rn(n,e,t);return Pr(i)}function Pr(n,e){if(n instanceof Jt){if(n.type===vr&&typeof n.value=="string"){const i=q1(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case ae.Number:case ae.String:case ae.Coalesce:return X3(n);case ae.Get:case ae.Var:case ae.Has:return Y3(n);case ae.Id:return i=>i.featureId;case ae.GeometryType:return i=>i.geometryType;case ae.Concat:{const i=n.args.map(r=>Pr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case ae.Resolution:return i=>i.resolution;case ae.Any:case ae.All:case ae.Between:case ae.In:case ae.Not:return Q3(n);case ae.Equal:case ae.NotEqual:case ae.LessThan:case ae.LessThanOrEqualTo:case ae.GreaterThan:case ae.GreaterThanOrEqualTo:return Z3(n);case ae.Multiply:case ae.Divide:case ae.Add:case ae.Subtract:case ae.Clamp:case ae.Mod:case ae.Pow:case ae.Abs:case ae.Floor:case ae.Ceil:case ae.Round:case ae.Sin:case ae.Cos:case ae.Atan:case ae.Sqrt:return J3(n);case ae.Case:return e6(n);case ae.Match:return t6(n);case ae.Interpolate:return n6(n);case ae.ToString:return i6(n);default:throw new Error(`Unsupported operator ${t}`)}}function X3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Pr(n.args[s]);switch(t){case ae.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case ae.Number:case ae.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function Y3(n,e){const i=n.args[0].value;switch(n.operator){case ae.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;o=o[f]}return o};case ae.Var:return r=>r.variables[i];case ae.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function Z3(n,e){const t=n.operator,i=Pr(n.args[0]),r=Pr(n.args[1]);switch(t){case ae.Equal:return s=>i(s)===r(s);case ae.NotEqual:return s=>i(s)!==r(s);case ae.LessThan:return s=>i(s)<r(s);case ae.LessThanOrEqualTo:return s=>i(s)<=r(s);case ae.GreaterThan:return s=>i(s)>r(s);case ae.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function Q3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Pr(n.args[s]);switch(t){case ae.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case ae.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case ae.Between:return s=>{const o=r[0](s),l=r[1](s),u=r[2](s);return o>=l&&o<=u};case ae.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case ae.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function J3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Pr(n.args[s]);switch(t){case ae.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case ae.Divide:return s=>r[0](s)/r[1](s);case ae.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case ae.Subtract:return s=>r[0](s)-r[1](s);case ae.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const u=r[2](s);return o>u?u:o};case ae.Mod:return s=>r[0](s)%r[1](s);case ae.Pow:return s=>Math.pow(r[0](s),r[1](s));case ae.Abs:return s=>Math.abs(r[0](s));case ae.Floor:return s=>Math.floor(r[0](s));case ae.Ceil:return s=>Math.ceil(r[0](s));case ae.Round:return s=>Math.round(r[0](s));case ae.Sin:return s=>Math.sin(r[0](s));case ae.Cos:return s=>Math.cos(r[0](s));case ae.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case ae.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function e6(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Pr(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function t6(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Pr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function n6(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Pr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,u;for(let h=2;h<t;h+=2){const f=i[h](r);let m=i[h+1](r);const _=Array.isArray(m);if(_&&(m=CV(m)),f>=o)return h===2?m:_?r6(s,o,l,u,f,m):id(s,o,l,u,f,m);l=f,u=m}return u}}function i6(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Pr(n.args[s]);if(t===ae.ToString)return s=>{const o=r[0](s);return n.args[0].type===vr?X1(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function id(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,u=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function r6(n,e,t,i,r,s){if(r-t===0)return i;const l=ab(i),u=ab(s);let h=u[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[id(n,e,t,l[0],r,u[0]),id(n,e,t,l[1],r,u[1]),l[2]+id(n,e,t,0,r,h),id(n,e,t,i[3],r,s[3])];return RV(f)}function s6(n){return!0}function o6(n){const e=GP(),t=a6(n,e),i=HP();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=$P(r.getGeometry())),t(i)}}function kb(n){const e=GP(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=ov(n[o],e);const r=HP(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[u]=f,u+=1)}return s.length=u,s}}function a6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?so(s.filter,Hn,e):s6;let l;if(Array.isArray(s.style)){const u=s.style.length;l=new Array(u);for(let h=0;h<u;++h)l[h]=ov(s.style[h],e)}else l=[ov(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const u=i[l].filter;if(u(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function ov(n,e){const t=Vd(n,"",e),i=zd(n,"",e),r=l6(n,e),s=c6(n,e),o=hi(n,"z-index",e);if(!t&&!i&&!r&&!s&&!gu(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new qn;return function(u){let h=!0;if(t){const f=t(u);f&&(h=!1),l.setFill(f)}if(i){const f=i(u);f&&(h=!1),l.setStroke(f)}if(r){const f=r(u);f&&(h=!1),l.setText(f)}if(s){const f=s(u);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(u)),h?null:l}}function Vd(n,e,t){let i;if(e+"fill-pattern-src"in n)i=f6(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=ew(n,e+"fill-color",t)}if(!i)return null;const r=new ki;return function(s){const o=i(s);return o===K1?null:(r.setColor(o),r)}}function zd(n,e,t){const i=hi(n,e+"stroke-width",t),r=ew(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Us(n,e+"stroke-line-cap",t),o=Us(n,e+"stroke-line-join",t),l=KP(n,e+"stroke-line-dash",t),u=hi(n,e+"stroke-line-dash-offset",t),h=hi(n,e+"stroke-miter-limit",t),f=new ca;return function(m){if(r){const _=r(m);if(_===K1)return null;f.setColor(_)}if(i&&f.setWidth(i(m)),s){const _=s(m);if(_!=="butt"&&_!=="round"&&_!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(_)}if(o){const _=o(m);if(_!=="bevel"&&_!=="round"&&_!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(_)}return l&&f.setLineDash(l(m)),u&&f.setLineDashOffset(u(m)),h&&f.setMiterLimit(h(m)),f}}function l6(n,e){const t="text-",i=Us(n,t+"value",e);if(!i)return null;const r=Vd(n,t,e),s=Vd(n,t+"background-",e),o=zd(n,t,e),l=zd(n,t+"background-",e),u=Us(n,t+"font",e),h=hi(n,t+"max-angle",e),f=hi(n,t+"offset-x",e),m=hi(n,t+"offset-y",e),_=ru(n,t+"overflow",e),v=Us(n,t+"placement",e),S=hi(n,t+"repeat",e),I=l0(n,t+"scale",e),T=ru(n,t+"rotate-with-view",e),R=hi(n,t+"rotation",e),M=Us(n,t+"align",e),N=Us(n,t+"justify",e),L=Us(n,t+"baseline",e),A=ru(n,t+"keep-upright",e),z=KP(n,t+"padding",e),P=c0(n,t+"declutter-mode"),b=new vf({declutterMode:P});return function(k){if(b.setText(i(k)),r&&b.setFill(r(k)),s&&b.setBackgroundFill(s(k)),o&&b.setStroke(o(k)),l&&b.setBackgroundStroke(l(k)),u&&b.setFont(u(k)),h&&b.setMaxAngle(h(k)),f&&b.setOffsetX(f(k)),m&&b.setOffsetY(m(k)),_&&b.setOverflow(_(k)),v){const F=v(k);if(F!=="point"&&F!=="line")throw new Error("Expected point or line for text-placement");b.setPlacement(F)}if(S&&b.setRepeat(S(k)),I&&b.setScale(I(k)),T&&b.setRotateWithView(T(k)),R&&b.setRotation(R(k)),M){const F=M(k);if(F!=="left"&&F!=="center"&&F!=="right"&&F!=="end"&&F!=="start")throw new Error("Expected left, right, center, start, or end for text-align");b.setTextAlign(F)}if(N){const F=N(k);if(F!=="left"&&F!=="right"&&F!=="center")throw new Error("Expected left, right, or center for text-justify");b.setJustify(F)}if(L){const F=L(k);if(F!=="bottom"&&F!=="top"&&F!=="middle"&&F!=="alphabetic"&&F!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");b.setTextBaseline(F)}return z&&b.setPadding(z(k)),A&&b.setKeepUpright(A(k)),b}}function c6(n,e){return"icon-src"in n?u6(n,e):"shape-points"in n?h6(n,e):"circle-radius"in n?d6(n,e):null}function u6(n,e){const t="icon-",i=t+"src",r=qP(n[i],i),s=im(n,t+"anchor",e),o=l0(n,t+"scale",e),l=hi(n,t+"opacity",e),u=im(n,t+"displacement",e),h=hi(n,t+"rotation",e),f=ru(n,t+"rotate-with-view",e),m=Db(n,t+"anchor-origin"),_=Mb(n,t+"anchor-x-units"),v=Mb(n,t+"anchor-y-units"),S=y6(n,t+"color"),I=p6(n,t+"cross-origin"),T=m6(n,t+"offset"),R=Db(n,t+"offset-origin"),M=rm(n,t+"width"),N=rm(n,t+"height"),L=g6(n,t+"size"),A=c0(n,t+"declutter-mode"),z=new a0({src:r,anchorOrigin:m,anchorXUnits:_,anchorYUnits:v,color:S,crossOrigin:I,offset:T,offsetOrigin:R,height:N,width:M,size:L,declutterMode:A});return function(P){return l&&z.setOpacity(l(P)),u&&z.setDisplacement(u(P)),h&&z.setRotation(h(P)),f&&z.setRotateWithView(f(P)),o&&z.setScale(o(P)),s&&z.setAnchor(s(P)),z}}function h6(n,e){const t="shape-",i=t+"points",r=t+"radius",s=av(n[i],i),o=av(n[r],r),l=Vd(n,t,e),u=zd(n,t,e),h=l0(n,t+"scale",e),f=im(n,t+"displacement",e),m=hi(n,t+"rotation",e),_=ru(n,t+"rotate-with-view",e),v=rm(n,t+"radius2"),S=rm(n,t+"angle"),I=c0(n,t+"declutter-mode"),T=new o0({points:s,radius:o,radius2:v,angle:S,declutterMode:I});return function(R){return l&&T.setFill(l(R)),u&&T.setStroke(u(R)),f&&T.setDisplacement(f(R)),m&&T.setRotation(m(R)),_&&T.setRotateWithView(_(R)),h&&T.setScale(h(R)),T}}function d6(n,e){const t="circle-",i=Vd(n,t,e),r=zd(n,t,e),s=hi(n,t+"radius",e),o=l0(n,t+"scale",e),l=im(n,t+"displacement",e),u=hi(n,t+"rotation",e),h=ru(n,t+"rotate-with-view",e),f=c0(n,t+"declutter-mode"),m=new to({radius:5,declutterMode:f});return function(_){return s&&m.setRadius(s(_)),i&&m.setFill(i(_)),r&&m.setStroke(r(_)),l&&m.setDisplacement(l(_)),u&&m.setRotation(u(_)),h&&m.setRotateWithView(h(_)),o&&m.setScale(o(_)),m}}function hi(n,e,t){if(!(e in n))return;const i=so(n[e],Ze,t);return function(r){return av(i(r),e)}}function Us(n,e,t){if(!(e in n))return null;const i=so(n[e],li,t);return function(r){return qP(i(r),e)}}function f6(n,e,t){const i=Us(n,e+"pattern-src",t),r=Nb(n,e+"pattern-offset",t),s=Nb(n,e+"pattern-size",t),o=ew(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function ru(n,e,t){if(!(e in n))return null;const i=so(n[e],Hn,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function ew(n,e,t){if(!(e in n))return null;const i=so(n[e],vr,t);return function(r){return XP(i(r),e)}}function KP(n,e,t){if(!(e in n))return null;const i=so(n[e],bl,t);return function(r){return Ef(i(r),e)}}function im(n,e,t){if(!(e in n))return null;const i=so(n[e],bl,t);return function(r){const s=Ef(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function Nb(n,e,t){if(!(e in n))return null;const i=so(n[e],bl,t);return function(r){return YP(i(r),e)}}function l0(n,e,t){if(!(e in n))return null;const i=so(n[e],bl|Ze,t);return function(r){return _6(i(r),e)}}function rm(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function g6(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return fi(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function p6(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function Db(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function Mb(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function m6(n,e){const t=n[e];if(t!==void 0)return Ef(t,e)}function c0(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function y6(n,e){const t=n[e];if(t!==void 0)return XP(t,e)}function Ef(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function qP(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function av(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function XP(n,e){if(typeof n=="string")return n;const t=Ef(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function YP(n,e){const t=Ef(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function _6(n,e){return typeof n=="number"?n:YP(n,e)}const mr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function Lb(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,m=l?l[1]:0;let _=n[0]+u/2+f,v=n[2]-u/2+f,S=n[1]+h/2+m,I=n[3]-h/2+m;_>v&&(_=(v+_)/2,v=_),S>I&&(S=(I+S)/2,I=S);let T=Tt(i[0],_,v),R=Tt(i[1],S,I);if(o&&t&&r){const M=30*r;T+=-M*Math.log(1+Math.max(0,_-i[0])/M)+M*Math.log(1+Math.max(0,i[0]-v)/M),R+=-M*Math.log(1+Math.max(0,S-i[1])/M)+M*Math.log(1+Math.max(0,i[1]-I)/M)}return[T,R]})}function x6(n){return n}function ZP(n){return Math.pow(n,3)}function zu(n){return 1-ZP(1-n)}function v6(n){return 3*n*n-2*n*n*n}function w6(n){return n}function tw(n,e,t,i){const r=ct(e)/t[0],s=Kn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function nw(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Tt(i,t/2,e*2)}function E6(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const u=n[0],h=n[n.length-1],f=t?tw(u,t,o,i):u;if(l)return e?nw(r,f,h):Tt(r,h,f);const m=Math.min(f,r),_=Math.floor(P1(n,m,s));return n[_]>f&&_<n.length-1?n[_+1]:n[_]}})}function T6(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,u,h){if(o!==void 0){const f=r?tw(e,r,u,s):e;if(h)return i?nw(o,f,t):Tt(o,t,f);const m=1e-9,_=Math.ceil(Math.log(e/f)/Math.log(n)-m),v=-l*(.5-m)+.5,S=Math.min(f,o),I=Math.floor(Math.log(e/S)/Math.log(n)+v),T=Math.max(_,I),R=e/Math.pow(n,T);return Tt(R,t,f)}})}function Ob(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,u){if(s!==void 0){const h=i?tw(n,i,l,r):n;return!t||!u?Tt(s,e,h):nw(s,h,e)}})}function iw(n){if(n!==void 0)return 0}function jb(n){if(n!==void 0)return n}function S6(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function I6(n){const e=Jo(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const b6=42,rw=256,K_=0;class ss extends _s{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=V1(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&oP(),e.center&&(e.center=zs(e.center,this.projection_)),e.extent&&(e.extent=Xo(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in mr)delete t[l];this.setProperties(t,!0);const i=R6(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=C6(e),s=i.constraint,o=A6(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=zs(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=zs(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&op(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],m={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||v6,callback:i};if(f.center&&(m.sourceCenter=o,m.targetCenter=f.center.slice(),o=m.targetCenter),f.zoom!==void 0?(m.sourceResolution=l,m.targetResolution=this.getResolutionForZoom(f.zoom),l=m.targetResolution):f.resolution&&(m.sourceResolution=l,m.targetResolution=f.resolution,l=m.targetResolution),f.rotation!==void 0){m.sourceRotation=u;const _=pl(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;m.targetRotation=u+_,u=m.targetRotation}P6(m)?m.complete=!0:s+=m.duration,h.push(m)}this.animations_.push(h),this.setHint(jn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[jn.ANIMATING]>0}getInteracting(){return this.hints_[jn.INTERACTING]>0}cancelAnimations(){this.setHint(jn.ANIMATING,-this.hints_[jn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&op(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let f=u.duration>0?h/u.duration:1;f>=1?(u.complete=!0,f=1):s=!1;const m=u.easing(f);if(u.sourceCenter){const _=u.sourceCenter[0],v=u.sourceCenter[1],S=u.targetCenter[0],I=u.targetCenter[1];this.nextCenter_=u.targetCenter;const T=_+m*(S-_),R=v+m*(I-v);this.targetCenter_=[T,R]}if(u.sourceResolution&&u.targetResolution){const _=m===1?u.targetResolution:u.sourceResolution+m*(u.targetResolution-u.sourceResolution);if(u.anchor){const v=this.getViewportSize_(this.getRotation()),S=this.constraints_.resolution(_,0,v,!0);this.targetCenter_=this.calculateCenterZoom(S,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=_,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const _=m===1?pl(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+m*(u.targetRotation-u.sourceRotation);if(u.anchor){const v=this.constraints_.rotation(_,!0);this.targetCenter_=this.calculateCenterRotate(v,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=_}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(jn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&op(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],M1(i,e-this.getRotation()),E4(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&ev(e,this.getProjection())}getCenterInternal(){return this.get(mr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return aP(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();ut(t,"The view center is not defined");const i=this.getResolution();ut(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return ut(r!==void 0,"The view rotation is not defined"),Kx(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(mr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Xo(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=ct(e)/t[0],r=Kn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(mr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=q_(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=P1(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Tt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Tt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(ut(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){ut(!Jm(e),"Cannot fit empty extent provided as `geometry`");const r=Xo(e,this.getProjection());i=pb(r)}else if(e.getType()==="Circle"){const r=Xo(e.getExtent(),this.getProjection());i=pb(r),i.rotate(this.getRotation(),Tl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,u=1/0,h=-1/0,f=-1/0;for(let m=0,_=s.length;m<_;m+=o){const v=s[m]*i-s[m+1]*r,S=s[m]*r+s[m+1]*i;l=Math.min(l,v),u=Math.min(u,S),h=Math.max(h,v),f=Math.max(f,S)}return[l,u,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),f=Math.sin(h),m=Math.cos(h),_=Tl(l);_[0]+=(r[1]-r[3])/2*u,_[1]+=(r[0]-r[2])/2*u;const v=_[0]*m-_[1]*f,S=_[1]*m+_[0]*f,I=this.getConstrainedCenter([v,S],u),T=t.callback?t.callback:kd;t.duration!==void 0?this.animateInternal({resolution:u,center:I,duration:t.duration,easing:t.easing},T):(this.targetResolution_=u,this.targetCenter_=I,this.applyTargetState_(!1,!0),op(T,!0))}centerOn(e,t,i){this.centerOnInternal(zs(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(q_(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),u=q_(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=ev(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&zs(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=zs(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&zs(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(mr.ROTATION)!==r&&this.set(mr.ROTATION,r),this.get(mr.RESOLUTION)!==o&&(this.set(mr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(mr.CENTER)||!Kp(this.get(mr.CENTER),l))&&this.set(mr.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Kp(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:e,easing:zu,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(jn.INTERACTING,1)}endInteraction(e,t,i){i=i&&zs(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(jn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function op(n,e){setTimeout(function(){n(e)},0)}function C6(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return Lb(n.extent,n.constrainOnlyCenter,t)}const e=V1(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,Lb(t,!1,!1)}return x6}function R6(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:K_,l=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,m=n.showFullExtent!==void 0?n.showFullExtent:!1,_=V1(n.projection,"EPSG:3857"),v=_.getExtent();let S=n.constrainOnlyCenter,I=n.extent;if(!h&&!I&&_.isGlobal()&&(S=!1,I=v),n.resolutions!==void 0){const T=n.resolutions;t=T[o],i=T[l]!==void 0?T[l]:T[T.length-1],n.constrainResolution?e=E6(T,f,!S&&I,m):e=Ob(t,i,f,!S&&I,m)}else{const R=(v?Math.max(ct(v),Kn(v)):360*mu.degrees/_.getMetersPerUnit())/rw/Math.pow(2,K_),M=R/Math.pow(2,28-K_);t=n.maxResolution,t!==void 0?o=0:t=R/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,l):i=R/Math.pow(u,l):i=M),l=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,l-o),n.constrainResolution?e=T6(u,t,i,f,!S&&I,m):e=Ob(t,i,f,!S&&I,m)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function A6(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?I6():t===!1?jb:typeof t=="number"?S6(t):jb}return iw}function P6(n){return!(n.sourceCenter&&n.targetCenter&&!Kp(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function q_(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-u*o,f=u*s+l*o;return[h,f]}const ft={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class QP extends _s{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[ft.OPACITY]=e.opacity!==void 0?e.opacity:1,ut(typeof t[ft.OPACITY]=="number","Layer opacity must be a number"),t[ft.VISIBLE]=e.visible!==void 0?e.visible:!0,t[ft.Z_INDEX]=e.zIndex,t[ft.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[ft.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[ft.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[ft.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Tt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return it()}getLayerStatesArray(e){return it()}getExtent(){return this.get(ft.EXTENT)}getMaxResolution(){return this.get(ft.MAX_RESOLUTION)}getMinResolution(){return this.get(ft.MIN_RESOLUTION)}getMinZoom(){return this.get(ft.MIN_ZOOM)}getMaxZoom(){return this.get(ft.MAX_ZOOM)}getOpacity(){return this.get(ft.OPACITY)}getSourceState(){return it()}getVisible(){return this.get(ft.VISIBLE)}getZIndex(){return this.get(ft.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(ft.EXTENT,e)}setMaxResolution(e){this.set(ft.MAX_RESOLUTION,e)}setMinResolution(e){this.set(ft.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(ft.MAX_ZOOM,e)}setMinZoom(e){this.set(ft.MIN_ZOOM,e)}setOpacity(e){ut(typeof e=="number","Layer opacity must be a number"),this.set(ft.OPACITY,e)}setVisible(e){this.set(ft.VISIBLE,e)}setZIndex(e){this.set(ft.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class u0 extends QP{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(ft.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(ft.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(At(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=rt(e,Ge.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof ss?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return sw(r,t.viewState)&&(!s||ui(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof ss?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(ft.MAP,e)}getMapInternal(){return this.get(ft.MAP)}setMap(e){this.mapPrecomposeKey_&&(At(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(At(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=rt(e,er.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=rt(this,Ge.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);ut(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(ft.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function sw(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const Fb={RENDER_ORDER:"renderOrder"};class JP extends u0{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Fb.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new OP(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(Fb.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?FP:e;const t=k6(e);this.styleFunction_=e===null?void 0:f3(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function k6(n){if(n===void 0)return FP;if(!n)return null;if(typeof n=="function"||n instanceof qn)return n;if(!Array.isArray(n))return kb([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof qn){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof qn))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return o6(r)}return kb(n)}class h0 extends JP{constructor(e){super(e)}createRenderer(){return new M3(this)}}const Lo={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Go extends ro{constructor(e,t){super(e),this.layer=t}}const X_={LAYERS:"layers"};class Uu extends QP{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(X_.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Ji(i.slice(),{unique:!0}):ut(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Ji(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(At),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(rt(e,oi.ADD,this.handleLayersAdd_,this),rt(e,oi.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(At);gf(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new Go(Lo.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[rt(e,fu.PROPERTYCHANGE,this.handleLayerChange_,this),rt(e,Ge.CHANGE,this.handleLayerChange_,this)];e instanceof Uu&&t.push(rt(e,Lo.ADDLAYER,this.handleLayerGroupAdd_,this),rt(e,Lo.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[st(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Go(Lo.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Go(Lo.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Go(Lo.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=st(t);this.listenerKeys_[i].forEach(At),delete this.listenerKeys_[i],this.dispatchEvent(new Go(Lo.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(X_.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Go(Lo.REMOVELAYER,i[r]))}this.set(X_.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=gl(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}}const Pe={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class ow extends pf{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Ge.CHANGE)}release(){this.setState(Pe.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Pe.EMPTY){if(this.state!==Pe.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){it()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:ZP(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function lv(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const N6=new Error("disposed"),D6=[256,256];class Vb extends ow{constructor(e){const t=Pe.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=lv(this.data_);return e?[e.width,e.height]:D6}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Pe.IDLE&&this.state!==Pe.ERROR)return;this.state=Pe.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Pe.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Pe.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(N6),this.controller_=null),super.disposeInternal()}}class ek extends ow{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Ri?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Pe.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Pe.ERROR,this.unlistenImage_(),this.image_=M6(),this.changed()}handleImageLoad_(){if(Ri)this.state=Pe.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Pe.LOADED:this.state=Pe.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Pe.ERROR&&(this.state=Pe.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Pe.IDLE&&(this.state=Pe.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=AV(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function M6(){const n=en(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let Y_;const su=[];function zb(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function Z_(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function L6(){if(Y_===void 0){const n=en(6,6,su);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",zb(n,4,5,4,0),zb(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;Y_=Z_(e,0)||Z_(e,4)||Z_(e,8),i0(n),su.push(n.canvas)}return Y_}function Ub(n,e,t,i){const r=n0(t,e,n);let s=Yp(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const u=n.getExtent();if(!u||pu(u,r)){const h=Yp(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function O6(n,e,t,i){const r=Tl(t);let s=Ub(n,e,r,i);return(!isFinite(s)||s<=0)&&qA(t,function(o){return s=Ub(n,e,o,i),isFinite(s)&&s>0}),s}function j6(n,e,t,i,r,s,o,l,u,h,f,m,_,v){const S=en(Math.round(t*n),Math.round(t*e),su);if(m||(S.imageSmoothingEnabled=!1),u.length===0)return S.canvas;S.scale(t,t);function I(A){return Math.round(A*t)/t}S.globalCompositeOperation="lighter";const T=ir();u.forEach(function(A,z,P){p4(T,A.extent)});let R;const M=t/i,N=(m?1:1+Math.pow(2,-24))/M;(!_||u.length!==1||h!==0)&&(R=en(Math.round(ct(T)*M),Math.round(Kn(T)*M),su),m||(R.imageSmoothingEnabled=!1),u.forEach(function(A,z,P){if(A.image.width>0&&A.image.height>0){if(A.clipExtent){R.save();const U=(A.clipExtent[0]-T[0])*M,O=-(A.clipExtent[3]-T[3])*M,se=ct(A.clipExtent)*M,pe=Kn(A.clipExtent)*M;R.rect(m?U:Math.round(U),m?O:Math.round(O),m?se:Math.round(U+se)-Math.round(U),m?pe:Math.round(O+pe)-Math.round(O)),R.clip()}const b=(A.extent[0]-T[0])*M,k=-(A.extent[3]-T[3])*M,F=ct(A.extent)*M,V=Kn(A.extent)*M;R.drawImage(A.image,h,h,A.image.width-2*h,A.image.height-2*h,m?b:Math.round(b),m?k:Math.round(k),m?F:Math.round(b+F)-Math.round(b),m?V:Math.round(k+V)-Math.round(k)),A.clipExtent&&R.restore()}}));const L=Vl(o);return l.getTriangles().forEach(function(A,z,P){const b=A.source,k=A.target;let F=b[0][0],V=b[0][1],U=b[1][0],O=b[1][1],se=b[2][0],pe=b[2][1];const J=I((k[0][0]-L[0])/s),re=I(-(k[0][1]-L[1])/s),Y=I((k[1][0]-L[0])/s),H=I(-(k[1][1]-L[1])/s),X=I((k[2][0]-L[0])/s),W=I(-(k[2][1]-L[1])/s),G=F,oe=V;F=0,V=0,U-=G,O-=oe,se-=G,pe-=oe;const ge=[[U,O,0,0,Y-J],[se,pe,0,0,X-J],[0,0,U,O,H-re],[0,0,se,pe,W-re]],xe=w4(ge);if(!xe)return;if(S.save(),S.beginPath(),L6()||!m){S.moveTo(Y,H);const Me=4,le=J-Y,Re=re-H;for(let He=0;He<Me;He++)S.lineTo(Y+I((He+1)*le/Me),H+I(He*Re/(Me-1))),He!=Me-1&&S.lineTo(Y+I((He+1)*le/Me),H+I((He+1)*Re/(Me-1)));S.lineTo(X,W)}else S.moveTo(Y,H),S.lineTo(J,re),S.lineTo(X,W);S.clip(),S.transform(xe[0],xe[2],xe[1],xe[3],J,re),S.translate(T[0]-G,T[3]-oe);let Te;if(R)Te=R.canvas,S.scale(N,-N);else{const Me=u[0],le=Me.extent;Te=Me.image,S.scale(ct(le)/Te.width,-Kn(le)/Te.height)}S.drawImage(Te,0,0),S.restore()}),R&&(i0(R),su.push(R.canvas)),f&&(S.save(),S.globalCompositeOperation="source-over",S.strokeStyle="black",S.lineWidth=1,l.getTriangles().forEach(function(A,z,P){const b=A.target,k=(b[0][0]-L[0])/s,F=-(b[0][1]-L[1])/s,V=(b[1][0]-L[0])/s,U=-(b[1][1]-L[1])/s,O=(b[2][0]-L[0])/s,se=-(b[2][1]-L[1])/s;S.beginPath(),S.moveTo(V,U),S.lineTo(k,F),S.lineTo(O,se),S.closePath(),S.stroke()}),S.restore()),S.canvas}const F6=10,Bb=.25;class V6{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let u={};const h=l?Qx(N=>hn(l,n0(N,this.targetProj_,this.sourceProj_))):Zp(this.targetProj_,this.sourceProj_);this.transformInv_=function(N){const L=N[0]+"/"+N[1];return u[L]||(u[L]=h(N)),u[L]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ct(r)>=ct(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ct(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ct(this.targetProj_.getExtent()):null;const f=Vl(i),m=Qm(i),_=Zm(i),v=Ym(i),S=this.transformInv_(f),I=this.transformInv_(m),T=this.transformInv_(_),R=this.transformInv_(v),M=F6+(o?Math.max(0,Math.ceil(Math.log2(Hx(i)/(o*o*256*256)))):0);if(this.addQuad_(f,m,_,v,S,I,T,R,M),this.wrapsXInSource_){let N=1/0;this.triangles_.forEach(function(L,A,z){N=Math.min(N,L.source[0][0],L.source[1][0],L.source[2][0])}),this.triangles_.forEach(L=>{if(Math.max(L.source[0][0],L.source[1][0],L.source[2][0])-N>this.sourceWorldWidth_/2){const A=[[L.source[0][0],L.source[0][1]],[L.source[1][0],L.source[1][1]],[L.source[2][0],L.source[2][1]]];A[0][0]-N>this.sourceWorldWidth_/2&&(A[0][0]-=this.sourceWorldWidth_),A[1][0]-N>this.sourceWorldWidth_/2&&(A[1][0]-=this.sourceWorldWidth_),A[2][0]-N>this.sourceWorldWidth_/2&&(A[2][0]-=this.sourceWorldWidth_);const z=Math.min(A[0][0],A[1][0],A[2][0]);Math.max(A[0][0],A[1][0],A[2][0])-z<this.sourceWorldWidth_/2&&(L.source=A)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,u,h){const f=WI([s,o,l,u]),m=this.sourceWorldWidth_?ct(f)/this.sourceWorldWidth_:null,_=this.sourceWorldWidth_,v=this.sourceProj_.canWrapX()&&m>.5&&m<1;let S=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const T=WI([e,t,i,r]);S=ct(T)/this.targetWorldWidth_>Bb||S}!v&&this.sourceProj_.isGlobal()&&m&&(S=m>Bb||S)}if(!S&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!ui(f,this.maxSourceExtent_))return;let I=0;if(!S&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)S=!0;else if(I=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),I!=1&&I!=2&&I!=4&&I!=8)return}if(h>0){if(!S){const T=[(e[0]+i[0])/2,(e[1]+i[1])/2],R=this.transformInv_(T);let M;v?M=(pl(s[0],_)+pl(l[0],_))/2-pl(R[0],_):M=(s[0]+l[0])/2-R[0];const N=(s[1]+l[1])/2-R[1];S=M*M+N*N>this.errorThresholdSquared_}if(S){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const T=[(t[0]+i[0])/2,(t[1]+i[1])/2],R=this.transformInv_(T),M=[(r[0]+e[0])/2,(r[1]+e[1])/2],N=this.transformInv_(M);this.addQuad_(e,t,T,M,s,o,R,N,h-1),this.addQuad_(M,T,i,r,N,R,l,u,h-1)}else{const T=[(e[0]+t[0])/2,(e[1]+t[1])/2],R=this.transformInv_(T),M=[(i[0]+r[0])/2,(i[1]+r[1])/2],N=this.transformInv_(M);this.addQuad_(e,T,M,r,s,R,N,u,h-1),this.addQuad_(T,t,i,M,R,o,l,N,h-1)}return}}if(v){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(I&11)==0&&this.addTriangle_(e,i,r,s,l,u),(I&14)==0&&this.addTriangle_(e,i,t,s,l,o),I&&((I&13)==0&&this.addTriangle_(t,r,e,o,u,s),(I&7)==0&&this.addTriangle_(t,r,i,o,u,l))}calculateSourceExtent(){const e=ir();return this.triangles_.forEach(function(t,i,r){const s=t.source;hd(e,s[0]),hd(e,s[1]),hd(e,s[2])}),e}getTriangles(){return this.triangles_}}const z6=.5;class tk extends ow{constructor(e,t,i,r,s,o,l,u,h,f,m,_){super(s,Pe.IDLE,_),this.renderEdges_=m!==void 0?m:!1,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const v=r.getTileCoordExtent(this.wrappedTileCoord_),S=this.targetTileGrid_.getExtent();let I=this.sourceTileGrid_.getExtent();const T=S?gl(v,S):v;if(Hx(T)===0){this.state=Pe.EMPTY;return}const R=e.getExtent();R&&(I?I=gl(I,R):I=R);const M=r.getResolution(this.wrappedTileCoord_[0]),N=O6(e,i,T,M);if(!isFinite(N)||N<=0){this.state=Pe.EMPTY;return}const L=f!==void 0?f:z6;if(this.triangulation_=new V6(e,i,T,I,N*L,M),this.triangulation_.getTriangles().length===0){this.state=Pe.EMPTY;return}this.sourceZ_=t.getZForResolution(N);let A=this.triangulation_.calculateSourceExtent();if(I&&(e.canWrapX()?(A[1]=Tt(A[1],I[1],I[3]),A[3]=Tt(A[3],I[1],I[3])):A=gl(A,I)),!Hx(A))this.state=Pe.EMPTY;else{let z=0,P=0;e.canWrapX()&&(z=ct(R),P=Math.floor((A[0]-R[0])/z)),ZA(A.slice(),e,!0).forEach(k=>{const F=t.getTileRangeForExtentAndZ(k,this.sourceZ_);for(let V=F.minX;V<=F.maxX;V++)for(let U=F.minY;U<=F.maxY;U++){const O=h(this.sourceZ_,V,U,l);if(O){const se=P*z;this.sourceTiles_.push({tile:O,offset:se})}}++P}),this.sourceTiles_.length===0&&(this.state=Pe.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Pe.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Pe.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=j6(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Pe.LOADED}this.changed()}load(){if(this.state==Pe.IDLE){this.state=Pe.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Pe.IDLE||i==Pe.LOADING){e++;const r=rt(t,Ge.CHANGE,s=>{const o=t.getState();(o==Pe.LOADED||o==Pe.ERROR||o==Pe.EMPTY)&&(At(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Pe.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(At),this.sourcesListenerKeys_=null}release(){this.canvas_&&(i0(this.canvas_.getContext("2d")),su.push(this.canvas_),this.canvas_=null),super.release()}}class aw{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Pc(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new aw(n,e,t,i)}class Wb{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Km&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return ut(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return ut(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){ut(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function sm(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function U6(n,e,t){return n+"/"+e+"/"+t}function Sp(n,e,t,i,r){return`${st(n)},${e},${U6(t,i,r)}`}function B6(n){return W6(n[0],n[1],n[2])}function W6(n,e,t){return(e<<n)+t}function G6(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function Q_(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function $6(n,e,t){const i=n[t];return i?i.delete(e):!1}function Gb(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=gl(e,Xo(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=gl(e,r))}return e}class H6 extends WP{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=ir(),this.tempTileRange_=new aw(0,0,0,0),this.tempTileCoord_=sm(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new Wb(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new Wb(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),u=Sp(l,l.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const f=r.viewState.projection,m=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!m||Tp(m,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=hn(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!pu(s,r))return null;const o=t.viewState,l=i.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const m=u.getTileCoordForCoordAndZ(r,f),_=this.getTile(f,m[1],m[2],t);if(!_||_.getState()!==Pe.LOADED)continue;const v=u.getOrigin(f),S=fi(u.getTileSize(f)),I=u.getResolution(f);let T;if(_ instanceof ek||_ instanceof tk)T=_.getImage();else if(_ instanceof Vb){if(T=lv(_.getData()),!T)continue}else continue;const R=Math.floor(h*((r[0]-v[0])/I-m[1]*S[0])),M=Math.floor(h*((v[1]-r[1])/I-m[2]*S[1])),N=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(T,R+N,M+N)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(o.projection),f=st(u);f in e.wantedTiles||(e.wantedTiles[f]={});const m=e.wantedTiles[f],_=l.getMapInternal(),v=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),_?_.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),S=o.rotation,I=S?XA(o.center,o.resolution,S,e.size):void 0;for(let T=i;T>=v;--T){const R=h.getTileRangeForExtentAndZ(t,T,this.tempTileRange_),M=h.getResolution(T);for(let N=R.minX;N<=R.maxX;++N)for(let L=R.minY;L<=R.maxY;++L){if(S&&!h.tileCoordIntersectsViewport([T,N,L],I))continue;const A=this.getTile(T,N,L,e);if(!A||!Q_(r,A,T))continue;const P=A.getKey();if(m[P]=!0,A.getState()===Pe.IDLE&&!e.tileQueue.isKeyQueued(P)){const b=sm(T,N,L,this.tempTileCoord_);e.tileQueue.enqueue([A,f,h.getTileCoordCenter(b),M])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let u=0;u<l.length;++u){const h=Sp(this.getLayer().getSource(),l[u],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Pe.LOADED)return f.endTransition(st(this)),Q_(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let m=s.minY;m<=s.maxY;++m){const _=Sp(u,h,i,f,m);let v=!1;if(l.containsKey(_)){const S=l.peek(_);S.getState()===Pe.LOADED&&(Q_(r,S,i),v=!0)}v||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,u=e.pixelRatio,h=this.getLayer(),f=h.getSource(),m=f.getTileGridForProjection(s),_=m.getZForResolution(o,f.zDirection),v=m.getResolution(_),S=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==S&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=S):this.renderedSourceKey_=S;let I=e.extent;const T=f.getTilePixelRatio(u);this.prepareContainer(e,t);const R=this.context.canvas.width,M=this.context.canvas.height,N=i.extent&&Xo(i.extent);N&&(I=gl(I,Xo(i.extent)));const L=v*R/2/T,A=v*M/2/T,z=[l[0]-L,l[1]-A,l[0]+L,l[1]+A],P={};this.renderedTiles.length=0;const b=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const Y=m.getZForResolution(r.nextResolution,f.zDirection),H=Gb(e,e.nextExtent);this.enqueueTiles(e,H,Y,P,b)}const k=Gb(e,I);if(this.enqueueTiles(e,k,_,P,0),b>0&&setTimeout(()=>{this.enqueueTiles(e,k,_-1,P,b-1)},0),!(_ in P))return this.container;const F=st(this),V=e.time;for(const Y of P[_]){const H=Y.getState();if(H===Pe.EMPTY)continue;const X=Y.tileCoord;if(H===Pe.LOADED&&Y.getAlpha(F,V)===1){Y.endTransition(F);continue}if(H!==Pe.ERROR&&(this.renderComplete=!1),this.findStaleTile_(X,P)){$6(P,Y,_),e.animate=!0;continue}if(this.findAltTiles_(m,X,_+1,P))continue;const oe=m.getMinZoom();for(let ge=_-1;ge>=oe&&!this.findAltTiles_(m,X,ge,P);--ge);}const U=v/o*u/T,O=this.getRenderContext(e);eo(this.tempTransform,R/2,M/2,U,U,0,-R/2,-M/2),i.extent&&this.clipUnrotated(O,e,N),f.getInterpolate()||(O.imageSmoothingEnabled=!1),this.preRender(O,e);const se=Object.keys(P).map(Number);se.sort(Xs);let pe;const J=[],re=[];for(let Y=se.length-1;Y>=0;--Y){const H=se[Y],X=f.getTilePixelSize(H,u,s),G=m.getResolution(H)/v,oe=X[0]*G*U,ge=X[1]*G*U,xe=m.getTileCoordForCoordAndZ(Vl(z),H),Te=m.getTileCoordExtent(xe),Me=hn(this.tempTransform,[T*(Te[0]-z[0])/v,T*(z[3]-Te[3])/v]),le=T*f.getGutterForProjection(s);for(const Re of P[H]){if(Re.getState()!==Pe.LOADED)continue;const He=Re.tileCoord,Wt=xe[1]-He[1],sr=Math.round(Me[0]-(Wt-1)*oe),Yn=xe[2]-He[2],Zn=Math.round(Me[1]-(Yn-1)*ge),fn=Math.round(Me[0]-Wt*oe),gn=Math.round(Me[1]-Yn*ge),Qn=sr-fn,Mi=Zn-gn,_t=se.length===1;let ht=!1;pe=[fn,gn,fn+Qn,gn,fn+Qn,gn+Mi,fn,gn+Mi];for(let rn=0,Li=J.length;rn<Li;++rn)if(!_t&&H<re[rn]){const bt=J[rn];ui([fn,gn,fn+Qn,gn+Mi],[bt[0],bt[3],bt[4],bt[7]])&&(ht||(O.save(),ht=!0),O.beginPath(),O.moveTo(pe[0],pe[1]),O.lineTo(pe[2],pe[3]),O.lineTo(pe[4],pe[5]),O.lineTo(pe[6],pe[7]),O.moveTo(bt[6],bt[7]),O.lineTo(bt[4],bt[5]),O.lineTo(bt[2],bt[3]),O.lineTo(bt[0],bt[1]),O.clip())}J.push(pe),re.push(H),this.drawTile(Re,e,fn,gn,Qn,Mi,le,_t),ht&&O.restore(),this.renderedTiles.unshift(Re),this.updateUsedTiles(e.usedTiles,f,Re)}}if(this.renderedResolution=v,this.extentChanged=!this.renderedExtent_||!Nd(this.renderedExtent_,z),this.renderedExtent_=z,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&O.restore(),O.imageSmoothingEnabled=!0,this.renderComplete){const Y=(H,X)=>{const W=st(f),G=X.wantedTiles[W],oe=G?Object.keys(G).length:0;this.updateCacheSize(oe),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(Y)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,u){let h;if(e instanceof Vb){if(h=lv(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),m=st(this),_=t.layerStatesArray[t.layerIndex],v=_.opacity*(u?e.getAlpha(m,t.time):1),S=v!==f.globalAlpha;S&&(f.save(),f.globalAlpha=v),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),S&&f.restore(),v!==_.opacity?t.animate=!0:u&&e.endTransition(m)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=st(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const ap={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class K6 extends u0{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(ap.PRELOAD)}setPreload(e){this.set(ap.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(ap.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(ap.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Vh extends K6{constructor(e){super(e)}createRenderer(){return new H6(this,{cacheSize:this.getCacheSize()})}}const kc=[0,0,0],Oo=5;class nk{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,ut(h4(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,ut(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Vl(i)),ut(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,ut(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:rw,ut(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new aw(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,u=r.maxY;l<=u;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Pc(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Pc(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Pc(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),f=Math.floor(o*u);if(t<r)return Pc(h,h,f,f,i);const m=Math.floor(u*(s+1))-1,_=Math.floor(u*(o+1))-1;return Pc(h,m,f,_,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,kc);const r=kc[1],s=kc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,kc);const o=kc[1],l=kc[2];return Pc(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=fi(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=fi(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=l+s[1]*r;return oa(o,l,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),u=this.getOrigin(o),h=fi(this.getTileSize(o),this.tmpSize_);let f=l*(e-u[0])/i/h[0],m=l*(u[1]-t)/i/h[1];return r?(f=Qg(f,Oo)-1,m=Qg(m,Oo)-1):(f=Zg(f,Oo),m=Zg(m,Oo)),sm(o,f,m,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),u=fi(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/u[0],f=(o[1]-t)/l/u[1];return r?(h=Qg(h,Oo)-1,f=Qg(f,Oo)-1):(h=Zg(h,Oo),f=Zg(f,Oo)),sm(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=P1(this.resolutions_,e,t||0);return Tt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return mP(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function ik(n){let e=n.getDefaultTileGrid();return e||(e=Z6(n),n.setDefaultTileGrid(e)),e}function q6(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=lw(t);if(!pu(s,r)){const o=ct(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function X6(n,e,t,i){i=i!==void 0?i:"top-left";const r=rk(n,e,t);return new nk({extent:n,origin:y4(n,i),resolutions:r,tileSize:t})}function Y6(n){const e=n||{},t=e.extent||Vn("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:rk(t,e.maxZoom,e.tileSize,e.maxResolution)};return new nk(i)}function rk(n,e,t,i){e=e!==void 0?e:b6,t=fi(t!==void 0?t:rw);const r=Kn(n),s=ct(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let u=0;u<o;++u)l[u]=i/Math.pow(2,u);return l}function Z6(n,e,t,i){const r=lw(n);return X6(r,e,t,i)}function lw(n){n=Vn(n);let e=n.getExtent();if(!e){const t=180*mu.degrees/n.getMetersPerUnit();e=oa(-t,-t,t,t)}return e}function gY(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const Q6=/\{z\}/g,J6=/\{x\}/g,e9=/\{y\}/g,t9=/\{-y\}/g;function n9(n,e,t,i,r){return n.replace(Q6,e.toString()).replace(J6,t.toString()).replace(e9,i.toString()).replace(t9,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function i9(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function r9(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return n9(n,o,t[1],t[2],s)})}function s9(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=r9(n[r],e);return o9(i)}function o9(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=B6(e),s=pl(r,n.length);return n[s](e,t,i)})}class a9 extends jP{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&fi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||st(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return it()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:ik(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=fi(r.getTileSize(e),this.tmpSize);return s==1?o:d3(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=q6(r,e,i)),G6(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class l9 extends ro{constructor(e,t){super(e),this.tile=t}}const J_={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class cw extends a9{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===cw.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=st(t),r=t.getState();let s;r==Pe.LOADING?(this.tileLoadingKeys_[i]=!0,s=J_.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Pe.ERROR?J_.TILELOADERROR:r==Pe.LOADED?J_.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new l9(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=i9(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(s9(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class c9 extends cw{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:sk,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:ek,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Tp(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Tp(t,e)))return this.tileGrid;const i=st(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=ik(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(l,h!==void 0?Pe.IDLE:Pe.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(Ge.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||Tp(l,s))return this.getTileInternal(e,t,i,r,l||s);const u=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),m=this.getTileGridForProjection(s),_=this.getTileCoordForTileUrlFunction(u,s),v=new tk(l,f,s,m,u,_,this.getTilePixelRatio(r),this.getGutter(),(S,I,T,R)=>this.getTileInternal(S,I,T,R,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return v.key=h,v}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),u=Sp(this,l,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,l);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=Vn(e);if(i){const r=st(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function sk(n,e){if(Ri){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class rd extends c9{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:Y6({extent:lw(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const u9="modulepreload",h9=function(n){return"/visapp/"+n},$b={},ns=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=h9(h),h in $b)return;$b[h]=!0;const f=h.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const _=document.createElement("link");if(_.rel=f?"stylesheet":u9,f||(_.as="script"),_.crossOrigin="",_.href=h,l&&_.setAttribute("nonce",l),document.head.appendChild(_),f)return new Promise((v,S)=>{_.addEventListener("load",v),_.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},d9='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class f9 extends rd{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[d9];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Ri&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||sk)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const om=1/0;class g9{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,gf(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){ut(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=om?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[u]?h:u;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,u;for(l=0;l<s;++l)o=t[l],u=e(o),u==om?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class p9 extends g9{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Ge.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Pe.LOADED||i===Pe.ERROR||i===Pe.EMPTY){i!==Pe.ERROR&&t.removeEventListener(Ge.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Pe.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function m9(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return om;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Bc extends ro{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Bo extends Bc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Lt={SINGLECLICK:"singleclick",CLICK:Ge.CLICK,DBLCLICK:Ge.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},cv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class y9 extends pf{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=rt(i,cv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=rt(i,cv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Ge.TOUCHMOVE,this.boundHandleTouchMove_,vP?{passive:!1}:!1)}emulateClick_(e){let t=new Bo(Lt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Bo(Lt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Bo(Lt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Lt.POINTERUP||t.type==Lt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Lt.POINTERDOWN||t.type==Lt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Bo(Lt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(At),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Bo(Lt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(rt(i,Lt.POINTERMOVE,this.handlePointerMove_,this),rt(i,Lt.POINTERUP,this.handlePointerUp_,this),rt(this.element_,Lt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(rt(this.element_.getRootNode(),Lt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Bo(Lt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Bo(Lt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(At(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Ge.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(At(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(At),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Wo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Ln={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class d0 extends _s{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)At(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==kd&&this.listenerKeys.push(rt(e,Wo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class _9 extends d0{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(Ge.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+xf+" "+Y1+(this.collapsed_&&this.collapsible_?" "+lb:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>BA(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!pa(t,this.renderedAttributions_)){_V(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(lb),this.collapsed_?ob(this.collapseLabel_,this.label_):ob(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class x9 extends d0{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Ge.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+xf+" "+Y1,u=this.element;u.className=l,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(tp)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:zu}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(tp);!s&&i===0?this.element.classList.add(tp):s&&i!==0&&this.element.classList.remove(tp)}this.label_.style.transform=r}this.rotation_=i}}class v9 extends d0{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Ge.CLICK,this.handleClick_.bind(this,i),!1);const m=document.createElement("button");m.className=s,m.setAttribute("type","button"),m.title=h,m.appendChild(typeof l=="string"?document.createTextNode(l):l),m.addEventListener(Ge.CLICK,this.handleClick_.bind(this,-i),!1);const _=t+" "+xf+" "+Y1,v=this.element;v.className=_,v.appendChild(f),v.appendChild(m),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:zu})):i.setZoom(s)}}}function w9(n){n=n||{};const e=new Ji;return(n.zoom===void 0||n.zoom)&&e.push(new v9(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new x9(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new _9(n.attributionOptions)),e}class E9{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const Hb={ACTIVE:"active"};class Tf extends _s{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Hb.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(Hb.ACTIVE,e)}setMap(e){this.map_=e}}function T9(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:w6,center:n.getConstrainedCenter(r)})}}function uw(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:zu})}class S9 extends Tf{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Lt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();uw(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function uv(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const I9=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},b9=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},ok=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?b9(n):!0},C9=Pd,ak=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(mV&&_P&&e.ctrlKey)},lk=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},R9=function(n){const e=n.originalEvent;return _P?e.metaKey:e.ctrlKey},A9=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ck=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},ex=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},P9=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class Sf extends Tf{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Lt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Lt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Lt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Lt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function hw(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class k9 extends Sf{constructor(e){super({stopDown:qm}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:uv(lk,P9);this.condition_=e.onFocusOnly?uv(ok,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(hw(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();T4(s,l.getResolution()),M1(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:zu})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class N9 extends Sf{constructor(e){e=e||{},super({stopDown:qm}),this.condition_=e.condition?e.condition:I9,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!ex(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===iw)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return ex(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return ex(e)&&ak(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class D9 extends Km{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Fd([r])}getGeometry(){return this.geometry_}}const Nc={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class zh extends ro{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class M9 extends Sf{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new D9(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??ak,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new zh(Nc.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new zh(t?Nc.BOXEND:Nc.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new zh(Nc.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new zh(Nc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new zh(Nc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class L9 extends M9{constructor(e){e=e||{};const t=e.condition?e.condition:A9;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:zu})}}const Ga={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class O9 extends Tf{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return lk(t)&&ck(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Ge.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Ga.DOWN||r==Ga.LEFT||r==Ga.RIGHT||r==Ga.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==Ga.DOWN?h=-l:r==Ga.LEFT?u=-l:r==Ga.RIGHT?u=l:h=l;const f=[u,h];M1(f,o.getRotation()),T9(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class j9 extends Tf{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!R9(t)&&ck(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Ge.KEYDOWN||e.type==Ge.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();uw(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const F9=40,V9=300;class z9 extends Tf{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:C9;this.condition_=e.onFocusOnly?uv(ok,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Ge.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=F9;break;case WheelEvent.DOM_DELTA_PAGE:s*=V9;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Tt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),uw(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class U9 extends Sf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=qm),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==iw&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(hw(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class B9 extends Sf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=qm),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(hw(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function W9(n){n=n||{};const e=new Ji,t=new E9(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new N9),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new S9({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new k9({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new U9),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new B9({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new O9),e.push(new j9({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new z9({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new L9({duration:n.zoomDuration})),e}class G9 extends Km{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){it()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;eo(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),lP(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,u){let h;const f=t.viewState;function m(L,A,z,P){return s.call(o,A,L?z:null,P)}const _=f.projection,v=QA(e.slice(),_),S=[[0,0]];if(_.canWrapX()&&r){const L=_.getExtent(),A=ct(L);S.push([-A,0],[A,0])}const I=t.layerStatesArray,T=I.length,R=[],M=[];for(let L=0;L<S.length;L++)for(let A=T-1;A>=0;--A){const z=I[A],P=z.layer;if(P.hasRenderer()&&sw(z,f)&&l.call(u,P)){const b=P.getRenderer(),k=P.getSource();if(b&&k){const F=k.getWrapX()?v:e,V=m.bind(null,z.managed);M[0]=F[0]+S[L][0],M[1]=F[1]+S[L][1],h=b.forEachFeatureAtCoordinate(M,t,i,V,R)}if(h)return h}}if(R.length===0)return;const N=1/R.length;return R.forEach((L,A)=>L.distanceSq+=A*N),R.sort((L,A)=>L.distanceSq-A.distanceSq),R.some(L=>h=L.callback(L.feature,L.layer,L.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,Pd,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){it()}scheduleExpireIconCache(e){tr.canExpireCache()&&e.postRenderFunctions.push($9)}}function $9(n,e){tr.expire()}class H9 extends G9{constructor(e){super(e),this.fontChangeListenerKey_=rt(Vc,fu.PROPERTYCHANGE,e.redrawText,e),this.element_=Ri?wP():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=xf+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new BP(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){At(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(er.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof JP&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const m=t[h];e.layerIndex=h;const _=m.layer,v=_.getSourceState();if(!sw(m,r)||v!="ready"&&v!="undefined"){_.unrender();continue}const S=_.render(e,o);S&&(S!==o&&(this.children_.push(S),o=S),s.push(m))}this.declutter(e,s),xV(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Yo(u)){const h=u.getContext("2d");for(const f of this.children_){const m=f.firstElementChild||f,_=f.style.backgroundColor;if(_&&(!Yo(m)||m.width>0)&&(h.fillStyle=_,h.fillRect(0,0,u.width,u.height)),Yo(m)&&m.width>0){const v=f.style.opacity||m.style.opacity;h.globalAlpha=v===""?1:Number(v);const S=m.style.transform;if(S)h.setTransform(...tv(S));else{const I=parseFloat(m.style.width)/m.width,T=parseFloat(m.style.height)/m.height;h.setTransform(I,0,0,T,0,0)}h.drawImage(m,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(er.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function uk(n){if(n instanceof u0){n.setMapInternal(null);return}n instanceof Uu&&n.getLayers().forEach(uk)}function hk(n,e){if(n instanceof u0){n.setMapInternal(e);return}if(n instanceof Uu){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)hk(t[i],e)}}let K9=class extends _s{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=q9(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:yV,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Cr(),this.pixelToCoordinateTransform_=Cr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ri||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ri||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ri?new Ji:w9()),this.interactions=t.interactions||(Ri?new Ji:W9({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new p9(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Ln.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Ln.VIEW,this.handleViewChanged_),this.addChangeListener(Ln.SIZE,this.handleSizeChanged_),this.addChangeListener(Ln.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof ss)&&e.view.then(function(r){i.setView(new ss(r))}),this.controls.addEventListener(oi.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(oi.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(oi.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(oi.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(oi.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(oi.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){hk(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Pd,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof Uu?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:Pd,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(Ln.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return ev(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?hn(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Ln.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ji){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=zs(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?hn(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Ln.SIZE)}getView(){return this.get(Ln.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return m9(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Bo(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===cv.POINTERDOWN||i===Ge.WHEEL||i===Ge.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[jn.ANIMATING]||o[jn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(er.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(er.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Bc(Wo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Bc(Wo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)At(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Ge.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Ge.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Yo(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Yo(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new H9(this)),!Yo(t)){this.mapBrowserEventHandler_=new y9(this,this.moveTolerance_);for(const r in Lt)this.mapBrowserEventHandler_.addEventListener(Lt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Ge.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Ge.WHEEL,this.boundHandleBrowserEvent_,vP?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[rt(i,Ge.KEYDOWN,this.handleBrowserEvent,this),rt(i,Ge.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(At(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(At(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=rt(e,fu.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=rt(e,Ge.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(At),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Go("addlayer",e)),this.layerGroupPropertyListenerKeys_=[rt(e,fu.PROPERTYCHANGE,this.render,this),rt(e,Ge.CHANGE,this.render,this),rt(e,"addlayer",this.handleLayerAdd_,this),rt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){uk(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&vb(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Kx(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:st(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=Kx(l.nextCenter,l.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Jm(this.previousExtent_)&&!Nd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Bc(Wo.MOVESTART,this,r)),this.previousExtent_=Xm(this.previousExtent_)),this.previousExtent_&&!s.viewHints[jn.ANIMATING]&&!s.viewHints[jn.INTERACTING]&&!Nd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Bc(Wo.MOVEEND,this,s)),WA(s.extent,this.previousExtent_))),this.dispatchEvent(new Bc(Wo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Wo.LOADSTART)||this.hasListener(Wo.LOADEND)||this.hasListener(er.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Go("removelayer",t)),this.set(Ln.LAYERGROUP,e)}setSize(e){this.set(Ln.SIZE,e)}setTarget(e){this.set(Ln.TARGET,e)}setView(e){if(!e||e instanceof ss){this.set(Ln.VIEW,e);return}this.set(Ln.VIEW,new ss);const t=this;e.then(function(i){t.setView(new ss(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Yo(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!vb(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&eP("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!pa(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function q9(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Uu({layers:n.layers});t[Ln.LAYERGROUP]=i,t[Ln.TARGET]=n.target,t[Ln.VIEW]=n.view instanceof ss?n.view:new ss;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Ji(n.controls.slice()):(ut(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Ji(n.interactions.slice()):(ut(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Ji(n.overlays.slice()):(ut(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Ji,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const tx="units",X9=[1,2,5],Uh=25.4/.28;class Y9 extends d0{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+xf,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(tx,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(tx)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(tx,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Yp(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||Uh)/Uh,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Uh)/Uh:void 0;let h=l*o,f="";if(r=="degrees"){const N=mu.degrees;h*=N,h<N/60?(f="",o*=3600):h<N?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let m=3*Math.floor(Math.log(l*o)/Math.log(10)),_,v,S,I=0,T,R;for(;;){S=Math.floor(m/3);const N=Math.pow(10,S);if(_=X9[(m%3+3)%3]*N,v=Math.round(_/o),isNaN(v)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&v>=u){_=I,v=T,S=R;break}else if(v>=l)break;I=_,T=v,R=S,++m}const M=this.scaleBar_?this.createScaleBar(v,_,f):_.toFixed(S<0?-S:0)+" "+f;this.renderedHTML_!=M&&(this.innerElement_.innerHTML=M,this.renderedHTML_=M),this.renderedWidth_!=v&&(this.innerElement_.style.width=v+"px",this.renderedWidth_=v),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,u=[this.createMarker("absolute")];for(let f=0;f<o;++f){const m=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${m}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return u.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),u=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=Yp(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Uh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const Z9={},Kb=n=>{let e;const t=new Set,i=(f,m)=>{const _=typeof f=="function"?f(e):f;if(!Object.is(_,e)){const v=e;e=m??(typeof _!="object"||_===null)?_:Object.assign({},e,_),t.forEach(S=>S(e,v))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(Z9?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},Q9=n=>n?Kb(n):Kb;var nx={exports:{}},ix={},rx={exports:{}},sx={};var qb;function J9(){if(qb)return sx;qb=1;var n=cf();function e(m,_){return m===_&&(m!==0||1/m===1/_)||m!==m&&_!==_}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(m,_){var v=_(),S=i({inst:{value:v,getSnapshot:_}}),I=S[0].inst,T=S[1];return s(function(){I.value=v,I.getSnapshot=_,u(I)&&T({inst:I})},[m,v,_]),r(function(){return u(I)&&T({inst:I}),m(function(){u(I)&&T({inst:I})})},[m]),o(v),v}function u(m){var _=m.getSnapshot;m=m.value;try{var v=_();return!t(m,v)}catch{return!0}}function h(m,_){return _()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return sx.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,sx}var Xb;function ez(){return Xb||(Xb=1,rx.exports=J9()),rx.exports}var Yb;function tz(){if(Yb)return ix;Yb=1;var n=cf(),e=ez();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return ix.useSyncExternalStoreWithSelector=function(h,f,m,_,v){var S=s(null);if(S.current===null){var I={hasValue:!1,value:null};S.current=I}else I=S.current;S=l(function(){function R(z){if(!M){if(M=!0,N=z,z=_(z),v!==void 0&&I.hasValue){var P=I.value;if(v(P,z))return L=P}return L=z}if(P=L,i(N,z))return P;var b=_(z);return v!==void 0&&v(P,b)?(N=z,P):(N=z,L=b)}var M=!1,N,L,A=m===void 0?null:m;return[function(){return R(f())},A===null?void 0:function(){return R(A())}]},[f,m,_,v]);var T=r(h,S[0],S[1]);return o(function(){I.hasValue=!0,I.value=T},[T]),u(T),T},ix}var Zb;function nz(){return Zb||(Zb=1,nx.exports=tz()),nx.exports}var iz=nz();const rz=Xv(iz),dk={},{useDebugValue:sz}=LL,{useSyncExternalStoreWithSelector:oz}=rz;let Qb=!1;const az=n=>n;function lz(n,e=az,t){(dk?"production":void 0)!=="production"&&t&&!Qb&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Qb=!0);const i=oz(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return sz(i),i}const Jb=n=>{(dk?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?Q9(n):n,t=(i,r)=>lz(e,i,r);return Object.assign(t,e),t},rr=n=>n?Jb(n):Jb;var fk=Symbol.for("immer-nothing"),e2=Symbol.for("immer-draftable"),Ni=Symbol.for("immer-state");function wr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Ud=Object.getPrototypeOf;function wu(n){return!!n&&!!n[Ni]}function Cl(n){return n?gk(n)||Array.isArray(n)||!!n[e2]||!!n.constructor?.[e2]||If(n)||g0(n):!1}var cz=Object.prototype.constructor.toString(),t2=new WeakMap;function gk(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=t2.get(t);return i===void 0&&(i=Function.toString.call(t),t2.set(t,i)),i===cz}function am(n,e,t=!0){f0(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function f0(n){const e=n[Ni];return e?e.type_:Array.isArray(n)?1:If(n)?2:g0(n)?3:0}function hv(n,e){return f0(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function pk(n,e,t){const i=f0(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function uz(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function If(n){return n instanceof Map}function g0(n){return n instanceof Set}function Ya(n){return n.copy_||n.base_}function dv(n,e){if(If(n))return new Map(n);if(g0(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=gk(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Ni];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Ud(n),i)}else{const i=Ud(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function dw(n,e=!1){return p0(n)||wu(n)||!Cl(n)||(f0(n)>1&&Object.defineProperties(n,{set:lp,add:lp,clear:lp,delete:lp}),Object.freeze(n),e&&Object.values(n).forEach(t=>dw(t,!0))),n}function hz(){wr(2)}var lp={value:hz};function p0(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var dz={};function Rl(n){const e=dz[n];return e||wr(0,n),e}var Bd;function mk(){return Bd}function fz(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function n2(n,e){e&&(Rl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function fv(n){gv(n),n.drafts_.forEach(gz),n.drafts_=null}function gv(n){n===Bd&&(Bd=n.parent_)}function i2(n){return Bd=fz(Bd,n)}function gz(n){const e=n[Ni];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function r2(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Ni].modified_&&(fv(e),wr(4)),Cl(n)&&(n=lm(e,n),e.parent_||cm(e,n)),e.patches_&&Rl("Patches").generateReplacementPatches_(t[Ni].base_,n,e.patches_,e.inversePatches_)):n=lm(e,t,[]),fv(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==fk?n:void 0}function lm(n,e,t){if(p0(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Ni];if(!r)return am(e,(s,o)=>s2(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return cm(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),am(o,(u,h)=>s2(n,r,s,u,h,t,l),i),cm(n,s,!1),t&&n.patches_&&Rl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function s2(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=p0(r);if(!(l&&!o)){if(wu(r)){const u=s&&e&&e.type_!==3&&!hv(e.assigned_,i)?s.concat(i):void 0,h=lm(n,r,u);if(pk(t,i,h),wu(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(Cl(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;lm(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(If(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&cm(n,r)}}}function cm(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&dw(e,t)}function pz(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:mk(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=fw;t&&(r=[i],s=Wd);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var fw={get(n,e){if(e===Ni)return n;const t=Ya(n);if(!hv(t,e))return mz(n,t,e);const i=t[e];return n.finalized_||!Cl(i)?i:i===ox(n.base_,e)?(ax(n),n.copy_[e]=mv(i,n)):i},has(n,e){return e in Ya(n)},ownKeys(n){return Reflect.ownKeys(Ya(n))},set(n,e,t){const i=yk(Ya(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=ox(Ya(n),e),s=r?.[Ni];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(uz(t,r)&&(t!==void 0||hv(n.base_,e)))return!0;ax(n),pv(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return ox(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,ax(n),pv(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Ya(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){wr(11)},getPrototypeOf(n){return Ud(n.base_)},setPrototypeOf(){wr(12)}},Wd={};am(fw,(n,e)=>{Wd[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Wd.deleteProperty=function(n,e){return Wd.set.call(this,n,e,void 0)};Wd.set=function(n,e,t){return fw.set.call(this,n[0],e,t,n[0])};function ox(n,e){const t=n[Ni];return(t?Ya(t):n)[e]}function mz(n,e,t){const i=yk(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function yk(n,e){if(!(e in n))return;let t=Ud(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Ud(t)}}function pv(n){n.modified_||(n.modified_=!0,n.parent_&&pv(n.parent_))}function ax(n){n.copy_||(n.copy_=dv(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var yz=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,f=>t.call(this,f,...h))}}typeof t!="function"&&wr(6),i!==void 0&&typeof i!="function"&&wr(7);let r;if(Cl(e)){const s=i2(this),o=mv(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?fv(s):gv(s)}return n2(s,i),r2(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===fk&&(r=void 0),this.autoFreeze_&&dw(r,!0),i){const s=[],o=[];Rl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else wr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){Cl(n)||wr(8),wu(n)&&(n=_z(n));const e=i2(this),t=mv(n,void 0);return t[Ni].isManual_=!0,gv(e),t}finishDraft(n,e){const t=n&&n[Ni];(!t||!t.isManual_)&&wr(9);const{scope_:i}=t;return n2(i,e),r2(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=Rl("Patches").applyPatches_;return wu(n)?i(n,e):this.produce(n,r=>i(r,e))}};function mv(n,e){const t=If(n)?Rl("MapSet").proxyMap_(n,e):g0(n)?Rl("MapSet").proxySet_(n,e):pz(n,e);return(e?e.scope_:mk()).drafts_.push(t),t}function _z(n){return wu(n)||wr(10,n),_k(n)}function _k(n){if(!Cl(n)||p0(n))return n;const e=n[Ni];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=dv(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=dv(n,!0);return am(t,(r,s)=>{pk(t,r,_k(s))},i),e&&(e.finalized_=!1),t}var xz=new yz,vz=xz.produce;const wz=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?vz(r):r;return e(l,s,...o)},n(i.setState,t,i)),bf=wz,ci=rr()(bf((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),xk={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await ns(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-CuMa98Rt.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1,2]));return n()},immediateLoad:!1},Trailerhellingen:{name:"Trailerhellingen",factory:async()=>{const{createBoothellingenLayer:n}=await ns(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-D91mXJQT.js");return{createBoothellingenLayer:e}},__vite__mapDeps([3,1,2]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await ns(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-DoegTFQl.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await ns(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-ChKya8gm.js");return{createViswaterLayer:e}},__vite__mapDeps([4,1]));return n()},immediateLoad:!1},"AHN4 Hillshade":{name:"AHN4 Hillshade",factory:async()=>{const{createAHN4MultiHillshadeLayer:n}=await ns(async()=>{const{createAHN4MultiHillshadeLayer:e}=await import("./hillshadeLayers-DnU3sskJ.js");return{createAHN4MultiHillshadeLayer:e}},__vite__mapDeps([5,6]));return n()},immediateLoad:!0},"PDOK Water NL":{name:"PDOK Water NL",factory:async()=>{const{createPDOKWaterLayer:n}=await ns(async()=>{const{createPDOKWaterLayer:e}=await import("./pdokWaterOL-D9f5Au-N.js");return{createPDOKWaterLayer:e}},__vite__mapDeps([7,8,6]));return n()},immediateLoad:!0},Zeevisstekken:{name:"Zeevisstekken",factory:async()=>{const{createZeevisstekkenLayer:n}=await ns(async()=>{const{createZeevisstekkenLayer:e}=await import("./zeevisstekkenOL-DJyM5ti7.js");return{createZeevisstekkenLayer:e}},__vite__mapDeps([9,1,2]));return n()},immediateLoad:!1},Boeien:{name:"Boeien",factory:async()=>{const{createVaarwegmarkeringenLayer:n}=await ns(async()=>{const{createVaarwegmarkeringenLayer:e}=await import("./vaarwegmarkeringenOL-CE794Wv5.js");return{createVaarwegmarkeringenLayer:e}},__vite__mapDeps([10,1,2]));return n("drijvend")},immediateLoad:!1},Bakens:{name:"Bakens",factory:async()=>{const{createVaarwegmarkeringenLayer:n}=await ns(async()=>{const{createVaarwegmarkeringenLayer:e}=await import("./vaarwegmarkeringenOL-CE794Wv5.js");return{createVaarwegmarkeringenLayer:e}},__vite__mapDeps([10,1,2]));return n("vast")},immediateLoad:!1},Bathymetrie:{name:"Bathymetrie",factory:async()=>{const{createBathymetrieLayer:n}=await ns(async()=>{const{createBathymetrieLayer:e}=await import("./bathymetrieOL-Db01RDSu.js");return{createBathymetrieLayer:e}},__vite__mapDeps([11,8,6]));return n()},immediateLoad:!1}};function Ez(){return Object.values(xk).filter(n=>n.immediateLoad)}const Dr=rr()(bf((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Zi=rr()(bf((n,e)=>({visible:{"CartoDB Light":!0,OpenStreetMap:!1,Luchtfoto:!1,Terrein:!1,"Labels Overlay":!1,Aanlegsteigers:!1,Trailerhellingen:!1,Dieptekaart:!1,Viswater:!1,"PDOK Water NL":!0,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5,"PDOK Water NL":1},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=xk[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=Dr.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),In=rr()(bf(n=>({layerControlOpen:!1,layerPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchFormLocationSource:null,catchFormInitialPhotos:[],catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleLayerPanel:()=>{n(e=>{const t=e.layerPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.layerPanelOpen=!0)})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e?.location||null,t.catchFormLocationSource=e?.locationSource||null,t.catchFormInitialPhotos=e?.photos||[]})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null,e.catchFormLocationSource=null,e.catchFormInitialPhotos=[]})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),Tz={};function Sz(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Gd=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Gd(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Gd(i)(t)}}}},Iz=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:T=>T,version:0,merge:(T,R)=>({...R,...T}),...e},o=!1;const l=new Set,u=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...T)},i,r);const f=Gd(s.serialize),m=()=>{const T=s.partialize({...i()});let R;const M=f({state:T,version:s.version}).then(N=>h.setItem(s.name,N)).catch(N=>{R=N});if(R)throw R;return M},_=r.setState;r.setState=(T,R)=>{_(T,R),m()};const v=n((...T)=>{t(...T),m()},i,r);let S;const I=()=>{var T;if(!h)return;o=!1,l.forEach(M=>M(i()));const R=((T=s.onRehydrateStorage)==null?void 0:T.call(s,i()))||void 0;return Gd(h.getItem.bind(h))(s.name).then(M=>{if(M)return s.deserialize(M)}).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==s.version){if(s.migrate)return s.migrate(M.state,M.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return M.state}).then(M=>{var N;return S=s.merge(M,(N=i())!=null?N:v),t(S,!0),m()}).then(()=>{R?.(S,void 0),o=!0,u.forEach(M=>M(S))}).catch(M=>{R?.(void 0,M)})};return r.persist={setOptions:T=>{s={...s,...T},T.getStorage&&(h=T.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:T=>(l.add(T),()=>{l.delete(T)}),onFinishHydration:T=>(u.add(T),()=>{u.delete(T)})},I(),S||v},bz=(n,e)=>(t,i,r)=>{let s={storage:Sz(()=>localStorage),partialize:I=>I,version:0,merge:(I,T)=>({...T,...I}),...e},o=!1;const l=new Set,u=new Set;let h=s.storage;if(!h)return n((...I)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...I)},i,r);const f=()=>{const I=s.partialize({...i()});return h.setItem(s.name,{state:I,version:s.version})},m=r.setState;r.setState=(I,T)=>{m(I,T),f()};const _=n((...I)=>{t(...I),f()},i,r);r.getInitialState=()=>_;let v;const S=()=>{var I,T;if(!h)return;o=!1,l.forEach(M=>{var N;return M((N=i())!=null?N:_)});const R=((T=s.onRehydrateStorage)==null?void 0:T.call(s,(I=i())!=null?I:_))||void 0;return Gd(h.getItem.bind(h))(s.name).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==s.version){if(s.migrate)return[!0,s.migrate(M.state,M.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,M.state];return[!1,void 0]}).then(M=>{var N;const[L,A]=M;if(v=s.merge(A,(N=i())!=null?N:_),t(v,!0),L)return f()}).then(()=>{R?.(v,void 0),v=i(),o=!0,u.forEach(M=>M(v))}).catch(M=>{R?.(void 0,M)})};return r.persist={setOptions:I=>{s={...s,...I},I.storage&&(h=I.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>S(),hasHydrated:()=>o,onHydrate:I=>(l.add(I),()=>{l.delete(I)}),onFinishHydration:I=>(u.add(I),()=>{u.delete(I)})},s.skipHydration||S(),v||_},Cz=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((Tz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Iz(n,e)):bz(n,e),Bu=Cz,We=rr()(Bu(n=>({defaultBackground:"CartoDB Light",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,showWindIndicator:!1,showTideWidget:!1,showBuienradarWidget:!1,showWaterflowWidget:!1,showForecastSlider:!1,showWaterDataWidget:!1,widgetOrder:["weather","wind","tide","buienradar","waterflow","forecast","waterData"],fontScale:100,showFontSliders:!1,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e}),setShowWindIndicator:e=>n({showWindIndicator:e}),setShowTideWidget:e=>n({showTideWidget:e}),setShowBuienradarWidget:e=>n({showBuienradarWidget:e}),setShowWaterflowWidget:e=>n({showWaterflowWidget:e}),setShowForecastSlider:e=>n({showForecastSlider:e}),setShowWaterDataWidget:e=>n({showWaterDataWidget:e}),setWidgetOrder:e=>n({widgetOrder:e}),setFontScale:e=>n({fontScale:e}),setShowFontSliders:e=>n({showFontSliders:e})}),{name:"visapp-settings",version:3,migrate:(n,e)=>{const t=n;return e<3?{...t,defaultBackground:"CartoDB Light"}:t}})),vk=rr()(Bu((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),gw=rr((n,e)=>({current:null,pressureHistory:[],hourlyForecast:[],precipitation15min:[],loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code,precipitation",hourly:"temperature_2m,wind_speed_10m,wind_direction_10m,surface_pressure,weather_code,precipitation_probability,precipitation",minutely_15:"precipitation",past_hours:"48",forecast_hours:"168",past_minutely_15:"0",forecast_minutely_15:"8",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();let l=[],u=[],h=[];o.hourly?.time&&o.hourly?.surface_pressure&&(l=o.hourly.time.map((f,m)=>({time:f,pressure:o.hourly.surface_pressure[m]})),u=o.hourly.time.map((f,m)=>({time:f,temperature:o.hourly.temperature_2m[m],windSpeed:o.hourly.wind_speed_10m[m],windDirection:o.hourly.wind_direction_10m[m],pressure:o.hourly.surface_pressure[m],weatherCode:o.hourly.weather_code[m],precipitationProbability:o.hourly.precipitation_probability?.[m]||0,precipitation:o.hourly.precipitation?.[m]||0}))),o.minutely_15?.time&&o.minutely_15?.precipitation&&(h=o.minutely_15.time.map((f,m)=>({time:f,precipitation:o.minutely_15.precipitation[m]||0}))),o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},pressureHistory:l,hourlyForecast:u,precipitation15min:h,loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"},getFishingScore:()=>{const{current:t}=e();if(!t)return 1;let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),Math.max(0,Math.min(3,i/2))},getPressureTrend:()=>{const{pressureHistory:t}=e();if(t.length<6)return"stable";const i=t.slice(-6),r=t.slice(-12,-6);if(r.length===0)return"stable";const s=i.reduce((u,h)=>u+h.pressure,0)/i.length,o=r.reduce((u,h)=>u+h.pressure,0)/r.length,l=s-o;return l>2?"rising":l<-2?"falling":"stable"},getWeatherAtTime:t=>{const{hourlyForecast:i}=e();if(i.length===0)return null;t.toISOString().slice(0,13)+"";let r=i[0],s=1/0;for(const o of i){const l=new Date(o.time).getTime(),u=Math.abs(l-t.getTime());u<s&&(s=u,r=o)}return r}})),wk=rr()(Bu(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),o2=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],a2=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],Rz=rr()(Bu((n,e)=>({presets:o2,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=Zi.getState().setLayerVisibility;a2.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=Zi.getState().visible,r=a2.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:o2})}}),{name:"visapp-presets"})),Az=()=>{};var l2={};const Ek=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Pz=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Tk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,f=s>>2,m=(s&3)<<4|l>>4;let _=(l&15)<<2|h>>6,v=h&63;u||(v=64,o||(_=64)),i.push(t[f],t[m],t[_],t[v])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Ek(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Pz(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const m=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||m==null)throw new kz;const _=s<<2|l>>4;if(i.push(_),h!==64){const v=l<<4&240|h>>2;if(i.push(v),m!==64){const S=h<<6&192|m;i.push(S)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class kz extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Nz=function(n){const e=Ek(n);return Tk.encodeByteArray(e,!0)},um=function(n){return Nz(n).replace(/\./g,"")},Sk=function(n){try{return Tk.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ik(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Dz=()=>Ik().__FIREBASE_DEFAULTS__,Mz=()=>{if(typeof process>"u"||typeof l2>"u")return;const n=l2.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Lz=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Sk(n[1]);return e&&JSON.parse(e)},m0=()=>{try{return Az()||Dz()||Mz()||Lz()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},bk=n=>m0()?.emulatorHosts?.[n],Ck=n=>{const e=bk(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Rk=()=>m0()?.config,Ak=n=>m0()?.[`_${n}`];class Oz{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Ul(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function pw(n){return(await fetch(n,{credentials:"include"})).ok}function Pk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[um(JSON.stringify(t)),um(JSON.stringify(o)),""].join(".")}const fd={};function jz(){const n={prod:[],emulator:[]};for(const e of Object.keys(fd))fd[e]?n.emulator.push(e):n.prod.push(e);return n}function Fz(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let c2=!1;function mw(n,e){if(typeof window>"u"||typeof document>"u"||!Ul(window.location.host)||fd[n]===e||fd[n]||c2)return;fd[n]=e;function t(_){return`__firebase__banner__${_}`}const i="__firebase__banner",s=jz().prod.length>0;function o(){const _=document.getElementById(i);_&&_.remove()}function l(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function u(_,v){_.setAttribute("width","24"),_.setAttribute("id",v),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{c2=!0,o()},_}function f(_,v){_.setAttribute("id",v),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function m(){const _=Fz(i),v=t("text"),S=document.getElementById(v)||document.createElement("span"),I=t("learnmore"),T=document.getElementById(I)||document.createElement("a"),R=t("preprendIcon"),M=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const N=_.element;l(N),f(T,I);const L=h();u(M,R),N.append(M,S,T,L),document.body.appendChild(N)}s?(S.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function tn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Vz(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tn())}function kk(){const n=m0()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function zz(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Uz(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Bz(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Wz(){const n=tn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Nk(){return!kk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Dk(){return!kk()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Mk(){try{return typeof indexedDB=="object"}catch{return!1}}function Gz(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const $z="FirebaseError";class xs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=$z,Object.setPrototypeOf(this,xs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Cf.prototype.create)}}class Cf{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?Hz(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new xs(r,l,i)}}function Hz(n,e){return n.replace(Kz,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const Kz=/\{\$([^}]+)}/g;function qz(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Al(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(u2(s)&&u2(o)){if(!Al(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function u2(n){return n!==null&&typeof n=="object"}function Rf(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Xz(n,e){const t=new Yz(n,e);return t.subscribe.bind(t)}class Yz{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Zz(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=lx),r.error===void 0&&(r.error=lx),r.complete===void 0&&(r.complete=lx);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Zz(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function lx(){}function oo(n){return n&&n._delegate?n._delegate:n}class ua{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Za="[DEFAULT]";class Qz{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Oz;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(eU(e))try{this.getOrInitializeService({instanceIdentifier:Za})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Za){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Za){return this.instances.has(e)}getOptions(e=Za){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Jz(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Za){return this.component?this.component.multipleInstances?e:Za:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Jz(n){return n===Za?void 0:n}function eU(n){return n.instantiationMode==="EAGER"}class tU{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Qz(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Xe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Xe||(Xe={}));const nU={debug:Xe.DEBUG,verbose:Xe.VERBOSE,info:Xe.INFO,warn:Xe.WARN,error:Xe.ERROR,silent:Xe.SILENT},iU=Xe.INFO,rU={[Xe.DEBUG]:"log",[Xe.VERBOSE]:"log",[Xe.INFO]:"info",[Xe.WARN]:"warn",[Xe.ERROR]:"error"},sU=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=rU[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class yw{constructor(e){this.name=e,this._logLevel=iU,this._logHandler=sU,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?nU[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xe.DEBUG,...e),this._logHandler(this,Xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xe.VERBOSE,...e),this._logHandler(this,Xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xe.INFO,...e),this._logHandler(this,Xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xe.WARN,...e),this._logHandler(this,Xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xe.ERROR,...e),this._logHandler(this,Xe.ERROR,...e)}}const oU=(n,e)=>e.some(t=>n instanceof t);let h2,d2;function aU(){return h2||(h2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function lU(){return d2||(d2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Lk=new WeakMap,yv=new WeakMap,Ok=new WeakMap,cx=new WeakMap,_w=new WeakMap;function cU(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(ta(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Lk.set(t,n)}).catch(()=>{}),_w.set(e,n),e}function uU(n){if(yv.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});yv.set(n,e)}let _v={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return yv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ok.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ta(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function hU(n){_v=n(_v)}function dU(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(ux(this),e,...t);return Ok.set(i,e.sort?e.sort():[e]),ta(i)}:lU().includes(n)?function(...e){return n.apply(ux(this),e),ta(Lk.get(this))}:function(...e){return ta(n.apply(ux(this),e))}}function fU(n){return typeof n=="function"?dU(n):(n instanceof IDBTransaction&&uU(n),oU(n,aU())?new Proxy(n,_v):n)}function ta(n){if(n instanceof IDBRequest)return cU(n);if(cx.has(n))return cx.get(n);const e=fU(n);return e!==n&&(cx.set(n,e),_w.set(e,n)),e}const ux=n=>_w.get(n);function gU(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=ta(o);return i&&o.addEventListener("upgradeneeded",u=>{i(ta(o.result),u.oldVersion,u.newVersion,ta(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const pU=["get","getKey","getAll","getAllKeys","count"],mU=["put","add","delete","clear"],hx=new Map;function f2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(hx.get(e))return hx.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=mU.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||pU.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&u.done]))[0]};return hx.set(e,s),s}hU(n=>({...n,get:(e,t,i)=>f2(e,t)||n.get(e,t,i),has:(e,t)=>!!f2(e,t)||n.has(e,t)}));class yU{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(_U(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function _U(n){return n.getComponent()?.type==="VERSION"}const xv="@firebase/app",g2="0.14.6";const no=new yw("@firebase/app"),xU="@firebase/app-compat",vU="@firebase/analytics-compat",wU="@firebase/analytics",EU="@firebase/app-check-compat",TU="@firebase/app-check",SU="@firebase/auth",IU="@firebase/auth-compat",bU="@firebase/database",CU="@firebase/data-connect",RU="@firebase/database-compat",AU="@firebase/functions",PU="@firebase/functions-compat",kU="@firebase/installations",NU="@firebase/installations-compat",DU="@firebase/messaging",MU="@firebase/messaging-compat",LU="@firebase/performance",OU="@firebase/performance-compat",jU="@firebase/remote-config",FU="@firebase/remote-config-compat",VU="@firebase/storage",zU="@firebase/storage-compat",UU="@firebase/firestore",BU="@firebase/ai",WU="@firebase/firestore-compat",GU="firebase",$U="12.6.0";const vv="[DEFAULT]",HU={[xv]:"fire-core",[xU]:"fire-core-compat",[wU]:"fire-analytics",[vU]:"fire-analytics-compat",[TU]:"fire-app-check",[EU]:"fire-app-check-compat",[SU]:"fire-auth",[IU]:"fire-auth-compat",[bU]:"fire-rtdb",[CU]:"fire-data-connect",[RU]:"fire-rtdb-compat",[AU]:"fire-fn",[PU]:"fire-fn-compat",[kU]:"fire-iid",[NU]:"fire-iid-compat",[DU]:"fire-fcm",[MU]:"fire-fcm-compat",[LU]:"fire-perf",[OU]:"fire-perf-compat",[jU]:"fire-rc",[FU]:"fire-rc-compat",[VU]:"fire-gcs",[zU]:"fire-gcs-compat",[UU]:"fire-fst",[WU]:"fire-fst-compat",[BU]:"fire-vertex","fire-js":"fire-js",[GU]:"fire-js-all"};const hm=new Map,KU=new Map,wv=new Map;function p2(n,e){try{n.container.addComponent(e)}catch(t){no.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Pl(n){const e=n.name;if(wv.has(e))return no.debug(`There were multiple attempts to register component ${e}.`),!1;wv.set(e,n);for(const t of hm.values())p2(t,n);for(const t of KU.values())p2(t,n);return!0}function y0(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Qi(n){return n==null?!1:n.settings!==void 0}const qU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},na=new Cf("app","Firebase",qU);class XU{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ua("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw na.create("app-deleted",{appName:this._name})}}const Bl=$U;function jk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:vv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw na.create("bad-app-name",{appName:String(r)});if(t||(t=Rk()),!t)throw na.create("no-options");const s=hm.get(r);if(s){if(Al(t,s.options)&&Al(i,s.config))return s;throw na.create("duplicate-app",{appName:r})}const o=new tU(r);for(const u of wv.values())o.addComponent(u);const l=new XU(t,i,o);return hm.set(r,l),l}function xw(n=vv){const e=hm.get(n);if(!e&&n===vv&&Rk())return jk();if(!e)throw na.create("no-app",{appName:n});return e}function ds(n,e,t){let i=HU[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),no.warn(o.join(" "));return}Pl(new ua(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const YU="firebase-heartbeat-database",ZU=1,$d="firebase-heartbeat-store";let dx=null;function Fk(){return dx||(dx=gU(YU,ZU,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore($d)}catch(t){console.warn(t)}}}}).catch(n=>{throw na.create("idb-open",{originalErrorMessage:n.message})})),dx}async function QU(n){try{const t=(await Fk()).transaction($d),i=await t.objectStore($d).get(Vk(n));return await t.done,i}catch(e){if(e instanceof xs)no.warn(e.message);else{const t=na.create("idb-get",{originalErrorMessage:e?.message});no.warn(t.message)}}}async function m2(n,e){try{const i=(await Fk()).transaction($d,"readwrite");await i.objectStore($d).put(e,Vk(n)),await i.done}catch(t){if(t instanceof xs)no.warn(t.message);else{const i=na.create("idb-set",{originalErrorMessage:t?.message});no.warn(i.message)}}}function Vk(n){return`${n.name}!${n.options.appId}`}const JU=1024,eB=30;class tB{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new iB(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=y2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>eB){const r=rB(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){no.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=y2(),{heartbeatsToSend:t,unsentEntries:i}=nB(this._heartbeatsCache.heartbeats),r=um(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return no.warn(e),""}}}function y2(){return new Date().toISOString().substring(0,10)}function nB(n,e=JU){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),_2(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),_2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class iB{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Mk()?Gz().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await QU(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return m2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return m2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function _2(n){return um(JSON.stringify({version:2,heartbeats:n})).length}function rB(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function sB(n){Pl(new ua("platform-logger",e=>new yU(e),"PRIVATE")),Pl(new ua("heartbeat",e=>new tB(e),"PRIVATE")),ds(xv,g2,n),ds(xv,g2,"esm2020"),ds("fire-js","")}sB("");function zk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const oB=zk,Uk=new Cf("auth","Firebase",zk());const dm=new yw("@firebase/auth");function aB(n,...e){dm.logLevel<=Xe.WARN&&dm.warn(`Auth (${Bl}): ${n}`,...e)}function Ip(n,...e){dm.logLevel<=Xe.ERROR&&dm.error(`Auth (${Bl}): ${n}`,...e)}function gs(n,...e){throw ww(n,...e)}function Rr(n,...e){return ww(n,...e)}function vw(n,e,t){const i={...oB(),[e]:t};return new Cf("auth","Firebase",i).create(e,{appName:n.name})}function ml(n){return vw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lB(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&gs(n,"argument-error"),vw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ww(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return Uk.create(n,...e)}function ze(n,e,...t){if(!n)throw ww(e,...t)}function Gs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ip(e),new Error(e)}function io(n,e){n||Gs(e)}function Ev(){return typeof self<"u"&&self.location?.href||""}function cB(){return x2()==="http:"||x2()==="https:"}function x2(){return typeof self<"u"&&self.location?.protocol||null}function uB(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(cB()||Uz()||"connection"in navigator)?navigator.onLine:!0}function hB(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Af{constructor(e,t){this.shortDelay=e,this.longDelay=t,io(t>e,"Short delay should be less than long delay!"),this.isMobile=Vz()||Bz()}get(){return uB()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ew(n,e){io(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Bk{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const dB={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const fB=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],gB=new Af(3e4,6e4);function Tw(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Wu(n,e,t,i,r={}){return Wk(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=Rf({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return zz()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Ul(n.emulatorConfig.host)&&(h.credentials="include"),Bk.fetch()(await Gk(n,n.config.apiHost,t,l),h)})}async function Wk(n,e,t){n._canInitEmulator=!1;const i={...dB,...e};try{const r=new mB(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw cp(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw cp(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw cp(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw cp(n,"user-disabled",o);const f=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw vw(n,f,h);gs(n,f)}}catch(r){if(r instanceof xs)throw r;gs(n,"network-request-failed",{message:String(r)})}}async function pB(n,e,t,i,r={}){const s=await Wu(n,e,t,i,r);return"mfaPendingCredential"in s&&gs(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Gk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?Ew(n.config,r):`${n.config.apiScheme}://${r}`;return fB.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class mB{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Rr(this.auth,"network-request-failed")),gB.get())})}}function cp(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Rr(n,e,i);return r.customData._tokenResponse=t,r}async function yB(n,e){return Wu(n,"POST","/v1/accounts:delete",e)}async function fm(n,e){return Wu(n,"POST","/v1/accounts:lookup",e)}function gd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function _B(n,e=!1){const t=oo(n),i=await t.getIdToken(e),r=Sw(i);ze(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:gd(fx(r.auth_time)),issuedAtTime:gd(fx(r.iat)),expirationTime:gd(fx(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function fx(n){return Number(n)*1e3}function Sw(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Ip("JWT malformed, contained fewer than 3 sections"),null;try{const r=Sk(t);return r?JSON.parse(r):(Ip("Failed to decode base64 JWT payload"),null)}catch(r){return Ip("Caught error parsing JWT payload as JSON",r?.toString()),null}}function v2(n){const e=Sw(n);return ze(e,"internal-error"),ze(typeof e.exp<"u","internal-error"),ze(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Hd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof xs&&xB(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function xB({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class vB{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Tv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=gd(this.lastLoginAt),this.creationTime=gd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function gm(n){const e=n.auth,t=await n.getIdToken(),i=await Hd(n,fm(e,{idToken:t}));ze(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?$k(r.providerUserInfo):[],o=EB(n.providerData,s),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Tv(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function wB(n){const e=oo(n);await gm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function EB(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function $k(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function TB(n,e){const t=await Wk(n,{},async()=>{const i=Rf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await Gk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:i};return n.emulatorConfig&&Ul(n.emulatorConfig.host)&&(u.credentials="include"),Bk.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function SB(n,e){return Wu(n,"POST","/v2/accounts:revokeToken",Tw(n,e))}class ou{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ze(e.idToken,"internal-error"),ze(typeof e.idToken<"u","internal-error"),ze(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):v2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ze(e.length!==0,"internal-error");const t=v2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ze(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await TB(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new ou;return i&&(ze(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(ze(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(ze(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ou,this.toJSON())}_performRefresh(){return Gs("not implemented")}}function jo(n,e){ze(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Tr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new vB(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Tv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Hd(this,this.stsTokenManager.getToken(this.auth,e));return ze(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return _B(this,e)}reload(){return wB(this)}_assign(e){this!==e&&(ze(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Tr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ze(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await gm(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qi(this.auth.app))return Promise.reject(ml(this.auth));const e=await this.getIdToken();return await Hd(this,yB(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:m,emailVerified:_,isAnonymous:v,providerData:S,stsTokenManager:I}=t;ze(m&&I,e,"internal-error");const T=ou.fromJSON(this.name,I);ze(typeof m=="string",e,"internal-error"),jo(i,e.name),jo(r,e.name),ze(typeof _=="boolean",e,"internal-error"),ze(typeof v=="boolean",e,"internal-error"),jo(s,e.name),jo(o,e.name),jo(l,e.name),jo(u,e.name),jo(h,e.name),jo(f,e.name);const R=new Tr({uid:m,auth:e,email:r,emailVerified:_,displayName:i,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:T,createdAt:h,lastLoginAt:f});return S&&Array.isArray(S)&&(R.providerData=S.map(M=>({...M}))),u&&(R._redirectEventId=u),R}static async _fromIdTokenResponse(e,t,i=!1){const r=new ou;r.updateFromServerResponse(t);const s=new Tr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await gm(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];ze(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?$k(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new ou;l.updateFromIdToken(i);const u=new Tr({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Tv(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const w2=new Map;function $s(n){io(n instanceof Function,"Expected a class definition");let e=w2.get(n);return e?(io(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,w2.set(n,e),e)}class Hk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Hk.type="NONE";const E2=Hk;function bp(n,e,t){return`firebase:${n}:${e}:${t}`}class au{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=bp(this.userKey,r.apiKey,s),this.fullPersistenceKey=bp("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await fm(this.auth,{idToken:e}).catch(()=>{});return t?Tr._fromGetAccountInfoResponse(this.auth,t,e):null}return Tr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new au($s(E2),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||$s(E2);const o=bp(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let m;if(typeof f=="string"){const _=await fm(e,{idToken:f}).catch(()=>{});if(!_)break;m=await Tr._fromGetAccountInfoResponse(e,_,f)}else m=Tr._fromJSON(e,f);h!==s&&(l=m),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new au(s,e,i):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new au(s,e,i))}}function T2(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Yk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Kk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Qk(e))return"Blackberry";if(Jk(e))return"Webos";if(qk(e))return"Safari";if((e.includes("chrome/")||Xk(e))&&!e.includes("edge/"))return"Chrome";if(Zk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Kk(n=tn()){return/firefox\//i.test(n)}function qk(n=tn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Xk(n=tn()){return/crios\//i.test(n)}function Yk(n=tn()){return/iemobile/i.test(n)}function Zk(n=tn()){return/android/i.test(n)}function Qk(n=tn()){return/blackberry/i.test(n)}function Jk(n=tn()){return/webos/i.test(n)}function Iw(n=tn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function IB(n=tn()){return Iw(n)&&!!window.navigator?.standalone}function bB(){return Wz()&&document.documentMode===10}function eN(n=tn()){return Iw(n)||Zk(n)||Jk(n)||Qk(n)||/windows phone/i.test(n)||Yk(n)}function tN(n,e=[]){let t;switch(n){case"Browser":t=T2(tn());break;case"Worker":t=`${T2(tn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Bl}/${i}`}class CB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function RB(n,e={}){return Wu(n,"GET","/v2/passwordPolicy",Tw(n,e))}const AB=6;class PB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??AB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class kB{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new S2(this),this.idTokenSubscription=new S2(this),this.beforeStateQueue=new CB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Uk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=$s(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await au.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await fm(this,{idToken:e}),i=await Tr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Qi(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ze(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await gm(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=hB()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qi(this.app))return Promise.reject(ml(this));const t=e?oo(e):null;return t&&ze(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ze(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qi(this.app)?Promise.reject(ml(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qi(this.app)?Promise.reject(ml(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($s(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await RB(this),t=new PB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Cf("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await SB(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&$s(e)||this._popupRedirectResolver;ze(t,this,"argument-error"),this.redirectPersistenceManager=await au.create(this,[$s(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ze(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ze(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Qi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&aB(`Error while retrieving App Check token: ${e.error}`),e?.token}}function _0(n){return oo(n)}class S2{constructor(e){this.auth=e,this.observer=null,this.addObserver=Xz(t=>this.observer=t)}get next(){return ze(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let bw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function NB(n){bw=n}function DB(n){return bw.loadJS(n)}function MB(){return bw.gapiScript}function LB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function OB(n,e){const t=y0(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(Al(s,e??{}))return r;gs(r,"already-initialized")}return t.initialize({options:e})}function jB(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map($s);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function FB(n,e,t){const i=_0(n);ze(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=nN(e),{host:o,port:l}=VB(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){ze(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),ze(Al(h,i.config.emulator)&&Al(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Ul(o)?(pw(`${s}//${o}${u}`),mw("Auth",!0)):zB()}function nN(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function VB(n){const e=nN(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:I2(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:I2(o)}}}function I2(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function zB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class iN{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Gs("not implemented")}_getIdTokenResponse(e){return Gs("not implemented")}_linkToIdToken(e,t){return Gs("not implemented")}_getReauthenticationResolver(e){return Gs("not implemented")}}async function lu(n,e){return pB(n,"POST","/v1/accounts:signInWithIdp",Tw(n,e))}const UB="http://localhost";class kl extends iN{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new kl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):gs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new kl(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return lu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,lu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,lu(e,t)}buildRequest(){const e={requestUri:UB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Rf(t)}return e}}class Cw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Pf extends Cw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class $o extends Pf{constructor(){super("facebook.com")}static credential(e){return kl._fromParams({providerId:$o.PROVIDER_ID,signInMethod:$o.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $o.credentialFromTaggedObject(e)}static credentialFromError(e){return $o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $o.credential(e.oauthAccessToken)}catch{return null}}}$o.FACEBOOK_SIGN_IN_METHOD="facebook.com";$o.PROVIDER_ID="facebook.com";class Bs extends Pf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return kl._fromParams({providerId:Bs.PROVIDER_ID,signInMethod:Bs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Bs.credentialFromTaggedObject(e)}static credentialFromError(e){return Bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Bs.credential(t,i)}catch{return null}}}Bs.GOOGLE_SIGN_IN_METHOD="google.com";Bs.PROVIDER_ID="google.com";class Ho extends Pf{constructor(){super("github.com")}static credential(e){return kl._fromParams({providerId:Ho.PROVIDER_ID,signInMethod:Ho.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ho.credentialFromTaggedObject(e)}static credentialFromError(e){return Ho.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ho.credential(e.oauthAccessToken)}catch{return null}}}Ho.GITHUB_SIGN_IN_METHOD="github.com";Ho.PROVIDER_ID="github.com";class Ko extends Pf{constructor(){super("twitter.com")}static credential(e,t){return kl._fromParams({providerId:Ko.PROVIDER_ID,signInMethod:Ko.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ko.credentialFromTaggedObject(e)}static credentialFromError(e){return Ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ko.credential(t,i)}catch{return null}}}Ko.TWITTER_SIGN_IN_METHOD="twitter.com";Ko.PROVIDER_ID="twitter.com";class Eu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await Tr._fromIdTokenResponse(e,i,r),o=b2(i);return new Eu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=b2(i);return new Eu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function b2(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class pm extends xs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,pm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new pm(e,t,i,r)}}function rN(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?pm._fromErrorAndOperation(n,s,e,i):s})}async function BB(n,e,t=!1){const i=await Hd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Eu._forOperation(n,"link",i)}async function WB(n,e,t=!1){const{auth:i}=n;if(Qi(i.app))return Promise.reject(ml(i));const r="reauthenticate";try{const s=await Hd(n,rN(i,r,e,n),t);ze(s.idToken,i,"internal-error");const o=Sw(s.idToken);ze(o,i,"internal-error");const{sub:l}=o;return ze(n.uid===l,i,"user-mismatch"),Eu._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&gs(i,"user-mismatch"),s}}async function GB(n,e,t=!1){if(Qi(n.app))return Promise.reject(ml(n));const i="signIn",r=await rN(n,i,e),s=await Eu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function $B(n,e,t,i){return oo(n).onIdTokenChanged(e,t,i)}function HB(n,e,t){return oo(n).beforeAuthStateChanged(e,t)}function KB(n,e,t,i){return oo(n).onAuthStateChanged(e,t,i)}function qB(n){return oo(n).signOut()}const mm="__sak";class sN{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(mm,"1"),this.storage.removeItem(mm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const XB=1e3,YB=10;class oN extends sN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);bB()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,YB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},XB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}oN.type="LOCAL";const ZB=oN;class aN extends sN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}aN.type="SESSION";const lN=aN;function QB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class x0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new x0(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),u=await QB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}x0.receivers=[];function Rw(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class JB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=Rw("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(m){const _=m;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(_.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function fs(){return window}function e8(n){fs().location.href=n}function cN(){return typeof fs().WorkerGlobalScope<"u"&&typeof fs().importScripts=="function"}async function t8(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function n8(){return navigator?.serviceWorker?.controller||null}function i8(){return cN()?self:null}const uN="firebaseLocalStorageDb",r8=1,ym="firebaseLocalStorage",hN="fbase_key";class kf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function v0(n,e){return n.transaction([ym],e?"readwrite":"readonly").objectStore(ym)}function s8(){const n=indexedDB.deleteDatabase(uN);return new kf(n).toPromise()}function Sv(){const n=indexedDB.open(uN,r8);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(ym,{keyPath:hN})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(ym)?e(i):(i.close(),await s8(),e(await Sv()))})})}async function C2(n,e,t){const i=v0(n,!0).put({[hN]:e,value:t});return new kf(i).toPromise()}async function o8(n,e){const t=v0(n,!1).get(e),i=await new kf(t).toPromise();return i===void 0?null:i.value}function R2(n,e){const t=v0(n,!0).delete(e);return new kf(t).toPromise()}const a8=800,l8=3;class dN{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>l8)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return cN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=x0._getInstance(i8()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await t8(),!this.activeServiceWorker)return;this.sender=new JB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||n8()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sv();return await C2(e,mm,"1"),await R2(e,mm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>C2(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>o8(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>R2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=v0(r,!1).getAll();return new kf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),a8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}dN.type="LOCAL";const c8=dN;new Af(3e4,6e4);function fN(n,e){return e?$s(e):(ze(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Aw extends iN{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return lu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return lu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return lu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function u8(n){return GB(n.auth,new Aw(n),n.bypassAuthState)}function h8(n){const{auth:e,user:t}=n;return ze(t,e,"internal-error"),WB(t,new Aw(n),n.bypassAuthState)}async function d8(n){const{auth:e,user:t}=n;return ze(t,e,"internal-error"),BB(t,new Aw(n),n.bypassAuthState)}class gN{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return u8;case"linkViaPopup":case"linkViaRedirect":return d8;case"reauthViaPopup":case"reauthViaRedirect":return h8;default:gs(this.auth,"internal-error")}}resolve(e){io(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){io(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const f8=new Af(2e3,1e4);async function g8(n,e,t){if(Qi(n.app))return Promise.reject(Rr(n,"operation-not-supported-in-this-environment"));const i=_0(n);lB(n,e,Cw);const r=fN(i,t);return new ul(i,"signInViaPopup",e,r).executeNotNull()}class ul extends gN{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,ul.currentPopupAction&&ul.currentPopupAction.cancel(),ul.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ze(e,this.auth,"internal-error"),e}async onExecution(){io(this.filter.length===1,"Popup operations only handle one event");const e=Rw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Rr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Rr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ul.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Rr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,f8.get())};e()}}ul.currentPopupAction=null;const p8="pendingRedirect",Cp=new Map;class m8 extends gN{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Cp.get(this.auth._key());if(!e){try{const i=await y8(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Cp.set(this.auth._key(),e)}return this.bypassAuthState||Cp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function y8(n,e){const t=v8(e),i=x8(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function _8(n,e){Cp.set(n._key(),e)}function x8(n){return $s(n._redirectPersistence)}function v8(n){return bp(p8,n.config.apiKey,n.name)}async function w8(n,e,t=!1){if(Qi(n.app))return Promise.reject(ml(n));const i=_0(n),r=fN(i,e),o=await new m8(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const E8=600*1e3;class T8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!S8(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!pN(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Rr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=E8&&this.cachedEventUids.clear(),this.cachedEventUids.has(A2(e))}saveEventToCache(e){this.cachedEventUids.add(A2(e)),this.lastProcessedEventTime=Date.now()}}function A2(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function pN({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function S8(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pN(n);default:return!1}}async function I8(n,e={}){return Wu(n,"GET","/v1/projects",e)}const b8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,C8=/^https?/;async function R8(n){if(n.config.emulator)return;const{authorizedDomains:e}=await I8(n);for(const t of e)try{if(A8(t))return}catch{}gs(n,"unauthorized-domain")}function A8(n){const e=Ev(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!C8.test(t))return!1;if(b8.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const P8=new Af(3e4,6e4);function P2(){const n=fs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function k8(n){return new Promise((e,t)=>{function i(){P2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{P2(),t(Rr(n,"network-request-failed"))},timeout:P8.get()})}if(fs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(fs().gapi?.load)i();else{const r=LB("iframefcb");return fs()[r]=()=>{gapi.load?i():t(Rr(n,"network-request-failed"))},DB(`${MB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw Rp=null,e})}let Rp=null;function N8(n){return Rp=Rp||k8(n),Rp}const D8=new Af(5e3,15e3),M8="__/auth/iframe",L8="emulator/auth/iframe",O8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},j8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function F8(n){const e=n.config;ze(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ew(e,L8):`https://${n.config.authDomain}/${M8}`,i={apiKey:e.apiKey,appName:n.name,v:Bl},r=j8.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${Rf(i).slice(1)}`}async function V8(n){const e=await N8(n),t=fs().gapi;return ze(t,n,"internal-error"),e.open({where:document.body,url:F8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:O8,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Rr(n,"network-request-failed"),l=fs().setTimeout(()=>{s(o)},D8.get());function u(){fs().clearTimeout(l),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const z8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},U8=500,B8=600,W8="_blank",G8="http://localhost";class k2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $8(n,e,t,i=U8,r=B8){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u={...z8,width:i.toString(),height:r.toString(),top:s,left:o},h=tn().toLowerCase();t&&(l=Xk(h)?W8:t),Kk(h)&&(e=e||G8,u.scrollbars="yes");const f=Object.entries(u).reduce((_,[v,S])=>`${_}${v}=${S},`,"");if(IB(h)&&l!=="_self")return H8(e||"",l),new k2(null);const m=window.open(e||"",l,f);ze(m,n,"popup-blocked");try{m.focus()}catch{}return new k2(m)}function H8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const K8="__/auth/handler",q8="emulator/auth/handler",X8=encodeURIComponent("fac");async function N2(n,e,t,i,r,s){ze(n.config.authDomain,n,"auth-domain-config-required"),ze(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Bl,eventId:r};if(e instanceof Cw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",qz(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof Pf){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),h=u?`#${X8}=${encodeURIComponent(u)}`:"";return`${Y8(n)}?${Rf(l).slice(1)}${h}`}function Y8({config:n}){return n.emulator?Ew(n,q8):`https://${n.authDomain}/${K8}`}const gx="webStorageSupport";class Z8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=lN,this._completeRedirectFn=w8,this._overrideRedirectResult=_8}async _openPopup(e,t,i,r){io(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await N2(e,t,i,Ev(),r);return $8(e,s,Rw())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await N2(e,t,i,Ev(),r);return e8(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(io(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await V8(e),i=new T8(e);return t.register("authEvent",r=>(ze(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(gx,{type:gx},r=>{const s=r?.[0]?.[gx];s!==void 0&&t(!!s),gs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=R8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return eN()||qk()||Iw()}}const Q8=Z8;var D2="@firebase/auth",M2="1.12.0";class J8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ze(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function e7(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function t7(n){Pl(new ua("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;ze(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tN(n)},h=new kB(i,r,s,u);return jB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Pl(new ua("auth-internal",e=>{const t=_0(e.getProvider("auth").getImmediate());return(i=>new J8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ds(D2,M2,e7(n)),ds(D2,M2,"esm2020")}const n7=300,i7=Ak("authIdTokenMaxAge")||n7;let L2=null;const r7=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>i7)return;const r=t?.token;L2!==r&&(L2=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function s7(n=xw()){const e=y0(n,"auth");if(e.isInitialized())return e.getImmediate();const t=OB(n,{popupRedirectResolver:Q8,persistence:[c8,ZB,lN]}),i=Ak("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=r7(s.toString());HB(t,o,()=>o(t.currentUser)),$B(t,l=>o(l))}}const r=bk("auth");return r&&FB(t,`http://${r}`),t}function o7(){return document.getElementsByTagName("head")?.[0]??document}NB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Rr("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",o7().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});t7("Browser");var a7="firebase",l7="12.7.0";ds(a7,l7,"app");var O2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Pw;(function(){var n;function e(P,b){function k(){}k.prototype=b.prototype,P.F=b.prototype,P.prototype=new k,P.prototype.constructor=P,P.D=function(F,V,U){for(var O=Array(arguments.length-2),se=2;se<arguments.length;se++)O[se-2]=arguments[se];return b.prototype[V].apply(F,O)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(P,b,k){k||(k=0);const F=Array(16);if(typeof b=="string")for(var V=0;V<16;++V)F[V]=b.charCodeAt(k++)|b.charCodeAt(k++)<<8|b.charCodeAt(k++)<<16|b.charCodeAt(k++)<<24;else for(V=0;V<16;++V)F[V]=b[k++]|b[k++]<<8|b[k++]<<16|b[k++]<<24;b=P.g[0],k=P.g[1],V=P.g[2];let U=P.g[3],O;O=b+(U^k&(V^U))+F[0]+3614090360&4294967295,b=k+(O<<7&4294967295|O>>>25),O=U+(V^b&(k^V))+F[1]+3905402710&4294967295,U=b+(O<<12&4294967295|O>>>20),O=V+(k^U&(b^k))+F[2]+606105819&4294967295,V=U+(O<<17&4294967295|O>>>15),O=k+(b^V&(U^b))+F[3]+3250441966&4294967295,k=V+(O<<22&4294967295|O>>>10),O=b+(U^k&(V^U))+F[4]+4118548399&4294967295,b=k+(O<<7&4294967295|O>>>25),O=U+(V^b&(k^V))+F[5]+1200080426&4294967295,U=b+(O<<12&4294967295|O>>>20),O=V+(k^U&(b^k))+F[6]+2821735955&4294967295,V=U+(O<<17&4294967295|O>>>15),O=k+(b^V&(U^b))+F[7]+4249261313&4294967295,k=V+(O<<22&4294967295|O>>>10),O=b+(U^k&(V^U))+F[8]+1770035416&4294967295,b=k+(O<<7&4294967295|O>>>25),O=U+(V^b&(k^V))+F[9]+2336552879&4294967295,U=b+(O<<12&4294967295|O>>>20),O=V+(k^U&(b^k))+F[10]+4294925233&4294967295,V=U+(O<<17&4294967295|O>>>15),O=k+(b^V&(U^b))+F[11]+2304563134&4294967295,k=V+(O<<22&4294967295|O>>>10),O=b+(U^k&(V^U))+F[12]+1804603682&4294967295,b=k+(O<<7&4294967295|O>>>25),O=U+(V^b&(k^V))+F[13]+4254626195&4294967295,U=b+(O<<12&4294967295|O>>>20),O=V+(k^U&(b^k))+F[14]+2792965006&4294967295,V=U+(O<<17&4294967295|O>>>15),O=k+(b^V&(U^b))+F[15]+1236535329&4294967295,k=V+(O<<22&4294967295|O>>>10),O=b+(V^U&(k^V))+F[1]+4129170786&4294967295,b=k+(O<<5&4294967295|O>>>27),O=U+(k^V&(b^k))+F[6]+3225465664&4294967295,U=b+(O<<9&4294967295|O>>>23),O=V+(b^k&(U^b))+F[11]+643717713&4294967295,V=U+(O<<14&4294967295|O>>>18),O=k+(U^b&(V^U))+F[0]+3921069994&4294967295,k=V+(O<<20&4294967295|O>>>12),O=b+(V^U&(k^V))+F[5]+3593408605&4294967295,b=k+(O<<5&4294967295|O>>>27),O=U+(k^V&(b^k))+F[10]+38016083&4294967295,U=b+(O<<9&4294967295|O>>>23),O=V+(b^k&(U^b))+F[15]+3634488961&4294967295,V=U+(O<<14&4294967295|O>>>18),O=k+(U^b&(V^U))+F[4]+3889429448&4294967295,k=V+(O<<20&4294967295|O>>>12),O=b+(V^U&(k^V))+F[9]+568446438&4294967295,b=k+(O<<5&4294967295|O>>>27),O=U+(k^V&(b^k))+F[14]+3275163606&4294967295,U=b+(O<<9&4294967295|O>>>23),O=V+(b^k&(U^b))+F[3]+4107603335&4294967295,V=U+(O<<14&4294967295|O>>>18),O=k+(U^b&(V^U))+F[8]+1163531501&4294967295,k=V+(O<<20&4294967295|O>>>12),O=b+(V^U&(k^V))+F[13]+2850285829&4294967295,b=k+(O<<5&4294967295|O>>>27),O=U+(k^V&(b^k))+F[2]+4243563512&4294967295,U=b+(O<<9&4294967295|O>>>23),O=V+(b^k&(U^b))+F[7]+1735328473&4294967295,V=U+(O<<14&4294967295|O>>>18),O=k+(U^b&(V^U))+F[12]+2368359562&4294967295,k=V+(O<<20&4294967295|O>>>12),O=b+(k^V^U)+F[5]+4294588738&4294967295,b=k+(O<<4&4294967295|O>>>28),O=U+(b^k^V)+F[8]+2272392833&4294967295,U=b+(O<<11&4294967295|O>>>21),O=V+(U^b^k)+F[11]+1839030562&4294967295,V=U+(O<<16&4294967295|O>>>16),O=k+(V^U^b)+F[14]+4259657740&4294967295,k=V+(O<<23&4294967295|O>>>9),O=b+(k^V^U)+F[1]+2763975236&4294967295,b=k+(O<<4&4294967295|O>>>28),O=U+(b^k^V)+F[4]+1272893353&4294967295,U=b+(O<<11&4294967295|O>>>21),O=V+(U^b^k)+F[7]+4139469664&4294967295,V=U+(O<<16&4294967295|O>>>16),O=k+(V^U^b)+F[10]+3200236656&4294967295,k=V+(O<<23&4294967295|O>>>9),O=b+(k^V^U)+F[13]+681279174&4294967295,b=k+(O<<4&4294967295|O>>>28),O=U+(b^k^V)+F[0]+3936430074&4294967295,U=b+(O<<11&4294967295|O>>>21),O=V+(U^b^k)+F[3]+3572445317&4294967295,V=U+(O<<16&4294967295|O>>>16),O=k+(V^U^b)+F[6]+76029189&4294967295,k=V+(O<<23&4294967295|O>>>9),O=b+(k^V^U)+F[9]+3654602809&4294967295,b=k+(O<<4&4294967295|O>>>28),O=U+(b^k^V)+F[12]+3873151461&4294967295,U=b+(O<<11&4294967295|O>>>21),O=V+(U^b^k)+F[15]+530742520&4294967295,V=U+(O<<16&4294967295|O>>>16),O=k+(V^U^b)+F[2]+3299628645&4294967295,k=V+(O<<23&4294967295|O>>>9),O=b+(V^(k|~U))+F[0]+4096336452&4294967295,b=k+(O<<6&4294967295|O>>>26),O=U+(k^(b|~V))+F[7]+1126891415&4294967295,U=b+(O<<10&4294967295|O>>>22),O=V+(b^(U|~k))+F[14]+2878612391&4294967295,V=U+(O<<15&4294967295|O>>>17),O=k+(U^(V|~b))+F[5]+4237533241&4294967295,k=V+(O<<21&4294967295|O>>>11),O=b+(V^(k|~U))+F[12]+1700485571&4294967295,b=k+(O<<6&4294967295|O>>>26),O=U+(k^(b|~V))+F[3]+2399980690&4294967295,U=b+(O<<10&4294967295|O>>>22),O=V+(b^(U|~k))+F[10]+4293915773&4294967295,V=U+(O<<15&4294967295|O>>>17),O=k+(U^(V|~b))+F[1]+2240044497&4294967295,k=V+(O<<21&4294967295|O>>>11),O=b+(V^(k|~U))+F[8]+1873313359&4294967295,b=k+(O<<6&4294967295|O>>>26),O=U+(k^(b|~V))+F[15]+4264355552&4294967295,U=b+(O<<10&4294967295|O>>>22),O=V+(b^(U|~k))+F[6]+2734768916&4294967295,V=U+(O<<15&4294967295|O>>>17),O=k+(U^(V|~b))+F[13]+1309151649&4294967295,k=V+(O<<21&4294967295|O>>>11),O=b+(V^(k|~U))+F[4]+4149444226&4294967295,b=k+(O<<6&4294967295|O>>>26),O=U+(k^(b|~V))+F[11]+3174756917&4294967295,U=b+(O<<10&4294967295|O>>>22),O=V+(b^(U|~k))+F[2]+718787259&4294967295,V=U+(O<<15&4294967295|O>>>17),O=k+(U^(V|~b))+F[9]+3951481745&4294967295,P.g[0]=P.g[0]+b&4294967295,P.g[1]=P.g[1]+(V+(O<<21&4294967295|O>>>11))&4294967295,P.g[2]=P.g[2]+V&4294967295,P.g[3]=P.g[3]+U&4294967295}i.prototype.v=function(P,b){b===void 0&&(b=P.length);const k=b-this.blockSize,F=this.C;let V=this.h,U=0;for(;U<b;){if(V==0)for(;U<=k;)r(this,P,U),U+=this.blockSize;if(typeof P=="string"){for(;U<b;)if(F[V++]=P.charCodeAt(U++),V==this.blockSize){r(this,F),V=0;break}}else for(;U<b;)if(F[V++]=P[U++],V==this.blockSize){r(this,F),V=0;break}}this.h=V,this.o+=b},i.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var b=1;b<P.length-8;++b)P[b]=0;b=this.o*8;for(var k=P.length-8;k<P.length;++k)P[k]=b&255,b/=256;for(this.v(P),P=Array(16),b=0,k=0;k<4;++k)for(let F=0;F<32;F+=8)P[b++]=this.g[k]>>>F&255;return P};function s(P,b){var k=l;return Object.prototype.hasOwnProperty.call(k,P)?k[P]:k[P]=b(P)}function o(P,b){this.h=b;const k=[];let F=!0;for(let V=P.length-1;V>=0;V--){const U=P[V]|0;F&&U==b||(k[V]=U,F=!1)}this.g=k}var l={};function u(P){return-128<=P&&P<128?s(P,function(b){return new o([b|0],b<0?-1:0)}):new o([P|0],P<0?-1:0)}function h(P){if(isNaN(P)||!isFinite(P))return m;if(P<0)return T(h(-P));const b=[];let k=1;for(let F=0;P>=k;F++)b[F]=P/k|0,k*=4294967296;return new o(b,0)}function f(P,b){if(P.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(P.charAt(0)=="-")return T(f(P.substring(1),b));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=h(Math.pow(b,8));let F=m;for(let U=0;U<P.length;U+=8){var V=Math.min(8,P.length-U);const O=parseInt(P.substring(U,U+V),b);V<8?(V=h(Math.pow(b,V)),F=F.j(V).add(h(O))):(F=F.j(k),F=F.add(h(O)))}return F}var m=u(0),_=u(1),v=u(16777216);n=o.prototype,n.m=function(){if(I(this))return-T(this).m();let P=0,b=1;for(let k=0;k<this.g.length;k++){const F=this.i(k);P+=(F>=0?F:4294967296+F)*b,b*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(S(this))return"0";if(I(this))return"-"+T(this).toString(P);const b=h(Math.pow(P,6));var k=this;let F="";for(;;){const V=L(k,b).g;k=R(k,V.j(b));let U=((k.g.length>0?k.g[0]:k.h)>>>0).toString(P);if(k=V,S(k))return U+F;for(;U.length<6;)U="0"+U;F=U+F}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function S(P){if(P.h!=0)return!1;for(let b=0;b<P.g.length;b++)if(P.g[b]!=0)return!1;return!0}function I(P){return P.h==-1}n.l=function(P){return P=R(this,P),I(P)?-1:S(P)?0:1};function T(P){const b=P.g.length,k=[];for(let F=0;F<b;F++)k[F]=~P.g[F];return new o(k,~P.h).add(_)}n.abs=function(){return I(this)?T(this):this},n.add=function(P){const b=Math.max(this.g.length,P.g.length),k=[];let F=0;for(let V=0;V<=b;V++){let U=F+(this.i(V)&65535)+(P.i(V)&65535),O=(U>>>16)+(this.i(V)>>>16)+(P.i(V)>>>16);F=O>>>16,U&=65535,O&=65535,k[V]=O<<16|U}return new o(k,k[k.length-1]&-2147483648?-1:0)};function R(P,b){return P.add(T(b))}n.j=function(P){if(S(this)||S(P))return m;if(I(this))return I(P)?T(this).j(T(P)):T(T(this).j(P));if(I(P))return T(this.j(T(P)));if(this.l(v)<0&&P.l(v)<0)return h(this.m()*P.m());const b=this.g.length+P.g.length,k=[];for(var F=0;F<2*b;F++)k[F]=0;for(F=0;F<this.g.length;F++)for(let V=0;V<P.g.length;V++){const U=this.i(F)>>>16,O=this.i(F)&65535,se=P.i(V)>>>16,pe=P.i(V)&65535;k[2*F+2*V]+=O*pe,M(k,2*F+2*V),k[2*F+2*V+1]+=U*pe,M(k,2*F+2*V+1),k[2*F+2*V+1]+=O*se,M(k,2*F+2*V+1),k[2*F+2*V+2]+=U*se,M(k,2*F+2*V+2)}for(P=0;P<b;P++)k[P]=k[2*P+1]<<16|k[2*P];for(P=b;P<2*b;P++)k[P]=0;return new o(k,0)};function M(P,b){for(;(P[b]&65535)!=P[b];)P[b+1]+=P[b]>>>16,P[b]&=65535,b++}function N(P,b){this.g=P,this.h=b}function L(P,b){if(S(b))throw Error("division by zero");if(S(P))return new N(m,m);if(I(P))return b=L(T(P),b),new N(T(b.g),T(b.h));if(I(b))return b=L(P,T(b)),new N(T(b.g),b.h);if(P.g.length>30){if(I(P)||I(b))throw Error("slowDivide_ only works with positive integers.");for(var k=_,F=b;F.l(P)<=0;)k=A(k),F=A(F);var V=z(k,1),U=z(F,1);for(F=z(F,2),k=z(k,2);!S(F);){var O=U.add(F);O.l(P)<=0&&(V=V.add(k),U=O),F=z(F,1),k=z(k,1)}return b=R(P,V.j(b)),new N(V,b)}for(V=m;P.l(b)>=0;){for(k=Math.max(1,Math.floor(P.m()/b.m())),F=Math.ceil(Math.log(k)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),U=h(k),O=U.j(b);I(O)||O.l(P)>0;)k-=F,U=h(k),O=U.j(b);S(U)&&(U=_),V=V.add(U),P=R(P,O)}return new N(V,P)}n.B=function(P){return L(this,P).h},n.and=function(P){const b=Math.max(this.g.length,P.g.length),k=[];for(let F=0;F<b;F++)k[F]=this.i(F)&P.i(F);return new o(k,this.h&P.h)},n.or=function(P){const b=Math.max(this.g.length,P.g.length),k=[];for(let F=0;F<b;F++)k[F]=this.i(F)|P.i(F);return new o(k,this.h|P.h)},n.xor=function(P){const b=Math.max(this.g.length,P.g.length),k=[];for(let F=0;F<b;F++)k[F]=this.i(F)^P.i(F);return new o(k,this.h^P.h)};function A(P){const b=P.g.length+1,k=[];for(let F=0;F<b;F++)k[F]=P.i(F)<<1|P.i(F-1)>>>31;return new o(k,P.h)}function z(P,b){const k=b>>5;b%=32;const F=P.g.length-k,V=[];for(let U=0;U<F;U++)V[U]=b>0?P.i(U+k)>>>b|P.i(U+k+1)<<32-b:P.i(U+k);return new o(V,P.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,Pw=o}).apply(typeof O2<"u"?O2:typeof self<"u"?self:typeof window<"u"?window:{});var up=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var mN,sd,yN,Ap,Iv,_N,xN,vN;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof up=="object"&&up];for(var E=0;E<p.length;++E){var C=p[E];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=t(this);function r(p,E){if(E)e:{var C=i;p=p.split(".");for(var j=0;j<p.length-1;j++){var Q=p[j];if(!(Q in C))break e;C=C[Q]}p=p[p.length-1],j=C[p],E=E(j),E!=j&&E!=null&&e(C,p,{configurable:!0,writable:!0,value:E})}}r("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(p){return p||function(E){var C=[],j;for(j in E)Object.prototype.hasOwnProperty.call(E,j)&&C.push([j,E[j]]);return C}});var s=s||{},o=this||self;function l(p){var E=typeof p;return E=="object"&&p!=null||E=="function"}function u(p,E,C){return p.call.apply(p.bind,arguments)}function h(p,E,C){return h=u,h.apply(null,arguments)}function f(p,E){var C=Array.prototype.slice.call(arguments,1);return function(){var j=C.slice();return j.push.apply(j,arguments),p.apply(this,j)}}function m(p,E){function C(){}C.prototype=E.prototype,p.Z=E.prototype,p.prototype=new C,p.prototype.constructor=p,p.Ob=function(j,Q,ie){for(var me=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)me[Be-2]=arguments[Be];return E.prototype[Q].apply(j,me)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function v(p){const E=p.length;if(E>0){const C=Array(E);for(let j=0;j<E;j++)C[j]=p[j];return C}return[]}function S(p,E){for(let j=1;j<arguments.length;j++){const Q=arguments[j];var C=typeof Q;if(C=C!="object"?C:Q?Array.isArray(Q)?"array":C:"null",C=="array"||C=="object"&&typeof Q.length=="number"){C=p.length||0;const ie=Q.length||0;p.length=C+ie;for(let me=0;me<ie;me++)p[C+me]=Q[me]}else p.push(Q)}}class I{constructor(E,C){this.i=E,this.j=C,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function T(p){o.setTimeout(()=>{throw p},0)}function R(){var p=P;let E=null;return p.g&&(E=p.g,p.g=p.g.next,p.g||(p.h=null),E.next=null),E}class M{constructor(){this.h=this.g=null}add(E,C){const j=N.get();j.set(E,C),this.h?this.h.next=j:this.g=j,this.h=j}}var N=new I(()=>new L,p=>p.reset());class L{constructor(){this.next=this.g=this.h=null}set(E,C){this.h=E,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let A,z=!1,P=new M,b=()=>{const p=Promise.resolve(void 0);A=()=>{p.then(k)}};function k(){for(var p;p=R();){try{p.h.call(p.g)}catch(C){T(C)}var E=N;E.j(p),E.h<100&&(E.h++,p.next=E.g,E.g=p)}z=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(p,E){this.type=p,this.g=this.target=E,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,E=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const C=()=>{};o.addEventListener("test",C,E),o.removeEventListener("test",C,E)}catch{}return p})();function O(p){return/^[\s\xa0]*$/.test(p)}function se(p,E){V.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,E)}m(se,V),se.prototype.init=function(p,E){const C=this.type=p.type,j=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=E,E=p.relatedTarget,E||(C=="mouseover"?E=p.fromElement:C=="mouseout"&&(E=p.toElement)),this.relatedTarget=E,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&se.Z.h.call(this)},se.prototype.h=function(){se.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var pe="closure_listenable_"+(Math.random()*1e6|0),J=0;function re(p,E,C,j,Q){this.listener=p,this.proxy=null,this.src=E,this.type=C,this.capture=!!j,this.ha=Q,this.key=++J,this.da=this.fa=!1}function Y(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function H(p,E,C){for(const j in p)E.call(C,p[j],j,p)}function X(p,E){for(const C in p)E.call(void 0,p[C],C,p)}function W(p){const E={};for(const C in p)E[C]=p[C];return E}const G="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function oe(p,E){let C,j;for(let Q=1;Q<arguments.length;Q++){j=arguments[Q];for(C in j)p[C]=j[C];for(let ie=0;ie<G.length;ie++)C=G[ie],Object.prototype.hasOwnProperty.call(j,C)&&(p[C]=j[C])}}function ge(p){this.src=p,this.g={},this.h=0}ge.prototype.add=function(p,E,C,j,Q){const ie=p.toString();p=this.g[ie],p||(p=this.g[ie]=[],this.h++);const me=Te(p,E,j,Q);return me>-1?(E=p[me],C||(E.fa=!1)):(E=new re(E,this.src,ie,!!j,Q),E.fa=C,p.push(E)),E};function xe(p,E){const C=E.type;if(C in p.g){var j=p.g[C],Q=Array.prototype.indexOf.call(j,E,void 0),ie;(ie=Q>=0)&&Array.prototype.splice.call(j,Q,1),ie&&(Y(E),p.g[C].length==0&&(delete p.g[C],p.h--))}}function Te(p,E,C,j){for(let Q=0;Q<p.length;++Q){const ie=p[Q];if(!ie.da&&ie.listener==E&&ie.capture==!!C&&ie.ha==j)return Q}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),le={};function Re(p,E,C,j,Q){if(Array.isArray(E)){for(let ie=0;ie<E.length;ie++)Re(p,E[ie],C,j,Q);return null}return C=Mi(C),p&&p[pe]?p.J(E,C,l(j)?!!j.capture:!1,Q):He(p,E,C,!1,j,Q)}function He(p,E,C,j,Q,ie){if(!E)throw Error("Invalid event type");const me=l(Q)?!!Q.capture:!!Q;let Be=gn(p);if(Be||(p[Me]=Be=new ge(p)),C=Be.add(E,C,j,me,ie),C.proxy)return C;if(j=Wt(),C.proxy=j,j.src=p,j.listener=C,p.addEventListener)U||(Q=me),Q===void 0&&(Q=!1),p.addEventListener(E.toString(),j,Q);else if(p.attachEvent)p.attachEvent(Zn(E.toString()),j);else if(p.addListener&&p.removeListener)p.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Wt(){function p(C){return E.call(p.src,p.listener,C)}const E=fn;return p}function sr(p,E,C,j,Q){if(Array.isArray(E))for(var ie=0;ie<E.length;ie++)sr(p,E[ie],C,j,Q);else j=l(j)?!!j.capture:!!j,C=Mi(C),p&&p[pe]?(p=p.i,ie=String(E).toString(),ie in p.g&&(E=p.g[ie],C=Te(E,C,j,Q),C>-1&&(Y(E[C]),Array.prototype.splice.call(E,C,1),E.length==0&&(delete p.g[ie],p.h--)))):p&&(p=gn(p))&&(E=p.g[E.toString()],p=-1,E&&(p=Te(E,C,j,Q)),(C=p>-1?E[p]:null)&&Yn(C))}function Yn(p){if(typeof p!="number"&&p&&!p.da){var E=p.src;if(E&&E[pe])xe(E.i,p);else{var C=p.type,j=p.proxy;E.removeEventListener?E.removeEventListener(C,j,p.capture):E.detachEvent?E.detachEvent(Zn(C),j):E.addListener&&E.removeListener&&E.removeListener(j),(C=gn(E))?(xe(C,p),C.h==0&&(C.src=null,E[Me]=null)):Y(p)}}}function Zn(p){return p in le?le[p]:le[p]="on"+p}function fn(p,E){if(p.da)p=!0;else{E=new se(E,this);const C=p.listener,j=p.ha||p.src;p.fa&&Yn(p),p=C.call(j,E)}return p}function gn(p){return p=p[Me],p instanceof ge?p:null}var Qn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Mi(p){return typeof p=="function"?p:(p[Qn]||(p[Qn]=function(E){return p.handleEvent(E)}),p[Qn])}function _t(){F.call(this),this.i=new ge(this),this.M=this,this.G=null}m(_t,F),_t.prototype[pe]=!0,_t.prototype.removeEventListener=function(p,E,C,j){sr(this,p,E,C,j)};function ht(p,E){var C,j=p.G;if(j)for(C=[];j;j=j.G)C.push(j);if(p=p.M,j=E.type||E,typeof E=="string")E=new V(E,p);else if(E instanceof V)E.target=E.target||p;else{var Q=E;E=new V(j,p),oe(E,Q)}Q=!0;let ie,me;if(C)for(me=C.length-1;me>=0;me--)ie=E.g=C[me],Q=rn(ie,j,!0,E)&&Q;if(ie=E.g=p,Q=rn(ie,j,!0,E)&&Q,Q=rn(ie,j,!1,E)&&Q,C)for(me=0;me<C.length;me++)ie=E.g=C[me],Q=rn(ie,j,!1,E)&&Q}_t.prototype.N=function(){if(_t.Z.N.call(this),this.i){var p=this.i;for(const E in p.g){const C=p.g[E];for(let j=0;j<C.length;j++)Y(C[j]);delete p.g[E],p.h--}}this.G=null},_t.prototype.J=function(p,E,C,j){return this.i.add(String(p),E,!1,C,j)},_t.prototype.K=function(p,E,C,j){return this.i.add(String(p),E,!0,C,j)};function rn(p,E,C,j){if(E=p.i.g[String(E)],!E)return!0;E=E.concat();let Q=!0;for(let ie=0;ie<E.length;++ie){const me=E[ie];if(me&&!me.da&&me.capture==C){const Be=me.listener,Vt=me.ha||me.src;me.fa&&xe(p.i,me),Q=Be.call(Vt,j)!==!1&&Q}}return Q&&!j.defaultPrevented}function Li(p,E){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:o.setTimeout(p,E||0)}function bt(p){p.g=Li(()=>{p.g=null,p.i&&(p.i=!1,bt(p))},p.l);const E=p.h;p.h=null,p.m.apply(null,E)}class ao extends F{constructor(E,C){super(),this.m=E,this.l=C,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:bt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Oi(p){F.call(this),this.h=p,this.g={}}m(Oi,F);var Mr=[];function or(p){H(p.g,function(E,C){this.g.hasOwnProperty(C)&&Yn(E)},p),p.g={}}Oi.prototype.N=function(){Oi.Z.N.call(this),or(this)},Oi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Lr=o.JSON.stringify,ya=o.JSON.parse,Or=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function ji(){}function Gl(){}var jr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ws(){V.call(this,"d")}m(ws,V);function lo(){V.call(this,"c")}m(lo,V);var Un={},Es=null;function Fr(){return Es=Es||new _t}Un.Ia="serverreachability";function Vr(p){V.call(this,Un.Ia,p)}m(Vr,V);function Bn(p){const E=Fr();ht(E,new Vr(E))}Un.STAT_EVENT="statevent";function Wn(p,E){V.call(this,Un.STAT_EVENT,p),this.stat=E}m(Wn,V);function gt(p){const E=Fr();ht(E,new Wn(E,p))}Un.Ja="timingevent";function co(p,E){V.call(this,Un.Ja,p),this.size=E}m(co,V);function ar(p,E){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},E)}function jt(){this.g=!0}jt.prototype.ua=function(){this.g=!1};function Fi(p,E,C,j,Q,ie){p.info(function(){if(p.g)if(ie){var me="",Be=ie.split("&");for(let dt=0;dt<Be.length;dt++){var Vt=Be[dt].split("=");if(Vt.length>1){const $t=Vt[0];Vt=Vt[1];const wi=$t.split("_");me=wi.length>=2&&wi[1]=="type"?me+($t+"="+Vt+"&"):me+($t+"=redacted&")}}}else me=null;else me=ie;return"XMLHTTP REQ ("+j+") [attempt "+Q+"]: "+E+`
`+C+`
`+me})}function pn(p,E,C,j,Q,ie,me){p.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+Q+"]: "+E+`
`+C+`
`+ie+" "+me})}function Ft(p,E,C,j){p.info(function(){return"XMLHTTP TEXT ("+E+"): "+yn(p,C)+(j?" "+j:"")})}function mn(p,E){p.info(function(){return"TIMEOUT: "+E})}jt.prototype.info=function(){};function yn(p,E){if(!p.g)return E;if(!E)return null;try{const ie=JSON.parse(E);if(ie){for(p=0;p<ie.length;p++)if(Array.isArray(ie[p])){var C=ie[p];if(!(C.length<2)){var j=C[1];if(Array.isArray(j)&&!(j.length<1)){var Q=j[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(let me=1;me<j.length;me++)j[me]=""}}}}return Lr(ie)}catch{return E}}var sn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ot={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Gt;function Yt(){}m(Yt,ji),Yt.prototype.g=function(){return new XMLHttpRequest},Gt=new Yt;function Vi(p){return encodeURIComponent(String(p))}function $l(p){var E=1;p=p.split(":");const C=[];for(;E>0&&p.length;)C.push(p.shift()),E--;return p.length&&C.push(p.join(":")),C}function zi(p,E,C,j){this.j=p,this.i=E,this.l=C,this.S=j||1,this.V=new Oi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ff}function Ff(){this.i=null,this.g="",this.h=!1}var Vf={},Hu={};function lr(p,E,C){p.M=1,p.A=Ss(Ui(E)),p.u=C,p.R=!0,Ku(p,null)}function Ku(p,E){p.F=Date.now(),_a(p),p.B=Ui(p.A);var C=p.B,j=p.S;Array.isArray(j)||(j=[String(j)]),ih(C.i,"t",j),p.C=0,C=p.j.L,p.h=new Ff,p.g=Xf(p.j,C?E:null,!p.u),p.P>0&&(p.O=new ao(h(p.Y,p,p.g),p.P)),E=p.V,C=p.g,j=p.ba;var Q="readystatechange";Array.isArray(Q)||(Q&&(Mr[0]=Q.toString()),Q=Mr);for(let ie=0;ie<Q.length;ie++){const me=Re(C,Q[ie],j||E.handleEvent,!1,E.h||E);if(!me)break;E.g[me.key]=me}E=p.J?W(p.J):{},p.u?(p.v||(p.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,E)):(p.v="GET",p.g.ea(p.B,p.v,null,E)),Bn(),Fi(p.i,p.v,p.B,p.l,p.S,p.u)}zi.prototype.ba=function(p){p=p.target;const E=this.O;E&&Hr(p)==3?E.j():this.Y(p)},zi.prototype.Y=function(p){try{if(p==this.g)e:{const Be=Hr(this.g),Vt=this.g.ya(),dt=this.g.ca();if(!(Be<3)&&(Be!=3||this.g&&(this.h.h||this.g.la()||Kf(this.g)))){this.K||Be!=4||Vt==7||(Vt==8||dt<=0?Bn(3):Bn(2)),Hl(this);var E=this.g.ca();this.X=E;var C=zf(this);if(this.o=E==200,pn(this.i,this.v,this.B,this.l,this.S,Be,E),this.o){if(this.U&&!this.L){t:{if(this.g){var j,Q=this.g;if((j=Q.g?Q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(j)){var ie=j;break t}}ie=null}if(p=ie)Ft(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,vt(this,p);else{this.o=!1,this.m=3,gt(12),Ts(this),xa(this);break e}}if(this.R){p=!0;let $t;for(;!this.K&&this.C<C.length;)if($t=Bf(this,C),$t==Hu){Be==4&&(this.m=4,gt(14),p=!1),Ft(this.i,this.l,null,"[Incomplete Response]");break}else if($t==Vf){this.m=4,gt(15),Ft(this.i,this.l,C,"[Invalid Chunk]"),p=!1;break}else Ft(this.i,this.l,$t,null),vt(this,$t);if(Uf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Be!=4||C.length!=0||this.h.h||(this.m=1,gt(16),p=!1),this.o=this.o&&p,!p)Ft(this.i,this.l,C,"[Invalid Chunked Response]"),Ts(this),xa(this);else if(C.length>0&&!this.W){this.W=!0;var me=this.j;me.g==this&&me.aa&&!me.P&&(me.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),Ra(me),me.P=!0,gt(11))}}else Ft(this.i,this.l,C,null),vt(this,C);Be==4&&Ts(this),this.o&&!this.K&&(Be==4?nc(this.j,this):(this.o=!1,_a(this)))}else sh(this.g),E==400&&C.indexOf("Unknown SID")>0?(this.m=3,gt(12)):(this.m=0,gt(13)),Ts(this),xa(this)}}}catch{}};function zf(p){if(!Uf(p))return p.g.la();const E=Kf(p.g);if(E==="")return"";let C="";const j=E.length,Q=Hr(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Ts(p),xa(p),"";p.h.i=new o.TextDecoder}for(let ie=0;ie<j;ie++)p.h.h=!0,C+=p.h.i.decode(E[ie],{stream:!(Q&&ie==j-1)});return E.length=0,p.h.g+=C,p.C=0,p.h.g}function Uf(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function Bf(p,E){var C=p.C,j=E.indexOf(`
`,C);return j==-1?Hu:(C=Number(E.substring(C,j)),isNaN(C)?Vf:(j+=1,j+C>E.length?Hu:(E=E.slice(j,j+C),p.C=j+C,E)))}zi.prototype.cancel=function(){this.K=!0,Ts(this)};function _a(p){p.T=Date.now()+p.H,qu(p,p.H)}function qu(p,E){if(p.D!=null)throw Error("WatchDog timer not null");p.D=ar(h(p.aa,p),E)}function Hl(p){p.D&&(o.clearTimeout(p.D),p.D=null)}zi.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(mn(this.i,this.B),this.M!=2&&(Bn(),gt(17)),Ts(this),this.m=2,xa(this)):qu(this,this.T-p)};function xa(p){p.j.I==0||p.K||nc(p.j,p)}function Ts(p){Hl(p);var E=p.O;E&&typeof E.dispose=="function"&&E.dispose(),p.O=null,or(p.V),p.g&&(E=p.g,p.g=null,E.abort(),E.dispose())}function vt(p,E){try{var C=p.j;if(C.I!=0&&(C.g==p||Yu(C.h,p))){if(!p.L&&Yu(C.h,p)&&C.I==3){try{var j=C.Ba.g.parse(E)}catch{j=null}if(Array.isArray(j)&&j.length==3){var Q=j;if(Q[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<p.F)tc(C),xi(C);else break e;Xr(C),gt(18)}}else C.xa=Q[1],0<C.xa-C.K&&Q[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=ar(h(C.Va,C),6e3));va(C.h)<=1&&C.ta&&(C.ta=void 0)}else vi(C,11)}else if((p.L||C.g==p)&&tc(C),!O(E))for(Q=C.Ba.g.parse(E),E=0;E<Q.length;E++){let dt=Q[E];const $t=dt[0];if(!($t<=C.K))if(C.K=$t,dt=dt[1],C.I==2)if(dt[0]=="c"){C.M=dt[1],C.ba=dt[2];const wi=dt[3];wi!=null&&(C.ka=wi,C.j.info("VER="+C.ka));const As=dt[4];As!=null&&(C.za=As,C.j.info("SVER="+C.za));const Yr=dt[5];Yr!=null&&typeof Yr=="number"&&Yr>0&&(j=1.5*Yr,C.O=j,C.j.info("backChannelRequestTimeoutMs_="+j)),j=C;const Zr=p.g;if(Zr){const sc=Zr.g?Zr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(sc){var ie=j.h;ie.g||sc.indexOf("spdy")==-1&&sc.indexOf("quic")==-1&&sc.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(ql(ie,ie.h),ie.h=null))}if(j.G){const lh=Zr.g?Zr.g.getResponseHeader("X-HTTP-Session-Id"):null;lh&&(j.wa=lh,at(j.J,j.G,lh))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-p.F,C.j.info("Handshake RTT: "+C.T+"ms")),j=C;var me=p;if(j.na=ah(j,j.L?j.ba:null,j.W),me.L){wa(j.h,me);var Be=me,Vt=j.O;Vt&&(Be.H=Vt),Be.D&&(Hl(Be),_a(Be)),j.g=me}else An(j);C.i.length>0&&Rs(C)}else dt[0]!="stop"&&dt[0]!="close"||vi(C,7);else C.I==3&&(dt[0]=="stop"||dt[0]=="close"?dt[0]=="stop"?vi(C,7):Jl(C):dt[0]!="noop"&&C.l&&C.l.qa(dt),C.A=0)}}Bn(4)}catch{}}var G0=class{constructor(p,E){this.g=p,this.map=E}};function Kl(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Xu(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function va(p){return p.h?1:p.g?p.g.size:0}function Yu(p,E){return p.h?p.h==E:p.g?p.g.has(E):!1}function ql(p,E){p.g?p.g.add(E):p.h=E}function wa(p,E){p.h&&p.h==E?p.h=null:p.g&&p.g.has(E)&&p.g.delete(E)}Kl.prototype.cancel=function(){if(this.i=mi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function mi(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let E=p.i;for(const C of p.g.values())E=E.concat(C.G);return E}return v(p.i)}var Wf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yi(p,E){if(p){p=p.split("&");for(let C=0;C<p.length;C++){const j=p[C].indexOf("=");let Q,ie=null;j>=0?(Q=p[C].substring(0,j),ie=p[C].substring(j+1)):Q=p[C],E(Q,ie?decodeURIComponent(ie.replace(/\+/g," ")):"")}}}function zr(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;p instanceof zr?(this.l=p.l,Ea(this,p.j),this.o=p.o,this.g=p.g,Ur(this,p.u),this.h=p.h,uo(this,rh(p.i)),this.m=p.m):p&&(E=String(p).match(Wf))?(this.l=!1,Ea(this,E[1]||"",!0),this.o=Ta(E[2]||""),this.g=Ta(E[3]||"",!0),Ur(this,E[4]),this.h=Ta(E[5]||"",!0),uo(this,E[6]||"",!0),this.m=Ta(E[7]||"")):(this.l=!1,this.i=new Ye(null,this.l))}zr.prototype.toString=function(){const p=[];var E=this.j;E&&p.push(Sa(E,Qu,!0),":");var C=this.g;return(C||E=="file")&&(p.push("//"),(E=this.o)&&p.push(Sa(E,Qu,!0),"@"),p.push(Vi(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&p.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&p.push("/"),p.push(Sa(C,C.charAt(0)=="/"?Ia:Ju,!0))),(C=this.i.toString())&&p.push("?",C),(C=this.m)&&p.push("#",Sa(C,eh)),p.join("")},zr.prototype.resolve=function(p){const E=Ui(this);let C=!!p.j;C?Ea(E,p.j):C=!!p.o,C?E.o=p.o:C=!!p.g,C?E.g=p.g:C=p.u!=null;var j=p.h;if(C)Ur(E,p.u);else if(C=!!p.h){if(j.charAt(0)!="/")if(this.g&&!this.h)j="/"+j;else{var Q=E.h.lastIndexOf("/");Q!=-1&&(j=E.h.slice(0,Q+1)+j)}if(Q=j,Q==".."||Q==".")j="";else if(Q.indexOf("./")!=-1||Q.indexOf("/.")!=-1){j=Q.lastIndexOf("/",0)==0,Q=Q.split("/");const ie=[];for(let me=0;me<Q.length;){const Be=Q[me++];Be=="."?j&&me==Q.length&&ie.push(""):Be==".."?((ie.length>1||ie.length==1&&ie[0]!="")&&ie.pop(),j&&me==Q.length&&ie.push("")):(ie.push(Be),j=!0)}j=ie.join("/")}else j=Q}return C?E.h=j:C=p.i.toString()!=="",C?uo(E,rh(p.i)):C=!!p.m,C&&(E.m=p.m),E};function Ui(p){return new zr(p)}function Ea(p,E,C){p.j=C?Ta(E,!0):E,p.j&&(p.j=p.j.replace(/:$/,""))}function Ur(p,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);p.u=E}else p.u=null}function uo(p,E,C){E instanceof Ye?(p.i=E,Yl(p.i,p.l)):(C||(E=Sa(E,$0)),p.i=new Ye(E,p.l))}function at(p,E,C){p.i.set(E,C)}function Ss(p){return at(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Ta(p,E){return p?E?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Sa(p,E,C){return typeof p=="string"?(p=encodeURI(p).replace(E,Zu),C&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Zu(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Qu=/[#\/\?@]/g,Ju=/[#\?:]/g,Ia=/[#\?]/g,$0=/[#\?@]/g,eh=/#/g;function Ye(p,E){this.h=this.g=null,this.i=p||null,this.j=!!E}function Br(p){p.g||(p.g=new Map,p.h=0,p.i&&yi(p.i,function(E,C){p.add(decodeURIComponent(E.replace(/\+/g," ")),C)}))}n=Ye.prototype,n.add=function(p,E){Br(this),this.i=null,p=Wr(this,p);let C=this.g.get(p);return C||this.g.set(p,C=[]),C.push(E),this.h+=1,this};function th(p,E){Br(p),E=Wr(p,E),p.g.has(E)&&(p.i=null,p.h-=p.g.get(E).length,p.g.delete(E))}function Xl(p,E){return Br(p),E=Wr(p,E),p.g.has(E)}n.forEach=function(p,E){Br(this),this.g.forEach(function(C,j){C.forEach(function(Q){p.call(E,Q,j,this)},this)},this)};function nh(p,E){Br(p);let C=[];if(typeof E=="string")Xl(p,E)&&(C=C.concat(p.g.get(Wr(p,E))));else for(p=Array.from(p.g.values()),E=0;E<p.length;E++)C=C.concat(p[E]);return C}n.set=function(p,E){return Br(this),this.i=null,p=Wr(this,p),Xl(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[E]),this.h+=1,this},n.get=function(p,E){return p?(p=nh(this,p),p.length>0?String(p[0]):E):E};function ih(p,E,C){th(p,E),C.length>0&&(p.i=null,p.g.set(Wr(p,E),v(C)),p.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],E=Array.from(this.g.keys());for(let j=0;j<E.length;j++){var C=E[j];const Q=Vi(C);C=nh(this,C);for(let ie=0;ie<C.length;ie++){let me=Q;C[ie]!==""&&(me+="="+Vi(C[ie])),p.push(me)}}return this.i=p.join("&")};function rh(p){const E=new Ye;return E.i=p.i,p.g&&(E.g=new Map(p.g),E.h=p.h),E}function Wr(p,E){return E=String(E),p.j&&(E=E.toLowerCase()),E}function Yl(p,E){E&&!p.j&&(Br(p),p.i=null,p.g.forEach(function(C,j){const Q=j.toLowerCase();j!=Q&&(th(this,j),ih(this,Q,C))},p)),p.j=E}function Gr(p,E){const C=new jt;if(o.Image){const j=new Image;j.onload=f(_n,C,"TestLoadImage: loaded",!0,E,j),j.onerror=f(_n,C,"TestLoadImage: error",!1,E,j),j.onabort=f(_n,C,"TestLoadImage: abort",!1,E,j),j.ontimeout=f(_n,C,"TestLoadImage: timeout",!1,E,j),o.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=p}else E(!1)}function $r(p,E){const C=new jt,j=new AbortController,Q=setTimeout(()=>{j.abort(),_n(C,"TestPingServer: timeout",!1,E)},1e4);fetch(p,{signal:j.signal}).then(ie=>{clearTimeout(Q),ie.ok?_n(C,"TestPingServer: ok",!0,E):_n(C,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(Q),_n(C,"TestPingServer: error",!1,E)})}function _n(p,E,C,j,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),j(C)}catch{}}function ba(){this.g=new Or}function Is(p){this.i=p.Sb||null,this.h=p.ab||!1}m(Is,ji),Is.prototype.g=function(){return new _i(this.i,this.h)};function _i(p,E){_t.call(this),this.H=p,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(_i,_t),n=_i.prototype,n.open=function(p,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=E,this.readyState=1,cr(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(E.body=p),(this.H||o).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ho(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,cr(this)),this.g&&(this.readyState=3,cr(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Gf(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Gf(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var E=p.value?p.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!p.done}))&&(this.response=this.responseText+=E)}p.done?ho(this):cr(this),this.readyState==3&&Gf(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,ho(this))},n.Na=function(p){this.g&&(this.response=p,ho(this))},n.ga=function(){this.g&&ho(this)};function ho(p){p.readyState=4,p.l=null,p.j=null,p.B=null,cr(p)}n.setRequestHeader=function(p,E){this.A.append(p,E)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],E=this.h.entries();for(var C=E.next();!C.done;)C=C.value,p.push(C[0]+": "+C[1]),C=E.next();return p.join(`\r
`)};function cr(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(_i.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function $f(p){let E="";return H(p,function(C,j){E+=j,E+=":",E+=C,E+=`\r
`}),E}function Zl(p,E,C){e:{for(j in C){var j=!1;break e}j=!0}j||(C=$f(C),typeof p=="string"?C!=null&&Vi(C):at(p,E,C))}function mt(p){_t.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(mt,_t);var Hf=/^https?$/i,H0=["POST","PUT"];n=mt.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,E,C,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);E=E?E.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Gt.g(),this.g.onreadystatechange=_(h(this.Ca,this));try{this.B=!0,this.g.open(E,String(p),!0),this.B=!1}catch(ie){fo(this,ie);return}if(p=C||"",C=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var Q in j)C.set(Q,j[Q]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const ie of j.keys())C.set(ie,j.get(ie));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(C.keys()).find(ie=>ie.toLowerCase()=="content-type"),Q=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(H0,E,void 0)>=0)||j||Q||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,me]of C)this.g.setRequestHeader(ie,me);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(ie){fo(this,ie)}};function fo(p,E){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=E,p.o=5,go(p),Cs(p)}function go(p){p.A||(p.A=!0,ht(p,"complete"),ht(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,ht(this,"complete"),ht(this,"abort"),Cs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Cs(this,!0)),mt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?bs(this):this.Xa())},n.Xa=function(){bs(this)};function bs(p){if(p.h&&typeof s<"u"){if(p.v&&Hr(p)==4)setTimeout(p.Ca.bind(p),0);else if(ht(p,"readystatechange"),Hr(p)==4){p.h=!1;try{const ie=p.ca();e:switch(ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var C;if(!(C=E)){var j;if(j=ie===0){let me=String(p.D).match(Wf)[1]||null;!me&&o.self&&o.self.location&&(me=o.self.location.protocol.slice(0,-1)),j=!Hf.test(me?me.toLowerCase():"")}C=j}if(C)ht(p,"complete"),ht(p,"success");else{p.o=6;try{var Q=Hr(p)>2?p.g.statusText:""}catch{Q=""}p.l=Q+" ["+p.ca()+"]",go(p)}}finally{Cs(p)}}}}function Cs(p,E){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const C=p.g;p.g=null,E||ht(p,"ready");try{C.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Hr(p){return p.g?p.g.readyState:0}n.ca=function(){try{return Hr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var E=this.g.responseText;return p&&E.indexOf(p)==0&&(E=E.substring(p.length)),ya(E)}};function Kf(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function sh(p){const E={};p=(p.g&&Hr(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<p.length;j++){if(O(p[j]))continue;var C=$l(p[j]);const Q=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ie=E[Q]||[];E[Q]=ie,ie.push(C)}X(E,function(j){return j.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Kr(p,E,C){return C&&C.internalChannelParams&&C.internalChannelParams[p]||E}function Ql(p){this.za=0,this.i=[],this.j=new jt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Kr("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Kr("baseRetryDelayMs",5e3,p),this.Za=Kr("retryDelaySeedMs",1e4,p),this.Ta=Kr("forwardChannelMaxRetries",2,p),this.va=Kr("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Kl(p&&p.concurrentRequestLimit),this.Ba=new ba,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ql.prototype,n.ka=8,n.I=1,n.connect=function(p,E,C,j){gt(0),this.W=p,this.H=E||{},C&&j!==void 0&&(this.H.OSID=C,this.H.OAID=j),this.F=this.X,this.J=ah(this,null,this.W),Rs(this)};function Jl(p){if(ec(p),p.I==3){var E=p.V++,C=Ui(p.J);if(at(C,"SID",p.M),at(C,"RID",E),at(C,"TYPE","terminate"),qr(p,C),E=new zi(p,p.j,E),E.M=2,E.A=Ss(Ui(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(E.A.toString(),"")}catch{}!C&&o.Image&&(new Image().src=E.A,C=!0),C||(E.g=Xf(E.j,null),E.g.ea(E.A)),E.F=Date.now(),_a(E)}Aa(p)}function xi(p){p.g&&(Ra(p),p.g.cancel(),p.g=null)}function ec(p){xi(p),p.v&&(o.clearTimeout(p.v),p.v=null),tc(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function Rs(p){if(!Xu(p.h)&&!p.m){p.m=!0;var E=p.Ea;A||b(),z||(A(),z=!0),P.add(E,p),p.D=0}}function qf(p,E){return va(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=E.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=ar(h(p.Ea,p,E),ic(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const Q=new zi(this,this.j,p);let ie=this.o;if(this.U&&(ie?(ie=W(ie),oe(ie,this.U)):ie=this.U),this.u!==null||this.R||(Q.J=ie,ie=null),this.S)e:{for(var E=0,C=0;C<this.i.length;C++){t:{var j=this.i[C];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(E+=j,E>4096){E=C;break e}if(E===4096||C===this.i.length-1){E=C+1;break e}}E=1e3}else E=1e3;E=oh(this,Q,E),C=Ui(this.J),at(C,"RID",p),at(C,"CVER",22),this.G&&at(C,"X-HTTP-Session-Id",this.G),qr(this,C),ie&&(this.R?E="headers="+Vi($f(ie))+"&"+E:this.u&&Zl(C,this.u,ie)),ql(this.h,Q),this.Ra&&at(C,"TYPE","init"),this.S?(at(C,"$req",E),at(C,"SID","null"),Q.U=!0,lr(Q,C,null)):lr(Q,C,E),this.I=2}}else this.I==3&&(p?Ca(this,p):this.i.length==0||Xu(this.h)||Ca(this))};function Ca(p,E){var C;E?C=E.l:C=p.V++;const j=Ui(p.J);at(j,"SID",p.M),at(j,"RID",C),at(j,"AID",p.K),qr(p,j),p.u&&p.o&&Zl(j,p.u,p.o),C=new zi(p,p.j,C,p.D+1),p.u===null&&(C.J=p.o),E&&(p.i=E.G.concat(p.i)),E=oh(p,C,1e3),C.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),ql(p.h,C),lr(C,j,E)}function qr(p,E){p.H&&H(p.H,function(C,j){at(E,j,C)}),p.l&&H({},function(C,j){at(E,j,C)})}function oh(p,E,C){C=Math.min(p.i.length,C);const j=p.l?h(p.l.Ka,p.l,p):null;e:{var Q=p.i;let Be=-1;for(;;){const Vt=["count="+C];Be==-1?C>0?(Be=Q[0].g,Vt.push("ofs="+Be)):Be=0:Vt.push("ofs="+Be);let dt=!0;for(let $t=0;$t<C;$t++){var ie=Q[$t].g;const wi=Q[$t].map;if(ie-=Be,ie<0)Be=Math.max(0,Q[$t].g-100),dt=!1;else try{ie="req"+ie+"_"||"";try{var me=wi instanceof Map?wi:Object.entries(wi);for(const[As,Yr]of me){let Zr=Yr;l(Yr)&&(Zr=Lr(Yr)),Vt.push(ie+As+"="+encodeURIComponent(Zr))}}catch(As){throw Vt.push(ie+"type="+encodeURIComponent("_badmap")),As}}catch{j&&j(wi)}}if(dt){me=Vt.join("&");break e}}me=void 0}return p=p.i.splice(0,C),E.G=p,me}function An(p){if(!p.g&&!p.v){p.Y=1;var E=p.Da;A||b(),z||(A(),z=!0),P.add(E,p),p.A=0}}function Xr(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=ar(h(p.Da,p),ic(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,po(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=ar(h(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,gt(10),xi(this),po(this))};function Ra(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function po(p){p.g=new zi(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var E=Ui(p.na);at(E,"RID","rpc"),at(E,"SID",p.M),at(E,"AID",p.K),at(E,"CI",p.F?"0":"1"),!p.F&&p.ia&&at(E,"TO",p.ia),at(E,"TYPE","xmlhttp"),qr(p,E),p.u&&p.o&&Zl(E,p.u,p.o),p.O&&(p.g.H=p.O);var C=p.g;p=p.ba,C.M=1,C.A=Ss(Ui(E)),C.u=null,C.R=!0,Ku(C,p)}n.Va=function(){this.C!=null&&(this.C=null,xi(this),Xr(this),gt(19))};function tc(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function nc(p,E){var C=null;if(p.g==E){tc(p),Ra(p),p.g=null;var j=2}else if(Yu(p.h,E))C=E.G,wa(p.h,E),j=1;else return;if(p.I!=0){if(E.o)if(j==1){C=E.u?E.u.length:0,E=Date.now()-E.F;var Q=p.D;j=Fr(),ht(j,new co(j,C)),Rs(p)}else An(p);else if(Q=E.m,Q==3||Q==0&&E.X>0||!(j==1&&qf(p,E)||j==2&&Xr(p)))switch(C&&C.length>0&&(E=p.h,E.i=E.i.concat(C)),Q){case 1:vi(p,5);break;case 4:vi(p,10);break;case 3:vi(p,6);break;default:vi(p,2)}}}function ic(p,E){let C=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(C*=2),C*E}function vi(p,E){if(p.j.info("Error code "+E),E==2){var C=h(p.bb,p),j=p.Ua;const Q=!j;j=new zr(j||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ea(j,"https"),Ss(j),Q?Gr(j.toString(),C):$r(j.toString(),C)}else gt(2);p.I=0,p.l&&p.l.pa(E),Aa(p),ec(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Aa(p){if(p.I=0,p.ja=[],p.l){const E=mi(p.h);(E.length!=0||p.i.length!=0)&&(S(p.ja,E),S(p.ja,p.i),p.h.i.length=0,v(p.i),p.i.length=0),p.l.oa()}}function ah(p,E,C){var j=C instanceof zr?Ui(C):new zr(C);if(j.g!="")E&&(j.g=E+"."+j.g),Ur(j,j.u);else{var Q=o.location;j=Q.protocol,E=E?E+"."+Q.hostname:Q.hostname,Q=+Q.port;const ie=new zr(null);j&&Ea(ie,j),E&&(ie.g=E),Q&&Ur(ie,Q),C&&(ie.h=C),j=ie}return C=p.G,E=p.wa,C&&E&&at(j,C,E),at(j,"VER",p.ka),qr(p,j),j}function Xf(p,E,C){if(E&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=p.Aa&&!p.ma?new mt(new Is({ab:C})):new mt(p.ma),E.Fa(p.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yf(){}n=Yf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function rc(){}rc.prototype.g=function(p,E){return new xn(p,E)};function xn(p,E){_t.call(this),this.g=new Ql(E),this.l=p,this.h=E&&E.messageUrlParams||null,p=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(p?p["X-WebChannel-Content-Type"]=E.messageContentType:p={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(p?p["X-WebChannel-Client-Profile"]=E.sa:p={"X-WebChannel-Client-Profile":E.sa}),this.g.U=p,(p=E&&E.Qb)&&!O(p)&&(this.g.u=p),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!O(E)&&(this.g.G=E,p=this.h,p!==null&&E in p&&(p=this.h,E in p&&delete p[E])),this.j=new mo(this)}m(xn,_t),xn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){Jl(this.g)},xn.prototype.o=function(p){var E=this.g;if(typeof p=="string"){var C={};C.__data__=p,p=C}else this.v&&(C={},C.__data__=Lr(p),p=C);E.i.push(new G0(E.Ya++,p)),E.I==3&&Rs(E)},xn.prototype.N=function(){this.g.l=null,delete this.j,Jl(this.g),delete this.g,xn.Z.N.call(this)};function Zf(p){ws.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var E=p.__sm__;if(E){e:{for(const C in E){p=C;break e}p=void 0}(this.i=p)&&(p=this.i,E=E!==null&&p in E?E[p]:void 0),this.data=E}else this.data=p}m(Zf,ws);function Qf(){lo.call(this),this.status=1}m(Qf,lo);function mo(p){this.g=p}m(mo,Yf),mo.prototype.ra=function(){ht(this.g,"a")},mo.prototype.qa=function(p){ht(this.g,new Zf(p))},mo.prototype.pa=function(p){ht(this.g,new Qf)},mo.prototype.oa=function(){ht(this.g,"b")},rc.prototype.createWebChannel=rc.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,vN=function(){return new rc},xN=function(){return Fr()},_N=Un,Iv={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},sn.NO_ERROR=0,sn.TIMEOUT=8,sn.HTTP_ERROR=6,Ap=sn,ot.COMPLETE="complete",yN=ot,Gl.EventType=jr,jr.OPEN="a",jr.CLOSE="b",jr.ERROR="c",jr.MESSAGE="d",_t.prototype.listen=_t.prototype.J,sd=Gl,mt.prototype.listenOnce=mt.prototype.K,mt.prototype.getLastError=mt.prototype.Ha,mt.prototype.getLastErrorCode=mt.prototype.ya,mt.prototype.getStatus=mt.prototype.ca,mt.prototype.getResponseJson=mt.prototype.La,mt.prototype.getResponseText=mt.prototype.la,mt.prototype.send=mt.prototype.ea,mt.prototype.setWithCredentials=mt.prototype.Fa,mN=mt}).apply(typeof up<"u"?up:typeof self<"u"?self:typeof window<"u"?window:{});const j2="@firebase/firestore",F2="4.9.3";let Tn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Tn.UNAUTHENTICATED=new Tn(null),Tn.GOOGLE_CREDENTIALS=new Tn("google-credentials-uid"),Tn.FIRST_PARTY=new Tn("first-party-uid"),Tn.MOCK_USER=new Tn("mock-user");let Gu="12.7.0";const Nl=new yw("@firebase/firestore");function Wc(){return Nl.logLevel}function ye(n,...e){if(Nl.logLevel<=Xe.DEBUG){const t=e.map(kw);Nl.debug(`Firestore (${Gu}): ${n}`,...t)}}function Ci(n,...e){if(Nl.logLevel<=Xe.ERROR){const t=e.map(kw);Nl.error(`Firestore (${Gu}): ${n}`,...t)}}function w0(n,...e){if(Nl.logLevel<=Xe.WARN){const t=e.map(kw);Nl.warn(`Firestore (${Gu}): ${n}`,...t)}}function kw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function ke(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,wN(n,i,t)}function wN(n,e,t){let i=`FIRESTORE (${Gu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ci(i),new Error(i)}function Oe(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||wN(e,r,i)}function It(n,e){return n}const he={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends xs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class yl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class EN{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class c7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Tn.UNAUTHENTICATED)))}shutdown(){}}class u7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class h7{constructor(e){this.t=e,this.currentUser=Tn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Oe(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new yl;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new yl,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},l=u=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new yl)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Oe(typeof i.accessToken=="string",31837,{l:i}),new EN(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Oe(e===null||typeof e=="string",2055,{h:e}),new Tn(e)}}class d7{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Tn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class f7{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new d7(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Tn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class V2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class g7{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Oe(this.o===void 0,3512);const i=s=>{s.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ye("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new V2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Oe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new V2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function p7(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class TN{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=p7(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function qe(n,e){return n<e?-1:n>e?1:0}function bv(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return px(r)===px(s)?qe(r,s):px(r)?1:-1}return qe(n.length,e.length)}const m7=55296,y7=57343;function px(n){const e=n.charCodeAt(0);return e>=m7&&e<=y7}function Tu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function SN(n){return n+"\0"}const z2="__name__";class is{constructor(e,t,i){t===void 0?t=0:t>e.length&&ke(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&ke(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return is.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof is?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=is.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return qe(e.length,t.length)}static compareSegments(e,t){const i=is.isNumericId(e),r=is.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?is.extractNumericId(e).compare(is.extractNumericId(t)):bv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pw.fromString(e.substring(4,e.length-2))}}class Rt extends is{construct(e,t,i){return new Rt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ce(he.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Rt(t)}static emptyPath(){return new Rt([])}}const _7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bt extends is{construct(e,t,i){return new Bt(e,t,i)}static isValidIdentifier(e){return _7.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===z2}static keyField(){return new Bt([z2])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Ce(he.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Ce(he.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ce(he.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new Ce(he.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bt(t)}static emptyPath(){return new Bt([])}}class Ie{constructor(e){this.path=e}static fromPath(e){return new Ie(Rt.fromString(e))}static fromName(e){return new Ie(Rt.fromString(e).popFirst(5))}static empty(){return new Ie(Rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Rt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ie(new Rt(e.slice()))}}function x7(n,e,t,i){if(e===!0&&i===!0)throw new Ce(he.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function v7(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function w7(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ke(12329,{type:typeof n})}function IN(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ce(he.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=w7(n);throw new Ce(he.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Xt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Nf(n,e){if(!v7(n))throw new Ce(he.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Ce(he.INVALID_ARGUMENT,t);return!0}const U2=-62135596800,B2=1e6;class Nt{static now(){return Nt.fromMillis(Date.now())}static fromDate(e){return Nt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*B2);return new Nt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ce(he.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ce(he.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<U2)throw new Ce(he.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(he.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/B2}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Nt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Nf(e,Nt._jsonSchema))return new Nt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-U2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Nt._jsonSchemaVersion="firestore/timestamp/1.0",Nt._jsonSchema={type:Xt("string",Nt._jsonSchemaVersion),seconds:Xt("number"),nanoseconds:Xt("number")};class et{static fromTimestamp(e){return new et(e)}static min(){return new et(new Nt(0,0))}static max(){return new et(new Nt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Kd=-1;class _m{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Cv(n){return n.fields.find((e=>e.kind===2))}function Qa(n){return n.fields.filter((e=>e.kind!==2))}_m.UNKNOWN_ID=-1;class Pp{constructor(e,t){this.fieldPath=e,this.kind=t}}class qd{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new qd(0,Di.min())}}function E7(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=et.fromTimestamp(i===1e9?new Nt(t+1,0):new Nt(t,i));return new Di(r,Ie.empty(),e)}function bN(n){return new Di(n.readTime,n.key,Kd)}class Di{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Di(et.min(),Ie.empty(),Kd)}static max(){return new Di(et.max(),Ie.empty(),Kd)}}function Nw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ie.comparator(n.documentKey,e.documentKey),t!==0?t:qe(n.largestBatchId,e.largestBatchId))}const CN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class RN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function E0(n){if(n.code!==he.FAILED_PRECONDITION||n.message!==CN)throw n;ye("LocalStore","Unexpectedly lost primary lease")}class te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new te(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof te?t:te.resolve(t)}catch(t){return te.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):te.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):te.reject(t)}static resolve(e){return new te(((t,i)=>{t(e)}))}static reject(e){return new te(((t,i)=>{i(e)}))}static waitFor(e){return new te(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=te.resolve(!1);for(const i of e)t=t.next((r=>r?te.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new te(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new te(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const Ii="SimpleDb";class T0{static open(e,t,i,r){try{return new T0(t,e.transaction(r,i))}catch(s){throw new pd(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new yl,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new pd(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=Dw(i.target.error);this.S.reject(new pd(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ye(Ii,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new S7(t)}}class ia{static delete(e){return ye(Ii,"Removing database:",e),tl(Ik().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Mk())return!1;if(ia.F())return!0;const e=tn(),t=ia.M(e),i=0<t&&t<10,r=AN(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,ia.M(tn())===12.2&&Ci("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ye(Ii,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new pd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Ce(he.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Ce(he.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new pd(e,o))},r.onupgradeneeded=s=>{ye(Ii,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{ye(Ii,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=T0.open(this.db,e,s?"readonly":"readwrite",i),u=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),te.reject(h)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,h=u.name!=="FirebaseError"&&o<3;if(ye(Ii,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function AN(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class T7{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return tl(this.U.delete())}}class pd extends Ce{constructor(e,t){super(he.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Wl(n){return n.name==="IndexedDbTransactionError"}class S7{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ye(Ii,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ye(Ii,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),tl(i)}add(e){return ye(Ii,"ADD",this.store.name,e,e),tl(this.store.add(e))}get(e){return tl(this.store.get(e)).next((t=>(t===void 0&&(t=null),ye(Ii,"GET",this.store.name,e,t),t)))}delete(e){return ye(Ii,"DELETE",this.store.name,e),tl(this.store.delete(e))}count(){return ye(Ii,"COUNT",this.store.name),tl(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new te(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new te(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){ye(Ii,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new te(((i,r)=>{t.onerror=s=>{const o=Dw(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new te(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new T7(l),h=t(l.primaryKey,l.value,u);if(h instanceof te){const f=h.catch((m=>(u.done(),te.reject(m))));i.push(f)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}})).next((()=>te.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function tl(n){return new te(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=Dw(i.target.error);t(r)}}))}let W2=!1;function Dw(n){const e=ia.M(tn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return W2||(W2=!0,setTimeout((()=>{throw i}),0)),i}}return n}const md="IndexBackfiller";class I7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ye(md,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ye(md,`Documents written: ${t}`)}catch(t){Wl(t)?ye(md,"Ignoring IndexedDB error during index backfill: ",t):await E0(t)}await this.re(6e4)}))}}class b7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return te.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return ye(md,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(ye(md,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=bN(s);Nw(o,i)>0&&(i=o)})),new Di(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Sr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Sr.ce=-1;const _l=-1;function S0(n){return n==null}function xm(n){return n===0&&1/n==-1/0}const vm="";function Xn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=G2(e)),e=C7(n.get(t),e);return G2(e)}function C7(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case vm:t+="";break;default:t+=s}}return t}function G2(n){return n+vm+""}function as(n){const e=n.length;if(Oe(e>=2,64408,{path:n}),e===2)return Oe(n.charAt(0)===vm&&n.charAt(1)==="",56145,{path:n}),Rt.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(vm,s);switch((o<0||o>t)&&ke(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:ke(61167,{path:n})}s=o+2}return new Rt(i)}const Ja="remoteDocuments",Df="owner",Dc="owner",Xd="mutationQueues",R7="userId",_r="mutations",$2="batchId",hl="userMutationsIndex",H2=["userId","batchId"];function kp(n,e){return[n,Xn(e)]}function PN(n,e,t){return[n,Xn(e),t]}const A7={},Su="documentMutations",wm="remoteDocumentsV14",P7=["prefixPath","collectionGroup","readTime","documentId"],Np="documentKeyIndex",k7=["prefixPath","collectionGroup","documentId"],kN="collectionGroupIndex",N7=["collectionGroup","readTime","prefixPath","documentId"],Yd="remoteDocumentGlobal",Rv="remoteDocumentGlobalKey",Iu="targets",NN="queryTargetsIndex",D7=["canonicalId","targetId"],bu="targetDocuments",M7=["targetId","path"],Mw="documentTargetsIndex",L7=["path","targetId"],Em="targetGlobalKey",xl="targetGlobal",Zd="collectionParents",O7=["collectionId","parent"],Cu="clientMetadata",j7="clientId",I0="bundles",F7="bundleId",b0="namedQueries",V7="name",Lw="indexConfiguration",z7="indexId",Av="collectionGroupIndex",U7="collectionGroup",yd="indexState",B7=["indexId","uid"],DN="sequenceNumberIndex",W7=["uid","sequenceNumber"],_d="indexEntries",G7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],MN="documentKeyIndex",$7=["indexId","uid","orderedDocumentKey"],C0="documentOverlays",H7=["userId","collectionPath","documentId"],Pv="collectionPathOverlayIndex",K7=["userId","collectionPath","largestBatchId"],LN="collectionGroupOverlayIndex",q7=["userId","collectionGroup","largestBatchId"],Ow="globals",X7="name",ON=[Xd,_r,Su,Ja,Iu,Df,xl,bu,Cu,Yd,Zd,I0,b0],Y7=[...ON,C0],jN=[Xd,_r,Su,wm,Iu,Df,xl,bu,Cu,Yd,Zd,I0,b0,C0],FN=jN,jw=[...FN,Lw,yd,_d],Z7=jw,VN=[...jw,Ow],Q7=VN;class kv extends RN{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function nn(n,e){const t=It(n);return ia.O(t.le,e)}function K2(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Fw(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function J7(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class gi{constructor(e,t){this.comparator=e,this.root=t||Sn.EMPTY}insert(e,t){return new gi(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Sn.BLACK,null,null))}remove(e){return new gi(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hp(this.root,e,this.comparator,!1)}getReverseIterator(){return new hp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hp(this.root,e,this.comparator,!0)}}class hp{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Sn{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Sn.RED,this.left=r??Sn.EMPTY,this.right=s??Sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new Sn(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Sn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ke(27949);return e+(this.isRed()?0:1)}}Sn.EMPTY=null,Sn.RED=!0,Sn.BLACK=!1;Sn.EMPTY=new class{constructor(){this.size=0}get key(){throw ke(57766)}get value(){throw ke(16141)}get color(){throw ke(16727)}get left(){throw ke(29726)}get right(){throw ke(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new Sn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class yt{constructor(e){this.comparator=e,this.data=new gi(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new q2(this.data.getIterator())}getIteratorFrom(e){return new q2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof yt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new yt(this.comparator);return t.data=e,t}}class q2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Mc(n){return n.hasNext()?n.getNext():void 0}class Hs{constructor(e){this.fields=e,e.sort(Bt.comparator)}static empty(){return new Hs([])}unionWith(e){let t=new yt(Bt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Hs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Tu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class eW extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class pi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new eW("Invalid base64 string: "+s):s}})(e);return new pi(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new pi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pi.EMPTY_BYTE_STRING=new pi("");const tW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ha(n){if(Oe(!!n,39018),typeof n=="string"){let e=0;const t=tW.exec(n);if(Oe(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:qt(n.seconds),nanos:qt(n.nanos)}}function qt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ru(n){return typeof n=="string"?pi.fromBase64String(n):pi.fromUint8Array(n)}const zN="server_timestamp",UN="__type__",BN="__previous_value__",WN="__local_write_time__";function Vw(n){return(n?.mapValue?.fields||{})[UN]?.stringValue===zN}function GN(n){const e=n.mapValue.fields[BN];return Vw(e)?GN(e):e}function Tm(n){const e=ha(n.mapValue.fields[WN].timestampValue);return new Nt(e.seconds,e.nanos)}class nW{constructor(e,t,i,r,s,o,l,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const Sm="(default)";class Au{constructor(e,t){this.projectId=e,this.database=t||Sm}static empty(){return new Au("","")}get isDefaultDatabase(){return this.database===Sm}isEqual(e){return e instanceof Au&&e.projectId===this.projectId&&e.database===this.database}}const $N="__type__",HN="__max__",Qo={mapValue:{fields:{__type__:{stringValue:HN}}}},KN="__vector__",Im="value",Dp={nullValue:"NULL_VALUE"};function Pu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Vw(n)?4:qN(n)?9007199254740991:R0(n)?10:11:ke(28295,{value:n})}function ps(n,e){if(n===e)return!0;const t=Pu(n);if(t!==Pu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Tm(n).isEqual(Tm(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ha(r.timestampValue),l=ha(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return Ru(r.bytesValue).isEqual(Ru(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return qt(r.geoPointValue.latitude)===qt(s.geoPointValue.latitude)&&qt(r.geoPointValue.longitude)===qt(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return qt(r.integerValue)===qt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=qt(r.doubleValue),l=qt(s.doubleValue);return o===l?xm(o)===xm(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return Tu(n.arrayValue.values||[],e.arrayValue.values||[],ps);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(K2(o)!==K2(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!ps(o[u],l[u])))return!1;return!0})(n,e);default:return ke(52216,{left:n})}}function Qd(n,e){return(n.values||[]).find((t=>ps(t,e)))!==void 0}function da(n,e){if(n===e)return 0;const t=Pu(n),i=Pu(e);if(t!==i)return qe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return qe(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=qt(s.integerValue||s.doubleValue),u=qt(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return X2(n.timestampValue,e.timestampValue);case 4:return X2(Tm(n),Tm(e));case 5:return bv(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=Ru(s),u=Ru(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=qe(l[h],u[h]);if(f!==0)return f}return qe(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=qe(qt(s.latitude),qt(o.latitude));return l!==0?l:qe(qt(s.longitude),qt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Y2(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[Im]?.arrayValue,f=u[Im]?.arrayValue,m=qe(h?.values?.length||0,f?.values?.length||0);return m!==0?m:Y2(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Qo.mapValue&&o===Qo.mapValue)return 0;if(s===Qo.mapValue)return 1;if(o===Qo.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const _=bv(u[m],f[m]);if(_!==0)return _;const v=da(l[u[m]],h[f[m]]);if(v!==0)return v}return qe(u.length,f.length)})(n.mapValue,e.mapValue);default:throw ke(23264,{he:t})}}function X2(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return qe(n,e);const t=ha(n),i=ha(e),r=qe(t.seconds,i.seconds);return r!==0?r:qe(t.nanos,i.nanos)}function Y2(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=da(t[r],i[r]);if(s)return s}return qe(t.length,i.length)}function ku(n){return Nv(n)}function Nv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ha(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ru(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ie.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=Nv(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${Nv(t.fields[o])}`;return r+"}"})(n.mapValue):ke(61005,{value:n})}function zw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Dv(n){return!!n&&"integerValue"in n}function Jd(n){return!!n&&"arrayValue"in n}function Z2(n){return!!n&&"nullValue"in n}function Q2(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function mx(n){return!!n&&"mapValue"in n}function R0(n){return(n?.mapValue?.fields||{})[$N]?.stringValue===KN}function xd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Fw(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=xd(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=xd(n.arrayValue.values[t]);return e}return{...n}}function qN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===HN}const XN={mapValue:{fields:{[$N]:{stringValue:KN},[Im]:{arrayValue:{}}}}};function iW(n){return"nullValue"in n?Dp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?zw(Au.empty(),Ie.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?R0(n)?XN:{mapValue:{}}:ke(35942,{value:n})}function rW(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?zw(Au.empty(),Ie.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?XN:"mapValue"in n?R0(n)?{mapValue:{}}:Qo:ke(61959,{value:n})}function J2(n,e){const t=da(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function eC(n,e){const t=da(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Er{constructor(e){this.value=e}static empty(){return new Er({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!mx(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=xd(t)}setAll(e){let t=Bt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=xd(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());mx(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ps(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];mx(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Fw(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new Er(xd(this.value))}}class bn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new bn(e,0,et.min(),et.min(),et.min(),Er.empty(),0)}static newFoundDocument(e,t,i,r){return new bn(e,1,t,et.min(),i,r,0)}static newNoDocument(e,t){return new bn(e,2,t,et.min(),et.min(),Er.empty(),0)}static newUnknownDocument(e,t){return new bn(e,3,t,et.min(),et.min(),Er.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(et.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Er.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Er.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Nu{constructor(e,t){this.position=e,this.inclusive=t}}function tC(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Ie.comparator(Ie.fromName(o.referenceValue),t.key):i=da(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function nC(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ps(n.position[t],e.position[t]))return!1;return!0}class bm{constructor(e,t="asc"){this.field=e,this.dir=t}}function sW(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class YN{}class Qe extends YN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new oW(e,t,i):t==="array-contains"?new cW(e,i):t==="in"?new nD(e,i):t==="not-in"?new uW(e,i):t==="array-contains-any"?new hW(e,i):new Qe(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new aW(e,i):new lW(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(da(t,this.value)):t!==null&&Pu(this.value)===Pu(t)&&this.matchesComparison(da(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pt extends YN{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new pt(e,t)}matches(e){return Du(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Du(n){return n.op==="and"}function Mv(n){return n.op==="or"}function Uw(n){return ZN(n)&&Du(n)}function ZN(n){for(const e of n.filters)if(e instanceof pt)return!1;return!0}function Lv(n){if(n instanceof Qe)return n.field.canonicalString()+n.op.toString()+ku(n.value);if(Uw(n))return n.filters.map((e=>Lv(e))).join(",");{const e=n.filters.map((t=>Lv(t))).join(",");return`${n.op}(${e})`}}function QN(n,e){return n instanceof Qe?(function(i,r){return r instanceof Qe&&i.op===r.op&&i.field.isEqual(r.field)&&ps(i.value,r.value)})(n,e):n instanceof pt?(function(i,r){return r instanceof pt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&QN(o,r.filters[l])),!0):!1})(n,e):void ke(19439)}function JN(n,e){const t=n.filters.concat(e);return pt.create(t,n.op)}function eD(n){return n instanceof Qe?(function(t){return`${t.field.canonicalString()} ${t.op} ${ku(t.value)}`})(n):n instanceof pt?(function(t){return t.op.toString()+" {"+t.getFilters().map(eD).join(" ,")+"}"})(n):"Filter"}class oW extends Qe{constructor(e,t,i){super(e,t,i),this.key=Ie.fromName(i.referenceValue)}matches(e){const t=Ie.comparator(e.key,this.key);return this.matchesComparison(t)}}class aW extends Qe{constructor(e,t){super(e,"in",t),this.keys=tD("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class lW extends Qe{constructor(e,t){super(e,"not-in",t),this.keys=tD("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function tD(n,e){return(e.arrayValue?.values||[]).map((t=>Ie.fromName(t.referenceValue)))}class cW extends Qe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Jd(t)&&Qd(t.arrayValue,this.value)}}class nD extends Qe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Qd(this.value.arrayValue,t)}}class uW extends Qe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Qd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Qd(this.value.arrayValue,t)}}class hW extends Qe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Jd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Qd(this.value.arrayValue,i)))}}class dW{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function Ov(n,e=null,t=[],i=[],r=null,s=null,o=null){return new dW(n,e,t,i,r,s,o)}function Dl(n){const e=It(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Lv(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),S0(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>ku(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>ku(i))).join(",")),e.Te=t}return e.Te}function Mf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!sW(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!QN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!nC(n.startAt,e.startAt)&&nC(n.endAt,e.endAt)}function fW(n){return Ie.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Cm(n,e){return n.filters.filter((t=>t instanceof Qe&&t.field.isEqual(e)))}function iC(n,e,t){let i=Dp,r=!0;for(const s of Cm(n,e)){let o=Dp,l=!0;switch(s.op){case"<":case"<=":o=iW(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=Dp}J2({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];J2({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function rC(n,e,t){let i=Qo,r=!0;for(const s of Cm(n,e)){let o=Qo,l=!0;switch(s.op){case">=":case">":o=rW(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Qo}eC({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];eC({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class A0{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function gW(n,e,t,i,r,s,o,l){return new A0(n,e,t,i,r,s,o,l)}function iD(n){return new A0(n)}function sC(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function pW(n){return n.collectionGroup!==null}function vd(n){const e=It(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new yt(Bt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new bm(s,i))})),t.has(Bt.keyField().canonicalString())||e.Ie.push(new bm(Bt.keyField(),i))}return e.Ie}function Qs(n){const e=It(n);return e.Ee||(e.Ee=mW(e,vd(n))),e.Ee}function mW(n,e){if(n.limitType==="F")return Ov(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new bm(r.field,s)}));const t=n.endAt?new Nu(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Nu(n.startAt.position,n.startAt.inclusive):null;return Ov(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function jv(n,e,t){return new A0(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function rD(n,e){return Mf(Qs(n),Qs(e))&&n.limitType===e.limitType}function sD(n){return`${Dl(Qs(n))}|lt:${n.limitType}`}function Bh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>eD(r))).join(", ")}]`),S0(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>ku(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>ku(r))).join(",")),`Target(${i})`})(Qs(n))}; limitType=${n.limitType})`}function P0(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ie.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of vd(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,u){const h=tC(o,l,u);return o.inclusive?h<=0:h<0})(i.startAt,vd(i),r)||i.endAt&&!(function(o,l,u){const h=tC(o,l,u);return o.inclusive?h>=0:h>0})(i.endAt,vd(i),r))})(n,e)}function yW(n){return(e,t)=>{let i=!1;for(const r of vd(n)){const s=_W(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function _W(n,e,t){const i=n.field.isKeyField()?Ie.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?da(u,h):ke(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return ke(19790,{direction:n.dir})}}class ma{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Fw(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return J7(this.inner)}size(){return this.innerSize}}const xW=new gi(Ie.comparator);function dl(){return xW}const oD=new gi(Ie.comparator);function dp(...n){let e=oD;for(const t of n)e=e.insert(t.key,t);return e}function vW(n){let e=oD;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function ls(){return wd()}function aD(){return wd()}function wd(){return new ma((n=>n.toString()),((n,e)=>n.isEqual(e)))}const wW=new gi(Ie.comparator),EW=new yt(Ie.comparator);function Cn(...n){let e=EW;for(const t of n)e=e.add(t);return e}const TW=new yt(qe);function SW(){return TW}function IW(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xm(e)?"-0":e}}function bW(n){return{integerValue:""+n}}class k0{constructor(){this._=void 0}}function CW(n,e,t){return n instanceof ef?(function(r,s){const o={fields:{[UN]:{stringValue:zN},[WN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Vw(s)&&(s=GN(s)),s&&(o.fields[BN]=s),{mapValue:o}})(t,e):n instanceof Mu?lD(n,e):n instanceof Lu?cD(n,e):(function(r,s){const o=AW(r,s),l=oC(o)+oC(r.Ae);return Dv(o)&&Dv(r.Ae)?bW(l):IW(r.serializer,l)})(n,e)}function RW(n,e,t){return n instanceof Mu?lD(n,e):n instanceof Lu?cD(n,e):t}function AW(n,e){return n instanceof tf?(function(i){return Dv(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class ef extends k0{}class Mu extends k0{constructor(e){super(),this.elements=e}}function lD(n,e){const t=uD(e);for(const i of n.elements)t.some((r=>ps(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Lu extends k0{constructor(e){super(),this.elements=e}}function cD(n,e){let t=uD(e);for(const i of n.elements)t=t.filter((r=>!ps(r,i)));return{arrayValue:{values:t}}}class tf extends k0{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function oC(n){return qt(n.integerValue||n.doubleValue)}function uD(n){return Jd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class PW{constructor(e,t){this.field=e,this.transform=t}}function kW(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Mu&&r instanceof Mu||i instanceof Lu&&r instanceof Lu?Tu(i.elements,r.elements,ps):i instanceof tf&&r instanceof tf?ps(i.Ae,r.Ae):i instanceof ef&&r instanceof ef})(n.transform,e.transform)}class NW{constructor(e,t){this.version=e,this.transformResults=t}}class Ir{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ir}static exists(e){return new Ir(void 0,e)}static updateTime(e){return new Ir(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Mp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class N0{}function hD(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Bw(n.key,Ir.none()):new Lf(n.key,n.data,Ir.none());{const t=n.data,i=Er.empty();let r=new yt(Bt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new $u(n.key,i,new Hs(r.toArray()),Ir.none())}}function DW(n,e,t){n instanceof Lf?(function(r,s,o){const l=r.value.clone(),u=lC(r.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof $u?(function(r,s,o){if(!Mp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=lC(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(dD(r)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Ed(n,e,t,i){return n instanceof Lf?(function(s,o,l,u){if(!Mp(s.precondition,o))return l;const h=s.value.clone(),f=cC(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof $u?(function(s,o,l,u){if(!Mp(s.precondition,o))return l;const h=cC(s.fieldTransforms,u,o),f=o.data;return f.setAll(dD(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((m=>m.field)))})(n,e,t,i):(function(s,o,l){return Mp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function aC(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Tu(i,r,((s,o)=>kW(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Lf extends N0{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class $u extends N0{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function dD(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function lC(n,e,t){const i=new Map;Oe(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,RW(o,l,t[r]))}return i}function cC(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,CW(s,o,e))}return i}class Bw extends N0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class fD extends N0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ww{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&DW(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Ed(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Ed(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=aD();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const u=hD(o,l);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(et.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Cn())}isEqual(e){return this.batchId===e.batchId&&Tu(this.mutations,e.mutations,((t,i)=>aC(t,i)))&&Tu(this.baseMutations,e.baseMutations,((t,i)=>aC(t,i)))}}class Gw{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Oe(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return wW})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new Gw(e,t,i,r)}}class $w{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var Kt,Je;function MW(n){switch(n){case he.OK:return ke(64938);case he.CANCELLED:case he.UNKNOWN:case he.DEADLINE_EXCEEDED:case he.RESOURCE_EXHAUSTED:case he.INTERNAL:case he.UNAVAILABLE:case he.UNAUTHENTICATED:return!1;case he.INVALID_ARGUMENT:case he.NOT_FOUND:case he.ALREADY_EXISTS:case he.PERMISSION_DENIED:case he.FAILED_PRECONDITION:case he.ABORTED:case he.OUT_OF_RANGE:case he.UNIMPLEMENTED:case he.DATA_LOSS:return!0;default:return ke(15467,{code:n})}}function LW(n){if(n===void 0)return Ci("GRPC error has no .code"),he.UNKNOWN;switch(n){case Kt.OK:return he.OK;case Kt.CANCELLED:return he.CANCELLED;case Kt.UNKNOWN:return he.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return he.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return he.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return he.INTERNAL;case Kt.UNAVAILABLE:return he.UNAVAILABLE;case Kt.UNAUTHENTICATED:return he.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return he.INVALID_ARGUMENT;case Kt.NOT_FOUND:return he.NOT_FOUND;case Kt.ALREADY_EXISTS:return he.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return he.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return he.FAILED_PRECONDITION;case Kt.ABORTED:return he.ABORTED;case Kt.OUT_OF_RANGE:return he.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return he.UNIMPLEMENTED;case Kt.DATA_LOSS:return he.DATA_LOSS;default:return ke(39323,{code:n})}}(Je=Kt||(Kt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";new Pw([4294967295,4294967295],0);const OW={asc:"ASCENDING",desc:"DESCENDING"},jW={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},FW={and:"AND",or:"OR"};class VW{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function zW(n,e){return n.useProto3Json||S0(e)?e:{value:e}}function Fv(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function UW(n,e){return Fv(n,e.toTimestamp())}function Ar(n){return Oe(!!n,49232),et.fromTimestamp((function(t){const i=ha(t);return new Nt(i.seconds,i.nanos)})(n))}function gD(n,e){return Vv(n,e).canonicalString()}function Vv(n,e){const t=(function(r){return new Rt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function pD(n){const e=Rt.fromString(n);return Oe(ZW(e),10190,{key:e.toString()}),e}function Rm(n,e){return gD(n.databaseId,e.path)}function Lp(n,e){const t=pD(e);if(t.get(1)!==n.databaseId.projectId)throw new Ce(he.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ce(he.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ie(_D(t))}function mD(n,e){return gD(n.databaseId,e)}function yD(n){const e=pD(n);return e.length===4?Rt.emptyPath():_D(e)}function BW(n){return new Rt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function _D(n){return Oe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function uC(n,e,t){return{name:Rm(n,e),fields:t.value.mapValue.fields}}function WW(n,e,t){const i=Lp(n,e.name),r=Ar(e.updateTime),s=e.createTime?Ar(e.createTime):et.min(),o=new Er({mapValue:{fields:e.fields}}),l=bn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function Am(n,e){let t;if(e instanceof Lf)t={update:uC(n,e.key,e.value)};else if(e instanceof Bw)t={delete:Rm(n,e.key)};else if(e instanceof $u)t={update:uC(n,e.key,e.data),updateMask:YW(e.fieldMask)};else{if(!(e instanceof fD))return ke(16599,{Vt:e.type});t={verify:Rm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof ef)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Mu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Lu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof tf)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw ke(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:UW(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ke(27497)})(n,e.precondition)),t}function zv(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?Ir.updateTime(Ar(s.updateTime)):s.exists!==void 0?Ir.exists(s.exists):Ir.none()})(e.currentDocument):Ir.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let u=null;if("setToServerValue"in l)Oe(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new ef;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new Mu(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Lu(f)}else"increment"in l?u=new tf(o,l.increment):ke(16584,{proto:l});const h=Bt.fromServerFormat(l.fieldPath);return new PW(h,u)})(n,r))):[];if(e.update){e.update.name;const r=Lp(n,e.update.name),s=new Er({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new Hs(h.map((f=>Bt.fromServerFormat(f))))})(e.updateMask);return new $u(r,s,o,t,i)}return new Lf(r,s,t,i)}if(e.delete){const r=Lp(n,e.delete);return new Bw(r,t)}if(e.verify){const r=Lp(n,e.verify);return new fD(r,t)}return ke(1463,{proto:e})}function GW(n,e){return n&&n.length>0?(Oe(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Ar(r.updateTime):Ar(s);return o.isEqual(et.min())&&(o=Ar(s)),new NW(o,r.transformResults||[])})(t,e)))):[]}function $W(n,e){return{documents:[mD(n,e.path)]}}function HW(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=mD(n,r);const s=(function(h){if(h.length!==0)return wD(pt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(_){return{field:Gc(_.field),direction:KW(_.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=zW(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function xD(n){let e=yD(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Oe(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(m){const _=vD(m);return _ instanceof pt&&Uw(_)?_.getFilters():[_]})(t.where));let o=[];t.orderBy&&(o=(function(m){return m.map((_=>(function(S){return new bm($c(S.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(_)))})(t.orderBy));let l=null;t.limit&&(l=(function(m){let _;return _=typeof m=="object"?m.value:m,S0(_)?null:_})(t.limit));let u=null;t.startAt&&(u=(function(m){const _=!!m.before,v=m.values||[];return new Nu(v,_)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const _=!m.before,v=m.values||[];return new Nu(v,_)})(t.endAt)),gW(e,r,o,s,l,"F",u,h)}function vD(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=$c(t.unaryFilter.field);return Qe.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=$c(t.unaryFilter.field);return Qe.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=$c(t.unaryFilter.field);return Qe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=$c(t.unaryFilter.field);return Qe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ke(61313);default:return ke(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Qe.create($c(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ke(58110);default:return ke(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return pt.create(t.compositeFilter.filters.map((i=>vD(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ke(1026)}})(t.compositeFilter.op))})(n):ke(30097,{filter:n})}function KW(n){return OW[n]}function qW(n){return jW[n]}function XW(n){return FW[n]}function Gc(n){return{fieldPath:n.canonicalString()}}function $c(n){return Bt.fromServerFormat(n.fieldPath)}function wD(n){return n instanceof Qe?(function(t){if(t.op==="=="){if(Q2(t.value))return{unaryFilter:{field:Gc(t.field),op:"IS_NAN"}};if(Z2(t.value))return{unaryFilter:{field:Gc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Q2(t.value))return{unaryFilter:{field:Gc(t.field),op:"IS_NOT_NAN"}};if(Z2(t.value))return{unaryFilter:{field:Gc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Gc(t.field),op:qW(t.op),value:t.value}}})(n):n instanceof pt?(function(t){const i=t.getFilters().map((r=>wD(r)));return i.length===1?i[0]:{compositeFilter:{op:XW(t.op),filters:i}}})(n):ke(54877,{filter:n})}function YW(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function ZW(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class tu{constructor(e,t,i,r,s=et.min(),o=et.min(),l=pi.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new tu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new tu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new tu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new tu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ED{constructor(e){this.yt=e}}function QW(n,e){let t;if(e.document)t=WW(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Ie.fromSegments(e.noDocument.path),r=Ll(e.noDocument.readTime);t=bn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ke(56709);{const i=Ie.fromSegments(e.unknownDocument.path),r=Ll(e.unknownDocument.version);t=bn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new Nt(r[0],r[1]);return et.fromTimestamp(s)})(e.readTime)),t}function hC(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Pm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:Rm(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Fv(s,o.version.toTimestamp()),createTime:Fv(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Ml(e.version)};else{if(!e.isUnknownDocument())return ke(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Ml(e.version)}}return i}function Pm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ml(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ll(n){const e=new Nt(n.seconds,n.nanoseconds);return et.fromTimestamp(e)}function nl(n,e){const t=(e.baseMutations||[]).map((s=>zv(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>zv(n.yt,s))),r=Nt.fromMillis(e.localWriteTimeMs);return new Ww(e.batchId,r,t,i)}function od(n){const e=Ll(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ll(n.lastLimboFreeSnapshotVersion):et.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return Oe(o===1,1966,{count:o}),Qs(iD(yD(s.documents[0])))})(n.query):(function(s){return Qs(xD(s))})(n.query),new tu(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,pi.fromBase64String(n.resumeToken))}function TD(n,e){const t=Ml(e.snapshotVersion),i=Ml(e.lastLimboFreeSnapshotVersion);let r;r=fW(e.target)?$W(n.yt,e.target):HW(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Dl(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function SD(n){const e=xD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?jv(e,e.limit,"L"):e}function yx(n,e){return new $w(e.largestBatchId,zv(n.yt,e.overlayMutation))}function dC(n,e){const t=e.path.lastSegment();return[n,Xn(e.path.popLast()),t]}function fC(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ml(i.readTime),documentKey:Xn(i.documentKey.path),largestBatchId:i.largestBatchId}}class JW{getBundleMetadata(e,t){return gC(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Ll(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return gC(e).put((function(r){return{bundleId:r.id,createTime:Ml(Ar(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return pC(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:SD(s.bundledQuery),readTime:Ll(s.readTime)}})(i)}))}saveNamedQuery(e,t){return pC(e).put((function(r){return{name:r.name,readTime:Ml(Ar(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function gC(n){return nn(n,I0)}function pC(n){return nn(n,b0)}class D0{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new D0(e,i)}getOverlay(e,t){return Wh(e).get(dC(this.userId,t)).next((i=>i?yx(this.serializer,i):null))}getOverlays(e,t){const i=ls();return te.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new $w(t,o);r.push(this.St(e,l))})),te.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Xn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Wh(e).Z(Pv,l))})),te.waitFor(s)}getOverlaysForCollection(e,t,i){const r=ls(),s=Xn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Wh(e).J(Pv,o).next((l=>{for(const u of l){const h=yx(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=ls();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Wh(e).ee({index:LN,range:l},((u,h,f)=>{const m=yx(this.serializer,h);s.size()<r||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Wh(e).put((function(r,s,o){const[l,u,h]=dC(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Am(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Wh(n){return nn(n,C0)}class eG{bt(e){return nn(e,Ow)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?pi.fromUint8Array(i):pi.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class il{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(qt(e.integerValue));else if("doubleValue"in e){const i=qt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),xm(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ha(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ru(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?qN(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):R0(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):ke(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=Im,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(qt(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ie.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}il.Kt=new il;const Lc=255;function tG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function mC(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=tG(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class nG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=mC(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=mC(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Lc),this.sn(255)}_n(){this.an(Lc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Lc?(this.sn(Lc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Lc?(this.an(Lc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class iG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class rG{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Gh{constructor(){this.cn=new nG,this.ln=new iG(this.cn),this.hn=new rG(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class rl{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new rl(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Op(this.En),directionalValue:Op(this.dn),orderedDocumentKey:Op(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Fo(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=yC(n.En,e.En),t!==0?t:(t=yC(n.dn,e.dn),t!==0?t:Ie.comparator(n.In,e.In)))}function yC(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Op(n){return Dk()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function _C(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class xC{constructor(e){this.mn=new yt(((t,i)=>Bt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Oe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Cv(e);if(t!==void 0&&!this.wn(t))return!1;const i=Qa(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=i[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new yt(Bt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Pp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Pp(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Pp(i.field,i.dir==="asc"?0:1)));return new _m(_m.UNKNOWN_ID,this.collectionId,t,qd.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function ID(n){if(Oe(n instanceof Qe||n instanceof pt,20012),n instanceof Qe){if(n instanceof nD){const t=n.value.arrayValue?.values?.map((i=>Qe.create(n.field,"==",i)))||[];return pt.create(t,"or")}return n}const e=n.filters.map((t=>ID(t)));return pt.create(e,n.op)}function sG(n){if(n.getFilters().length===0)return[];const e=Wv(ID(n));return Oe(bD(e),7391),Uv(e)||Bv(e)?[e]:e.getFilters()}function Uv(n){return n instanceof Qe}function Bv(n){return n instanceof pt&&Uw(n)}function bD(n){return Uv(n)||Bv(n)||(function(t){if(t instanceof pt&&Mv(t)){for(const i of t.getFilters())if(!Uv(i)&&!Bv(i))return!1;return!0}return!1})(n)}function Wv(n){if(Oe(n instanceof Qe||n instanceof pt,34018),n instanceof Qe)return n;if(n.filters.length===1)return Wv(n.filters[0]);const e=n.filters.map((i=>Wv(i)));let t=pt.create(e,n.op);return t=km(t),bD(t)?t:(Oe(t instanceof pt,64498),Oe(Du(t),40251),Oe(t.filters.length>1,57927),t.filters.reduce(((i,r)=>Hw(i,r))))}function Hw(n,e){let t;return Oe(n instanceof Qe||n instanceof pt,38388),Oe(e instanceof Qe||e instanceof pt,25473),t=n instanceof Qe?e instanceof Qe?(function(r,s){return pt.create([r,s],"and")})(n,e):vC(n,e):e instanceof Qe?vC(e,n):(function(r,s){if(Oe(r.filters.length>0&&s.filters.length>0,48005),Du(r)&&Du(s))return JN(r,s.getFilters());const o=Mv(r)?r:s,l=Mv(r)?s:r,u=o.filters.map((h=>Hw(h,l)));return pt.create(u,"or")})(n,e),km(t)}function vC(n,e){if(Du(e))return JN(e,n.getFilters());{const t=e.filters.map((i=>Hw(n,i)));return pt.create(t,"or")}}function km(n){if(Oe(n instanceof Qe||n instanceof pt,11850),n instanceof Qe)return n;const e=n.getFilters();if(e.length===1)return km(e[0]);if(ZN(n))return n;const t=e.map((r=>km(r))),i=[];return t.forEach((r=>{r instanceof Qe?i.push(r):r instanceof pt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:pt.create(i,n.op)}class oG{constructor(){this.Cn=new Kw}addToCollectionParentIndex(e,t){return this.Cn.add(t),te.resolve()}getCollectionParents(e,t){return te.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return te.resolve()}deleteFieldIndex(e,t){return te.resolve()}deleteAllFieldIndexes(e){return te.resolve()}createTargetIndexes(e,t){return te.resolve()}getDocumentsMatchingTarget(e,t){return te.resolve(null)}getIndexType(e,t){return te.resolve(0)}getFieldIndexes(e,t){return te.resolve([])}getNextCollectionGroupToUpdate(e){return te.resolve(null)}getMinOffset(e,t){return te.resolve(Di.min())}getMinOffsetFromCollectionGroup(e,t){return te.resolve(Di.min())}updateCollectionGroup(e,t,i){return te.resolve()}updateIndexEntries(e,t){return te.resolve()}}class Kw{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new yt(Rt.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new yt(Rt.comparator)).toArray()}}const wC="IndexedDbIndexManager",fp=new Uint8Array(0);class aG{constructor(e,t){this.databaseId=t,this.vn=new Kw,this.Fn=new ma((i=>Dl(i)),((i,r)=>Mf(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Xn(r)};return EC(e).put(s)}return te.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[SN(t),""],!1,!0);return EC(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(as(o.parent))}return i}))}addFieldIndex(e,t){const i=$h(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=jc(e);return s.next((l=>{o.put(fC(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=$h(e),r=jc(e),s=Oc(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=$h(e),i=Oc(e),r=jc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return te.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new xC(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Oc(e);let r=!0;const s=new Map;return te.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=Cn();const l=[];return te.forEach(s,((u,h)=>{ye(wC,`Using index ${(function(N){return`id=${N.indexId}|cg=${N.collectionGroup}|f=${N.fields.map((L=>`${L.fieldPath}:${L.kind}`)).join(",")}`})(u)} to execute ${Dl(t)}`);const f=(function(N,L){const A=Cv(L);if(A===void 0)return null;for(const z of Cm(N,A.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null})(h,u),m=(function(N,L){const A=new Map;for(const z of Qa(L))for(const P of Cm(N,z.fieldPath))switch(P.op){case"==":case"in":A.set(z.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return A.set(z.fieldPath.canonicalString(),P.value),Array.from(A.values())}return null})(h,u),_=(function(N,L){const A=[];let z=!0;for(const P of Qa(L)){const b=P.kind===0?iC(N,P.fieldPath,N.startAt):rC(N,P.fieldPath,N.startAt);A.push(b.value),z&&(z=b.inclusive)}return new Nu(A,z)})(h,u),v=(function(N,L){const A=[];let z=!0;for(const P of Qa(L)){const b=P.kind===0?rC(N,P.fieldPath,N.endAt):iC(N,P.fieldPath,N.endAt);A.push(b.value),z&&(z=b.inclusive)}return new Nu(A,z)})(h,u),S=this.On(u,h,_),I=this.On(u,h,v),T=this.Nn(u,h,m),R=this.Bn(u.indexId,f,S,_.inclusive,I,v.inclusive,T);return te.forEach(R,(M=>i.Y(M,t.limit).next((N=>{N.forEach((L=>{const A=Ie.fromSegments(L.documentKey);o.has(A)||(o=o.add(A),l.push(A))}))}))))})).next((()=>l))}return te.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=sG(pt.create(e.filters,"and")).map((i=>Ov(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let m=0;m<u;++m){const _=t?this.Ln(t[m/h]):fp,v=this.kn(e,_,i[m%h],r),S=this.qn(e,_,s[m%h],o),I=l.map((T=>this.kn(e,_,T,!0)));f.push(...this.createRange(v,S,I))}return f}kn(e,t,i,r){const s=new rl(e,Ie.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new rl(e,Ie.empty(),t,i);return r?s.An():s}xn(e,t){const i=new xC(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return te.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new yt(Bt.comparator),f=!1;for(const m of u.filters)for(const _ of m.getFlattenedFilters())_.field.isKeyField()||(_.op==="array-contains"||_.op==="array-contains-any"?f=!0:h=h.add(_.field));for(const m of u.orderBy)m.field.isKeyField()||(h=h.add(m.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Gh;for(const r of Qa(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);il.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Gh;return il.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Gh;return il.Kt.Dt(zw(this.databaseId,t),i.Pn((function(s){const o=Qa(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Gh);let s=0;for(const o of Qa(e)){const l=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&Jd(l))r=this.Kn(r,o,l);else{const h=u.Pn(o.kind);il.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const u=new Gh;u.seed(l.un()),il.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof Qe&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=$h(e),r=jc(e);return(t?i.J(Av,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return te.forEach(s,(l=>r.get([l.indexId,this.uid]).next((u=>{o.push((function(f,m){const _=m?new qd(m.sequenceNumber,new Di(Ll(m.readTime),new Ie(as(m.documentKey)),m.largestBatchId)):qd.empty(),v=f.fields.map((([S,I])=>new Pp(Bt.fromServerFormat(S),I)));return new _m(f.indexId,f.collectionGroup,v,_)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:qe(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=$h(e),s=jc(e);return this.Gn(e).next((o=>r.J(Av,IDBKeyRange.bound(t,t)).next((l=>te.forEach(l,(u=>s.put(fC(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return te.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?te.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),te.forEach(l,(u=>this.zn(e,r,u).next((h=>{const f=this.jn(s,u);return h.isEqual(f)?te.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,i,r){return Oc(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Oc(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Oc(e);let s=new yt(Fo);return r.ee({index:MN,range:IDBKeyRange.only([i.indexId,this.uid,Op(this.$n(i,t))])},((o,l)=>{s=s.add(new rl(i.indexId,t,_C(l.arrayValue),_C(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new yt(Fo);const r=this.Qn(t,e);if(r==null)return i;const s=Cv(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Jd(o))for(const l of o.arrayValue.values||[])i=i.add(new rl(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new rl(t.indexId,e.key,fp,r));return i}Jn(e,t,i,r,s){ye(wC,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,f,m,_){const v=u.getIterator(),S=h.getIterator();let I=Mc(v),T=Mc(S);for(;I||T;){let R=!1,M=!1;if(I&&T){const N=f(I,T);N<0?M=!0:N>0&&(R=!0)}else I!=null?M=!0:R=!0;R?(m(T),T=Mc(S)):M?(_(I),I=Mc(v)):(I=Mc(v),T=Mc(S))}})(r,s,Fo,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),te.waitFor(o)}Gn(e){let t=1;return jc(e).ee({index:DN,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>Fo(o,l))).filter(((o,l,u)=>!l||Fo(o,u[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=Fo(o,e),u=Fo(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,fp,Ie.empty()),u=r[o+1].Vn(this.uid,fp,Ie.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return Fo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(TC)}getMinOffset(e,t){return te.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||ke(44426))))).next(TC)}}function EC(n){return nn(n,Zd)}function Oc(n){return nn(n,_d)}function $h(n){return nn(n,Lw)}function jc(n){return nn(n,yd)}function TC(n){Oe(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;Nw(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Di(e.readTime,e.documentKey,t)}const SC={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},CD=41943040;class si{static withCacheSize(e){return new si(e,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function RD(n,e,t){const i=n.store(_r),r=n.store(Su),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.ee({range:o},((f,m,_)=>(l++,_.delete())));s.push(u.next((()=>{Oe(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const m=PN(e,f.key.path,t.batchId);s.push(r.delete(m)),h.push(f.key)}return te.waitFor(s).next((()=>h))}function Nm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ke(14731);e=n.noDocument}return JSON.stringify(e).length}si.DEFAULT_COLLECTION_PERCENTILE=10,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,si.DEFAULT=new si(CD,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),si.DISABLED=new si(-1,0,0);class M0{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){Oe(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new M0(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vo(e).ee({index:hl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Hc(e),o=Vo(e);return o.add({}).next((l=>{Oe(typeof l=="number",49019);const u=new Ww(l,t,i,r),h=(function(v,S,I){const T=I.baseMutations.map((M=>Am(v.yt,M))),R=I.mutations.map((M=>Am(v.yt,M)));return{userId:S,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:T,mutations:R}})(this.serializer,this.userId,u),f=[];let m=new yt(((_,v)=>qe(_.canonicalString(),v.canonicalString())));for(const _ of r){const v=PN(this.userId,_.key.path,l);m=m.add(_.key.path.popLast()),f.push(o.put(h)),f.push(s.put(v,A7))}return m.forEach((_=>{f.push(this.indexManager.addToCollectionParentIndex(e,_))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),te.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return Vo(e).get(t).next((i=>i?(Oe(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),nl(this.serializer,i)):null))}er(e,t){return this.Xn[t]?te.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Vo(e).ee({index:hl,range:r},((o,l,u)=>{l.userId===this.userId&&(Oe(l.batchId>=i,47524,{tr:i}),s=nl(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=_l;return Vo(e).ee({index:hl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,_l],[this.userId,Number.POSITIVE_INFINITY]);return Vo(e).J(hl,t).next((i=>i.map((r=>nl(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=kp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Hc(e).ee({range:r},((o,l,u)=>{const[h,f,m]=o,_=as(f);if(h===this.userId&&t.path.isEqual(_))return Vo(e).get(m).next((v=>{if(!v)throw ke(61480,{nr:o,batchId:m});Oe(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:m}),s.push(nl(this.serializer,v))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(qe);const r=[];return t.forEach((s=>{const o=kp(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=Hc(e).ee({range:l},((h,f,m)=>{const[_,v,S]=h,I=as(v);_===this.userId&&s.path.isEqual(I)?i=i.add(S):m.done()}));r.push(u)})),te.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=kp(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new yt(qe);return Hc(e).ee({range:o},((u,h,f)=>{const[m,_,v]=u,S=as(_);m===this.userId&&i.isPrefixOf(S)?S.length===r&&(l=l.add(v)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(Vo(e).get(s).next((o=>{if(o===null)throw ke(35274,{batchId:s});Oe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(nl(this.serializer,o))})))})),te.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return RD(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),te.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return te.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Hc(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const u=as(s[1]);r.push(u)}else l.done()})).next((()=>{Oe(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return AD(e,this.userId,t)}_r(e){return PD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:_l,lastStreamToken:""}))}}function AD(n,e,t){const i=kp(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Hc(n).ee({range:s,X:!0},((l,u,h)=>{const[f,m,_]=l;f===e&&m===r&&(o=!0),h.done()})).next((()=>o))}function Vo(n){return nn(n,_r)}function Hc(n){return nn(n,Su)}function PD(n){return nn(n,Xd)}class Ol{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ol(0)}static cr(){return new Ol(-1)}}class lG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Ol(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>et.fromTimestamp(new Nt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Fc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Oe(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return Fc(e).ee(((o,l)=>{const u=od(l);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>te.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Fc(e).ee(((i,r)=>{const s=od(r);t(s)}))}lr(e){return IC(e).get(Em).next((t=>(Oe(t!==null,2888),t)))}hr(e,t){return IC(e).put(Em,t)}Pr(e,t){return Fc(e).put(TD(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Dl(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Fc(e).ee({range:r,index:NN},((o,l,u)=>{const h=od(l);Mf(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=qo(e);return t.forEach((o=>{const l=Xn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),te.waitFor(r)}removeMatchingKeys(e,t,i){const r=qo(e);return te.forEach(t,(s=>{const o=Xn(s.path);return te.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=qo(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=qo(e);let s=Cn();return r.ee({range:i,X:!0},((o,l,u)=>{const h=as(o[1]),f=new Ie(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Xn(t.path),r=IDBKeyRange.bound([i],[SN(i)],!1,!0);let s=0;return qo(e).ee({index:Mw,X:!0,range:r},(([o,l],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return Fc(e).get(t).next((i=>i?od(i):null))}}function Fc(n){return nn(n,Iu)}function IC(n){return nn(n,xl)}function qo(n){return nn(n,bu)}const bC="LruGarbageCollector",cG=1048576;function CC([n,e],[t,i]){const r=qe(n,t);return r===0?qe(e,i):r}class uG{constructor(e){this.Ir=e,this.buffer=new yt(CC),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();CC(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class hG{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ye(bC,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Wl(t)?ye(bC,"Ignoring IndexedDB error during garbage collection: ",t):await E0(t)}await this.Vr(3e5)}))}}class dG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return te.resolve(Sr.ce);const i=new uG(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),te.resolve(SC)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),SC):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,o=Date.now(),this.nthSequenceNumber(e,r)))).next((m=>(i=m,l=Date.now(),this.removeTargets(e,i,t)))).next((m=>(s=m,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((m=>(h=Date.now(),Wc()<=Xe.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${m} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),te.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:m}))))}}function fG(n,e){return new dG(n,e)}class gG{constructor(e,t){this.db=e,this.garbageCollector=fG(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return gp(e,i)}removeReference(e,t,i){return gp(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return gp(e,t)}br(e,t){return(function(r,s){let o=!1;return PD(r).te((l=>AD(r,l,s).next((u=>(u&&(o=!0),te.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,et.min()),qo(e).delete((function(m){return[0,Xn(m.path)]})(o)))))}));r.push(u)}})).next((()=>te.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return gp(e,t)}Sr(e,t){const i=qo(e);let r,s=Sr.ce;return i.ee({index:Mw},(([o,l],{path:u,sequenceNumber:h})=>{o===0?(s!==Sr.ce&&t(new Ie(as(r)),s),s=h,r=u):s=Sr.ce})).next((()=>{s!==Sr.ce&&t(new Ie(as(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function gp(n,e){return qo(n).put((function(i,r){return{targetId:0,path:Xn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class kD{constructor(){this.changes=new ma((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,bn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?te.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class pG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return $a(e).put(i)}removeEntry(e,t,i){return $a(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Pm(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=bn.newInvalidDocument(t);return $a(e).ee({index:Np,range:IDBKeyRange.only(Hh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:bn.newInvalidDocument(t)};return $a(e).ee({index:Np,range:IDBKeyRange.only(Hh(t))},((r,s)=>{i={document:this.Cr(t,s),size:Nm(s)}})).next((()=>i))}getEntries(e,t){let i=dl();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=dl(),r=new gi(Ie.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,Nm(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return te.resolve();let r=new yt(PC);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Hh(r.first()),Hh(r.last())),o=r.getIterator();let l=o.getNext();return $a(e).ee({index:Np,range:s},((u,h,f)=>{const m=Ie.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&PC(l,m)<0;)i(l,null),l=o.getNext();l&&l.isEqual(m)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Hh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),Pm(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return $a(e).J(IDBKeyRange.bound(l,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=dl();for(const m of h){const _=this.Cr(Ie.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);_.isFoundDocument()&&(P0(t,_)||r.has(_.key))&&(f=f.insert(_.key,_))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=dl();const o=AC(t,i),l=AC(t,Di.max());return $a(e).ee({index:kN,range:IDBKeyRange.bound(o,l,!0)},((u,h,f)=>{const m=this.Cr(Ie.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(m.key,m),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new mG(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return RC(e).get(Rv).next((t=>(Oe(!!t,20021),t)))}Dr(e,t){return RC(e).put(Rv,t)}Cr(e,t){if(t){const i=QW(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(et.min())))return i}return bn.newInvalidDocument(e)}}function ND(n){return new pG(n)}class mG extends kD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ma((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new yt(((s,o)=>qe(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=hC(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=Nm(u);i+=h-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=l.size,this.trackRemovals){const u=hC(this.Nr.serializer,o.convertToNoDocument(et.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),te.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function RC(n){return nn(n,Yd)}function $a(n){return nn(n,wm)}function Hh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function AC(n,e){const t=e.documentKey.path.toArray();return[n,Pm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function PC(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=qe(t[s],i[s]),r)return r;return r=qe(t.length,i.length),r||(r=qe(t[t.length-2],i[i.length-2]),r||qe(t[t.length-1],i[i.length-1]))}class yG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class DD{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&Ed(i.mutation,r,Hs.empty(),Nt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Cn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Cn()){const r=ls();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=dp();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=ls();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Cn())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=dl();const o=wd(),l=(function(){return wd()})();return t.forEach(((u,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof $u)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),Ed(f.mutation,h,f.mutation.getFieldMask(),Nt.now())):o.set(h.key,Hs.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new yG(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=wd();let r=new gi(((o,l)=>o-l)),s=Cn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=i.get(u)||Hs.empty();f=l.applyToLocalView(h,f),i.set(u,f);const m=(r.get(l.batchId)||Cn()).add(u);r=r.insert(l.batchId,m)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,m=aD();f.forEach((_=>{if(!s.has(_)){const v=hD(t.get(_),i.get(_));v!==null&&m.set(_,v),s=s.add(_)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return te.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):pW(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):te.resolve(ls());let l=Kd,u=s;return o.next((h=>te.forEach(h,((f,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(f)?te.resolve():this.remoteDocumentCache.getEntry(e,f).next((_=>{u=u.insert(f,_)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Cn()))).next((f=>({batchId:l,changes:vW(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ie(t)).next((i=>{let r=dp();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=dp();return this.indexManager.getCollectionParents(e,s).next((l=>te.forEach(l,(u=>{const h=(function(m,_){return new A0(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((m,_)=>{o=o.insert(m,_)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,bn.newInvalidDocument(f)))}));let l=dp();return o.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&Ed(f.mutation,h,Hs.empty(),Nt.now()),P0(t,h)&&(l=l.insert(u,h))})),l}))}}class _G{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return te.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Ar(r.createTime)}})(t)),te.resolve()}getNamedQuery(e,t){return te.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:SD(r.bundledQuery),readTime:Ar(r.readTime)}})(t)),te.resolve()}}class xG{constructor(){this.overlays=new gi(Ie.comparator),this.qr=new Map}getOverlay(e,t){return te.resolve(this.overlays.get(t))}getOverlays(e,t){const i=ls();return te.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),te.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),te.resolve()}getOverlaysForCollection(e,t,i){const r=ls(),s=t.length+1,o=new Ie(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return te.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new gi(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=ls(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=ls(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return te.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new $w(t,i));let s=this.qr.get(t);s===void 0&&(s=Cn(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class vG{constructor(){this.sessionToken=pi.EMPTY_BYTE_STRING}getSessionToken(e){return te.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,te.resolve()}}class qw{constructor(){this.Qr=new yt(un.$r),this.Ur=new yt(un.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new un(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new un(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ie(new Rt([])),i=new un(t,e),r=new un(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ie(new Rt([])),i=new un(t,e),r=new un(t,e+1);let s=Cn();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new un(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class un{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ie.comparator(e.key,t.key)||qe(e.Yr,t.Yr)}static Kr(e,t){return qe(e.Yr,t.Yr)||Ie.comparator(e.key,t.key)}}class wG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new yt(un.$r)}checkEmpty(e){return te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ww(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new un(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return te.resolve(o)}lookupMutationBatch(e,t){return te.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return te.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return te.resolve(this.mutationQueue.length===0?_l:this.tr-1)}getAllMutationBatches(e){return te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new un(t,0),r=new un(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),te.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(qe);return t.forEach((r=>{const s=new un(r,0),o=new un(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),te.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Ie.isDocumentKey(s)||(s=s.child(""));const o=new un(new Ie(s),0);let l=new yt(qe);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(u.Yr)),!0)}),o),te.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Oe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return te.forEach(t.mutations,(r=>{const s=new un(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new un(t,0),r=this.Zr.firstAfterOrEqual(i);return te.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,te.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class EG{constructor(e){this.ri=e,this.docs=(function(){return new gi(Ie.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return te.resolve(i?i.document.mutableCopy():bn.newInvalidDocument(t))}getEntries(e,t){let i=dl();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():bn.newInvalidDocument(r))})),te.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=dl();const o=t.path,l=new Ie(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||Nw(bN(f),i)<=0||(r.has(f.key)||P0(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return te.resolve(s)}getAllFromCollectionGroup(e,t,i,r){ke(9500)}ii(e,t){return te.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new TG(this)}getSize(e){return te.resolve(this.size)}}class TG extends kD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),te.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class SG{constructor(e){this.persistence=e,this.si=new ma((t=>Dl(t)),Mf),this.lastRemoteSnapshotVersion=et.min(),this.highestTargetId=0,this.oi=0,this._i=new qw,this.targetCount=0,this.ai=Ol.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),te.resolve()}getLastRemoteSnapshotVersion(e){return te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return te.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),te.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),te.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ol(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,te.resolve()}updateTargetData(e,t){return this.Pr(t),te.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,te.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),te.waitFor(s).next((()=>r))}getTargetCount(e){return te.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return te.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),te.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),te.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),te.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return te.resolve(i)}containsKey(e,t){return te.resolve(this._i.containsKey(t))}}class MD{constructor(e,t){this.ui={},this.overlays={},this.ci=new Sr(0),this.li=!1,this.li=!0,this.hi=new vG,this.referenceDelegate=e(this),this.Pi=new SG(this),this.indexManager=new oG,this.remoteDocumentCache=(function(r){return new EG(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new ED(t),this.Ii=new _G(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new xG,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new wG(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){ye("MemoryPersistence","Starting transaction:",e);const r=new IG(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return te.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class IG extends RN{constructor(e){super(),this.currentSequenceNumber=e}}class L0{constructor(e){this.persistence=e,this.Ri=new qw,this.Vi=null}static mi(e){return new L0(e)}get fi(){if(this.Vi)return this.Vi;throw ke(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),te.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),te.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),te.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return te.forEach(this.fi,(i=>{const r=Ie.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,et.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return te.or([()=>te.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class bG{constructor(e){this.serializer=e}k(e,t,i,r){const s=new T0("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(Df)})(e),(function(u){u.createObjectStore(Xd,{keyPath:R7}),u.createObjectStore(_r,{keyPath:$2,autoIncrement:!0}).createIndex(hl,H2,{unique:!0}),u.createObjectStore(Su)})(e),kC(e),(function(u){u.createObjectStore(Ja)})(e));let o=te.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(bu),u.deleteObjectStore(Iu),u.deleteObjectStore(xl)})(e),kC(e)),o=o.next((()=>(function(u){const h=u.store(xl),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:et.min().toTimestamp(),targetCount:0};return h.put(Em,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(_r).J().next((m=>{u.deleteObjectStore(_r),u.createObjectStore(_r,{keyPath:$2,autoIncrement:!0}).createIndex(hl,H2,{unique:!0});const _=h.store(_r),v=m.map((S=>_.put(S)));return te.waitFor(v)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(Cu,{keyPath:j7})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Yd)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(I0,{keyPath:F7})})(e),(function(u){u.createObjectStore(b0,{keyPath:V7})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(C0,{keyPath:H7});h.createIndex(Pv,K7,{unique:!1}),h.createIndex(LN,q7,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(wm,{keyPath:P7});h.createIndex(Np,k7),h.createIndex(kN,N7)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Ja)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(Lw,{keyPath:z7,autoIncrement:!0}).createIndex(Av,U7,{unique:!1}),u.createObjectStore(yd,{keyPath:B7}).createIndex(DN,W7,{unique:!1}),u.createObjectStore(_d,{keyPath:G7}).createIndex(MN,$7,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(yd).clear()})).next((()=>{t.objectStore(_d).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(Ow,{keyPath:X7})})(e)}))),i<18&&r>=18&&Dk()&&(o=o.next((()=>{t.objectStore(yd).clear()})).next((()=>{t.objectStore(_d).clear()}))),o}wi(e){let t=0;return e.store(Ja).ee(((i,r)=>{t+=Nm(r)})).next((()=>{const i={byteSize:t};return e.store(Yd).put(Rv,i)}))}yi(e){const t=e.store(Xd),i=e.store(_r);return t.J().next((r=>te.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,_l],[s.userId,s.lastAcknowledgedBatchId]);return i.J(hl,o).next((l=>te.forEach(l,(u=>{Oe(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=nl(this.serializer,u);return RD(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(bu),i=e.store(Ja);return e.store(xl).get(Em).next((r=>{const s=[];return i.ee(((o,l)=>{const u=new Rt(o),h=(function(m){return[0,Xn(m)]})(u);s.push(t.get(h).next((f=>f?te.resolve():(m=>t.put({targetId:0,path:Xn(m),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>te.waitFor(s)))}))}bi(e,t){e.createObjectStore(Zd,{keyPath:O7});const i=t.store(Zd),r=new Kw,s=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:Xn(u)})}};return t.store(Ja).ee({X:!0},((o,l)=>{const u=new Rt(o);return s(u.popLast())})).next((()=>t.store(Su).ee({X:!0},(([o,l,u],h)=>{const f=as(l);return s(f.popLast())}))))}Di(e){const t=e.store(Iu);return t.ee(((i,r)=>{const s=od(r),o=TD(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(Ja),r=[];return i.ee(((s,o)=>{const l=t.store(wm),u=(function(m){return m.document?new Ie(Rt.fromString(m.document.name).popFirst(5)):m.noDocument?Ie.fromSegments(m.noDocument.path):m.unknownDocument?Ie.fromSegments(m.unknownDocument.path):ke(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>te.waitFor(r)))}Fi(e,t){const i=t.store(_r),r=ND(this.serializer),s=new MD(L0.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((u=>{let h=l.get(u.userId)??Cn();nl(this.serializer,u).keys().forEach((f=>h=h.add(f))),l.set(u.userId,h)})),te.forEach(l,((u,h)=>{const f=new Tn(h),m=D0.wt(this.serializer,f),_=s.getIndexManager(f),v=M0.wt(f,this.serializer,_,s.referenceDelegate);return new DD(r,v,m,_).recalculateAndSaveOverlaysForDocumentKeys(new kv(t,Sr.ce),u).next()}))}))}}function kC(n){n.createObjectStore(bu,{keyPath:M7}).createIndex(Mw,L7,{unique:!0}),n.createObjectStore(Iu,{keyPath:"targetId"}).createIndex(NN,D7,{unique:!0}),n.createObjectStore(xl)}const zo="IndexedDbPersistence",_x=18e5,xx=5e3,vx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",CG="main";class Xw{constructor(e,t,i,r,s,o,l,u,h,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=_=>Promise.resolve(),!Xw.v())throw new Ce(he.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new gG(this,r),this.$i=t+CG,this.serializer=new ED(u),this.Ui=new ia(this.$i,this.Ni,new bG(this.serializer)),this.hi=new eG,this.Pi=new lG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ND(this.serializer),this.Ii=new JW,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&Ci(zo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ce(he.FAILED_PRECONDITION,vx);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Sr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>pp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Wl(e))return ye(zo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ye(zo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Kh(e).get(Dc).next((t=>te.resolve(this.es(t))))}ts(e){return pp(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,_x)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=nn(t,Cu);return i.J().next((r=>{const s=this.ss(r,_x),o=r.filter((l=>s.indexOf(l)===-1));return te.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?te.resolve(!0):Kh(e).get(Dc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,xx)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ce(he.FAILED_PRECONDITION,vx);return!1}}return!(!this.networkEnabled||!this.inForeground)||pp(e).J().next((i=>this.ss(i,xx).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ye(zo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Df,Cu],(e=>{const t=new kv(e,Sr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>pp(e).J().next((t=>this.ss(t,_x).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return M0.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new aG(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return D0.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){ye(zo,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?Q7:u===17?VN:u===16?Z7:u===15?jw:u===14?FN:u===13?jN:u===12?Y7:u===11?ON:void ke(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new kv(l,this.ci?this.ci.next():Sr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Ci(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ce(he.FAILED_PRECONDITION,CN);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return Kh(e).get(Dc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,xx)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ce(he.FAILED_PRECONDITION,vx)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Kh(e).put(Dc,t)}static v(){return ia.v()}Zi(e){const t=Kh(e);return t.get(Dc).next((i=>this.es(i)?(ye(zo,"Releasing primary lease."),t.delete(Dc)):te.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Ci(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;Nk()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return ye(zo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ci(zo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ci("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Kh(n){return nn(n,Df)}function pp(n){return nn(n,Cu)}function RG(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Yw{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Cn(),r=Cn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Yw(e,t.fromCache,i,r)}}class AG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class LD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Nk()?8:AN(tn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new AG;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Wc()<=Xe.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",Bh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),te.resolve()):(Wc()<=Xe.DEBUG&&ye("QueryEngine","Query:",Bh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Wc()<=Xe.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",Bh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qs(t))):te.resolve())}ys(e,t){if(sC(t))return te.resolve(null);let i=Qs(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=jv(t,null,"F"),i=Qs(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Cn(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,l);return this.Cs(t,h,o,u.readTime)?this.ys(e,jv(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return sC(t)||r.isEqual(et.min())?te.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?te.resolve(null):(Wc()<=Xe.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Bh(t)),this.vs(e,o,t,E7(r,Kd)).next((l=>l)))}))}Ds(e,t){let i=new yt(yW(e));return t.forEach(((r,s)=>{P0(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Wc()<=Xe.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",Bh(t)),this.ps.getDocumentsMatchingQuery(e,t,Di.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const PG="LocalStore";class kG{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new gi(qe),this.xs=new ma((s=>Dl(s)),Mf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new DD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function OD(n,e,t,i){return new kG(n,e,t,i)}async function NG(n,e){const t=It(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let u=Cn();for(const h of r){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function DG(n,e){const t=It(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,f){const m=h.batch,_=m.keys();let v=te.resolve();return _.forEach((S=>{v=v.next((()=>f.getEntry(u,S))).next((I=>{const T=h.docVersions.get(S);Oe(T!==null,48541),I.version.compareTo(T)<0&&(m.applyToRemoteDocument(I,h),I.isValidDocument()&&(I.setReadTime(h.commitVersion),f.addEntry(I)))}))})),v.next((()=>l.mutationQueue.removeMutationBatch(u,m)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let u=Cn();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function MG(n){const e=It(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function LG(n,e){const t=It(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=_l),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class NC{constructor(){this.activeTargetIds=SW()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class jD{constructor(){this.Mo=new NC,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new NC,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class OG{Oo(e){}shutdown(){}}const DC="ConnectivityMonitor";class MC{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ye(DC,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ye(DC,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let mp=null;function Gv(){return mp===null?mp=(function(){return 268435456+Math.round(2147483648*Math.random())})():mp++,"0x"+mp.toString(16)}const wx="RestConnection",jG={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class FG{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===Sm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=Gv(),l=this.zo(e,t.toUriEncodedString());ye(wx,`Sending RPC '${e}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(l),f=Ul(h);return this.Jo(e,l,u,i,f).then((m=>(ye(wx,`Received RPC '${e}' ${o}: `,m),m)),(m=>{throw w0(wx,`RPC '${e}' ${o} failed with error: `,m,"url: ",l,"request:",i),m}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Gu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=jG[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class VG{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Mn="WebChannelConnection";class zG extends FG{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=Gv();return new Promise(((l,u)=>{const h=new mN;h.setWithCredentials(!0),h.listenOnce(yN.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Ap.NO_ERROR:const m=h.getResponseJson();ye(Mn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),l(m);break;case Ap.TIMEOUT:ye(Mn,`RPC '${e}' ${o} timed out`),u(new Ce(he.DEADLINE_EXCEEDED,"Request time out"));break;case Ap.HTTP_ERROR:const _=h.getStatus();if(ye(Mn,`RPC '${e}' ${o} failed with status:`,_,"response text:",h.getResponseText()),_>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const S=v?.error;if(S&&S.status&&S.message){const I=(function(R){const M=R.toLowerCase().replace(/_/g,"-");return Object.values(he).indexOf(M)>=0?M:he.UNKNOWN})(S.status);u(new Ce(I,S.message))}else u(new Ce(he.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Ce(he.UNAVAILABLE,"Connection failed."));break;default:ke(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{ye(Mn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);ye(Mn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=Gv(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=vN(),l=xN(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const f=s.join("");ye(Mn,`Creating RPC '${e}' stream ${r}: ${f}`,u);const m=o.createWebChannel(f,u);this.I_(m);let _=!1,v=!1;const S=new VG({Yo:T=>{v?ye(Mn,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(_||(ye(Mn,`Opening RPC '${e}' stream ${r} transport.`),m.open(),_=!0),ye(Mn,`RPC '${e}' stream ${r} sending:`,T),m.send(T))},Zo:()=>m.close()}),I=(T,R,M)=>{T.listen(R,(N=>{try{M(N)}catch(L){setTimeout((()=>{throw L}),0)}}))};return I(m,sd.EventType.OPEN,(()=>{v||(ye(Mn,`RPC '${e}' stream ${r} transport opened.`),S.o_())})),I(m,sd.EventType.CLOSE,(()=>{v||(v=!0,ye(Mn,`RPC '${e}' stream ${r} transport closed`),S.a_(),this.E_(m))})),I(m,sd.EventType.ERROR,(T=>{v||(v=!0,w0(Mn,`RPC '${e}' stream ${r} transport errored. Name:`,T.name,"Message:",T.message),S.a_(new Ce(he.UNAVAILABLE,"The operation could not be completed")))})),I(m,sd.EventType.MESSAGE,(T=>{if(!v){const R=T.data[0];Oe(!!R,16349);const M=R,N=M?.error||M[0]?.error;if(N){ye(Mn,`RPC '${e}' stream ${r} received error:`,N);const L=N.status;let A=(function(b){const k=Kt[b];if(k!==void 0)return LW(k)})(L),z=N.message;A===void 0&&(A=he.INTERNAL,z="Unknown error status: "+L+" with message "+N.message),v=!0,S.a_(new Ce(A,z)),m.close()}else ye(Mn,`RPC '${e}' stream ${r} received:`,R),S.u_(R)}})),I(l,_N.STAT_EVENT,(T=>{T.stat===Iv.PROXY?ye(Mn,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===Iv.NOPROXY&&ye(Mn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function UG(){return typeof window<"u"?window:null}function jp(){return typeof document<"u"?document:null}function FD(n){return new VW(n,!0)}class VD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&ye("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const LC="PersistentStream";class BG{constructor(e,t,i,r,s,o,l,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new VD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===he.RESOURCE_EXHAUSTED?(Ci(t.toString()),Ci("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===he.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Ce(he.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ye(LC,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ye(LC,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class WG extends BG{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=GW(e.writeResults,e.commitTime),i=Ar(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=BW(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>Am(this.serializer,i)))};this.q_(t)}}class GG{}class $G extends GG{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ce(he.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,Vv(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===he.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ce(he.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,Vv(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===he.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ce(he.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class HG{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ci(t),this.aa=!1):ye("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const O0="RemoteStore";class KG{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{F0(this)&&(ye(O0,"Restarting streams for network reachability change."),await(async function(u){const h=It(u);h.Ea.add(4),await j0(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Zw(h)})(this))}))})),this.Ra=new HG(i,r)}}async function Zw(n){if(F0(n))for(const e of n.da)await e(!0)}async function j0(n){for(const e of n.da)await e(!1)}function F0(n){return It(n).Ea.size===0}async function zD(n,e,t){if(!Wl(e))throw e;n.Ea.add(1),await j0(n),n.Ra.set("Offline"),t||(t=()=>MG(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ye(O0,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Zw(n)}))}function UD(n,e){return e().catch((t=>zD(n,t,e)))}async function V0(n){const e=It(n),t=fa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:_l;for(;qG(e);)try{const r=await LG(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,XG(e,r)}catch(r){await zD(e,r)}BD(e)&&WD(e)}function qG(n){return F0(n)&&n.Ta.length<10}function XG(n,e){n.Ta.push(e);const t=fa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function BD(n){return F0(n)&&!fa(n).x_()&&n.Ta.length>0}function WD(n){fa(n).start()}async function YG(n){fa(n).ra()}async function ZG(n){const e=fa(n);for(const t of n.Ta)e.ea(t.mutations)}async function QG(n,e,t){const i=n.Ta.shift(),r=Gw.from(i,e,t);await UD(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await V0(n)}async function JG(n,e){e&&fa(n).X_&&await(async function(i,r){if((function(o){return MW(o)&&o!==he.ABORTED})(r.code)){const s=i.Ta.shift();fa(i).B_(),await UD(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await V0(i)}})(n,e),BD(n)&&WD(n)}async function e$(n,e){const t=It(n);e?(t.Ea.delete(2),await Zw(t)):e||(t.Ea.add(2),await j0(t),t.Ra.set("Unknown"))}function fa(n){return n.fa||(n.fa=(function(t,i,r){const s=It(t);return s.sa(),new WG(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:YG.bind(null,n),r_:JG.bind(null,n),ta:ZG.bind(null,n),na:QG.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await V0(n)):(await n.fa.stop(),n.Ta.length>0&&(ye(O0,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Qw{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new yl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new Qw(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(he.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function t$(n,e){if(Ci("AsyncQueue",`${e}: ${n}`),Wl(n))return new Ce(he.UNAVAILABLE,`${e}: ${n}`);throw n}class n${constructor(){this.queries=OC(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=It(t),s=r.queries;r.queries=OC(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(i)}))})(this,new Ce(he.ABORTED,"Firestore shutting down"))}}function OC(){return new ma((n=>sD(n)),rD)}function i$(n){n.Ca.forEach((e=>{e.next()}))}var jC,FC;(FC=jC||(jC={})).Ma="default",FC.Cache="cache";const r$="SyncEngine";class s${constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ma((l=>sD(l)),rD),this.Iu=new Map,this.Eu=new Set,this.du=new gi(Ie.comparator),this.Au=new Map,this.Ru=new qw,this.Vu={},this.mu=new Map,this.fu=Ol.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function VC(n,e,t){const i=It(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const u=It(o);u.onlineState=l;let h=!1;u.queries.forEach(((f,m)=>{for(const _ of m.Sa)_.va(l)&&(h=!0)})),h&&i$(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function o$(n,e){const t=It(n),i=e.batch.batchId;try{const r=await DG(t.localStore,e);$D(t,i,null),GD(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Jw(t,r)}catch(r){await E0(r)}}async function a$(n,e,t){const i=It(n);try{const r=await(function(o,l){const u=It(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next((m=>(Oe(m!==null,37113),f=m.keys(),u.mutationQueue.removeMutationBatch(h,m)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);$D(i,e,t),GD(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Jw(i,r)}catch(r){await E0(r)}}function GD(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function $D(n,e,t){const i=It(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function Jw(n,e,t){const i=It(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){r.push(h);const f=Yw.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const f=It(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>te.forEach(h,(_=>te.forEach(_.Es,(v=>f.persistence.referenceDelegate.addReference(m,_.targetId,v))).next((()=>te.forEach(_.ds,(v=>f.persistence.referenceDelegate.removeReference(m,_.targetId,v)))))))))}catch(m){if(!Wl(m))throw m;ye(PG,"Failed to update sequence numbers: "+m)}for(const m of h){const _=m.targetId;if(!m.fromCache){const v=f.Ms.get(_),S=v.snapshotVersion,I=v.withLastLimboFreeSnapshotVersion(S);f.Ms=f.Ms.insert(_,I)}}})(i.localStore,s))}async function l$(n,e){const t=It(n);if(!t.currentUser.isEqual(e)){ye(r$,"User change. New user:",e.toKey());const i=await NG(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new Ce(he.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Jw(t,i.Ls)}}function c$(n){const e=It(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=o$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=a$.bind(null,e),e}class $v{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=FD(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return OD(this.persistence,new LD,e.initialUser,this.serializer)}Cu(e){return new MD(L0.mi,this.serializer)}Du(e){return new jD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$v.provider={build:()=>new $v};class u$ extends $v{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await c$(this.xu.syncEngine),await V0(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return OD(this.persistence,new LD,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new hG(i,e.asyncQueue,t)}Mu(e,t){const i=new b7(t,this.persistence);return new I7(e.asyncQueue,i)}Cu(e){const t=RG(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?si.withCacheSize(this.cacheSizeBytes):si.DEFAULT;return new Xw(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,UG(),jp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new jD}}class Hv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>VC(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=l$.bind(null,this.syncEngine),await e$(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new n$})()}createDatastore(e){const t=FD(e.databaseInfo.databaseId),i=(function(s){return new zG(s)})(e.databaseInfo);return(function(s,o,l,u){return new $G(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new KG(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>VC(this.syncEngine,t,0)),(function(){return MC.v()?new MC:new OG})())}createSyncEngine(e,t){return(function(r,s,o,l,u,h,f){const m=new s$(r,s,o,l,u,h);return f&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=It(t);ye(O0,"RemoteStore shutting down."),i.Ea.add(5),await j0(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Hv.provider={build:()=>new Hv};const zC="FirestoreClient";class h${constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Tn.UNAUTHENTICATED,this.clientId=TN.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{ye(zC,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(ye(zC,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new yl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=t$(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function HD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const UC=new Map;const KD="firestore.googleapis.com",BC=!0;class WC{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(he.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=KD,this.ssl=BC}else this.host=e.host,this.ssl=e.ssl??BC;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=CD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<cG)throw new Ce(he.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}x7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=HD(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ce(he.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ce(he.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ce(he.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class qD{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new WC({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(he.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(he.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new WC(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new c7;switch(i.type){case"firstParty":return new f7(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ce(he.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=UC.get(t);i&&(ye("ComponentProvider","Removing Datastore"),UC.delete(t),i.terminate())})(this),Promise.resolve()}}function d$(n,e,t,i={}){n=IN(n,qD);const r=Ul(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(pw(`https://${l}`),mw("Firestore",!0)),s.host!==KD&&s.host!==l&&w0("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:r,emulatorOptions:i};if(!Al(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=Tn.MOCK_USER;else{h=Pk(i.mockUserToken,n._app?.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new Ce(he.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Tn(m)}n._authCredentials=new u7(new EN(h,f))}}class eE{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new eE(this.firestore,e,this._query)}}class cs{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tE(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cs(this.firestore,e,this._key)}toJSON(){return{type:cs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Nf(t,cs._jsonSchema))return new cs(e,i||null,new Ie(Rt.fromString(t.referencePath)))}}cs._jsonSchemaVersion="firestore/documentReference/1.0",cs._jsonSchema={type:Xt("string",cs._jsonSchemaVersion),referencePath:Xt("string")};class tE extends eE{constructor(e,t,i){super(e,t,iD(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cs(this.firestore,null,new Ie(e))}withConverter(e){return new tE(this.firestore,e,this._path)}}const GC="AsyncQueue";class $C{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new VD(this,"async_queue_retry"),this._c=()=>{const i=jp();i&&ye(GC,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=jp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=jp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new yl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Wl(e))throw e;ye(GC,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ci("INTERNAL UNHANDLED ERROR: ",HC(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Qw.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&ke(47125,{Pc:HC(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function HC(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class XD extends qD{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new $C,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $C(e),this._firestoreClient=void 0,await e}}}function f$(n,e){const t=typeof n=="object"?n:xw(),i=typeof n=="string"?n:Sm,r=y0(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=Ck("firestore");s&&d$(r,...s)}return r}function g$(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new nW(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,HD(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new h$(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function p$(n,e){w0("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return m$(n,Hv.provider,{build:i=>new u$(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function m$(n,e,t){if((n=IN(n,XD))._firestoreClient||n._terminated)throw new Ce(he.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ce(he.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},g$(n)}class Ws{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ws(pi.fromBase64String(e))}catch(t){throw new Ce(he.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ws(pi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ws._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Nf(e,Ws._jsonSchema))return Ws.fromBase64String(e.bytes)}}Ws._jsonSchemaVersion="firestore/bytes/1.0",Ws._jsonSchema={type:Xt("string",Ws._jsonSchemaVersion),bytes:Xt("string")};class YD{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ce(he.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class vl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ce(he.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ce(he.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:vl._jsonSchemaVersion}}static fromJSON(e){if(Nf(e,vl._jsonSchema))return new vl(e.latitude,e.longitude)}}vl._jsonSchemaVersion="firestore/geoPoint/1.0",vl._jsonSchema={type:Xt("string",vl._jsonSchemaVersion),latitude:Xt("number"),longitude:Xt("number")};class wl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:wl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Nf(e,wl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new wl(e.vectorValues);throw new Ce(he.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}wl._jsonSchemaVersion="firestore/vectorValue/1.0",wl._jsonSchema={type:Xt("string",wl._jsonSchemaVersion),vectorValues:Xt("object")};const y$=new RegExp("[~\\*/\\[\\]]");function _$(n,e,t){if(e.search(y$)>=0)throw KC(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new YD(...e.split("."))._internalPath}catch{throw KC(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function KC(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new Ce(he.INVALID_ARGUMENT,s+n+o)}class ZD{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new cs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new x$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(QD("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class x$ extends ZD{data(){return super.data()}}function QD(n,e){return typeof e=="string"?_$(n,e):e instanceof YD?e._internalPath:e._delegate._internalPath}class yp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cu extends ZD{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Fp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(QD("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(he.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=cu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}cu._jsonSchemaVersion="firestore/documentSnapshot/1.0",cu._jsonSchema={type:Xt("string",cu._jsonSchemaVersion),bundleSource:Xt("string","DocumentSnapshot"),bundleName:Xt("string"),bundle:Xt("string")};class Fp extends cu{data(e={}){return super.data(e)}}class Td{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new yp(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Fp(this._firestore,this._userDataWriter,i.key,i,new yp(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ce(he.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const u=new Fp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new yp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new Fp(r._firestore,r._userDataWriter,l.doc.key,l.doc,new yp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:v$(l.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(he.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Td._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=TN.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function v$(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ke(61501,{type:n})}}Td._jsonSchemaVersion="firestore/querySnapshot/1.0",Td._jsonSchema={type:Xt("string",Td._jsonSchemaVersion),bundleSource:Xt("string","QuerySnapshot"),bundleName:Xt("string"),bundle:Xt("string")};(function(e,t=!0){(function(r){Gu=r})(Bl),Pl(new ua("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new XD(new h7(i.getProvider("auth-internal")),new g7(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ce(he.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Au(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),ds(j2,F2,e),ds(j2,F2,"esm2020")})();const JD="firebasestorage.googleapis.com",w$="storageBucket",E$=120*1e3,T$=600*1e3;class vs extends xs{constructor(e,t,i=0){super(Ex(e),`Firebase Storage: ${t} (${Ex(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,vs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ex(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ms;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ms||(ms={}));function Ex(n){return"storage/"+n}function S$(){const n="An unknown error occurred, please check the error payload for server response.";return new vs(ms.UNKNOWN,n)}function I$(){return new vs(ms.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function b$(){return new vs(ms.CANCELED,"User canceled the upload/download.")}function C$(n){return new vs(ms.INVALID_URL,"Invalid URL '"+n+"'.")}function R$(n){return new vs(ms.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function qC(n){return new vs(ms.INVALID_ARGUMENT,n)}function eM(){return new vs(ms.APP_DELETED,"The Firebase app was deleted.")}function A$(n){return new vs(ms.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class br{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=br.makeFromUrl(e,t)}catch{return new br(e,"")}if(i.path==="")return i;throw R$(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(L){L.path_=decodeURIComponent(L.path)}const f="v[A-Za-z0-9_]+",m=t.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",v=new RegExp(`^https?://${m}/${f}/b/${r}/o${_}`,"i"),S={bucket:1,path:3},I=t===JD?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",R=new RegExp(`^https?://${I}/${r}/${T}`,"i"),N=[{regex:l,indices:u,postModify:s},{regex:v,indices:S,postModify:h},{regex:R,indices:{bucket:1,path:2},postModify:h}];for(let L=0;L<N.length;L++){const A=N[L],z=A.regex.exec(e);if(z){const P=z[A.indices.bucket];let b=z[A.indices.path];b||(b=""),i=new br(P,b),A.postModify(i);break}}if(i==null)throw C$(e);return i}}class P${constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function k$(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function f(...T){h||(h=!0,e.apply(null,T))}function m(T){r=setTimeout(()=>{r=null,n(v,u())},T)}function _(){s&&clearTimeout(s)}function v(T,...R){if(h){_();return}if(T){_(),f.call(null,T,...R);return}if(u()||o){_(),f.call(null,T,...R);return}i<64&&(i*=2);let N;l===1?(l=2,N=0):N=(i+Math.random())*1e3,m(N)}let S=!1;function I(T){S||(S=!0,_(),!h&&(r!==null?(T||(l=2),clearTimeout(r),m(0)):T||(l=1)))}return m(0),s=setTimeout(()=>{o=!0,I(!0)},t),I}function N$(n){n(!1)}function D$(n){return n!==void 0}function XC(n,e,t,i){if(i<e)throw qC(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw qC(`Invalid value for '${n}'. Expected ${t} or less.`)}function M$(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var Dm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Dm||(Dm={}));function L$(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class O${constructor(e,t,i,r,s,o,l,u,h,f,m,_=!0,v=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=m,this.retry=_,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,I)=>{this.resolve_=S,this.reject_=I,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new _p(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===Dm.NO_ERROR,u=s.getStatus();if(!l||L$(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===Dm.ABORT;i(!1,new _p(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new _p(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());D$(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=S$();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?eM():b$();o(u)}else{const u=I$();o(u)}};this.canceled_?t(!1,new _p(!1,null,!0)):this.backoffId_=k$(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&N$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class _p{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function j$(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function F$(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function V$(n,e){e&&(n["X-Firebase-GMPID"]=e)}function z$(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function U$(n,e,t,i,r,s,o=!0,l=!1){const u=M$(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return V$(f,e),j$(f,t),F$(f,s),z$(f,i),new O$(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function B$(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function W$(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Mm{constructor(e,t){this._service=e,t instanceof br?this._location=t:this._location=br.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Mm(e,t)}get root(){const e=new br(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return W$(this._location.path)}get storage(){return this._service}get parent(){const e=B$(this._location.path);if(e===null)return null;const t=new br(this._location.bucket,e);return new Mm(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw A$(e)}}function YC(n,e){const t=e?.[w$];return t==null?null:br.makeFromBucketSpec(t,n)}function G$(n,e,t,i={}){n.host=`${e}:${t}`;const r=Ul(e);r&&(pw(`https://${n.host}/b`),mw("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:Pk(s,n.app.options.projectId))}class $${constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=JD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=E$,this._maxUploadRetryTime=T$,this._requests=new Set,r!=null?this._bucket=br.makeFromBucketSpec(r,this._host):this._bucket=YC(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=br.makeFromBucketSpec(this._url,e):this._bucket=YC(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){XC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){XC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Qi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Mm(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new P$(eM());{const o=U$(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const ZC="@firebase/storage",QC="0.14.0";const tM="storage";function H$(n=xw(),e){n=oo(n);const i=y0(n,tM).getImmediate({identifier:e}),r=Ck("storage");return r&&K$(i,...r),i}function K$(n,e,t,i={}){G$(n,e,t,i)}function q$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new $$(t,i,r,e,Bl)}function X$(){Pl(new ua(tM,q$,"PUBLIC").setMultipleInstances(!0)),ds(ZC,QC,""),ds(ZC,QC,"esm2020")}X$();const Y$={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},nE=jk(Y$),Tx=s7(nE),Z$=f$(nE);H$(nE);p$(Z$).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const Q$="visvriend2024",J$=new Bs,nM=rr()(Bu((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===Q$;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await g8(Tx,J$);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await qB(Tx),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{KB(Tx,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})})),iE="https://waterwebservices.rijkswaterstaat.nl/ONLINEWAARNEMINGENSERVICES_DBO",nf=[{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556,x:97580,y:497920},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664,x:75580,y:458220},{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12,x:65150,y:444150},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961,x:30410,y:385360},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456,x:109200,y:553200},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083,x:158e3,y:576500},{id:"TERSLNZE",name:"Terschelling",lat:53.4397,lng:5.3281,x:155e3,y:606e3},{id:"TEXLHORS",name:"Texel Hors",lat:52.9983,lng:4.6981,x:106e3,y:557e3},{id:"EEMHVN",name:"Eemhaven",lat:51.9,lng:4.4833,x:9e4,y:436e3},{id:"KATSVR",name:"Kats",lat:51.5694,lng:3.9389,x:53e3,y:399e3}];function eH(n,e){let t=nf[0],i=1/0;for(const r of nf){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}async function tH(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"T"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${iE}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching water temperature:",r),null}}async function nH(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"GOLFHTE"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${iE}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching wave height:",r),null}}async function iH(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"STROOMSHD"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${iE}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0){const l=o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null;return l!==null?{speed:l,direction:0}:null}}return null}catch(r){return console.error("Error fetching current speed:",r),null}}async function rH(n){const[e,t,i]=await Promise.all([tH(n),nH(n),iH(n)]);return{temperature:e??void 0,waveHeight:t??void 0,currentSpeed:i?.speed??void 0,currentDirection:i?.direction??void 0,timestamp:new Date,station:n}}function JC(n){const e=new Date().getMonth(),i=[5,4,5,8,12,16,18,19,17,13,9,6][e]+(Math.random()*2-1),r=30+Math.random()*80,s=Math.random()*60,o=Math.random()*360;return{temperature:Math.round(i*10)/10,waveHeight:Math.round(r),currentSpeed:Math.round(s),currentDirection:Math.round(o),timestamp:new Date,station:n}}const eR=rr((n,e)=>({station:nf[1],waterData:null,lastUpdated:null,isLoading:!1,error:null,useSimulatedData:!0,setStation:t=>n({station:t}),setStationByPosition:(t,i)=>{const r=eH(t,i);n({station:r})},fetchData:async()=>{const{station:t,useSimulatedData:i}=e();if(t){n({isLoading:!0,error:null});try{let r;i?r=JC(t):r=await rH(t),n({waterData:r,lastUpdated:new Date,isLoading:!1})}catch(r){console.error("Error fetching water data:",r);const s=JC(t);n({waterData:s,lastUpdated:new Date,isLoading:!1,error:"Kon geen live data ophalen, gesimuleerde data wordt getoond"})}}},setUseSimulatedData:t=>n({useSimulatedData:t})})),z0="https://photospicker.googleapis.com/v1",sH="1095904118758-p3569bgj1u7n5l8kbkl28m749js2h2vg.apps.googleusercontent.com",oH="https://www.googleapis.com/auth/photospicker.mediaitems.readonly";function aH(){const n=window.location.origin+window.location.pathname;return`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:sH,redirect_uri:n,response_type:"token",scope:oH,include_granted_scopes:"true",prompt:"consent"}).toString()}`}function lH(){const n=window.location.hash.substring(1);if(!n)return null;const e=new URLSearchParams(n),t=e.get("access_token"),i=e.get("expires_in");return t?(window.history.replaceState(null,"",window.location.pathname+window.location.search),{token:t,expiresIn:i?parseInt(i):3600}):null}async function cH(n){const e=await fetch(`${z0}/sessions`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({})});if(!e.ok){const t=await e.text();throw new Error(`Failed to create session: ${e.status} - ${t}`)}return e.json()}function uH(n){const e=n+"/autoclose";return window.open(e,"google-photos-picker","width=900,height=700,scrollbars=yes")}async function hH(n,e){const t=await fetch(`${z0}/sessions/${e}`,{headers:{Authorization:`Bearer ${n}`}});if(!t.ok){const i=await t.text();throw new Error(`Failed to poll session: ${t.status} - ${i}`)}return t.json()}function dH(n){if(n.pollingConfig?.pollInterval){const e=n.pollingConfig.pollInterval.match(/(\d+)/);if(e)return parseInt(e[1])*1e3}return 5e3}async function fH(n,e){const t=[];let i="";do{const r=new URL(`${z0}/mediaItems`);r.searchParams.set("sessionId",e),r.searchParams.set("pageSize","100"),i&&r.searchParams.set("pageToken",i);const s=await fetch(r.toString(),{headers:{Authorization:`Bearer ${n}`}});if(!s.ok){const l=await s.text();throw new Error(`Failed to get media items: ${s.status} - ${l}`)}const o=await s.json();o.mediaItems&&t.push(...o.mediaItems),i=o.nextPageToken||""}while(i);return t}async function tR(n,e){await fetch(`${z0}/sessions/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${n}`}})}function gH(n,e=300){return`${n}=w${e}-h${e}-c`}function pH(n,e=800,t=600){return`${n}=w${e}-h${t}`}function mH(n){return`${n}=d`}function yH(){return Date.now()+3600*1e3}async function _H(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e(null);return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,m=r.getUint16(f)===18761,_=xH(r,f,m);e(_);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e(null)},t.onerror=()=>e(null),t.readAsArrayBuffer(n)})}function xH(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null;for(let m=0;m<r;m++){const _=i+2+m*12;if(n.getUint16(_,t)===34853){s=e+n.getUint32(_+8,t);break}}if(!s)return null;const o=n.getUint16(s,t);let l=null,u=null,h=null,f=null;for(let m=0;m<o;m++){const _=s+2+m*12,v=n.getUint16(_,t),S=n.getUint16(_+2,t),I=n.getUint32(_+4,t),T=_+8;switch(v){case 1:l=String.fromCharCode(n.getUint8(T));break;case 2:u=Lm(n,e+n.getUint32(T,t),3,t);break;case 3:h=String.fromCharCode(n.getUint8(T));break;case 4:f=Lm(n,e+n.getUint32(T,t),3,t);break}}if(u&&f&&l&&h){const m=Om(u[0],u[1],u[2],l),_=Om(f[0],f[1],f[2],h);if(!isNaN(m)&&!isNaN(_))return{lat:m,lng:_}}return null}catch{return null}}function Lm(n,e,t,i){const r=[];for(let s=0;s<t;s++){const o=n.getUint32(e+s*8,i),l=n.getUint32(e+s*8+4,i);r.push(l===0?0:o/l)}return r}function Om(n,e,t,i){let r=n+e/60+t/3600;return(i==="S"||i==="W")&&(r=-r),r}function vH(n,e){return`${n.toFixed(5)}, ${e.toFixed(5)}`}async function wH(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e({gps:null,dateTime:null});return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,m=r.getUint16(f)===18761,_=EH(r,f,m);e(_);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e({gps:null,dateTime:null})},t.onerror=()=>e({gps:null,dateTime:null}),t.readAsArrayBuffer(n)})}function EH(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null,o=null,l=null;for(let h=0;h<r;h++){const f=i+2+h*12,m=n.getUint16(f,t);if(m===34853&&(s=e+n.getUint32(f+8,t)),m===34665&&(o=e+n.getUint32(f+8,t)),m===306){const _=e+n.getUint32(f+8,t),v=Sx(n,_,19);l=Ix(v)}}if(o){const h=n.getUint16(o,t);for(let f=0;f<h;f++){const m=o+2+f*12,_=n.getUint16(m,t);if(_===36867){const v=e+n.getUint32(m+8,t),S=Sx(n,v,19),I=Ix(S);I&&(l=I);break}if(_===36868&&!l){const v=e+n.getUint32(m+8,t),S=Sx(n,v,19);l=Ix(S)}}}let u=null;return s&&(u=TH(n,e,s,t)),{gps:u,dateTime:l}}catch{return{gps:null,dateTime:null}}}function TH(n,e,t,i){const r=n.getUint16(t,i);let s=null,o=null,l=null,u=null;for(let h=0;h<r;h++){const f=t+2+h*12,m=n.getUint16(f,i),_=f+8;switch(m){case 1:s=String.fromCharCode(n.getUint8(_));break;case 2:o=Lm(n,e+n.getUint32(_,i),3,i);break;case 3:l=String.fromCharCode(n.getUint8(_));break;case 4:u=Lm(n,e+n.getUint32(_,i),3,i);break}}if(o&&u&&s&&l){const h=Om(o[0],o[1],o[2],s),f=Om(u[0],u[1],u[2],l);if(!isNaN(h)&&!isNaN(f))return{lat:h,lng:f}}return null}function Sx(n,e,t){let i="";for(let r=0;r<t;r++){const s=n.getUint8(e+r);if(s===0)break;i+=String.fromCharCode(s)}return i}function Ix(n){if(!n||n.length<19)return null;try{const e=n.match(/(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})/);if(!e)return null;const[,t,i,r,s,o,l]=e,u=new Date(parseInt(t),parseInt(i)-1,parseInt(r),parseInt(s),parseInt(o),parseInt(l));return isNaN(u.getTime())?null:u}catch{return null}}function nR(n){const e=n.getDate(),i=["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"][n.getMonth()],r=n.getFullYear(),s=n.getHours().toString().padStart(2,"0"),o=n.getMinutes().toString().padStart(2,"0");return`${e} ${i} ${r}, ${s}:${o}`}const SH="https://archive-api.open-meteo.com/v1/archive";function IH(n){return n.toISOString().split("T")[0]}function bH(n){const e=new Date,t=new Date(e.getTime()-7200*60*1e3);return n<new Date("1940-01-01")?{supported:!1,reason:"Datum is voor 1940 - geen data beschikbaar"}:n>t?{supported:!1,reason:"Datum is te recent - gebruik huidige weerdata"}:{supported:!0}}async function CH(n,e,t){const i=bH(t);if(!i.supported)return console.warn("Historical weather not available:",i.reason),null;const r=IH(t),s=new URLSearchParams({latitude:n.toString(),longitude:e.toString(),start_date:r,end_date:r,hourly:["temperature_2m","relative_humidity_2m","surface_pressure","wind_speed_10m","wind_direction_10m","cloud_cover","precipitation","weather_code"].join(","),timezone:"Europe/Amsterdam"});try{const o=await fetch(`${SH}?${s.toString()}`);if(!o.ok)throw new Error(`Archive API error: ${o.status}`);const l=await o.json(),u=t.getHours()||12,h=Math.min(u,l.hourly.time.length-1);return{temp:l.hourly.temperature_2m[h],humidity:l.hourly.relative_humidity_2m[h],pressure:l.hourly.surface_pressure[h],windSpeed:l.hourly.wind_speed_10m[h],windDirection:l.hourly.wind_direction_10m[h],cloudCover:l.hourly.cloud_cover[h],precipitation:l.hourly.precipitation[h],weatherCode:l.hourly.weather_code[h],date:r,fetchedAt:new Date().toISOString()}}catch(o){return console.error("Failed to fetch historical weather:",o),null}}function RH(n){return{0:"Helder",1:"Overwegend helder",2:"Half bewolkt",3:"Bewolkt",45:"Mist",48:"Aanvriezende mist",51:"Lichte motregen",53:"Motregen",55:"Zware motregen",56:"Lichte ijzel",57:"Ijzel",61:"Lichte regen",63:"Regen",65:"Zware regen",66:"Lichte ijsregen",67:"Ijsregen",71:"Lichte sneeuw",73:"Sneeuw",75:"Zware sneeuw",77:"Sneeuwkorrels",80:"Lichte regenbuien",81:"Regenbuien",82:"Zware regenbuien",85:"Lichte sneeuwbuien",86:"Sneeuwbuien",95:"Onweer",96:"Onweer met lichte hagel",99:"Onweer met zware hagel"}[n]||"Onbekend"}function AH(n){const e=["N","NNO","NO","ONO","O","OZO","ZO","ZZO","Z","ZZW","ZW","WZW","W","WNW","NW","NNW"],t=Math.round(n/22.5)%16;return e[t]}function PH(n){let e=50;return n.pressure>=1010&&n.pressure<=1025?e+=15:(n.pressure<1e3||n.pressure>1035)&&(e-=10),n.windSpeed<10?e+=10:n.windSpeed<20?e+=5:n.windSpeed>30&&(e-=15),n.cloudCover>=50&&n.cloudCover<=80&&(e+=10),n.precipitation>0&&n.precipitation<2?e+=5:n.precipitation>5&&(e-=10),n.temp>=10&&n.temp<=20?e+=10:(n.temp<5||n.temp>25)&&(e-=5),Math.max(0,Math.min(100,e))}const kH="visapp-photos",NH=1,ys="photos",iR=800,rR=800,DH=.7;let bx=null;async function U0(){return bx||new Promise((n,e)=>{const t=indexedDB.open(kH,NH);t.onerror=()=>{console.error("Failed to open IndexedDB:",t.error),e(t.error)},t.onsuccess=()=>{bx=t.result,n(t.result)},t.onupgradeneeded=i=>{const r=i.target.result;r.objectStoreNames.contains(ys)||r.createObjectStore(ys,{keyPath:"id"}).createIndex("storedAt","storedAt",{unique:!1})}})}async function MH(n,e){try{const t=new Image;t.crossOrigin="anonymous";const i=new Promise((N,L)=>{t.onload=()=>N(),t.onerror=()=>L(new Error("Failed to load image"))});t.src=e;try{await i}catch{console.warn("CORS blocked, trying without crossOrigin..."),t.crossOrigin="",t.src=e,await new Promise((N,L)=>{t.onload=()=>N(),t.onerror=()=>L(new Error("Failed to load image even without CORS"))})}const r=document.createElement("canvas"),s=r.getContext("2d");if(!s)throw new Error("Could not get canvas context");let o=t.naturalWidth,l=t.naturalHeight;if(o>iR||l>rR){const N=Math.min(iR/o,rR/l);o=Math.round(o*N),l=Math.round(l*N)}r.width=o,r.height=l,s.drawImage(t,0,0,o,l);let u,h;try{u=r.toDataURL("image/jpeg",DH),h=Math.round(u.length*.75)}catch{return console.warn("Canvas tainted by CORS, photo will not be stored locally"),null}const f=document.createElement("canvas"),m=f.getContext("2d");if(!m)throw new Error("Could not get thumbnail canvas context");const _=150;f.width=_,f.height=_;const v=Math.min(t.naturalWidth,t.naturalHeight),S=(t.naturalWidth-v)/2,I=(t.naturalHeight-v)/2;m.drawImage(t,S,I,v,v,0,0,_,_);let T;try{T=f.toDataURL("image/jpeg",.7)}catch{T=""}const R={id:n,dataUrl:u,thumbnailUrl:T,storedAt:Date.now(),originalSize:t.naturalWidth*t.naturalHeight*4,storedSize:h},M=await U0();return new Promise((N,L)=>{const P=M.transaction(ys,"readwrite").objectStore(ys).put(R);P.onsuccess=()=>{console.log(` Photo stored: ${n} (${(h/1024).toFixed(1)} KB)`),N(R)},P.onerror=()=>{console.error("Failed to store photo:",P.error),L(P.error)}})}catch(t){return console.error("Failed to store photo from URL:",t),null}}async function LH(n){try{const e=await U0();return new Promise((t,i)=>{const o=e.transaction(ys,"readonly").objectStore(ys).get(n);o.onsuccess=()=>{t(o.result||null)},o.onerror=()=>{i(o.error)}})}catch(e){return console.error("Failed to get stored photo:",e),null}}async function OH(n){try{const e=await U0();return new Promise((t,i)=>{const o=e.transaction(ys,"readwrite").objectStore(ys).delete(n);o.onsuccess=()=>{console.log(` Photo deleted: ${n}`),t(!0)},o.onerror=()=>{i(o.error)}})}catch(e){return console.error("Failed to delete stored photo:",e),!1}}async function sR(){try{const n=await U0();return new Promise((e,t)=>{const s=n.transaction(ys,"readwrite").objectStore(ys).clear();s.onsuccess=()=>{console.log(" All photos cleared"),e()},s.onerror=()=>{t(s.error)}})}catch(n){console.error("Failed to clear photos:",n)}}function jH(){return`gphoto_${Date.now()}_${Math.random().toString(36).substring(2,9)}`}const di=rr()(Bu(bf((n,e)=>({accessToken:null,tokenExpiresAt:null,currentSessionId:null,isPickerOpen:!1,isLoading:!1,error:null,photos:[],selectedPhotoId:null,photoActionDialogOpen:!1,startAuth:()=>{const t=aH();window.location.href=t},handleAuthCallback:()=>{const t=lH();return t?(n(i=>{i.accessToken=t.token,i.tokenExpiresAt=Date.now()+t.expiresIn*1e3,i.error=null}),!0):!1},checkAndRefreshAuth:()=>{const{accessToken:t,tokenExpiresAt:i}=e();return!t||!i?!1:Date.now()>i-300*1e3?(n(r=>{r.accessToken=null,r.tokenExpiresAt=null}),!1):!0},openPhotoPicker:async()=>{const{accessToken:t,checkAndRefreshAuth:i}=e();if(!i()||!t){e().startAuth();return}n(r=>{r.isLoading=!0,r.error=null});try{console.log("[Google Photos] Creating session...");const r=await cH(t);if(console.log("[Google Photos] Session created:",r),n(f=>{f.currentSessionId=r.id}),console.log("[Google Photos] Opening picker:",r.pickerUri),!uH(r.pickerUri))throw new Error("Popup geblokkeerd. Sta popups toe voor deze site.");n(f=>{f.isPickerOpen=!0});const o=dH(r);let l=0;const u=120,h=async()=>{if(l++,console.log(`[Google Photos] Poll attempt ${l}/${u}`),l>u)throw new Error("Timeout bij wachten op foto selectie");const f=await hH(t,r.id);if(console.log("[Google Photos] Session status:",f),f.mediaItemsSet){console.log("[Google Photos] User finished selecting, fetching items...");const m=await fH(t,r.id);console.log("[Google Photos] Got items:",m.length,m);for(const _ of m)await FH(_,n,e);await tR(t,r.id),n(_=>{_.isLoading=!1,_.isPickerOpen=!1,_.currentSessionId=null});return}await new Promise(m=>setTimeout(m,o)),await h()};await h()}catch(r){console.error("Google Photos picker error:",r),n(o=>{o.isLoading=!1,o.isPickerOpen=!1,o.error=r instanceof Error?r.message:"Onbekende fout"});const{currentSessionId:s}=e();if(s&&t)try{await tR(t,s)}catch{}n(o=>{o.currentSessionId=null})}},addPhoto:t=>{n(i=>{i.photos.push(t)})},updatePhoto:(t,i)=>{n(r=>{const s=r.photos.findIndex(o=>o.id===t);s!==-1&&Object.assign(r.photos[s],i)})},removePhoto:t=>{OH(t).catch(console.error),n(i=>{i.photos=i.photos.filter(r=>r.id!==t),i.selectedPhotoId===t&&(i.selectedPhotoId=null,i.photoActionDialogOpen=!1)})},selectPhoto:t=>{n(i=>{i.selectedPhotoId=t})},fetchWeatherForPhoto:async t=>{const i=e().photos.find(r=>r.id===t);if(!i||!i.location||!i.dateTime){console.warn("Cannot fetch weather: missing location or date");return}try{const r=await CH(i.location.lat,i.location.lng,i.dateTime);r&&n(s=>{const o=s.photos.findIndex(l=>l.id===t);o!==-1&&(s.photos[o].weather=r,s.photos[o].weatherFetchedAt=new Date().toISOString())})}catch(r){console.error("Failed to fetch historical weather:",r)}},openPhotoActionDialog:t=>{n(i=>{i.selectedPhotoId=t,i.photoActionDialogOpen=!0})},closePhotoActionDialog:()=>{n(t=>{t.photoActionDialogOpen=!1})},clearAll:()=>{sR().catch(console.error),n(t=>{t.photos=[],t.selectedPhotoId=null,t.photoActionDialogOpen=!1})},setError:t=>{n(i=>{i.error=t})},logout:()=>{sR().catch(console.error),n(t=>{t.accessToken=null,t.tokenExpiresAt=null,t.photos=[],t.selectedPhotoId=null,t.photoActionDialogOpen=!1,t.error=null})}})),{name:"visapp-google-photos",partialize:n=>({accessToken:n.accessToken,tokenExpiresAt:n.tokenExpiresAt,photos:n.photos.map(e=>({...e,dateTime:e.dateTime?e.dateTime.toISOString():null}))}),onRehydrate:()=>n=>{n&&(n.photos=n.photos.map(e=>({...e,dateTime:e.dateTime?new Date(e.dateTime):null})))}}));async function FH(n,e,t){const i=n.mediaFile.baseUrl,r=jH();let s=null,o=null;try{const h=mH(i),f=await fetch(h);if(f.ok){const m=await f.blob(),_=new File([m],n.mediaFile.filename,{type:n.mediaFile.mimeType}),v=await wH(_);s=v.gps,o=v.dateTime}}catch(h){console.warn("Could not extract EXIF metadata:",h)}let l=!1;try{const h=pH(i,800,800);l=await MH(r,h)!==null}catch(h){console.warn("Could not store photo locally:",h)}const u={id:r,googleId:n.id,baseUrl:i,urlExpiresAt:yH(),filename:n.mediaFile.filename,mimeType:n.mediaFile.mimeType,location:s,dateTime:o,weather:null,weatherFetchedAt:null,isOnMap:!1,isRegisteredAsCatch:!1,isStoredLocally:l};console.log("[Google Photos] Adding photo to store:",u),e(h=>{h.photos.push(u)}),e(h=>{h.selectedPhotoId=u.id,h.photoActionDialogOpen=!0})}function VH(){const n=di(t=>t.photos),e=di(t=>t.selectedPhotoId);return n.find(t=>t.id===e)||null}function zH(){return di(e=>e.photos).filter(e=>e.isOnMap&&e.location!==null)}function UH({target:n}){const e=q.useRef(null),t=q.useRef(null),i=Dr(s=>s.setMap),r=We(s=>s.showScaleBar);return q.useEffect(()=>{if(!e.current){const s=new K9({target:n,controls:[],view:new ss({center:aa([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),q.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new Y9({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const BH=["OpenStreetMap","Luchtfoto","Terrein","CartoDB Light"];function WH(){const n=q.useRef(null),e=q.useRef(!1);UH({target:"map"});const t=Dr(u=>u.map),i=Zi(u=>u.registerLayer),r=Zi(u=>u.setLayerVisibility);Zi(u=>u.setLayerOpacity);const s=We(u=>u.defaultBackground),o=We(u=>u.gpsAutoStart),l=ci(u=>u.startTracking);return q.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const u=We.getState().defaultBackground||"CartoDB Light",h=u==="OpenStreetMap",f=u==="Luchtfoto",m=u==="Terrein",_=u==="CartoDB Light";console.log("Background setting:",u);const v=new Vh({properties:{title:"CartoDB Light",type:"base"},visible:_,source:new rd({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20})}),S=new Vh({properties:{title:"Terrein",type:"base"},visible:m,source:new rd({url:"https://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors, SRTM | Map style:  OpenTopoMap (CC-BY-SA)",maxZoom:17})}),I=new Vh({properties:{title:"OpenStreetMap",type:"base"},visible:h,source:new f9}),T=new Vh({properties:{title:"Luchtfoto",type:"base"},visible:f,source:new rd({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),R=new Vh({properties:{title:"Labels Overlay",type:"overlay"},visible:f,source:new rd({url:"https://{a-d}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})});t.addLayer(v),t.addLayer(S),t.addLayer(I),t.addLayer(T),t.addLayer(R),i("CartoDB Light",v),i("Terrein",S),i("OpenStreetMap",I),i("Luchtfoto",T),i("Labels Overlay",R),r("CartoDB Light",_),r("Terrein",m),r("OpenStreetMap",h),r("Luchtfoto",f),r("Labels Overlay",f),t.updateSize(),M();async function M(){const N=Ez();console.log(`Loading ${N.length} immediate layers...`),(await Promise.allSettled(N.map(async A=>{try{const z=await A.factory();return z?{name:A.name,layer:z}:null}catch(z){return console.warn(`Failed to create ${A.name}:`,z),null}}))).forEach(A=>{if(A.status==="fulfilled"&&A.value){const{name:z,layer:P}=A.value;t.addLayer(P),i(z,P)}})}},[t,i]),q.useEffect(()=>{if(!t||e.current)return;const u=setTimeout(()=>{const h=s||"OpenStreetMap";BH.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(u)},[t,s,r]),q.useEffect(()=>{if(!t||!o)return;const u=setTimeout(()=>l(),500);return()=>clearTimeout(u)},[t,o,l]),g.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const GH=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$H=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),oR=n=>{const e=$H(n);return e.charAt(0).toUpperCase()+e.slice(1)},iM=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),HH=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var KH={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const qH=q.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},u)=>q.createElement("svg",{ref:u,...KH,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:iM("lucide",r),...!s&&!HH(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>q.createElement(h,f)),...Array.isArray(s)?s:[s]]));const we=(n,e)=>{const t=q.forwardRef(({className:i,...r},s)=>q.createElement(qH,{ref:s,iconNode:e,className:iM(`lucide-${GH(oR(n))}`,`lucide-${n}`,i),...r}));return t.displayName=oR(n),t};const XH=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],rM=we("anchor",XH);const YH=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ZH=we("book-open",YH);const QH=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],JH=we("calendar",QH);const eK=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],rE=we("camera",eK);const tK=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],jm=we("chart-column",tK);const nK=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Fm=we("check",nK);const iK=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],sM=we("chevron-down",iK);const rK=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],sK=we("chevron-left",rK);const oK=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Kc=we("chevron-right",oK);const aK=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],oM=we("chevron-up",aK);const lK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]],cK=we("circle-dot",lK);const uK=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],hK=we("cloud-fog",uK);const dK=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],fK=we("cloud-lightning",dK);const gK=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],Of=we("cloud-rain",gK);const pK=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],mK=we("cloud-snow",pK);const yK=[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]],Cx=we("cloud-sun",yK);const _K=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],jl=we("cloud",_K);const xK=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],B0=we("droplets",xK);const vK=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],sE=we("external-link",vK);const wK=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],EK=we("eye-off",wK);const TK=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],SK=we("eye",TK);const IK=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],bK=we("file-text",IK);const CK=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],kr=we("fish",CK);const RK=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],rf=we("gauge",RK);const AK=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],PK=we("hard-drive",AK);const kK=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],aM=we("image-plus",kK);const NK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],lM=we("info",NK);const DK=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],MK=we("landmark",DK);const LK=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],sf=we("layers",LK);const OK=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Vm=we("loader-circle",OK);const jK=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],FK=we("locate-fixed",jK);const VK=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],zK=we("lock",VK);const UK=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],BK=we("log-out",UK);const WK=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Nr=we("map-pin",WK);const GK=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],jf=we("map",GK);const $K=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],HK=we("menu",$K);const KK=[["path",{d:"M5 12h14",key:"1ays0h"}]],oE=we("minus",KK);const qK=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],XK=we("moon",qK);const YK=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],ZK=we("mountain",YK);const QK=[["polygon",{points:"12 2 19 21 12 17 5 21 12 2",key:"x8c0qg"}]],JK=we("navigation-2",QK);const eq=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],Ou=we("navigation",eq);const tq=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],nq=we("pause",tq);const iq=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],rq=we("person-standing",iq);const sq=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],oq=we("play",sq);const aq=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],lq=we("plus",aq);const cq=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],uq=we("refresh-cw",cq);const hq=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],dq=we("rotate-ccw",hq);const fq=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],cM=we("ruler",fq);const gq=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],pq=we("save",gq);const mq=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],yq=we("scale",mq);const _q=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Kv=we("search",_q);const xq=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],vq=we("settings",xq);const wq=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],Eq=we("ship",wq);const Tq=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Sq=we("sparkles",Tq);const Iq=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],qv=we("star",Iq);const bq=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Cq=we("sun",bq);const Rq=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Aq=we("tag",Rq);const Pq=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],W0=we("thermometer",Pq);const kq=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],aE=we("trending-down",kq);const Nq=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],lE=we("trending-up",Nq);const Dq=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],aR=we("triangle-alert",Dq);const Mq=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Lq=we("type",Mq);const Oq=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],jq=we("user",Oq);const Fq=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],ju=we("waves",Fq);const Vq=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],of=we("wind",Vq);const zq=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],zn=we("x",zq),uM=200,Uq=.7;async function Bq(n,e=uM){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,u=r.height;l>u?l>e&&(u=Math.round(u*e/l),l=e):u>e&&(l=Math.round(l*e/u),u=e),s.width=l,s.height=u,o?.drawImage(r,0,0,l,u),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",Uq)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function Wq(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function hM(n){const e=await Bq(n,uM),t=await Wq(e);return{thumbnailBlob:e,thumbnailBase64:t}}function dM(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function Gq(){const n=Dr(L=>L.map),e=In(L=>L.openCatchForm),[t,i]=q.useState(null),[r,s]=q.useState(!1),[o,l]=q.useState(!1),u=q.useRef(null),h=q.useRef(null);q.useEffect(()=>{if(!n)return;const L=n.getViewport();if(!L)return;const A=600,z=15,P=se=>{if(se.touches.length!==1)return;const pe=se.touches[0];h.current={x:pe.clientX,y:pe.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const J=window.__olMap;if(!J)return;const re=L.getBoundingClientRect(),Y=[h.current.x-re.left,h.current.y-re.top],H=J.getCoordinateFromPixel(Y);if(H){const X=Jx(H);se.preventDefault(),i({pixel:[h.current.x,h.current.y],coordinate:X}),s(!0),l(!1),setTimeout(()=>l(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},A)},b=se=>{if(!u.current||!h.current)return;const pe=se.touches[0],J=pe.clientX-h.current.x,re=pe.clientY-h.current.y;Math.sqrt(J*J+re*re)>z&&(clearTimeout(u.current),u.current=null)},k=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null},F=se=>{r&&se.preventDefault()},V=se=>{se.button===0&&(h.current={x:se.clientX,y:se.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const pe=window.__olMap;if(!pe)return;const J=L.getBoundingClientRect(),re=[h.current.x-J.left,h.current.y-J.top],Y=pe.getCoordinateFromPixel(re);if(Y){const H=Jx(Y);i({pixel:[h.current.x,h.current.y],coordinate:H}),s(!0),l(!1),setTimeout(()=>l(!0),300)}},A))},U=se=>{if(!u.current||!h.current)return;const pe=se.clientX-h.current.x,J=se.clientY-h.current.y;Math.sqrt(pe*pe+J*J)>z&&(clearTimeout(u.current),u.current=null)},O=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null};return L.addEventListener("touchstart",P,{passive:!1}),L.addEventListener("touchmove",b,{passive:!0}),L.addEventListener("touchend",k),L.addEventListener("touchcancel",k),L.addEventListener("contextmenu",F),L.addEventListener("mousedown",V),L.addEventListener("mousemove",U),L.addEventListener("mouseup",O),L.addEventListener("mouseleave",O),()=>{L.removeEventListener("touchstart",P),L.removeEventListener("touchmove",b),L.removeEventListener("touchend",k),L.removeEventListener("touchcancel",k),L.removeEventListener("contextmenu",F),L.removeEventListener("mousedown",V),L.removeEventListener("mousemove",U),L.removeEventListener("mouseup",O),L.removeEventListener("mouseleave",O),u.current&&clearTimeout(u.current)}},[n,r]);const f=()=>{o&&(s(!1),i(null),l(!1))},m=()=>{s(!1),i(null),l(!1)},_=q.useRef(null),v=()=>{if(!t)return;const[L,A]=t.coordinate;e({location:{lat:A,lng:L},locationSource:"map"}),m()},S=()=>{_.current?.click()},I=async L=>{const A=L.target.files?.[0];if(!(!A||!t)){try{const z=await _H(A),{thumbnailBase64:P}=await hM(A),b={id:dM(),thumbnailBase64:P,createdAt:new Date().toISOString(),pendingUpload:!0};if(z)e({location:z,locationSource:"photo",photos:[b]});else{const[k,F]=t.coordinate;e({location:{lat:F,lng:k},locationSource:"map",photos:[b]})}}catch(z){console.error("Failed to process photo:",z);const[P,b]=t.coordinate;e({location:{lat:b,lng:P},locationSource:"map"})}L.target.value="",m()}},T=()=>{if(!t)return;const[L,A]=t.coordinate,z=`https://www.google.com/maps?q=${A},${L}`;window.open(z,"_blank"),m()},R=()=>{if(!t)return;const[L,A]=t.coordinate,z=`https://www.google.com/maps?layer=c&cbll=${A},${L}`;window.open(z,"_blank"),m()},M=L=>{const[A,z]=L;return`${z.toFixed(5)}N, ${A.toFixed(5)}E`},N=()=>{if(!t)return{};const L=220,A=280;let z=t.pixel[0];z+L>window.innerWidth&&(z=window.innerWidth-L-10),z<10&&(z=10);let P=t.pixel[1];const b=window.innerHeight-t.pixel[1],k=t.pixel[1];return b<A&&k>A?P=t.pixel[1]-A+40:b<A&&(P=Math.max(10,window.innerHeight-A-10)),{left:z,top:P}};return g.jsx(dn,{children:r&&t&&g.jsxs(g.Fragment,{children:[g.jsx(je.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),g.jsxs(je.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none max-h-[90vh] overflow-y-auto",style:N(),initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[g.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:g.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[g.jsx(Nr,{size:16}),g.jsx("span",{className:"text-xs font-mono",children:M(t.coordinate)})]})}),g.jsxs("div",{className:"bg-white",children:[g.jsxs("button",{onClick:S,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(rE,{size:20,className:"text-green-500"}),g.jsx("span",{className:"font-medium",children:"Maak foto"})]}),g.jsxs("button",{onClick:v,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(kr,{size:20,className:"text-orange-500"}),g.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),g.jsxs("button",{onClick:R,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(rq,{size:20,className:"text-yellow-600"}),g.jsx("span",{className:"font-medium",children:"Street View"})]}),g.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(sE,{size:20,className:"text-blue-600"}),g.jsx("span",{className:"font-medium",children:"Google Maps"})]})]}),g.jsx("input",{ref:_,type:"file",accept:"image/*",capture:"environment",onChange:I,className:"hidden"}),g.jsx("div",{className:"bg-white border-t border-gray-100",children:g.jsxs("button",{onClick:m,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[g.jsx(zn,{size:18}),g.jsx("span",{children:"Annuleren"})]})})]})]})})}function $q(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=ci(),s=q.useCallback(l=>{i(l)},[i]),o=q.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return q.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function Hq(){const{tracking:n,toggle:e}=$q();return g.jsx(je.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:g.jsx(FK,{size:22,strokeWidth:2})})}const Kq="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function qq(){const n=Dr(_=>_.map),e=ci(_=>_.position),t=ci(_=>_.accuracy),i=ci(_=>_.tracking),r=ci(_=>_.smoothHeading),s=We(_=>_.showAccuracyCircle),o=ci(_=>_.firstFix),l=ci(_=>_.resetFirstFix),u=q.useRef(null),h=q.useRef(null),f=q.useRef(null),m=q.useMemo(()=>_=>new qn({image:new a0({src:Kq,scale:.9,rotation:_,rotateWithView:!1,anchor:[.5,.5]})}),[]);return q.useEffect(()=>{if(!n||!i&&!e)return;const _=aa([5.1214,52.0907]);return u.current=new El({geometry:new la(_)}),u.current.setStyle(m(0)),h.current=new El({geometry:new la(_)}),f.current=new h0({source:new r0({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,m]),q.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const _=aa([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(_),h.current.getGeometry()?.setCoordinates(_),s&&t){const v=n.getView().getResolution()||1,S=Math.min(t/v,80);h.current.setStyle(new qn({image:new to({radius:S,fill:new ki({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new qn({}));if(o&&i){n.getView().setCenter(_),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:_,duration:150})},[n,i,e,t,o,l,s]),q.useEffect(()=>{if(!u.current)return;const _=r!==null?r*Math.PI/180:0;u.current.setStyle(m(_))},[r,m]),null}function Xq(){const n=Dr(A=>A.map),e=We(A=>A.showWeatherWidget),[t,i]=q.useState(!1),[r,s]=q.useState(""),[o,l]=q.useState([]),[u,h]=q.useState(!1),[f,m]=q.useState(!1),_=q.useRef(null),v=q.useRef(null),S=q.useRef();q.useEffect(()=>{t&&_.current&&_.current.focus()},[t]),q.useEffect(()=>{if(!t)return;const A=z=>{v.current&&!v.current.contains(z.target)&&I()};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[t]),q.useEffect(()=>{if(!t)return;const A=z=>{z.key==="Escape"&&I()};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[t]),q.useEffect(()=>{if(S.current&&clearTimeout(S.current),r.length<2){l([]);return}return S.current=window.setTimeout(async()=>{m(!0);try{const z=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();z.response?.docs&&l(z.response.docs)}catch(A){console.error("Search error:",A),l([])}finally{m(!1)}},300),()=>{S.current&&clearTimeout(S.current)}},[r]);const I=()=>{i(!1),s(""),l([]),h(!1)},T=async A=>{try{const P=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(A)}`)).json();if(P.response?.docs?.[0]?.centroide_ll){const k=P.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(k)return{lng:parseFloat(k[1]),lat:parseFloat(k[2])}}}catch(z){console.error("Lookup error:",z)}return null},R=async A=>{if(!n)return;const z=await T(A.id);z&&n.getView().animate({center:aa([z.lng,z.lat]),zoom:16,duration:1e3}),I()},M=async(A,z)=>{z.stopPropagation();const P=await T(A.id);if(P){const b=`https://www.google.com/maps?q=${P.lat},${P.lng}`;window.open(b,"_blank")}I()},N={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};if(!t)return g.jsx(je.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:N,onClick:()=>i(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:g.jsx(Kv,{size:22,className:"text-gray-600"})});const L=e?"left-[185px]":"left-2";return g.jsxs("div",{ref:v,className:`fixed ${L} right-14 z-[850]`,style:N,children:[g.jsxs(je.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[g.jsx(Kv,{size:18,className:"search-icon"}),g.jsx("input",{ref:_,type:"text",value:r,onChange:A=>{s(A.target.value),h(!0)},onFocus:()=>h(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),g.jsx("button",{onClick:I,className:"search-clear",title:"Sluiten",children:g.jsx(zn,{size:18})})]}),g.jsx(dn,{children:u&&o.length>0&&g.jsx(je.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:o.map(A=>g.jsxs("li",{className:"search-result-item",children:[g.jsx("div",{className:"search-result-content",onClick:()=>R(A),children:g.jsx("span",{className:"search-result-text",children:A.weergavenaam})}),g.jsx("button",{className:"search-navigate-btn",onClick:z=>M(A,z),title:"Open in Google Maps",children:g.jsx(sE,{size:20})})]},A.id))})}),u&&f&&g.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function Yq({size:n=18}){return g.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[g.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),g.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),g.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),g.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function Zq(){const[n,e]=q.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=In(),{user:r,loading:s,signInWithGoogle:o,logout:l}=nM(),u=We(T=>T.showCatchButton),h=We(T=>T.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},m=()=>e(!1),_=()=>{m(),t()},v=()=>{m(),i()},S=()=>{m(),o()},I=()=>{m(),l()};return g.jsxs(g.Fragment,{children:[g.jsx(je.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-orange-500 hover:bg-orange-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?g.jsx(zn,{size:22,className:"text-white"}):g.jsx(HK,{size:22,className:"text-gray-600"})}),g.jsx(dn,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(je.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),g.jsxs(je.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[g.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-orange-500",children:g.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?g.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:g.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-orange-500 rounded-full animate-spin"})}):r?g.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:g.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?g.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):g.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:g.jsx(jq,{size:16,className:"text-white"})}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),g.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),g.jsx("button",{onClick:I,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:g.jsx(BK,{size:16})})]})}):g.jsxs("button",{onClick:S,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[g.jsx(Yq,{size:18}),g.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),g.jsx("div",{className:"py-1",children:g.jsxs("button",{onClick:_,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[g.jsx(lM,{size:18,className:"text-blue-500"}),g.jsx("span",{children:"Info & handleiding"})]})}),g.jsx("div",{className:"py-1 border-t border-gray-100",children:g.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(kr,{size:18,className:"text-green-500"}),g.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),g.jsx("button",{onClick:()=>h(!u),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${u?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:g.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${u?"left-[22px]":"left-0.5"}`})})]})}),g.jsx("div",{className:"mt-auto border-t border-gray-100",children:g.jsxs("button",{onClick:v,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[g.jsx(vq,{size:18,className:"text-gray-500"}),g.jsx("span",{children:"Instellingen"})]})}),g.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.5"})]})]})})]})}function Qq(){const{infoPanelOpen:n,toggleInfoPanel:e}=In(),[t,i]=q.useState("info"),r=[{id:"info",label:"Info",icon:g.jsx(lM,{size:14})},{id:"functies",label:"Functies",icon:g.jsx(bK,{size:14})},{id:"handleiding",label:"Handleiding",icon:g.jsx(ZH,{size:14})}];return g.jsx(dn,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(je.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(je.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600",children:[g.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.5"}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-orange-400/50 hover:bg-orange-400 transition-colors border-0 outline-none",children:g.jsx(zn,{size:18,className:"text-white",strokeWidth:2.5})})]}),g.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>g.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-orange-600 border-b-2 border-orange-600 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&g.jsx(Jq,{}),t==="functies"&&g.jsx(eX,{}),t==="handleiding"&&g.jsx(tX,{}),g.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:g.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.5 - Voor jou en je vismaat"})})]})]})]})})}function Jq(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),g.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),g.jsxs("ul",{className:"space-y-2 text-gray-600",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),g.jsxs("div",{className:"text-gray-600 space-y-2",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function eX(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(jf,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(kr,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Registreer soort, gewicht en lengte"}),g.jsx("li",{children:"Vismethode en aas bijhouden"}),g.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),g.jsx("li",{children:"GPS locatie per vangst"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(Nr,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Markeer je beste visplekken"}),g.jsx("li",{children:"Voeg notities en ratings toe"}),g.jsx("li",{children:"Welke vis zit waar?"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(jl,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Live weergegevens op je locatie"}),g.jsx("li",{children:"Windsnelheid en richting"}),g.jsx("li",{children:"Luchtdruk"}),g.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(Ou,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Live GPS tracking"}),g.jsx("li",{children:"Zoek adressen en plaatsen"}),g.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function tX(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),g.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[g.jsxs("li",{children:["Tik op de ",g.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),g.jsxs("li",{children:["Gebruik het ",g.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),g.jsxs("li",{children:["Tik op de ",g.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[g.jsxs("li",{children:["Gebruik de ",g.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),g.jsxs("li",{children:["Check de ",g.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),g.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),g.jsxs("li",{children:["Markeer succesvolle plekken als ",g.jsx("strong",{children:"favoriet"})]})]})]})]})}const nX=aa([5.1214,52.0907]),iX=8;function rX(){const n=Dr(r=>r.map),e=Zi(r=>r.setLayerVisibility),t=ci(r=>r.stopTracking),i=()=>{t(),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Labels Overlay",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:nX,zoom:iX,rotation:0,duration:500})};return g.jsx(je.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:g.jsx(dq,{size:18,className:"text-gray-600"})})}const sX={Map:jf,Fish:kr,Anchor:rM,Layers:sf,Star:qv},oX={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},aX={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function lX(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=Rz(),[r,s]=q.useState(!1),[o,l]=q.useState(null),[u,h]=q.useState(!1),[f,m]=q.useState(""),_=I=>{e(I),s(!1)},v=(I,T)=>{I.stopPropagation();const{useLayerStore:R}=require("../../store"),M=R.getState().visible,N=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(L=>M[L]);t(T,{layers:N}),l(T),setTimeout(()=>l(null),2e3)},S=()=>{f.trim()&&(i(f.trim()),m(""),h(!1))};return g.jsxs(g.Fragment,{children:[g.jsx(je.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?g.jsx(oM,{size:20,className:"text-orange-600"}):g.jsx(sf,{size:20,className:"text-gray-600"})}),g.jsx(dn,{children:r&&g.jsxs(g.Fragment,{children:[g.jsx(je.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),g.jsxs(je.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[g.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-orange-500 to-orange-600",children:g.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),g.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(I=>{const T=sX[I.icon]||sf,R=oX[I.icon]||"text-blue-600",M=aX[I.icon]||"hover:bg-blue-50",N=o===I.id;return g.jsxs("button",{onClick:()=>_(I.id),className:`w-full h-9 flex items-center gap-2 px-2 ${M} rounded text-left transition-colors border-0 outline-none bg-transparent ${N?"bg-green-50":""}`,children:[g.jsx(T,{size:16,className:`${R} flex-shrink-0`}),g.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:I.name}),N?g.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:g.jsx(Fm,{size:14,className:"text-green-500"})}):g.jsx("span",{onClick:L=>v(L,I.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:g.jsx(pq,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},I.id)})}),g.jsx("div",{className:"border-t border-gray-200 p-2",children:u?g.jsxs("div",{className:"flex gap-1",children:[g.jsx("input",{type:"text",value:f,onChange:I=>m(I.target.value),onKeyDown:I=>{I.key==="Enter"&&S(),I.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-orange-400"}),g.jsx("button",{onClick:S,disabled:!f.trim(),className:"px-2 py-1 bg-orange-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):g.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",children:[g.jsx(lq,{size:14}),g.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const Sd={lat:52.1326,lng:5.2913},cX={0:"Helder",1:"Overwegend helder",2:"Halfbewolkt",3:"Bewolkt",45:"Mist",48:"Rijpmist",51:"Lichte motregen",53:"Motregen",55:"Zware motregen",61:"Lichte regen",63:"Regen",65:"Zware regen",71:"Lichte sneeuw",73:"Sneeuw",75:"Zware sneeuw",80:"Lichte buien",81:"Buien",82:"Zware buien",95:"Onweer",96:"Onweer met hagel",99:"Zwaar onweer"};function fM({code:n,size:e=18}){return n===0?g.jsx(Cq,{size:e,className:"text-yellow-500"}):n>=1&&n<=3?g.jsx(jl,{size:e,className:"text-gray-400"}):n===45||n===48?g.jsx(hK,{size:e,className:"text-gray-400"}):n>=51&&n<=67||n>=80&&n<=82?g.jsx(Of,{size:e,className:"text-blue-500"}):n>=71&&n<=77||n>=85&&n<=86?g.jsx(mK,{size:e,className:"text-cyan-500"}):n>=95?g.jsx(fK,{size:e,className:"text-purple-500"}):g.jsx(jl,{size:e,className:"text-gray-400"})}function uX({degrees:n,size:e=14}){return g.jsx("div",{style:{transform:`rotate(${n+180}deg)`},className:"inline-flex",children:g.jsx(Ou,{size:e,className:"text-blue-500"})})}function hX({size:n=16,className:e=""}){return g.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[g.jsx("path",{d:"M2 12h16"}),g.jsx("path",{d:"M18 12l4-4"}),g.jsx("path",{d:"M18 12l4 4"}),g.jsx("circle",{cx:"3",cy:"12",r:"1.5",fill:"currentColor"}),g.jsx("path",{d:"M6 12l1.5-3"}),g.jsx("path",{d:"M6 12l1.5 3"}),g.jsx("path",{d:"M10 12l1.5-3"}),g.jsx("path",{d:"M10 12l1.5 3"}),g.jsx("path",{d:"M14 12l1.5-2.5"}),g.jsx("path",{d:"M14 12l1.5 2.5"})]})}function af({size:n=16,className:e="",clipPercent:t=100}){const i=`fish-clip-${Math.random().toString(36).substr(2,9)}`;return g.jsxs("svg",{width:n*(t/100),height:n,viewBox:`0 0 ${24*(t/100)} 24`,fill:"currentColor",className:e,style:{overflow:"hidden"},children:[g.jsx("defs",{children:g.jsx("clipPath",{id:i,children:g.jsx("rect",{x:"0",y:"0",width:24*(t/100),height:"24"})})}),g.jsxs("g",{clipPath:`url(#${i})`,children:[g.jsx("ellipse",{cx:"12",cy:"12",rx:"8",ry:"5"}),g.jsx("path",{d:"M3 12L0 7V17L3 12Z"}),g.jsx("circle",{cx:"17",cy:"10.5",r:"1.2",fill:"white"}),g.jsx("circle",{cx:"17.3",cy:"10.5",r:"0.5",fill:"black"}),g.jsx("path",{d:"M10 7L12 4L14 7",fill:"currentColor"}),g.jsx("path",{d:"M11 17L12 19L13 17",fill:"currentColor"})]})]})}function gM({value:n,maxFish:e=3,color:t}){const i=Math.floor(n),r=n%1,s=[];for(let o=0;o<i&&o<e;o++)s.push(g.jsx(af,{size:18,className:t},o));return r>=.5&&i<e&&s.push(g.jsx(af,{size:18,className:t,clipPercent:60},"half")),g.jsx("div",{className:"flex items-center gap-1",children:s.length>0?s:g.jsx(hX,{size:18,className:t})})}function lf(n){const e=29.53058867,t=new Date("2000-01-06T18:14:00Z");return(n.getTime()-t.getTime())/(1e3*60*60*24)%e/e}function pM(n){return n<.03||n>.97?"Nieuwe maan":n<.22?"Wassende sikkel":n<.28?"Eerste kwartier":n<.47?"Wassende maan":n<.53?"Volle maan":n<.72?"Afnemende maan":n<.78?"Laatste kwartier":"Afnemende sikkel"}const dX="https://svs.gsfc.nasa.gov/vis/a000000/a004700/a004720/lroc_color_poles_1k.jpg";function mM({phase:n,size:e=20}){const t=n<=.5?n*2:(1-n)*2,i=n<.5;let r;return n<=.5?r=1-n*4:r=(n-.5)*4-1,r=Math.max(-1,Math.min(1,r)),g.jsxs("div",{className:"relative rounded-full overflow-hidden",style:{width:e,height:e,boxShadow:`0 ${e*.05}px ${e*.15}px rgba(0,0,0,0.4)`},children:[g.jsx("div",{className:"absolute inset-0 rounded-full",style:{backgroundImage:`url(${dX})`,backgroundSize:"cover",backgroundPosition:"center",filter:"contrast(1.1) brightness(1.05)"}}),g.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`
            radial-gradient(circle at 30% 25%, rgba(200,200,190,0.4) 0%, transparent 25%),
            radial-gradient(circle at 70% 60%, rgba(180,180,170,0.3) 0%, transparent 20%),
            radial-gradient(circle at 45% 75%, rgba(160,160,150,0.3) 0%, transparent 15%),
            radial-gradient(circle at 60% 30%, rgba(170,170,160,0.25) 0%, transparent 18%),
            radial-gradient(circle at 25% 55%, rgba(190,190,180,0.2) 0%, transparent 12%),
            linear-gradient(135deg, #d4d4c8 0%, #a8a89c 50%, #8c8c80 100%)
          `,mixBlendMode:"overlay"}}),g.jsxs("svg",{className:"absolute inset-0",viewBox:"0 0 100 100",style:{width:e,height:e},children:[g.jsx("defs",{children:g.jsxs("linearGradient",{id:`moonShadow-${e}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[g.jsx("stop",{offset:"0%",stopColor:"rgba(15,20,35,0.75)"}),g.jsx("stop",{offset:"40%",stopColor:"rgba(15,20,35,0.65)"}),g.jsx("stop",{offset:"100%",stopColor:"rgba(15,20,35,0)"})]})}),n<.03||n>.97?g.jsx("circle",{cx:"50",cy:"50",r:"50",fill:"rgba(15,20,35,0.80)"}):n>.47&&n<.53?null:g.jsx("ellipse",{cx:50+r*50,cy:"50",rx:Math.abs(50*(1-Math.abs(r*.8))),ry:"50",fill:"rgba(15,20,35,0.70)"})]}),t>.1&&g.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none",style:{background:i?`radial-gradient(circle at ${85-r*20}% 50%, rgba(255,255,240,0.15) 0%, transparent 50%)`:`radial-gradient(circle at ${15-r*20}% 50%, rgba(255,255,240,0.15) 0%, transparent 50%)`}})]})}function fX(n){const e=lf(n),t=n.getHours(),i=Math.floor((e*24+12)%24),r=(i+6)%24,s=(i+18)%24,o=(i+12)%24,l=[i,o],u=[r,s];let h=.3;return(e<.1||e>.9||e>.4&&e<.6)&&(h+=.3),l.forEach(f=>{const m=Math.abs(t-f);m<=1||m>=23?h+=.3:(m<=2||m>=22)&&(h+=.15)}),u.forEach(f=>{Math.abs(t-f)<=1&&(h-=.1)}),{activity:Math.max(.1,Math.min(1,h)),besteTijden:l,slechteTijden:u}}function yM(n){return n<.1||n>.9||n>.4&&n<.6?{type:"Springtij",color:"text-green-600"}:n>.2&&n<.3||n>.7&&n<.8?{type:"Doodtij",color:"text-orange-600"}:{type:"Normaal",color:"text-blue-600"}}function _M(n,e){const t=[],i=29.53058867,r=new Date("2000-01-06T18:14:00Z"),s=745;for(let o=0;o<e;o++){const l=new Date(n);l.setDate(l.getDate()+o),l.setHours(0,0,0,0);const h=(l.getTime()-r.getTime())/(1e3*60*60*24)%i/i;let f=h*s*2%1440;for(let m=0;m<4;m++){const _=m%2===0,v=m*(s/2);let S=f+v;const I=Math.floor(S/1440);S=S%1440;const T=Math.floor(S/60),R=Math.floor(S%60),M=new Date(l);M.setDate(M.getDate()+I),M.setHours(T,R,0,0);const N=Math.abs(Math.sin(h*Math.PI*2)),L=_?1.8:.4,A=N*.5;t.push({time:M,height:_?L+A:L-A*.5,type:_?"high":"low"})}}return t.sort((o,l)=>o.time.getTime()-l.time.getTime())}function gX({data:n,showHeader:e=!1}){if(!n||n.length===0)return null;const t=Math.max(...n.map(s=>s.precipitation),.5),i=n.some(s=>s.precipitation>0),r=s=>{const o=new Date(s);return`${o.getHours()}:${o.getMinutes().toString().padStart(2,"0")}`};return g.jsxs("div",{className:"space-y-1",children:[e&&g.jsx("div",{className:"flex items-center justify-between",children:g.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag komende 2 uur"})}),!i&&g.jsx("div",{className:"text-[10px] text-green-600 font-medium text-right",children:"Droog"}),g.jsxs("div",{className:"relative h-10 bg-gray-100 rounded-lg overflow-hidden",children:[g.jsx("div",{className:"absolute inset-0 flex",children:[...Array(8)].map((s,o)=>g.jsx("div",{className:"flex-1 border-r border-gray-200/50"},o))}),g.jsx("div",{className:"absolute inset-0 flex items-end px-0.5",children:n.map((s,o)=>{const l=s.precipitation/t*100,u=s.precipitation>2?"bg-blue-600":s.precipitation>.5?"bg-blue-500":s.precipitation>0?"bg-blue-400":"bg-transparent";return g.jsx("div",{className:"flex-1 mx-px",title:`${r(s.time)}: ${s.precipitation.toFixed(1)} mm`,children:g.jsx("div",{className:`w-full rounded-t transition-all ${u}`,style:{height:`${Math.max(l,s.precipitation>0?8:0)}%`}})},o)})}),g.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-1 text-[8px] text-gray-400",children:[g.jsx("span",{children:"Nu"}),g.jsx("span",{children:"+1u"}),g.jsx("span",{children:"+2u"})]})]}),i&&g.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-gray-500",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-400"}),g.jsx("span",{children:"Licht"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-500"}),g.jsx("span",{children:"Matig"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-600"}),g.jsx("span",{children:"Zwaar"})]})]})]})}function pX({hourly:n}){const e=new Date,t=e.getHours(),i=n.filter(r=>new Date(r.time)>=e).slice(0,8);return i.length===0?null:g.jsxs("div",{className:"space-y-1",children:[g.jsx("div",{className:"text-[10px] text-gray-500",children:"Komende uren"}),g.jsx("div",{className:"flex gap-1 overflow-x-auto py-1 -mx-1 px-1",children:i.map((r,s)=>{const o=new Date(r.time),l=o.getHours()===t;return g.jsxs("div",{className:`flex flex-col items-center p-1.5 rounded-lg min-w-[36px] ${l?"bg-blue-100":"bg-gray-50"}`,children:[g.jsx("span",{className:"text-[9px] text-gray-500",children:l?"Nu":`${o.getHours()}:00`}),g.jsx(fM,{code:r.weatherCode,size:14}),g.jsxs("span",{className:"text-[10px] font-medium",children:[Math.round(r.temperature),""]}),r.precipitationProbability>20&&g.jsxs("span",{className:"text-[8px] text-blue-500",children:[r.precipitationProbability,"%"]})]},r.time)})})]})}const mX=[{name:"Amsterdam",lat:52.3676,lng:4.9041},{name:"Rotterdam",lat:51.9244,lng:4.4777},{name:"Den Haag",lat:52.0705,lng:4.3007},{name:"Utrecht",lat:52.0907,lng:5.1214},{name:"Eindhoven",lat:51.4416,lng:5.4697},{name:"Groningen",lat:53.2194,lng:6.5665},{name:"Tilburg",lat:51.5555,lng:5.0913},{name:"Almere",lat:52.3508,lng:5.2647},{name:"Breda",lat:51.5719,lng:4.7683},{name:"Nijmegen",lat:51.8126,lng:5.8372},{name:"Arnhem",lat:51.9851,lng:5.8987},{name:"Haarlem",lat:52.3874,lng:4.6462},{name:"Enschede",lat:52.2215,lng:6.8937},{name:"Zwolle",lat:52.5168,lng:6.083},{name:"Maastricht",lat:50.8514,lng:5.6909},{name:"Leiden",lat:52.1601,lng:4.497},{name:"Dordrecht",lat:51.8133,lng:4.6901},{name:"Zoetermeer",lat:52.0575,lng:4.4931},{name:"Leeuwarden",lat:53.2012,lng:5.7999},{name:"Den Bosch",lat:51.6978,lng:5.3037}];function yX({hourlyData:n,onClose:e,onLocationChange:t}){const[i,r]=q.useState(new Date),[s,o]=q.useState(""),[l,u]=q.useState(!1),[h,f]=q.useState(null),m=new Date,_=q.useMemo(()=>{const b=new Date(m);return b.setHours(b.getHours(),0,0,0),b},[]),v=q.useMemo(()=>{const b=new Date(_);return b.setHours(b.getHours()+48),b},[_]),S=v.getTime()-_.getTime(),I=(i.getTime()-_.getTime())/S*100,T=n.filter(b=>{const k=new Date(b.time);return k>=_&&k<=v}),R=mX.filter(b=>b.name.toLowerCase().includes(s.toLowerCase())).slice(0,6),M=b=>{const k=new Date;k.setHours(0,0,0,0);const F=new Date(b);F.setHours(0,0,0,0);const V=Math.floor((F.getTime()-k.getTime())/(1440*60*1e3));return V===0?"Vandaag":V===1?"Morgen":V===2?"Overmorgen":b.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},N=b=>`${b.getHours().toString().padStart(2,"0")}:00`,L=T.find(b=>{const k=new Date(b.time);return k.getHours()===i.getHours()&&k.getDate()===i.getDate()}),A=Math.max(...T.map(b=>b.precipitation),1),z=T.some(b=>b.precipitation>0),P=b=>{f(b.name),u(!1),o(""),t&&t(b.lat,b.lng,b.name)};return g.jsx(je.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:g.jsx(je.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:b=>b.stopPropagation(),children:g.jsxs("div",{className:"p-4 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Of,{size:20,className:"text-blue-500"}),g.jsx("span",{className:"font-semibold text-gray-800",children:"Neerslag 48 uur"}),!z&&g.jsx("span",{className:"text-xs text-green-600 font-medium bg-green-50 px-2 py-0.5 rounded-full",children:"Droog"})]}),g.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:g.jsx(zn,{size:16,className:"text-gray-500"})})]}),g.jsxs("div",{className:"relative",children:[g.jsxs("button",{onClick:()=>u(!l),className:"w-full flex items-center gap-2 px-3 py-2 bg-gray-50 hover:bg-gray-100 rounded-xl transition-colors border-0 outline-none text-left",children:[g.jsx(Nr,{size:16,className:"text-gray-400"}),g.jsx("span",{className:"flex-1 text-sm text-gray-700",children:h||"Huidige locatie"}),g.jsx(Kv,{size:14,className:"text-gray-400"})]}),l&&g.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white rounded-xl shadow-lg border border-gray-100 z-10 overflow-hidden",children:[g.jsx("div",{className:"p-2 border-b border-gray-100",children:g.jsx("input",{type:"text",value:s,onChange:b=>o(b.target.value),placeholder:"Zoek plaats...",className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg outline-none focus:ring-2 focus:ring-blue-400",autoFocus:!0})}),g.jsxs("div",{className:"max-h-40 overflow-y-auto",children:[g.jsxs("button",{onClick:()=>{f(null),u(!1),t&&t(Sd.lat,Sd.lng,"Huidige locatie")},className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 border-0 outline-none bg-transparent text-left",children:[g.jsx(Ou,{size:14,className:"text-blue-500"}),g.jsx("span",{className:"text-sm text-gray-700",children:"Huidige locatie"})]}),R.map(b=>g.jsxs("button",{onClick:()=>P(b),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 border-0 outline-none bg-transparent text-left",children:[g.jsx(Nr,{size:14,className:"text-gray-400"}),g.jsx("span",{className:"text-sm text-gray-700",children:b.name})]},b.name))]})]})]}),g.jsxs("div",{className:"bg-blue-50 rounded-xl p-3 flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsx("div",{className:"text-xs text-gray-500",children:M(i)}),g.jsx("div",{className:"text-xl font-bold text-blue-600",children:N(i)})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-2xl font-bold text-blue-600",children:L?`${L.precipitation.toFixed(1)} mm`:"0 mm"}),L&&L.precipitationProbability>0&&g.jsxs("div",{className:"text-xs text-blue-500",children:[L.precipitationProbability,"% kans"]})]})]}),g.jsxs("div",{className:"relative bg-gray-100 rounded-xl p-2 h-28",children:[g.jsx("div",{className:"absolute top-1 left-2 text-[9px] font-medium text-amber-600",children:" Nu"}),g.jsx("div",{className:"absolute inset-2 pt-3 flex items-end gap-px",children:T.map((b,k)=>{const F=b.precipitation/A*100,V=new Date(b.time),U=V.getHours()===i.getHours()&&V.getDate()===i.getDate(),O=k===0,se=b.precipitation>2?"bg-blue-600":b.precipitation>.5?"bg-blue-500":b.precipitation>0?"bg-blue-400":"bg-gray-200";return g.jsx("div",{className:"flex-1 cursor-pointer h-full flex flex-col justify-end",onClick:()=>r(V),children:g.jsx("div",{className:`w-full rounded-t transition-all ${se} ${U?"ring-2 ring-amber-400 ring-offset-1":""} ${O?"ring-1 ring-amber-500":""}`,style:{height:`${Math.max(F,b.precipitation>0?8:3)}%`}})},k)})}),g.jsxs("div",{className:"absolute bottom-0.5 left-2 right-2 flex justify-between text-[8px] text-gray-400",children:[g.jsx("span",{children:"Nu"}),g.jsx("span",{children:"+24u"}),g.jsx("span",{children:"+48u"})]})]}),g.jsxs("div",{className:"space-y-1",children:[g.jsx("input",{type:"range",min:"0",max:"100",value:I,onChange:b=>r(new Date(_.getTime()+parseFloat(b.target.value)/100*S)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),g.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[g.jsx("span",{className:I<5?"text-amber-600 font-medium":"",children:"Nu"}),g.jsxs("span",{children:[M(i)," ",N(i)]}),g.jsx("span",{children:"+48u"})]})]}),g.jsxs("div",{className:"flex items-center justify-center gap-4 text-[10px] text-gray-400",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-400"}),g.jsx("span",{children:"Licht"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-500"}),g.jsx("span",{children:"Matig"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-600"}),g.jsx("span",{children:"Zwaar"})]})]})]})})})}function lR(n,e=52.1){const t=Math.floor((n.getTime()-new Date(n.getFullYear(),0,0).getTime())/864e5),i=-23.45*Math.cos(360/365*(t+10)*Math.PI/180),r=Math.acos(-Math.tan(e*Math.PI/180)*Math.tan(i*Math.PI/180))*180/Math.PI,s=12-.1,o=s-r/15,l=s+r/15;return{sunrise:Math.max(0,o),sunset:Math.min(24,l)}}function _X({onClose:n}){const e=ci(H=>H.position),{current:t}=gw(),i=168,r=24,s=[{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664},{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12},{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961}],o=(H,X)=>{let W=s[0],G=1/0;for(const oe of s){const ge=Math.sqrt(Math.pow(oe.lat-H,2)+Math.pow(oe.lng-X,2));ge<G&&(G=ge,W=oe)}return W},[l,u]=q.useState(()=>e?o(e.lat,e.lng):s[0]),[h,f]=q.useState(0),m=q.useMemo(()=>{const H=new Date;return H.setMinutes(0,0,0),H},[]),_=q.useMemo(()=>new Date(m.getTime()+h*60*60*1e3),[m,h]),v=q.useMemo(()=>{const H=new Date(m.getTime()-864e5);return _M(H,10)},[m]),S=q.useMemo(()=>{const H=new Date(_.getTime()+r*60*60*1e3);return v.filter(X=>X.time>=_&&X.time<=H)},[v,_]),I=S.filter(H=>H.type==="low"),T=S.filter(H=>H.type==="high"),R=H=>{if(v.length<2)return 1;let X=v[0],W=v[1];for(let Te=0;Te<v.length-1;Te++)if(v[Te].time<=H&&v[Te+1].time>H){X=v[Te],W=v[Te+1];break}const G=W.time.getTime()-X.time.getTime(),oe=H.getTime()-X.time.getTime(),ge=Math.max(0,Math.min(1,oe/G)),xe=(1-Math.cos(ge*Math.PI))/2;return X.height+(W.height-X.height)*xe},M=q.useMemo(()=>{const H=[];for(let X=0;X<=r;X+=.25){const W=new Date(_.getTime()+X*60*60*1e3);H.push({hour:X,height:R(W)})}return H},[_,v]),N=new Date,L=N>=_&&N<=new Date(_.getTime()+r*60*60*1e3),A=L?(N.getTime()-_.getTime())/(3600*1e3):-1,z=L?R(N):null;v.find(H=>H.time>N);const P=()=>{const H=R(N),X=R(new Date(N.getTime()-600*1e3));return H>X?"rising":"falling"},b=new Date(_.getTime()+r/2*60*60*1e3),k=lf(b),F=Math.round((k<=.5?k*2:(1-k)*2)*100),V=k>.5;lR(_,l.lat);const U=[2.4,2,1.6,1.2,.8,.4,0],O=2.4,se=H=>H.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"}),pe=()=>{const H=new Date(_.getTime()+r*60*60*1e3),X=_.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric",month:"short"}),W=H.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric",month:"short"});return X===W?X:`${X} - ${W}`},J=()=>{const H=[];for(let X=0;X<=r;X+=3){const W=new Date(_.getTime()+X*60*60*1e3),G=W.getHours().toString().padStart(2,"0"),oe=W.getHours()===0&&X>0;H.push({hour:X,label:G,isNewDay:oe})}return H},re=t?.weatherCode?t.weatherCode>=3?75:t.weatherCode>=2?50:t.weatherCode>=1?25:0:0,Y=H=>{const X=Math.floor(H/24);return X===0?"Nu":X===1?"+1 dag":`+${X} dagen`};return g.jsx(je.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:g.jsxs(je.div,{className:"bg-white w-full max-w-md mx-4 rounded-2xl overflow-hidden shadow-2xl select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:H=>H.stopPropagation(),children:[g.jsx("div",{className:"bg-[#3b82f6] px-4 py-3",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("select",{value:l.id,onChange:H=>{const X=s.find(W=>W.id===H.target.value);X&&u(X)},className:"bg-transparent text-white font-semibold text-lg border-0 outline-none cursor-pointer appearance-none",style:{backgroundImage:"none"},children:s.map(H=>g.jsx("option",{value:H.id,className:"text-gray-800",children:H.name},H.id))}),g.jsx("button",{onClick:n,className:"p-1 hover:bg-white/20 rounded-full transition-colors border-0 outline-none bg-transparent",children:g.jsx(zn,{size:20,className:"text-white"})})]})}),g.jsxs("div",{className:"bg-[#3b82f6] px-4 pb-4 flex items-center justify-between",children:[g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx(mM,{phase:k,size:40}),g.jsxs("span",{className:"text-white/90 text-[10px] mt-1",children:[F,"% ",V?"Afnemend":"Wassend"]})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-white text-lg font-semibold",children:pe()}),g.jsx("div",{className:"text-white/80 text-sm",children:Y(h)})]}),g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx(jl,{size:32,className:"text-white"}),g.jsxs("span",{className:"text-white/90 text-[10px] mt-1",children:[re,"%"]})]})]}),g.jsxs("div",{className:"relative bg-white",style:{height:260},children:[(()=>{const H=[];for(let X=0;X<2;X++){const W=new Date(_);W.setHours(0,0,0,0),W.setDate(W.getDate()+X);const G=lR(W,l.lat),oe=(W.getTime()-_.getTime())/(3600*1e3),ge=oe+G.sunrise,xe=oe+G.sunset;if(xe>0&&ge<r){const Te=Math.max(0,ge/r*100),Me=Math.min(100,xe/r*100);H.push(g.jsx("div",{className:"absolute top-0 bottom-8 bg-[#f5f5dc]/60",style:{left:`calc(40px + ${Te}% * (100% - 40px) / 100)`,width:`${Me-Te}%`}},X))}}return H})(),U.map((H,X)=>g.jsxs("div",{className:"absolute left-0 right-0 flex items-center",style:{top:`${X/(U.length-1)*228}px`},children:[g.jsxs("span",{className:"text-gray-500 text-xs w-10 text-right pr-2",children:[H," m"]}),g.jsx("div",{className:"flex-1 border-t border-gray-200"})]},H)),g.jsxs("svg",{className:"absolute left-10 right-0 top-0",style:{height:228},viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[(()=>{const H=[];for(let X=0;X<=r;X++)new Date(_.getTime()+X*60*60*1e3).getHours()===0&&X>0&&X<r&&H.push(g.jsx("line",{x1:X/r*100,y1:"0",x2:X/r*100,y2:"100",stroke:"#94a3b8",strokeWidth:"0.3",strokeDasharray:"2,2"},X));return H})(),g.jsx("path",{d:`M ${M.map(H=>`${H.hour/r*100} ${100-H.height/O*100}`).join(" L ")}`,fill:"none",stroke:"#1e3a5f",strokeWidth:"0.8"}),S.map((H,X)=>{const W=(H.time.getTime()-_.getTime())/36e5;return W<0||W>r?null:g.jsx("circle",{cx:W/r*100,cy:100-H.height/O*100,r:"1.5",fill:H.type==="high"?"#3b82f6":"#1e3a5f"},X)}),L&&A>=0&&A<=r&&g.jsx("line",{x1:A/r*100,y1:"0",x2:A/r*100,y2:"100",stroke:"#ef4444",strokeWidth:"0.5"})]}),L&&z!==null&&g.jsxs("div",{className:"absolute bg-white border border-gray-300 rounded px-2 py-0.5 text-sm font-medium text-red-500 shadow-sm z-10",style:{left:`calc(40px + ${A/r*100}% * (100% - 40px) / 100 - 30px)`,top:4},children:[z.toFixed(2)," m",P()==="rising"?"":""]}),g.jsx("div",{className:"absolute top-2 right-2 text-gray-400 text-xs",children:"LAT"}),g.jsx("div",{className:"absolute bottom-0 left-10 right-0 flex justify-between px-1 text-xs text-gray-500",style:{height:24},children:J().map((H,X)=>g.jsxs("div",{className:"flex flex-col items-center",style:{width:`${100/9}%`},children:[g.jsx("span",{className:H.isNewDay?"text-blue-500 font-medium":"",children:H.label}),H.isNewDay&&g.jsx("span",{className:"text-[8px] text-blue-400",children:""})]},X))})]}),g.jsxs("div",{className:"bg-gray-100 px-4 py-3",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[g.jsx(ju,{size:14,className:"text-blue-500"}),g.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Tijdlijn (7 dagen)"}),g.jsx("button",{onClick:()=>f(0),className:"ml-auto text-xs text-blue-500 hover:text-blue-700 border-0 bg-transparent cursor-pointer",children:"Nu"})]}),g.jsx("input",{type:"range",min:"0",max:i-r,value:h,onChange:H=>f(parseInt(H.target.value)),className:"w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer accent-blue-500"}),g.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400 mt-1",children:[g.jsx("span",{children:"Nu"}),g.jsx("span",{children:"+3 dagen"}),g.jsx("span",{children:"+7 dagen"})]})]}),g.jsxs("div",{className:"bg-[#1e3a5f] px-4 py-3 flex",children:[g.jsxs("div",{className:"flex-1",children:[g.jsx("div",{className:"text-white font-semibold text-sm mb-1",children:"Laagwater:"}),I.length>0?I.slice(0,3).map((H,X)=>g.jsxs("div",{className:"text-white/90 text-xs",children:[H.height.toFixed(1),"m @ ",se(H.time)," ",H.time.getDate()!==_.getDate()&&g.jsxs("span",{className:"text-white/60",children:["(",H.time.toLocaleDateString("nl-NL",{weekday:"short"}),")"]})]},X)):g.jsx("div",{className:"text-white/60 text-sm",children:"-"})]}),g.jsxs("div",{className:"flex-1 text-right",children:[g.jsx("div",{className:"text-white font-semibold text-sm mb-1",children:"Hoogwater:"}),T.length>0?T.slice(0,3).map((H,X)=>g.jsxs("div",{className:"text-white/90 text-xs",children:[H.height.toFixed(1),"m @ ",se(H.time)," ",H.time.getDate()!==_.getDate()&&g.jsxs("span",{className:"text-white/60",children:["(",H.time.toLocaleDateString("nl-NL",{weekday:"short"}),")"]})]},X)):g.jsx("div",{className:"text-white/60 text-sm",children:"-"})]})]}),g.jsxs("div",{className:"bg-[#1e3a5f] px-4 pb-3 flex gap-2",children:[g.jsx("button",{onClick:()=>f(0),className:`flex-1 py-1.5 text-xs ${h===0?"bg-white/30":"bg-white/10 hover:bg-white/20"} text-white rounded transition-colors border-0`,children:"Nu"}),g.jsx("button",{onClick:()=>f(24),className:`flex-1 py-1.5 text-xs ${h===24?"bg-white/30":"bg-white/10 hover:bg-white/20"} text-white rounded transition-colors border-0`,children:"+1 dag"}),g.jsx("button",{onClick:()=>f(48),className:`flex-1 py-1.5 text-xs ${h===48?"bg-white/30":"bg-white/10 hover:bg-white/20"} text-white rounded transition-colors border-0`,children:"+2 dagen"}),g.jsx("button",{onClick:()=>f(72),className:`flex-1 py-1.5 text-xs ${h===72?"bg-white/30":"bg-white/10 hover:bg-white/20"} text-white rounded transition-colors border-0`,children:"+3 dagen"})]})]})})}function xX({pressureHistory:n,currentPressure:e,trend:t,onClose:i}){const[r,s]=q.useState(12),o=new Date,l=n.slice(-72),u=Math.min(...l.map(T=>T.pressure),990),h=Math.max(...l.map(T=>T.pressure),1040),f=h-u||20,m=T=>{if(T>=l.length-1||T<1)return .5;const R=l[T].pressure-l[T-1].pressure,M=l[T].pressure;let N=.5;return R>.5?N+=.3:R<-.5&&(N-=.2),M>=1010&&M<=1025&&(N+=.2),M>1020&&Math.abs(R)<.3&&(N+=.2),Math.max(0,Math.min(1,N))},v=[...l.map((T,R)=>({hour:R,activity:m(R)}))].sort((T,R)=>R.activity-T.activity).slice(0,5),S=()=>t==="rising"?g.jsx(lE,{size:16,className:"text-green-500"}):t==="falling"?g.jsx(aE,{size:16,className:"text-red-500"}):g.jsx(oE,{size:16,className:"text-gray-400"}),I=()=>t==="rising"?"Stijgend - Goed voor vissen!":t==="falling"?"Dalend - Minder activiteit":"Stabiel";return g.jsx(je.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i,children:g.jsx(je.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:T=>T.stopPropagation(),children:g.jsxs("div",{className:"p-4 space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(rf,{size:20,className:"text-purple-500"}),g.jsx("span",{className:"font-semibold text-gray-800",children:"Luchtdruk"})]}),g.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:g.jsx(zn,{size:16,className:"text-gray-500"})})]}),g.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-4",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{children:[g.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[Math.round(e)," hPa"]}),g.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[S(),g.jsx("span",{className:"text-sm text-gray-600",children:I()})]})]}),g.jsxs("div",{className:"text-right",children:[g.jsx(gM,{value:m(l.length-1)*3,color:m(l.length-1)>.7?"text-green-500":m(l.length-1)>.4?"text-amber-500":"text-red-500"}),g.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:"Nu"})]})]})}),g.jsxs("div",{className:"space-y-1",children:[g.jsx("div",{className:"text-[10px] text-gray-500",children:"Druk & visactiviteit (48 uur)"}),g.jsxs("div",{className:"relative bg-gray-100 rounded-xl p-2 h-32",children:[g.jsxs("svg",{className:"absolute inset-2 w-[calc(100%-16px)] h-[calc(100%-16px)]",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[l.slice(-48).map((T,R)=>{const M=m(l.length-48+R),N=R/47*100,L=M*30,A=M>.7?"#22c55e":M>.4?"#f59e0b":"#ef4444";return g.jsx("rect",{x:N-1,y:100-L,width:2,height:L,fill:A,opacity:"0.3"},R)}),g.jsx("path",{d:`M ${l.slice(-48).map((T,R)=>{const M=R/47*100,N=100-(T.pressure-u)/f*80;return`${M} ${N}`}).join(" L ")}`,fill:"none",stroke:"#8b5cf6",strokeWidth:"2"}),g.jsx("rect",{x:"0",y:100-(1025-u)/f*80,width:"100",height:15/f*80,fill:"#22c55e",opacity:"0.1"})]}),g.jsx("div",{className:"absolute top-1 left-2 text-[9px] text-gray-400",children:Math.round(h)}),g.jsx("div",{className:"absolute bottom-4 left-2 text-[9px] text-gray-400",children:Math.round(u)}),g.jsxs("div",{className:"absolute bottom-0.5 left-2 right-2 flex justify-between text-[8px] text-gray-400",children:[g.jsx("span",{children:"-48u"}),g.jsx("span",{children:"-24u"}),g.jsx("span",{children:"Nu"})]})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"text-[10px] text-gray-500 flex items-center gap-1",children:[g.jsx(af,{size:12,className:"text-green-500"}),"Beste vistijden (op basis van druk)"]}),g.jsx("div",{className:"flex flex-wrap gap-1",children:v.slice(0,4).map((T,R)=>{const M=new Date(l[T.hour]?.time||o),N=M.getDate()===o.getDate();return g.jsxs("div",{className:"bg-green-50 rounded-lg px-2 py-1 text-xs",children:[g.jsxs("span",{className:"text-green-700 font-medium",children:[N?"Vandaag":"Morgen"," ",M.getHours(),":00"]}),g.jsxs("span",{className:"text-green-500 ml-1",children:[Math.round(T.activity*100),"%"]})]},R)})})]}),g.jsxs("div",{className:"flex items-center justify-center gap-4 text-[10px] text-gray-400",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-3 h-1.5 rounded-sm bg-green-400 opacity-50"}),g.jsx("span",{children:"Actief"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-3 h-1.5 rounded-sm bg-amber-400 opacity-50"}),g.jsx("span",{children:"Matig"})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("div",{className:"w-8 h-3 rounded-sm bg-green-500 opacity-20"}),g.jsx("span",{children:"Optimale zone"})]})]})]})})})}function vX({current:n,pressureHistory:e,pressureTrend:t,moonActivity:i,combinedScore:r,onClose:s}){const[o,l]=q.useState(0),u=lf(new Date),h=pM(u),f=yM(u),m=()=>n.windSpeed<15?{score:2,label:"Uitstekend",color:"text-green-500",desc:"Lichte wind, ideaal"}:n.windSpeed<25?{score:1,label:"Goed",color:"text-lime-500",desc:"Matige wind"}:{score:-1,label:"Slecht",color:"text-red-500",desc:"Te veel wind"},_=()=>{let re=0,Y=[];n.pressure>1020?(re=2,Y.push("Hoge druk")):n.pressure>1013?(re=1,Y.push("Normale druk")):(re=0,Y.push("Lage druk")),t==="rising"?(re+=1,Y.push("stijgend")):t==="falling"?(re-=1,Y.push("dalend")):Y.push("stabiel");const H=re>=2?"Uitstekend":re>=1?"Goed":re>=0?"Matig":"Slecht",X=re>=2?"text-green-500":re>=1?"text-lime-500":re>=0?"text-amber-500":"text-red-500";return{score:Math.max(0,re),label:H,color:X,desc:Y.join(", ")}},v=()=>n.temperature>=10&&n.temperature<=20?{score:2,label:"Ideaal",color:"text-green-500",desc:"10-20C is perfect"}:n.temperature>=5&&n.temperature<=25?{score:1,label:"Goed",color:"text-lime-500",desc:"Acceptabel bereik"}:{score:0,label:"Matig",color:"text-amber-500",desc:"Buiten ideaal bereik"},S=()=>n.weatherCode<50?{score:1,label:"Droog",color:"text-green-500",desc:"Geen neerslag"}:{score:0,label:"Nat",color:"text-amber-500",desc:"Neerslag verwacht"},I=()=>{const re=i.activity;return re>=.7?{score:3,label:"Zeer actief",color:"text-green-500"}:re>=.5?{score:2,label:"Actief",color:"text-lime-500"}:re>=.3?{score:1,label:"Matig",color:"text-amber-500"}:{score:0,label:"Rustig",color:"text-red-400"}},T=m(),R=_(),M=v(),N=S(),L=I(),A=new Date,z=e.findIndex(re=>new Date(re.time)>=A),P=z===-1?e.length-1:Math.max(0,z-1),k=96/2,F=P+o,V=Math.max(0,F-k),U=Math.min(e.length,F+k),O=e.slice(V,U),se=P-V;Math.max(0,e.length-P-k);const pe=re=>re>=2.5?"text-green-500":re>=1.5?"text-lime-500":re>=.8?"text-amber-500":"text-red-500",J=re=>re>=2.5?"from-green-500 to-emerald-600":re>=1.5?"from-lime-500 to-green-600":re>=.8?"from-amber-500 to-orange-600":"from-red-500 to-rose-600";return g.jsx(je.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s,children:g.jsx(je.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm max-h-[90vh] overflow-y-auto select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:re=>re.stopPropagation(),children:g.jsxs("div",{className:"p-4 space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${J(r)} flex items-center justify-center shadow-lg`,children:g.jsx(af,{size:28,className:"text-white"})}),g.jsxs("div",{children:[g.jsx("div",{className:"text-lg font-bold text-gray-800",children:"Visscore"}),g.jsx("div",{className:`text-sm font-medium ${pe(r)}`,children:r>=2.5?"Uitstekend":r>=1.5?"Goed":r>=.8?"Matig":"Slecht"})]})]}),g.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:g.jsx(zn,{size:16,className:"text-gray-500"})})]}),g.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 space-y-3",children:[g.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Score opbouw"}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center",children:g.jsx(rf,{size:16,className:"text-purple-500"})}),g.jsxs("div",{className:"flex-1",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-sm text-gray-700",children:"Luchtdruk"}),g.jsx("span",{className:`text-sm font-medium ${R.color}`,children:R.label})]}),g.jsxs("div",{className:"text-[10px] text-gray-500",children:[Math.round(n.pressure)," hPa, ",R.desc]})]})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-8 h-8 rounded-lg bg-indigo-100 flex items-center justify-center",children:g.jsx(XK,{size:16,className:"text-indigo-500"})}),g.jsxs("div",{className:"flex-1",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-sm text-gray-700",children:"Maanfase"}),g.jsx("span",{className:`text-sm font-medium ${L.color}`,children:L.label})]}),g.jsxs("div",{className:"text-[10px] text-gray-500",children:[h," (",f.type,"), ",Math.round(i.activity*100),"% activiteit"]})]})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:g.jsx(of,{size:16,className:"text-blue-500"})}),g.jsxs("div",{className:"flex-1",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-sm text-gray-700",children:"Wind"}),g.jsx("span",{className:`text-sm font-medium ${T.color}`,children:T.label})]}),g.jsxs("div",{className:"text-[10px] text-gray-500",children:[Math.round(n.windSpeed)," km/u, ",T.desc]})]})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-8 h-8 rounded-lg bg-orange-100 flex items-center justify-center",children:g.jsx(W0,{size:16,className:"text-orange-500"})}),g.jsxs("div",{className:"flex-1",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-sm text-gray-700",children:"Temperatuur"}),g.jsx("span",{className:`text-sm font-medium ${M.color}`,children:M.label})]}),g.jsxs("div",{className:"text-[10px] text-gray-500",children:[Math.round(n.temperature),"C, ",M.desc]})]})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-8 h-8 rounded-lg bg-cyan-100 flex items-center justify-center",children:g.jsx(jl,{size:16,className:"text-cyan-500"})}),g.jsxs("div",{className:"flex-1",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-sm text-gray-700",children:"Weer"}),g.jsx("span",{className:`text-sm font-medium ${N.color}`,children:N.label})]}),g.jsx("div",{className:"text-[10px] text-gray-500",children:N.desc})]})]})]}),O.length>0&&g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(rf,{size:14,className:"text-purple-500"}),g.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Luchtdruk verloop"}),g.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[t==="rising"&&g.jsx(lE,{size:12,className:"text-green-500"}),t==="falling"&&g.jsx(aE,{size:12,className:"text-red-500"}),t==="stable"&&g.jsx(oE,{size:12,className:"text-gray-400"}),g.jsx("span",{className:"text-[10px] text-gray-500",children:t==="rising"?"Stijgend":t==="falling"?"Dalend":"Stabiel"})]})]}),g.jsxs("div",{className:"relative bg-gray-100 rounded-xl p-2 h-28",children:[g.jsxs("svg",{className:"absolute inset-2 w-[calc(100%-16px)] h-[calc(100%-24px)]",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[g.jsx("rect",{x:"0",y:"10",width:"100",height:"30",fill:"#22c55e",opacity:"0.1"}),O.length>1&&se>0&&g.jsx("path",{d:`M ${O.slice(0,Math.min(se+1,O.length)).map((re,Y)=>{const H=Y/(O.length-1)*100,X=Math.min(...O.map(oe=>oe.pressure))-3,W=Math.max(...O.map(oe=>oe.pressure))+3,G=100-(re.pressure-X)/(W-X)*100;return`${H} ${G}`}).join(" L ")}`,fill:"none",stroke:"#8b5cf6",strokeWidth:"2.5"}),O.length>1&&se<O.length&&g.jsx("path",{d:`M ${O.slice(Math.max(0,se)).map((re,Y)=>{const X=(Math.max(0,se)+Y)/(O.length-1)*100,W=Math.min(...O.map(ge=>ge.pressure))-3,G=Math.max(...O.map(ge=>ge.pressure))+3,oe=100-(re.pressure-W)/(G-W)*100;return`${X} ${oe}`}).join(" L ")}`,fill:"none",stroke:"#8b5cf6",strokeWidth:"2",strokeDasharray:"4,2",opacity:"0.7"}),se>=0&&se<O.length&&g.jsx("line",{x1:se/(O.length-1)*100,y1:"0",x2:se/(O.length-1)*100,y2:"100",stroke:"#f59e0b",strokeWidth:"2"})]}),se>=0&&se<O.length&&g.jsx("div",{className:"absolute top-1 bg-amber-500 text-white text-[8px] px-1 rounded font-medium",style:{left:`calc(8px + ${se/(O.length-1)*100}% - 10px)`},children:"Nu"}),g.jsxs("div",{className:"absolute bottom-0.5 left-2 right-2 flex justify-between text-[8px] text-gray-400",children:[g.jsx("span",{children:O[0]?new Date(O[0].time).toLocaleDateString("nl-NL",{day:"numeric",month:"short"}):""}),g.jsx("span",{children:O[Math.floor(O.length/2)]?new Date(O[Math.floor(O.length/2)].time).toLocaleDateString("nl-NL",{day:"numeric",month:"short"}):""}),g.jsx("span",{children:O[O.length-1]?new Date(O[O.length-1].time).toLocaleDateString("nl-NL",{day:"numeric",month:"short"}):""})]}),g.jsxs("div",{className:"absolute top-2 right-3 text-[9px] text-purple-600 font-medium",children:[Math.round(Math.max(...O.map(re=>re.pressure)))," hPa"]}),g.jsxs("div",{className:"absolute bottom-5 right-3 text-[9px] text-purple-400",children:[Math.round(Math.min(...O.map(re=>re.pressure)))," hPa"]})]}),g.jsxs("div",{className:"space-y-1",children:[g.jsx("input",{type:"range",min:-P+k,max:e.length-P-k,value:o,onChange:re=>l(parseInt(re.target.value)),className:"w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-purple-500"}),g.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[g.jsx("span",{children:" Verleden"}),g.jsx("span",{className:"text-purple-500 font-medium",children:o===0?"Nu gecentreerd":o>0?`+${o}u vooruit`:`${o}u terug`}),g.jsx("span",{children:"Toekomst "})]})]})]}),g.jsxs("div",{className:"bg-blue-50 rounded-xl p-3 space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(jm,{size:14,className:"text-blue-500"}),g.jsx("span",{className:"text-xs font-medium text-blue-700",children:"Hoe werkt de visscore?"})]}),g.jsxs("div",{className:"text-[11px] text-blue-800 space-y-1.5",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Luchtdruk"})," is de belangrijkste factor. Vissen hebben een zwemblaas die gevoelig is voor drukveranderingen. ",g.jsx("span",{className:"text-green-600",children:"Stijgende druk"})," = actievere vissen. ",g.jsx("span",{className:"text-red-500",children:"Dalende druk"})," = minder activiteit."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Maanfase"})," benvloedt getijden en visgedrag. Rond ",g.jsx("span",{className:"text-green-600",children:"nieuwe en volle maan"})," zijn vissen actiever door sterkere getijstromen."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Wind"})," onder 15 km/u is ideaal. Lichte wind zorgt voor zuurstofrijk water zonder het water te troebel te maken."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Temperatuur"})," tussen 10-20C is optimaal voor de meeste vissoorten in Nederland."]})]})]}),g.jsx("div",{className:"bg-amber-50 rounded-xl p-3",children:g.jsxs("div",{className:"flex items-start gap-2",children:[g.jsx(af,{size:16,className:"text-amber-500 mt-0.5"}),g.jsxs("div",{className:"text-[11px] text-amber-800",children:[g.jsx("strong",{children:"Pro tip:"})," De beste vistijden zijn vaak 1-2 uur voor en na een drukomslag, en rond zonsopgang/zonsondergang tijdens een stijgende luchtdruk."]})]})})]})})})}function wX({onClose:n}){const[e,t]=q.useState(!0),[i,r]=q.useState(0),[s,o]=q.useState([]),l=ci(T=>T.position);q.useEffect(()=>{(async()=>{try{const M=await(await fetch("https://api.rainviewer.com/public/weather-maps.json")).json();if(M.radar?.past){const N=M.radar.past.map(L=>`https://tilecache.rainviewer.com${L.path}/256/{z}/{x}/{y}/2/1_1.png`);M.radar?.nowcast&&N.push(...M.radar.nowcast.map(L=>`https://tilecache.rainviewer.com${L.path}/256/{z}/{x}/{y}/2/1_1.png`)),o(N)}}catch(R){console.error("Failed to fetch radar data:",R)}})()},[]),q.useEffect(()=>{if(!e||s.length===0)return;const T=setInterval(()=>{r(R=>(R+1)%s.length)},500);return()=>clearInterval(T)},[e,s.length]);const u=l?.lat||52.1326,h=l?.lng||5.2913,f=7,m=Math.pow(2,f),_=Math.floor((h+180)/360*m),v=Math.floor((1-Math.log(Math.tan(u*Math.PI/180)+1/Math.cos(u*Math.PI/180))/Math.PI)/2*m),S=()=>s.length===0?null:s[i]?.replace("{z}",f.toString()).replace("{x}",_.toString()).replace("{y}",v.toString()),I=()=>{if(s.length===0)return"Laden...";const R=i-12;return R<-5?`-${Math.abs(R)*5} min`:R<0?`-${Math.abs(R)*5} min`:R===0?"Nu":`+${R*5} min`};return g.jsx(je.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:g.jsx(je.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:T=>T.stopPropagation(),children:g.jsxs("div",{className:"p-4 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Of,{size:20,className:"text-blue-500"}),g.jsx("span",{className:"font-semibold text-gray-800",children:"Buienradar"})]}),g.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:g.jsx(zn,{size:16,className:"text-gray-500"})})]}),g.jsxs("div",{className:"relative bg-gray-200 rounded-xl overflow-hidden",style:{aspectRatio:"1/1"},children:[g.jsx("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-3",children:[-1,0,1].map(T=>[-1,0,1].map(R=>g.jsx("img",{src:`https://tile.openstreetmap.org/${f}/${_+R}/${v+T}.png`,alt:"",className:"w-full h-full object-cover",style:{filter:"saturate(0.3) brightness(1.1)"}},`${R}-${T}`)))}),S()&&g.jsx("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-3",children:[-1,0,1].map(T=>[-1,0,1].map(R=>g.jsx("img",{src:s[i]?.replace("{z}",f.toString()).replace("{x}",(_+R).toString()).replace("{y}",(v+T).toString()),alt:"",className:"w-full h-full object-cover",style:{mixBlendMode:"multiply"}},`radar-${R}-${T}`)))}),g.jsx("div",{className:"absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-sm font-medium",children:I()}),g.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:g.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full border-2 border-white shadow-lg"})})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("input",{type:"range",min:"0",max:Math.max(0,s.length-1),value:i,onChange:T=>{t(!1),r(parseInt(T.target.value))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),g.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[g.jsx("span",{children:"-1 uur"}),g.jsx("span",{children:"Nu"}),g.jsx("span",{children:"+30 min"})]})]}),g.jsx("div",{className:"flex items-center justify-center gap-3",children:g.jsxs("button",{onClick:()=>t(!e),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-xl transition-colors border-0 outline-none",children:[e?g.jsx(nq,{size:16}):g.jsx(oq,{size:16}),g.jsx("span",{className:"text-sm font-medium",children:e?"Pauzeren":"Afspelen"})]})}),g.jsxs("div",{className:"flex items-center justify-center gap-2 text-[10px] text-gray-500",children:[g.jsx("span",{children:"Licht"}),g.jsxs("div",{className:"flex h-2",children:[g.jsx("div",{className:"w-4 bg-blue-200 rounded-l"}),g.jsx("div",{className:"w-4 bg-blue-400"}),g.jsx("div",{className:"w-4 bg-blue-600"}),g.jsx("div",{className:"w-4 bg-purple-600"}),g.jsx("div",{className:"w-4 bg-red-500 rounded-r"})]}),g.jsx("span",{children:"Zwaar"})]})]})})})}const cR=[{id:"lobith",name:"Lobith",river:"Rijn",normalFlow:2300},{id:"borgharen",name:"Borgharen",river:"Maas",normalFlow:250},{id:"tiel",name:"Tiel",river:"Waal",normalFlow:1500},{id:"deventer",name:"Deventer",river:"IJssel",normalFlow:400}];function EX(n){const e=new Date,t=Math.floor((e.getTime()-new Date(e.getFullYear(),0,0).getTime())/(1e3*60*60*24)),i=1+.4*Math.sin((t-100)*Math.PI/182),r=.9+Math.random()*.2;return Math.round(n.normalFlow*i*r)}function TX(){const{current:n,loading:e,fetchWeather:t,getFishingScore:i,pressureHistory:r,getPressureTrend:s,hourlyForecast:o,precipitation15min:l}=gw(),u=ci(le=>le.position),h=We(le=>le.showWeatherWidget),f=We(le=>le.showTideWidget),m=We(le=>le.showBuienradarWidget),_=We(le=>le.showWaterflowWidget),v=We(le=>le.showForecastSlider),S=We(le=>le.showWaterDataWidget),{waterData:I,station:T,fetchData:R}=eR(),[M,N]=q.useState(!1),[L,A]=q.useState(!1),[z,P]=q.useState(!1),[b,k]=q.useState(0),[F,V]=q.useState(!1),[U,O]=q.useState(!1),[se,pe]=q.useState(!1),[J,re]=q.useState(new Map);q.useEffect(()=>{const le=new Map;cR.forEach(Re=>le.set(Re.id,EX(Re))),re(le)},[]),q.useEffect(()=>{const le=u||Sd;t(le.lat,le.lng),R()},[]),q.useEffect(()=>{u&&t(u.lat,u.lng)},[u,t]),q.useEffect(()=>{const le=u||Sd,Re=setInterval(()=>{t(le.lat,le.lng),R()},600*1e3);return()=>clearInterval(Re)},[u,t,R]);const Y=new Date;lf(Y);const H=fX(Y),W=q.useMemo(()=>{const le=new Date;return le.setHours(0,0,0,0),_M(le,2)},[]).filter(le=>le.time>Y).slice(0,4),G=i?i():1,oe=Math.min(3,G/2+H.activity*1.5),ge=le=>le>=2.5?"text-green-500":le>=1.5?"text-lime-500":le>=.8?"text-amber-500":"text-red-500",xe=le=>le>=2.5?"Uitstekend":le>=1.5?"Goed":le>=.8?"Matig":"Slecht",Te=le=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(le/45)%8],Me=le=>le.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return h?g.jsxs(g.Fragment,{children:[M&&g.jsx("div",{className:"fixed inset-0 z-[1499]",onClick:()=>N(!1)}),g.jsxs(je.div,{className:"fixed left-2 z-[1500] bg-white shadow-lg border border-gray-200 select-none rounded-xl",style:M?{top:"0.5rem",width:"220px",maxHeight:"calc(100vh - 1rem)",overflowY:"auto"}:{top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[e&&!n?g.jsxs("div",{className:"p-3 flex items-center gap-2",children:[g.jsx(uq,{size:16,className:"animate-spin text-blue-500"}),g.jsx("span",{className:"text-sm text-gray-500",children:"Laden..."})]}):n?g.jsxs("div",{className:"p-2.5",children:[g.jsx("button",{onClick:()=>N(!M),className:"w-full border-0 outline-none bg-transparent p-0",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(fM,{code:n.weatherCode,size:24}),g.jsx("div",{className:"flex flex-col leading-tight",children:g.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[Math.round(n.temperature),""]})})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx(of,{size:14,className:"text-gray-400"}),g.jsx("span",{className:"text-sm text-gray-600",children:Math.round(n.windSpeed)}),g.jsx(uX,{degrees:n.windDirection,size:12})]}),g.jsx("div",{className:"ml-auto",children:M?g.jsx(oM,{size:16,className:"text-gray-400"}):g.jsx(sM,{size:16,className:"text-gray-400"})})]})}),g.jsxs("div",{className:"flex items-center gap-2 mt-1.5 pt-1.5 border-t border-gray-200/50 cursor-pointer hover:bg-gray-50 rounded-lg p-1 -m-1 transition-colors",onClick:le=>{le.stopPropagation(),pe(!0)},children:[g.jsx(gM,{value:oe,color:ge(oe)}),g.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:g.jsx("div",{className:`h-full transition-all ${oe>=2.5?"bg-green-500":oe>=1.5?"bg-lime-500":oe>=.8?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.max(oe/3*100,5)}%`}})}),g.jsx("span",{className:`text-[10px] font-medium ${ge(oe)}`,children:xe(oe)}),g.jsx(Kc,{size:12,className:"text-gray-400"})]}),g.jsx(dn,{children:M&&g.jsx(je.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:g.jsxs("div",{className:"pt-3 mt-2 border-t border-gray-200/50 space-y-3",children:[g.jsx("div",{className:"text-xs text-gray-600",children:cX[n.weatherCode]||"Onbekend"}),(()=>{const le=new Date;le.setDate(le.getDate()+b);const Re=lf(le),He=yM(Re),Wt=b===0?"Vandaag":b===1?"Morgen":b===-1?"Gisteren":le.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric",month:"short"});return g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-3",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(mM,{phase:Re,size:40}),g.jsxs("div",{className:"flex-1",children:[g.jsx("div",{className:"text-gray-800 text-sm font-medium",children:pM(Re)}),g.jsxs("div",{className:"text-gray-500 text-[10px]",children:[Math.round(Re*100),"% verlicht"]}),g.jsx("div",{className:`text-[10px] font-medium ${He.color}`,children:He.type})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-xs text-gray-600",children:Wt}),b!==0&&g.jsx("button",{onClick:()=>k(0),className:"text-[10px] text-blue-500 hover:underline border-0 bg-transparent p-0 outline-none",children:"Vandaag"})]})]}),g.jsxs("div",{className:"space-y-1",children:[g.jsx("input",{type:"range",min:"-14",max:"14",value:b,onChange:sr=>k(parseInt(sr.target.value)),className:"w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),g.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[g.jsx("span",{children:"-14d"}),g.jsx("span",{children:"Nu"}),g.jsx("span",{children:"+14d"})]})]})]})})(),g.jsxs("div",{className:"space-y-1",children:[g.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[g.jsx("span",{className:"text-gray-500",children:"Maanactiviteit"}),g.jsxs("span",{className:"text-gray-600",children:[Math.round(H.activity*100),"%"]})]}),g.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:g.jsx("div",{className:`h-full transition-all ${H.activity>=.7?"bg-green-500":H.activity>=.5?"bg-lime-500":H.activity>=.3?"bg-amber-500":"bg-red-400"}`,style:{width:`${H.activity*100}%`}})})]}),S&&g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(B0,{size:14,className:"text-cyan-500"}),g.jsx("select",{value:T?.id||"",onChange:le=>{le.stopPropagation();const Re=nf.find(He=>He.id===le.target.value);if(Re){const{setStation:He,fetchData:Wt}=eR.getState();He(Re),setTimeout(()=>Wt(),50)}},className:"flex-1 px-2 py-1 text-xs border border-gray-200 rounded-lg bg-white/80 outline-none focus:ring-1 focus:ring-cyan-400",children:nf.map(le=>g.jsx("option",{value:le.id,children:le.name},le.id))})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[I?.temperature!==void 0&&g.jsxs("div",{className:"bg-cyan-50 rounded-lg p-2",children:[g.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[g.jsx(W0,{size:12,className:"text-cyan-500"}),g.jsx("span",{children:"Water"})]}),g.jsxs("div",{className:"text-sm font-bold text-cyan-600",children:[I.temperature.toFixed(1),"C"]})]}),I?.waveHeight!==void 0&&g.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[g.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[g.jsx(ju,{size:12,className:"text-blue-500"}),g.jsx("span",{children:"Golven"})]}),g.jsxs("div",{className:"text-sm font-bold text-blue-600",children:[I.waveHeight," cm"]})]}),I?.currentSpeed!==void 0&&g.jsxs("div",{className:"bg-green-50 rounded-lg p-2",children:[g.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[g.jsx(Ou,{size:12,className:"text-green-500"}),g.jsx("span",{children:"Stroming"})]}),g.jsxs("div",{className:"text-sm font-bold text-green-600",children:[I.currentSpeed," cm/s"]})]}),I?.currentDirection!==void 0&&g.jsxs("div",{className:"bg-purple-50 rounded-lg p-2",children:[g.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[g.jsx(Ou,{size:12,className:"text-purple-500",style:{transform:`rotate(${I.currentDirection}deg)`}}),g.jsx("span",{children:"Richting"})]}),g.jsxs("div",{className:"text-sm font-bold text-purple-600",children:[Math.round(I.currentDirection),""]})]})]})]}),_&&g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-500",children:[g.jsx(jm,{size:14,className:"text-cyan-600"}),g.jsx("span",{className:"font-medium",children:"Waterafvoer rivieren"})]}),g.jsx("div",{className:"grid grid-cols-2 gap-2",children:cR.map(le=>{const Re=J.get(le.id)||0,He=Re/le.normalFlow,Wt=He<.7?{text:"Laag",color:"text-orange-500",bg:"bg-orange-50"}:He>1.3?{text:"Hoog",color:"text-blue-600",bg:"bg-blue-50"}:{text:"Normaal",color:"text-green-500",bg:"bg-green-50"};return g.jsxs("div",{className:`${Wt.bg} rounded-lg p-2`,children:[g.jsx("div",{className:"text-[10px] text-gray-500",children:le.river}),g.jsxs("div",{className:`text-sm font-bold ${Wt.color}`,children:[Re.toLocaleString()," m/s"]}),g.jsx("div",{className:`text-[9px] ${Wt.color}`,children:Wt.text})]},le.id)})})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[g.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600",children:[g.jsx(of,{size:12,className:"text-gray-400"}),g.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",Te(n.windDirection)]})]}),g.jsxs("button",{onClick:()=>V(!0),className:"flex items-center gap-1.5 text-gray-600 hover:bg-purple-50 rounded-lg p-1 -m-1 transition-colors border-0 bg-transparent cursor-pointer",children:[g.jsx(rf,{size:12,className:"text-purple-500"}),g.jsxs("span",{children:[Math.round(n.pressure)," hPa"]}),(()=>{const le=s();return le==="rising"?g.jsx(lE,{size:12,className:"text-green-500"}):le==="falling"?g.jsx(aE,{size:12,className:"text-red-500"}):g.jsx(oE,{size:12,className:"text-gray-400"})})(),g.jsx(Kc,{size:10,className:"text-gray-400 ml-auto"})]})]}),m&&g.jsxs(g.Fragment,{children:[g.jsxs("button",{onClick:()=>O(!0),className:"w-full flex items-center gap-2 p-2 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors border-0 cursor-pointer",children:[g.jsx(Of,{size:16,className:"text-blue-500"}),g.jsx("span",{className:"text-sm text-blue-700 font-medium",children:"Buienradar"}),g.jsx("span",{className:"text-xs text-blue-500 ml-auto",children:"Live kaart"}),g.jsx(Kc,{size:14,className:"text-blue-400"})]}),l.length>0&&g.jsx("button",{onClick:()=>P(!0),className:"w-full border-0 bg-transparent p-0 cursor-pointer text-left",children:g.jsxs("div",{className:"hover:bg-gray-50 rounded-lg p-1 -m-1 transition-colors",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag komende 2 uur"}),g.jsx(Kc,{size:12,className:"text-gray-400"})]}),g.jsx(gX,{data:l})]})})]}),v&&o.length>0&&g.jsx(pX,{hourly:o}),f&&W.length>0&&g.jsx("button",{onClick:()=>A(!0),className:"w-full border-0 bg-transparent p-0 cursor-pointer text-left",children:g.jsxs("div",{className:"space-y-1 hover:bg-gray-50 rounded-lg p-1 -m-1 transition-colors",children:[g.jsxs("div",{className:"text-[10px] text-gray-500 flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx(ju,{size:12}),g.jsx("span",{children:"Volgende getijden"})]}),g.jsx(Kc,{size:12,className:"text-gray-400"})]}),g.jsx("div",{className:"flex gap-1",children:W.map((le,Re)=>g.jsxs("div",{className:`flex-1 p-1.5 rounded text-center ${le.type==="high"?"bg-green-50":"bg-red-50"}`,children:[g.jsx("div",{className:`text-[9px] font-medium ${le.type==="high"?"text-green-600":"text-red-600"}`,children:le.type==="high"?"HW":"LW"}),g.jsx("div",{className:"text-[10px] font-medium",children:Me(le.time)})]},Re))})]})}),T&&g.jsxs("div",{className:"text-[9px] text-gray-400 text-center",children:["Waterdata: ",T.name]})]})})})]}):g.jsxs("button",{onClick:()=>{const le=u||Sd;t(le.lat,le.lng)},className:"p-3 flex items-center gap-2 border-0 outline-none bg-transparent",children:[g.jsx(jl,{size:18,className:"text-gray-400"}),g.jsx("span",{className:"text-sm text-gray-500",children:"Weer laden"})]}),g.jsx(dn,{children:L&&g.jsx(_X,{onClose:()=>A(!1)})}),g.jsx(dn,{children:z&&o.length>0&&g.jsx(yX,{hourlyData:o,onClose:()=>P(!1)})}),g.jsx(dn,{children:F&&n&&g.jsx(xX,{pressureHistory:r,currentPressure:n.pressure,trend:s(),onClose:()=>V(!1)})}),g.jsx(dn,{children:U&&g.jsx(wX,{onClose:()=>O(!1)})}),g.jsx(dn,{children:se&&n&&g.jsx(vX,{current:n,pressureHistory:r,pressureTrend:s(),moonActivity:H,combinedScore:oe,onClose:()=>pe(!1)})})]})]}):null}const zm=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],SX=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],IX=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],Rx=5;function bX({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=q.useRef(null),s=q.useRef(null),o=async u=>{const h=u.target.files;if(!h||h.length===0)return;const f=Rx-n.length,m=Array.from(h).slice(0,f);for(const _ of m)try{const{thumbnailBase64:v}=await hM(_),S={id:dM(),thumbnailBase64:v,createdAt:new Date().toISOString(),pendingUpload:!0};e(S)}catch(v){console.error("Failed to process image:",v)}u.target.value=""},l=n.length<Rx;return g.jsxs("div",{className:"space-y-2",children:[g.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",Rx,")"]}),g.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(u=>g.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[g.jsx("img",{src:u.thumbnailUrl||u.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&g.jsx("button",{type:"button",onClick:()=>t(u.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:g.jsx(zn,{size:12,className:"text-white"})}),u.pendingUpload&&g.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},u.id)),l&&!i&&g.jsxs(g.Fragment,{children:[g.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[g.jsx(rE,{size:20,className:"text-gray-400"}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),g.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[g.jsx(aM,{size:20,className:"text-gray-400"}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),g.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),g.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}const CX={Snoek:{colors:["green","yellow","spotted"],pattern:"elongated with spots"},Snoekbaars:{colors:["gray","silver","striped"],pattern:"elongated with stripes"},Baars:{colors:["green","black","striped","red-fins"],pattern:"oval with stripes"},Karper:{colors:["brown","gold","orange"],pattern:"large oval"},Brasem:{colors:["silver","bronze"],pattern:"flat oval"},Voorn:{colors:["silver","red-fins"],pattern:"small oval"},Zeelt:{colors:["green","brown","slimy"],pattern:"elongated"},Meerval:{colors:["dark","brown","black"],pattern:"large with whiskers"},Aal:{colors:["dark","silver-belly"],pattern:"snake-like"},Forel:{colors:["spotted","pink","silver"],pattern:"streamlined with spots"}};async function RX(n){return new Promise(e=>{const t=new Image;t.onload=()=>{const i=document.createElement("canvas"),r=i.getContext("2d");if(!r){e([]);return}const s=100;i.width=s,i.height=s;const o=(t.width-s)/2,l=(t.height-s)/2;r.drawImage(t,o,l,s,s,0,0,s,s);const h=r.getImageData(0,0,s,s).data;let f=0,m=0,_=0,v=0,S=0,I=0;const T=h.length/4;for(let L=0;L<h.length;L+=4){const A=h[L],z=h[L+1],P=h[L+2];f+=A,m+=z,z>A&&z>P&&_++,A>100&&z>80&&z<150&&P<100&&v++,A>150&&z>150&&P>150&&S++,A<80&&z<80&&P<80&&I++}const R=[];_/T>.2&&R.push("green"),v/T>.2&&R.push("brown"),S/T>.2&&R.push("silver"),I/T>.3&&R.push("dark");const M=f/T,N=m/T;M>150&&N>100&&N<180&&R.push("gold"),e(R)},t.src=n})}function AX(n){const e=[];for(const[t,i]of Object.entries(CX)){let r=0;for(const s of n)i.colors.some(o=>o.includes(s)||s.includes(o))&&r++;r>0&&e.push({species:t,score:r/i.colors.length})}return e.sort((t,i)=>i.score-t.score)}async function PX(n){try{const e=await RX(n),t=AX(e);if(t.length===0)return{species:"",confidence:0,suggestions:zm.slice(0,5).map(o=>o.name)};const i=t[0],r=t.slice(0,5).map(o=>o.species),s=["Snoek","Baars","Karper","Snoekbaars","Brasem"];for(const o of s)!r.includes(o)&&r.length<5&&r.push(o);return{species:i.score>.3?i.species:"",confidence:i.score,suggestions:r.slice(0,5)}}catch(e){return console.error("Fish recognition error:",e),{species:"",confidence:0,suggestions:zm.slice(0,5).map(t=>t.name)}}}function kX(n){return{Snoek:{avgWeight:3e3,avgLength:70},Snoekbaars:{avgWeight:2500,avgLength:60},Baars:{avgWeight:500,avgLength:30},Karper:{avgWeight:8e3,avgLength:60},Brasem:{avgWeight:2e3,avgLength:45},Voorn:{avgWeight:300,avgLength:25},Zeelt:{avgWeight:1500,avgLength:40},Meerval:{avgWeight:15e3,avgLength:120},Aal:{avgWeight:800,avgLength:60},Forel:{avgWeight:1e3,avgLength:40},Kolblei:{avgWeight:500,avgLength:30},Winde:{avgWeight:1e3,avgLength:40},Kopvoorn:{avgWeight:800,avgLength:35},Ruisvoorn:{avgWeight:400,avgLength:25},Blankvoorn:{avgWeight:300,avgLength:25}}[n]||null}function NX({onClose:n,initialLocation:e,initialLocationSource:t,initialPhotos:i=[]}){const r=vk(oe=>oe.addCatch),s=gw(oe=>oe.current),o=ci(oe=>oe.position),[l,u]=q.useState(e||(o?{lat:o.lat,lng:o.lng}:null)),[h,f]=q.useState(t||(o?"gps":null)),[m,_]=q.useState(""),[v,S]=q.useState(""),[I,T]=q.useState(""),[R,M]=q.useState(""),[N,L]=q.useState(""),[A,z]=q.useState(""),[P,b]=q.useState(i),[k,F]=q.useState(!1),[V,U]=q.useState([]),[O,se]=q.useState(0),pe=async oe=>{if(b(ge=>[...ge,oe]),oe.dataUrl&&!m){F(!0);try{const ge=await PX(oe.dataUrl);if(U(ge.suggestions),se(ge.confidence),ge.species&&ge.confidence>.4){_(ge.species);const xe=kX(ge.species)}}catch(ge){console.error("AI recognition failed:",ge)}finally{F(!1)}}},J=oe=>{_(oe),U([])},re=oe=>{b(ge=>ge.filter(xe=>xe.id!==oe))},Y=()=>{o&&(u({lat:o.lat,lng:o.lng}),f("gps"))},H=oe=>{if(oe.preventDefault(),!m||!l){alert("Selecteer een vissoort en zorg dat er een locatie is");return}r({location:l,species:m,weight:v?parseInt(v):void 0,length:I?parseInt(I):void 0,photos:P.length>0?P:void 0,method:R||"Anders",bait:N||void 0,notes:A||void 0,weather:s?{temp:s.temperature,windSpeed:s.windSpeed,windDirection:s.windDirection,pressure:s.pressure}:void 0}),n()},W=(()=>{switch(h){case"gps":return{icon:Ou,label:"GPS",color:"text-blue-500"};case"photo":return{icon:rE,label:"Foto EXIF",color:"text-green-500"};case"map":return{icon:jf,label:"Kaart",color:"text-orange-500"};default:return{icon:Nr,label:"Locatie",color:"text-gray-500"}}})(),G=W.icon;return g.jsx(je.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:g.jsxs(je.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:oe=>oe.stopPropagation(),children:[g.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(kr,{className:"text-white",size:24}),g.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),g.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:g.jsx(zn,{size:20})})]}),g.jsxs("form",{onSubmit:H,className:"p-4 space-y-4",children:[g.jsx("div",{className:"space-y-2",children:l?g.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-gray-50 p-2 rounded-lg",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(G,{size:16,className:W.color}),g.jsxs("span",{className:"text-gray-600",children:[l.lat.toFixed(5),", ",l.lng.toFixed(5)]})]}),g.jsx("span",{className:`text-xs ${W.color} font-medium`,children:W.label})]}):g.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-red-50 p-2 rounded-lg text-red-600",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Nr,{size:16}),g.jsx("span",{children:"Geen locatie"})]}),o&&g.jsx("button",{type:"button",onClick:Y,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded-md border-0 outline-none",children:"Gebruik GPS"})]})}),g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:["Vissoort *",k&&g.jsxs("span",{className:"flex items-center gap-1 text-xs text-blue-500",children:[g.jsx(Vm,{size:12,className:"animate-spin"}),"AI analyseert..."]})]}),g.jsx(dn,{children:V.length>0&&!m&&g.jsxs(je.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-2 p-2 bg-blue-50 rounded-lg border border-blue-200",children:[g.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mb-2",children:[g.jsx(Sq,{size:12}),g.jsxs("span",{children:["AI suggesties ",O>.3?`(${Math.round(O*100)}% zeker)`:""]})]}),g.jsx("div",{className:"flex flex-wrap gap-1",children:V.map(oe=>g.jsx("button",{type:"button",onClick:()=>J(oe),className:"px-2 py-1 text-xs bg-white border border-blue-300 text-blue-700 rounded-full hover:bg-blue-100 transition-colors",children:oe},oe))})]})}),g.jsxs("select",{value:m,onChange:oe=>{_(oe.target.value),U([])},className:"form-select",required:!0,children:[g.jsx("option",{value:"",children:"Selecteer vissoort..."}),zm.map(oe=>g.jsx("option",{value:oe.name,children:oe.name},oe.name))]})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[g.jsx(yq,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),g.jsx("input",{type:"number",value:v,onChange:oe=>S(oe.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[g.jsx(cM,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),g.jsx("input",{type:"number",value:I,onChange:oe=>T(oe.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),g.jsxs("select",{value:R,onChange:oe=>M(oe.target.value),className:"form-select",children:[g.jsx("option",{value:"",children:"Selecteer methode..."}),SX.map(oe=>g.jsx("option",{value:oe,children:oe},oe))]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),g.jsxs("select",{value:N,onChange:oe=>L(oe.target.value),className:"form-select",children:[g.jsx("option",{value:"",children:"Selecteer aas..."}),IX.map(oe=>g.jsx("option",{value:oe,children:oe},oe))]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),g.jsx("textarea",{value:A,onChange:oe=>z(oe.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),g.jsx(bX,{photos:P,onAddPhoto:pe,onRemovePhoto:re}),g.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function DX(){const n=In(h=>h.catchFormOpen),e=In(h=>h.catchFormLocation),t=In(h=>h.catchFormLocationSource),i=In(h=>h.catchFormInitialPhotos),r=In(h=>h.openCatchForm),s=In(h=>h.closeCatchForm),o=ci(h=>h.position),l=We(h=>h.showCatchButton),u=()=>{o?r({location:{lat:o.lat,lng:o.lng},locationSource:"gps"}):r()};return g.jsxs(g.Fragment,{children:[l&&g.jsx(je.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:u,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:g.jsx(kr,{size:22,strokeWidth:2})}),g.jsx(dn,{children:n&&g.jsx(NX,{onClose:s,initialLocation:e||void 0,initialLocationSource:t||void 0,initialPhotos:i})})]})}function MX(){const n=Dr(r=>r.map),e=vk(r=>r.catches),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new r0,t.current=new h0({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=aa([r.location.lng,r.location.lat]),o=new El({geometry:new la(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new qn({image:new to({radius:14,fill:new ki({color:"#22c55e"}),stroke:new ca({color:"#fff",width:2})}),text:new vf({text:l,font:"bold 12px sans-serif",fill:new ki({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function LX(){const n=Dr(r=>r.map),e=wk(r=>r.spots),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new r0,t.current=new h0({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=aa([r.location.lng,r.location.lat]),o=new El({geometry:new la(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new qn({image:new to({radius:12,fill:new ki({color:l}),stroke:new ca({color:"#fff",width:2})}),text:new vf({text:"",font:"bold 14px sans-serif",fill:new ki({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function OX({onClose:n,initialLocation:e}){const t=wk(T=>T.addSpot),[i,r]=q.useState(""),[s,o]=q.useState(""),[l,u]=q.useState([]),[h,f]=q.useState(""),[m,_]=q.useState(3),v=e,S=T=>{u(R=>R.includes(T)?R.filter(M=>M!==T):[...R,T])},I=T=>{if(T.preventDefault(),!i||!v){alert("Geef een naam op voor deze locatie");return}t({name:i,location:v,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:m}),n()};return g.jsx(je.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:g.jsxs(je.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:T=>T.stopPropagation(),children:[g.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(qv,{className:"text-white",size:24}),g.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),g.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:g.jsx(zn,{size:20})})]}),g.jsxs("form",{onSubmit:I,className:"p-4 space-y-4",children:[v&&g.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[g.jsx(Nr,{size:16}),g.jsxs("span",{children:[v.lat.toFixed(5),", ",v.lng.toFixed(5)]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),g.jsx("input",{type:"text",value:i,onChange:T=>r(T.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),g.jsx("input",{type:"text",value:s,onChange:T=>o(T.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),g.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(T=>g.jsx("button",{type:"button",onClick:()=>_(T),className:"p-1 border-0 outline-none bg-transparent",children:g.jsx(qv,{size:28,className:T<=m?"text-yellow-400 fill-yellow-400":"text-gray-300"})},T))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),g.jsx("div",{className:"flex flex-wrap gap-2",children:zm.slice(0,12).map(T=>g.jsx("button",{type:"button",onClick:()=>S(T.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(T.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:T.name},T.name))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),g.jsx("textarea",{value:h,onChange:T=>f(T.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),g.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const jX=[{name:"Aanlegsteigers",icon:rM,color:"#2196F3"},{name:"Trailerhellingen",icon:Eq,color:"#4CAF50"},{name:"Dieptekaart",icon:ju,color:"#00BCD4"},{name:"Bathymetrie",icon:cM,color:"#7C3AED"},{name:"Viswater",icon:Nr,color:"#9C27B0"},{name:"Zeevisstekken",icon:ju,color:"#0D47A1"},{name:"Boeien",icon:cK,color:"#E91E63"},{name:"Bakens",icon:MK,color:"#FF5722"}],uR=[{name:"CartoDB Light",label:"Light"},{name:"Terrein",label:"Terrein"},{name:"OpenStreetMap",label:"Kaart"},{name:"Luchtfoto",label:"Satelliet"}];function FX(){const n=In(v=>v.layerPanelOpen),e=In(v=>v.toggleLayerPanel),t=Zi(v=>v.visible),i=Zi(v=>v.opacity),r=Zi(v=>v.toggleLayer),s=Zi(v=>v.setLayerVisibility),o=Zi(v=>v.setLayerOpacity),l=v=>{uR.forEach(S=>{s(S.name,S.name===v)}),v==="Luchtfoto"?s("Labels Overlay",!0):s("Labels Overlay",!1)},u=()=>{s("Labels Overlay",!t["Labels Overlay"])},h=i["AHN4 Hillshade"]??.5,f=t["AHN4 Hillshade"],m=i["PDOK Water NL"]??.7,_=t["PDOK Water NL"];return g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:g.jsx(je.button,{className:"w-11 h-11 bg-white/90 hover:bg-white backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:g.jsx(sf,{size:22})})}),g.jsx(dn,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(je.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(je.div,{className:"fixed top-2 right-2 z-[1601] bg-white rounded-lg shadow-lg overflow-hidden w-[280px] max-h-[calc(100vh-100px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[g.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-orange-500",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(sf,{size:14,className:"text-white"}),g.jsx("span",{className:"font-medium text-white text-sm",children:"Kaartlagen"})]}),g.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-orange-400/50 hover:bg-orange-400 transition-colors",children:g.jsx(zn,{size:16,className:"text-white",strokeWidth:2.5})})]}),g.jsxs("div",{className:"p-2 overflow-y-auto flex-1",children:[g.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[g.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1.5 px-1 uppercase tracking-wide",children:"Achtergrond"}),g.jsx("div",{className:"flex gap-1",children:uR.map(v=>g.jsx("button",{className:`flex-1 px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t[v.name]?"bg-orange-500 text-white":"bg-gray-100 text-gray-600 hover:bg-orange-50"}`,onClick:()=>l(v.name),children:v.label},v.name))}),t.Luchtfoto&&g.jsxs("button",{onClick:u,className:`mt-1.5 w-full flex items-center justify-between px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t["Labels Overlay"]?"bg-orange-50 text-orange-600":"bg-transparent text-gray-500 hover:bg-orange-50"}`,children:[g.jsxs("span",{className:"flex items-center gap-1.5",children:[g.jsx(Aq,{size:12}),"Labels overlay"]}),t["Labels Overlay"]&&g.jsx(Fm,{size:12})]})]}),g.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[g.jsx("div",{className:"text-xs font-medium text-amber-600 mb-1.5 px-1 uppercase tracking-wide",children:"Hoogtekaart"}),g.jsx(hR,{name:"AHN4 Hillshade",icon:ZK,color:"#f59e0b",visible:f,opacity:h,onToggle:()=>r("AHN4 Hillshade"),onOpacityChange:v=>o("AHN4 Hillshade",v)})]}),g.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[g.jsx("div",{className:"text-xs font-medium text-cyan-600 mb-1.5 px-1 uppercase tracking-wide",children:"Water"}),g.jsx(hR,{name:"PDOK Water NL",label:"Waterlopen NL",icon:B0,color:"#0284c7",visible:_,opacity:m,onToggle:()=>r("PDOK Water NL"),onOpacityChange:v=>o("PDOK Water NL",v)})]}),g.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[g.jsx("div",{className:"text-xs font-medium text-orange-600 mb-1.5 px-1 uppercase tracking-wide",children:"Vislagen"}),g.jsx("div",{className:"space-y-0.5",children:jX.map(v=>{const S=v.icon,I=t[v.name];return g.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors border-0 outline-none ${I?"bg-orange-50":"bg-transparent hover:bg-orange-50"}`,onClick:()=>r(v.name),children:[g.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center transition-colors",style:{backgroundColor:I?v.color:"#e5e7eb"},children:g.jsx(S,{size:12,className:"text-white"})}),g.jsx("span",{className:`text-sm ${I?"text-orange-700":"text-gray-600"}`,children:v.name}),g.jsx("div",{className:"ml-auto",children:g.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all",style:{backgroundColor:I?v.color:"white",border:`2px solid ${I?v.color:"#d1d5db"}`},children:I&&g.jsx(Fm,{size:10,className:"text-white",strokeWidth:3})})})]},v.name)})})]}),g.jsxs("div",{children:[g.jsx("div",{className:"text-xs font-medium text-blue-600 mb-1.5 px-1 uppercase tracking-wide",children:"Externe bronnen"}),g.jsxs("a",{href:"https://www.visplanner.nl",target:"_blank",rel:"noopener noreferrer",className:"w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors border-0 outline-none bg-transparent hover:bg-blue-50 text-gray-600 hover:text-blue-600 no-underline",children:[g.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center bg-blue-500",children:g.jsx(Nr,{size:12,className:"text-white"})}),g.jsx("span",{className:"text-sm",children:"VISplanner"}),g.jsx(sE,{size:12,className:"ml-auto text-gray-400"})]}),g.jsx("p",{className:"text-[10px] text-gray-400 px-2 mt-1",children:"Bekijk waar je mag vissen met je VISpas"})]})]})]})]})})]})}function hR({name:n,label:e,icon:t,color:i,visible:r,opacity:s,onToggle:o,onOpacityChange:l}){const u=e||n;return g.jsxs("div",{children:[g.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors border-0 outline-none ${r?"bg-gray-50":"bg-transparent hover:bg-gray-50"}`,onClick:o,children:[g.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center transition-colors",style:{backgroundColor:r?i:"#e5e7eb"},children:g.jsx(t,{size:12,className:"text-white"})}),g.jsx("span",{className:`text-sm ${r?"text-gray-800":"text-gray-600"}`,children:u}),g.jsx("div",{className:"ml-auto",children:g.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all",style:{backgroundColor:r?i:"white",border:`2px solid ${r?i:"#d1d5db"}`},children:r&&g.jsx(Fm,{size:10,className:"text-white",strokeWidth:3})})})]}),r&&g.jsx("div",{className:"mt-1 px-2 pb-1",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] text-gray-400 w-16",children:"Transparantie"}),g.jsx("input",{type:"range",min:"10",max:"100",value:s*100,onChange:h=>l(parseInt(h.target.value)/100),className:"flex-1 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{accentColor:i}}),g.jsxs("span",{className:"text-[10px] text-gray-400 w-6 text-right",children:[Math.round(s*100),"%"]})]})})]})}function VX(){const n=In(J=>J.settingsPanelOpen),e=In(J=>J.toggleSettingsPanel),t=We(J=>J.showCatchButton),i=We(J=>J.setShowCatchButton),r=We(J=>J.showCatches),s=We(J=>J.setShowCatches),o=We(J=>J.showFavoriteSpots),l=We(J=>J.setShowFavoriteSpots),u=We(J=>J.defaultBackground),h=We(J=>J.setDefaultBackground),f=We(J=>J.fontScale),m=We(J=>J.setFontScale),_=We(J=>J.showFontSliders),v=We(J=>J.setShowFontSliders),S=Zi(J=>J.setLayerVisibility),I=We(J=>J.showWeatherWidget),T=We(J=>J.setShowWeatherWidget),R=We(J=>J.showWindIndicator),M=We(J=>J.setShowWindIndicator),N=We(J=>J.showTideWidget),L=We(J=>J.setShowTideWidget),A=We(J=>J.showBuienradarWidget),z=We(J=>J.setShowBuienradarWidget),P=We(J=>J.showWaterflowWidget),b=We(J=>J.setShowWaterflowWidget),k=We(J=>J.showForecastSlider),F=We(J=>J.setShowForecastSlider),V=We(J=>J.showWaterDataWidget),U=We(J=>J.setShowWaterDataWidget),[O,se]=q.useState(!1),pe=J=>{h(J),S("CartoDB Light",J==="CartoDB Light"),S("Terrein",J==="Terrein"),S("OpenStreetMap",J==="OpenStreetMap"),S("Luchtfoto",J==="Luchtfoto"),S("Labels Overlay",J==="Luchtfoto")};return n?g.jsx(je.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:g.jsxs(je.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:J=>J.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600",children:[g.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),g.jsx("button",{onClick:e,className:"p-1.5 rounded-lg bg-orange-600 hover:bg-orange-700 transition-colors border-0 outline-none",children:g.jsx(zn,{size:18,className:"text-white"})})]}),g.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[g.jsxs("div",{className:"space-y-3",children:[g.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),g.jsx(xp,{icon:g.jsx(kr,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),g.jsx(xp,{icon:g.jsx(kr,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),g.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[g.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),g.jsx(xp,{icon:g.jsx(Nr,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),g.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[g.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:g.jsx(jf,{size:18,className:"text-gray-500"})}),g.jsxs("div",{className:"flex-1",children:[g.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),g.jsxs("select",{value:u,onChange:J=>pe(J.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-orange-400",children:[g.jsx("option",{value:"CartoDB Light",children:"Light (standaard)"}),g.jsx("option",{value:"Terrein",children:"Terrein (relif)"}),g.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),g.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),g.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[g.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weergave"}),g.jsx(xp,{icon:g.jsx(Lq,{size:18,className:"text-purple-500"}),label:"Tekstgrootte aanpassen",description:"Toon schuifbalk voor tekstgrootte",checked:_,onChange:v}),_&&g.jsxs("div",{className:"flex items-center gap-3 pl-2",children:[g.jsx("span",{className:"text-xs text-gray-500",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:f,onChange:J=>m(parseInt(J.target.value)),className:"flex-1"}),g.jsx("span",{className:"text-lg text-gray-500",children:"T"}),g.jsxs("span",{className:"text-xs text-gray-500 w-10",children:[f,"%"]})]})]}),g.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[g.jsxs("button",{onClick:()=>se(!O),className:"w-full flex items-center justify-between bg-transparent border-0 p-0 cursor-pointer",children:[g.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Widgets"}),g.jsx(sM,{size:18,className:`text-gray-400 transition-transform ${O?"rotate-180":""}`})]}),g.jsx(dn,{children:O&&g.jsxs(je.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden space-y-2",children:[g.jsx(Ha,{icon:g.jsx(W0,{size:16,className:"text-orange-500"}),label:"Weer & visvriendelijkheid",checked:I,onChange:T}),g.jsx(Ha,{icon:g.jsx(of,{size:16,className:"text-cyan-500"}),label:"Wind indicator",checked:R,onChange:M}),g.jsx(Ha,{icon:g.jsx(ju,{size:16,className:"text-blue-500"}),label:"Getijden",checked:N,onChange:L}),g.jsx(Ha,{icon:g.jsx(Of,{size:16,className:"text-indigo-500"}),label:"Buienradar",checked:A,onChange:z}),g.jsx(Ha,{icon:g.jsx(B0,{size:16,className:"text-cyan-600"}),label:"Waterdata (temp, golven)",checked:V,onChange:U}),g.jsx(Ha,{icon:g.jsx(jm,{size:16,className:"text-green-500"}),label:"Waterafvoer rivieren",checked:P,onChange:b}),g.jsx(Ha,{icon:g.jsx(jm,{size:16,className:"text-purple-500"}),label:"Voorspelling schuif",checked:k,onChange:F})]})})]})]}),g.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function xp({icon:n,label:e,description:t,checked:i,onChange:r}){return g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),g.jsxs("div",{className:"flex-1",children:[g.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),g.jsx("p",{className:"text-xs text-gray-400",children:t})]}),g.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-orange-500":"bg-gray-300"}`,children:g.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function Ha({icon:n,label:e,checked:t,onChange:i}){return g.jsxs("div",{className:"flex items-center gap-2 py-1.5 px-1",children:[g.jsx("div",{className:"p-1.5 bg-gray-100 rounded-lg",children:n}),g.jsx("span",{className:"flex-1 text-sm text-gray-700",children:e}),g.jsx("button",{onClick:()=>i(!t),className:`relative w-10 h-5 rounded-full transition-colors border-0 outline-none ${t?"bg-orange-500":"bg-gray-300"}`,children:g.jsx("span",{className:`absolute top-0.5 w-4 h-4 bg-white rounded-full shadow transition-all ${t?"left-5":"left-0.5"}`})})]})}function zX(){const n=Dr(S=>S.map),[e,t]=q.useState([]),[i,r]=q.useState(0),[s,o]=q.useState(!1),[l,u]=q.useState(null),h=e.length,f=e[i]||"";q.useEffect(()=>{if(!n)return;const S=async I=>{const T=[];if(n.forEachFeatureAtPixel(I.pixel,(R,M)=>{const N=R.getProperties(),L=M?.get("title")||"";let A="";if(L==="Aanlegsteigers"||N.layerType==="aanlegsteiger"){const z=N.name||"Aanlegsteiger",P=N.operator||"",b=N.access||"",k=N.fee||"",F=N.capacity||"",V=N.website||"";A=`<strong class="text-blue-800">${z}</strong>`,P&&(A+=`<br/><span class="text-sm text-gray-600">Beheerder: ${P}</span>`),b&&(A+=`<br/><span class="text-sm text-gray-600">Toegang: ${b==="yes"?"Openbaar":b==="private"?"Priv":b}</span>`),k&&(A+=`<br/><span class="text-sm text-gray-600">Kosten: ${k==="yes"?"Betaald":k==="no"?"Gratis":k}</span>`),F&&(A+=`<br/><span class="text-sm text-gray-600">Capaciteit: ${F} boten</span>`),V&&(A+=`<br/><a href="${V}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Website</a>`)}else if(L==="Trailerhellingen"||N.layerType==="trailerhelling"){const z=N.name||null,P=N.operator||"",b=N.access||"",k=N.fee||"",F=N.surface||"",V=N.website||"",U=N.description||"",O=N.opening_hours||"";let se="";k==="no"?se='<span class="inline-block px-2 py-0.5 bg-green-100 text-green-700 text-xs font-medium rounded-full">Gratis</span>':k==="yes"?se='<span class="inline-block px-2 py-0.5 bg-orange-100 text-orange-700 text-xs font-medium rounded-full">Betaald</span>':k&&(se=`<span class="inline-block px-2 py-0.5 bg-orange-100 text-orange-700 text-xs font-medium rounded-full">${k}</span>`),z?(A=`<strong class="text-green-800 text-lg">${z}</strong>`,se&&(A+=` ${se}`)):(A='<strong class="text-green-800 text-lg">Trailerhelling</strong>',se&&(A+=` ${se}`)),b&&(A+=`<br/><span class="text-sm text-gray-600">Toegang: ${b==="yes"||b==="public"||b==="permissive"?"Openbaar":b==="private"?"Priv":b==="customers"?"Alleen klanten":b}</span>`),P&&(A+=`<br/><span class="text-sm text-gray-600">Beheerder: ${P}</span>`),F&&(A+=`<br/><span class="text-sm text-gray-600">Ondergrond: ${{concrete:"Beton",asphalt:"Asfalt",gravel:"Grind",paved:"Verhard",unpaved:"Onverhard",grass:"Gras",sand:"Zand",wood:"Hout"}[F]||F}</span>`),O&&(A+=`<br/><span class="text-sm text-gray-600">Openingstijden: ${O}</span>`),U&&(A+=`<br/><span class="text-sm text-gray-500 italic">${U}</span>`),V&&(A+=`<br/><a href="${V}" target="_blank" rel="noopener noreferrer" class="text-green-600 hover:underline text-sm">Website</a>`)}else if(L==="Viswater"||N.layerType==="viswater"){const z=N.name||"Viswater",P=N.fishing||"",b=N.access||"",k=N.operator||"";A=`<strong class="text-purple-800">${z}</strong>`,P&&(A+=`<br/><span class="text-sm text-purple-700">Type: ${P}</span>`),k&&(A+=`<br/><span class="text-sm text-gray-600">Beheerder: ${k}</span>`),b&&(A+=`<br/><span class="text-sm text-gray-600">Toegang: ${b}</span>`)}else if(L==="Zeevisstekken"||N.layerType==="zeevisstek"){const z=N.name||"Zeevisstek",P=N.regio||"",b=N.beschrijving||"",k=N.parkeren||"",F=N.beerkanaal,V=N.vissoorten||{},U=N.tips||"",O=N.bereikbaarheid||"";if(A=`<strong class="text-blue-900 text-lg">${z}</strong>`,P&&(A+=`<br/><span class="text-sm text-blue-600 font-medium">${P}</span>`),F&&(A+='<br/><span class="inline-block mt-1 px-2 py-0.5 bg-red-100 text-red-700 text-xs font-medium rounded-full">Beperkte toegang</span>'),k){const se=k.toLowerCase().includes("gratis")?"bg-green-100 text-green-700":k.toLowerCase().includes("betaald")?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700";A+=` <span class="inline-block mt-1 px-2 py-0.5 ${se} text-xs font-medium rounded-full">Parkeren: ${k}</span>`}b&&(A+=`<br/><span class="text-sm text-gray-600 mt-2 block">${b}</span>`),V&&Object.keys(V).length>0&&(A+='<br/><div class="mt-2 pt-2 border-t border-gray-200">',A+='<span class="text-xs font-semibold text-gray-500 uppercase">Vissoorten per seizoen</span>',V.voorjaar&&V.voorjaar.length>0&&(A+=`<br/><span class="text-sm"><span class="text-green-600 font-medium">Voorjaar:</span> ${V.voorjaar.join(", ")}</span>`),V.zomer&&V.zomer.length>0&&(A+=`<br/><span class="text-sm"><span class="text-yellow-600 font-medium">Zomer:</span> ${V.zomer.join(", ")}</span>`),V.winter&&V.winter.length>0&&(A+=`<br/><span class="text-sm"><span class="text-blue-600 font-medium">Winter:</span> ${V.winter.join(", ")}</span>`),A+="</div>"),U&&(A+='<br/><div class="mt-2 p-2 bg-amber-50 rounded-lg">',A+='<span class="text-xs font-semibold text-amber-700"> Tip:</span>',A+=`<span class="text-sm text-amber-800 block">${U}</span>`,A+="</div>"),O&&(A+=`<br/><span class="text-xs text-gray-500"> ${O}</span>`)}else if(L==="Boeien"||N.layerType==="boei"){const z=N.benaming||N.benamCod||"Boei",P=N.vaarwater||"",b=N.kleurpatr||"",k=N.objVorm||"",F=N.lichtKlr||N.lichtKleur||"",V=N.signKar||"",U=N.inbedrijf||"";if(A=`<strong class="text-pink-800 text-lg">${z}</strong>`,P&&(A+=`<br/><span class="text-sm text-pink-600 font-medium">${P}</span>`),b){const O=b.toLowerCase().includes("rood")?"bg-red-100 text-red-700":b.toLowerCase().includes("groen")?"bg-green-100 text-green-700":b.toLowerCase().includes("geel")?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700";A+=`<br/><span class="inline-block mt-1 px-2 py-0.5 ${O} text-xs font-medium rounded-full">${b}</span>`}k&&(A+=`<br/><span class="text-sm text-gray-600">Vorm: ${k}</span>`),F&&F!=="#"&&(A+=`<br/><span class="text-sm text-gray-600">Licht: ${F}</span>`),V&&V!=="Niet toegewezen"&&(A+=`<br/><span class="text-sm text-gray-600">Signaal: ${V}</span>`),U&&(A+=`<br/><span class="text-xs text-gray-400">In bedrijf sinds: ${U}</span>`)}else if(L==="Bakens"||N.layerType==="baken"){const z=N.benaming||N.benamCod||"Baken",P=N.vaarwater||"",b=N.kleurpatr||"",k=N.objHoogte||"",F=N.nautFunct||"",V=N.lichtKl||N.lichtKleur||"",U=N.lichtHgt||"",O=N.inbedrijf||"";if(A=`<strong class="text-orange-800 text-lg">${z}</strong>`,P&&(A+=`<br/><span class="text-sm text-orange-600 font-medium">${P}</span>`),b){const se=b.toLowerCase().includes("rood")?"bg-red-100 text-red-700":b.toLowerCase().includes("groen")?"bg-green-100 text-green-700":b.toLowerCase().includes("geel")?"bg-yellow-100 text-yellow-700":(b.toLowerCase().includes("wit"),"bg-gray-100 text-gray-700");A+=`<br/><span class="inline-block mt-1 px-2 py-0.5 ${se} text-xs font-medium rounded-full">${b}</span>`}F&&(A+=`<br/><span class="text-sm text-gray-600">Functie: ${F}</span>`),k&&(A+=`<br/><span class="text-sm text-gray-600">Hoogte: ${k}m</span>`),V&&V!=="#"&&(A+=`<br/><span class="text-sm text-gray-600">Licht: ${V}</span>`),U&&(A+=`<br/><span class="text-sm text-gray-600">Lichthoogte: ${U}m</span>`),O&&(A+=`<br/><span class="text-xs text-gray-400">In bedrijf sinds: ${O}</span>`)}else(N.name||N.title)&&(A=`<strong class="text-gray-800">${N.name||N.title}</strong>`,N.description&&(A+=`<br/><span class="text-sm text-gray-600">${N.description}</span>`));A&&T.push({content:A,coordinate:I.coordinate})}),T.length>0){t(T.map(M=>M.content)),r(0),o(!0);const R=Jx(T[0].coordinate);u(`https://www.google.com/maps/dir/?api=1&destination=${R[1]},${R[0]}`)}};return n.on("singleclick",S),()=>{n.un("singleclick",S)}},[n]);const m=()=>{o(!1),t([]),r(0),u(null)},_=()=>{i<h-1&&r(i+1)},v=()=>{i>0&&r(i-1)};return g.jsx(dn,{children:s&&f&&g.jsxs(je.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},className:"fixed bottom-0 left-0 right-0 z-[1200] bg-white rounded-t-2xl shadow-lg max-h-[50vh] overflow-hidden",children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100 bg-gradient-to-r from-orange-500 to-orange-600",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[h>1&&g.jsxs("div",{className:"flex items-center gap-1 mr-2",children:[g.jsx("button",{onClick:v,disabled:i===0,className:"p-1 rounded bg-orange-600 hover:bg-orange-700 disabled:opacity-50 border-0 outline-none",children:g.jsx(sK,{size:16,className:"text-white"})}),g.jsxs("span",{className:"text-white text-xs px-1",children:[i+1,"/",h]}),g.jsx("button",{onClick:_,disabled:i===h-1,className:"p-1 rounded bg-orange-600 hover:bg-orange-700 disabled:opacity-50 border-0 outline-none",children:g.jsx(Kc,{size:16,className:"text-white"})})]}),g.jsx("span",{className:"font-medium text-white text-sm",children:"Info"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[l&&g.jsx("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 rounded bg-orange-600 hover:bg-orange-700 border-0 outline-none",title:"Navigeer met Google Maps",onClick:S=>S.stopPropagation(),children:g.jsx(JK,{size:16,className:"text-white"})}),g.jsx("button",{onClick:m,className:"p-1.5 rounded bg-blue-600 hover:bg-blue-700 border-0 outline-none",children:g.jsx(zn,{size:16,className:"text-white"})})]})]}),g.jsx("div",{className:"p-4 overflow-y-auto",style:{maxHeight:"calc(50vh - 56px)"},dangerouslySetInnerHTML:{__html:f}})]})})}function UX({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=nM(),[l,u]=q.useState(""),[h,f]=q.useState(!1),[m,_]=q.useState(!1),[v,S]=q.useState(null);if(q.useEffect(()=>{o()},[o]),s)return g.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-500 via-orange-600 to-orange-800 flex items-center justify-center",children:g.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return g.jsx(g.Fragment,{children:n});const I=R=>{R.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},T=async()=>{try{S(null),await i()}catch{S("Google login mislukt"),setTimeout(()=>S(null),3e3)}};return g.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-500 via-orange-600 to-orange-800 flex items-center justify-center p-4",children:g.jsxs(je.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[g.jsxs("div",{className:"flex flex-col items-center mb-6",children:[g.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-orange-500 to-orange-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:g.jsx(kr,{size:40,className:"text-white"})}),g.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),g.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),g.jsxs(je.button,{onClick:T,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[g.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[g.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),g.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),g.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),g.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),v&&g.jsx(je.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:v}),g.jsxs("div",{className:"flex items-center gap-3 my-4",children:[g.jsx("div",{className:"flex-1 h-px bg-gray-200"}),g.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),g.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),g.jsxs("form",{onSubmit:I,className:"space-y-4",children:[g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:g.jsx(zK,{size:20})}),g.jsx("input",{type:m?"text":"password",value:l,onChange:R=>u(R.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-orange-400"}`}),g.jsx("button",{type:"button",onClick:()=>_(!m),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m?g.jsx(EK,{size:20}):g.jsx(SK,{size:20})})]}),h&&g.jsx(je.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),g.jsx(je.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),g.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function BX(){const n=di(s=>s.isLoading),e=di(s=>s.isPickerOpen),t=di(s=>s.openPhotoPicker),i=di(s=>s.error),r=()=>{!n&&!e&&t()};return g.jsxs("div",{className:"fixed bottom-[60px] left-2 z-[900]",children:[g.jsx(je.button,{className:`w-11 h-11 backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center border-0 outline-none transition-colors ${n||e?"bg-orange-500 text-white":"bg-white/90 hover:bg-white text-gray-600"}`,onClick:r,whileHover:{scale:n?1:1.05},whileTap:{scale:n?1:.95},title:i||"Foto uit Google Photos",disabled:n||e,children:n||e?g.jsx(Vm,{size:22,className:"animate-spin"}):g.jsx(aM,{size:22})}),i&&g.jsx(je.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 bg-red-500 text-white text-xs px-2 py-1 rounded-lg whitespace-nowrap shadow-lg",children:i})]})}const WX='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>',GX=`data:image/svg+xml;base64,${btoa(WX)}`;function $X(){const n=Dr(s=>s.map),e=zH(),t=di(s=>s.openPhotoActionDialog),i=q.useRef(null),r=q.useRef(null);return q.useEffect(()=>{if(!n)return;r.current=new r0,i.current=new h0({source:r.current,zIndex:450,properties:{name:"googlePhotos"}}),n.addLayer(i.current);const s=o=>{const l=n.getFeaturesAtPixel(o.pixel,{layerFilter:u=>u===i.current});if(l&&l.length>0){const h=l[0].get("photoData");h&&t(h.id)}};return n.on("click",s),()=>{n.un("click",s),i.current&&n&&n.removeLayer(i.current)}},[n,t]),q.useEffect(()=>{r.current&&(r.current.clear(),e.forEach(s=>{if(!s.location)return;const o=aa([s.location.lng,s.location.lat]),l=new El({geometry:new la(o),photoData:s}),h=s.weather!==null?"#10b981":"#3b82f6";l.setStyle(new qn({image:new to({radius:16,fill:new ki({color:h}),stroke:new ca({color:"#fff",width:2})})})),l.setStyle([new qn({image:new to({radius:16,fill:new ki({color:h}),stroke:new ca({color:"#fff",width:2})})}),new qn({image:new a0({src:GX,scale:.6,anchor:[.5,.5]})})]),r.current.addFeature(l)}))},[e]),null}function HX(){const n=di(z=>z.photoActionDialogOpen),e=di(z=>z.closePhotoActionDialog),t=di(z=>z.updatePhoto),i=di(z=>z.fetchWeatherForPhoto),r=di(z=>z.removePhoto),s=In(z=>z.openCatchForm),o=VH(),[l,u]=q.useState(!1),[h,f]=q.useState(null),[m,_]=q.useState(!1);if(q.useEffect(()=>{if(!o){f(null);return}o.isStoredLocally?(_(!0),LH(o.id).then(z=>{z&&f(z.dataUrl)}).finally(()=>_(!1))):f(null)},[o?.id,o?.isStoredLocally]),!n||!o)return null;const v=o.location!==null,S=o.dateTime!==null,I=o.weather!==null,T=v&&S&&!I,R=async()=>{u(!0);try{await i(o.id)}finally{u(!1)}},M=()=>{t(o.id,{isOnMap:!0}),e()},N=()=>{s({location:o.location||void 0,locationSource:"photo"}),t(o.id,{isRegisteredAsCatch:!0}),e()},L=()=>{r(o.id)},A=I?PH(o.weather):null;return g.jsx(dn,{children:g.jsx(je.div,{className:"fixed inset-0 z-[1200] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:g.jsxs(je.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-md max-h-[85vh] overflow-hidden flex flex-col",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:z=>z.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[g.jsx("h2",{className:"text-lg font-semibold text-white",children:"Foto details"}),g.jsx("button",{onClick:e,className:"p-1.5 rounded-lg bg-blue-600 hover:bg-blue-700 transition-colors border-0 outline-none",children:g.jsx(zn,{size:18,className:"text-white"})})]}),g.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto flex-1",children:[g.jsx("div",{className:"relative aspect-video bg-gray-100 rounded-xl overflow-hidden",children:m?g.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400",children:g.jsx(Vm,{size:32,className:"animate-spin"})}):h?g.jsxs(g.Fragment,{children:[g.jsx("img",{src:h,alt:o.filename,className:"w-full h-full object-cover"}),g.jsxs("div",{className:"absolute bottom-2 right-2 bg-green-500 text-white text-xs px-2 py-0.5 rounded-full flex items-center gap-1",children:[g.jsx(PK,{size:10}),"Lokaal"]})]}):g.jsx("img",{src:gH(o.baseUrl,400),alt:o.filename,className:"w-full h-full object-cover"})}),g.jsxs("div",{className:"space-y-2",children:[v?g.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[g.jsx(Nr,{size:16,className:"text-blue-500 shrink-0"}),g.jsx("span",{className:"text-gray-700",children:vH(o.location.lat,o.location.lng)})]}):g.jsxs("div",{className:"flex items-center gap-2 text-sm text-orange-600",children:[g.jsx(aR,{size:16,className:"shrink-0"}),g.jsx("span",{children:"Geen locatie in foto gevonden"})]}),S?g.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[g.jsx(JH,{size:16,className:"text-blue-500 shrink-0"}),g.jsx("span",{className:"text-gray-700",children:nR(o.dateTime)})]}):g.jsxs("div",{className:"flex items-center gap-2 text-sm text-orange-600",children:[g.jsx(aR,{size:16,className:"shrink-0"}),g.jsx("span",{children:"Geen datum in foto gevonden"})]})]}),T&&g.jsx("button",{onClick:R,disabled:l,className:"w-full py-2.5 px-4 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-xl font-medium flex items-center justify-center gap-2 hover:from-orange-600 hover:to-orange-700 transition-all disabled:opacity-50 border-0 outline-none",children:l?g.jsxs(g.Fragment,{children:[g.jsx(Vm,{size:18,className:"animate-spin"}),"Weergegevens ophalen..."]}):g.jsxs(g.Fragment,{children:[g.jsx(Cx,{size:18}),"Haal weergegevens op"]})}),I&&g.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl p-4 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("h3",{className:"font-medium text-gray-800 flex items-center gap-2",children:[g.jsx(Cx,{size:18,className:"text-blue-500"}),"Weer op ",nR(o.dateTime).split(",")[0]]}),A!==null&&g.jsxs("div",{className:`flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${A>=70?"bg-green-100 text-green-700":A>=50?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[g.jsx(kr,{size:12}),A,"%"]})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(W0,{size:16,className:"text-orange-500"}),g.jsxs("span",{className:"text-sm text-gray-700",children:[o.weather.temp.toFixed(1),"C"]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(rf,{size:16,className:"text-purple-500"}),g.jsxs("span",{className:"text-sm text-gray-700",children:[o.weather.pressure.toFixed(0)," hPa"]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(of,{size:16,className:"text-cyan-500"}),g.jsxs("span",{className:"text-sm text-gray-700",children:[o.weather.windSpeed.toFixed(0)," km/u ",AH(o.weather.windDirection)]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(B0,{size:16,className:"text-blue-500"}),g.jsxs("span",{className:"text-sm text-gray-700",children:[o.weather.humidity.toFixed(0),"%"]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(jl,{size:16,className:"text-gray-500"}),g.jsxs("span",{className:"text-sm text-gray-700",children:[o.weather.cloudCover.toFixed(0),"% bewolkt"]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Cx,{size:16,className:"text-yellow-500"}),g.jsx("span",{className:"text-sm text-gray-700",children:RH(o.weather.weatherCode)})]})]}),o.weather.precipitation>0&&g.jsxs("div",{className:"text-sm text-blue-600 mt-2",children:["Neerslag: ",o.weather.precipitation.toFixed(1)," mm"]})]}),g.jsxs("div",{className:"space-y-2 pt-2",children:[v&&g.jsxs(g.Fragment,{children:[g.jsxs("button",{onClick:M,disabled:o.isOnMap,className:`w-full py-2.5 px-4 rounded-xl font-medium flex items-center justify-center gap-2 transition-all border-0 outline-none ${o.isOnMap?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,children:[g.jsx(jf,{size:18}),o.isOnMap?"Al op kaart geplaatst":"Plaats op kaart"]}),g.jsxs("button",{onClick:N,disabled:o.isRegisteredAsCatch,className:`w-full py-2.5 px-4 rounded-xl font-medium flex items-center justify-center gap-2 transition-all border-0 outline-none ${o.isRegisteredAsCatch?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600"}`,children:[g.jsx(kr,{size:18}),o.isRegisteredAsCatch?"Al geregistreerd":"Registreer vangst"]})]}),g.jsx("button",{onClick:L,className:"w-full py-2 px-4 text-red-500 hover:bg-red-50 rounded-xl font-medium transition-all border-0 outline-none",children:"Verwijderen"})]})]})]})})})}function KX(){const n=In(s=>s.spotFormOpen),e=In(s=>s.spotFormLocation),t=In(s=>s.closeSpotForm),r=14*We(s=>s.fontScale)/100;return g.jsx(UX,{children:g.jsxs("div",{className:"h-screen w-screen overflow-hidden",style:{fontSize:`${r}px`},children:[g.jsx(WH,{}),g.jsx(qq,{}),g.jsx(MX,{}),g.jsx($X,{}),g.jsx(LX,{}),g.jsx(zX,{}),g.jsx(Gq,{}),g.jsx(TX,{}),g.jsx(Xq,{}),g.jsx(Zq,{}),g.jsx(lX,{}),g.jsx(rX,{}),g.jsx(BX,{}),g.jsx(FX,{}),g.jsx(DX,{}),g.jsx(Hq,{}),g.jsx(Qq,{}),g.jsx(VX,{}),g.jsx(HX,{}),g.jsx(dn,{children:n&&g.jsx(OX,{onClose:t,initialLocation:e||void 0})})]})})}const qX="1.2.40";console.log(`%c VisApp v${qX}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");window.location.hash.includes("access_token")&&di.getState().handleAuthCallback()&&console.log("%c Google Photos authenticated","background: #4CAF50; color: white; padding: 2px 6px; border-radius: 4px;");ML.createRoot(document.getElementById("root")).render(g.jsx(KX,{}));export{dP as $,Kx as A,ro as B,WP as C,Vn as D,Ge as E,ki as F,cY as G,ZX as H,Ue as I,gY as J,P4 as K,u0 as L,Zx as M,k_ as N,JI as O,L1 as P,QX as Q,JX as R,qn as S,Vh as T,a0 as U,r0 as V,U1 as W,rd as X,k1 as Y,GA as Z,uP as _,h0 as a,hV as a0,sb as a1,eu as a2,rb as a3,dV as a4,G1 as a5,W1 as a6,gP as a7,oV as a8,Xm as a9,it as aA,Zp as aB,NP as aC,sv as aD,gu as aE,aV as aF,c9 as aG,ir as aH,n0 as aI,N1 as aJ,pl as aK,B6 as aL,p4 as aa,hP as ab,fP as ac,iY as ad,Qp as ae,fV as af,sY as ag,pP as ah,nu as ai,la as aj,$A as ak,eY as al,tY as am,rY as an,dY as ao,hY as ap,ib as aq,n3 as ar,i3 as as,uY as at,aY as au,Fd as av,oY as aw,nY as ax,xr as ay,El as az,ca as b,jn as c,hn as d,pu as e,Xo as f,gl as g,ct as h,Jm as i,Kn as j,ui as k,Zh as l,eo as m,lY as n,Tl as o,Ub as p,V6 as q,j6 as r,rt as s,z6 as t,At as u,jP as v,P1 as w,Tp as x,Nd as y,Qg as z};
//# sourceMappingURL=index-Di4WjQrJ.js.map
