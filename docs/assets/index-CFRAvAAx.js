const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-IOKJg3XX.js","assets/GeoJSON-BA-k4zKV.js","assets/boothellingenOL-C7JgCh2x.js","assets/viswaterOL-ZFHWmdgG.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function gw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var V_={exports:{}},Th={},F_={exports:{}},Ge={};var MT;function xN(){if(MT)return Ge;MT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator;function y(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,C={};function x(G,$,xe){this.props=G,this.context=$,this.refs=C,this.updater=xe||E}x.prototype.isReactComponent={},x.prototype.setState=function(G,$){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,$,"setState")},x.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function b(){}b.prototype=x.prototype;function D(G,$,xe){this.props=G,this.context=$,this.refs=C,this.updater=xe||E}var L=D.prototype=new b;L.constructor=D,I(L,x.prototype),L.isPureReactComponent=!0;var O=Array.isArray,F=Object.prototype.hasOwnProperty,W={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function R(G,$,xe){var Te,Ie={},be=null,Me=null;if($!=null)for(Te in $.ref!==void 0&&(Me=$.ref),$.key!==void 0&&(be=""+$.key),$)F.call($,Te)&&!P.hasOwnProperty(Te)&&(Ie[Te]=$[Te]);var Ve=arguments.length-2;if(Ve===1)Ie.children=xe;else if(1<Ve){for(var Be=Array(Ve),lt=0;lt<Ve;lt++)Be[lt]=arguments[lt+2];Ie.children=Be}if(G&&G.defaultProps)for(Te in Ve=G.defaultProps,Ve)Ie[Te]===void 0&&(Ie[Te]=Ve[Te]);return{$$typeof:n,type:G,key:be,ref:Me,props:Ie,_owner:W.current}}function k(G,$){return{$$typeof:n,type:G.type,key:$,ref:G.ref,props:G.props,_owner:G._owner}}function V(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function j(G){var $={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(xe){return $[xe]})}var z=/\/+/g;function N(G,$){return typeof G=="object"&&G!==null&&G.key!=null?j(""+G.key):$.toString(36)}function le(G,$,xe,Te,Ie){var be=typeof G;(be==="undefined"||be==="boolean")&&(G=null);var Me=!1;if(G===null)Me=!0;else switch(be){case"string":case"number":Me=!0;break;case"object":switch(G.$$typeof){case n:case e:Me=!0}}if(Me)return Me=G,Ie=Ie(Me),G=Te===""?"."+N(Me,0):Te,O(Ie)?(xe="",G!=null&&(xe=G.replace(z,"$&/")+"/"),le(Ie,$,xe,"",function(lt){return lt})):Ie!=null&&(V(Ie)&&(Ie=k(Ie,xe+(!Ie.key||Me&&Me.key===Ie.key?"":(""+Ie.key).replace(z,"$&/")+"/")+G)),$.push(Ie)),1;if(Me=0,Te=Te===""?".":Te+":",O(G))for(var Ve=0;Ve<G.length;Ve++){be=G[Ve];var Be=Te+N(be,Ve);Me+=le(be,$,xe,Be,Ie)}else if(Be=y(G),typeof Be=="function")for(G=Be.call(G),Ve=0;!(be=G.next()).done;)be=be.value,Be=Te+N(be,Ve++),Me+=le(be,$,xe,Be,Ie);else if(be==="object")throw $=String(G),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Me}function me(G,$,xe){if(G==null)return G;var Te=[],Ie=0;return le(G,Te,"","",function(be){return $.call(xe,be,Ie++)}),Te}function fe(G){if(G._status===-1){var $=G._result;$=$(),$.then(function(xe){(G._status===0||G._status===-1)&&(G._status=1,G._result=xe)},function(xe){(G._status===0||G._status===-1)&&(G._status=2,G._result=xe)}),G._status===-1&&(G._status=0,G._result=$)}if(G._status===1)return G._result.default;throw G._result}var ce={current:null},ee={transition:null},oe={ReactCurrentDispatcher:ce,ReactCurrentBatchConfig:ee,ReactCurrentOwner:W};function ne(){throw Error("act(...) is not supported in production builds of React.")}return Ge.Children={map:me,forEach:function(G,$,xe){me(G,function(){$.apply(this,arguments)},xe)},count:function(G){var $=0;return me(G,function(){$++}),$},toArray:function(G){return me(G,function($){return $})||[]},only:function(G){if(!V(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},Ge.Component=x,Ge.Fragment=t,Ge.Profiler=r,Ge.PureComponent=D,Ge.StrictMode=i,Ge.Suspense=c,Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oe,Ge.act=ne,Ge.cloneElement=function(G,$,xe){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var Te=I({},G.props),Ie=G.key,be=G.ref,Me=G._owner;if($!=null){if($.ref!==void 0&&(be=$.ref,Me=W.current),$.key!==void 0&&(Ie=""+$.key),G.type&&G.type.defaultProps)var Ve=G.type.defaultProps;for(Be in $)F.call($,Be)&&!P.hasOwnProperty(Be)&&(Te[Be]=$[Be]===void 0&&Ve!==void 0?Ve[Be]:$[Be])}var Be=arguments.length-2;if(Be===1)Te.children=xe;else if(1<Be){Ve=Array(Be);for(var lt=0;lt<Be;lt++)Ve[lt]=arguments[lt+2];Te.children=Ve}return{$$typeof:n,type:G.type,key:Ie,ref:be,props:Te,_owner:Me}},Ge.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:s,_context:G},G.Consumer=G},Ge.createElement=R,Ge.createFactory=function(G){var $=R.bind(null,G);return $.type=G,$},Ge.createRef=function(){return{current:null}},Ge.forwardRef=function(G){return{$$typeof:l,render:G}},Ge.isValidElement=V,Ge.lazy=function(G){return{$$typeof:f,_payload:{_status:-1,_result:G},_init:fe}},Ge.memo=function(G,$){return{$$typeof:h,type:G,compare:$===void 0?null:$}},Ge.startTransition=function(G){var $=ee.transition;ee.transition={};try{G()}finally{ee.transition=$}},Ge.unstable_act=ne,Ge.useCallback=function(G,$){return ce.current.useCallback(G,$)},Ge.useContext=function(G){return ce.current.useContext(G)},Ge.useDebugValue=function(){},Ge.useDeferredValue=function(G){return ce.current.useDeferredValue(G)},Ge.useEffect=function(G,$){return ce.current.useEffect(G,$)},Ge.useId=function(){return ce.current.useId()},Ge.useImperativeHandle=function(G,$,xe){return ce.current.useImperativeHandle(G,$,xe)},Ge.useInsertionEffect=function(G,$){return ce.current.useInsertionEffect(G,$)},Ge.useLayoutEffect=function(G,$){return ce.current.useLayoutEffect(G,$)},Ge.useMemo=function(G,$){return ce.current.useMemo(G,$)},Ge.useReducer=function(G,$,xe){return ce.current.useReducer(G,$,xe)},Ge.useRef=function(G){return ce.current.useRef(G)},Ge.useState=function(G){return ce.current.useState(G)},Ge.useSyncExternalStore=function(G,$,xe){return ce.current.useSyncExternalStore(G,$,xe)},Ge.useTransition=function(){return ce.current.useTransition()},Ge.version="18.3.1",Ge}var NT;function Wd(){return NT||(NT=1,F_.exports=xN()),F_.exports}var LT;function TN(){if(LT)return Th;LT=1;var n=Wd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,c,h){var f,m={},y=null,E=null;h!==void 0&&(y=""+h),c.key!==void 0&&(y=""+c.key),c.ref!==void 0&&(E=c.ref);for(f in c)i.call(c,f)&&!s.hasOwnProperty(f)&&(m[f]=c[f]);if(l&&l.defaultProps)for(f in c=l.defaultProps,c)m[f]===void 0&&(m[f]=c[f]);return{$$typeof:e,type:l,key:y,ref:E,props:m,_owner:r.current}}return Th.Fragment=t,Th.jsx=o,Th.jsxs=o,Th}var OT;function IN(){return OT||(OT=1,V_.exports=TN()),V_.exports}var T=IN(),Ig={},j_={exports:{}},Qn={},U_={exports:{}},z_={};var VT;function SN(){return VT||(VT=1,(function(n){function e(ee,oe){var ne=ee.length;ee.push(oe);e:for(;0<ne;){var G=ne-1>>>1,$=ee[G];if(0<r($,oe))ee[G]=oe,ee[ne]=$,ne=G;else break e}}function t(ee){return ee.length===0?null:ee[0]}function i(ee){if(ee.length===0)return null;var oe=ee[0],ne=ee.pop();if(ne!==oe){ee[0]=ne;e:for(var G=0,$=ee.length,xe=$>>>1;G<xe;){var Te=2*(G+1)-1,Ie=ee[Te],be=Te+1,Me=ee[be];if(0>r(Ie,ne))be<$&&0>r(Me,Ie)?(ee[G]=Me,ee[be]=ne,G=be):(ee[G]=Ie,ee[Te]=ne,G=Te);else if(be<$&&0>r(Me,ne))ee[G]=Me,ee[be]=ne,G=be;else break e}}return oe}function r(ee,oe){var ne=ee.sortIndex-oe.sortIndex;return ne!==0?ne:ee.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],h=[],f=1,m=null,y=3,E=!1,I=!1,C=!1,x=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function L(ee){for(var oe=t(h);oe!==null;){if(oe.callback===null)i(h);else if(oe.startTime<=ee)i(h),oe.sortIndex=oe.expirationTime,e(c,oe);else break;oe=t(h)}}function O(ee){if(C=!1,L(ee),!I)if(t(c)!==null)I=!0,fe(F);else{var oe=t(h);oe!==null&&ce(O,oe.startTime-ee)}}function F(ee,oe){I=!1,C&&(C=!1,b(R),R=-1),E=!0;var ne=y;try{for(L(oe),m=t(c);m!==null&&(!(m.expirationTime>oe)||ee&&!j());){var G=m.callback;if(typeof G=="function"){m.callback=null,y=m.priorityLevel;var $=G(m.expirationTime<=oe);oe=n.unstable_now(),typeof $=="function"?m.callback=$:m===t(c)&&i(c),L(oe)}else i(c);m=t(c)}if(m!==null)var xe=!0;else{var Te=t(h);Te!==null&&ce(O,Te.startTime-oe),xe=!1}return xe}finally{m=null,y=ne,E=!1}}var W=!1,P=null,R=-1,k=5,V=-1;function j(){return!(n.unstable_now()-V<k)}function z(){if(P!==null){var ee=n.unstable_now();V=ee;var oe=!0;try{oe=P(!0,ee)}finally{oe?N():(W=!1,P=null)}}else W=!1}var N;if(typeof D=="function")N=function(){D(z)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,me=le.port2;le.port1.onmessage=z,N=function(){me.postMessage(null)}}else N=function(){x(z,0)};function fe(ee){P=ee,W||(W=!0,N())}function ce(ee,oe){R=x(function(){ee(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ee){ee.callback=null},n.unstable_continueExecution=function(){I||E||(I=!0,fe(F))},n.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<ee?Math.floor(1e3/ee):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(ee){switch(y){case 1:case 2:case 3:var oe=3;break;default:oe=y}var ne=y;y=oe;try{return ee()}finally{y=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ee,oe){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ne=y;y=ee;try{return oe()}finally{y=ne}},n.unstable_scheduleCallback=function(ee,oe,ne){var G=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?G+ne:G):ne=G,ee){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,ee={id:f++,callback:oe,priorityLevel:ee,startTime:ne,expirationTime:$,sortIndex:-1},ne>G?(ee.sortIndex=ne,e(h,ee),t(c)===null&&ee===t(h)&&(C?(b(R),R=-1):C=!0,ce(O,ne-G))):(ee.sortIndex=$,e(c,ee),I||E||(I=!0,fe(F))),ee},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(ee){var oe=y;return function(){var ne=y;y=oe;try{return ee.apply(this,arguments)}finally{y=ne}}}})(z_)),z_}var FT;function CN(){return FT||(FT=1,U_.exports=SN()),U_.exports}var jT;function RN(){if(jT)return Qn;jT=1;var n=Wd(),e=CN();function t(a){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)u+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,u){o(a,u),o(a+"Capture",u)}function o(a,u){for(r[a]=u,a=0;a<u.length;a++)i.add(u[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function y(a){return c.call(m,a)?!0:c.call(f,a)?!1:h.test(a)?m[a]=!0:(f[a]=!0,!1)}function E(a,u,d,p){if(d!==null&&d.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return p?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function I(a,u,d,p){if(u===null||typeof u>"u"||E(a,u,d,p))return!0;if(p)return!1;if(d!==null)switch(d.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function C(a,u,d,p,_,v,A){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=p,this.attributeNamespace=_,this.mustUseProperty=d,this.propertyName=a,this.type=u,this.sanitizeURL=v,this.removeEmptyString=A}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){x[a]=new C(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var u=a[0];x[u]=new C(u,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){x[a]=new C(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){x[a]=new C(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){x[a]=new C(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){x[a]=new C(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){x[a]=new C(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){x[a]=new C(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){x[a]=new C(a,5,!1,a.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function D(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var u=a.replace(b,D);x[u]=new C(u,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var u=a.replace(b,D);x[u]=new C(u,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var u=a.replace(b,D);x[u]=new C(u,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){x[a]=new C(a,1,!1,a.toLowerCase(),null,!1,!1)}),x.xlinkHref=new C("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){x[a]=new C(a,1,!1,a.toLowerCase(),null,!0,!0)});function L(a,u,d,p){var _=x.hasOwnProperty(u)?x[u]:null;(_!==null?_.type!==0:p||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(I(u,d,_,p)&&(d=null),p||_===null?y(u)&&(d===null?a.removeAttribute(u):a.setAttribute(u,""+d)):_.mustUseProperty?a[_.propertyName]=d===null?_.type===3?!1:"":d:(u=_.attributeName,p=_.attributeNamespace,d===null?a.removeAttribute(u):(_=_.type,d=_===3||_===4&&d===!0?"":""+d,p?a.setAttributeNS(p,u,d):a.setAttribute(u,d))))}var O=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),W=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),j=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),ce=Symbol.for("react.offscreen"),ee=Symbol.iterator;function oe(a){return a===null||typeof a!="object"?null:(a=ee&&a[ee]||a["@@iterator"],typeof a=="function"?a:null)}var ne=Object.assign,G;function $(a){if(G===void 0)try{throw Error()}catch(d){var u=d.stack.trim().match(/\n( *(at )?)/);G=u&&u[1]||""}return`
`+G+a}var xe=!1;function Te(a,u){if(!a||xe)return"";xe=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(Z){var p=Z}Reflect.construct(a,[],u)}else{try{u.call()}catch(Z){p=Z}a.call(u.prototype)}else{try{throw Error()}catch(Z){p=Z}a()}}catch(Z){if(Z&&p&&typeof Z.stack=="string"){for(var _=Z.stack.split(`
`),v=p.stack.split(`
`),A=_.length-1,U=v.length-1;1<=A&&0<=U&&_[A]!==v[U];)U--;for(;1<=A&&0<=U;A--,U--)if(_[A]!==v[U]){if(A!==1||U!==1)do if(A--,U--,0>U||_[A]!==v[U]){var B=`
`+_[A].replace(" at new "," at ");return a.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",a.displayName)),B}while(1<=A&&0<=U);break}}}finally{xe=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?$(a):""}function Ie(a){switch(a.tag){case 5:return $(a.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return a=Te(a.type,!1),a;case 11:return a=Te(a.type.render,!1),a;case 1:return a=Te(a.type,!0),a;default:return""}}function be(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case P:return"Fragment";case W:return"Portal";case k:return"Profiler";case R:return"StrictMode";case N:return"Suspense";case le:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case j:return(a.displayName||"Context")+".Consumer";case V:return(a._context.displayName||"Context")+".Provider";case z:var u=a.render;return a=a.displayName,a||(a=u.displayName||u.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case me:return u=a.displayName||null,u!==null?u:be(a.type)||"Memo";case fe:u=a._payload,a=a._init;try{return be(a(u))}catch{}}return null}function Me(a){var u=a.type;switch(a.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=u.render,a=a.displayName||a.name||"",u.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return be(u);case 8:return u===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function Ve(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Be(a){var u=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function lt(a){var u=Be(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,u),p=""+a[u];if(!a.hasOwnProperty(u)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var _=d.get,v=d.set;return Object.defineProperty(a,u,{configurable:!0,get:function(){return _.call(this)},set:function(A){p=""+A,v.call(this,A)}}),Object.defineProperty(a,u,{enumerable:d.enumerable}),{getValue:function(){return p},setValue:function(A){p=""+A},stopTracking:function(){a._valueTracker=null,delete a[u]}}}}function Qi(a){a._valueTracker||(a._valueTracker=lt(a))}function fs(a){if(!a)return!1;var u=a._valueTracker;if(!u)return!0;var d=u.getValue(),p="";return a&&(p=Be(a)?a.checked?"true":"false":a.value),a=p,a!==d?(u.setValue(a),!0):!1}function Wn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Kn(a,u){var d=u.checked;return ne({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function hn(a,u){var d=u.defaultValue==null?"":u.defaultValue,p=u.checked!=null?u.checked:u.defaultChecked;d=Ve(u.value!=null?u.value:d),a._wrapperState={initialChecked:p,initialValue:d,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function dn(a,u){u=u.checked,u!=null&&L(a,"checked",u,!1)}function $n(a,u){dn(a,u);var d=Ve(u.value),p=u.type;if(d!=null)p==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(p==="submit"||p==="reset"){a.removeAttribute("value");return}u.hasOwnProperty("value")?yt(a,u.type,d):u.hasOwnProperty("defaultValue")&&yt(a,u.type,Ve(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(a.defaultChecked=!!u.defaultChecked)}function Ci(a,u,d){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var p=u.type;if(!(p!=="submit"&&p!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+a._wrapperState.initialValue,d||u===a.value||(a.value=u),a.defaultValue=u}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function yt(a,u,d){(u!=="number"||Wn(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ut=Array.isArray;function tn(a,u,d,p){if(a=a.options,u){u={};for(var _=0;_<d.length;_++)u["$"+d[_]]=!0;for(d=0;d<a.length;d++)_=u.hasOwnProperty("$"+a[d].value),a[d].selected!==_&&(a[d].selected=_),_&&p&&(a[d].defaultSelected=!0)}else{for(d=""+Ve(d),u=null,_=0;_<a.length;_++){if(a[_].value===d){a[_].selected=!0,p&&(a[_].defaultSelected=!0);return}u!==null||a[_].disabled||(u=a[_])}u!==null&&(u.selected=!0)}}function Ri(a,u){if(u.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},u,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function It(a,u){var d=u.value;if(d==null){if(d=u.children,u=u.defaultValue,d!=null){if(u!=null)throw Error(t(92));if(ut(d)){if(1<d.length)throw Error(t(93));d=d[0]}u=d}u==null&&(u=""),d=u}a._wrapperState={initialValue:Ve(d)}}function Js(a,u){var d=Ve(u.value),p=Ve(u.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),u.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),p!=null&&(a.defaultValue=""+p)}function Ai(a){var u=a.textContent;u===a._wrapperState.initialValue&&u!==""&&u!==null&&(a.value=u)}function Sr(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ji(a,u){return a==null||a==="http://www.w3.org/1999/xhtml"?Sr(u):a==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Cr,ua=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,d,p,_){MSApp.execUnsafeLocalFunction(function(){return a(u,d,p,_)})}:a})(function(a,u){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=u;else{for(Cr=Cr||document.createElement("div"),Cr.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=Cr.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;u.firstChild;)a.appendChild(u.firstChild)}});function Rr(a,u){if(u){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=u;return}}a.textContent=u}var Pi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ll=["Webkit","ms","Moz","O"];Object.keys(Pi).forEach(function(a){Ll.forEach(function(u){u=u+a.charAt(0).toUpperCase()+a.substring(1),Pi[u]=Pi[a]})});function Ar(a,u,d){return u==null||typeof u=="boolean"||u===""?"":d||typeof u!="number"||u===0||Pi.hasOwnProperty(a)&&Pi[a]?(""+u).trim():u+"px"}function gs(a,u){a=a.style;for(var d in u)if(u.hasOwnProperty(d)){var p=d.indexOf("--")===0,_=Ar(d,u[d],p);d==="float"&&(d="cssFloat"),p?a.setProperty(d,_):a[d]=_}}var eo=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function On(a,u){if(u){if(eo[a]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(t(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(t(61))}if(u.style!=null&&typeof u.style!="object")throw Error(t(62))}}function ps(a,u){if(a.indexOf("-")===-1)return typeof u.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pr=null;function br(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Vn=null,Fn=null,ft=null;function to(a){if(a=lh(a)){if(typeof Vn!="function")throw Error(t(280));var u=a.stateNode;u&&(u=jf(u),Vn(a.stateNode,a.type,u))}}function er(a){Fn?ft?ft.push(a):ft=[a]:Fn=a}function Ot(){if(Fn){var a=Fn,u=ft;if(ft=Fn=null,to(a),u)for(a=0;a<u.length;a++)to(u[a])}}function bi(a,u){return a(u)}function fn(){}var Vt=!1;function gn(a,u,d){if(Vt)return a(u,d);Vt=!0;try{return bi(a,u,d)}finally{Vt=!1,(Fn!==null||ft!==null)&&(fn(),Ot())}}function pn(a,u){var d=a.stateNode;if(d===null)return null;var p=jf(d);if(p===null)return null;d=p[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(a=a.type,p=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!p;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,u,typeof d));return d}var nn=!1;if(l)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){nn=!0}}),window.addEventListener("test",rt,rt),window.removeEventListener("test",rt,rt)}catch{nn=!1}function Bt(a,u,d,p,_,v,A,U,B){var Z=Array.prototype.slice.call(arguments,3);try{u.apply(d,Z)}catch(re){this.onError(re)}}var Xt=!1,ki=null,Ol=!1,Di=null,yf={onError:function(a){Xt=!0,ki=a}};function _f(a,u,d,p,_,v,A,U,B){Xt=!1,ki=null,Bt.apply(yf,arguments)}function Oc(a,u,d,p,_,v,A,U,B){if(_f.apply(this,arguments),Xt){if(Xt){var Z=ki;Xt=!1,ki=null}else throw Error(t(198));Ol||(Ol=!0,Di=Z)}}function tr(a){var u=a,d=a;if(a.alternate)for(;u.return;)u=u.return;else{a=u;do u=a,(u.flags&4098)!==0&&(d=u.return),a=u.return;while(a)}return u.tag===3?d:null}function Vc(a){if(a.tag===13){var u=a.memoizedState;if(u===null&&(a=a.alternate,a!==null&&(u=a.memoizedState)),u!==null)return u.dehydrated}return null}function vf(a){if(tr(a)!==a)throw Error(t(188))}function wf(a){var u=a.alternate;if(!u){if(u=tr(a),u===null)throw Error(t(188));return u!==a?null:a}for(var d=a,p=u;;){var _=d.return;if(_===null)break;var v=_.alternate;if(v===null){if(p=_.return,p!==null){d=p;continue}break}if(_.child===v.child){for(v=_.child;v;){if(v===d)return vf(_),a;if(v===p)return vf(_),u;v=v.sibling}throw Error(t(188))}if(d.return!==p.return)d=_,p=v;else{for(var A=!1,U=_.child;U;){if(U===d){A=!0,d=_,p=v;break}if(U===p){A=!0,p=_,d=v;break}U=U.sibling}if(!A){for(U=v.child;U;){if(U===d){A=!0,d=v,p=_;break}if(U===p){A=!0,p=v,d=_;break}U=U.sibling}if(!A)throw Error(t(189))}}if(d.alternate!==p)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:u}function Ef(a){return a=wf(a),a!==null?ca(a):null}function ca(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var u=ca(a);if(u!==null)return u;a=a.sibling}return null}var Fc=e.unstable_scheduleCallback,Vl=e.unstable_cancelCallback,ha=e.unstable_shouldYield,ms=e.unstable_requestPaint,vt=e.unstable_now,gy=e.unstable_getCurrentPriorityLevel,Fl=e.unstable_ImmediatePriority,jc=e.unstable_UserBlockingPriority,da=e.unstable_NormalPriority,Uc=e.unstable_LowPriority,jl=e.unstable_IdlePriority,fa=null,ui=null;function xf(a){if(ui&&typeof ui.onCommitFiberRoot=="function")try{ui.onCommitFiberRoot(fa,a,void 0,(a.current.flags&128)===128)}catch{}}var ci=Math.clz32?Math.clz32:ga,kr=Math.log,Mi=Math.LN2;function ga(a){return a>>>=0,a===0?32:31-(kr(a)/Mi|0)|0}var Dr=64,no=4194304;function st(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ys(a,u){var d=a.pendingLanes;if(d===0)return 0;var p=0,_=a.suspendedLanes,v=a.pingedLanes,A=d&268435455;if(A!==0){var U=A&~_;U!==0?p=st(U):(v&=A,v!==0&&(p=st(v)))}else A=d&~_,A!==0?p=st(A):v!==0&&(p=st(v));if(p===0)return 0;if(u!==0&&u!==p&&(u&_)===0&&(_=p&-p,v=u&-u,_>=v||_===16&&(v&4194240)!==0))return u;if((p&4)!==0&&(p|=d&16),u=a.entangledLanes,u!==0)for(a=a.entanglements,u&=p;0<u;)d=31-ci(u),_=1<<d,p|=a[d],u&=~_;return p}function pa(a,u){switch(a){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ma(a,u){for(var d=a.suspendedLanes,p=a.pingedLanes,_=a.expirationTimes,v=a.pendingLanes;0<v;){var A=31-ci(v),U=1<<A,B=_[A];B===-1?((U&d)===0||(U&p)!==0)&&(_[A]=pa(U,u)):B<=u&&(a.expiredLanes|=U),v&=~U}}function zc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Bc(){var a=Dr;return Dr<<=1,(Dr&4194240)===0&&(Dr=64),a}function Gc(a){for(var u=[],d=0;31>d;d++)u.push(a);return u}function ya(a,u,d){a.pendingLanes|=u,u!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,u=31-ci(u),a[u]=d}function py(a,u){var d=a.pendingLanes&~u;a.pendingLanes=u,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=u,a.mutableReadLanes&=u,a.entangledLanes&=u,u=a.entanglements;var p=a.eventTimes;for(a=a.expirationTimes;0<d;){var _=31-ci(d),v=1<<_;u[_]=0,p[_]=-1,a[_]=-1,d&=~v}}function Wc(a,u){var d=a.entangledLanes|=u;for(a=a.entanglements;d;){var p=31-ci(d),_=1<<p;_&u|a[p]&u&&(a[p]|=u),d&=~_}}var He=0;function Mr(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Kc,Ul,$c,Hc,Xc,Nr=!1,zl=[],Lr=null,Or=null,mn=null,_a=new Map,_s=new Map,hi=[],Tf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function io(a,u){switch(a){case"focusin":case"focusout":Lr=null;break;case"dragenter":case"dragleave":Or=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":_a.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":_s.delete(u.pointerId)}}function nr(a,u,d,p,_,v){return a===null||a.nativeEvent!==v?(a={blockedOn:u,domEventName:d,eventSystemFlags:p,nativeEvent:v,targetContainers:[_]},u!==null&&(u=lh(u),u!==null&&Ul(u)),a):(a.eventSystemFlags|=p,u=a.targetContainers,_!==null&&u.indexOf(_)===-1&&u.push(_),a)}function If(a,u,d,p,_){switch(u){case"focusin":return Lr=nr(Lr,a,u,d,p,_),!0;case"dragenter":return Or=nr(Or,a,u,d,p,_),!0;case"mouseover":return mn=nr(mn,a,u,d,p,_),!0;case"pointerover":var v=_.pointerId;return _a.set(v,nr(_a.get(v)||null,a,u,d,p,_)),!0;case"gotpointercapture":return v=_.pointerId,_s.set(v,nr(_s.get(v)||null,a,u,d,p,_)),!0}return!1}function Bl(a){var u=xa(a.target);if(u!==null){var d=tr(u);if(d!==null){if(u=d.tag,u===13){if(u=Vc(d),u!==null){a.blockedOn=u,Xc(a.priority,function(){$c(d)});return}}else if(u===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pt(a){if(a.blockedOn!==null)return!1;for(var u=a.targetContainers;0<u.length;){var d=Gl(a.domEventName,a.eventSystemFlags,u[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var p=new d.constructor(d.type,d);Pr=p,d.target.dispatchEvent(p),Pr=null}else return u=lh(d),u!==null&&Ul(u),a.blockedOn=d,!1;u.shift()}return!0}function Sf(a,u,d){pt(a)&&d.delete(u)}function my(){Nr=!1,Lr!==null&&pt(Lr)&&(Lr=null),Or!==null&&pt(Or)&&(Or=null),mn!==null&&pt(mn)&&(mn=null),_a.forEach(Sf),_s.forEach(Sf)}function ro(a,u){a.blockedOn===u&&(a.blockedOn=null,Nr||(Nr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,my)))}function so(a){function u(_){return ro(_,a)}if(0<zl.length){ro(zl[0],a);for(var d=1;d<zl.length;d++){var p=zl[d];p.blockedOn===a&&(p.blockedOn=null)}}for(Lr!==null&&ro(Lr,a),Or!==null&&ro(Or,a),mn!==null&&ro(mn,a),_a.forEach(u),_s.forEach(u),d=0;d<hi.length;d++)p=hi[d],p.blockedOn===a&&(p.blockedOn=null);for(;0<hi.length&&(d=hi[0],d.blockedOn===null);)Bl(d),d.blockedOn===null&&hi.shift()}var vs=O.ReactCurrentBatchConfig,ws=!0;function Vr(a,u,d,p){var _=He,v=vs.transition;vs.transition=null;try{He=1,qc(a,u,d,p)}finally{He=_,vs.transition=v}}function Cf(a,u,d,p){var _=He,v=vs.transition;vs.transition=null;try{He=4,qc(a,u,d,p)}finally{He=_,vs.transition=v}}function qc(a,u,d,p){if(ws){var _=Gl(a,u,d,p);if(_===null)Ry(a,u,p,Fr,d),io(a,p);else if(If(_,a,u,d,p))p.stopPropagation();else if(io(a,p),u&4&&-1<Tf.indexOf(a)){for(;_!==null;){var v=lh(_);if(v!==null&&Kc(v),v=Gl(a,u,d,p),v===null&&Ry(a,u,p,Fr,d),v===_)break;_=v}_!==null&&p.stopPropagation()}else Ry(a,u,p,null,d)}}var Fr=null;function Gl(a,u,d,p){if(Fr=null,a=br(p),a=xa(a),a!==null)if(u=tr(a),u===null)a=null;else if(d=u.tag,d===13){if(a=Vc(u),a!==null)return a;a=null}else if(d===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;a=null}else u!==a&&(a=null);return Fr=a,null}function Wl(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gy()){case Fl:return 1;case jc:return 4;case da:case Uc:return 16;case jl:return 536870912;default:return 16}default:return 16}}var di=null,Kl=null,Es=null;function Rf(){if(Es)return Es;var a,u=Kl,d=u.length,p,_="value"in di?di.value:di.textContent,v=_.length;for(a=0;a<d&&u[a]===_[a];a++);var A=d-a;for(p=1;p<=A&&u[d-p]===_[v-p];p++);return Es=_.slice(a,1<p?1-p:void 0)}function va(a){var u=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&u===13&&(a=13)):a=u,a===10&&(a=13),32<=a||a===13?a:0}function jr(){return!0}function Yc(){return!1}function Cn(a){function u(d,p,_,v,A){this._reactName=d,this._targetInst=_,this.type=p,this.nativeEvent=v,this.target=A,this.currentTarget=null;for(var U in a)a.hasOwnProperty(U)&&(d=a[U],this[U]=d?d(v):v[U]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?jr:Yc,this.isPropagationStopped=Yc,this}return ne(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=jr)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=jr)},persist:function(){},isPersistent:jr}),u}var Ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wa=Cn(Ur),oo=ne({},Ur,{view:0,detail:0}),$l=Cn(oo),Hl,Xl,fi,Ea=ne({},oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fe,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==fi&&(fi&&a.type==="mousemove"?(Hl=a.screenX-fi.screenX,Xl=a.screenY-fi.screenY):Xl=Hl=0,fi=a),Hl)},movementY:function(a){return"movementY"in a?a.movementY:Xl}}),Zc=Cn(Ea),Af=ne({},Ea,{dataTransfer:0}),Pf=Cn(Af),ql=ne({},oo,{relatedTarget:0}),yn=Cn(ql),bf=ne({},Ur,{animationName:0,elapsedTime:0,pseudoElement:0}),kf=Cn(bf),ao=ne({},Ur,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=Cn(ao),w=ne({},Ur,{data:0}),S=Cn(w),M={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function he(a){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(a):(a=Q[a])?!!u[a]:!1}function Fe(){return he}var Ft=ne({},oo,{key:function(a){if(a.key){var u=M[a.key]||a.key;if(u!=="Unidentified")return u}return a.type==="keypress"?(a=va(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?X[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fe,charCode:function(a){return a.type==="keypress"?va(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?va(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ct=Cn(Ft),Gt=ne({},Ea,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gi=Cn(Gt),xs=ne({},oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fe}),zr=Cn(xs),Br=ne({},Ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yl=Cn(Br),Qc=ne({},Ea,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),mM=Cn(Qc),yM=[9,13,27,32],yy=l&&"CompositionEvent"in window,Jc=null;l&&"documentMode"in document&&(Jc=document.documentMode);var _M=l&&"TextEvent"in window&&!Jc,Sx=l&&(!yy||Jc&&8<Jc&&11>=Jc),Cx=" ",Rx=!1;function Ax(a,u){switch(a){case"keyup":return yM.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Px(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Zl=!1;function vM(a,u){switch(a){case"compositionend":return Px(u);case"keypress":return u.which!==32?null:(Rx=!0,Cx);case"textInput":return a=u.data,a===Cx&&Rx?null:a;default:return null}}function wM(a,u){if(Zl)return a==="compositionend"||!yy&&Ax(a,u)?(a=Rf(),Es=Kl=di=null,Zl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Sx&&u.locale!=="ko"?null:u.data;default:return null}}var EM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bx(a){var u=a&&a.nodeName&&a.nodeName.toLowerCase();return u==="input"?!!EM[a.type]:u==="textarea"}function kx(a,u,d,p){er(p),u=Of(u,"onChange"),0<u.length&&(d=new wa("onChange","change",null,d,p),a.push({event:d,listeners:u}))}var eh=null,th=null;function xM(a){qx(a,0)}function Df(a){var u=nu(a);if(fs(u))return a}function TM(a,u){if(a==="change")return u}var Dx=!1;if(l){var _y;if(l){var vy="oninput"in document;if(!vy){var Mx=document.createElement("div");Mx.setAttribute("oninput","return;"),vy=typeof Mx.oninput=="function"}_y=vy}else _y=!1;Dx=_y&&(!document.documentMode||9<document.documentMode)}function Nx(){eh&&(eh.detachEvent("onpropertychange",Lx),th=eh=null)}function Lx(a){if(a.propertyName==="value"&&Df(th)){var u=[];kx(u,th,a,br(a)),gn(xM,u)}}function IM(a,u,d){a==="focusin"?(Nx(),eh=u,th=d,eh.attachEvent("onpropertychange",Lx)):a==="focusout"&&Nx()}function SM(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Df(th)}function CM(a,u){if(a==="click")return Df(u)}function RM(a,u){if(a==="input"||a==="change")return Df(u)}function AM(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}var ir=typeof Object.is=="function"?Object.is:AM;function nh(a,u){if(ir(a,u))return!0;if(typeof a!="object"||a===null||typeof u!="object"||u===null)return!1;var d=Object.keys(a),p=Object.keys(u);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var _=d[p];if(!c.call(u,_)||!ir(a[_],u[_]))return!1}return!0}function Ox(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Vx(a,u){var d=Ox(a);a=0;for(var p;d;){if(d.nodeType===3){if(p=a+d.textContent.length,a<=u&&p>=u)return{node:d,offset:u-a};a=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Ox(d)}}function Fx(a,u){return a&&u?a===u?!0:a&&a.nodeType===3?!1:u&&u.nodeType===3?Fx(a,u.parentNode):"contains"in a?a.contains(u):a.compareDocumentPosition?!!(a.compareDocumentPosition(u)&16):!1:!1}function jx(){for(var a=window,u=Wn();u instanceof a.HTMLIFrameElement;){try{var d=typeof u.contentWindow.location.href=="string"}catch{d=!1}if(d)a=u.contentWindow;else break;u=Wn(a.document)}return u}function wy(a){var u=a&&a.nodeName&&a.nodeName.toLowerCase();return u&&(u==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||u==="textarea"||a.contentEditable==="true")}function PM(a){var u=jx(),d=a.focusedElem,p=a.selectionRange;if(u!==d&&d&&d.ownerDocument&&Fx(d.ownerDocument.documentElement,d)){if(p!==null&&wy(d)){if(u=p.start,a=p.end,a===void 0&&(a=u),"selectionStart"in d)d.selectionStart=u,d.selectionEnd=Math.min(a,d.value.length);else if(a=(u=d.ownerDocument||document)&&u.defaultView||window,a.getSelection){a=a.getSelection();var _=d.textContent.length,v=Math.min(p.start,_);p=p.end===void 0?v:Math.min(p.end,_),!a.extend&&v>p&&(_=p,p=v,v=_),_=Vx(d,v);var A=Vx(d,p);_&&A&&(a.rangeCount!==1||a.anchorNode!==_.node||a.anchorOffset!==_.offset||a.focusNode!==A.node||a.focusOffset!==A.offset)&&(u=u.createRange(),u.setStart(_.node,_.offset),a.removeAllRanges(),v>p?(a.addRange(u),a.extend(A.node,A.offset)):(u.setEnd(A.node,A.offset),a.addRange(u)))}}for(u=[],a=d;a=a.parentNode;)a.nodeType===1&&u.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<u.length;d++)a=u[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var bM=l&&"documentMode"in document&&11>=document.documentMode,Ql=null,Ey=null,ih=null,xy=!1;function Ux(a,u,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;xy||Ql==null||Ql!==Wn(p)||(p=Ql,"selectionStart"in p&&wy(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),ih&&nh(ih,p)||(ih=p,p=Of(Ey,"onSelect"),0<p.length&&(u=new wa("onSelect","select",null,u,d),a.push({event:u,listeners:p}),u.target=Ql)))}function Mf(a,u){var d={};return d[a.toLowerCase()]=u.toLowerCase(),d["Webkit"+a]="webkit"+u,d["Moz"+a]="moz"+u,d}var Jl={animationend:Mf("Animation","AnimationEnd"),animationiteration:Mf("Animation","AnimationIteration"),animationstart:Mf("Animation","AnimationStart"),transitionend:Mf("Transition","TransitionEnd")},Ty={},zx={};l&&(zx=document.createElement("div").style,"AnimationEvent"in window||(delete Jl.animationend.animation,delete Jl.animationiteration.animation,delete Jl.animationstart.animation),"TransitionEvent"in window||delete Jl.transitionend.transition);function Nf(a){if(Ty[a])return Ty[a];if(!Jl[a])return a;var u=Jl[a],d;for(d in u)if(u.hasOwnProperty(d)&&d in zx)return Ty[a]=u[d];return a}var Bx=Nf("animationend"),Gx=Nf("animationiteration"),Wx=Nf("animationstart"),Kx=Nf("transitionend"),$x=new Map,Hx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function lo(a,u){$x.set(a,u),s(u,[a])}for(var Iy=0;Iy<Hx.length;Iy++){var Sy=Hx[Iy],kM=Sy.toLowerCase(),DM=Sy[0].toUpperCase()+Sy.slice(1);lo(kM,"on"+DM)}lo(Bx,"onAnimationEnd"),lo(Gx,"onAnimationIteration"),lo(Wx,"onAnimationStart"),lo("dblclick","onDoubleClick"),lo("focusin","onFocus"),lo("focusout","onBlur"),lo(Kx,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MM=new Set("cancel close invalid load scroll toggle".split(" ").concat(rh));function Xx(a,u,d){var p=a.type||"unknown-event";a.currentTarget=d,Oc(p,u,void 0,a),a.currentTarget=null}function qx(a,u){u=(u&4)!==0;for(var d=0;d<a.length;d++){var p=a[d],_=p.event;p=p.listeners;e:{var v=void 0;if(u)for(var A=p.length-1;0<=A;A--){var U=p[A],B=U.instance,Z=U.currentTarget;if(U=U.listener,B!==v&&_.isPropagationStopped())break e;Xx(_,U,Z),v=B}else for(A=0;A<p.length;A++){if(U=p[A],B=U.instance,Z=U.currentTarget,U=U.listener,B!==v&&_.isPropagationStopped())break e;Xx(_,U,Z),v=B}}}if(Ol)throw a=Di,Ol=!1,Di=null,a}function wt(a,u){var d=u[My];d===void 0&&(d=u[My]=new Set);var p=a+"__bubble";d.has(p)||(Yx(u,a,2,!1),d.add(p))}function Cy(a,u,d){var p=0;u&&(p|=4),Yx(d,a,p,u)}var Lf="_reactListening"+Math.random().toString(36).slice(2);function sh(a){if(!a[Lf]){a[Lf]=!0,i.forEach(function(d){d!=="selectionchange"&&(MM.has(d)||Cy(d,!1,a),Cy(d,!0,a))});var u=a.nodeType===9?a:a.ownerDocument;u===null||u[Lf]||(u[Lf]=!0,Cy("selectionchange",!1,u))}}function Yx(a,u,d,p){switch(Wl(u)){case 1:var _=Vr;break;case 4:_=Cf;break;default:_=qc}d=_.bind(null,u,d,a),_=void 0,!nn||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(_=!0),p?_!==void 0?a.addEventListener(u,d,{capture:!0,passive:_}):a.addEventListener(u,d,!0):_!==void 0?a.addEventListener(u,d,{passive:_}):a.addEventListener(u,d,!1)}function Ry(a,u,d,p,_){var v=p;if((u&1)===0&&(u&2)===0&&p!==null)e:for(;;){if(p===null)return;var A=p.tag;if(A===3||A===4){var U=p.stateNode.containerInfo;if(U===_||U.nodeType===8&&U.parentNode===_)break;if(A===4)for(A=p.return;A!==null;){var B=A.tag;if((B===3||B===4)&&(B=A.stateNode.containerInfo,B===_||B.nodeType===8&&B.parentNode===_))return;A=A.return}for(;U!==null;){if(A=xa(U),A===null)return;if(B=A.tag,B===5||B===6){p=v=A;continue e}U=U.parentNode}}p=p.return}gn(function(){var Z=v,re=br(d),ae=[];e:{var ie=$x.get(a);if(ie!==void 0){var ge=wa,ye=a;switch(a){case"keypress":if(va(d)===0)break e;case"keydown":case"keyup":ge=ct;break;case"focusin":ye="focus",ge=yn;break;case"focusout":ye="blur",ge=yn;break;case"beforeblur":case"afterblur":ge=yn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=Zc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=Pf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=zr;break;case Bx:case Gx:case Wx:ge=kf;break;case Kx:ge=Yl;break;case"scroll":ge=$l;break;case"wheel":ge=mM;break;case"copy":case"cut":case"paste":ge=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=gi}var _e=(u&4)!==0,jt=!_e&&a==="scroll",H=_e?ie!==null?ie+"Capture":null:ie;_e=[];for(var K=Z,q;K!==null;){q=K;var ue=q.stateNode;if(q.tag===5&&ue!==null&&(q=ue,H!==null&&(ue=pn(K,H),ue!=null&&_e.push(oh(K,ue,q)))),jt)break;K=K.return}0<_e.length&&(ie=new ge(ie,ye,null,d,re),ae.push({event:ie,listeners:_e}))}}if((u&7)===0){e:{if(ie=a==="mouseover"||a==="pointerover",ge=a==="mouseout"||a==="pointerout",ie&&d!==Pr&&(ye=d.relatedTarget||d.fromElement)&&(xa(ye)||ye[Ts]))break e;if((ge||ie)&&(ie=re.window===re?re:(ie=re.ownerDocument)?ie.defaultView||ie.parentWindow:window,ge?(ye=d.relatedTarget||d.toElement,ge=Z,ye=ye?xa(ye):null,ye!==null&&(jt=tr(ye),ye!==jt||ye.tag!==5&&ye.tag!==6)&&(ye=null)):(ge=null,ye=Z),ge!==ye)){if(_e=Zc,ue="onMouseLeave",H="onMouseEnter",K="mouse",(a==="pointerout"||a==="pointerover")&&(_e=gi,ue="onPointerLeave",H="onPointerEnter",K="pointer"),jt=ge==null?ie:nu(ge),q=ye==null?ie:nu(ye),ie=new _e(ue,K+"leave",ge,d,re),ie.target=jt,ie.relatedTarget=q,ue=null,xa(re)===Z&&(_e=new _e(H,K+"enter",ye,d,re),_e.target=q,_e.relatedTarget=jt,ue=_e),jt=ue,ge&&ye)t:{for(_e=ge,H=ye,K=0,q=_e;q;q=eu(q))K++;for(q=0,ue=H;ue;ue=eu(ue))q++;for(;0<K-q;)_e=eu(_e),K--;for(;0<q-K;)H=eu(H),q--;for(;K--;){if(_e===H||H!==null&&_e===H.alternate)break t;_e=eu(_e),H=eu(H)}_e=null}else _e=null;ge!==null&&Zx(ae,ie,ge,_e,!1),ye!==null&&jt!==null&&Zx(ae,jt,ye,_e,!0)}}e:{if(ie=Z?nu(Z):window,ge=ie.nodeName&&ie.nodeName.toLowerCase(),ge==="select"||ge==="input"&&ie.type==="file")var we=TM;else if(bx(ie))if(Dx)we=RM;else{we=SM;var Ae=IM}else(ge=ie.nodeName)&&ge.toLowerCase()==="input"&&(ie.type==="checkbox"||ie.type==="radio")&&(we=CM);if(we&&(we=we(a,Z))){kx(ae,we,d,re);break e}Ae&&Ae(a,ie,Z),a==="focusout"&&(Ae=ie._wrapperState)&&Ae.controlled&&ie.type==="number"&&yt(ie,"number",ie.value)}switch(Ae=Z?nu(Z):window,a){case"focusin":(bx(Ae)||Ae.contentEditable==="true")&&(Ql=Ae,Ey=Z,ih=null);break;case"focusout":ih=Ey=Ql=null;break;case"mousedown":xy=!0;break;case"contextmenu":case"mouseup":case"dragend":xy=!1,Ux(ae,d,re);break;case"selectionchange":if(bM)break;case"keydown":case"keyup":Ux(ae,d,re)}var Pe;if(yy)e:{switch(a){case"compositionstart":var Ne="onCompositionStart";break e;case"compositionend":Ne="onCompositionEnd";break e;case"compositionupdate":Ne="onCompositionUpdate";break e}Ne=void 0}else Zl?Ax(a,d)&&(Ne="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Ne="onCompositionStart");Ne&&(Sx&&d.locale!=="ko"&&(Zl||Ne!=="onCompositionStart"?Ne==="onCompositionEnd"&&Zl&&(Pe=Rf()):(di=re,Kl="value"in di?di.value:di.textContent,Zl=!0)),Ae=Of(Z,Ne),0<Ae.length&&(Ne=new S(Ne,a,null,d,re),ae.push({event:Ne,listeners:Ae}),Pe?Ne.data=Pe:(Pe=Px(d),Pe!==null&&(Ne.data=Pe)))),(Pe=_M?vM(a,d):wM(a,d))&&(Z=Of(Z,"onBeforeInput"),0<Z.length&&(re=new S("onBeforeInput","beforeinput",null,d,re),ae.push({event:re,listeners:Z}),re.data=Pe))}qx(ae,u)})}function oh(a,u,d){return{instance:a,listener:u,currentTarget:d}}function Of(a,u){for(var d=u+"Capture",p=[];a!==null;){var _=a,v=_.stateNode;_.tag===5&&v!==null&&(_=v,v=pn(a,d),v!=null&&p.unshift(oh(a,v,_)),v=pn(a,u),v!=null&&p.push(oh(a,v,_))),a=a.return}return p}function eu(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function Zx(a,u,d,p,_){for(var v=u._reactName,A=[];d!==null&&d!==p;){var U=d,B=U.alternate,Z=U.stateNode;if(B!==null&&B===p)break;U.tag===5&&Z!==null&&(U=Z,_?(B=pn(d,v),B!=null&&A.unshift(oh(d,B,U))):_||(B=pn(d,v),B!=null&&A.push(oh(d,B,U)))),d=d.return}A.length!==0&&a.push({event:u,listeners:A})}var NM=/\r\n?/g,LM=/\u0000|\uFFFD/g;function Qx(a){return(typeof a=="string"?a:""+a).replace(NM,`
`).replace(LM,"")}function Vf(a,u,d){if(u=Qx(u),Qx(a)!==u&&d)throw Error(t(425))}function Ff(){}var Ay=null,Py=null;function by(a,u){return a==="textarea"||a==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var ky=typeof setTimeout=="function"?setTimeout:void 0,OM=typeof clearTimeout=="function"?clearTimeout:void 0,Jx=typeof Promise=="function"?Promise:void 0,VM=typeof queueMicrotask=="function"?queueMicrotask:typeof Jx<"u"?function(a){return Jx.resolve(null).then(a).catch(FM)}:ky;function FM(a){setTimeout(function(){throw a})}function Dy(a,u){var d=u,p=0;do{var _=d.nextSibling;if(a.removeChild(d),_&&_.nodeType===8)if(d=_.data,d==="/$"){if(p===0){a.removeChild(_),so(u);return}p--}else d!=="$"&&d!=="$?"&&d!=="$!"||p++;d=_}while(d);so(u)}function uo(a){for(;a!=null;a=a.nextSibling){var u=a.nodeType;if(u===1||u===3)break;if(u===8){if(u=a.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return a}function e1(a){a=a.previousSibling;for(var u=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(u===0)return a;u--}else d==="/$"&&u++}a=a.previousSibling}return null}var tu=Math.random().toString(36).slice(2),Gr="__reactFiber$"+tu,ah="__reactProps$"+tu,Ts="__reactContainer$"+tu,My="__reactEvents$"+tu,jM="__reactListeners$"+tu,UM="__reactHandles$"+tu;function xa(a){var u=a[Gr];if(u)return u;for(var d=a.parentNode;d;){if(u=d[Ts]||d[Gr]){if(d=u.alternate,u.child!==null||d!==null&&d.child!==null)for(a=e1(a);a!==null;){if(d=a[Gr])return d;a=e1(a)}return u}a=d,d=a.parentNode}return null}function lh(a){return a=a[Gr]||a[Ts],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function nu(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function jf(a){return a[ah]||null}var Ny=[],iu=-1;function co(a){return{current:a}}function Et(a){0>iu||(a.current=Ny[iu],Ny[iu]=null,iu--)}function _t(a,u){iu++,Ny[iu]=a.current,a.current=u}var ho={},Rn=co(ho),Hn=co(!1),Ta=ho;function ru(a,u){var d=a.type.contextTypes;if(!d)return ho;var p=a.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===u)return p.__reactInternalMemoizedMaskedChildContext;var _={},v;for(v in d)_[v]=u[v];return p&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=u,a.__reactInternalMemoizedMaskedChildContext=_),_}function Xn(a){return a=a.childContextTypes,a!=null}function Uf(){Et(Hn),Et(Rn)}function t1(a,u,d){if(Rn.current!==ho)throw Error(t(168));_t(Rn,u),_t(Hn,d)}function n1(a,u,d){var p=a.stateNode;if(u=u.childContextTypes,typeof p.getChildContext!="function")return d;p=p.getChildContext();for(var _ in p)if(!(_ in u))throw Error(t(108,Me(a)||"Unknown",_));return ne({},d,p)}function zf(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||ho,Ta=Rn.current,_t(Rn,a),_t(Hn,Hn.current),!0}function i1(a,u,d){var p=a.stateNode;if(!p)throw Error(t(169));d?(a=n1(a,u,Ta),p.__reactInternalMemoizedMergedChildContext=a,Et(Hn),Et(Rn),_t(Rn,a)):Et(Hn),_t(Hn,d)}var Is=null,Bf=!1,Ly=!1;function r1(a){Is===null?Is=[a]:Is.push(a)}function zM(a){Bf=!0,r1(a)}function fo(){if(!Ly&&Is!==null){Ly=!0;var a=0,u=He;try{var d=Is;for(He=1;a<d.length;a++){var p=d[a];do p=p(!0);while(p!==null)}Is=null,Bf=!1}catch(_){throw Is!==null&&(Is=Is.slice(a+1)),Fc(Fl,fo),_}finally{He=u,Ly=!1}}return null}var su=[],ou=0,Gf=null,Wf=0,Ni=[],Li=0,Ia=null,Ss=1,Cs="";function Sa(a,u){su[ou++]=Wf,su[ou++]=Gf,Gf=a,Wf=u}function s1(a,u,d){Ni[Li++]=Ss,Ni[Li++]=Cs,Ni[Li++]=Ia,Ia=a;var p=Ss;a=Cs;var _=32-ci(p)-1;p&=~(1<<_),d+=1;var v=32-ci(u)+_;if(30<v){var A=_-_%5;v=(p&(1<<A)-1).toString(32),p>>=A,_-=A,Ss=1<<32-ci(u)+_|d<<_|p,Cs=v+a}else Ss=1<<v|d<<_|p,Cs=a}function Oy(a){a.return!==null&&(Sa(a,1),s1(a,1,0))}function Vy(a){for(;a===Gf;)Gf=su[--ou],su[ou]=null,Wf=su[--ou],su[ou]=null;for(;a===Ia;)Ia=Ni[--Li],Ni[Li]=null,Cs=Ni[--Li],Ni[Li]=null,Ss=Ni[--Li],Ni[Li]=null}var pi=null,mi=null,St=!1,rr=null;function o1(a,u){var d=ji(5,null,null,0);d.elementType="DELETED",d.stateNode=u,d.return=a,u=a.deletions,u===null?(a.deletions=[d],a.flags|=16):u.push(d)}function a1(a,u){switch(a.tag){case 5:var d=a.type;return u=u.nodeType!==1||d.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(a.stateNode=u,pi=a,mi=uo(u.firstChild),!0):!1;case 6:return u=a.pendingProps===""||u.nodeType!==3?null:u,u!==null?(a.stateNode=u,pi=a,mi=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(d=Ia!==null?{id:Ss,overflow:Cs}:null,a.memoizedState={dehydrated:u,treeContext:d,retryLane:1073741824},d=ji(18,null,null,0),d.stateNode=u,d.return=a,a.child=d,pi=a,mi=null,!0):!1;default:return!1}}function Fy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function jy(a){if(St){var u=mi;if(u){var d=u;if(!a1(a,u)){if(Fy(a))throw Error(t(418));u=uo(d.nextSibling);var p=pi;u&&a1(a,u)?o1(p,d):(a.flags=a.flags&-4097|2,St=!1,pi=a)}}else{if(Fy(a))throw Error(t(418));a.flags=a.flags&-4097|2,St=!1,pi=a}}}function l1(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;pi=a}function Kf(a){if(a!==pi)return!1;if(!St)return l1(a),St=!0,!1;var u;if((u=a.tag!==3)&&!(u=a.tag!==5)&&(u=a.type,u=u!=="head"&&u!=="body"&&!by(a.type,a.memoizedProps)),u&&(u=mi)){if(Fy(a))throw u1(),Error(t(418));for(;u;)o1(a,u),u=uo(u.nextSibling)}if(l1(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,u=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(u===0){mi=uo(a.nextSibling);break e}u--}else d!=="$"&&d!=="$!"&&d!=="$?"||u++}a=a.nextSibling}mi=null}}else mi=pi?uo(a.stateNode.nextSibling):null;return!0}function u1(){for(var a=mi;a;)a=uo(a.nextSibling)}function au(){mi=pi=null,St=!1}function Uy(a){rr===null?rr=[a]:rr.push(a)}var BM=O.ReactCurrentBatchConfig;function uh(a,u,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var p=d.stateNode}if(!p)throw Error(t(147,a));var _=p,v=""+a;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===v?u.ref:(u=function(A){var U=_.refs;A===null?delete U[v]:U[v]=A},u._stringRef=v,u)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function $f(a,u){throw a=Object.prototype.toString.call(u),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":a))}function c1(a){var u=a._init;return u(a._payload)}function h1(a){function u(H,K){if(a){var q=H.deletions;q===null?(H.deletions=[K],H.flags|=16):q.push(K)}}function d(H,K){if(!a)return null;for(;K!==null;)u(H,K),K=K.sibling;return null}function p(H,K){for(H=new Map;K!==null;)K.key!==null?H.set(K.key,K):H.set(K.index,K),K=K.sibling;return H}function _(H,K){return H=Eo(H,K),H.index=0,H.sibling=null,H}function v(H,K,q){return H.index=q,a?(q=H.alternate,q!==null?(q=q.index,q<K?(H.flags|=2,K):q):(H.flags|=2,K)):(H.flags|=1048576,K)}function A(H){return a&&H.alternate===null&&(H.flags|=2),H}function U(H,K,q,ue){return K===null||K.tag!==6?(K=k_(q,H.mode,ue),K.return=H,K):(K=_(K,q),K.return=H,K)}function B(H,K,q,ue){var we=q.type;return we===P?re(H,K,q.props.children,ue,q.key):K!==null&&(K.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===fe&&c1(we)===K.type)?(ue=_(K,q.props),ue.ref=uh(H,K,q),ue.return=H,ue):(ue=mg(q.type,q.key,q.props,null,H.mode,ue),ue.ref=uh(H,K,q),ue.return=H,ue)}function Z(H,K,q,ue){return K===null||K.tag!==4||K.stateNode.containerInfo!==q.containerInfo||K.stateNode.implementation!==q.implementation?(K=D_(q,H.mode,ue),K.return=H,K):(K=_(K,q.children||[]),K.return=H,K)}function re(H,K,q,ue,we){return K===null||K.tag!==7?(K=Ma(q,H.mode,ue,we),K.return=H,K):(K=_(K,q),K.return=H,K)}function ae(H,K,q){if(typeof K=="string"&&K!==""||typeof K=="number")return K=k_(""+K,H.mode,q),K.return=H,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case F:return q=mg(K.type,K.key,K.props,null,H.mode,q),q.ref=uh(H,null,K),q.return=H,q;case W:return K=D_(K,H.mode,q),K.return=H,K;case fe:var ue=K._init;return ae(H,ue(K._payload),q)}if(ut(K)||oe(K))return K=Ma(K,H.mode,q,null),K.return=H,K;$f(H,K)}return null}function ie(H,K,q,ue){var we=K!==null?K.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return we!==null?null:U(H,K,""+q,ue);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case F:return q.key===we?B(H,K,q,ue):null;case W:return q.key===we?Z(H,K,q,ue):null;case fe:return we=q._init,ie(H,K,we(q._payload),ue)}if(ut(q)||oe(q))return we!==null?null:re(H,K,q,ue,null);$f(H,q)}return null}function ge(H,K,q,ue,we){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return H=H.get(q)||null,U(K,H,""+ue,we);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case F:return H=H.get(ue.key===null?q:ue.key)||null,B(K,H,ue,we);case W:return H=H.get(ue.key===null?q:ue.key)||null,Z(K,H,ue,we);case fe:var Ae=ue._init;return ge(H,K,q,Ae(ue._payload),we)}if(ut(ue)||oe(ue))return H=H.get(q)||null,re(K,H,ue,we,null);$f(K,ue)}return null}function ye(H,K,q,ue){for(var we=null,Ae=null,Pe=K,Ne=K=0,on=null;Pe!==null&&Ne<q.length;Ne++){Pe.index>Ne?(on=Pe,Pe=null):on=Pe.sibling;var Je=ie(H,Pe,q[Ne],ue);if(Je===null){Pe===null&&(Pe=on);break}a&&Pe&&Je.alternate===null&&u(H,Pe),K=v(Je,K,Ne),Ae===null?we=Je:Ae.sibling=Je,Ae=Je,Pe=on}if(Ne===q.length)return d(H,Pe),St&&Sa(H,Ne),we;if(Pe===null){for(;Ne<q.length;Ne++)Pe=ae(H,q[Ne],ue),Pe!==null&&(K=v(Pe,K,Ne),Ae===null?we=Pe:Ae.sibling=Pe,Ae=Pe);return St&&Sa(H,Ne),we}for(Pe=p(H,Pe);Ne<q.length;Ne++)on=ge(Pe,H,Ne,q[Ne],ue),on!==null&&(a&&on.alternate!==null&&Pe.delete(on.key===null?Ne:on.key),K=v(on,K,Ne),Ae===null?we=on:Ae.sibling=on,Ae=on);return a&&Pe.forEach(function(xo){return u(H,xo)}),St&&Sa(H,Ne),we}function _e(H,K,q,ue){var we=oe(q);if(typeof we!="function")throw Error(t(150));if(q=we.call(q),q==null)throw Error(t(151));for(var Ae=we=null,Pe=K,Ne=K=0,on=null,Je=q.next();Pe!==null&&!Je.done;Ne++,Je=q.next()){Pe.index>Ne?(on=Pe,Pe=null):on=Pe.sibling;var xo=ie(H,Pe,Je.value,ue);if(xo===null){Pe===null&&(Pe=on);break}a&&Pe&&xo.alternate===null&&u(H,Pe),K=v(xo,K,Ne),Ae===null?we=xo:Ae.sibling=xo,Ae=xo,Pe=on}if(Je.done)return d(H,Pe),St&&Sa(H,Ne),we;if(Pe===null){for(;!Je.done;Ne++,Je=q.next())Je=ae(H,Je.value,ue),Je!==null&&(K=v(Je,K,Ne),Ae===null?we=Je:Ae.sibling=Je,Ae=Je);return St&&Sa(H,Ne),we}for(Pe=p(H,Pe);!Je.done;Ne++,Je=q.next())Je=ge(Pe,H,Ne,Je.value,ue),Je!==null&&(a&&Je.alternate!==null&&Pe.delete(Je.key===null?Ne:Je.key),K=v(Je,K,Ne),Ae===null?we=Je:Ae.sibling=Je,Ae=Je);return a&&Pe.forEach(function(EN){return u(H,EN)}),St&&Sa(H,Ne),we}function jt(H,K,q,ue){if(typeof q=="object"&&q!==null&&q.type===P&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case F:e:{for(var we=q.key,Ae=K;Ae!==null;){if(Ae.key===we){if(we=q.type,we===P){if(Ae.tag===7){d(H,Ae.sibling),K=_(Ae,q.props.children),K.return=H,H=K;break e}}else if(Ae.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===fe&&c1(we)===Ae.type){d(H,Ae.sibling),K=_(Ae,q.props),K.ref=uh(H,Ae,q),K.return=H,H=K;break e}d(H,Ae);break}else u(H,Ae);Ae=Ae.sibling}q.type===P?(K=Ma(q.props.children,H.mode,ue,q.key),K.return=H,H=K):(ue=mg(q.type,q.key,q.props,null,H.mode,ue),ue.ref=uh(H,K,q),ue.return=H,H=ue)}return A(H);case W:e:{for(Ae=q.key;K!==null;){if(K.key===Ae)if(K.tag===4&&K.stateNode.containerInfo===q.containerInfo&&K.stateNode.implementation===q.implementation){d(H,K.sibling),K=_(K,q.children||[]),K.return=H,H=K;break e}else{d(H,K);break}else u(H,K);K=K.sibling}K=D_(q,H.mode,ue),K.return=H,H=K}return A(H);case fe:return Ae=q._init,jt(H,K,Ae(q._payload),ue)}if(ut(q))return ye(H,K,q,ue);if(oe(q))return _e(H,K,q,ue);$f(H,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,K!==null&&K.tag===6?(d(H,K.sibling),K=_(K,q),K.return=H,H=K):(d(H,K),K=k_(q,H.mode,ue),K.return=H,H=K),A(H)):d(H,K)}return jt}var lu=h1(!0),d1=h1(!1),Hf=co(null),Xf=null,uu=null,zy=null;function By(){zy=uu=Xf=null}function Gy(a){var u=Hf.current;Et(Hf),a._currentValue=u}function Wy(a,u,d){for(;a!==null;){var p=a.alternate;if((a.childLanes&u)!==u?(a.childLanes|=u,p!==null&&(p.childLanes|=u)):p!==null&&(p.childLanes&u)!==u&&(p.childLanes|=u),a===d)break;a=a.return}}function cu(a,u){Xf=a,zy=uu=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&u)!==0&&(qn=!0),a.firstContext=null)}function Oi(a){var u=a._currentValue;if(zy!==a)if(a={context:a,memoizedValue:u,next:null},uu===null){if(Xf===null)throw Error(t(308));uu=a,Xf.dependencies={lanes:0,firstContext:a}}else uu=uu.next=a;return u}var Ca=null;function Ky(a){Ca===null?Ca=[a]:Ca.push(a)}function f1(a,u,d,p){var _=u.interleaved;return _===null?(d.next=d,Ky(u)):(d.next=_.next,_.next=d),u.interleaved=d,Rs(a,p)}function Rs(a,u){a.lanes|=u;var d=a.alternate;for(d!==null&&(d.lanes|=u),d=a,a=a.return;a!==null;)a.childLanes|=u,d=a.alternate,d!==null&&(d.childLanes|=u),d=a,a=a.return;return d.tag===3?d.stateNode:null}var go=!1;function $y(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function g1(a,u){a=a.updateQueue,u.updateQueue===a&&(u.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function As(a,u){return{eventTime:a,lane:u,tag:0,payload:null,callback:null,next:null}}function po(a,u,d){var p=a.updateQueue;if(p===null)return null;if(p=p.shared,(Qe&2)!==0){var _=p.pending;return _===null?u.next=u:(u.next=_.next,_.next=u),p.pending=u,Rs(a,d)}return _=p.interleaved,_===null?(u.next=u,Ky(p)):(u.next=_.next,_.next=u),p.interleaved=u,Rs(a,d)}function qf(a,u,d){if(u=u.updateQueue,u!==null&&(u=u.shared,(d&4194240)!==0)){var p=u.lanes;p&=a.pendingLanes,d|=p,u.lanes=d,Wc(a,d)}}function p1(a,u){var d=a.updateQueue,p=a.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var _=null,v=null;if(d=d.firstBaseUpdate,d!==null){do{var A={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};v===null?_=v=A:v=v.next=A,d=d.next}while(d!==null);v===null?_=v=u:v=v.next=u}else _=v=u;d={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:v,shared:p.shared,effects:p.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=u}function Yf(a,u,d,p){var _=a.updateQueue;go=!1;var v=_.firstBaseUpdate,A=_.lastBaseUpdate,U=_.shared.pending;if(U!==null){_.shared.pending=null;var B=U,Z=B.next;B.next=null,A===null?v=Z:A.next=Z,A=B;var re=a.alternate;re!==null&&(re=re.updateQueue,U=re.lastBaseUpdate,U!==A&&(U===null?re.firstBaseUpdate=Z:U.next=Z,re.lastBaseUpdate=B))}if(v!==null){var ae=_.baseState;A=0,re=Z=B=null,U=v;do{var ie=U.lane,ge=U.eventTime;if((p&ie)===ie){re!==null&&(re=re.next={eventTime:ge,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var ye=a,_e=U;switch(ie=u,ge=d,_e.tag){case 1:if(ye=_e.payload,typeof ye=="function"){ae=ye.call(ge,ae,ie);break e}ae=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=_e.payload,ie=typeof ye=="function"?ye.call(ge,ae,ie):ye,ie==null)break e;ae=ne({},ae,ie);break e;case 2:go=!0}}U.callback!==null&&U.lane!==0&&(a.flags|=64,ie=_.effects,ie===null?_.effects=[U]:ie.push(U))}else ge={eventTime:ge,lane:ie,tag:U.tag,payload:U.payload,callback:U.callback,next:null},re===null?(Z=re=ge,B=ae):re=re.next=ge,A|=ie;if(U=U.next,U===null){if(U=_.shared.pending,U===null)break;ie=U,U=ie.next,ie.next=null,_.lastBaseUpdate=ie,_.shared.pending=null}}while(!0);if(re===null&&(B=ae),_.baseState=B,_.firstBaseUpdate=Z,_.lastBaseUpdate=re,u=_.shared.interleaved,u!==null){_=u;do A|=_.lane,_=_.next;while(_!==u)}else v===null&&(_.shared.lanes=0);Pa|=A,a.lanes=A,a.memoizedState=ae}}function m1(a,u,d){if(a=u.effects,u.effects=null,a!==null)for(u=0;u<a.length;u++){var p=a[u],_=p.callback;if(_!==null){if(p.callback=null,p=d,typeof _!="function")throw Error(t(191,_));_.call(p)}}}var ch={},Wr=co(ch),hh=co(ch),dh=co(ch);function Ra(a){if(a===ch)throw Error(t(174));return a}function Hy(a,u){switch(_t(dh,u),_t(hh,a),_t(Wr,ch),a=u.nodeType,a){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:Ji(null,"");break;default:a=a===8?u.parentNode:u,u=a.namespaceURI||null,a=a.tagName,u=Ji(u,a)}Et(Wr),_t(Wr,u)}function hu(){Et(Wr),Et(hh),Et(dh)}function y1(a){Ra(dh.current);var u=Ra(Wr.current),d=Ji(u,a.type);u!==d&&(_t(hh,a),_t(Wr,d))}function Xy(a){hh.current===a&&(Et(Wr),Et(hh))}var At=co(0);function Zf(a){for(var u=a;u!==null;){if(u.tag===13){var d=u.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var qy=[];function Yy(){for(var a=0;a<qy.length;a++)qy[a]._workInProgressVersionPrimary=null;qy.length=0}var Qf=O.ReactCurrentDispatcher,Zy=O.ReactCurrentBatchConfig,Aa=0,Pt=null,qt=null,rn=null,Jf=!1,fh=!1,gh=0,GM=0;function An(){throw Error(t(321))}function Qy(a,u){if(u===null)return!1;for(var d=0;d<u.length&&d<a.length;d++)if(!ir(a[d],u[d]))return!1;return!0}function Jy(a,u,d,p,_,v){if(Aa=v,Pt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Qf.current=a===null||a.memoizedState===null?HM:XM,a=d(p,_),fh){v=0;do{if(fh=!1,gh=0,25<=v)throw Error(t(301));v+=1,rn=qt=null,u.updateQueue=null,Qf.current=qM,a=d(p,_)}while(fh)}if(Qf.current=ng,u=qt!==null&&qt.next!==null,Aa=0,rn=qt=Pt=null,Jf=!1,u)throw Error(t(300));return a}function e_(){var a=gh!==0;return gh=0,a}function Kr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?Pt.memoizedState=rn=a:rn=rn.next=a,rn}function Vi(){if(qt===null){var a=Pt.alternate;a=a!==null?a.memoizedState:null}else a=qt.next;var u=rn===null?Pt.memoizedState:rn.next;if(u!==null)rn=u,qt=a;else{if(a===null)throw Error(t(310));qt=a,a={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},rn===null?Pt.memoizedState=rn=a:rn=rn.next=a}return rn}function ph(a,u){return typeof u=="function"?u(a):u}function t_(a){var u=Vi(),d=u.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var p=qt,_=p.baseQueue,v=d.pending;if(v!==null){if(_!==null){var A=_.next;_.next=v.next,v.next=A}p.baseQueue=_=v,d.pending=null}if(_!==null){v=_.next,p=p.baseState;var U=A=null,B=null,Z=v;do{var re=Z.lane;if((Aa&re)===re)B!==null&&(B=B.next={lane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),p=Z.hasEagerState?Z.eagerState:a(p,Z.action);else{var ae={lane:re,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null};B===null?(U=B=ae,A=p):B=B.next=ae,Pt.lanes|=re,Pa|=re}Z=Z.next}while(Z!==null&&Z!==v);B===null?A=p:B.next=U,ir(p,u.memoizedState)||(qn=!0),u.memoizedState=p,u.baseState=A,u.baseQueue=B,d.lastRenderedState=p}if(a=d.interleaved,a!==null){_=a;do v=_.lane,Pt.lanes|=v,Pa|=v,_=_.next;while(_!==a)}else _===null&&(d.lanes=0);return[u.memoizedState,d.dispatch]}function n_(a){var u=Vi(),d=u.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var p=d.dispatch,_=d.pending,v=u.memoizedState;if(_!==null){d.pending=null;var A=_=_.next;do v=a(v,A.action),A=A.next;while(A!==_);ir(v,u.memoizedState)||(qn=!0),u.memoizedState=v,u.baseQueue===null&&(u.baseState=v),d.lastRenderedState=v}return[v,p]}function _1(){}function v1(a,u){var d=Pt,p=Vi(),_=u(),v=!ir(p.memoizedState,_);if(v&&(p.memoizedState=_,qn=!0),p=p.queue,i_(x1.bind(null,d,p,a),[a]),p.getSnapshot!==u||v||rn!==null&&rn.memoizedState.tag&1){if(d.flags|=2048,mh(9,E1.bind(null,d,p,_,u),void 0,null),sn===null)throw Error(t(349));(Aa&30)!==0||w1(d,u,_)}return _}function w1(a,u,d){a.flags|=16384,a={getSnapshot:u,value:d},u=Pt.updateQueue,u===null?(u={lastEffect:null,stores:null},Pt.updateQueue=u,u.stores=[a]):(d=u.stores,d===null?u.stores=[a]:d.push(a))}function E1(a,u,d,p){u.value=d,u.getSnapshot=p,T1(u)&&I1(a)}function x1(a,u,d){return d(function(){T1(u)&&I1(a)})}function T1(a){var u=a.getSnapshot;a=a.value;try{var d=u();return!ir(a,d)}catch{return!0}}function I1(a){var u=Rs(a,1);u!==null&&lr(u,a,1,-1)}function S1(a){var u=Kr();return typeof a=="function"&&(a=a()),u.memoizedState=u.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ph,lastRenderedState:a},u.queue=a,a=a.dispatch=$M.bind(null,Pt,a),[u.memoizedState,a]}function mh(a,u,d,p){return a={tag:a,create:u,destroy:d,deps:p,next:null},u=Pt.updateQueue,u===null?(u={lastEffect:null,stores:null},Pt.updateQueue=u,u.lastEffect=a.next=a):(d=u.lastEffect,d===null?u.lastEffect=a.next=a:(p=d.next,d.next=a,a.next=p,u.lastEffect=a)),a}function C1(){return Vi().memoizedState}function eg(a,u,d,p){var _=Kr();Pt.flags|=a,_.memoizedState=mh(1|u,d,void 0,p===void 0?null:p)}function tg(a,u,d,p){var _=Vi();p=p===void 0?null:p;var v=void 0;if(qt!==null){var A=qt.memoizedState;if(v=A.destroy,p!==null&&Qy(p,A.deps)){_.memoizedState=mh(u,d,v,p);return}}Pt.flags|=a,_.memoizedState=mh(1|u,d,v,p)}function R1(a,u){return eg(8390656,8,a,u)}function i_(a,u){return tg(2048,8,a,u)}function A1(a,u){return tg(4,2,a,u)}function P1(a,u){return tg(4,4,a,u)}function b1(a,u){if(typeof u=="function")return a=a(),u(a),function(){u(null)};if(u!=null)return a=a(),u.current=a,function(){u.current=null}}function k1(a,u,d){return d=d!=null?d.concat([a]):null,tg(4,4,b1.bind(null,u,a),d)}function r_(){}function D1(a,u){var d=Vi();u=u===void 0?null:u;var p=d.memoizedState;return p!==null&&u!==null&&Qy(u,p[1])?p[0]:(d.memoizedState=[a,u],a)}function M1(a,u){var d=Vi();u=u===void 0?null:u;var p=d.memoizedState;return p!==null&&u!==null&&Qy(u,p[1])?p[0]:(a=a(),d.memoizedState=[a,u],a)}function N1(a,u,d){return(Aa&21)===0?(a.baseState&&(a.baseState=!1,qn=!0),a.memoizedState=d):(ir(d,u)||(d=Bc(),Pt.lanes|=d,Pa|=d,a.baseState=!0),u)}function WM(a,u){var d=He;He=d!==0&&4>d?d:4,a(!0);var p=Zy.transition;Zy.transition={};try{a(!1),u()}finally{He=d,Zy.transition=p}}function L1(){return Vi().memoizedState}function KM(a,u,d){var p=vo(a);if(d={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null},O1(a))V1(u,d);else if(d=f1(a,u,d,p),d!==null){var _=Un();lr(d,a,p,_),F1(d,u,p)}}function $M(a,u,d){var p=vo(a),_={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null};if(O1(a))V1(u,_);else{var v=a.alternate;if(a.lanes===0&&(v===null||v.lanes===0)&&(v=u.lastRenderedReducer,v!==null))try{var A=u.lastRenderedState,U=v(A,d);if(_.hasEagerState=!0,_.eagerState=U,ir(U,A)){var B=u.interleaved;B===null?(_.next=_,Ky(u)):(_.next=B.next,B.next=_),u.interleaved=_;return}}catch{}d=f1(a,u,_,p),d!==null&&(_=Un(),lr(d,a,p,_),F1(d,u,p))}}function O1(a){var u=a.alternate;return a===Pt||u!==null&&u===Pt}function V1(a,u){fh=Jf=!0;var d=a.pending;d===null?u.next=u:(u.next=d.next,d.next=u),a.pending=u}function F1(a,u,d){if((d&4194240)!==0){var p=u.lanes;p&=a.pendingLanes,d|=p,u.lanes=d,Wc(a,d)}}var ng={readContext:Oi,useCallback:An,useContext:An,useEffect:An,useImperativeHandle:An,useInsertionEffect:An,useLayoutEffect:An,useMemo:An,useReducer:An,useRef:An,useState:An,useDebugValue:An,useDeferredValue:An,useTransition:An,useMutableSource:An,useSyncExternalStore:An,useId:An,unstable_isNewReconciler:!1},HM={readContext:Oi,useCallback:function(a,u){return Kr().memoizedState=[a,u===void 0?null:u],a},useContext:Oi,useEffect:R1,useImperativeHandle:function(a,u,d){return d=d!=null?d.concat([a]):null,eg(4194308,4,b1.bind(null,u,a),d)},useLayoutEffect:function(a,u){return eg(4194308,4,a,u)},useInsertionEffect:function(a,u){return eg(4,2,a,u)},useMemo:function(a,u){var d=Kr();return u=u===void 0?null:u,a=a(),d.memoizedState=[a,u],a},useReducer:function(a,u,d){var p=Kr();return u=d!==void 0?d(u):u,p.memoizedState=p.baseState=u,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:u},p.queue=a,a=a.dispatch=KM.bind(null,Pt,a),[p.memoizedState,a]},useRef:function(a){var u=Kr();return a={current:a},u.memoizedState=a},useState:S1,useDebugValue:r_,useDeferredValue:function(a){return Kr().memoizedState=a},useTransition:function(){var a=S1(!1),u=a[0];return a=WM.bind(null,a[1]),Kr().memoizedState=a,[u,a]},useMutableSource:function(){},useSyncExternalStore:function(a,u,d){var p=Pt,_=Kr();if(St){if(d===void 0)throw Error(t(407));d=d()}else{if(d=u(),sn===null)throw Error(t(349));(Aa&30)!==0||w1(p,u,d)}_.memoizedState=d;var v={value:d,getSnapshot:u};return _.queue=v,R1(x1.bind(null,p,v,a),[a]),p.flags|=2048,mh(9,E1.bind(null,p,v,d,u),void 0,null),d},useId:function(){var a=Kr(),u=sn.identifierPrefix;if(St){var d=Cs,p=Ss;d=(p&~(1<<32-ci(p)-1)).toString(32)+d,u=":"+u+"R"+d,d=gh++,0<d&&(u+="H"+d.toString(32)),u+=":"}else d=GM++,u=":"+u+"r"+d.toString(32)+":";return a.memoizedState=u},unstable_isNewReconciler:!1},XM={readContext:Oi,useCallback:D1,useContext:Oi,useEffect:i_,useImperativeHandle:k1,useInsertionEffect:A1,useLayoutEffect:P1,useMemo:M1,useReducer:t_,useRef:C1,useState:function(){return t_(ph)},useDebugValue:r_,useDeferredValue:function(a){var u=Vi();return N1(u,qt.memoizedState,a)},useTransition:function(){var a=t_(ph)[0],u=Vi().memoizedState;return[a,u]},useMutableSource:_1,useSyncExternalStore:v1,useId:L1,unstable_isNewReconciler:!1},qM={readContext:Oi,useCallback:D1,useContext:Oi,useEffect:i_,useImperativeHandle:k1,useInsertionEffect:A1,useLayoutEffect:P1,useMemo:M1,useReducer:n_,useRef:C1,useState:function(){return n_(ph)},useDebugValue:r_,useDeferredValue:function(a){var u=Vi();return qt===null?u.memoizedState=a:N1(u,qt.memoizedState,a)},useTransition:function(){var a=n_(ph)[0],u=Vi().memoizedState;return[a,u]},useMutableSource:_1,useSyncExternalStore:v1,useId:L1,unstable_isNewReconciler:!1};function sr(a,u){if(a&&a.defaultProps){u=ne({},u),a=a.defaultProps;for(var d in a)u[d]===void 0&&(u[d]=a[d]);return u}return u}function s_(a,u,d,p){u=a.memoizedState,d=d(p,u),d=d==null?u:ne({},u,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var ig={isMounted:function(a){return(a=a._reactInternals)?tr(a)===a:!1},enqueueSetState:function(a,u,d){a=a._reactInternals;var p=Un(),_=vo(a),v=As(p,_);v.payload=u,d!=null&&(v.callback=d),u=po(a,v,_),u!==null&&(lr(u,a,_,p),qf(u,a,_))},enqueueReplaceState:function(a,u,d){a=a._reactInternals;var p=Un(),_=vo(a),v=As(p,_);v.tag=1,v.payload=u,d!=null&&(v.callback=d),u=po(a,v,_),u!==null&&(lr(u,a,_,p),qf(u,a,_))},enqueueForceUpdate:function(a,u){a=a._reactInternals;var d=Un(),p=vo(a),_=As(d,p);_.tag=2,u!=null&&(_.callback=u),u=po(a,_,p),u!==null&&(lr(u,a,p,d),qf(u,a,p))}};function j1(a,u,d,p,_,v,A){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(p,v,A):u.prototype&&u.prototype.isPureReactComponent?!nh(d,p)||!nh(_,v):!0}function U1(a,u,d){var p=!1,_=ho,v=u.contextType;return typeof v=="object"&&v!==null?v=Oi(v):(_=Xn(u)?Ta:Rn.current,p=u.contextTypes,v=(p=p!=null)?ru(a,_):ho),u=new u(d,v),a.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=ig,a.stateNode=u,u._reactInternals=a,p&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=_,a.__reactInternalMemoizedMaskedChildContext=v),u}function z1(a,u,d,p){a=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(d,p),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(d,p),u.state!==a&&ig.enqueueReplaceState(u,u.state,null)}function o_(a,u,d,p){var _=a.stateNode;_.props=d,_.state=a.memoizedState,_.refs={},$y(a);var v=u.contextType;typeof v=="object"&&v!==null?_.context=Oi(v):(v=Xn(u)?Ta:Rn.current,_.context=ru(a,v)),_.state=a.memoizedState,v=u.getDerivedStateFromProps,typeof v=="function"&&(s_(a,u,v,d),_.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(u=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),u!==_.state&&ig.enqueueReplaceState(_,_.state,null),Yf(a,d,_,p),_.state=a.memoizedState),typeof _.componentDidMount=="function"&&(a.flags|=4194308)}function du(a,u){try{var d="",p=u;do d+=Ie(p),p=p.return;while(p);var _=d}catch(v){_=`
Error generating stack: `+v.message+`
`+v.stack}return{value:a,source:u,stack:_,digest:null}}function a_(a,u,d){return{value:a,source:null,stack:d??null,digest:u??null}}function l_(a,u){try{console.error(u.value)}catch(d){setTimeout(function(){throw d})}}var YM=typeof WeakMap=="function"?WeakMap:Map;function B1(a,u,d){d=As(-1,d),d.tag=3,d.payload={element:null};var p=u.value;return d.callback=function(){cg||(cg=!0,T_=p),l_(a,u)},d}function G1(a,u,d){d=As(-1,d),d.tag=3;var p=a.type.getDerivedStateFromError;if(typeof p=="function"){var _=u.value;d.payload=function(){return p(_)},d.callback=function(){l_(a,u)}}var v=a.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(d.callback=function(){l_(a,u),typeof p!="function"&&(yo===null?yo=new Set([this]):yo.add(this));var A=u.stack;this.componentDidCatch(u.value,{componentStack:A!==null?A:""})}),d}function W1(a,u,d){var p=a.pingCache;if(p===null){p=a.pingCache=new YM;var _=new Set;p.set(u,_)}else _=p.get(u),_===void 0&&(_=new Set,p.set(u,_));_.has(d)||(_.add(d),a=cN.bind(null,a,u,d),u.then(a,a))}function K1(a){do{var u;if((u=a.tag===13)&&(u=a.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return a;a=a.return}while(a!==null);return null}function $1(a,u,d,p,_){return(a.mode&1)===0?(a===u?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(u=As(-1,1),u.tag=2,po(d,u,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=_,a)}var ZM=O.ReactCurrentOwner,qn=!1;function jn(a,u,d,p){u.child=a===null?d1(u,null,d,p):lu(u,a.child,d,p)}function H1(a,u,d,p,_){d=d.render;var v=u.ref;return cu(u,_),p=Jy(a,u,d,p,v,_),d=e_(),a!==null&&!qn?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~_,Ps(a,u,_)):(St&&d&&Oy(u),u.flags|=1,jn(a,u,p,_),u.child)}function X1(a,u,d,p,_){if(a===null){var v=d.type;return typeof v=="function"&&!b_(v)&&v.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(u.tag=15,u.type=v,q1(a,u,v,p,_)):(a=mg(d.type,null,p,u,u.mode,_),a.ref=u.ref,a.return=u,u.child=a)}if(v=a.child,(a.lanes&_)===0){var A=v.memoizedProps;if(d=d.compare,d=d!==null?d:nh,d(A,p)&&a.ref===u.ref)return Ps(a,u,_)}return u.flags|=1,a=Eo(v,p),a.ref=u.ref,a.return=u,u.child=a}function q1(a,u,d,p,_){if(a!==null){var v=a.memoizedProps;if(nh(v,p)&&a.ref===u.ref)if(qn=!1,u.pendingProps=p=v,(a.lanes&_)!==0)(a.flags&131072)!==0&&(qn=!0);else return u.lanes=a.lanes,Ps(a,u,_)}return u_(a,u,d,p,_)}function Y1(a,u,d){var p=u.pendingProps,_=p.children,v=a!==null?a.memoizedState:null;if(p.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(gu,yi),yi|=d;else{if((d&1073741824)===0)return a=v!==null?v.baseLanes|d:d,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:a,cachePool:null,transitions:null},u.updateQueue=null,_t(gu,yi),yi|=a,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=v!==null?v.baseLanes:d,_t(gu,yi),yi|=p}else v!==null?(p=v.baseLanes|d,u.memoizedState=null):p=d,_t(gu,yi),yi|=p;return jn(a,u,_,d),u.child}function Z1(a,u){var d=u.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(u.flags|=512,u.flags|=2097152)}function u_(a,u,d,p,_){var v=Xn(d)?Ta:Rn.current;return v=ru(u,v),cu(u,_),d=Jy(a,u,d,p,v,_),p=e_(),a!==null&&!qn?(u.updateQueue=a.updateQueue,u.flags&=-2053,a.lanes&=~_,Ps(a,u,_)):(St&&p&&Oy(u),u.flags|=1,jn(a,u,d,_),u.child)}function Q1(a,u,d,p,_){if(Xn(d)){var v=!0;zf(u)}else v=!1;if(cu(u,_),u.stateNode===null)sg(a,u),U1(u,d,p),o_(u,d,p,_),p=!0;else if(a===null){var A=u.stateNode,U=u.memoizedProps;A.props=U;var B=A.context,Z=d.contextType;typeof Z=="object"&&Z!==null?Z=Oi(Z):(Z=Xn(d)?Ta:Rn.current,Z=ru(u,Z));var re=d.getDerivedStateFromProps,ae=typeof re=="function"||typeof A.getSnapshotBeforeUpdate=="function";ae||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==p||B!==Z)&&z1(u,A,p,Z),go=!1;var ie=u.memoizedState;A.state=ie,Yf(u,p,A,_),B=u.memoizedState,U!==p||ie!==B||Hn.current||go?(typeof re=="function"&&(s_(u,d,re,p),B=u.memoizedState),(U=go||j1(u,d,U,p,ie,B,Z))?(ae||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(u.flags|=4194308)):(typeof A.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=p,u.memoizedState=B),A.props=p,A.state=B,A.context=Z,p=U):(typeof A.componentDidMount=="function"&&(u.flags|=4194308),p=!1)}else{A=u.stateNode,g1(a,u),U=u.memoizedProps,Z=u.type===u.elementType?U:sr(u.type,U),A.props=Z,ae=u.pendingProps,ie=A.context,B=d.contextType,typeof B=="object"&&B!==null?B=Oi(B):(B=Xn(d)?Ta:Rn.current,B=ru(u,B));var ge=d.getDerivedStateFromProps;(re=typeof ge=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==ae||ie!==B)&&z1(u,A,p,B),go=!1,ie=u.memoizedState,A.state=ie,Yf(u,p,A,_);var ye=u.memoizedState;U!==ae||ie!==ye||Hn.current||go?(typeof ge=="function"&&(s_(u,d,ge,p),ye=u.memoizedState),(Z=go||j1(u,d,Z,p,ie,ye,B)||!1)?(re||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(p,ye,B),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(p,ye,B)),typeof A.componentDidUpdate=="function"&&(u.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof A.componentDidUpdate!="function"||U===a.memoizedProps&&ie===a.memoizedState||(u.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&ie===a.memoizedState||(u.flags|=1024),u.memoizedProps=p,u.memoizedState=ye),A.props=p,A.state=ye,A.context=B,p=Z):(typeof A.componentDidUpdate!="function"||U===a.memoizedProps&&ie===a.memoizedState||(u.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&ie===a.memoizedState||(u.flags|=1024),p=!1)}return c_(a,u,d,p,v,_)}function c_(a,u,d,p,_,v){Z1(a,u);var A=(u.flags&128)!==0;if(!p&&!A)return _&&i1(u,d,!1),Ps(a,u,v);p=u.stateNode,ZM.current=u;var U=A&&typeof d.getDerivedStateFromError!="function"?null:p.render();return u.flags|=1,a!==null&&A?(u.child=lu(u,a.child,null,v),u.child=lu(u,null,U,v)):jn(a,u,U,v),u.memoizedState=p.state,_&&i1(u,d,!0),u.child}function J1(a){var u=a.stateNode;u.pendingContext?t1(a,u.pendingContext,u.pendingContext!==u.context):u.context&&t1(a,u.context,!1),Hy(a,u.containerInfo)}function eT(a,u,d,p,_){return au(),Uy(_),u.flags|=256,jn(a,u,d,p),u.child}var h_={dehydrated:null,treeContext:null,retryLane:0};function d_(a){return{baseLanes:a,cachePool:null,transitions:null}}function tT(a,u,d){var p=u.pendingProps,_=At.current,v=!1,A=(u.flags&128)!==0,U;if((U=A)||(U=a!==null&&a.memoizedState===null?!1:(_&2)!==0),U?(v=!0,u.flags&=-129):(a===null||a.memoizedState!==null)&&(_|=1),_t(At,_&1),a===null)return jy(u),a=u.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((u.mode&1)===0?u.lanes=1:a.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(A=p.children,a=p.fallback,v?(p=u.mode,v=u.child,A={mode:"hidden",children:A},(p&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=A):v=yg(A,p,0,null),a=Ma(a,p,d,null),v.return=u,a.return=u,v.sibling=a,u.child=v,u.child.memoizedState=d_(d),u.memoizedState=h_,a):f_(u,A));if(_=a.memoizedState,_!==null&&(U=_.dehydrated,U!==null))return QM(a,u,A,p,U,_,d);if(v){v=p.fallback,A=u.mode,_=a.child,U=_.sibling;var B={mode:"hidden",children:p.children};return(A&1)===0&&u.child!==_?(p=u.child,p.childLanes=0,p.pendingProps=B,u.deletions=null):(p=Eo(_,B),p.subtreeFlags=_.subtreeFlags&14680064),U!==null?v=Eo(U,v):(v=Ma(v,A,d,null),v.flags|=2),v.return=u,p.return=u,p.sibling=v,u.child=p,p=v,v=u.child,A=a.child.memoizedState,A=A===null?d_(d):{baseLanes:A.baseLanes|d,cachePool:null,transitions:A.transitions},v.memoizedState=A,v.childLanes=a.childLanes&~d,u.memoizedState=h_,p}return v=a.child,a=v.sibling,p=Eo(v,{mode:"visible",children:p.children}),(u.mode&1)===0&&(p.lanes=d),p.return=u,p.sibling=null,a!==null&&(d=u.deletions,d===null?(u.deletions=[a],u.flags|=16):d.push(a)),u.child=p,u.memoizedState=null,p}function f_(a,u){return u=yg({mode:"visible",children:u},a.mode,0,null),u.return=a,a.child=u}function rg(a,u,d,p){return p!==null&&Uy(p),lu(u,a.child,null,d),a=f_(u,u.pendingProps.children),a.flags|=2,u.memoizedState=null,a}function QM(a,u,d,p,_,v,A){if(d)return u.flags&256?(u.flags&=-257,p=a_(Error(t(422))),rg(a,u,A,p)):u.memoizedState!==null?(u.child=a.child,u.flags|=128,null):(v=p.fallback,_=u.mode,p=yg({mode:"visible",children:p.children},_,0,null),v=Ma(v,_,A,null),v.flags|=2,p.return=u,v.return=u,p.sibling=v,u.child=p,(u.mode&1)!==0&&lu(u,a.child,null,A),u.child.memoizedState=d_(A),u.memoizedState=h_,v);if((u.mode&1)===0)return rg(a,u,A,null);if(_.data==="$!"){if(p=_.nextSibling&&_.nextSibling.dataset,p)var U=p.dgst;return p=U,v=Error(t(419)),p=a_(v,p,void 0),rg(a,u,A,p)}if(U=(A&a.childLanes)!==0,qn||U){if(p=sn,p!==null){switch(A&-A){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(p.suspendedLanes|A))!==0?0:_,_!==0&&_!==v.retryLane&&(v.retryLane=_,Rs(a,_),lr(p,a,_,-1))}return P_(),p=a_(Error(t(421))),rg(a,u,A,p)}return _.data==="$?"?(u.flags|=128,u.child=a.child,u=hN.bind(null,a),_._reactRetry=u,null):(a=v.treeContext,mi=uo(_.nextSibling),pi=u,St=!0,rr=null,a!==null&&(Ni[Li++]=Ss,Ni[Li++]=Cs,Ni[Li++]=Ia,Ss=a.id,Cs=a.overflow,Ia=u),u=f_(u,p.children),u.flags|=4096,u)}function nT(a,u,d){a.lanes|=u;var p=a.alternate;p!==null&&(p.lanes|=u),Wy(a.return,u,d)}function g_(a,u,d,p,_){var v=a.memoizedState;v===null?a.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:_}:(v.isBackwards=u,v.rendering=null,v.renderingStartTime=0,v.last=p,v.tail=d,v.tailMode=_)}function iT(a,u,d){var p=u.pendingProps,_=p.revealOrder,v=p.tail;if(jn(a,u,p.children,d),p=At.current,(p&2)!==0)p=p&1|2,u.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=u.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&nT(a,d,u);else if(a.tag===19)nT(a,d,u);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===u)break e;for(;a.sibling===null;){if(a.return===null||a.return===u)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}p&=1}if(_t(At,p),(u.mode&1)===0)u.memoizedState=null;else switch(_){case"forwards":for(d=u.child,_=null;d!==null;)a=d.alternate,a!==null&&Zf(a)===null&&(_=d),d=d.sibling;d=_,d===null?(_=u.child,u.child=null):(_=d.sibling,d.sibling=null),g_(u,!1,_,d,v);break;case"backwards":for(d=null,_=u.child,u.child=null;_!==null;){if(a=_.alternate,a!==null&&Zf(a)===null){u.child=_;break}a=_.sibling,_.sibling=d,d=_,_=a}g_(u,!0,d,null,v);break;case"together":g_(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function sg(a,u){(u.mode&1)===0&&a!==null&&(a.alternate=null,u.alternate=null,u.flags|=2)}function Ps(a,u,d){if(a!==null&&(u.dependencies=a.dependencies),Pa|=u.lanes,(d&u.childLanes)===0)return null;if(a!==null&&u.child!==a.child)throw Error(t(153));if(u.child!==null){for(a=u.child,d=Eo(a,a.pendingProps),u.child=d,d.return=u;a.sibling!==null;)a=a.sibling,d=d.sibling=Eo(a,a.pendingProps),d.return=u;d.sibling=null}return u.child}function JM(a,u,d){switch(u.tag){case 3:J1(u),au();break;case 5:y1(u);break;case 1:Xn(u.type)&&zf(u);break;case 4:Hy(u,u.stateNode.containerInfo);break;case 10:var p=u.type._context,_=u.memoizedProps.value;_t(Hf,p._currentValue),p._currentValue=_;break;case 13:if(p=u.memoizedState,p!==null)return p.dehydrated!==null?(_t(At,At.current&1),u.flags|=128,null):(d&u.child.childLanes)!==0?tT(a,u,d):(_t(At,At.current&1),a=Ps(a,u,d),a!==null?a.sibling:null);_t(At,At.current&1);break;case 19:if(p=(d&u.childLanes)!==0,(a.flags&128)!==0){if(p)return iT(a,u,d);u.flags|=128}if(_=u.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),_t(At,At.current),p)break;return null;case 22:case 23:return u.lanes=0,Y1(a,u,d)}return Ps(a,u,d)}var rT,p_,sT,oT;rT=function(a,u){for(var d=u.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},p_=function(){},sT=function(a,u,d,p){var _=a.memoizedProps;if(_!==p){a=u.stateNode,Ra(Wr.current);var v=null;switch(d){case"input":_=Kn(a,_),p=Kn(a,p),v=[];break;case"select":_=ne({},_,{value:void 0}),p=ne({},p,{value:void 0}),v=[];break;case"textarea":_=Ri(a,_),p=Ri(a,p),v=[];break;default:typeof _.onClick!="function"&&typeof p.onClick=="function"&&(a.onclick=Ff)}On(d,p);var A;d=null;for(Z in _)if(!p.hasOwnProperty(Z)&&_.hasOwnProperty(Z)&&_[Z]!=null)if(Z==="style"){var U=_[Z];for(A in U)U.hasOwnProperty(A)&&(d||(d={}),d[A]="")}else Z!=="dangerouslySetInnerHTML"&&Z!=="children"&&Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&Z!=="autoFocus"&&(r.hasOwnProperty(Z)?v||(v=[]):(v=v||[]).push(Z,null));for(Z in p){var B=p[Z];if(U=_?.[Z],p.hasOwnProperty(Z)&&B!==U&&(B!=null||U!=null))if(Z==="style")if(U){for(A in U)!U.hasOwnProperty(A)||B&&B.hasOwnProperty(A)||(d||(d={}),d[A]="");for(A in B)B.hasOwnProperty(A)&&U[A]!==B[A]&&(d||(d={}),d[A]=B[A])}else d||(v||(v=[]),v.push(Z,d)),d=B;else Z==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,U=U?U.__html:void 0,B!=null&&U!==B&&(v=v||[]).push(Z,B)):Z==="children"?typeof B!="string"&&typeof B!="number"||(v=v||[]).push(Z,""+B):Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&(r.hasOwnProperty(Z)?(B!=null&&Z==="onScroll"&&wt("scroll",a),v||U===B||(v=[])):(v=v||[]).push(Z,B))}d&&(v=v||[]).push("style",d);var Z=v;(u.updateQueue=Z)&&(u.flags|=4)}},oT=function(a,u,d,p){d!==p&&(u.flags|=4)};function yh(a,u){if(!St)switch(a.tailMode){case"hidden":u=a.tail;for(var d=null;u!==null;)u.alternate!==null&&(d=u),u=u.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?u||a.tail===null?a.tail=null:a.tail.sibling=null:p.sibling=null}}function Pn(a){var u=a.alternate!==null&&a.alternate.child===a.child,d=0,p=0;if(u)for(var _=a.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags&14680064,p|=_.flags&14680064,_.return=a,_=_.sibling;else for(_=a.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=a,_=_.sibling;return a.subtreeFlags|=p,a.childLanes=d,u}function eN(a,u,d){var p=u.pendingProps;switch(Vy(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pn(u),null;case 1:return Xn(u.type)&&Uf(),Pn(u),null;case 3:return p=u.stateNode,hu(),Et(Hn),Et(Rn),Yy(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(a===null||a.child===null)&&(Kf(u)?u.flags|=4:a===null||a.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,rr!==null&&(C_(rr),rr=null))),p_(a,u),Pn(u),null;case 5:Xy(u);var _=Ra(dh.current);if(d=u.type,a!==null&&u.stateNode!=null)sT(a,u,d,p,_),a.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!p){if(u.stateNode===null)throw Error(t(166));return Pn(u),null}if(a=Ra(Wr.current),Kf(u)){p=u.stateNode,d=u.type;var v=u.memoizedProps;switch(p[Gr]=u,p[ah]=v,a=(u.mode&1)!==0,d){case"dialog":wt("cancel",p),wt("close",p);break;case"iframe":case"object":case"embed":wt("load",p);break;case"video":case"audio":for(_=0;_<rh.length;_++)wt(rh[_],p);break;case"source":wt("error",p);break;case"img":case"image":case"link":wt("error",p),wt("load",p);break;case"details":wt("toggle",p);break;case"input":hn(p,v),wt("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!v.multiple},wt("invalid",p);break;case"textarea":It(p,v),wt("invalid",p)}On(d,v),_=null;for(var A in v)if(v.hasOwnProperty(A)){var U=v[A];A==="children"?typeof U=="string"?p.textContent!==U&&(v.suppressHydrationWarning!==!0&&Vf(p.textContent,U,a),_=["children",U]):typeof U=="number"&&p.textContent!==""+U&&(v.suppressHydrationWarning!==!0&&Vf(p.textContent,U,a),_=["children",""+U]):r.hasOwnProperty(A)&&U!=null&&A==="onScroll"&&wt("scroll",p)}switch(d){case"input":Qi(p),Ci(p,v,!0);break;case"textarea":Qi(p),Ai(p);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(p.onclick=Ff)}p=_,u.updateQueue=p,p!==null&&(u.flags|=4)}else{A=_.nodeType===9?_:_.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Sr(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=A.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof p.is=="string"?a=A.createElement(d,{is:p.is}):(a=A.createElement(d),d==="select"&&(A=a,p.multiple?A.multiple=!0:p.size&&(A.size=p.size))):a=A.createElementNS(a,d),a[Gr]=u,a[ah]=p,rT(a,u,!1,!1),u.stateNode=a;e:{switch(A=ps(d,p),d){case"dialog":wt("cancel",a),wt("close",a),_=p;break;case"iframe":case"object":case"embed":wt("load",a),_=p;break;case"video":case"audio":for(_=0;_<rh.length;_++)wt(rh[_],a);_=p;break;case"source":wt("error",a),_=p;break;case"img":case"image":case"link":wt("error",a),wt("load",a),_=p;break;case"details":wt("toggle",a),_=p;break;case"input":hn(a,p),_=Kn(a,p),wt("invalid",a);break;case"option":_=p;break;case"select":a._wrapperState={wasMultiple:!!p.multiple},_=ne({},p,{value:void 0}),wt("invalid",a);break;case"textarea":It(a,p),_=Ri(a,p),wt("invalid",a);break;default:_=p}On(d,_),U=_;for(v in U)if(U.hasOwnProperty(v)){var B=U[v];v==="style"?gs(a,B):v==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&ua(a,B)):v==="children"?typeof B=="string"?(d!=="textarea"||B!=="")&&Rr(a,B):typeof B=="number"&&Rr(a,""+B):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(r.hasOwnProperty(v)?B!=null&&v==="onScroll"&&wt("scroll",a):B!=null&&L(a,v,B,A))}switch(d){case"input":Qi(a),Ci(a,p,!1);break;case"textarea":Qi(a),Ai(a);break;case"option":p.value!=null&&a.setAttribute("value",""+Ve(p.value));break;case"select":a.multiple=!!p.multiple,v=p.value,v!=null?tn(a,!!p.multiple,v,!1):p.defaultValue!=null&&tn(a,!!p.multiple,p.defaultValue,!0);break;default:typeof _.onClick=="function"&&(a.onclick=Ff)}switch(d){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return Pn(u),null;case 6:if(a&&u.stateNode!=null)oT(a,u,a.memoizedProps,p);else{if(typeof p!="string"&&u.stateNode===null)throw Error(t(166));if(d=Ra(dh.current),Ra(Wr.current),Kf(u)){if(p=u.stateNode,d=u.memoizedProps,p[Gr]=u,(v=p.nodeValue!==d)&&(a=pi,a!==null))switch(a.tag){case 3:Vf(p.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Vf(p.nodeValue,d,(a.mode&1)!==0)}v&&(u.flags|=4)}else p=(d.nodeType===9?d:d.ownerDocument).createTextNode(p),p[Gr]=u,u.stateNode=p}return Pn(u),null;case 13:if(Et(At),p=u.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(St&&mi!==null&&(u.mode&1)!==0&&(u.flags&128)===0)u1(),au(),u.flags|=98560,v=!1;else if(v=Kf(u),p!==null&&p.dehydrated!==null){if(a===null){if(!v)throw Error(t(318));if(v=u.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[Gr]=u}else au(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Pn(u),v=!1}else rr!==null&&(C_(rr),rr=null),v=!0;if(!v)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=d,u):(p=p!==null,p!==(a!==null&&a.memoizedState!==null)&&p&&(u.child.flags|=8192,(u.mode&1)!==0&&(a===null||(At.current&1)!==0?Yt===0&&(Yt=3):P_())),u.updateQueue!==null&&(u.flags|=4),Pn(u),null);case 4:return hu(),p_(a,u),a===null&&sh(u.stateNode.containerInfo),Pn(u),null;case 10:return Gy(u.type._context),Pn(u),null;case 17:return Xn(u.type)&&Uf(),Pn(u),null;case 19:if(Et(At),v=u.memoizedState,v===null)return Pn(u),null;if(p=(u.flags&128)!==0,A=v.rendering,A===null)if(p)yh(v,!1);else{if(Yt!==0||a!==null&&(a.flags&128)!==0)for(a=u.child;a!==null;){if(A=Zf(a),A!==null){for(u.flags|=128,yh(v,!1),p=A.updateQueue,p!==null&&(u.updateQueue=p,u.flags|=4),u.subtreeFlags=0,p=d,d=u.child;d!==null;)v=d,a=p,v.flags&=14680066,A=v.alternate,A===null?(v.childLanes=0,v.lanes=a,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=A.childLanes,v.lanes=A.lanes,v.child=A.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=A.memoizedProps,v.memoizedState=A.memoizedState,v.updateQueue=A.updateQueue,v.type=A.type,a=A.dependencies,v.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return _t(At,At.current&1|2),u.child}a=a.sibling}v.tail!==null&&vt()>pu&&(u.flags|=128,p=!0,yh(v,!1),u.lanes=4194304)}else{if(!p)if(a=Zf(A),a!==null){if(u.flags|=128,p=!0,d=a.updateQueue,d!==null&&(u.updateQueue=d,u.flags|=4),yh(v,!0),v.tail===null&&v.tailMode==="hidden"&&!A.alternate&&!St)return Pn(u),null}else 2*vt()-v.renderingStartTime>pu&&d!==1073741824&&(u.flags|=128,p=!0,yh(v,!1),u.lanes=4194304);v.isBackwards?(A.sibling=u.child,u.child=A):(d=v.last,d!==null?d.sibling=A:u.child=A,v.last=A)}return v.tail!==null?(u=v.tail,v.rendering=u,v.tail=u.sibling,v.renderingStartTime=vt(),u.sibling=null,d=At.current,_t(At,p?d&1|2:d&1),u):(Pn(u),null);case 22:case 23:return A_(),p=u.memoizedState!==null,a!==null&&a.memoizedState!==null!==p&&(u.flags|=8192),p&&(u.mode&1)!==0?(yi&1073741824)!==0&&(Pn(u),u.subtreeFlags&6&&(u.flags|=8192)):Pn(u),null;case 24:return null;case 25:return null}throw Error(t(156,u.tag))}function tN(a,u){switch(Vy(u),u.tag){case 1:return Xn(u.type)&&Uf(),a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 3:return hu(),Et(Hn),Et(Rn),Yy(),a=u.flags,(a&65536)!==0&&(a&128)===0?(u.flags=a&-65537|128,u):null;case 5:return Xy(u),null;case 13:if(Et(At),a=u.memoizedState,a!==null&&a.dehydrated!==null){if(u.alternate===null)throw Error(t(340));au()}return a=u.flags,a&65536?(u.flags=a&-65537|128,u):null;case 19:return Et(At),null;case 4:return hu(),null;case 10:return Gy(u.type._context),null;case 22:case 23:return A_(),null;case 24:return null;default:return null}}var og=!1,bn=!1,nN=typeof WeakSet=="function"?WeakSet:Set,pe=null;function fu(a,u){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(p){Mt(a,u,p)}else d.current=null}function m_(a,u,d){try{d()}catch(p){Mt(a,u,p)}}var aT=!1;function iN(a,u){if(Ay=ws,a=jx(),wy(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var _=p.anchorOffset,v=p.focusNode;p=p.focusOffset;try{d.nodeType,v.nodeType}catch{d=null;break e}var A=0,U=-1,B=-1,Z=0,re=0,ae=a,ie=null;t:for(;;){for(var ge;ae!==d||_!==0&&ae.nodeType!==3||(U=A+_),ae!==v||p!==0&&ae.nodeType!==3||(B=A+p),ae.nodeType===3&&(A+=ae.nodeValue.length),(ge=ae.firstChild)!==null;)ie=ae,ae=ge;for(;;){if(ae===a)break t;if(ie===d&&++Z===_&&(U=A),ie===v&&++re===p&&(B=A),(ge=ae.nextSibling)!==null)break;ae=ie,ie=ae.parentNode}ae=ge}d=U===-1||B===-1?null:{start:U,end:B}}else d=null}d=d||{start:0,end:0}}else d=null;for(Py={focusedElem:a,selectionRange:d},ws=!1,pe=u;pe!==null;)if(u=pe,a=u.child,(u.subtreeFlags&1028)!==0&&a!==null)a.return=u,pe=a;else for(;pe!==null;){u=pe;try{var ye=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(ye!==null){var _e=ye.memoizedProps,jt=ye.memoizedState,H=u.stateNode,K=H.getSnapshotBeforeUpdate(u.elementType===u.type?_e:sr(u.type,_e),jt);H.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var q=u.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ue){Mt(u,u.return,ue)}if(a=u.sibling,a!==null){a.return=u.return,pe=a;break}pe=u.return}return ye=aT,aT=!1,ye}function _h(a,u,d){var p=u.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var _=p=p.next;do{if((_.tag&a)===a){var v=_.destroy;_.destroy=void 0,v!==void 0&&m_(u,d,v)}_=_.next}while(_!==p)}}function ag(a,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var d=u=u.next;do{if((d.tag&a)===a){var p=d.create;d.destroy=p()}d=d.next}while(d!==u)}}function y_(a){var u=a.ref;if(u!==null){var d=a.stateNode;a.tag,a=d,typeof u=="function"?u(a):u.current=a}}function lT(a){var u=a.alternate;u!==null&&(a.alternate=null,lT(u)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(u=a.stateNode,u!==null&&(delete u[Gr],delete u[ah],delete u[My],delete u[jM],delete u[UM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function uT(a){return a.tag===5||a.tag===3||a.tag===4}function cT(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||uT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function __(a,u,d){var p=a.tag;if(p===5||p===6)a=a.stateNode,u?d.nodeType===8?d.parentNode.insertBefore(a,u):d.insertBefore(a,u):(d.nodeType===8?(u=d.parentNode,u.insertBefore(a,d)):(u=d,u.appendChild(a)),d=d._reactRootContainer,d!=null||u.onclick!==null||(u.onclick=Ff));else if(p!==4&&(a=a.child,a!==null))for(__(a,u,d),a=a.sibling;a!==null;)__(a,u,d),a=a.sibling}function v_(a,u,d){var p=a.tag;if(p===5||p===6)a=a.stateNode,u?d.insertBefore(a,u):d.appendChild(a);else if(p!==4&&(a=a.child,a!==null))for(v_(a,u,d),a=a.sibling;a!==null;)v_(a,u,d),a=a.sibling}var _n=null,or=!1;function mo(a,u,d){for(d=d.child;d!==null;)hT(a,u,d),d=d.sibling}function hT(a,u,d){if(ui&&typeof ui.onCommitFiberUnmount=="function")try{ui.onCommitFiberUnmount(fa,d)}catch{}switch(d.tag){case 5:bn||fu(d,u);case 6:var p=_n,_=or;_n=null,mo(a,u,d),_n=p,or=_,_n!==null&&(or?(a=_n,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):_n.removeChild(d.stateNode));break;case 18:_n!==null&&(or?(a=_n,d=d.stateNode,a.nodeType===8?Dy(a.parentNode,d):a.nodeType===1&&Dy(a,d),so(a)):Dy(_n,d.stateNode));break;case 4:p=_n,_=or,_n=d.stateNode.containerInfo,or=!0,mo(a,u,d),_n=p,or=_;break;case 0:case 11:case 14:case 15:if(!bn&&(p=d.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){_=p=p.next;do{var v=_,A=v.destroy;v=v.tag,A!==void 0&&((v&2)!==0||(v&4)!==0)&&m_(d,u,A),_=_.next}while(_!==p)}mo(a,u,d);break;case 1:if(!bn&&(fu(d,u),p=d.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=d.memoizedProps,p.state=d.memoizedState,p.componentWillUnmount()}catch(U){Mt(d,u,U)}mo(a,u,d);break;case 21:mo(a,u,d);break;case 22:d.mode&1?(bn=(p=bn)||d.memoizedState!==null,mo(a,u,d),bn=p):mo(a,u,d);break;default:mo(a,u,d)}}function dT(a){var u=a.updateQueue;if(u!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new nN),u.forEach(function(p){var _=dN.bind(null,a,p);d.has(p)||(d.add(p),p.then(_,_))})}}function ar(a,u){var d=u.deletions;if(d!==null)for(var p=0;p<d.length;p++){var _=d[p];try{var v=a,A=u,U=A;e:for(;U!==null;){switch(U.tag){case 5:_n=U.stateNode,or=!1;break e;case 3:_n=U.stateNode.containerInfo,or=!0;break e;case 4:_n=U.stateNode.containerInfo,or=!0;break e}U=U.return}if(_n===null)throw Error(t(160));hT(v,A,_),_n=null,or=!1;var B=_.alternate;B!==null&&(B.return=null),_.return=null}catch(Z){Mt(_,u,Z)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)fT(u,a),u=u.sibling}function fT(a,u){var d=a.alternate,p=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(ar(u,a),$r(a),p&4){try{_h(3,a,a.return),ag(3,a)}catch(_e){Mt(a,a.return,_e)}try{_h(5,a,a.return)}catch(_e){Mt(a,a.return,_e)}}break;case 1:ar(u,a),$r(a),p&512&&d!==null&&fu(d,d.return);break;case 5:if(ar(u,a),$r(a),p&512&&d!==null&&fu(d,d.return),a.flags&32){var _=a.stateNode;try{Rr(_,"")}catch(_e){Mt(a,a.return,_e)}}if(p&4&&(_=a.stateNode,_!=null)){var v=a.memoizedProps,A=d!==null?d.memoizedProps:v,U=a.type,B=a.updateQueue;if(a.updateQueue=null,B!==null)try{U==="input"&&v.type==="radio"&&v.name!=null&&dn(_,v),ps(U,A);var Z=ps(U,v);for(A=0;A<B.length;A+=2){var re=B[A],ae=B[A+1];re==="style"?gs(_,ae):re==="dangerouslySetInnerHTML"?ua(_,ae):re==="children"?Rr(_,ae):L(_,re,ae,Z)}switch(U){case"input":$n(_,v);break;case"textarea":Js(_,v);break;case"select":var ie=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!v.multiple;var ge=v.value;ge!=null?tn(_,!!v.multiple,ge,!1):ie!==!!v.multiple&&(v.defaultValue!=null?tn(_,!!v.multiple,v.defaultValue,!0):tn(_,!!v.multiple,v.multiple?[]:"",!1))}_[ah]=v}catch(_e){Mt(a,a.return,_e)}}break;case 6:if(ar(u,a),$r(a),p&4){if(a.stateNode===null)throw Error(t(162));_=a.stateNode,v=a.memoizedProps;try{_.nodeValue=v}catch(_e){Mt(a,a.return,_e)}}break;case 3:if(ar(u,a),$r(a),p&4&&d!==null&&d.memoizedState.isDehydrated)try{so(u.containerInfo)}catch(_e){Mt(a,a.return,_e)}break;case 4:ar(u,a),$r(a);break;case 13:ar(u,a),$r(a),_=a.child,_.flags&8192&&(v=_.memoizedState!==null,_.stateNode.isHidden=v,!v||_.alternate!==null&&_.alternate.memoizedState!==null||(x_=vt())),p&4&&dT(a);break;case 22:if(re=d!==null&&d.memoizedState!==null,a.mode&1?(bn=(Z=bn)||re,ar(u,a),bn=Z):ar(u,a),$r(a),p&8192){if(Z=a.memoizedState!==null,(a.stateNode.isHidden=Z)&&!re&&(a.mode&1)!==0)for(pe=a,re=a.child;re!==null;){for(ae=pe=re;pe!==null;){switch(ie=pe,ge=ie.child,ie.tag){case 0:case 11:case 14:case 15:_h(4,ie,ie.return);break;case 1:fu(ie,ie.return);var ye=ie.stateNode;if(typeof ye.componentWillUnmount=="function"){p=ie,d=ie.return;try{u=p,ye.props=u.memoizedProps,ye.state=u.memoizedState,ye.componentWillUnmount()}catch(_e){Mt(p,d,_e)}}break;case 5:fu(ie,ie.return);break;case 22:if(ie.memoizedState!==null){mT(ae);continue}}ge!==null?(ge.return=ie,pe=ge):mT(ae)}re=re.sibling}e:for(re=null,ae=a;;){if(ae.tag===5){if(re===null){re=ae;try{_=ae.stateNode,Z?(v=_.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(U=ae.stateNode,B=ae.memoizedProps.style,A=B!=null&&B.hasOwnProperty("display")?B.display:null,U.style.display=Ar("display",A))}catch(_e){Mt(a,a.return,_e)}}}else if(ae.tag===6){if(re===null)try{ae.stateNode.nodeValue=Z?"":ae.memoizedProps}catch(_e){Mt(a,a.return,_e)}}else if((ae.tag!==22&&ae.tag!==23||ae.memoizedState===null||ae===a)&&ae.child!==null){ae.child.return=ae,ae=ae.child;continue}if(ae===a)break e;for(;ae.sibling===null;){if(ae.return===null||ae.return===a)break e;re===ae&&(re=null),ae=ae.return}re===ae&&(re=null),ae.sibling.return=ae.return,ae=ae.sibling}}break;case 19:ar(u,a),$r(a),p&4&&dT(a);break;case 21:break;default:ar(u,a),$r(a)}}function $r(a){var u=a.flags;if(u&2){try{e:{for(var d=a.return;d!==null;){if(uT(d)){var p=d;break e}d=d.return}throw Error(t(160))}switch(p.tag){case 5:var _=p.stateNode;p.flags&32&&(Rr(_,""),p.flags&=-33);var v=cT(a);v_(a,v,_);break;case 3:case 4:var A=p.stateNode.containerInfo,U=cT(a);__(a,U,A);break;default:throw Error(t(161))}}catch(B){Mt(a,a.return,B)}a.flags&=-3}u&4096&&(a.flags&=-4097)}function rN(a,u,d){pe=a,gT(a)}function gT(a,u,d){for(var p=(a.mode&1)!==0;pe!==null;){var _=pe,v=_.child;if(_.tag===22&&p){var A=_.memoizedState!==null||og;if(!A){var U=_.alternate,B=U!==null&&U.memoizedState!==null||bn;U=og;var Z=bn;if(og=A,(bn=B)&&!Z)for(pe=_;pe!==null;)A=pe,B=A.child,A.tag===22&&A.memoizedState!==null?yT(_):B!==null?(B.return=A,pe=B):yT(_);for(;v!==null;)pe=v,gT(v),v=v.sibling;pe=_,og=U,bn=Z}pT(a)}else(_.subtreeFlags&8772)!==0&&v!==null?(v.return=_,pe=v):pT(a)}}function pT(a){for(;pe!==null;){var u=pe;if((u.flags&8772)!==0){var d=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:bn||ag(5,u);break;case 1:var p=u.stateNode;if(u.flags&4&&!bn)if(d===null)p.componentDidMount();else{var _=u.elementType===u.type?d.memoizedProps:sr(u.type,d.memoizedProps);p.componentDidUpdate(_,d.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var v=u.updateQueue;v!==null&&m1(u,v,p);break;case 3:var A=u.updateQueue;if(A!==null){if(d=null,u.child!==null)switch(u.child.tag){case 5:d=u.child.stateNode;break;case 1:d=u.child.stateNode}m1(u,A,d)}break;case 5:var U=u.stateNode;if(d===null&&u.flags&4){d=U;var B=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&d.focus();break;case"img":B.src&&(d.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var Z=u.alternate;if(Z!==null){var re=Z.memoizedState;if(re!==null){var ae=re.dehydrated;ae!==null&&so(ae)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}bn||u.flags&512&&y_(u)}catch(ie){Mt(u,u.return,ie)}}if(u===a){pe=null;break}if(d=u.sibling,d!==null){d.return=u.return,pe=d;break}pe=u.return}}function mT(a){for(;pe!==null;){var u=pe;if(u===a){pe=null;break}var d=u.sibling;if(d!==null){d.return=u.return,pe=d;break}pe=u.return}}function yT(a){for(;pe!==null;){var u=pe;try{switch(u.tag){case 0:case 11:case 15:var d=u.return;try{ag(4,u)}catch(B){Mt(u,d,B)}break;case 1:var p=u.stateNode;if(typeof p.componentDidMount=="function"){var _=u.return;try{p.componentDidMount()}catch(B){Mt(u,_,B)}}var v=u.return;try{y_(u)}catch(B){Mt(u,v,B)}break;case 5:var A=u.return;try{y_(u)}catch(B){Mt(u,A,B)}}}catch(B){Mt(u,u.return,B)}if(u===a){pe=null;break}var U=u.sibling;if(U!==null){U.return=u.return,pe=U;break}pe=u.return}}var sN=Math.ceil,lg=O.ReactCurrentDispatcher,w_=O.ReactCurrentOwner,Fi=O.ReactCurrentBatchConfig,Qe=0,sn=null,Wt=null,vn=0,yi=0,gu=co(0),Yt=0,vh=null,Pa=0,ug=0,E_=0,wh=null,Yn=null,x_=0,pu=1/0,bs=null,cg=!1,T_=null,yo=null,hg=!1,_o=null,dg=0,Eh=0,I_=null,fg=-1,gg=0;function Un(){return(Qe&6)!==0?vt():fg!==-1?fg:fg=vt()}function vo(a){return(a.mode&1)===0?1:(Qe&2)!==0&&vn!==0?vn&-vn:BM.transition!==null?(gg===0&&(gg=Bc()),gg):(a=He,a!==0||(a=window.event,a=a===void 0?16:Wl(a.type)),a)}function lr(a,u,d,p){if(50<Eh)throw Eh=0,I_=null,Error(t(185));ya(a,d,p),((Qe&2)===0||a!==sn)&&(a===sn&&((Qe&2)===0&&(ug|=d),Yt===4&&wo(a,vn)),Zn(a,p),d===1&&Qe===0&&(u.mode&1)===0&&(pu=vt()+500,Bf&&fo()))}function Zn(a,u){var d=a.callbackNode;ma(a,u);var p=ys(a,a===sn?vn:0);if(p===0)d!==null&&Vl(d),a.callbackNode=null,a.callbackPriority=0;else if(u=p&-p,a.callbackPriority!==u){if(d!=null&&Vl(d),u===1)a.tag===0?zM(vT.bind(null,a)):r1(vT.bind(null,a)),VM(function(){(Qe&6)===0&&fo()}),d=null;else{switch(Mr(p)){case 1:d=Fl;break;case 4:d=jc;break;case 16:d=da;break;case 536870912:d=jl;break;default:d=da}d=RT(d,_T.bind(null,a))}a.callbackPriority=u,a.callbackNode=d}}function _T(a,u){if(fg=-1,gg=0,(Qe&6)!==0)throw Error(t(327));var d=a.callbackNode;if(mu()&&a.callbackNode!==d)return null;var p=ys(a,a===sn?vn:0);if(p===0)return null;if((p&30)!==0||(p&a.expiredLanes)!==0||u)u=pg(a,p);else{u=p;var _=Qe;Qe|=2;var v=ET();(sn!==a||vn!==u)&&(bs=null,pu=vt()+500,ka(a,u));do try{lN();break}catch(U){wT(a,U)}while(!0);By(),lg.current=v,Qe=_,Wt!==null?u=0:(sn=null,vn=0,u=Yt)}if(u!==0){if(u===2&&(_=zc(a),_!==0&&(p=_,u=S_(a,_))),u===1)throw d=vh,ka(a,0),wo(a,p),Zn(a,vt()),d;if(u===6)wo(a,p);else{if(_=a.current.alternate,(p&30)===0&&!oN(_)&&(u=pg(a,p),u===2&&(v=zc(a),v!==0&&(p=v,u=S_(a,v))),u===1))throw d=vh,ka(a,0),wo(a,p),Zn(a,vt()),d;switch(a.finishedWork=_,a.finishedLanes=p,u){case 0:case 1:throw Error(t(345));case 2:Da(a,Yn,bs);break;case 3:if(wo(a,p),(p&130023424)===p&&(u=x_+500-vt(),10<u)){if(ys(a,0)!==0)break;if(_=a.suspendedLanes,(_&p)!==p){Un(),a.pingedLanes|=a.suspendedLanes&_;break}a.timeoutHandle=ky(Da.bind(null,a,Yn,bs),u);break}Da(a,Yn,bs);break;case 4:if(wo(a,p),(p&4194240)===p)break;for(u=a.eventTimes,_=-1;0<p;){var A=31-ci(p);v=1<<A,A=u[A],A>_&&(_=A),p&=~v}if(p=_,p=vt()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*sN(p/1960))-p,10<p){a.timeoutHandle=ky(Da.bind(null,a,Yn,bs),p);break}Da(a,Yn,bs);break;case 5:Da(a,Yn,bs);break;default:throw Error(t(329))}}}return Zn(a,vt()),a.callbackNode===d?_T.bind(null,a):null}function S_(a,u){var d=wh;return a.current.memoizedState.isDehydrated&&(ka(a,u).flags|=256),a=pg(a,u),a!==2&&(u=Yn,Yn=d,u!==null&&C_(u)),a}function C_(a){Yn===null?Yn=a:Yn.push.apply(Yn,a)}function oN(a){for(var u=a;;){if(u.flags&16384){var d=u.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var p=0;p<d.length;p++){var _=d[p],v=_.getSnapshot;_=_.value;try{if(!ir(v(),_))return!1}catch{return!1}}}if(d=u.child,u.subtreeFlags&16384&&d!==null)d.return=u,u=d;else{if(u===a)break;for(;u.sibling===null;){if(u.return===null||u.return===a)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function wo(a,u){for(u&=~E_,u&=~ug,a.suspendedLanes|=u,a.pingedLanes&=~u,a=a.expirationTimes;0<u;){var d=31-ci(u),p=1<<d;a[d]=-1,u&=~p}}function vT(a){if((Qe&6)!==0)throw Error(t(327));mu();var u=ys(a,0);if((u&1)===0)return Zn(a,vt()),null;var d=pg(a,u);if(a.tag!==0&&d===2){var p=zc(a);p!==0&&(u=p,d=S_(a,p))}if(d===1)throw d=vh,ka(a,0),wo(a,u),Zn(a,vt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=u,Da(a,Yn,bs),Zn(a,vt()),null}function R_(a,u){var d=Qe;Qe|=1;try{return a(u)}finally{Qe=d,Qe===0&&(pu=vt()+500,Bf&&fo())}}function ba(a){_o!==null&&_o.tag===0&&(Qe&6)===0&&mu();var u=Qe;Qe|=1;var d=Fi.transition,p=He;try{if(Fi.transition=null,He=1,a)return a()}finally{He=p,Fi.transition=d,Qe=u,(Qe&6)===0&&fo()}}function A_(){yi=gu.current,Et(gu)}function ka(a,u){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,OM(d)),Wt!==null)for(d=Wt.return;d!==null;){var p=d;switch(Vy(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&Uf();break;case 3:hu(),Et(Hn),Et(Rn),Yy();break;case 5:Xy(p);break;case 4:hu();break;case 13:Et(At);break;case 19:Et(At);break;case 10:Gy(p.type._context);break;case 22:case 23:A_()}d=d.return}if(sn=a,Wt=a=Eo(a.current,null),vn=yi=u,Yt=0,vh=null,E_=ug=Pa=0,Yn=wh=null,Ca!==null){for(u=0;u<Ca.length;u++)if(d=Ca[u],p=d.interleaved,p!==null){d.interleaved=null;var _=p.next,v=d.pending;if(v!==null){var A=v.next;v.next=_,p.next=A}d.pending=p}Ca=null}return a}function wT(a,u){do{var d=Wt;try{if(By(),Qf.current=ng,Jf){for(var p=Pt.memoizedState;p!==null;){var _=p.queue;_!==null&&(_.pending=null),p=p.next}Jf=!1}if(Aa=0,rn=qt=Pt=null,fh=!1,gh=0,w_.current=null,d===null||d.return===null){Yt=1,vh=u,Wt=null;break}e:{var v=a,A=d.return,U=d,B=u;if(u=vn,U.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var Z=B,re=U,ae=re.tag;if((re.mode&1)===0&&(ae===0||ae===11||ae===15)){var ie=re.alternate;ie?(re.updateQueue=ie.updateQueue,re.memoizedState=ie.memoizedState,re.lanes=ie.lanes):(re.updateQueue=null,re.memoizedState=null)}var ge=K1(A);if(ge!==null){ge.flags&=-257,$1(ge,A,U,v,u),ge.mode&1&&W1(v,Z,u),u=ge,B=Z;var ye=u.updateQueue;if(ye===null){var _e=new Set;_e.add(B),u.updateQueue=_e}else ye.add(B);break e}else{if((u&1)===0){W1(v,Z,u),P_();break e}B=Error(t(426))}}else if(St&&U.mode&1){var jt=K1(A);if(jt!==null){(jt.flags&65536)===0&&(jt.flags|=256),$1(jt,A,U,v,u),Uy(du(B,U));break e}}v=B=du(B,U),Yt!==4&&(Yt=2),wh===null?wh=[v]:wh.push(v),v=A;do{switch(v.tag){case 3:v.flags|=65536,u&=-u,v.lanes|=u;var H=B1(v,B,u);p1(v,H);break e;case 1:U=B;var K=v.type,q=v.stateNode;if((v.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(yo===null||!yo.has(q)))){v.flags|=65536,u&=-u,v.lanes|=u;var ue=G1(v,U,u);p1(v,ue);break e}}v=v.return}while(v!==null)}TT(d)}catch(we){u=we,Wt===d&&d!==null&&(Wt=d=d.return);continue}break}while(!0)}function ET(){var a=lg.current;return lg.current=ng,a===null?ng:a}function P_(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),sn===null||(Pa&268435455)===0&&(ug&268435455)===0||wo(sn,vn)}function pg(a,u){var d=Qe;Qe|=2;var p=ET();(sn!==a||vn!==u)&&(bs=null,ka(a,u));do try{aN();break}catch(_){wT(a,_)}while(!0);if(By(),Qe=d,lg.current=p,Wt!==null)throw Error(t(261));return sn=null,vn=0,Yt}function aN(){for(;Wt!==null;)xT(Wt)}function lN(){for(;Wt!==null&&!ha();)xT(Wt)}function xT(a){var u=CT(a.alternate,a,yi);a.memoizedProps=a.pendingProps,u===null?TT(a):Wt=u,w_.current=null}function TT(a){var u=a;do{var d=u.alternate;if(a=u.return,(u.flags&32768)===0){if(d=eN(d,u,yi),d!==null){Wt=d;return}}else{if(d=tN(d,u),d!==null){d.flags&=32767,Wt=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Yt=6,Wt=null;return}}if(u=u.sibling,u!==null){Wt=u;return}Wt=u=a}while(u!==null);Yt===0&&(Yt=5)}function Da(a,u,d){var p=He,_=Fi.transition;try{Fi.transition=null,He=1,uN(a,u,d,p)}finally{Fi.transition=_,He=p}return null}function uN(a,u,d,p){do mu();while(_o!==null);if((Qe&6)!==0)throw Error(t(327));d=a.finishedWork;var _=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var v=d.lanes|d.childLanes;if(py(a,v),a===sn&&(Wt=sn=null,vn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||hg||(hg=!0,RT(da,function(){return mu(),null})),v=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||v){v=Fi.transition,Fi.transition=null;var A=He;He=1;var U=Qe;Qe|=4,w_.current=null,iN(a,d),fT(d,a),PM(Py),ws=!!Ay,Py=Ay=null,a.current=d,rN(d),ms(),Qe=U,He=A,Fi.transition=v}else a.current=d;if(hg&&(hg=!1,_o=a,dg=_),v=a.pendingLanes,v===0&&(yo=null),xf(d.stateNode),Zn(a,vt()),u!==null)for(p=a.onRecoverableError,d=0;d<u.length;d++)_=u[d],p(_.value,{componentStack:_.stack,digest:_.digest});if(cg)throw cg=!1,a=T_,T_=null,a;return(dg&1)!==0&&a.tag!==0&&mu(),v=a.pendingLanes,(v&1)!==0?a===I_?Eh++:(Eh=0,I_=a):Eh=0,fo(),null}function mu(){if(_o!==null){var a=Mr(dg),u=Fi.transition,d=He;try{if(Fi.transition=null,He=16>a?16:a,_o===null)var p=!1;else{if(a=_o,_o=null,dg=0,(Qe&6)!==0)throw Error(t(331));var _=Qe;for(Qe|=4,pe=a.current;pe!==null;){var v=pe,A=v.child;if((pe.flags&16)!==0){var U=v.deletions;if(U!==null){for(var B=0;B<U.length;B++){var Z=U[B];for(pe=Z;pe!==null;){var re=pe;switch(re.tag){case 0:case 11:case 15:_h(8,re,v)}var ae=re.child;if(ae!==null)ae.return=re,pe=ae;else for(;pe!==null;){re=pe;var ie=re.sibling,ge=re.return;if(lT(re),re===Z){pe=null;break}if(ie!==null){ie.return=ge,pe=ie;break}pe=ge}}}var ye=v.alternate;if(ye!==null){var _e=ye.child;if(_e!==null){ye.child=null;do{var jt=_e.sibling;_e.sibling=null,_e=jt}while(_e!==null)}}pe=v}}if((v.subtreeFlags&2064)!==0&&A!==null)A.return=v,pe=A;else e:for(;pe!==null;){if(v=pe,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:_h(9,v,v.return)}var H=v.sibling;if(H!==null){H.return=v.return,pe=H;break e}pe=v.return}}var K=a.current;for(pe=K;pe!==null;){A=pe;var q=A.child;if((A.subtreeFlags&2064)!==0&&q!==null)q.return=A,pe=q;else e:for(A=K;pe!==null;){if(U=pe,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:ag(9,U)}}catch(we){Mt(U,U.return,we)}if(U===A){pe=null;break e}var ue=U.sibling;if(ue!==null){ue.return=U.return,pe=ue;break e}pe=U.return}}if(Qe=_,fo(),ui&&typeof ui.onPostCommitFiberRoot=="function")try{ui.onPostCommitFiberRoot(fa,a)}catch{}p=!0}return p}finally{He=d,Fi.transition=u}}return!1}function IT(a,u,d){u=du(d,u),u=B1(a,u,1),a=po(a,u,1),u=Un(),a!==null&&(ya(a,1,u),Zn(a,u))}function Mt(a,u,d){if(a.tag===3)IT(a,a,d);else for(;u!==null;){if(u.tag===3){IT(u,a,d);break}else if(u.tag===1){var p=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(yo===null||!yo.has(p))){a=du(d,a),a=G1(u,a,1),u=po(u,a,1),a=Un(),u!==null&&(ya(u,1,a),Zn(u,a));break}}u=u.return}}function cN(a,u,d){var p=a.pingCache;p!==null&&p.delete(u),u=Un(),a.pingedLanes|=a.suspendedLanes&d,sn===a&&(vn&d)===d&&(Yt===4||Yt===3&&(vn&130023424)===vn&&500>vt()-x_?ka(a,0):E_|=d),Zn(a,u)}function ST(a,u){u===0&&((a.mode&1)===0?u=1:(u=no,no<<=1,(no&130023424)===0&&(no=4194304)));var d=Un();a=Rs(a,u),a!==null&&(ya(a,u,d),Zn(a,d))}function hN(a){var u=a.memoizedState,d=0;u!==null&&(d=u.retryLane),ST(a,d)}function dN(a,u){var d=0;switch(a.tag){case 13:var p=a.stateNode,_=a.memoizedState;_!==null&&(d=_.retryLane);break;case 19:p=a.stateNode;break;default:throw Error(t(314))}p!==null&&p.delete(u),ST(a,d)}var CT;CT=function(a,u,d){if(a!==null)if(a.memoizedProps!==u.pendingProps||Hn.current)qn=!0;else{if((a.lanes&d)===0&&(u.flags&128)===0)return qn=!1,JM(a,u,d);qn=(a.flags&131072)!==0}else qn=!1,St&&(u.flags&1048576)!==0&&s1(u,Wf,u.index);switch(u.lanes=0,u.tag){case 2:var p=u.type;sg(a,u),a=u.pendingProps;var _=ru(u,Rn.current);cu(u,d),_=Jy(null,u,p,a,_,d);var v=e_();return u.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Xn(p)?(v=!0,zf(u)):v=!1,u.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,$y(u),_.updater=ig,u.stateNode=_,_._reactInternals=u,o_(u,p,a,d),u=c_(null,u,p,!0,v,d)):(u.tag=0,St&&v&&Oy(u),jn(null,u,_,d),u=u.child),u;case 16:p=u.elementType;e:{switch(sg(a,u),a=u.pendingProps,_=p._init,p=_(p._payload),u.type=p,_=u.tag=gN(p),a=sr(p,a),_){case 0:u=u_(null,u,p,a,d);break e;case 1:u=Q1(null,u,p,a,d);break e;case 11:u=H1(null,u,p,a,d);break e;case 14:u=X1(null,u,p,sr(p.type,a),d);break e}throw Error(t(306,p,""))}return u;case 0:return p=u.type,_=u.pendingProps,_=u.elementType===p?_:sr(p,_),u_(a,u,p,_,d);case 1:return p=u.type,_=u.pendingProps,_=u.elementType===p?_:sr(p,_),Q1(a,u,p,_,d);case 3:e:{if(J1(u),a===null)throw Error(t(387));p=u.pendingProps,v=u.memoizedState,_=v.element,g1(a,u),Yf(u,p,null,d);var A=u.memoizedState;if(p=A.element,v.isDehydrated)if(v={element:p,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},u.updateQueue.baseState=v,u.memoizedState=v,u.flags&256){_=du(Error(t(423)),u),u=eT(a,u,p,d,_);break e}else if(p!==_){_=du(Error(t(424)),u),u=eT(a,u,p,d,_);break e}else for(mi=uo(u.stateNode.containerInfo.firstChild),pi=u,St=!0,rr=null,d=d1(u,null,p,d),u.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(au(),p===_){u=Ps(a,u,d);break e}jn(a,u,p,d)}u=u.child}return u;case 5:return y1(u),a===null&&jy(u),p=u.type,_=u.pendingProps,v=a!==null?a.memoizedProps:null,A=_.children,by(p,_)?A=null:v!==null&&by(p,v)&&(u.flags|=32),Z1(a,u),jn(a,u,A,d),u.child;case 6:return a===null&&jy(u),null;case 13:return tT(a,u,d);case 4:return Hy(u,u.stateNode.containerInfo),p=u.pendingProps,a===null?u.child=lu(u,null,p,d):jn(a,u,p,d),u.child;case 11:return p=u.type,_=u.pendingProps,_=u.elementType===p?_:sr(p,_),H1(a,u,p,_,d);case 7:return jn(a,u,u.pendingProps,d),u.child;case 8:return jn(a,u,u.pendingProps.children,d),u.child;case 12:return jn(a,u,u.pendingProps.children,d),u.child;case 10:e:{if(p=u.type._context,_=u.pendingProps,v=u.memoizedProps,A=_.value,_t(Hf,p._currentValue),p._currentValue=A,v!==null)if(ir(v.value,A)){if(v.children===_.children&&!Hn.current){u=Ps(a,u,d);break e}}else for(v=u.child,v!==null&&(v.return=u);v!==null;){var U=v.dependencies;if(U!==null){A=v.child;for(var B=U.firstContext;B!==null;){if(B.context===p){if(v.tag===1){B=As(-1,d&-d),B.tag=2;var Z=v.updateQueue;if(Z!==null){Z=Z.shared;var re=Z.pending;re===null?B.next=B:(B.next=re.next,re.next=B),Z.pending=B}}v.lanes|=d,B=v.alternate,B!==null&&(B.lanes|=d),Wy(v.return,d,u),U.lanes|=d;break}B=B.next}}else if(v.tag===10)A=v.type===u.type?null:v.child;else if(v.tag===18){if(A=v.return,A===null)throw Error(t(341));A.lanes|=d,U=A.alternate,U!==null&&(U.lanes|=d),Wy(A,d,u),A=v.sibling}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===u){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}jn(a,u,_.children,d),u=u.child}return u;case 9:return _=u.type,p=u.pendingProps.children,cu(u,d),_=Oi(_),p=p(_),u.flags|=1,jn(a,u,p,d),u.child;case 14:return p=u.type,_=sr(p,u.pendingProps),_=sr(p.type,_),X1(a,u,p,_,d);case 15:return q1(a,u,u.type,u.pendingProps,d);case 17:return p=u.type,_=u.pendingProps,_=u.elementType===p?_:sr(p,_),sg(a,u),u.tag=1,Xn(p)?(a=!0,zf(u)):a=!1,cu(u,d),U1(u,p,_),o_(u,p,_,d),c_(null,u,p,!0,a,d);case 19:return iT(a,u,d);case 22:return Y1(a,u,d)}throw Error(t(156,u.tag))};function RT(a,u){return Fc(a,u)}function fN(a,u,d,p){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ji(a,u,d,p){return new fN(a,u,d,p)}function b_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function gN(a){if(typeof a=="function")return b_(a)?1:0;if(a!=null){if(a=a.$$typeof,a===z)return 11;if(a===me)return 14}return 2}function Eo(a,u){var d=a.alternate;return d===null?(d=ji(a.tag,u,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=u,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,u=a.dependencies,d.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function mg(a,u,d,p,_,v){var A=2;if(p=a,typeof a=="function")b_(a)&&(A=1);else if(typeof a=="string")A=5;else e:switch(a){case P:return Ma(d.children,_,v,u);case R:A=8,_|=8;break;case k:return a=ji(12,d,u,_|2),a.elementType=k,a.lanes=v,a;case N:return a=ji(13,d,u,_),a.elementType=N,a.lanes=v,a;case le:return a=ji(19,d,u,_),a.elementType=le,a.lanes=v,a;case ce:return yg(d,_,v,u);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case V:A=10;break e;case j:A=9;break e;case z:A=11;break e;case me:A=14;break e;case fe:A=16,p=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return u=ji(A,d,u,_),u.elementType=a,u.type=p,u.lanes=v,u}function Ma(a,u,d,p){return a=ji(7,a,p,u),a.lanes=d,a}function yg(a,u,d,p){return a=ji(22,a,p,u),a.elementType=ce,a.lanes=d,a.stateNode={isHidden:!1},a}function k_(a,u,d){return a=ji(6,a,null,u),a.lanes=d,a}function D_(a,u,d){return u=ji(4,a.children!==null?a.children:[],a.key,u),u.lanes=d,u.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},u}function pN(a,u,d,p,_){this.tag=u,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gc(0),this.expirationTimes=Gc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gc(0),this.identifierPrefix=p,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function M_(a,u,d,p,_,v,A,U,B){return a=new pN(a,u,d,U,B),u===1?(u=1,v===!0&&(u|=8)):u=0,v=ji(3,null,null,u),a.current=v,v.stateNode=a,v.memoizedState={element:p,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},$y(v),a}function mN(a,u,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:p==null?null:""+p,children:a,containerInfo:u,implementation:d}}function AT(a){if(!a)return ho;a=a._reactInternals;e:{if(tr(a)!==a||a.tag!==1)throw Error(t(170));var u=a;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Xn(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(Xn(d))return n1(a,d,u)}return u}function PT(a,u,d,p,_,v,A,U,B){return a=M_(d,p,!0,a,_,v,A,U,B),a.context=AT(null),d=a.current,p=Un(),_=vo(d),v=As(p,_),v.callback=u??null,po(d,v,_),a.current.lanes=_,ya(a,_,p),Zn(a,p),a}function _g(a,u,d,p){var _=u.current,v=Un(),A=vo(_);return d=AT(d),u.context===null?u.context=d:u.pendingContext=d,u=As(v,A),u.payload={element:a},p=p===void 0?null:p,p!==null&&(u.callback=p),a=po(_,u,A),a!==null&&(lr(a,_,A,v),qf(a,_,A)),A}function vg(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function bT(a,u){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<u?d:u}}function N_(a,u){bT(a,u),(a=a.alternate)&&bT(a,u)}function yN(){return null}var kT=typeof reportError=="function"?reportError:function(a){console.error(a)};function L_(a){this._internalRoot=a}wg.prototype.render=L_.prototype.render=function(a){var u=this._internalRoot;if(u===null)throw Error(t(409));_g(a,u,null,null)},wg.prototype.unmount=L_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var u=a.containerInfo;ba(function(){_g(null,a,null,null)}),u[Ts]=null}};function wg(a){this._internalRoot=a}wg.prototype.unstable_scheduleHydration=function(a){if(a){var u=Hc();a={blockedOn:null,target:a,priority:u};for(var d=0;d<hi.length&&u!==0&&u<hi[d].priority;d++);hi.splice(d,0,a),d===0&&Bl(a)}};function O_(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Eg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function DT(){}function _N(a,u,d,p,_){if(_){if(typeof p=="function"){var v=p;p=function(){var Z=vg(A);v.call(Z)}}var A=PT(u,p,a,0,null,!1,!1,"",DT);return a._reactRootContainer=A,a[Ts]=A.current,sh(a.nodeType===8?a.parentNode:a),ba(),A}for(;_=a.lastChild;)a.removeChild(_);if(typeof p=="function"){var U=p;p=function(){var Z=vg(B);U.call(Z)}}var B=M_(a,0,!1,null,null,!1,!1,"",DT);return a._reactRootContainer=B,a[Ts]=B.current,sh(a.nodeType===8?a.parentNode:a),ba(function(){_g(u,B,d,p)}),B}function xg(a,u,d,p,_){var v=d._reactRootContainer;if(v){var A=v;if(typeof _=="function"){var U=_;_=function(){var B=vg(A);U.call(B)}}_g(u,A,a,_)}else A=_N(d,u,a,_,p);return vg(A)}Kc=function(a){switch(a.tag){case 3:var u=a.stateNode;if(u.current.memoizedState.isDehydrated){var d=st(u.pendingLanes);d!==0&&(Wc(u,d|1),Zn(u,vt()),(Qe&6)===0&&(pu=vt()+500,fo()))}break;case 13:ba(function(){var p=Rs(a,1);if(p!==null){var _=Un();lr(p,a,1,_)}}),N_(a,1)}},Ul=function(a){if(a.tag===13){var u=Rs(a,134217728);if(u!==null){var d=Un();lr(u,a,134217728,d)}N_(a,134217728)}},$c=function(a){if(a.tag===13){var u=vo(a),d=Rs(a,u);if(d!==null){var p=Un();lr(d,a,u,p)}N_(a,u)}},Hc=function(){return He},Xc=function(a,u){var d=He;try{return He=a,u()}finally{He=d}},Vn=function(a,u,d){switch(u){case"input":if($n(a,d),u=d.name,d.type==="radio"&&u!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<d.length;u++){var p=d[u];if(p!==a&&p.form===a.form){var _=jf(p);if(!_)throw Error(t(90));fs(p),$n(p,_)}}}break;case"textarea":Js(a,d);break;case"select":u=d.value,u!=null&&tn(a,!!d.multiple,u,!1)}},bi=R_,fn=ba;var vN={usingClientEntryPoint:!1,Events:[lh,nu,jf,er,Ot,R_]},xh={findFiberByHostInstance:xa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wN={bundleType:xh.bundleType,version:xh.version,rendererPackageName:xh.rendererPackageName,rendererConfig:xh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:O.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Ef(a),a===null?null:a.stateNode},findFiberByHostInstance:xh.findFiberByHostInstance||yN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tg.isDisabled&&Tg.supportsFiber)try{fa=Tg.inject(wN),ui=Tg}catch{}}return Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vN,Qn.createPortal=function(a,u){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O_(u))throw Error(t(200));return mN(a,u,null,d)},Qn.createRoot=function(a,u){if(!O_(a))throw Error(t(299));var d=!1,p="",_=kT;return u!=null&&(u.unstable_strictMode===!0&&(d=!0),u.identifierPrefix!==void 0&&(p=u.identifierPrefix),u.onRecoverableError!==void 0&&(_=u.onRecoverableError)),u=M_(a,1,!1,null,null,d,!1,p,_),a[Ts]=u.current,sh(a.nodeType===8?a.parentNode:a),new L_(u)},Qn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var u=a._reactInternals;if(u===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Ef(u),a=a===null?null:a.stateNode,a},Qn.flushSync=function(a){return ba(a)},Qn.hydrate=function(a,u,d){if(!Eg(u))throw Error(t(200));return xg(null,a,u,!0,d)},Qn.hydrateRoot=function(a,u,d){if(!O_(a))throw Error(t(405));var p=d!=null&&d.hydratedSources||null,_=!1,v="",A=kT;if(d!=null&&(d.unstable_strictMode===!0&&(_=!0),d.identifierPrefix!==void 0&&(v=d.identifierPrefix),d.onRecoverableError!==void 0&&(A=d.onRecoverableError)),u=PT(u,null,a,1,d??null,_,!1,v,A),a[Ts]=u.current,sh(a),p)for(a=0;a<p.length;a++)d=p[a],_=d._getVersion,_=_(d._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[d,_]:u.mutableSourceEagerHydrationData.push(d,_);return new wg(u)},Qn.render=function(a,u,d){if(!Eg(u))throw Error(t(200));return xg(null,a,u,!1,d)},Qn.unmountComponentAtNode=function(a){if(!Eg(a))throw Error(t(40));return a._reactRootContainer?(ba(function(){xg(null,null,a,!1,function(){a._reactRootContainer=null,a[Ts]=null})}),!0):!1},Qn.unstable_batchedUpdates=R_,Qn.unstable_renderSubtreeIntoContainer=function(a,u,d,p){if(!Eg(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return xg(a,u,d,!1,p)},Qn.version="18.3.1-next-f1338f8080-20240426",Qn}var UT;function AN(){if(UT)return j_.exports;UT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),j_.exports=RN(),j_.exports}var zT;function PN(){if(zT)return Ig;zT=1;var n=AN();return Ig.createRoot=n.createRoot,Ig.hydrateRoot=n.hydrateRoot,Ig}var bN=PN();const kN=gw(bN);var J=Wd();const DN=gw(J),pw=J.createContext({});function mw(n){const e=J.useRef(null);return e.current===null&&(e.current=n()),e.current}const mm=J.createContext(null),yw=J.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class MN extends J.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function NN({children:n,isPresent:e}){const t=J.useId(),i=J.useRef(null),r=J.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=J.useContext(yw);return J.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${c}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),T.jsx(MN,{isPresent:e,childRef:i,sizeRef:r,children:J.cloneElement(n,{ref:i})})}const LN=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=mw(ON),c=J.useId(),h=J.useCallback(m=>{l.set(m,!0);for(const y of l.values())if(!y)return;i&&i()},[l,i]),f=J.useMemo(()=>({id:c,initial:e,isPresent:t,custom:r,onExitComplete:h,register:m=>(l.set(m,!1),()=>l.delete(m))}),s?[Math.random(),h]:[t,h]);return J.useMemo(()=>{l.forEach((m,y)=>l.set(y,!1))},[t]),J.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=T.jsx(NN,{isPresent:t,children:n})),T.jsx(mm.Provider,{value:f,children:n})};function ON(){return new Map}function wA(n=!0){const e=J.useContext(mm);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=J.useId();J.useEffect(()=>{n&&r(s)},[n]);const o=J.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Sg=n=>n.key||"";function BT(n){const e=[];return J.Children.forEach(n,t=>{J.isValidElement(t)&&e.push(t)}),e}const _w=typeof window<"u",EA=_w?J.useLayoutEffect:J.useEffect,ra=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,c]=wA(o),h=J.useMemo(()=>BT(n),[n]),f=o&&!l?[]:h.map(Sg),m=J.useRef(!0),y=J.useRef(h),E=mw(()=>new Map),[I,C]=J.useState(h),[x,b]=J.useState(h);EA(()=>{m.current=!1,y.current=h;for(let O=0;O<x.length;O++){const F=Sg(x[O]);f.includes(F)?E.delete(F):E.get(F)!==!0&&E.set(F,!1)}},[x,f.length,f.join("-")]);const D=[];if(h!==I){let O=[...h];for(let F=0;F<x.length;F++){const W=x[F],P=Sg(W);f.includes(P)||(O.splice(F,0,W),D.push(W))}s==="wait"&&D.length&&(O=D),b(BT(O)),C(h);return}const{forceRender:L}=J.useContext(pw);return T.jsx(T.Fragment,{children:x.map(O=>{const F=Sg(O),W=o&&!l?!1:h===x||f.includes(F),P=()=>{if(E.has(F))E.set(F,!0);else return;let R=!0;E.forEach(k=>{k||(R=!1)}),R&&(L?.(),b(y.current),o&&c?.(),i&&i())};return T.jsx(LN,{isPresent:W,initial:!m.current||t?void 0:!1,custom:W?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:W?void 0:P,children:O},F)})})},xi=n=>n;let xA=xi;function vw(n){let e;return()=>(e===void 0&&(e=n()),e)}const ec=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},Us=n=>n*1e3,zs=n=>n/1e3,VN={useManualTiming:!1};function FN(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(c.schedule(h),n()),h(o)}const c={schedule:(h,f=!1,m=!1)=>{const E=m&&i?e:t;return f&&s.add(h),E.has(h)||E.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,c.process(h))}};return c}const Cg=["read","resolveKeyframes","update","preRender","render","postRender"],jN=40;function TA(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Cg.reduce((b,D)=>(b[D]=FN(s),b),{}),{read:l,resolveKeyframes:c,update:h,preRender:f,render:m,postRender:y}=o,E=()=>{const b=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(b-r.timestamp,jN),1),r.timestamp=b,r.isProcessing=!0,l.process(r),c.process(r),h.process(r),f.process(r),m.process(r),y.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(E))},I=()=>{t=!0,i=!0,r.isProcessing||n(E)};return{schedule:Cg.reduce((b,D)=>{const L=o[D];return b[D]=(O,F=!1,W=!1)=>(t||I(),L.schedule(O,F,W)),b},{}),cancel:b=>{for(let D=0;D<Cg.length;D++)o[Cg[D]].cancel(b)},state:r,steps:o}}const{schedule:xt,cancel:Zo,state:wn,steps:B_}=TA(typeof requestAnimationFrame<"u"?requestAnimationFrame:xi,!0),IA=J.createContext({strict:!1}),GT={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},tc={};for(const n in GT)tc[n]={isEnabled:e=>GT[n].some(t=>!!e[t])};function UN(n){for(const e in n)tc[e]={...tc[e],...n[e]}}const zN=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function vp(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||zN.has(n)}let SA=n=>!vp(n);function BN(n){n&&(SA=e=>e.startsWith("on")?!vp(e):n(e))}try{BN(require("@emotion/is-prop-valid").default)}catch{}function GN(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(SA(r)||t===!0&&vp(r)||!e&&!vp(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function WN(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const ym=J.createContext({});function dd(n){return typeof n=="string"||Array.isArray(n)}function _m(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const ww=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Ew=["initial",...ww];function vm(n){return _m(n.animate)||Ew.some(e=>dd(n[e]))}function CA(n){return!!(vm(n)||n.variants)}function KN(n,e){if(vm(n)){const{initial:t,animate:i}=n;return{initial:t===!1||dd(t)?t:void 0,animate:dd(i)?i:void 0}}return n.inherit!==!1?e:{}}function $N(n){const{initial:e,animate:t}=KN(n,J.useContext(ym));return J.useMemo(()=>({initial:e,animate:t}),[WT(e),WT(t)])}function WT(n){return Array.isArray(n)?n.join(" "):n}const HN=Symbol.for("motionComponentSymbol");function Fu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function XN(n,e,t){return J.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):Fu(t)&&(t.current=i))},[e])}const xw=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),qN="framerAppearId",RA="data-"+xw(qN),{schedule:Tw}=TA(queueMicrotask,!1),AA=J.createContext({});function YN(n,e,t,i,r){var s,o;const{visualElement:l}=J.useContext(ym),c=J.useContext(IA),h=J.useContext(mm),f=J.useContext(yw).reducedMotion,m=J.useRef(null);i=i||c.renderer,!m.current&&i&&(m.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const y=m.current,E=J.useContext(AA);y&&!y.projection&&r&&(y.type==="html"||y.type==="svg")&&ZN(m.current,t,r,E);const I=J.useRef(!1);J.useInsertionEffect(()=>{y&&I.current&&y.update(t,h)});const C=t[RA],x=J.useRef(!!C&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,C))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,C)));return EA(()=>{y&&(I.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),Tw.render(y.render),x.current&&y.animationState&&y.animationState.animateChanges())}),J.useEffect(()=>{y&&(!x.current&&y.animationState&&y.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)===null||b===void 0||b.call(window,C)}),x.current=!1))}),y}function ZN(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:c,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:PA(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&Fu(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:c,layoutRoot:h})}function PA(n){if(n)return n.options.allowProjection!==!1?n.projection:PA(n.parent)}function QN({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&UN(n);function l(h,f){let m;const y={...J.useContext(yw),...h,layoutId:JN(h)},{isStatic:E}=y,I=$N(h),C=i(h,E);if(!E&&_w){eL();const x=tL(y);m=x.MeasureLayout,I.visualElement=YN(r,C,y,e,x.ProjectionNode)}return T.jsxs(ym.Provider,{value:I,children:[m&&I.visualElement?T.jsx(m,{visualElement:I.visualElement,...y}):null,t(r,h,XN(C,I.visualElement,f),C,E,I.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const c=J.forwardRef(l);return c[HN]=r,c}function JN({layoutId:n}){const e=J.useContext(pw).id;return e&&n!==void 0?e+"-"+n:n}function eL(n,e){J.useContext(IA).strict}function tL(n){const{drag:e,layout:t}=tc;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const nL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Iw(n){return typeof n!="string"||n.includes("-")?!1:!!(nL.indexOf(n)>-1||/[A-Z]/u.test(n))}function KT(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function Sw(n,e,t,i){if(typeof e=="function"){const[r,s]=KT(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=KT(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const Y0=n=>Array.isArray(n),iL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),rL=n=>Y0(n)?n[n.length-1]||0:n,Ln=n=>!!(n&&n.getVelocity);function ep(n){const e=Ln(n)?n.get():n;return iL(e)?e.toValue():e}function sL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:oL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const bA=n=>(e,t)=>{const i=J.useContext(ym),r=J.useContext(mm),s=()=>sL(n,e,i,r);return t?s():mw(s)};function oL(n,e,t,i){const r={},s=i(n,{});for(const y in s)r[y]=ep(s[y]);let{initial:o,animate:l}=n;const c=vm(n),h=CA(n);e&&h&&!c&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const m=f?l:o;if(m&&typeof m!="boolean"&&!_m(m)){const y=Array.isArray(m)?m:[m];for(let E=0;E<y.length;E++){const I=Sw(n,y[E]);if(I){const{transitionEnd:C,transition:x,...b}=I;for(const D in b){let L=b[D];if(Array.isArray(L)){const O=f?L.length-1:0;L=L[O]}L!==null&&(r[D]=L)}for(const D in C)r[D]=C[D]}}}return r}const Rc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Al=new Set(Rc),kA=n=>e=>typeof e=="string"&&e.startsWith(n),DA=kA("--"),aL=kA("var(--"),Cw=n=>aL(n)?lL.test(n.split("/*")[0].trim()):!1,lL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,MA=(n,e)=>e&&typeof n=="number"?e.transform(n):n,$s=(n,e,t)=>t>e?e:t<n?n:t,Ac={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},fd={...Ac,transform:n=>$s(0,1,n)},Rg={...Ac,default:1},Kd=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Mo=Kd("deg"),es=Kd("%"),ke=Kd("px"),uL=Kd("vh"),cL=Kd("vw"),$T={...es,parse:n=>es.parse(n)/100,transform:n=>es.transform(n*100)},hL={borderWidth:ke,borderTopWidth:ke,borderRightWidth:ke,borderBottomWidth:ke,borderLeftWidth:ke,borderRadius:ke,radius:ke,borderTopLeftRadius:ke,borderTopRightRadius:ke,borderBottomRightRadius:ke,borderBottomLeftRadius:ke,width:ke,maxWidth:ke,height:ke,maxHeight:ke,top:ke,right:ke,bottom:ke,left:ke,padding:ke,paddingTop:ke,paddingRight:ke,paddingBottom:ke,paddingLeft:ke,margin:ke,marginTop:ke,marginRight:ke,marginBottom:ke,marginLeft:ke,backgroundPositionX:ke,backgroundPositionY:ke},dL={rotate:Mo,rotateX:Mo,rotateY:Mo,rotateZ:Mo,scale:Rg,scaleX:Rg,scaleY:Rg,scaleZ:Rg,skew:Mo,skewX:Mo,skewY:Mo,distance:ke,translateX:ke,translateY:ke,translateZ:ke,x:ke,y:ke,z:ke,perspective:ke,transformPerspective:ke,opacity:fd,originX:$T,originY:$T,originZ:ke},HT={...Ac,transform:Math.round},Rw={...hL,...dL,zIndex:HT,size:ke,fillOpacity:fd,strokeOpacity:fd,numOctaves:HT},fL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},gL=Rc.length;function pL(n,e,t){let i="",r=!0;for(let s=0;s<gL;s++){const o=Rc[s],l=n[o];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(o.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||t){const h=MA(l,Rw[o]);if(!c){r=!1;const f=fL[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function Aw(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const c in e){const h=e[c];if(Al.has(c)){o=!0;continue}else if(DA(c)){r[c]=h;continue}else{const f=MA(h,Rw[c]);c.startsWith("origin")?(l=!0,s[c]=f):i[c]=f}}if(e.transform||(o||t?i.transform=pL(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:c="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${c} ${h} ${f}`}}const mL={offset:"stroke-dashoffset",array:"stroke-dasharray"},yL={offset:"strokeDashoffset",array:"strokeDasharray"};function _L(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?mL:yL;n[s.offset]=ke.transform(-i);const o=ke.transform(e),l=ke.transform(t);n[s.array]=`${o} ${l}`}function XT(n,e,t){return typeof n=="string"?n:ke.transform(e+t*n)}function vL(n,e,t){const i=XT(e,n.x,n.width),r=XT(t,n.y,n.height);return`${i} ${r}`}function Pw(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...h},f,m){if(Aw(n,h,m),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:y,style:E,dimensions:I}=n;y.transform&&(I&&(E.transform=y.transform),delete y.transform),I&&(r!==void 0||s!==void 0||E.transform)&&(E.transformOrigin=vL(I,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(y.x=e),t!==void 0&&(y.y=t),i!==void 0&&(y.scale=i),o!==void 0&&_L(y,o,l,c,!1)}const bw=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),NA=()=>({...bw(),attrs:{}}),kw=n=>typeof n=="string"&&n.toLowerCase()==="svg";function LA(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const OA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function VA(n,e,t,i){LA(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(OA.has(r)?r:xw(r),e.attrs[r])}const wp={};function wL(n){Object.assign(wp,n)}function FA(n,{layout:e,layoutId:t}){return Al.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!wp[n]||n==="opacity")}function Dw(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(Ln(r[o])||e.style&&Ln(e.style[o])||FA(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function jA(n,e,t){const i=Dw(n,e,t);for(const r in n)if(Ln(n[r])||Ln(e[r])){const s=Rc.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function EL(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const qT=["x","y","width","height","cx","cy","r"],xL={useVisualState:bA({scrapeMotionValuesFromProps:jA,createRenderState:NA,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(Al.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<qT.length;l++){const c=qT[l];n[c]!==e[c]&&(o=!0)}o&&xt.read(()=>{EL(t,i),xt.render(()=>{Pw(i,r,kw(t.tagName),n.transformTemplate),VA(t,i)})})}})},TL={useVisualState:bA({scrapeMotionValuesFromProps:Dw,createRenderState:bw})};function UA(n,e,t){for(const i in e)!Ln(e[i])&&!FA(i,t)&&(n[i]=e[i])}function IL({transformTemplate:n},e){return J.useMemo(()=>{const t=bw();return Aw(t,e,n),Object.assign({},t.vars,t.style)},[e])}function SL(n,e){const t=n.style||{},i={};return UA(i,t,n),Object.assign(i,IL(n,e)),i}function CL(n,e){const t={},i=SL(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function RL(n,e,t,i){const r=J.useMemo(()=>{const s=NA();return Pw(s,e,kw(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};UA(s,n.style,n),r.style={...s,...r.style}}return r}function AL(n=!1){return(t,i,r,{latestValues:s},o)=>{const c=(Iw(t)?RL:CL)(i,s,o,t),h=GN(i,typeof t=="string",n),f=t!==J.Fragment?{...h,...c,ref:r}:{},{children:m}=i,y=J.useMemo(()=>Ln(m)?m.get():m,[m]);return J.createElement(t,{...f,children:y})}}function PL(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...Iw(i)?xL:TL,preloadedFeatures:n,useRender:AL(r),createVisualElement:e,Component:i};return QN(o)}}function zA(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function wm(n,e,t){const i=n.getProps();return Sw(i,e,t!==void 0?t:i.custom,n)}const bL=vw(()=>window.ScrollTimeline!==void 0);class kL{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(bL()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class DL extends kL{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Mw(n,e){return n?n[e]||n.default||n:void 0}const Z0=2e4;function BA(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<Z0;)e+=t,i=n.next(e);return e>=Z0?1/0:e}function Nw(n){return typeof n=="function"}function YT(n,e){n.timeline=e,n.onfinish=null}const Lw=n=>Array.isArray(n)&&typeof n[0]=="number",ML={linearEasing:void 0};function NL(n,e){const t=vw(n);return()=>{var i;return(i=ML[e])!==null&&i!==void 0?i:t()}}const Ep=NL(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),GA=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(ec(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function WA(n){return!!(typeof n=="function"&&Ep()||!n||typeof n=="string"&&(n in Q0||Ep())||Lw(n)||Array.isArray(n)&&n.every(WA))}const Vh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,Q0={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Vh([0,.65,.55,1]),circOut:Vh([.55,0,1,.45]),backIn:Vh([.31,.01,.66,-.59]),backOut:Vh([.33,1.53,.69,.99])};function KA(n,e){if(n)return typeof n=="function"&&Ep()?GA(n,e):Lw(n)?Vh(n):Array.isArray(n)?n.map(t=>KA(t,e)||Q0.easeOut):Q0[n]}const cr={x:!1,y:!1};function $A(){return cr.x||cr.y}function LL(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function HA(n,e){const t=LL(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function ZT(n){return e=>{e.pointerType==="touch"||$A()||n(e)}}function OL(n,e,t={}){const[i,r,s]=HA(n,t),o=ZT(l=>{const{target:c}=l,h=e(l);if(typeof h!="function"||!c)return;const f=ZT(m=>{h(m),c.removeEventListener("pointerleave",f)});c.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const XA=(n,e)=>e?n===e?!0:XA(n,e.parentElement):!1,Ow=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,VL=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function FL(n){return VL.has(n.tagName)||n.tabIndex!==-1}const Fh=new WeakSet;function QT(n){return e=>{e.key==="Enter"&&n(e)}}function G_(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const jL=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=QT(()=>{if(Fh.has(t))return;G_(t,"down");const r=QT(()=>{G_(t,"up")}),s=()=>G_(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function JT(n){return Ow(n)&&!$A()}function UL(n,e,t={}){const[i,r,s]=HA(n,t),o=l=>{const c=l.currentTarget;if(!JT(l)||Fh.has(c))return;Fh.add(c);const h=e(l),f=(E,I)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",y),!(!JT(E)||!Fh.has(c))&&(Fh.delete(c),typeof h=="function"&&h(E,{success:I}))},m=E=>{f(E,t.useGlobalTarget||XA(c,E.target))},y=E=>{f(E,!1)};window.addEventListener("pointerup",m,r),window.addEventListener("pointercancel",y,r)};return i.forEach(l=>{!FL(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>jL(h,r),r)}),s}function zL(n){return n==="x"||n==="y"?cr[n]?null:(cr[n]=!0,()=>{cr[n]=!1}):cr.x||cr.y?null:(cr.x=cr.y=!0,()=>{cr.x=cr.y=!1})}const qA=new Set(["width","height","top","left","right","bottom",...Rc]);let tp;function BL(){tp=void 0}const ts={now:()=>(tp===void 0&&ts.set(wn.isProcessing||VN.useManualTiming?wn.timestamp:performance.now()),tp),set:n=>{tp=n,queueMicrotask(BL)}};function Vw(n,e){n.indexOf(e)===-1&&n.push(e)}function Fw(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class jw{constructor(){this.subscriptions=[]}add(e){return Vw(this.subscriptions,e),()=>Fw(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function YA(n,e){return e?n*(1e3/e):0}const eI=30,GL=n=>!isNaN(parseFloat(n));class WL{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=ts.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ts.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=GL(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new jw);const i=this.events[e].add(t);return e==="change"?()=>{i(),xt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ts.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>eI)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,eI);return YA(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function gd(n,e){return new WL(n,e)}function KL(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,gd(t))}function $L(n,e){const t=wm(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=rL(s[o]);KL(n,o,l)}}function HL(n){return!!(Ln(n)&&n.add)}function J0(n,e){const t=n.getValue("willChange");if(HL(t))return t.add(e)}function ZA(n){return n.props[RA]}const QA=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,XL=1e-7,qL=12;function YL(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=QA(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>XL&&++l<qL);return o}function $d(n,e,t,i){if(n===e&&t===i)return xi;const r=s=>YL(s,0,1,n,t);return s=>s===0||s===1?s:QA(r(s),e,i)}const JA=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,eP=n=>e=>1-n(1-e),tP=$d(.33,1.53,.69,.99),Uw=eP(tP),nP=JA(Uw),iP=n=>(n*=2)<1?.5*Uw(n):.5*(2-Math.pow(2,-10*(n-1))),zw=n=>1-Math.sin(Math.acos(n)),rP=eP(zw),sP=JA(zw),oP=n=>/^0[^.\s]+$/u.test(n);function ZL(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||oP(n):!0}const qh=n=>Math.round(n*1e5)/1e5,Bw=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function QL(n){return n==null}const JL=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Gw=(n,e)=>t=>!!(typeof t=="string"&&JL.test(t)&&t.startsWith(n)||e&&!QL(t)&&Object.prototype.hasOwnProperty.call(t,e)),aP=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(Bw);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},eO=n=>$s(0,255,n),W_={...Ac,transform:n=>Math.round(eO(n))},Ya={test:Gw("rgb","red"),parse:aP("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+W_.transform(n)+", "+W_.transform(e)+", "+W_.transform(t)+", "+qh(fd.transform(i))+")"};function tO(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const ev={test:Gw("#"),parse:tO,transform:Ya.transform},ju={test:Gw("hsl","hue"),parse:aP("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+es.transform(qh(e))+", "+es.transform(qh(t))+", "+qh(fd.transform(i))+")"},Mn={test:n=>Ya.test(n)||ev.test(n)||ju.test(n),parse:n=>Ya.test(n)?Ya.parse(n):ju.test(n)?ju.parse(n):ev.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Ya.transform(n):ju.transform(n)},nO=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function iO(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(Bw))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(nO))===null||t===void 0?void 0:t.length)||0)>0}const lP="number",uP="color",rO="var",sO="var(",tI="${}",oO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function pd(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(oO,c=>(Mn.test(c)?(i.color.push(s),r.push(uP),t.push(Mn.parse(c))):c.startsWith(sO)?(i.var.push(s),r.push(rO),t.push(c)):(i.number.push(s),r.push(lP),t.push(parseFloat(c))),++s,tI)).split(tI);return{values:t,split:l,indexes:i,types:r}}function cP(n){return pd(n).values}function hP(n){const{split:e,types:t}=pd(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===lP?s+=qh(r[o]):l===uP?s+=Mn.transform(r[o]):s+=r[o]}return s}}const aO=n=>typeof n=="number"?0:n;function lO(n){const e=cP(n);return hP(n)(e.map(aO))}const Qo={test:iO,parse:cP,createTransformer:hP,getAnimatableNone:lO},uO=new Set(["brightness","contrast","saturate","opacity"]);function cO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(Bw)||[];if(!i)return n;const r=t.replace(i,"");let s=uO.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const hO=/\b([a-z-]*)\(.*?\)/gu,tv={...Qo,getAnimatableNone:n=>{const e=n.match(hO);return e?e.map(cO).join(" "):n}},dO={...Rw,color:Mn,backgroundColor:Mn,outlineColor:Mn,fill:Mn,stroke:Mn,borderColor:Mn,borderTopColor:Mn,borderRightColor:Mn,borderBottomColor:Mn,borderLeftColor:Mn,filter:tv,WebkitFilter:tv},Ww=n=>dO[n];function dP(n,e){let t=Ww(n);return t!==tv&&(t=Qo),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const fO=new Set(["auto","none","0"]);function gO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!fO.has(s)&&pd(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=dP(t,r)}const nI=n=>n===Ac||n===ke,iI=(n,e)=>parseFloat(n.split(", ")[e]),rI=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return iI(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?iI(s[1],n):0}},pO=new Set(["x","y","z"]),mO=Rc.filter(n=>!pO.has(n));function yO(n){const e=[];return mO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const nc={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:rI(4,13),y:rI(5,14)};nc.translateX=nc.x;nc.translateY=nc.y;const rl=new Set;let nv=!1,iv=!1;function fP(){if(iv){const n=Array.from(rl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=yO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}iv=!1,nv=!1,rl.forEach(n=>n.complete()),rl.clear()}function gP(){rl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(iv=!0)})}function _O(){gP(),fP()}class Kw{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(rl.add(this),nv||(nv=!0,xt.read(gP),xt.resolveKeyframes(fP))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const c=i.readValue(t,l);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),rl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,rl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const pP=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),vO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function wO(n){const e=vO.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function mP(n,e,t=1){const[i,r]=wO(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return pP(o)?parseFloat(o):o}return Cw(r)?mP(r,e,t+1):r}const yP=n=>e=>e.test(n),EO={test:n=>n==="auto",parse:n=>n},_P=[Ac,ke,es,Mo,cL,uL,EO],sI=n=>_P.find(yP(n));class vP extends Kw{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let h=e[c];if(typeof h=="string"&&(h=h.trim(),Cw(h))){const f=mP(h,t.current);f!==void 0&&(e[c]=f),c===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!qA.has(i)||e.length!==2)return;const[r,s]=e,o=sI(r),l=sI(s);if(o!==l)if(nI(o)&&nI(l))for(let c=0;c<e.length;c++){const h=e[c];typeof h=="string"&&(e[c]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)ZL(e[r])&&i.push(r);i.length&&gO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=nc[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=nc[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([c,h])=>{t.getValue(c).set(h)}),this.resolveNoneKeyframes()}}const oI=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Qo.test(n)||n==="0")&&!n.startsWith("url("));function xO(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function TO(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=oI(r,e),l=oI(s,e);return!o||!l?!1:xO(n)||(t==="spring"||Nw(t))&&i}const IO=n=>n!==null;function Em(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(IO),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const SO=40;class wP{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ts.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>SO?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&_O(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ts.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:c,isGenerator:h}=this.options;if(!h&&!TO(e,i,r,s))if(o)this.options.duration=0;else{c&&c(Em(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const kt=(n,e,t)=>n+(e-n)*t;function K_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function CO({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,c=2*t-l;r=K_(c,l,n+1/3),s=K_(c,l,n),o=K_(c,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function xp(n,e){return t=>t>0?e:n}const $_=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},RO=[ev,Ya,ju],AO=n=>RO.find(e=>e.test(n));function aI(n){const e=AO(n);if(!e)return!1;let t=e.parse(n);return e===ju&&(t=CO(t)),t}const lI=(n,e)=>{const t=aI(n),i=aI(e);if(!t||!i)return xp(n,e);const r={...t};return s=>(r.red=$_(t.red,i.red,s),r.green=$_(t.green,i.green,s),r.blue=$_(t.blue,i.blue,s),r.alpha=kt(t.alpha,i.alpha,s),Ya.transform(r))},PO=(n,e)=>t=>e(n(t)),Hd=(...n)=>n.reduce(PO),rv=new Set(["none","hidden"]);function bO(n,e){return rv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function kO(n,e){return t=>kt(n,e,t)}function $w(n){return typeof n=="number"?kO:typeof n=="string"?Cw(n)?xp:Mn.test(n)?lI:NO:Array.isArray(n)?EP:typeof n=="object"?Mn.test(n)?lI:DO:xp}function EP(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>$w(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function DO(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=$w(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function MO(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],c=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=c,r[o]++}return i}const NO=(n,e)=>{const t=Qo.createTransformer(e),i=pd(n),r=pd(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?rv.has(n)&&!r.values.length||rv.has(e)&&!i.values.length?bO(n,e):Hd(EP(MO(i,r),r.values),t):xp(n,e)};function xP(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?kt(n,e,t):$w(n)(n,e)}const LO=5;function TP(n,e,t){const i=Math.max(e-LO,0);return YA(t-n(i),e-i)}const Lt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},H_=.001;function OO({duration:n=Lt.duration,bounce:e=Lt.bounce,velocity:t=Lt.velocity,mass:i=Lt.mass}){let r,s,o=1-e;o=$s(Lt.minDamping,Lt.maxDamping,o),n=$s(Lt.minDuration,Lt.maxDuration,zs(n)),o<1?(r=h=>{const f=h*o,m=f*n,y=f-t,E=sv(h,o),I=Math.exp(-m);return H_-y/E*I},s=h=>{const m=h*o*n,y=m*t+t,E=Math.pow(o,2)*Math.pow(h,2)*n,I=Math.exp(-m),C=sv(Math.pow(h,2),o);return(-r(h)+H_>0?-1:1)*((y-E)*I)/C}):(r=h=>{const f=Math.exp(-h*n),m=(h-t)*n+1;return-H_+f*m},s=h=>{const f=Math.exp(-h*n),m=(t-h)*(n*n);return f*m});const l=5/n,c=FO(r,s,l);if(n=Us(n),isNaN(c))return{stiffness:Lt.stiffness,damping:Lt.damping,duration:n};{const h=Math.pow(c,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const VO=12;function FO(n,e,t){let i=t;for(let r=1;r<VO;r++)i=i-n(i)/e(i);return i}function sv(n,e){return n*Math.sqrt(1-e*e)}const jO=["duration","bounce"],UO=["stiffness","damping","mass"];function uI(n,e){return e.some(t=>n[t]!==void 0)}function zO(n){let e={velocity:Lt.velocity,stiffness:Lt.stiffness,damping:Lt.damping,mass:Lt.mass,isResolvedFromDuration:!1,...n};if(!uI(n,UO)&&uI(n,jO))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*$s(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Lt.mass,stiffness:r,damping:s}}else{const t=OO(n);e={...e,...t,mass:Lt.mass},e.isResolvedFromDuration=!0}return e}function IP(n=Lt.visualDuration,e=Lt.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:c,damping:h,mass:f,duration:m,velocity:y,isResolvedFromDuration:E}=zO({...t,velocity:-zs(t.velocity||0)}),I=y||0,C=h/(2*Math.sqrt(c*f)),x=o-s,b=zs(Math.sqrt(c/f)),D=Math.abs(x)<5;i||(i=D?Lt.restSpeed.granular:Lt.restSpeed.default),r||(r=D?Lt.restDelta.granular:Lt.restDelta.default);let L;if(C<1){const F=sv(b,C);L=W=>{const P=Math.exp(-C*b*W);return o-P*((I+C*b*x)/F*Math.sin(F*W)+x*Math.cos(F*W))}}else if(C===1)L=F=>o-Math.exp(-b*F)*(x+(I+b*x)*F);else{const F=b*Math.sqrt(C*C-1);L=W=>{const P=Math.exp(-C*b*W),R=Math.min(F*W,300);return o-P*((I+C*b*x)*Math.sinh(R)+F*x*Math.cosh(R))/F}}const O={calculatedDuration:E&&m||null,next:F=>{const W=L(F);if(E)l.done=F>=m;else{let P=0;C<1&&(P=F===0?Us(I):TP(L,F,W));const R=Math.abs(P)<=i,k=Math.abs(o-W)<=r;l.done=R&&k}return l.value=l.done?o:W,l},toString:()=>{const F=Math.min(BA(O),Z0),W=GA(P=>O.next(F*P).value,F,30);return F+"ms "+W}};return O}function cI({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:c,restDelta:h=.5,restSpeed:f}){const m=n[0],y={done:!1,value:m},E=R=>l!==void 0&&R<l||c!==void 0&&R>c,I=R=>l===void 0?c:c===void 0||Math.abs(l-R)<Math.abs(c-R)?l:c;let C=t*e;const x=m+C,b=o===void 0?x:o(x);b!==x&&(C=b-m);const D=R=>-C*Math.exp(-R/i),L=R=>b+D(R),O=R=>{const k=D(R),V=L(R);y.done=Math.abs(k)<=h,y.value=y.done?b:V};let F,W;const P=R=>{E(y.value)&&(F=R,W=IP({keyframes:[y.value,I(y.value)],velocity:TP(L,R,y.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return P(0),{calculatedDuration:null,next:R=>{let k=!1;return!W&&F===void 0&&(k=!0,O(R),P(R)),F!==void 0&&R>=F?W.next(R-F):(!k&&O(R),y)}}}const BO=$d(.42,0,1,1),GO=$d(0,0,.58,1),SP=$d(.42,0,.58,1),WO=n=>Array.isArray(n)&&typeof n[0]!="number",KO={linear:xi,easeIn:BO,easeInOut:SP,easeOut:GO,circIn:zw,circInOut:sP,circOut:rP,backIn:Uw,backInOut:nP,backOut:tP,anticipate:iP},hI=n=>{if(Lw(n)){xA(n.length===4);const[e,t,i,r]=n;return $d(e,t,i,r)}else if(typeof n=="string")return KO[n];return n};function $O(n,e,t){const i=[],r=t||xP,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const c=Array.isArray(e)?e[o]||xi:e;l=Hd(c,l)}i.push(l)}return i}function HO(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(xA(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=$O(e,i,r),c=l.length,h=f=>{if(o&&f<n[0])return e[0];let m=0;if(c>1)for(;m<n.length-2&&!(f<n[m+1]);m++);const y=ec(n[m],n[m+1],f);return l[m](y)};return t?f=>h($s(n[0],n[s-1],f)):h}function XO(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=ec(0,e,i);n.push(kt(t,1,r))}}function qO(n){const e=[0];return XO(e,n.length-1),e}function YO(n,e){return n.map(t=>t*e)}function ZO(n,e){return n.map(()=>e||SP).splice(0,n.length-1)}function Tp({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=WO(i)?i.map(hI):hI(i),s={done:!1,value:e[0]},o=YO(t&&t.length===e.length?t:qO(e),n),l=HO(o,e,{ease:Array.isArray(r)?r:ZO(e,r)});return{calculatedDuration:n,next:c=>(s.value=l(c),s.done=c>=n,s)}}const QO=n=>{const e=({timestamp:t})=>n(t);return{start:()=>xt.update(e,!0),stop:()=>Zo(e),now:()=>wn.isProcessing?wn.timestamp:ts.now()}},JO={decay:cI,inertia:cI,tween:Tp,keyframes:Tp,spring:IP},eV=n=>n/100;class Hw extends wP{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||Kw,l=(c,h)=>this.onKeyframesResolved(c,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=Nw(t)?t:JO[t]||Tp;let c,h;l!==Tp&&typeof e[0]!="number"&&(c=Hd(eV,xP(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=BA(f));const{calculatedDuration:m}=f,y=m+r,E=y*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:c,calculatedDuration:m,resolvedDuration:y,totalDuration:E}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:R}=this.options;return{done:!0,value:R[R.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:c,calculatedDuration:h,totalDuration:f,resolvedDuration:m}=i;if(this.startTime===null)return s.next(0);const{delay:y,repeat:E,repeatType:I,repeatDelay:C,onUpdate:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const b=this.currentTime-y*(this.speed>=0?1:-1),D=this.speed>=0?b<0:b>f;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let L=this.currentTime,O=s;if(E){const R=Math.min(this.currentTime,f)/m;let k=Math.floor(R),V=R%1;!V&&R>=1&&(V=1),V===1&&k--,k=Math.min(k,E+1),k%2&&(I==="reverse"?(V=1-V,C&&(V-=C/m)):I==="mirror"&&(O=o)),L=$s(0,1,V)*m}const F=D?{done:!1,value:c[0]}:O.next(L);l&&(F.value=l(F.value));let{done:W}=F;!D&&h!==null&&(W=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&W);return P&&r!==void 0&&(F.value=Em(c,this.options,r)),x&&x(F.value),P&&this.finish(),F}get duration(){const{resolved:e}=this;return e?zs(e.calculatedDuration):0}get time(){return zs(this.currentTime)}set time(e){e=Us(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=zs(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=QO,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const tV=new Set(["opacity","clipPath","filter","transform"]);function nV(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:c}={}){const h={[e]:t};c&&(h.offset=c);const f=KA(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const iV=vw(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Ip=10,rV=2e4;function sV(n){return Nw(n.type)||n.type==="spring"||!WA(n.ease)}function oV(n,e){const t=new Hw({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<rV;)i=t.sample(s),r.push(i.value),s+=Ip;return{times:void 0,keyframes:r,duration:s-Ip,ease:"linear"}}const CP={anticipate:iP,backInOut:nP,circInOut:sP};function aV(n){return n in CP}class dI extends wP{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new vP(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:c,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&Ep()&&aV(s)&&(s=CP[s]),sV(this.options)){const{onComplete:m,onUpdate:y,motionValue:E,element:I,...C}=this.options,x=oV(e,C);e=x.keyframes,e.length===1&&(e[1]=e[0]),i=x.duration,r=x.times,s=x.ease,o="keyframes"}const f=nV(l.owner.current,c,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(YT(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:m}=this.options;l.set(Em(e,this.options,t)),m&&m(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return zs(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return zs(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=Us(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return xi;const{animation:i}=t;YT(i,e)}return xi}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:m,element:y,...E}=this.options,I=new Hw({...E,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),C=Us(this.time);h.setWithVelocity(I.sample(C-Ip).value,I.sample(C).value,Ip)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:h}=t.owner.getProps();return iV()&&i&&tV.has(i)&&!c&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const lV={type:"spring",stiffness:500,damping:25,restSpeed:10},uV=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),cV={type:"keyframes",duration:.8},hV={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},dV=(n,{keyframes:e})=>e.length>2?cV:Al.has(n)?n.startsWith("scale")?uV(e[1]):lV:hV;function fV({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:c,elapsed:h,...f}){return!!Object.keys(f).length}const Xw=(n,e,t,i={},r,s)=>o=>{const l=Mw(i,n)||{},c=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-Us(c);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:y=>{e.set(y),l.onUpdate&&l.onUpdate(y)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};fV(l)||(f={...f,...dV(n,f)}),f.duration&&(f.duration=Us(f.duration)),f.repeatDelay&&(f.repeatDelay=Us(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let m=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(m=!0)),m&&!s&&e.get()!==void 0){const y=Em(f.keyframes,l);if(y!==void 0)return xt.update(()=>{f.onUpdate(y),f.onComplete()}),new DL([])}return!s&&dI.supports(f)?new dI(f):new Hw(f)};function gV({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function RP(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...c}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const m in c){const y=n.getValue(m,(s=n.latestValues[m])!==null&&s!==void 0?s:null),E=c[m];if(E===void 0||f&&gV(f,m))continue;const I={delay:t,...Mw(o||{},m)};let C=!1;if(window.MotionHandoffAnimation){const b=ZA(n);if(b){const D=window.MotionHandoffAnimation(b,m,xt);D!==null&&(I.startTime=D,C=!0)}}J0(n,m),y.start(Xw(m,y,E,n.shouldReduceMotion&&qA.has(m)?{type:!1}:I,n,C));const x=y.animation;x&&h.push(x)}return l&&Promise.all(h).then(()=>{xt.update(()=>{l&&$L(n,l)})}),h}function ov(n,e,t={}){var i;const r=wm(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(RP(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:m,staggerDirection:y}=s;return pV(n,e,f+h,m,y,t)}:()=>Promise.resolve(),{when:c}=s;if(c){const[h,f]=c==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function pV(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,c=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(mV).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(ov(h,e,{...s,delay:t+c(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function mV(n,e){return n.sortNodePosition(e)}function yV(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>ov(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=ov(n,e,t);else{const r=typeof e=="function"?wm(n,e,t.custom):e;i=Promise.all(RP(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const _V=Ew.length;function AP(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?AP(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<_V;t++){const i=Ew[t],r=n.props[i];(dd(r)||r===!1)&&(e[i]=r)}return e}const vV=[...ww].reverse(),wV=ww.length;function EV(n){return e=>Promise.all(e.map(({animation:t,options:i})=>yV(n,t,i)))}function xV(n){let e=EV(n),t=fI(),i=!0;const r=c=>(h,f)=>{var m;const y=wm(n,f,c==="exit"?(m=n.presenceContext)===null||m===void 0?void 0:m.custom:void 0);if(y){const{transition:E,transitionEnd:I,...C}=y;h={...h,...C,...I}}return h};function s(c){e=c(n)}function o(c){const{props:h}=n,f=AP(n.parent)||{},m=[],y=new Set;let E={},I=1/0;for(let x=0;x<wV;x++){const b=vV[x],D=t[b],L=h[b]!==void 0?h[b]:f[b],O=dd(L),F=b===c?D.isActive:null;F===!1&&(I=x);let W=L===f[b]&&L!==h[b]&&O;if(W&&i&&n.manuallyAnimateOnMount&&(W=!1),D.protectedKeys={...E},!D.isActive&&F===null||!L&&!D.prevProp||_m(L)||typeof L=="boolean")continue;const P=TV(D.prevProp,L);let R=P||b===c&&D.isActive&&!W&&O||x>I&&O,k=!1;const V=Array.isArray(L)?L:[L];let j=V.reduce(r(b),{});F===!1&&(j={});const{prevResolvedValues:z={}}=D,N={...z,...j},le=ce=>{R=!0,y.has(ce)&&(k=!0,y.delete(ce)),D.needsAnimating[ce]=!0;const ee=n.getValue(ce);ee&&(ee.liveStyle=!1)};for(const ce in N){const ee=j[ce],oe=z[ce];if(E.hasOwnProperty(ce))continue;let ne=!1;Y0(ee)&&Y0(oe)?ne=!zA(ee,oe):ne=ee!==oe,ne?ee!=null?le(ce):y.add(ce):ee!==void 0&&y.has(ce)?le(ce):D.protectedKeys[ce]=!0}D.prevProp=L,D.prevResolvedValues=j,D.isActive&&(E={...E,...j}),i&&n.blockInitialAnimation&&(R=!1),R&&(!(W&&P)||k)&&m.push(...V.map(ce=>({animation:ce,options:{type:b}})))}if(y.size){const x={};y.forEach(b=>{const D=n.getBaseTarget(b),L=n.getValue(b);L&&(L.liveStyle=!0),x[b]=D??null}),m.push({animation:x})}let C=!!m.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(C=!1),i=!1,C?e(m):Promise.resolve()}function l(c,h){var f;if(t[c].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(y=>{var E;return(E=y.animationState)===null||E===void 0?void 0:E.setActive(c,h)}),t[c].isActive=h;const m=o(c);for(const y in t)t[y].protectedKeys={};return m}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=fI(),i=!0}}}function TV(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!zA(e,n):!1}function Na(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function fI(){return{animate:Na(!0),whileInView:Na(),whileHover:Na(),whileTap:Na(),whileDrag:Na(),whileFocus:Na(),exit:Na()}}let sa=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class IV extends sa{constructor(e){super(e),e.animationState||(e.animationState=xV(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();_m(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let SV=0;class CV extends sa{constructor(){super(...arguments),this.id=SV++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const RV={animation:{Feature:IV},exit:{Feature:CV}};function md(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function Xd(n){return{point:{x:n.pageX,y:n.pageY}}}const AV=n=>e=>Ow(e)&&n(e,Xd(e));function Yh(n,e,t,i){return md(n,e,AV(t),i)}const gI=(n,e)=>Math.abs(n-e);function PV(n,e){const t=gI(n.x,e.x),i=gI(n.y,e.y);return Math.sqrt(t**2+i**2)}class PP{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=q_(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,E=PV(m.offset,{x:0,y:0})>=3;if(!y&&!E)return;const{point:I}=m,{timestamp:C}=wn;this.history.push({...I,timestamp:C});const{onStart:x,onMove:b}=this.handlers;y||(x&&x(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,m)},this.handlePointerMove=(m,y)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=X_(y,this.transformPagePoint),xt.update(this.updatePoint,!0)},this.handlePointerUp=(m,y)=>{this.end();const{onEnd:E,onSessionEnd:I,resumeAnimation:C}=this.handlers;if(this.dragSnapToOrigin&&C&&C(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=q_(m.type==="pointercancel"?this.lastMoveEventInfo:X_(y,this.transformPagePoint),this.history);this.startEvent&&E&&E(m,x),I&&I(m,x)},!Ow(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=Xd(e),l=X_(o,this.transformPagePoint),{point:c}=l,{timestamp:h}=wn;this.history=[{...c,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,q_(l,this.history)),this.removeListeners=Hd(Yh(this.contextWindow,"pointermove",this.handlePointerMove),Yh(this.contextWindow,"pointerup",this.handlePointerUp),Yh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Zo(this.updatePoint)}}function X_(n,e){return e?{point:e(n.point)}:n}function pI(n,e){return{x:n.x-e.x,y:n.y-e.y}}function q_({point:n},e){return{point:n,delta:pI(n,bP(e)),offset:pI(n,bV(e)),velocity:kV(e,.1)}}function bV(n){return n[0]}function bP(n){return n[n.length-1]}function kV(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=bP(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>Us(e)));)t--;if(!i)return{x:0,y:0};const s=zs(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const kP=1e-4,DV=1-kP,MV=1+kP,DP=.01,NV=0-DP,LV=0+DP;function Ti(n){return n.max-n.min}function OV(n,e,t){return Math.abs(n-e)<=t}function mI(n,e,t,i=.5){n.origin=i,n.originPoint=kt(e.min,e.max,n.origin),n.scale=Ti(t)/Ti(e),n.translate=kt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=DV&&n.scale<=MV||isNaN(n.scale))&&(n.scale=1),(n.translate>=NV&&n.translate<=LV||isNaN(n.translate))&&(n.translate=0)}function Zh(n,e,t,i){mI(n.x,e.x,t.x,i?i.originX:void 0),mI(n.y,e.y,t.y,i?i.originY:void 0)}function yI(n,e,t){n.min=t.min+e.min,n.max=n.min+Ti(e)}function VV(n,e,t){yI(n.x,e.x,t.x),yI(n.y,e.y,t.y)}function _I(n,e,t){n.min=e.min-t.min,n.max=n.min+Ti(e)}function Qh(n,e,t){_I(n.x,e.x,t.x),_I(n.y,e.y,t.y)}function FV(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?kt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?kt(t,n,i.max):Math.min(n,t)),n}function vI(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function jV(n,{top:e,left:t,bottom:i,right:r}){return{x:vI(n.x,t,r),y:vI(n.y,e,i)}}function wI(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function UV(n,e){return{x:wI(n.x,e.x),y:wI(n.y,e.y)}}function zV(n,e){let t=.5;const i=Ti(n),r=Ti(e);return r>i?t=ec(e.min,e.max-i,n.min):i>r&&(t=ec(n.min,n.max-r,e.min)),$s(0,1,t)}function BV(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const av=.35;function GV(n=av){return n===!1?n=0:n===!0&&(n=av),{x:EI(n,"left","right"),y:EI(n,"top","bottom")}}function EI(n,e,t){return{min:xI(n,e),max:xI(n,t)}}function xI(n,e){return typeof n=="number"?n:n[e]||0}const TI=()=>({translate:0,scale:1,origin:0,originPoint:0}),Uu=()=>({x:TI(),y:TI()}),II=()=>({min:0,max:0}),Ut=()=>({x:II(),y:II()});function Bi(n){return[n("x"),n("y")]}function MP({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function WV({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function KV(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function Y_(n){return n===void 0||n===1}function lv({scale:n,scaleX:e,scaleY:t}){return!Y_(n)||!Y_(e)||!Y_(t)}function Fa(n){return lv(n)||NP(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function NP(n){return SI(n.x)||SI(n.y)}function SI(n){return n&&n!=="0%"}function Sp(n,e,t){const i=n-t,r=e*i;return t+r}function CI(n,e,t,i,r){return r!==void 0&&(n=Sp(n,r,i)),Sp(n,t,i)+e}function uv(n,e=0,t=1,i,r){n.min=CI(n.min,e,t,i,r),n.max=CI(n.max,e,t,i,r)}function LP(n,{x:e,y:t}){uv(n.x,e.translate,e.scale,e.originPoint),uv(n.y,t.translate,t.scale,t.originPoint)}const RI=.999999999999,AI=1.0000000000001;function $V(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:c}=s.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Bu(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,LP(n,o)),i&&Fa(s.latestValues)&&Bu(n,s.latestValues))}e.x<AI&&e.x>RI&&(e.x=1),e.y<AI&&e.y>RI&&(e.y=1)}function zu(n,e){n.min=n.min+e,n.max=n.max+e}function PI(n,e,t,i,r=.5){const s=kt(n.min,n.max,r);uv(n,e,t,s,i)}function Bu(n,e){PI(n.x,e.x,e.scaleX,e.scale,e.originX),PI(n.y,e.y,e.scaleY,e.scale,e.originY)}function OP(n,e){return MP(KV(n.getBoundingClientRect(),e))}function HV(n,e,t){const i=OP(n,t),{scroll:r}=e;return r&&(zu(i.x,r.offset.x),zu(i.y,r.offset.y)),i}const VP=({current:n})=>n?n.ownerDocument.defaultView:null,XV=new WeakMap;class qV{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Xd(f).point)},s=(f,m)=>{const{drag:y,dragPropagation:E,onDragStart:I}=this.getProps();if(y&&!E&&(this.openDragLock&&this.openDragLock(),this.openDragLock=zL(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Bi(x=>{let b=this.getAxisMotionValue(x).get()||0;if(es.test(b)){const{projection:D}=this.visualElement;if(D&&D.layout){const L=D.layout.layoutBox[x];L&&(b=Ti(L)*(parseFloat(b)/100))}}this.originPoint[x]=b}),I&&xt.postRender(()=>I(f,m)),J0(this.visualElement,"transform");const{animationState:C}=this.visualElement;C&&C.setActive("whileDrag",!0)},o=(f,m)=>{const{dragPropagation:y,dragDirectionLock:E,onDirectionLock:I,onDrag:C}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:x}=m;if(E&&this.currentDirection===null){this.currentDirection=YV(x),this.currentDirection!==null&&I&&I(this.currentDirection);return}this.updateAxis("x",m.point,x),this.updateAxis("y",m.point,x),this.visualElement.render(),C&&C(f,m)},l=(f,m)=>this.stop(f,m),c=()=>Bi(f=>{var m;return this.getAnimationState(f)==="paused"&&((m=this.getAxisMotionValue(f).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new PP(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:VP(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&xt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Ag(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=FV(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Fu(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=jV(r.layoutBox,t):this.constraints=!1,this.elastic=GV(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Bi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=BV(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Fu(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=HV(i,r.root,this.visualElement.getTransformPagePoint());let o=UV(r.layout.layoutBox,s);if(t){const l=t(WV(o));this.hasMutatedConstraints=!!l,l&&(o=MP(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},h=Bi(f=>{if(!Ag(f,t,this.currentDirection))return;let m=c&&c[f]||{};o&&(m={min:0,max:0});const y=r?200:1e6,E=r?40:1e7,I={type:"inertia",velocity:i?e[f]:0,bounceStiffness:y,bounceDamping:E,timeConstant:750,restDelta:1,restSpeed:10,...s,...m};return this.startAxisValueAnimation(f,I)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return J0(this.visualElement,e),i.start(Xw(e,i,0,t,this.visualElement,!1))}stopAnimation(){Bi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Bi(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Bi(t=>{const{drag:i}=this.getProps();if(!Ag(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-kt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Fu(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Bi(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const c=l.get();r[o]=zV({min:c,max:c},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Bi(o=>{if(!Ag(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:h}=this.constraints[o];l.set(kt(c,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;XV.set(this.visualElement,this);const e=this.visualElement.current,t=Yh(e,"pointerdown",c=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();Fu(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),xt.read(i);const o=md(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:h})=>{this.isDragging&&h&&(Bi(f=>{const m=this.getAxisMotionValue(f);m&&(this.originPoint[f]+=c[f].translate,m.set(m.get()+c[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=av,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function Ag(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function YV(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class ZV extends sa{constructor(e){super(e),this.removeGroupControls=xi,this.removeListeners=xi,this.controls=new qV(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||xi}unmount(){this.removeGroupControls(),this.removeListeners()}}const bI=n=>(e,t)=>{n&&xt.postRender(()=>n(e,t))};class QV extends sa{constructor(){super(...arguments),this.removePointerDownListener=xi}onPointerDown(e){this.session=new PP(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:VP(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:bI(e),onStart:bI(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&xt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Yh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const np={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function kI(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Ih={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(ke.test(n))n=parseFloat(n);else return n;const t=kI(n,e.target.x),i=kI(n,e.target.y);return`${t}% ${i}%`}},JV={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=Qo.parse(n);if(r.length>5)return i;const s=Qo.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,c=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=c;const h=kt(l,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class eF extends J.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;wL(tF),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),np.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||xt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Tw.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function FP(n){const[e,t]=wA(),i=J.useContext(pw);return T.jsx(eF,{...n,layoutGroup:i,switchLayoutGroup:J.useContext(AA),isPresent:e,safeToRemove:t})}const tF={borderRadius:{...Ih,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ih,borderTopRightRadius:Ih,borderBottomLeftRadius:Ih,borderBottomRightRadius:Ih,boxShadow:JV};function nF(n,e,t){const i=Ln(n)?n:gd(n);return i.start(Xw("",i,e,t)),i.animation}function iF(n){return n instanceof SVGElement&&n.tagName!=="svg"}const rF=(n,e)=>n.depth-e.depth;class sF{constructor(){this.children=[],this.isDirty=!1}add(e){Vw(this.children,e),this.isDirty=!0}remove(e){Fw(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(rF),this.isDirty=!1,this.children.forEach(e)}}function oF(n,e){const t=ts.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Zo(i),n(s-e))};return xt.read(i,!0),()=>Zo(i)}const jP=["TopLeft","TopRight","BottomLeft","BottomRight"],aF=jP.length,DI=n=>typeof n=="string"?parseFloat(n):n,MI=n=>typeof n=="number"||ke.test(n);function lF(n,e,t,i,r,s){r?(n.opacity=kt(0,t.opacity!==void 0?t.opacity:1,uF(i)),n.opacityExit=kt(e.opacity!==void 0?e.opacity:1,0,cF(i))):s&&(n.opacity=kt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<aF;o++){const l=`border${jP[o]}Radius`;let c=NI(e,l),h=NI(t,l);if(c===void 0&&h===void 0)continue;c||(c=0),h||(h=0),c===0||h===0||MI(c)===MI(h)?(n[l]=Math.max(kt(DI(c),DI(h),i),0),(es.test(h)||es.test(c))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=kt(e.rotate||0,t.rotate||0,i))}function NI(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const uF=UP(0,.5,rP),cF=UP(.5,.95,xi);function UP(n,e,t){return i=>i<n?0:i>e?1:t(ec(n,e,i))}function LI(n,e){n.min=e.min,n.max=e.max}function Ui(n,e){LI(n.x,e.x),LI(n.y,e.y)}function OI(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function VI(n,e,t,i,r){return n-=e,n=Sp(n,1/t,i),r!==void 0&&(n=Sp(n,1/r,i)),n}function hF(n,e=0,t=1,i=.5,r,s=n,o=n){if(es.test(e)&&(e=parseFloat(e),e=kt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=kt(s.min,s.max,i);n===s&&(l-=e),n.min=VI(n.min,e,t,l,r),n.max=VI(n.max,e,t,l,r)}function FI(n,e,[t,i,r],s,o){hF(n,e[t],e[i],e[r],e.scale,s,o)}const dF=["x","scaleX","originX"],fF=["y","scaleY","originY"];function jI(n,e,t,i){FI(n.x,e,dF,t?t.x:void 0,i?i.x:void 0),FI(n.y,e,fF,t?t.y:void 0,i?i.y:void 0)}function UI(n){return n.translate===0&&n.scale===1}function zP(n){return UI(n.x)&&UI(n.y)}function zI(n,e){return n.min===e.min&&n.max===e.max}function gF(n,e){return zI(n.x,e.x)&&zI(n.y,e.y)}function BI(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function BP(n,e){return BI(n.x,e.x)&&BI(n.y,e.y)}function GI(n){return Ti(n.x)/Ti(n.y)}function WI(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class pF{constructor(){this.members=[]}add(e){Vw(this.members,e),e.scheduleRender()}remove(e){if(Fw(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function mF(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:m,rotateY:y,skewX:E,skewY:I}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),m&&(i+=`rotateX(${m}deg) `),y&&(i+=`rotateY(${y}deg) `),E&&(i+=`skewX(${E}deg) `),I&&(i+=`skewY(${I}deg) `)}const l=n.x.scale*e.x,c=n.y.scale*e.y;return(l!==1||c!==1)&&(i+=`scale(${l}, ${c})`),i||"none"}const ja={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},jh=typeof window<"u"&&window.MotionDebug!==void 0,Z_=["","X","Y","Z"],yF={visibility:"hidden"},KI=1e3;let _F=0;function Q_(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function GP(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=ZA(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",xt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&GP(i)}function WP({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=_F++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,jh&&(ja.totalNodes=ja.resolvedTargetDeltas=ja.recalculatedProjection=0),this.nodes.forEach(EF),this.nodes.forEach(CF),this.nodes.forEach(RF),this.nodes.forEach(xF),jh&&window.MotionDebug.record(ja)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new sF)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new jw),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=iF(o),this.instance=o;const{layoutId:c,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||c)&&(this.isLayoutDirty=!0),n){let m;const y=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=oF(y,250),np.hasAnimatedSinceResize&&(np.hasAnimatedSinceResize=!1,this.nodes.forEach(HI))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&f&&(c||h)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:y,hasRelativeTargetChanged:E,layout:I})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const C=this.options.transition||f.getDefaultTransition()||DF,{onLayoutAnimationStart:x,onLayoutAnimationComplete:b}=f.getProps(),D=!this.targetLayout||!BP(this.targetLayout,I)||E,L=!y&&E;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||L||y&&(D||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,L);const O={...Mw(C,"layout"),onPlay:x,onComplete:b};(f.shouldReduceMotion||this.options.layoutRoot)&&(O.delay=0,O.type=!1),this.startAnimation(O)}else y||HI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=I})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Zo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(AF),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&GP(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const m=this.path[f];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach($I);return}this.isUpdating||this.nodes.forEach(IF),this.isUpdating=!1,this.nodes.forEach(SF),this.nodes.forEach(vF),this.nodes.forEach(wF),this.clearAllSnapshots();const l=ts.now();wn.delta=$s(0,1e3/60,l-wn.timestamp),wn.timestamp=l,wn.isProcessing=!0,B_.update.process(wn),B_.preRender.process(wn),B_.render.process(wn),wn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Tw.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(TF),this.sharedNodes.forEach(PF)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,xt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){xt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!zP(this.projectionDelta),c=this.getTransformTemplate(),h=c?c(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||Fa(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),MF(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const c=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(NF))){const{scroll:f}=this.root;f&&(zu(c.x,f.offset.x),zu(c.y,f.offset.y))}return c}removeElementScroll(o){var l;const c=Ut();if(Ui(c,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return c;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:m,options:y}=f;f!==this.root&&m&&y.layoutScroll&&(m.wasRoot&&Ui(c,o),zu(c.x,m.offset.x),zu(c.y,m.offset.y))}return c}applyTransform(o,l=!1){const c=Ut();Ui(c,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Bu(c,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Fa(f.latestValues)&&Bu(c,f.latestValues)}return Fa(this.latestValues)&&Bu(c,this.latestValues),c}removeTransform(o){const l=Ut();Ui(l,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];if(!h.instance||!Fa(h.latestValues))continue;lv(h.latestValues)&&h.updateSnapshot();const f=Ut(),m=h.measurePageBox();Ui(f,m),jI(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return Fa(this.latestValues)&&jI(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==wn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==c;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:y}=this.options;if(!(!this.layout||!(m||y))){if(this.resolvedRelativeTargetAt=wn.timestamp,!this.targetDelta&&!this.relativeTarget){const E=this.getClosestProjectingParent();E&&E.layout&&this.animationProgress!==1?(this.relativeParent=E,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Qh(this.relativeTargetOrigin,this.layout.layoutBox,E.layout.layoutBox),Ui(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),VV(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ui(this.target,this.layout.layoutBox),LP(this.target,this.targetDelta)):Ui(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const E=this.getClosestProjectingParent();E&&!!E.resumingFrom==!!this.resumingFrom&&!E.options.layoutScroll&&E.target&&this.animationProgress!==1?(this.relativeParent=E,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Qh(this.relativeTargetOrigin,this.target,E.target),Ui(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}jh&&ja.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||lv(this.parent.latestValues)||NP(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===wn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||m))return;Ui(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,E=this.treeScale.y;$V(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:I}=l;if(!I){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(OI(this.prevProjectionDelta.x,this.projectionDelta.x),OI(this.prevProjectionDelta.y,this.projectionDelta.y)),Zh(this.projectionDelta,this.layoutCorrected,I,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==E||!WI(this.projectionDelta.x,this.prevProjectionDelta.x)||!WI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",I)),jh&&ja.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Uu(),this.projectionDelta=Uu(),this.projectionDeltaWithTransform=Uu()}setAnimationOrigin(o,l=!1){const c=this.snapshot,h=c?c.latestValues:{},f={...this.latestValues},m=Uu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const y=Ut(),E=c?c.source:void 0,I=this.layout?this.layout.source:void 0,C=E!==I,x=this.getStack(),b=!x||x.members.length<=1,D=!!(C&&!b&&this.options.crossfade===!0&&!this.path.some(kF));this.animationProgress=0;let L;this.mixTargetDelta=O=>{const F=O/1e3;XI(m.x,o.x,F),XI(m.y,o.y,F),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Qh(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),bF(this.relativeTarget,this.relativeTargetOrigin,y,F),L&&gF(this.relativeTarget,L)&&(this.isProjectionDirty=!1),L||(L=Ut()),Ui(L,this.relativeTarget)),C&&(this.animationValues=f,lF(f,h,this.latestValues,F,D,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Zo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=xt.update(()=>{np.hasAnimatedSinceResize=!0,this.currentAnimation=nF(0,KI,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(KI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:h,latestValues:f}=o;if(!(!l||!c||!h)){if(this!==o&&this.layout&&h&&KP(this.options.animationType,this.layout.layoutBox,h.layoutBox)){c=this.target||Ut();const m=Ti(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+m;const y=Ti(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+y}Ui(l,c),Bu(l,f),Zh(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new pF),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const h=this.getStack();h&&h.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const h={};c.z&&Q_("z",o,h,this.animationValues);for(let f=0;f<Z_.length;f++)Q_(`rotate${Z_[f]}`,o,h,this.animationValues),Q_(`skew${Z_[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return yF;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=ep(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const C={};return this.options.layoutId&&(C.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,C.pointerEvents=ep(o?.pointerEvents)||""),this.hasProjected&&!Fa(this.latestValues)&&(C.transform=f?f({},""):"none",this.hasProjected=!1),C}const y=m.animationValues||m.latestValues;this.applyTransformsToTarget(),h.transform=mF(this.projectionDeltaWithTransform,this.treeScale,y),f&&(h.transform=f(y,h.transform));const{x:E,y:I}=this.projectionDelta;h.transformOrigin=`${E.origin*100}% ${I.origin*100}% 0`,m.animationValues?h.opacity=m===this?(c=(l=y.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:h.opacity=m===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const C in wp){if(y[C]===void 0)continue;const{correct:x,applyTo:b}=wp[C],D=h.transform==="none"?y[C]:x(y[C],m);if(b){const L=b.length;for(let O=0;O<L;O++)h[b[O]]=D}else h[C]=D}return this.options.layoutId&&(h.pointerEvents=m===this?ep(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach($I),this.root.sharedNodes.clear()}}}function vF(n){n.updateLayout()}function wF(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?Bi(m=>{const y=o?t.measuredBox[m]:t.layoutBox[m],E=Ti(y);y.min=i[m].min,y.max=y.min+E}):KP(s,t.layoutBox,i)&&Bi(m=>{const y=o?t.measuredBox[m]:t.layoutBox[m],E=Ti(i[m]);y.max=y.min+E,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[m].max=n.relativeTarget[m].min+E)});const l=Uu();Zh(l,i,t.layoutBox);const c=Uu();o?Zh(c,n.applyTransform(r,!0),t.measuredBox):Zh(c,i,t.layoutBox);const h=!zP(l);let f=!1;if(!n.resumeFrom){const m=n.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:y,layout:E}=m;if(y&&E){const I=Ut();Qh(I,t.layoutBox,y.layoutBox);const C=Ut();Qh(C,i,E.layoutBox),BP(I,C)||(f=!0),m.options.layoutRoot&&(n.relativeTarget=C,n.relativeTargetOrigin=I,n.relativeParent=m)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:c,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function EF(n){jh&&ja.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function xF(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function TF(n){n.clearSnapshot()}function $I(n){n.clearMeasurements()}function IF(n){n.isLayoutDirty=!1}function SF(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function HI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function CF(n){n.resolveTargetDelta()}function RF(n){n.calcProjection()}function AF(n){n.resetSkewAndRotation()}function PF(n){n.removeLeadSnapshot()}function XI(n,e,t){n.translate=kt(e.translate,0,t),n.scale=kt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function qI(n,e,t,i){n.min=kt(e.min,t.min,i),n.max=kt(e.max,t.max,i)}function bF(n,e,t,i){qI(n.x,e.x,t.x,i),qI(n.y,e.y,t.y,i)}function kF(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const DF={duration:.45,ease:[.4,0,.1,1]},YI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),ZI=YI("applewebkit/")&&!YI("chrome/")?Math.round:xi;function QI(n){n.min=ZI(n.min),n.max=ZI(n.max)}function MF(n){QI(n.x),QI(n.y)}function KP(n,e,t){return n==="position"||n==="preserve-aspect"&&!OV(GI(e),GI(t),.2)}function NF(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const LF=WP({attachResizeListener:(n,e)=>md(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),J_={current:void 0},$P=WP({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!J_.current){const n=new LF({});n.mount(window),n.setOptions({layoutScroll:!0}),J_.current=n}return J_.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),OF={pan:{Feature:QV},drag:{Feature:ZV,ProjectionNode:$P,MeasureLayout:FP}};function JI(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&xt.postRender(()=>s(e,Xd(e)))}class VF extends sa{mount(){const{current:e}=this.node;e&&(this.unmount=OL(e,t=>(JI(this.node,t,"Start"),i=>JI(this.node,i,"End"))))}unmount(){}}class FF extends sa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Hd(md(this.node.current,"focus",()=>this.onFocus()),md(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function eS(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&xt.postRender(()=>s(e,Xd(e)))}class jF extends sa{mount(){const{current:e}=this.node;e&&(this.unmount=UL(e,t=>(eS(this.node,t,"Start"),(i,{success:r})=>eS(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const cv=new WeakMap,e0=new WeakMap,UF=n=>{const e=cv.get(n.target);e&&e(n)},zF=n=>{n.forEach(UF)};function BF({root:n,...e}){const t=n||document;e0.has(t)||e0.set(t,{});const i=e0.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(zF,{root:n,...e})),i[r]}function GF(n,e,t){const i=BF(e);return cv.set(n,t),i.observe(n),()=>{cv.delete(n),i.unobserve(n)}}const WF={some:0,all:1};class KF extends sa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:WF[r]},l=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:m}=this.node.getProps(),y=h?f:m;y&&y(c)};return GF(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some($F(e,t))&&this.startObserver()}unmount(){}}function $F({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const HF={inView:{Feature:KF},tap:{Feature:jF},focus:{Feature:FF},hover:{Feature:VF}},XF={layout:{ProjectionNode:$P,MeasureLayout:FP}},hv={current:null},HP={current:!1};function qF(){if(HP.current=!0,!!_w)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>hv.current=n.matches;n.addListener(e),e()}else hv.current=!1}const YF=[..._P,Mn,Qo],ZF=n=>YF.find(yP(n)),tS=new WeakMap;function QF(n,e,t){for(const i in e){const r=e[i],s=t[i];if(Ln(r))n.addValue(i,r);else if(Ln(s))n.addValue(i,gd(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,gd(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const nS=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class JF{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Kw,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const E=ts.now();this.renderScheduledAt<E&&(this.renderScheduledAt=E,xt.render(this.render,!1,!0))};const{latestValues:c,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=c,this.baseTarget={...c},this.initialValues=t.initial?{...c}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=vm(t),this.isVariantNode=CA(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:m,...y}=this.scrapeMotionValuesFromProps(t,{},this);for(const E in y){const I=y[E];c[E]!==void 0&&Ln(I)&&I.set(c[E],!1)}}mount(e){this.current=e,tS.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),HP.current||qF(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:hv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){tS.delete(this.current),this.projection&&this.projection.unmount(),Zo(this.notifyUpdate),Zo(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Al.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&xt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in tc){const t=tc[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<nS.length;i++){const r=nS[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=QF(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=gd(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(pP(r)||oP(r))?r=parseFloat(r):!ZF(r)&&Qo.test(t)&&(r=dP(e,t)),this.setBaseTarget(e,Ln(r)?r.get():r)),Ln(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=Sw(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ln(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new jw),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class XP extends JF{constructor(){super(...arguments),this.KeyframeResolver=vP}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ln(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function e3(n){return window.getComputedStyle(n)}class t3 extends XP{constructor(){super(...arguments),this.type="html",this.renderInstance=LA}readValueFromInstance(e,t){if(Al.has(t)){const i=Ww(t);return i&&i.default||0}else{const i=e3(e),r=(DA(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return OP(e,t)}build(e,t,i){Aw(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return Dw(e,t,i)}}class n3 extends XP{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Al.has(t)){const i=Ww(t);return i&&i.default||0}return t=OA.has(t)?t:xw(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return jA(e,t,i)}build(e,t,i){Pw(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){VA(e,t,i,r)}mount(e){this.isSVGTag=kw(e.tagName),super.mount(e)}}const i3=(n,e)=>Iw(n)?new n3(e):new t3(e,{allowProjection:n!==J.Fragment}),r3=PL({...RV,...HF,...OF,...XF},i3),it=WN(r3),ei={ADD:"add",REMOVE:"remove"},ic={PROPERTYCHANGE:"propertychange"},ze={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class xm{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function s3(n,e,t){let i,r;t=t||Bs;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function Bs(n,e){return n>e?1:n<e?-1:0}function o3(n,e){return n<e?1:n>e?-1:0}function qw(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function a3(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function Yw(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function oa(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function l3(n,e,t){const i=e||Bs;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function yd(){return!0}function Tm(){return!1}function _d(){}function qP(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!oa(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function u3(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function qd(n){for(const e in n)delete n[e]}function rc(n){let e;for(e in n)return!1;return!e}class Ys{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class Im extends xm{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Ys(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let c;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?c=r[h].handleEvent(s):c=r[h].call(this,s),c===!1||s.propagationStopped){c=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,_d);delete o[i]}return c}disposeInternal(){this.listeners_&&qd(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=_d,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function tt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Cp(n,e,t,i){return tt(n,e,t,i,!0)}function Rt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),qd(n))}class Yd extends Im{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(ze.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=tt(this,e[s],t);return r}return tt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Cp(this,e[s],t)}else i=Cp(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)c3(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}Yd.prototype.on;Yd.prototype.once;Yd.prototype.un;function c3(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Rt(n[e]);else Rt(n)}function et(){throw new Error("Unimplemented abstract method.")}let h3=0;function nt(n){return n.ol_uid||(n.ol_uid=String(++h3))}class iS extends Ys{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class ls extends Yd{constructor(e){super(),this.on,this.once,this.un,nt(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new iS(i,e,t)),i=ic.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new iS(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],rc(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const rS={LENGTH:"length"};class Pg extends Ys{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Ki extends ls{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(rS.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Pg(ei.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Pg(ei.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Pg(ei.REMOVE,r,e)),this.dispatchEvent(new Pg(ei.ADD,t,e))}updateLength_(){this.set(rS.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function at(n,e){if(!n)throw new Error(e)}class sc extends ls{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new sc(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Rt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=tt(e,ze.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?d3(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function d3(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(at(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const an={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function sS(n){const e=Zi();for(let t=0,i=n.length;t<i;++t)Jh(e,n[t]);return e}function Zw(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function YP(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function ZP(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function oc(n,e){return QP(n,e[0],e[1])}function Uh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function QP(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function dv(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let c=an.UNKNOWN;return o<t?c=c|an.LEFT:o>r&&(c=c|an.RIGHT),l<i?c=c|an.BELOW:l>s&&(c=c|an.ABOVE),c===an.UNKNOWN&&(c=an.INTERSECTING),c}function Zi(){return[1/0,1/0,-1/0,-1/0]}function Jo(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Sm(n){return Jo(1/0,1/0,-1/0,-1/0,n)}function JP(n,e){const t=n[0],i=n[1];return Jo(t,i,t,i,e)}function Qw(n,e,t,i,r){const s=Sm(r);return eb(s,n,e,t,i)}function vd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function f3(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Jh(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function eb(n,e,t,i,r){for(;t<i;t+=r)g3(n,e[t],e[t+1]);return n}function g3(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function tb(n,e){let t;return t=e(Cm(n)),t||(t=e(Rm(n)),t)||(t=e(Am(n)),t)||(t=e(Pl(n)),t)?t:!1}function fv(n){let e=0;return Pm(n)||(e=dt(n)*Bn(n)),e}function Cm(n){return[n[0],n[1]]}function Rm(n){return[n[2],n[1]]}function fl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function p3(n,e){let t;if(e==="bottom-left")t=Cm(n);else if(e==="bottom-right")t=Rm(n);else if(e==="top-left")t=Pl(n);else if(e==="top-right")t=Am(n);else throw new Error("Invalid corner");return t}function gv(n,e,t,i,r){const[s,o,l,c,h,f,m,y]=nb(n,e,t,i);return Jo(Math.min(s,l,h,m),Math.min(o,c,f,y),Math.max(s,l,h,m),Math.max(o,c,f,y),r)}function nb(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),c=r*o,h=r*l,f=s*o,m=s*l,y=n[0],E=n[1];return[y-c+m,E-h-f,y-c-m,E-h+f,y+c-m,E+h+f,y+c+m,E+h-f,y-c+m,E-h-f]}function Bn(n){return n[3]-n[1]}function sl(n,e,t){const i=t||Zi();return ii(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Sm(i),i}function Pl(n){return[n[0],n[3]]}function Am(n){return[n[2],n[3]]}function dt(n){return n[2]-n[0]}function ii(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Pm(n){return n[2]<n[0]||n[3]<n[1]}function m3(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function y3(n,e,t){let i=!1;const r=dv(n,e),s=dv(n,t);if(r===an.INTERSECTING||s===an.INTERSECTING)i=!0;else{const o=n[0],l=n[1],c=n[2],h=n[3],f=e[0],m=e[1],y=t[0],E=t[1],I=(E-m)/(y-f);let C,x;s&an.ABOVE&&!(r&an.ABOVE)&&(C=y-(E-h)/I,i=C>=o&&C<=c),!i&&s&an.RIGHT&&!(r&an.RIGHT)&&(x=E-(y-c)*I,i=x>=l&&x<=h),!i&&s&an.BELOW&&!(r&an.BELOW)&&(C=y-(E-l)/I,i=C>=o&&C<=c),!i&&s&an.LEFT&&!(r&an.LEFT)&&(x=E-(y-o)*I,i=x>=l&&x<=h)}return i}function ib(n,e){const t=e.getExtent(),i=fl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=dt(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function rb(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];ib(n,e);const r=dt(i);if(dt(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Dt(n,e,t){return Math.min(Math.max(n,e),t)}function _3(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const c=((n-t)*o+(e-i)*l)/(o*o+l*l);c>1?(t=r,i=s):c>0&&(t+=o*c,i+=l*c)}return $u(n,e,t,i)}function $u(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function v3(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const c=Math.abs(n[l][i]);c>s&&(s=c,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const c=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=c*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function oS(n){return n*180/Math.PI}function Ko(n){return n*Math.PI/180}function ol(n,e){const t=n%e;return t*e<0?t+e:t}function vi(n,e,t){return n+t*(e-n)}function Zd(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function sH(n,e){return Math.round(Zd(n,e))}function bg(n,e){return Math.floor(Zd(n,e))}function kg(n,e){return Math.ceil(Zd(n,e))}function pv(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function w3(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Rp(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function Jw(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function E3(n,e){return n[0]*=e,n[1]*=e,n}function sb(n,e){if(e.canWrapX()){const t=dt(e.getExtent()),i=x3(n,e,t);i&&(n[0]-=i*t)}return n}function x3(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||dt(i),r=Math.floor((n[0]-i[0])/t)),r}function ob(...n){console.warn(...n)}const ac={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class eE{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||ac[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Qd=6378137,Gu=Math.PI*Qd,T3=[-Gu,-Gu,Gu,Gu],I3=[-180,-85,180,85],Dg=Qd*Math.log(Math.tan(Math.PI/2));class yu extends eE{constructor(e){super({code:e,units:"m",extent:T3,global:!0,worldExtent:I3,getPointResolution:function(t,i){return t/Math.cosh(i[1]/Qd)}})}}const aS=[new yu("EPSG:3857"),new yu("EPSG:102100"),new yu("EPSG:102113"),new yu("EPSG:900913"),new yu("http://www.opengis.net/def/crs/EPSG/0/3857"),new yu("http://www.opengis.net/gml/srs/epsg.xml#3857")];function S3(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Gu*n[s]/180;let o=Qd*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Dg?o=Dg:o<-Dg&&(o=-Dg),e[s+1]=o}return e}function C3(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Gu,e[s+1]=360*Math.atan(Math.exp(n[s+1]/Qd))/Math.PI-90;return e}const R3=6378137,lS=[-180,-90,180,90],A3=Math.PI*R3/180;class La extends eE{constructor(e,t){super({code:e,units:"degrees",extent:lS,axisOrientation:t,global:!0,metersPerUnit:A3,worldExtent:lS})}}const uS=[new La("CRS:84"),new La("EPSG:4326","neu"),new La("urn:ogc:def:crs:OGC:1.3:CRS84"),new La("urn:ogc:def:crs:OGC:2:84"),new La("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new La("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new La("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let mv={};function P3(n){return mv[n]||mv[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function b3(n,e){mv[n]=e}let Hu={};function wd(n,e,t){const i=n.getCode(),r=e.getCode();i in Hu||(Hu[i]={}),Hu[i][r]=t}function t0(n,e){return n in Hu&&e in Hu[n]?Hu[n][e]:null}const Ap=.9996,qi=.00669438,bm=qi*qi,km=bm*qi,Za=qi/(1-qi),cS=Math.sqrt(1-qi),lc=(1-cS)/(1+cS),ab=lc*lc,tE=ab*lc,nE=tE*lc,lb=nE*lc,ub=1-qi/4-3*bm/64-5*km/256,k3=3*qi/8+3*bm/32+45*km/1024,D3=15*bm/256+45*km/1024,M3=35*km/3072,N3=3/2*lc-27/32*tE+269/512*lb,L3=21/16*ab-55/32*nE,O3=151/96*tE-417/128*lb,V3=1097/512*nE,Pp=6378137;function F3(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/Ap/(Pp*ub),l=o+N3*Math.sin(2*o)+L3*Math.sin(4*o)+O3*Math.sin(6*o)+V3*Math.sin(8*o),c=Math.sin(l),h=c*c,f=Math.cos(l),m=c/f,y=m*m,E=y*y,I=1-qi*h,C=Math.sqrt(1-qi*h),x=Pp/C,b=(1-qi)/I,D=Za*f**2,L=D*D,O=i/(x*Ap),F=O*O,W=F*O,P=W*O,R=P*O,k=R*O,V=l-m/b*(F/2-P/24*(5+3*y+10*D-4*L-9*Za))+k/720*(61+90*y+298*D+45*E-252*Za-3*L);let j=(O-W/6*(1+2*y+D)+R/120*(5-2*D+28*y-3*L+8*Za+24*E))/f;return j=pv(j+Ko(cb(t.number)),-Math.PI,Math.PI),[oS(j),oS(V)]}const hS=-80,dS=84,j3=-180,U3=180;function z3(n,e,t){n=pv(n,j3,U3),e<hS?e=hS:e>dS&&(e=dS);const i=Ko(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,c=l*l,h=Ko(n),f=cb(t.number),m=Ko(f),y=Pp/Math.sqrt(1-qi*r**2),E=Za*s**2,I=s*pv(h-m,-Math.PI,Math.PI),C=I*I,x=C*I,b=x*I,D=b*I,L=D*I,O=Pp*(ub*i-k3*Math.sin(2*i)+D3*Math.sin(4*i)-M3*Math.sin(6*i)),F=Ap*y*(I+x/6*(1-l+E)+D/120*(5-18*l+c+72*E-58*Za))+5e5;let W=Ap*(O+y*o*(C/2+b/24*(5-l+9*E+4*E**2)+L/720*(61-58*l+c+600*E-330*Za)));return t.north||(W+=1e7),[F,W]}function cb(n){return(n-1)*6-180+3}const B3=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function hb(n){let e=0;for(const r of B3){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function fS(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const c=t[l],h=t[l+1],f=n(c,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function G3(n){return hb(n)?new eE({code:n,units:"m"}):null}function W3(n){const e=hb(n.getCode());return e?{forward:fS(z3,e),inverse:fS(F3,e)}:null}const K3=63710088e-1;function gS(n,e,t){t=t||K3;const i=Ko(n[1]),r=Ko(e[1]),s=(r-i)/2,o=Ko(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const $3=[W3],H3=[G3];let yv=!0;function db(n){yv=!1}function iE(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function _v(n){b3(n.getCode(),n),wd(n,n,iE)}function X3(n){n.forEach(_v)}function oi(n){if(typeof n!="string")return n;const e=P3(n);if(e)return e;for(const t of H3){const i=t(n);if(i)return i}return null}function bp(n,e,t,i){n=oi(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/ac[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=sE(n,oi("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=gS(h.slice(0,2),h.slice(2,4)),m=gS(h.slice(4,6),h.slice(6,8));r=(f+m)/2}const c=i?ac[i]:n.getMetersPerUnit();c!==void 0&&(r/=c)}}return r}function pS(n){X3(n),n.forEach(function(e){n.forEach(function(t){e!==t&&wd(e,t,iE)})})}function q3(n,e,t,i){n.forEach(function(r){e.forEach(function(s){wd(r,s,t),wd(s,r,i)})})}function rE(n,e){return n?typeof n=="string"?oi(n):n:oi(e)}function Y3(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),c=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=c?e[o+h]:l[h]}return t})}function gl(n,e){return db(),Dm(n,"EPSG:4326","EPSG:3857")}function mS(n,e){const t=Dm(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=ol(i+180,360)-180),t}function ip(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||sE(n,e)===iE)&&t}function sE(n,e){const t=n.getCode(),i=e.getCode();let r=t0(t,i);if(r)return r;let s=null,o=null;for(const c of $3)s||(s=c(n)),o||(o=c(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=n0(s.inverse,o.forward);else{const c=t0(t,l);c&&(r=n0(c,o.forward))}else{const c=t0(l,i);c&&(r=n0(s.inverse,c))}return r&&(_v(n),_v(e),wd(n,e,r)),r}function n0(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function kp(n,e){const t=oi(n),i=oi(e);return sE(t,i)}function Dm(n,e,t){const i=kp(e,t);if(!i){const r=oi(e).getCode(),s=oi(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function vv(n,e){return n}function Ms(n,e){return yv&&!Rp(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(yv=!1,ob("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function fb(n,e){return n}function zo(n,e){return n}function Z3(){pS(aS),pS(uS),q3(uS,aS,S3,C3)}Z3();new Array(6);function wr(){return[1,0,0,1,0,0]}function Q3(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function cn(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Hs(n,e,t,i,r,s,o,l){const c=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*c,n[2]=-i*c,n[3]=r*h,n[4]=o*i*h-l*i*c+e,n[5]=o*r*c+l*r*h+t,n}function gb(n,e){const t=J3(e);at(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],c=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*c-o*l)/t,n[5]=-(i*c-r*l)/t,n}function J3(n){return n[0]*n[3]-n[1]*n[2]}const e4=[1e5,1e5,1e5,1e5,2,2];function t4(n){return"matrix("+n.join(", ")+")"}function wv(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function n4(n,e){const t=wv(n),i=wv(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*e4[r])!==0)return!1;return!0}function $o(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let c=e;c<t;c+=i){const h=n[c],f=n[c+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let m=2;m<o;m++)s[l++]=n[c+m]}return s&&s.length!=l&&(s.length=l),s}function pb(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),c=Math.sin(r),h=s[0],f=s[1];let m=0;for(let y=e;y<t;y+=i){const E=n[y]-h,I=n[y+1]-f;o[m++]=h+E*l-I*c,o[m++]=f+E*c+I*l;for(let C=y+2;C<y+i;++C)o[m++]=n[C]}return o&&o.length!=m&&(o.length=m),o}function i4(n,e,t,i,r,s,o,l){l=l||[];const c=o[0],h=o[1];let f=0;for(let m=e;m<t;m+=i){const y=n[m]-c,E=n[m+1]-h;l[f++]=c+r*y,l[f++]=h+s*E;for(let I=m+2;I<m+i;++I)l[f++]=n[I]}return l&&l.length!=f&&(l.length=f),l}function r4(n,e,t,i,r,s,o){o=o||[];let l=0;for(let c=e;c<t;c+=i){o[l++]=n[c]+r,o[l++]=n[c+1]+s;for(let h=c+2;h<c+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const yS=wr(),s4=[NaN,NaN];class o4 extends ls{constructor(){super(),this.extent_=Zi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=qP((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return et()}closestPointXY(e,t,i,r){return et()}containsXY(e,t){return this.closestPointXY(e,t,s4,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return et()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Sm(t),this.extentRevision_=this.getRevision()}return m3(this.extent_,e)}rotate(e,t){et()}scale(e,t,i){et()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return et()}getType(){return et()}applyTransform(e){et()}intersectsExtent(e){return et()}translate(e,t){et()}transform(e,t){const i=oi(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const c=i.getExtent(),h=i.getWorldExtent(),f=Bn(h)/Bn(c);Hs(yS,h[0],h[3],f,-f,0,0,0);const m=$o(s,0,s.length,l,yS,o),y=kp(i,t);return y?y(m,m,l):m}:kp(i,t);return this.applyTransform(r),this}}class oE extends o4{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Qw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return et()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=_S(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){et()}setLayout(e,t,i){let r;if(e)r=_S(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=a4(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();pb(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=fl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();i4(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();r4(i,0,i.length,r,e,t,i),this.changed()}}}function a4(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function _S(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function l4(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return $o(i,0,i.length,r,e,t)}function vS(n,e,t,i,r,s,o){const l=n[e],c=n[e+1],h=n[t]-l,f=n[t+1]-c;let m;if(h===0&&f===0)m=e;else{const y=((r-l)*h+(s-c)*f)/(h*h+f*f);if(y>1)m=t;else if(y>0){for(let E=0;E<i;++E)o[E]=vi(n[e+E],n[t+E],y);o.length=i;return}else m=e}for(let y=0;y<i;++y)o[y]=n[m+y];o.length=i}function mb(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],c=n[e+1],h=$u(s,o,l,c);h>r&&(r=h),s=l,o=c}return r}function yb(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=mb(n,e,l,i,r),e=l}return r}function oH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=yb(n,e,l,i,r),e=l[l.length-1]}return r}function _b(n,e,t,i,r,s,o,l,c,h,f){if(e==t)return h;let m,y;if(r===0){if(y=$u(o,l,n[e],n[e+1]),y<h){for(m=0;m<i;++m)c[m]=n[e+m];return c.length=i,y}return h}f=f||[NaN,NaN];let E=e+i;for(;E<t;)if(vS(n,E-i,E,i,o,l,f),y=$u(o,l,f[0],f[1]),y<h){for(h=y,m=0;m<i;++m)c[m]=f[m];c.length=i,E+=i}else E+=i*Math.max((Math.sqrt(y)-Math.sqrt(h))/r|0,1);if(s&&(vS(n,t-i,e,i,o,l,f),y=$u(o,l,f[0],f[1]),y<h)){for(h=y,m=0;m<i;++m)c[m]=f[m];c.length=i}return h}function vb(n,e,t,i,r,s,o,l,c,h,f){f=f||[NaN,NaN];for(let m=0,y=t.length;m<y;++m){const E=t[m];h=_b(n,e,E,i,r,s,o,l,c,h,f),e=E}return h}function aH(n,e,t,i,r,s,o,l,c,h,f){f=f||[NaN,NaN];for(let m=0,y=t.length;m<y;++m){const E=t[m];h=vb(n,e,E,i,r,s,o,l,c,h,f),e=E[E.length-1]}return h}function u4(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function wb(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function Eb(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const c=wb(n,e,t[o],i);r[s++]=c,e=c}return r.length=s,r}function lH(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const c=Eb(n,e,t[o],i,r[s]);c.length===0&&(c[0]=e),r[s++]=c,e=c[c.length-1]}return r.length=s,r}function Wu(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Dp(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const c=t[o];r[s++]=Wu(n,e,c,i,r[s]),e=c}return r.length=s,r}function wS(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const c=t[o];r[s++]=c.length===1&&c[0]===e?[]:Dp(n,e,c,i,r[s]),e=c[c.length-1]}return r.length=s,r}function ES(n,e,t,i,r,s,o){let l,c;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,c=r;else if(h!==0){let f=n[e],m=n[e+1],y=0;const E=[0];for(let x=e+i;x<t;x+=i){const b=n[x],D=n[x+1];y+=Math.sqrt((b-f)*(b-f)+(D-m)*(D-m)),E.push(y),f=b,m=D}const I=r*y,C=s3(E,I);C<0?(c=(I-E[-C-2])/(E[-C-1]-E[-C-2]),l=e+(-C-2)*i):l=e+C*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:c===void 0?n[l+f]:vi(n[l+f],n[l+i+f],c);return s}function xS(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,c=t/i;for(;l<c;){const y=l+c>>1;r<n[(y+1)*i-1]?c=y:l=y+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],m=(r-h)/(f-h);o=[];for(let y=0;y<i-1;++y)o.push(vi(n[(l-1)*i+y],n[l*i+y],m));return o.push(r),o}function uH(n,e,t,i,r,s,o){if(o)return xS(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let c=0,h=t.length;c<h;++c){const f=t[c];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return xS(n,e,f,i,r,!1);e=f}}return null}function c4(n,e,t,i,r){return!tb(r,function(o){return!Qa(n,e,t,i,o[0],o[1])})}function Qa(n,e,t,i,r,s){let o=0,l=n[t-i],c=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];c<=s?f>s&&(h-l)*(s-c)-(r-l)*(f-c)>0&&o++:f<=s&&(h-l)*(s-c)-(r-l)*(f-c)<0&&o--,l=h,c=f}return o!==0}function aE(n,e,t,i,r,s){if(t.length===0||!Qa(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(Qa(n,t[o-1],t[o],i,r,s))return!1;return!0}function cH(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const c=t[o];if(aE(n,e,c,i,r,s))return!0;e=c[c.length-1]}return!1}function h4(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function lE(n,e,t,i,r,s){return s=s??eb(Zi(),n,e,t,i),ii(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:h4(n,e,t,i,function(o,l){return y3(r,o,l)}):!1}function hH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(lE(n,e,t[s],i,r))return!0;e=t[s]}return!1}function xb(n,e,t,i,r){return!!(lE(n,e,t,i,r)||Qa(n,e,t,i,r[0],r[1])||Qa(n,e,t,i,r[0],r[3])||Qa(n,e,t,i,r[2],r[1])||Qa(n,e,t,i,r[2],r[3]))}function Tb(n,e,t,i,r){if(!xb(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(c4(n,t[s-1],t[s],i,r)&&!lE(n,t[s-1],t[s],i,r))return!1;return!0}function dH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(Tb(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function d4(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const c=n[l],h=n[l+1];o+=Math.sqrt((c-r)*(c-r)+(h-s)*(h-s)),r=c,s=h}return o}function uE(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const c=new Array(l);c[0]=1,c[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const m=h.pop(),y=h.pop();let E=0;const I=n[y],C=n[y+1],x=n[m],b=n[m+1];for(let D=y+i;D<m;D+=i){const L=n[D],O=n[D+1],F=_3(L,O,I,C,x,b);F>E&&(f=D,E=F)}E>r&&(c[(f-e)/i]=1,y+i<f&&h.push(y,f),f+i<m&&h.push(f,m))}for(let m=0;m<l;++m)c[m]&&(s[o++]=n[e+m*i],s[o++]=n[e+m*i+1]);return o}function f4(n,e,t,i,r,s,o,l){for(let c=0,h=t.length;c<h;++c){const f=t[c];o=uE(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Ua(n,e){return e*Math.round(n/e)}function g4(n,e,t,i,r,s,o){if(e==t)return o;let l=Ua(n[e],r),c=Ua(n[e+1],r);e+=i,s[o++]=l,s[o++]=c;let h,f;do if(h=Ua(n[e],r),f=Ua(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==c);for(;e<t;){const m=Ua(n[e],r),y=Ua(n[e+1],r);if(e+=i,m==h&&y==f)continue;const E=h-l,I=f-c,C=m-l,x=y-c;if(E*x==I*C&&(E<0&&C<E||E==C||E>0&&C>E)&&(I<0&&x<I||I==x||I>0&&x>I)){h=m,f=y;continue}s[o++]=h,s[o++]=f,l=h,c=f,h=m,f=y}return s[o++]=h,s[o++]=f,o}function cE(n,e,t,i,r,s,o,l){for(let c=0,h=t.length;c<h;++c){const f=t[c];o=g4(n,e,f,i,r,s,o),l.push(o),e=f}return o}function fH(n,e,t,i,r,s,o,l){for(let c=0,h=t.length;c<h;++c){const f=t[c],m=[];o=cE(n,e,f,i,r,s,o,m),l.push(m),e=f[f.length-1]}return o}class pl extends oE{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new pl(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=$u(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let c=0;c<l;++c)i[c]=s[c];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return JP(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return QP(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=u4(this.flatCoordinates,0,e,this.stride),this.changed()}}const $i={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},ml=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",p4=ml.includes("safari")&&!ml.includes("chrom");p4&&(ml.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ml));const m4=ml.includes("webkit")&&!ml.includes("edge"),Ib=ml.includes("macintosh"),y4=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ei=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Sb=typeof Image<"u"&&Image.prototype.decode,Cb=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Ue={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Qt(n,e,t,i){let r;return t&&t.length?r=t.shift():Ei?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let i0;function Mp(){return i0||(i0=Qt(1,1)),i0}function Mm(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function TS(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function _4(n){for(;n.lastChild;)n.lastChild.remove()}function v4(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function Rb(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Bo(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const hE=[NaN,NaN,NaN,0];let r0;function w4(){return r0||(r0=Qt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),r0}const E4=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,x4=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,T4=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,I4=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Mg(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function ed(n){throw new Error('failed to parse "'+n+'" as color')}function Ab(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(x4)||n.match(E4)||n.match(T4);if(s){const o=s[4],l=100/255;return[Dt(Mg(s[1],l)+.5|0,0,255),Dt(Mg(s[2],l)+.5|0,0,255),Dt(Mg(s[3],l)+.5|0,0,255),o!==void 0?Dt(Mg(o,100),0,1):1]}ed(n)}if(n.startsWith("#")){if(I4.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let c=0,h=s.length;c<h;c+=o){let f=parseInt(s.substring(c,c+o),16);o===1&&(f+=f<<4),l[c/o]=f}return l[3]=l[3]/255,l}ed(n)}const e=w4();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&ed(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Ab(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=Zd(r[3]/255,3),r}function S4(n){return typeof n=="string"?n:fE(n)}const C4=1024,Sh={};let s0=0;function R4(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function o0(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function a0(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function l0(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function u0(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function IS(n){const e=l0(n[0]),t=l0(n[1]),i=l0(n[2]),r=u0(e*.222488403+t*.716873169+i*.06060791),s=500*(u0(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-u0(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function A4(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=a0(e),s=a0(e+t/500*Math.cos(i)),o=a0(e-t/200*Math.sin(i)),l=o0(s*3.021973625-r*1.617392459-o*.404875592),c=o0(s*-.943766287+r*1.916279586+o*.027607165),h=o0(s*.069407491-r*.22898585+o*1.159737864);return[Dt(l+.5|0,0,255),Dt(c+.5|0,0,255),Dt(h+.5|0,0,255),n[3]]}function dE(n){if(n==="none")return hE;if(Sh.hasOwnProperty(n))return Sh[n];if(s0>=C4){let t=0;for(const i in Sh)(t++&3)===0&&(delete Sh[i],--s0)}const e=Ab(n);e.length!==4&&ed(n);for(const t of e)isNaN(t)&&ed(n);return Sh[n]=e,++s0,e}function uc(n){return Array.isArray(n)?n:dE(n)}function fE(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}function P4(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[Cp(i,ze.LOAD,function(){o=!0,s||e()})];return i.src&&Sb?(s=!0,i.decode().then(function(){r&&e()}).catch(function(c){r&&(o?e():t())})):l.push(Cp(i,ze.ERROR,t)),function(){r=!1,l.forEach(Rt)}}function b4(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function k4(n,e){return e&&(n.src=e),n.src&&Sb?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):b4(n)}class D4{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=c0(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=c0(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=c0(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Ue.IDLE&&r.load(),r.getImageState()===Ue.LOADING?r.ready().then(()=>{this.patternCache_[o]=Mp().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Mp().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function c0(n,e,t){const i=t?uc(t):"null";return e+":"+n+":"+i}const Hi=new D4;let Ch=null;class Pb extends Im{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Ue.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Ue.LOADED){Ch||(Ch=Qt(1,1,void 0,{willReadFrequently:!0})),Ch.drawImage(this.image_,0,0);try{Ch.getImageData(0,0,1,1),this.tainted_=!1}catch{Ch=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(ze.CHANGE)}handleImageError_(){this.imageState_=Ue.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Ue.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Qt(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Ue.IDLE){this.image_||this.initializeImage_(),this.imageState_=Ue.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&k4(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Ue.LOADED)return;const t=this.image_,i=Qt(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=S4(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Ue.LOADED||this.imageState_===Ue.ERROR)e();else{const t=()=>{(this.imageState_===Ue.LOADED||this.imageState_===Ue.ERROR)&&(this.removeEventListener(ze.CHANGE,t),e())};this.addEventListener(ze.CHANGE,t)}})),this.ready_}}function Np(n,e,t,i,r,s){let o=e===void 0?void 0:Hi.get(e,t,r);return o||(o=new Pb(n,n&&"src"in n?n.src||void 0:e,t,i,r),Hi.set(e,t,r,o,s)),s&&o&&!Hi.getPattern(e,t,r)&&Hi.set(e,t,r,o,s),o}function Yr(n){return n?Array.isArray(n)?fE(n):typeof n=="object"&&"src"in n?M4(n):n:null}function M4(n){if(!n.offset||!n.size)return Hi.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Hi.getPattern(e,void 0,n.color);if(t)return t;const i=Hi.get(n.src,"anonymous",null);if(i.getImageState()!==Ue.LOADED)return null;const r=Qt(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Np(r.canvas,e,void 0,Ue.LOADED,n.color,!0),Hi.getPattern(e,void 0,n.color)}class bb{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Ng="ol-hidden",Jd="ol-unselectable",gE="ol-control",SS="ol-collapsed",N4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),CS=["style","variant","weight","size","lineHeight","family"],Ev={normal:400,bold:700},xv=function(n){const e=n.match(N4);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=CS.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[CS[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in Ev&&(t.weight=Ev[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},kb="10px sans-serif",ti="#000",cc="round",Gs=[],Ws=0,hc="round",Ed=10,xd="#000",Td="center",Lp="middle",Ja=[0,0,0,0],Id=1,bu=new ls;let Rh=null,RS;const Tv={},L4=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function O4(n,e,t){return`${n} ${e} 16px "${t}"`}const V4=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=xv(s),c=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const m=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),y=Ev[f.weight]||f.weight;return m===c&&f.style===l.style&&y==h})}async function r(){await t.ready;let s=!0;const o=bu.getProperties(),l=Object.keys(o).filter(c=>o[c]<100);for(let c=l.length-1;c>=0;--c){const h=l[c];let f=o[h];f<100&&(await i(h)?(qd(Tv),bu.set(h,100)):(f+=10,bu.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Ei?self.fonts:document.fonts);const o=xv(s);if(!o)return;const l=o.families;let c=!1;for(const h of l){if(L4.has(h))continue;const f=O4(o.style,o.weight,h);bu.get(f)===void 0&&(bu.set(f,0,!0),c=!0)}c&&(clearTimeout(e),e=setTimeout(r,100))}})(),F4=(function(){let n;return function(e){let t=Tv[e];if(t==null){if(Ei){const i=xv(e),r=Db(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);Tv[e]=t}return t}})();function Db(n,e){return Rh||(Rh=Qt(1,1)),n!=RS&&(Rh.font=n,RS=Rh.font),Rh.measureText(e)}function Mb(n,e){return Db(n,e).width}function AS(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,Mb(n,s)),0);return t[e]=i,i}function j4(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,c=0;for(let h=0,f=e.length;h<=f;h+=2){const m=e[h];if(m===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=c,c=0;continue}const y=e[h+1]||n.font,E=Mb(y,m);t.push(E),o+=E;const I=F4(y);i.push(I),c=Math.max(c,I)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function U4(n,e,t,i,r,s,o,l,c,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=m=>m.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(c,h),n.scale(f[0],f[1]),z4(i,n)):f[0]<0||f[1]<0?(n.translate(c,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,c,h,o*f[0],l*f[1]),n.restore()}function z4(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class B4 extends bb{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?Zd(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=wr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=$o(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,c=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=c*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,m=s.length;f<m;f+=2){const y=s[f]-this.imageAnchorX_,E=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const I=y+this.imageAnchorX_,C=E+this.imageAnchorY_;Hs(l,I,C,1,1,h,-I,-C),o.save(),o.transform.apply(o,l),o.translate(I,C),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,E,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=c)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=$o(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const c=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(c-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,c,h),this.textFillState_&&o.fillText(this.text_,c,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=$o(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let c=l.length;s&&(c-=2);for(let h=2;h<c;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ii(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=l4(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ii(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(ii(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let c=0,h=o.length;c<h;++c)s=this.moveToLineTo_(r,s,o[c],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ii(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ii(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,c=s.length;l<c;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),oa(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Td;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Yr(i||ti)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),c=t.getWidth(),h=t.getMiterLimit(),f=s||Gs;this.strokeState_={lineCap:r!==void 0?r:cc,lineDash:this.pixelRatio_===1?f:f.map(m=>m*this.pixelRatio_),lineDashOffset:(o||Ws)*this.pixelRatio_,lineJoin:l!==void 0?l:hc,lineWidth:(c!==void 0?c:Id)*this.pixelRatio_,miterLimit:h!==void 0?h:Ed,strokeStyle:Yr(i||xd)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const E=t.getColor();this.textFillState_={fillStyle:Yr(E||ti)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const E=i.getColor(),I=i.getLineCap(),C=i.getLineDash(),x=i.getLineDashOffset(),b=i.getLineJoin(),D=i.getWidth(),L=i.getMiterLimit();this.textStrokeState_={lineCap:I!==void 0?I:cc,lineDash:C||Gs,lineDashOffset:x||Ws,lineJoin:b!==void 0?b:hc,lineWidth:D!==void 0?D:Id,miterLimit:L!==void 0?L:Ed,strokeStyle:Yr(E||xd)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),c=e.getRotation(),h=e.getScaleArray(),f=e.getText(),m=e.getTextAlign(),y=e.getTextBaseline();this.textState_={font:r!==void 0?r:kb,textAlign:m!==void 0?m:Td,textBaseline:y!==void 0?y:Lp},this.text_=f!==void 0?Array.isArray(f)?f.reduce((E,I,C)=>E+=C%2?" ":I,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=c!==void 0?c:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const G4=.5,Nb={Point:Z4,LineString:X4,Polygon:J4,MultiPoint:Q4,MultiLineString:q4,MultiPolygon:Y4,GeometryCollection:H4,Circle:K4};function W4(n,e){return parseInt(nt(n),10)-parseInt(nt(e),10)}function PS(n,e){const t=Lb(n,e);return t*t}function Lb(n,e){return G4*n/e}function K4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const c=n.getBuilder(t.getZIndex(),"Circle");c.setFillStrokeStyle(s,o),c.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(l),c.drawText(e,i)}}function bS(n,e,t,i,r,s,o,l){const c=[],h=t.getImage();if(h){let y=!0;const E=h.getImageState();E==Ue.LOADED||E==Ue.ERROR?y=!1:E==Ue.IDLE&&h.load(),y&&c.push(h.ready())}const f=t.getFill();f&&f.loading()&&c.push(f.ready());const m=c.length>0;return m&&Promise.all(c).then(()=>r(null)),$4(n,e,t,i,s,o,l),m}function $4(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const c=l.simplifyTransformed(i,r);if(t.getRenderer())Ob(n,c,t,e,o);else{const f=Nb[c.getType()];f(n,c,t,e,o,s)}}function Ob(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,c=o.length;l<c;++l)Ob(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function H4(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,c;for(l=0,c=o.length;l<c;++l){const h=Nb[o[l].getType()];h(n,o[l],t,i,r,s)}}function X4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function q4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function Y4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const c=n.getBuilder(t.getZIndex(),"Polygon");c.setFillStrokeStyle(s,o),c.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(l),c.drawText(e,i,r)}}function Z4(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),c=l&&l.getText(),h=s&&o&&c?{}:void 0;if(o){if(o.getImageState()!=Ue.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(c){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function Q4(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,c=t.getText(),h=c&&c.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=Ue.LOADED)return;const m=n.getBuilder(t.getZIndex(),"Image");m.setImageStyle(o,f),m.drawMultiPoint(e,i,r)}if(h){const m=n.getBuilder(t.getZIndex(),"Text");m.setTextStyle(c,f),m.drawText(e,i,r)}}function J4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const c=n.getBuilder(t.getZIndex(),"Polygon");c.setFillStrokeStyle(s,o),c.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const c=n.getBuilder(t.getZIndex(),"Text");c.setTextStyle(l),c.drawText(e,i,r)}}let ej=!1;function tj(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=ej,l.onload=function(c){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function kS(n,e){return function(t,i,r,s,o){tj(n,e,t,i,r,(l,c)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function nj(n,e){return[[-1/0,-1/0,1/0,1/0]]}function ij(n,e,t,i){const r=[];let s=Zi();for(let o=0,l=t.length;o<l;++o){const c=t[o];s=Qw(n,e,c[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=c[c.length-1]}return r}function pE(n,e,t,i,r,s,o){let l,c,h,f,m,y,E;const I=r[s+1],C=[];for(let D=0,L=t.length;D<L;++D){const O=t[D];for(f=n[O-i],y=n[O-i+1],l=e;l<O;l+=i)m=n[l],E=n[l+1],(I<=y&&E<=I||y<=I&&I<=E)&&(h=(I-y)/(E-y)*(m-f)+f,C.push(h)),f=m,y=E}let x=NaN,b=-1/0;for(C.sort(Bs),f=C[0],l=1,c=C.length;l<c;++l){m=C[l];const D=Math.abs(m-f);D>b&&(h=(f+m)/2,aE(n,e,t,i,h,I)&&(x=h,b=D)),f=m}return isNaN(x)&&(x=r[s]),o?(o.push(x,I,b),o):[x,I,b]}function rj(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const c=t[o];s=pE(n,e,c,i,r,2*o,s),e=c[c.length-1]}return s}function sj(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function mE(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],c=n[e+1];r+=(l-s)*(c+o),s=l,o=c}return r===0?void 0:r>0}function Vb(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],c=mE(n,e,l,i);if(s===0){if(r&&c||!r&&!c)return!1}else if(r&&!c||!r&&c)return!1;e=l}return!0}function gH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!Vb(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function Iv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],c=mE(n,e,l,i);(s===0?r&&c||!r&&!c:r&&!c||!r&&c)&&sj(n,e,l,i),e=l}return e}function pH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=Iv(n,e,t[s],i,r);return e}function oj(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const c=e[o],h=mE(n,i,c,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=c}return t}function Fb(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,c=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=c*h-l*f,l=h,c=f}return r/2}function jb(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=Fb(n,e,l,i),e=l}return r}function mH(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=jb(n,e,l,i),e=l[l.length-1]}return r}class Sd extends oE{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Sd(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<ZP(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(mb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),_b(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return Fb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Wu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=uE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Sd(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=wb(this.flatCoordinates,0,e,this.stride),this.changed()}}class Cd extends oE{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Yw(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Cd(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<ZP(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(yb(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vb(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return aE(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return jb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Iv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Dp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=fl(this.getExtent());this.flatInteriorPoint_=pE(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new pl(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Sd(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const c=i[o],h=new Sd(t.slice(s,c),e);r.push(h),s=c}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Vb(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Iv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=cE(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Cd(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return Tb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Eb(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function DS(n){if(Pm(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Cd(s,"XY",[s.length])}const MS=wr();class dr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?JP(this.flatCoordinates_):Qw(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=fl(this.getExtent());this.flatInteriorPoints_=pE(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=oj(this.flatCoordinates_,this.ends_),t=ij(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=rj(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=ES(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=ES(e,t,o,2,.5);Yw(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=oi(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Bn(i)/Bn(t);Hs(MS,i[0],i[3],r,-r,0,0,0),$o(this.flatCoordinates_,0,this.flatCoordinates_.length,2,MS,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new dr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=qP((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=uE(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=f4(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=cE(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new dr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}dr.prototype.getFlatCoordinates=dr.prototype.getOrientedFlatCoordinates;function Ub(n,e,t=0,i=n.length-1,r=aj){for(;i>t;){if(i-t>600){const c=i-t+1,h=e-t+1,f=Math.log(c),m=.5*Math.exp(2*f/3),y=.5*Math.sqrt(f*m*(c-m)/c)*(h-c/2<0?-1:1),E=Math.max(t,Math.floor(e-h*m/c+y)),I=Math.min(i,Math.floor(e+(c-h)*m/c+y));Ub(n,e,E,I,r)}const s=n[e];let o=t,l=i;for(Ah(n,t,e),r(n[i],s)>0&&Ah(n,t,i);o<l;){for(Ah(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?Ah(n,t,l):(l++,Ah(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function Ah(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function aj(n,e){return n<e?-1:n>e?1:0}let zb=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!Og(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],c=t.leaf?r(l):l;Og(e,c)&&(t.leaf?i.push(l):d0(e,c)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!Og(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(Og(e,o)){if(t.leaf||d0(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=ku([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,c,h;for(;i||s.length;){if(i||(i=s.pop(),c=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=lj(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&d0(i,r)?(s.push(i),o.push(l),l=0,c=i,i=i.children[0]):c?(l++,i=c.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=ku(e.slice(t,i+1)),_u(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=ku([]),l.leaf=!1,l.height=r;const c=Math.ceil(s/o),h=c*Math.ceil(Math.sqrt(o));NS(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const m=Math.min(f+h-1,i);NS(e,f,m,c,this.compareMinY);for(let y=f;y<=m;y+=c){const E=Math.min(y+c-1,m);l.children.push(this._build(e,y,E,r-1))}}return _u(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let c=0;c<t.children.length;c++){const h=t.children[c],f=h0(h),m=hj(e,h)-f;m<o?(o=m,s=f<s?f:s,l=h):m===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Bh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=ku(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,_u(i,this.toBBox),_u(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=ku([e,t]),this.data.height=e.height+1,this.data.leaf=!1,_u(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const c=zh(e,0,l,this.toBBox),h=zh(e,l,i,this.toBBox),f=dj(c,h),m=h0(c)+h0(h);f<s?(s=f,r=l,o=m<o?m:o):f===s&&m<o&&(o=m,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:uj,s=e.leaf?this.compareMinY:cj,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=zh(e,0,t,s),l=zh(e,i-t,i,s);let c=Lg(o)+Lg(l);for(let h=t;h<i-t;h++){const f=e.children[h];Bh(o,e.leaf?s(f):f),c+=Lg(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];Bh(l,e.leaf?s(f):f),c+=Lg(l)}return c}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Bh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():_u(e[t],this.toBBox)}};function lj(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function _u(n,e){zh(n,0,n.children.length,e,n)}function zh(n,e,t,i,r){r||(r=ku(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Bh(r,n.leaf?i(o):o)}return r}function Bh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function uj(n,e){return n.minX-e.minX}function cj(n,e){return n.minY-e.minY}function h0(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Lg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function hj(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function dj(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function d0(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Og(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function ku(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function NS(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;Ub(n,o,e,t,r),s.push(e,o,o,t)}}class LS{constructor(e){this.rbush_=new zb(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[nt(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],c={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=c,this.items_[nt(l)]=c}this.rbush_.load(i)}remove(e){const t=nt(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[nt(t)],r=[i.minX,i.minY,i.maxX,i.maxY];vd(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return rc(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Jo(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class Bb extends ls{constructor(e){super(),this.projection=oi(e.projection),this.attributions_=OS(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=OS(e),this.changed()}setState(e){this.state_=e,this.changed()}}function OS(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const zi={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class To extends Ys{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class yE extends Bb{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=_d,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(at(this.format_,"`format` must be set when `url` is set"),this.loader_=kS(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:nj;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new LS:null,this.loadedExtentsRtree_=new LS,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Ki(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=nt(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new To(zi.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof dr||(this.featureChangeKeys_[e]=[tt(t,ze.CHANGE,this.handleFeatureChange_,this),tt(t,ic.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof dr){const s=this.idIndex_[r];s instanceof dr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(at(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],c=nt(l);this.addToIndex_(c,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],c=nt(l);this.setupChangeEvents_(c,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[c]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(zi.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new To(zi.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(zi.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(zi.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(ei.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(ei.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Rt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new To(zi.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof dr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof dr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),rc(this.nullGeometryFeatures_)||Yw(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=rb(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const c=[-1/0,-1/0,1/0,1/0];return t=t||yd,this.featuresRtree_.forEachInExtent(c,function(h){if(t(h)){const f=h.getGeometry(),m=l;if(l=f instanceof dr?0:f.closestPointXY(i,r,o,l),l<m){s=h;const y=Math.sqrt(l);c[0]=i-y,c[1]=r-y,c[2]=i+y,c[3]=r+y}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=nt(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new To(zi.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:nt(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&rc(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const c=s[o];r.forEachInExtent(c,function(f){return Uh(f.extent,c)})||(++this.loadingExtentsCount_,this.dispatchEvent(new To(zi.FEATURESLOADSTART)),this.loader_.call(this,c,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new To(zi.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new To(zi.FEATURESLOADERROR))}),r.insert(c,{extent:c.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(vd(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=nt(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Rt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(zi.REMOVEFEATURE)&&this.dispatchEvent(new To(zi.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){at(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(kS(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Tr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Tr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Np(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Ue.IDLE&&t.load(),t.getImageState()===Ue.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?nt(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:uc(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Pc{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Pc({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function VS(n){return n[0]>0&&n[1]>0}function fj(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function si(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Nm{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=si(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Nm({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return et()}getImage(e){return et()}getHitDetectionImage(){return et()}getPixelRatio(e){return 1}getImageState(){return et()}getImageSize(){return et()}getOrigin(){return et()}getSize(){return et()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=si(e)}listenImageChange(e){et()}load(){et()}unlistenImageChange(e){et()}ready(){return Promise.resolve()}}class Lm extends Nm{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Ue.LOADING:Ue.LOADED,this.imageState_===Ue.LOADING&&this.ready().then(()=>this.imageState_=Ue.LOADED),this.render()}clone(){const e=this.getScale(),t=new Lm({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Hi.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=Qt(o,o);this.draw_(s,l,e),r=l.canvas,Hi.set(i,null,null,new Pb(r,void 0,null,Ue.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const W=r;r=s,s=W}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,c=s*Math.sin(l),h=Math.sqrt(s*s-c*c),f=r-h,m=Math.sqrt(c*c+f*f),y=m/c;if(e==="miter"&&y<=i)return y*t;const E=t/2/y,I=t/2*(f/m),x=Math.sqrt((r+E)*(r+E)+I*I)-r;if(this.radius2_===void 0||e==="bevel")return x*2;const b=r*Math.sin(l),D=Math.sqrt(r*r-b*b),L=s-D,F=Math.sqrt(b*b+L*L)/b;if(F<=i){const W=F*t/2-s-r;return 2*Math.max(x,W)}return x*2}createRenderOptions(){let e=cc,t=hc,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=Yr(this.stroke_.getColor()??xd),l=this.stroke_.getWidth()??Id,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??hc,e=this.stroke_.getLineCap()??cc,i=this.stroke_.getMiterLimit()??Ed);const c=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+c);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ti),t.fillStyle=Yr(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=uc(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Qt(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const c=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(c),h*Math.sin(c))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ti,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class bl extends Lm{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new bl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Yi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=FS,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Yi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=FS,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function gj(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(at(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let f0=null;function Gb(n,e){if(!f0){const t=new Tr({color:"rgba(255,255,255,0.4)"}),i=new Pc({color:"#3399CC",width:1.25});f0=[new Yi({image:new bl({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return f0}function FS(n){return n.getGeometry()}const pj="#333";class ef{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=si(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Tr({color:pj}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new ef({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Tr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=si(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Nn={ANIMATING:0,INTERACTING:1},Se={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Vg=[Se.FILL],Go=[Se.STROKE],el=[Se.BEGIN_PATH],jS=[Se.CLOSE_PATH];class tf extends bb{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,c=e.length;l<c;l+=t)r[0]=e[l],r[1]=e[l+1],oc(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let c=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],m=e[t+1];const y=this.tmpCoordinate_;let E=!0,I,C,x;for(I=t+r;I<i;I+=r)y[0]=e[I],y[1]=e[I+1],x=dv(h,y),x!==C?(E&&(l[c++]=f,l[c++]=m,E=!1),l[c++]=y[0],l[c++]=y[1]):x===an.INTERSECTING?(l[c++]=y[0],l[c++]=y[1],E=!1):E=!0,f=y[0],m=y[1],C=x;return(s&&E||I===t+r)&&(l[c++]=f,l[c++]=m),c}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const c=i[o],h=this.appendFlatLineCoordinates(e,t,c,r,!1,!1);s.push(h),t=c}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),c=this.coordinates.length;let h,f,m,y,E;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),y=[];const I=e.getEndss();E=0;for(let C=0,x=I.length;C<x;++C){const b=[];E=this.drawCustomCoordinates_(h,E,I[C],l,b),y.push(b)}this.instructions.push([Se.CUSTOM,c,y,e,i,wS,s]),this.hitDetectionInstructions.push([Se.CUSTOM,c,y,e,r||i,wS,s]);break;case"Polygon":case"MultiLineString":m=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),E=this.drawCustomCoordinates_(h,0,e.getEnds(),l,m),this.instructions.push([Se.CUSTOM,c,m,e,i,Dp,s]),this.hitDetectionInstructions.push([Se.CUSTOM,c,m,e,r||i,Dp,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Se.CUSTOM,c,f,e,i,Wu,s]),this.hitDetectionInstructions.push([Se.CUSTOM,c,f,e,r||i,Wu,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>c&&(this.instructions.push([Se.CUSTOM,c,f,e,i,Wu,s]),this.hitDetectionInstructions.push([Se.CUSTOM,c,f,e,r||i,Wu,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Se.CUSTOM,c,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Se.CUSTOM,c,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Se.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Se.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Se.END_GEOMETRY?o=t:s==Se.BEGIN_GEOMETRY&&(r[2]=t,a3(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Yr(i||ti)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Yr(i||xd);const r=e.getLineCap();t.lineCap=r!==void 0?r:cc;const s=e.getLineDash();t.lineDash=s?s.slice():Gs;const o=e.getLineDashOffset();t.lineDashOffset=o||Ws;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:hc;const c=e.getWidth();t.lineWidth=c!==void 0?c:Id;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Ed,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Se.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Se.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,c=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!oa(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=c||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=c,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Se.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=YP(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Zw(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class mj extends tf{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!oc(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Se.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Se.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let c=0,h=r.length;c<h;c+=e.getStride())(!this.maxExtent||oc(this.maxExtent,r.slice(c,c+2)))&&s.push(r[c],r[c+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Se.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Se.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class yj extends tf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Se.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws],el);const l=e.getFlatCoordinates(),c=e.getStride();this.drawFlatCoordinates_(l,0,l.length,c),this.hitDetectionInstructions.push(Go),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws],el);const l=e.getEnds(),c=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let m=0,y=l.length;m<y;++m)f=this.drawFlatCoordinates_(c,f,l[m],h);this.hitDetectionInstructions.push(Go),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Go),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Go),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(el)}}class US extends tf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,c=i.length;this.instructions.push(el),this.hitDetectionInstructions.push(el);for(let h=0;h<c;++h){const f=i[h],m=this.coordinates.length,y=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),E=[Se.MOVE_TO_LINE_TO,m,y];this.instructions.push(E),this.hitDetectionInstructions.push(E),l&&(this.instructions.push(jS),this.hitDetectionInstructions.push(jS)),t=f}return o&&(this.instructions.push(Vg),this.hitDetectionInstructions.push(Vg)),l&&(this.instructions.push(Go),this.hitDetectionInstructions.push(Go)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getFlatCoordinates(),c=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,c,!1,!1);const f=[Se.CIRCLE,h];this.instructions.push(el,f),this.hitDetectionInstructions.push(el,f),r.fillStyle!==void 0&&(this.instructions.push(Vg),this.hitDetectionInstructions.push(Vg)),r.strokeStyle!==void 0&&(this.instructions.push(Go),this.hitDetectionInstructions.push(Go)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getEnds(),c=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(c,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Gs,Ws]);const l=e.getEndss(),c=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let m=0,y=l.length;m<y;++m)f=this.drawFlatCoordinatess_(c,f,l[m],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Ua(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function _j(n,e,t,i,r){const s=[];let o=t,l=0,c=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=c.slice(-2),m=e[o+r],y=e[o+r+1],E=Math.sqrt((m-h)*(m-h)+(y-f)*(y-f));if(l+=E,l>=n){const I=(n-l+E)/E,C=vi(h,m,I),x=vi(f,y,I);c.push(C,x),s.push(c),c=[C,x],l==n&&(o+=r),l=0}else if(l<n)c.push(e[o+r],e[o+r+1]),o+=r;else{const I=E-l,C=vi(h,m,I/E),x=vi(f,y,I/E);c.push(C,x),s.push(c),c=[C,x],l=0,o+=r}}return l>0&&s.push(c),s}function vj(n,e,t,i,r){let s=t,o=t,l=0,c=0,h=t,f,m,y,E,I,C,x,b,D,L;for(m=t;m<i;m+=r){const O=e[m],F=e[m+1];I!==void 0&&(D=O-I,L=F-C,E=Math.sqrt(D*D+L*L),x!==void 0&&(c+=y,f=Math.acos((x*D+b*L)/(y*E)),f>n&&(c>l&&(l=c,s=h,o=m),c=0,h=m-r)),y=E,x=D,b=L),I=O,C=F}return c+=E,c>l?[h,m]:[s,o]}const Op={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class wj extends tf{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ti]={fillStyle:ti},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let c=l.length;const h=e.getType();let f=null,m=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!ii(this.maxExtent,e.getExtent()))return;let y;if(f=e.getFlatCoordinates(),h=="LineString")y=[f.length];else if(h=="MultiLineString")y=e.getEnds();else if(h=="Polygon")y=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const x=e.getEndss();y=[];for(let b=0,D=x.length;b<D;++b)y.push(x[b][0])}this.beginGeometry(e,t,i);const E=o.repeat,I=E?void 0:o.textAlign;let C=0;for(let x=0,b=y.length;x<b;++x){let D;E?D=_j(E*this.resolution,f,C,y[x],m):D=[f.slice(C,y[x])];for(let L=0,O=D.length;L<O;++L){const F=D[L];let W=0,P=F.length;if(I==null){const k=vj(o.maxAngle,F,0,F.length,2);W=k[0],P=k[1]}for(let k=W;k<P;k+=m)l.push(F[k],F[k+1]);const R=l.length;C=y[x],this.drawChars_(c,R),c=R}}this.endGeometry(t)}else{let y=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),m=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||y.push(f[2]/this.resolution),m=3;break;case"MultiPolygon":const O=e.getFlatInteriorPoints();f=[];for(let F=0,W=O.length;F<W;F+=3)o.overflow||y.push(O[F+2]/this.resolution),f.push(O[F],O[F+1]);if(f.length===0)return;m=2;break}const E=this.appendFlatPointCoordinates(f,m);if(E===c)return;if(y&&(E-c)/2!==f.length/m){let O=c/2;y=y.filter((F,W)=>{const P=l[(O+W)*2]===f[W*m]&&l[(O+W)*2+1]===f[W*m+1];return P||--O,P})}this.saveTextStates_();const I=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,C=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let x=o.padding;if(x!=Ja&&(o.scale[0]<0||o.scale[1]<0)){let O=o.padding[0],F=o.padding[1],W=o.padding[2],P=o.padding[3];o.scale[0]<0&&(F=-F,P=-P),o.scale[1]<0&&(O=-O,W=-W),x=[O,F,W,P]}const b=this.pixelRatio;this.instructions.push([Se.DRAW_IMAGE,c,E,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,x==Ja?Ja:x.map(function(O){return O*b}),I,C,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]);const D=1/b,L=I?I.slice(0):null;L&&(L[1]=ti),this.hitDetectionInstructions.push([Se.DRAW_IMAGE,c,E,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[D,D],NaN,this.declutterMode_,this.declutterImageWithText_,x,L,C,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ti:this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Td,justify:t.justify,textBaseline:t.textBaseline||Lp,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const c=this.pixelRatio,h=Op[r.textBaseline],f=this.textOffsetY_*c,m=this.text_,y=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Se.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,c,f,s,y*c,m,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Se.DRAW_CHARS,e,t,h,r.overflow,l&&ti,r.maxAngle,c,f,s,y*c,m,o,1/c,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Yr(o.getColor()||ti)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const C=l.getLineDash(),x=l.getLineDashOffset(),b=l.getWidth(),D=l.getMiterLimit();s.lineCap=l.getLineCap()||cc,s.lineDash=C?C.slice():Gs,s.lineDashOffset=x===void 0?Ws:x,s.lineJoin=l.getLineJoin()||hc,s.lineWidth=b===void 0?Id:b,s.miterLimit=D===void 0?Ed:D,s.strokeStyle=Yr(l.getColor()||xd)}i=this.textState_;const c=e.getFont()||kb;V4(c);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=c,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Lp,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||Ja,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),m=e.getOffsetY(),y=e.getRotateWithView(),E=e.getKeepUpright(),I=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=m===void 0?0:m,this.textRotateWithView_=y===void 0?!1:y,this.textKeepUpright_=E===void 0?!0:E,this.textRotation_=I===void 0?0:I,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:nt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+nt(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const Ej={Circle:US,Default:tf,Image:mj,LineString:yj,Polygon:US,Text:wj};class xj{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=Ej[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function Tj(n,e,t,i,r,s,o,l,c,h,f,m,y=!0){let E=n[e],I=n[e+1],C=0,x=0,b=0,D=0;function L(){C=E,x=I,e+=i,E=n[e],I=n[e+1],D+=b,b=Math.sqrt((E-C)*(E-C)+(I-x)*(I-x))}do L();while(e<t-i&&D+b<s);let O=b===0?0:(s-D)/b;const F=vi(C,E,O),W=vi(x,I,O),P=e-i,R=D,k=s+l*c(h,r,f);for(;e<t-i&&D+b<k;)L();O=b===0?0:(k-D)/b;const V=vi(C,E,O),j=vi(x,I,O);let z=!1;if(y)if(m){const ce=[F,W,V,j];pb(ce,0,4,2,m,ce,ce),z=ce[0]>ce[2]}else z=F>V;const N=Math.PI,le=[],me=P+i===e;e=P,b=0,D=R,E=n[e],I=n[e+1];let fe;if(me){L(),fe=Math.atan2(I-x,E-C),z&&(fe+=fe>0?-N:N);const ce=(V+F)/2,ee=(j+W)/2;return le[0]=[ce,ee,(k-s)/2,fe,r],le}r=r.replace(/\n/g," ");for(let ce=0,ee=r.length;ce<ee;){L();let oe=Math.atan2(I-x,E-C);if(z&&(oe+=oe>0?-N:N),fe!==void 0){let Ie=oe-fe;if(Ie+=Ie>N?-2*N:Ie<-N?2*N:0,Math.abs(Ie)>o)return null}fe=oe;const ne=ce;let G=0;for(;ce<ee;++ce){const Ie=z?ee-ce-1:ce,be=l*c(h,r[Ie],f);if(e+i<t&&D+b<s+G+be/2)break;G+=be}if(ce===ne)continue;const $=z?r.substring(ee-ne,ee-ce):r.substring(ne,ce);O=b===0?0:(s+G/2-D)/b;const xe=vi(C,E,O),Te=vi(x,I,O);le.push([xe,Te,G/2,oe,$]),s+=G}return le}class Wb{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Mp(),{get:(e,t)=>{if(typeof Mp()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const vu=Zi(),Io=[],ks=[],Ds=[],So=[];function zS(n){return n[3].declutterBox}const BS=new RegExp("[-----]");function g0(n,e){return e==="start"?e=BS.test(n)?"right":"left":e==="end"&&(e=BS.test(n)?"left":"right"),Op[e]}function Ij(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function Sj(n,e,t){return t%2===0&&(n+=e),n}class Cj{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=wr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Wb:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,c=this.textStates[t],h=this.pixelRatio,f=[c.scale[0]*h,c.scale[1]*h],m=c.justify?Op[c.justify]:g0(Array.isArray(e)?e[0]:e,c.textAlign||Td),y=r&&o.lineWidth?o.lineWidth:0,E=Array.isArray(e)?e:String(e).split(`
`).reduce(Ij,[]),{width:I,height:C,widths:x,heights:b,lineWidths:D}=j4(c,E),L=I+y,O=[],F=(L+2)*f[0],W=(C+y)*f[1],P={width:F<0?Math.floor(F):Math.ceil(F),height:W<0?Math.floor(W):Math.ceil(W),contextInstructions:O};(f[0]!=1||f[1]!=1)&&O.push("scale",f),r&&(O.push("strokeStyle",o.strokeStyle),O.push("lineWidth",y),O.push("lineCap",o.lineCap),O.push("lineJoin",o.lineJoin),O.push("miterLimit",o.miterLimit),O.push("setLineDash",[o.lineDash]),O.push("lineDashOffset",o.lineDashOffset)),i&&O.push("fillStyle",l.fillStyle),O.push("textBaseline","middle"),O.push("textAlign","center");const R=.5-m;let k=m*L+R*y;const V=[],j=[];let z=0,N=0,le=0,me=0,fe;for(let ce=0,ee=E.length;ce<ee;ce+=2){const oe=E[ce];if(oe===`
`){N+=z,z=0,k=m*L+R*y,++me;continue}const ne=E[ce+1]||c.font;ne!==fe&&(r&&V.push("font",ne),i&&j.push("font",ne),fe=ne),z=Math.max(z,b[le]);const G=[oe,k+R*x[le]+m*(x[le]-D[me]),.5*(y+z)+N];k+=x[le],r&&V.push("strokeText",G),i&&j.push("fillText",G),++le}return Array.prototype.push.apply(O,V),Array.prototype.push.apply(O,j),this.labels_[s]=P,P}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,c,h,f,m,y,E,I,C,x){l*=y[0],c*=y[1];let b=i-l,D=r-c;const L=s+h>e?e-h:s,O=o+f>t?t-f:o,F=I[3]+L*y[0]+I[1],W=I[0]+O*y[1]+I[2],P=b-I[3],R=D-I[0];(C||m!==0)&&(Io[0]=P,So[0]=P,Io[1]=R,ks[1]=R,ks[0]=P+F,Ds[0]=ks[0],Ds[1]=R+W,So[1]=Ds[1]);let k;return m!==0?(k=Hs(wr(),i,r,1,1,m,-i,-r),cn(k,Io),cn(k,ks),cn(k,Ds),cn(k,So),Jo(Math.min(Io[0],ks[0],Ds[0],So[0]),Math.min(Io[1],ks[1],Ds[1],So[1]),Math.max(Io[0],ks[0],Ds[0],So[0]),Math.max(Io[1],ks[1],Ds[1],So[1]),vu)):Jo(Math.min(P,P+F),Math.min(R,R+W),Math.max(P,P+F),Math.max(R,R+W),vu),E&&(b=Math.round(b),D=Math.round(D)),{drawImageX:b,drawImageY:D,drawImageW:L,drawImageH:O,originX:h,originY:f,declutterBox:{minX:vu[0],minY:vu[1],maxX:vu[2],maxY:vu[3],value:x},canvasTransform:k,scale:y}}replayImageOrLabel_(e,t,i,r,s,o,l){const c=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(c&&this.replayTextBackground_(e,Io,ks,Ds,So,o,l),U4(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=cn(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],c=this.pixelRatio,h=g0(Array.isArray(e)?e[0]:e,s.textAlign||Td),f=Op[s.textBaseline||Lp],m=l&&l.lineWidth?l.lineWidth:0,y=o.width/c-2*s.scale[0],E=h*y+2*(.5-h)*m,I=f*o.height/c+2*(.5-f)*m;return{label:o,anchorX:E,anchorY:I}}execute_(e,t,i,r,s,o,l,c){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&oa(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=$o(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Q3(this.renderedTransform_,i));let m=0;const y=r.length;let E=0,I,C,x,b,D,L,O,F,W,P,R,k,V,j=0,z=0;const N=this.coordinateCache_,le=this.viewRotation_,me=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,fe={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:le},ce=this.instructions!=r||this.overlaps?0:200;let ee,oe,ne,G;for(;m<y;){const $=r[m];switch($[0]){case Se.BEGIN_GEOMETRY:ee=$[1],G=$[3],ee.getGeometry()?l!==void 0&&!ii(l,G.getExtent())?m=$[2]+1:++m:m=$[2],h&&(h.zIndex=$[4]);break;case Se.BEGIN_PATH:j>ce&&(this.fill_(e),j=0),z>ce&&(e.stroke(),z=0),!j&&!z&&(e.beginPath(),D=NaN,L=NaN),++m;break;case Se.CIRCLE:E=$[1];const Te=f[E],Ie=f[E+1],be=f[E+2],Me=f[E+3],Ve=be-Te,Be=Me-Ie,lt=Math.sqrt(Ve*Ve+Be*Be);e.moveTo(Te+lt,Ie),e.arc(Te,Ie,lt,0,2*Math.PI,!0),++m;break;case Se.CLOSE_PATH:e.closePath(),++m;break;case Se.CUSTOM:E=$[1],I=$[2];const Qi=$[3],fs=$[4],Wn=$[5];fe.geometry=Qi,fe.feature=ee,m in N||(N[m]=[]);const Kn=N[m];Wn?Wn(f,E,I,2,Kn):(Kn[0]=f[E],Kn[1]=f[E+1],Kn.length=2),h&&(h.zIndex=$[6]),fs(Kn,fe),++m;break;case Se.DRAW_IMAGE:E=$[1],I=$[2],W=$[3],C=$[4],x=$[5];let hn=$[6];const dn=$[7],$n=$[8],Ci=$[9],yt=$[10];let ut=$[11];const tn=$[12];let Ri=$[13];b=$[14]||"declutter";const It=$[15];if(!W&&$.length>=20){P=$[19],R=$[20],k=$[21],V=$[22];const Ot=this.drawLabelWithPointPlacement_(P,R,k,V);W=Ot.label,$[3]=W;const bi=$[23];C=(Ot.anchorX-bi)*this.pixelRatio,$[4]=C;const fn=$[24];x=(Ot.anchorY-fn)*this.pixelRatio,$[5]=x,hn=W.height,$[6]=hn,Ri=W.width,$[13]=Ri}let Js;$.length>25&&(Js=$[25]);let Ai,Sr,Ji;$.length>17?(Ai=$[16],Sr=$[17],Ji=$[18]):(Ai=Ja,Sr=null,Ji=null),yt&&me?ut+=le:!yt&&!me&&(ut-=le);let Cr=0;for(;E<I;E+=2){if(Js&&Js[Cr++]<Ri/this.pixelRatio)continue;const Ot=this.calculateImageOrLabelDimensions_(W.width,W.height,f[E],f[E+1],Ri,hn,C,x,$n,Ci,ut,tn,s,Ai,!!Sr||!!Ji,ee),bi=[e,t,W,Ot,dn,Sr,Ji];if(c){let fn,Vt,gn;if(It){const rt=I-E;if(!It[rt]){It[rt]={args:bi,declutterMode:b};continue}const Bt=It[rt];fn=Bt.args,Vt=Bt.declutterMode,delete It[rt],gn=zS(fn)}let pn,nn;if(fn&&(Vt!=="declutter"||!c.collides(gn))&&(pn=!0),(b!=="declutter"||!c.collides(Ot.declutterBox))&&(nn=!0),Vt==="declutter"&&b==="declutter"){const rt=pn&&nn;pn=rt,nn=rt}pn&&(Vt!=="none"&&c.insert(gn),this.replayImageOrLabel_.apply(this,fn)),nn&&(b!=="none"&&c.insert(Ot.declutterBox),this.replayImageOrLabel_.apply(this,bi))}else this.replayImageOrLabel_.apply(this,bi)}++m;break;case Se.DRAW_CHARS:const ua=$[1],Rr=$[2],Pi=$[3],Ll=$[4];V=$[5];const Ar=$[6],gs=$[7],eo=$[8];k=$[9];const On=$[10];P=$[11],Array.isArray(P)&&(P=P.reduce(Sj,"")),R=$[12];const ps=[$[13],$[13]];b=$[14]||"declutter";const Pr=$[15],br=this.textStates[R],Vn=br.font,Fn=[br.scale[0]*gs,br.scale[1]*gs];let ft;Vn in this.widths_?ft=this.widths_[Vn]:(ft={},this.widths_[Vn]=ft);const to=d4(f,ua,Rr,2),er=Math.abs(Fn[0])*AS(Vn,P,ft);if(Ll||er<=to){const Ot=this.textStates[R].textAlign,bi=(to-er)*g0(P,Ot),fn=Tj(f,ua,Rr,2,P,bi,Ar,Math.abs(Fn[0]),AS,Vn,ft,me?0:this.viewRotation_,Pr);e:if(fn){const Vt=[];let gn,pn,nn,rt,Bt;if(k)for(gn=0,pn=fn.length;gn<pn;++gn){Bt=fn[gn],nn=Bt[4],rt=this.createLabel(nn,R,"",k),C=Bt[2]+(Fn[0]<0?-On:On),x=Pi*rt.height+(.5-Pi)*2*On*Fn[1]/Fn[0]-eo;const Xt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Bt[0],Bt[1],rt.width,rt.height,C,x,0,0,Bt[3],ps,!1,Ja,!1,ee);if(c&&b==="declutter"&&c.collides(Xt.declutterBox))break e;Vt.push([e,t,rt,Xt,1,null,null])}if(V)for(gn=0,pn=fn.length;gn<pn;++gn){Bt=fn[gn],nn=Bt[4],rt=this.createLabel(nn,R,V,""),C=Bt[2],x=Pi*rt.height-eo;const Xt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Bt[0],Bt[1],rt.width,rt.height,C,x,0,0,Bt[3],ps,!1,Ja,!1,ee);if(c&&b==="declutter"&&c.collides(Xt.declutterBox))break e;Vt.push([e,t,rt,Xt,1,null,null])}c&&b!=="none"&&c.load(Vt.map(zS));for(let Xt=0,ki=Vt.length;Xt<ki;++Xt)this.replayImageOrLabel_.apply(this,Vt[Xt])}}++m;break;case Se.END_GEOMETRY:if(o!==void 0){ee=$[1];const Ot=o(ee,G,b);if(Ot)return Ot}++m;break;case Se.FILL:ce?j++:this.fill_(e),++m;break;case Se.MOVE_TO_LINE_TO:for(E=$[1],I=$[2],oe=f[E],ne=f[E+1],e.moveTo(oe,ne),D=oe+.5|0,L=ne+.5|0,E+=2;E<I;E+=2)oe=f[E],ne=f[E+1],O=oe+.5|0,F=ne+.5|0,(E==I-2||O!==D||F!==L)&&(e.lineTo(oe,ne),D=O,L=F);++m;break;case Se.SET_FILL_STYLE:this.alignAndScaleFill_=$[2],j&&(this.fill_(e),j=0,z&&(e.stroke(),z=0)),e.fillStyle=$[1],++m;break;case Se.SET_STROKE_STYLE:z&&(e.stroke(),z=0),this.setStrokeStyle_(e,$),++m;break;case Se.STROKE:ce?z++:e.stroke(),++m;break;default:++m;break}}j&&this.fill_(e),z&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Ka=["Polygon","Circle","LineString","Image","Text","Default"],Kb=["Image","Text"],Rj=Ka.filter(n=>!Kb.includes(n));class Aj{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=wr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new Cj(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,c=Hs(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Qt(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let m;this.renderBuffer_!==void 0&&(m=Zi(),Jh(m,e),Zw(m,t*(this.renderBuffer_+r),m));const y=Pj(r);let E;function I(F,W,P){const R=f.getImageData(0,0,l,l).data;for(let k=0,V=y.length;k<V;k++)if(R[y[k]]>0){if(!o||P==="none"||E!=="Image"&&E!=="Text"||o.includes(F)){const j=(y[k]-3)/4,z=r-j%l,N=r-(j/l|0),le=s(F,W,z*z+N*N);if(le)return le}f.clearRect(0,0,l,l);break}}const C=Object.keys(this.executorsByZIndex_).map(Number);C.sort(Bs);let x,b,D,L,O;for(x=C.length-1;x>=0;--x){const F=C[x].toString();for(D=this.executorsByZIndex_[F],b=Ka.length-1;b>=0;--b)if(E=Ka[b],L=D[E],L!==void 0&&(O=L.executeHitDetection(f,c,i,I,m),O))return O}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return $o(l,0,8,2,e,l),l}isEmpty(){return rc(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const c=Object.keys(this.executorsByZIndex_).map(Number);c.sort(l?o3:Bs),o=o||Ka;const h=Ka.length;for(let f=0,m=c.length;f<m;++f){const y=c[f].toString(),E=this.executorsByZIndex_[y];for(let I=0,C=o.length;I<C;++I){const x=o[I],b=E[x];if(b!==void 0){const D=l===null?void 0:b.getZIndexContext(),L=D?D.getContext():e,O=this.maxExtent_&&x!=="Image"&&x!=="Text";if(O&&(L.save(),this.clip(L,i)),!D||x==="Text"||x==="Image"?b.execute(L,t,i,r,s,l):D.pushFunction(F=>b.execute(F,t,i,r,s,l)),O&&L.restore(),D){D.offset();const F=c[f]*h+Ka.indexOf(x);this.deferredZIndexContexts_[F]||(this.deferredZIndexContexts_[F]=[]),this.deferredZIndexContexts_[F].push(D)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Bs);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const p0={};function Pj(n){if(p0[n]!==void 0)return p0[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let c=i[l];c||(c=[],i[l]=c),c.push(((n+s)*e+(n+o))*4+3),s>0&&c.push(((n-s)*e+(n+o))*4+3),o>0&&(c.push(((n+s)*e+(n-o))*4+3),s>0&&c.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return p0[n]=r,r}function GS(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let _E=class $b extends Nm{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;at(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||nt(o)),at(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),at(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let c;if(e.src!==void 0?c=Ue.IDLE:o!==void 0&&("complete"in o?o.complete?c=o.src?Ue.LOADED:Ue.IDLE:c=Ue.LOADING:c=Ue.LOADED),this.color_=e.color!==void 0?uc(e.color):null,this.iconImage_=Np(o,l,this.crossOrigin_,c,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const m=this.getImage(1);if(m.width&&m.height)h=m.width,f=m.height;else if(m instanceof HTMLImageElement){this.initialOptions_=e;const y=()=>{if(this.unlistenImageChange(y),!this.initialOptions_)return;const E=this.iconImage_.getSize();this.setScale(GS(E[0],E[1],e.width,e.height))};this.listenImageChange(y);return}}h!==void 0&&this.setScale(GS(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new $b({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=Np(null,e,this.crossOrigin_,Ue.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Ue.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Ue.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(ze.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(ze.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Xr=.5;function bj(n,e,t,i,r,s,o,l,c){const h=r,f=n[0]*Xr,m=n[1]*Xr,y=Qt(f,m);y.imageSmoothingEnabled=!1;const E=y.canvas,I=new B4(y,Xr,r,null,o,l,null),C=t.length,x=Math.floor((256*256*256-1)/C),b={};for(let L=1;L<=C;++L){const O=t[L-1],F=O.getStyleFunction()||i;if(!F)continue;let W=F(O,s);if(!W)continue;Array.isArray(W)||(W=[W]);const R=(L*x).toString(16).padStart(7,"#00000");for(let k=0,V=W.length;k<V;++k){const j=W[k],z=j.getGeometryFunction()(O);if(!z||!ii(h,z.getExtent()))continue;const N=j.clone(),le=N.getFill();le&&le.setColor(R);const me=N.getStroke();me&&(me.setColor(R),me.setLineDash(null)),N.setText(void 0);const fe=j.getImage();if(fe){const ne=fe.getImageSize();if(!ne)continue;const G=Qt(ne[0],ne[1],void 0,{alpha:!1}),$=G.canvas;G.fillStyle=R,G.fillRect(0,0,$.width,$.height),N.setImage(new _E({img:$,anchor:fe.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:fe.getOrigin(),opacity:1,size:fe.getSize(),scale:fe.getScale(),rotation:fe.getRotation(),rotateWithView:fe.getRotateWithView()}))}const ce=N.getZIndex()||0;let ee=b[ce];ee||(ee={},b[ce]=ee,ee.Polygon=[],ee.Circle=[],ee.LineString=[],ee.Point=[]);const oe=z.getType();if(oe==="GeometryCollection"){const ne=z.getGeometriesArrayRecursive();for(let G=0,$=ne.length;G<$;++G){const xe=ne[G];ee[xe.getType().replace("Multi","")].push(xe,N)}}else ee[oe.replace("Multi","")].push(z,N)}}const D=Object.keys(b).map(Number).sort(Bs);for(let L=0,O=D.length;L<O;++L){const F=b[D[L]];for(const W in F){const P=F[W];for(let R=0,k=P.length;R<k;R+=2){I.setStyle(P[R+1]);for(let V=0,j=e.length;V<j;++V)I.setTransform(e[V]),I.drawGeometry(P[R])}}}return y.getImageData(0,0,E.width,E.height)}function kj(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Xr),s=Math.floor(Math.round(n[1])*Xr),o=(Dt(r,0,t.width-1)+Dt(s,0,t.height-1)*t.width)*4,l=t.data[o],c=t.data[o+1],f=t.data[o+2]+256*(c+256*l),m=Math.floor((256*256*256-1)/e.length);f&&f%m===0&&i.push(e[f/m-1])}return i}class Hb extends Ys{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const Dj=5;class Mj extends Yd{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=Dj}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return et()}getData(e){return null}prepareFrame(e){return et()}renderFrame(e,t){return et()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Ue.LOADED||t.getState()===Ue.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Ue.LOADED&&t!=Ue.ERROR&&e.addEventListener(ze.CHANGE,this.boundHandleImageChange_),t==Ue.IDLE&&(e.load(),t=e.getState()),t==Ue.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const WS=[];let Du=null;function Nj(){Du=Qt(1,1,void 0,{willReadFrequently:!0})}class Xb extends Mj{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=wr(),this.pixelTransform=wr(),this.inversePixelTransform=wr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Du||Nj(),Du.clearRect(0,0,1,1);let r;try{Du.drawImage(e,t,i,1,1,0,0,1,1),r=Du.getImageData(0,0,1,1).data}catch{return Du=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&oa(uc(e.style.backgroundColor),uc(i)))){const l=e.firstElementChild;Bo(l)&&(o=l.getContext("2d"))}if(o&&n4(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Ei?Rb():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Qt();const c=o.canvas;s.appendChild(c),l=c.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Pl(i),s=Am(i),o=Rm(i),l=Cm(i);cn(t.coordinateToPixelTransform,r),cn(t.coordinateToPixelTransform,s),cn(t.coordinateToPixelTransform,o),cn(t.coordinateToPixelTransform,l);const c=this.inversePixelTransform;cn(c,r),cn(c,s),cn(c,o),cn(c,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(dt(i)/r*o),c=Math.round(Bn(i)/r*o);Hs(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-c/2),gb(this.inversePixelTransform,this.pixelTransform);const h=t4(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=c?(f.width=l,f.height=c):this.context.clearRect(0,0,l,c),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new Hb(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_($i.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_($i.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Wb),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_($i.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_($i.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const c=s/2,h=o/2,f=r/t,m=-f,y=-e[0]+l,E=-e[1];return Hs(this.tempTransform,c,h,f,m,-i,y,E)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class Lj extends Xb{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Zi(),this.wrappedRenderedExtent_=Zi(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,c=s.projection,h=s.rotation,f=c.getExtent(),m=this.getLayer().getSource(),y=this.getLayer().getDeclutter(),E=t.pixelRatio,I=t.viewHints,C=!(I[Nn.ANIMATING]||I[Nn.INTERACTING]),x=this.context,b=Math.round(dt(r)/l*E),D=Math.round(Bn(r)/l*E),L=m.getWrapX()&&c.canWrapX(),O=L?dt(f):null,F=L?Math.ceil((r[2]-f[2])/O)+1:1;let W=L?Math.floor((r[0]-f[0])/O):0;do{let P=this.getRenderTransform(o,l,0,E,b,D,W*O);t.declutter&&(P=P.slice(0)),e.execute(x,[x.canvas.width,x.canvas.height],P,h,C,i===void 0?Ka:i?Kb:Rj,i?y&&t.declutter[y]:void 0)}while(++W<F)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Qt(this.context.canvas.width,this.context.canvas.height,WS))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Mm(this.context),WS.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener($i.PRERENDER)||this.getLayer().hasListener($i.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const c=zo(i.extent);l=ii(c,e.extent),this.clipped_=l&&!Uh(c,e.extent),this.clipped_&&this.clipUnrotated(s,e,c)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,c=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],m=i[0]*Xr,y=i[1]*Xr;f.push(this.getRenderTransform(r,s,o,Xr,m,y,0).slice());const E=h.getSource(),I=l.getExtent();if(E.getWrapX()&&l.canWrapX()&&!Uh(I,c)){let C=c[0];const x=dt(I);let b=0,D;for(;C<I[0];)--b,D=x*b,f.push(this.getRenderTransform(r,s,o,Xr,m,y,D).slice()),C+=x;for(b=0,C=c[2];C>I[2];)++b,D=x*b,f.push(this.getRenderTransform(r,s,o,Xr,m,y,D).slice()),C-=x}this.hitDetectionImageData_=bj(i,f,this.renderedFeatures_,h.getStyleFunction(),c,s,o,PS(s,this.renderedPixelRatio_))}t(kj(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,c=this.getLayer(),h={},f=function(y,E,I){const C=nt(y),x=h[C];if(x){if(x!==!0&&I<x.distanceSq){if(I===0)return h[C]=!0,s.splice(s.lastIndexOf(x),1),r(y,c,E);x.geometry=E,x.distanceSq=I}}else{if(I===0)return h[C]=!0,r(y,c,E);s.push(h[C]={feature:y,layer:c,geometry:E,distanceSq:I,callback:r})}},m=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,m?t.declutter?.[m]?.all().map(y=>y.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Nn.ANIMATING],s=e.viewHints[Nn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const c=e.extent,h=e.viewState,f=h.projection,m=h.resolution,y=e.pixelRatio,E=t.getRevision(),I=t.getRenderBuffer();let C=t.getRenderOrder();C===void 0&&(C=W4);const x=h.center.slice(),b=Zw(c,I*m),D=b.slice(),L=[b.slice()],O=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Uh(O,e.extent)){const le=dt(O),me=Math.max(dt(b)/2,le);b[0]=O[0]-me,b[2]=O[2]+me,sb(x,f);const fe=ib(L[0],f);fe[0]<O[0]&&fe[2]<O[2]?L.push([fe[0]+le,fe[1],fe[2]+le,fe[3]]):fe[0]>O[0]&&fe[2]>O[2]&&L.push([fe[0]-le,fe[1],fe[2]-le,fe[3]])}if(this.ready&&this.renderedResolution_==m&&this.renderedRevision_==E&&this.renderedRenderOrder_==C&&this.renderedFrameDeclutter_===!!e.declutter&&Uh(this.wrappedRenderedExtent_,b))return oa(this.renderedExtent_,D)||(this.hitDetectionImageData_=null,this.renderedExtent_=D),this.renderedCenter_=x,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const F=new xj(Lb(m,y),b,m,y);let W;for(let le=0,me=L.length;le<me;++le)i.loadFeatures(L[le],m,f);const P=PS(m,y);let R=!0;const k=(le,me)=>{let fe;const ce=le.getStyleFunction()||t.getStyleFunction();if(ce&&(fe=ce(le,m)),fe){const ee=this.renderFeature(le,P,fe,F,W,this.getLayer().getDeclutter(),me);R=R&&!ee}},V=fb(b),j=i.getFeaturesInExtent(V);C&&j.sort(C);for(let le=0,me=j.length;le<me;++le)k(j[le],le);this.renderedFeatures_=j,this.ready=R;const z=F.finish(),N=new Aj(b,m,y,i.getOverlaps(),z,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=m,this.renderedRevision_=E,this.renderedRenderOrder_=C,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=D,this.wrappedRenderedExtent_=b,this.renderedCenter_=x,this.renderedProjection_=f,this.renderedPixelRatio_=y,this.replayGroup_=N,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let c=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)c=bS(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||c;else c=bS(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return c}}let kl=0;const zn=1<<kl++,Xe=1<<kl++,ni=1<<kl++,fr=1<<kl++,yl=1<<kl++,Gh=1<<kl++,Fg=Math.pow(2,kl)-1,vE={[zn]:"boolean",[Xe]:"number",[ni]:"string",[fr]:"color",[yl]:"number[]",[Gh]:"size"},Oj=Object.keys(vE).map(Number).sort(Bs);function Vj(n){return n in vE}function Wh(n){const e=[];for(const t of Oj)Kh(n,t)&&e.push(vE[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Kh(n,e){return(n&e)===e}function Co(n,e){return n===e}class Zt{constructor(e,t){if(!Vj(e))throw new Error(`literal expressions must have a specific type, got ${Wh(e)}`);this.type=e,this.value=t}}class Fj{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function qb(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Sn(n,e,t){switch(typeof n){case"boolean":{if(Co(e,ni))return new Zt(ni,n?"true":"false");if(!Kh(e,zn))throw new Error(`got a boolean, but expected ${Wh(e)}`);return new Zt(zn,n)}case"number":{if(Co(e,Gh))return new Zt(Gh,si(n));if(Co(e,zn))return new Zt(zn,!!n);if(Co(e,ni))return new Zt(ni,n.toString());if(!Kh(e,Xe))throw new Error(`got a number, but expected ${Wh(e)}`);return new Zt(Xe,n)}case"string":{if(Co(e,fr))return new Zt(fr,dE(n));if(Co(e,zn))return new Zt(zn,!!n);if(!Kh(e,ni))throw new Error(`got a string, but expected ${Wh(e)}`);return new Zt(ni,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return qj(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Co(e,Gh)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Zt(Gh,n)}if(Co(e,fr)){if(n.length===3)return new Zt(fr,[...n,1]);if(n.length===4)return new Zt(fr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Kh(e,yl))throw new Error(`got an array of numbers, but expected ${Wh(e)}`);return new Zt(yl,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},jj={[te.Get]:Le(je(1,1/0),KS),[te.Var]:Le(je(1,1),Uj),[te.Has]:Le(je(1,1/0),KS),[te.Id]:Le(zj,wu),[te.Concat]:Le(je(2,1/0),ot(ni)),[te.GeometryType]:Le(Bj,wu),[te.LineMetric]:Le(wu),[te.Resolution]:Le(m0,wu),[te.Zoom]:Le(m0,wu),[te.Time]:Le(m0,wu),[te.Any]:Le(je(2,1/0),ot(zn)),[te.All]:Le(je(2,1/0),ot(zn)),[te.Not]:Le(je(1,1),ot(zn)),[te.Equal]:Le(je(2,2),ot(Fg)),[te.NotEqual]:Le(je(2,2),ot(Fg)),[te.GreaterThan]:Le(je(2,2),ot(Xe)),[te.GreaterThanOrEqualTo]:Le(je(2,2),ot(Xe)),[te.LessThan]:Le(je(2,2),ot(Xe)),[te.LessThanOrEqualTo]:Le(je(2,2),ot(Xe)),[te.Multiply]:Le(je(2,1/0),$S),[te.Coalesce]:Le(je(2,1/0),$S),[te.Divide]:Le(je(2,2),ot(Xe)),[te.Add]:Le(je(2,1/0),ot(Xe)),[te.Subtract]:Le(je(2,2),ot(Xe)),[te.Clamp]:Le(je(3,3),ot(Xe)),[te.Mod]:Le(je(2,2),ot(Xe)),[te.Pow]:Le(je(2,2),ot(Xe)),[te.Abs]:Le(je(1,1),ot(Xe)),[te.Floor]:Le(je(1,1),ot(Xe)),[te.Ceil]:Le(je(1,1),ot(Xe)),[te.Round]:Le(je(1,1),ot(Xe)),[te.Sin]:Le(je(1,1),ot(Xe)),[te.Cos]:Le(je(1,1),ot(Xe)),[te.Atan]:Le(je(1,2),ot(Xe)),[te.Sqrt]:Le(je(1,1),ot(Xe)),[te.Match]:Le(je(4,1/0),HS,Wj),[te.Between]:Le(je(3,3),ot(Xe)),[te.Interpolate]:Le(je(6,1/0),HS,Kj),[te.Case]:Le(je(3,1/0),Gj,$j),[te.In]:Le(je(2,2),Hj),[te.Number]:Le(je(1,1/0),ot(Fg)),[te.String]:Le(je(1,1/0),ot(Fg)),[te.Array]:Le(je(1,1/0),ot(Xe)),[te.Color]:Le(je(1,4),ot(Xe)),[te.Band]:Le(je(1,3),ot(Xe)),[te.Palette]:Le(je(2,2),Xj),[te.ToString]:Le(je(1,1),ot(zn|Xe|ni|fr))};function KS(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Zt(Xe,o);break}case"string":{r[s]=new Zt(ni,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function Uj(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Zt(ni,i)]}function zj(n,e,t){t.featureId=!0}function Bj(n,e,t){t.geometryType=!0}function m0(n,e,t){t.mapState=!0}function wu(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function je(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function $S(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Sn(n[s+1],e,t);r[s]=o}return r}function ot(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=Sn(e[o+1],n,i);s[o]=l}return s}}function Gj(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function HS(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function Wj(n,e,t){const i=n.length-1,r=ni|Xe|zn,s=Sn(n[1],r,t),o=Sn(n[n.length-1],e,t),l=new Array(i-2);for(let c=0;c<i-2;c+=2){try{const h=Sn(n[c+2],s.type,t);l[c]=h}catch(h){throw new Error(`failed to parse argument ${c+1} of match expression: ${h.message}`)}try{const h=Sn(n[c+3],o.type,t);l[c+1]=h}catch(h){throw new Error(`failed to parse argument ${c+2} of match expression: ${h.message}`)}}return[s,...l,o]}function Kj(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const c=i[1];if(typeof c!="number"||c<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(c)} instead`);r=c;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Zt(Xe,r);let o;try{o=Sn(n[2],Xe,t)}catch(c){throw new Error(`failed to parse argument 1 in interpolate expression: ${c.message}`)}const l=new Array(n.length-3);for(let c=0;c<l.length;c+=2){try{const h=Sn(n[c+3],Xe,t);l[c]=h}catch(h){throw new Error(`failed to parse argument ${c+2} for interpolate expression: ${h.message}`)}try{const h=Sn(n[c+4],e,t);l[c+1]=h}catch(h){throw new Error(`failed to parse argument ${c+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function $j(n,e,t){const i=Sn(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Sn(n[s+1],zn,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Sn(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function Hj(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=ni}else r=Xe;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const c=Sn(i[l],r,t);s[l]=c}catch(c){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${c.message}`)}return[Sn(n[1],r,t),...s]}function Xj(n,e,t){let i;try{i=Sn(n[1],Xe,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=Sn(r[o],fr,t)}catch(c){throw new Error(`failed to parse color at index ${o} in palette expression: ${c.message}`)}if(!(l instanceof Zt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Le(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new Fj(t,r,...s)}}function qj(n,e,t){const i=n[0],r=jj[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function Yb(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Yb(n.getGeometries()[0]);default:return""}}function Zb(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Zs(n,e,t){const i=Sn(n,e,t);return Ir(i)}function Ir(n,e){if(n instanceof Zt){if(n.type===fr&&typeof n.value=="string"){const i=dE(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return Yj(n);case te.Get:case te.Var:case te.Has:return Zj(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Ir(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return Jj(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return Qj(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return e5(n);case te.Case:return t5(n);case te.Match:return n5(n);case te.Interpolate:return i5(n);case te.ToString:return r5(n);default:throw new Error(`Unsupported operator ${t}`)}}function Yj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function Zj(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,c=s.length;l<c;++l){const f=s[l].value;o=o[f]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,c=s.length;l<c;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function Qj(n,e){const t=n.operator,i=Ir(n.args[0]),r=Ir(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function Jj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),l=r[1](s),c=r[2](s);return o>=l&&o<=c};case te.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function e5(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const c=r[2](s);return o>c?c:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function t5(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ir(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function n5(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ir(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function i5(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ir(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,c;for(let h=2;h<t;h+=2){const f=i[h](r);let m=i[h+1](r);const y=Array.isArray(m);if(y&&(m=R4(m)),f>=o)return h===2?m:y?s5(s,o,l,c,f,m):$h(s,o,l,c,f,m);l=f,c=m}return c}}function r5(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);if(t===te.ToString)return s=>{const o=r[0](s);return n.args[0].type===fr?fE(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function $h(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,c=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+c*(s-i)}function s5(n,e,t,i,r,s){if(r-t===0)return i;const l=IS(i),c=IS(s);let h=c[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[$h(n,e,t,l[0],r,c[0]),$h(n,e,t,l[1],r,c[1]),l[2]+$h(n,e,t,0,r,h),$h(n,e,t,i[3],r,s[3])];return A4(f)}function o5(n){return!0}function a5(n){const e=qb(),t=l5(n,e),i=Zb();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=Yb(r.getGeometry())),t(i)}}function XS(n){const e=qb(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Sv(n[o],e);const r=Zb(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let c=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[c]=f,c+=1)}return s.length=c,s}}function l5(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Zs(s.filter,zn,e):o5;let l;if(Array.isArray(s.style)){const c=s.style.length;l=new Array(c);for(let h=0;h<c;++h)l[h]=Sv(s.style[h],e)}else l=[Sv(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const c=i[l].filter;if(c(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function Sv(n,e){const t=Rd(n,"",e),i=Ad(n,"",e),r=u5(n,e),s=c5(n,e),o=ri(n,"z-index",e);if(!t&&!i&&!r&&!s&&!rc(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new Yi;return function(c){let h=!0;if(t){const f=t(c);f&&(h=!1),l.setFill(f)}if(i){const f=i(c);f&&(h=!1),l.setStroke(f)}if(r){const f=r(c);f&&(h=!1),l.setText(f)}if(s){const f=s(c);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(c)),h?null:l}}function Rd(n,e,t){let i;if(e+"fill-pattern-src"in n)i=g5(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=wE(n,e+"fill-color",t)}if(!i)return null;const r=new Tr;return function(s){const o=i(s);return o===hE?null:(r.setColor(o),r)}}function Ad(n,e,t){const i=ri(n,e+"stroke-width",t),r=wE(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Ns(n,e+"stroke-line-cap",t),o=Ns(n,e+"stroke-line-join",t),l=Qb(n,e+"stroke-line-dash",t),c=ri(n,e+"stroke-line-dash-offset",t),h=ri(n,e+"stroke-miter-limit",t),f=new Pc;return function(m){if(r){const y=r(m);if(y===hE)return null;f.setColor(y)}if(i&&f.setWidth(i(m)),s){const y=s(m);if(y!=="butt"&&y!=="round"&&y!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(y)}if(o){const y=o(m);if(y!=="bevel"&&y!=="round"&&y!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(y)}return l&&f.setLineDash(l(m)),c&&f.setLineDashOffset(c(m)),h&&f.setMiterLimit(h(m)),f}}function u5(n,e){const t="text-",i=Ns(n,t+"value",e);if(!i)return null;const r=Rd(n,t,e),s=Rd(n,t+"background-",e),o=Ad(n,t,e),l=Ad(n,t+"background-",e),c=Ns(n,t+"font",e),h=ri(n,t+"max-angle",e),f=ri(n,t+"offset-x",e),m=ri(n,t+"offset-y",e),y=Xu(n,t+"overflow",e),E=Ns(n,t+"placement",e),I=ri(n,t+"repeat",e),C=Om(n,t+"scale",e),x=Xu(n,t+"rotate-with-view",e),b=ri(n,t+"rotation",e),D=Ns(n,t+"align",e),L=Ns(n,t+"justify",e),O=Ns(n,t+"baseline",e),F=Xu(n,t+"keep-upright",e),W=Qb(n,t+"padding",e),P=Vm(n,t+"declutter-mode"),R=new ef({declutterMode:P});return function(k){if(R.setText(i(k)),r&&R.setFill(r(k)),s&&R.setBackgroundFill(s(k)),o&&R.setStroke(o(k)),l&&R.setBackgroundStroke(l(k)),c&&R.setFont(c(k)),h&&R.setMaxAngle(h(k)),f&&R.setOffsetX(f(k)),m&&R.setOffsetY(m(k)),y&&R.setOverflow(y(k)),E){const V=E(k);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");R.setPlacement(V)}if(I&&R.setRepeat(I(k)),C&&R.setScale(C(k)),x&&R.setRotateWithView(x(k)),b&&R.setRotation(b(k)),D){const V=D(k);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");R.setTextAlign(V)}if(L){const V=L(k);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");R.setJustify(V)}if(O){const V=O(k);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");R.setTextBaseline(V)}return W&&R.setPadding(W(k)),F&&R.setKeepUpright(F(k)),R}}function c5(n,e){return"icon-src"in n?h5(n,e):"shape-points"in n?d5(n,e):"circle-radius"in n?f5(n,e):null}function h5(n,e){const t="icon-",i=t+"src",r=Jb(n[i],i),s=Vp(n,t+"anchor",e),o=Om(n,t+"scale",e),l=ri(n,t+"opacity",e),c=Vp(n,t+"displacement",e),h=ri(n,t+"rotation",e),f=Xu(n,t+"rotate-with-view",e),m=YS(n,t+"anchor-origin"),y=ZS(n,t+"anchor-x-units"),E=ZS(n,t+"anchor-y-units"),I=_5(n,t+"color"),C=m5(n,t+"cross-origin"),x=y5(n,t+"offset"),b=YS(n,t+"offset-origin"),D=Fp(n,t+"width"),L=Fp(n,t+"height"),O=p5(n,t+"size"),F=Vm(n,t+"declutter-mode"),W=new _E({src:r,anchorOrigin:m,anchorXUnits:y,anchorYUnits:E,color:I,crossOrigin:C,offset:x,offsetOrigin:b,height:L,width:D,size:O,declutterMode:F});return function(P){return l&&W.setOpacity(l(P)),c&&W.setDisplacement(c(P)),h&&W.setRotation(h(P)),f&&W.setRotateWithView(f(P)),o&&W.setScale(o(P)),s&&W.setAnchor(s(P)),W}}function d5(n,e){const t="shape-",i=t+"points",r=t+"radius",s=Cv(n[i],i),o=Cv(n[r],r),l=Rd(n,t,e),c=Ad(n,t,e),h=Om(n,t+"scale",e),f=Vp(n,t+"displacement",e),m=ri(n,t+"rotation",e),y=Xu(n,t+"rotate-with-view",e),E=Fp(n,t+"radius2"),I=Fp(n,t+"angle"),C=Vm(n,t+"declutter-mode"),x=new Lm({points:s,radius:o,radius2:E,angle:I,declutterMode:C});return function(b){return l&&x.setFill(l(b)),c&&x.setStroke(c(b)),f&&x.setDisplacement(f(b)),m&&x.setRotation(m(b)),y&&x.setRotateWithView(y(b)),h&&x.setScale(h(b)),x}}function f5(n,e){const t="circle-",i=Rd(n,t,e),r=Ad(n,t,e),s=ri(n,t+"radius",e),o=Om(n,t+"scale",e),l=Vp(n,t+"displacement",e),c=ri(n,t+"rotation",e),h=Xu(n,t+"rotate-with-view",e),f=Vm(n,t+"declutter-mode"),m=new bl({radius:5,declutterMode:f});return function(y){return s&&m.setRadius(s(y)),i&&m.setFill(i(y)),r&&m.setStroke(r(y)),l&&m.setDisplacement(l(y)),c&&m.setRotation(c(y)),h&&m.setRotateWithView(h(y)),o&&m.setScale(o(y)),m}}function ri(n,e,t){if(!(e in n))return;const i=Zs(n[e],Xe,t);return function(r){return Cv(i(r),e)}}function Ns(n,e,t){if(!(e in n))return null;const i=Zs(n[e],ni,t);return function(r){return Jb(i(r),e)}}function g5(n,e,t){const i=Ns(n,e+"pattern-src",t),r=qS(n,e+"pattern-offset",t),s=qS(n,e+"pattern-size",t),o=wE(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function Xu(n,e,t){if(!(e in n))return null;const i=Zs(n[e],zn,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function wE(n,e,t){if(!(e in n))return null;const i=Zs(n[e],fr,t);return function(r){return e2(i(r),e)}}function Qb(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl,t);return function(r){return nf(i(r),e)}}function Vp(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl,t);return function(r){const s=nf(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function qS(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl,t);return function(r){return t2(i(r),e)}}function Om(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl|Xe,t);return function(r){return v5(i(r),e)}}function Fp(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function p5(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return si(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function m5(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function YS(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function ZS(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function y5(n,e){const t=n[e];if(t!==void 0)return nf(t,e)}function Vm(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function _5(n,e){const t=n[e];if(t!==void 0)return e2(t,e)}function nf(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function Jb(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function Cv(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function e2(n,e){if(typeof n=="string")return n;const t=nf(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function t2(n,e){const t=nf(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function v5(n,e){return typeof n=="number"?n:t2(n,e)}const ur={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function QS(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const c=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,m=l?l[1]:0;let y=n[0]+c/2+f,E=n[2]-c/2+f,I=n[1]+h/2+m,C=n[3]-h/2+m;y>E&&(y=(E+y)/2,E=y),I>C&&(I=(C+I)/2,C=I);let x=Dt(i[0],y,E),b=Dt(i[1],I,C);if(o&&t&&r){const D=30*r;x+=-D*Math.log(1+Math.max(0,y-i[0])/D)+D*Math.log(1+Math.max(0,i[0]-E)/D),b+=-D*Math.log(1+Math.max(0,I-i[1])/D)+D*Math.log(1+Math.max(0,i[1]-C)/D)}return[x,b]})}function w5(n){return n}function n2(n){return Math.pow(n,3)}function bc(n){return 1-n2(1-n)}function E5(n){return 3*n*n-2*n*n*n}function x5(n){return n}function EE(n,e,t,i){const r=dt(e)/t[0],s=Bn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function xE(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Dt(i,t/2,e*2)}function T5(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const c=n[0],h=n[n.length-1],f=t?EE(c,t,o,i):c;if(l)return e?xE(r,f,h):Dt(r,h,f);const m=Math.min(f,r),y=Math.floor(qw(n,m,s));return n[y]>f&&y<n.length-1?n[y+1]:n[y]}})}function I5(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,c,h){if(o!==void 0){const f=r?EE(e,r,c,s):e;if(h)return i?xE(o,f,t):Dt(o,t,f);const m=1e-9,y=Math.ceil(Math.log(e/f)/Math.log(n)-m),E=-l*(.5-m)+.5,I=Math.min(f,o),C=Math.floor(Math.log(e/I)/Math.log(n)+E),x=Math.max(y,C),b=e/Math.pow(n,x);return Dt(b,t,f)}})}function JS(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,c){if(s!==void 0){const h=i?EE(n,i,l,r):n;return!t||!c?Dt(s,e,h):xE(s,h,e)}})}function TE(n){if(n!==void 0)return 0}function eC(n){if(n!==void 0)return n}function S5(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function C5(n){const e=Ko(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const R5=42,IE=256,y0=0;class qr extends ls{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=rE(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&db(),e.center&&(e.center=Ms(e.center,this.projection_)),e.extent&&(e.extent=zo(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in ur)delete t[l];this.setProperties(t,!0);const i=P5(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=A5(e),s=i.constraint,o=b5(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ms(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ms(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&jg(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,c=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],m={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||E5,callback:i};if(f.center&&(m.sourceCenter=o,m.targetCenter=f.center.slice(),o=m.targetCenter),f.zoom!==void 0?(m.sourceResolution=l,m.targetResolution=this.getResolutionForZoom(f.zoom),l=m.targetResolution):f.resolution&&(m.sourceResolution=l,m.targetResolution=f.resolution,l=m.targetResolution),f.rotation!==void 0){m.sourceRotation=c;const y=ol(f.rotation-c+Math.PI,2*Math.PI)-Math.PI;m.targetRotation=c+y,c=m.targetRotation}k5(m)?m.complete=!0:s+=m.duration,h.push(m)}this.animations_.push(h),this.setHint(Nn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Nn.ANIMATING]>0}getInteracting(){return this.hints_[Nn.INTERACTING]>0}cancelAnimations(){this.setHint(Nn.ANIMATING,-this.hints_[Nn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&jg(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const c=r[o];if(c.complete)continue;const h=e-c.start;let f=c.duration>0?h/c.duration:1;f>=1?(c.complete=!0,f=1):s=!1;const m=c.easing(f);if(c.sourceCenter){const y=c.sourceCenter[0],E=c.sourceCenter[1],I=c.targetCenter[0],C=c.targetCenter[1];this.nextCenter_=c.targetCenter;const x=y+m*(I-y),b=E+m*(C-E);this.targetCenter_=[x,b]}if(c.sourceResolution&&c.targetResolution){const y=m===1?c.targetResolution:c.sourceResolution+m*(c.targetResolution-c.sourceResolution);if(c.anchor){const E=this.getViewportSize_(this.getRotation()),I=this.constraints_.resolution(y,0,E,!0);this.targetCenter_=this.calculateCenterZoom(I,c.anchor)}this.nextResolution_=c.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(c.sourceRotation!==void 0&&c.targetRotation!==void 0){const y=m===1?ol(c.targetRotation+Math.PI,2*Math.PI)-Math.PI:c.sourceRotation+m*(c.targetRotation-c.sourceRotation);if(c.anchor){const E=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(E,c.anchor)}this.nextRotation_=c.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),t=!0,!c.complete)break}if(s){this.animations_[i]=null,this.setHint(Nn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&jg(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],Jw(i,e-this.getRotation()),w3(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&vv(e,this.getProjection())}getCenterInternal(){return this.get(ur.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return fb(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();at(t,"The view center is not defined");const i=this.getResolution();at(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return at(r!==void 0,"The view rotation is not defined"),gv(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(ur.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(zo(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=dt(e)/t[0],r=Bn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(ur.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=_0(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=qw(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Dt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Dt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(at(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){at(!Pm(e),"Cannot fit empty extent provided as `geometry`");const r=zo(e,this.getProjection());i=DS(r)}else if(e.getType()==="Circle"){const r=zo(e.getExtent(),this.getProjection());i=DS(r),i.rotate(this.getRotation(),fl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,c=1/0,h=-1/0,f=-1/0;for(let m=0,y=s.length;m<y;m+=o){const E=s[m]*i-s[m+1]*r,I=s[m]*r+s[m+1]*i;l=Math.min(l,E),c=Math.min(c,I),h=Math.max(h,E),f=Math.max(f,I)}return[l,c,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let c=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);c=isNaN(c)?o:Math.max(c,o),c=this.getConstrainedResolution(c,s?0:1);const h=this.getRotation(),f=Math.sin(h),m=Math.cos(h),y=fl(l);y[0]+=(r[1]-r[3])/2*c,y[1]+=(r[0]-r[2])/2*c;const E=y[0]*m-y[1]*f,I=y[1]*m+y[0]*f,C=this.getConstrainedCenter([E,I],c),x=t.callback?t.callback:_d;t.duration!==void 0?this.animateInternal({resolution:c,center:C,duration:t.duration,easing:t.easing},x):(this.targetResolution_=c,this.targetCenter_=C,this.applyTargetState_(!1,!0),jg(x,!0))}centerOn(e,t,i){this.centerOnInternal(Ms(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(_0(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),c=_0(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-c[0],e[1]-c[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=vv(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ms(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ms(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ms(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(ur.ROTATION)!==r&&this.set(ur.ROTATION,r),this.get(ur.RESOLUTION)!==o&&(this.set(ur.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(ur.CENTER)||!Rp(this.get(ur.CENTER),l))&&this.set(ur.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),c=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=c,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Rp(this.getCenterInternal(),c))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:c,resolution:l,duration:e,easing:bc,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Nn.INTERACTING,1)}endInteraction(e,t,i){i=i&&Ms(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Nn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function jg(n,e){setTimeout(function(){n(e)},0)}function A5(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return QS(n.extent,n.constrainOnlyCenter,t)}const e=rE(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,QS(t,!1,!1)}return w5}function P5(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:y0,l=n.maxZoom!==void 0?n.maxZoom:28;const c=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,m=n.showFullExtent!==void 0?n.showFullExtent:!1,y=rE(n.projection,"EPSG:3857"),E=y.getExtent();let I=n.constrainOnlyCenter,C=n.extent;if(!h&&!C&&y.isGlobal()&&(I=!1,C=E),n.resolutions!==void 0){const x=n.resolutions;t=x[o],i=x[l]!==void 0?x[l]:x[x.length-1],n.constrainResolution?e=T5(x,f,!I&&C,m):e=JS(t,i,f,!I&&C,m)}else{const b=(E?Math.max(dt(E),Bn(E)):360*ac.degrees/y.getMetersPerUnit())/IE/Math.pow(2,y0),D=b/Math.pow(2,28-y0);t=n.maxResolution,t!==void 0?o=0:t=b/Math.pow(c,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(c,l):i=b/Math.pow(c,l):i=D),l=o+Math.floor(Math.log(t/i)/Math.log(c)),i=t/Math.pow(c,l-o),n.constrainResolution?e=I5(c,t,i,f,!I&&C,m):e=JS(t,i,f,!I&&C,m)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:c}}function b5(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?C5():t===!1?eC:typeof t=="number"?S5(t):eC}return TE}function k5(n){return!(n.sourceCenter&&n.targetCenter&&!Rp(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function _0(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,c=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,c+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-c*o,f=c*s+l*o;return[h,f]}const ht={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class i2 extends ls{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[ht.OPACITY]=e.opacity!==void 0?e.opacity:1,at(typeof t[ht.OPACITY]=="number","Layer opacity must be a number"),t[ht.VISIBLE]=e.visible!==void 0?e.visible:!0,t[ht.Z_INDEX]=e.zIndex,t[ht.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[ht.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[ht.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[ht.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Dt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return et()}getLayerStatesArray(e){return et()}getExtent(){return this.get(ht.EXTENT)}getMaxResolution(){return this.get(ht.MAX_RESOLUTION)}getMinResolution(){return this.get(ht.MIN_RESOLUTION)}getMinZoom(){return this.get(ht.MIN_ZOOM)}getMaxZoom(){return this.get(ht.MAX_ZOOM)}getOpacity(){return this.get(ht.OPACITY)}getSourceState(){return et()}getVisible(){return this.get(ht.VISIBLE)}getZIndex(){return this.get(ht.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(ht.EXTENT,e)}setMaxResolution(e){this.set(ht.MAX_RESOLUTION,e)}setMinResolution(e){this.set(ht.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(ht.MAX_ZOOM,e)}setMinZoom(e){this.set(ht.MIN_ZOOM,e)}setOpacity(e){at(typeof e=="number","Layer opacity must be a number"),this.set(ht.OPACITY,e)}setVisible(e){this.set(ht.VISIBLE,e)}setZIndex(e){this.set(ht.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Fm extends i2{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(ht.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(ht.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Rt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=tt(e,ze.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof qr?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return SE(r,t.viewState)&&(!s||ii(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof qr?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(ht.MAP,e)}getMapInternal(){return this.get(ht.MAP)}setMap(e){this.mapPrecomposeKey_&&(Rt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Rt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=tt(e,$i.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=tt(this,ze.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);at(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(ht.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function SE(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const tC={RENDER_ORDER:"renderOrder"};class r2 extends Fm{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(tC.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new zb(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(tC.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Gb:e;const t=D5(e);this.styleFunction_=e===null?void 0:gj(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function D5(n){if(n===void 0)return Gb;if(!n)return null;if(typeof n=="function"||n instanceof Yi)return n;if(!Array.isArray(n))return XS([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Yi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Yi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return a5(r)}return XS(n)}class CE extends r2{constructor(e){super(e)}createRenderer(){return new Lj(this)}}const Ro={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Oo extends Ys{constructor(e,t){super(e),this.layer=t}}const v0={LAYERS:"layers"};class kc extends i2{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(v0.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Ki(i.slice(),{unique:!0}):at(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Ki(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Rt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(tt(e,ei.ADD,this.handleLayersAdd_,this),tt(e,ei.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Rt);qd(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new Oo(Ro.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[tt(e,ic.PROPERTYCHANGE,this.handleLayerChange_,this),tt(e,ze.CHANGE,this.handleLayerChange_,this)];e instanceof kc&&t.push(tt(e,Ro.ADDLAYER,this.handleLayerGroupAdd_,this),tt(e,Ro.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[nt(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Oo(Ro.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Oo(Ro.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Oo(Ro.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=nt(t);this.listenerKeys_[i].forEach(Rt),delete this.listenerKeys_[i],this.dispatchEvent(new Oo(Ro.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(v0.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Oo(Ro.REMOVELAYER,i[r]))}this.set(v0.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const c=t[o];c.opacity*=r.opacity,c.visible=c.visible&&r.visible,c.maxResolution=Math.min(c.maxResolution,r.maxResolution),c.minResolution=Math.max(c.minResolution,r.minResolution),c.minZoom=Math.max(c.minZoom,r.minZoom),c.maxZoom=Math.min(c.maxZoom,r.maxZoom),r.extent!==void 0&&(c.extent!==void 0?c.extent=sl(c.extent,r.extent):c.extent=r.extent),c.zIndex===void 0&&(c.zIndex=s)}return t}getSourceState(){return"ready"}}const Ce={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class RE extends Im{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(ze.CHANGE)}release(){this.setState(Ce.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Ce.EMPTY){if(this.state!==Ce.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){et()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:n2(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Rv(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const M5=new Error("disposed"),N5=[256,256];class nC extends RE{constructor(e){const t=Ce.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Rv(this.data_);return e?[e.width,e.height]:N5}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Ce.IDLE&&this.state!==Ce.ERROR)return;this.state=Ce.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Ce.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Ce.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(M5),this.controller_=null),super.disposeInternal()}}class s2 extends RE{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Ei?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Ce.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Ce.ERROR,this.unlistenImage_(),this.image_=L5(),this.changed()}handleImageLoad_(){if(Ei)this.state=Ce.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Ce.LOADED:this.state=Ce.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Ce.ERROR&&(this.state=Ce.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ce.IDLE&&(this.state=Ce.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=P4(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function L5(){const n=Qt(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let w0;const qu=[];function iC(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function E0(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function O5(){if(w0===void 0){const n=Qt(6,6,qu);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",iC(n,4,5,4,0),iC(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;w0=E0(e,0)||E0(e,4)||E0(e,8),Mm(n),qu.push(n.canvas)}return w0}function rC(n,e,t,i){const r=Dm(t,e,n);let s=bp(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const c=n.getExtent();if(!c||oc(c,r)){const h=bp(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function V5(n,e,t,i){const r=fl(t);let s=rC(n,e,r,i);return(!isFinite(s)||s<=0)&&tb(t,function(o){return s=rC(n,e,o,i),isFinite(s)&&s>0}),s}function F5(n,e,t,i,r,s,o,l,c,h,f,m,y,E){const I=Qt(Math.round(t*n),Math.round(t*e),qu);if(m||(I.imageSmoothingEnabled=!1),c.length===0)return I.canvas;I.scale(t,t);function C(F){return Math.round(F*t)/t}I.globalCompositeOperation="lighter";const x=Zi();c.forEach(function(F,W,P){f3(x,F.extent)});let b;const D=t/i,L=(m?1:1+Math.pow(2,-24))/D;b=Qt(Math.round(dt(x)*D),Math.round(Bn(x)*D),qu),m||(b.imageSmoothingEnabled=!1),c.forEach(function(F,W,P){if(F.image.width>0&&F.image.height>0){if(F.clipExtent){b.save();const z=(F.clipExtent[0]-x[0])*D,N=-(F.clipExtent[3]-x[3])*D,le=dt(F.clipExtent)*D,me=Bn(F.clipExtent)*D;b.rect(m?z:Math.round(z),m?N:Math.round(N),m?le:Math.round(z+le)-Math.round(z),m?me:Math.round(N+me)-Math.round(N)),b.clip()}const R=(F.extent[0]-x[0])*D,k=-(F.extent[3]-x[3])*D,V=dt(F.extent)*D,j=Bn(F.extent)*D;b.drawImage(F.image,h,h,F.image.width-2*h,F.image.height-2*h,m?R:Math.round(R),m?k:Math.round(k),m?V:Math.round(R+V)-Math.round(R),m?j:Math.round(k+j)-Math.round(k)),F.clipExtent&&b.restore()}});const O=Pl(o);return l.getTriangles().forEach(function(F,W,P){const R=F.source,k=F.target;let V=R[0][0],j=R[0][1],z=R[1][0],N=R[1][1],le=R[2][0],me=R[2][1];const fe=C((k[0][0]-O[0])/s),ce=C(-(k[0][1]-O[1])/s),ee=C((k[1][0]-O[0])/s),oe=C(-(k[1][1]-O[1])/s),ne=C((k[2][0]-O[0])/s),G=C(-(k[2][1]-O[1])/s),$=V,xe=j;V=0,j=0,z-=$,N-=xe,le-=$,me-=xe;const Te=[[z,N,0,0,ee-fe],[le,me,0,0,ne-fe],[0,0,z,N,oe-ce],[0,0,le,me,G-ce]],Ie=v3(Te);if(!Ie)return;if(I.save(),I.beginPath(),O5()||!m){I.moveTo(ee,oe);const Me=4,Ve=fe-ee,Be=ce-oe;for(let lt=0;lt<Me;lt++)I.lineTo(ee+C((lt+1)*Ve/Me),oe+C(lt*Be/(Me-1))),lt!=Me-1&&I.lineTo(ee+C((lt+1)*Ve/Me),oe+C((lt+1)*Be/(Me-1)));I.lineTo(ne,G)}else I.moveTo(ee,oe),I.lineTo(fe,ce),I.lineTo(ne,G);I.clip(),I.transform(Ie[0],Ie[2],Ie[1],Ie[3],fe,ce),I.translate(x[0]-$,x[3]-xe);let be;if(b)be=b.canvas,I.scale(L,-L);else{const Me=c[0],Ve=Me.extent;be=Me.image,I.scale(dt(Ve)/be.width,-Bn(Ve)/be.height)}I.drawImage(be,0,0),I.restore()}),b&&(Mm(b),qu.push(b.canvas)),f&&(I.save(),I.globalCompositeOperation="source-over",I.strokeStyle="black",I.lineWidth=1,l.getTriangles().forEach(function(F,W,P){const R=F.target,k=(R[0][0]-O[0])/s,V=-(R[0][1]-O[1])/s,j=(R[1][0]-O[0])/s,z=-(R[1][1]-O[1])/s,N=(R[2][0]-O[0])/s,le=-(R[2][1]-O[1])/s;I.beginPath(),I.moveTo(j,z),I.lineTo(k,V),I.lineTo(N,le),I.closePath(),I.stroke()}),I.restore()),I.canvas}const j5=10,sC=.25;class U5{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let c={};const h=l?Y3(L=>cn(l,Dm(L,this.targetProj_,this.sourceProj_))):kp(this.targetProj_,this.sourceProj_);this.transformInv_=function(L){const O=L[0]+"/"+L[1];return c[O]||(c[O]=h(L)),c[O]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&dt(r)>=dt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?dt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?dt(this.targetProj_.getExtent()):null;const f=Pl(i),m=Am(i),y=Rm(i),E=Cm(i),I=this.transformInv_(f),C=this.transformInv_(m),x=this.transformInv_(y),b=this.transformInv_(E),D=j5+(o?Math.max(0,Math.ceil(Math.log2(fv(i)/(o*o*256*256)))):0);if(this.addQuad_(f,m,y,E,I,C,x,b,D),this.wrapsXInSource_){let L=1/0;this.triangles_.forEach(function(O,F,W){L=Math.min(L,O.source[0][0],O.source[1][0],O.source[2][0])}),this.triangles_.forEach(O=>{if(Math.max(O.source[0][0],O.source[1][0],O.source[2][0])-L>this.sourceWorldWidth_/2){const F=[[O.source[0][0],O.source[0][1]],[O.source[1][0],O.source[1][1]],[O.source[2][0],O.source[2][1]]];F[0][0]-L>this.sourceWorldWidth_/2&&(F[0][0]-=this.sourceWorldWidth_),F[1][0]-L>this.sourceWorldWidth_/2&&(F[1][0]-=this.sourceWorldWidth_),F[2][0]-L>this.sourceWorldWidth_/2&&(F[2][0]-=this.sourceWorldWidth_);const W=Math.min(F[0][0],F[1][0],F[2][0]);Math.max(F[0][0],F[1][0],F[2][0])-W<this.sourceWorldWidth_/2&&(O.source=F)}})}c={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,c,h){const f=sS([s,o,l,c]),m=this.sourceWorldWidth_?dt(f)/this.sourceWorldWidth_:null,y=this.sourceWorldWidth_,E=this.sourceProj_.canWrapX()&&m>.5&&m<1;let I=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const x=sS([e,t,i,r]);I=dt(x)/this.targetWorldWidth_>sC||I}!E&&this.sourceProj_.isGlobal()&&m&&(I=m>sC||I)}if(!I&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!ii(f,this.maxSourceExtent_))return;let C=0;if(!I&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(c[0])||!isFinite(c[1]))){if(h>0)I=!0;else if(C=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(c[0])||!isFinite(c[1])?1:0),C!=1&&C!=2&&C!=4&&C!=8)return}if(h>0){if(!I){const x=[(e[0]+i[0])/2,(e[1]+i[1])/2],b=this.transformInv_(x);let D;E?D=(ol(s[0],y)+ol(l[0],y))/2-ol(b[0],y):D=(s[0]+l[0])/2-b[0];const L=(s[1]+l[1])/2-b[1];I=D*D+L*L>this.errorThresholdSquared_}if(I){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const x=[(t[0]+i[0])/2,(t[1]+i[1])/2],b=this.transformInv_(x),D=[(r[0]+e[0])/2,(r[1]+e[1])/2],L=this.transformInv_(D);this.addQuad_(e,t,x,D,s,o,b,L,h-1),this.addQuad_(D,x,i,r,L,b,l,c,h-1)}else{const x=[(e[0]+t[0])/2,(e[1]+t[1])/2],b=this.transformInv_(x),D=[(i[0]+r[0])/2,(i[1]+r[1])/2],L=this.transformInv_(D);this.addQuad_(e,x,D,r,s,b,L,c,h-1),this.addQuad_(x,t,i,D,b,o,l,L,h-1)}return}}if(E){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(C&11)==0&&this.addTriangle_(e,i,r,s,l,c),(C&14)==0&&this.addTriangle_(e,i,t,s,l,o),C&&((C&13)==0&&this.addTriangle_(t,r,e,o,c,s),(C&7)==0&&this.addTriangle_(t,r,i,o,c,l))}calculateSourceExtent(){const e=Zi();return this.triangles_.forEach(function(t,i,r){const s=t.source;Jh(e,s[0]),Jh(e,s[1]),Jh(e,s[2])}),e}getTriangles(){return this.triangles_}}const z5=.5;class o2 extends RE{constructor(e,t,i,r,s,o,l,c,h,f,m,y){super(s,Ce.IDLE,y),this.renderEdges_=m!==void 0?m:!1,this.pixelRatio_=l,this.gutter_=c,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const E=r.getTileCoordExtent(this.wrappedTileCoord_),I=this.targetTileGrid_.getExtent();let C=this.sourceTileGrid_.getExtent();const x=I?sl(E,I):E;if(fv(x)===0){this.state=Ce.EMPTY;return}const b=e.getExtent();b&&(C?C=sl(C,b):C=b);const D=r.getResolution(this.wrappedTileCoord_[0]),L=V5(e,i,x,D);if(!isFinite(L)||L<=0){this.state=Ce.EMPTY;return}const O=f!==void 0?f:z5;if(this.triangulation_=new U5(e,i,x,C,L*O,D),this.triangulation_.getTriangles().length===0){this.state=Ce.EMPTY;return}this.sourceZ_=t.getZForResolution(L);let F=this.triangulation_.calculateSourceExtent();if(C&&(e.canWrapX()?(F[1]=Dt(F[1],C[1],C[3]),F[3]=Dt(F[3],C[1],C[3])):F=sl(F,C)),!fv(F))this.state=Ce.EMPTY;else{let W=0,P=0;e.canWrapX()&&(W=dt(b),P=Math.floor((F[0]-b[0])/W)),rb(F.slice(),e,!0).forEach(k=>{const V=t.getTileRangeForExtentAndZ(k,this.sourceZ_);for(let j=V.minX;j<=V.maxX;j++)for(let z=V.minY;z<=V.maxY;z++){const N=h(this.sourceZ_,j,z,l);if(N){const le=P*W;this.sourceTiles_.push({tile:N,offset:le})}}++P}),this.sourceTiles_.length===0&&(this.state=Ce.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Ce.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Ce.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=F5(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,c,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Ce.LOADED}this.changed()}load(){if(this.state==Ce.IDLE){this.state=Ce.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Ce.IDLE||i==Ce.LOADING){e++;const r=tt(t,ze.CHANGE,s=>{const o=t.getState();(o==Ce.LOADED||o==Ce.ERROR||o==Ce.EMPTY)&&(Rt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Ce.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Rt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Mm(this.canvas_.getContext("2d")),qu.push(this.canvas_),this.canvas_=null),super.release()}}class AE{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Eu(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new AE(n,e,t,i)}class oC{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof xm&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return at(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return at(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){at(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function jp(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function B5(n,e,t){return n+"/"+e+"/"+t}function rp(n,e,t,i,r){return`${nt(n)},${e},${B5(t,i,r)}`}function G5(n){return W5(n[0],n[1],n[2])}function W5(n,e,t){return(e<<n)+t}function K5(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function x0(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function $5(n,e,t){const i=n[t];return i?i.delete(e):!1}function aC(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=sl(e,zo(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=sl(e,r))}return e}class H5 extends Xb{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Zi(),this.tempTileRange_=new AE(0,0,0,0),this.tempTileCoord_=jp(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new oC(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new oC(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),c=rp(l,l.getKey(),e,t,i);let h;if(s.containsKey(c))h=s.get(c);else{const f=r.viewState.projection,m=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!m||ip(m,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(c,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=cn(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!oc(s,r))return null;const o=t.viewState,l=i.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=c.getZForResolution(o.resolution);f>=c.getMinZoom();--f){const m=c.getTileCoordForCoordAndZ(r,f),y=this.getTile(f,m[1],m[2],t);if(!y||y.getState()!==Ce.LOADED)continue;const E=c.getOrigin(f),I=si(c.getTileSize(f)),C=c.getResolution(f);let x;if(y instanceof s2||y instanceof o2)x=y.getImage();else if(y instanceof nC){if(x=Rv(y.getData()),!x)continue}else continue;const b=Math.floor(h*((r[0]-E[0])/C-m[1]*I[0])),D=Math.floor(h*((E[1]-r[1])/C-m[2]*I[1])),L=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(x,b+L,D+L)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),c=l.getRenderSource(),h=c.getTileGridForProjection(o.projection),f=nt(c);f in e.wantedTiles||(e.wantedTiles[f]={});const m=e.wantedTiles[f],y=l.getMapInternal(),E=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),y?y.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),c.zDirection)),I=o.rotation,C=I?nb(o.center,o.resolution,I,e.size):void 0;for(let x=i;x>=E;--x){const b=h.getTileRangeForExtentAndZ(t,x,this.tempTileRange_),D=h.getResolution(x);for(let L=b.minX;L<=b.maxX;++L)for(let O=b.minY;O<=b.maxY;++O){if(I&&!h.tileCoordIntersectsViewport([x,L,O],C))continue;const F=this.getTile(x,L,O,e);if(!F||!x0(r,F,x))continue;const P=F.getKey();if(m[P]=!0,F.getState()===Ce.IDLE&&!e.tileQueue.isKeyQueued(P)){const R=jp(x,L,O,this.tempTileCoord_);e.tileQueue.enqueue([F,f,h.getTileCoordCenter(R),D])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let c=0;c<l.length;++c){const h=rp(this.getLayer().getSource(),l[c],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Ce.LOADED)return f.endTransition(nt(this)),x0(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,c=this.getLayer().getRenderSource(),h=c.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let m=s.minY;m<=s.maxY;++m){const y=rp(c,h,i,f,m);let E=!1;if(l.containsKey(y)){const I=l.peek(y);I.getState()===Ce.LOADED&&(x0(r,I,i),E=!0)}E||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,c=e.pixelRatio,h=this.getLayer(),f=h.getSource(),m=f.getTileGridForProjection(s),y=m.getZForResolution(o,f.zDirection),E=m.getResolution(y),I=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==I&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=I):this.renderedSourceKey_=I;let C=e.extent;const x=f.getTilePixelRatio(c);this.prepareContainer(e,t);const b=this.context.canvas.width,D=this.context.canvas.height,L=i.extent&&zo(i.extent);L&&(C=sl(C,zo(i.extent)));const O=E*b/2/x,F=E*D/2/x,W=[l[0]-O,l[1]-F,l[0]+O,l[1]+F],P={};this.renderedTiles.length=0;const R=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const ee=m.getZForResolution(r.nextResolution,f.zDirection),oe=aC(e,e.nextExtent);this.enqueueTiles(e,oe,ee,P,R)}const k=aC(e,C);if(this.enqueueTiles(e,k,y,P,0),R>0&&setTimeout(()=>{this.enqueueTiles(e,k,y-1,P,R-1)},0),!(y in P))return this.container;const V=nt(this),j=e.time;for(const ee of P[y]){const oe=ee.getState();if(oe===Ce.EMPTY)continue;const ne=ee.tileCoord;if(oe===Ce.LOADED&&ee.getAlpha(V,j)===1){ee.endTransition(V);continue}if(oe!==Ce.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,P)){$5(P,ee,y),e.animate=!0;continue}if(this.findAltTiles_(m,ne,y+1,P))continue;const xe=m.getMinZoom();for(let Te=y-1;Te>=xe&&!this.findAltTiles_(m,ne,Te,P);--Te);}const z=E/o*c/x,N=this.getRenderContext(e);Hs(this.tempTransform,b/2,D/2,z,z,0,-b/2,-D/2),i.extent&&this.clipUnrotated(N,e,L),f.getInterpolate()||(N.imageSmoothingEnabled=!1),this.preRender(N,e);const le=Object.keys(P).map(Number);le.sort(Bs);let me;const fe=[],ce=[];for(let ee=le.length-1;ee>=0;--ee){const oe=le[ee],ne=f.getTilePixelSize(oe,c,s),$=m.getResolution(oe)/E,xe=ne[0]*$*z,Te=ne[1]*$*z,Ie=m.getTileCoordForCoordAndZ(Pl(W),oe),be=m.getTileCoordExtent(Ie),Me=cn(this.tempTransform,[x*(be[0]-W[0])/E,x*(W[3]-be[3])/E]),Ve=x*f.getGutterForProjection(s);for(const Be of P[oe]){if(Be.getState()!==Ce.LOADED)continue;const lt=Be.tileCoord,Qi=Ie[1]-lt[1],fs=Math.round(Me[0]-(Qi-1)*xe),Wn=Ie[2]-lt[2],Kn=Math.round(Me[1]-(Wn-1)*Te),hn=Math.round(Me[0]-Qi*xe),dn=Math.round(Me[1]-Wn*Te),$n=fs-hn,Ci=Kn-dn,yt=le.length===1;let ut=!1;me=[hn,dn,hn+$n,dn,hn+$n,dn+Ci,hn,dn+Ci];for(let tn=0,Ri=fe.length;tn<Ri;++tn)if(!yt&&oe<ce[tn]){const It=fe[tn];ii([hn,dn,hn+$n,dn+Ci],[It[0],It[3],It[4],It[7]])&&(ut||(N.save(),ut=!0),N.beginPath(),N.moveTo(me[0],me[1]),N.lineTo(me[2],me[3]),N.lineTo(me[4],me[5]),N.lineTo(me[6],me[7]),N.moveTo(It[6],It[7]),N.lineTo(It[4],It[5]),N.lineTo(It[2],It[3]),N.lineTo(It[0],It[1]),N.clip())}fe.push(me),ce.push(oe),this.drawTile(Be,e,hn,dn,$n,Ci,Ve,yt),ut&&N.restore(),this.renderedTiles.unshift(Be),this.updateUsedTiles(e.usedTiles,f,Be)}}if(this.renderedResolution=E,this.extentChanged=!this.renderedExtent_||!vd(this.renderedExtent_,W),this.renderedExtent_=W,this.renderedPixelRatio=c,this.postRender(this.context,e),i.extent&&N.restore(),N.imageSmoothingEnabled=!0,this.renderComplete){const ee=(oe,ne)=>{const G=nt(f),$=ne.wantedTiles[G],xe=$?Object.keys($).length:0;this.updateCacheSize(xe),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(ee)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,c){let h;if(e instanceof nC){if(h=Rv(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),m=nt(this),y=t.layerStatesArray[t.layerIndex],E=y.opacity*(c?e.getAlpha(m,t.time):1),I=E!==f.globalAlpha;I&&(f.save(),f.globalAlpha=E),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),I&&f.restore(),E!==y.opacity?t.animate=!0:c&&e.endTransition(m)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=nt(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Ug={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class X5 extends Fm{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Ug.PRELOAD)}setPreload(e){this.set(Ug.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Ug.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Ug.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class T0 extends X5{constructor(e){super(e)}createRenderer(){return new H5(this,{cacheSize:this.getCacheSize()})}}const xu=[0,0,0],Ao=5;class a2{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,at(l3(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,at(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Pl(i)),at(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,at(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:IE,at(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new AE(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,c=r.maxY;l<=c;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,c=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):c=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Eu(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(c,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Eu(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Eu(s,o,s,o,i);if(this.zoomFactor_){const c=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*c),f=Math.floor(o*c);if(t<r)return Eu(h,h,f,f,i);const m=Math.floor(c*(s+1))-1,y=Math.floor(c*(o+1))-1;return Eu(h,m,f,y,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,xu);const r=xu[1],s=xu[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,xu);const o=xu[1],l=xu[2];return Eu(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=si(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=si(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,c=o+s[0]*r,h=l+s[1]*r;return Jo(o,l,c,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),c=this.getOrigin(o),h=si(this.getTileSize(o),this.tmpSize_);let f=l*(e-c[0])/i/h[0],m=l*(c[1]-t)/i/h[1];return r?(f=kg(f,Ao)-1,m=kg(m,Ao)-1):(f=bg(f,Ao),m=bg(m,Ao)),jp(o,f,m,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),c=si(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/c[0],f=(o[1]-t)/l/c[1];return r?(h=kg(h,Ao)-1,f=kg(f,Ao)-1):(h=bg(h,Ao),f=bg(f,Ao)),jp(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=qw(this.resolutions_,e,t||0);return Dt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return xb(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function l2(n){let e=n.getDefaultTileGrid();return e||(e=Q5(n),n.setDefaultTileGrid(e)),e}function q5(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=PE(t);if(!oc(s,r)){const o=dt(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function Y5(n,e,t,i){i=i!==void 0?i:"top-left";const r=u2(n,e,t);return new a2({extent:n,origin:p3(n,i),resolutions:r,tileSize:t})}function Z5(n){const e=n||{},t=e.extent||oi("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:u2(t,e.maxZoom,e.tileSize,e.maxResolution)};return new a2(i)}function u2(n,e,t,i){e=e!==void 0?e:R5,t=si(t!==void 0?t:IE);const r=Bn(n),s=dt(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let c=0;c<o;++c)l[c]=i/Math.pow(2,c);return l}function Q5(n,e,t,i){const r=PE(n);return Y5(r,e,t,i)}function PE(n){n=oi(n);let e=n.getExtent();if(!e){const t=180*ac.degrees/n.getMetersPerUnit();e=Jo(-t,-t,t,t)}return e}function _H(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const J5=/\{z\}/g,e6=/\{x\}/g,t6=/\{y\}/g,n6=/\{-y\}/g;function i6(n,e,t,i,r){return n.replace(J5,e.toString()).replace(e6,t.toString()).replace(t6,i.toString()).replace(n6,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function r6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function s6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return i6(n,o,t[1],t[2],s)})}function o6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=s6(n[r],e);return a6(i)}function a6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=G5(e),s=ol(r,n.length);return n[s](e,t,i)})}class l6 extends Bb{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&si(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||nt(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return et()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:l2(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=si(r.getTileSize(e),this.tmpSize);return s==1?o:fj(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=q5(r,e,i)),K5(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class u6 extends Ys{constructor(e,t){super(e),this.tile=t}}const I0={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class bE extends l6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===bE.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=nt(t),r=t.getState();let s;r==Ce.LOADING?(this.tileLoadingKeys_[i]=!0,s=I0.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Ce.ERROR?I0.TILELOADERROR:r==Ce.LOADED?I0.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new u6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=r6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(o6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class c6 extends bE{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:c2,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:s2,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!ip(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||ip(t,e)))return this.tileGrid;const i=nt(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=l2(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],c=this.getTileCoordForTileUrlFunction(l,s),h=c?this.tileUrlFunction(c,r,s):void 0,f=new this.tileClass(l,h!==void 0?Ce.IDLE:Ce.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(ze.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||ip(l,s))return this.getTileInternal(e,t,i,r,l||s);const c=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),m=this.getTileGridForProjection(s),y=this.getTileCoordForTileUrlFunction(c,s),E=new o2(l,f,s,m,c,y,this.getTilePixelRatio(r),this.getGutter(),(I,C,x,b)=>this.getTileInternal(I,C,x,b,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return E.key=h,E}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),c=rp(this,l,e,t,i);if(o&&o.containsKey(c))return o.get(c);const h=this.createTile_(e,t,i,r,s,l);return o?.set(c,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=oi(e);if(i){const r=nt(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function c2(n,e){if(Ei){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Av extends c6{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:Z5({extent:PE(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const h6="modulepreload",d6=function(n){return"/visapp/"+n},lC={},zg=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let c=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=c(t.map(h=>{if(h=d6(h),h in lC)return;lC[h]=!0;const f=h.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":h6,f||(y.as="script"),y.crossOrigin="",y.href=h,l&&y.setAttribute("nonce",l),document.head.appendChild(y),f)return new Promise((E,I)=>{y.addEventListener("load",E),y.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},f6='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class g6 extends Av{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[f6];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Ei&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||c2)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const Up=1/0;class p6{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,qd(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){at(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=Up?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const c=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[c]?h:c;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,c;for(l=0;l<s;++l)o=t[l],c=e(o),c==Up?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=c,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class m6 extends p6{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(ze.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Ce.LOADED||i===Ce.ERROR||i===Ce.EMPTY){i!==Ce.ERROR&&t.removeEventListener(ze.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Ce.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function y6(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Up;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Mu extends Ys{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class No extends Mu{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Nt={SINGLECLICK:"singleclick",CLICK:ze.CLICK,DBLCLICK:ze.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Pv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class _6 extends Im{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=tt(i,Pv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=tt(i,Pv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(ze.TOUCHMOVE,this.boundHandleTouchMove_,Cb?{passive:!1}:!1)}emulateClick_(e){let t=new No(Nt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new No(Nt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new No(Nt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Nt.POINTERUP||t.type==Nt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Nt.POINTERDOWN||t.type==Nt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new No(Nt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new No(Nt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(tt(i,Nt.POINTERMOVE,this.handlePointerMove_,this),tt(i,Nt.POINTERUP,this.handlePointerUp_,this),tt(this.element_,Nt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(tt(this.element_.getRootNode(),Nt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new No(Nt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new No(Nt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Rt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ze.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Rt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Lo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Dn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class jm extends ls{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Rt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==_d&&this.listenerKeys.push(tt(e,Lo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class v6 extends jm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const c=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(c),this.toggleButton_.addEventListener(ze.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+Jd+" "+gE+(this.collapsed_&&this.collapsible_?" "+SS:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>u3(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!oa(t,this.renderedAttributions_)){_4(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(SS),this.collapsed_?TS(this.collapseLabel_,this.label_):TS(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class w6 extends jm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(ze.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+Jd+" "+gE,c=this.element;c.className=l,c.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ng)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:bc}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Ng);!s&&i===0?this.element.classList.add(Ng):s&&i!==0&&this.element.classList.remove(Ng)}this.label_.style.transform=r}this.rotation_=i}}class E6 extends jm{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",c=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=c,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(ze.CLICK,this.handleClick_.bind(this,i),!1);const m=document.createElement("button");m.className=s,m.setAttribute("type","button"),m.title=h,m.appendChild(typeof l=="string"?document.createTextNode(l):l),m.addEventListener(ze.CLICK,this.handleClick_.bind(this,-i),!1);const y=t+" "+Jd+" "+gE,E=this.element;E.className=y,E.appendChild(f),E.appendChild(m),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:bc})):i.setZoom(s)}}}function x6(n){n=n||{};const e=new Ki;return(n.zoom===void 0||n.zoom)&&e.push(new E6(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new w6(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new v6(n.attributionOptions)),e}class T6{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const uC={ACTIVE:"active"};class rf extends ls{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(uC.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(uC.ACTIVE,e)}setMap(e){this.map_=e}}function I6(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:x5,center:n.getConstrainedCenter(r)})}}function kE(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:bc})}class S6 extends rf{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Nt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();kE(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function bv(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const C6=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},R6=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},h2=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?R6(n):!0},A6=yd,d2=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(m4&&Ib&&e.ctrlKey)},f2=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},P6=function(n){const e=n.originalEvent;return Ib?e.metaKey:e.ctrlKey},b6=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},g2=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},S0=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},k6=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class sf extends rf{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Nt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Nt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Nt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Nt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function DE(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class D6 extends sf{constructor(e){super({stopDown:Tm}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:bv(f2,k6);this.condition_=e.onFocusOnly?bv(h2,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(DE(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();E3(s,l.getResolution()),Jw(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),c=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(c),duration:500,easing:bc})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class M6 extends sf{constructor(e){e=e||{},super({stopDown:Tm}),this.condition_=e.condition?e.condition:C6,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!S0(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===TE)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return S0(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return S0(e)&&d2(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class N6 extends xm{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Cd([r])}getGeometry(){return this.geometry_}}const Tu={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ph extends Ys{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class L6 extends sf{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new N6(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??d2,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ph(Tu.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Ph(t?Tu.BOXEND:Tu.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ph(Tu.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Tu.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Tu.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class O6 extends L6{constructor(e){e=e||{};const t=e.condition?e.condition:b6;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:bc})}}const Oa={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class V6 extends rf{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return f2(t)&&g2(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==ze.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Oa.DOWN||r==Oa.LEFT||r==Oa.RIGHT||r==Oa.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let c=0,h=0;r==Oa.DOWN?h=-l:r==Oa.LEFT?c=-l:r==Oa.RIGHT?c=l:h=l;const f=[c,h];Jw(f,o.getRotation()),I6(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class F6 extends rf{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!P6(t)&&g2(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==ze.KEYDOWN||e.type==ze.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();kE(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const j6=40,U6=300;class z6 extends rf{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:A6;this.condition_=e.onFocusOnly?bv(h2,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==ze.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=j6;break;case WheelEvent.DOM_DELTA_PAGE:s*=U6;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const c=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),c),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),kE(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class B6 extends sf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Tm),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const c=s-this.lastAngle_;this.rotationDelta_+=c,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=c}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==TE&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(DE(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class G6 extends sf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Tm),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const c=e.map,h=c.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=c.getCoordinateFromPixelInternal(c.getEventPixel(DE(this.targetPointers))),c.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function W6(n){n=n||{};const e=new Ki,t=new T6(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new M6),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new S6({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new D6({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new B6),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new G6({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new V6),e.push(new F6({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new z6({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new O6({duration:n.zoomDuration})),e}class K6 extends xm{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){et()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Hs(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),gb(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,c){let h;const f=t.viewState;function m(O,F,W,P){return s.call(o,F,O?W:null,P)}const y=f.projection,E=sb(e.slice(),y),I=[[0,0]];if(y.canWrapX()&&r){const O=y.getExtent(),F=dt(O);I.push([-F,0],[F,0])}const C=t.layerStatesArray,x=C.length,b=[],D=[];for(let O=0;O<I.length;O++)for(let F=x-1;F>=0;--F){const W=C[F],P=W.layer;if(P.hasRenderer()&&SE(W,f)&&l.call(c,P)){const R=P.getRenderer(),k=P.getSource();if(R&&k){const V=k.getWrapX()?E:e,j=m.bind(null,W.managed);D[0]=V[0]+I[O][0],D[1]=V[1]+I[O][1],h=R.forEachFeatureAtCoordinate(D,t,i,j,b)}if(h)return h}}if(b.length===0)return;const L=1/b.length;return b.forEach((O,F)=>O.distanceSq+=F*L),b.sort((O,F)=>O.distanceSq-F.distanceSq),b.some(O=>h=O.callback(O.feature,O.layer,O.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,yd,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){et()}scheduleExpireIconCache(e){Hi.canExpireCache()&&e.postRenderFunctions.push($6)}}function $6(n,e){Hi.expire()}class H6 extends K6{constructor(e){super(e),this.fontChangeListenerKey_=tt(bu,ic.PROPERTYCHANGE,e.redrawText,e),this.element_=Ei?Rb():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Jd+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new Hb(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Rt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent($i.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof r2&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const m=t[h];e.layerIndex=h;const y=m.layer,E=y.getSourceState();if(!SE(m,r)||E!="ready"&&E!="undefined"){y.unrender();continue}const I=y.render(e,o);I&&(I!==o&&(this.children_.push(I),o=I),s.push(m))}this.declutter(e,s),v4(this.element_,this.children_);const c=this.getMap().getTargetElement();if(Bo(c)){const h=c.getContext("2d");for(const f of this.children_){const m=f.firstElementChild||f,y=f.style.backgroundColor;if(y&&(!Bo(m)||m.width>0)&&(h.fillStyle=y,h.fillRect(0,0,c.width,c.height)),Bo(m)&&m.width>0){const E=f.style.opacity||m.style.opacity;h.globalAlpha=E===""?1:Number(E);const I=m.style.transform;if(I)h.setTransform(...wv(I));else{const C=parseFloat(m.style.width)/m.width,x=parseFloat(m.style.height)/m.height;h.setTransform(C,0,0,x,0,0)}h.drawImage(m,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent($i.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function p2(n){if(n instanceof Fm){n.setMapInternal(null);return}n instanceof kc&&n.getLayers().forEach(p2)}function m2(n,e){if(n instanceof Fm){n.setMapInternal(e);return}if(n instanceof kc){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)m2(t[i],e)}}let X6=class extends ls{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=q6(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:y4,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=wr(),this.pixelToCoordinateTransform_=wr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ei||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ei||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ei?new Ki:x6()),this.interactions=t.interactions||(Ei?new Ki:W6({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new m6(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Dn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Dn.VIEW,this.handleViewChanged_),this.addChangeListener(Dn.SIZE,this.handleSizeChanged_),this.addChangeListener(Dn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof qr)&&e.view.then(function(r){i.setView(new qr(r))}),this.controls.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(ei.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(ei.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){m2(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:yd,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof kc?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:yd,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(Dn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return vv(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?cn(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Dn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ki){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ms(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?cn(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Dn.SIZE)}getView(){return this.get(Dn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return y6(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new No(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Pv.POINTERDOWN||i===ze.WHEEL||i===ze.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Nn.ANIMATING]||o[Nn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener($i.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent($i.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Mu(Lo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Mu(Lo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Rt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(ze.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(ze.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Bo(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Bo(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new H6(this)),!Bo(t)){this.mapBrowserEventHandler_=new _6(this,this.moveTolerance_);for(const r in Nt)this.mapBrowserEventHandler_.addEventListener(Nt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(ze.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(ze.WHEEL,this.boundHandleBrowserEvent_,Cb?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[tt(i,ze.KEYDOWN,this.handleBrowserEvent,this),tt(i,ze.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Rt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Rt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=tt(e,ic.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=tt(e,ze.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Rt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Oo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[tt(e,ic.PROPERTYCHANGE,this.render,this),tt(e,ze.CHANGE,this.render,this),tt(e,"addlayer",this.handleLayerAdd_,this),tt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){p2(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&VS(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:gv(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:nt(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const c=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=gv(l.nextCenter,l.nextResolution,c,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Pm(this.previousExtent_)&&!vd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Mu(Lo.MOVESTART,this,r)),this.previousExtent_=Sm(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Nn.ANIMATING]&&!s.viewHints[Nn.INTERACTING]&&!vd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Mu(Lo.MOVEEND,this,s)),YP(s.extent,this.previousExtent_))),this.dispatchEvent(new Mu(Lo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Lo.LOADSTART)||this.hasListener(Lo.LOADEND)||this.hasListener($i.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Oo("removelayer",t)),this.set(Dn.LAYERGROUP,e)}setSize(e){this.set(Dn.SIZE,e)}setTarget(e){this.set(Dn.TARGET,e)}setView(e){if(!e||e instanceof qr){this.set(Dn.VIEW,e);return}this.set(Dn.VIEW,new qr);const t=this;e.then(function(i){t.setView(new qr(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Bo(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!VS(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&ob("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!oa(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function q6(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new kc({layers:n.layers});t[Dn.LAYERGROUP]=i,t[Dn.TARGET]=n.target,t[Dn.VIEW]=n.view instanceof qr?n.view:new qr;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Ki(n.controls.slice()):(at(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Ki(n.interactions.slice()):(at(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Ki(n.overlays.slice()):(at(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Ki,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const C0="units",Y6=[1,2,5],bh=25.4/.28;class Z6 extends jm{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+Jd,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(C0,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(C0)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(C0,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=bp(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||bh)/bh,c=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||bh)/bh:void 0;let h=l*o,f="";if(r=="degrees"){const L=ac.degrees;h*=L,h<L/60?(f="",o*=3600):h<L?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let m=3*Math.floor(Math.log(l*o)/Math.log(10)),y,E,I,C=0,x,b;for(;;){I=Math.floor(m/3);const L=Math.pow(10,I);if(y=Y6[(m%3+3)%3]*L,E=Math.round(y/o),isNaN(E)){this.element.style.display="none",this.renderedVisible_=!1;return}if(c!==void 0&&E>=c){y=C,E=x,I=b;break}else if(E>=l)break;C=y,x=E,b=I,++m}const D=this.scaleBar_?this.createScaleBar(E,y,f):y.toFixed(I<0?-I:0)+" "+f;this.renderedHTML_!=D&&(this.innerElement_.innerHTML=D,this.renderedHTML_=D),this.renderedWidth_!=E&&(this.innerElement_.style.width=E+"px",this.renderedWidth_=E),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,c=[this.createMarker("absolute")];for(let f=0;f<o;++f){const m=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";c.push(`<div><div class="ol-scale-singlebar ${m}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return c.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+c.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),c=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${c}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=bp(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||bh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const Q6={},cC=n=>{let e;const t=new Set,i=(f,m)=>{const y=typeof f=="function"?f(e):f;if(!Object.is(y,e)){const E=e;e=m??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(I=>I(e,E))}},r=()=>e,c={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(Q6?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,c);return c},J6=n=>n?cC(n):cC;var R0={exports:{}},A0={},P0={exports:{}},b0={};var hC;function eU(){if(hC)return b0;hC=1;var n=Wd();function e(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(m,y){var E=y(),I=i({inst:{value:E,getSnapshot:y}}),C=I[0].inst,x=I[1];return s(function(){C.value=E,C.getSnapshot=y,c(C)&&x({inst:C})},[m,E,y]),r(function(){return c(C)&&x({inst:C}),m(function(){c(C)&&x({inst:C})})},[m]),o(E),E}function c(m){var y=m.getSnapshot;m=m.value;try{var E=y();return!t(m,E)}catch{return!0}}function h(m,y){return y()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return b0.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,b0}var dC;function tU(){return dC||(dC=1,P0.exports=eU()),P0.exports}var fC;function nU(){if(fC)return A0;fC=1;var n=Wd(),e=tU();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,c=n.useDebugValue;return A0.useSyncExternalStoreWithSelector=function(h,f,m,y,E){var I=s(null);if(I.current===null){var C={hasValue:!1,value:null};I.current=C}else C=I.current;I=l(function(){function b(W){if(!D){if(D=!0,L=W,W=y(W),E!==void 0&&C.hasValue){var P=C.value;if(E(P,W))return O=P}return O=W}if(P=O,i(L,W))return P;var R=y(W);return E!==void 0&&E(P,R)?(L=W,P):(L=W,O=R)}var D=!1,L,O,F=m===void 0?null:m;return[function(){return b(f())},F===null?void 0:function(){return b(F())}]},[f,m,y,E]);var x=r(h,I[0],I[1]);return o(function(){C.hasValue=!0,C.value=x},[x]),c(x),x},A0}var gC;function iU(){return gC||(gC=1,R0.exports=nU()),R0.exports}var rU=iU();const sU=gw(rU),y2={},{useDebugValue:oU}=DN,{useSyncExternalStoreWithSelector:aU}=sU;let pC=!1;const lU=n=>n;function uU(n,e=lU,t){(y2?"production":void 0)!=="production"&&t&&!pC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),pC=!0);const i=aU(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return oU(i),i}const mC=n=>{(y2?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?J6(n):n,t=(i,r)=>uU(e,i,r);return Object.assign(t,e),t},us=n=>n?mC(n):mC;var _2=Symbol.for("immer-nothing"),yC=Symbol.for("immer-draftable"),Ii=Symbol.for("immer-state");function gr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Pd=Object.getPrototypeOf;function dc(n){return!!n&&!!n[Ii]}function _l(n){return n?v2(n)||Array.isArray(n)||!!n[yC]||!!n.constructor?.[yC]||of(n)||zm(n):!1}var cU=Object.prototype.constructor.toString(),_C=new WeakMap;function v2(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=_C.get(t);return i===void 0&&(i=Function.toString.call(t),_C.set(t,i)),i===cU}function zp(n,e,t=!0){Um(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function Um(n){const e=n[Ii];return e?e.type_:Array.isArray(n)?1:of(n)?2:zm(n)?3:0}function kv(n,e){return Um(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function w2(n,e,t){const i=Um(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function hU(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function of(n){return n instanceof Map}function zm(n){return n instanceof Set}function za(n){return n.copy_||n.base_}function Dv(n,e){if(of(n))return new Map(n);if(zm(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=v2(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Ii];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Pd(n),i)}else{const i=Pd(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function ME(n,e=!1){return Bm(n)||dc(n)||!_l(n)||(Um(n)>1&&Object.defineProperties(n,{set:Bg,add:Bg,clear:Bg,delete:Bg}),Object.freeze(n),e&&Object.values(n).forEach(t=>ME(t,!0))),n}function dU(){gr(2)}var Bg={value:dU};function Bm(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var fU={};function vl(n){const e=fU[n];return e||gr(0,n),e}var bd;function E2(){return bd}function gU(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function vC(n,e){e&&(vl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Mv(n){Nv(n),n.drafts_.forEach(pU),n.drafts_=null}function Nv(n){n===bd&&(bd=n.parent_)}function wC(n){return bd=gU(bd,n)}function pU(n){const e=n[Ii];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function EC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Ii].modified_&&(Mv(e),gr(4)),_l(n)&&(n=Bp(e,n),e.parent_||Gp(e,n)),e.patches_&&vl("Patches").generateReplacementPatches_(t[Ii].base_,n,e.patches_,e.inversePatches_)):n=Bp(e,t,[]),Mv(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==_2?n:void 0}function Bp(n,e,t){if(Bm(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Ii];if(!r)return zp(e,(s,o)=>xC(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return Gp(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),zp(o,(c,h)=>xC(n,r,s,c,h,t,l),i),Gp(n,s,!1),t&&n.patches_&&vl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function xC(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=Bm(r);if(!(l&&!o)){if(dc(r)){const c=s&&e&&e.type_!==3&&!kv(e.assigned_,i)?s.concat(i):void 0,h=Bp(n,r,c);if(w2(t,i,h),dc(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(_l(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;Bp(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(of(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&Gp(n,r)}}}function Gp(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&ME(e,t)}function mU(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:E2(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=NE;t&&(r=[i],s=kd);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var NE={get(n,e){if(e===Ii)return n;const t=za(n);if(!kv(t,e))return yU(n,t,e);const i=t[e];return n.finalized_||!_l(i)?i:i===k0(n.base_,e)?(D0(n),n.copy_[e]=Ov(i,n)):i},has(n,e){return e in za(n)},ownKeys(n){return Reflect.ownKeys(za(n))},set(n,e,t){const i=x2(za(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=k0(za(n),e),s=r?.[Ii];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(hU(t,r)&&(t!==void 0||kv(n.base_,e)))return!0;D0(n),Lv(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return k0(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,D0(n),Lv(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=za(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){gr(11)},getPrototypeOf(n){return Pd(n.base_)},setPrototypeOf(){gr(12)}},kd={};zp(NE,(n,e)=>{kd[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});kd.deleteProperty=function(n,e){return kd.set.call(this,n,e,void 0)};kd.set=function(n,e,t){return NE.set.call(this,n[0],e,t,n[0])};function k0(n,e){const t=n[Ii];return(t?za(t):n)[e]}function yU(n,e,t){const i=x2(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function x2(n,e){if(!(e in n))return;let t=Pd(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Pd(t)}}function Lv(n){n.modified_||(n.modified_=!0,n.parent_&&Lv(n.parent_))}function D0(n){n.copy_||(n.copy_=Dv(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var _U=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(c=s,...h){return o.produce(c,f=>t.call(this,f,...h))}}typeof t!="function"&&gr(6),i!==void 0&&typeof i!="function"&&gr(7);let r;if(_l(e)){const s=wC(this),o=Ov(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?Mv(s):Nv(s)}return vC(s,i),EC(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===_2&&(r=void 0),this.autoFreeze_&&ME(r,!0),i){const s=[],o=[];vl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else gr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){_l(n)||gr(8),dc(n)&&(n=vU(n));const e=wC(this),t=Ov(n,void 0);return t[Ii].isManual_=!0,Nv(e),t}finishDraft(n,e){const t=n&&n[Ii];(!t||!t.isManual_)&&gr(9);const{scope_:i}=t;return vC(i,e),EC(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=vl("Patches").applyPatches_;return dc(n)?i(n,e):this.produce(n,r=>i(r,e))}};function Ov(n,e){const t=of(n)?vl("MapSet").proxyMap_(n,e):zm(n)?vl("MapSet").proxySet_(n,e):mU(n,e);return(e?e.scope_:E2()).drafts_.push(t),t}function vU(n){return dc(n)||gr(10,n),T2(n)}function T2(n){if(!_l(n)||Bm(n))return n;const e=n[Ii];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Dv(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=Dv(n,!0);return zp(t,(r,s)=>{w2(t,r,T2(s))},i),e&&(e.finalized_=!1),t}var wU=new _U,EU=wU.produce;const xU=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?EU(r):r;return e(l,s,...o)},n(i.setState,t,i)),Gm=xU,Gi=us()(Gm((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),I2={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await zg(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-IOKJg3XX.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Boothellingen:{name:"Boothellingen",factory:async()=>{const{createBoothellingenLayer:n}=await zg(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-C7JgCh2x.js");return{createBoothellingenLayer:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await zg(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-lHbIjW0X.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await zg(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-ZFHWmdgG.js");return{createViswaterLayer:e}},__vite__mapDeps([3,1]));return n()},immediateLoad:!1}};function TU(){return Object.values(I2).filter(n=>n.immediateLoad)}const cs=us()(Gm((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Ho=us()(Gm((n,e)=>({visible:{"CartoDB (licht)":!1,OpenStreetMap:!0,Luchtfoto:!1,Aanlegsteigers:!1,Boothellingen:!1,Dieptekaart:!1,Viswater:!1,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=I2[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=cs.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(c=>{c.layers[t]=o,c.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),Xi=us()(Gm(n=>({layerControlOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e||null})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),IU={};function SU(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=c=>c===null?null:JSON.parse(c,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Dd=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Dd(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Dd(i)(t)}}}},CU=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:x=>x,version:0,merge:(x,b)=>({...b,...x}),...e},o=!1;const l=new Set,c=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...x)},i,r);const f=Dd(s.serialize),m=()=>{const x=s.partialize({...i()});let b;const D=f({state:x,version:s.version}).then(L=>h.setItem(s.name,L)).catch(L=>{b=L});if(b)throw b;return D},y=r.setState;r.setState=(x,b)=>{y(x,b),m()};const E=n((...x)=>{t(...x),m()},i,r);let I;const C=()=>{var x;if(!h)return;o=!1,l.forEach(D=>D(i()));const b=((x=s.onRehydrateStorage)==null?void 0:x.call(s,i()))||void 0;return Dd(h.getItem.bind(h))(s.name).then(D=>{if(D)return s.deserialize(D)}).then(D=>{if(D)if(typeof D.version=="number"&&D.version!==s.version){if(s.migrate)return s.migrate(D.state,D.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return D.state}).then(D=>{var L;return I=s.merge(D,(L=i())!=null?L:E),t(I,!0),m()}).then(()=>{b?.(I,void 0),o=!0,c.forEach(D=>D(I))}).catch(D=>{b?.(void 0,D)})};return r.persist={setOptions:x=>{s={...s,...x},x.getStorage&&(h=x.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>C(),hasHydrated:()=>o,onHydrate:x=>(l.add(x),()=>{l.delete(x)}),onFinishHydration:x=>(c.add(x),()=>{c.delete(x)})},C(),I||E},RU=(n,e)=>(t,i,r)=>{let s={storage:SU(()=>localStorage),partialize:C=>C,version:0,merge:(C,x)=>({...x,...C}),...e},o=!1;const l=new Set,c=new Set;let h=s.storage;if(!h)return n((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...C)},i,r);const f=()=>{const C=s.partialize({...i()});return h.setItem(s.name,{state:C,version:s.version})},m=r.setState;r.setState=(C,x)=>{m(C,x),f()};const y=n((...C)=>{t(...C),f()},i,r);r.getInitialState=()=>y;let E;const I=()=>{var C,x;if(!h)return;o=!1,l.forEach(D=>{var L;return D((L=i())!=null?L:y)});const b=((x=s.onRehydrateStorage)==null?void 0:x.call(s,(C=i())!=null?C:y))||void 0;return Dd(h.getItem.bind(h))(s.name).then(D=>{if(D)if(typeof D.version=="number"&&D.version!==s.version){if(s.migrate)return[!0,s.migrate(D.state,D.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,D.state];return[!1,void 0]}).then(D=>{var L;const[O,F]=D;if(E=s.merge(F,(L=i())!=null?L:y),t(E,!0),O)return f()}).then(()=>{b?.(E,void 0),E=i(),o=!0,c.forEach(D=>D(E))}).catch(D=>{b?.(void 0,D)})};return r.persist={setOptions:C=>{s={...s,...C},C.storage&&(h=C.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:C=>(l.add(C),()=>{l.delete(C)}),onFinishHydration:C=>(c.add(C),()=>{c.delete(C)})},s.skipHydration||I(),E||y},AU=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((IU?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),CU(n,e)):RU(n,e),af=AU,ln=us()(af(n=>({defaultBackground:"OpenStreetMap",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e})}),{name:"visapp-settings"})),S2=us()(af((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),C2=us((n,e)=>({current:null,loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"}})),R2=us()(af(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),TC=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],IC=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],PU=us()(af((n,e)=>({presets:TC,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=Ho.getState().setLayerVisibility;IC.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=Ho.getState().visible,r=IC.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:TC})}}),{name:"visapp-presets"})),bU=()=>{};var SC={};const A2=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},kU=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},P2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,c=r+2<n.length,h=c?n[r+2]:0,f=s>>2,m=(s&3)<<4|l>>4;let y=(l&15)<<2|h>>6,E=h&63;c||(E=64,o||(y=64)),i.push(t[f],t[m],t[y],t[E])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(A2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):kU(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const m=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||m==null)throw new DU;const y=s<<2|l>>4;if(i.push(y),h!==64){const E=l<<4&240|h>>2;if(i.push(E),m!==64){const I=h<<6&192|m;i.push(I)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class DU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const MU=function(n){const e=A2(n);return P2.encodeByteArray(e,!0)},Wp=function(n){return MU(n).replace(/\./g,"")},b2=function(n){try{return P2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function k2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const NU=()=>k2().__FIREBASE_DEFAULTS__,LU=()=>{if(typeof process>"u"||typeof SC>"u")return;const n=SC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},OU=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&b2(n[1]);return e&&JSON.parse(e)},Wm=()=>{try{return bU()||NU()||LU()||OU()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},D2=n=>Wm()?.emulatorHosts?.[n],M2=n=>{const e=D2(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},N2=()=>Wm()?.config,L2=n=>Wm()?.[`_${n}`];class VU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Dl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function LE(n){return(await fetch(n,{credentials:"include"})).ok}function O2(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Wp(JSON.stringify(t)),Wp(JSON.stringify(o)),""].join(".")}const td={};function FU(){const n={prod:[],emulator:[]};for(const e of Object.keys(td))td[e]?n.emulator.push(e):n.prod.push(e);return n}function jU(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let CC=!1;function OE(n,e){if(typeof window>"u"||typeof document>"u"||!Dl(window.location.host)||td[n]===e||td[n]||CC)return;td[n]=e;function t(y){return`__firebase__banner__${y}`}const i="__firebase__banner",s=FU().prod.length>0;function o(){const y=document.getElementById(i);y&&y.remove()}function l(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function c(y,E){y.setAttribute("width","24"),y.setAttribute("id",E),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{CC=!0,o()},y}function f(y,E){y.setAttribute("id",E),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function m(){const y=jU(i),E=t("text"),I=document.getElementById(E)||document.createElement("span"),C=t("learnmore"),x=document.getElementById(C)||document.createElement("a"),b=t("preprendIcon"),D=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const L=y.element;l(L),f(x,C);const O=h();c(D,b),L.append(D,I,x,O),document.body.appendChild(L)}s?(I.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Jt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function UU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jt())}function V2(){const n=Wm()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function zU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function BU(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function GU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function WU(){const n=Jt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function F2(){return!V2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function j2(){return!V2()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function U2(){try{return typeof indexedDB=="object"}catch{return!1}}function KU(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const $U="FirebaseError";class hs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=$U,Object.setPrototypeOf(this,hs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lf.prototype.create)}}class lf{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?HU(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new hs(r,l,i)}}function HU(n,e){return n.replace(XU,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const XU=/\{\$([^}]+)}/g;function qU(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function wl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(RC(s)&&RC(o)){if(!wl(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function RC(n){return n!==null&&typeof n=="object"}function uf(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function YU(n,e){const t=new ZU(n,e);return t.subscribe.bind(t)}class ZU{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");QU(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=M0),r.error===void 0&&(r.error=M0),r.complete===void 0&&(r.complete=M0);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function QU(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function M0(){}function Qs(n){return n&&n._delegate?n._delegate:n}class ea{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ba="[DEFAULT]";class JU{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new VU;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tz(e))try{this.getOrInitializeService({instanceIdentifier:Ba})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ba){return this.instances.has(e)}getOptions(e=Ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:ez(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ba){return this.component?this.component.multipleInstances?e:Ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ez(n){return n===Ba?void 0:n}function tz(n){return n.instantiationMode==="EAGER"}class nz{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new JU(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var $e;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})($e||($e={}));const iz={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},rz=$e.INFO,sz={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},oz=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=sz[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class VE{constructor(e){this.name=e,this._logLevel=rz,this._logHandler=oz,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?iz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const az=(n,e)=>e.some(t=>n instanceof t);let AC,PC;function lz(){return AC||(AC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uz(){return PC||(PC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const z2=new WeakMap,Vv=new WeakMap,B2=new WeakMap,N0=new WeakMap,FE=new WeakMap;function cz(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Xo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&z2.set(t,n)}).catch(()=>{}),FE.set(e,n),e}function hz(n){if(Vv.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Vv.set(n,e)}let Fv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Vv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||B2.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function dz(n){Fv=n(Fv)}function fz(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(L0(this),e,...t);return B2.set(i,e.sort?e.sort():[e]),Xo(i)}:uz().includes(n)?function(...e){return n.apply(L0(this),e),Xo(z2.get(this))}:function(...e){return Xo(n.apply(L0(this),e))}}function gz(n){return typeof n=="function"?fz(n):(n instanceof IDBTransaction&&hz(n),az(n,lz())?new Proxy(n,Fv):n)}function Xo(n){if(n instanceof IDBRequest)return cz(n);if(N0.has(n))return N0.get(n);const e=gz(n);return e!==n&&(N0.set(n,e),FE.set(e,n)),e}const L0=n=>FE.get(n);function pz(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Xo(o);return i&&o.addEventListener("upgradeneeded",c=>{i(Xo(o.result),c.oldVersion,c.newVersion,Xo(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const mz=["get","getKey","getAll","getAllKeys","count"],yz=["put","add","delete","clear"],O0=new Map;function bC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(O0.get(e))return O0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=yz.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||mz.includes(t)))return;const s=async function(o,...l){const c=this.transaction(o,r?"readwrite":"readonly");let h=c.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&c.done]))[0]};return O0.set(e,s),s}dz(n=>({...n,get:(e,t,i)=>bC(e,t)||n.get(e,t,i),has:(e,t)=>!!bC(e,t)||n.has(e,t)}));class _z{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(vz(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function vz(n){return n.getComponent()?.type==="VERSION"}const jv="@firebase/app",kC="0.14.6";const Xs=new VE("@firebase/app"),wz="@firebase/app-compat",Ez="@firebase/analytics-compat",xz="@firebase/analytics",Tz="@firebase/app-check-compat",Iz="@firebase/app-check",Sz="@firebase/auth",Cz="@firebase/auth-compat",Rz="@firebase/database",Az="@firebase/data-connect",Pz="@firebase/database-compat",bz="@firebase/functions",kz="@firebase/functions-compat",Dz="@firebase/installations",Mz="@firebase/installations-compat",Nz="@firebase/messaging",Lz="@firebase/messaging-compat",Oz="@firebase/performance",Vz="@firebase/performance-compat",Fz="@firebase/remote-config",jz="@firebase/remote-config-compat",Uz="@firebase/storage",zz="@firebase/storage-compat",Bz="@firebase/firestore",Gz="@firebase/ai",Wz="@firebase/firestore-compat",Kz="firebase",$z="12.6.0";const Uv="[DEFAULT]",Hz={[jv]:"fire-core",[wz]:"fire-core-compat",[xz]:"fire-analytics",[Ez]:"fire-analytics-compat",[Iz]:"fire-app-check",[Tz]:"fire-app-check-compat",[Sz]:"fire-auth",[Cz]:"fire-auth-compat",[Rz]:"fire-rtdb",[Az]:"fire-data-connect",[Pz]:"fire-rtdb-compat",[bz]:"fire-fn",[kz]:"fire-fn-compat",[Dz]:"fire-iid",[Mz]:"fire-iid-compat",[Nz]:"fire-fcm",[Lz]:"fire-fcm-compat",[Oz]:"fire-perf",[Vz]:"fire-perf-compat",[Fz]:"fire-rc",[jz]:"fire-rc-compat",[Uz]:"fire-gcs",[zz]:"fire-gcs-compat",[Bz]:"fire-fst",[Wz]:"fire-fst-compat",[Gz]:"fire-vertex","fire-js":"fire-js",[Kz]:"fire-js-all"};const Kp=new Map,Xz=new Map,zv=new Map;function DC(n,e){try{n.container.addComponent(e)}catch(t){Xs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function El(n){const e=n.name;if(zv.has(e))return Xs.debug(`There were multiple attempts to register component ${e}.`),!1;zv.set(e,n);for(const t of Kp.values())DC(t,n);for(const t of Xz.values())DC(t,n);return!0}function Km(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Wi(n){return n==null?!1:n.settings!==void 0}const qz={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qo=new lf("app","Firebase",qz);class Yz{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ea("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qo.create("app-deleted",{appName:this._name})}}const Ml=$z;function G2(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Uv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw qo.create("bad-app-name",{appName:String(r)});if(t||(t=N2()),!t)throw qo.create("no-options");const s=Kp.get(r);if(s){if(wl(t,s.options)&&wl(i,s.config))return s;throw qo.create("duplicate-app",{appName:r})}const o=new nz(r);for(const c of zv.values())o.addComponent(c);const l=new Yz(t,i,o);return Kp.set(r,l),l}function jE(n=Uv){const e=Kp.get(n);if(!e&&n===Uv&&N2())return G2();if(!e)throw qo.create("no-app",{appName:n});return e}function ns(n,e,t){let i=Hz[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xs.warn(o.join(" "));return}El(new ea(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const Zz="firebase-heartbeat-database",Qz=1,Md="firebase-heartbeat-store";let V0=null;function W2(){return V0||(V0=pz(Zz,Qz,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Md)}catch(t){console.warn(t)}}}}).catch(n=>{throw qo.create("idb-open",{originalErrorMessage:n.message})})),V0}async function Jz(n){try{const t=(await W2()).transaction(Md),i=await t.objectStore(Md).get(K2(n));return await t.done,i}catch(e){if(e instanceof hs)Xs.warn(e.message);else{const t=qo.create("idb-get",{originalErrorMessage:e?.message});Xs.warn(t.message)}}}async function MC(n,e){try{const i=(await W2()).transaction(Md,"readwrite");await i.objectStore(Md).put(e,K2(n)),await i.done}catch(t){if(t instanceof hs)Xs.warn(t.message);else{const i=qo.create("idb-set",{originalErrorMessage:t?.message});Xs.warn(i.message)}}}function K2(n){return`${n.name}!${n.options.appId}`}const eB=1024,tB=30;class nB{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new rB(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=NC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>tB){const r=sB(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=NC(),{heartbeatsToSend:t,unsentEntries:i}=iB(this._heartbeatsCache.heartbeats),r=Wp(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Xs.warn(e),""}}}function NC(){return new Date().toISOString().substring(0,10)}function iB(n,e=eB){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),LC(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),LC(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class rB{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return U2()?KU().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Jz(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return MC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return MC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function LC(n){return Wp(JSON.stringify({version:2,heartbeats:n})).length}function sB(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function oB(n){El(new ea("platform-logger",e=>new _z(e),"PRIVATE")),El(new ea("heartbeat",e=>new nB(e),"PRIVATE")),ns(jv,kC,n),ns(jv,kC,"esm2020"),ns("fire-js","")}oB("");function $2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const aB=$2,H2=new lf("auth","Firebase",$2());const $p=new VE("@firebase/auth");function lB(n,...e){$p.logLevel<=$e.WARN&&$p.warn(`Auth (${Ml}): ${n}`,...e)}function sp(n,...e){$p.logLevel<=$e.ERROR&&$p.error(`Auth (${Ml}): ${n}`,...e)}function rs(n,...e){throw zE(n,...e)}function Er(n,...e){return zE(n,...e)}function UE(n,e,t){const i={...aB(),[e]:t};return new lf("auth","Firebase",i).create(e,{appName:n.name})}function al(n){return UE(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uB(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&rs(n,"argument-error"),UE(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function zE(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return H2.create(n,...e)}function Oe(n,e,...t){if(!n)throw zE(e,...t)}function Vs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw sp(e),new Error(e)}function qs(n,e){n||Vs(e)}function Bv(){return typeof self<"u"&&self.location?.href||""}function cB(){return OC()==="http:"||OC()==="https:"}function OC(){return typeof self<"u"&&self.location?.protocol||null}function hB(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(cB()||BU()||"connection"in navigator)?navigator.onLine:!0}function dB(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class cf{constructor(e,t){this.shortDelay=e,this.longDelay=t,qs(t>e,"Short delay should be less than long delay!"),this.isMobile=UU()||GU()}get(){return hB()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function BE(n,e){qs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class X2{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const fB={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const gB=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],pB=new cf(3e4,6e4);function GE(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Dc(n,e,t,i,r={}){return q2(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=uf({key:n.config.apiKey,...o}).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:c,...s};return zU()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(h.credentials="include"),X2.fetch()(await Y2(n,n.config.apiHost,t,l),h)})}async function q2(n,e,t){n._canInitEmulator=!1;const i={...fB,...e};try{const r=new yB(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Gg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,h]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gg(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Gg(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Gg(n,"user-disabled",o);const f=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw UE(n,f,h);rs(n,f)}}catch(r){if(r instanceof hs)throw r;rs(n,"network-request-failed",{message:String(r)})}}async function mB(n,e,t,i,r={}){const s=await Dc(n,e,t,i,r);return"mfaPendingCredential"in s&&rs(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Y2(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?BE(n.config,r):`${n.config.apiScheme}://${r}`;return gB.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class yB{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Er(this.auth,"network-request-failed")),pB.get())})}}function Gg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Er(n,e,i);return r.customData._tokenResponse=t,r}async function _B(n,e){return Dc(n,"POST","/v1/accounts:delete",e)}async function Hp(n,e){return Dc(n,"POST","/v1/accounts:lookup",e)}function nd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function vB(n,e=!1){const t=Qs(n),i=await t.getIdToken(e),r=WE(i);Oe(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:nd(F0(r.auth_time)),issuedAtTime:nd(F0(r.iat)),expirationTime:nd(F0(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function F0(n){return Number(n)*1e3}function WE(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return sp("JWT malformed, contained fewer than 3 sections"),null;try{const r=b2(t);return r?JSON.parse(r):(sp("Failed to decode base64 JWT payload"),null)}catch(r){return sp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function VC(n){const e=WE(n);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Nd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof hs&&wB(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function wB({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class EB{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Gv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=nd(this.lastLoginAt),this.creationTime=nd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Xp(n){const e=n.auth,t=await n.getIdToken(),i=await Nd(n,Hp(e,{idToken:t}));Oe(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?Z2(r.providerUserInfo):[],o=TB(n.providerData,s),l=n.isAnonymous,c=!(n.email&&r.passwordHash)&&!o?.length,h=l?c:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Gv(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function xB(n){const e=Qs(n);await Xp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function TB(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function Z2(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function IB(n,e){const t=await q2(n,{},async()=>{const i=uf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await Y2(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:i};return n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(c.credentials="include"),X2.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function SB(n,e){return Dc(n,"POST","/v2/accounts:revokeToken",GE(n,e))}class Yu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):VC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const t=VC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await IB(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Yu;return i&&(Oe(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Oe(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Oe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yu,this.toJSON())}_performRefresh(){return Vs("not implemented")}}function Po(n,e){Oe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class mr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new EB(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Gv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Nd(this,this.stsTokenManager.getToken(this.auth,e));return Oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return vB(this,e)}reload(){return xB(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new mr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Xp(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Wi(this.auth.app))return Promise.reject(al(this.auth));const e=await this.getIdToken();return await Nd(this,_B(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,c=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:m,emailVerified:y,isAnonymous:E,providerData:I,stsTokenManager:C}=t;Oe(m&&C,e,"internal-error");const x=Yu.fromJSON(this.name,C);Oe(typeof m=="string",e,"internal-error"),Po(i,e.name),Po(r,e.name),Oe(typeof y=="boolean",e,"internal-error"),Oe(typeof E=="boolean",e,"internal-error"),Po(s,e.name),Po(o,e.name),Po(l,e.name),Po(c,e.name),Po(h,e.name),Po(f,e.name);const b=new mr({uid:m,auth:e,email:r,emailVerified:y,displayName:i,isAnonymous:E,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:x,createdAt:h,lastLoginAt:f});return I&&Array.isArray(I)&&(b.providerData=I.map(D=>({...D}))),c&&(b._redirectEventId=c),b}static async _fromIdTokenResponse(e,t,i=!1){const r=new Yu;r.updateFromServerResponse(t);const s=new mr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Xp(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Oe(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?Z2(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new Yu;l.updateFromIdToken(i);const c=new mr({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Gv(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(c,h),c}}const FC=new Map;function Fs(n){qs(n instanceof Function,"Expected a class definition");let e=FC.get(n);return e?(qs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,FC.set(n,e),e)}class Q2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Q2.type="NONE";const jC=Q2;function op(n,e,t){return`firebase:${n}:${e}:${t}`}class Zu{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=op(this.userKey,r.apiKey,s),this.fullPersistenceKey=op("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Hp(this.auth,{idToken:e}).catch(()=>{});return t?mr._fromGetAccountInfoResponse(this.auth,t,e):null}return mr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Zu(Fs(jC),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Fs(jC);const o=op(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let m;if(typeof f=="string"){const y=await Hp(e,{idToken:f}).catch(()=>{});if(!y)break;m=await mr._fromGetAccountInfoResponse(e,y,f)}else m=mr._fromJSON(e,f);h!==s&&(l=m),s=h;break}}catch{}const c=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Zu(s,e,i):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Zu(s,e,i))}}function UC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(J2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(rk(e))return"Blackberry";if(sk(e))return"Webos";if(ek(e))return"Safari";if((e.includes("chrome/")||tk(e))&&!e.includes("edge/"))return"Chrome";if(ik(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function J2(n=Jt()){return/firefox\//i.test(n)}function ek(n=Jt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tk(n=Jt()){return/crios\//i.test(n)}function nk(n=Jt()){return/iemobile/i.test(n)}function ik(n=Jt()){return/android/i.test(n)}function rk(n=Jt()){return/blackberry/i.test(n)}function sk(n=Jt()){return/webos/i.test(n)}function KE(n=Jt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function CB(n=Jt()){return KE(n)&&!!window.navigator?.standalone}function RB(){return WU()&&document.documentMode===10}function ok(n=Jt()){return KE(n)||ik(n)||sk(n)||rk(n)||/windows phone/i.test(n)||nk(n)}function ak(n,e=[]){let t;switch(n){case"Browser":t=UC(Jt());break;case"Worker":t=`${UC(Jt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ml}/${i}`}class AB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function PB(n,e={}){return Dc(n,"GET","/v2/passwordPolicy",GE(n,e))}const bB=6;class kB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??bB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class DB{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zC(this),this.idTokenSubscription=new zC(this),this.beforeStateQueue=new AB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=H2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Fs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Zu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Hp(this,{idToken:e}),i=await mr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Wi(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Xp(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=dB()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Wi(this.app))return Promise.reject(al(this));const t=e?Qs(e):null;return t&&Oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Wi(this.app)?Promise.reject(al(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Wi(this.app)?Promise.reject(al(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await PB(this),t=new kB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lf("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await SB(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Fs(e)||this._popupRedirectResolver;Oe(t,this,"argument-error"),this.redirectPersistenceManager=await Zu.create(this,[Fs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,i,r);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ak(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Wi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&lB(`Error while retrieving App Check token: ${e.error}`),e?.token}}function $m(n){return Qs(n)}class zC{constructor(e){this.auth=e,this.observer=null,this.addObserver=YU(t=>this.observer=t)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let $E={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function MB(n){$E=n}function NB(n){return $E.loadJS(n)}function LB(){return $E.gapiScript}function OB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function VB(n,e){const t=Km(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(wl(s,e??{}))return r;rs(r,"already-initialized")}return t.initialize({options:e})}function FB(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Fs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function jB(n,e,t){const i=$m(n);Oe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=lk(e),{host:o,port:l}=UB(e),c=l===null?"":`:${l}`,h={url:`${s}//${o}${c}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Oe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Oe(wl(h,i.config.emulator)&&wl(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Dl(o)?(LE(`${s}//${o}${c}`),OE("Auth",!0)):zB()}function lk(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function UB(n){const e=lk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:BC(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:BC(o)}}}function BC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function zB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class uk{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Vs("not implemented")}_getIdTokenResponse(e){return Vs("not implemented")}_linkToIdToken(e,t){return Vs("not implemented")}_getReauthenticationResolver(e){return Vs("not implemented")}}async function Qu(n,e){return mB(n,"POST","/v1/accounts:signInWithIdp",GE(n,e))}const BB="http://localhost";class xl extends uk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new xl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):rs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new xl(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Qu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Qu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qu(e,t)}buildRequest(){const e={requestUri:BB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=uf(t)}return e}}class HE{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class hf extends HE{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Vo extends hf{constructor(){super("facebook.com")}static credential(e){return xl._fromParams({providerId:Vo.PROVIDER_ID,signInMethod:Vo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vo.credentialFromTaggedObject(e)}static credentialFromError(e){return Vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vo.credential(e.oauthAccessToken)}catch{return null}}}Vo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Vo.PROVIDER_ID="facebook.com";class Ls extends hf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return xl._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ls.credential(t,i)}catch{return null}}}Ls.GOOGLE_SIGN_IN_METHOD="google.com";Ls.PROVIDER_ID="google.com";class Fo extends hf{constructor(){super("github.com")}static credential(e){return xl._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fo.credential(e.oauthAccessToken)}catch{return null}}}Fo.GITHUB_SIGN_IN_METHOD="github.com";Fo.PROVIDER_ID="github.com";class jo extends hf{constructor(){super("twitter.com")}static credential(e,t){return xl._fromParams({providerId:jo.PROVIDER_ID,signInMethod:jo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return jo.credentialFromTaggedObject(e)}static credentialFromError(e){return jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return jo.credential(t,i)}catch{return null}}}jo.TWITTER_SIGN_IN_METHOD="twitter.com";jo.PROVIDER_ID="twitter.com";class fc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await mr._fromIdTokenResponse(e,i,r),o=GC(i);return new fc({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=GC(i);return new fc({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function GC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class qp extends hs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,qp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new qp(e,t,i,r)}}function ck(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?qp._fromErrorAndOperation(n,s,e,i):s})}async function GB(n,e,t=!1){const i=await Nd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return fc._forOperation(n,"link",i)}async function WB(n,e,t=!1){const{auth:i}=n;if(Wi(i.app))return Promise.reject(al(i));const r="reauthenticate";try{const s=await Nd(n,ck(i,r,e,n),t);Oe(s.idToken,i,"internal-error");const o=WE(s.idToken);Oe(o,i,"internal-error");const{sub:l}=o;return Oe(n.uid===l,i,"user-mismatch"),fc._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&rs(i,"user-mismatch"),s}}async function KB(n,e,t=!1){if(Wi(n.app))return Promise.reject(al(n));const i="signIn",r=await ck(n,i,e),s=await fc._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function $B(n,e,t,i){return Qs(n).onIdTokenChanged(e,t,i)}function HB(n,e,t){return Qs(n).beforeAuthStateChanged(e,t)}function XB(n,e,t,i){return Qs(n).onAuthStateChanged(e,t,i)}function qB(n){return Qs(n).signOut()}const Yp="__sak";class hk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Yp,"1"),this.storage.removeItem(Yp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const YB=1e3,ZB=10;class dk extends hk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ok(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);RB()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,ZB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},YB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}dk.type="LOCAL";const QB=dk;class fk extends hk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}fk.type="SESSION";const gk=fk;function JB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Hm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Hm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),c=await JB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hm.receivers=[];function XE(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class e9{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const h=XE("",20);r.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(m){const y=m;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(y.data.response);break;default:clearTimeout(f),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function is(){return window}function t9(n){is().location.href=n}function pk(){return typeof is().WorkerGlobalScope<"u"&&typeof is().importScripts=="function"}async function n9(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function i9(){return navigator?.serviceWorker?.controller||null}function r9(){return pk()?self:null}const mk="firebaseLocalStorageDb",s9=1,Zp="firebaseLocalStorage",yk="fbase_key";class df{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Xm(n,e){return n.transaction([Zp],e?"readwrite":"readonly").objectStore(Zp)}function o9(){const n=indexedDB.deleteDatabase(mk);return new df(n).toPromise()}function Wv(){const n=indexedDB.open(mk,s9);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Zp,{keyPath:yk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Zp)?e(i):(i.close(),await o9(),e(await Wv()))})})}async function WC(n,e,t){const i=Xm(n,!0).put({[yk]:e,value:t});return new df(i).toPromise()}async function a9(n,e){const t=Xm(n,!1).get(e),i=await new df(t).toPromise();return i===void 0?null:i.value}function KC(n,e){const t=Xm(n,!0).delete(e);return new df(t).toPromise()}const l9=800,u9=3;class _k{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Wv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>u9)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return pk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hm._getInstance(r9()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await n9(),!this.activeServiceWorker)return;this.sender=new e9(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||i9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Wv();return await WC(e,Yp,"1"),await KC(e,Yp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>WC(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>a9(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>KC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=Xm(r,!1).getAll();return new df(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),l9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}_k.type="LOCAL";const c9=_k;new cf(3e4,6e4);function vk(n,e){return e?Fs(e):(Oe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class qE extends uk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function h9(n){return KB(n.auth,new qE(n),n.bypassAuthState)}function d9(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),WB(t,new qE(n),n.bypassAuthState)}async function f9(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),GB(t,new qE(n),n.bypassAuthState)}class wk{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return h9;case"linkViaPopup":case"linkViaRedirect":return f9;case"reauthViaPopup":case"reauthViaRedirect":return d9;default:rs(this.auth,"internal-error")}}resolve(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const g9=new cf(2e3,1e4);async function p9(n,e,t){if(Wi(n.app))return Promise.reject(Er(n,"operation-not-supported-in-this-environment"));const i=$m(n);uB(n,e,HE);const r=vk(i,t);return new tl(i,"signInViaPopup",e,r).executeNotNull()}class tl extends wk{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,tl.currentPopupAction&&tl.currentPopupAction.cancel(),tl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){qs(this.filter.length===1,"Popup operations only handle one event");const e=XE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Er(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Er(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Er(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,g9.get())};e()}}tl.currentPopupAction=null;const m9="pendingRedirect",ap=new Map;class y9 extends wk{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=ap.get(this.auth._key());if(!e){try{const i=await _9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}ap.set(this.auth._key(),e)}return this.bypassAuthState||ap.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _9(n,e){const t=E9(e),i=w9(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function v9(n,e){ap.set(n._key(),e)}function w9(n){return Fs(n._redirectPersistence)}function E9(n){return op(m9,n.config.apiKey,n.name)}async function x9(n,e,t=!1){if(Wi(n.app))return Promise.reject(al(n));const i=$m(n),r=vk(i,e),o=await new y9(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const T9=600*1e3;class I9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!S9(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Ek(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Er(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=T9&&this.cachedEventUids.clear(),this.cachedEventUids.has($C(e))}saveEventToCache(e){this.cachedEventUids.add($C(e)),this.lastProcessedEventTime=Date.now()}}function $C(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Ek({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function S9(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ek(n);default:return!1}}async function C9(n,e={}){return Dc(n,"GET","/v1/projects",e)}const R9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,A9=/^https?/;async function P9(n){if(n.config.emulator)return;const{authorizedDomains:e}=await C9(n);for(const t of e)try{if(b9(t))return}catch{}rs(n,"unauthorized-domain")}function b9(n){const e=Bv(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!A9.test(t))return!1;if(R9.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const k9=new cf(3e4,6e4);function HC(){const n=is().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function D9(n){return new Promise((e,t)=>{function i(){HC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{HC(),t(Er(n,"network-request-failed"))},timeout:k9.get()})}if(is().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(is().gapi?.load)i();else{const r=OB("iframefcb");return is()[r]=()=>{gapi.load?i():t(Er(n,"network-request-failed"))},NB(`${LB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw lp=null,e})}let lp=null;function M9(n){return lp=lp||D9(n),lp}const N9=new cf(5e3,15e3),L9="__/auth/iframe",O9="emulator/auth/iframe",V9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},F9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function j9(n){const e=n.config;Oe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?BE(e,O9):`https://${n.config.authDomain}/${L9}`,i={apiKey:e.apiKey,appName:n.name,v:Ml},r=F9.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${uf(i).slice(1)}`}async function U9(n){const e=await M9(n),t=is().gapi;return Oe(t,n,"internal-error"),e.open({where:document.body,url:j9(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:V9,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Er(n,"network-request-failed"),l=is().setTimeout(()=>{s(o)},N9.get());function c(){is().clearTimeout(l),r(i)}i.ping(c).then(c,()=>{s(o)})}))}const z9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},B9=500,G9=600,W9="_blank",K9="http://localhost";class XC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $9(n,e,t,i=B9,r=G9){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const c={...z9,width:i.toString(),height:r.toString(),top:s,left:o},h=Jt().toLowerCase();t&&(l=tk(h)?W9:t),J2(h)&&(e=e||K9,c.scrollbars="yes");const f=Object.entries(c).reduce((y,[E,I])=>`${y}${E}=${I},`,"");if(CB(h)&&l!=="_self")return H9(e||"",l),new XC(null);const m=window.open(e||"",l,f);Oe(m,n,"popup-blocked");try{m.focus()}catch{}return new XC(m)}function H9(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const X9="__/auth/handler",q9="emulator/auth/handler",Y9=encodeURIComponent("fac");async function qC(n,e,t,i,r,s){Oe(n.config.authDomain,n,"auth-domain-config-required"),Oe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ml,eventId:r};if(e instanceof HE){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",qU(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof hf){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const c=await n._getAppCheckToken(),h=c?`#${Y9}=${encodeURIComponent(c)}`:"";return`${Z9(n)}?${uf(l).slice(1)}${h}`}function Z9({config:n}){return n.emulator?BE(n,q9):`https://${n.authDomain}/${X9}`}const j0="webStorageSupport";class Q9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gk,this._completeRedirectFn=x9,this._overrideRedirectResult=v9}async _openPopup(e,t,i,r){qs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await qC(e,t,i,Bv(),r);return $9(e,s,XE())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await qC(e,t,i,Bv(),r);return t9(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(qs(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await U9(e),i=new I9(e);return t.register("authEvent",r=>(Oe(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(j0,{type:j0},r=>{const s=r?.[0]?.[j0];s!==void 0&&t(!!s),rs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=P9(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ok()||ek()||KE()}}const J9=Q9;var YC="@firebase/auth",ZC="1.12.0";class e8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function t8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function n8(n){El(new ea("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Oe(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ak(n)},h=new DB(i,r,s,c);return FB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),El(new ea("auth-internal",e=>{const t=$m(e.getProvider("auth").getImmediate());return(i=>new e8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ns(YC,ZC,t8(n)),ns(YC,ZC,"esm2020")}const i8=300,r8=L2("authIdTokenMaxAge")||i8;let QC=null;const s8=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>r8)return;const r=t?.token;QC!==r&&(QC=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function o8(n=jE()){const e=Km(n,"auth");if(e.isInitialized())return e.getImmediate();const t=VB(n,{popupRedirectResolver:J9,persistence:[c9,QB,gk]}),i=L2("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=s8(s.toString());HB(t,o,()=>o(t.currentUser)),$B(t,l=>o(l))}}const r=D2("auth");return r&&jB(t,`http://${r}`),t}function a8(){return document.getElementsByTagName("head")?.[0]??document}MB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Er("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",a8().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});n8("Browser");var l8="firebase",u8="12.7.0";ns(l8,u8,"app");var JC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var YE;(function(){var n;function e(P,R){function k(){}k.prototype=R.prototype,P.F=R.prototype,P.prototype=new k,P.prototype.constructor=P,P.D=function(V,j,z){for(var N=Array(arguments.length-2),le=2;le<arguments.length;le++)N[le-2]=arguments[le];return R.prototype[j].apply(V,N)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(P,R,k){k||(k=0);const V=Array(16);if(typeof R=="string")for(var j=0;j<16;++j)V[j]=R.charCodeAt(k++)|R.charCodeAt(k++)<<8|R.charCodeAt(k++)<<16|R.charCodeAt(k++)<<24;else for(j=0;j<16;++j)V[j]=R[k++]|R[k++]<<8|R[k++]<<16|R[k++]<<24;R=P.g[0],k=P.g[1],j=P.g[2];let z=P.g[3],N;N=R+(z^k&(j^z))+V[0]+3614090360&4294967295,R=k+(N<<7&4294967295|N>>>25),N=z+(j^R&(k^j))+V[1]+3905402710&4294967295,z=R+(N<<12&4294967295|N>>>20),N=j+(k^z&(R^k))+V[2]+606105819&4294967295,j=z+(N<<17&4294967295|N>>>15),N=k+(R^j&(z^R))+V[3]+3250441966&4294967295,k=j+(N<<22&4294967295|N>>>10),N=R+(z^k&(j^z))+V[4]+4118548399&4294967295,R=k+(N<<7&4294967295|N>>>25),N=z+(j^R&(k^j))+V[5]+1200080426&4294967295,z=R+(N<<12&4294967295|N>>>20),N=j+(k^z&(R^k))+V[6]+2821735955&4294967295,j=z+(N<<17&4294967295|N>>>15),N=k+(R^j&(z^R))+V[7]+4249261313&4294967295,k=j+(N<<22&4294967295|N>>>10),N=R+(z^k&(j^z))+V[8]+1770035416&4294967295,R=k+(N<<7&4294967295|N>>>25),N=z+(j^R&(k^j))+V[9]+2336552879&4294967295,z=R+(N<<12&4294967295|N>>>20),N=j+(k^z&(R^k))+V[10]+4294925233&4294967295,j=z+(N<<17&4294967295|N>>>15),N=k+(R^j&(z^R))+V[11]+2304563134&4294967295,k=j+(N<<22&4294967295|N>>>10),N=R+(z^k&(j^z))+V[12]+1804603682&4294967295,R=k+(N<<7&4294967295|N>>>25),N=z+(j^R&(k^j))+V[13]+4254626195&4294967295,z=R+(N<<12&4294967295|N>>>20),N=j+(k^z&(R^k))+V[14]+2792965006&4294967295,j=z+(N<<17&4294967295|N>>>15),N=k+(R^j&(z^R))+V[15]+1236535329&4294967295,k=j+(N<<22&4294967295|N>>>10),N=R+(j^z&(k^j))+V[1]+4129170786&4294967295,R=k+(N<<5&4294967295|N>>>27),N=z+(k^j&(R^k))+V[6]+3225465664&4294967295,z=R+(N<<9&4294967295|N>>>23),N=j+(R^k&(z^R))+V[11]+643717713&4294967295,j=z+(N<<14&4294967295|N>>>18),N=k+(z^R&(j^z))+V[0]+3921069994&4294967295,k=j+(N<<20&4294967295|N>>>12),N=R+(j^z&(k^j))+V[5]+3593408605&4294967295,R=k+(N<<5&4294967295|N>>>27),N=z+(k^j&(R^k))+V[10]+38016083&4294967295,z=R+(N<<9&4294967295|N>>>23),N=j+(R^k&(z^R))+V[15]+3634488961&4294967295,j=z+(N<<14&4294967295|N>>>18),N=k+(z^R&(j^z))+V[4]+3889429448&4294967295,k=j+(N<<20&4294967295|N>>>12),N=R+(j^z&(k^j))+V[9]+568446438&4294967295,R=k+(N<<5&4294967295|N>>>27),N=z+(k^j&(R^k))+V[14]+3275163606&4294967295,z=R+(N<<9&4294967295|N>>>23),N=j+(R^k&(z^R))+V[3]+4107603335&4294967295,j=z+(N<<14&4294967295|N>>>18),N=k+(z^R&(j^z))+V[8]+1163531501&4294967295,k=j+(N<<20&4294967295|N>>>12),N=R+(j^z&(k^j))+V[13]+2850285829&4294967295,R=k+(N<<5&4294967295|N>>>27),N=z+(k^j&(R^k))+V[2]+4243563512&4294967295,z=R+(N<<9&4294967295|N>>>23),N=j+(R^k&(z^R))+V[7]+1735328473&4294967295,j=z+(N<<14&4294967295|N>>>18),N=k+(z^R&(j^z))+V[12]+2368359562&4294967295,k=j+(N<<20&4294967295|N>>>12),N=R+(k^j^z)+V[5]+4294588738&4294967295,R=k+(N<<4&4294967295|N>>>28),N=z+(R^k^j)+V[8]+2272392833&4294967295,z=R+(N<<11&4294967295|N>>>21),N=j+(z^R^k)+V[11]+1839030562&4294967295,j=z+(N<<16&4294967295|N>>>16),N=k+(j^z^R)+V[14]+4259657740&4294967295,k=j+(N<<23&4294967295|N>>>9),N=R+(k^j^z)+V[1]+2763975236&4294967295,R=k+(N<<4&4294967295|N>>>28),N=z+(R^k^j)+V[4]+1272893353&4294967295,z=R+(N<<11&4294967295|N>>>21),N=j+(z^R^k)+V[7]+4139469664&4294967295,j=z+(N<<16&4294967295|N>>>16),N=k+(j^z^R)+V[10]+3200236656&4294967295,k=j+(N<<23&4294967295|N>>>9),N=R+(k^j^z)+V[13]+681279174&4294967295,R=k+(N<<4&4294967295|N>>>28),N=z+(R^k^j)+V[0]+3936430074&4294967295,z=R+(N<<11&4294967295|N>>>21),N=j+(z^R^k)+V[3]+3572445317&4294967295,j=z+(N<<16&4294967295|N>>>16),N=k+(j^z^R)+V[6]+76029189&4294967295,k=j+(N<<23&4294967295|N>>>9),N=R+(k^j^z)+V[9]+3654602809&4294967295,R=k+(N<<4&4294967295|N>>>28),N=z+(R^k^j)+V[12]+3873151461&4294967295,z=R+(N<<11&4294967295|N>>>21),N=j+(z^R^k)+V[15]+530742520&4294967295,j=z+(N<<16&4294967295|N>>>16),N=k+(j^z^R)+V[2]+3299628645&4294967295,k=j+(N<<23&4294967295|N>>>9),N=R+(j^(k|~z))+V[0]+4096336452&4294967295,R=k+(N<<6&4294967295|N>>>26),N=z+(k^(R|~j))+V[7]+1126891415&4294967295,z=R+(N<<10&4294967295|N>>>22),N=j+(R^(z|~k))+V[14]+2878612391&4294967295,j=z+(N<<15&4294967295|N>>>17),N=k+(z^(j|~R))+V[5]+4237533241&4294967295,k=j+(N<<21&4294967295|N>>>11),N=R+(j^(k|~z))+V[12]+1700485571&4294967295,R=k+(N<<6&4294967295|N>>>26),N=z+(k^(R|~j))+V[3]+2399980690&4294967295,z=R+(N<<10&4294967295|N>>>22),N=j+(R^(z|~k))+V[10]+4293915773&4294967295,j=z+(N<<15&4294967295|N>>>17),N=k+(z^(j|~R))+V[1]+2240044497&4294967295,k=j+(N<<21&4294967295|N>>>11),N=R+(j^(k|~z))+V[8]+1873313359&4294967295,R=k+(N<<6&4294967295|N>>>26),N=z+(k^(R|~j))+V[15]+4264355552&4294967295,z=R+(N<<10&4294967295|N>>>22),N=j+(R^(z|~k))+V[6]+2734768916&4294967295,j=z+(N<<15&4294967295|N>>>17),N=k+(z^(j|~R))+V[13]+1309151649&4294967295,k=j+(N<<21&4294967295|N>>>11),N=R+(j^(k|~z))+V[4]+4149444226&4294967295,R=k+(N<<6&4294967295|N>>>26),N=z+(k^(R|~j))+V[11]+3174756917&4294967295,z=R+(N<<10&4294967295|N>>>22),N=j+(R^(z|~k))+V[2]+718787259&4294967295,j=z+(N<<15&4294967295|N>>>17),N=k+(z^(j|~R))+V[9]+3951481745&4294967295,P.g[0]=P.g[0]+R&4294967295,P.g[1]=P.g[1]+(j+(N<<21&4294967295|N>>>11))&4294967295,P.g[2]=P.g[2]+j&4294967295,P.g[3]=P.g[3]+z&4294967295}i.prototype.v=function(P,R){R===void 0&&(R=P.length);const k=R-this.blockSize,V=this.C;let j=this.h,z=0;for(;z<R;){if(j==0)for(;z<=k;)r(this,P,z),z+=this.blockSize;if(typeof P=="string"){for(;z<R;)if(V[j++]=P.charCodeAt(z++),j==this.blockSize){r(this,V),j=0;break}}else for(;z<R;)if(V[j++]=P[z++],j==this.blockSize){r(this,V),j=0;break}}this.h=j,this.o+=R},i.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var R=1;R<P.length-8;++R)P[R]=0;R=this.o*8;for(var k=P.length-8;k<P.length;++k)P[k]=R&255,R/=256;for(this.v(P),P=Array(16),R=0,k=0;k<4;++k)for(let V=0;V<32;V+=8)P[R++]=this.g[k]>>>V&255;return P};function s(P,R){var k=l;return Object.prototype.hasOwnProperty.call(k,P)?k[P]:k[P]=R(P)}function o(P,R){this.h=R;const k=[];let V=!0;for(let j=P.length-1;j>=0;j--){const z=P[j]|0;V&&z==R||(k[j]=z,V=!1)}this.g=k}var l={};function c(P){return-128<=P&&P<128?s(P,function(R){return new o([R|0],R<0?-1:0)}):new o([P|0],P<0?-1:0)}function h(P){if(isNaN(P)||!isFinite(P))return m;if(P<0)return x(h(-P));const R=[];let k=1;for(let V=0;P>=k;V++)R[V]=P/k|0,k*=4294967296;return new o(R,0)}function f(P,R){if(P.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(P.charAt(0)=="-")return x(f(P.substring(1),R));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=h(Math.pow(R,8));let V=m;for(let z=0;z<P.length;z+=8){var j=Math.min(8,P.length-z);const N=parseInt(P.substring(z,z+j),R);j<8?(j=h(Math.pow(R,j)),V=V.j(j).add(h(N))):(V=V.j(k),V=V.add(h(N)))}return V}var m=c(0),y=c(1),E=c(16777216);n=o.prototype,n.m=function(){if(C(this))return-x(this).m();let P=0,R=1;for(let k=0;k<this.g.length;k++){const V=this.i(k);P+=(V>=0?V:4294967296+V)*R,R*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(I(this))return"0";if(C(this))return"-"+x(this).toString(P);const R=h(Math.pow(P,6));var k=this;let V="";for(;;){const j=O(k,R).g;k=b(k,j.j(R));let z=((k.g.length>0?k.g[0]:k.h)>>>0).toString(P);if(k=j,I(k))return z+V;for(;z.length<6;)z="0"+z;V=z+V}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function I(P){if(P.h!=0)return!1;for(let R=0;R<P.g.length;R++)if(P.g[R]!=0)return!1;return!0}function C(P){return P.h==-1}n.l=function(P){return P=b(this,P),C(P)?-1:I(P)?0:1};function x(P){const R=P.g.length,k=[];for(let V=0;V<R;V++)k[V]=~P.g[V];return new o(k,~P.h).add(y)}n.abs=function(){return C(this)?x(this):this},n.add=function(P){const R=Math.max(this.g.length,P.g.length),k=[];let V=0;for(let j=0;j<=R;j++){let z=V+(this.i(j)&65535)+(P.i(j)&65535),N=(z>>>16)+(this.i(j)>>>16)+(P.i(j)>>>16);V=N>>>16,z&=65535,N&=65535,k[j]=N<<16|z}return new o(k,k[k.length-1]&-2147483648?-1:0)};function b(P,R){return P.add(x(R))}n.j=function(P){if(I(this)||I(P))return m;if(C(this))return C(P)?x(this).j(x(P)):x(x(this).j(P));if(C(P))return x(this.j(x(P)));if(this.l(E)<0&&P.l(E)<0)return h(this.m()*P.m());const R=this.g.length+P.g.length,k=[];for(var V=0;V<2*R;V++)k[V]=0;for(V=0;V<this.g.length;V++)for(let j=0;j<P.g.length;j++){const z=this.i(V)>>>16,N=this.i(V)&65535,le=P.i(j)>>>16,me=P.i(j)&65535;k[2*V+2*j]+=N*me,D(k,2*V+2*j),k[2*V+2*j+1]+=z*me,D(k,2*V+2*j+1),k[2*V+2*j+1]+=N*le,D(k,2*V+2*j+1),k[2*V+2*j+2]+=z*le,D(k,2*V+2*j+2)}for(P=0;P<R;P++)k[P]=k[2*P+1]<<16|k[2*P];for(P=R;P<2*R;P++)k[P]=0;return new o(k,0)};function D(P,R){for(;(P[R]&65535)!=P[R];)P[R+1]+=P[R]>>>16,P[R]&=65535,R++}function L(P,R){this.g=P,this.h=R}function O(P,R){if(I(R))throw Error("division by zero");if(I(P))return new L(m,m);if(C(P))return R=O(x(P),R),new L(x(R.g),x(R.h));if(C(R))return R=O(P,x(R)),new L(x(R.g),R.h);if(P.g.length>30){if(C(P)||C(R))throw Error("slowDivide_ only works with positive integers.");for(var k=y,V=R;V.l(P)<=0;)k=F(k),V=F(V);var j=W(k,1),z=W(V,1);for(V=W(V,2),k=W(k,2);!I(V);){var N=z.add(V);N.l(P)<=0&&(j=j.add(k),z=N),V=W(V,1),k=W(k,1)}return R=b(P,j.j(R)),new L(j,R)}for(j=m;P.l(R)>=0;){for(k=Math.max(1,Math.floor(P.m()/R.m())),V=Math.ceil(Math.log(k)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),z=h(k),N=z.j(R);C(N)||N.l(P)>0;)k-=V,z=h(k),N=z.j(R);I(z)&&(z=y),j=j.add(z),P=b(P,N)}return new L(j,P)}n.B=function(P){return O(this,P).h},n.and=function(P){const R=Math.max(this.g.length,P.g.length),k=[];for(let V=0;V<R;V++)k[V]=this.i(V)&P.i(V);return new o(k,this.h&P.h)},n.or=function(P){const R=Math.max(this.g.length,P.g.length),k=[];for(let V=0;V<R;V++)k[V]=this.i(V)|P.i(V);return new o(k,this.h|P.h)},n.xor=function(P){const R=Math.max(this.g.length,P.g.length),k=[];for(let V=0;V<R;V++)k[V]=this.i(V)^P.i(V);return new o(k,this.h^P.h)};function F(P){const R=P.g.length+1,k=[];for(let V=0;V<R;V++)k[V]=P.i(V)<<1|P.i(V-1)>>>31;return new o(k,P.h)}function W(P,R){const k=R>>5;R%=32;const V=P.g.length-k,j=[];for(let z=0;z<V;z++)j[z]=R>0?P.i(z+k)>>>R|P.i(z+k+1)<<32-R:P.i(z+k);return new o(j,P.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,YE=o}).apply(typeof JC<"u"?JC:typeof self<"u"?self:typeof window<"u"?window:{});var Wg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var xk,Hh,Tk,up,Kv,Ik,Sk,Ck;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wg=="object"&&Wg];for(var w=0;w<g.length;++w){var S=g[w];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=t(this);function r(g,w){if(w)e:{var S=i;g=g.split(".");for(var M=0;M<g.length-1;M++){var X=g[M];if(!(X in S))break e;S=S[X]}g=g[g.length-1],M=S[g],w=w(M),w!=M&&w!=null&&e(S,g,{configurable:!0,writable:!0,value:w})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(w){var S=[],M;for(M in w)Object.prototype.hasOwnProperty.call(w,M)&&S.push([M,w[M]]);return S}});var s=s||{},o=this||self;function l(g){var w=typeof g;return w=="object"&&g!=null||w=="function"}function c(g,w,S){return g.call.apply(g.bind,arguments)}function h(g,w,S){return h=c,h.apply(null,arguments)}function f(g,w){var S=Array.prototype.slice.call(arguments,1);return function(){var M=S.slice();return M.push.apply(M,arguments),g.apply(this,M)}}function m(g,w){function S(){}S.prototype=w.prototype,g.Z=w.prototype,g.prototype=new S,g.prototype.constructor=g,g.Ob=function(M,X,Q){for(var he=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)he[Fe-2]=arguments[Fe];return w.prototype[X].apply(M,he)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function E(g){const w=g.length;if(w>0){const S=Array(w);for(let M=0;M<w;M++)S[M]=g[M];return S}return[]}function I(g,w){for(let M=1;M<arguments.length;M++){const X=arguments[M];var S=typeof X;if(S=S!="object"?S:X?Array.isArray(X)?"array":S:"null",S=="array"||S=="object"&&typeof X.length=="number"){S=g.length||0;const Q=X.length||0;g.length=S+Q;for(let he=0;he<Q;he++)g[S+he]=X[he]}else g.push(X)}}class C{constructor(w,S){this.i=w,this.j=S,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function x(g){o.setTimeout(()=>{throw g},0)}function b(){var g=P;let w=null;return g.g&&(w=g.g,g.g=g.g.next,g.g||(g.h=null),w.next=null),w}class D{constructor(){this.h=this.g=null}add(w,S){const M=L.get();M.set(w,S),this.h?this.h.next=M:this.g=M,this.h=M}}var L=new C(()=>new O,g=>g.reset());class O{constructor(){this.next=this.g=this.h=null}set(w,S){this.h=w,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let F,W=!1,P=new D,R=()=>{const g=Promise.resolve(void 0);F=()=>{g.then(k)}};function k(){for(var g;g=b();){try{g.h.call(g.g)}catch(S){x(S)}var w=L;w.j(g),w.h<100&&(w.h++,g.next=w.g,w.g=g)}W=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(g,w){this.type=g,this.g=this.target=w,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,w=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const S=()=>{};o.addEventListener("test",S,w),o.removeEventListener("test",S,w)}catch{}return g})();function N(g){return/^[\s\xa0]*$/.test(g)}function le(g,w){j.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,w)}m(le,j),le.prototype.init=function(g,w){const S=this.type=g.type,M=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=w,w=g.relatedTarget,w||(S=="mouseover"?w=g.fromElement:S=="mouseout"&&(w=g.toElement)),this.relatedTarget=w,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&le.Z.h.call(this)},le.prototype.h=function(){le.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var me="closure_listenable_"+(Math.random()*1e6|0),fe=0;function ce(g,w,S,M,X){this.listener=g,this.proxy=null,this.src=w,this.type=S,this.capture=!!M,this.ha=X,this.key=++fe,this.da=this.fa=!1}function ee(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function oe(g,w,S){for(const M in g)w.call(S,g[M],M,g)}function ne(g,w){for(const S in g)w.call(void 0,g[S],S,g)}function G(g){const w={};for(const S in g)w[S]=g[S];return w}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function xe(g,w){let S,M;for(let X=1;X<arguments.length;X++){M=arguments[X];for(S in M)g[S]=M[S];for(let Q=0;Q<$.length;Q++)S=$[Q],Object.prototype.hasOwnProperty.call(M,S)&&(g[S]=M[S])}}function Te(g){this.src=g,this.g={},this.h=0}Te.prototype.add=function(g,w,S,M,X){const Q=g.toString();g=this.g[Q],g||(g=this.g[Q]=[],this.h++);const he=be(g,w,M,X);return he>-1?(w=g[he],S||(w.fa=!1)):(w=new ce(w,this.src,Q,!!M,X),w.fa=S,g.push(w)),w};function Ie(g,w){const S=w.type;if(S in g.g){var M=g.g[S],X=Array.prototype.indexOf.call(M,w,void 0),Q;(Q=X>=0)&&Array.prototype.splice.call(M,X,1),Q&&(ee(w),g.g[S].length==0&&(delete g.g[S],g.h--))}}function be(g,w,S,M){for(let X=0;X<g.length;++X){const Q=g[X];if(!Q.da&&Q.listener==w&&Q.capture==!!S&&Q.ha==M)return X}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),Ve={};function Be(g,w,S,M,X){if(Array.isArray(w)){for(let Q=0;Q<w.length;Q++)Be(g,w[Q],S,M,X);return null}return S=Ci(S),g&&g[me]?g.J(w,S,l(M)?!!M.capture:!1,X):lt(g,w,S,!1,M,X)}function lt(g,w,S,M,X,Q){if(!w)throw Error("Invalid event type");const he=l(X)?!!X.capture:!!X;let Fe=dn(g);if(Fe||(g[Me]=Fe=new Te(g)),S=Fe.add(w,S,M,he,Q),S.proxy)return S;if(M=Qi(),S.proxy=M,M.src=g,M.listener=S,g.addEventListener)z||(X=he),X===void 0&&(X=!1),g.addEventListener(w.toString(),M,X);else if(g.attachEvent)g.attachEvent(Kn(w.toString()),M);else if(g.addListener&&g.removeListener)g.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Qi(){function g(S){return w.call(g.src,g.listener,S)}const w=hn;return g}function fs(g,w,S,M,X){if(Array.isArray(w))for(var Q=0;Q<w.length;Q++)fs(g,w[Q],S,M,X);else M=l(M)?!!M.capture:!!M,S=Ci(S),g&&g[me]?(g=g.i,Q=String(w).toString(),Q in g.g&&(w=g.g[Q],S=be(w,S,M,X),S>-1&&(ee(w[S]),Array.prototype.splice.call(w,S,1),w.length==0&&(delete g.g[Q],g.h--)))):g&&(g=dn(g))&&(w=g.g[w.toString()],g=-1,w&&(g=be(w,S,M,X)),(S=g>-1?w[g]:null)&&Wn(S))}function Wn(g){if(typeof g!="number"&&g&&!g.da){var w=g.src;if(w&&w[me])Ie(w.i,g);else{var S=g.type,M=g.proxy;w.removeEventListener?w.removeEventListener(S,M,g.capture):w.detachEvent?w.detachEvent(Kn(S),M):w.addListener&&w.removeListener&&w.removeListener(M),(S=dn(w))?(Ie(S,g),S.h==0&&(S.src=null,w[Me]=null)):ee(g)}}}function Kn(g){return g in Ve?Ve[g]:Ve[g]="on"+g}function hn(g,w){if(g.da)g=!0;else{w=new le(w,this);const S=g.listener,M=g.ha||g.src;g.fa&&Wn(g),g=S.call(M,w)}return g}function dn(g){return g=g[Me],g instanceof Te?g:null}var $n="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ci(g){return typeof g=="function"?g:(g[$n]||(g[$n]=function(w){return g.handleEvent(w)}),g[$n])}function yt(){V.call(this),this.i=new Te(this),this.M=this,this.G=null}m(yt,V),yt.prototype[me]=!0,yt.prototype.removeEventListener=function(g,w,S,M){fs(this,g,w,S,M)};function ut(g,w){var S,M=g.G;if(M)for(S=[];M;M=M.G)S.push(M);if(g=g.M,M=w.type||w,typeof w=="string")w=new j(w,g);else if(w instanceof j)w.target=w.target||g;else{var X=w;w=new j(M,g),xe(w,X)}X=!0;let Q,he;if(S)for(he=S.length-1;he>=0;he--)Q=w.g=S[he],X=tn(Q,M,!0,w)&&X;if(Q=w.g=g,X=tn(Q,M,!0,w)&&X,X=tn(Q,M,!1,w)&&X,S)for(he=0;he<S.length;he++)Q=w.g=S[he],X=tn(Q,M,!1,w)&&X}yt.prototype.N=function(){if(yt.Z.N.call(this),this.i){var g=this.i;for(const w in g.g){const S=g.g[w];for(let M=0;M<S.length;M++)ee(S[M]);delete g.g[w],g.h--}}this.G=null},yt.prototype.J=function(g,w,S,M){return this.i.add(String(g),w,!1,S,M)},yt.prototype.K=function(g,w,S,M){return this.i.add(String(g),w,!0,S,M)};function tn(g,w,S,M){if(w=g.i.g[String(w)],!w)return!0;w=w.concat();let X=!0;for(let Q=0;Q<w.length;++Q){const he=w[Q];if(he&&!he.da&&he.capture==S){const Fe=he.listener,Ft=he.ha||he.src;he.fa&&Ie(g.i,he),X=Fe.call(Ft,M)!==!1&&X}}return X&&!M.defaultPrevented}function Ri(g,w){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:o.setTimeout(g,w||0)}function It(g){g.g=Ri(()=>{g.g=null,g.i&&(g.i=!1,It(g))},g.l);const w=g.h;g.h=null,g.m.apply(null,w)}class Js extends V{constructor(w,S){super(),this.m=w,this.l=S,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ai(g){V.call(this),this.h=g,this.g={}}m(Ai,V);var Sr=[];function Ji(g){oe(g.g,function(w,S){this.g.hasOwnProperty(S)&&Wn(w)},g),g.g={}}Ai.prototype.N=function(){Ai.Z.N.call(this),Ji(this)},Ai.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cr=o.JSON.stringify,ua=o.JSON.parse,Rr=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function Pi(){}function Ll(){}var Ar={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gs(){j.call(this,"d")}m(gs,j);function eo(){j.call(this,"c")}m(eo,j);var On={},ps=null;function Pr(){return ps=ps||new yt}On.Ia="serverreachability";function br(g){j.call(this,On.Ia,g)}m(br,j);function Vn(g){const w=Pr();ut(w,new br(w))}On.STAT_EVENT="statevent";function Fn(g,w){j.call(this,On.STAT_EVENT,g),this.stat=w}m(Fn,j);function ft(g){const w=Pr();ut(w,new Fn(w,g))}On.Ja="timingevent";function to(g,w){j.call(this,On.Ja,g),this.size=w}m(to,j);function er(g,w){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},w)}function Ot(){this.g=!0}Ot.prototype.ua=function(){this.g=!1};function bi(g,w,S,M,X,Q){g.info(function(){if(g.g)if(Q){var he="",Fe=Q.split("&");for(let ct=0;ct<Fe.length;ct++){var Ft=Fe[ct].split("=");if(Ft.length>1){const Gt=Ft[0];Ft=Ft[1];const gi=Gt.split("_");he=gi.length>=2&&gi[1]=="type"?he+(Gt+"="+Ft+"&"):he+(Gt+"=redacted&")}}}else he=null;else he=Q;return"XMLHTTP REQ ("+M+") [attempt "+X+"]: "+w+`
`+S+`
`+he})}function fn(g,w,S,M,X,Q,he){g.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+X+"]: "+w+`
`+S+`
`+Q+" "+he})}function Vt(g,w,S,M){g.info(function(){return"XMLHTTP TEXT ("+w+"): "+pn(g,S)+(M?" "+M:"")})}function gn(g,w){g.info(function(){return"TIMEOUT: "+w})}Ot.prototype.info=function(){};function pn(g,w){if(!g.g)return w;if(!w)return null;try{const Q=JSON.parse(w);if(Q){for(g=0;g<Q.length;g++)if(Array.isArray(Q[g])){var S=Q[g];if(!(S.length<2)){var M=S[1];if(Array.isArray(M)&&!(M.length<1)){var X=M[0];if(X!="noop"&&X!="stop"&&X!="close")for(let he=1;he<M.length;he++)M[he]=""}}}}return Cr(Q)}catch{return w}}var nn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bt;function Xt(){}m(Xt,Pi),Xt.prototype.g=function(){return new XMLHttpRequest},Bt=new Xt;function ki(g){return encodeURIComponent(String(g))}function Ol(g){var w=1;g=g.split(":");const S=[];for(;w>0&&g.length;)S.push(g.shift()),w--;return g.length&&S.push(g.join(":")),S}function Di(g,w,S,M){this.j=g,this.i=w,this.l=S,this.S=M||1,this.V=new Ai(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new yf}function yf(){this.i=null,this.g="",this.h=!1}var _f={},Oc={};function tr(g,w,S){g.M=1,g.A=ys(Mi(w)),g.u=S,g.R=!0,Vc(g,null)}function Vc(g,w){g.F=Date.now(),ca(g),g.B=Mi(g.A);var S=g.B,M=g.S;Array.isArray(M)||(M=[String(M)]),Hc(S.i,"t",M),g.C=0,S=g.j.L,g.h=new yf,g.g=Af(g.j,S?w:null,!g.u),g.P>0&&(g.O=new Js(h(g.Y,g,g.g),g.P)),w=g.V,S=g.g,M=g.ba;var X="readystatechange";Array.isArray(X)||(X&&(Sr[0]=X.toString()),X=Sr);for(let Q=0;Q<X.length;Q++){const he=Be(S,X[Q],M||w.handleEvent,!1,w.h||w);if(!he)break;w.g[he.key]=he}w=g.J?G(g.J):{},g.u?(g.v||(g.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,w)):(g.v="GET",g.g.ea(g.B,g.v,null,w)),Vn(),bi(g.i,g.v,g.B,g.l,g.S,g.u)}Di.prototype.ba=function(g){g=g.target;const w=this.O;w&&Vr(g)==3?w.j():this.Y(g)},Di.prototype.Y=function(g){try{if(g==this.g)e:{const Fe=Vr(this.g),Ft=this.g.ya(),ct=this.g.ca();if(!(Fe<3)&&(Fe!=3||this.g&&(this.h.h||this.g.la()||Cf(this.g)))){this.K||Fe!=4||Ft==7||(Ft==8||ct<=0?Vn(3):Vn(2)),Vl(this);var w=this.g.ca();this.X=w;var S=vf(this);if(this.o=w==200,fn(this.i,this.v,this.B,this.l,this.S,Fe,w),this.o){if(this.U&&!this.L){t:{if(this.g){var M,X=this.g;if((M=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(M)){var Q=M;break t}}Q=null}if(g=Q)Vt(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,vt(this,g);else{this.o=!1,this.m=3,ft(12),ms(this),ha(this);break e}}if(this.R){g=!0;let Gt;for(;!this.K&&this.C<S.length;)if(Gt=Ef(this,S),Gt==Oc){Fe==4&&(this.m=4,ft(14),g=!1),Vt(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==_f){this.m=4,ft(15),Vt(this.i,this.l,S,"[Invalid Chunk]"),g=!1;break}else Vt(this.i,this.l,Gt,null),vt(this,Gt);if(wf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fe!=4||S.length!=0||this.h.h||(this.m=1,ft(16),g=!1),this.o=this.o&&g,!g)Vt(this.i,this.l,S,"[Invalid Chunked Response]"),ms(this),ha(this);else if(S.length>0&&!this.W){this.W=!0;var he=this.j;he.g==this&&he.aa&&!he.P&&(he.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),wa(he),he.P=!0,ft(11))}}else Vt(this.i,this.l,S,null),vt(this,S);Fe==4&&ms(this),this.o&&!this.K&&(Fe==4?Hl(this.j,this):(this.o=!1,ca(this)))}else qc(this.g),w==400&&S.indexOf("Unknown SID")>0?(this.m=3,ft(12)):(this.m=0,ft(13)),ms(this),ha(this)}}}catch{}};function vf(g){if(!wf(g))return g.g.la();const w=Cf(g.g);if(w==="")return"";let S="";const M=w.length,X=Vr(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ms(g),ha(g),"";g.h.i=new o.TextDecoder}for(let Q=0;Q<M;Q++)g.h.h=!0,S+=g.h.i.decode(w[Q],{stream:!(X&&Q==M-1)});return w.length=0,g.h.g+=S,g.C=0,g.h.g}function wf(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Ef(g,w){var S=g.C,M=w.indexOf(`
`,S);return M==-1?Oc:(S=Number(w.substring(S,M)),isNaN(S)?_f:(M+=1,M+S>w.length?Oc:(w=w.slice(M,M+S),g.C=M+S,w)))}Di.prototype.cancel=function(){this.K=!0,ms(this)};function ca(g){g.T=Date.now()+g.H,Fc(g,g.H)}function Fc(g,w){if(g.D!=null)throw Error("WatchDog timer not null");g.D=er(h(g.aa,g),w)}function Vl(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Di.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(gn(this.i,this.B),this.M!=2&&(Vn(),ft(17)),ms(this),this.m=2,ha(this)):Fc(this,this.T-g)};function ha(g){g.j.I==0||g.K||Hl(g.j,g)}function ms(g){Vl(g);var w=g.O;w&&typeof w.dispose=="function"&&w.dispose(),g.O=null,Ji(g.V),g.g&&(w=g.g,g.g=null,w.abort(),w.dispose())}function vt(g,w){try{var S=g.j;if(S.I!=0&&(S.g==g||Uc(S.h,g))){if(!g.L&&Uc(S.h,g)&&S.I==3){try{var M=S.Ba.g.parse(w)}catch{M=null}if(Array.isArray(M)&&M.length==3){var X=M;if(X[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<g.F)$l(S),di(S);else break e;Ur(S),ft(18)}}else S.xa=X[1],0<S.xa-S.K&&X[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=er(h(S.Va,S),6e3));da(S.h)<=1&&S.ta&&(S.ta=void 0)}else fi(S,11)}else if((g.L||S.g==g)&&$l(S),!N(w))for(X=S.Ba.g.parse(w),w=0;w<X.length;w++){let ct=X[w];const Gt=ct[0];if(!(Gt<=S.K))if(S.K=Gt,ct=ct[1],S.I==2)if(ct[0]=="c"){S.M=ct[1],S.ba=ct[2];const gi=ct[3];gi!=null&&(S.ka=gi,S.j.info("VER="+S.ka));const xs=ct[4];xs!=null&&(S.za=xs,S.j.info("SVER="+S.za));const zr=ct[5];zr!=null&&typeof zr=="number"&&zr>0&&(M=1.5*zr,S.O=M,S.j.info("backChannelRequestTimeoutMs_="+M)),M=S;const Br=g.g;if(Br){const Yl=Br.g?Br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yl){var Q=M.h;Q.g||Yl.indexOf("spdy")==-1&&Yl.indexOf("quic")==-1&&Yl.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(jl(Q,Q.h),Q.h=null))}if(M.G){const Qc=Br.g?Br.g.getResponseHeader("X-HTTP-Session-Id"):null;Qc&&(M.wa=Qc,st(M.J,M.G,Qc))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-g.F,S.j.info("Handshake RTT: "+S.T+"ms")),M=S;var he=g;if(M.na=Zc(M,M.L?M.ba:null,M.W),he.L){fa(M.h,he);var Fe=he,Ft=M.O;Ft&&(Fe.H=Ft),Fe.D&&(Vl(Fe),ca(Fe)),M.g=he}else Cn(M);S.i.length>0&&Es(S)}else ct[0]!="stop"&&ct[0]!="close"||fi(S,7);else S.I==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?fi(S,7):Wl(S):ct[0]!="noop"&&S.l&&S.l.qa(ct),S.A=0)}}Vn(4)}catch{}}var gy=class{constructor(g,w){this.g=g,this.map=w}};function Fl(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function jc(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function da(g){return g.h?1:g.g?g.g.size:0}function Uc(g,w){return g.h?g.h==w:g.g?g.g.has(w):!1}function jl(g,w){g.g?g.g.add(w):g.h=w}function fa(g,w){g.h&&g.h==w?g.h=null:g.g&&g.g.has(w)&&g.g.delete(w)}Fl.prototype.cancel=function(){if(this.i=ui(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function ui(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let w=g.i;for(const S of g.g.values())w=w.concat(S.G);return w}return E(g.i)}var xf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ci(g,w){if(g){g=g.split("&");for(let S=0;S<g.length;S++){const M=g[S].indexOf("=");let X,Q=null;M>=0?(X=g[S].substring(0,M),Q=g[S].substring(M+1)):X=g[S],w(X,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function kr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;g instanceof kr?(this.l=g.l,ga(this,g.j),this.o=g.o,this.g=g.g,Dr(this,g.u),this.h=g.h,no(this,Xc(g.i)),this.m=g.m):g&&(w=String(g).match(xf))?(this.l=!1,ga(this,w[1]||"",!0),this.o=pa(w[2]||""),this.g=pa(w[3]||"",!0),Dr(this,w[4]),this.h=pa(w[5]||"",!0),no(this,w[6]||"",!0),this.m=pa(w[7]||"")):(this.l=!1,this.i=new He(null,this.l))}kr.prototype.toString=function(){const g=[];var w=this.j;w&&g.push(ma(w,Bc,!0),":");var S=this.g;return(S||w=="file")&&(g.push("//"),(w=this.o)&&g.push(ma(w,Bc,!0),"@"),g.push(ki(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&g.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&g.push("/"),g.push(ma(S,S.charAt(0)=="/"?ya:Gc,!0))),(S=this.i.toString())&&g.push("?",S),(S=this.m)&&g.push("#",ma(S,Wc)),g.join("")},kr.prototype.resolve=function(g){const w=Mi(this);let S=!!g.j;S?ga(w,g.j):S=!!g.o,S?w.o=g.o:S=!!g.g,S?w.g=g.g:S=g.u!=null;var M=g.h;if(S)Dr(w,g.u);else if(S=!!g.h){if(M.charAt(0)!="/")if(this.g&&!this.h)M="/"+M;else{var X=w.h.lastIndexOf("/");X!=-1&&(M=w.h.slice(0,X+1)+M)}if(X=M,X==".."||X==".")M="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){M=X.lastIndexOf("/",0)==0,X=X.split("/");const Q=[];for(let he=0;he<X.length;){const Fe=X[he++];Fe=="."?M&&he==X.length&&Q.push(""):Fe==".."?((Q.length>1||Q.length==1&&Q[0]!="")&&Q.pop(),M&&he==X.length&&Q.push("")):(Q.push(Fe),M=!0)}M=Q.join("/")}else M=X}return S?w.h=M:S=g.i.toString()!=="",S?no(w,Xc(g.i)):S=!!g.m,S&&(w.m=g.m),w};function Mi(g){return new kr(g)}function ga(g,w,S){g.j=S?pa(w,!0):w,g.j&&(g.j=g.j.replace(/:$/,""))}function Dr(g,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);g.u=w}else g.u=null}function no(g,w,S){w instanceof He?(g.i=w,zl(g.i,g.l)):(S||(w=ma(w,py)),g.i=new He(w,g.l))}function st(g,w,S){g.i.set(w,S)}function ys(g){return st(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function pa(g,w){return g?w?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ma(g,w,S){return typeof g=="string"?(g=encodeURI(g).replace(w,zc),S&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function zc(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Bc=/[#\/\?@]/g,Gc=/[#\?:]/g,ya=/[#\?]/g,py=/[#\?@]/g,Wc=/#/g;function He(g,w){this.h=this.g=null,this.i=g||null,this.j=!!w}function Mr(g){g.g||(g.g=new Map,g.h=0,g.i&&ci(g.i,function(w,S){g.add(decodeURIComponent(w.replace(/\+/g," ")),S)}))}n=He.prototype,n.add=function(g,w){Mr(this),this.i=null,g=Nr(this,g);let S=this.g.get(g);return S||this.g.set(g,S=[]),S.push(w),this.h+=1,this};function Kc(g,w){Mr(g),w=Nr(g,w),g.g.has(w)&&(g.i=null,g.h-=g.g.get(w).length,g.g.delete(w))}function Ul(g,w){return Mr(g),w=Nr(g,w),g.g.has(w)}n.forEach=function(g,w){Mr(this),this.g.forEach(function(S,M){S.forEach(function(X){g.call(w,X,M,this)},this)},this)};function $c(g,w){Mr(g);let S=[];if(typeof w=="string")Ul(g,w)&&(S=S.concat(g.g.get(Nr(g,w))));else for(g=Array.from(g.g.values()),w=0;w<g.length;w++)S=S.concat(g[w]);return S}n.set=function(g,w){return Mr(this),this.i=null,g=Nr(this,g),Ul(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[w]),this.h+=1,this},n.get=function(g,w){return g?(g=$c(this,g),g.length>0?String(g[0]):w):w};function Hc(g,w,S){Kc(g,w),S.length>0&&(g.i=null,g.g.set(Nr(g,w),E(S)),g.h+=S.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],w=Array.from(this.g.keys());for(let M=0;M<w.length;M++){var S=w[M];const X=ki(S);S=$c(this,S);for(let Q=0;Q<S.length;Q++){let he=X;S[Q]!==""&&(he+="="+ki(S[Q])),g.push(he)}}return this.i=g.join("&")};function Xc(g){const w=new He;return w.i=g.i,g.g&&(w.g=new Map(g.g),w.h=g.h),w}function Nr(g,w){return w=String(w),g.j&&(w=w.toLowerCase()),w}function zl(g,w){w&&!g.j&&(Mr(g),g.i=null,g.g.forEach(function(S,M){const X=M.toLowerCase();M!=X&&(Kc(this,M),Hc(this,X,S))},g)),g.j=w}function Lr(g,w){const S=new Ot;if(o.Image){const M=new Image;M.onload=f(mn,S,"TestLoadImage: loaded",!0,w,M),M.onerror=f(mn,S,"TestLoadImage: error",!1,w,M),M.onabort=f(mn,S,"TestLoadImage: abort",!1,w,M),M.ontimeout=f(mn,S,"TestLoadImage: timeout",!1,w,M),o.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=g}else w(!1)}function Or(g,w){const S=new Ot,M=new AbortController,X=setTimeout(()=>{M.abort(),mn(S,"TestPingServer: timeout",!1,w)},1e4);fetch(g,{signal:M.signal}).then(Q=>{clearTimeout(X),Q.ok?mn(S,"TestPingServer: ok",!0,w):mn(S,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(X),mn(S,"TestPingServer: error",!1,w)})}function mn(g,w,S,M,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),M(S)}catch{}}function _a(){this.g=new Rr}function _s(g){this.i=g.Sb||null,this.h=g.ab||!1}m(_s,Pi),_s.prototype.g=function(){return new hi(this.i,this.h)};function hi(g,w){yt.call(this),this.H=g,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(hi,yt),n=hi.prototype,n.open=function(g,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=w,this.readyState=1,nr(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(w.body=g),(this.H||o).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,io(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,nr(this)),this.g&&(this.readyState=3,nr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Tf(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Tf(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var w=g.value?g.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!g.done}))&&(this.response=this.responseText+=w)}g.done?io(this):nr(this),this.readyState==3&&Tf(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,io(this))},n.Na=function(g){this.g&&(this.response=g,io(this))},n.ga=function(){this.g&&io(this)};function io(g){g.readyState=4,g.l=null,g.j=null,g.B=null,nr(g)}n.setRequestHeader=function(g,w){this.A.append(g,w)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],w=this.h.entries();for(var S=w.next();!S.done;)S=S.value,g.push(S[0]+": "+S[1]),S=w.next();return g.join(`\r
`)};function nr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(hi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function If(g){let w="";return oe(g,function(S,M){w+=M,w+=":",w+=S,w+=`\r
`}),w}function Bl(g,w,S){e:{for(M in S){var M=!1;break e}M=!0}M||(S=If(S),typeof g=="string"?S!=null&&ki(S):st(g,w,S))}function pt(g){yt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(pt,yt);var Sf=/^https?$/i,my=["POST","PUT"];n=pt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,w,S,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);w=w?w.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bt.g(),this.g.onreadystatechange=y(h(this.Ca,this));try{this.B=!0,this.g.open(w,String(g),!0),this.B=!1}catch(Q){ro(this,Q);return}if(g=S||"",S=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var X in M)S.set(X,M[X]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const Q of M.keys())S.set(Q,M.get(Q));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(S.keys()).find(Q=>Q.toLowerCase()=="content-type"),X=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(my,w,void 0)>=0)||M||X||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,he]of S)this.g.setRequestHeader(Q,he);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(Q){ro(this,Q)}};function ro(g,w){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=w,g.o=5,so(g),ws(g)}function so(g){g.A||(g.A=!0,ut(g,"complete"),ut(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ut(this,"complete"),ut(this,"abort"),ws(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ws(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?vs(this):this.Xa())},n.Xa=function(){vs(this)};function vs(g){if(g.h&&typeof s<"u"){if(g.v&&Vr(g)==4)setTimeout(g.Ca.bind(g),0);else if(ut(g,"readystatechange"),Vr(g)==4){g.h=!1;try{const Q=g.ca();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var S;if(!(S=w)){var M;if(M=Q===0){let he=String(g.D).match(xf)[1]||null;!he&&o.self&&o.self.location&&(he=o.self.location.protocol.slice(0,-1)),M=!Sf.test(he?he.toLowerCase():"")}S=M}if(S)ut(g,"complete"),ut(g,"success");else{g.o=6;try{var X=Vr(g)>2?g.g.statusText:""}catch{X=""}g.l=X+" ["+g.ca()+"]",so(g)}}finally{ws(g)}}}}function ws(g,w){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const S=g.g;g.g=null,w||ut(g,"ready");try{S.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Vr(g){return g.g?g.g.readyState:0}n.ca=function(){try{return Vr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var w=this.g.responseText;return g&&w.indexOf(g)==0&&(w=w.substring(g.length)),ua(w)}};function Cf(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function qc(g){const w={};g=(g.g&&Vr(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<g.length;M++){if(N(g[M]))continue;var S=Ol(g[M]);const X=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const Q=w[X]||[];w[X]=Q,Q.push(S)}ne(w,function(M){return M.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fr(g,w,S){return S&&S.internalChannelParams&&S.internalChannelParams[g]||w}function Gl(g){this.za=0,this.i=[],this.j=new Ot,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Fr("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Fr("baseRetryDelayMs",5e3,g),this.Za=Fr("retryDelaySeedMs",1e4,g),this.Ta=Fr("forwardChannelMaxRetries",2,g),this.va=Fr("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Fl(g&&g.concurrentRequestLimit),this.Ba=new _a,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Gl.prototype,n.ka=8,n.I=1,n.connect=function(g,w,S,M){ft(0),this.W=g,this.H=w||{},S&&M!==void 0&&(this.H.OSID=S,this.H.OAID=M),this.F=this.X,this.J=Zc(this,null,this.W),Es(this)};function Wl(g){if(Kl(g),g.I==3){var w=g.V++,S=Mi(g.J);if(st(S,"SID",g.M),st(S,"RID",w),st(S,"TYPE","terminate"),jr(g,S),w=new Di(g,g.j,w),w.M=2,w.A=ys(Mi(S)),S=!1,o.navigator&&o.navigator.sendBeacon)try{S=o.navigator.sendBeacon(w.A.toString(),"")}catch{}!S&&o.Image&&(new Image().src=w.A,S=!0),S||(w.g=Af(w.j,null),w.g.ea(w.A)),w.F=Date.now(),ca(w)}Ea(g)}function di(g){g.g&&(wa(g),g.g.cancel(),g.g=null)}function Kl(g){di(g),g.v&&(o.clearTimeout(g.v),g.v=null),$l(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function Es(g){if(!jc(g.h)&&!g.m){g.m=!0;var w=g.Ea;F||R(),W||(F(),W=!0),P.add(w,g),g.D=0}}function Rf(g,w){return da(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=w.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=er(h(g.Ea,g,w),Xl(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const X=new Di(this,this.j,g);let Q=this.o;if(this.U&&(Q?(Q=G(Q),xe(Q,this.U)):Q=this.U),this.u!==null||this.R||(X.J=Q,Q=null),this.S)e:{for(var w=0,S=0;S<this.i.length;S++){t:{var M=this.i[S];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(w+=M,w>4096){w=S;break e}if(w===4096||S===this.i.length-1){w=S+1;break e}}w=1e3}else w=1e3;w=Yc(this,X,w),S=Mi(this.J),st(S,"RID",g),st(S,"CVER",22),this.G&&st(S,"X-HTTP-Session-Id",this.G),jr(this,S),Q&&(this.R?w="headers="+ki(If(Q))+"&"+w:this.u&&Bl(S,this.u,Q)),jl(this.h,X),this.Ra&&st(S,"TYPE","init"),this.S?(st(S,"$req",w),st(S,"SID","null"),X.U=!0,tr(X,S,null)):tr(X,S,w),this.I=2}}else this.I==3&&(g?va(this,g):this.i.length==0||jc(this.h)||va(this))};function va(g,w){var S;w?S=w.l:S=g.V++;const M=Mi(g.J);st(M,"SID",g.M),st(M,"RID",S),st(M,"AID",g.K),jr(g,M),g.u&&g.o&&Bl(M,g.u,g.o),S=new Di(g,g.j,S,g.D+1),g.u===null&&(S.J=g.o),w&&(g.i=w.G.concat(g.i)),w=Yc(g,S,1e3),S.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),jl(g.h,S),tr(S,M,w)}function jr(g,w){g.H&&oe(g.H,function(S,M){st(w,M,S)}),g.l&&oe({},function(S,M){st(w,M,S)})}function Yc(g,w,S){S=Math.min(g.i.length,S);const M=g.l?h(g.l.Ka,g.l,g):null;e:{var X=g.i;let Fe=-1;for(;;){const Ft=["count="+S];Fe==-1?S>0?(Fe=X[0].g,Ft.push("ofs="+Fe)):Fe=0:Ft.push("ofs="+Fe);let ct=!0;for(let Gt=0;Gt<S;Gt++){var Q=X[Gt].g;const gi=X[Gt].map;if(Q-=Fe,Q<0)Fe=Math.max(0,X[Gt].g-100),ct=!1;else try{Q="req"+Q+"_"||"";try{var he=gi instanceof Map?gi:Object.entries(gi);for(const[xs,zr]of he){let Br=zr;l(zr)&&(Br=Cr(zr)),Ft.push(Q+xs+"="+encodeURIComponent(Br))}}catch(xs){throw Ft.push(Q+"type="+encodeURIComponent("_badmap")),xs}}catch{M&&M(gi)}}if(ct){he=Ft.join("&");break e}}he=void 0}return g=g.i.splice(0,S),w.G=g,he}function Cn(g){if(!g.g&&!g.v){g.Y=1;var w=g.Da;F||R(),W||(F(),W=!0),P.add(w,g),g.A=0}}function Ur(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=er(h(g.Da,g),Xl(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,oo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=er(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ft(10),di(this),oo(this))};function wa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function oo(g){g.g=new Di(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var w=Mi(g.na);st(w,"RID","rpc"),st(w,"SID",g.M),st(w,"AID",g.K),st(w,"CI",g.F?"0":"1"),!g.F&&g.ia&&st(w,"TO",g.ia),st(w,"TYPE","xmlhttp"),jr(g,w),g.u&&g.o&&Bl(w,g.u,g.o),g.O&&(g.g.H=g.O);var S=g.g;g=g.ba,S.M=1,S.A=ys(Mi(w)),S.u=null,S.R=!0,Vc(S,g)}n.Va=function(){this.C!=null&&(this.C=null,di(this),Ur(this),ft(19))};function $l(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function Hl(g,w){var S=null;if(g.g==w){$l(g),wa(g),g.g=null;var M=2}else if(Uc(g.h,w))S=w.G,fa(g.h,w),M=1;else return;if(g.I!=0){if(w.o)if(M==1){S=w.u?w.u.length:0,w=Date.now()-w.F;var X=g.D;M=Pr(),ut(M,new to(M,S)),Es(g)}else Cn(g);else if(X=w.m,X==3||X==0&&w.X>0||!(M==1&&Rf(g,w)||M==2&&Ur(g)))switch(S&&S.length>0&&(w=g.h,w.i=w.i.concat(S)),X){case 1:fi(g,5);break;case 4:fi(g,10);break;case 3:fi(g,6);break;default:fi(g,2)}}}function Xl(g,w){let S=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(S*=2),S*w}function fi(g,w){if(g.j.info("Error code "+w),w==2){var S=h(g.bb,g),M=g.Ua;const X=!M;M=new kr(M||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ga(M,"https"),ys(M),X?Lr(M.toString(),S):Or(M.toString(),S)}else ft(2);g.I=0,g.l&&g.l.pa(w),Ea(g),Kl(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function Ea(g){if(g.I=0,g.ja=[],g.l){const w=ui(g.h);(w.length!=0||g.i.length!=0)&&(I(g.ja,w),I(g.ja,g.i),g.h.i.length=0,E(g.i),g.i.length=0),g.l.oa()}}function Zc(g,w,S){var M=S instanceof kr?Mi(S):new kr(S);if(M.g!="")w&&(M.g=w+"."+M.g),Dr(M,M.u);else{var X=o.location;M=X.protocol,w=w?w+"."+X.hostname:X.hostname,X=+X.port;const Q=new kr(null);M&&ga(Q,M),w&&(Q.g=w),X&&Dr(Q,X),S&&(Q.h=S),M=Q}return S=g.G,w=g.wa,S&&w&&st(M,S,w),st(M,"VER",g.ka),jr(g,M),M}function Af(g,w,S){if(w&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=g.Aa&&!g.ma?new pt(new _s({ab:S})):new pt(g.ma),w.Fa(g.L),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pf(){}n=Pf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ql(){}ql.prototype.g=function(g,w){return new yn(g,w)};function yn(g,w){yt.call(this),this.g=new Gl(w),this.l=g,this.h=w&&w.messageUrlParams||null,g=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(g?g["X-WebChannel-Content-Type"]=w.messageContentType:g={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(g?g["X-WebChannel-Client-Profile"]=w.sa:g={"X-WebChannel-Client-Profile":w.sa}),this.g.U=g,(g=w&&w.Qb)&&!N(g)&&(this.g.u=g),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!N(w)&&(this.g.G=w,g=this.h,g!==null&&w in g&&(g=this.h,w in g&&delete g[w])),this.j=new ao(this)}m(yn,yt),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){Wl(this.g)},yn.prototype.o=function(g){var w=this.g;if(typeof g=="string"){var S={};S.__data__=g,g=S}else this.v&&(S={},S.__data__=Cr(g),g=S);w.i.push(new gy(w.Ya++,g)),w.I==3&&Es(w)},yn.prototype.N=function(){this.g.l=null,delete this.j,Wl(this.g),delete this.g,yn.Z.N.call(this)};function bf(g){gs.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var w=g.__sm__;if(w){e:{for(const S in w){g=S;break e}g=void 0}(this.i=g)&&(g=this.i,w=w!==null&&g in w?w[g]:void 0),this.data=w}else this.data=g}m(bf,gs);function kf(){eo.call(this),this.status=1}m(kf,eo);function ao(g){this.g=g}m(ao,Pf),ao.prototype.ra=function(){ut(this.g,"a")},ao.prototype.qa=function(g){ut(this.g,new bf(g))},ao.prototype.pa=function(g){ut(this.g,new kf)},ao.prototype.oa=function(){ut(this.g,"b")},ql.prototype.createWebChannel=ql.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,Ck=function(){return new ql},Sk=function(){return Pr()},Ik=On,Kv={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},nn.NO_ERROR=0,nn.TIMEOUT=8,nn.HTTP_ERROR=6,up=nn,rt.COMPLETE="complete",Tk=rt,Ll.EventType=Ar,Ar.OPEN="a",Ar.CLOSE="b",Ar.ERROR="c",Ar.MESSAGE="d",yt.prototype.listen=yt.prototype.J,Hh=Ll,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,xk=pt}).apply(typeof Wg<"u"?Wg:typeof self<"u"?self:typeof window<"u"?window:{});const eR="@firebase/firestore",tR="4.9.3";let En=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};En.UNAUTHENTICATED=new En(null),En.GOOGLE_CREDENTIALS=new En("google-credentials-uid"),En.FIRST_PARTY=new En("first-party-uid"),En.MOCK_USER=new En("mock-user");let Mc="12.7.0";const Tl=new VE("@firebase/firestore");function Nu(){return Tl.logLevel}function de(n,...e){if(Tl.logLevel<=$e.DEBUG){const t=e.map(ZE);Tl.debug(`Firestore (${Mc}): ${n}`,...t)}}function wi(n,...e){if(Tl.logLevel<=$e.ERROR){const t=e.map(ZE);Tl.error(`Firestore (${Mc}): ${n}`,...t)}}function qm(n,...e){if(Tl.logLevel<=$e.WARN){const t=e.map(ZE);Tl.warn(`Firestore (${Mc}): ${n}`,...t)}}function ZE(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Re(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Rk(n,i,t)}function Rk(n,e,t){let i=`FIRESTORE (${Mc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw wi(i),new Error(i)}function De(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||Rk(e,r,i)}function Tt(n,e){return n}const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ee extends hs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ll{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Ak{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class c8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(En.UNAUTHENTICATED)))}shutdown(){}}class h8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class d8{constructor(e){this.t=e,this.currentUser=En.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){De(this.o===void 0,42304);let i=this.i;const r=c=>this.i!==i?(i=this.i,t(c)):Promise.resolve();let s=new ll;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ll,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const c=s;e.enqueueRetryable((async()=>{await c.promise,await r(this.currentUser)}))},l=c=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>l(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ll)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(De(typeof i.accessToken=="string",31837,{l:i}),new Ak(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return De(e===null||typeof e=="string",2055,{h:e}),new En(e)}}class f8{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=En.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class g8{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new f8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(En.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class nR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class p8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Wi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){De(this.o===void 0,3512);const i=s=>{s.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,de("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new nR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(De(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new nR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function m8(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Pk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=m8(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function We(n,e){return n<e?-1:n>e?1:0}function $v(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return U0(r)===U0(s)?We(r,s):U0(r)?1:-1}return We(n.length,e.length)}const y8=55296,_8=57343;function U0(n){const e=n.charCodeAt(0);return e>=y8&&e<=_8}function gc(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function bk(n){return n+"\0"}const iR="__name__";class Hr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Re(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Re(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Hr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Hr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Hr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return We(e.length,t.length)}static compareSegments(e,t){const i=Hr.isNumericId(e),r=Hr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Hr.extractNumericId(e).compare(Hr.extractNumericId(t)):$v(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return YE.fromString(e.substring(4,e.length-2))}}class Ct extends Hr{construct(e,t,i){return new Ct(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ee(se.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Ct(t)}static emptyPath(){return new Ct([])}}const v8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends Hr{construct(e,t,i){return new zt(e,t,i)}static isValidIdentifier(e){return v8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===iR}static keyField(){return new zt([iR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Ee(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Ee(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Ee(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new Ee(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(t)}static emptyPath(){return new zt([])}}class ve{constructor(e){this.path=e}static fromPath(e){return new ve(Ct.fromString(e))}static fromName(e){return new ve(Ct.fromString(e).popFirst(5))}static empty(){return new ve(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ve(new Ct(e.slice()))}}function w8(n,e,t,i){if(e===!0&&i===!0)throw new Ee(se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function E8(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function x8(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Re(12329,{type:typeof n})}function kk(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ee(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=x8(n);throw new Ee(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Ht(n,e){const t={typeString:n};return e&&(t.value=e),t}function ff(n,e){if(!E8(n))throw new Ee(se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Ee(se.INVALID_ARGUMENT,t);return!0}const rR=-62135596800,sR=1e6;class bt{static now(){return bt.fromMillis(Date.now())}static fromDate(e){return bt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*sR);return new bt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ee(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ee(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<rR)throw new Ee(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ee(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/sR}_compareTo(e){return this.seconds===e.seconds?We(this.nanoseconds,e.nanoseconds):We(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ff(e,bt._jsonSchema))return new bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-rR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}bt._jsonSchemaVersion="firestore/timestamp/1.0",bt._jsonSchema={type:Ht("string",bt._jsonSchemaVersion),seconds:Ht("number"),nanoseconds:Ht("number")};class Ze{static fromTimestamp(e){return new Ze(e)}static min(){return new Ze(new bt(0,0))}static max(){return new Ze(new bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ld=-1;class Qp{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Hv(n){return n.fields.find((e=>e.kind===2))}function Ga(n){return n.fields.filter((e=>e.kind!==2))}Qp.UNKNOWN_ID=-1;class cp{constructor(e,t){this.fieldPath=e,this.kind=t}}class Od{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Od(0,Si.min())}}function T8(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Ze.fromTimestamp(i===1e9?new bt(t+1,0):new bt(t,i));return new Si(r,ve.empty(),e)}function Dk(n){return new Si(n.readTime,n.key,Ld)}class Si{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Si(Ze.min(),ve.empty(),Ld)}static max(){return new Si(Ze.max(),ve.empty(),Ld)}}function QE(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ve.comparator(n.documentKey,e.documentKey),t!==0?t:We(n.largestBatchId,e.largestBatchId))}const Mk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Nk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ym(n){if(n.code!==se.FAILED_PRECONDITION||n.message!==Mk)throw n;de("LocalStore","Unexpectedly lost primary lease")}class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Y(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Y?t:Y.resolve(t)}catch(t){return Y.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Y.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Y.reject(t)}static resolve(e){return new Y(((t,i)=>{t(e)}))}static reject(e){return new Y(((t,i)=>{i(e)}))}static waitFor(e){return new Y(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(c=>i(c)))})),o=!0,s===r&&t()}))}static or(e){let t=Y.resolve(!1);for(const i of e)t=t.next((r=>r?Y.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Y(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const h=c;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new Y(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const _i="SimpleDb";class Zm{static open(e,t,i,r){try{return new Zm(t,e.transaction(r,i))}catch(s){throw new id(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ll,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new id(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=JE(i.target.error);this.S.reject(new id(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(de(_i,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new S8(t)}}class Yo{static delete(e){return de(_i,"Removing database:",e),$a(k2().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!U2())return!1;if(Yo.F())return!0;const e=Jt(),t=Yo.M(e),i=0<t&&t<10,r=Lk(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Yo.M(Jt())===12.2&&wi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(de(_i,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new id(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Ee(se.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Ee(se.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new id(e,o))},r.onupgradeneeded=s=>{de(_i,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{de(_i,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=Zm.open(this.db,e,s?"readonly":"readwrite",i),c=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),Y.reject(h)))).toPromise();return c.catch((()=>{})),await l.D,c}catch(l){const c=l,h=c.name!=="FirebaseError"&&o<3;if(de(_i,"Transaction failed with error:",c.message,"Retrying:",h),this.close(),!h)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Lk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class I8{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return $a(this.U.delete())}}class id extends Ee{constructor(e,t){super(se.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Nl(n){return n.name==="IndexedDbTransactionError"}class S8{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(de(_i,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(de(_i,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),$a(i)}add(e){return de(_i,"ADD",this.store.name,e,e),$a(this.store.add(e))}get(e){return $a(this.store.get(e)).next((t=>(t===void 0&&(t=null),de(_i,"GET",this.store.name,e,t),t)))}delete(e){return de(_i,"DELETE",this.store.name,e),$a(this.store.delete(e))}count(){return de(_i,"COUNT",this.store.name),$a(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Y(((o,l)=>{s.onerror=c=>{l(c.target.error)},s.onsuccess=c=>{o(c.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,c)=>{o.push(c)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Y(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){de(_i,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Y(((i,r)=>{t.onerror=s=>{const o=JE(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Y(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const c=new I8(l),h=t(l.primaryKey,l.value,c);if(h instanceof Y){const f=h.catch((m=>(c.done(),Y.reject(m))));i.push(f)}c.isDone?r():c.G===null?l.continue():l.continue(c.G)}})).next((()=>Y.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function $a(n){return new Y(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=JE(i.target.error);t(r)}}))}let oR=!1;function JE(n){const e=Yo.M(Jt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Ee("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return oR||(oR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const rd="IndexBackfiller";class C8{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){de(rd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();de(rd,`Documents written: ${t}`)}catch(t){Nl(t)?de(rd,"Ignoring IndexedDB error during index backfill: ",t):await Ym(t)}await this.re(6e4)}))}}class R8{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Y.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return de(rd,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(de(rd,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=Dk(s);QE(o,i)>0&&(i=o)})),new Si(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class yr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}yr.ce=-1;const ul=-1;function Qm(n){return n==null}function Jp(n){return n===0&&1/n==-1/0}const em="";function Gn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=aR(e)),e=A8(n.get(t),e);return aR(e)}function A8(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case em:t+="";break;default:t+=s}}return t}function aR(n){return n+em+""}function Zr(n){const e=n.length;if(De(e>=2,64408,{path:n}),e===2)return De(n.charAt(0)===em&&n.charAt(1)==="",56145,{path:n}),Ct.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(em,s);switch((o<0||o>t)&&Re(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let c;r.length===0?c=l:(r+=l,c=r,r=""),i.push(c);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Re(61167,{path:n})}s=o+2}return new Ct(i)}const Wa="remoteDocuments",gf="owner",Iu="owner",Vd="mutationQueues",P8="userId",hr="mutations",lR="batchId",nl="userMutationsIndex",uR=["userId","batchId"];function hp(n,e){return[n,Gn(e)]}function Ok(n,e,t){return[n,Gn(e),t]}const b8={},pc="documentMutations",tm="remoteDocumentsV14",k8=["prefixPath","collectionGroup","readTime","documentId"],dp="documentKeyIndex",D8=["prefixPath","collectionGroup","documentId"],Vk="collectionGroupIndex",M8=["collectionGroup","readTime","prefixPath","documentId"],Fd="remoteDocumentGlobal",Xv="remoteDocumentGlobalKey",mc="targets",Fk="queryTargetsIndex",N8=["canonicalId","targetId"],yc="targetDocuments",L8=["targetId","path"],ex="documentTargetsIndex",O8=["path","targetId"],nm="targetGlobalKey",cl="targetGlobal",jd="collectionParents",V8=["collectionId","parent"],_c="clientMetadata",F8="clientId",Jm="bundles",j8="bundleId",ey="namedQueries",U8="name",tx="indexConfiguration",z8="indexId",qv="collectionGroupIndex",B8="collectionGroup",sd="indexState",G8=["indexId","uid"],jk="sequenceNumberIndex",W8=["uid","sequenceNumber"],od="indexEntries",K8=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Uk="documentKeyIndex",$8=["indexId","uid","orderedDocumentKey"],ty="documentOverlays",H8=["userId","collectionPath","documentId"],Yv="collectionPathOverlayIndex",X8=["userId","collectionPath","largestBatchId"],zk="collectionGroupOverlayIndex",q8=["userId","collectionGroup","largestBatchId"],nx="globals",Y8="name",Bk=[Vd,hr,pc,Wa,mc,gf,cl,yc,_c,Fd,jd,Jm,ey],Z8=[...Bk,ty],Gk=[Vd,hr,pc,tm,mc,gf,cl,yc,_c,Fd,jd,Jm,ey,ty],Wk=Gk,ix=[...Wk,tx,sd,od],Q8=ix,Kk=[...ix,nx],J8=Kk;class Zv extends Nk{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function en(n,e){const t=Tt(n);return Yo.O(t.le,e)}function cR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function rx(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function eG(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ai{constructor(e,t){this.comparator=e,this.root=t||xn.EMPTY}insert(e,t){return new ai(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,xn.BLACK,null,null))}remove(e){return new ai(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kg(this.root,e,this.comparator,!0)}}class Kg{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xn{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??xn.RED,this.left=r??xn.EMPTY,this.right=s??xn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new xn(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return xn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return xn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Re(27949);return e+(this.isRed()?0:1)}}xn.EMPTY=null,xn.RED=!0,xn.BLACK=!1;xn.EMPTY=new class{constructor(){this.size=0}get key(){throw Re(57766)}get value(){throw Re(16141)}get color(){throw Re(16727)}get left(){throw Re(29726)}get right(){throw Re(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new xn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class mt{constructor(e){this.comparator=e,this.data=new ai(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new hR(this.data.getIterator())}getIteratorFrom(e){return new hR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new mt(this.comparator);return t.data=e,t}}class hR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Su(n){return n.hasNext()?n.getNext():void 0}class js{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new js([])}unionWith(e){let t=new mt(zt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new js(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return gc(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class tG extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class li{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new tG("Invalid base64 string: "+s):s}})(e);return new li(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new li(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return We(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}li.EMPTY_BYTE_STRING=new li("");const nG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ta(n){if(De(!!n,39018),typeof n=="string"){let e=0;const t=nG.exec(n);if(De(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:$t(n.seconds),nanos:$t(n.nanos)}}function $t(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function vc(n){return typeof n=="string"?li.fromBase64String(n):li.fromUint8Array(n)}const $k="server_timestamp",Hk="__type__",Xk="__previous_value__",qk="__local_write_time__";function sx(n){return(n?.mapValue?.fields||{})[Hk]?.stringValue===$k}function Yk(n){const e=n.mapValue.fields[Xk];return sx(e)?Yk(e):e}function im(n){const e=ta(n.mapValue.fields[qk].timestampValue);return new bt(e.seconds,e.nanos)}class iG{constructor(e,t,i,r,s,o,l,c,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=f}}const rm="(default)";class wc{constructor(e,t){this.projectId=e,this.database=t||rm}static empty(){return new wc("","")}get isDefaultDatabase(){return this.database===rm}isEqual(e){return e instanceof wc&&e.projectId===this.projectId&&e.database===this.database}}const Zk="__type__",Qk="__max__",Wo={mapValue:{fields:{__type__:{stringValue:Qk}}}},Jk="__vector__",sm="value",fp={nullValue:"NULL_VALUE"};function Ec(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?sx(n)?4:eD(n)?9007199254740991:ny(n)?10:11:Re(28295,{value:n})}function ss(n,e){if(n===e)return!0;const t=Ec(n);if(t!==Ec(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return im(n).isEqual(im(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ta(r.timestampValue),l=ta(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return vc(r.bytesValue).isEqual(vc(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return $t(r.geoPointValue.latitude)===$t(s.geoPointValue.latitude)&&$t(r.geoPointValue.longitude)===$t(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return $t(r.integerValue)===$t(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=$t(r.doubleValue),l=$t(s.doubleValue);return o===l?Jp(o)===Jp(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return gc(n.arrayValue.values||[],e.arrayValue.values||[],ss);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(cR(o)!==cR(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!ss(o[c],l[c])))return!1;return!0})(n,e);default:return Re(52216,{left:n})}}function Ud(n,e){return(n.values||[]).find((t=>ss(t,e)))!==void 0}function na(n,e){if(n===e)return 0;const t=Ec(n),i=Ec(e);if(t!==i)return We(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return We(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=$t(s.integerValue||s.doubleValue),c=$t(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1})(n,e);case 3:return dR(n.timestampValue,e.timestampValue);case 4:return dR(im(n),im(e));case 5:return $v(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=vc(s),c=vc(o);return l.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),c=o.split("/");for(let h=0;h<l.length&&h<c.length;h++){const f=We(l[h],c[h]);if(f!==0)return f}return We(l.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=We($t(s.latitude),$t(o.latitude));return l!==0?l:We($t(s.longitude),$t(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return fR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},c=o.fields||{},h=l[sm]?.arrayValue,f=c[sm]?.arrayValue,m=We(h?.values?.length||0,f?.values?.length||0);return m!==0?m:fR(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Wo.mapValue&&o===Wo.mapValue)return 0;if(s===Wo.mapValue)return 1;if(o===Wo.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),h=o.fields||{},f=Object.keys(h);c.sort(),f.sort();for(let m=0;m<c.length&&m<f.length;++m){const y=$v(c[m],f[m]);if(y!==0)return y;const E=na(l[c[m]],h[f[m]]);if(E!==0)return E}return We(c.length,f.length)})(n.mapValue,e.mapValue);default:throw Re(23264,{he:t})}}function dR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return We(n,e);const t=ta(n),i=ta(e),r=We(t.seconds,i.seconds);return r!==0?r:We(t.nanos,i.nanos)}function fR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=na(t[r],i[r]);if(s)return s}return We(t.length,i.length)}function xc(n){return Qv(n)}function Qv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ta(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return vc(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ve.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=Qv(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${Qv(t.fields[o])}`;return r+"}"})(n.mapValue):Re(61005,{value:n})}function ox(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Jv(n){return!!n&&"integerValue"in n}function zd(n){return!!n&&"arrayValue"in n}function gR(n){return!!n&&"nullValue"in n}function pR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function z0(n){return!!n&&"mapValue"in n}function ny(n){return(n?.mapValue?.fields||{})[Zk]?.stringValue===Jk}function ad(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return rx(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=ad(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ad(n.arrayValue.values[t]);return e}return{...n}}function eD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Qk}const tD={mapValue:{fields:{[Zk]:{stringValue:Jk},[sm]:{arrayValue:{}}}}};function rG(n){return"nullValue"in n?fp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ox(wc.empty(),ve.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?ny(n)?tD:{mapValue:{}}:Re(35942,{value:n})}function sG(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ox(wc.empty(),ve.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?tD:"mapValue"in n?ny(n)?{mapValue:{}}:Wo:Re(61959,{value:n})}function mR(n,e){const t=na(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function yR(n,e){const t=na(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class pr{constructor(e){this.value=e}static empty(){return new pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!z0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ad(t)}setAll(e){let t=zt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=ad(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());z0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ss(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];z0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){rx(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new pr(ad(this.value))}}class Tn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Ze.min(),Ze.min(),Ze.min(),pr.empty(),0)}static newFoundDocument(e,t,i,r){return new Tn(e,1,t,Ze.min(),i,r,0)}static newNoDocument(e,t){return new Tn(e,2,t,Ze.min(),Ze.min(),pr.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Ze.min(),Ze.min(),pr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ze.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ze.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Tc{constructor(e,t){this.position=e,this.inclusive=t}}function _R(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=ve.comparator(ve.fromName(o.referenceValue),t.key):i=na(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function vR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ss(n.position[t],e.position[t]))return!1;return!0}class om{constructor(e,t="asc"){this.field=e,this.dir=t}}function oG(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class nD{}class qe extends nD{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new aG(e,t,i):t==="array-contains"?new cG(e,i):t==="in"?new lD(e,i):t==="not-in"?new hG(e,i):t==="array-contains-any"?new dG(e,i):new qe(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new lG(e,i):new uG(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(na(t,this.value)):t!==null&&Ec(this.value)===Ec(t)&&this.matchesComparison(na(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gt extends nD{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gt(e,t)}matches(e){return Ic(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ic(n){return n.op==="and"}function ew(n){return n.op==="or"}function ax(n){return iD(n)&&Ic(n)}function iD(n){for(const e of n.filters)if(e instanceof gt)return!1;return!0}function tw(n){if(n instanceof qe)return n.field.canonicalString()+n.op.toString()+xc(n.value);if(ax(n))return n.filters.map((e=>tw(e))).join(",");{const e=n.filters.map((t=>tw(t))).join(",");return`${n.op}(${e})`}}function rD(n,e){return n instanceof qe?(function(i,r){return r instanceof qe&&i.op===r.op&&i.field.isEqual(r.field)&&ss(i.value,r.value)})(n,e):n instanceof gt?(function(i,r){return r instanceof gt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&rD(o,r.filters[l])),!0):!1})(n,e):void Re(19439)}function sD(n,e){const t=n.filters.concat(e);return gt.create(t,n.op)}function oD(n){return n instanceof qe?(function(t){return`${t.field.canonicalString()} ${t.op} ${xc(t.value)}`})(n):n instanceof gt?(function(t){return t.op.toString()+" {"+t.getFilters().map(oD).join(" ,")+"}"})(n):"Filter"}class aG extends qe{constructor(e,t,i){super(e,t,i),this.key=ve.fromName(i.referenceValue)}matches(e){const t=ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class lG extends qe{constructor(e,t){super(e,"in",t),this.keys=aD("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class uG extends qe{constructor(e,t){super(e,"not-in",t),this.keys=aD("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function aD(n,e){return(e.arrayValue?.values||[]).map((t=>ve.fromName(t.referenceValue)))}class cG extends qe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return zd(t)&&Ud(t.arrayValue,this.value)}}class lD extends qe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ud(this.value.arrayValue,t)}}class hG extends qe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ud(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ud(this.value.arrayValue,t)}}class dG extends qe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!zd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Ud(this.value.arrayValue,i)))}}class fG{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function nw(n,e=null,t=[],i=[],r=null,s=null,o=null){return new fG(n,e,t,i,r,s,o)}function Il(n){const e=Tt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>tw(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),Qm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>xc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>xc(i))).join(",")),e.Te=t}return e.Te}function pf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!oG(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!rD(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!vR(n.startAt,e.startAt)&&vR(n.endAt,e.endAt)}function gG(n){return ve.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function am(n,e){return n.filters.filter((t=>t instanceof qe&&t.field.isEqual(e)))}function wR(n,e,t){let i=fp,r=!0;for(const s of am(n,e)){let o=fp,l=!0;switch(s.op){case"<":case"<=":o=rG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=fp}mR({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];mR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function ER(n,e,t){let i=Wo,r=!0;for(const s of am(n,e)){let o=Wo,l=!0;switch(s.op){case">=":case">":o=sG(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Wo}yR({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];yR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class iy{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function pG(n,e,t,i,r,s,o,l){return new iy(n,e,t,i,r,s,o,l)}function uD(n){return new iy(n)}function xR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function mG(n){return n.collectionGroup!==null}function ld(n){const e=Tt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new mt(zt.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new om(s,i))})),t.has(zt.keyField().canonicalString())||e.Ie.push(new om(zt.keyField(),i))}return e.Ie}function Ks(n){const e=Tt(n);return e.Ee||(e.Ee=yG(e,ld(n))),e.Ee}function yG(n,e){if(n.limitType==="F")return nw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new om(r.field,s)}));const t=n.endAt?new Tc(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Tc(n.startAt.position,n.startAt.inclusive):null;return nw(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function iw(n,e,t){return new iy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function cD(n,e){return pf(Ks(n),Ks(e))&&n.limitType===e.limitType}function hD(n){return`${Il(Ks(n))}|lt:${n.limitType}`}function kh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>oD(r))).join(", ")}]`),Qm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>xc(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>xc(r))).join(",")),`Target(${i})`})(Ks(n))}; limitType=${n.limitType})`}function ry(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):ve.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of ld(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,c){const h=_R(o,l,c);return o.inclusive?h<=0:h<0})(i.startAt,ld(i),r)||i.endAt&&!(function(o,l,c){const h=_R(o,l,c);return o.inclusive?h>=0:h>0})(i.endAt,ld(i),r))})(n,e)}function _G(n){return(e,t)=>{let i=!1;for(const r of ld(n)){const s=vG(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function vG(n,e,t){const i=n.field.isKeyField()?ve.comparator(e.key,t.key):(function(s,o,l){const c=o.data.field(s),h=l.data.field(s);return c!==null&&h!==null?na(c,h):Re(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Re(19790,{direction:n.dir})}}class aa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){rx(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return eG(this.inner)}size(){return this.innerSize}}const wG=new ai(ve.comparator);function il(){return wG}const dD=new ai(ve.comparator);function $g(...n){let e=dD;for(const t of n)e=e.insert(t.key,t);return e}function EG(n){let e=dD;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Qr(){return ud()}function fD(){return ud()}function ud(){return new aa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const xG=new ai(ve.comparator),TG=new mt(ve.comparator);function In(...n){let e=TG;for(const t of n)e=e.add(t);return e}const IG=new mt(We);function SG(){return IG}function CG(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Jp(e)?"-0":e}}function RG(n){return{integerValue:""+n}}class sy{constructor(){this._=void 0}}function AG(n,e,t){return n instanceof Bd?(function(r,s){const o={fields:{[Hk]:{stringValue:$k},[qk]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&sx(s)&&(s=Yk(s)),s&&(o.fields[Xk]=s),{mapValue:o}})(t,e):n instanceof Sc?gD(n,e):n instanceof Cc?pD(n,e):(function(r,s){const o=bG(r,s),l=TR(o)+TR(r.Ae);return Jv(o)&&Jv(r.Ae)?RG(l):CG(r.serializer,l)})(n,e)}function PG(n,e,t){return n instanceof Sc?gD(n,e):n instanceof Cc?pD(n,e):t}function bG(n,e){return n instanceof Gd?(function(i){return Jv(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class Bd extends sy{}class Sc extends sy{constructor(e){super(),this.elements=e}}function gD(n,e){const t=mD(e);for(const i of n.elements)t.some((r=>ss(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Cc extends sy{constructor(e){super(),this.elements=e}}function pD(n,e){let t=mD(e);for(const i of n.elements)t=t.filter((r=>!ss(r,i)));return{arrayValue:{values:t}}}class Gd extends sy{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function TR(n){return $t(n.integerValue||n.doubleValue)}function mD(n){return zd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class kG{constructor(e,t){this.field=e,this.transform=t}}function DG(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Sc&&r instanceof Sc||i instanceof Cc&&r instanceof Cc?gc(i.elements,r.elements,ss):i instanceof Gd&&r instanceof Gd?ss(i.Ae,r.Ae):i instanceof Bd&&r instanceof Bd})(n.transform,e.transform)}class MG{constructor(e,t){this.version=e,this.transformResults=t}}class _r{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new _r}static exists(e){return new _r(void 0,e)}static updateTime(e){return new _r(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function gp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class oy{}function yD(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new lx(n.key,_r.none()):new mf(n.key,n.data,_r.none());{const t=n.data,i=pr.empty();let r=new mt(zt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Nc(n.key,i,new js(r.toArray()),_r.none())}}function NG(n,e,t){n instanceof mf?(function(r,s,o){const l=r.value.clone(),c=SR(r.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Nc?(function(r,s,o){if(!gp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=SR(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(_D(r)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function cd(n,e,t,i){return n instanceof mf?(function(s,o,l,c){if(!gp(s.precondition,o))return l;const h=s.value.clone(),f=CR(s.fieldTransforms,c,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Nc?(function(s,o,l,c){if(!gp(s.precondition,o))return l;const h=CR(s.fieldTransforms,c,o),f=o.data;return f.setAll(_D(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((m=>m.field)))})(n,e,t,i):(function(s,o,l){return gp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function IR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&gc(i,r,((s,o)=>DG(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class mf extends oy{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Nc extends oy{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function _D(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function SR(n,e,t){const i=new Map;De(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,PG(o,l,t[r]))}return i}function CR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,AG(s,o,e))}return i}class lx extends oy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vD extends oy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ux{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&NG(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=cd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=cd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=fD();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const c=yD(o,l);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(Ze.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),In())}isEqual(e){return this.batchId===e.batchId&&gc(this.mutations,e.mutations,((t,i)=>IR(t,i)))&&gc(this.baseMutations,e.baseMutations,((t,i)=>IR(t,i)))}}class cx{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){De(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return xG})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new cx(e,t,i,r)}}class hx{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var Kt,Ye;function LG(n){switch(n){case se.OK:return Re(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Re(15467,{code:n})}}function OG(n){if(n===void 0)return wi("GRPC error has no .code"),se.UNKNOWN;switch(n){case Kt.OK:return se.OK;case Kt.CANCELLED:return se.CANCELLED;case Kt.UNKNOWN:return se.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return se.INTERNAL;case Kt.UNAVAILABLE:return se.UNAVAILABLE;case Kt.UNAUTHENTICATED:return se.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case Kt.NOT_FOUND:return se.NOT_FOUND;case Kt.ALREADY_EXISTS:return se.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return se.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case Kt.ABORTED:return se.ABORTED;case Kt.OUT_OF_RANGE:return se.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return se.UNIMPLEMENTED;case Kt.DATA_LOSS:return se.DATA_LOSS;default:return Re(39323,{code:n})}}(Ye=Kt||(Kt={}))[Ye.OK=0]="OK",Ye[Ye.CANCELLED=1]="CANCELLED",Ye[Ye.UNKNOWN=2]="UNKNOWN",Ye[Ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ye[Ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ye[Ye.NOT_FOUND=5]="NOT_FOUND",Ye[Ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ye[Ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ye[Ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ye[Ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ye[Ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ye[Ye.ABORTED=10]="ABORTED",Ye[Ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ye[Ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ye[Ye.INTERNAL=13]="INTERNAL",Ye[Ye.UNAVAILABLE=14]="UNAVAILABLE",Ye[Ye.DATA_LOSS=15]="DATA_LOSS";new YE([4294967295,4294967295],0);const VG={asc:"ASCENDING",desc:"DESCENDING"},FG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jG={and:"AND",or:"OR"};class UG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function zG(n,e){return n.useProto3Json||Qm(e)?e:{value:e}}function rw(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function BG(n,e){return rw(n,e.toTimestamp())}function xr(n){return De(!!n,49232),Ze.fromTimestamp((function(t){const i=ta(t);return new bt(i.seconds,i.nanos)})(n))}function wD(n,e){return sw(n,e).canonicalString()}function sw(n,e){const t=(function(r){return new Ct(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function ED(n){const e=Ct.fromString(n);return De(QG(e),10190,{key:e.toString()}),e}function lm(n,e){return wD(n.databaseId,e.path)}function pp(n,e){const t=ED(e);if(t.get(1)!==n.databaseId.projectId)throw new Ee(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ee(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ve(ID(t))}function xD(n,e){return wD(n.databaseId,e)}function TD(n){const e=ED(n);return e.length===4?Ct.emptyPath():ID(e)}function GG(n){return new Ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ID(n){return De(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function RR(n,e,t){return{name:lm(n,e),fields:t.value.mapValue.fields}}function WG(n,e,t){const i=pp(n,e.name),r=xr(e.updateTime),s=e.createTime?xr(e.createTime):Ze.min(),o=new pr({mapValue:{fields:e.fields}}),l=Tn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function um(n,e){let t;if(e instanceof mf)t={update:RR(n,e.key,e.value)};else if(e instanceof lx)t={delete:lm(n,e.key)};else if(e instanceof Nc)t={update:RR(n,e.key,e.data),updateMask:ZG(e.fieldMask)};else{if(!(e instanceof vD))return Re(16599,{Vt:e.type});t={verify:lm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof Bd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Sc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Cc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Gd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Re(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:BG(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Re(27497)})(n,e.precondition)),t}function ow(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?_r.updateTime(xr(s.updateTime)):s.exists!==void 0?_r.exists(s.exists):_r.none()})(e.currentDocument):_r.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let c=null;if("setToServerValue"in l)De(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new Bd;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];c=new Sc(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];c=new Cc(f)}else"increment"in l?c=new Gd(o,l.increment):Re(16584,{proto:l});const h=zt.fromServerFormat(l.fieldPath);return new kG(h,c)})(n,r))):[];if(e.update){e.update.name;const r=pp(n,e.update.name),s=new pr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(c){const h=c.fieldPaths||[];return new js(h.map((f=>zt.fromServerFormat(f))))})(e.updateMask);return new Nc(r,s,o,t,i)}return new mf(r,s,t,i)}if(e.delete){const r=pp(n,e.delete);return new lx(r,t)}if(e.verify){const r=pp(n,e.verify);return new vD(r,t)}return Re(1463,{proto:e})}function KG(n,e){return n&&n.length>0?(De(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?xr(r.updateTime):xr(s);return o.isEqual(Ze.min())&&(o=xr(s)),new MG(o,r.transformResults||[])})(t,e)))):[]}function $G(n,e){return{documents:[xD(n,e.path)]}}function HG(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=xD(n,r);const s=(function(h){if(h.length!==0)return RD(gt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(y){return{field:Lu(y.field),direction:XG(y.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=zG(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function SD(n){let e=TD(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){De(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(m){const y=CD(m);return y instanceof gt&&ax(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(m){return m.map((y=>(function(I){return new om(Ou(I.field),(function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(I.direction))})(y)))})(t.orderBy));let l=null;t.limit&&(l=(function(m){let y;return y=typeof m=="object"?m.value:m,Qm(y)?null:y})(t.limit));let c=null;t.startAt&&(c=(function(m){const y=!!m.before,E=m.values||[];return new Tc(E,y)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const y=!m.before,E=m.values||[];return new Tc(E,y)})(t.endAt)),pG(e,r,o,s,l,"F",c,h)}function CD(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ou(t.unaryFilter.field);return qe.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Ou(t.unaryFilter.field);return qe.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ou(t.unaryFilter.field);return qe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ou(t.unaryFilter.field);return qe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Re(61313);default:return Re(60726)}})(n):n.fieldFilter!==void 0?(function(t){return qe.create(Ou(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Re(58110);default:return Re(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return gt.create(t.compositeFilter.filters.map((i=>CD(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Re(1026)}})(t.compositeFilter.op))})(n):Re(30097,{filter:n})}function XG(n){return VG[n]}function qG(n){return FG[n]}function YG(n){return jG[n]}function Lu(n){return{fieldPath:n.canonicalString()}}function Ou(n){return zt.fromServerFormat(n.fieldPath)}function RD(n){return n instanceof qe?(function(t){if(t.op==="=="){if(pR(t.value))return{unaryFilter:{field:Lu(t.field),op:"IS_NAN"}};if(gR(t.value))return{unaryFilter:{field:Lu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(pR(t.value))return{unaryFilter:{field:Lu(t.field),op:"IS_NOT_NAN"}};if(gR(t.value))return{unaryFilter:{field:Lu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Lu(t.field),op:qG(t.op),value:t.value}}})(n):n instanceof gt?(function(t){const i=t.getFilters().map((r=>RD(r)));return i.length===1?i[0]:{compositeFilter:{op:YG(t.op),filters:i}}})(n):Re(54877,{filter:n})}function ZG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function QG(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Ku{constructor(e,t,i,r,s=Ze.min(),o=Ze.min(),l=li.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Ku(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ku(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ku(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ku(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class AD{constructor(e){this.yt=e}}function JG(n,e){let t;if(e.document)t=WG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=ve.fromSegments(e.noDocument.path),r=Cl(e.noDocument.readTime);t=Tn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Re(56709);{const i=ve.fromSegments(e.unknownDocument.path),r=Cl(e.unknownDocument.version);t=Tn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new bt(r[0],r[1]);return Ze.fromTimestamp(s)})(e.readTime)),t}function AR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:cm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:lm(s,o.key),fields:o.data.value.mapValue.fields,updateTime:rw(s,o.version.toTimestamp()),createTime:rw(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Sl(e.version)};else{if(!e.isUnknownDocument())return Re(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Sl(e.version)}}return i}function cm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Sl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Cl(n){const e=new bt(n.seconds,n.nanoseconds);return Ze.fromTimestamp(e)}function Ha(n,e){const t=(e.baseMutations||[]).map((s=>ow(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>ow(n.yt,s))),r=bt.fromMillis(e.localWriteTimeMs);return new ux(e.batchId,r,t,i)}function Xh(n){const e=Cl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Cl(n.lastLimboFreeSnapshotVersion):Ze.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return De(o===1,1966,{count:o}),Ks(uD(TD(s.documents[0])))})(n.query):(function(s){return Ks(SD(s))})(n.query),new Ku(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,li.fromBase64String(n.resumeToken))}function PD(n,e){const t=Sl(e.snapshotVersion),i=Sl(e.lastLimboFreeSnapshotVersion);let r;r=gG(e.target)?$G(n.yt,e.target):HG(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Il(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function bD(n){const e=SD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?iw(e,e.limit,"L"):e}function B0(n,e){return new hx(e.largestBatchId,ow(n.yt,e.overlayMutation))}function PR(n,e){const t=e.path.lastSegment();return[n,Gn(e.path.popLast()),t]}function bR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Sl(i.readTime),documentKey:Gn(i.documentKey.path),largestBatchId:i.largestBatchId}}class eW{getBundleMetadata(e,t){return kR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Cl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return kR(e).put((function(r){return{bundleId:r.id,createTime:Sl(xr(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return DR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:bD(s.bundledQuery),readTime:Cl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return DR(e).put((function(r){return{name:r.name,readTime:Sl(xr(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function kR(n){return en(n,Jm)}function DR(n){return en(n,ey)}class ay{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new ay(e,i)}getOverlay(e,t){return Dh(e).get(PR(this.userId,t)).next((i=>i?B0(this.serializer,i):null))}getOverlays(e,t){const i=Qr();return Y.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new hx(t,o);r.push(this.St(e,l))})),Y.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Gn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Dh(e).Z(Yv,l))})),Y.waitFor(s)}getOverlaysForCollection(e,t,i){const r=Qr(),s=Gn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Dh(e).J(Yv,o).next((l=>{for(const c of l){const h=B0(this.serializer,c);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=Qr();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Dh(e).ee({index:zk,range:l},((c,h,f)=>{const m=B0(this.serializer,h);s.size()<r||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Dh(e).put((function(r,s,o){const[l,c,h]=PR(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:um(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Dh(n){return en(n,ty)}class tW{bt(e){return en(e,nx)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?li.fromUint8Array(i):li.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Xa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt($t(e.integerValue));else if("doubleValue"in e){const i=$t(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Jp(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ta(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(vc(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?eD(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):ny(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Re(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=sm,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt($t(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),ve.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Xa.Kt=new Xa;const Cu=255;function nW(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function MR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=nW(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class iW{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=MR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=MR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Cu),this.sn(255)}_n(){this.an(Cu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Cu?(this.sn(Cu),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Cu?(this.an(Cu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class rW{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class sW{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Mh{constructor(){this.cn=new iW,this.ln=new rW(this.cn),this.hn=new sW(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class qa{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new qa(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:mp(this.En),directionalValue:mp(this.dn),orderedDocumentKey:mp(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function bo(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=NR(n.En,e.En),t!==0?t:(t=NR(n.dn,e.dn),t!==0?t:ve.comparator(n.In,e.In)))}function NR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function mp(n){return j2()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function LR(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class OR{constructor(e){this.mn=new mt(((t,i)=>zt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(De(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Hv(e);if(t!==void 0&&!this.wn(t))return!1;const i=Ga(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const c=i[s];if(!this.Sn(l,c)||!this.bn(this.fn[o++],c))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new mt(zt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new cp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new cp(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new cp(i.field,i.dir==="asc"?0:1)));return new Qp(Qp.UNKNOWN_ID,this.collectionId,t,Od.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function kD(n){if(De(n instanceof qe||n instanceof gt,20012),n instanceof qe){if(n instanceof lD){const t=n.value.arrayValue?.values?.map((i=>qe.create(n.field,"==",i)))||[];return gt.create(t,"or")}return n}const e=n.filters.map((t=>kD(t)));return gt.create(e,n.op)}function oW(n){if(n.getFilters().length===0)return[];const e=uw(kD(n));return De(DD(e),7391),aw(e)||lw(e)?[e]:e.getFilters()}function aw(n){return n instanceof qe}function lw(n){return n instanceof gt&&ax(n)}function DD(n){return aw(n)||lw(n)||(function(t){if(t instanceof gt&&ew(t)){for(const i of t.getFilters())if(!aw(i)&&!lw(i))return!1;return!0}return!1})(n)}function uw(n){if(De(n instanceof qe||n instanceof gt,34018),n instanceof qe)return n;if(n.filters.length===1)return uw(n.filters[0]);const e=n.filters.map((i=>uw(i)));let t=gt.create(e,n.op);return t=hm(t),DD(t)?t:(De(t instanceof gt,64498),De(Ic(t),40251),De(t.filters.length>1,57927),t.filters.reduce(((i,r)=>dx(i,r))))}function dx(n,e){let t;return De(n instanceof qe||n instanceof gt,38388),De(e instanceof qe||e instanceof gt,25473),t=n instanceof qe?e instanceof qe?(function(r,s){return gt.create([r,s],"and")})(n,e):VR(n,e):e instanceof qe?VR(e,n):(function(r,s){if(De(r.filters.length>0&&s.filters.length>0,48005),Ic(r)&&Ic(s))return sD(r,s.getFilters());const o=ew(r)?r:s,l=ew(r)?s:r,c=o.filters.map((h=>dx(h,l)));return gt.create(c,"or")})(n,e),hm(t)}function VR(n,e){if(Ic(e))return sD(e,n.getFilters());{const t=e.filters.map((i=>dx(n,i)));return gt.create(t,"or")}}function hm(n){if(De(n instanceof qe||n instanceof gt,11850),n instanceof qe)return n;const e=n.getFilters();if(e.length===1)return hm(e[0]);if(iD(n))return n;const t=e.map((r=>hm(r))),i=[];return t.forEach((r=>{r instanceof qe?i.push(r):r instanceof gt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:gt.create(i,n.op)}class aW{constructor(){this.Cn=new fx}addToCollectionParentIndex(e,t){return this.Cn.add(t),Y.resolve()}getCollectionParents(e,t){return Y.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Y.resolve()}deleteFieldIndex(e,t){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,t){return Y.resolve()}getDocumentsMatchingTarget(e,t){return Y.resolve(null)}getIndexType(e,t){return Y.resolve(0)}getFieldIndexes(e,t){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,t){return Y.resolve(Si.min())}getMinOffsetFromCollectionGroup(e,t){return Y.resolve(Si.min())}updateCollectionGroup(e,t,i){return Y.resolve()}updateIndexEntries(e,t){return Y.resolve()}}class fx{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new mt(Ct.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new mt(Ct.comparator)).toArray()}}const FR="IndexedDbIndexManager",Hg=new Uint8Array(0);class lW{constructor(e,t){this.databaseId=t,this.vn=new fx,this.Fn=new aa((i=>Il(i)),((i,r)=>pf(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Gn(r)};return jR(e).put(s)}return Y.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[bk(t),""],!1,!0);return jR(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Zr(o.parent))}return i}))}addFieldIndex(e,t){const i=Nh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((c=>[c.fieldPath.canonicalString(),c.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=Au(e);return s.next((l=>{o.put(bR(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Nh(e),r=Au(e),s=Ru(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Nh(e),i=Ru(e),r=Au(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Y.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new OR(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Ru(e);let r=!0;const s=new Map;return Y.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=In();const l=[];return Y.forEach(s,((c,h)=>{de(FR,`Using index ${(function(L){return`id=${L.indexId}|cg=${L.collectionGroup}|f=${L.fields.map((O=>`${O.fieldPath}:${O.kind}`)).join(",")}`})(c)} to execute ${Il(t)}`);const f=(function(L,O){const F=Hv(O);if(F===void 0)return null;for(const W of am(L,F.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null})(h,c),m=(function(L,O){const F=new Map;for(const W of Ga(O))for(const P of am(L,W.fieldPath))switch(P.op){case"==":case"in":F.set(W.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return F.set(W.fieldPath.canonicalString(),P.value),Array.from(F.values())}return null})(h,c),y=(function(L,O){const F=[];let W=!0;for(const P of Ga(O)){const R=P.kind===0?wR(L,P.fieldPath,L.startAt):ER(L,P.fieldPath,L.startAt);F.push(R.value),W&&(W=R.inclusive)}return new Tc(F,W)})(h,c),E=(function(L,O){const F=[];let W=!0;for(const P of Ga(O)){const R=P.kind===0?ER(L,P.fieldPath,L.endAt):wR(L,P.fieldPath,L.endAt);F.push(R.value),W&&(W=R.inclusive)}return new Tc(F,W)})(h,c),I=this.On(c,h,y),C=this.On(c,h,E),x=this.Nn(c,h,m),b=this.Bn(c.indexId,f,I,y.inclusive,C,E.inclusive,x);return Y.forEach(b,(D=>i.Y(D,t.limit).next((L=>{L.forEach((O=>{const F=ve.fromSegments(O.documentKey);o.has(F)||(o=o.add(F),l.push(F))}))}))))})).next((()=>l))}return Y.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=oW(gt.create(e.filters,"and")).map((i=>nw(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const c=(t!=null?t.length:1)*Math.max(i.length,s.length),h=c/(t!=null?t.length:1),f=[];for(let m=0;m<c;++m){const y=t?this.Ln(t[m/h]):Hg,E=this.kn(e,y,i[m%h],r),I=this.qn(e,y,s[m%h],o),C=l.map((x=>this.kn(e,y,x,!0)));f.push(...this.createRange(E,I,C))}return f}kn(e,t,i,r){const s=new qa(e,ve.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new qa(e,ve.empty(),t,i);return r?s.An():s}xn(e,t){const i=new OR(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Y.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(c){let h=new mt(zt.comparator),f=!1;for(const m of c.filters)for(const y of m.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?f=!0:h=h.add(y.field));for(const m of c.orderBy)m.field.isKeyField()||(h=h.add(m.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Mh;for(const r of Ga(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);Xa.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Mh;return Xa.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Mh;return Xa.Kt.Dt(ox(this.databaseId,t),i.Pn((function(s){const o=Ga(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Mh);let s=0;for(const o of Ga(e)){const l=i[s++];for(const c of r)if(this.Un(t,o.fieldPath)&&zd(l))r=this.Kn(r,o,l);else{const h=c.Pn(o.kind);Xa.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const c=new Mh;c.seed(l.un()),Xa.Kt.Dt(o,c.Pn(t.kind)),s.push(c)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof qe&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Nh(e),r=Au(e);return(t?i.J(qv,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Y.forEach(s,(l=>r.get([l.indexId,this.uid]).next((c=>{o.push((function(f,m){const y=m?new Od(m.sequenceNumber,new Si(Cl(m.readTime),new ve(Zr(m.documentKey)),m.largestBatchId)):Od.empty(),E=f.fields.map((([I,C])=>new cp(zt.fromServerFormat(I),C)));return new Qp(f.indexId,f.collectionGroup,E,y)})(l,c))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:We(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Nh(e),s=Au(e);return this.Gn(e).next((o=>r.J(qv,IDBKeyRange.bound(t,t)).next((l=>Y.forEach(l,(c=>s.put(bR(c.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Y.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Y.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),Y.forEach(l,(c=>this.zn(e,r,c).next((h=>{const f=this.jn(s,c);return h.isEqual(f)?Y.resolve():this.Jn(e,s,c,h,f)})))))))}))}Hn(e,t,i,r){return Ru(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Ru(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Ru(e);let s=new mt(bo);return r.ee({index:Uk,range:IDBKeyRange.only([i.indexId,this.uid,mp(this.$n(i,t))])},((o,l)=>{s=s.add(new qa(i.indexId,t,LR(l.arrayValue),LR(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new mt(bo);const r=this.Qn(t,e);if(r==null)return i;const s=Hv(t);if(s!=null){const o=e.data.field(s.fieldPath);if(zd(o))for(const l of o.arrayValue.values||[])i=i.add(new qa(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new qa(t.indexId,e.key,Hg,r));return i}Jn(e,t,i,r,s){de(FR,"Updating index entries for document '%s'",t.key);const o=[];return(function(c,h,f,m,y){const E=c.getIterator(),I=h.getIterator();let C=Su(E),x=Su(I);for(;C||x;){let b=!1,D=!1;if(C&&x){const L=f(C,x);L<0?D=!0:L>0&&(b=!0)}else C!=null?D=!0:b=!0;b?(m(x),x=Su(I)):D?(y(C),C=Su(E)):(C=Su(E),x=Su(I))}})(r,s,bo,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),Y.waitFor(o)}Gn(e){let t=1;return Au(e).ee({index:jk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>bo(o,l))).filter(((o,l,c)=>!l||bo(o,c[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=bo(o,e),c=bo(o,t);if(l===0)r[0]=e.An();else if(l>0&&c<0)r.push(o),r.push(o.An());else if(c>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,Hg,ve.empty()),c=r[o+1].Vn(this.uid,Hg,ve.empty());s.push(IDBKeyRange.bound(l,c))}return s}Zn(e,t){return bo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(UR)}getMinOffset(e,t){return Y.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Re(44426))))).next(UR)}}function jR(n){return en(n,jd)}function Ru(n){return en(n,od)}function Nh(n){return en(n,tx)}function Au(n){return en(n,sd)}function UR(n){De(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;QE(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Si(e.readTime,e.documentKey,t)}const zR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},MD=41943040;class Jn{static withCacheSize(e){return new Jn(e,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function ND(n,e,t){const i=n.store(hr),r=n.store(pc),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const c=i.ee({range:o},((f,m,y)=>(l++,y.delete())));s.push(c.next((()=>{De(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const m=Ok(e,f.key.path,t.batchId);s.push(r.delete(m)),h.push(f.key)}return Y.waitFor(s).next((()=>h))}function dm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Re(14731);e=n.noDocument}return JSON.stringify(e).length}Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn(MD,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);class ly{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){De(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new ly(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ko(e).ee({index:nl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Vu(e),o=ko(e);return o.add({}).next((l=>{De(typeof l=="number",49019);const c=new ux(l,t,i,r),h=(function(E,I,C){const x=C.baseMutations.map((D=>um(E.yt,D))),b=C.mutations.map((D=>um(E.yt,D)));return{userId:I,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:x,mutations:b}})(this.serializer,this.userId,c),f=[];let m=new mt(((y,E)=>We(y.canonicalString(),E.canonicalString())));for(const y of r){const E=Ok(this.userId,y.key.path,l);m=m.add(y.key.path.popLast()),f.push(o.put(h)),f.push(s.put(E,b8))}return m.forEach((y=>{f.push(this.indexManager.addToCollectionParentIndex(e,y))})),e.addOnCommittedListener((()=>{this.Xn[l]=c.keys()})),Y.waitFor(f).next((()=>c))}))}lookupMutationBatch(e,t){return ko(e).get(t).next((i=>i?(De(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Ha(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Y.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return ko(e).ee({index:nl,range:r},((o,l,c)=>{l.userId===this.userId&&(De(l.batchId>=i,47524,{tr:i}),s=Ha(this.serializer,l)),c.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ul;return ko(e).ee({index:nl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ul],[this.userId,Number.POSITIVE_INFINITY]);return ko(e).J(nl,t).next((i=>i.map((r=>Ha(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=hp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Vu(e).ee({range:r},((o,l,c)=>{const[h,f,m]=o,y=Zr(f);if(h===this.userId&&t.path.isEqual(y))return ko(e).get(m).next((E=>{if(!E)throw Re(61480,{nr:o,batchId:m});De(E.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:E.userId,batchId:m}),s.push(Ha(this.serializer,E))}));c.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt(We);const r=[];return t.forEach((s=>{const o=hp(this.userId,s.path),l=IDBKeyRange.lowerBound(o),c=Vu(e).ee({range:l},((h,f,m)=>{const[y,E,I]=h,C=Zr(E);y===this.userId&&s.path.isEqual(C)?i=i.add(I):m.done()}));r.push(c)})),Y.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=hp(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new mt(We);return Vu(e).ee({range:o},((c,h,f)=>{const[m,y,E]=c,I=Zr(y);m===this.userId&&i.isPrefixOf(I)?I.length===r&&(l=l.add(E)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(ko(e).get(s).next((o=>{if(o===null)throw Re(35274,{batchId:s});De(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Ha(this.serializer,o))})))})),Y.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return ND(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Y.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Y.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Vu(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const c=Zr(s[1]);r.push(c)}else l.done()})).next((()=>{De(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return LD(e,this.userId,t)}_r(e){return OD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:ul,lastStreamToken:""}))}}function LD(n,e,t){const i=hp(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Vu(n).ee({range:s,X:!0},((l,c,h)=>{const[f,m,y]=l;f===e&&m===r&&(o=!0),h.done()})).next((()=>o))}function ko(n){return en(n,hr)}function Vu(n){return en(n,pc)}function OD(n){return en(n,Vd)}class Rl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Rl(0)}static cr(){return new Rl(-1)}}class uW{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Rl(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ze.fromTimestamp(new bt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Pu(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(De(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return Pu(e).ee(((o,l)=>{const c=Xh(l);c.sequenceNumber<=t&&i.get(c.targetId)===null&&(r++,s.push(this.removeTargetData(e,c)))})).next((()=>Y.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Pu(e).ee(((i,r)=>{const s=Xh(r);t(s)}))}lr(e){return BR(e).get(nm).next((t=>(De(t!==null,2888),t)))}hr(e,t){return BR(e).put(nm,t)}Pr(e,t){return Pu(e).put(PD(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Il(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Pu(e).ee({range:r,index:Fk},((o,l,c)=>{const h=Xh(l);pf(t,h.target)&&(s=h,c.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Uo(e);return t.forEach((o=>{const l=Gn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),Y.waitFor(r)}removeMatchingKeys(e,t,i){const r=Uo(e);return Y.forEach(t,(s=>{const o=Gn(s.path);return Y.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Uo(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Uo(e);let s=In();return r.ee({range:i,X:!0},((o,l,c)=>{const h=Zr(o[1]),f=new ve(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Gn(t.path),r=IDBKeyRange.bound([i],[bk(i)],!1,!0);let s=0;return Uo(e).ee({index:ex,X:!0,range:r},(([o,l],c,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return Pu(e).get(t).next((i=>i?Xh(i):null))}}function Pu(n){return en(n,mc)}function BR(n){return en(n,cl)}function Uo(n){return en(n,yc)}const GR="LruGarbageCollector",cW=1048576;function WR([n,e],[t,i]){const r=We(n,t);return r===0?We(e,i):r}class hW{constructor(e){this.Ir=e,this.buffer=new mt(WR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();WR(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class dW{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){de(GR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Nl(t)?de(GR,"Ignoring IndexedDB error during garbage collection: ",t):await Ym(t)}await this.Vr(3e5)}))}}class fW{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Y.resolve(yr.ce);const i=new hW(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(de("LruGarbageCollector","Garbage collection skipped; disabled"),Y.resolve(zR)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(de("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),zR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,c,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(de("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,o=Date.now(),this.nthSequenceNumber(e,r)))).next((m=>(i=m,l=Date.now(),this.removeTargets(e,i,t)))).next((m=>(s=m,c=Date.now(),this.removeOrphanedDocuments(e,i)))).next((m=>(h=Date.now(),Nu()<=$e.DEBUG&&de("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(c-l)+`ms
	Removed ${m} documents in `+(h-c)+`ms
Total Duration: ${h-f}ms`),Y.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:m}))))}}function gW(n,e){return new fW(n,e)}class pW{constructor(e,t){this.db=e,this.garbageCollector=gW(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return Xg(e,i)}removeReference(e,t,i){return Xg(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Xg(e,t)}br(e,t){return(function(r,s){let o=!1;return OD(r).te((l=>LD(r,l,s).next((c=>(c&&(o=!0),Y.resolve(!c)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const c=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Ze.min()),Uo(e).delete((function(m){return[0,Gn(m.path)]})(o)))))}));r.push(c)}})).next((()=>Y.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Xg(e,t)}Sr(e,t){const i=Uo(e);let r,s=yr.ce;return i.ee({index:ex},(([o,l],{path:c,sequenceNumber:h})=>{o===0?(s!==yr.ce&&t(new ve(Zr(r)),s),s=h,r=c):s=yr.ce})).next((()=>{s!==yr.ce&&t(new ve(Zr(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Xg(n,e){return Uo(n).put((function(i,r){return{targetId:0,path:Gn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class VD{constructor(){this.changes=new aa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Y.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class mW{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Va(e).put(i)}removeEntry(e,t,i){return Va(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],cm(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Tn.newInvalidDocument(t);return Va(e).ee({index:dp,range:IDBKeyRange.only(Lh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Tn.newInvalidDocument(t)};return Va(e).ee({index:dp,range:IDBKeyRange.only(Lh(t))},((r,s)=>{i={document:this.Cr(t,s),size:dm(s)}})).next((()=>i))}getEntries(e,t){let i=il();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=il(),r=new ai(ve.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,dm(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Y.resolve();let r=new mt(HR);t.forEach((c=>r=r.add(c)));const s=IDBKeyRange.bound(Lh(r.first()),Lh(r.last())),o=r.getIterator();let l=o.getNext();return Va(e).ee({index:dp,range:s},((c,h,f)=>{const m=ve.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&HR(l,m)<0;)i(l,null),l=o.getNext();l&&l.isEqual(m)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Lh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),cm(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Va(e).J(IDBKeyRange.bound(l,c,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=il();for(const m of h){const y=this.Cr(ve.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);y.isFoundDocument()&&(ry(t,y)||r.has(y.key))&&(f=f.insert(y.key,y))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=il();const o=$R(t,i),l=$R(t,Si.max());return Va(e).ee({index:Vk,range:IDBKeyRange.bound(o,l,!0)},((c,h,f)=>{const m=this.Cr(ve.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(m.key,m),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new yW(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return KR(e).get(Xv).next((t=>(De(!!t,20021),t)))}Dr(e,t){return KR(e).put(Xv,t)}Cr(e,t){if(t){const i=JG(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Ze.min())))return i}return Tn.newInvalidDocument(e)}}function FD(n){return new mW(n)}class yW extends VD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new aa((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new mt(((s,o)=>We(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const c=AR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=dm(c);i+=h-l.size,t.push(this.Nr.addEntry(e,s,c))}else if(i-=l.size,this.trackRemovals){const c=AR(this.Nr.serializer,o.convertToNoDocument(Ze.min()));t.push(this.Nr.addEntry(e,s,c))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Y.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function KR(n){return en(n,Fd)}function Va(n){return en(n,tm)}function Lh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function $R(n,e){const t=e.documentKey.path.toArray();return[n,cm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function HR(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=We(t[s],i[s]),r)return r;return r=We(t.length,i.length),r||(r=We(t[t.length-2],i[i.length-2]),r||We(t[t.length-1],i[i.length-1]))}class _W{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class jD{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&cd(i.mutation,r,js.empty(),bt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,In()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=In()){const r=Qr();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=$g();return s.forEach(((l,c)=>{o=o.insert(l,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=Qr();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,In())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=il();const o=ud(),l=(function(){return ud()})();return t.forEach(((c,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Nc)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),cd(f.mutation,h,f.mutation.getFieldMask(),bt.now())):o.set(h.key,js.empty())})),this.recalculateAndSaveOverlays(e,s).next((c=>(c.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new _W(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=ud();let r=new ai(((o,l)=>o-l)),s=In();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((c=>{const h=t.get(c);if(h===null)return;let f=i.get(c)||js.empty();f=l.applyToLocalView(h,f),i.set(c,f);const m=(r.get(l.batchId)||In()).add(c);r=r.insert(l.batchId,m)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),h=c.key,f=c.value,m=fD();f.forEach((y=>{if(!s.has(y)){const E=yD(t.get(y),i.get(y));E!==null&&m.set(y,E),s=s.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return Y.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return ve.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):mG(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Y.resolve(Qr());let l=Ld,c=s;return o.next((h=>Y.forEach(h,((f,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(f)?Y.resolve():this.remoteDocumentCache.getEntry(e,f).next((y=>{c=c.insert(f,y)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,c,h,In()))).next((f=>({batchId:l,changes:EG(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ve(t)).next((i=>{let r=$g();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=$g();return this.indexManager.getCollectionParents(e,s).next((l=>Y.forEach(l,(c=>{const h=(function(m,y){return new iy(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((m,y)=>{o=o.insert(m,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((c,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Tn.newInvalidDocument(f)))}));let l=$g();return o.forEach(((c,h)=>{const f=s.get(c);f!==void 0&&cd(f.mutation,h,js.empty(),bt.now()),ry(t,h)&&(l=l.insert(c,h))})),l}))}}class vW{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Y.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:xr(r.createTime)}})(t)),Y.resolve()}getNamedQuery(e,t){return Y.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:bD(r.bundledQuery),readTime:xr(r.readTime)}})(t)),Y.resolve()}}class wW{constructor(){this.overlays=new ai(ve.comparator),this.qr=new Map}getOverlay(e,t){return Y.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Qr();return Y.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Y.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Y.resolve()}getOverlaysForCollection(e,t,i){const r=Qr(),s=t.length+1,o=new ve(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return Y.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new ai(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=Qr(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=Qr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return Y.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new hx(t,i));let s=this.qr.get(t);s===void 0&&(s=In(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class EW{constructor(){this.sessionToken=li.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Y.resolve()}}class gx{constructor(){this.Qr=new mt(un.$r),this.Ur=new mt(un.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new un(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new un(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new ve(new Ct([])),i=new un(t,e),r=new un(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ve(new Ct([])),i=new un(t,e),r=new un(t,e+1);let s=In();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new un(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class un{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ve.comparator(e.key,t.key)||We(e.Yr,t.Yr)}static Kr(e,t){return We(e.Yr,t.Yr)||ve.comparator(e.key,t.key)}}class xW{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new mt(un.$r)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new ux(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new un(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Y.resolve(o)}lookupMutationBatch(e,t){return Y.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?ul:this.tr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new un(t,0),r=new un(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),Y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt(We);return t.forEach((r=>{const s=new un(r,0),o=new un(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),Y.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;ve.isDocumentKey(s)||(s=s.child(""));const o=new un(new ve(s),0);let l=new mt(We);return this.Zr.forEachWhile((c=>{const h=c.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(c.Yr)),!0)}),o),Y.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){De(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Y.forEach(t.mutations,(r=>{const s=new un(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new un(t,0),r=this.Zr.firstAfterOrEqual(i);return Y.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class TW{constructor(e){this.ri=e,this.docs=(function(){return new ai(ve.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Y.resolve(i?i.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let i=il();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Tn.newInvalidDocument(r))})),Y.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=il();const o=t.path,l=new ve(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:h,value:{document:f}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||QE(Dk(f),i)<=0||(r.has(f.key)||ry(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Y.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Re(9500)}ii(e,t){return Y.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new IW(this)}getSize(e){return Y.resolve(this.size)}}class IW extends VD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Y.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class SW{constructor(e){this.persistence=e,this.si=new aa((t=>Il(t)),pf),this.lastRemoteSnapshotVersion=Ze.min(),this.highestTargetId=0,this.oi=0,this._i=new gx,this.targetCount=0,this.ai=Rl.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Y.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Rl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Y.resolve()}updateTargetData(e,t){return this.Pr(t),Y.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),Y.waitFor(s).next((()=>r))}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Y.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Y.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Y.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Y.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Y.resolve(i)}containsKey(e,t){return Y.resolve(this._i.containsKey(t))}}class UD{constructor(e,t){this.ui={},this.overlays={},this.ci=new yr(0),this.li=!1,this.li=!0,this.hi=new EW,this.referenceDelegate=e(this),this.Pi=new SW(this),this.indexManager=new aW,this.remoteDocumentCache=(function(r){return new TW(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new AD(t),this.Ii=new vW(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new wW,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new xW(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){de("MemoryPersistence","Starting transaction:",e);const r=new CW(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Y.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class CW extends Nk{constructor(e){super(),this.currentSequenceNumber=e}}class uy{constructor(e){this.persistence=e,this.Ri=new gx,this.Vi=null}static mi(e){return new uy(e)}get fi(){if(this.Vi)return this.Vi;throw Re(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Y.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Y.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Y.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.fi,(i=>{const r=ve.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Ze.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Y.or([()=>Y.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class RW{constructor(e){this.serializer=e}k(e,t,i,r){const s=new Zm("createOrUpgrade",t);i<1&&r>=1&&((function(c){c.createObjectStore(gf)})(e),(function(c){c.createObjectStore(Vd,{keyPath:P8}),c.createObjectStore(hr,{keyPath:lR,autoIncrement:!0}).createIndex(nl,uR,{unique:!0}),c.createObjectStore(pc)})(e),XR(e),(function(c){c.createObjectStore(Wa)})(e));let o=Y.resolve();return i<3&&r>=3&&(i!==0&&((function(c){c.deleteObjectStore(yc),c.deleteObjectStore(mc),c.deleteObjectStore(cl)})(e),XR(e)),o=o.next((()=>(function(c){const h=c.store(cl),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ze.min().toTimestamp(),targetCount:0};return h.put(nm,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(c,h){return h.store(hr).J().next((m=>{c.deleteObjectStore(hr),c.createObjectStore(hr,{keyPath:lR,autoIncrement:!0}).createIndex(nl,uR,{unique:!0});const y=h.store(hr),E=m.map((I=>y.put(I)));return Y.waitFor(E)}))})(e,s)))),o=o.next((()=>{(function(c){c.createObjectStore(_c,{keyPath:F8})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(c){c.createObjectStore(Fd)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(c){c.createObjectStore(Jm,{keyPath:j8})})(e),(function(c){c.createObjectStore(ey,{keyPath:U8})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(c){const h=c.createObjectStore(ty,{keyPath:H8});h.createIndex(Yv,X8,{unique:!1}),h.createIndex(zk,q8,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(c){const h=c.createObjectStore(tm,{keyPath:k8});h.createIndex(dp,D8),h.createIndex(Vk,M8)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Wa)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(c){c.createObjectStore(tx,{keyPath:z8,autoIncrement:!0}).createIndex(qv,B8,{unique:!1}),c.createObjectStore(sd,{keyPath:G8}).createIndex(jk,W8,{unique:!1}),c.createObjectStore(od,{keyPath:K8}).createIndex(Uk,$8,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(sd).clear()})).next((()=>{t.objectStore(od).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(c){c.createObjectStore(nx,{keyPath:Y8})})(e)}))),i<18&&r>=18&&j2()&&(o=o.next((()=>{t.objectStore(sd).clear()})).next((()=>{t.objectStore(od).clear()}))),o}wi(e){let t=0;return e.store(Wa).ee(((i,r)=>{t+=dm(r)})).next((()=>{const i={byteSize:t};return e.store(Fd).put(Xv,i)}))}yi(e){const t=e.store(Vd),i=e.store(hr);return t.J().next((r=>Y.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,ul],[s.userId,s.lastAcknowledgedBatchId]);return i.J(nl,o).next((l=>Y.forEach(l,(c=>{De(c.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const h=Ha(this.serializer,c);return ND(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(yc),i=e.store(Wa);return e.store(cl).get(nm).next((r=>{const s=[];return i.ee(((o,l)=>{const c=new Ct(o),h=(function(m){return[0,Gn(m)]})(c);s.push(t.get(h).next((f=>f?Y.resolve():(m=>t.put({targetId:0,path:Gn(m),sequenceNumber:r.highestListenSequenceNumber}))(c))))})).next((()=>Y.waitFor(s)))}))}bi(e,t){e.createObjectStore(jd,{keyPath:V8});const i=t.store(jd),r=new fx,s=o=>{if(r.add(o)){const l=o.lastSegment(),c=o.popLast();return i.put({collectionId:l,parent:Gn(c)})}};return t.store(Wa).ee({X:!0},((o,l)=>{const c=new Ct(o);return s(c.popLast())})).next((()=>t.store(pc).ee({X:!0},(([o,l,c],h)=>{const f=Zr(l);return s(f.popLast())}))))}Di(e){const t=e.store(mc);return t.ee(((i,r)=>{const s=Xh(r),o=PD(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(Wa),r=[];return i.ee(((s,o)=>{const l=t.store(tm),c=(function(m){return m.document?new ve(Ct.fromString(m.document.name).popFirst(5)):m.noDocument?ve.fromSegments(m.noDocument.path):m.unknownDocument?ve.fromSegments(m.unknownDocument.path):Re(36783)})(o).path.toArray(),h={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>Y.waitFor(r)))}Fi(e,t){const i=t.store(hr),r=FD(this.serializer),s=new UD(uy.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((c=>{let h=l.get(c.userId)??In();Ha(this.serializer,c).keys().forEach((f=>h=h.add(f))),l.set(c.userId,h)})),Y.forEach(l,((c,h)=>{const f=new En(h),m=ay.wt(this.serializer,f),y=s.getIndexManager(f),E=ly.wt(f,this.serializer,y,s.referenceDelegate);return new jD(r,E,m,y).recalculateAndSaveOverlaysForDocumentKeys(new Zv(t,yr.ce),c).next()}))}))}}function XR(n){n.createObjectStore(yc,{keyPath:L8}).createIndex(ex,O8,{unique:!0}),n.createObjectStore(mc,{keyPath:"targetId"}).createIndex(Fk,N8,{unique:!0}),n.createObjectStore(cl)}const Do="IndexedDbPersistence",G0=18e5,W0=5e3,K0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",AW="main";class px{constructor(e,t,i,r,s,o,l,c,h,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=y=>Promise.resolve(),!px.v())throw new Ee(se.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new pW(this,r),this.$i=t+AW,this.serializer=new AD(c),this.Ui=new Yo(this.$i,this.Ni,new RW(this.serializer)),this.hi=new tW,this.Pi=new uW(this.referenceDelegate,this.serializer),this.remoteDocumentCache=FD(this.serializer),this.Ii=new eW,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&wi(Do,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ee(se.FAILED_PRECONDITION,K0);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new yr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>qg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Nl(e))return de(Do,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return de(Do,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Oh(e).get(Iu).next((t=>Y.resolve(this.es(t))))}ts(e){return qg(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,G0)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=en(t,_c);return i.J().next((r=>{const s=this.ss(r,G0),o=r.filter((l=>s.indexOf(l)===-1));return Y.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Y.resolve(!0):Oh(e).get(Iu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,W0)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ee(se.FAILED_PRECONDITION,K0);return!1}}return!(!this.networkEnabled||!this.inForeground)||qg(e).J().next((i=>this.ss(i,W0).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&de(Do,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[gf,_c],(e=>{const t=new Zv(e,yr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>qg(e).J().next((t=>this.ss(t,G0).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return ly.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new lW(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return ay.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){de(Do,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(c){return c===18?J8:c===17?Kk:c===16?Q8:c===15?ix:c===14?Wk:c===13?Gk:c===12?Z8:c===11?Bk:void Re(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new Zv(l,this.ci?this.ci.next():yr.ce),t==="readwrite-primary"?this.Hi(o).next((c=>!!c||this.Yi(o))).next((c=>{if(!c)throw wi(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ee(se.FAILED_PRECONDITION,Mk);return i(o)})).next((c=>this.Xi(o).next((()=>c)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return Oh(e).get(Iu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,W0)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ee(se.FAILED_PRECONDITION,K0)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Oh(e).put(Iu,t)}static v(){return Yo.v()}Zi(e){const t=Oh(e);return t.get(Iu).next((i=>this.es(i)?(de(Do,"Releasing primary lease."),t.delete(Iu)):Y.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(wi(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;F2()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return de(Do,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return wi(Do,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){wi("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Oh(n){return en(n,gf)}function qg(n){return en(n,_c)}function PW(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class mx{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=In(),r=In();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new mx(e,t.fromCache,i,r)}}class bW{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class zD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return F2()?8:Lk(Jt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new bW;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Nu()<=$e.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",kh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Y.resolve()):(Nu()<=$e.DEBUG&&de("QueryEngine","Query:",kh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Nu()<=$e.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",kh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ks(t))):Y.resolve())}ys(e,t){if(xR(t))return Y.resolve(null);let i=Ks(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=iw(t,null,"F"),i=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=In(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((c=>{const h=this.Ds(t,l);return this.Cs(t,h,o,c.readTime)?this.ys(e,iw(t,null,"F")):this.vs(e,h,t,c)}))))})))))}ws(e,t,i,r){return xR(t)||r.isEqual(Ze.min())?Y.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Y.resolve(null):(Nu()<=$e.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),kh(t)),this.vs(e,o,t,T8(r,Ld)).next((l=>l)))}))}Ds(e,t){let i=new mt(_G(e));return t.forEach(((r,s)=>{ry(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Nu()<=$e.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",kh(t)),this.ps.getDocumentsMatchingQuery(e,t,Si.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const kW="LocalStore";class DW{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new ai(We),this.xs=new aa((s=>Il(s)),pf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function BD(n,e,t,i){return new DW(n,e,t,i)}async function MW(n,e){const t=Tt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let c=In();for(const h of r){o.push(h.batchId);for(const f of h.mutations)c=c.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(i,c).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function NW(n,e){const t=Tt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,c,h,f){const m=h.batch,y=m.keys();let E=Y.resolve();return y.forEach((I=>{E=E.next((()=>f.getEntry(c,I))).next((C=>{const x=h.docVersions.get(I);De(x!==null,48541),C.version.compareTo(x)<0&&(m.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),f.addEntry(C)))}))})),E.next((()=>l.mutationQueue.removeMutationBatch(c,m)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let c=In();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(c=c.add(l.batch.mutations[h].key));return c})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function LW(n){const e=Tt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function OW(n,e){const t=Tt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ul),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class qR{constructor(){this.activeTargetIds=SG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class GD{constructor(){this.Mo=new qR,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new qR,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class VW{Oo(e){}shutdown(){}}const YR="ConnectivityMonitor";class ZR{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){de(YR,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){de(YR,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Yg=null;function cw(){return Yg===null?Yg=(function(){return 268435456+Math.round(2147483648*Math.random())})():Yg++,"0x"+Yg.toString(16)}const $0="RestConnection",FW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class jW{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===rm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=cw(),l=this.zo(e,t.toUriEncodedString());de($0,`Sending RPC '${e}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,r,s);const{host:h}=new URL(l),f=Dl(h);return this.Jo(e,l,c,i,f).then((m=>(de($0,`Received RPC '${e}' ${o}: `,m),m)),(m=>{throw qm($0,`RPC '${e}' ${o} failed with error: `,m,"url: ",l,"request:",i),m}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=FW[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class UW{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const kn="WebChannelConnection";class zW extends jW{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=cw();return new Promise(((l,c)=>{const h=new xk;h.setWithCredentials(!0),h.listenOnce(Tk.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case up.NO_ERROR:const m=h.getResponseJson();de(kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),l(m);break;case up.TIMEOUT:de(kn,`RPC '${e}' ${o} timed out`),c(new Ee(se.DEADLINE_EXCEEDED,"Request time out"));break;case up.HTTP_ERROR:const y=h.getStatus();if(de(kn,`RPC '${e}' ${o} failed with status:`,y,"response text:",h.getResponseText()),y>0){let E=h.getResponseJson();Array.isArray(E)&&(E=E[0]);const I=E?.error;if(I&&I.status&&I.message){const C=(function(b){const D=b.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(D)>=0?D:se.UNKNOWN})(I.status);c(new Ee(C,I.message))}else c(new Ee(se.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new Ee(se.UNAVAILABLE,"Connection failed."));break;default:Re(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{de(kn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);de(kn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=cw(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Ck(),l=Sk(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;const f=s.join("");de(kn,`Creating RPC '${e}' stream ${r}: ${f}`,c);const m=o.createWebChannel(f,c);this.I_(m);let y=!1,E=!1;const I=new UW({Yo:x=>{E?de(kn,`Not sending because RPC '${e}' stream ${r} is closed:`,x):(y||(de(kn,`Opening RPC '${e}' stream ${r} transport.`),m.open(),y=!0),de(kn,`RPC '${e}' stream ${r} sending:`,x),m.send(x))},Zo:()=>m.close()}),C=(x,b,D)=>{x.listen(b,(L=>{try{D(L)}catch(O){setTimeout((()=>{throw O}),0)}}))};return C(m,Hh.EventType.OPEN,(()=>{E||(de(kn,`RPC '${e}' stream ${r} transport opened.`),I.o_())})),C(m,Hh.EventType.CLOSE,(()=>{E||(E=!0,de(kn,`RPC '${e}' stream ${r} transport closed`),I.a_(),this.E_(m))})),C(m,Hh.EventType.ERROR,(x=>{E||(E=!0,qm(kn,`RPC '${e}' stream ${r} transport errored. Name:`,x.name,"Message:",x.message),I.a_(new Ee(se.UNAVAILABLE,"The operation could not be completed")))})),C(m,Hh.EventType.MESSAGE,(x=>{if(!E){const b=x.data[0];De(!!b,16349);const D=b,L=D?.error||D[0]?.error;if(L){de(kn,`RPC '${e}' stream ${r} received error:`,L);const O=L.status;let F=(function(R){const k=Kt[R];if(k!==void 0)return OG(k)})(O),W=L.message;F===void 0&&(F=se.INTERNAL,W="Unknown error status: "+O+" with message "+L.message),E=!0,I.a_(new Ee(F,W)),m.close()}else de(kn,`RPC '${e}' stream ${r} received:`,b),I.u_(b)}})),C(l,Ik.STAT_EVENT,(x=>{x.stat===Kv.PROXY?de(kn,`RPC '${e}' stream ${r} detected buffering proxy`):x.stat===Kv.NOPROXY&&de(kn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{I.__()}),0),I}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function BW(){return typeof window<"u"?window:null}function yp(){return typeof document<"u"?document:null}function WD(n){return new UG(n,!0)}class KD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&de("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const QR="PersistentStream";class GW{constructor(e,t,i,r,s,o,l,c){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new KD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===se.RESOURCE_EXHAUSTED?(wi(t.toString()),wi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Ee(se.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return de(QR,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(de(QR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class WW extends GW{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return De(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,De(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){De(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=KG(e.writeResults,e.commitTime),i=xr(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=GG(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>um(this.serializer,i)))};this.q_(t)}}class KW{}class $W extends KW{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ee(se.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,sw(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ee(se.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,sw(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ee(se.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class HW{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(wi(t),this.aa=!1):de("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const cy="RemoteStore";class XW{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{dy(this)&&(de(cy,"Restarting streams for network reachability change."),await(async function(c){const h=Tt(c);h.Ea.add(4),await hy(h),h.Ra.set("Unknown"),h.Ea.delete(4),await yx(h)})(this))}))})),this.Ra=new HW(i,r)}}async function yx(n){if(dy(n))for(const e of n.da)await e(!0)}async function hy(n){for(const e of n.da)await e(!1)}function dy(n){return Tt(n).Ea.size===0}async function $D(n,e,t){if(!Nl(e))throw e;n.Ea.add(1),await hy(n),n.Ra.set("Offline"),t||(t=()=>LW(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{de(cy,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await yx(n)}))}function HD(n,e){return e().catch((t=>$D(n,t,e)))}async function fy(n){const e=Tt(n),t=ia(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ul;for(;qW(e);)try{const r=await OW(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,YW(e,r)}catch(r){await $D(e,r)}XD(e)&&qD(e)}function qW(n){return dy(n)&&n.Ta.length<10}function YW(n,e){n.Ta.push(e);const t=ia(n);t.O_()&&t.X_&&t.ea(e.mutations)}function XD(n){return dy(n)&&!ia(n).x_()&&n.Ta.length>0}function qD(n){ia(n).start()}async function ZW(n){ia(n).ra()}async function QW(n){const e=ia(n);for(const t of n.Ta)e.ea(t.mutations)}async function JW(n,e,t){const i=n.Ta.shift(),r=cx.from(i,e,t);await HD(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await fy(n)}async function e7(n,e){e&&ia(n).X_&&await(async function(i,r){if((function(o){return LG(o)&&o!==se.ABORTED})(r.code)){const s=i.Ta.shift();ia(i).B_(),await HD(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await fy(i)}})(n,e),XD(n)&&qD(n)}async function t7(n,e){const t=Tt(n);e?(t.Ea.delete(2),await yx(t)):e||(t.Ea.add(2),await hy(t),t.Ra.set("Unknown"))}function ia(n){return n.fa||(n.fa=(function(t,i,r){const s=Tt(t);return s.sa(),new WW(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:ZW.bind(null,n),r_:e7.bind(null,n),ta:QW.bind(null,n),na:JW.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await fy(n)):(await n.fa.stop(),n.Ta.length>0&&(de(cy,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class _x{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new ll,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new _x(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ee(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function n7(n,e){if(wi("AsyncQueue",`${e}: ${n}`),Nl(n))return new Ee(se.UNAVAILABLE,`${e}: ${n}`);throw n}class i7{constructor(){this.queries=JR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Tt(t),s=r.queries;r.queries=JR(),s.forEach(((o,l)=>{for(const c of l.Sa)c.onError(i)}))})(this,new Ee(se.ABORTED,"Firestore shutting down"))}}function JR(){return new aa((n=>hD(n)),cD)}function r7(n){n.Ca.forEach((e=>{e.next()}))}var eA,tA;(tA=eA||(eA={})).Ma="default",tA.Cache="cache";const s7="SyncEngine";class o7{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new aa((l=>hD(l)),cD),this.Iu=new Map,this.Eu=new Set,this.du=new ai(ve.comparator),this.Au=new Map,this.Ru=new gx,this.Vu={},this.mu=new Map,this.fu=Rl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function nA(n,e,t){const i=Tt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const c=Tt(o);c.onlineState=l;let h=!1;c.queries.forEach(((f,m)=>{for(const y of m.Sa)y.va(l)&&(h=!0)})),h&&r7(c)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function a7(n,e){const t=Tt(n),i=e.batch.batchId;try{const r=await NW(t.localStore,e);ZD(t,i,null),YD(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await vx(t,r)}catch(r){await Ym(r)}}async function l7(n,e,t){const i=Tt(n);try{const r=await(function(o,l){const c=Tt(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return c.mutationQueue.lookupMutationBatch(h,l).next((m=>(De(m!==null,37113),f=m.keys(),c.mutationQueue.removeMutationBatch(h,m)))).next((()=>c.mutationQueue.performConsistencyCheck(h))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>c.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);ZD(i,e,t),YD(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await vx(i,r)}catch(r){await Ym(r)}}function YD(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function ZD(n,e,t){const i=Tt(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function vx(n,e,t){const i=Tt(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,c)=>{o.push(i.pu(c,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(c.targetId)?.current;i.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(h){r.push(h);const f=mx.As(c.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(c,h){const f=Tt(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>Y.forEach(h,(y=>Y.forEach(y.Es,(E=>f.persistence.referenceDelegate.addReference(m,y.targetId,E))).next((()=>Y.forEach(y.ds,(E=>f.persistence.referenceDelegate.removeReference(m,y.targetId,E)))))))))}catch(m){if(!Nl(m))throw m;de(kW,"Failed to update sequence numbers: "+m)}for(const m of h){const y=m.targetId;if(!m.fromCache){const E=f.Ms.get(y),I=E.snapshotVersion,C=E.withLastLimboFreeSnapshotVersion(I);f.Ms=f.Ms.insert(y,C)}}})(i.localStore,s))}async function u7(n,e){const t=Tt(n);if(!t.currentUser.isEqual(e)){de(s7,"User change. New user:",e.toKey());const i=await MW(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((c=>{c.reject(new Ee(se.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await vx(t,i.Ls)}}function c7(n){const e=Tt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=a7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=l7.bind(null,e),e}class hw{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=WD(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return BD(this.persistence,new zD,e.initialUser,this.serializer)}Cu(e){return new UD(uy.mi,this.serializer)}Du(e){return new GD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hw.provider={build:()=>new hw};class h7 extends hw{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await c7(this.xu.syncEngine),await fy(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return BD(this.persistence,new zD,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new dW(i,e.asyncQueue,t)}Mu(e,t){const i=new R8(t,this.persistence);return new C8(e.asyncQueue,i)}Cu(e){const t=PW(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new px(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,BW(),yp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new GD}}class dw{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>nA(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=u7.bind(null,this.syncEngine),await t7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new i7})()}createDatastore(e){const t=WD(e.databaseInfo.databaseId),i=(function(s){return new zW(s)})(e.databaseInfo);return(function(s,o,l,c){return new $W(s,o,l,c)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new XW(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>nA(this.syncEngine,t,0)),(function(){return ZR.v()?new ZR:new VW})())}createSyncEngine(e,t){return(function(r,s,o,l,c,h,f){const m=new o7(r,s,o,l,c,h);return f&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Tt(t);de(cy,"RemoteStore shutting down."),i.Ea.add(5),await hy(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}dw.provider={build:()=>new dw};const iA="FirestoreClient";class d7{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=En.UNAUTHENTICATED,this.clientId=Pk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{de(iA,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(de(iA,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ll;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=n7(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function QD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const rA=new Map;const JD="firestore.googleapis.com",sA=!0;class oA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ee(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=JD,this.ssl=sA}else this.host=e.host,this.ssl=e.ssl??sA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=MD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<cW)throw new Ee(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}w8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=QD(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ee(se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ee(se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ee(se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class eM{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new oA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ee(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ee(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new oA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new c8;switch(i.type){case"firstParty":return new g8(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ee(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=rA.get(t);i&&(de("ComponentProvider","Removing Datastore"),rA.delete(t),i.terminate())})(this),Promise.resolve()}}function f7(n,e,t,i={}){n=kk(n,eM);const r=Dl(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(LE(`https://${l}`),OE("Firestore",!0)),s.host!==JD&&s.host!==l&&qm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:l,ssl:r,emulatorOptions:i};if(!wl(c,o)&&(n._setSettings(c),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=En.MOCK_USER;else{h=O2(i.mockUserToken,n._app?.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new Ee(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new En(m)}n._authCredentials=new h8(new Ak(h,f))}}class wx{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new wx(this.firestore,e,this._query)}}class Jr{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ex(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jr(this.firestore,e,this._key)}toJSON(){return{type:Jr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(ff(t,Jr._jsonSchema))return new Jr(e,i||null,new ve(Ct.fromString(t.referencePath)))}}Jr._jsonSchemaVersion="firestore/documentReference/1.0",Jr._jsonSchema={type:Ht("string",Jr._jsonSchemaVersion),referencePath:Ht("string")};class Ex extends wx{constructor(e,t,i){super(e,t,uD(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jr(this.firestore,null,new ve(e))}withConverter(e){return new Ex(this.firestore,e,this._path)}}const aA="AsyncQueue";class lA{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new KD(this,"async_queue_retry"),this._c=()=>{const i=yp();i&&de(aA,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=yp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=yp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ll;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Nl(e))throw e;de(aA,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,wi("INTERNAL UNHANDLED ERROR: ",uA(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=_x.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Re(47125,{Pc:uA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function uA(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class tM extends eM{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new lA,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new lA(e),this._firestoreClient=void 0,await e}}}function g7(n,e){const t=typeof n=="object"?n:jE(),i=typeof n=="string"?n:rm,r=Km(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=M2("firestore");s&&f7(r,...s)}return r}function p7(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new iG(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,QD(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new d7(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function m7(n,e){qm("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return y7(n,dw.provider,{build:i=>new h7(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function y7(n,e,t){if((n=kk(n,tM))._firestoreClient||n._terminated)throw new Ee(se.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ee(se.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},p7(n)}class Os{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Os(li.fromBase64String(e))}catch(t){throw new Ee(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Os(li.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Os._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ff(e,Os._jsonSchema))return Os.fromBase64String(e.bytes)}}Os._jsonSchemaVersion="firestore/bytes/1.0",Os._jsonSchema={type:Ht("string",Os._jsonSchemaVersion),bytes:Ht("string")};class nM{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ee(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ee(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ee(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return We(this._lat,e._lat)||We(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:hl._jsonSchemaVersion}}static fromJSON(e){if(ff(e,hl._jsonSchema))return new hl(e.latitude,e.longitude)}}hl._jsonSchemaVersion="firestore/geoPoint/1.0",hl._jsonSchema={type:Ht("string",hl._jsonSchemaVersion),latitude:Ht("number"),longitude:Ht("number")};class dl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:dl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ff(e,dl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new dl(e.vectorValues);throw new Ee(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}dl._jsonSchemaVersion="firestore/vectorValue/1.0",dl._jsonSchema={type:Ht("string",dl._jsonSchemaVersion),vectorValues:Ht("object")};const _7=new RegExp("[~\\*/\\[\\]]");function v7(n,e,t){if(e.search(_7)>=0)throw cA(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new nM(...e.split("."))._internalPath}catch{throw cA(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function cA(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new Ee(se.INVALID_ARGUMENT,s+n+o)}class iM{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Jr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new w7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rM("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class w7 extends iM{data(){return super.data()}}function rM(n,e){return typeof e=="string"?v7(n,e):e instanceof nM?e._internalPath:e._delegate._internalPath}class Zg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ju extends iM{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new _p(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(rM("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ju._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ju._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ju._jsonSchema={type:Ht("string",Ju._jsonSchemaVersion),bundleSource:Ht("string","DocumentSnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class _p extends Ju{data(e={}){return super.data(e)}}class hd{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Zg(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new _p(this._firestore,this._userDataWriter,i.key,i,new Zg(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ee(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const c=new _p(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Zg(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const c=new _p(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Zg(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:E7(l.type),doc:c,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Pk.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function E7(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re(61501,{type:n})}}hd._jsonSchemaVersion="firestore/querySnapshot/1.0",hd._jsonSchema={type:Ht("string",hd._jsonSchemaVersion),bundleSource:Ht("string","QuerySnapshot"),bundleName:Ht("string"),bundle:Ht("string")};(function(e,t=!0){(function(r){Mc=r})(Ml),El(new ea("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new tM(new d8(i.getProvider("auth-internal")),new p8(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ee(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wc(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),ns(eR,tR,e),ns(eR,tR,"esm2020")})();const sM="firebasestorage.googleapis.com",x7="storageBucket",T7=120*1e3,I7=600*1e3;class ds extends hs{constructor(e,t,i=0){super(H0(e),`Firebase Storage: ${t} (${H0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return H0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var os;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(os||(os={}));function H0(n){return"storage/"+n}function S7(){const n="An unknown error occurred, please check the error payload for server response.";return new ds(os.UNKNOWN,n)}function C7(){return new ds(os.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function R7(){return new ds(os.CANCELED,"User canceled the upload/download.")}function A7(n){return new ds(os.INVALID_URL,"Invalid URL '"+n+"'.")}function P7(n){return new ds(os.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function hA(n){return new ds(os.INVALID_ARGUMENT,n)}function oM(){return new ds(os.APP_DELETED,"The Firebase app was deleted.")}function b7(n){return new ds(os.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class vr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=vr.makeFromUrl(e,t)}catch{return new vr(e,"")}if(i.path==="")return i;throw P7(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(O){O.path.charAt(O.path.length-1)==="/"&&(O.path_=O.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function h(O){O.path_=decodeURIComponent(O.path)}const f="v[A-Za-z0-9_]+",m=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",E=new RegExp(`^https?://${m}/${f}/b/${r}/o${y}`,"i"),I={bucket:1,path:3},C=t===sM?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",b=new RegExp(`^https?://${C}/${r}/${x}`,"i"),L=[{regex:l,indices:c,postModify:s},{regex:E,indices:I,postModify:h},{regex:b,indices:{bucket:1,path:2},postModify:h}];for(let O=0;O<L.length;O++){const F=L[O],W=F.regex.exec(e);if(W){const P=W[F.indices.bucket];let R=W[F.indices.path];R||(R=""),i=new vr(P,R),F.postModify(i);break}}if(i==null)throw A7(e);return i}}class k7{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function D7(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function c(){return l===2}let h=!1;function f(...x){h||(h=!0,e.apply(null,x))}function m(x){r=setTimeout(()=>{r=null,n(E,c())},x)}function y(){s&&clearTimeout(s)}function E(x,...b){if(h){y();return}if(x){y(),f.call(null,x,...b);return}if(c()||o){y(),f.call(null,x,...b);return}i<64&&(i*=2);let L;l===1?(l=2,L=0):L=(i+Math.random())*1e3,m(L)}let I=!1;function C(x){I||(I=!0,y(),!h&&(r!==null?(x||(l=2),clearTimeout(r),m(0)):x||(l=1)))}return m(0),s=setTimeout(()=>{o=!0,C(!0)},t),C}function M7(n){n(!1)}function N7(n){return n!==void 0}function dA(n,e,t,i){if(i<e)throw hA(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw hA(`Invalid value for '${n}'. Expected ${t} or less.`)}function L7(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var fm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(fm||(fm={}));function O7(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class V7{constructor(e,t,i,r,s,o,l,c,h,f,m,y=!0,E=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=m,this.retry=y,this.isUsingEmulator=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((I,C)=>{this.resolve_=I,this.reject_=C,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new Qg(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const c=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===fm.NO_ERROR,c=s.getStatus();if(!l||O7(c,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===fm.ABORT;i(!1,new Qg(!1,null,f));return}const h=this.successCodes_.indexOf(c)!==-1;i(!0,new Qg(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());N7(c)?s(c):s()}catch(c){o(c)}else if(l!==null){const c=S7();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(r.canceled){const c=this.appDelete_?oM():R7();o(c)}else{const c=C7();o(c)}};this.canceled_?t(!1,new Qg(!1,null,!0)):this.backoffId_=D7(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&M7(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Qg{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function F7(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function j7(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function U7(n,e){e&&(n["X-Firebase-GMPID"]=e)}function z7(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function B7(n,e,t,i,r,s,o=!0,l=!1){const c=L7(n.urlParams),h=n.url+c,f=Object.assign({},n.headers);return U7(f,e),F7(f,t),j7(f,s),z7(f,i),new V7(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function G7(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function W7(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class gm{constructor(e,t){this._service=e,t instanceof vr?this._location=t:this._location=vr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new gm(e,t)}get root(){const e=new vr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return W7(this._location.path)}get storage(){return this._service}get parent(){const e=G7(this._location.path);if(e===null)return null;const t=new vr(this._location.bucket,e);return new gm(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw b7(e)}}function fA(n,e){const t=e?.[x7];return t==null?null:vr.makeFromBucketSpec(t,n)}function K7(n,e,t,i={}){n.host=`${e}:${t}`;const r=Dl(e);r&&(LE(`https://${n.host}/b`),OE("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:O2(s,n.app.options.projectId))}class $7{constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=sM,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=T7,this._maxUploadRetryTime=I7,this._requests=new Set,r!=null?this._bucket=vr.makeFromBucketSpec(r,this._host):this._bucket=fA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=vr.makeFromBucketSpec(this._url,e):this._bucket=fA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){dA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){dA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Wi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new gm(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new k7(oM());{const o=B7(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const gA="@firebase/storage",pA="0.14.0";const aM="storage";function H7(n=jE(),e){n=Qs(n);const i=Km(n,aM).getImmediate({identifier:e}),r=M2("storage");return r&&X7(i,...r),i}function X7(n,e,t,i={}){K7(n,e,t,i)}function q7(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new $7(t,i,r,e,Ml)}function Y7(){El(new ea(aM,q7,"PUBLIC").setMultipleInstances(!0)),ns(gA,pA,""),ns(gA,pA,"esm2020")}Y7();const Z7={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},xx=G2(Z7),X0=o8(xx),Q7=g7(xx);H7(xx);m7(Q7).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const J7="visvriend2024",eK=new Ls,lM=us()(af((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===J7;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await p9(X0,eK);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await qB(X0),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{XB(X0,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})}));function tK({target:n}){const e=J.useRef(null),t=J.useRef(null),i=cs(s=>s.setMap),r=ln(s=>s.showScaleBar);return J.useEffect(()=>{if(!e.current){const s=new X6({target:n,controls:[],view:new qr({center:gl([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),J.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new Z6({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const nK=["CartoDB (licht)","OpenStreetMap","Luchtfoto"];function iK(){const n=J.useRef(null),e=J.useRef(!1);tK({target:"map"});const t=cs(c=>c.map),i=Ho(c=>c.registerLayer),r=Ho(c=>c.setLayerVisibility),s=ln(c=>c.defaultBackground),o=ln(c=>c.gpsAutoStart),l=Gi(c=>c.startTracking);return J.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const c=new T0({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new g6}),h=new T0({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new Av({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),f=new T0({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Av({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})});t.addLayer(c),t.addLayer(h),t.addLayer(f),i("OpenStreetMap",c),i("CartoDB (licht)",h),i("Luchtfoto",f),t.updateSize(),m();async function m(){const y=TU();console.log(`Loading ${y.length} immediate layers...`),(await Promise.allSettled(y.map(async I=>{try{const C=await I.factory();return C?{name:I.name,layer:C}:null}catch(C){return console.warn(`Failed to create ${I.name}:`,C),null}}))).forEach(I=>{if(I.status==="fulfilled"&&I.value){const{name:C,layer:x}=I.value;t.addLayer(x),i(C,x)}})}},[t,i]),J.useEffect(()=>{if(!t||e.current)return;const c=setTimeout(()=>{const h=s||"CartoDB (licht)";nK.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(c)},[t,s,r]),J.useEffect(()=>{if(!t||!o)return;const c=setTimeout(()=>l(),500);return()=>clearTimeout(c)},[t,o,l]),T.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const rK=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sK=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),mA=n=>{const e=sK(n);return e.charAt(0).toUpperCase()+e.slice(1)},uM=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),oK=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var aK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const lK=J.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},c)=>J.createElement("svg",{ref:c,...aK,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:uM("lucide",r),...!s&&!oK(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>J.createElement(h,f)),...Array.isArray(s)?s:[s]]));const Ke=(n,e)=>{const t=J.forwardRef(({className:i,...r},s)=>J.createElement(lK,{ref:s,iconNode:e,className:uM(`lucide-${rK(mA(n))}`,`lucide-${n}`,i),...r}));return t.displayName=mA(n),t};const uK=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],cM=Ke("anchor",uK);const cK=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],hK=Ke("book-open",cK);const dK=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],fK=Ke("camera",dK);const gK=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],pK=Ke("check",gK);const mK=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],yK=Ke("chevron-up",mK);const _K=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],Tx=Ke("cloud",_K);const vK=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],hM=Ke("external-link",vK);const wK=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],EK=Ke("eye-off",wK);const xK=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],TK=Ke("eye",xK);const IK=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],SK=Ke("file-text",IK);const CK=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],as=Ke("fish",CK);const RK=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],AK=Ke("image-plus",RK);const PK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],dM=Ke("info",PK);const bK=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],pm=Ke("layers",bK);const kK=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],DK=Ke("locate-fixed",kK);const MK=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],NK=Ke("lock",MK);const LK=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],OK=Ke("log-out",LK);const VK=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Lc=Ke("map-pin",VK);const FK=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Ix=Ke("map",FK);const jK=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],UK=Ke("menu",jK);const zK=[["path",{d:"M5 12h14",key:"1ays0h"}]],BK=Ke("minus",zK);const GK=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],WK=Ke("navigation",GK);const KK=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],$K=Ke("person-standing",KK);const HK=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],fM=Ke("plus",HK);const XK=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],qK=Ke("rotate-ccw",XK);const YK=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],ZK=Ke("ruler",YK);const QK=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],JK=Ke("save",QK);const e$=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],t$=Ke("scale",e$);const n$=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],yA=Ke("search",n$);const i$=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],r$=Ke("settings",i$);const s$=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],o$=Ke("ship",s$);const a$=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],fw=Ke("star",a$);const l$=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],u$=Ke("thermometer",l$);const c$=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],h$=Ke("user",c$);const d$=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],f$=Ke("waves",d$);const g$=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],p$=Ke("wind",g$);const m$=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],la=Ke("x",m$);function y$(){const n=cs(x=>x.map),e=Xi(x=>x.openCatchForm),[t,i]=J.useState(null),[r,s]=J.useState(!1),[o,l]=J.useState(!1),c=J.useRef(null),h=J.useRef(null);J.useEffect(()=>{if(!n)return;const x=n.getViewport();if(!x)return;const b=600,D=15,L=V=>{if(V.touches.length!==1)return;const j=V.touches[0];h.current={x:j.clientX,y:j.clientY},c.current&&clearTimeout(c.current),c.current=window.setTimeout(()=>{if(!h.current)return;const z=window.__olMap;if(!z)return;const N=x.getBoundingClientRect(),le=[h.current.x-N.left,h.current.y-N.top],me=z.getCoordinateFromPixel(le);if(me){const fe=mS(me);V.preventDefault(),i({pixel:[h.current.x,h.current.y],coordinate:fe}),s(!0),l(!1),setTimeout(()=>l(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},b)},O=V=>{if(!c.current||!h.current)return;const j=V.touches[0],z=j.clientX-h.current.x,N=j.clientY-h.current.y;Math.sqrt(z*z+N*N)>D&&(clearTimeout(c.current),c.current=null)},F=()=>{c.current&&(clearTimeout(c.current),c.current=null),h.current=null},W=V=>{r&&V.preventDefault()},P=V=>{V.button===0&&(h.current={x:V.clientX,y:V.clientY},c.current&&clearTimeout(c.current),c.current=window.setTimeout(()=>{if(!h.current)return;const j=window.__olMap;if(!j)return;const z=x.getBoundingClientRect(),N=[h.current.x-z.left,h.current.y-z.top],le=j.getCoordinateFromPixel(N);if(le){const me=mS(le);i({pixel:[h.current.x,h.current.y],coordinate:me}),s(!0),l(!1),setTimeout(()=>l(!0),300)}},b))},R=V=>{if(!c.current||!h.current)return;const j=V.clientX-h.current.x,z=V.clientY-h.current.y;Math.sqrt(j*j+z*z)>D&&(clearTimeout(c.current),c.current=null)},k=()=>{c.current&&(clearTimeout(c.current),c.current=null),h.current=null};return x.addEventListener("touchstart",L,{passive:!1}),x.addEventListener("touchmove",O,{passive:!0}),x.addEventListener("touchend",F),x.addEventListener("touchcancel",F),x.addEventListener("contextmenu",W),x.addEventListener("mousedown",P),x.addEventListener("mousemove",R),x.addEventListener("mouseup",k),x.addEventListener("mouseleave",k),()=>{x.removeEventListener("touchstart",L),x.removeEventListener("touchmove",O),x.removeEventListener("touchend",F),x.removeEventListener("touchcancel",F),x.removeEventListener("contextmenu",W),x.removeEventListener("mousedown",P),x.removeEventListener("mousemove",R),x.removeEventListener("mouseup",k),x.removeEventListener("mouseleave",k),c.current&&clearTimeout(c.current)}},[n,r]);const f=()=>{o&&(s(!1),i(null),l(!1))},m=()=>{s(!1),i(null),l(!1)},y=()=>{if(!t)return;const[x,b]=t.coordinate;e({lat:b,lng:x}),m()},E=()=>{if(!t)return;const[x,b]=t.coordinate,D=`https://www.google.com/maps?q=${b},${x}`;window.open(D,"_blank"),m()},I=()=>{if(!t)return;const[x,b]=t.coordinate,D=`https://www.google.com/maps?layer=c&cbll=${b},${x}`;window.open(D,"_blank"),m()},C=x=>{const[b,D]=x;return`${D.toFixed(5)}N, ${b.toFixed(5)}E`};return T.jsx(ra,{children:r&&t&&T.jsxs(T.Fragment,{children:[T.jsx(it.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),T.jsxs(it.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(t.pixel[0],window.innerWidth-220),top:Math.min(t.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[T.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:T.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[T.jsx(Lc,{size:16}),T.jsx("span",{className:"text-xs font-mono",children:C(t.coordinate)})]})}),T.jsxs("div",{className:"bg-white",children:[T.jsxs("button",{onClick:y,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[T.jsx(as,{size:20,className:"text-orange-500"}),T.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),T.jsxs("button",{onClick:I,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[T.jsx($K,{size:20,className:"text-yellow-600"}),T.jsx("span",{className:"font-medium",children:"Street View"})]}),T.jsxs("button",{onClick:E,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[T.jsx(hM,{size:20,className:"text-blue-600"}),T.jsx("span",{className:"font-medium",children:"Google Maps"})]})]}),T.jsx("div",{className:"bg-white",children:T.jsxs("button",{onClick:m,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[T.jsx(la,{size:18}),T.jsx("span",{children:"Annuleren"})]})})]})]})})}function _$(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=Gi(),s=J.useCallback(l=>{i(l)},[i]),o=J.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return J.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function v$(){const{tracking:n,toggle:e}=_$();return T.jsx(it.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:T.jsx(DK,{size:22,strokeWidth:2})})}const w$="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function E$(){const n=cs(y=>y.map),e=Gi(y=>y.position),t=Gi(y=>y.accuracy),i=Gi(y=>y.tracking),r=Gi(y=>y.smoothHeading),s=ln(y=>y.showAccuracyCircle),o=Gi(y=>y.firstFix),l=Gi(y=>y.resetFirstFix),c=J.useRef(null),h=J.useRef(null),f=J.useRef(null),m=J.useMemo(()=>y=>new Yi({image:new _E({src:w$,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return J.useEffect(()=>{if(!n||!i&&!e)return;const y=gl([5.1214,52.0907]);return c.current=new sc({geometry:new pl(y)}),c.current.setStyle(m(0)),h.current=new sc({geometry:new pl(y)}),f.current=new CE({source:new yE({features:[h.current,c.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,m]),J.useEffect(()=>{if(!n||!e||!c.current||!h.current)return;const y=gl([e.lng,e.lat]);if(c.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const E=n.getView().getResolution()||1,I=Math.min(t/E,80);h.current.setStyle(new Yi({image:new bl({radius:I,fill:new Tr({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new Yi({}));if(o&&i){n.getView().setCenter(y),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:y,duration:150})},[n,i,e,t,o,l,s]),J.useEffect(()=>{if(!c.current)return;const y=r!==null?r*Math.PI/180:0;c.current.setStyle(m(y))},[r,m]),null}function x$(){const n=cs(i=>i.map),e=()=>{if(!n)return;const i=n.getView(),r=i.getZoom();r!==void 0&&i.animate({zoom:r+1,duration:200})},t=()=>{if(!n)return;const i=n.getView(),r=i.getZoom();r!==void 0&&i.animate({zoom:r-1,duration:200})};return T.jsxs("div",{className:"fixed top-2 left-2 z-[800] flex flex-col gap-1",children:[T.jsx(it.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:T.jsx(fM,{size:18,className:"text-gray-600"})}),T.jsx(it.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:T.jsx(BK,{size:18,className:"text-gray-600"})})]})}function T$(){const n=cs(L=>L.map),[e,t]=J.useState(!1),[i,r]=J.useState(""),[s,o]=J.useState([]),[l,c]=J.useState(!1),[h,f]=J.useState(!1),m=J.useRef(null),y=J.useRef(null),E=J.useRef();J.useEffect(()=>{e&&m.current&&m.current.focus()},[e]),J.useEffect(()=>{if(!e)return;const L=O=>{y.current&&!y.current.contains(O.target)&&I()};return document.addEventListener("mousedown",L),()=>document.removeEventListener("mousedown",L)},[e]),J.useEffect(()=>{if(!e)return;const L=O=>{O.key==="Escape"&&I()};return document.addEventListener("keydown",L),()=>document.removeEventListener("keydown",L)},[e]),J.useEffect(()=>{if(E.current&&clearTimeout(E.current),i.length<2){o([]);return}return E.current=window.setTimeout(async()=>{f(!0);try{const O=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();O.response?.docs&&o(O.response.docs)}catch(L){console.error("Search error:",L),o([])}finally{f(!1)}},300),()=>{E.current&&clearTimeout(E.current)}},[i]);const I=()=>{t(!1),r(""),o([]),c(!1)},C=async L=>{try{const F=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(L)}`)).json();if(F.response?.docs?.[0]?.centroide_ll){const P=F.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(P)return{lng:parseFloat(P[1]),lat:parseFloat(P[2])}}}catch(O){console.error("Lookup error:",O)}return null},x=async L=>{if(!n)return;const O=await C(L.id);O&&n.getView().animate({center:gl([O.lng,O.lat]),zoom:16,duration:1e3}),I()},b=async(L,O)=>{O.stopPropagation();const F=await C(L.id);if(F){const W=`https://www.google.com/maps?q=${F.lat},${F.lng}`;window.open(W,"_blank")}I()},D={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?T.jsxs("div",{ref:y,className:"fixed left-[52px] right-14 z-[850]",style:D,children:[T.jsxs(it.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[T.jsx(yA,{size:18,className:"search-icon"}),T.jsx("input",{ref:m,type:"text",value:i,onChange:L=>{r(L.target.value),c(!0)},onFocus:()=>c(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),T.jsx("button",{onClick:I,className:"search-clear",title:"Sluiten",children:T.jsx(la,{size:18})})]}),T.jsx(ra,{children:l&&s.length>0&&T.jsx(it.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(L=>T.jsxs("li",{className:"search-result-item",children:[T.jsx("div",{className:"search-result-content",onClick:()=>x(L),children:T.jsx("span",{className:"search-result-text",children:L.weergavenaam})}),T.jsx("button",{className:"search-navigate-btn",onClick:O=>b(L,O),title:"Open in Google Maps",children:T.jsx(hM,{size:20})})]},L.id))})}),l&&h&&T.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):T.jsx(it.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:D,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:T.jsx(yA,{size:22,className:"text-gray-600"})})}function I$({size:n=18}){return T.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[T.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),T.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),T.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),T.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function S$(){const[n,e]=J.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=Xi(),{user:r,loading:s,signInWithGoogle:o,logout:l}=lM(),c=ln(x=>x.showCatchButton),h=ln(x=>x.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},m=()=>e(!1),y=()=>{m(),t()},E=()=>{m(),i()},I=()=>{m(),o()},C=()=>{m(),l()};return T.jsxs(T.Fragment,{children:[T.jsx(it.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?T.jsx(la,{size:22,className:"text-white"}):T.jsx(UK,{size:22,className:"text-gray-600"})}),T.jsx(ra,{children:n&&T.jsxs(T.Fragment,{children:[T.jsx(it.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),T.jsxs(it.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[T.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-blue-500",children:T.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?T.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:T.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):r?T.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:T.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?T.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):T.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:T.jsx(h$,{size:16,className:"text-white"})}),T.jsxs("div",{className:"flex-1 min-w-0",children:[T.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),T.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),T.jsx("button",{onClick:C,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:T.jsx(OK,{size:16})})]})}):T.jsxs("button",{onClick:I,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[T.jsx(I$,{size:18}),T.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),T.jsx("div",{className:"py-1",children:T.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[T.jsx(dM,{size:18,className:"text-blue-500"}),T.jsx("span",{children:"Info & handleiding"})]})}),T.jsx("div",{className:"py-1 border-t border-gray-100",children:T.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx(as,{size:18,className:"text-green-500"}),T.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),T.jsx("button",{onClick:()=>h(!c),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${c?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:T.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${c?"left-[22px]":"left-0.5"}`})})]})}),T.jsx("div",{className:"mt-auto border-t border-gray-100",children:T.jsxs("button",{onClick:E,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[T.jsx(r$,{size:18,className:"text-gray-500"}),T.jsx("span",{children:"Instellingen"})]})}),T.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.0"})]})]})})]})}function C$(){const{infoPanelOpen:n,toggleInfoPanel:e}=Xi(),[t,i]=J.useState("info"),r=[{id:"info",label:"Info",icon:T.jsx(dM,{size:14})},{id:"functies",label:"Functies",icon:T.jsx(SK,{size:14})},{id:"handleiding",label:"Handleiding",icon:T.jsx(hK,{size:14})}];return T.jsx(ra,{children:n&&T.jsxs(T.Fragment,{children:[T.jsx(it.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),T.jsxs(it.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[T.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[T.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.0"}),T.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:T.jsx(la,{size:18,className:"text-white",strokeWidth:2.5})})]}),T.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>T.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&T.jsx(R$,{}),t==="functies"&&T.jsx(A$,{}),t==="handleiding"&&T.jsx(P$,{}),T.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:T.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.0 - Voor jou en je vismaat"})})]})]})]})})}function R$(){return T.jsxs(T.Fragment,{children:[T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),T.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),T.jsxs("ul",{className:"space-y-2 text-gray-600",children:[T.jsxs("li",{children:[T.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),T.jsxs("li",{children:[T.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),T.jsxs("div",{className:"text-gray-600 space-y-2",children:[T.jsxs("p",{children:[T.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),T.jsxs("p",{children:[T.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function A$(){return T.jsxs(T.Fragment,{children:[T.jsxs("section",{children:[T.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[T.jsx(Ix,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),T.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[T.jsxs("li",{children:[T.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),T.jsxs("li",{children:[T.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),T.jsxs("section",{children:[T.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[T.jsx(as,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),T.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[T.jsx("li",{children:"Registreer soort, gewicht en lengte"}),T.jsx("li",{children:"Vismethode en aas bijhouden"}),T.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),T.jsx("li",{children:"GPS locatie per vangst"})]})]}),T.jsxs("section",{children:[T.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[T.jsx(Lc,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),T.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[T.jsx("li",{children:"Markeer je beste visplekken"}),T.jsx("li",{children:"Voeg notities en ratings toe"}),T.jsx("li",{children:"Welke vis zit waar?"})]})]}),T.jsxs("section",{children:[T.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[T.jsx(Tx,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),T.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[T.jsx("li",{children:"Live weergegevens op je locatie"}),T.jsx("li",{children:"Windsnelheid en richting"}),T.jsx("li",{children:"Luchtdruk"}),T.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),T.jsxs("section",{children:[T.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[T.jsx(WK,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),T.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[T.jsx("li",{children:"Live GPS tracking"}),T.jsx("li",{children:"Zoek adressen en plaatsen"}),T.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function P$(){return T.jsxs(T.Fragment,{children:[T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),T.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[T.jsxs("li",{children:["Tik op de ",T.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),T.jsxs("li",{children:["Gebruik het ",T.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),T.jsxs("li",{children:["Tik op de ",T.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),T.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[T.jsxs("p",{children:[T.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),T.jsxs("p",{children:[T.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),T.jsxs("p",{children:[T.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),T.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[T.jsxs("p",{children:[T.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),T.jsxs("p",{children:[T.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),T.jsxs("p",{children:[T.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),T.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[T.jsxs("p",{children:[T.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),T.jsxs("p",{children:[T.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),T.jsxs("p",{children:[T.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),T.jsxs("section",{children:[T.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),T.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[T.jsxs("li",{children:["Gebruik de ",T.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),T.jsxs("li",{children:["Check de ",T.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),T.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),T.jsxs("li",{children:["Markeer succesvolle plekken als ",T.jsx("strong",{children:"favoriet"})]})]})]})]})}const b$=gl([5.1214,52.0907]),k$=8;function D$(){const n=cs(r=>r.map),e=Ho(r=>r.setLayerVisibility),t=Gi(r=>r.stopTracking),i=()=>{t(),e("CartoDB (licht)",!1),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:b$,zoom:k$,rotation:0,duration:500})};return T.jsx(it.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:T.jsx(qK,{size:18,className:"text-gray-600"})})}const M$={Map:Ix,Fish:as,Anchor:cM,Layers:pm,Star:fw},N$={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},L$={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function O$(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=PU(),[r,s]=J.useState(!1),[o,l]=J.useState(null),[c,h]=J.useState(!1),[f,m]=J.useState(""),y=C=>{e(C),s(!1)},E=(C,x)=>{C.stopPropagation();const{useLayerStore:b}=require("../../store"),D=b.getState().visible,L=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(O=>D[O]);t(x,{layers:L}),l(x),setTimeout(()=>l(null),2e3)},I=()=>{f.trim()&&(i(f.trim()),m(""),h(!1))};return T.jsxs(T.Fragment,{children:[T.jsx(it.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?T.jsx(yK,{size:20,className:"text-blue-600"}):T.jsx(pm,{size:20,className:"text-gray-600"})}),T.jsx(ra,{children:r&&T.jsxs(T.Fragment,{children:[T.jsx(it.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),T.jsxs(it.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[T.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:T.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),T.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(C=>{const x=M$[C.icon]||pm,b=N$[C.icon]||"text-blue-600",D=L$[C.icon]||"hover:bg-blue-50",L=o===C.id;return T.jsxs("button",{onClick:()=>y(C.id),className:`w-full h-9 flex items-center gap-2 px-2 ${D} rounded text-left transition-colors border-0 outline-none bg-transparent ${L?"bg-green-50":""}`,children:[T.jsx(x,{size:16,className:`${b} flex-shrink-0`}),T.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:C.name}),L?T.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:T.jsx(pK,{size:14,className:"text-green-500"})}):T.jsx("span",{onClick:O=>E(O,C.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:T.jsx(JK,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},C.id)})}),T.jsx("div",{className:"border-t border-gray-200 p-2",children:c?T.jsxs("div",{className:"flex gap-1",children:[T.jsx("input",{type:"text",value:f,onChange:C=>m(C.target.value),onKeyDown:C=>{C.key==="Enter"&&I(),C.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400"}),T.jsx("button",{onClick:I,disabled:!f.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):T.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",children:[T.jsx(fM,{size:14}),T.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const _A={lat:52.1326,lng:5.2913};function V$(){const{current:n,loading:e,fetchWeather:t,getFishingCondition:i}=C2(),r=Gi(f=>f.position),s=ln(f=>f.showWeatherWidget);if(J.useEffect(()=>{const f=r||_A;t(f.lat,f.lng)},[]),J.useEffect(()=>{r&&t(r.lat,r.lng)},[r,t]),J.useEffect(()=>{const f=r||_A,m=setInterval(()=>{t(f.lat,f.lng)},600*1e3);return()=>clearInterval(m)},[r,t]),!s||!n&&!e)return null;const o=i(),l={excellent:"text-green-500",good:"text-lime-500",moderate:"text-amber-500",poor:"text-red-500"},c={excellent:"Uitstekend",good:"Goed",moderate:"Matig",poor:"Slecht"},h=f=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(f/45)%8];return T.jsx(it.div,{className:"fixed top-24 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-3 min-w-[130px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e?T.jsx("div",{className:"text-sm text-gray-500",children:"Laden..."}):n?T.jsxs("div",{className:"space-y-2",children:[T.jsxs("div",{className:"flex items-center gap-2 pb-2 mb-1",children:[T.jsx(as,{size:18,className:l[o]}),T.jsx("span",{className:`text-sm font-medium ${l[o]}`,children:c[o]})]}),T.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[T.jsx(u$,{size:16,className:"text-gray-400"}),T.jsxs("span",{children:[Math.round(n.temperature),"C"]})]}),T.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[T.jsx(p$,{size:16,className:"text-gray-400"}),T.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",h(n.windDirection)]})]}),T.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[T.jsx(Tx,{size:16,className:"text-gray-400"}),T.jsxs("span",{children:[Math.round(n.pressure)," hPa"]})]})]}):null})}const gM=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],F$=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],j$=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],pM=200,U$=.7;async function z$(n,e=pM){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,c=r.height;l>c?l>e&&(c=Math.round(c*e/l),l=e):c>e&&(l=Math.round(l*e/c),c=e),s.width=l,s.height=c,o?.drawImage(r,0,0,l,c),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",U$)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function B$(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function G$(n){const e=await z$(n,pM),t=await B$(e);return{thumbnailBlob:e,thumbnailBase64:t}}function W$(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const q0=5;function K$({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=J.useRef(null),s=J.useRef(null),o=async c=>{const h=c.target.files;if(!h||h.length===0)return;const f=q0-n.length,m=Array.from(h).slice(0,f);for(const y of m)try{const{thumbnailBase64:E}=await G$(y),I={id:W$(),thumbnailBase64:E,createdAt:new Date().toISOString(),pendingUpload:!0};e(I)}catch(E){console.error("Failed to process image:",E)}c.target.value=""},l=n.length<q0;return T.jsxs("div",{className:"space-y-2",children:[T.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",q0,")"]}),T.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(c=>T.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[T.jsx("img",{src:c.thumbnailUrl||c.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&T.jsx("button",{type:"button",onClick:()=>t(c.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:T.jsx(la,{size:12,className:"text-white"})}),c.pendingUpload&&T.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},c.id)),l&&!i&&T.jsxs(T.Fragment,{children:[T.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[T.jsx(fK,{size:20,className:"text-gray-400"}),T.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),T.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[T.jsx(AK,{size:20,className:"text-gray-400"}),T.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),T.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),T.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}function $$({onClose:n,initialLocation:e}){const t=S2(P=>P.addCatch),i=C2(P=>P.current),r=Gi(P=>P.position),s=e||(r?{lat:r.lat,lng:r.lng}:null),[o,l]=J.useState(""),[c,h]=J.useState(""),[f,m]=J.useState(""),[y,E]=J.useState(""),[I,C]=J.useState(""),[x,b]=J.useState(""),[D,L]=J.useState([]),O=P=>{L(R=>[...R,P])},F=P=>{L(R=>R.filter(k=>k.id!==P))},W=P=>{if(P.preventDefault(),!o||!s){alert("Selecteer een vissoort en zorg dat GPS actief is");return}t({location:s,species:o,weight:c?parseInt(c):void 0,length:f?parseInt(f):void 0,photos:D.length>0?D:void 0,method:y||"Anders",bait:I||void 0,notes:x||void 0,weather:i?{temp:i.temperature,windSpeed:i.windSpeed,windDirection:i.windDirection,pressure:i.pressure}:void 0}),n()};return T.jsx(it.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:T.jsxs(it.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:P=>P.stopPropagation(),children:[T.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(as,{className:"text-white",size:24}),T.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),T.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:T.jsx(la,{size:20})})]}),T.jsxs("form",{onSubmit:W,className:"p-4 space-y-4",children:[s&&T.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[T.jsx(Lc,{size:16}),T.jsxs("span",{children:[s.lat.toFixed(5),", ",s.lng.toFixed(5)]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vissoort *"}),T.jsxs("select",{value:o,onChange:P=>l(P.target.value),className:"form-select",required:!0,children:[T.jsx("option",{value:"",children:"Selecteer vissoort..."}),gM.map(P=>T.jsx("option",{value:P.name,children:P.name},P.name))]})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[T.jsxs("div",{children:[T.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[T.jsx(t$,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),T.jsx("input",{type:"number",value:c,onChange:P=>h(P.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),T.jsxs("div",{children:[T.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[T.jsx(ZK,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),T.jsx("input",{type:"number",value:f,onChange:P=>m(P.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),T.jsxs("select",{value:y,onChange:P=>E(P.target.value),className:"form-select",children:[T.jsx("option",{value:"",children:"Selecteer methode..."}),F$.map(P=>T.jsx("option",{value:P,children:P},P))]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),T.jsxs("select",{value:I,onChange:P=>C(P.target.value),className:"form-select",children:[T.jsx("option",{value:"",children:"Selecteer aas..."}),j$.map(P=>T.jsx("option",{value:P,children:P},P))]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),T.jsx("textarea",{value:x,onChange:P=>b(P.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),T.jsx(K$,{photos:D,onAddPhoto:O,onRemovePhoto:F}),T.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function H$(){const n=Xi(l=>l.catchFormOpen),e=Xi(l=>l.catchFormLocation),t=Xi(l=>l.openCatchForm),i=Xi(l=>l.closeCatchForm),r=Gi(l=>l.position),s=ln(l=>l.showCatchButton),o=()=>{r?t({lat:r.lat,lng:r.lng}):t()};return T.jsxs(T.Fragment,{children:[s&&T.jsx(it.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:o,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:T.jsx(as,{size:22,strokeWidth:2})}),T.jsx(ra,{children:n&&T.jsx($$,{onClose:i,initialLocation:e||void 0})})]})}function X$(){const n=cs(r=>r.map),e=S2(r=>r.catches),t=J.useRef(null),i=J.useRef(null);return J.useEffect(()=>{if(n)return i.current=new yE,t.current=new CE({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),J.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=gl([r.location.lng,r.location.lat]),o=new sc({geometry:new pl(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new Yi({image:new bl({radius:14,fill:new Tr({color:"#22c55e"}),stroke:new Pc({color:"#fff",width:2})}),text:new ef({text:l,font:"bold 12px sans-serif",fill:new Tr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function q$(){const n=cs(r=>r.map),e=R2(r=>r.spots),t=J.useRef(null),i=J.useRef(null);return J.useEffect(()=>{if(n)return i.current=new yE,t.current=new CE({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),J.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=gl([r.location.lng,r.location.lat]),o=new sc({geometry:new pl(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new Yi({image:new bl({radius:12,fill:new Tr({color:l}),stroke:new Pc({color:"#fff",width:2})}),text:new ef({text:"",font:"bold 14px sans-serif",fill:new Tr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function Y$({onClose:n,initialLocation:e}){const t=R2(x=>x.addSpot),[i,r]=J.useState(""),[s,o]=J.useState(""),[l,c]=J.useState([]),[h,f]=J.useState(""),[m,y]=J.useState(3),E=e,I=x=>{c(b=>b.includes(x)?b.filter(D=>D!==x):[...b,x])},C=x=>{if(x.preventDefault(),!i||!E){alert("Geef een naam op voor deze locatie");return}t({name:i,location:E,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:m}),n()};return T.jsx(it.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:T.jsxs(it.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:x=>x.stopPropagation(),children:[T.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(fw,{className:"text-white",size:24}),T.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),T.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:T.jsx(la,{size:20})})]}),T.jsxs("form",{onSubmit:C,className:"p-4 space-y-4",children:[E&&T.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[T.jsx(Lc,{size:16}),T.jsxs("span",{children:[E.lat.toFixed(5),", ",E.lng.toFixed(5)]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),T.jsx("input",{type:"text",value:i,onChange:x=>r(x.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),T.jsx("input",{type:"text",value:s,onChange:x=>o(x.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),T.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(x=>T.jsx("button",{type:"button",onClick:()=>y(x),className:"p-1 border-0 outline-none bg-transparent",children:T.jsx(fw,{size:28,className:x<=m?"text-yellow-400 fill-yellow-400":"text-gray-300"})},x))})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),T.jsx("div",{className:"flex flex-wrap gap-2",children:gM.slice(0,12).map(x=>T.jsx("button",{type:"button",onClick:()=>I(x.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(x.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:x.name},x.name))})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),T.jsx("textarea",{value:h,onChange:x=>f(x.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),T.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const Z$=[{name:"Aanlegsteigers",icon:cM,color:"#2196F3"},{name:"Boothellingen",icon:o$,color:"#4CAF50"},{name:"Dieptekaart",icon:f$,color:"#00BCD4"},{name:"Viswater",icon:Lc,color:"#9C27B0"}],vA=[{name:"CartoDB (licht)",label:"Kaart"},{name:"OpenStreetMap",label:"OSM"},{name:"Luchtfoto",label:"Satelliet"}];function Q$(){const[n,e]=J.useState(!1),t=Ho(o=>o.visible),i=Ho(o=>o.toggleLayer),r=Ho(o=>o.setLayerVisibility),s=o=>{vA.forEach(l=>{r(l.name,l.name===o)})};return T.jsxs("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:[T.jsx(it.button,{className:"w-11 h-11 bg-white/80 hover:bg-white/90 backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:T.jsx(pm,{size:22})}),T.jsx(ra,{children:n&&T.jsxs(it.div,{className:"absolute bottom-12 right-0 bg-white rounded-xl shadow-lg p-3 min-w-[200px]",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},children:[T.jsxs("div",{className:"mb-3 pb-3 border-b border-gray-100",children:[T.jsx("div",{className:"text-xs font-medium text-gray-500 mb-2",children:"Achtergrond"}),T.jsx("div",{className:"flex gap-1",children:vA.map(o=>T.jsx("button",{className:`px-2 py-1 text-xs rounded-md transition-colors ${t[o.name]?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,onClick:()=>s(o.name),children:o.label},o.name))})]}),T.jsx("div",{className:"text-xs font-medium text-gray-500 mb-2",children:"Kaartlagen"}),T.jsx("div",{className:"space-y-1",children:Z$.map(o=>{const l=o.icon,c=t[o.name];return T.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-colors ${c?"bg-blue-50 text-blue-700":"hover:bg-gray-50 text-gray-700"}`,onClick:()=>i(o.name),children:[T.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center",style:{backgroundColor:c?o.color:"#e5e7eb"},children:T.jsx(l,{size:14,className:"text-white"})}),T.jsx("span",{className:"text-sm",children:o.name}),c&&T.jsx("div",{className:"ml-auto w-2 h-2 bg-green-500 rounded-full"})]},o.name)})})]})})]})}function J$(){const n=Xi(y=>y.settingsPanelOpen),e=Xi(y=>y.toggleSettingsPanel),t=ln(y=>y.showCatchButton),i=ln(y=>y.setShowCatchButton),r=ln(y=>y.showCatches),s=ln(y=>y.setShowCatches),o=ln(y=>y.showFavoriteSpots),l=ln(y=>y.setShowFavoriteSpots),c=ln(y=>y.defaultBackground),h=ln(y=>y.setDefaultBackground),f=ln(y=>y.showWeatherWidget),m=ln(y=>y.setShowWeatherWidget);return n?T.jsx(it.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:T.jsxs(it.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:y=>y.stopPropagation(),children:[T.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[T.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),T.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:T.jsx(la,{size:20,className:"text-white"})})]}),T.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[T.jsxs("div",{className:"space-y-3",children:[T.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),T.jsx(Jg,{icon:T.jsx(as,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),T.jsx(Jg,{icon:T.jsx(as,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),T.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[T.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),T.jsx(Jg,{icon:T.jsx(Lc,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),T.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[T.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:T.jsx(Ix,{size:18,className:"text-gray-500"})}),T.jsxs("div",{className:"flex-1",children:[T.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),T.jsxs("select",{value:c,onChange:y=>h(y.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-400",children:[T.jsx("option",{value:"CartoDB (licht)",children:"Kaart (licht)"}),T.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),T.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),T.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[T.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weer"}),T.jsx(Jg,{icon:T.jsx(Tx,{size:18,className:"text-blue-400"}),label:"Weer widget",description:"Toon temperatuur, wind en luchtdruk",checked:f,onChange:m})]})]}),T.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function Jg({icon:n,label:e,description:t,checked:i,onChange:r}){return T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),T.jsxs("div",{className:"flex-1",children:[T.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),T.jsx("p",{className:"text-xs text-gray-400",children:t})]}),T.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-blue-500":"bg-gray-300"}`,children:T.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function eH({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=lM(),[l,c]=J.useState(""),[h,f]=J.useState(!1),[m,y]=J.useState(!1),[E,I]=J.useState(null);if(J.useEffect(()=>{o()},[o]),s)return T.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center",children:T.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return T.jsx(T.Fragment,{children:n});const C=b=>{b.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},x=async()=>{try{I(null),await i()}catch{I("Google login mislukt"),setTimeout(()=>I(null),3e3)}};return T.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center p-4",children:T.jsxs(it.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[T.jsxs("div",{className:"flex flex-col items-center mb-6",children:[T.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:T.jsx(as,{size:40,className:"text-white"})}),T.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),T.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),T.jsxs(it.button,{onClick:x,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[T.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[T.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),T.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),T.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),T.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),E&&T.jsx(it.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:E}),T.jsxs("div",{className:"flex items-center gap-3 my-4",children:[T.jsx("div",{className:"flex-1 h-px bg-gray-200"}),T.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),T.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),T.jsxs("form",{onSubmit:C,className:"space-y-4",children:[T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:T.jsx(NK,{size:20})}),T.jsx("input",{type:m?"text":"password",value:l,onChange:b=>c(b.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-blue-400"}`}),T.jsx("button",{type:"button",onClick:()=>y(!m),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m?T.jsx(EK,{size:20}):T.jsx(TK,{size:20})})]}),h&&T.jsx(it.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),T.jsx(it.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),T.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function tH(){const n=Xi(i=>i.spotFormOpen),e=Xi(i=>i.spotFormLocation),t=Xi(i=>i.closeSpotForm);return T.jsx(eH,{children:T.jsxs("div",{className:"h-screen w-screen overflow-hidden",children:[T.jsx(iK,{}),T.jsx(E$,{}),T.jsx(X$,{}),T.jsx(q$,{}),T.jsx(y$,{}),T.jsx(x$,{}),T.jsx(T$,{}),T.jsx(S$,{}),T.jsx(O$,{}),T.jsx(D$,{}),T.jsx(Q$,{}),T.jsx(H$,{}),T.jsx(v$,{}),T.jsx(V$,{}),T.jsx(C$,{}),T.jsx(J$,{}),T.jsx(ra,{children:n&&T.jsx(Y$,{onClose:t,initialLocation:e||void 0})})]})})}const nH="1.2.0";console.log(`%c VisApp v${nH}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");kN.createRoot(document.getElementById("root")).render(T.jsx(tH,{}));export{pH as $,wb as A,Rt as B,bl as C,tt as D,ze as E,Tr as F,o4 as G,Sm as H,f3 as I,fl as J,yb as K,vb as L,uH as M,Dp as N,f4 as O,hH as P,Eb as Q,$u as R,Yi as S,c6 as T,pl as U,yE as V,QP as W,oH as X,aH as Y,cH as Z,mH as _,CE as a,wS as a0,ij as a1,rj as a2,gH as a3,fH as a4,Cd as a5,dH as a6,lH as a7,dr as a8,sc as a9,et as aa,ip as ab,kp as ac,Vb as ad,Iv as ae,rc as af,a4 as ag,Pc as b,Bn as c,_H as d,Zi as e,oi as f,dt as g,rC as h,Zw as i,G5 as j,T0 as k,oE as l,ol as m,Yw as n,ZP as o,mb as p,_b as q,sH as r,h4 as s,Dm as t,xS as u,Wu as v,ES as w,d4 as x,uE as y,lE as z};
//# sourceMappingURL=index-CFRAvAAx.js.map
