const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-7OwWae1Y.js","assets/GeoJSON-DfCFI_mW.js","assets/boothellingenOL-DhmmLHca.js","assets/viswaterOL-DAvhoQqQ.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function mw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var V_={exports:{}},Th={},j_={exports:{}},We={};var LT;function PN(){if(LT)return We;LT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function y(W){return W===null||typeof W!="object"?null:(W=p&&W[p]||W["@@iterator"],typeof W=="function"?W:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,S={};function T(W,K,Ee){this.props=W,this.context=K,this.refs=S,this.updater=Ee||x}T.prototype.isReactComponent={},T.prototype.setState=function(W,K){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,K,"setState")},T.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function P(){}P.prototype=T.prototype;function M(W,K,Ee){this.props=W,this.context=K,this.refs=S,this.updater=Ee||x}var k=M.prototype=new P;k.constructor=M,I(k,T.prototype),k.isPureReactComponent=!0;var O=Array.isArray,F=Object.prototype.hasOwnProperty,G={current:null},b={key:!0,ref:!0,__self:!0,__source:!0};function R(W,K,Ee){var Te,Ie={},be=null,Me=null;if(K!=null)for(Te in K.ref!==void 0&&(Me=K.ref),K.key!==void 0&&(be=""+K.key),K)F.call(K,Te)&&!b.hasOwnProperty(Te)&&(Ie[Te]=K[Te]);var Fe=arguments.length-2;if(Fe===1)Ie.children=Ee;else if(1<Fe){for(var Ge=Array(Fe),lt=0;lt<Fe;lt++)Ge[lt]=arguments[lt+2];Ie.children=Ge}if(W&&W.defaultProps)for(Te in Fe=W.defaultProps,Fe)Ie[Te]===void 0&&(Ie[Te]=Fe[Te]);return{$$typeof:n,type:W,key:be,ref:Me,props:Ie,_owner:G.current}}function D(W,K){return{$$typeof:n,type:W.type,key:K,ref:W.ref,props:W.props,_owner:W._owner}}function V(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function j(W){var K={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(Ee){return K[Ee]})}var z=/\/+/g;function N(W,K){return typeof W=="object"&&W!==null&&W.key!=null?j(""+W.key):K.toString(36)}function se(W,K,Ee,Te,Ie){var be=typeof W;(be==="undefined"||be==="boolean")&&(W=null);var Me=!1;if(W===null)Me=!0;else switch(be){case"string":case"number":Me=!0;break;case"object":switch(W.$$typeof){case n:case e:Me=!0}}if(Me)return Me=W,Ie=Ie(Me),W=Te===""?"."+N(Me,0):Te,O(Ie)?(Ee="",W!=null&&(Ee=W.replace(z,"$&/")+"/"),se(Ie,K,Ee,"",function(lt){return lt})):Ie!=null&&(V(Ie)&&(Ie=D(Ie,Ee+(!Ie.key||Me&&Me.key===Ie.key?"":(""+Ie.key).replace(z,"$&/")+"/")+W)),K.push(Ie)),1;if(Me=0,Te=Te===""?".":Te+":",O(W))for(var Fe=0;Fe<W.length;Fe++){be=W[Fe];var Ge=Te+N(be,Fe);Me+=se(be,K,Ee,Ge,Ie)}else if(Ge=y(W),typeof Ge=="function")for(W=Ge.call(W),Fe=0;!(be=W.next()).done;)be=be.value,Ge=Te+N(be,Fe++),Me+=se(be,K,Ee,Ge,Ie);else if(be==="object")throw K=String(W),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return Me}function ge(W,K,Ee){if(W==null)return W;var Te=[],Ie=0;return se(W,Te,"","",function(be){return K.call(Ee,be,Ie++)}),Te}function ne(W){if(W._status===-1){var K=W._result;K=K(),K.then(function(Ee){(W._status===0||W._status===-1)&&(W._status=1,W._result=Ee)},function(Ee){(W._status===0||W._status===-1)&&(W._status=2,W._result=Ee)}),W._status===-1&&(W._status=0,W._result=K)}if(W._status===1)return W._result.default;throw W._result}var ue={current:null},Z={transition:null},le={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:Z,ReactCurrentOwner:G};function ie(){throw Error("act(...) is not supported in production builds of React.")}return We.Children={map:ge,forEach:function(W,K,Ee){ge(W,function(){K.apply(this,arguments)},Ee)},count:function(W){var K=0;return ge(W,function(){K++}),K},toArray:function(W){return ge(W,function(K){return K})||[]},only:function(W){if(!V(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},We.Component=T,We.Fragment=t,We.Profiler=r,We.PureComponent=M,We.StrictMode=i,We.Suspense=u,We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=le,We.act=ie,We.cloneElement=function(W,K,Ee){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var Te=I({},W.props),Ie=W.key,be=W.ref,Me=W._owner;if(K!=null){if(K.ref!==void 0&&(be=K.ref,Me=G.current),K.key!==void 0&&(Ie=""+K.key),W.type&&W.type.defaultProps)var Fe=W.type.defaultProps;for(Ge in K)F.call(K,Ge)&&!b.hasOwnProperty(Ge)&&(Te[Ge]=K[Ge]===void 0&&Fe!==void 0?Fe[Ge]:K[Ge])}var Ge=arguments.length-2;if(Ge===1)Te.children=Ee;else if(1<Ge){Fe=Array(Ge);for(var lt=0;lt<Ge;lt++)Fe[lt]=arguments[lt+2];Te.children=Fe}return{$$typeof:n,type:W.type,key:Ie,ref:be,props:Te,_owner:Me}},We.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:s,_context:W},W.Consumer=W},We.createElement=R,We.createFactory=function(W){var K=R.bind(null,W);return K.type=W,K},We.createRef=function(){return{current:null}},We.forwardRef=function(W){return{$$typeof:l,render:W}},We.isValidElement=V,We.lazy=function(W){return{$$typeof:f,_payload:{_status:-1,_result:W},_init:ne}},We.memo=function(W,K){return{$$typeof:h,type:W,compare:K===void 0?null:K}},We.startTransition=function(W){var K=Z.transition;Z.transition={};try{W()}finally{Z.transition=K}},We.unstable_act=ie,We.useCallback=function(W,K){return ue.current.useCallback(W,K)},We.useContext=function(W){return ue.current.useContext(W)},We.useDebugValue=function(){},We.useDeferredValue=function(W){return ue.current.useDeferredValue(W)},We.useEffect=function(W,K){return ue.current.useEffect(W,K)},We.useId=function(){return ue.current.useId()},We.useImperativeHandle=function(W,K,Ee){return ue.current.useImperativeHandle(W,K,Ee)},We.useInsertionEffect=function(W,K){return ue.current.useInsertionEffect(W,K)},We.useLayoutEffect=function(W,K){return ue.current.useLayoutEffect(W,K)},We.useMemo=function(W,K){return ue.current.useMemo(W,K)},We.useReducer=function(W,K,Ee){return ue.current.useReducer(W,K,Ee)},We.useRef=function(W){return ue.current.useRef(W)},We.useState=function(W){return ue.current.useState(W)},We.useSyncExternalStore=function(W,K,Ee){return ue.current.useSyncExternalStore(W,K,Ee)},We.useTransition=function(){return ue.current.useTransition()},We.version="18.3.1",We}var OT;function Wd(){return OT||(OT=1,j_.exports=PN()),j_.exports}var FT;function bN(){if(FT)return Th;FT=1;var n=Wd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var f,p={},y=null,x=null;h!==void 0&&(y=""+h),u.key!==void 0&&(y=""+u.key),u.ref!==void 0&&(x=u.ref);for(f in u)i.call(u,f)&&!s.hasOwnProperty(f)&&(p[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)p[f]===void 0&&(p[f]=u[f]);return{$$typeof:e,type:l,key:y,ref:x,props:p,_owner:r.current}}return Th.Fragment=t,Th.jsx=o,Th.jsxs=o,Th}var VT;function kN(){return VT||(VT=1,V_.exports=bN()),V_.exports}var E=kN(),Ig={},U_={exports:{}},Qn={},z_={exports:{}},B_={};var jT;function DN(){return jT||(jT=1,(function(n){function e(Z,le){var ie=Z.length;Z.push(le);e:for(;0<ie;){var W=ie-1>>>1,K=Z[W];if(0<r(K,le))Z[W]=le,Z[ie]=K,ie=W;else break e}}function t(Z){return Z.length===0?null:Z[0]}function i(Z){if(Z.length===0)return null;var le=Z[0],ie=Z.pop();if(ie!==le){Z[0]=ie;e:for(var W=0,K=Z.length,Ee=K>>>1;W<Ee;){var Te=2*(W+1)-1,Ie=Z[Te],be=Te+1,Me=Z[be];if(0>r(Ie,ie))be<K&&0>r(Me,Ie)?(Z[W]=Me,Z[be]=ie,W=be):(Z[W]=Ie,Z[Te]=ie,W=Te);else if(be<K&&0>r(Me,ie))Z[W]=Me,Z[be]=ie,W=be;else break e}}return le}function r(Z,le){var ie=Z.sortIndex-le.sortIndex;return ie!==0?ie:Z.id-le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,p=null,y=3,x=!1,I=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(Z){for(var le=t(h);le!==null;){if(le.callback===null)i(h);else if(le.startTime<=Z)i(h),le.sortIndex=le.expirationTime,e(u,le);else break;le=t(h)}}function O(Z){if(S=!1,k(Z),!I)if(t(u)!==null)I=!0,ne(F);else{var le=t(h);le!==null&&ue(O,le.startTime-Z)}}function F(Z,le){I=!1,S&&(S=!1,P(R),R=-1),x=!0;var ie=y;try{for(k(le),p=t(u);p!==null&&(!(p.expirationTime>le)||Z&&!j());){var W=p.callback;if(typeof W=="function"){p.callback=null,y=p.priorityLevel;var K=W(p.expirationTime<=le);le=n.unstable_now(),typeof K=="function"?p.callback=K:p===t(u)&&i(u),k(le)}else i(u);p=t(u)}if(p!==null)var Ee=!0;else{var Te=t(h);Te!==null&&ue(O,Te.startTime-le),Ee=!1}return Ee}finally{p=null,y=ie,x=!1}}var G=!1,b=null,R=-1,D=5,V=-1;function j(){return!(n.unstable_now()-V<D)}function z(){if(b!==null){var Z=n.unstable_now();V=Z;var le=!0;try{le=b(!0,Z)}finally{le?N():(G=!1,b=null)}}else G=!1}var N;if(typeof M=="function")N=function(){M(z)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,ge=se.port2;se.port1.onmessage=z,N=function(){ge.postMessage(null)}}else N=function(){T(z,0)};function ne(Z){b=Z,G||(G=!0,N())}function ue(Z,le){R=T(function(){Z(n.unstable_now())},le)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Z){Z.callback=null},n.unstable_continueExecution=function(){I||x||(I=!0,ne(F))},n.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Z?Math.floor(1e3/Z):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(Z){switch(y){case 1:case 2:case 3:var le=3;break;default:le=y}var ie=y;y=le;try{return Z()}finally{y=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Z,le){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ie=y;y=Z;try{return le()}finally{y=ie}},n.unstable_scheduleCallback=function(Z,le,ie){var W=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?W+ie:W):ie=W,Z){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ie+K,Z={id:f++,callback:le,priorityLevel:Z,startTime:ie,expirationTime:K,sortIndex:-1},ie>W?(Z.sortIndex=ie,e(h,Z),t(u)===null&&Z===t(h)&&(S?(P(R),R=-1):S=!0,ue(O,ie-W))):(Z.sortIndex=K,e(u,Z),I||x||(I=!0,ne(F))),Z},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(Z){var le=y;return function(){var ie=y;y=le;try{return Z.apply(this,arguments)}finally{y=ie}}}})(B_)),B_}var UT;function MN(){return UT||(UT=1,z_.exports=DN()),z_.exports}var zT;function NN(){if(zT)return Qn;zT=1;var n=Wd(),e=MN();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)i.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function y(a){return u.call(p,a)?!0:u.call(f,a)?!1:h.test(a)?p[a]=!0:(f[a]=!0,!1)}function x(a,c,d,m){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return m?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function I(a,c,d,m){if(c===null||typeof c>"u"||x(a,c,d,m))return!0;if(m)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function S(a,c,d,m,_,v,A){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=m,this.attributeNamespace=_,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=v,this.removeEmptyString=A}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){T[a]=new S(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];T[c]=new S(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){T[a]=new S(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){T[a]=new S(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){T[a]=new S(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){T[a]=new S(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){T[a]=new S(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){T[a]=new S(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){T[a]=new S(a,5,!1,a.toLowerCase(),null,!1,!1)});var P=/[\-:]([a-z])/g;function M(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(P,M);T[c]=new S(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(P,M);T[c]=new S(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(P,M);T[c]=new S(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){T[a]=new S(a,1,!1,a.toLowerCase(),null,!1,!1)}),T.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){T[a]=new S(a,1,!1,a.toLowerCase(),null,!0,!0)});function k(a,c,d,m){var _=T.hasOwnProperty(c)?T[c]:null;(_!==null?_.type!==0:m||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(I(c,d,_,m)&&(d=null),m||_===null?y(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):_.mustUseProperty?a[_.propertyName]=d===null?_.type===3?!1:"":d:(c=_.attributeName,m=_.attributeNamespace,d===null?a.removeAttribute(c):(_=_.type,d=_===3||_===4&&d===!0?"":""+d,m?a.setAttributeNS(m,c,d):a.setAttribute(c,d))))}var O=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),G=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),j=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),ge=Symbol.for("react.memo"),ne=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),Z=Symbol.iterator;function le(a){return a===null||typeof a!="object"?null:(a=Z&&a[Z]||a["@@iterator"],typeof a=="function"?a:null)}var ie=Object.assign,W;function K(a){if(W===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);W=c&&c[1]||""}return`
`+W+a}var Ee=!1;function Te(a,c){if(!a||Ee)return"";Ee=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Q){var m=Q}Reflect.construct(a,[],c)}else{try{c.call()}catch(Q){m=Q}a.call(c.prototype)}else{try{throw Error()}catch(Q){m=Q}a()}}catch(Q){if(Q&&m&&typeof Q.stack=="string"){for(var _=Q.stack.split(`
`),v=m.stack.split(`
`),A=_.length-1,U=v.length-1;1<=A&&0<=U&&_[A]!==v[U];)U--;for(;1<=A&&0<=U;A--,U--)if(_[A]!==v[U]){if(A!==1||U!==1)do if(A--,U--,0>U||_[A]!==v[U]){var B=`
`+_[A].replace(" at new "," at ");return a.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",a.displayName)),B}while(1<=A&&0<=U);break}}}finally{Ee=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?K(a):""}function Ie(a){switch(a.tag){case 5:return K(a.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return a=Te(a.type,!1),a;case 11:return a=Te(a.type.render,!1),a;case 1:return a=Te(a.type,!0),a;default:return""}}function be(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case b:return"Fragment";case G:return"Portal";case D:return"Profiler";case R:return"StrictMode";case N:return"Suspense";case se:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case j:return(a.displayName||"Context")+".Consumer";case V:return(a._context.displayName||"Context")+".Provider";case z:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case ge:return c=a.displayName||null,c!==null?c:be(a.type)||"Memo";case ne:c=a._payload,a=a._init;try{return be(a(c))}catch{}}return null}function Me(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return be(c);case 8:return c===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Fe(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ge(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function lt(a){var c=Ge(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),m=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var _=d.get,v=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return _.call(this)},set:function(A){m=""+A,v.call(this,A)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(A){m=""+A},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function Qi(a){a._valueTracker||(a._valueTracker=lt(a))}function ds(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),m="";return a&&(m=Ge(a)?a.checked?"true":"false":a.value),a=m,a!==d?(c.setValue(a),!0):!1}function Wn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function $n(a,c){var d=c.checked;return ie({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function hn(a,c){var d=c.defaultValue==null?"":c.defaultValue,m=c.checked!=null?c.checked:c.defaultChecked;d=Fe(c.value!=null?c.value:d),a._wrapperState={initialChecked:m,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function dn(a,c){c=c.checked,c!=null&&k(a,"checked",c,!1)}function Kn(a,c){dn(a,c);var d=Fe(c.value),m=c.type;if(d!=null)m==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(m==="submit"||m==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?yt(a,c.type,d):c.hasOwnProperty("defaultValue")&&yt(a,c.type,Fe(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Ri(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var m=c.type;if(!(m!=="submit"&&m!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function yt(a,c,d){(c!=="number"||Wn(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ct=Array.isArray;function tn(a,c,d,m){if(a=a.options,c){c={};for(var _=0;_<d.length;_++)c["$"+d[_]]=!0;for(d=0;d<a.length;d++)_=c.hasOwnProperty("$"+a[d].value),a[d].selected!==_&&(a[d].selected=_),_&&m&&(a[d].defaultSelected=!0)}else{for(d=""+Fe(d),c=null,_=0;_<a.length;_++){if(a[_].value===d){a[_].selected=!0,m&&(a[_].defaultSelected=!0);return}c!==null||a[_].disabled||(c=a[_])}c!==null&&(c.selected=!0)}}function Ai(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ie({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function It(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(t(92));if(ct(d)){if(1<d.length)throw Error(t(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:Fe(d)}}function to(a,c){var d=Fe(c.value),m=Fe(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),m!=null&&(a.defaultValue=""+m)}function Pi(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function Cr(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ji(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?Cr(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Rr,ca=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,m,_){MSApp.execUnsafeLocalFunction(function(){return a(c,d,m,_)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(Rr=Rr||document.createElement("div"),Rr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Rr.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function Ar(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var bi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ol=["Webkit","ms","Moz","O"];Object.keys(bi).forEach(function(a){Ol.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),bi[c]=bi[a]})});function Pr(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||bi.hasOwnProperty(a)&&bi[a]?(""+c).trim():c+"px"}function fs(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var m=d.indexOf("--")===0,_=Pr(d,c[d],m);d==="float"&&(d="cssFloat"),m?a.setProperty(d,_):a[d]=_}}var no=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function On(a,c){if(c){if(no[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function gs(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var br=null;function kr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Fn=null,Vn=null,ft=null;function io(a){if(a=lh(a)){if(typeof Fn!="function")throw Error(t(280));var c=a.stateNode;c&&(c=jf(c),Fn(a.stateNode,a.type,c))}}function er(a){Vn?ft?ft.push(a):ft=[a]:Vn=a}function Ot(){if(Vn){var a=Vn,c=ft;if(ft=Vn=null,io(a),c)for(a=0;a<c.length;a++)io(c[a])}}function ki(a,c){return a(c)}function fn(){}var Ft=!1;function gn(a,c,d){if(Ft)return a(c,d);Ft=!0;try{return ki(a,c,d)}finally{Ft=!1,(Vn!==null||ft!==null)&&(fn(),Ot())}}function pn(a,c){var d=a.stateNode;if(d===null)return null;var m=jf(d);if(m===null)return null;d=m[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,c,typeof d));return d}var nn=!1;if(l)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){nn=!0}}),window.addEventListener("test",rt,rt),window.removeEventListener("test",rt,rt)}catch{nn=!1}function Bt(a,c,d,m,_,v,A,U,B){var Q=Array.prototype.slice.call(arguments,3);try{c.apply(d,Q)}catch(oe){this.onError(oe)}}var Xt=!1,Di=null,Fl=!1,Mi=null,yf={onError:function(a){Xt=!0,Di=a}};function _f(a,c,d,m,_,v,A,U,B){Xt=!1,Di=null,Bt.apply(yf,arguments)}function Ou(a,c,d,m,_,v,A,U,B){if(_f.apply(this,arguments),Xt){if(Xt){var Q=Di;Xt=!1,Di=null}else throw Error(t(198));Fl||(Fl=!0,Mi=Q)}}function tr(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function Fu(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function vf(a){if(tr(a)!==a)throw Error(t(188))}function wf(a){var c=a.alternate;if(!c){if(c=tr(a),c===null)throw Error(t(188));return c!==a?null:a}for(var d=a,m=c;;){var _=d.return;if(_===null)break;var v=_.alternate;if(v===null){if(m=_.return,m!==null){d=m;continue}break}if(_.child===v.child){for(v=_.child;v;){if(v===d)return vf(_),a;if(v===m)return vf(_),c;v=v.sibling}throw Error(t(188))}if(d.return!==m.return)d=_,m=v;else{for(var A=!1,U=_.child;U;){if(U===d){A=!0,d=_,m=v;break}if(U===m){A=!0,m=_,d=v;break}U=U.sibling}if(!A){for(U=v.child;U;){if(U===d){A=!0,d=v,m=_;break}if(U===m){A=!0,m=v,d=_;break}U=U.sibling}if(!A)throw Error(t(189))}}if(d.alternate!==m)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:c}function xf(a){return a=wf(a),a!==null?ua(a):null}function ua(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=ua(a);if(c!==null)return c;a=a.sibling}return null}var Vu=e.unstable_scheduleCallback,Vl=e.unstable_cancelCallback,ha=e.unstable_shouldYield,ps=e.unstable_requestPaint,vt=e.unstable_now,py=e.unstable_getCurrentPriorityLevel,jl=e.unstable_ImmediatePriority,ju=e.unstable_UserBlockingPriority,da=e.unstable_NormalPriority,Uu=e.unstable_LowPriority,Ul=e.unstable_IdlePriority,fa=null,ui=null;function Ef(a){if(ui&&typeof ui.onCommitFiberRoot=="function")try{ui.onCommitFiberRoot(fa,a,void 0,(a.current.flags&128)===128)}catch{}}var hi=Math.clz32?Math.clz32:ga,Dr=Math.log,Ni=Math.LN2;function ga(a){return a>>>=0,a===0?32:31-(Dr(a)/Ni|0)|0}var Mr=64,ro=4194304;function st(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ms(a,c){var d=a.pendingLanes;if(d===0)return 0;var m=0,_=a.suspendedLanes,v=a.pingedLanes,A=d&268435455;if(A!==0){var U=A&~_;U!==0?m=st(U):(v&=A,v!==0&&(m=st(v)))}else A=d&~_,A!==0?m=st(A):v!==0&&(m=st(v));if(m===0)return 0;if(c!==0&&c!==m&&(c&_)===0&&(_=m&-m,v=c&-c,_>=v||_===16&&(v&4194240)!==0))return c;if((m&4)!==0&&(m|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=m;0<c;)d=31-hi(c),_=1<<d,m|=a[d],c&=~_;return m}function pa(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ma(a,c){for(var d=a.suspendedLanes,m=a.pingedLanes,_=a.expirationTimes,v=a.pendingLanes;0<v;){var A=31-hi(v),U=1<<A,B=_[A];B===-1?((U&d)===0||(U&m)!==0)&&(_[A]=pa(U,c)):B<=c&&(a.expiredLanes|=U),v&=~U}}function zu(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Bu(){var a=Mr;return Mr<<=1,(Mr&4194240)===0&&(Mr=64),a}function Gu(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function ya(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-hi(c),a[c]=d}function my(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var m=a.eventTimes;for(a=a.expirationTimes;0<d;){var _=31-hi(d),v=1<<_;c[_]=0,m[_]=-1,a[_]=-1,d&=~v}}function Wu(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var m=31-hi(d),_=1<<m;_&c|a[m]&c&&(a[m]|=c),d&=~_}}var He=0;function Nr(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var $u,zl,Ku,Hu,Xu,Lr=!1,Bl=[],Or=null,Fr=null,mn=null,_a=new Map,ys=new Map,di=[],Tf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function so(a,c){switch(a){case"focusin":case"focusout":Or=null;break;case"dragenter":case"dragleave":Fr=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":_a.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":ys.delete(c.pointerId)}}function nr(a,c,d,m,_,v){return a===null||a.nativeEvent!==v?(a={blockedOn:c,domEventName:d,eventSystemFlags:m,nativeEvent:v,targetContainers:[_]},c!==null&&(c=lh(c),c!==null&&zl(c)),a):(a.eventSystemFlags|=m,c=a.targetContainers,_!==null&&c.indexOf(_)===-1&&c.push(_),a)}function If(a,c,d,m,_){switch(c){case"focusin":return Or=nr(Or,a,c,d,m,_),!0;case"dragenter":return Fr=nr(Fr,a,c,d,m,_),!0;case"mouseover":return mn=nr(mn,a,c,d,m,_),!0;case"pointerover":var v=_.pointerId;return _a.set(v,nr(_a.get(v)||null,a,c,d,m,_)),!0;case"gotpointercapture":return v=_.pointerId,ys.set(v,nr(ys.get(v)||null,a,c,d,m,_)),!0}return!1}function Gl(a){var c=Ea(a.target);if(c!==null){var d=tr(c);if(d!==null){if(c=d.tag,c===13){if(c=Fu(d),c!==null){a.blockedOn=c,Xu(a.priority,function(){Ku(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=Wl(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var m=new d.constructor(d.type,d);br=m,d.target.dispatchEvent(m),br=null}else return c=lh(d),c!==null&&zl(c),a.blockedOn=d,!1;c.shift()}return!0}function Sf(a,c,d){pt(a)&&d.delete(c)}function yy(){Lr=!1,Or!==null&&pt(Or)&&(Or=null),Fr!==null&&pt(Fr)&&(Fr=null),mn!==null&&pt(mn)&&(mn=null),_a.forEach(Sf),ys.forEach(Sf)}function oo(a,c){a.blockedOn===c&&(a.blockedOn=null,Lr||(Lr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,yy)))}function ao(a){function c(_){return oo(_,a)}if(0<Bl.length){oo(Bl[0],a);for(var d=1;d<Bl.length;d++){var m=Bl[d];m.blockedOn===a&&(m.blockedOn=null)}}for(Or!==null&&oo(Or,a),Fr!==null&&oo(Fr,a),mn!==null&&oo(mn,a),_a.forEach(c),ys.forEach(c),d=0;d<di.length;d++)m=di[d],m.blockedOn===a&&(m.blockedOn=null);for(;0<di.length&&(d=di[0],d.blockedOn===null);)Gl(d),d.blockedOn===null&&di.shift()}var _s=O.ReactCurrentBatchConfig,vs=!0;function Vr(a,c,d,m){var _=He,v=_s.transition;_s.transition=null;try{He=1,qu(a,c,d,m)}finally{He=_,_s.transition=v}}function Cf(a,c,d,m){var _=He,v=_s.transition;_s.transition=null;try{He=4,qu(a,c,d,m)}finally{He=_,_s.transition=v}}function qu(a,c,d,m){if(vs){var _=Wl(a,c,d,m);if(_===null)Ay(a,c,m,jr,d),so(a,m);else if(If(_,a,c,d,m))m.stopPropagation();else if(so(a,m),c&4&&-1<Tf.indexOf(a)){for(;_!==null;){var v=lh(_);if(v!==null&&$u(v),v=Wl(a,c,d,m),v===null&&Ay(a,c,m,jr,d),v===_)break;_=v}_!==null&&m.stopPropagation()}else Ay(a,c,m,null,d)}}var jr=null;function Wl(a,c,d,m){if(jr=null,a=kr(m),a=Ea(a),a!==null)if(c=tr(a),c===null)a=null;else if(d=c.tag,d===13){if(a=Fu(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return jr=a,null}function $l(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(py()){case jl:return 1;case ju:return 4;case da:case Uu:return 16;case Ul:return 536870912;default:return 16}default:return 16}}var fi=null,Kl=null,ws=null;function Rf(){if(ws)return ws;var a,c=Kl,d=c.length,m,_="value"in fi?fi.value:fi.textContent,v=_.length;for(a=0;a<d&&c[a]===_[a];a++);var A=d-a;for(m=1;m<=A&&c[d-m]===_[v-m];m++);return ws=_.slice(a,1<m?1-m:void 0)}function va(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Ur(){return!0}function Yu(){return!1}function Cn(a){function c(d,m,_,v,A){this._reactName=d,this._targetInst=_,this.type=m,this.nativeEvent=v,this.target=A,this.currentTarget=null;for(var U in a)a.hasOwnProperty(U)&&(d=a[U],this[U]=d?d(v):v[U]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Ur:Yu,this.isPropagationStopped=Yu,this}return ie(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Ur)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Ur)},persist:function(){},isPersistent:Ur}),c}var zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wa=Cn(zr),lo=ie({},zr,{view:0,detail:0}),Hl=Cn(lo),Xl,ql,gi,xa=ie({},lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ve,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==gi&&(gi&&a.type==="mousemove"?(Xl=a.screenX-gi.screenX,ql=a.screenY-gi.screenY):ql=Xl=0,gi=a),Xl)},movementY:function(a){return"movementY"in a?a.movementY:ql}}),Zu=Cn(xa),Af=ie({},xa,{dataTransfer:0}),Pf=Cn(Af),Yl=ie({},lo,{relatedTarget:0}),yn=Cn(Yl),bf=ie({},zr,{animationName:0,elapsedTime:0,pseudoElement:0}),kf=Cn(bf),co=ie({},zr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=Cn(co),w=ie({},zr,{data:0}),C=Cn(w),L={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function de(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=ee[a])?!!c[a]:!1}function Ve(){return de}var Vt=ie({},lo,{key:function(a){if(a.key){var c=L[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=va(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?X[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ve,charCode:function(a){return a.type==="keypress"?va(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?va(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ut=Cn(Vt),Gt=ie({},xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pi=Cn(Gt),xs=ie({},lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ve}),Br=Cn(xs),Gr=ie({},zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zl=Cn(Gr),Qu=ie({},xa,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),TM=Cn(Qu),IM=[9,13,27,32],_y=l&&"CompositionEvent"in window,Ju=null;l&&"documentMode"in document&&(Ju=document.documentMode);var SM=l&&"TextEvent"in window&&!Ju,RE=l&&(!_y||Ju&&8<Ju&&11>=Ju),AE=" ",PE=!1;function bE(a,c){switch(a){case"keyup":return IM.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kE(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ql=!1;function CM(a,c){switch(a){case"compositionend":return kE(c);case"keypress":return c.which!==32?null:(PE=!0,AE);case"textInput":return a=c.data,a===AE&&PE?null:a;default:return null}}function RM(a,c){if(Ql)return a==="compositionend"||!_y&&bE(a,c)?(a=Rf(),ws=Kl=fi=null,Ql=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return RE&&c.locale!=="ko"?null:c.data;default:return null}}var AM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function DE(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!AM[a.type]:c==="textarea"}function ME(a,c,d,m){er(m),c=Of(c,"onChange"),0<c.length&&(d=new wa("onChange","change",null,d,m),a.push({event:d,listeners:c}))}var eh=null,th=null;function PM(a){ZE(a,0)}function Df(a){var c=ic(a);if(ds(c))return a}function bM(a,c){if(a==="change")return c}var NE=!1;if(l){var vy;if(l){var wy="oninput"in document;if(!wy){var LE=document.createElement("div");LE.setAttribute("oninput","return;"),wy=typeof LE.oninput=="function"}vy=wy}else vy=!1;NE=vy&&(!document.documentMode||9<document.documentMode)}function OE(){eh&&(eh.detachEvent("onpropertychange",FE),th=eh=null)}function FE(a){if(a.propertyName==="value"&&Df(th)){var c=[];ME(c,th,a,kr(a)),gn(PM,c)}}function kM(a,c,d){a==="focusin"?(OE(),eh=c,th=d,eh.attachEvent("onpropertychange",FE)):a==="focusout"&&OE()}function DM(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Df(th)}function MM(a,c){if(a==="click")return Df(c)}function NM(a,c){if(a==="input"||a==="change")return Df(c)}function LM(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var ir=typeof Object.is=="function"?Object.is:LM;function nh(a,c){if(ir(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),m=Object.keys(c);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var _=d[m];if(!u.call(c,_)||!ir(a[_],c[_]))return!1}return!0}function VE(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function jE(a,c){var d=VE(a);a=0;for(var m;d;){if(d.nodeType===3){if(m=a+d.textContent.length,a<=c&&m>=c)return{node:d,offset:c-a};a=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=VE(d)}}function UE(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?UE(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function zE(){for(var a=window,c=Wn();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=Wn(a.document)}return c}function xy(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function OM(a){var c=zE(),d=a.focusedElem,m=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&UE(d.ownerDocument.documentElement,d)){if(m!==null&&xy(d)){if(c=m.start,a=m.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var _=d.textContent.length,v=Math.min(m.start,_);m=m.end===void 0?v:Math.min(m.end,_),!a.extend&&v>m&&(_=m,m=v,v=_),_=jE(d,v);var A=jE(d,m);_&&A&&(a.rangeCount!==1||a.anchorNode!==_.node||a.anchorOffset!==_.offset||a.focusNode!==A.node||a.focusOffset!==A.offset)&&(c=c.createRange(),c.setStart(_.node,_.offset),a.removeAllRanges(),v>m?(a.addRange(c),a.extend(A.node,A.offset)):(c.setEnd(A.node,A.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var FM=l&&"documentMode"in document&&11>=document.documentMode,Jl=null,Ey=null,ih=null,Ty=!1;function BE(a,c,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Ty||Jl==null||Jl!==Wn(m)||(m=Jl,"selectionStart"in m&&xy(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),ih&&nh(ih,m)||(ih=m,m=Of(Ey,"onSelect"),0<m.length&&(c=new wa("onSelect","select",null,c,d),a.push({event:c,listeners:m}),c.target=Jl)))}function Mf(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var ec={animationend:Mf("Animation","AnimationEnd"),animationiteration:Mf("Animation","AnimationIteration"),animationstart:Mf("Animation","AnimationStart"),transitionend:Mf("Transition","TransitionEnd")},Iy={},GE={};l&&(GE=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function Nf(a){if(Iy[a])return Iy[a];if(!ec[a])return a;var c=ec[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in GE)return Iy[a]=c[d];return a}var WE=Nf("animationend"),$E=Nf("animationiteration"),KE=Nf("animationstart"),HE=Nf("transitionend"),XE=new Map,qE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function uo(a,c){XE.set(a,c),s(c,[a])}for(var Sy=0;Sy<qE.length;Sy++){var Cy=qE[Sy],VM=Cy.toLowerCase(),jM=Cy[0].toUpperCase()+Cy.slice(1);uo(VM,"on"+jM)}uo(WE,"onAnimationEnd"),uo($E,"onAnimationIteration"),uo(KE,"onAnimationStart"),uo("dblclick","onDoubleClick"),uo("focusin","onFocus"),uo("focusout","onBlur"),uo(HE,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UM=new Set("cancel close invalid load scroll toggle".split(" ").concat(rh));function YE(a,c,d){var m=a.type||"unknown-event";a.currentTarget=d,Ou(m,c,void 0,a),a.currentTarget=null}function ZE(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var m=a[d],_=m.event;m=m.listeners;e:{var v=void 0;if(c)for(var A=m.length-1;0<=A;A--){var U=m[A],B=U.instance,Q=U.currentTarget;if(U=U.listener,B!==v&&_.isPropagationStopped())break e;YE(_,U,Q),v=B}else for(A=0;A<m.length;A++){if(U=m[A],B=U.instance,Q=U.currentTarget,U=U.listener,B!==v&&_.isPropagationStopped())break e;YE(_,U,Q),v=B}}}if(Fl)throw a=Mi,Fl=!1,Mi=null,a}function wt(a,c){var d=c[Ny];d===void 0&&(d=c[Ny]=new Set);var m=a+"__bubble";d.has(m)||(QE(c,a,2,!1),d.add(m))}function Ry(a,c,d){var m=0;c&&(m|=4),QE(d,a,m,c)}var Lf="_reactListening"+Math.random().toString(36).slice(2);function sh(a){if(!a[Lf]){a[Lf]=!0,i.forEach(function(d){d!=="selectionchange"&&(UM.has(d)||Ry(d,!1,a),Ry(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Lf]||(c[Lf]=!0,Ry("selectionchange",!1,c))}}function QE(a,c,d,m){switch($l(c)){case 1:var _=Vr;break;case 4:_=Cf;break;default:_=qu}d=_.bind(null,c,d,a),_=void 0,!nn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(_=!0),m?_!==void 0?a.addEventListener(c,d,{capture:!0,passive:_}):a.addEventListener(c,d,!0):_!==void 0?a.addEventListener(c,d,{passive:_}):a.addEventListener(c,d,!1)}function Ay(a,c,d,m,_){var v=m;if((c&1)===0&&(c&2)===0&&m!==null)e:for(;;){if(m===null)return;var A=m.tag;if(A===3||A===4){var U=m.stateNode.containerInfo;if(U===_||U.nodeType===8&&U.parentNode===_)break;if(A===4)for(A=m.return;A!==null;){var B=A.tag;if((B===3||B===4)&&(B=A.stateNode.containerInfo,B===_||B.nodeType===8&&B.parentNode===_))return;A=A.return}for(;U!==null;){if(A=Ea(U),A===null)return;if(B=A.tag,B===5||B===6){m=v=A;continue e}U=U.parentNode}}m=m.return}gn(function(){var Q=v,oe=kr(d),ce=[];e:{var re=XE.get(a);if(re!==void 0){var pe=wa,ye=a;switch(a){case"keypress":if(va(d)===0)break e;case"keydown":case"keyup":pe=ut;break;case"focusin":ye="focus",pe=yn;break;case"focusout":ye="blur",pe=yn;break;case"beforeblur":case"afterblur":pe=yn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=Zu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=Pf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=Br;break;case WE:case $E:case KE:pe=kf;break;case HE:pe=Zl;break;case"scroll":pe=Hl;break;case"wheel":pe=TM;break;case"copy":case"cut":case"paste":pe=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=pi}var _e=(c&4)!==0,jt=!_e&&a==="scroll",H=_e?re!==null?re+"Capture":null:re;_e=[];for(var $=Q,q;$!==null;){q=$;var he=q.stateNode;if(q.tag===5&&he!==null&&(q=he,H!==null&&(he=pn($,H),he!=null&&_e.push(oh($,he,q)))),jt)break;$=$.return}0<_e.length&&(re=new pe(re,ye,null,d,oe),ce.push({event:re,listeners:_e}))}}if((c&7)===0){e:{if(re=a==="mouseover"||a==="pointerover",pe=a==="mouseout"||a==="pointerout",re&&d!==br&&(ye=d.relatedTarget||d.fromElement)&&(Ea(ye)||ye[Es]))break e;if((pe||re)&&(re=oe.window===oe?oe:(re=oe.ownerDocument)?re.defaultView||re.parentWindow:window,pe?(ye=d.relatedTarget||d.toElement,pe=Q,ye=ye?Ea(ye):null,ye!==null&&(jt=tr(ye),ye!==jt||ye.tag!==5&&ye.tag!==6)&&(ye=null)):(pe=null,ye=Q),pe!==ye)){if(_e=Zu,he="onMouseLeave",H="onMouseEnter",$="mouse",(a==="pointerout"||a==="pointerover")&&(_e=pi,he="onPointerLeave",H="onPointerEnter",$="pointer"),jt=pe==null?re:ic(pe),q=ye==null?re:ic(ye),re=new _e(he,$+"leave",pe,d,oe),re.target=jt,re.relatedTarget=q,he=null,Ea(oe)===Q&&(_e=new _e(H,$+"enter",ye,d,oe),_e.target=q,_e.relatedTarget=jt,he=_e),jt=he,pe&&ye)t:{for(_e=pe,H=ye,$=0,q=_e;q;q=tc(q))$++;for(q=0,he=H;he;he=tc(he))q++;for(;0<$-q;)_e=tc(_e),$--;for(;0<q-$;)H=tc(H),q--;for(;$--;){if(_e===H||H!==null&&_e===H.alternate)break t;_e=tc(_e),H=tc(H)}_e=null}else _e=null;pe!==null&&JE(ce,re,pe,_e,!1),ye!==null&&jt!==null&&JE(ce,jt,ye,_e,!0)}}e:{if(re=Q?ic(Q):window,pe=re.nodeName&&re.nodeName.toLowerCase(),pe==="select"||pe==="input"&&re.type==="file")var we=bM;else if(DE(re))if(NE)we=NM;else{we=DM;var Ae=kM}else(pe=re.nodeName)&&pe.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(we=MM);if(we&&(we=we(a,Q))){ME(ce,we,d,oe);break e}Ae&&Ae(a,re,Q),a==="focusout"&&(Ae=re._wrapperState)&&Ae.controlled&&re.type==="number"&&yt(re,"number",re.value)}switch(Ae=Q?ic(Q):window,a){case"focusin":(DE(Ae)||Ae.contentEditable==="true")&&(Jl=Ae,Ey=Q,ih=null);break;case"focusout":ih=Ey=Jl=null;break;case"mousedown":Ty=!0;break;case"contextmenu":case"mouseup":case"dragend":Ty=!1,BE(ce,d,oe);break;case"selectionchange":if(FM)break;case"keydown":case"keyup":BE(ce,d,oe)}var Pe;if(_y)e:{switch(a){case"compositionstart":var Ne="onCompositionStart";break e;case"compositionend":Ne="onCompositionEnd";break e;case"compositionupdate":Ne="onCompositionUpdate";break e}Ne=void 0}else Ql?bE(a,d)&&(Ne="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Ne="onCompositionStart");Ne&&(RE&&d.locale!=="ko"&&(Ql||Ne!=="onCompositionStart"?Ne==="onCompositionEnd"&&Ql&&(Pe=Rf()):(fi=oe,Kl="value"in fi?fi.value:fi.textContent,Ql=!0)),Ae=Of(Q,Ne),0<Ae.length&&(Ne=new C(Ne,a,null,d,oe),ce.push({event:Ne,listeners:Ae}),Pe?Ne.data=Pe:(Pe=kE(d),Pe!==null&&(Ne.data=Pe)))),(Pe=SM?CM(a,d):RM(a,d))&&(Q=Of(Q,"onBeforeInput"),0<Q.length&&(oe=new C("onBeforeInput","beforeinput",null,d,oe),ce.push({event:oe,listeners:Q}),oe.data=Pe))}ZE(ce,c)})}function oh(a,c,d){return{instance:a,listener:c,currentTarget:d}}function Of(a,c){for(var d=c+"Capture",m=[];a!==null;){var _=a,v=_.stateNode;_.tag===5&&v!==null&&(_=v,v=pn(a,d),v!=null&&m.unshift(oh(a,v,_)),v=pn(a,c),v!=null&&m.push(oh(a,v,_))),a=a.return}return m}function tc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function JE(a,c,d,m,_){for(var v=c._reactName,A=[];d!==null&&d!==m;){var U=d,B=U.alternate,Q=U.stateNode;if(B!==null&&B===m)break;U.tag===5&&Q!==null&&(U=Q,_?(B=pn(d,v),B!=null&&A.unshift(oh(d,B,U))):_||(B=pn(d,v),B!=null&&A.push(oh(d,B,U)))),d=d.return}A.length!==0&&a.push({event:c,listeners:A})}var zM=/\r\n?/g,BM=/\u0000|\uFFFD/g;function e1(a){return(typeof a=="string"?a:""+a).replace(zM,`
`).replace(BM,"")}function Ff(a,c,d){if(c=e1(c),e1(a)!==c&&d)throw Error(t(425))}function Vf(){}var Py=null,by=null;function ky(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Dy=typeof setTimeout=="function"?setTimeout:void 0,GM=typeof clearTimeout=="function"?clearTimeout:void 0,t1=typeof Promise=="function"?Promise:void 0,WM=typeof queueMicrotask=="function"?queueMicrotask:typeof t1<"u"?function(a){return t1.resolve(null).then(a).catch($M)}:Dy;function $M(a){setTimeout(function(){throw a})}function My(a,c){var d=c,m=0;do{var _=d.nextSibling;if(a.removeChild(d),_&&_.nodeType===8)if(d=_.data,d==="/$"){if(m===0){a.removeChild(_),ao(c);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=_}while(d);ao(c)}function ho(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function n1(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var nc=Math.random().toString(36).slice(2),Wr="__reactFiber$"+nc,ah="__reactProps$"+nc,Es="__reactContainer$"+nc,Ny="__reactEvents$"+nc,KM="__reactListeners$"+nc,HM="__reactHandles$"+nc;function Ea(a){var c=a[Wr];if(c)return c;for(var d=a.parentNode;d;){if(c=d[Es]||d[Wr]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=n1(a);a!==null;){if(d=a[Wr])return d;a=n1(a)}return c}a=d,d=a.parentNode}return null}function lh(a){return a=a[Wr]||a[Es],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ic(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function jf(a){return a[ah]||null}var Ly=[],rc=-1;function fo(a){return{current:a}}function xt(a){0>rc||(a.current=Ly[rc],Ly[rc]=null,rc--)}function _t(a,c){rc++,Ly[rc]=a.current,a.current=c}var go={},Rn=fo(go),Hn=fo(!1),Ta=go;function sc(a,c){var d=a.type.contextTypes;if(!d)return go;var m=a.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===c)return m.__reactInternalMemoizedMaskedChildContext;var _={},v;for(v in d)_[v]=c[v];return m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=_),_}function Xn(a){return a=a.childContextTypes,a!=null}function Uf(){xt(Hn),xt(Rn)}function i1(a,c,d){if(Rn.current!==go)throw Error(t(168));_t(Rn,c),_t(Hn,d)}function r1(a,c,d){var m=a.stateNode;if(c=c.childContextTypes,typeof m.getChildContext!="function")return d;m=m.getChildContext();for(var _ in m)if(!(_ in c))throw Error(t(108,Me(a)||"Unknown",_));return ie({},d,m)}function zf(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||go,Ta=Rn.current,_t(Rn,a),_t(Hn,Hn.current),!0}function s1(a,c,d){var m=a.stateNode;if(!m)throw Error(t(169));d?(a=r1(a,c,Ta),m.__reactInternalMemoizedMergedChildContext=a,xt(Hn),xt(Rn),_t(Rn,a)):xt(Hn),_t(Hn,d)}var Ts=null,Bf=!1,Oy=!1;function o1(a){Ts===null?Ts=[a]:Ts.push(a)}function XM(a){Bf=!0,o1(a)}function po(){if(!Oy&&Ts!==null){Oy=!0;var a=0,c=He;try{var d=Ts;for(He=1;a<d.length;a++){var m=d[a];do m=m(!0);while(m!==null)}Ts=null,Bf=!1}catch(_){throw Ts!==null&&(Ts=Ts.slice(a+1)),Vu(jl,po),_}finally{He=c,Oy=!1}}return null}var oc=[],ac=0,Gf=null,Wf=0,Li=[],Oi=0,Ia=null,Is=1,Ss="";function Sa(a,c){oc[ac++]=Wf,oc[ac++]=Gf,Gf=a,Wf=c}function a1(a,c,d){Li[Oi++]=Is,Li[Oi++]=Ss,Li[Oi++]=Ia,Ia=a;var m=Is;a=Ss;var _=32-hi(m)-1;m&=~(1<<_),d+=1;var v=32-hi(c)+_;if(30<v){var A=_-_%5;v=(m&(1<<A)-1).toString(32),m>>=A,_-=A,Is=1<<32-hi(c)+_|d<<_|m,Ss=v+a}else Is=1<<v|d<<_|m,Ss=a}function Fy(a){a.return!==null&&(Sa(a,1),a1(a,1,0))}function Vy(a){for(;a===Gf;)Gf=oc[--ac],oc[ac]=null,Wf=oc[--ac],oc[ac]=null;for(;a===Ia;)Ia=Li[--Oi],Li[Oi]=null,Ss=Li[--Oi],Li[Oi]=null,Is=Li[--Oi],Li[Oi]=null}var mi=null,yi=null,St=!1,rr=null;function l1(a,c){var d=Ui(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function c1(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,mi=a,yi=ho(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,mi=a,yi=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Ia!==null?{id:Is,overflow:Ss}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=Ui(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,mi=a,yi=null,!0):!1;default:return!1}}function jy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Uy(a){if(St){var c=yi;if(c){var d=c;if(!c1(a,c)){if(jy(a))throw Error(t(418));c=ho(d.nextSibling);var m=mi;c&&c1(a,c)?l1(m,d):(a.flags=a.flags&-4097|2,St=!1,mi=a)}}else{if(jy(a))throw Error(t(418));a.flags=a.flags&-4097|2,St=!1,mi=a}}}function u1(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;mi=a}function $f(a){if(a!==mi)return!1;if(!St)return u1(a),St=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!ky(a.type,a.memoizedProps)),c&&(c=yi)){if(jy(a))throw h1(),Error(t(418));for(;c;)l1(a,c),c=ho(c.nextSibling)}if(u1(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){yi=ho(a.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}yi=null}}else yi=mi?ho(a.stateNode.nextSibling):null;return!0}function h1(){for(var a=yi;a;)a=ho(a.nextSibling)}function lc(){yi=mi=null,St=!1}function zy(a){rr===null?rr=[a]:rr.push(a)}var qM=O.ReactCurrentBatchConfig;function ch(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var m=d.stateNode}if(!m)throw Error(t(147,a));var _=m,v=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===v?c.ref:(c=function(A){var U=_.refs;A===null?delete U[v]:U[v]=A},c._stringRef=v,c)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function Kf(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function d1(a){var c=a._init;return c(a._payload)}function f1(a){function c(H,$){if(a){var q=H.deletions;q===null?(H.deletions=[$],H.flags|=16):q.push($)}}function d(H,$){if(!a)return null;for(;$!==null;)c(H,$),$=$.sibling;return null}function m(H,$){for(H=new Map;$!==null;)$.key!==null?H.set($.key,$):H.set($.index,$),$=$.sibling;return H}function _(H,$){return H=To(H,$),H.index=0,H.sibling=null,H}function v(H,$,q){return H.index=q,a?(q=H.alternate,q!==null?(q=q.index,q<$?(H.flags|=2,$):q):(H.flags|=2,$)):(H.flags|=1048576,$)}function A(H){return a&&H.alternate===null&&(H.flags|=2),H}function U(H,$,q,he){return $===null||$.tag!==6?($=D_(q,H.mode,he),$.return=H,$):($=_($,q),$.return=H,$)}function B(H,$,q,he){var we=q.type;return we===b?oe(H,$,q.props.children,he,q.key):$!==null&&($.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===ne&&d1(we)===$.type)?(he=_($,q.props),he.ref=ch(H,$,q),he.return=H,he):(he=mg(q.type,q.key,q.props,null,H.mode,he),he.ref=ch(H,$,q),he.return=H,he)}function Q(H,$,q,he){return $===null||$.tag!==4||$.stateNode.containerInfo!==q.containerInfo||$.stateNode.implementation!==q.implementation?($=M_(q,H.mode,he),$.return=H,$):($=_($,q.children||[]),$.return=H,$)}function oe(H,$,q,he,we){return $===null||$.tag!==7?($=Ma(q,H.mode,he,we),$.return=H,$):($=_($,q),$.return=H,$)}function ce(H,$,q){if(typeof $=="string"&&$!==""||typeof $=="number")return $=D_(""+$,H.mode,q),$.return=H,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case F:return q=mg($.type,$.key,$.props,null,H.mode,q),q.ref=ch(H,null,$),q.return=H,q;case G:return $=M_($,H.mode,q),$.return=H,$;case ne:var he=$._init;return ce(H,he($._payload),q)}if(ct($)||le($))return $=Ma($,H.mode,q,null),$.return=H,$;Kf(H,$)}return null}function re(H,$,q,he){var we=$!==null?$.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return we!==null?null:U(H,$,""+q,he);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case F:return q.key===we?B(H,$,q,he):null;case G:return q.key===we?Q(H,$,q,he):null;case ne:return we=q._init,re(H,$,we(q._payload),he)}if(ct(q)||le(q))return we!==null?null:oe(H,$,q,he,null);Kf(H,q)}return null}function pe(H,$,q,he,we){if(typeof he=="string"&&he!==""||typeof he=="number")return H=H.get(q)||null,U($,H,""+he,we);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case F:return H=H.get(he.key===null?q:he.key)||null,B($,H,he,we);case G:return H=H.get(he.key===null?q:he.key)||null,Q($,H,he,we);case ne:var Ae=he._init;return pe(H,$,q,Ae(he._payload),we)}if(ct(he)||le(he))return H=H.get(q)||null,oe($,H,he,we,null);Kf($,he)}return null}function ye(H,$,q,he){for(var we=null,Ae=null,Pe=$,Ne=$=0,on=null;Pe!==null&&Ne<q.length;Ne++){Pe.index>Ne?(on=Pe,Pe=null):on=Pe.sibling;var et=re(H,Pe,q[Ne],he);if(et===null){Pe===null&&(Pe=on);break}a&&Pe&&et.alternate===null&&c(H,Pe),$=v(et,$,Ne),Ae===null?we=et:Ae.sibling=et,Ae=et,Pe=on}if(Ne===q.length)return d(H,Pe),St&&Sa(H,Ne),we;if(Pe===null){for(;Ne<q.length;Ne++)Pe=ce(H,q[Ne],he),Pe!==null&&($=v(Pe,$,Ne),Ae===null?we=Pe:Ae.sibling=Pe,Ae=Pe);return St&&Sa(H,Ne),we}for(Pe=m(H,Pe);Ne<q.length;Ne++)on=pe(Pe,H,Ne,q[Ne],he),on!==null&&(a&&on.alternate!==null&&Pe.delete(on.key===null?Ne:on.key),$=v(on,$,Ne),Ae===null?we=on:Ae.sibling=on,Ae=on);return a&&Pe.forEach(function(Io){return c(H,Io)}),St&&Sa(H,Ne),we}function _e(H,$,q,he){var we=le(q);if(typeof we!="function")throw Error(t(150));if(q=we.call(q),q==null)throw Error(t(151));for(var Ae=we=null,Pe=$,Ne=$=0,on=null,et=q.next();Pe!==null&&!et.done;Ne++,et=q.next()){Pe.index>Ne?(on=Pe,Pe=null):on=Pe.sibling;var Io=re(H,Pe,et.value,he);if(Io===null){Pe===null&&(Pe=on);break}a&&Pe&&Io.alternate===null&&c(H,Pe),$=v(Io,$,Ne),Ae===null?we=Io:Ae.sibling=Io,Ae=Io,Pe=on}if(et.done)return d(H,Pe),St&&Sa(H,Ne),we;if(Pe===null){for(;!et.done;Ne++,et=q.next())et=ce(H,et.value,he),et!==null&&($=v(et,$,Ne),Ae===null?we=et:Ae.sibling=et,Ae=et);return St&&Sa(H,Ne),we}for(Pe=m(H,Pe);!et.done;Ne++,et=q.next())et=pe(Pe,H,Ne,et.value,he),et!==null&&(a&&et.alternate!==null&&Pe.delete(et.key===null?Ne:et.key),$=v(et,$,Ne),Ae===null?we=et:Ae.sibling=et,Ae=et);return a&&Pe.forEach(function(AN){return c(H,AN)}),St&&Sa(H,Ne),we}function jt(H,$,q,he){if(typeof q=="object"&&q!==null&&q.type===b&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case F:e:{for(var we=q.key,Ae=$;Ae!==null;){if(Ae.key===we){if(we=q.type,we===b){if(Ae.tag===7){d(H,Ae.sibling),$=_(Ae,q.props.children),$.return=H,H=$;break e}}else if(Ae.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===ne&&d1(we)===Ae.type){d(H,Ae.sibling),$=_(Ae,q.props),$.ref=ch(H,Ae,q),$.return=H,H=$;break e}d(H,Ae);break}else c(H,Ae);Ae=Ae.sibling}q.type===b?($=Ma(q.props.children,H.mode,he,q.key),$.return=H,H=$):(he=mg(q.type,q.key,q.props,null,H.mode,he),he.ref=ch(H,$,q),he.return=H,H=he)}return A(H);case G:e:{for(Ae=q.key;$!==null;){if($.key===Ae)if($.tag===4&&$.stateNode.containerInfo===q.containerInfo&&$.stateNode.implementation===q.implementation){d(H,$.sibling),$=_($,q.children||[]),$.return=H,H=$;break e}else{d(H,$);break}else c(H,$);$=$.sibling}$=M_(q,H.mode,he),$.return=H,H=$}return A(H);case ne:return Ae=q._init,jt(H,$,Ae(q._payload),he)}if(ct(q))return ye(H,$,q,he);if(le(q))return _e(H,$,q,he);Kf(H,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,$!==null&&$.tag===6?(d(H,$.sibling),$=_($,q),$.return=H,H=$):(d(H,$),$=D_(q,H.mode,he),$.return=H,H=$),A(H)):d(H,$)}return jt}var cc=f1(!0),g1=f1(!1),Hf=fo(null),Xf=null,uc=null,By=null;function Gy(){By=uc=Xf=null}function Wy(a){var c=Hf.current;xt(Hf),a._currentValue=c}function $y(a,c,d){for(;a!==null;){var m=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),a===d)break;a=a.return}}function hc(a,c){Xf=a,By=uc=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(qn=!0),a.firstContext=null)}function Fi(a){var c=a._currentValue;if(By!==a)if(a={context:a,memoizedValue:c,next:null},uc===null){if(Xf===null)throw Error(t(308));uc=a,Xf.dependencies={lanes:0,firstContext:a}}else uc=uc.next=a;return c}var Ca=null;function Ky(a){Ca===null?Ca=[a]:Ca.push(a)}function p1(a,c,d,m){var _=c.interleaved;return _===null?(d.next=d,Ky(c)):(d.next=_.next,_.next=d),c.interleaved=d,Cs(a,m)}function Cs(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var mo=!1;function Hy(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function m1(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Rs(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function yo(a,c,d){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(Qe&2)!==0){var _=m.pending;return _===null?c.next=c:(c.next=_.next,_.next=c),m.pending=c,Cs(a,d)}return _=m.interleaved,_===null?(c.next=c,Ky(m)):(c.next=_.next,_.next=c),m.interleaved=c,Cs(a,d)}function qf(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,Wu(a,d)}}function y1(a,c){var d=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var _=null,v=null;if(d=d.firstBaseUpdate,d!==null){do{var A={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};v===null?_=v=A:v=v.next=A,d=d.next}while(d!==null);v===null?_=v=c:v=v.next=c}else _=v=c;d={baseState:m.baseState,firstBaseUpdate:_,lastBaseUpdate:v,shared:m.shared,effects:m.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function Yf(a,c,d,m){var _=a.updateQueue;mo=!1;var v=_.firstBaseUpdate,A=_.lastBaseUpdate,U=_.shared.pending;if(U!==null){_.shared.pending=null;var B=U,Q=B.next;B.next=null,A===null?v=Q:A.next=Q,A=B;var oe=a.alternate;oe!==null&&(oe=oe.updateQueue,U=oe.lastBaseUpdate,U!==A&&(U===null?oe.firstBaseUpdate=Q:U.next=Q,oe.lastBaseUpdate=B))}if(v!==null){var ce=_.baseState;A=0,oe=Q=B=null,U=v;do{var re=U.lane,pe=U.eventTime;if((m&re)===re){oe!==null&&(oe=oe.next={eventTime:pe,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var ye=a,_e=U;switch(re=c,pe=d,_e.tag){case 1:if(ye=_e.payload,typeof ye=="function"){ce=ye.call(pe,ce,re);break e}ce=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=_e.payload,re=typeof ye=="function"?ye.call(pe,ce,re):ye,re==null)break e;ce=ie({},ce,re);break e;case 2:mo=!0}}U.callback!==null&&U.lane!==0&&(a.flags|=64,re=_.effects,re===null?_.effects=[U]:re.push(U))}else pe={eventTime:pe,lane:re,tag:U.tag,payload:U.payload,callback:U.callback,next:null},oe===null?(Q=oe=pe,B=ce):oe=oe.next=pe,A|=re;if(U=U.next,U===null){if(U=_.shared.pending,U===null)break;re=U,U=re.next,re.next=null,_.lastBaseUpdate=re,_.shared.pending=null}}while(!0);if(oe===null&&(B=ce),_.baseState=B,_.firstBaseUpdate=Q,_.lastBaseUpdate=oe,c=_.shared.interleaved,c!==null){_=c;do A|=_.lane,_=_.next;while(_!==c)}else v===null&&(_.shared.lanes=0);Pa|=A,a.lanes=A,a.memoizedState=ce}}function _1(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var m=a[c],_=m.callback;if(_!==null){if(m.callback=null,m=d,typeof _!="function")throw Error(t(191,_));_.call(m)}}}var uh={},$r=fo(uh),hh=fo(uh),dh=fo(uh);function Ra(a){if(a===uh)throw Error(t(174));return a}function Xy(a,c){switch(_t(dh,c),_t(hh,a),_t($r,uh),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Ji(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=Ji(c,a)}xt($r),_t($r,c)}function dc(){xt($r),xt(hh),xt(dh)}function v1(a){Ra(dh.current);var c=Ra($r.current),d=Ji(c,a.type);c!==d&&(_t(hh,a),_t($r,d))}function qy(a){hh.current===a&&(xt($r),xt(hh))}var At=fo(0);function Zf(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Yy=[];function Zy(){for(var a=0;a<Yy.length;a++)Yy[a]._workInProgressVersionPrimary=null;Yy.length=0}var Qf=O.ReactCurrentDispatcher,Qy=O.ReactCurrentBatchConfig,Aa=0,Pt=null,qt=null,rn=null,Jf=!1,fh=!1,gh=0,YM=0;function An(){throw Error(t(321))}function Jy(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!ir(a[d],c[d]))return!1;return!0}function e_(a,c,d,m,_,v){if(Aa=v,Pt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Qf.current=a===null||a.memoizedState===null?eN:tN,a=d(m,_),fh){v=0;do{if(fh=!1,gh=0,25<=v)throw Error(t(301));v+=1,rn=qt=null,c.updateQueue=null,Qf.current=nN,a=d(m,_)}while(fh)}if(Qf.current=ng,c=qt!==null&&qt.next!==null,Aa=0,rn=qt=Pt=null,Jf=!1,c)throw Error(t(300));return a}function t_(){var a=gh!==0;return gh=0,a}function Kr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?Pt.memoizedState=rn=a:rn=rn.next=a,rn}function Vi(){if(qt===null){var a=Pt.alternate;a=a!==null?a.memoizedState:null}else a=qt.next;var c=rn===null?Pt.memoizedState:rn.next;if(c!==null)rn=c,qt=a;else{if(a===null)throw Error(t(310));qt=a,a={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},rn===null?Pt.memoizedState=rn=a:rn=rn.next=a}return rn}function ph(a,c){return typeof c=="function"?c(a):c}function n_(a){var c=Vi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=qt,_=m.baseQueue,v=d.pending;if(v!==null){if(_!==null){var A=_.next;_.next=v.next,v.next=A}m.baseQueue=_=v,d.pending=null}if(_!==null){v=_.next,m=m.baseState;var U=A=null,B=null,Q=v;do{var oe=Q.lane;if((Aa&oe)===oe)B!==null&&(B=B.next={lane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),m=Q.hasEagerState?Q.eagerState:a(m,Q.action);else{var ce={lane:oe,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null};B===null?(U=B=ce,A=m):B=B.next=ce,Pt.lanes|=oe,Pa|=oe}Q=Q.next}while(Q!==null&&Q!==v);B===null?A=m:B.next=U,ir(m,c.memoizedState)||(qn=!0),c.memoizedState=m,c.baseState=A,c.baseQueue=B,d.lastRenderedState=m}if(a=d.interleaved,a!==null){_=a;do v=_.lane,Pt.lanes|=v,Pa|=v,_=_.next;while(_!==a)}else _===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function i_(a){var c=Vi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=d.dispatch,_=d.pending,v=c.memoizedState;if(_!==null){d.pending=null;var A=_=_.next;do v=a(v,A.action),A=A.next;while(A!==_);ir(v,c.memoizedState)||(qn=!0),c.memoizedState=v,c.baseQueue===null&&(c.baseState=v),d.lastRenderedState=v}return[v,m]}function w1(){}function x1(a,c){var d=Pt,m=Vi(),_=c(),v=!ir(m.memoizedState,_);if(v&&(m.memoizedState=_,qn=!0),m=m.queue,r_(I1.bind(null,d,m,a),[a]),m.getSnapshot!==c||v||rn!==null&&rn.memoizedState.tag&1){if(d.flags|=2048,mh(9,T1.bind(null,d,m,_,c),void 0,null),sn===null)throw Error(t(349));(Aa&30)!==0||E1(d,c,_)}return _}function E1(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function T1(a,c,d,m){c.value=d,c.getSnapshot=m,S1(c)&&C1(a)}function I1(a,c,d){return d(function(){S1(c)&&C1(a)})}function S1(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!ir(a,d)}catch{return!0}}function C1(a){var c=Cs(a,1);c!==null&&lr(c,a,1,-1)}function R1(a){var c=Kr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ph,lastRenderedState:a},c.queue=a,a=a.dispatch=JM.bind(null,Pt,a),[c.memoizedState,a]}function mh(a,c,d,m){return a={tag:a,create:c,destroy:d,deps:m,next:null},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(m=d.next,d.next=a,a.next=m,c.lastEffect=a)),a}function A1(){return Vi().memoizedState}function eg(a,c,d,m){var _=Kr();Pt.flags|=a,_.memoizedState=mh(1|c,d,void 0,m===void 0?null:m)}function tg(a,c,d,m){var _=Vi();m=m===void 0?null:m;var v=void 0;if(qt!==null){var A=qt.memoizedState;if(v=A.destroy,m!==null&&Jy(m,A.deps)){_.memoizedState=mh(c,d,v,m);return}}Pt.flags|=a,_.memoizedState=mh(1|c,d,v,m)}function P1(a,c){return eg(8390656,8,a,c)}function r_(a,c){return tg(2048,8,a,c)}function b1(a,c){return tg(4,2,a,c)}function k1(a,c){return tg(4,4,a,c)}function D1(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function M1(a,c,d){return d=d!=null?d.concat([a]):null,tg(4,4,D1.bind(null,c,a),d)}function s_(){}function N1(a,c){var d=Vi();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&Jy(c,m[1])?m[0]:(d.memoizedState=[a,c],a)}function L1(a,c){var d=Vi();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&Jy(c,m[1])?m[0]:(a=a(),d.memoizedState=[a,c],a)}function O1(a,c,d){return(Aa&21)===0?(a.baseState&&(a.baseState=!1,qn=!0),a.memoizedState=d):(ir(d,c)||(d=Bu(),Pt.lanes|=d,Pa|=d,a.baseState=!0),c)}function ZM(a,c){var d=He;He=d!==0&&4>d?d:4,a(!0);var m=Qy.transition;Qy.transition={};try{a(!1),c()}finally{He=d,Qy.transition=m}}function F1(){return Vi().memoizedState}function QM(a,c,d){var m=xo(a);if(d={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null},V1(a))j1(c,d);else if(d=p1(a,c,d,m),d!==null){var _=Un();lr(d,a,m,_),U1(d,c,m)}}function JM(a,c,d){var m=xo(a),_={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null};if(V1(a))j1(c,_);else{var v=a.alternate;if(a.lanes===0&&(v===null||v.lanes===0)&&(v=c.lastRenderedReducer,v!==null))try{var A=c.lastRenderedState,U=v(A,d);if(_.hasEagerState=!0,_.eagerState=U,ir(U,A)){var B=c.interleaved;B===null?(_.next=_,Ky(c)):(_.next=B.next,B.next=_),c.interleaved=_;return}}catch{}d=p1(a,c,_,m),d!==null&&(_=Un(),lr(d,a,m,_),U1(d,c,m))}}function V1(a){var c=a.alternate;return a===Pt||c!==null&&c===Pt}function j1(a,c){fh=Jf=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function U1(a,c,d){if((d&4194240)!==0){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,Wu(a,d)}}var ng={readContext:Fi,useCallback:An,useContext:An,useEffect:An,useImperativeHandle:An,useInsertionEffect:An,useLayoutEffect:An,useMemo:An,useReducer:An,useRef:An,useState:An,useDebugValue:An,useDeferredValue:An,useTransition:An,useMutableSource:An,useSyncExternalStore:An,useId:An,unstable_isNewReconciler:!1},eN={readContext:Fi,useCallback:function(a,c){return Kr().memoizedState=[a,c===void 0?null:c],a},useContext:Fi,useEffect:P1,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,eg(4194308,4,D1.bind(null,c,a),d)},useLayoutEffect:function(a,c){return eg(4194308,4,a,c)},useInsertionEffect:function(a,c){return eg(4,2,a,c)},useMemo:function(a,c){var d=Kr();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var m=Kr();return c=d!==void 0?d(c):c,m.memoizedState=m.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},m.queue=a,a=a.dispatch=QM.bind(null,Pt,a),[m.memoizedState,a]},useRef:function(a){var c=Kr();return a={current:a},c.memoizedState=a},useState:R1,useDebugValue:s_,useDeferredValue:function(a){return Kr().memoizedState=a},useTransition:function(){var a=R1(!1),c=a[0];return a=ZM.bind(null,a[1]),Kr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var m=Pt,_=Kr();if(St){if(d===void 0)throw Error(t(407));d=d()}else{if(d=c(),sn===null)throw Error(t(349));(Aa&30)!==0||E1(m,c,d)}_.memoizedState=d;var v={value:d,getSnapshot:c};return _.queue=v,P1(I1.bind(null,m,v,a),[a]),m.flags|=2048,mh(9,T1.bind(null,m,v,d,c),void 0,null),d},useId:function(){var a=Kr(),c=sn.identifierPrefix;if(St){var d=Ss,m=Is;d=(m&~(1<<32-hi(m)-1)).toString(32)+d,c=":"+c+"R"+d,d=gh++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=YM++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},tN={readContext:Fi,useCallback:N1,useContext:Fi,useEffect:r_,useImperativeHandle:M1,useInsertionEffect:b1,useLayoutEffect:k1,useMemo:L1,useReducer:n_,useRef:A1,useState:function(){return n_(ph)},useDebugValue:s_,useDeferredValue:function(a){var c=Vi();return O1(c,qt.memoizedState,a)},useTransition:function(){var a=n_(ph)[0],c=Vi().memoizedState;return[a,c]},useMutableSource:w1,useSyncExternalStore:x1,useId:F1,unstable_isNewReconciler:!1},nN={readContext:Fi,useCallback:N1,useContext:Fi,useEffect:r_,useImperativeHandle:M1,useInsertionEffect:b1,useLayoutEffect:k1,useMemo:L1,useReducer:i_,useRef:A1,useState:function(){return i_(ph)},useDebugValue:s_,useDeferredValue:function(a){var c=Vi();return qt===null?c.memoizedState=a:O1(c,qt.memoizedState,a)},useTransition:function(){var a=i_(ph)[0],c=Vi().memoizedState;return[a,c]},useMutableSource:w1,useSyncExternalStore:x1,useId:F1,unstable_isNewReconciler:!1};function sr(a,c){if(a&&a.defaultProps){c=ie({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function o_(a,c,d,m){c=a.memoizedState,d=d(m,c),d=d==null?c:ie({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var ig={isMounted:function(a){return(a=a._reactInternals)?tr(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var m=Un(),_=xo(a),v=Rs(m,_);v.payload=c,d!=null&&(v.callback=d),c=yo(a,v,_),c!==null&&(lr(c,a,_,m),qf(c,a,_))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var m=Un(),_=xo(a),v=Rs(m,_);v.tag=1,v.payload=c,d!=null&&(v.callback=d),c=yo(a,v,_),c!==null&&(lr(c,a,_,m),qf(c,a,_))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=Un(),m=xo(a),_=Rs(d,m);_.tag=2,c!=null&&(_.callback=c),c=yo(a,_,m),c!==null&&(lr(c,a,m,d),qf(c,a,m))}};function z1(a,c,d,m,_,v,A){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,v,A):c.prototype&&c.prototype.isPureReactComponent?!nh(d,m)||!nh(_,v):!0}function B1(a,c,d){var m=!1,_=go,v=c.contextType;return typeof v=="object"&&v!==null?v=Fi(v):(_=Xn(c)?Ta:Rn.current,m=c.contextTypes,v=(m=m!=null)?sc(a,_):go),c=new c(d,v),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=ig,a.stateNode=c,c._reactInternals=a,m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=_,a.__reactInternalMemoizedMaskedChildContext=v),c}function G1(a,c,d,m){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,m),c.state!==a&&ig.enqueueReplaceState(c,c.state,null)}function a_(a,c,d,m){var _=a.stateNode;_.props=d,_.state=a.memoizedState,_.refs={},Hy(a);var v=c.contextType;typeof v=="object"&&v!==null?_.context=Fi(v):(v=Xn(c)?Ta:Rn.current,_.context=sc(a,v)),_.state=a.memoizedState,v=c.getDerivedStateFromProps,typeof v=="function"&&(o_(a,c,v,d),_.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(c=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),c!==_.state&&ig.enqueueReplaceState(_,_.state,null),Yf(a,d,_,m),_.state=a.memoizedState),typeof _.componentDidMount=="function"&&(a.flags|=4194308)}function fc(a,c){try{var d="",m=c;do d+=Ie(m),m=m.return;while(m);var _=d}catch(v){_=`
Error generating stack: `+v.message+`
`+v.stack}return{value:a,source:c,stack:_,digest:null}}function l_(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function c_(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var iN=typeof WeakMap=="function"?WeakMap:Map;function W1(a,c,d){d=Rs(-1,d),d.tag=3,d.payload={element:null};var m=c.value;return d.callback=function(){ug||(ug=!0,I_=m),c_(a,c)},d}function $1(a,c,d){d=Rs(-1,d),d.tag=3;var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var _=c.value;d.payload=function(){return m(_)},d.callback=function(){c_(a,c)}}var v=a.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(d.callback=function(){c_(a,c),typeof m!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var A=c.stack;this.componentDidCatch(c.value,{componentStack:A!==null?A:""})}),d}function K1(a,c,d){var m=a.pingCache;if(m===null){m=a.pingCache=new iN;var _=new Set;m.set(c,_)}else _=m.get(c),_===void 0&&(_=new Set,m.set(c,_));_.has(d)||(_.add(d),a=yN.bind(null,a,c,d),c.then(a,a))}function H1(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function X1(a,c,d,m,_){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=Rs(-1,1),c.tag=2,yo(d,c,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=_,a)}var rN=O.ReactCurrentOwner,qn=!1;function jn(a,c,d,m){c.child=a===null?g1(c,null,d,m):cc(c,a.child,d,m)}function q1(a,c,d,m,_){d=d.render;var v=c.ref;return hc(c,_),m=e_(a,c,d,m,v,_),d=t_(),a!==null&&!qn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~_,As(a,c,_)):(St&&d&&Fy(c),c.flags|=1,jn(a,c,m,_),c.child)}function Y1(a,c,d,m,_){if(a===null){var v=d.type;return typeof v=="function"&&!k_(v)&&v.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=v,Z1(a,c,v,m,_)):(a=mg(d.type,null,m,c,c.mode,_),a.ref=c.ref,a.return=c,c.child=a)}if(v=a.child,(a.lanes&_)===0){var A=v.memoizedProps;if(d=d.compare,d=d!==null?d:nh,d(A,m)&&a.ref===c.ref)return As(a,c,_)}return c.flags|=1,a=To(v,m),a.ref=c.ref,a.return=c,c.child=a}function Z1(a,c,d,m,_){if(a!==null){var v=a.memoizedProps;if(nh(v,m)&&a.ref===c.ref)if(qn=!1,c.pendingProps=m=v,(a.lanes&_)!==0)(a.flags&131072)!==0&&(qn=!0);else return c.lanes=a.lanes,As(a,c,_)}return u_(a,c,d,m,_)}function Q1(a,c,d){var m=c.pendingProps,_=m.children,v=a!==null?a.memoizedState:null;if(m.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(pc,_i),_i|=d;else{if((d&1073741824)===0)return a=v!==null?v.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,_t(pc,_i),_i|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=v!==null?v.baseLanes:d,_t(pc,_i),_i|=m}else v!==null?(m=v.baseLanes|d,c.memoizedState=null):m=d,_t(pc,_i),_i|=m;return jn(a,c,_,d),c.child}function J1(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function u_(a,c,d,m,_){var v=Xn(d)?Ta:Rn.current;return v=sc(c,v),hc(c,_),d=e_(a,c,d,m,v,_),m=t_(),a!==null&&!qn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~_,As(a,c,_)):(St&&m&&Fy(c),c.flags|=1,jn(a,c,d,_),c.child)}function eT(a,c,d,m,_){if(Xn(d)){var v=!0;zf(c)}else v=!1;if(hc(c,_),c.stateNode===null)sg(a,c),B1(c,d,m),a_(c,d,m,_),m=!0;else if(a===null){var A=c.stateNode,U=c.memoizedProps;A.props=U;var B=A.context,Q=d.contextType;typeof Q=="object"&&Q!==null?Q=Fi(Q):(Q=Xn(d)?Ta:Rn.current,Q=sc(c,Q));var oe=d.getDerivedStateFromProps,ce=typeof oe=="function"||typeof A.getSnapshotBeforeUpdate=="function";ce||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==m||B!==Q)&&G1(c,A,m,Q),mo=!1;var re=c.memoizedState;A.state=re,Yf(c,m,A,_),B=c.memoizedState,U!==m||re!==B||Hn.current||mo?(typeof oe=="function"&&(o_(c,d,oe,m),B=c.memoizedState),(U=mo||z1(c,d,U,m,re,B,Q))?(ce||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=B),A.props=m,A.state=B,A.context=Q,m=U):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{A=c.stateNode,m1(a,c),U=c.memoizedProps,Q=c.type===c.elementType?U:sr(c.type,U),A.props=Q,ce=c.pendingProps,re=A.context,B=d.contextType,typeof B=="object"&&B!==null?B=Fi(B):(B=Xn(d)?Ta:Rn.current,B=sc(c,B));var pe=d.getDerivedStateFromProps;(oe=typeof pe=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==ce||re!==B)&&G1(c,A,m,B),mo=!1,re=c.memoizedState,A.state=re,Yf(c,m,A,_);var ye=c.memoizedState;U!==ce||re!==ye||Hn.current||mo?(typeof pe=="function"&&(o_(c,d,pe,m),ye=c.memoizedState),(Q=mo||z1(c,d,Q,m,re,ye,B)||!1)?(oe||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(m,ye,B),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(m,ye,B)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=ye),A.props=m,A.state=ye,A.context=B,m=Q):(typeof A.componentDidUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=1024),m=!1)}return h_(a,c,d,m,v,_)}function h_(a,c,d,m,_,v){J1(a,c);var A=(c.flags&128)!==0;if(!m&&!A)return _&&s1(c,d,!1),As(a,c,v);m=c.stateNode,rN.current=c;var U=A&&typeof d.getDerivedStateFromError!="function"?null:m.render();return c.flags|=1,a!==null&&A?(c.child=cc(c,a.child,null,v),c.child=cc(c,null,U,v)):jn(a,c,U,v),c.memoizedState=m.state,_&&s1(c,d,!0),c.child}function tT(a){var c=a.stateNode;c.pendingContext?i1(a,c.pendingContext,c.pendingContext!==c.context):c.context&&i1(a,c.context,!1),Xy(a,c.containerInfo)}function nT(a,c,d,m,_){return lc(),zy(_),c.flags|=256,jn(a,c,d,m),c.child}var d_={dehydrated:null,treeContext:null,retryLane:0};function f_(a){return{baseLanes:a,cachePool:null,transitions:null}}function iT(a,c,d){var m=c.pendingProps,_=At.current,v=!1,A=(c.flags&128)!==0,U;if((U=A)||(U=a!==null&&a.memoizedState===null?!1:(_&2)!==0),U?(v=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(_|=1),_t(At,_&1),a===null)return Uy(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(A=m.children,a=m.fallback,v?(m=c.mode,v=c.child,A={mode:"hidden",children:A},(m&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=A):v=yg(A,m,0,null),a=Ma(a,m,d,null),v.return=c,a.return=c,v.sibling=a,c.child=v,c.child.memoizedState=f_(d),c.memoizedState=d_,a):g_(c,A));if(_=a.memoizedState,_!==null&&(U=_.dehydrated,U!==null))return sN(a,c,A,m,U,_,d);if(v){v=m.fallback,A=c.mode,_=a.child,U=_.sibling;var B={mode:"hidden",children:m.children};return(A&1)===0&&c.child!==_?(m=c.child,m.childLanes=0,m.pendingProps=B,c.deletions=null):(m=To(_,B),m.subtreeFlags=_.subtreeFlags&14680064),U!==null?v=To(U,v):(v=Ma(v,A,d,null),v.flags|=2),v.return=c,m.return=c,m.sibling=v,c.child=m,m=v,v=c.child,A=a.child.memoizedState,A=A===null?f_(d):{baseLanes:A.baseLanes|d,cachePool:null,transitions:A.transitions},v.memoizedState=A,v.childLanes=a.childLanes&~d,c.memoizedState=d_,m}return v=a.child,a=v.sibling,m=To(v,{mode:"visible",children:m.children}),(c.mode&1)===0&&(m.lanes=d),m.return=c,m.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=m,c.memoizedState=null,m}function g_(a,c){return c=yg({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function rg(a,c,d,m){return m!==null&&zy(m),cc(c,a.child,null,d),a=g_(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function sN(a,c,d,m,_,v,A){if(d)return c.flags&256?(c.flags&=-257,m=l_(Error(t(422))),rg(a,c,A,m)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(v=m.fallback,_=c.mode,m=yg({mode:"visible",children:m.children},_,0,null),v=Ma(v,_,A,null),v.flags|=2,m.return=c,v.return=c,m.sibling=v,c.child=m,(c.mode&1)!==0&&cc(c,a.child,null,A),c.child.memoizedState=f_(A),c.memoizedState=d_,v);if((c.mode&1)===0)return rg(a,c,A,null);if(_.data==="$!"){if(m=_.nextSibling&&_.nextSibling.dataset,m)var U=m.dgst;return m=U,v=Error(t(419)),m=l_(v,m,void 0),rg(a,c,A,m)}if(U=(A&a.childLanes)!==0,qn||U){if(m=sn,m!==null){switch(A&-A){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(m.suspendedLanes|A))!==0?0:_,_!==0&&_!==v.retryLane&&(v.retryLane=_,Cs(a,_),lr(m,a,_,-1))}return b_(),m=l_(Error(t(421))),rg(a,c,A,m)}return _.data==="$?"?(c.flags|=128,c.child=a.child,c=_N.bind(null,a),_._reactRetry=c,null):(a=v.treeContext,yi=ho(_.nextSibling),mi=c,St=!0,rr=null,a!==null&&(Li[Oi++]=Is,Li[Oi++]=Ss,Li[Oi++]=Ia,Is=a.id,Ss=a.overflow,Ia=c),c=g_(c,m.children),c.flags|=4096,c)}function rT(a,c,d){a.lanes|=c;var m=a.alternate;m!==null&&(m.lanes|=c),$y(a.return,c,d)}function p_(a,c,d,m,_){var v=a.memoizedState;v===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:_}:(v.isBackwards=c,v.rendering=null,v.renderingStartTime=0,v.last=m,v.tail=d,v.tailMode=_)}function sT(a,c,d){var m=c.pendingProps,_=m.revealOrder,v=m.tail;if(jn(a,c,m.children,d),m=At.current,(m&2)!==0)m=m&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&rT(a,d,c);else if(a.tag===19)rT(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}if(_t(At,m),(c.mode&1)===0)c.memoizedState=null;else switch(_){case"forwards":for(d=c.child,_=null;d!==null;)a=d.alternate,a!==null&&Zf(a)===null&&(_=d),d=d.sibling;d=_,d===null?(_=c.child,c.child=null):(_=d.sibling,d.sibling=null),p_(c,!1,_,d,v);break;case"backwards":for(d=null,_=c.child,c.child=null;_!==null;){if(a=_.alternate,a!==null&&Zf(a)===null){c.child=_;break}a=_.sibling,_.sibling=d,d=_,_=a}p_(c,!0,d,null,v);break;case"together":p_(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function sg(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function As(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),Pa|=c.lanes,(d&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,d=To(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=To(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function oN(a,c,d){switch(c.tag){case 3:tT(c),lc();break;case 5:v1(c);break;case 1:Xn(c.type)&&zf(c);break;case 4:Xy(c,c.stateNode.containerInfo);break;case 10:var m=c.type._context,_=c.memoizedProps.value;_t(Hf,m._currentValue),m._currentValue=_;break;case 13:if(m=c.memoizedState,m!==null)return m.dehydrated!==null?(_t(At,At.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?iT(a,c,d):(_t(At,At.current&1),a=As(a,c,d),a!==null?a.sibling:null);_t(At,At.current&1);break;case 19:if(m=(d&c.childLanes)!==0,(a.flags&128)!==0){if(m)return sT(a,c,d);c.flags|=128}if(_=c.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),_t(At,At.current),m)break;return null;case 22:case 23:return c.lanes=0,Q1(a,c,d)}return As(a,c,d)}var oT,m_,aT,lT;oT=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},m_=function(){},aT=function(a,c,d,m){var _=a.memoizedProps;if(_!==m){a=c.stateNode,Ra($r.current);var v=null;switch(d){case"input":_=$n(a,_),m=$n(a,m),v=[];break;case"select":_=ie({},_,{value:void 0}),m=ie({},m,{value:void 0}),v=[];break;case"textarea":_=Ai(a,_),m=Ai(a,m),v=[];break;default:typeof _.onClick!="function"&&typeof m.onClick=="function"&&(a.onclick=Vf)}On(d,m);var A;d=null;for(Q in _)if(!m.hasOwnProperty(Q)&&_.hasOwnProperty(Q)&&_[Q]!=null)if(Q==="style"){var U=_[Q];for(A in U)U.hasOwnProperty(A)&&(d||(d={}),d[A]="")}else Q!=="dangerouslySetInnerHTML"&&Q!=="children"&&Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(r.hasOwnProperty(Q)?v||(v=[]):(v=v||[]).push(Q,null));for(Q in m){var B=m[Q];if(U=_?.[Q],m.hasOwnProperty(Q)&&B!==U&&(B!=null||U!=null))if(Q==="style")if(U){for(A in U)!U.hasOwnProperty(A)||B&&B.hasOwnProperty(A)||(d||(d={}),d[A]="");for(A in B)B.hasOwnProperty(A)&&U[A]!==B[A]&&(d||(d={}),d[A]=B[A])}else d||(v||(v=[]),v.push(Q,d)),d=B;else Q==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,U=U?U.__html:void 0,B!=null&&U!==B&&(v=v||[]).push(Q,B)):Q==="children"?typeof B!="string"&&typeof B!="number"||(v=v||[]).push(Q,""+B):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&(r.hasOwnProperty(Q)?(B!=null&&Q==="onScroll"&&wt("scroll",a),v||U===B||(v=[])):(v=v||[]).push(Q,B))}d&&(v=v||[]).push("style",d);var Q=v;(c.updateQueue=Q)&&(c.flags|=4)}},lT=function(a,c,d,m){d!==m&&(c.flags|=4)};function yh(a,c){if(!St)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function Pn(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,m=0;if(c)for(var _=a.child;_!==null;)d|=_.lanes|_.childLanes,m|=_.subtreeFlags&14680064,m|=_.flags&14680064,_.return=a,_=_.sibling;else for(_=a.child;_!==null;)d|=_.lanes|_.childLanes,m|=_.subtreeFlags,m|=_.flags,_.return=a,_=_.sibling;return a.subtreeFlags|=m,a.childLanes=d,c}function aN(a,c,d){var m=c.pendingProps;switch(Vy(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pn(c),null;case 1:return Xn(c.type)&&Uf(),Pn(c),null;case 3:return m=c.stateNode,dc(),xt(Hn),xt(Rn),Zy(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&($f(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,rr!==null&&(R_(rr),rr=null))),m_(a,c),Pn(c),null;case 5:qy(c);var _=Ra(dh.current);if(d=c.type,a!==null&&c.stateNode!=null)aT(a,c,d,m,_),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!m){if(c.stateNode===null)throw Error(t(166));return Pn(c),null}if(a=Ra($r.current),$f(c)){m=c.stateNode,d=c.type;var v=c.memoizedProps;switch(m[Wr]=c,m[ah]=v,a=(c.mode&1)!==0,d){case"dialog":wt("cancel",m),wt("close",m);break;case"iframe":case"object":case"embed":wt("load",m);break;case"video":case"audio":for(_=0;_<rh.length;_++)wt(rh[_],m);break;case"source":wt("error",m);break;case"img":case"image":case"link":wt("error",m),wt("load",m);break;case"details":wt("toggle",m);break;case"input":hn(m,v),wt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!v.multiple},wt("invalid",m);break;case"textarea":It(m,v),wt("invalid",m)}On(d,v),_=null;for(var A in v)if(v.hasOwnProperty(A)){var U=v[A];A==="children"?typeof U=="string"?m.textContent!==U&&(v.suppressHydrationWarning!==!0&&Ff(m.textContent,U,a),_=["children",U]):typeof U=="number"&&m.textContent!==""+U&&(v.suppressHydrationWarning!==!0&&Ff(m.textContent,U,a),_=["children",""+U]):r.hasOwnProperty(A)&&U!=null&&A==="onScroll"&&wt("scroll",m)}switch(d){case"input":Qi(m),Ri(m,v,!0);break;case"textarea":Qi(m),Pi(m);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(m.onclick=Vf)}m=_,c.updateQueue=m,m!==null&&(c.flags|=4)}else{A=_.nodeType===9?_:_.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Cr(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=A.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof m.is=="string"?a=A.createElement(d,{is:m.is}):(a=A.createElement(d),d==="select"&&(A=a,m.multiple?A.multiple=!0:m.size&&(A.size=m.size))):a=A.createElementNS(a,d),a[Wr]=c,a[ah]=m,oT(a,c,!1,!1),c.stateNode=a;e:{switch(A=gs(d,m),d){case"dialog":wt("cancel",a),wt("close",a),_=m;break;case"iframe":case"object":case"embed":wt("load",a),_=m;break;case"video":case"audio":for(_=0;_<rh.length;_++)wt(rh[_],a);_=m;break;case"source":wt("error",a),_=m;break;case"img":case"image":case"link":wt("error",a),wt("load",a),_=m;break;case"details":wt("toggle",a),_=m;break;case"input":hn(a,m),_=$n(a,m),wt("invalid",a);break;case"option":_=m;break;case"select":a._wrapperState={wasMultiple:!!m.multiple},_=ie({},m,{value:void 0}),wt("invalid",a);break;case"textarea":It(a,m),_=Ai(a,m),wt("invalid",a);break;default:_=m}On(d,_),U=_;for(v in U)if(U.hasOwnProperty(v)){var B=U[v];v==="style"?fs(a,B):v==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&ca(a,B)):v==="children"?typeof B=="string"?(d!=="textarea"||B!=="")&&Ar(a,B):typeof B=="number"&&Ar(a,""+B):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(r.hasOwnProperty(v)?B!=null&&v==="onScroll"&&wt("scroll",a):B!=null&&k(a,v,B,A))}switch(d){case"input":Qi(a),Ri(a,m,!1);break;case"textarea":Qi(a),Pi(a);break;case"option":m.value!=null&&a.setAttribute("value",""+Fe(m.value));break;case"select":a.multiple=!!m.multiple,v=m.value,v!=null?tn(a,!!m.multiple,v,!1):m.defaultValue!=null&&tn(a,!!m.multiple,m.defaultValue,!0);break;default:typeof _.onClick=="function"&&(a.onclick=Vf)}switch(d){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Pn(c),null;case 6:if(a&&c.stateNode!=null)lT(a,c,a.memoizedProps,m);else{if(typeof m!="string"&&c.stateNode===null)throw Error(t(166));if(d=Ra(dh.current),Ra($r.current),$f(c)){if(m=c.stateNode,d=c.memoizedProps,m[Wr]=c,(v=m.nodeValue!==d)&&(a=mi,a!==null))switch(a.tag){case 3:Ff(m.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Ff(m.nodeValue,d,(a.mode&1)!==0)}v&&(c.flags|=4)}else m=(d.nodeType===9?d:d.ownerDocument).createTextNode(m),m[Wr]=c,c.stateNode=m}return Pn(c),null;case 13:if(xt(At),m=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(St&&yi!==null&&(c.mode&1)!==0&&(c.flags&128)===0)h1(),lc(),c.flags|=98560,v=!1;else if(v=$f(c),m!==null&&m.dehydrated!==null){if(a===null){if(!v)throw Error(t(318));if(v=c.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[Wr]=c}else lc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Pn(c),v=!1}else rr!==null&&(R_(rr),rr=null),v=!0;if(!v)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(m=m!==null,m!==(a!==null&&a.memoizedState!==null)&&m&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(At.current&1)!==0?Yt===0&&(Yt=3):b_())),c.updateQueue!==null&&(c.flags|=4),Pn(c),null);case 4:return dc(),m_(a,c),a===null&&sh(c.stateNode.containerInfo),Pn(c),null;case 10:return Wy(c.type._context),Pn(c),null;case 17:return Xn(c.type)&&Uf(),Pn(c),null;case 19:if(xt(At),v=c.memoizedState,v===null)return Pn(c),null;if(m=(c.flags&128)!==0,A=v.rendering,A===null)if(m)yh(v,!1);else{if(Yt!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(A=Zf(a),A!==null){for(c.flags|=128,yh(v,!1),m=A.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),c.subtreeFlags=0,m=d,d=c.child;d!==null;)v=d,a=m,v.flags&=14680066,A=v.alternate,A===null?(v.childLanes=0,v.lanes=a,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=A.childLanes,v.lanes=A.lanes,v.child=A.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=A.memoizedProps,v.memoizedState=A.memoizedState,v.updateQueue=A.updateQueue,v.type=A.type,a=A.dependencies,v.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return _t(At,At.current&1|2),c.child}a=a.sibling}v.tail!==null&&vt()>mc&&(c.flags|=128,m=!0,yh(v,!1),c.lanes=4194304)}else{if(!m)if(a=Zf(A),a!==null){if(c.flags|=128,m=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),yh(v,!0),v.tail===null&&v.tailMode==="hidden"&&!A.alternate&&!St)return Pn(c),null}else 2*vt()-v.renderingStartTime>mc&&d!==1073741824&&(c.flags|=128,m=!0,yh(v,!1),c.lanes=4194304);v.isBackwards?(A.sibling=c.child,c.child=A):(d=v.last,d!==null?d.sibling=A:c.child=A,v.last=A)}return v.tail!==null?(c=v.tail,v.rendering=c,v.tail=c.sibling,v.renderingStartTime=vt(),c.sibling=null,d=At.current,_t(At,m?d&1|2:d&1),c):(Pn(c),null);case 22:case 23:return P_(),m=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==m&&(c.flags|=8192),m&&(c.mode&1)!==0?(_i&1073741824)!==0&&(Pn(c),c.subtreeFlags&6&&(c.flags|=8192)):Pn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function lN(a,c){switch(Vy(c),c.tag){case 1:return Xn(c.type)&&Uf(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return dc(),xt(Hn),xt(Rn),Zy(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return qy(c),null;case 13:if(xt(At),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));lc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return xt(At),null;case 4:return dc(),null;case 10:return Wy(c.type._context),null;case 22:case 23:return P_(),null;case 24:return null;default:return null}}var og=!1,bn=!1,cN=typeof WeakSet=="function"?WeakSet:Set,me=null;function gc(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(m){Mt(a,c,m)}else d.current=null}function y_(a,c,d){try{d()}catch(m){Mt(a,c,m)}}var cT=!1;function uN(a,c){if(Py=vs,a=zE(),xy(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var _=m.anchorOffset,v=m.focusNode;m=m.focusOffset;try{d.nodeType,v.nodeType}catch{d=null;break e}var A=0,U=-1,B=-1,Q=0,oe=0,ce=a,re=null;t:for(;;){for(var pe;ce!==d||_!==0&&ce.nodeType!==3||(U=A+_),ce!==v||m!==0&&ce.nodeType!==3||(B=A+m),ce.nodeType===3&&(A+=ce.nodeValue.length),(pe=ce.firstChild)!==null;)re=ce,ce=pe;for(;;){if(ce===a)break t;if(re===d&&++Q===_&&(U=A),re===v&&++oe===m&&(B=A),(pe=ce.nextSibling)!==null)break;ce=re,re=ce.parentNode}ce=pe}d=U===-1||B===-1?null:{start:U,end:B}}else d=null}d=d||{start:0,end:0}}else d=null;for(by={focusedElem:a,selectionRange:d},vs=!1,me=c;me!==null;)if(c=me,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,me=a;else for(;me!==null;){c=me;try{var ye=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(ye!==null){var _e=ye.memoizedProps,jt=ye.memoizedState,H=c.stateNode,$=H.getSnapshotBeforeUpdate(c.elementType===c.type?_e:sr(c.type,_e),jt);H.__reactInternalSnapshotBeforeUpdate=$}break;case 3:var q=c.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Mt(c,c.return,he)}if(a=c.sibling,a!==null){a.return=c.return,me=a;break}me=c.return}return ye=cT,cT=!1,ye}function _h(a,c,d){var m=c.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var _=m=m.next;do{if((_.tag&a)===a){var v=_.destroy;_.destroy=void 0,v!==void 0&&y_(c,d,v)}_=_.next}while(_!==m)}}function ag(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var m=d.create;d.destroy=m()}d=d.next}while(d!==c)}}function __(a){var c=a.ref;if(c!==null){var d=a.stateNode;a.tag,a=d,typeof c=="function"?c(a):c.current=a}}function uT(a){var c=a.alternate;c!==null&&(a.alternate=null,uT(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[Wr],delete c[ah],delete c[Ny],delete c[KM],delete c[HM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function hT(a){return a.tag===5||a.tag===3||a.tag===4}function dT(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||hT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function v_(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=Vf));else if(m!==4&&(a=a.child,a!==null))for(v_(a,c,d),a=a.sibling;a!==null;)v_(a,c,d),a=a.sibling}function w_(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(m!==4&&(a=a.child,a!==null))for(w_(a,c,d),a=a.sibling;a!==null;)w_(a,c,d),a=a.sibling}var _n=null,or=!1;function _o(a,c,d){for(d=d.child;d!==null;)fT(a,c,d),d=d.sibling}function fT(a,c,d){if(ui&&typeof ui.onCommitFiberUnmount=="function")try{ui.onCommitFiberUnmount(fa,d)}catch{}switch(d.tag){case 5:bn||gc(d,c);case 6:var m=_n,_=or;_n=null,_o(a,c,d),_n=m,or=_,_n!==null&&(or?(a=_n,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):_n.removeChild(d.stateNode));break;case 18:_n!==null&&(or?(a=_n,d=d.stateNode,a.nodeType===8?My(a.parentNode,d):a.nodeType===1&&My(a,d),ao(a)):My(_n,d.stateNode));break;case 4:m=_n,_=or,_n=d.stateNode.containerInfo,or=!0,_o(a,c,d),_n=m,or=_;break;case 0:case 11:case 14:case 15:if(!bn&&(m=d.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){_=m=m.next;do{var v=_,A=v.destroy;v=v.tag,A!==void 0&&((v&2)!==0||(v&4)!==0)&&y_(d,c,A),_=_.next}while(_!==m)}_o(a,c,d);break;case 1:if(!bn&&(gc(d,c),m=d.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=d.memoizedProps,m.state=d.memoizedState,m.componentWillUnmount()}catch(U){Mt(d,c,U)}_o(a,c,d);break;case 21:_o(a,c,d);break;case 22:d.mode&1?(bn=(m=bn)||d.memoizedState!==null,_o(a,c,d),bn=m):_o(a,c,d);break;default:_o(a,c,d)}}function gT(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new cN),c.forEach(function(m){var _=vN.bind(null,a,m);d.has(m)||(d.add(m),m.then(_,_))})}}function ar(a,c){var d=c.deletions;if(d!==null)for(var m=0;m<d.length;m++){var _=d[m];try{var v=a,A=c,U=A;e:for(;U!==null;){switch(U.tag){case 5:_n=U.stateNode,or=!1;break e;case 3:_n=U.stateNode.containerInfo,or=!0;break e;case 4:_n=U.stateNode.containerInfo,or=!0;break e}U=U.return}if(_n===null)throw Error(t(160));fT(v,A,_),_n=null,or=!1;var B=_.alternate;B!==null&&(B.return=null),_.return=null}catch(Q){Mt(_,c,Q)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)pT(c,a),c=c.sibling}function pT(a,c){var d=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(ar(c,a),Hr(a),m&4){try{_h(3,a,a.return),ag(3,a)}catch(_e){Mt(a,a.return,_e)}try{_h(5,a,a.return)}catch(_e){Mt(a,a.return,_e)}}break;case 1:ar(c,a),Hr(a),m&512&&d!==null&&gc(d,d.return);break;case 5:if(ar(c,a),Hr(a),m&512&&d!==null&&gc(d,d.return),a.flags&32){var _=a.stateNode;try{Ar(_,"")}catch(_e){Mt(a,a.return,_e)}}if(m&4&&(_=a.stateNode,_!=null)){var v=a.memoizedProps,A=d!==null?d.memoizedProps:v,U=a.type,B=a.updateQueue;if(a.updateQueue=null,B!==null)try{U==="input"&&v.type==="radio"&&v.name!=null&&dn(_,v),gs(U,A);var Q=gs(U,v);for(A=0;A<B.length;A+=2){var oe=B[A],ce=B[A+1];oe==="style"?fs(_,ce):oe==="dangerouslySetInnerHTML"?ca(_,ce):oe==="children"?Ar(_,ce):k(_,oe,ce,Q)}switch(U){case"input":Kn(_,v);break;case"textarea":to(_,v);break;case"select":var re=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!v.multiple;var pe=v.value;pe!=null?tn(_,!!v.multiple,pe,!1):re!==!!v.multiple&&(v.defaultValue!=null?tn(_,!!v.multiple,v.defaultValue,!0):tn(_,!!v.multiple,v.multiple?[]:"",!1))}_[ah]=v}catch(_e){Mt(a,a.return,_e)}}break;case 6:if(ar(c,a),Hr(a),m&4){if(a.stateNode===null)throw Error(t(162));_=a.stateNode,v=a.memoizedProps;try{_.nodeValue=v}catch(_e){Mt(a,a.return,_e)}}break;case 3:if(ar(c,a),Hr(a),m&4&&d!==null&&d.memoizedState.isDehydrated)try{ao(c.containerInfo)}catch(_e){Mt(a,a.return,_e)}break;case 4:ar(c,a),Hr(a);break;case 13:ar(c,a),Hr(a),_=a.child,_.flags&8192&&(v=_.memoizedState!==null,_.stateNode.isHidden=v,!v||_.alternate!==null&&_.alternate.memoizedState!==null||(T_=vt())),m&4&&gT(a);break;case 22:if(oe=d!==null&&d.memoizedState!==null,a.mode&1?(bn=(Q=bn)||oe,ar(c,a),bn=Q):ar(c,a),Hr(a),m&8192){if(Q=a.memoizedState!==null,(a.stateNode.isHidden=Q)&&!oe&&(a.mode&1)!==0)for(me=a,oe=a.child;oe!==null;){for(ce=me=oe;me!==null;){switch(re=me,pe=re.child,re.tag){case 0:case 11:case 14:case 15:_h(4,re,re.return);break;case 1:gc(re,re.return);var ye=re.stateNode;if(typeof ye.componentWillUnmount=="function"){m=re,d=re.return;try{c=m,ye.props=c.memoizedProps,ye.state=c.memoizedState,ye.componentWillUnmount()}catch(_e){Mt(m,d,_e)}}break;case 5:gc(re,re.return);break;case 22:if(re.memoizedState!==null){_T(ce);continue}}pe!==null?(pe.return=re,me=pe):_T(ce)}oe=oe.sibling}e:for(oe=null,ce=a;;){if(ce.tag===5){if(oe===null){oe=ce;try{_=ce.stateNode,Q?(v=_.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(U=ce.stateNode,B=ce.memoizedProps.style,A=B!=null&&B.hasOwnProperty("display")?B.display:null,U.style.display=Pr("display",A))}catch(_e){Mt(a,a.return,_e)}}}else if(ce.tag===6){if(oe===null)try{ce.stateNode.nodeValue=Q?"":ce.memoizedProps}catch(_e){Mt(a,a.return,_e)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===a)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===a)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===a)break e;oe===ce&&(oe=null),ce=ce.return}oe===ce&&(oe=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:ar(c,a),Hr(a),m&4&&gT(a);break;case 21:break;default:ar(c,a),Hr(a)}}function Hr(a){var c=a.flags;if(c&2){try{e:{for(var d=a.return;d!==null;){if(hT(d)){var m=d;break e}d=d.return}throw Error(t(160))}switch(m.tag){case 5:var _=m.stateNode;m.flags&32&&(Ar(_,""),m.flags&=-33);var v=dT(a);w_(a,v,_);break;case 3:case 4:var A=m.stateNode.containerInfo,U=dT(a);v_(a,U,A);break;default:throw Error(t(161))}}catch(B){Mt(a,a.return,B)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function hN(a,c,d){me=a,mT(a)}function mT(a,c,d){for(var m=(a.mode&1)!==0;me!==null;){var _=me,v=_.child;if(_.tag===22&&m){var A=_.memoizedState!==null||og;if(!A){var U=_.alternate,B=U!==null&&U.memoizedState!==null||bn;U=og;var Q=bn;if(og=A,(bn=B)&&!Q)for(me=_;me!==null;)A=me,B=A.child,A.tag===22&&A.memoizedState!==null?vT(_):B!==null?(B.return=A,me=B):vT(_);for(;v!==null;)me=v,mT(v),v=v.sibling;me=_,og=U,bn=Q}yT(a)}else(_.subtreeFlags&8772)!==0&&v!==null?(v.return=_,me=v):yT(a)}}function yT(a){for(;me!==null;){var c=me;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:bn||ag(5,c);break;case 1:var m=c.stateNode;if(c.flags&4&&!bn)if(d===null)m.componentDidMount();else{var _=c.elementType===c.type?d.memoizedProps:sr(c.type,d.memoizedProps);m.componentDidUpdate(_,d.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var v=c.updateQueue;v!==null&&_1(c,v,m);break;case 3:var A=c.updateQueue;if(A!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}_1(c,A,d)}break;case 5:var U=c.stateNode;if(d===null&&c.flags&4){d=U;var B=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&d.focus();break;case"img":B.src&&(d.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Q=c.alternate;if(Q!==null){var oe=Q.memoizedState;if(oe!==null){var ce=oe.dehydrated;ce!==null&&ao(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}bn||c.flags&512&&__(c)}catch(re){Mt(c,c.return,re)}}if(c===a){me=null;break}if(d=c.sibling,d!==null){d.return=c.return,me=d;break}me=c.return}}function _T(a){for(;me!==null;){var c=me;if(c===a){me=null;break}var d=c.sibling;if(d!==null){d.return=c.return,me=d;break}me=c.return}}function vT(a){for(;me!==null;){var c=me;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{ag(4,c)}catch(B){Mt(c,d,B)}break;case 1:var m=c.stateNode;if(typeof m.componentDidMount=="function"){var _=c.return;try{m.componentDidMount()}catch(B){Mt(c,_,B)}}var v=c.return;try{__(c)}catch(B){Mt(c,v,B)}break;case 5:var A=c.return;try{__(c)}catch(B){Mt(c,A,B)}}}catch(B){Mt(c,c.return,B)}if(c===a){me=null;break}var U=c.sibling;if(U!==null){U.return=c.return,me=U;break}me=c.return}}var dN=Math.ceil,lg=O.ReactCurrentDispatcher,x_=O.ReactCurrentOwner,ji=O.ReactCurrentBatchConfig,Qe=0,sn=null,Wt=null,vn=0,_i=0,pc=fo(0),Yt=0,vh=null,Pa=0,cg=0,E_=0,wh=null,Yn=null,T_=0,mc=1/0,Ps=null,ug=!1,I_=null,vo=null,hg=!1,wo=null,dg=0,xh=0,S_=null,fg=-1,gg=0;function Un(){return(Qe&6)!==0?vt():fg!==-1?fg:fg=vt()}function xo(a){return(a.mode&1)===0?1:(Qe&2)!==0&&vn!==0?vn&-vn:qM.transition!==null?(gg===0&&(gg=Bu()),gg):(a=He,a!==0||(a=window.event,a=a===void 0?16:$l(a.type)),a)}function lr(a,c,d,m){if(50<xh)throw xh=0,S_=null,Error(t(185));ya(a,d,m),((Qe&2)===0||a!==sn)&&(a===sn&&((Qe&2)===0&&(cg|=d),Yt===4&&Eo(a,vn)),Zn(a,m),d===1&&Qe===0&&(c.mode&1)===0&&(mc=vt()+500,Bf&&po()))}function Zn(a,c){var d=a.callbackNode;ma(a,c);var m=ms(a,a===sn?vn:0);if(m===0)d!==null&&Vl(d),a.callbackNode=null,a.callbackPriority=0;else if(c=m&-m,a.callbackPriority!==c){if(d!=null&&Vl(d),c===1)a.tag===0?XM(xT.bind(null,a)):o1(xT.bind(null,a)),WM(function(){(Qe&6)===0&&po()}),d=null;else{switch(Nr(m)){case 1:d=jl;break;case 4:d=ju;break;case 16:d=da;break;case 536870912:d=Ul;break;default:d=da}d=PT(d,wT.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function wT(a,c){if(fg=-1,gg=0,(Qe&6)!==0)throw Error(t(327));var d=a.callbackNode;if(yc()&&a.callbackNode!==d)return null;var m=ms(a,a===sn?vn:0);if(m===0)return null;if((m&30)!==0||(m&a.expiredLanes)!==0||c)c=pg(a,m);else{c=m;var _=Qe;Qe|=2;var v=TT();(sn!==a||vn!==c)&&(Ps=null,mc=vt()+500,ka(a,c));do try{pN();break}catch(U){ET(a,U)}while(!0);Gy(),lg.current=v,Qe=_,Wt!==null?c=0:(sn=null,vn=0,c=Yt)}if(c!==0){if(c===2&&(_=zu(a),_!==0&&(m=_,c=C_(a,_))),c===1)throw d=vh,ka(a,0),Eo(a,m),Zn(a,vt()),d;if(c===6)Eo(a,m);else{if(_=a.current.alternate,(m&30)===0&&!fN(_)&&(c=pg(a,m),c===2&&(v=zu(a),v!==0&&(m=v,c=C_(a,v))),c===1))throw d=vh,ka(a,0),Eo(a,m),Zn(a,vt()),d;switch(a.finishedWork=_,a.finishedLanes=m,c){case 0:case 1:throw Error(t(345));case 2:Da(a,Yn,Ps);break;case 3:if(Eo(a,m),(m&130023424)===m&&(c=T_+500-vt(),10<c)){if(ms(a,0)!==0)break;if(_=a.suspendedLanes,(_&m)!==m){Un(),a.pingedLanes|=a.suspendedLanes&_;break}a.timeoutHandle=Dy(Da.bind(null,a,Yn,Ps),c);break}Da(a,Yn,Ps);break;case 4:if(Eo(a,m),(m&4194240)===m)break;for(c=a.eventTimes,_=-1;0<m;){var A=31-hi(m);v=1<<A,A=c[A],A>_&&(_=A),m&=~v}if(m=_,m=vt()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*dN(m/1960))-m,10<m){a.timeoutHandle=Dy(Da.bind(null,a,Yn,Ps),m);break}Da(a,Yn,Ps);break;case 5:Da(a,Yn,Ps);break;default:throw Error(t(329))}}}return Zn(a,vt()),a.callbackNode===d?wT.bind(null,a):null}function C_(a,c){var d=wh;return a.current.memoizedState.isDehydrated&&(ka(a,c).flags|=256),a=pg(a,c),a!==2&&(c=Yn,Yn=d,c!==null&&R_(c)),a}function R_(a){Yn===null?Yn=a:Yn.push.apply(Yn,a)}function fN(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var m=0;m<d.length;m++){var _=d[m],v=_.getSnapshot;_=_.value;try{if(!ir(v(),_))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Eo(a,c){for(c&=~E_,c&=~cg,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-hi(c),m=1<<d;a[d]=-1,c&=~m}}function xT(a){if((Qe&6)!==0)throw Error(t(327));yc();var c=ms(a,0);if((c&1)===0)return Zn(a,vt()),null;var d=pg(a,c);if(a.tag!==0&&d===2){var m=zu(a);m!==0&&(c=m,d=C_(a,m))}if(d===1)throw d=vh,ka(a,0),Eo(a,c),Zn(a,vt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Da(a,Yn,Ps),Zn(a,vt()),null}function A_(a,c){var d=Qe;Qe|=1;try{return a(c)}finally{Qe=d,Qe===0&&(mc=vt()+500,Bf&&po())}}function ba(a){wo!==null&&wo.tag===0&&(Qe&6)===0&&yc();var c=Qe;Qe|=1;var d=ji.transition,m=He;try{if(ji.transition=null,He=1,a)return a()}finally{He=m,ji.transition=d,Qe=c,(Qe&6)===0&&po()}}function P_(){_i=pc.current,xt(pc)}function ka(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,GM(d)),Wt!==null)for(d=Wt.return;d!==null;){var m=d;switch(Vy(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Uf();break;case 3:dc(),xt(Hn),xt(Rn),Zy();break;case 5:qy(m);break;case 4:dc();break;case 13:xt(At);break;case 19:xt(At);break;case 10:Wy(m.type._context);break;case 22:case 23:P_()}d=d.return}if(sn=a,Wt=a=To(a.current,null),vn=_i=c,Yt=0,vh=null,E_=cg=Pa=0,Yn=wh=null,Ca!==null){for(c=0;c<Ca.length;c++)if(d=Ca[c],m=d.interleaved,m!==null){d.interleaved=null;var _=m.next,v=d.pending;if(v!==null){var A=v.next;v.next=_,m.next=A}d.pending=m}Ca=null}return a}function ET(a,c){do{var d=Wt;try{if(Gy(),Qf.current=ng,Jf){for(var m=Pt.memoizedState;m!==null;){var _=m.queue;_!==null&&(_.pending=null),m=m.next}Jf=!1}if(Aa=0,rn=qt=Pt=null,fh=!1,gh=0,x_.current=null,d===null||d.return===null){Yt=1,vh=c,Wt=null;break}e:{var v=a,A=d.return,U=d,B=c;if(c=vn,U.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var Q=B,oe=U,ce=oe.tag;if((oe.mode&1)===0&&(ce===0||ce===11||ce===15)){var re=oe.alternate;re?(oe.updateQueue=re.updateQueue,oe.memoizedState=re.memoizedState,oe.lanes=re.lanes):(oe.updateQueue=null,oe.memoizedState=null)}var pe=H1(A);if(pe!==null){pe.flags&=-257,X1(pe,A,U,v,c),pe.mode&1&&K1(v,Q,c),c=pe,B=Q;var ye=c.updateQueue;if(ye===null){var _e=new Set;_e.add(B),c.updateQueue=_e}else ye.add(B);break e}else{if((c&1)===0){K1(v,Q,c),b_();break e}B=Error(t(426))}}else if(St&&U.mode&1){var jt=H1(A);if(jt!==null){(jt.flags&65536)===0&&(jt.flags|=256),X1(jt,A,U,v,c),zy(fc(B,U));break e}}v=B=fc(B,U),Yt!==4&&(Yt=2),wh===null?wh=[v]:wh.push(v),v=A;do{switch(v.tag){case 3:v.flags|=65536,c&=-c,v.lanes|=c;var H=W1(v,B,c);y1(v,H);break e;case 1:U=B;var $=v.type,q=v.stateNode;if((v.flags&128)===0&&(typeof $.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(vo===null||!vo.has(q)))){v.flags|=65536,c&=-c,v.lanes|=c;var he=$1(v,U,c);y1(v,he);break e}}v=v.return}while(v!==null)}ST(d)}catch(we){c=we,Wt===d&&d!==null&&(Wt=d=d.return);continue}break}while(!0)}function TT(){var a=lg.current;return lg.current=ng,a===null?ng:a}function b_(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),sn===null||(Pa&268435455)===0&&(cg&268435455)===0||Eo(sn,vn)}function pg(a,c){var d=Qe;Qe|=2;var m=TT();(sn!==a||vn!==c)&&(Ps=null,ka(a,c));do try{gN();break}catch(_){ET(a,_)}while(!0);if(Gy(),Qe=d,lg.current=m,Wt!==null)throw Error(t(261));return sn=null,vn=0,Yt}function gN(){for(;Wt!==null;)IT(Wt)}function pN(){for(;Wt!==null&&!ha();)IT(Wt)}function IT(a){var c=AT(a.alternate,a,_i);a.memoizedProps=a.pendingProps,c===null?ST(a):Wt=c,x_.current=null}function ST(a){var c=a;do{var d=c.alternate;if(a=c.return,(c.flags&32768)===0){if(d=aN(d,c,_i),d!==null){Wt=d;return}}else{if(d=lN(d,c),d!==null){d.flags&=32767,Wt=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Yt=6,Wt=null;return}}if(c=c.sibling,c!==null){Wt=c;return}Wt=c=a}while(c!==null);Yt===0&&(Yt=5)}function Da(a,c,d){var m=He,_=ji.transition;try{ji.transition=null,He=1,mN(a,c,d,m)}finally{ji.transition=_,He=m}return null}function mN(a,c,d,m){do yc();while(wo!==null);if((Qe&6)!==0)throw Error(t(327));d=a.finishedWork;var _=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var v=d.lanes|d.childLanes;if(my(a,v),a===sn&&(Wt=sn=null,vn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||hg||(hg=!0,PT(da,function(){return yc(),null})),v=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||v){v=ji.transition,ji.transition=null;var A=He;He=1;var U=Qe;Qe|=4,x_.current=null,uN(a,d),pT(d,a),OM(by),vs=!!Py,by=Py=null,a.current=d,hN(d),ps(),Qe=U,He=A,ji.transition=v}else a.current=d;if(hg&&(hg=!1,wo=a,dg=_),v=a.pendingLanes,v===0&&(vo=null),Ef(d.stateNode),Zn(a,vt()),c!==null)for(m=a.onRecoverableError,d=0;d<c.length;d++)_=c[d],m(_.value,{componentStack:_.stack,digest:_.digest});if(ug)throw ug=!1,a=I_,I_=null,a;return(dg&1)!==0&&a.tag!==0&&yc(),v=a.pendingLanes,(v&1)!==0?a===S_?xh++:(xh=0,S_=a):xh=0,po(),null}function yc(){if(wo!==null){var a=Nr(dg),c=ji.transition,d=He;try{if(ji.transition=null,He=16>a?16:a,wo===null)var m=!1;else{if(a=wo,wo=null,dg=0,(Qe&6)!==0)throw Error(t(331));var _=Qe;for(Qe|=4,me=a.current;me!==null;){var v=me,A=v.child;if((me.flags&16)!==0){var U=v.deletions;if(U!==null){for(var B=0;B<U.length;B++){var Q=U[B];for(me=Q;me!==null;){var oe=me;switch(oe.tag){case 0:case 11:case 15:_h(8,oe,v)}var ce=oe.child;if(ce!==null)ce.return=oe,me=ce;else for(;me!==null;){oe=me;var re=oe.sibling,pe=oe.return;if(uT(oe),oe===Q){me=null;break}if(re!==null){re.return=pe,me=re;break}me=pe}}}var ye=v.alternate;if(ye!==null){var _e=ye.child;if(_e!==null){ye.child=null;do{var jt=_e.sibling;_e.sibling=null,_e=jt}while(_e!==null)}}me=v}}if((v.subtreeFlags&2064)!==0&&A!==null)A.return=v,me=A;else e:for(;me!==null;){if(v=me,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:_h(9,v,v.return)}var H=v.sibling;if(H!==null){H.return=v.return,me=H;break e}me=v.return}}var $=a.current;for(me=$;me!==null;){A=me;var q=A.child;if((A.subtreeFlags&2064)!==0&&q!==null)q.return=A,me=q;else e:for(A=$;me!==null;){if(U=me,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:ag(9,U)}}catch(we){Mt(U,U.return,we)}if(U===A){me=null;break e}var he=U.sibling;if(he!==null){he.return=U.return,me=he;break e}me=U.return}}if(Qe=_,po(),ui&&typeof ui.onPostCommitFiberRoot=="function")try{ui.onPostCommitFiberRoot(fa,a)}catch{}m=!0}return m}finally{He=d,ji.transition=c}}return!1}function CT(a,c,d){c=fc(d,c),c=W1(a,c,1),a=yo(a,c,1),c=Un(),a!==null&&(ya(a,1,c),Zn(a,c))}function Mt(a,c,d){if(a.tag===3)CT(a,a,d);else for(;c!==null;){if(c.tag===3){CT(c,a,d);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(vo===null||!vo.has(m))){a=fc(d,a),a=$1(c,a,1),c=yo(c,a,1),a=Un(),c!==null&&(ya(c,1,a),Zn(c,a));break}}c=c.return}}function yN(a,c,d){var m=a.pingCache;m!==null&&m.delete(c),c=Un(),a.pingedLanes|=a.suspendedLanes&d,sn===a&&(vn&d)===d&&(Yt===4||Yt===3&&(vn&130023424)===vn&&500>vt()-T_?ka(a,0):E_|=d),Zn(a,c)}function RT(a,c){c===0&&((a.mode&1)===0?c=1:(c=ro,ro<<=1,(ro&130023424)===0&&(ro=4194304)));var d=Un();a=Cs(a,c),a!==null&&(ya(a,c,d),Zn(a,d))}function _N(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),RT(a,d)}function vN(a,c){var d=0;switch(a.tag){case 13:var m=a.stateNode,_=a.memoizedState;_!==null&&(d=_.retryLane);break;case 19:m=a.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(c),RT(a,d)}var AT;AT=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Hn.current)qn=!0;else{if((a.lanes&d)===0&&(c.flags&128)===0)return qn=!1,oN(a,c,d);qn=(a.flags&131072)!==0}else qn=!1,St&&(c.flags&1048576)!==0&&a1(c,Wf,c.index);switch(c.lanes=0,c.tag){case 2:var m=c.type;sg(a,c),a=c.pendingProps;var _=sc(c,Rn.current);hc(c,d),_=e_(null,c,m,a,_,d);var v=t_();return c.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Xn(m)?(v=!0,zf(c)):v=!1,c.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Hy(c),_.updater=ig,c.stateNode=_,_._reactInternals=c,a_(c,m,a,d),c=h_(null,c,m,!0,v,d)):(c.tag=0,St&&v&&Fy(c),jn(null,c,_,d),c=c.child),c;case 16:m=c.elementType;e:{switch(sg(a,c),a=c.pendingProps,_=m._init,m=_(m._payload),c.type=m,_=c.tag=xN(m),a=sr(m,a),_){case 0:c=u_(null,c,m,a,d);break e;case 1:c=eT(null,c,m,a,d);break e;case 11:c=q1(null,c,m,a,d);break e;case 14:c=Y1(null,c,m,sr(m.type,a),d);break e}throw Error(t(306,m,""))}return c;case 0:return m=c.type,_=c.pendingProps,_=c.elementType===m?_:sr(m,_),u_(a,c,m,_,d);case 1:return m=c.type,_=c.pendingProps,_=c.elementType===m?_:sr(m,_),eT(a,c,m,_,d);case 3:e:{if(tT(c),a===null)throw Error(t(387));m=c.pendingProps,v=c.memoizedState,_=v.element,m1(a,c),Yf(c,m,null,d);var A=c.memoizedState;if(m=A.element,v.isDehydrated)if(v={element:m,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},c.updateQueue.baseState=v,c.memoizedState=v,c.flags&256){_=fc(Error(t(423)),c),c=nT(a,c,m,d,_);break e}else if(m!==_){_=fc(Error(t(424)),c),c=nT(a,c,m,d,_);break e}else for(yi=ho(c.stateNode.containerInfo.firstChild),mi=c,St=!0,rr=null,d=g1(c,null,m,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(lc(),m===_){c=As(a,c,d);break e}jn(a,c,m,d)}c=c.child}return c;case 5:return v1(c),a===null&&Uy(c),m=c.type,_=c.pendingProps,v=a!==null?a.memoizedProps:null,A=_.children,ky(m,_)?A=null:v!==null&&ky(m,v)&&(c.flags|=32),J1(a,c),jn(a,c,A,d),c.child;case 6:return a===null&&Uy(c),null;case 13:return iT(a,c,d);case 4:return Xy(c,c.stateNode.containerInfo),m=c.pendingProps,a===null?c.child=cc(c,null,m,d):jn(a,c,m,d),c.child;case 11:return m=c.type,_=c.pendingProps,_=c.elementType===m?_:sr(m,_),q1(a,c,m,_,d);case 7:return jn(a,c,c.pendingProps,d),c.child;case 8:return jn(a,c,c.pendingProps.children,d),c.child;case 12:return jn(a,c,c.pendingProps.children,d),c.child;case 10:e:{if(m=c.type._context,_=c.pendingProps,v=c.memoizedProps,A=_.value,_t(Hf,m._currentValue),m._currentValue=A,v!==null)if(ir(v.value,A)){if(v.children===_.children&&!Hn.current){c=As(a,c,d);break e}}else for(v=c.child,v!==null&&(v.return=c);v!==null;){var U=v.dependencies;if(U!==null){A=v.child;for(var B=U.firstContext;B!==null;){if(B.context===m){if(v.tag===1){B=Rs(-1,d&-d),B.tag=2;var Q=v.updateQueue;if(Q!==null){Q=Q.shared;var oe=Q.pending;oe===null?B.next=B:(B.next=oe.next,oe.next=B),Q.pending=B}}v.lanes|=d,B=v.alternate,B!==null&&(B.lanes|=d),$y(v.return,d,c),U.lanes|=d;break}B=B.next}}else if(v.tag===10)A=v.type===c.type?null:v.child;else if(v.tag===18){if(A=v.return,A===null)throw Error(t(341));A.lanes|=d,U=A.alternate,U!==null&&(U.lanes|=d),$y(A,d,c),A=v.sibling}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===c){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}jn(a,c,_.children,d),c=c.child}return c;case 9:return _=c.type,m=c.pendingProps.children,hc(c,d),_=Fi(_),m=m(_),c.flags|=1,jn(a,c,m,d),c.child;case 14:return m=c.type,_=sr(m,c.pendingProps),_=sr(m.type,_),Y1(a,c,m,_,d);case 15:return Z1(a,c,c.type,c.pendingProps,d);case 17:return m=c.type,_=c.pendingProps,_=c.elementType===m?_:sr(m,_),sg(a,c),c.tag=1,Xn(m)?(a=!0,zf(c)):a=!1,hc(c,d),B1(c,m,_),a_(c,m,_,d),h_(null,c,m,!0,a,d);case 19:return sT(a,c,d);case 22:return Q1(a,c,d)}throw Error(t(156,c.tag))};function PT(a,c){return Vu(a,c)}function wN(a,c,d,m){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ui(a,c,d,m){return new wN(a,c,d,m)}function k_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function xN(a){if(typeof a=="function")return k_(a)?1:0;if(a!=null){if(a=a.$$typeof,a===z)return 11;if(a===ge)return 14}return 2}function To(a,c){var d=a.alternate;return d===null?(d=Ui(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function mg(a,c,d,m,_,v){var A=2;if(m=a,typeof a=="function")k_(a)&&(A=1);else if(typeof a=="string")A=5;else e:switch(a){case b:return Ma(d.children,_,v,c);case R:A=8,_|=8;break;case D:return a=Ui(12,d,c,_|2),a.elementType=D,a.lanes=v,a;case N:return a=Ui(13,d,c,_),a.elementType=N,a.lanes=v,a;case se:return a=Ui(19,d,c,_),a.elementType=se,a.lanes=v,a;case ue:return yg(d,_,v,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case V:A=10;break e;case j:A=9;break e;case z:A=11;break e;case ge:A=14;break e;case ne:A=16,m=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=Ui(A,d,c,_),c.elementType=a,c.type=m,c.lanes=v,c}function Ma(a,c,d,m){return a=Ui(7,a,m,c),a.lanes=d,a}function yg(a,c,d,m){return a=Ui(22,a,m,c),a.elementType=ue,a.lanes=d,a.stateNode={isHidden:!1},a}function D_(a,c,d){return a=Ui(6,a,null,c),a.lanes=d,a}function M_(a,c,d){return c=Ui(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function EN(a,c,d,m,_){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gu(0),this.expirationTimes=Gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gu(0),this.identifierPrefix=m,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function N_(a,c,d,m,_,v,A,U,B){return a=new EN(a,c,d,U,B),c===1?(c=1,v===!0&&(c|=8)):c=0,v=Ui(3,null,null,c),a.current=v,v.stateNode=a,v.memoizedState={element:m,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hy(v),a}function TN(a,c,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:m==null?null:""+m,children:a,containerInfo:c,implementation:d}}function bT(a){if(!a)return go;a=a._reactInternals;e:{if(tr(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Xn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(Xn(d))return r1(a,d,c)}return c}function kT(a,c,d,m,_,v,A,U,B){return a=N_(d,m,!0,a,_,v,A,U,B),a.context=bT(null),d=a.current,m=Un(),_=xo(d),v=Rs(m,_),v.callback=c??null,yo(d,v,_),a.current.lanes=_,ya(a,_,m),Zn(a,m),a}function _g(a,c,d,m){var _=c.current,v=Un(),A=xo(_);return d=bT(d),c.context===null?c.context=d:c.pendingContext=d,c=Rs(v,A),c.payload={element:a},m=m===void 0?null:m,m!==null&&(c.callback=m),a=yo(_,c,A),a!==null&&(lr(a,_,A,v),qf(a,_,A)),A}function vg(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function DT(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function L_(a,c){DT(a,c),(a=a.alternate)&&DT(a,c)}function IN(){return null}var MT=typeof reportError=="function"?reportError:function(a){console.error(a)};function O_(a){this._internalRoot=a}wg.prototype.render=O_.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));_g(a,c,null,null)},wg.prototype.unmount=O_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;ba(function(){_g(null,a,null,null)}),c[Es]=null}};function wg(a){this._internalRoot=a}wg.prototype.unstable_scheduleHydration=function(a){if(a){var c=Hu();a={blockedOn:null,target:a,priority:c};for(var d=0;d<di.length&&c!==0&&c<di[d].priority;d++);di.splice(d,0,a),d===0&&Gl(a)}};function F_(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function xg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function NT(){}function SN(a,c,d,m,_){if(_){if(typeof m=="function"){var v=m;m=function(){var Q=vg(A);v.call(Q)}}var A=kT(c,m,a,0,null,!1,!1,"",NT);return a._reactRootContainer=A,a[Es]=A.current,sh(a.nodeType===8?a.parentNode:a),ba(),A}for(;_=a.lastChild;)a.removeChild(_);if(typeof m=="function"){var U=m;m=function(){var Q=vg(B);U.call(Q)}}var B=N_(a,0,!1,null,null,!1,!1,"",NT);return a._reactRootContainer=B,a[Es]=B.current,sh(a.nodeType===8?a.parentNode:a),ba(function(){_g(c,B,d,m)}),B}function Eg(a,c,d,m,_){var v=d._reactRootContainer;if(v){var A=v;if(typeof _=="function"){var U=_;_=function(){var B=vg(A);U.call(B)}}_g(c,A,a,_)}else A=SN(d,c,a,_,m);return vg(A)}$u=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=st(c.pendingLanes);d!==0&&(Wu(c,d|1),Zn(c,vt()),(Qe&6)===0&&(mc=vt()+500,po()))}break;case 13:ba(function(){var m=Cs(a,1);if(m!==null){var _=Un();lr(m,a,1,_)}}),L_(a,1)}},zl=function(a){if(a.tag===13){var c=Cs(a,134217728);if(c!==null){var d=Un();lr(c,a,134217728,d)}L_(a,134217728)}},Ku=function(a){if(a.tag===13){var c=xo(a),d=Cs(a,c);if(d!==null){var m=Un();lr(d,a,c,m)}L_(a,c)}},Hu=function(){return He},Xu=function(a,c){var d=He;try{return He=a,c()}finally{He=d}},Fn=function(a,c,d){switch(c){case"input":if(Kn(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var m=d[c];if(m!==a&&m.form===a.form){var _=jf(m);if(!_)throw Error(t(90));ds(m),Kn(m,_)}}}break;case"textarea":to(a,d);break;case"select":c=d.value,c!=null&&tn(a,!!d.multiple,c,!1)}},ki=A_,fn=ba;var CN={usingClientEntryPoint:!1,Events:[lh,ic,jf,er,Ot,A_]},Eh={findFiberByHostInstance:Ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RN={bundleType:Eh.bundleType,version:Eh.version,rendererPackageName:Eh.rendererPackageName,rendererConfig:Eh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:O.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=xf(a),a===null?null:a.stateNode},findFiberByHostInstance:Eh.findFiberByHostInstance||IN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tg.isDisabled&&Tg.supportsFiber)try{fa=Tg.inject(RN),ui=Tg}catch{}}return Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CN,Qn.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!F_(c))throw Error(t(200));return TN(a,c,null,d)},Qn.createRoot=function(a,c){if(!F_(a))throw Error(t(299));var d=!1,m="",_=MT;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onRecoverableError!==void 0&&(_=c.onRecoverableError)),c=N_(a,1,!1,null,null,d,!1,m,_),a[Es]=c.current,sh(a.nodeType===8?a.parentNode:a),new O_(c)},Qn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=xf(c),a=a===null?null:a.stateNode,a},Qn.flushSync=function(a){return ba(a)},Qn.hydrate=function(a,c,d){if(!xg(c))throw Error(t(200));return Eg(null,a,c,!0,d)},Qn.hydrateRoot=function(a,c,d){if(!F_(a))throw Error(t(405));var m=d!=null&&d.hydratedSources||null,_=!1,v="",A=MT;if(d!=null&&(d.unstable_strictMode===!0&&(_=!0),d.identifierPrefix!==void 0&&(v=d.identifierPrefix),d.onRecoverableError!==void 0&&(A=d.onRecoverableError)),c=kT(c,null,a,1,d??null,_,!1,v,A),a[Es]=c.current,sh(a),m)for(a=0;a<m.length;a++)d=m[a],_=d._getVersion,_=_(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,_]:c.mutableSourceEagerHydrationData.push(d,_);return new wg(c)},Qn.render=function(a,c,d){if(!xg(c))throw Error(t(200));return Eg(null,a,c,!1,d)},Qn.unmountComponentAtNode=function(a){if(!xg(a))throw Error(t(40));return a._reactRootContainer?(ba(function(){Eg(null,null,a,!1,function(){a._reactRootContainer=null,a[Es]=null})}),!0):!1},Qn.unstable_batchedUpdates=A_,Qn.unstable_renderSubtreeIntoContainer=function(a,c,d,m){if(!xg(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Eg(a,c,d,!1,m)},Qn.version="18.3.1-next-f1338f8080-20240426",Qn}var BT;function LN(){if(BT)return U_.exports;BT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),U_.exports=NN(),U_.exports}var GT;function ON(){if(GT)return Ig;GT=1;var n=LN();return Ig.createRoot=n.createRoot,Ig.hydrateRoot=n.hydrateRoot,Ig}var FN=ON();const VN=mw(FN);var J=Wd();const jN=mw(J),yw=J.createContext({});function _w(n){const e=J.useRef(null);return e.current===null&&(e.current=n()),e.current}const mm=J.createContext(null),vw=J.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class UN extends J.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function zN({children:n,isPresent:e}){const t=J.useId(),i=J.useRef(null),r=J.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=J.useContext(vw);return J.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),E.jsx(UN,{isPresent:e,childRef:i,sizeRef:r,children:J.cloneElement(n,{ref:i})})}const BN=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=_w(GN),u=J.useId(),h=J.useCallback(p=>{l.set(p,!0);for(const y of l.values())if(!y)return;i&&i()},[l,i]),f=J.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:p=>(l.set(p,!1),()=>l.delete(p))}),s?[Math.random(),h]:[t,h]);return J.useMemo(()=>{l.forEach((p,y)=>l.set(y,!1))},[t]),J.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=E.jsx(zN,{isPresent:t,children:n})),E.jsx(mm.Provider,{value:f,children:n})};function GN(){return new Map}function SA(n=!0){const e=J.useContext(mm);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=J.useId();J.useEffect(()=>{n&&r(s)},[n]);const o=J.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Sg=n=>n.key||"";function WT(n){const e=[];return J.Children.forEach(n,t=>{J.isValidElement(t)&&e.push(t)}),e}const ww=typeof window<"u",CA=ww?J.useLayoutEffect:J.useEffect,qs=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,u]=SA(o),h=J.useMemo(()=>WT(n),[n]),f=o&&!l?[]:h.map(Sg),p=J.useRef(!0),y=J.useRef(h),x=_w(()=>new Map),[I,S]=J.useState(h),[T,P]=J.useState(h);CA(()=>{p.current=!1,y.current=h;for(let O=0;O<T.length;O++){const F=Sg(T[O]);f.includes(F)?x.delete(F):x.get(F)!==!0&&x.set(F,!1)}},[T,f.length,f.join("-")]);const M=[];if(h!==I){let O=[...h];for(let F=0;F<T.length;F++){const G=T[F],b=Sg(G);f.includes(b)||(O.splice(F,0,G),M.push(G))}s==="wait"&&M.length&&(O=M),P(WT(O)),S(h);return}const{forceRender:k}=J.useContext(yw);return E.jsx(E.Fragment,{children:T.map(O=>{const F=Sg(O),G=o&&!l?!1:h===T||f.includes(F),b=()=>{if(x.has(F))x.set(F,!0);else return;let R=!0;x.forEach(D=>{D||(R=!1)}),R&&(k?.(),P(y.current),o&&u?.(),i&&i())};return E.jsx(BN,{isPresent:G,initial:!p.current||t?void 0:!1,custom:G?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:G?void 0:b,children:O},F)})})},Ti=n=>n;let RA=Ti;function xw(n){let e;return()=>(e===void 0&&(e=n()),e)}const tu=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},js=n=>n*1e3,Us=n=>n/1e3,WN={useManualTiming:!1};function $N(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,f=!1,p=!1)=>{const x=p&&i?e:t;return f&&s.add(h),x.has(h)||x.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Cg=["read","resolveKeyframes","update","preRender","render","postRender"],KN=40;function AA(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Cg.reduce((P,M)=>(P[M]=$N(s),P),{}),{read:l,resolveKeyframes:u,update:h,preRender:f,render:p,postRender:y}=o,x=()=>{const P=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(P-r.timestamp,KN),1),r.timestamp=P,r.isProcessing=!0,l.process(r),u.process(r),h.process(r),f.process(r),p.process(r),y.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(x))},I=()=>{t=!0,i=!0,r.isProcessing||n(x)};return{schedule:Cg.reduce((P,M)=>{const k=o[M];return P[M]=(O,F=!1,G=!1)=>(t||I(),k.schedule(O,F,G)),P},{}),cancel:P=>{for(let M=0;M<Cg.length;M++)o[Cg[M]].cancel(P)},state:r,steps:o}}const{schedule:Et,cancel:Jo,state:wn,steps:G_}=AA(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ti,!0),PA=J.createContext({strict:!1}),$T={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},nu={};for(const n in $T)nu[n]={isEnabled:e=>$T[n].some(t=>!!e[t])};function HN(n){for(const e in n)nu[e]={...nu[e],...n[e]}}const XN=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function vp(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||XN.has(n)}let bA=n=>!vp(n);function qN(n){n&&(bA=e=>e.startsWith("on")?!vp(e):n(e))}try{qN(require("@emotion/is-prop-valid").default)}catch{}function YN(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(bA(r)||t===!0&&vp(r)||!e&&!vp(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function ZN(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const ym=J.createContext({});function dd(n){return typeof n=="string"||Array.isArray(n)}function _m(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const Ew=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Tw=["initial",...Ew];function vm(n){return _m(n.animate)||Tw.some(e=>dd(n[e]))}function kA(n){return!!(vm(n)||n.variants)}function QN(n,e){if(vm(n)){const{initial:t,animate:i}=n;return{initial:t===!1||dd(t)?t:void 0,animate:dd(i)?i:void 0}}return n.inherit!==!1?e:{}}function JN(n){const{initial:e,animate:t}=QN(n,J.useContext(ym));return J.useMemo(()=>({initial:e,animate:t}),[KT(e),KT(t)])}function KT(n){return Array.isArray(n)?n.join(" "):n}const eL=Symbol.for("motionComponentSymbol");function jc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function tL(n,e,t){return J.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):jc(t)&&(t.current=i))},[e])}const Iw=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),nL="framerAppearId",DA="data-"+Iw(nL),{schedule:Sw}=AA(queueMicrotask,!1),MA=J.createContext({});function iL(n,e,t,i,r){var s,o;const{visualElement:l}=J.useContext(ym),u=J.useContext(PA),h=J.useContext(mm),f=J.useContext(vw).reducedMotion,p=J.useRef(null);i=i||u.renderer,!p.current&&i&&(p.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const y=p.current,x=J.useContext(MA);y&&!y.projection&&r&&(y.type==="html"||y.type==="svg")&&rL(p.current,t,r,x);const I=J.useRef(!1);J.useInsertionEffect(()=>{y&&I.current&&y.update(t,h)});const S=t[DA],T=J.useRef(!!S&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,S))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,S)));return CA(()=>{y&&(I.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),Sw.render(y.render),T.current&&y.animationState&&y.animationState.animateChanges())}),J.useEffect(()=>{y&&(!T.current&&y.animationState&&y.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{var P;(P=window.MotionHandoffMarkAsComplete)===null||P===void 0||P.call(window,S)}),T.current=!1))}),y}function rL(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:NA(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&jc(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function NA(n){if(n)return n.options.allowProjection!==!1?n.projection:NA(n.parent)}function sL({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&HN(n);function l(h,f){let p;const y={...J.useContext(vw),...h,layoutId:oL(h)},{isStatic:x}=y,I=JN(h),S=i(h,x);if(!x&&ww){aL();const T=lL(y);p=T.MeasureLayout,I.visualElement=iL(r,S,y,e,T.ProjectionNode)}return E.jsxs(ym.Provider,{value:I,children:[p&&I.visualElement?E.jsx(p,{visualElement:I.visualElement,...y}):null,t(r,h,tL(S,I.visualElement,f),S,x,I.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=J.forwardRef(l);return u[eL]=r,u}function oL({layoutId:n}){const e=J.useContext(yw).id;return e&&n!==void 0?e+"-"+n:n}function aL(n,e){J.useContext(PA).strict}function lL(n){const{drag:e,layout:t}=nu;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const cL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Cw(n){return typeof n!="string"||n.includes("-")?!1:!!(cL.indexOf(n)>-1||/[A-Z]/u.test(n))}function HT(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function Rw(n,e,t,i){if(typeof e=="function"){const[r,s]=HT(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=HT(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const Z0=n=>Array.isArray(n),uL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),hL=n=>Z0(n)?n[n.length-1]||0:n,Ln=n=>!!(n&&n.getVelocity);function ep(n){const e=Ln(n)?n.get():n;return uL(e)?e.toValue():e}function dL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:fL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const LA=n=>(e,t)=>{const i=J.useContext(ym),r=J.useContext(mm),s=()=>dL(n,e,i,r);return t?s():_w(s)};function fL(n,e,t,i){const r={},s=i(n,{});for(const y in s)r[y]=ep(s[y]);let{initial:o,animate:l}=n;const u=vm(n),h=kA(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const p=f?l:o;if(p&&typeof p!="boolean"&&!_m(p)){const y=Array.isArray(p)?p:[p];for(let x=0;x<y.length;x++){const I=Rw(n,y[x]);if(I){const{transitionEnd:S,transition:T,...P}=I;for(const M in P){let k=P[M];if(Array.isArray(k)){const O=f?k.length-1:0;k=k[O]}k!==null&&(r[M]=k)}for(const M in S)r[M]=S[M]}}}return r}const Au=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Pl=new Set(Au),OA=n=>e=>typeof e=="string"&&e.startsWith(n),FA=OA("--"),gL=OA("var(--"),Aw=n=>gL(n)?pL.test(n.split("/*")[0].trim()):!1,pL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,VA=(n,e)=>e&&typeof n=="number"?e.transform(n):n,$s=(n,e,t)=>t>e?e:t<n?n:t,Pu={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},fd={...Pu,transform:n=>$s(0,1,n)},Rg={...Pu,default:1},$d=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Lo=$d("deg"),ts=$d("%"),ke=$d("px"),mL=$d("vh"),yL=$d("vw"),XT={...ts,parse:n=>ts.parse(n)/100,transform:n=>ts.transform(n*100)},_L={borderWidth:ke,borderTopWidth:ke,borderRightWidth:ke,borderBottomWidth:ke,borderLeftWidth:ke,borderRadius:ke,radius:ke,borderTopLeftRadius:ke,borderTopRightRadius:ke,borderBottomRightRadius:ke,borderBottomLeftRadius:ke,width:ke,maxWidth:ke,height:ke,maxHeight:ke,top:ke,right:ke,bottom:ke,left:ke,padding:ke,paddingTop:ke,paddingRight:ke,paddingBottom:ke,paddingLeft:ke,margin:ke,marginTop:ke,marginRight:ke,marginBottom:ke,marginLeft:ke,backgroundPositionX:ke,backgroundPositionY:ke},vL={rotate:Lo,rotateX:Lo,rotateY:Lo,rotateZ:Lo,scale:Rg,scaleX:Rg,scaleY:Rg,scaleZ:Rg,skew:Lo,skewX:Lo,skewY:Lo,distance:ke,translateX:ke,translateY:ke,translateZ:ke,x:ke,y:ke,z:ke,perspective:ke,transformPerspective:ke,opacity:fd,originX:XT,originY:XT,originZ:ke},qT={...Pu,transform:Math.round},Pw={..._L,...vL,zIndex:qT,size:ke,fillOpacity:fd,strokeOpacity:fd,numOctaves:qT},wL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},xL=Au.length;function EL(n,e,t){let i="",r=!0;for(let s=0;s<xL;s++){const o=Au[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=VA(l,Pw[o]);if(!u){r=!1;const f=wL[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function bw(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const u in e){const h=e[u];if(Pl.has(u)){o=!0;continue}else if(FA(u)){r[u]=h;continue}else{const f=VA(h,Pw[u]);u.startsWith("origin")?(l=!0,s[u]=f):i[u]=f}}if(e.transform||(o||t?i.transform=EL(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${u} ${h} ${f}`}}const TL={offset:"stroke-dashoffset",array:"stroke-dasharray"},IL={offset:"strokeDashoffset",array:"strokeDasharray"};function SL(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?TL:IL;n[s.offset]=ke.transform(-i);const o=ke.transform(e),l=ke.transform(t);n[s.array]=`${o} ${l}`}function YT(n,e,t){return typeof n=="string"?n:ke.transform(e+t*n)}function CL(n,e,t){const i=YT(e,n.x,n.width),r=YT(t,n.y,n.height);return`${i} ${r}`}function kw(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...h},f,p){if(bw(n,h,p),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:y,style:x,dimensions:I}=n;y.transform&&(I&&(x.transform=y.transform),delete y.transform),I&&(r!==void 0||s!==void 0||x.transform)&&(x.transformOrigin=CL(I,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(y.x=e),t!==void 0&&(y.y=t),i!==void 0&&(y.scale=i),o!==void 0&&SL(y,o,l,u,!1)}const Dw=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),jA=()=>({...Dw(),attrs:{}}),Mw=n=>typeof n=="string"&&n.toLowerCase()==="svg";function UA(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const zA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function BA(n,e,t,i){UA(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(zA.has(r)?r:Iw(r),e.attrs[r])}const wp={};function RL(n){Object.assign(wp,n)}function GA(n,{layout:e,layoutId:t}){return Pl.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!wp[n]||n==="opacity")}function Nw(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(Ln(r[o])||e.style&&Ln(e.style[o])||GA(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function WA(n,e,t){const i=Nw(n,e,t);for(const r in n)if(Ln(n[r])||Ln(e[r])){const s=Au.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function AL(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const ZT=["x","y","width","height","cx","cy","r"],PL={useVisualState:LA({scrapeMotionValuesFromProps:WA,createRenderState:jA,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(Pl.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<ZT.length;l++){const u=ZT[l];n[u]!==e[u]&&(o=!0)}o&&Et.read(()=>{AL(t,i),Et.render(()=>{kw(i,r,Mw(t.tagName),n.transformTemplate),BA(t,i)})})}})},bL={useVisualState:LA({scrapeMotionValuesFromProps:Nw,createRenderState:Dw})};function $A(n,e,t){for(const i in e)!Ln(e[i])&&!GA(i,t)&&(n[i]=e[i])}function kL({transformTemplate:n},e){return J.useMemo(()=>{const t=Dw();return bw(t,e,n),Object.assign({},t.vars,t.style)},[e])}function DL(n,e){const t=n.style||{},i={};return $A(i,t,n),Object.assign(i,kL(n,e)),i}function ML(n,e){const t={},i=DL(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function NL(n,e,t,i){const r=J.useMemo(()=>{const s=jA();return kw(s,e,Mw(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};$A(s,n.style,n),r.style={...s,...r.style}}return r}function LL(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(Cw(t)?NL:ML)(i,s,o,t),h=YN(i,typeof t=="string",n),f=t!==J.Fragment?{...h,...u,ref:r}:{},{children:p}=i,y=J.useMemo(()=>Ln(p)?p.get():p,[p]);return J.createElement(t,{...f,children:y})}}function OL(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...Cw(i)?PL:bL,preloadedFeatures:n,useRender:LL(r),createVisualElement:e,Component:i};return sL(o)}}function KA(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function wm(n,e,t){const i=n.getProps();return Rw(i,e,t!==void 0?t:i.custom,n)}const FL=xw(()=>window.ScrollTimeline!==void 0);class VL{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(FL()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class jL extends VL{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Lw(n,e){return n?n[e]||n.default||n:void 0}const Q0=2e4;function HA(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<Q0;)e+=t,i=n.next(e);return e>=Q0?1/0:e}function Ow(n){return typeof n=="function"}function QT(n,e){n.timeline=e,n.onfinish=null}const Fw=n=>Array.isArray(n)&&typeof n[0]=="number",UL={linearEasing:void 0};function zL(n,e){const t=xw(n);return()=>{var i;return(i=UL[e])!==null&&i!==void 0?i:t()}}const xp=zL(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),XA=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(tu(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function qA(n){return!!(typeof n=="function"&&xp()||!n||typeof n=="string"&&(n in J0||xp())||Fw(n)||Array.isArray(n)&&n.every(qA))}const Fh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,J0={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Fh([0,.65,.55,1]),circOut:Fh([.55,0,1,.45]),backIn:Fh([.31,.01,.66,-.59]),backOut:Fh([.33,1.53,.69,.99])};function YA(n,e){if(n)return typeof n=="function"&&xp()?XA(n,e):Fw(n)?Fh(n):Array.isArray(n)?n.map(t=>YA(t,e)||J0.easeOut):J0[n]}const ur={x:!1,y:!1};function ZA(){return ur.x||ur.y}function BL(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function QA(n,e){const t=BL(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function JT(n){return e=>{e.pointerType==="touch"||ZA()||n(e)}}function GL(n,e,t={}){const[i,r,s]=QA(n,t),o=JT(l=>{const{target:u}=l,h=e(l);if(typeof h!="function"||!u)return;const f=JT(p=>{h(p),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const JA=(n,e)=>e?n===e?!0:JA(n,e.parentElement):!1,Vw=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,WL=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function $L(n){return WL.has(n.tagName)||n.tabIndex!==-1}const Vh=new WeakSet;function eI(n){return e=>{e.key==="Enter"&&n(e)}}function W_(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const KL=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=eI(()=>{if(Vh.has(t))return;W_(t,"down");const r=eI(()=>{W_(t,"up")}),s=()=>W_(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function tI(n){return Vw(n)&&!ZA()}function HL(n,e,t={}){const[i,r,s]=QA(n,t),o=l=>{const u=l.currentTarget;if(!tI(l)||Vh.has(u))return;Vh.add(u);const h=e(l),f=(x,I)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",y),!(!tI(x)||!Vh.has(u))&&(Vh.delete(u),typeof h=="function"&&h(x,{success:I}))},p=x=>{f(x,t.useGlobalTarget||JA(u,x.target))},y=x=>{f(x,!1)};window.addEventListener("pointerup",p,r),window.addEventListener("pointercancel",y,r)};return i.forEach(l=>{!$L(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>KL(h,r),r)}),s}function XL(n){return n==="x"||n==="y"?ur[n]?null:(ur[n]=!0,()=>{ur[n]=!1}):ur.x||ur.y?null:(ur.x=ur.y=!0,()=>{ur.x=ur.y=!1})}const eP=new Set(["width","height","top","left","right","bottom",...Au]);let tp;function qL(){tp=void 0}const ns={now:()=>(tp===void 0&&ns.set(wn.isProcessing||WN.useManualTiming?wn.timestamp:performance.now()),tp),set:n=>{tp=n,queueMicrotask(qL)}};function jw(n,e){n.indexOf(e)===-1&&n.push(e)}function Uw(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class zw{constructor(){this.subscriptions=[]}add(e){return jw(this.subscriptions,e),()=>Uw(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function tP(n,e){return e?n*(1e3/e):0}const nI=30,YL=n=>!isNaN(parseFloat(n));class ZL{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=ns.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ns.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=YL(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new zw);const i=this.events[e].add(t);return e==="change"?()=>{i(),Et.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ns.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>nI)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,nI);return tP(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function gd(n,e){return new ZL(n,e)}function QL(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,gd(t))}function JL(n,e){const t=wm(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=hL(s[o]);QL(n,o,l)}}function eO(n){return!!(Ln(n)&&n.add)}function ev(n,e){const t=n.getValue("willChange");if(eO(t))return t.add(e)}function nP(n){return n.props[DA]}const iP=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,tO=1e-7,nO=12;function iO(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=iP(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>tO&&++l<nO);return o}function Kd(n,e,t,i){if(n===e&&t===i)return Ti;const r=s=>iO(s,0,1,n,t);return s=>s===0||s===1?s:iP(r(s),e,i)}const rP=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,sP=n=>e=>1-n(1-e),oP=Kd(.33,1.53,.69,.99),Bw=sP(oP),aP=rP(Bw),lP=n=>(n*=2)<1?.5*Bw(n):.5*(2-Math.pow(2,-10*(n-1))),Gw=n=>1-Math.sin(Math.acos(n)),cP=sP(Gw),uP=rP(Gw),hP=n=>/^0[^.\s]+$/u.test(n);function rO(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||hP(n):!0}const qh=n=>Math.round(n*1e5)/1e5,Ww=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function sO(n){return n==null}const oO=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,$w=(n,e)=>t=>!!(typeof t=="string"&&oO.test(t)&&t.startsWith(n)||e&&!sO(t)&&Object.prototype.hasOwnProperty.call(t,e)),dP=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(Ww);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},aO=n=>$s(0,255,n),$_={...Pu,transform:n=>Math.round(aO(n))},Ya={test:$w("rgb","red"),parse:dP("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+$_.transform(n)+", "+$_.transform(e)+", "+$_.transform(t)+", "+qh(fd.transform(i))+")"};function lO(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const tv={test:$w("#"),parse:lO,transform:Ya.transform},Uc={test:$w("hsl","hue"),parse:dP("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+ts.transform(qh(e))+", "+ts.transform(qh(t))+", "+qh(fd.transform(i))+")"},Mn={test:n=>Ya.test(n)||tv.test(n)||Uc.test(n),parse:n=>Ya.test(n)?Ya.parse(n):Uc.test(n)?Uc.parse(n):tv.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Ya.transform(n):Uc.transform(n)},cO=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function uO(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(Ww))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(cO))===null||t===void 0?void 0:t.length)||0)>0}const fP="number",gP="color",hO="var",dO="var(",iI="${}",fO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function pd(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(fO,u=>(Mn.test(u)?(i.color.push(s),r.push(gP),t.push(Mn.parse(u))):u.startsWith(dO)?(i.var.push(s),r.push(hO),t.push(u)):(i.number.push(s),r.push(fP),t.push(parseFloat(u))),++s,iI)).split(iI);return{values:t,split:l,indexes:i,types:r}}function pP(n){return pd(n).values}function mP(n){const{split:e,types:t}=pd(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===fP?s+=qh(r[o]):l===gP?s+=Mn.transform(r[o]):s+=r[o]}return s}}const gO=n=>typeof n=="number"?0:n;function pO(n){const e=pP(n);return mP(n)(e.map(gO))}const ea={test:uO,parse:pP,createTransformer:mP,getAnimatableNone:pO},mO=new Set(["brightness","contrast","saturate","opacity"]);function yO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(Ww)||[];if(!i)return n;const r=t.replace(i,"");let s=mO.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const _O=/\b([a-z-]*)\(.*?\)/gu,nv={...ea,getAnimatableNone:n=>{const e=n.match(_O);return e?e.map(yO).join(" "):n}},vO={...Pw,color:Mn,backgroundColor:Mn,outlineColor:Mn,fill:Mn,stroke:Mn,borderColor:Mn,borderTopColor:Mn,borderRightColor:Mn,borderBottomColor:Mn,borderLeftColor:Mn,filter:nv,WebkitFilter:nv},Kw=n=>vO[n];function yP(n,e){let t=Kw(n);return t!==nv&&(t=ea),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const wO=new Set(["auto","none","0"]);function xO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!wO.has(s)&&pd(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=yP(t,r)}const rI=n=>n===Pu||n===ke,sI=(n,e)=>parseFloat(n.split(", ")[e]),oI=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return sI(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?sI(s[1],n):0}},EO=new Set(["x","y","z"]),TO=Au.filter(n=>!EO.has(n));function IO(n){const e=[];return TO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const iu={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:oI(4,13),y:oI(5,14)};iu.translateX=iu.x;iu.translateY=iu.y;const rl=new Set;let iv=!1,rv=!1;function _P(){if(rv){const n=Array.from(rl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=IO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}rv=!1,iv=!1,rl.forEach(n=>n.complete()),rl.clear()}function vP(){rl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(rv=!0)})}function SO(){vP(),_P()}class Hw{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(rl.add(this),iv||(iv=!0,Et.read(vP),Et.resolveKeyframes(_P))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),rl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,rl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const wP=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),CO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function RO(n){const e=CO.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function xP(n,e,t=1){const[i,r]=RO(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return wP(o)?parseFloat(o):o}return Aw(r)?xP(r,e,t+1):r}const EP=n=>e=>e.test(n),AO={test:n=>n==="auto",parse:n=>n},TP=[Pu,ke,ts,Lo,yL,mL,AO],aI=n=>TP.find(EP(n));class IP extends Hw{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),Aw(h))){const f=xP(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!eP.has(i)||e.length!==2)return;const[r,s]=e,o=aI(r),l=aI(s);if(o!==l)if(rI(o)&&rI(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)rO(e[r])&&i.push(r);i.length&&xO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=iu[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=iu[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const lI=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ea.test(n)||n==="0")&&!n.startsWith("url("));function PO(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function bO(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=lI(r,e),l=lI(s,e);return!o||!l?!1:PO(n)||(t==="spring"||Ow(t))&&i}const kO=n=>n!==null;function xm(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(kO),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const DO=40;class SP{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ns.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>DO?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&SO(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ns.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:u,isGenerator:h}=this.options;if(!h&&!bO(e,i,r,s))if(o)this.options.duration=0;else{u&&u(xm(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const kt=(n,e,t)=>n+(e-n)*t;function K_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function MO({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;r=K_(u,l,n+1/3),s=K_(u,l,n),o=K_(u,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Ep(n,e){return t=>t>0?e:n}const H_=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},NO=[tv,Ya,Uc],LO=n=>NO.find(e=>e.test(n));function cI(n){const e=LO(n);if(!e)return!1;let t=e.parse(n);return e===Uc&&(t=MO(t)),t}const uI=(n,e)=>{const t=cI(n),i=cI(e);if(!t||!i)return Ep(n,e);const r={...t};return s=>(r.red=H_(t.red,i.red,s),r.green=H_(t.green,i.green,s),r.blue=H_(t.blue,i.blue,s),r.alpha=kt(t.alpha,i.alpha,s),Ya.transform(r))},OO=(n,e)=>t=>e(n(t)),Hd=(...n)=>n.reduce(OO),sv=new Set(["none","hidden"]);function FO(n,e){return sv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function VO(n,e){return t=>kt(n,e,t)}function Xw(n){return typeof n=="number"?VO:typeof n=="string"?Aw(n)?Ep:Mn.test(n)?uI:zO:Array.isArray(n)?CP:typeof n=="object"?Mn.test(n)?uI:jO:Ep}function CP(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>Xw(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function jO(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=Xw(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function UO(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],u=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const zO=(n,e)=>{const t=ea.createTransformer(e),i=pd(n),r=pd(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?sv.has(n)&&!r.values.length||sv.has(e)&&!i.values.length?FO(n,e):Hd(CP(UO(i,r),r.values),t):Ep(n,e)};function RP(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?kt(n,e,t):Xw(n)(n,e)}const BO=5;function AP(n,e,t){const i=Math.max(e-BO,0);return tP(t-n(i),e-i)}const Lt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},X_=.001;function GO({duration:n=Lt.duration,bounce:e=Lt.bounce,velocity:t=Lt.velocity,mass:i=Lt.mass}){let r,s,o=1-e;o=$s(Lt.minDamping,Lt.maxDamping,o),n=$s(Lt.minDuration,Lt.maxDuration,Us(n)),o<1?(r=h=>{const f=h*o,p=f*n,y=f-t,x=ov(h,o),I=Math.exp(-p);return X_-y/x*I},s=h=>{const p=h*o*n,y=p*t+t,x=Math.pow(o,2)*Math.pow(h,2)*n,I=Math.exp(-p),S=ov(Math.pow(h,2),o);return(-r(h)+X_>0?-1:1)*((y-x)*I)/S}):(r=h=>{const f=Math.exp(-h*n),p=(h-t)*n+1;return-X_+f*p},s=h=>{const f=Math.exp(-h*n),p=(t-h)*(n*n);return f*p});const l=5/n,u=$O(r,s,l);if(n=js(n),isNaN(u))return{stiffness:Lt.stiffness,damping:Lt.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const WO=12;function $O(n,e,t){let i=t;for(let r=1;r<WO;r++)i=i-n(i)/e(i);return i}function ov(n,e){return n*Math.sqrt(1-e*e)}const KO=["duration","bounce"],HO=["stiffness","damping","mass"];function hI(n,e){return e.some(t=>n[t]!==void 0)}function XO(n){let e={velocity:Lt.velocity,stiffness:Lt.stiffness,damping:Lt.damping,mass:Lt.mass,isResolvedFromDuration:!1,...n};if(!hI(n,HO)&&hI(n,KO))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*$s(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Lt.mass,stiffness:r,damping:s}}else{const t=GO(n);e={...e,...t,mass:Lt.mass},e.isResolvedFromDuration=!0}return e}function PP(n=Lt.visualDuration,e=Lt.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:p,velocity:y,isResolvedFromDuration:x}=XO({...t,velocity:-Us(t.velocity||0)}),I=y||0,S=h/(2*Math.sqrt(u*f)),T=o-s,P=Us(Math.sqrt(u/f)),M=Math.abs(T)<5;i||(i=M?Lt.restSpeed.granular:Lt.restSpeed.default),r||(r=M?Lt.restDelta.granular:Lt.restDelta.default);let k;if(S<1){const F=ov(P,S);k=G=>{const b=Math.exp(-S*P*G);return o-b*((I+S*P*T)/F*Math.sin(F*G)+T*Math.cos(F*G))}}else if(S===1)k=F=>o-Math.exp(-P*F)*(T+(I+P*T)*F);else{const F=P*Math.sqrt(S*S-1);k=G=>{const b=Math.exp(-S*P*G),R=Math.min(F*G,300);return o-b*((I+S*P*T)*Math.sinh(R)+F*T*Math.cosh(R))/F}}const O={calculatedDuration:x&&p||null,next:F=>{const G=k(F);if(x)l.done=F>=p;else{let b=0;S<1&&(b=F===0?js(I):AP(k,F,G));const R=Math.abs(b)<=i,D=Math.abs(o-G)<=r;l.done=R&&D}return l.value=l.done?o:G,l},toString:()=>{const F=Math.min(HA(O),Q0),G=XA(b=>O.next(F*b).value,F,30);return F+"ms "+G}};return O}function dI({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:f}){const p=n[0],y={done:!1,value:p},x=R=>l!==void 0&&R<l||u!==void 0&&R>u,I=R=>l===void 0?u:u===void 0||Math.abs(l-R)<Math.abs(u-R)?l:u;let S=t*e;const T=p+S,P=o===void 0?T:o(T);P!==T&&(S=P-p);const M=R=>-S*Math.exp(-R/i),k=R=>P+M(R),O=R=>{const D=M(R),V=k(R);y.done=Math.abs(D)<=h,y.value=y.done?P:V};let F,G;const b=R=>{x(y.value)&&(F=R,G=PP({keyframes:[y.value,I(y.value)],velocity:AP(k,R,y.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return b(0),{calculatedDuration:null,next:R=>{let D=!1;return!G&&F===void 0&&(D=!0,O(R),b(R)),F!==void 0&&R>=F?G.next(R-F):(!D&&O(R),y)}}}const qO=Kd(.42,0,1,1),YO=Kd(0,0,.58,1),bP=Kd(.42,0,.58,1),ZO=n=>Array.isArray(n)&&typeof n[0]!="number",QO={linear:Ti,easeIn:qO,easeInOut:bP,easeOut:YO,circIn:Gw,circInOut:uP,circOut:cP,backIn:Bw,backInOut:aP,backOut:oP,anticipate:lP},fI=n=>{if(Fw(n)){RA(n.length===4);const[e,t,i,r]=n;return Kd(e,t,i,r)}else if(typeof n=="string")return QO[n];return n};function JO(n,e,t){const i=[],r=t||RP,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ti:e;l=Hd(u,l)}i.push(l)}return i}function eF(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(RA(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=JO(e,i,r),u=l.length,h=f=>{if(o&&f<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(f<n[p+1]);p++);const y=tu(n[p],n[p+1],f);return l[p](y)};return t?f=>h($s(n[0],n[s-1],f)):h}function tF(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=tu(0,e,i);n.push(kt(t,1,r))}}function nF(n){const e=[0];return tF(e,n.length-1),e}function iF(n,e){return n.map(t=>t*e)}function rF(n,e){return n.map(()=>e||bP).splice(0,n.length-1)}function Tp({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=ZO(i)?i.map(fI):fI(i),s={done:!1,value:e[0]},o=iF(t&&t.length===e.length?t:nF(e),n),l=eF(o,e,{ease:Array.isArray(r)?r:rF(e,r)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const sF=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Et.update(e,!0),stop:()=>Jo(e),now:()=>wn.isProcessing?wn.timestamp:ns.now()}},oF={decay:dI,inertia:dI,tween:Tp,keyframes:Tp,spring:PP},aF=n=>n/100;class qw extends SP{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||Hw,l=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=Ow(t)?t:oF[t]||Tp;let u,h;l!==Tp&&typeof e[0]!="number"&&(u=Hd(aF,RP(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=HA(f));const{calculatedDuration:p}=f,y=p+r,x=y*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:p,resolvedDuration:y,totalDuration:x}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:R}=this.options;return{done:!0,value:R[R.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:p}=i;if(this.startTime===null)return s.next(0);const{delay:y,repeat:x,repeatType:I,repeatDelay:S,onUpdate:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const P=this.currentTime-y*(this.speed>=0?1:-1),M=this.speed>=0?P<0:P>f;this.currentTime=Math.max(P,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let k=this.currentTime,O=s;if(x){const R=Math.min(this.currentTime,f)/p;let D=Math.floor(R),V=R%1;!V&&R>=1&&(V=1),V===1&&D--,D=Math.min(D,x+1),D%2&&(I==="reverse"?(V=1-V,S&&(V-=S/p)):I==="mirror"&&(O=o)),k=$s(0,1,V)*p}const F=M?{done:!1,value:u[0]}:O.next(k);l&&(F.value=l(F.value));let{done:G}=F;!M&&h!==null&&(G=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const b=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&G);return b&&r!==void 0&&(F.value=xm(u,this.options,r)),T&&T(F.value),b&&this.finish(),F}get duration(){const{resolved:e}=this;return e?Us(e.calculatedDuration):0}get time(){return Us(this.currentTime)}set time(e){e=js(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Us(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=sF,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const lF=new Set(["opacity","clipPath","filter","transform"]);function cF(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=YA(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const uF=xw(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Ip=10,hF=2e4;function dF(n){return Ow(n.type)||n.type==="spring"||!qA(n.ease)}function fF(n,e){const t=new qw({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<hF;)i=t.sample(s),r.push(i.value),s+=Ip;return{times:void 0,keyframes:r,duration:s-Ip,ease:"linear"}}const kP={anticipate:lP,backInOut:aP,circInOut:uP};function gF(n){return n in kP}class gI extends SP{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new IP(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:u,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&xp()&&gF(s)&&(s=kP[s]),dF(this.options)){const{onComplete:p,onUpdate:y,motionValue:x,element:I,...S}=this.options,T=fF(e,S);e=T.keyframes,e.length===1&&(e[1]=e[0]),i=T.duration,r=T.times,s=T.ease,o="keyframes"}const f=cF(l.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(QT(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:p}=this.options;l.set(xm(e,this.options,t)),p&&p(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Us(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Us(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=js(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Ti;const{animation:i}=t;QT(i,e)}return Ti}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:p,element:y,...x}=this.options,I=new qw({...x,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),S=js(this.time);h.setWithVelocity(I.sample(S-Ip).value,I.sample(S).value,Ip)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return uF()&&i&&lF.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const pF={type:"spring",stiffness:500,damping:25,restSpeed:10},mF=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),yF={type:"keyframes",duration:.8},_F={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},vF=(n,{keyframes:e})=>e.length>2?yF:Pl.has(n)?n.startsWith("scale")?mF(e[1]):pF:_F;function wF({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const Yw=(n,e,t,i={},r,s)=>o=>{const l=Lw(i,n)||{},u=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-js(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:y=>{e.set(y),l.onUpdate&&l.onUpdate(y)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};wF(l)||(f={...f,...vF(n,f)}),f.duration&&(f.duration=js(f.duration)),f.repeatDelay&&(f.repeatDelay=js(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(p=!0)),p&&!s&&e.get()!==void 0){const y=xm(f.keyframes,l);if(y!==void 0)return Et.update(()=>{f.onUpdate(y),f.onComplete()}),new jL([])}return!s&&gI.supports(f)?new gI(f):new qw(f)};function xF({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function DP(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...u}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const p in u){const y=n.getValue(p,(s=n.latestValues[p])!==null&&s!==void 0?s:null),x=u[p];if(x===void 0||f&&xF(f,p))continue;const I={delay:t,...Lw(o||{},p)};let S=!1;if(window.MotionHandoffAnimation){const P=nP(n);if(P){const M=window.MotionHandoffAnimation(P,p,Et);M!==null&&(I.startTime=M,S=!0)}}ev(n,p),y.start(Yw(p,y,x,n.shouldReduceMotion&&eP.has(p)?{type:!1}:I,n,S));const T=y.animation;T&&h.push(T)}return l&&Promise.all(h).then(()=>{Et.update(()=>{l&&JL(n,l)})}),h}function av(n,e,t={}){var i;const r=wm(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(DP(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:p,staggerDirection:y}=s;return EF(n,e,f+h,p,y,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function EF(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(TF).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(av(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function TF(n,e){return n.sortNodePosition(e)}function IF(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>av(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=av(n,e,t);else{const r=typeof e=="function"?wm(n,e,t.custom):e;i=Promise.all(DP(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const SF=Tw.length;function MP(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?MP(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<SF;t++){const i=Tw[t],r=n.props[i];(dd(r)||r===!1)&&(e[i]=r)}return e}const CF=[...Ew].reverse(),RF=Ew.length;function AF(n){return e=>Promise.all(e.map(({animation:t,options:i})=>IF(n,t,i)))}function PF(n){let e=AF(n),t=pI(),i=!0;const r=u=>(h,f)=>{var p;const y=wm(n,f,u==="exit"?(p=n.presenceContext)===null||p===void 0?void 0:p.custom:void 0);if(y){const{transition:x,transitionEnd:I,...S}=y;h={...h,...S,...I}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,f=MP(n.parent)||{},p=[],y=new Set;let x={},I=1/0;for(let T=0;T<RF;T++){const P=CF[T],M=t[P],k=h[P]!==void 0?h[P]:f[P],O=dd(k),F=P===u?M.isActive:null;F===!1&&(I=T);let G=k===f[P]&&k!==h[P]&&O;if(G&&i&&n.manuallyAnimateOnMount&&(G=!1),M.protectedKeys={...x},!M.isActive&&F===null||!k&&!M.prevProp||_m(k)||typeof k=="boolean")continue;const b=bF(M.prevProp,k);let R=b||P===u&&M.isActive&&!G&&O||T>I&&O,D=!1;const V=Array.isArray(k)?k:[k];let j=V.reduce(r(P),{});F===!1&&(j={});const{prevResolvedValues:z={}}=M,N={...z,...j},se=ue=>{R=!0,y.has(ue)&&(D=!0,y.delete(ue)),M.needsAnimating[ue]=!0;const Z=n.getValue(ue);Z&&(Z.liveStyle=!1)};for(const ue in N){const Z=j[ue],le=z[ue];if(x.hasOwnProperty(ue))continue;let ie=!1;Z0(Z)&&Z0(le)?ie=!KA(Z,le):ie=Z!==le,ie?Z!=null?se(ue):y.add(ue):Z!==void 0&&y.has(ue)?se(ue):M.protectedKeys[ue]=!0}M.prevProp=k,M.prevResolvedValues=j,M.isActive&&(x={...x,...j}),i&&n.blockInitialAnimation&&(R=!1),R&&(!(G&&b)||D)&&p.push(...V.map(ue=>({animation:ue,options:{type:P}})))}if(y.size){const T={};y.forEach(P=>{const M=n.getBaseTarget(P),k=n.getValue(P);k&&(k.liveStyle=!0),T[P]=M??null}),p.push({animation:T})}let S=!!p.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(S=!1),i=!1,S?e(p):Promise.resolve()}function l(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(y=>{var x;return(x=y.animationState)===null||x===void 0?void 0:x.setActive(u,h)}),t[u].isActive=h;const p=o(u);for(const y in t)t[y].protectedKeys={};return p}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=pI(),i=!0}}}function bF(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!KA(e,n):!1}function Na(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function pI(){return{animate:Na(!0),whileInView:Na(),whileHover:Na(),whileTap:Na(),whileDrag:Na(),whileFocus:Na(),exit:Na()}}let oa=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class kF extends oa{constructor(e){super(e),e.animationState||(e.animationState=PF(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();_m(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let DF=0;class MF extends oa{constructor(){super(...arguments),this.id=DF++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const NF={animation:{Feature:kF},exit:{Feature:MF}};function md(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function Xd(n){return{point:{x:n.pageX,y:n.pageY}}}const LF=n=>e=>Vw(e)&&n(e,Xd(e));function Yh(n,e,t,i){return md(n,e,LF(t),i)}const mI=(n,e)=>Math.abs(n-e);function OF(n,e){const t=mI(n.x,e.x),i=mI(n.y,e.y);return Math.sqrt(t**2+i**2)}class NP{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=Y_(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,x=OF(p.offset,{x:0,y:0})>=3;if(!y&&!x)return;const{point:I}=p,{timestamp:S}=wn;this.history.push({...I,timestamp:S});const{onStart:T,onMove:P}=this.handlers;y||(T&&T(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),P&&P(this.lastMoveEvent,p)},this.handlePointerMove=(p,y)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=q_(y,this.transformPagePoint),Et.update(this.updatePoint,!0)},this.handlePointerUp=(p,y)=>{this.end();const{onEnd:x,onSessionEnd:I,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=Y_(p.type==="pointercancel"?this.lastMoveEventInfo:q_(y,this.transformPagePoint),this.history);this.startEvent&&x&&x(p,T),I&&I(p,T)},!Vw(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=Xd(e),l=q_(o,this.transformPagePoint),{point:u}=l,{timestamp:h}=wn;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,Y_(l,this.history)),this.removeListeners=Hd(Yh(this.contextWindow,"pointermove",this.handlePointerMove),Yh(this.contextWindow,"pointerup",this.handlePointerUp),Yh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Jo(this.updatePoint)}}function q_(n,e){return e?{point:e(n.point)}:n}function yI(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Y_({point:n},e){return{point:n,delta:yI(n,LP(e)),offset:yI(n,FF(e)),velocity:VF(e,.1)}}function FF(n){return n[0]}function LP(n){return n[n.length-1]}function VF(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=LP(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>js(e)));)t--;if(!i)return{x:0,y:0};const s=Us(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const OP=1e-4,jF=1-OP,UF=1+OP,FP=.01,zF=0-FP,BF=0+FP;function Ii(n){return n.max-n.min}function GF(n,e,t){return Math.abs(n-e)<=t}function _I(n,e,t,i=.5){n.origin=i,n.originPoint=kt(e.min,e.max,n.origin),n.scale=Ii(t)/Ii(e),n.translate=kt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=jF&&n.scale<=UF||isNaN(n.scale))&&(n.scale=1),(n.translate>=zF&&n.translate<=BF||isNaN(n.translate))&&(n.translate=0)}function Zh(n,e,t,i){_I(n.x,e.x,t.x,i?i.originX:void 0),_I(n.y,e.y,t.y,i?i.originY:void 0)}function vI(n,e,t){n.min=t.min+e.min,n.max=n.min+Ii(e)}function WF(n,e,t){vI(n.x,e.x,t.x),vI(n.y,e.y,t.y)}function wI(n,e,t){n.min=e.min-t.min,n.max=n.min+Ii(e)}function Qh(n,e,t){wI(n.x,e.x,t.x),wI(n.y,e.y,t.y)}function $F(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?kt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?kt(t,n,i.max):Math.min(n,t)),n}function xI(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function KF(n,{top:e,left:t,bottom:i,right:r}){return{x:xI(n.x,t,r),y:xI(n.y,e,i)}}function EI(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function HF(n,e){return{x:EI(n.x,e.x),y:EI(n.y,e.y)}}function XF(n,e){let t=.5;const i=Ii(n),r=Ii(e);return r>i?t=tu(e.min,e.max-i,n.min):i>r&&(t=tu(n.min,n.max-r,e.min)),$s(0,1,t)}function qF(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const lv=.35;function YF(n=lv){return n===!1?n=0:n===!0&&(n=lv),{x:TI(n,"left","right"),y:TI(n,"top","bottom")}}function TI(n,e,t){return{min:II(n,e),max:II(n,t)}}function II(n,e){return typeof n=="number"?n:n[e]||0}const SI=()=>({translate:0,scale:1,origin:0,originPoint:0}),zc=()=>({x:SI(),y:SI()}),CI=()=>({min:0,max:0}),Ut=()=>({x:CI(),y:CI()});function Gi(n){return[n("x"),n("y")]}function VP({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function ZF({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function QF(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function Z_(n){return n===void 0||n===1}function cv({scale:n,scaleX:e,scaleY:t}){return!Z_(n)||!Z_(e)||!Z_(t)}function Va(n){return cv(n)||jP(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function jP(n){return RI(n.x)||RI(n.y)}function RI(n){return n&&n!=="0%"}function Sp(n,e,t){const i=n-t,r=e*i;return t+r}function AI(n,e,t,i,r){return r!==void 0&&(n=Sp(n,r,i)),Sp(n,t,i)+e}function uv(n,e=0,t=1,i,r){n.min=AI(n.min,e,t,i,r),n.max=AI(n.max,e,t,i,r)}function UP(n,{x:e,y:t}){uv(n.x,e.translate,e.scale,e.originPoint),uv(n.y,t.translate,t.scale,t.originPoint)}const PI=.999999999999,bI=1.0000000000001;function JF(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Gc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,UP(n,o)),i&&Va(s.latestValues)&&Gc(n,s.latestValues))}e.x<bI&&e.x>PI&&(e.x=1),e.y<bI&&e.y>PI&&(e.y=1)}function Bc(n,e){n.min=n.min+e,n.max=n.max+e}function kI(n,e,t,i,r=.5){const s=kt(n.min,n.max,r);uv(n,e,t,s,i)}function Gc(n,e){kI(n.x,e.x,e.scaleX,e.scale,e.originX),kI(n.y,e.y,e.scaleY,e.scale,e.originY)}function zP(n,e){return VP(QF(n.getBoundingClientRect(),e))}function eV(n,e,t){const i=zP(n,t),{scroll:r}=e;return r&&(Bc(i.x,r.offset.x),Bc(i.y,r.offset.y)),i}const BP=({current:n})=>n?n.ownerDocument.defaultView:null,tV=new WeakMap;class nV{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Xd(f).point)},s=(f,p)=>{const{drag:y,dragPropagation:x,onDragStart:I}=this.getProps();if(y&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=XL(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Gi(T=>{let P=this.getAxisMotionValue(T).get()||0;if(ts.test(P)){const{projection:M}=this.visualElement;if(M&&M.layout){const k=M.layout.layoutBox[T];k&&(P=Ii(k)*(parseFloat(P)/100))}}this.originPoint[T]=P}),I&&Et.postRender(()=>I(f,p)),ev(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},o=(f,p)=>{const{dragPropagation:y,dragDirectionLock:x,onDirectionLock:I,onDrag:S}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:T}=p;if(x&&this.currentDirection===null){this.currentDirection=iV(T),this.currentDirection!==null&&I&&I(this.currentDirection);return}this.updateAxis("x",p.point,T),this.updateAxis("y",p.point,T),this.visualElement.render(),S&&S(f,p)},l=(f,p)=>this.stop(f,p),u=()=>Gi(f=>{var p;return this.getAnimationState(f)==="paused"&&((p=this.getAxisMotionValue(f).animation)===null||p===void 0?void 0:p.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new NP(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:BP(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Et.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Ag(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=$F(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&jc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=KF(r.layoutBox,t):this.constraints=!1,this.elastic=YF(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Gi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=qF(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!jc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=eV(i,r.root,this.visualElement.getTransformPagePoint());let o=HF(r.layout.layoutBox,s);if(t){const l=t(ZF(o));this.hasMutatedConstraints=!!l,l&&(o=VP(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=Gi(f=>{if(!Ag(f,t,this.currentDirection))return;let p=u&&u[f]||{};o&&(p={min:0,max:0});const y=r?200:1e6,x=r?40:1e7,I={type:"inertia",velocity:i?e[f]:0,bounceStiffness:y,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...s,...p};return this.startAxisValueAnimation(f,I)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return ev(this.visualElement,e),i.start(Yw(e,i,0,t,this.visualElement,!1))}stopAnimation(){Gi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Gi(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Gi(t=>{const{drag:i}=this.getProps();if(!Ag(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-kt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!jc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Gi(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();r[o]=XF({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Gi(o=>{if(!Ag(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(kt(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;tV.set(this.visualElement,this);const e=this.visualElement.current,t=Yh(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();jc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Et.read(i);const o=md(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(Gi(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=u[f].translate,p.set(p.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=lv,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function Ag(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function iV(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class rV extends oa{constructor(e){super(e),this.removeGroupControls=Ti,this.removeListeners=Ti,this.controls=new nV(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ti}unmount(){this.removeGroupControls(),this.removeListeners()}}const DI=n=>(e,t)=>{n&&Et.postRender(()=>n(e,t))};class sV extends oa{constructor(){super(...arguments),this.removePointerDownListener=Ti}onPointerDown(e){this.session=new NP(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:BP(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:DI(e),onStart:DI(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Et.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Yh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const np={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function MI(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Ih={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(ke.test(n))n=parseFloat(n);else return n;const t=MI(n,e.target.x),i=MI(n,e.target.y);return`${t}% ${i}%`}},oV={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=ea.parse(n);if(r.length>5)return i;const s=ea.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=u;const h=kt(l,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class aV extends J.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;RL(lV),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),np.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Et.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Sw.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function GP(n){const[e,t]=SA(),i=J.useContext(yw);return E.jsx(aV,{...n,layoutGroup:i,switchLayoutGroup:J.useContext(MA),isPresent:e,safeToRemove:t})}const lV={borderRadius:{...Ih,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ih,borderTopRightRadius:Ih,borderBottomLeftRadius:Ih,borderBottomRightRadius:Ih,boxShadow:oV};function cV(n,e,t){const i=Ln(n)?n:gd(n);return i.start(Yw("",i,e,t)),i.animation}function uV(n){return n instanceof SVGElement&&n.tagName!=="svg"}const hV=(n,e)=>n.depth-e.depth;class dV{constructor(){this.children=[],this.isDirty=!1}add(e){jw(this.children,e),this.isDirty=!0}remove(e){Uw(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(hV),this.isDirty=!1,this.children.forEach(e)}}function fV(n,e){const t=ns.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Jo(i),n(s-e))};return Et.read(i,!0),()=>Jo(i)}const WP=["TopLeft","TopRight","BottomLeft","BottomRight"],gV=WP.length,NI=n=>typeof n=="string"?parseFloat(n):n,LI=n=>typeof n=="number"||ke.test(n);function pV(n,e,t,i,r,s){r?(n.opacity=kt(0,t.opacity!==void 0?t.opacity:1,mV(i)),n.opacityExit=kt(e.opacity!==void 0?e.opacity:1,0,yV(i))):s&&(n.opacity=kt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<gV;o++){const l=`border${WP[o]}Radius`;let u=OI(e,l),h=OI(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||LI(u)===LI(h)?(n[l]=Math.max(kt(NI(u),NI(h),i),0),(ts.test(h)||ts.test(u))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=kt(e.rotate||0,t.rotate||0,i))}function OI(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const mV=$P(0,.5,cP),yV=$P(.5,.95,Ti);function $P(n,e,t){return i=>i<n?0:i>e?1:t(tu(n,e,i))}function FI(n,e){n.min=e.min,n.max=e.max}function zi(n,e){FI(n.x,e.x),FI(n.y,e.y)}function VI(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function jI(n,e,t,i,r){return n-=e,n=Sp(n,1/t,i),r!==void 0&&(n=Sp(n,1/r,i)),n}function _V(n,e=0,t=1,i=.5,r,s=n,o=n){if(ts.test(e)&&(e=parseFloat(e),e=kt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=kt(s.min,s.max,i);n===s&&(l-=e),n.min=jI(n.min,e,t,l,r),n.max=jI(n.max,e,t,l,r)}function UI(n,e,[t,i,r],s,o){_V(n,e[t],e[i],e[r],e.scale,s,o)}const vV=["x","scaleX","originX"],wV=["y","scaleY","originY"];function zI(n,e,t,i){UI(n.x,e,vV,t?t.x:void 0,i?i.x:void 0),UI(n.y,e,wV,t?t.y:void 0,i?i.y:void 0)}function BI(n){return n.translate===0&&n.scale===1}function KP(n){return BI(n.x)&&BI(n.y)}function GI(n,e){return n.min===e.min&&n.max===e.max}function xV(n,e){return GI(n.x,e.x)&&GI(n.y,e.y)}function WI(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function HP(n,e){return WI(n.x,e.x)&&WI(n.y,e.y)}function $I(n){return Ii(n.x)/Ii(n.y)}function KI(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class EV{constructor(){this.members=[]}add(e){jw(this.members,e),e.scheduleRender()}remove(e){if(Uw(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function TV(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:p,rotateY:y,skewX:x,skewY:I}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),p&&(i+=`rotateX(${p}deg) `),y&&(i+=`rotateY(${y}deg) `),x&&(i+=`skewX(${x}deg) `),I&&(i+=`skewY(${I}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(i+=`scale(${l}, ${u})`),i||"none"}const ja={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},jh=typeof window<"u"&&window.MotionDebug!==void 0,Q_=["","X","Y","Z"],IV={visibility:"hidden"},HI=1e3;let SV=0;function J_(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function XP(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=nP(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Et,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&XP(i)}function qP({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=SV++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,jh&&(ja.totalNodes=ja.resolvedTargetDeltas=ja.recalculatedProjection=0),this.nodes.forEach(AV),this.nodes.forEach(MV),this.nodes.forEach(NV),this.nodes.forEach(PV),jh&&window.MotionDebug.record(ja)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new dV)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new zw),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=uV(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||u)&&(this.isLayoutDirty=!0),n){let p;const y=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=fV(y,250),np.hasAnimatedSinceResize&&(np.hasAnimatedSinceResize=!1,this.nodes.forEach(qI))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:y,hasRelativeTargetChanged:x,layout:I})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const S=this.options.transition||f.getDefaultTransition()||jV,{onLayoutAnimationStart:T,onLayoutAnimationComplete:P}=f.getProps(),M=!this.targetLayout||!HP(this.targetLayout,I)||x,k=!y&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||k||y&&(M||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,k);const O={...Lw(S,"layout"),onPlay:T,onComplete:P};(f.shouldReduceMotion||this.options.layoutRoot)&&(O.delay=0,O.type=!1),this.startAnimation(O)}else y||qI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=I})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Jo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(LV),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&XP(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(XI);return}this.isUpdating||this.nodes.forEach(kV),this.isUpdating=!1,this.nodes.forEach(DV),this.nodes.forEach(CV),this.nodes.forEach(RV),this.clearAllSnapshots();const l=ns.now();wn.delta=$s(0,1e3/60,l-wn.timestamp),wn.timestamp=l,wn.isProcessing=!0,G_.update.process(wn),G_.preRender.process(wn),G_.render.process(wn),wn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Sw.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(bV),this.sharedNodes.forEach(OV)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Et.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Et.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!KP(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||Va(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),UV(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(zV))){const{scroll:f}=this.root;f&&(Bc(u.x,f.offset.x),Bc(u.y,f.offset.y))}return u}removeElementScroll(o){var l;const u=Ut();if(zi(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:p,options:y}=f;f!==this.root&&p&&y.layoutScroll&&(p.wasRoot&&zi(u,o),Bc(u.x,p.offset.x),Bc(u.y,p.offset.y))}return u}applyTransform(o,l=!1){const u=Ut();zi(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Gc(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Va(f.latestValues)&&Gc(u,f.latestValues)}return Va(this.latestValues)&&Gc(u,this.latestValues),u}removeTransform(o){const l=Ut();zi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Va(h.latestValues))continue;cv(h.latestValues)&&h.updateSnapshot();const f=Ut(),p=h.measurePageBox();zi(f,p),zI(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return Va(this.latestValues)&&zI(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==wn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:y}=this.options;if(!(!this.layout||!(p||y))){if(this.resolvedRelativeTargetAt=wn.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Qh(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),zi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),WF(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):zi(this.target,this.layout.layoutBox),UP(this.target,this.targetDelta)):zi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Qh(this.relativeTargetOrigin,this.target,x.target),zi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}jh&&ja.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||cv(this.parent.latestValues)||jP(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===wn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;zi(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,x=this.treeScale.y;JF(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:I}=l;if(!I){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(VI(this.prevProjectionDelta.x,this.projectionDelta.x),VI(this.prevProjectionDelta.y,this.projectionDelta.y)),Zh(this.projectionDelta,this.layoutCorrected,I,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==x||!KI(this.projectionDelta.x,this.prevProjectionDelta.x)||!KI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",I)),jh&&ja.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=zc(),this.projectionDelta=zc(),this.projectionDeltaWithTransform=zc()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},p=zc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const y=Ut(),x=u?u.source:void 0,I=this.layout?this.layout.source:void 0,S=x!==I,T=this.getStack(),P=!T||T.members.length<=1,M=!!(S&&!P&&this.options.crossfade===!0&&!this.path.some(VV));this.animationProgress=0;let k;this.mixTargetDelta=O=>{const F=O/1e3;YI(p.x,o.x,F),YI(p.y,o.y,F),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Qh(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),FV(this.relativeTarget,this.relativeTargetOrigin,y,F),k&&xV(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=Ut()),zi(k,this.relativeTarget)),S&&(this.animationValues=f,pV(f,h,this.latestValues,F,M,P)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Jo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Et.update(()=>{np.hasAnimatedSinceResize=!0,this.currentAnimation=cV(0,HI,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(HI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:f}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&YP(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Ut();const p=Ii(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const y=Ii(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+y}zi(l,u),Gc(l,f),Zh(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new EV),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&J_("z",o,h,this.animationValues);for(let f=0;f<Q_.length;f++)J_(`rotate${Q_[f]}`,o,h,this.animationValues),J_(`skew${Q_[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return IV;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=ep(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const S={};return this.options.layoutId&&(S.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,S.pointerEvents=ep(o?.pointerEvents)||""),this.hasProjected&&!Va(this.latestValues)&&(S.transform=f?f({},""):"none",this.hasProjected=!1),S}const y=p.animationValues||p.latestValues;this.applyTransformsToTarget(),h.transform=TV(this.projectionDeltaWithTransform,this.treeScale,y),f&&(h.transform=f(y,h.transform));const{x,y:I}=this.projectionDelta;h.transformOrigin=`${x.origin*100}% ${I.origin*100}% 0`,p.animationValues?h.opacity=p===this?(u=(l=y.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:h.opacity=p===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const S in wp){if(y[S]===void 0)continue;const{correct:T,applyTo:P}=wp[S],M=h.transform==="none"?y[S]:T(y[S],p);if(P){const k=P.length;for(let O=0;O<k;O++)h[P[O]]=M}else h[S]=M}return this.options.layoutId&&(h.pointerEvents=p===this?ep(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(XI),this.root.sharedNodes.clear()}}}function CV(n){n.updateLayout()}function RV(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?Gi(p=>{const y=o?t.measuredBox[p]:t.layoutBox[p],x=Ii(y);y.min=i[p].min,y.max=y.min+x}):YP(s,t.layoutBox,i)&&Gi(p=>{const y=o?t.measuredBox[p]:t.layoutBox[p],x=Ii(i[p]);y.max=y.min+x,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[p].max=n.relativeTarget[p].min+x)});const l=zc();Zh(l,i,t.layoutBox);const u=zc();o?Zh(u,n.applyTransform(r,!0),t.measuredBox):Zh(u,i,t.layoutBox);const h=!KP(l);let f=!1;if(!n.resumeFrom){const p=n.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:y,layout:x}=p;if(y&&x){const I=Ut();Qh(I,t.layoutBox,y.layoutBox);const S=Ut();Qh(S,i,x.layoutBox),HP(I,S)||(f=!0),p.options.layoutRoot&&(n.relativeTarget=S,n.relativeTargetOrigin=I,n.relativeParent=p)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function AV(n){jh&&ja.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function PV(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function bV(n){n.clearSnapshot()}function XI(n){n.clearMeasurements()}function kV(n){n.isLayoutDirty=!1}function DV(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function qI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function MV(n){n.resolveTargetDelta()}function NV(n){n.calcProjection()}function LV(n){n.resetSkewAndRotation()}function OV(n){n.removeLeadSnapshot()}function YI(n,e,t){n.translate=kt(e.translate,0,t),n.scale=kt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function ZI(n,e,t,i){n.min=kt(e.min,t.min,i),n.max=kt(e.max,t.max,i)}function FV(n,e,t,i){ZI(n.x,e.x,t.x,i),ZI(n.y,e.y,t.y,i)}function VV(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const jV={duration:.45,ease:[.4,0,.1,1]},QI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),JI=QI("applewebkit/")&&!QI("chrome/")?Math.round:Ti;function eS(n){n.min=JI(n.min),n.max=JI(n.max)}function UV(n){eS(n.x),eS(n.y)}function YP(n,e,t){return n==="position"||n==="preserve-aspect"&&!GF($I(e),$I(t),.2)}function zV(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const BV=qP({attachResizeListener:(n,e)=>md(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),e0={current:void 0},ZP=qP({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!e0.current){const n=new BV({});n.mount(window),n.setOptions({layoutScroll:!0}),e0.current=n}return e0.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),GV={pan:{Feature:sV},drag:{Feature:rV,ProjectionNode:ZP,MeasureLayout:GP}};function tS(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Et.postRender(()=>s(e,Xd(e)))}class WV extends oa{mount(){const{current:e}=this.node;e&&(this.unmount=GL(e,t=>(tS(this.node,t,"Start"),i=>tS(this.node,i,"End"))))}unmount(){}}class $V extends oa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Hd(md(this.node.current,"focus",()=>this.onFocus()),md(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function nS(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Et.postRender(()=>s(e,Xd(e)))}class KV extends oa{mount(){const{current:e}=this.node;e&&(this.unmount=HL(e,t=>(nS(this.node,t,"Start"),(i,{success:r})=>nS(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const hv=new WeakMap,t0=new WeakMap,HV=n=>{const e=hv.get(n.target);e&&e(n)},XV=n=>{n.forEach(HV)};function qV({root:n,...e}){const t=n||document;t0.has(t)||t0.set(t,{});const i=t0.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(XV,{root:n,...e})),i[r]}function YV(n,e,t){const i=qV(e);return hv.set(n,t),i.observe(n),()=>{hv.delete(n),i.unobserve(n)}}const ZV={some:0,all:1};class QV extends oa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:ZV[r]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),y=h?f:p;y&&y(u)};return YV(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(JV(e,t))&&this.startObserver()}unmount(){}}function JV({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const e3={inView:{Feature:QV},tap:{Feature:KV},focus:{Feature:$V},hover:{Feature:WV}},t3={layout:{ProjectionNode:ZP,MeasureLayout:GP}},dv={current:null},QP={current:!1};function n3(){if(QP.current=!0,!!ww)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>dv.current=n.matches;n.addListener(e),e()}else dv.current=!1}const i3=[...TP,Mn,ea],r3=n=>i3.find(EP(n)),iS=new WeakMap;function s3(n,e,t){for(const i in e){const r=e[i],s=t[i];if(Ln(r))n.addValue(i,r);else if(Ln(s))n.addValue(i,gd(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,gd(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const rS=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class o3{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Hw,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=ns.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,Et.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=vm(t),this.isVariantNode=kA(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,...y}=this.scrapeMotionValuesFromProps(t,{},this);for(const x in y){const I=y[x];u[x]!==void 0&&Ln(I)&&I.set(u[x],!1)}}mount(e){this.current=e,iS.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),QP.current||n3(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:dv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){iS.delete(this.current),this.projection&&this.projection.unmount(),Jo(this.notifyUpdate),Jo(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Pl.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Et.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in nu){const t=nu[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<rS.length;i++){const r=rS[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=s3(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=gd(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(wP(r)||hP(r))?r=parseFloat(r):!r3(r)&&ea.test(t)&&(r=yP(e,t)),this.setBaseTarget(e,Ln(r)?r.get():r)),Ln(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=Rw(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ln(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new zw),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class JP extends o3{constructor(){super(...arguments),this.KeyframeResolver=IP}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ln(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function a3(n){return window.getComputedStyle(n)}class l3 extends JP{constructor(){super(...arguments),this.type="html",this.renderInstance=UA}readValueFromInstance(e,t){if(Pl.has(t)){const i=Kw(t);return i&&i.default||0}else{const i=a3(e),r=(FA(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return zP(e,t)}build(e,t,i){bw(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return Nw(e,t,i)}}class c3 extends JP{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Pl.has(t)){const i=Kw(t);return i&&i.default||0}return t=zA.has(t)?t:Iw(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return WA(e,t,i)}build(e,t,i){kw(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){BA(e,t,i,r)}mount(e){this.isSVGTag=Mw(e.tagName),super.mount(e)}}const u3=(n,e)=>Cw(n)?new c3(e):new l3(e,{allowProjection:n!==J.Fragment}),h3=OL({...NF,...e3,...GV,...t3},u3),Je=ZN(h3),ei={ADD:"add",REMOVE:"remove"},ru={PROPERTYCHANGE:"propertychange"},ze={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Em{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function d3(n,e,t){let i,r;t=t||zs;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function zs(n,e){return n>e?1:n<e?-1:0}function f3(n,e){return n<e?1:n>e?-1:0}function Zw(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function g3(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function Qw(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function aa(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function p3(n,e,t){const i=e||zs;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function yd(){return!0}function Tm(){return!1}function _d(){}function eb(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!aa(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function m3(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function qd(n){for(const e in n)delete n[e]}function su(n){let e;for(e in n)return!1;return!e}class Ys{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class Im extends Em{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Ys(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let u;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,_d);delete o[i]}return u}disposeInternal(){this.listeners_&&qd(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=_d,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function nt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Cp(n,e,t,i){return nt(n,e,t,i,!0)}function Rt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),qd(n))}class Yd extends Im{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(ze.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=nt(this,e[s],t);return r}return nt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Cp(this,e[s],t)}else i=Cp(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)y3(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}Yd.prototype.on;Yd.prototype.once;Yd.prototype.un;function y3(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Rt(n[e]);else Rt(n)}function tt(){throw new Error("Unimplemented abstract method.")}let _3=0;function it(n){return n.ol_uid||(n.ol_uid=String(++_3))}class sS extends Ys{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class ls extends Yd{constructor(e){super(),this.on,this.once,this.un,it(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new sS(i,e,t)),i=ru.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new sS(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],su(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const oS={LENGTH:"length"};class Pg extends Ys{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Ki extends ls{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(oS.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Pg(ei.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Pg(ei.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Pg(ei.REMOVE,r,e)),this.dispatchEvent(new Pg(ei.ADD,t,e))}updateLength_(){this.set(oS.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function at(n,e){if(!n)throw new Error(e)}class ou extends ls{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new ou(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Rt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=nt(e,ze.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?v3(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function v3(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(at(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const an={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function aS(n){const e=Zi();for(let t=0,i=n.length;t<i;++t)Jh(e,n[t]);return e}function Jw(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function tb(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function nb(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function au(n,e){return ib(n,e[0],e[1])}function Uh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function ib(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function fv(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let u=an.UNKNOWN;return o<t?u=u|an.LEFT:o>r&&(u=u|an.RIGHT),l<i?u=u|an.BELOW:l>s&&(u=u|an.ABOVE),u===an.UNKNOWN&&(u=an.INTERSECTING),u}function Zi(){return[1/0,1/0,-1/0,-1/0]}function ta(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Sm(n){return ta(1/0,1/0,-1/0,-1/0,n)}function rb(n,e){const t=n[0],i=n[1];return ta(t,i,t,i,e)}function ex(n,e,t,i,r){const s=Sm(r);return sb(s,n,e,t,i)}function vd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function w3(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Jh(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function sb(n,e,t,i,r){for(;t<i;t+=r)x3(n,e[t],e[t+1]);return n}function x3(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function ob(n,e){let t;return t=e(Cm(n)),t||(t=e(Rm(n)),t)||(t=e(Am(n)),t)||(t=e(bl(n)),t)?t:!1}function gv(n){let e=0;return Pm(n)||(e=dt(n)*Bn(n)),e}function Cm(n){return[n[0],n[1]]}function Rm(n){return[n[2],n[1]]}function fl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function E3(n,e){let t;if(e==="bottom-left")t=Cm(n);else if(e==="bottom-right")t=Rm(n);else if(e==="top-left")t=bl(n);else if(e==="top-right")t=Am(n);else throw new Error("Invalid corner");return t}function pv(n,e,t,i,r){const[s,o,l,u,h,f,p,y]=ab(n,e,t,i);return ta(Math.min(s,l,h,p),Math.min(o,u,f,y),Math.max(s,l,h,p),Math.max(o,u,f,y),r)}function ab(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),u=r*o,h=r*l,f=s*o,p=s*l,y=n[0],x=n[1];return[y-u+p,x-h-f,y-u-p,x-h+f,y+u-p,x+h+f,y+u+p,x+h-f,y-u+p,x-h-f]}function Bn(n){return n[3]-n[1]}function sl(n,e,t){const i=t||Zi();return ri(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Sm(i),i}function bl(n){return[n[0],n[3]]}function Am(n){return[n[2],n[3]]}function dt(n){return n[2]-n[0]}function ri(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Pm(n){return n[2]<n[0]||n[3]<n[1]}function T3(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function I3(n,e,t){let i=!1;const r=fv(n,e),s=fv(n,t);if(r===an.INTERSECTING||s===an.INTERSECTING)i=!0;else{const o=n[0],l=n[1],u=n[2],h=n[3],f=e[0],p=e[1],y=t[0],x=t[1],I=(x-p)/(y-f);let S,T;s&an.ABOVE&&!(r&an.ABOVE)&&(S=y-(x-h)/I,i=S>=o&&S<=u),!i&&s&an.RIGHT&&!(r&an.RIGHT)&&(T=x-(y-u)*I,i=T>=l&&T<=h),!i&&s&an.BELOW&&!(r&an.BELOW)&&(S=y-(x-l)/I,i=S>=o&&S<=u),!i&&s&an.LEFT&&!(r&an.LEFT)&&(T=x-(y-o)*I,i=T>=l&&T<=h)}return i}function lb(n,e){const t=e.getExtent(),i=fl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=dt(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function cb(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];lb(n,e);const r=dt(i);if(dt(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Dt(n,e,t){return Math.min(Math.max(n,e),t)}function S3(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const u=((n-t)*o+(e-i)*l)/(o*o+l*l);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=l*u)}return Hc(n,e,t,i)}function Hc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function C3(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const u=Math.abs(n[l][i]);u>s&&(s=u,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const u=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function lS(n){return n*180/Math.PI}function Ho(n){return n*Math.PI/180}function ol(n,e){const t=n%e;return t*e<0?t+e:t}function wi(n,e,t){return n+t*(e-n)}function Zd(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function vH(n,e){return Math.round(Zd(n,e))}function bg(n,e){return Math.floor(Zd(n,e))}function kg(n,e){return Math.ceil(Zd(n,e))}function mv(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function R3(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Rp(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function tx(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function A3(n,e){return n[0]*=e,n[1]*=e,n}function ub(n,e){if(e.canWrapX()){const t=dt(e.getExtent()),i=P3(n,e,t);i&&(n[0]-=i*t)}return n}function P3(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||dt(i),r=Math.floor((n[0]-i[0])/t)),r}function hb(...n){console.warn(...n)}const lu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class nx{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||lu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Qd=6378137,Wc=Math.PI*Qd,b3=[-Wc,-Wc,Wc,Wc],k3=[-180,-85,180,85],Dg=Qd*Math.log(Math.tan(Math.PI/2));class _c extends nx{constructor(e){super({code:e,units:"m",extent:b3,global:!0,worldExtent:k3,getPointResolution:function(t,i){return t/Math.cosh(i[1]/Qd)}})}}const cS=[new _c("EPSG:3857"),new _c("EPSG:102100"),new _c("EPSG:102113"),new _c("EPSG:900913"),new _c("http://www.opengis.net/def/crs/EPSG/0/3857"),new _c("http://www.opengis.net/gml/srs/epsg.xml#3857")];function D3(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Wc*n[s]/180;let o=Qd*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Dg?o=Dg:o<-Dg&&(o=-Dg),e[s+1]=o}return e}function M3(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Wc,e[s+1]=360*Math.atan(Math.exp(n[s+1]/Qd))/Math.PI-90;return e}const N3=6378137,uS=[-180,-90,180,90],L3=Math.PI*N3/180;class La extends nx{constructor(e,t){super({code:e,units:"degrees",extent:uS,axisOrientation:t,global:!0,metersPerUnit:L3,worldExtent:uS})}}const hS=[new La("CRS:84"),new La("EPSG:4326","neu"),new La("urn:ogc:def:crs:OGC:1.3:CRS84"),new La("urn:ogc:def:crs:OGC:2:84"),new La("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new La("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new La("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let yv={};function O3(n){return yv[n]||yv[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function F3(n,e){yv[n]=e}let Xc={};function wd(n,e,t){const i=n.getCode(),r=e.getCode();i in Xc||(Xc[i]={}),Xc[i][r]=t}function n0(n,e){return n in Xc&&e in Xc[n]?Xc[n][e]:null}const Ap=.9996,qi=.00669438,bm=qi*qi,km=bm*qi,Za=qi/(1-qi),dS=Math.sqrt(1-qi),cu=(1-dS)/(1+dS),db=cu*cu,ix=db*cu,rx=ix*cu,fb=rx*cu,gb=1-qi/4-3*bm/64-5*km/256,V3=3*qi/8+3*bm/32+45*km/1024,j3=15*bm/256+45*km/1024,U3=35*km/3072,z3=3/2*cu-27/32*ix+269/512*fb,B3=21/16*db-55/32*rx,G3=151/96*ix-417/128*fb,W3=1097/512*rx,Pp=6378137;function $3(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/Ap/(Pp*gb),l=o+z3*Math.sin(2*o)+B3*Math.sin(4*o)+G3*Math.sin(6*o)+W3*Math.sin(8*o),u=Math.sin(l),h=u*u,f=Math.cos(l),p=u/f,y=p*p,x=y*y,I=1-qi*h,S=Math.sqrt(1-qi*h),T=Pp/S,P=(1-qi)/I,M=Za*f**2,k=M*M,O=i/(T*Ap),F=O*O,G=F*O,b=G*O,R=b*O,D=R*O,V=l-p/P*(F/2-b/24*(5+3*y+10*M-4*k-9*Za))+D/720*(61+90*y+298*M+45*x-252*Za-3*k);let j=(O-G/6*(1+2*y+M)+R/120*(5-2*M+28*y-3*k+8*Za+24*x))/f;return j=mv(j+Ho(pb(t.number)),-Math.PI,Math.PI),[lS(j),lS(V)]}const fS=-80,gS=84,K3=-180,H3=180;function X3(n,e,t){n=mv(n,K3,H3),e<fS?e=fS:e>gS&&(e=gS);const i=Ho(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,u=l*l,h=Ho(n),f=pb(t.number),p=Ho(f),y=Pp/Math.sqrt(1-qi*r**2),x=Za*s**2,I=s*mv(h-p,-Math.PI,Math.PI),S=I*I,T=S*I,P=T*I,M=P*I,k=M*I,O=Pp*(gb*i-V3*Math.sin(2*i)+j3*Math.sin(4*i)-U3*Math.sin(6*i)),F=Ap*y*(I+T/6*(1-l+x)+M/120*(5-18*l+u+72*x-58*Za))+5e5;let G=Ap*(O+y*o*(S/2+P/24*(5-l+9*x+4*x**2)+k/720*(61-58*l+u+600*x-330*Za)));return t.north||(G+=1e7),[F,G]}function pb(n){return(n-1)*6-180+3}const q3=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function mb(n){let e=0;for(const r of q3){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function pS(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const u=t[l],h=t[l+1],f=n(u,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function Y3(n){return mb(n)?new nx({code:n,units:"m"}):null}function Z3(n){const e=mb(n.getCode());return e?{forward:pS(X3,e),inverse:pS($3,e)}:null}const Q3=63710088e-1;function mS(n,e,t){t=t||Q3;const i=Ho(n[1]),r=Ho(e[1]),s=(r-i)/2,o=Ho(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const J3=[Z3],e4=[Y3];let _v=!0;function yb(n){_v=!1}function sx(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function vv(n){F3(n.getCode(),n),wd(n,n,sx)}function t4(n){n.forEach(vv)}function ai(n){if(typeof n!="string")return n;const e=O3(n);if(e)return e;for(const t of e4){const i=t(n);if(i)return i}return null}function bp(n,e,t,i){n=ai(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/lu[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=ax(n,ai("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=mS(h.slice(0,2),h.slice(2,4)),p=mS(h.slice(4,6),h.slice(6,8));r=(f+p)/2}const u=i?lu[i]:n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function yS(n){t4(n),n.forEach(function(e){n.forEach(function(t){e!==t&&wd(e,t,sx)})})}function n4(n,e,t,i){n.forEach(function(r){e.forEach(function(s){wd(r,s,t),wd(s,r,i)})})}function ox(n,e){return n?typeof n=="string"?ai(n):n:ai(e)}function i4(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),u=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=u?e[o+h]:l[h]}return t})}function gl(n,e){return yb(),Dm(n,"EPSG:4326","EPSG:3857")}function _S(n,e){const t=Dm(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=ol(i+180,360)-180),t}function ip(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||ax(n,e)===sx)&&t}function ax(n,e){const t=n.getCode(),i=e.getCode();let r=n0(t,i);if(r)return r;let s=null,o=null;for(const u of J3)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=i0(s.inverse,o.forward);else{const u=n0(t,l);u&&(r=i0(u,o.forward))}else{const u=n0(l,i);u&&(r=i0(s.inverse,u))}return r&&(vv(n),vv(e),wd(n,e,r)),r}function i0(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function kp(n,e){const t=ai(n),i=ai(e);return ax(t,i)}function Dm(n,e,t){const i=kp(e,t);if(!i){const r=ai(e).getCode(),s=ai(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function wv(n,e){return n}function Ds(n,e){return _v&&!Rp(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(_v=!1,hb("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function _b(n,e){return n}function Go(n,e){return n}function r4(){yS(cS),yS(hS),n4(hS,cS,D3,M3)}r4();new Array(6);function wr(){return[1,0,0,1,0,0]}function s4(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function un(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Ks(n,e,t,i,r,s,o,l){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-l*i*u+e,n[5]=o*r*u+l*r*h+t,n}function vb(n,e){const t=o4(e);at(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*l)/t,n[5]=-(i*u-r*l)/t,n}function o4(n){return n[0]*n[3]-n[1]*n[2]}const a4=[1e5,1e5,1e5,1e5,2,2];function l4(n){return"matrix("+n.join(", ")+")"}function xv(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function c4(n,e){const t=xv(n),i=xv(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*a4[r])!==0)return!1;return!0}function Xo(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let u=e;u<t;u+=i){const h=n[u],f=n[u+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let p=2;p<o;p++)s[l++]=n[u+p]}return s&&s.length!=l&&(s.length=l),s}function wb(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),u=Math.sin(r),h=s[0],f=s[1];let p=0;for(let y=e;y<t;y+=i){const x=n[y]-h,I=n[y+1]-f;o[p++]=h+x*l-I*u,o[p++]=f+x*u+I*l;for(let S=y+2;S<y+i;++S)o[p++]=n[S]}return o&&o.length!=p&&(o.length=p),o}function u4(n,e,t,i,r,s,o,l){l=l||[];const u=o[0],h=o[1];let f=0;for(let p=e;p<t;p+=i){const y=n[p]-u,x=n[p+1]-h;l[f++]=u+r*y,l[f++]=h+s*x;for(let I=p+2;I<p+i;++I)l[f++]=n[I]}return l&&l.length!=f&&(l.length=f),l}function h4(n,e,t,i,r,s,o){o=o||[];let l=0;for(let u=e;u<t;u+=i){o[l++]=n[u]+r,o[l++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const vS=wr(),d4=[NaN,NaN];class f4 extends ls{constructor(){super(),this.extent_=Zi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=eb((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return tt()}closestPointXY(e,t,i,r){return tt()}containsXY(e,t){return this.closestPointXY(e,t,d4,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return tt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Sm(t),this.extentRevision_=this.getRevision()}return T3(this.extent_,e)}rotate(e,t){tt()}scale(e,t,i){tt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return tt()}getType(){return tt()}applyTransform(e){tt()}intersectsExtent(e){return tt()}translate(e,t){tt()}transform(e,t){const i=ai(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const u=i.getExtent(),h=i.getWorldExtent(),f=Bn(h)/Bn(u);Ks(vS,h[0],h[3],f,-f,0,0,0);const p=Xo(s,0,s.length,l,vS,o),y=kp(i,t);return y?y(p,p,l):p}:kp(i,t);return this.applyTransform(r),this}}class lx extends f4{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return ex(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return tt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=wS(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){tt()}setLayout(e,t,i){let r;if(e)r=wS(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=g4(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();wb(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=fl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();u4(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();h4(i,0,i.length,r,e,t,i),this.changed()}}}function g4(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function wS(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function p4(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Xo(i,0,i.length,r,e,t)}function xS(n,e,t,i,r,s,o){const l=n[e],u=n[e+1],h=n[t]-l,f=n[t+1]-u;let p;if(h===0&&f===0)p=e;else{const y=((r-l)*h+(s-u)*f)/(h*h+f*f);if(y>1)p=t;else if(y>0){for(let x=0;x<i;++x)o[x]=wi(n[e+x],n[t+x],y);o.length=i;return}else p=e}for(let y=0;y<i;++y)o[y]=n[p+y];o.length=i}function xb(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],u=n[e+1],h=Hc(s,o,l,u);h>r&&(r=h),s=l,o=u}return r}function Eb(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=xb(n,e,l,i,r),e=l}return r}function wH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=Eb(n,e,l,i,r),e=l[l.length-1]}return r}function Tb(n,e,t,i,r,s,o,l,u,h,f){if(e==t)return h;let p,y;if(r===0){if(y=Hc(o,l,n[e],n[e+1]),y<h){for(p=0;p<i;++p)u[p]=n[e+p];return u.length=i,y}return h}f=f||[NaN,NaN];let x=e+i;for(;x<t;)if(xS(n,x-i,x,i,o,l,f),y=Hc(o,l,f[0],f[1]),y<h){for(h=y,p=0;p<i;++p)u[p]=f[p];u.length=i,x+=i}else x+=i*Math.max((Math.sqrt(y)-Math.sqrt(h))/r|0,1);if(s&&(xS(n,t-i,e,i,o,l,f),y=Hc(o,l,f[0],f[1]),y<h)){for(h=y,p=0;p<i;++p)u[p]=f[p];u.length=i}return h}function Ib(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,y=t.length;p<y;++p){const x=t[p];h=Tb(n,e,x,i,r,s,o,l,u,h,f),e=x}return h}function xH(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,y=t.length;p<y;++p){const x=t[p];h=Ib(n,e,x,i,r,s,o,l,u,h,f),e=x[x.length-1]}return h}function m4(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function Sb(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function Cb(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=Sb(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function EH(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=Cb(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function $c(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Dp(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=$c(n,e,u,i,r[s]),e=u}return r.length=s,r}function ES(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:Dp(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function TS(n,e,t,i,r,s,o){let l,u;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,u=r;else if(h!==0){let f=n[e],p=n[e+1],y=0;const x=[0];for(let T=e+i;T<t;T+=i){const P=n[T],M=n[T+1];y+=Math.sqrt((P-f)*(P-f)+(M-p)*(M-p)),x.push(y),f=P,p=M}const I=r*y,S=d3(x,I);S<0?(u=(I-x[-S-2])/(x[-S-1]-x[-S-2]),l=e+(-S-2)*i):l=e+S*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:u===void 0?n[l+f]:wi(n[l+f],n[l+i+f],u);return s}function IS(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,u=t/i;for(;l<u;){const y=l+u>>1;r<n[(y+1)*i-1]?u=y:l=y+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],p=(r-h)/(f-h);o=[];for(let y=0;y<i-1;++y)o.push(wi(n[(l-1)*i+y],n[l*i+y],p));return o.push(r),o}function TH(n,e,t,i,r,s,o){if(o)return IS(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let u=0,h=t.length;u<h;++u){const f=t[u];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return IS(n,e,f,i,r,!1);e=f}}return null}function y4(n,e,t,i,r){return!ob(r,function(o){return!Qa(n,e,t,i,o[0],o[1])})}function Qa(n,e,t,i,r,s){let o=0,l=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];u<=s?f>s&&(h-l)*(s-u)-(r-l)*(f-u)>0&&o++:f<=s&&(h-l)*(s-u)-(r-l)*(f-u)<0&&o--,l=h,u=f}return o!==0}function cx(n,e,t,i,r,s){if(t.length===0||!Qa(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(Qa(n,t[o-1],t[o],i,r,s))return!1;return!0}function IH(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const u=t[o];if(cx(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function _4(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function ux(n,e,t,i,r,s){return s=s??sb(Zi(),n,e,t,i),ri(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:_4(n,e,t,i,function(o,l){return I3(r,o,l)}):!1}function SH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(ux(n,e,t[s],i,r))return!0;e=t[s]}return!1}function Rb(n,e,t,i,r){return!!(ux(n,e,t,i,r)||Qa(n,e,t,i,r[0],r[1])||Qa(n,e,t,i,r[0],r[3])||Qa(n,e,t,i,r[2],r[1])||Qa(n,e,t,i,r[2],r[3]))}function Ab(n,e,t,i,r){if(!Rb(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(y4(n,t[s-1],t[s],i,r)&&!ux(n,t[s-1],t[s],i,r))return!1;return!0}function CH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(Ab(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function v4(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const u=n[l],h=n[l+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function hx(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(l);u[0]=1,u[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const p=h.pop(),y=h.pop();let x=0;const I=n[y],S=n[y+1],T=n[p],P=n[p+1];for(let M=y+i;M<p;M+=i){const k=n[M],O=n[M+1],F=S3(k,O,I,S,T,P);F>x&&(f=M,x=F)}x>r&&(u[(f-e)/i]=1,y+i<f&&h.push(y,f),f+i<p&&h.push(f,p))}for(let p=0;p<l;++p)u[p]&&(s[o++]=n[e+p*i],s[o++]=n[e+p*i+1]);return o}function w4(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=hx(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Ua(n,e){return e*Math.round(n/e)}function x4(n,e,t,i,r,s,o){if(e==t)return o;let l=Ua(n[e],r),u=Ua(n[e+1],r);e+=i,s[o++]=l,s[o++]=u;let h,f;do if(h=Ua(n[e],r),f=Ua(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==u);for(;e<t;){const p=Ua(n[e],r),y=Ua(n[e+1],r);if(e+=i,p==h&&y==f)continue;const x=h-l,I=f-u,S=p-l,T=y-u;if(x*T==I*S&&(x<0&&S<x||x==S||x>0&&S>x)&&(I<0&&T<I||I==T||I>0&&T>I)){h=p,f=y;continue}s[o++]=h,s[o++]=f,l=h,u=f,h=p,f=y}return s[o++]=h,s[o++]=f,o}function dx(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=x4(n,e,f,i,r,s,o),l.push(o),e=f}return o}function RH(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u],p=[];o=dx(n,e,f,i,r,s,o,p),l.push(p),e=f[f.length-1]}return o}class pl extends lx{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new pl(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Hc(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let u=0;u<l;++u)i[u]=s[u];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return rb(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return ib(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=m4(this.flatCoordinates,0,e,this.stride),this.changed()}}const Hi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},ml=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",E4=ml.includes("safari")&&!ml.includes("chrom");E4&&(ml.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ml));const T4=ml.includes("webkit")&&!ml.includes("edge"),Pb=ml.includes("macintosh"),I4=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ei=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,bb=typeof Image<"u"&&Image.prototype.decode,kb=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Ue={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Qt(n,e,t,i){let r;return t&&t.length?r=t.shift():Ei?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let r0;function Mp(){return r0||(r0=Qt(1,1)),r0}function Mm(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function SS(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function S4(n){for(;n.lastChild;)n.lastChild.remove()}function C4(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function Db(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Wo(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const fx=[NaN,NaN,NaN,0];let s0;function R4(){return s0||(s0=Qt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),s0}const A4=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,P4=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,b4=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,k4=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Mg(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function ed(n){throw new Error('failed to parse "'+n+'" as color')}function Mb(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(P4)||n.match(A4)||n.match(b4);if(s){const o=s[4],l=100/255;return[Dt(Mg(s[1],l)+.5|0,0,255),Dt(Mg(s[2],l)+.5|0,0,255),Dt(Mg(s[3],l)+.5|0,0,255),o!==void 0?Dt(Mg(o,100),0,1):1]}ed(n)}if(n.startsWith("#")){if(k4.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let f=parseInt(s.substring(u,u+o),16);o===1&&(f+=f<<4),l[u/o]=f}return l[3]=l[3]/255,l}ed(n)}const e=R4();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&ed(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Mb(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=Zd(r[3]/255,3),r}function D4(n){return typeof n=="string"?n:px(n)}const M4=1024,Sh={};let o0=0;function N4(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function a0(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function l0(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function c0(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function u0(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function CS(n){const e=c0(n[0]),t=c0(n[1]),i=c0(n[2]),r=u0(e*.222488403+t*.716873169+i*.06060791),s=500*(u0(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-u0(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function L4(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=l0(e),s=l0(e+t/500*Math.cos(i)),o=l0(e-t/200*Math.sin(i)),l=a0(s*3.021973625-r*1.617392459-o*.404875592),u=a0(s*-.943766287+r*1.916279586+o*.027607165),h=a0(s*.069407491-r*.22898585+o*1.159737864);return[Dt(l+.5|0,0,255),Dt(u+.5|0,0,255),Dt(h+.5|0,0,255),n[3]]}function gx(n){if(n==="none")return fx;if(Sh.hasOwnProperty(n))return Sh[n];if(o0>=M4){let t=0;for(const i in Sh)(t++&3)===0&&(delete Sh[i],--o0)}const e=Mb(n);e.length!==4&&ed(n);for(const t of e)isNaN(t)&&ed(n);return Sh[n]=e,++o0,e}function uu(n){return Array.isArray(n)?n:gx(n)}function px(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}function O4(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[Cp(i,ze.LOAD,function(){o=!0,s||e()})];return i.src&&bb?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):l.push(Cp(i,ze.ERROR,t)),function(){r=!1,l.forEach(Rt)}}function F4(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function V4(n,e){return e&&(n.src=e),n.src&&bb?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):F4(n)}class j4{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=h0(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=h0(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=h0(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Ue.IDLE&&r.load(),r.getImageState()===Ue.LOADING?r.ready().then(()=>{this.patternCache_[o]=Mp().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Mp().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function h0(n,e,t){const i=t?uu(t):"null";return e+":"+n+":"+i}const Xi=new j4;let Ch=null;class Nb extends Im{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Ue.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Ue.LOADED){Ch||(Ch=Qt(1,1,void 0,{willReadFrequently:!0})),Ch.drawImage(this.image_,0,0);try{Ch.getImageData(0,0,1,1),this.tainted_=!1}catch{Ch=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(ze.CHANGE)}handleImageError_(){this.imageState_=Ue.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Ue.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Qt(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Ue.IDLE){this.image_||this.initializeImage_(),this.imageState_=Ue.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&V4(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Ue.LOADED)return;const t=this.image_,i=Qt(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=D4(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Ue.LOADED||this.imageState_===Ue.ERROR)e();else{const t=()=>{(this.imageState_===Ue.LOADED||this.imageState_===Ue.ERROR)&&(this.removeEventListener(ze.CHANGE,t),e())};this.addEventListener(ze.CHANGE,t)}})),this.ready_}}function Np(n,e,t,i,r,s){let o=e===void 0?void 0:Xi.get(e,t,r);return o||(o=new Nb(n,n&&"src"in n?n.src||void 0:e,t,i,r),Xi.set(e,t,r,o,s)),s&&o&&!Xi.getPattern(e,t,r)&&Xi.set(e,t,r,o,s),o}function Zr(n){return n?Array.isArray(n)?px(n):typeof n=="object"&&"src"in n?U4(n):n:null}function U4(n){if(!n.offset||!n.size)return Xi.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Xi.getPattern(e,void 0,n.color);if(t)return t;const i=Xi.get(n.src,"anonymous",null);if(i.getImageState()!==Ue.LOADED)return null;const r=Qt(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Np(r.canvas,e,void 0,Ue.LOADED,n.color,!0),Xi.getPattern(e,void 0,n.color)}class Lb{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Ng="ol-hidden",Jd="ol-unselectable",mx="ol-control",RS="ol-collapsed",z4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),AS=["style","variant","weight","size","lineHeight","family"],Ev={normal:400,bold:700},Tv=function(n){const e=n.match(z4);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=AS.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[AS[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in Ev&&(t.weight=Ev[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},Ob="10px sans-serif",ti="#000",hu="round",Bs=[],Gs=0,du="round",xd=10,Ed="#000",Td="center",Lp="middle",Ja=[0,0,0,0],Id=1,kc=new ls;let Rh=null,PS;const Iv={},B4=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function G4(n,e,t){return`${n} ${e} 16px "${t}"`}const W4=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=Tv(s),u=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const p=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),y=Ev[f.weight]||f.weight;return p===u&&f.style===l.style&&y==h})}async function r(){await t.ready;let s=!0;const o=kc.getProperties(),l=Object.keys(o).filter(u=>o[u]<100);for(let u=l.length-1;u>=0;--u){const h=l[u];let f=o[h];f<100&&(await i(h)?(qd(Iv),kc.set(h,100)):(f+=10,kc.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Ei?self.fonts:document.fonts);const o=Tv(s);if(!o)return;const l=o.families;let u=!1;for(const h of l){if(B4.has(h))continue;const f=G4(o.style,o.weight,h);kc.get(f)===void 0&&(kc.set(f,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),$4=(function(){let n;return function(e){let t=Iv[e];if(t==null){if(Ei){const i=Tv(e),r=Fb(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);Iv[e]=t}return t}})();function Fb(n,e){return Rh||(Rh=Qt(1,1)),n!=PS&&(Rh.font=n,PS=Rh.font),Rh.measureText(e)}function Vb(n,e){return Fb(n,e).width}function bS(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,Vb(n,s)),0);return t[e]=i,i}function K4(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,u=0;for(let h=0,f=e.length;h<=f;h+=2){const p=e[h];if(p===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=u,u=0;continue}const y=e[h+1]||n.font,x=Vb(y,p);t.push(x),o+=x;const I=$4(y);i.push(I),u=Math.max(u,I)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function H4(n,e,t,i,r,s,o,l,u,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=p=>p.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(f[0],f[1]),X4(i,n)):f[0]<0||f[1]<0?(n.translate(u,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,u,h,o*f[0],l*f[1]),n.restore()}function X4(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class q4 extends Lb{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?Zd(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=wr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Xo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,p=s.length;f<p;f+=2){const y=s[f]-this.imageAnchorX_,x=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const I=y+this.imageAnchorX_,S=x+this.imageAnchorY_;Ks(l,I,S,1,1,h,-I,-S),o.save(),o.transform.apply(o,l),o.translate(I,S),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Xo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=Xo(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let u=l.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=p4(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(ri(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,u=s.length;l<u;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),aa(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Td;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Zr(i||ti)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),f=s||Bs;this.strokeState_={lineCap:r!==void 0?r:hu,lineDash:this.pixelRatio_===1?f:f.map(p=>p*this.pixelRatio_),lineDashOffset:(o||Gs)*this.pixelRatio_,lineJoin:l!==void 0?l:du,lineWidth:(u!==void 0?u:Id)*this.pixelRatio_,miterLimit:h!==void 0?h:xd,strokeStyle:Zr(i||Ed)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const x=t.getColor();this.textFillState_={fillStyle:Zr(x||ti)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const x=i.getColor(),I=i.getLineCap(),S=i.getLineDash(),T=i.getLineDashOffset(),P=i.getLineJoin(),M=i.getWidth(),k=i.getMiterLimit();this.textStrokeState_={lineCap:I!==void 0?I:hu,lineDash:S||Bs,lineDashOffset:T||Gs,lineJoin:P!==void 0?P:du,lineWidth:M!==void 0?M:Id,miterLimit:k!==void 0?k:xd,strokeStyle:Zr(x||Ed)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),f=e.getText(),p=e.getTextAlign(),y=e.getTextBaseline();this.textState_={font:r!==void 0?r:Ob,textAlign:p!==void 0?p:Td,textBaseline:y!==void 0?y:Lp},this.text_=f!==void 0?Array.isArray(f)?f.reduce((x,I,S)=>x+=S%2?" ":I,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const Y4=.5,jb={Point:r5,LineString:t5,Polygon:o5,MultiPoint:s5,MultiLineString:n5,MultiPolygon:i5,GeometryCollection:e5,Circle:Q4};function Z4(n,e){return parseInt(it(n),10)-parseInt(it(e),10)}function kS(n,e){const t=Ub(n,e);return t*t}function Ub(n,e){return Y4*n/e}function Q4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}function DS(n,e,t,i,r,s,o,l){const u=[],h=t.getImage();if(h){let y=!0;const x=h.getImageState();x==Ue.LOADED||x==Ue.ERROR?y=!1:x==Ue.IDLE&&h.load(),y&&u.push(h.ready())}const f=t.getFill();f&&f.loading()&&u.push(f.ready());const p=u.length>0;return p&&Promise.all(u).then(()=>r(null)),J4(n,e,t,i,s,o,l),p}function J4(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const u=l.simplifyTransformed(i,r);if(t.getRenderer())zb(n,u,t,e,o);else{const f=jb[u.getType()];f(n,u,t,e,o,s)}}function zb(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,u=o.length;l<u;++l)zb(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function e5(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,u;for(l=0,u=o.length;l<u;++l){const h=jb[o[l].getType()];h(n,o[l],t,i,r,s)}}function t5(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function n5(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function i5(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}function r5(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=Ue.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function s5(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=Ue.LOADED)return;const p=n.getBuilder(t.getZIndex(),"Image");p.setImageStyle(o,f),p.drawMultiPoint(e,i,r)}if(h){const p=n.getBuilder(t.getZIndex(),"Text");p.setTextStyle(u,f),p.drawText(e,i,r)}}function o5(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}let a5=!1;function l5(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=a5,l.onload=function(u){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function MS(n,e){return function(t,i,r,s,o){l5(n,e,t,i,r,(l,u)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function c5(n,e){return[[-1/0,-1/0,1/0,1/0]]}function u5(n,e,t,i){const r=[];let s=Zi();for(let o=0,l=t.length;o<l;++o){const u=t[o];s=ex(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function yx(n,e,t,i,r,s,o){let l,u,h,f,p,y,x;const I=r[s+1],S=[];for(let M=0,k=t.length;M<k;++M){const O=t[M];for(f=n[O-i],y=n[O-i+1],l=e;l<O;l+=i)p=n[l],x=n[l+1],(I<=y&&x<=I||y<=I&&I<=x)&&(h=(I-y)/(x-y)*(p-f)+f,S.push(h)),f=p,y=x}let T=NaN,P=-1/0;for(S.sort(zs),f=S[0],l=1,u=S.length;l<u;++l){p=S[l];const M=Math.abs(p-f);M>P&&(h=(f+p)/2,cx(n,e,t,i,h,I)&&(T=h,P=M)),f=p}return isNaN(T)&&(T=r[s]),o?(o.push(T,I,P),o):[T,I,P]}function h5(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const u=t[o];s=yx(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function d5(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function _x(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],u=n[e+1];r+=(l-s)*(u+o),s=l,o=u}return r===0?void 0:r>0}function Bb(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=_x(n,e,l,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function AH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!Bb(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function Sv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=_x(n,e,l,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&d5(n,e,l,i),e=l}return e}function PH(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=Sv(n,e,t[s],i,r);return e}function f5(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const u=e[o],h=_x(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function Gb(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,u=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=u*h-l*f,l=h,u=f}return r/2}function Wb(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=Gb(n,e,l,i),e=l}return r}function bH(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=Wb(n,e,l,i),e=l[l.length-1]}return r}class Sd extends lx{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Sd(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<nb(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(xb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Tb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return Gb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return $c(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=hx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Sd(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Sb(this.flatCoordinates,0,e,this.stride),this.changed()}}class Cd extends lx{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Qw(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Cd(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<nb(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Eb(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ib(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return cx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Wb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Sv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Dp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=fl(this.getExtent());this.flatInteriorPoint_=yx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new pl(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Sd(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const u=i[o],h=new Sd(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Bb(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Sv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=dx(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Cd(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return Ab(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Cb(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function NS(n){if(Pm(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Cd(s,"XY",[s.length])}const LS=wr();class dr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?rb(this.flatCoordinates_):ex(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=fl(this.getExtent());this.flatInteriorPoints_=yx(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=f5(this.flatCoordinates_,this.ends_),t=u5(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=h5(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=TS(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=TS(e,t,o,2,.5);Qw(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ai(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Bn(i)/Bn(t);Ks(LS,i[0],i[3],r,-r,0,0,0),Xo(this.flatCoordinates_,0,this.flatCoordinates_.length,2,LS,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new dr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=eb((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=hx(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=w4(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=dx(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new dr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}dr.prototype.getFlatCoordinates=dr.prototype.getOrientedFlatCoordinates;function $b(n,e,t=0,i=n.length-1,r=g5){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,f=Math.log(u),p=.5*Math.exp(2*f/3),y=.5*Math.sqrt(f*p*(u-p)/u)*(h-u/2<0?-1:1),x=Math.max(t,Math.floor(e-h*p/u+y)),I=Math.min(i,Math.floor(e+(u-h)*p/u+y));$b(n,e,x,I,r)}const s=n[e];let o=t,l=i;for(Ah(n,t,e),r(n[i],s)>0&&Ah(n,t,i);o<l;){for(Ah(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?Ah(n,t,l):(l++,Ah(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function Ah(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function g5(n,e){return n<e?-1:n>e?1:0}let Kb=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!Og(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],u=t.leaf?r(l):l;Og(e,u)&&(t.leaf?i.push(l):f0(e,u)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!Og(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(Og(e,o)){if(t.leaf||f0(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Dc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=p5(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&f0(i,r)?(s.push(i),o.push(l),l=0,u=i,i=i.children[0]):u?(l++,i=u.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=Dc(e.slice(t,i+1)),vc(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=Dc([]),l.leaf=!1,l.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));OS(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const p=Math.min(f+h-1,i);OS(e,f,p,u,this.compareMinY);for(let y=f;y<=p;y+=u){const x=Math.min(y+u-1,p);l.children.push(this._build(e,y,x,r-1))}}return vc(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let u=0;u<t.children.length;u++){const h=t.children[u],f=d0(h),p=_5(e,h)-f;p<o?(o=p,s=f<s?f:s,l=h):p===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Bh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=Dc(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,vc(i,this.toBBox),vc(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=Dc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,vc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const u=zh(e,0,l,this.toBBox),h=zh(e,l,i,this.toBBox),f=v5(u,h),p=d0(u)+d0(h);f<s?(s=f,r=l,o=p<o?p:o):f===s&&p<o&&(o=p,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:m5,s=e.leaf?this.compareMinY:y5,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=zh(e,0,t,s),l=zh(e,i-t,i,s);let u=Lg(o)+Lg(l);for(let h=t;h<i-t;h++){const f=e.children[h];Bh(o,e.leaf?s(f):f),u+=Lg(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];Bh(l,e.leaf?s(f):f),u+=Lg(l)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Bh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():vc(e[t],this.toBBox)}};function p5(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function vc(n,e){zh(n,0,n.children.length,e,n)}function zh(n,e,t,i,r){r||(r=Dc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Bh(r,n.leaf?i(o):o)}return r}function Bh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function m5(n,e){return n.minX-e.minX}function y5(n,e){return n.minY-e.minY}function d0(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Lg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function _5(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function v5(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function f0(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Og(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Dc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function OS(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;$b(n,o,e,t,r),s.push(e,o,o,t)}}class FS{constructor(e){this.rbush_=new Kb(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[it(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=u,this.items_[it(l)]=u}this.rbush_.load(i)}remove(e){const t=it(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[it(t)],r=[i.minX,i.minY,i.maxX,i.maxY];vd(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return su(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return ta(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class Hb extends ls{constructor(e){super(),this.projection=ai(e.projection),this.attributions_=VS(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=VS(e),this.changed()}setState(e){this.state_=e,this.changed()}}function VS(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const Bi={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class So extends Ys{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class vx extends Hb{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=_d,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(at(this.format_,"`format` must be set when `url` is set"),this.loader_=MS(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:c5;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new FS:null,this.loadedExtentsRtree_=new FS,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Ki(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=it(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new So(Bi.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof dr||(this.featureChangeKeys_[e]=[nt(t,ze.CHANGE,this.handleFeatureChange_,this),nt(t,ru.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof dr){const s=this.idIndex_[r];s instanceof dr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(at(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],u=it(l);this.addToIndex_(u,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],u=it(l);this.setupChangeEvents_(u,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(Bi.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new So(Bi.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Bi.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(Bi.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(ei.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(ei.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Rt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new So(Bi.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof dr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof dr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),su(this.nullGeometryFeatures_)||Qw(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=cb(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||yd,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const f=h.getGeometry(),p=l;if(l=f instanceof dr?0:f.closestPointXY(i,r,o,l),l<p){s=h;const y=Math.sqrt(l);u[0]=i-y,u[1]=r-y,u[2]=i+y,u[3]=r+y}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=it(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new So(Bi.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:it(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&su(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const u=s[o];r.forEachInExtent(u,function(f){return Uh(f.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new So(Bi.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new So(Bi.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new So(Bi.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(vd(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=it(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Rt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(Bi.REMOVEFEATURE)&&this.dispatchEvent(new So(Bi.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){at(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(MS(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Tr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Tr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Np(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Ue.IDLE&&t.load(),t.getImageState()===Ue.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?it(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:uu(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class bu{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new bu({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function jS(n){return n[0]>0&&n[1]>0}function w5(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function oi(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Nm{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=oi(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Nm({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return tt()}getImage(e){return tt()}getHitDetectionImage(){return tt()}getPixelRatio(e){return 1}getImageState(){return tt()}getImageSize(){return tt()}getOrigin(){return tt()}getSize(){return tt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=oi(e)}listenImageChange(e){tt()}load(){tt()}unlistenImageChange(e){tt()}ready(){return Promise.resolve()}}class Lm extends Nm{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Ue.LOADING:Ue.LOADED,this.imageState_===Ue.LOADING&&this.ready().then(()=>this.imageState_=Ue.LOADED),this.render()}clone(){const e=this.getScale(),t=new Lm({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Xi.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=Qt(o,o);this.draw_(s,l,e),r=l.canvas,Xi.set(i,null,null,new Nb(r,void 0,null,Ue.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const G=r;r=s,s=G}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,u=s*Math.sin(l),h=Math.sqrt(s*s-u*u),f=r-h,p=Math.sqrt(u*u+f*f),y=p/u;if(e==="miter"&&y<=i)return y*t;const x=t/2/y,I=t/2*(f/p),T=Math.sqrt((r+x)*(r+x)+I*I)-r;if(this.radius2_===void 0||e==="bevel")return T*2;const P=r*Math.sin(l),M=Math.sqrt(r*r-P*P),k=s-M,F=Math.sqrt(P*P+k*k)/P;if(F<=i){const G=F*t/2-s-r;return 2*Math.max(T,G)}return T*2}createRenderOptions(){let e=hu,t=du,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=Zr(this.stroke_.getColor()??Ed),l=this.stroke_.getWidth()??Id,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??du,e=this.stroke_.getLineCap()??hu,i=this.stroke_.getMiterLimit()??xd);const u=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ti),t.fillStyle=Zr(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=uu(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Qt(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const u=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ti,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class kl extends Lm{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new kl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Yi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=US,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Yi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=US,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function x5(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(at(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let g0=null;function Xb(n,e){if(!g0){const t=new Tr({color:"rgba(255,255,255,0.4)"}),i=new bu({color:"#3399CC",width:1.25});g0=[new Yi({image:new kl({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return g0}function US(n){return n.getGeometry()}const E5="#333";class ef{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=oi(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Tr({color:E5}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new ef({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Tr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=oi(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Nn={ANIMATING:0,INTERACTING:1},Se={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Fg=[Se.FILL],$o=[Se.STROKE],el=[Se.BEGIN_PATH],zS=[Se.CLOSE_PATH];class tf extends Lb{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,u=e.length;l<u;l+=t)r[0]=e[l],r[1]=e[l+1],au(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let u=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],p=e[t+1];const y=this.tmpCoordinate_;let x=!0,I,S,T;for(I=t+r;I<i;I+=r)y[0]=e[I],y[1]=e[I+1],T=fv(h,y),T!==S?(x&&(l[u++]=f,l[u++]=p,x=!1),l[u++]=y[0],l[u++]=y[1]):T===an.INTERSECTING?(l[u++]=y[0],l[u++]=y[1],x=!1):x=!0,f=y[0],p=y[1],S=T;return(s&&x||I===t+r)&&(l[u++]=f,l[u++]=p),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),u=this.coordinates.length;let h,f,p,y,x;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),y=[];const I=e.getEndss();x=0;for(let S=0,T=I.length;S<T;++S){const P=[];x=this.drawCustomCoordinates_(h,x,I[S],l,P),y.push(P)}this.instructions.push([Se.CUSTOM,u,y,e,i,ES,s]),this.hitDetectionInstructions.push([Se.CUSTOM,u,y,e,r||i,ES,s]);break;case"Polygon":case"MultiLineString":p=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),x=this.drawCustomCoordinates_(h,0,e.getEnds(),l,p),this.instructions.push([Se.CUSTOM,u,p,e,i,Dp,s]),this.hitDetectionInstructions.push([Se.CUSTOM,u,p,e,r||i,Dp,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Se.CUSTOM,u,f,e,i,$c,s]),this.hitDetectionInstructions.push([Se.CUSTOM,u,f,e,r||i,$c,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>u&&(this.instructions.push([Se.CUSTOM,u,f,e,i,$c,s]),this.hitDetectionInstructions.push([Se.CUSTOM,u,f,e,r||i,$c,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Se.CUSTOM,u,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Se.CUSTOM,u,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Se.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Se.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Se.END_GEOMETRY?o=t:s==Se.BEGIN_GEOMETRY&&(r[2]=t,g3(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Zr(i||ti)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Zr(i||Ed);const r=e.getLineCap();t.lineCap=r!==void 0?r:hu;const s=e.getLineDash();t.lineDash=s?s.slice():Bs;const o=e.getLineDashOffset();t.lineDashOffset=o||Gs;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:du;const u=e.getWidth();t.lineWidth=u!==void 0?u:Id;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:xd,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Se.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Se.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!aa(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Se.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=tb(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Jw(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class T5 extends tf{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!au(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Se.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Se.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||au(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Se.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Se.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class I5 extends tf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Se.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs],el);const l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push($o),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs],el);const l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,y=l.length;p<y;++p)f=this.drawFlatCoordinates_(u,f,l[p],h);this.hitDetectionInstructions.push($o),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push($o),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push($o),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(el)}}class BS extends tf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,u=i.length;this.instructions.push(el),this.hitDetectionInstructions.push(el);for(let h=0;h<u;++h){const f=i[h],p=this.coordinates.length,y=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),x=[Se.MOVE_TO_LINE_TO,p,y];this.instructions.push(x),this.hitDetectionInstructions.push(x),l&&(this.instructions.push(zS),this.hitDetectionInstructions.push(zS)),t=f}return o&&(this.instructions.push(Fg),this.hitDetectionInstructions.push(Fg)),l&&(this.instructions.push($o),this.hitDetectionInstructions.push($o)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs]);const l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);const f=[Se.CIRCLE,h];this.instructions.push(el,f),this.hitDetectionInstructions.push(el,f),r.fillStyle!==void 0&&(this.instructions.push(Fg),this.hitDetectionInstructions.push(Fg)),r.strokeStyle!==void 0&&(this.instructions.push($o),this.hitDetectionInstructions.push($o)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs]);const l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Se.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Bs,Gs]);const l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,y=l.length;p<y;++p)f=this.drawFlatCoordinatess_(u,f,l[p],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Ua(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function S5(n,e,t,i,r){const s=[];let o=t,l=0,u=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=u.slice(-2),p=e[o+r],y=e[o+r+1],x=Math.sqrt((p-h)*(p-h)+(y-f)*(y-f));if(l+=x,l>=n){const I=(n-l+x)/x,S=wi(h,p,I),T=wi(f,y,I);u.push(S,T),s.push(u),u=[S,T],l==n&&(o+=r),l=0}else if(l<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const I=x-l,S=wi(h,p,I/x),T=wi(f,y,I/x);u.push(S,T),s.push(u),u=[S,T],l=0,o+=r}}return l>0&&s.push(u),s}function C5(n,e,t,i,r){let s=t,o=t,l=0,u=0,h=t,f,p,y,x,I,S,T,P,M,k;for(p=t;p<i;p+=r){const O=e[p],F=e[p+1];I!==void 0&&(M=O-I,k=F-S,x=Math.sqrt(M*M+k*k),T!==void 0&&(u+=y,f=Math.acos((T*M+P*k)/(y*x)),f>n&&(u>l&&(l=u,s=h,o=p),u=0,h=p-r)),y=x,T=M,P=k),I=O,S=F}return u+=x,u>l?[h,p]:[s,o]}const Op={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class R5 extends tf{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ti]={fillStyle:ti},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let u=l.length;const h=e.getType();let f=null,p=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!ri(this.maxExtent,e.getExtent()))return;let y;if(f=e.getFlatCoordinates(),h=="LineString")y=[f.length];else if(h=="MultiLineString")y=e.getEnds();else if(h=="Polygon")y=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const T=e.getEndss();y=[];for(let P=0,M=T.length;P<M;++P)y.push(T[P][0])}this.beginGeometry(e,t,i);const x=o.repeat,I=x?void 0:o.textAlign;let S=0;for(let T=0,P=y.length;T<P;++T){let M;x?M=S5(x*this.resolution,f,S,y[T],p):M=[f.slice(S,y[T])];for(let k=0,O=M.length;k<O;++k){const F=M[k];let G=0,b=F.length;if(I==null){const D=C5(o.maxAngle,F,0,F.length,2);G=D[0],b=D[1]}for(let D=G;D<b;D+=p)l.push(F[D],F[D+1]);const R=l.length;S=y[T],this.drawChars_(u,R),u=R}}this.endGeometry(t)}else{let y=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),p=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||y.push(f[2]/this.resolution),p=3;break;case"MultiPolygon":const O=e.getFlatInteriorPoints();f=[];for(let F=0,G=O.length;F<G;F+=3)o.overflow||y.push(O[F+2]/this.resolution),f.push(O[F],O[F+1]);if(f.length===0)return;p=2;break}const x=this.appendFlatPointCoordinates(f,p);if(x===u)return;if(y&&(x-u)/2!==f.length/p){let O=u/2;y=y.filter((F,G)=>{const b=l[(O+G)*2]===f[G*p]&&l[(O+G)*2+1]===f[G*p+1];return b||--O,b})}this.saveTextStates_();const I=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,S=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let T=o.padding;if(T!=Ja&&(o.scale[0]<0||o.scale[1]<0)){let O=o.padding[0],F=o.padding[1],G=o.padding[2],b=o.padding[3];o.scale[0]<0&&(F=-F,b=-b),o.scale[1]<0&&(O=-O,G=-G),T=[O,F,G,b]}const P=this.pixelRatio;this.instructions.push([Se.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,T==Ja?Ja:T.map(function(O){return O*P}),I,S,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]);const M=1/P,k=I?I.slice(0):null;k&&(k[1]=ti),this.hitDetectionInstructions.push([Se.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[M,M],NaN,this.declutterMode_,this.declutterImageWithText_,T,k,S,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ti:this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Td,justify:t.justify,textBaseline:t.textBaseline||Lp,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=Op[r.textBaseline],f=this.textOffsetY_*u,p=this.text_,y=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Se.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,u,f,s,y*u,p,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Se.DRAW_CHARS,e,t,h,r.overflow,l&&ti,r.maxAngle,u,f,s,y*u,p,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Zr(o.getColor()||ti)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const S=l.getLineDash(),T=l.getLineDashOffset(),P=l.getWidth(),M=l.getMiterLimit();s.lineCap=l.getLineCap()||hu,s.lineDash=S?S.slice():Bs,s.lineDashOffset=T===void 0?Gs:T,s.lineJoin=l.getLineJoin()||du,s.lineWidth=P===void 0?Id:P,s.miterLimit=M===void 0?xd:M,s.strokeStyle=Zr(l.getColor()||Ed)}i=this.textState_;const u=e.getFont()||Ob;W4(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Lp,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||Ja,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),p=e.getOffsetY(),y=e.getRotateWithView(),x=e.getKeepUpright(),I=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=p===void 0?0:p,this.textRotateWithView_=y===void 0?!1:y,this.textKeepUpright_=x===void 0?!0:x,this.textRotation_=I===void 0?0:I,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:it(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+it(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const A5={Circle:BS,Default:tf,Image:T5,LineString:I5,Polygon:BS,Text:R5};class P5{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=A5[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function b5(n,e,t,i,r,s,o,l,u,h,f,p,y=!0){let x=n[e],I=n[e+1],S=0,T=0,P=0,M=0;function k(){S=x,T=I,e+=i,x=n[e],I=n[e+1],M+=P,P=Math.sqrt((x-S)*(x-S)+(I-T)*(I-T))}do k();while(e<t-i&&M+P<s);let O=P===0?0:(s-M)/P;const F=wi(S,x,O),G=wi(T,I,O),b=e-i,R=M,D=s+l*u(h,r,f);for(;e<t-i&&M+P<D;)k();O=P===0?0:(D-M)/P;const V=wi(S,x,O),j=wi(T,I,O);let z=!1;if(y)if(p){const ue=[F,G,V,j];wb(ue,0,4,2,p,ue,ue),z=ue[0]>ue[2]}else z=F>V;const N=Math.PI,se=[],ge=b+i===e;e=b,P=0,M=R,x=n[e],I=n[e+1];let ne;if(ge){k(),ne=Math.atan2(I-T,x-S),z&&(ne+=ne>0?-N:N);const ue=(V+F)/2,Z=(j+G)/2;return se[0]=[ue,Z,(D-s)/2,ne,r],se}r=r.replace(/\n/g," ");for(let ue=0,Z=r.length;ue<Z;){k();let le=Math.atan2(I-T,x-S);if(z&&(le+=le>0?-N:N),ne!==void 0){let Ie=le-ne;if(Ie+=Ie>N?-2*N:Ie<-N?2*N:0,Math.abs(Ie)>o)return null}ne=le;const ie=ue;let W=0;for(;ue<Z;++ue){const Ie=z?Z-ue-1:ue,be=l*u(h,r[Ie],f);if(e+i<t&&M+P<s+W+be/2)break;W+=be}if(ue===ie)continue;const K=z?r.substring(Z-ie,Z-ue):r.substring(ie,ue);O=P===0?0:(s+W/2-M)/P;const Ee=wi(S,x,O),Te=wi(T,I,O);se.push([Ee,Te,W/2,le,K]),s+=W}return se}class qb{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Mp(),{get:(e,t)=>{if(typeof Mp()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const wc=Zi(),Co=[],bs=[],ks=[],Ro=[];function GS(n){return n[3].declutterBox}const WS=new RegExp("[-----]");function p0(n,e){return e==="start"?e=WS.test(n)?"right":"left":e==="end"&&(e=WS.test(n)?"left":"right"),Op[e]}function k5(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function D5(n,e,t){return t%2===0&&(n+=e),n}class M5{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=wr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new qb:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,f=[u.scale[0]*h,u.scale[1]*h],p=u.justify?Op[u.justify]:p0(Array.isArray(e)?e[0]:e,u.textAlign||Td),y=r&&o.lineWidth?o.lineWidth:0,x=Array.isArray(e)?e:String(e).split(`
`).reduce(k5,[]),{width:I,height:S,widths:T,heights:P,lineWidths:M}=K4(u,x),k=I+y,O=[],F=(k+2)*f[0],G=(S+y)*f[1],b={width:F<0?Math.floor(F):Math.ceil(F),height:G<0?Math.floor(G):Math.ceil(G),contextInstructions:O};(f[0]!=1||f[1]!=1)&&O.push("scale",f),r&&(O.push("strokeStyle",o.strokeStyle),O.push("lineWidth",y),O.push("lineCap",o.lineCap),O.push("lineJoin",o.lineJoin),O.push("miterLimit",o.miterLimit),O.push("setLineDash",[o.lineDash]),O.push("lineDashOffset",o.lineDashOffset)),i&&O.push("fillStyle",l.fillStyle),O.push("textBaseline","middle"),O.push("textAlign","center");const R=.5-p;let D=p*k+R*y;const V=[],j=[];let z=0,N=0,se=0,ge=0,ne;for(let ue=0,Z=x.length;ue<Z;ue+=2){const le=x[ue];if(le===`
`){N+=z,z=0,D=p*k+R*y,++ge;continue}const ie=x[ue+1]||u.font;ie!==ne&&(r&&V.push("font",ie),i&&j.push("font",ie),ne=ie),z=Math.max(z,P[se]);const W=[le,D+R*T[se]+p*(T[se]-M[ge]),.5*(y+z)+N];D+=T[se],r&&V.push("strokeText",W),i&&j.push("fillText",W),++se}return Array.prototype.push.apply(O,V),Array.prototype.push.apply(O,j),this.labels_[s]=b,b}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,u,h,f,p,y,x,I,S,T){l*=y[0],u*=y[1];let P=i-l,M=r-u;const k=s+h>e?e-h:s,O=o+f>t?t-f:o,F=I[3]+k*y[0]+I[1],G=I[0]+O*y[1]+I[2],b=P-I[3],R=M-I[0];(S||p!==0)&&(Co[0]=b,Ro[0]=b,Co[1]=R,bs[1]=R,bs[0]=b+F,ks[0]=bs[0],ks[1]=R+G,Ro[1]=ks[1]);let D;return p!==0?(D=Ks(wr(),i,r,1,1,p,-i,-r),un(D,Co),un(D,bs),un(D,ks),un(D,Ro),ta(Math.min(Co[0],bs[0],ks[0],Ro[0]),Math.min(Co[1],bs[1],ks[1],Ro[1]),Math.max(Co[0],bs[0],ks[0],Ro[0]),Math.max(Co[1],bs[1],ks[1],Ro[1]),wc)):ta(Math.min(b,b+F),Math.min(R,R+G),Math.max(b,b+F),Math.max(R,R+G),wc),x&&(P=Math.round(P),M=Math.round(M)),{drawImageX:P,drawImageY:M,drawImageW:k,drawImageH:O,originX:h,originY:f,declutterBox:{minX:wc[0],minY:wc[1],maxX:wc[2],maxY:wc[3],value:T},canvasTransform:D,scale:y}}replayImageOrLabel_(e,t,i,r,s,o,l){const u=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(u&&this.replayTextBackground_(e,Co,bs,ks,Ro,o,l),H4(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=un(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],u=this.pixelRatio,h=p0(Array.isArray(e)?e[0]:e,s.textAlign||Td),f=Op[s.textBaseline||Lp],p=l&&l.lineWidth?l.lineWidth:0,y=o.width/u-2*s.scale[0],x=h*y+2*(.5-h)*p,I=f*o.height/u+2*(.5-f)*p;return{label:o,anchorX:x,anchorY:I}}execute_(e,t,i,r,s,o,l,u){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&aa(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=Xo(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),s4(this.renderedTransform_,i));let p=0;const y=r.length;let x=0,I,S,T,P,M,k,O,F,G,b,R,D,V,j=0,z=0;const N=this.coordinateCache_,se=this.viewRotation_,ge=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ne={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:se},ue=this.instructions!=r||this.overlaps?0:200;let Z,le,ie,W;for(;p<y;){const K=r[p];switch(K[0]){case Se.BEGIN_GEOMETRY:Z=K[1],W=K[3],Z.getGeometry()?l!==void 0&&!ri(l,W.getExtent())?p=K[2]+1:++p:p=K[2],h&&(h.zIndex=K[4]);break;case Se.BEGIN_PATH:j>ue&&(this.fill_(e),j=0),z>ue&&(e.stroke(),z=0),!j&&!z&&(e.beginPath(),M=NaN,k=NaN),++p;break;case Se.CIRCLE:x=K[1];const Te=f[x],Ie=f[x+1],be=f[x+2],Me=f[x+3],Fe=be-Te,Ge=Me-Ie,lt=Math.sqrt(Fe*Fe+Ge*Ge);e.moveTo(Te+lt,Ie),e.arc(Te,Ie,lt,0,2*Math.PI,!0),++p;break;case Se.CLOSE_PATH:e.closePath(),++p;break;case Se.CUSTOM:x=K[1],I=K[2];const Qi=K[3],ds=K[4],Wn=K[5];ne.geometry=Qi,ne.feature=Z,p in N||(N[p]=[]);const $n=N[p];Wn?Wn(f,x,I,2,$n):($n[0]=f[x],$n[1]=f[x+1],$n.length=2),h&&(h.zIndex=K[6]),ds($n,ne),++p;break;case Se.DRAW_IMAGE:x=K[1],I=K[2],G=K[3],S=K[4],T=K[5];let hn=K[6];const dn=K[7],Kn=K[8],Ri=K[9],yt=K[10];let ct=K[11];const tn=K[12];let Ai=K[13];P=K[14]||"declutter";const It=K[15];if(!G&&K.length>=20){b=K[19],R=K[20],D=K[21],V=K[22];const Ot=this.drawLabelWithPointPlacement_(b,R,D,V);G=Ot.label,K[3]=G;const ki=K[23];S=(Ot.anchorX-ki)*this.pixelRatio,K[4]=S;const fn=K[24];T=(Ot.anchorY-fn)*this.pixelRatio,K[5]=T,hn=G.height,K[6]=hn,Ai=G.width,K[13]=Ai}let to;K.length>25&&(to=K[25]);let Pi,Cr,Ji;K.length>17?(Pi=K[16],Cr=K[17],Ji=K[18]):(Pi=Ja,Cr=null,Ji=null),yt&&ge?ct+=se:!yt&&!ge&&(ct-=se);let Rr=0;for(;x<I;x+=2){if(to&&to[Rr++]<Ai/this.pixelRatio)continue;const Ot=this.calculateImageOrLabelDimensions_(G.width,G.height,f[x],f[x+1],Ai,hn,S,T,Kn,Ri,ct,tn,s,Pi,!!Cr||!!Ji,Z),ki=[e,t,G,Ot,dn,Cr,Ji];if(u){let fn,Ft,gn;if(It){const rt=I-x;if(!It[rt]){It[rt]={args:ki,declutterMode:P};continue}const Bt=It[rt];fn=Bt.args,Ft=Bt.declutterMode,delete It[rt],gn=GS(fn)}let pn,nn;if(fn&&(Ft!=="declutter"||!u.collides(gn))&&(pn=!0),(P!=="declutter"||!u.collides(Ot.declutterBox))&&(nn=!0),Ft==="declutter"&&P==="declutter"){const rt=pn&&nn;pn=rt,nn=rt}pn&&(Ft!=="none"&&u.insert(gn),this.replayImageOrLabel_.apply(this,fn)),nn&&(P!=="none"&&u.insert(Ot.declutterBox),this.replayImageOrLabel_.apply(this,ki))}else this.replayImageOrLabel_.apply(this,ki)}++p;break;case Se.DRAW_CHARS:const ca=K[1],Ar=K[2],bi=K[3],Ol=K[4];V=K[5];const Pr=K[6],fs=K[7],no=K[8];D=K[9];const On=K[10];b=K[11],Array.isArray(b)&&(b=b.reduce(D5,"")),R=K[12];const gs=[K[13],K[13]];P=K[14]||"declutter";const br=K[15],kr=this.textStates[R],Fn=kr.font,Vn=[kr.scale[0]*fs,kr.scale[1]*fs];let ft;Fn in this.widths_?ft=this.widths_[Fn]:(ft={},this.widths_[Fn]=ft);const io=v4(f,ca,Ar,2),er=Math.abs(Vn[0])*bS(Fn,b,ft);if(Ol||er<=io){const Ot=this.textStates[R].textAlign,ki=(io-er)*p0(b,Ot),fn=b5(f,ca,Ar,2,b,ki,Pr,Math.abs(Vn[0]),bS,Fn,ft,ge?0:this.viewRotation_,br);e:if(fn){const Ft=[];let gn,pn,nn,rt,Bt;if(D)for(gn=0,pn=fn.length;gn<pn;++gn){Bt=fn[gn],nn=Bt[4],rt=this.createLabel(nn,R,"",D),S=Bt[2]+(Vn[0]<0?-On:On),T=bi*rt.height+(.5-bi)*2*On*Vn[1]/Vn[0]-no;const Xt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Bt[0],Bt[1],rt.width,rt.height,S,T,0,0,Bt[3],gs,!1,Ja,!1,Z);if(u&&P==="declutter"&&u.collides(Xt.declutterBox))break e;Ft.push([e,t,rt,Xt,1,null,null])}if(V)for(gn=0,pn=fn.length;gn<pn;++gn){Bt=fn[gn],nn=Bt[4],rt=this.createLabel(nn,R,V,""),S=Bt[2],T=bi*rt.height-no;const Xt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Bt[0],Bt[1],rt.width,rt.height,S,T,0,0,Bt[3],gs,!1,Ja,!1,Z);if(u&&P==="declutter"&&u.collides(Xt.declutterBox))break e;Ft.push([e,t,rt,Xt,1,null,null])}u&&P!=="none"&&u.load(Ft.map(GS));for(let Xt=0,Di=Ft.length;Xt<Di;++Xt)this.replayImageOrLabel_.apply(this,Ft[Xt])}}++p;break;case Se.END_GEOMETRY:if(o!==void 0){Z=K[1];const Ot=o(Z,W,P);if(Ot)return Ot}++p;break;case Se.FILL:ue?j++:this.fill_(e),++p;break;case Se.MOVE_TO_LINE_TO:for(x=K[1],I=K[2],le=f[x],ie=f[x+1],e.moveTo(le,ie),M=le+.5|0,k=ie+.5|0,x+=2;x<I;x+=2)le=f[x],ie=f[x+1],O=le+.5|0,F=ie+.5|0,(x==I-2||O!==M||F!==k)&&(e.lineTo(le,ie),M=O,k=F);++p;break;case Se.SET_FILL_STYLE:this.alignAndScaleFill_=K[2],j&&(this.fill_(e),j=0,z&&(e.stroke(),z=0)),e.fillStyle=K[1],++p;break;case Se.SET_STROKE_STYLE:z&&(e.stroke(),z=0),this.setStrokeStyle_(e,K),++p;break;case Se.STROKE:ue?z++:e.stroke(),++p;break;default:++p;break}}j&&this.fill_(e),z&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const $a=["Polygon","Circle","LineString","Image","Text","Default"],Yb=["Image","Text"],N5=$a.filter(n=>!Yb.includes(n));class L5{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=wr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new M5(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,u=Ks(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Qt(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let p;this.renderBuffer_!==void 0&&(p=Zi(),Jh(p,e),Jw(p,t*(this.renderBuffer_+r),p));const y=O5(r);let x;function I(F,G,b){const R=f.getImageData(0,0,l,l).data;for(let D=0,V=y.length;D<V;D++)if(R[y[D]]>0){if(!o||b==="none"||x!=="Image"&&x!=="Text"||o.includes(F)){const j=(y[D]-3)/4,z=r-j%l,N=r-(j/l|0),se=s(F,G,z*z+N*N);if(se)return se}f.clearRect(0,0,l,l);break}}const S=Object.keys(this.executorsByZIndex_).map(Number);S.sort(zs);let T,P,M,k,O;for(T=S.length-1;T>=0;--T){const F=S[T].toString();for(M=this.executorsByZIndex_[F],P=$a.length-1;P>=0;--P)if(x=$a[P],k=M[x],k!==void 0&&(O=k.executeHitDetection(f,u,i,I,p),O))return O}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return Xo(l,0,8,2,e,l),l}isEmpty(){return su(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(l?f3:zs),o=o||$a;const h=$a.length;for(let f=0,p=u.length;f<p;++f){const y=u[f].toString(),x=this.executorsByZIndex_[y];for(let I=0,S=o.length;I<S;++I){const T=o[I],P=x[T];if(P!==void 0){const M=l===null?void 0:P.getZIndexContext(),k=M?M.getContext():e,O=this.maxExtent_&&T!=="Image"&&T!=="Text";if(O&&(k.save(),this.clip(k,i)),!M||T==="Text"||T==="Image"?P.execute(k,t,i,r,s,l):M.pushFunction(F=>P.execute(F,t,i,r,s,l)),O&&k.restore(),M){M.offset();const F=u[f]*h+$a.indexOf(T);this.deferredZIndexContexts_[F]||(this.deferredZIndexContexts_[F]=[]),this.deferredZIndexContexts_[F].push(M)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(zs);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const m0={};function O5(n){if(m0[n]!==void 0)return m0[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let u=i[l];u||(u=[],i[l]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return m0[n]=r,r}function $S(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let wx=class Zb extends Nm{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;at(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||it(o)),at(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),at(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=Ue.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?Ue.LOADED:Ue.IDLE:u=Ue.LOADING:u=Ue.LOADED),this.color_=e.color!==void 0?uu(e.color):null,this.iconImage_=Np(o,l,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const p=this.getImage(1);if(p.width&&p.height)h=p.width,f=p.height;else if(p instanceof HTMLImageElement){this.initialOptions_=e;const y=()=>{if(this.unlistenImageChange(y),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale($S(x[0],x[1],e.width,e.height))};this.listenImageChange(y);return}}h!==void 0&&this.setScale($S(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Zb({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=Np(null,e,this.crossOrigin_,Ue.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Ue.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Ue.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(ze.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(ze.CHANGE,e)}ready(){return this.iconImage_.ready()}};const qr=.5;function F5(n,e,t,i,r,s,o,l,u){const h=r,f=n[0]*qr,p=n[1]*qr,y=Qt(f,p);y.imageSmoothingEnabled=!1;const x=y.canvas,I=new q4(y,qr,r,null,o,l,null),S=t.length,T=Math.floor((256*256*256-1)/S),P={};for(let k=1;k<=S;++k){const O=t[k-1],F=O.getStyleFunction()||i;if(!F)continue;let G=F(O,s);if(!G)continue;Array.isArray(G)||(G=[G]);const R=(k*T).toString(16).padStart(7,"#00000");for(let D=0,V=G.length;D<V;++D){const j=G[D],z=j.getGeometryFunction()(O);if(!z||!ri(h,z.getExtent()))continue;const N=j.clone(),se=N.getFill();se&&se.setColor(R);const ge=N.getStroke();ge&&(ge.setColor(R),ge.setLineDash(null)),N.setText(void 0);const ne=j.getImage();if(ne){const ie=ne.getImageSize();if(!ie)continue;const W=Qt(ie[0],ie[1],void 0,{alpha:!1}),K=W.canvas;W.fillStyle=R,W.fillRect(0,0,K.width,K.height),N.setImage(new wx({img:K,anchor:ne.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ne.getOrigin(),opacity:1,size:ne.getSize(),scale:ne.getScale(),rotation:ne.getRotation(),rotateWithView:ne.getRotateWithView()}))}const ue=N.getZIndex()||0;let Z=P[ue];Z||(Z={},P[ue]=Z,Z.Polygon=[],Z.Circle=[],Z.LineString=[],Z.Point=[]);const le=z.getType();if(le==="GeometryCollection"){const ie=z.getGeometriesArrayRecursive();for(let W=0,K=ie.length;W<K;++W){const Ee=ie[W];Z[Ee.getType().replace("Multi","")].push(Ee,N)}}else Z[le.replace("Multi","")].push(z,N)}}const M=Object.keys(P).map(Number).sort(zs);for(let k=0,O=M.length;k<O;++k){const F=P[M[k]];for(const G in F){const b=F[G];for(let R=0,D=b.length;R<D;R+=2){I.setStyle(b[R+1]);for(let V=0,j=e.length;V<j;++V)I.setTransform(e[V]),I.drawGeometry(b[R])}}}return y.getImageData(0,0,x.width,x.height)}function V5(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*qr),s=Math.floor(Math.round(n[1])*qr),o=(Dt(r,0,t.width-1)+Dt(s,0,t.height-1)*t.width)*4,l=t.data[o],u=t.data[o+1],f=t.data[o+2]+256*(u+256*l),p=Math.floor((256*256*256-1)/e.length);f&&f%p===0&&i.push(e[f/p-1])}return i}class Qb extends Ys{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const j5=5;class U5 extends Yd{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=j5}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return tt()}getData(e){return null}prepareFrame(e){return tt()}renderFrame(e,t){return tt()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Ue.LOADED||t.getState()===Ue.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Ue.LOADED&&t!=Ue.ERROR&&e.addEventListener(ze.CHANGE,this.boundHandleImageChange_),t==Ue.IDLE&&(e.load(),t=e.getState()),t==Ue.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const KS=[];let Mc=null;function z5(){Mc=Qt(1,1,void 0,{willReadFrequently:!0})}class Jb extends U5{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=wr(),this.pixelTransform=wr(),this.inversePixelTransform=wr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Mc||z5(),Mc.clearRect(0,0,1,1);let r;try{Mc.drawImage(e,t,i,1,1,0,0,1,1),r=Mc.getImageData(0,0,1,1).data}catch{return Mc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&aa(uu(e.style.backgroundColor),uu(i)))){const l=e.firstElementChild;Wo(l)&&(o=l.getContext("2d"))}if(o&&c4(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Ei?Db():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Qt();const u=o.canvas;s.appendChild(u),l=u.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=bl(i),s=Am(i),o=Rm(i),l=Cm(i);un(t.coordinateToPixelTransform,r),un(t.coordinateToPixelTransform,s),un(t.coordinateToPixelTransform,o),un(t.coordinateToPixelTransform,l);const u=this.inversePixelTransform;un(u,r),un(u,s),un(u,o),un(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(dt(i)/r*o),u=Math.round(Bn(i)/r*o);Ks(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-u/2),vb(this.inversePixelTransform,this.pixelTransform);const h=l4(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=u?(f.width=l,f.height=u):this.context.clearRect(0,0,l,u),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new Qb(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Hi.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Hi.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new qb),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Hi.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Hi.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const u=s/2,h=o/2,f=r/t,p=-f,y=-e[0]+l,x=-e[1];return Ks(this.tempTransform,u,h,f,p,-i,y,x)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class B5 extends Jb{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Zi(),this.wrappedRenderedExtent_=Zi(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,u=s.projection,h=s.rotation,f=u.getExtent(),p=this.getLayer().getSource(),y=this.getLayer().getDeclutter(),x=t.pixelRatio,I=t.viewHints,S=!(I[Nn.ANIMATING]||I[Nn.INTERACTING]),T=this.context,P=Math.round(dt(r)/l*x),M=Math.round(Bn(r)/l*x),k=p.getWrapX()&&u.canWrapX(),O=k?dt(f):null,F=k?Math.ceil((r[2]-f[2])/O)+1:1;let G=k?Math.floor((r[0]-f[0])/O):0;do{let b=this.getRenderTransform(o,l,0,x,P,M,G*O);t.declutter&&(b=b.slice(0)),e.execute(T,[T.canvas.width,T.canvas.height],b,h,S,i===void 0?$a:i?Yb:N5,i?y&&t.declutter[y]:void 0)}while(++G<F)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Qt(this.context.canvas.width,this.context.canvas.height,KS))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Mm(this.context),KS.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(Hi.PRERENDER)||this.getLayer().hasListener(Hi.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const u=Go(i.extent);l=ri(u,e.extent),this.clipped_=l&&!Uh(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],p=i[0]*qr,y=i[1]*qr;f.push(this.getRenderTransform(r,s,o,qr,p,y,0).slice());const x=h.getSource(),I=l.getExtent();if(x.getWrapX()&&l.canWrapX()&&!Uh(I,u)){let S=u[0];const T=dt(I);let P=0,M;for(;S<I[0];)--P,M=T*P,f.push(this.getRenderTransform(r,s,o,qr,p,y,M).slice()),S+=T;for(P=0,S=u[2];S>I[2];)++P,M=T*P,f.push(this.getRenderTransform(r,s,o,qr,p,y,M).slice()),S-=T}this.hitDetectionImageData_=F5(i,f,this.renderedFeatures_,h.getStyleFunction(),u,s,o,kS(s,this.renderedPixelRatio_))}t(V5(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},f=function(y,x,I){const S=it(y),T=h[S];if(T){if(T!==!0&&I<T.distanceSq){if(I===0)return h[S]=!0,s.splice(s.lastIndexOf(T),1),r(y,u,x);T.geometry=x,T.distanceSq=I}}else{if(I===0)return h[S]=!0,r(y,u,x);s.push(h[S]={feature:y,layer:u,geometry:x,distanceSq:I,callback:r})}},p=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,p?t.declutter?.[p]?.all().map(y=>y.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Nn.ANIMATING],s=e.viewHints[Nn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,f=h.projection,p=h.resolution,y=e.pixelRatio,x=t.getRevision(),I=t.getRenderBuffer();let S=t.getRenderOrder();S===void 0&&(S=Z4);const T=h.center.slice(),P=Jw(u,I*p),M=P.slice(),k=[P.slice()],O=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Uh(O,e.extent)){const se=dt(O),ge=Math.max(dt(P)/2,se);P[0]=O[0]-ge,P[2]=O[2]+ge,ub(T,f);const ne=lb(k[0],f);ne[0]<O[0]&&ne[2]<O[2]?k.push([ne[0]+se,ne[1],ne[2]+se,ne[3]]):ne[0]>O[0]&&ne[2]>O[2]&&k.push([ne[0]-se,ne[1],ne[2]-se,ne[3]])}if(this.ready&&this.renderedResolution_==p&&this.renderedRevision_==x&&this.renderedRenderOrder_==S&&this.renderedFrameDeclutter_===!!e.declutter&&Uh(this.wrappedRenderedExtent_,P))return aa(this.renderedExtent_,M)||(this.hitDetectionImageData_=null,this.renderedExtent_=M),this.renderedCenter_=T,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const F=new P5(Ub(p,y),P,p,y);let G;for(let se=0,ge=k.length;se<ge;++se)i.loadFeatures(k[se],p,f);const b=kS(p,y);let R=!0;const D=(se,ge)=>{let ne;const ue=se.getStyleFunction()||t.getStyleFunction();if(ue&&(ne=ue(se,p)),ne){const Z=this.renderFeature(se,b,ne,F,G,this.getLayer().getDeclutter(),ge);R=R&&!Z}},V=_b(P),j=i.getFeaturesInExtent(V);S&&j.sort(S);for(let se=0,ge=j.length;se<ge;++se)D(j[se],se);this.renderedFeatures_=j,this.ready=R;const z=F.finish(),N=new L5(P,p,y,i.getOverlaps(),z,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=p,this.renderedRevision_=x,this.renderedRenderOrder_=S,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=M,this.wrappedRenderedExtent_=P,this.renderedCenter_=T,this.renderedProjection_=f,this.renderedPixelRatio_=y,this.replayGroup_=N,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)u=DS(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||u;else u=DS(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return u}}let Dl=0;const zn=1<<Dl++,Xe=1<<Dl++,ni=1<<Dl++,fr=1<<Dl++,yl=1<<Dl++,Gh=1<<Dl++,Vg=Math.pow(2,Dl)-1,xx={[zn]:"boolean",[Xe]:"number",[ni]:"string",[fr]:"color",[yl]:"number[]",[Gh]:"size"},G5=Object.keys(xx).map(Number).sort(zs);function W5(n){return n in xx}function Wh(n){const e=[];for(const t of G5)$h(n,t)&&e.push(xx[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function $h(n,e){return(n&e)===e}function Ao(n,e){return n===e}class Zt{constructor(e,t){if(!W5(e))throw new Error(`literal expressions must have a specific type, got ${Wh(e)}`);this.type=e,this.value=t}}class $5{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function e2(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Sn(n,e,t){switch(typeof n){case"boolean":{if(Ao(e,ni))return new Zt(ni,n?"true":"false");if(!$h(e,zn))throw new Error(`got a boolean, but expected ${Wh(e)}`);return new Zt(zn,n)}case"number":{if(Ao(e,Gh))return new Zt(Gh,oi(n));if(Ao(e,zn))return new Zt(zn,!!n);if(Ao(e,ni))return new Zt(ni,n.toString());if(!$h(e,Xe))throw new Error(`got a number, but expected ${Wh(e)}`);return new Zt(Xe,n)}case"string":{if(Ao(e,fr))return new Zt(fr,gx(n));if(Ao(e,zn))return new Zt(zn,!!n);if(!$h(e,ni))throw new Error(`got a string, but expected ${Wh(e)}`);return new Zt(ni,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return nj(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Ao(e,Gh)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Zt(Gh,n)}if(Ao(e,fr)){if(n.length===3)return new Zt(fr,[...n,1]);if(n.length===4)return new Zt(fr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!$h(e,yl))throw new Error(`got an array of numbers, but expected ${Wh(e)}`);return new Zt(yl,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},K5={[te.Get]:Le(je(1,1/0),HS),[te.Var]:Le(je(1,1),H5),[te.Has]:Le(je(1,1/0),HS),[te.Id]:Le(X5,xc),[te.Concat]:Le(je(2,1/0),ot(ni)),[te.GeometryType]:Le(q5,xc),[te.LineMetric]:Le(xc),[te.Resolution]:Le(y0,xc),[te.Zoom]:Le(y0,xc),[te.Time]:Le(y0,xc),[te.Any]:Le(je(2,1/0),ot(zn)),[te.All]:Le(je(2,1/0),ot(zn)),[te.Not]:Le(je(1,1),ot(zn)),[te.Equal]:Le(je(2,2),ot(Vg)),[te.NotEqual]:Le(je(2,2),ot(Vg)),[te.GreaterThan]:Le(je(2,2),ot(Xe)),[te.GreaterThanOrEqualTo]:Le(je(2,2),ot(Xe)),[te.LessThan]:Le(je(2,2),ot(Xe)),[te.LessThanOrEqualTo]:Le(je(2,2),ot(Xe)),[te.Multiply]:Le(je(2,1/0),XS),[te.Coalesce]:Le(je(2,1/0),XS),[te.Divide]:Le(je(2,2),ot(Xe)),[te.Add]:Le(je(2,1/0),ot(Xe)),[te.Subtract]:Le(je(2,2),ot(Xe)),[te.Clamp]:Le(je(3,3),ot(Xe)),[te.Mod]:Le(je(2,2),ot(Xe)),[te.Pow]:Le(je(2,2),ot(Xe)),[te.Abs]:Le(je(1,1),ot(Xe)),[te.Floor]:Le(je(1,1),ot(Xe)),[te.Ceil]:Le(je(1,1),ot(Xe)),[te.Round]:Le(je(1,1),ot(Xe)),[te.Sin]:Le(je(1,1),ot(Xe)),[te.Cos]:Le(je(1,1),ot(Xe)),[te.Atan]:Le(je(1,2),ot(Xe)),[te.Sqrt]:Le(je(1,1),ot(Xe)),[te.Match]:Le(je(4,1/0),qS,Z5),[te.Between]:Le(je(3,3),ot(Xe)),[te.Interpolate]:Le(je(6,1/0),qS,Q5),[te.Case]:Le(je(3,1/0),Y5,J5),[te.In]:Le(je(2,2),ej),[te.Number]:Le(je(1,1/0),ot(Vg)),[te.String]:Le(je(1,1/0),ot(Vg)),[te.Array]:Le(je(1,1/0),ot(Xe)),[te.Color]:Le(je(1,4),ot(Xe)),[te.Band]:Le(je(1,3),ot(Xe)),[te.Palette]:Le(je(2,2),tj),[te.ToString]:Le(je(1,1),ot(zn|Xe|ni|fr))};function HS(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Zt(Xe,o);break}case"string":{r[s]=new Zt(ni,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function H5(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Zt(ni,i)]}function X5(n,e,t){t.featureId=!0}function q5(n,e,t){t.geometryType=!0}function y0(n,e,t){t.mapState=!0}function xc(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function je(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function XS(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Sn(n[s+1],e,t);r[s]=o}return r}function ot(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=Sn(e[o+1],n,i);s[o]=l}return s}}function Y5(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function qS(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function Z5(n,e,t){const i=n.length-1,r=ni|Xe|zn,s=Sn(n[1],r,t),o=Sn(n[n.length-1],e,t),l=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=Sn(n[u+2],s.type,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=Sn(n[u+3],o.type,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...l,o]}function Q5(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Zt(Xe,r);let o;try{o=Sn(n[2],Xe,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const l=new Array(n.length-3);for(let u=0;u<l.length;u+=2){try{const h=Sn(n[u+3],Xe,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=Sn(n[u+4],e,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function J5(n,e,t){const i=Sn(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Sn(n[s+1],zn,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Sn(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function ej(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=ni}else r=Xe;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const u=Sn(i[l],r,t);s[l]=u}catch(u){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${u.message}`)}return[Sn(n[1],r,t),...s]}function tj(n,e,t){let i;try{i=Sn(n[1],Xe,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=Sn(r[o],fr,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(l instanceof Zt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Le(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new $5(t,r,...s)}}function nj(n,e,t){const i=n[0],r=K5[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function t2(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return t2(n.getGeometries()[0]);default:return""}}function n2(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Zs(n,e,t){const i=Sn(n,e,t);return Ir(i)}function Ir(n,e){if(n instanceof Zt){if(n.type===fr&&typeof n.value=="string"){const i=gx(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return ij(n);case te.Get:case te.Var:case te.Has:return rj(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Ir(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return oj(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return sj(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return aj(n);case te.Case:return lj(n);case te.Match:return cj(n);case te.Interpolate:return uj(n);case te.ToString:return hj(n);default:throw new Error(`Unsupported operator ${t}`)}}function ij(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function rj(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;o=o[f]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function sj(n,e){const t=n.operator,i=Ir(n.args[0]),r=Ir(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function oj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),l=r[1](s),u=r[2](s);return o>=l&&o<=u};case te.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function aj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const u=r[2](s);return o>u?u:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function lj(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ir(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function cj(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ir(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function uj(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Ir(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,u;for(let h=2;h<t;h+=2){const f=i[h](r);let p=i[h+1](r);const y=Array.isArray(p);if(y&&(p=N4(p)),f>=o)return h===2?p:y?dj(s,o,l,u,f,p):Kh(s,o,l,u,f,p);l=f,u=p}return u}}function hj(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ir(n.args[s]);if(t===te.ToString)return s=>{const o=r[0](s);return n.args[0].type===fr?px(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function Kh(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,u=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function dj(n,e,t,i,r,s){if(r-t===0)return i;const l=CS(i),u=CS(s);let h=u[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[Kh(n,e,t,l[0],r,u[0]),Kh(n,e,t,l[1],r,u[1]),l[2]+Kh(n,e,t,0,r,h),Kh(n,e,t,i[3],r,s[3])];return L4(f)}function fj(n){return!0}function gj(n){const e=e2(),t=pj(n,e),i=n2();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=t2(r.getGeometry())),t(i)}}function YS(n){const e=e2(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Cv(n[o],e);const r=n2(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[u]=f,u+=1)}return s.length=u,s}}function pj(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Zs(s.filter,zn,e):fj;let l;if(Array.isArray(s.style)){const u=s.style.length;l=new Array(u);for(let h=0;h<u;++h)l[h]=Cv(s.style[h],e)}else l=[Cv(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const u=i[l].filter;if(u(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function Cv(n,e){const t=Rd(n,"",e),i=Ad(n,"",e),r=mj(n,e),s=yj(n,e),o=si(n,"z-index",e);if(!t&&!i&&!r&&!s&&!su(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new Yi;return function(u){let h=!0;if(t){const f=t(u);f&&(h=!1),l.setFill(f)}if(i){const f=i(u);f&&(h=!1),l.setStroke(f)}if(r){const f=r(u);f&&(h=!1),l.setText(f)}if(s){const f=s(u);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(u)),h?null:l}}function Rd(n,e,t){let i;if(e+"fill-pattern-src"in n)i=xj(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=Ex(n,e+"fill-color",t)}if(!i)return null;const r=new Tr;return function(s){const o=i(s);return o===fx?null:(r.setColor(o),r)}}function Ad(n,e,t){const i=si(n,e+"stroke-width",t),r=Ex(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Ms(n,e+"stroke-line-cap",t),o=Ms(n,e+"stroke-line-join",t),l=i2(n,e+"stroke-line-dash",t),u=si(n,e+"stroke-line-dash-offset",t),h=si(n,e+"stroke-miter-limit",t),f=new bu;return function(p){if(r){const y=r(p);if(y===fx)return null;f.setColor(y)}if(i&&f.setWidth(i(p)),s){const y=s(p);if(y!=="butt"&&y!=="round"&&y!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(y)}if(o){const y=o(p);if(y!=="bevel"&&y!=="round"&&y!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(y)}return l&&f.setLineDash(l(p)),u&&f.setLineDashOffset(u(p)),h&&f.setMiterLimit(h(p)),f}}function mj(n,e){const t="text-",i=Ms(n,t+"value",e);if(!i)return null;const r=Rd(n,t,e),s=Rd(n,t+"background-",e),o=Ad(n,t,e),l=Ad(n,t+"background-",e),u=Ms(n,t+"font",e),h=si(n,t+"max-angle",e),f=si(n,t+"offset-x",e),p=si(n,t+"offset-y",e),y=qc(n,t+"overflow",e),x=Ms(n,t+"placement",e),I=si(n,t+"repeat",e),S=Om(n,t+"scale",e),T=qc(n,t+"rotate-with-view",e),P=si(n,t+"rotation",e),M=Ms(n,t+"align",e),k=Ms(n,t+"justify",e),O=Ms(n,t+"baseline",e),F=qc(n,t+"keep-upright",e),G=i2(n,t+"padding",e),b=Fm(n,t+"declutter-mode"),R=new ef({declutterMode:b});return function(D){if(R.setText(i(D)),r&&R.setFill(r(D)),s&&R.setBackgroundFill(s(D)),o&&R.setStroke(o(D)),l&&R.setBackgroundStroke(l(D)),u&&R.setFont(u(D)),h&&R.setMaxAngle(h(D)),f&&R.setOffsetX(f(D)),p&&R.setOffsetY(p(D)),y&&R.setOverflow(y(D)),x){const V=x(D);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");R.setPlacement(V)}if(I&&R.setRepeat(I(D)),S&&R.setScale(S(D)),T&&R.setRotateWithView(T(D)),P&&R.setRotation(P(D)),M){const V=M(D);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");R.setTextAlign(V)}if(k){const V=k(D);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");R.setJustify(V)}if(O){const V=O(D);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");R.setTextBaseline(V)}return G&&R.setPadding(G(D)),F&&R.setKeepUpright(F(D)),R}}function yj(n,e){return"icon-src"in n?_j(n,e):"shape-points"in n?vj(n,e):"circle-radius"in n?wj(n,e):null}function _j(n,e){const t="icon-",i=t+"src",r=r2(n[i],i),s=Fp(n,t+"anchor",e),o=Om(n,t+"scale",e),l=si(n,t+"opacity",e),u=Fp(n,t+"displacement",e),h=si(n,t+"rotation",e),f=qc(n,t+"rotate-with-view",e),p=QS(n,t+"anchor-origin"),y=JS(n,t+"anchor-x-units"),x=JS(n,t+"anchor-y-units"),I=Sj(n,t+"color"),S=Tj(n,t+"cross-origin"),T=Ij(n,t+"offset"),P=QS(n,t+"offset-origin"),M=Vp(n,t+"width"),k=Vp(n,t+"height"),O=Ej(n,t+"size"),F=Fm(n,t+"declutter-mode"),G=new wx({src:r,anchorOrigin:p,anchorXUnits:y,anchorYUnits:x,color:I,crossOrigin:S,offset:T,offsetOrigin:P,height:k,width:M,size:O,declutterMode:F});return function(b){return l&&G.setOpacity(l(b)),u&&G.setDisplacement(u(b)),h&&G.setRotation(h(b)),f&&G.setRotateWithView(f(b)),o&&G.setScale(o(b)),s&&G.setAnchor(s(b)),G}}function vj(n,e){const t="shape-",i=t+"points",r=t+"radius",s=Rv(n[i],i),o=Rv(n[r],r),l=Rd(n,t,e),u=Ad(n,t,e),h=Om(n,t+"scale",e),f=Fp(n,t+"displacement",e),p=si(n,t+"rotation",e),y=qc(n,t+"rotate-with-view",e),x=Vp(n,t+"radius2"),I=Vp(n,t+"angle"),S=Fm(n,t+"declutter-mode"),T=new Lm({points:s,radius:o,radius2:x,angle:I,declutterMode:S});return function(P){return l&&T.setFill(l(P)),u&&T.setStroke(u(P)),f&&T.setDisplacement(f(P)),p&&T.setRotation(p(P)),y&&T.setRotateWithView(y(P)),h&&T.setScale(h(P)),T}}function wj(n,e){const t="circle-",i=Rd(n,t,e),r=Ad(n,t,e),s=si(n,t+"radius",e),o=Om(n,t+"scale",e),l=Fp(n,t+"displacement",e),u=si(n,t+"rotation",e),h=qc(n,t+"rotate-with-view",e),f=Fm(n,t+"declutter-mode"),p=new kl({radius:5,declutterMode:f});return function(y){return s&&p.setRadius(s(y)),i&&p.setFill(i(y)),r&&p.setStroke(r(y)),l&&p.setDisplacement(l(y)),u&&p.setRotation(u(y)),h&&p.setRotateWithView(h(y)),o&&p.setScale(o(y)),p}}function si(n,e,t){if(!(e in n))return;const i=Zs(n[e],Xe,t);return function(r){return Rv(i(r),e)}}function Ms(n,e,t){if(!(e in n))return null;const i=Zs(n[e],ni,t);return function(r){return r2(i(r),e)}}function xj(n,e,t){const i=Ms(n,e+"pattern-src",t),r=ZS(n,e+"pattern-offset",t),s=ZS(n,e+"pattern-size",t),o=Ex(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function qc(n,e,t){if(!(e in n))return null;const i=Zs(n[e],zn,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function Ex(n,e,t){if(!(e in n))return null;const i=Zs(n[e],fr,t);return function(r){return s2(i(r),e)}}function i2(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl,t);return function(r){return nf(i(r),e)}}function Fp(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl,t);return function(r){const s=nf(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function ZS(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl,t);return function(r){return o2(i(r),e)}}function Om(n,e,t){if(!(e in n))return null;const i=Zs(n[e],yl|Xe,t);return function(r){return Cj(i(r),e)}}function Vp(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function Ej(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return oi(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function Tj(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function QS(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function JS(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function Ij(n,e){const t=n[e];if(t!==void 0)return nf(t,e)}function Fm(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function Sj(n,e){const t=n[e];if(t!==void 0)return s2(t,e)}function nf(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function r2(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function Rv(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function s2(n,e){if(typeof n=="string")return n;const t=nf(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function o2(n,e){const t=nf(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function Cj(n,e){return typeof n=="number"?n:o2(n,e)}const cr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function eC(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,p=l?l[1]:0;let y=n[0]+u/2+f,x=n[2]-u/2+f,I=n[1]+h/2+p,S=n[3]-h/2+p;y>x&&(y=(x+y)/2,x=y),I>S&&(I=(S+I)/2,S=I);let T=Dt(i[0],y,x),P=Dt(i[1],I,S);if(o&&t&&r){const M=30*r;T+=-M*Math.log(1+Math.max(0,y-i[0])/M)+M*Math.log(1+Math.max(0,i[0]-x)/M),P+=-M*Math.log(1+Math.max(0,I-i[1])/M)+M*Math.log(1+Math.max(0,i[1]-S)/M)}return[T,P]})}function Rj(n){return n}function a2(n){return Math.pow(n,3)}function ku(n){return 1-a2(1-n)}function Aj(n){return 3*n*n-2*n*n*n}function Pj(n){return n}function Tx(n,e,t,i){const r=dt(e)/t[0],s=Bn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function Ix(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Dt(i,t/2,e*2)}function bj(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const u=n[0],h=n[n.length-1],f=t?Tx(u,t,o,i):u;if(l)return e?Ix(r,f,h):Dt(r,h,f);const p=Math.min(f,r),y=Math.floor(Zw(n,p,s));return n[y]>f&&y<n.length-1?n[y+1]:n[y]}})}function kj(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,u,h){if(o!==void 0){const f=r?Tx(e,r,u,s):e;if(h)return i?Ix(o,f,t):Dt(o,t,f);const p=1e-9,y=Math.ceil(Math.log(e/f)/Math.log(n)-p),x=-l*(.5-p)+.5,I=Math.min(f,o),S=Math.floor(Math.log(e/I)/Math.log(n)+x),T=Math.max(y,S),P=e/Math.pow(n,T);return Dt(P,t,f)}})}function tC(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,u){if(s!==void 0){const h=i?Tx(n,i,l,r):n;return!t||!u?Dt(s,e,h):Ix(s,h,e)}})}function Sx(n){if(n!==void 0)return 0}function nC(n){if(n!==void 0)return n}function Dj(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function Mj(n){const e=Ho(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const Nj=42,Cx=256,_0=0;class Yr extends ls{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=ox(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&yb(),e.center&&(e.center=Ds(e.center,this.projection_)),e.extent&&(e.extent=Go(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in cr)delete t[l];this.setProperties(t,!0);const i=Oj(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=Lj(e),s=i.constraint,o=Fj(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ds(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ds(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&jg(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],p={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||Aj,callback:i};if(f.center&&(p.sourceCenter=o,p.targetCenter=f.center.slice(),o=p.targetCenter),f.zoom!==void 0?(p.sourceResolution=l,p.targetResolution=this.getResolutionForZoom(f.zoom),l=p.targetResolution):f.resolution&&(p.sourceResolution=l,p.targetResolution=f.resolution,l=p.targetResolution),f.rotation!==void 0){p.sourceRotation=u;const y=ol(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=u+y,u=p.targetRotation}Vj(p)?p.complete=!0:s+=p.duration,h.push(p)}this.animations_.push(h),this.setHint(Nn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Nn.ANIMATING]>0}getInteracting(){return this.hints_[Nn.INTERACTING]>0}cancelAnimations(){this.setHint(Nn.ANIMATING,-this.hints_[Nn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&jg(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let f=u.duration>0?h/u.duration:1;f>=1?(u.complete=!0,f=1):s=!1;const p=u.easing(f);if(u.sourceCenter){const y=u.sourceCenter[0],x=u.sourceCenter[1],I=u.targetCenter[0],S=u.targetCenter[1];this.nextCenter_=u.targetCenter;const T=y+p*(I-y),P=x+p*(S-x);this.targetCenter_=[T,P]}if(u.sourceResolution&&u.targetResolution){const y=p===1?u.targetResolution:u.sourceResolution+p*(u.targetResolution-u.sourceResolution);if(u.anchor){const x=this.getViewportSize_(this.getRotation()),I=this.constraints_.resolution(y,0,x,!0);this.targetCenter_=this.calculateCenterZoom(I,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const y=p===1?ol(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+p*(u.targetRotation-u.sourceRotation);if(u.anchor){const x=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(x,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Nn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&jg(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],tx(i,e-this.getRotation()),R3(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&wv(e,this.getProjection())}getCenterInternal(){return this.get(cr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return _b(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();at(t,"The view center is not defined");const i=this.getResolution();at(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return at(r!==void 0,"The view rotation is not defined"),pv(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(cr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Go(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=dt(e)/t[0],r=Bn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(cr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=v0(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=Zw(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Dt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Dt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(at(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){at(!Pm(e),"Cannot fit empty extent provided as `geometry`");const r=Go(e,this.getProjection());i=NS(r)}else if(e.getType()==="Circle"){const r=Go(e.getExtent(),this.getProjection());i=NS(r),i.rotate(this.getRotation(),fl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,u=1/0,h=-1/0,f=-1/0;for(let p=0,y=s.length;p<y;p+=o){const x=s[p]*i-s[p+1]*r,I=s[p]*r+s[p+1]*i;l=Math.min(l,x),u=Math.min(u,I),h=Math.max(h,x),f=Math.max(f,I)}return[l,u,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),f=Math.sin(h),p=Math.cos(h),y=fl(l);y[0]+=(r[1]-r[3])/2*u,y[1]+=(r[0]-r[2])/2*u;const x=y[0]*p-y[1]*f,I=y[1]*p+y[0]*f,S=this.getConstrainedCenter([x,I],u),T=t.callback?t.callback:_d;t.duration!==void 0?this.animateInternal({resolution:u,center:S,duration:t.duration,easing:t.easing},T):(this.targetResolution_=u,this.targetCenter_=S,this.applyTargetState_(!1,!0),jg(T,!0))}centerOn(e,t,i){this.centerOnInternal(Ds(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(v0(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),u=v0(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=wv(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ds(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ds(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ds(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(cr.ROTATION)!==r&&this.set(cr.ROTATION,r),this.get(cr.RESOLUTION)!==o&&(this.set(cr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(cr.CENTER)||!Rp(this.get(cr.CENTER),l))&&this.set(cr.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Rp(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:e,easing:ku,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Nn.INTERACTING,1)}endInteraction(e,t,i){i=i&&Ds(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Nn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function jg(n,e){setTimeout(function(){n(e)},0)}function Lj(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return eC(n.extent,n.constrainOnlyCenter,t)}const e=ox(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,eC(t,!1,!1)}return Rj}function Oj(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:_0,l=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,p=n.showFullExtent!==void 0?n.showFullExtent:!1,y=ox(n.projection,"EPSG:3857"),x=y.getExtent();let I=n.constrainOnlyCenter,S=n.extent;if(!h&&!S&&y.isGlobal()&&(I=!1,S=x),n.resolutions!==void 0){const T=n.resolutions;t=T[o],i=T[l]!==void 0?T[l]:T[T.length-1],n.constrainResolution?e=bj(T,f,!I&&S,p):e=tC(t,i,f,!I&&S,p)}else{const P=(x?Math.max(dt(x),Bn(x)):360*lu.degrees/y.getMetersPerUnit())/Cx/Math.pow(2,_0),M=P/Math.pow(2,28-_0);t=n.maxResolution,t!==void 0?o=0:t=P/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,l):i=P/Math.pow(u,l):i=M),l=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,l-o),n.constrainResolution?e=kj(u,t,i,f,!I&&S,p):e=tC(t,i,f,!I&&S,p)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function Fj(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?Mj():t===!1?nC:typeof t=="number"?Dj(t):nC}return Sx}function Vj(n){return!(n.sourceCenter&&n.targetCenter&&!Rp(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function v0(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-u*o,f=u*s+l*o;return[h,f]}const ht={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class l2 extends ls{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[ht.OPACITY]=e.opacity!==void 0?e.opacity:1,at(typeof t[ht.OPACITY]=="number","Layer opacity must be a number"),t[ht.VISIBLE]=e.visible!==void 0?e.visible:!0,t[ht.Z_INDEX]=e.zIndex,t[ht.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[ht.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[ht.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[ht.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Dt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return tt()}getLayerStatesArray(e){return tt()}getExtent(){return this.get(ht.EXTENT)}getMaxResolution(){return this.get(ht.MAX_RESOLUTION)}getMinResolution(){return this.get(ht.MIN_RESOLUTION)}getMinZoom(){return this.get(ht.MIN_ZOOM)}getMaxZoom(){return this.get(ht.MAX_ZOOM)}getOpacity(){return this.get(ht.OPACITY)}getSourceState(){return tt()}getVisible(){return this.get(ht.VISIBLE)}getZIndex(){return this.get(ht.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(ht.EXTENT,e)}setMaxResolution(e){this.set(ht.MAX_RESOLUTION,e)}setMinResolution(e){this.set(ht.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(ht.MAX_ZOOM,e)}setMinZoom(e){this.set(ht.MIN_ZOOM,e)}setOpacity(e){at(typeof e=="number","Layer opacity must be a number"),this.set(ht.OPACITY,e)}setVisible(e){this.set(ht.VISIBLE,e)}setZIndex(e){this.set(ht.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Vm extends l2{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(ht.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(ht.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Rt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=nt(e,ze.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Yr?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return Rx(r,t.viewState)&&(!s||ri(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof Yr?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(ht.MAP,e)}getMapInternal(){return this.get(ht.MAP)}setMap(e){this.mapPrecomposeKey_&&(Rt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Rt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=nt(e,Hi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=nt(this,ze.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);at(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(ht.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Rx(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const iC={RENDER_ORDER:"renderOrder"};class c2 extends Vm{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(iC.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new Kb(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(iC.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Xb:e;const t=jj(e);this.styleFunction_=e===null?void 0:x5(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function jj(n){if(n===void 0)return Xb;if(!n)return null;if(typeof n=="function"||n instanceof Yi)return n;if(!Array.isArray(n))return YS([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Yi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Yi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return gj(r)}return YS(n)}class Ax extends c2{constructor(e){super(e)}createRenderer(){return new B5(this)}}const Po={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Vo extends Ys{constructor(e,t){super(e),this.layer=t}}const w0={LAYERS:"layers"};class Du extends l2{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(w0.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Ki(i.slice(),{unique:!0}):at(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Ki(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Rt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(nt(e,ei.ADD,this.handleLayersAdd_,this),nt(e,ei.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Rt);qd(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new Vo(Po.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[nt(e,ru.PROPERTYCHANGE,this.handleLayerChange_,this),nt(e,ze.CHANGE,this.handleLayerChange_,this)];e instanceof Du&&t.push(nt(e,Po.ADDLAYER,this.handleLayerGroupAdd_,this),nt(e,Po.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[it(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Vo(Po.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Vo(Po.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Vo(Po.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=it(t);this.listenerKeys_[i].forEach(Rt),delete this.listenerKeys_[i],this.dispatchEvent(new Vo(Po.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(w0.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Vo(Po.REMOVELAYER,i[r]))}this.set(w0.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=sl(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}}const Ce={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class Px extends Im{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(ze.CHANGE)}release(){this.setState(Ce.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Ce.EMPTY){if(this.state!==Ce.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){tt()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:a2(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Av(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const Uj=new Error("disposed"),zj=[256,256];class rC extends Px{constructor(e){const t=Ce.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Av(this.data_);return e?[e.width,e.height]:zj}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Ce.IDLE&&this.state!==Ce.ERROR)return;this.state=Ce.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Ce.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Ce.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(Uj),this.controller_=null),super.disposeInternal()}}class u2 extends Px{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Ei?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Ce.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Ce.ERROR,this.unlistenImage_(),this.image_=Bj(),this.changed()}handleImageLoad_(){if(Ei)this.state=Ce.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Ce.LOADED:this.state=Ce.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Ce.ERROR&&(this.state=Ce.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ce.IDLE&&(this.state=Ce.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=O4(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function Bj(){const n=Qt(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let x0;const Yc=[];function sC(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function E0(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function Gj(){if(x0===void 0){const n=Qt(6,6,Yc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",sC(n,4,5,4,0),sC(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;x0=E0(e,0)||E0(e,4)||E0(e,8),Mm(n),Yc.push(n.canvas)}return x0}function oC(n,e,t,i){const r=Dm(t,e,n);let s=bp(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const u=n.getExtent();if(!u||au(u,r)){const h=bp(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function Wj(n,e,t,i){const r=fl(t);let s=oC(n,e,r,i);return(!isFinite(s)||s<=0)&&ob(t,function(o){return s=oC(n,e,o,i),isFinite(s)&&s>0}),s}function $j(n,e,t,i,r,s,o,l,u,h,f,p,y,x){const I=Qt(Math.round(t*n),Math.round(t*e),Yc);if(p||(I.imageSmoothingEnabled=!1),u.length===0)return I.canvas;I.scale(t,t);function S(F){return Math.round(F*t)/t}I.globalCompositeOperation="lighter";const T=Zi();u.forEach(function(F,G,b){w3(T,F.extent)});let P;const M=t/i,k=(p?1:1+Math.pow(2,-24))/M;P=Qt(Math.round(dt(T)*M),Math.round(Bn(T)*M),Yc),p||(P.imageSmoothingEnabled=!1),u.forEach(function(F,G,b){if(F.image.width>0&&F.image.height>0){if(F.clipExtent){P.save();const z=(F.clipExtent[0]-T[0])*M,N=-(F.clipExtent[3]-T[3])*M,se=dt(F.clipExtent)*M,ge=Bn(F.clipExtent)*M;P.rect(p?z:Math.round(z),p?N:Math.round(N),p?se:Math.round(z+se)-Math.round(z),p?ge:Math.round(N+ge)-Math.round(N)),P.clip()}const R=(F.extent[0]-T[0])*M,D=-(F.extent[3]-T[3])*M,V=dt(F.extent)*M,j=Bn(F.extent)*M;P.drawImage(F.image,h,h,F.image.width-2*h,F.image.height-2*h,p?R:Math.round(R),p?D:Math.round(D),p?V:Math.round(R+V)-Math.round(R),p?j:Math.round(D+j)-Math.round(D)),F.clipExtent&&P.restore()}});const O=bl(o);return l.getTriangles().forEach(function(F,G,b){const R=F.source,D=F.target;let V=R[0][0],j=R[0][1],z=R[1][0],N=R[1][1],se=R[2][0],ge=R[2][1];const ne=S((D[0][0]-O[0])/s),ue=S(-(D[0][1]-O[1])/s),Z=S((D[1][0]-O[0])/s),le=S(-(D[1][1]-O[1])/s),ie=S((D[2][0]-O[0])/s),W=S(-(D[2][1]-O[1])/s),K=V,Ee=j;V=0,j=0,z-=K,N-=Ee,se-=K,ge-=Ee;const Te=[[z,N,0,0,Z-ne],[se,ge,0,0,ie-ne],[0,0,z,N,le-ue],[0,0,se,ge,W-ue]],Ie=C3(Te);if(!Ie)return;if(I.save(),I.beginPath(),Gj()||!p){I.moveTo(Z,le);const Me=4,Fe=ne-Z,Ge=ue-le;for(let lt=0;lt<Me;lt++)I.lineTo(Z+S((lt+1)*Fe/Me),le+S(lt*Ge/(Me-1))),lt!=Me-1&&I.lineTo(Z+S((lt+1)*Fe/Me),le+S((lt+1)*Ge/(Me-1)));I.lineTo(ie,W)}else I.moveTo(Z,le),I.lineTo(ne,ue),I.lineTo(ie,W);I.clip(),I.transform(Ie[0],Ie[2],Ie[1],Ie[3],ne,ue),I.translate(T[0]-K,T[3]-Ee);let be;if(P)be=P.canvas,I.scale(k,-k);else{const Me=u[0],Fe=Me.extent;be=Me.image,I.scale(dt(Fe)/be.width,-Bn(Fe)/be.height)}I.drawImage(be,0,0),I.restore()}),P&&(Mm(P),Yc.push(P.canvas)),f&&(I.save(),I.globalCompositeOperation="source-over",I.strokeStyle="black",I.lineWidth=1,l.getTriangles().forEach(function(F,G,b){const R=F.target,D=(R[0][0]-O[0])/s,V=-(R[0][1]-O[1])/s,j=(R[1][0]-O[0])/s,z=-(R[1][1]-O[1])/s,N=(R[2][0]-O[0])/s,se=-(R[2][1]-O[1])/s;I.beginPath(),I.moveTo(j,z),I.lineTo(D,V),I.lineTo(N,se),I.closePath(),I.stroke()}),I.restore()),I.canvas}const Kj=10,aC=.25;class Hj{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let u={};const h=l?i4(k=>un(l,Dm(k,this.targetProj_,this.sourceProj_))):kp(this.targetProj_,this.sourceProj_);this.transformInv_=function(k){const O=k[0]+"/"+k[1];return u[O]||(u[O]=h(k)),u[O]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&dt(r)>=dt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?dt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?dt(this.targetProj_.getExtent()):null;const f=bl(i),p=Am(i),y=Rm(i),x=Cm(i),I=this.transformInv_(f),S=this.transformInv_(p),T=this.transformInv_(y),P=this.transformInv_(x),M=Kj+(o?Math.max(0,Math.ceil(Math.log2(gv(i)/(o*o*256*256)))):0);if(this.addQuad_(f,p,y,x,I,S,T,P,M),this.wrapsXInSource_){let k=1/0;this.triangles_.forEach(function(O,F,G){k=Math.min(k,O.source[0][0],O.source[1][0],O.source[2][0])}),this.triangles_.forEach(O=>{if(Math.max(O.source[0][0],O.source[1][0],O.source[2][0])-k>this.sourceWorldWidth_/2){const F=[[O.source[0][0],O.source[0][1]],[O.source[1][0],O.source[1][1]],[O.source[2][0],O.source[2][1]]];F[0][0]-k>this.sourceWorldWidth_/2&&(F[0][0]-=this.sourceWorldWidth_),F[1][0]-k>this.sourceWorldWidth_/2&&(F[1][0]-=this.sourceWorldWidth_),F[2][0]-k>this.sourceWorldWidth_/2&&(F[2][0]-=this.sourceWorldWidth_);const G=Math.min(F[0][0],F[1][0],F[2][0]);Math.max(F[0][0],F[1][0],F[2][0])-G<this.sourceWorldWidth_/2&&(O.source=F)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,u,h){const f=aS([s,o,l,u]),p=this.sourceWorldWidth_?dt(f)/this.sourceWorldWidth_:null,y=this.sourceWorldWidth_,x=this.sourceProj_.canWrapX()&&p>.5&&p<1;let I=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const T=aS([e,t,i,r]);I=dt(T)/this.targetWorldWidth_>aC||I}!x&&this.sourceProj_.isGlobal()&&p&&(I=p>aC||I)}if(!I&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!ri(f,this.maxSourceExtent_))return;let S=0;if(!I&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)I=!0;else if(S=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),S!=1&&S!=2&&S!=4&&S!=8)return}if(h>0){if(!I){const T=[(e[0]+i[0])/2,(e[1]+i[1])/2],P=this.transformInv_(T);let M;x?M=(ol(s[0],y)+ol(l[0],y))/2-ol(P[0],y):M=(s[0]+l[0])/2-P[0];const k=(s[1]+l[1])/2-P[1];I=M*M+k*k>this.errorThresholdSquared_}if(I){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const T=[(t[0]+i[0])/2,(t[1]+i[1])/2],P=this.transformInv_(T),M=[(r[0]+e[0])/2,(r[1]+e[1])/2],k=this.transformInv_(M);this.addQuad_(e,t,T,M,s,o,P,k,h-1),this.addQuad_(M,T,i,r,k,P,l,u,h-1)}else{const T=[(e[0]+t[0])/2,(e[1]+t[1])/2],P=this.transformInv_(T),M=[(i[0]+r[0])/2,(i[1]+r[1])/2],k=this.transformInv_(M);this.addQuad_(e,T,M,r,s,P,k,u,h-1),this.addQuad_(T,t,i,M,P,o,l,k,h-1)}return}}if(x){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(S&11)==0&&this.addTriangle_(e,i,r,s,l,u),(S&14)==0&&this.addTriangle_(e,i,t,s,l,o),S&&((S&13)==0&&this.addTriangle_(t,r,e,o,u,s),(S&7)==0&&this.addTriangle_(t,r,i,o,u,l))}calculateSourceExtent(){const e=Zi();return this.triangles_.forEach(function(t,i,r){const s=t.source;Jh(e,s[0]),Jh(e,s[1]),Jh(e,s[2])}),e}getTriangles(){return this.triangles_}}const Xj=.5;class h2 extends Px{constructor(e,t,i,r,s,o,l,u,h,f,p,y){super(s,Ce.IDLE,y),this.renderEdges_=p!==void 0?p:!1,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const x=r.getTileCoordExtent(this.wrappedTileCoord_),I=this.targetTileGrid_.getExtent();let S=this.sourceTileGrid_.getExtent();const T=I?sl(x,I):x;if(gv(T)===0){this.state=Ce.EMPTY;return}const P=e.getExtent();P&&(S?S=sl(S,P):S=P);const M=r.getResolution(this.wrappedTileCoord_[0]),k=Wj(e,i,T,M);if(!isFinite(k)||k<=0){this.state=Ce.EMPTY;return}const O=f!==void 0?f:Xj;if(this.triangulation_=new Hj(e,i,T,S,k*O,M),this.triangulation_.getTriangles().length===0){this.state=Ce.EMPTY;return}this.sourceZ_=t.getZForResolution(k);let F=this.triangulation_.calculateSourceExtent();if(S&&(e.canWrapX()?(F[1]=Dt(F[1],S[1],S[3]),F[3]=Dt(F[3],S[1],S[3])):F=sl(F,S)),!gv(F))this.state=Ce.EMPTY;else{let G=0,b=0;e.canWrapX()&&(G=dt(P),b=Math.floor((F[0]-P[0])/G)),cb(F.slice(),e,!0).forEach(D=>{const V=t.getTileRangeForExtentAndZ(D,this.sourceZ_);for(let j=V.minX;j<=V.maxX;j++)for(let z=V.minY;z<=V.maxY;z++){const N=h(this.sourceZ_,j,z,l);if(N){const se=b*G;this.sourceTiles_.push({tile:N,offset:se})}}++b}),this.sourceTiles_.length===0&&(this.state=Ce.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Ce.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Ce.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=$j(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Ce.LOADED}this.changed()}load(){if(this.state==Ce.IDLE){this.state=Ce.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Ce.IDLE||i==Ce.LOADING){e++;const r=nt(t,ze.CHANGE,s=>{const o=t.getState();(o==Ce.LOADED||o==Ce.ERROR||o==Ce.EMPTY)&&(Rt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Ce.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Rt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Mm(this.canvas_.getContext("2d")),Yc.push(this.canvas_),this.canvas_=null),super.release()}}class bx{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Ec(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new bx(n,e,t,i)}class lC{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Em&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return at(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return at(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){at(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function jp(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function qj(n,e,t){return n+"/"+e+"/"+t}function rp(n,e,t,i,r){return`${it(n)},${e},${qj(t,i,r)}`}function Yj(n){return Zj(n[0],n[1],n[2])}function Zj(n,e,t){return(e<<n)+t}function Qj(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function T0(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function Jj(n,e,t){const i=n[t];return i?i.delete(e):!1}function cC(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=sl(e,Go(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=sl(e,r))}return e}class e6 extends Jb{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Zi(),this.tempTileRange_=new bx(0,0,0,0),this.tempTileCoord_=jp(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new lC(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new lC(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),u=rp(l,l.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const f=r.viewState.projection,p=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!p||ip(p,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=un(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!au(s,r))return null;const o=t.viewState,l=i.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const p=u.getTileCoordForCoordAndZ(r,f),y=this.getTile(f,p[1],p[2],t);if(!y||y.getState()!==Ce.LOADED)continue;const x=u.getOrigin(f),I=oi(u.getTileSize(f)),S=u.getResolution(f);let T;if(y instanceof u2||y instanceof h2)T=y.getImage();else if(y instanceof rC){if(T=Av(y.getData()),!T)continue}else continue;const P=Math.floor(h*((r[0]-x[0])/S-p[1]*I[0])),M=Math.floor(h*((x[1]-r[1])/S-p[2]*I[1])),k=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(T,P+k,M+k)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(o.projection),f=it(u);f in e.wantedTiles||(e.wantedTiles[f]={});const p=e.wantedTiles[f],y=l.getMapInternal(),x=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),y?y.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),I=o.rotation,S=I?ab(o.center,o.resolution,I,e.size):void 0;for(let T=i;T>=x;--T){const P=h.getTileRangeForExtentAndZ(t,T,this.tempTileRange_),M=h.getResolution(T);for(let k=P.minX;k<=P.maxX;++k)for(let O=P.minY;O<=P.maxY;++O){if(I&&!h.tileCoordIntersectsViewport([T,k,O],S))continue;const F=this.getTile(T,k,O,e);if(!F||!T0(r,F,T))continue;const b=F.getKey();if(p[b]=!0,F.getState()===Ce.IDLE&&!e.tileQueue.isKeyQueued(b)){const R=jp(T,k,O,this.tempTileCoord_);e.tileQueue.enqueue([F,f,h.getTileCoordCenter(R),M])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let u=0;u<l.length;++u){const h=rp(this.getLayer().getSource(),l[u],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Ce.LOADED)return f.endTransition(it(this)),T0(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let p=s.minY;p<=s.maxY;++p){const y=rp(u,h,i,f,p);let x=!1;if(l.containsKey(y)){const I=l.peek(y);I.getState()===Ce.LOADED&&(T0(r,I,i),x=!0)}x||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,u=e.pixelRatio,h=this.getLayer(),f=h.getSource(),p=f.getTileGridForProjection(s),y=p.getZForResolution(o,f.zDirection),x=p.getResolution(y),I=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==I&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=I):this.renderedSourceKey_=I;let S=e.extent;const T=f.getTilePixelRatio(u);this.prepareContainer(e,t);const P=this.context.canvas.width,M=this.context.canvas.height,k=i.extent&&Go(i.extent);k&&(S=sl(S,Go(i.extent)));const O=x*P/2/T,F=x*M/2/T,G=[l[0]-O,l[1]-F,l[0]+O,l[1]+F],b={};this.renderedTiles.length=0;const R=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const Z=p.getZForResolution(r.nextResolution,f.zDirection),le=cC(e,e.nextExtent);this.enqueueTiles(e,le,Z,b,R)}const D=cC(e,S);if(this.enqueueTiles(e,D,y,b,0),R>0&&setTimeout(()=>{this.enqueueTiles(e,D,y-1,b,R-1)},0),!(y in b))return this.container;const V=it(this),j=e.time;for(const Z of b[y]){const le=Z.getState();if(le===Ce.EMPTY)continue;const ie=Z.tileCoord;if(le===Ce.LOADED&&Z.getAlpha(V,j)===1){Z.endTransition(V);continue}if(le!==Ce.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ie,b)){Jj(b,Z,y),e.animate=!0;continue}if(this.findAltTiles_(p,ie,y+1,b))continue;const Ee=p.getMinZoom();for(let Te=y-1;Te>=Ee&&!this.findAltTiles_(p,ie,Te,b);--Te);}const z=x/o*u/T,N=this.getRenderContext(e);Ks(this.tempTransform,P/2,M/2,z,z,0,-P/2,-M/2),i.extent&&this.clipUnrotated(N,e,k),f.getInterpolate()||(N.imageSmoothingEnabled=!1),this.preRender(N,e);const se=Object.keys(b).map(Number);se.sort(zs);let ge;const ne=[],ue=[];for(let Z=se.length-1;Z>=0;--Z){const le=se[Z],ie=f.getTilePixelSize(le,u,s),K=p.getResolution(le)/x,Ee=ie[0]*K*z,Te=ie[1]*K*z,Ie=p.getTileCoordForCoordAndZ(bl(G),le),be=p.getTileCoordExtent(Ie),Me=un(this.tempTransform,[T*(be[0]-G[0])/x,T*(G[3]-be[3])/x]),Fe=T*f.getGutterForProjection(s);for(const Ge of b[le]){if(Ge.getState()!==Ce.LOADED)continue;const lt=Ge.tileCoord,Qi=Ie[1]-lt[1],ds=Math.round(Me[0]-(Qi-1)*Ee),Wn=Ie[2]-lt[2],$n=Math.round(Me[1]-(Wn-1)*Te),hn=Math.round(Me[0]-Qi*Ee),dn=Math.round(Me[1]-Wn*Te),Kn=ds-hn,Ri=$n-dn,yt=se.length===1;let ct=!1;ge=[hn,dn,hn+Kn,dn,hn+Kn,dn+Ri,hn,dn+Ri];for(let tn=0,Ai=ne.length;tn<Ai;++tn)if(!yt&&le<ue[tn]){const It=ne[tn];ri([hn,dn,hn+Kn,dn+Ri],[It[0],It[3],It[4],It[7]])&&(ct||(N.save(),ct=!0),N.beginPath(),N.moveTo(ge[0],ge[1]),N.lineTo(ge[2],ge[3]),N.lineTo(ge[4],ge[5]),N.lineTo(ge[6],ge[7]),N.moveTo(It[6],It[7]),N.lineTo(It[4],It[5]),N.lineTo(It[2],It[3]),N.lineTo(It[0],It[1]),N.clip())}ne.push(ge),ue.push(le),this.drawTile(Ge,e,hn,dn,Kn,Ri,Fe,yt),ct&&N.restore(),this.renderedTiles.unshift(Ge),this.updateUsedTiles(e.usedTiles,f,Ge)}}if(this.renderedResolution=x,this.extentChanged=!this.renderedExtent_||!vd(this.renderedExtent_,G),this.renderedExtent_=G,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&N.restore(),N.imageSmoothingEnabled=!0,this.renderComplete){const Z=(le,ie)=>{const W=it(f),K=ie.wantedTiles[W],Ee=K?Object.keys(K).length:0;this.updateCacheSize(Ee),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(Z)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,u){let h;if(e instanceof rC){if(h=Av(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),p=it(this),y=t.layerStatesArray[t.layerIndex],x=y.opacity*(u?e.getAlpha(p,t.time):1),I=x!==f.globalAlpha;I&&(f.save(),f.globalAlpha=x),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),I&&f.restore(),x!==y.opacity?t.animate=!0:u&&e.endTransition(p)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=it(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Ug={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class t6 extends Vm{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Ug.PRELOAD)}setPreload(e){this.set(Ug.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Ug.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Ug.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class I0 extends t6{constructor(e){super(e)}createRenderer(){return new e6(this,{cacheSize:this.getCacheSize()})}}const Tc=[0,0,0],bo=5;class d2{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,at(p3(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,at(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=bl(i)),at(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,at(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Cx,at(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new bx(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,u=r.maxY;l<=u;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Ec(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Ec(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Ec(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),f=Math.floor(o*u);if(t<r)return Ec(h,h,f,f,i);const p=Math.floor(u*(s+1))-1,y=Math.floor(u*(o+1))-1;return Ec(h,p,f,y,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Tc);const r=Tc[1],s=Tc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Tc);const o=Tc[1],l=Tc[2];return Ec(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=oi(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=oi(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=l+s[1]*r;return ta(o,l,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),u=this.getOrigin(o),h=oi(this.getTileSize(o),this.tmpSize_);let f=l*(e-u[0])/i/h[0],p=l*(u[1]-t)/i/h[1];return r?(f=kg(f,bo)-1,p=kg(p,bo)-1):(f=bg(f,bo),p=bg(p,bo)),jp(o,f,p,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),u=oi(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/u[0],f=(o[1]-t)/l/u[1];return r?(h=kg(h,bo)-1,f=kg(f,bo)-1):(h=bg(h,bo),f=bg(f,bo)),jp(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=Zw(this.resolutions_,e,t||0);return Dt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return Rb(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function f2(n){let e=n.getDefaultTileGrid();return e||(e=s6(n),n.setDefaultTileGrid(e)),e}function n6(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=kx(t);if(!au(s,r)){const o=dt(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function i6(n,e,t,i){i=i!==void 0?i:"top-left";const r=g2(n,e,t);return new d2({extent:n,origin:E3(n,i),resolutions:r,tileSize:t})}function r6(n){const e=n||{},t=e.extent||ai("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:g2(t,e.maxZoom,e.tileSize,e.maxResolution)};return new d2(i)}function g2(n,e,t,i){e=e!==void 0?e:Nj,t=oi(t!==void 0?t:Cx);const r=Bn(n),s=dt(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let u=0;u<o;++u)l[u]=i/Math.pow(2,u);return l}function s6(n,e,t,i){const r=kx(n);return i6(r,e,t,i)}function kx(n){n=ai(n);let e=n.getExtent();if(!e){const t=180*lu.degrees/n.getMetersPerUnit();e=ta(-t,-t,t,t)}return e}function DH(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const o6=/\{z\}/g,a6=/\{x\}/g,l6=/\{y\}/g,c6=/\{-y\}/g;function u6(n,e,t,i,r){return n.replace(o6,e.toString()).replace(a6,t.toString()).replace(l6,i.toString()).replace(c6,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function h6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function d6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return u6(n,o,t[1],t[2],s)})}function f6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=d6(n[r],e);return g6(i)}function g6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=Yj(e),s=ol(r,n.length);return n[s](e,t,i)})}class p6 extends Hb{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&oi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||it(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return tt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:f2(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=oi(r.getTileSize(e),this.tmpSize);return s==1?o:w5(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=n6(r,e,i)),Qj(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class m6 extends Ys{constructor(e,t){super(e),this.tile=t}}const S0={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class Dx extends p6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Dx.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=it(t),r=t.getState();let s;r==Ce.LOADING?(this.tileLoadingKeys_[i]=!0,s=S0.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Ce.ERROR?S0.TILELOADERROR:r==Ce.LOADED?S0.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new m6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=h6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(f6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class y6 extends Dx{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:p2,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:u2,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!ip(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||ip(t,e)))return this.tileGrid;const i=it(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=f2(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(l,h!==void 0?Ce.IDLE:Ce.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(ze.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||ip(l,s))return this.getTileInternal(e,t,i,r,l||s);const u=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),p=this.getTileGridForProjection(s),y=this.getTileCoordForTileUrlFunction(u,s),x=new h2(l,f,s,p,u,y,this.getTilePixelRatio(r),this.getGutter(),(I,S,T,P)=>this.getTileInternal(I,S,T,P,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return x.key=h,x}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),u=rp(this,l,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,l);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=ai(e);if(i){const r=it(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function p2(n,e){if(Ei){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Pv extends y6{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:r6({extent:kx(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const _6="modulepreload",v6=function(n){return"/visapp/"+n},uC={},zg=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=v6(h),h in uC)return;uC[h]=!0;const f=h.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":_6,f||(y.as="script"),y.crossOrigin="",y.href=h,l&&y.setAttribute("nonce",l),document.head.appendChild(y),f)return new Promise((x,I)=>{y.addEventListener("load",x),y.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},w6='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class x6 extends Pv{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[w6];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Ei&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||p2)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const Up=1/0;class E6{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,qd(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){at(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=Up?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[u]?h:u;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,u;for(l=0;l<s;++l)o=t[l],u=e(o),u==Up?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class T6 extends E6{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(ze.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Ce.LOADED||i===Ce.ERROR||i===Ce.EMPTY){i!==Ce.ERROR&&t.removeEventListener(ze.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Ce.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function I6(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Up;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Nc extends Ys{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Oo extends Nc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Nt={SINGLECLICK:"singleclick",CLICK:ze.CLICK,DBLCLICK:ze.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},bv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class S6 extends Im{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=nt(i,bv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=nt(i,bv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(ze.TOUCHMOVE,this.boundHandleTouchMove_,kb?{passive:!1}:!1)}emulateClick_(e){let t=new Oo(Nt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Oo(Nt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Oo(Nt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Nt.POINTERUP||t.type==Nt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Nt.POINTERDOWN||t.type==Nt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Oo(Nt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Oo(Nt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(nt(i,Nt.POINTERMOVE,this.handlePointerMove_,this),nt(i,Nt.POINTERUP,this.handlePointerUp_,this),nt(this.element_,Nt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(nt(this.element_.getRootNode(),Nt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Oo(Nt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Oo(Nt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Rt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ze.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Rt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Rt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Fo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Dn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class jm extends ls{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Rt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==_d&&this.listenerKeys.push(nt(e,Fo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class C6 extends jm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(ze.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+Jd+" "+mx+(this.collapsed_&&this.collapsible_?" "+RS:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>m3(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!aa(t,this.renderedAttributions_)){S4(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(RS),this.collapsed_?SS(this.collapseLabel_,this.label_):SS(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class R6 extends jm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(ze.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+Jd+" "+mx,u=this.element;u.className=l,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ng)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:ku}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Ng);!s&&i===0?this.element.classList.add(Ng):s&&i!==0&&this.element.classList.remove(Ng)}this.label_.style.transform=r}this.rotation_=i}}class A6 extends jm{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(ze.CLICK,this.handleClick_.bind(this,i),!1);const p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=h,p.appendChild(typeof l=="string"?document.createTextNode(l):l),p.addEventListener(ze.CLICK,this.handleClick_.bind(this,-i),!1);const y=t+" "+Jd+" "+mx,x=this.element;x.className=y,x.appendChild(f),x.appendChild(p),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:ku})):i.setZoom(s)}}}function P6(n){n=n||{};const e=new Ki;return(n.zoom===void 0||n.zoom)&&e.push(new A6(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new R6(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new C6(n.attributionOptions)),e}class b6{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const hC={ACTIVE:"active"};class rf extends ls{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(hC.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(hC.ACTIVE,e)}setMap(e){this.map_=e}}function k6(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:Pj,center:n.getConstrainedCenter(r)})}}function Mx(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:ku})}class D6 extends rf{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Nt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();Mx(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function kv(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const M6=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},N6=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},m2=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?N6(n):!0},L6=yd,y2=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(T4&&Pb&&e.ctrlKey)},_2=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},O6=function(n){const e=n.originalEvent;return Pb?e.metaKey:e.ctrlKey},F6=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},v2=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},C0=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},V6=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class sf extends rf{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Nt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Nt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Nt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Nt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function Nx(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class j6 extends sf{constructor(e){super({stopDown:Tm}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:kv(_2,V6);this.condition_=e.onFocusOnly?kv(m2,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(Nx(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();A3(s,l.getResolution()),tx(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:ku})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class U6 extends sf{constructor(e){e=e||{},super({stopDown:Tm}),this.condition_=e.condition?e.condition:M6,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!C0(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===Sx)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return C0(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return C0(e)&&y2(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class z6 extends Em{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Cd([r])}getGeometry(){return this.geometry_}}const Ic={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ph extends Ys{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class B6 extends sf{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new z6(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??y2,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ph(Ic.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Ph(t?Ic.BOXEND:Ic.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ph(Ic.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Ic.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Ic.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class G6 extends B6{constructor(e){e=e||{};const t=e.condition?e.condition:F6;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:ku})}}const Oa={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class W6 extends rf{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return _2(t)&&v2(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==ze.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Oa.DOWN||r==Oa.LEFT||r==Oa.RIGHT||r==Oa.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==Oa.DOWN?h=-l:r==Oa.LEFT?u=-l:r==Oa.RIGHT?u=l:h=l;const f=[u,h];tx(f,o.getRotation()),k6(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class $6 extends rf{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!O6(t)&&v2(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==ze.KEYDOWN||e.type==ze.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();Mx(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const K6=40,H6=300;class X6 extends rf{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:L6;this.condition_=e.onFocusOnly?kv(m2,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==ze.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=K6;break;case WheelEvent.DOM_DELTA_PAGE:s*=H6;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Mx(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class q6 extends sf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Tm),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==Sx&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Nx(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class Y6 extends sf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Tm),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(Nx(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function Z6(n){n=n||{};const e=new Ki,t=new b6(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new U6),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new D6({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new j6({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new q6),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new Y6({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new W6),e.push(new $6({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new X6({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new G6({duration:n.zoomDuration})),e}class Q6 extends Em{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){tt()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Ks(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),vb(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,u){let h;const f=t.viewState;function p(O,F,G,b){return s.call(o,F,O?G:null,b)}const y=f.projection,x=ub(e.slice(),y),I=[[0,0]];if(y.canWrapX()&&r){const O=y.getExtent(),F=dt(O);I.push([-F,0],[F,0])}const S=t.layerStatesArray,T=S.length,P=[],M=[];for(let O=0;O<I.length;O++)for(let F=T-1;F>=0;--F){const G=S[F],b=G.layer;if(b.hasRenderer()&&Rx(G,f)&&l.call(u,b)){const R=b.getRenderer(),D=b.getSource();if(R&&D){const V=D.getWrapX()?x:e,j=p.bind(null,G.managed);M[0]=V[0]+I[O][0],M[1]=V[1]+I[O][1],h=R.forEachFeatureAtCoordinate(M,t,i,j,P)}if(h)return h}}if(P.length===0)return;const k=1/P.length;return P.forEach((O,F)=>O.distanceSq+=F*k),P.sort((O,F)=>O.distanceSq-F.distanceSq),P.some(O=>h=O.callback(O.feature,O.layer,O.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,yd,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){tt()}scheduleExpireIconCache(e){Xi.canExpireCache()&&e.postRenderFunctions.push(J6)}}function J6(n,e){Xi.expire()}class eU extends Q6{constructor(e){super(e),this.fontChangeListenerKey_=nt(kc,ru.PROPERTYCHANGE,e.redrawText,e),this.element_=Ei?Db():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Jd+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new Qb(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Rt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Hi.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof c2&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const p=t[h];e.layerIndex=h;const y=p.layer,x=y.getSourceState();if(!Rx(p,r)||x!="ready"&&x!="undefined"){y.unrender();continue}const I=y.render(e,o);I&&(I!==o&&(this.children_.push(I),o=I),s.push(p))}this.declutter(e,s),C4(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Wo(u)){const h=u.getContext("2d");for(const f of this.children_){const p=f.firstElementChild||f,y=f.style.backgroundColor;if(y&&(!Wo(p)||p.width>0)&&(h.fillStyle=y,h.fillRect(0,0,u.width,u.height)),Wo(p)&&p.width>0){const x=f.style.opacity||p.style.opacity;h.globalAlpha=x===""?1:Number(x);const I=p.style.transform;if(I)h.setTransform(...xv(I));else{const S=parseFloat(p.style.width)/p.width,T=parseFloat(p.style.height)/p.height;h.setTransform(S,0,0,T,0,0)}h.drawImage(p,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Hi.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function w2(n){if(n instanceof Vm){n.setMapInternal(null);return}n instanceof Du&&n.getLayers().forEach(w2)}function x2(n,e){if(n instanceof Vm){n.setMapInternal(e);return}if(n instanceof Du){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)x2(t[i],e)}}let tU=class extends ls{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=nU(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:I4,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=wr(),this.pixelToCoordinateTransform_=wr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ei||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ei||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ei?new Ki:P6()),this.interactions=t.interactions||(Ei?new Ki:Z6({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new T6(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Dn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Dn.VIEW,this.handleViewChanged_),this.addChangeListener(Dn.SIZE,this.handleSizeChanged_),this.addChangeListener(Dn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Yr)&&e.view.then(function(r){i.setView(new Yr(r))}),this.controls.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(ei.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(ei.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){x2(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:yd,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof Du?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:yd,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(Dn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return wv(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?un(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Dn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ki){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ds(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?un(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Dn.SIZE)}getView(){return this.get(Dn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return I6(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Oo(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===bv.POINTERDOWN||i===ze.WHEEL||i===ze.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Nn.ANIMATING]||o[Nn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Hi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Hi.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Nc(Fo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Nc(Fo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Rt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(ze.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(ze.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Wo(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Wo(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new eU(this)),!Wo(t)){this.mapBrowserEventHandler_=new S6(this,this.moveTolerance_);for(const r in Nt)this.mapBrowserEventHandler_.addEventListener(Nt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(ze.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(ze.WHEEL,this.boundHandleBrowserEvent_,kb?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[nt(i,ze.KEYDOWN,this.handleBrowserEvent,this),nt(i,ze.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Rt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Rt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=nt(e,ru.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=nt(e,ze.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Rt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Vo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[nt(e,ru.PROPERTYCHANGE,this.render,this),nt(e,ze.CHANGE,this.render,this),nt(e,"addlayer",this.handleLayerAdd_,this),nt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){w2(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&jS(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:pv(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:it(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=pv(l.nextCenter,l.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Pm(this.previousExtent_)&&!vd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Nc(Fo.MOVESTART,this,r)),this.previousExtent_=Sm(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Nn.ANIMATING]&&!s.viewHints[Nn.INTERACTING]&&!vd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Nc(Fo.MOVEEND,this,s)),tb(s.extent,this.previousExtent_))),this.dispatchEvent(new Nc(Fo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Fo.LOADSTART)||this.hasListener(Fo.LOADEND)||this.hasListener(Hi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Vo("removelayer",t)),this.set(Dn.LAYERGROUP,e)}setSize(e){this.set(Dn.SIZE,e)}setTarget(e){this.set(Dn.TARGET,e)}setView(e){if(!e||e instanceof Yr){this.set(Dn.VIEW,e);return}this.set(Dn.VIEW,new Yr);const t=this;e.then(function(i){t.setView(new Yr(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Wo(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!jS(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&hb("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!aa(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function nU(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Du({layers:n.layers});t[Dn.LAYERGROUP]=i,t[Dn.TARGET]=n.target,t[Dn.VIEW]=n.view instanceof Yr?n.view:new Yr;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Ki(n.controls.slice()):(at(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Ki(n.interactions.slice()):(at(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Ki(n.overlays.slice()):(at(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Ki,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const R0="units",iU=[1,2,5],bh=25.4/.28;class rU extends jm{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+Jd,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(R0,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(R0)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(R0,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=bp(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||bh)/bh,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||bh)/bh:void 0;let h=l*o,f="";if(r=="degrees"){const k=lu.degrees;h*=k,h<k/60?(f="",o*=3600):h<k?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let p=3*Math.floor(Math.log(l*o)/Math.log(10)),y,x,I,S=0,T,P;for(;;){I=Math.floor(p/3);const k=Math.pow(10,I);if(y=iU[(p%3+3)%3]*k,x=Math.round(y/o),isNaN(x)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&x>=u){y=S,x=T,I=P;break}else if(x>=l)break;S=y,T=x,P=I,++p}const M=this.scaleBar_?this.createScaleBar(x,y,f):y.toFixed(I<0?-I:0)+" "+f;this.renderedHTML_!=M&&(this.innerElement_.innerHTML=M,this.renderedHTML_=M),this.renderedWidth_!=x&&(this.innerElement_.style.width=x+"px",this.renderedWidth_=x),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,u=[this.createMarker("absolute")];for(let f=0;f<o;++f){const p=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${p}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return u.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),u=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=bp(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||bh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const sU={},dC=n=>{let e;const t=new Set,i=(f,p)=>{const y=typeof f=="function"?f(e):f;if(!Object.is(y,e)){const x=e;e=p??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(I=>I(e,x))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(sU?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},oU=n=>n?dC(n):dC;var A0={exports:{}},P0={},b0={exports:{}},k0={};var fC;function aU(){if(fC)return k0;fC=1;var n=Wd();function e(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(p,y){var x=y(),I=i({inst:{value:x,getSnapshot:y}}),S=I[0].inst,T=I[1];return s(function(){S.value=x,S.getSnapshot=y,u(S)&&T({inst:S})},[p,x,y]),r(function(){return u(S)&&T({inst:S}),p(function(){u(S)&&T({inst:S})})},[p]),o(x),x}function u(p){var y=p.getSnapshot;p=p.value;try{var x=y();return!t(p,x)}catch{return!0}}function h(p,y){return y()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return k0.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,k0}var gC;function lU(){return gC||(gC=1,b0.exports=aU()),b0.exports}var pC;function cU(){if(pC)return P0;pC=1;var n=Wd(),e=lU();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return P0.useSyncExternalStoreWithSelector=function(h,f,p,y,x){var I=s(null);if(I.current===null){var S={hasValue:!1,value:null};I.current=S}else S=I.current;I=l(function(){function P(G){if(!M){if(M=!0,k=G,G=y(G),x!==void 0&&S.hasValue){var b=S.value;if(x(b,G))return O=b}return O=G}if(b=O,i(k,G))return b;var R=y(G);return x!==void 0&&x(b,R)?(k=G,b):(k=G,O=R)}var M=!1,k,O,F=p===void 0?null:p;return[function(){return P(f())},F===null?void 0:function(){return P(F())}]},[f,p,y,x]);var T=r(h,I[0],I[1]);return o(function(){S.hasValue=!0,S.value=T},[T]),u(T),T},P0}var mC;function uU(){return mC||(mC=1,A0.exports=cU()),A0.exports}var hU=uU();const dU=mw(hU),E2={},{useDebugValue:fU}=jN,{useSyncExternalStoreWithSelector:gU}=dU;let yC=!1;const pU=n=>n;function mU(n,e=pU,t){(E2?"production":void 0)!=="production"&&t&&!yC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),yC=!0);const i=gU(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return fU(i),i}const _C=n=>{(E2?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?oU(n):n,t=(i,r)=>mU(e,i,r);return Object.assign(t,e),t},cs=n=>n?_C(n):_C;var T2=Symbol.for("immer-nothing"),vC=Symbol.for("immer-draftable"),Si=Symbol.for("immer-state");function gr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Pd=Object.getPrototypeOf;function fu(n){return!!n&&!!n[Si]}function _l(n){return n?I2(n)||Array.isArray(n)||!!n[vC]||!!n.constructor?.[vC]||of(n)||zm(n):!1}var yU=Object.prototype.constructor.toString(),wC=new WeakMap;function I2(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=wC.get(t);return i===void 0&&(i=Function.toString.call(t),wC.set(t,i)),i===yU}function zp(n,e,t=!0){Um(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function Um(n){const e=n[Si];return e?e.type_:Array.isArray(n)?1:of(n)?2:zm(n)?3:0}function Dv(n,e){return Um(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function S2(n,e,t){const i=Um(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function _U(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function of(n){return n instanceof Map}function zm(n){return n instanceof Set}function za(n){return n.copy_||n.base_}function Mv(n,e){if(of(n))return new Map(n);if(zm(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=I2(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Si];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Pd(n),i)}else{const i=Pd(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function Lx(n,e=!1){return Bm(n)||fu(n)||!_l(n)||(Um(n)>1&&Object.defineProperties(n,{set:Bg,add:Bg,clear:Bg,delete:Bg}),Object.freeze(n),e&&Object.values(n).forEach(t=>Lx(t,!0))),n}function vU(){gr(2)}var Bg={value:vU};function Bm(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var wU={};function vl(n){const e=wU[n];return e||gr(0,n),e}var bd;function C2(){return bd}function xU(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function xC(n,e){e&&(vl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Nv(n){Lv(n),n.drafts_.forEach(EU),n.drafts_=null}function Lv(n){n===bd&&(bd=n.parent_)}function EC(n){return bd=xU(bd,n)}function EU(n){const e=n[Si];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function TC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Si].modified_&&(Nv(e),gr(4)),_l(n)&&(n=Bp(e,n),e.parent_||Gp(e,n)),e.patches_&&vl("Patches").generateReplacementPatches_(t[Si].base_,n,e.patches_,e.inversePatches_)):n=Bp(e,t,[]),Nv(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==T2?n:void 0}function Bp(n,e,t){if(Bm(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Si];if(!r)return zp(e,(s,o)=>IC(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return Gp(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),zp(o,(u,h)=>IC(n,r,s,u,h,t,l),i),Gp(n,s,!1),t&&n.patches_&&vl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function IC(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=Bm(r);if(!(l&&!o)){if(fu(r)){const u=s&&e&&e.type_!==3&&!Dv(e.assigned_,i)?s.concat(i):void 0,h=Bp(n,r,u);if(S2(t,i,h),fu(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(_l(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;Bp(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(of(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&Gp(n,r)}}}function Gp(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&Lx(e,t)}function TU(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:C2(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=Ox;t&&(r=[i],s=kd);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var Ox={get(n,e){if(e===Si)return n;const t=za(n);if(!Dv(t,e))return IU(n,t,e);const i=t[e];return n.finalized_||!_l(i)?i:i===D0(n.base_,e)?(M0(n),n.copy_[e]=Fv(i,n)):i},has(n,e){return e in za(n)},ownKeys(n){return Reflect.ownKeys(za(n))},set(n,e,t){const i=R2(za(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=D0(za(n),e),s=r?.[Si];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(_U(t,r)&&(t!==void 0||Dv(n.base_,e)))return!0;M0(n),Ov(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return D0(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,M0(n),Ov(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=za(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){gr(11)},getPrototypeOf(n){return Pd(n.base_)},setPrototypeOf(){gr(12)}},kd={};zp(Ox,(n,e)=>{kd[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});kd.deleteProperty=function(n,e){return kd.set.call(this,n,e,void 0)};kd.set=function(n,e,t){return Ox.set.call(this,n[0],e,t,n[0])};function D0(n,e){const t=n[Si];return(t?za(t):n)[e]}function IU(n,e,t){const i=R2(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function R2(n,e){if(!(e in n))return;let t=Pd(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Pd(t)}}function Ov(n){n.modified_||(n.modified_=!0,n.parent_&&Ov(n.parent_))}function M0(n){n.copy_||(n.copy_=Mv(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var SU=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,f=>t.call(this,f,...h))}}typeof t!="function"&&gr(6),i!==void 0&&typeof i!="function"&&gr(7);let r;if(_l(e)){const s=EC(this),o=Fv(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?Nv(s):Lv(s)}return xC(s,i),TC(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===T2&&(r=void 0),this.autoFreeze_&&Lx(r,!0),i){const s=[],o=[];vl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else gr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){_l(n)||gr(8),fu(n)&&(n=CU(n));const e=EC(this),t=Fv(n,void 0);return t[Si].isManual_=!0,Lv(e),t}finishDraft(n,e){const t=n&&n[Si];(!t||!t.isManual_)&&gr(9);const{scope_:i}=t;return xC(i,e),TC(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=vl("Patches").applyPatches_;return fu(n)?i(n,e):this.produce(n,r=>i(r,e))}};function Fv(n,e){const t=of(n)?vl("MapSet").proxyMap_(n,e):zm(n)?vl("MapSet").proxySet_(n,e):TU(n,e);return(e?e.scope_:C2()).drafts_.push(t),t}function CU(n){return fu(n)||gr(10,n),A2(n)}function A2(n){if(!_l(n)||Bm(n))return n;const e=n[Si];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Mv(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=Mv(n,!0);return zp(t,(r,s)=>{S2(t,r,A2(s))},i),e&&(e.finalized_=!1),t}var RU=new SU,AU=RU.produce;const PU=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?AU(r):r;return e(l,s,...o)},n(i.setState,t,i)),Gm=PU,Wi=cs()(Gm((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),P2={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await zg(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-7OwWae1Y.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Boothellingen:{name:"Boothellingen",factory:async()=>{const{createBoothellingenLayer:n}=await zg(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-DhmmLHca.js");return{createBoothellingenLayer:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await zg(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-frm1JmxY.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await zg(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-DAvhoQqQ.js");return{createViswaterLayer:e}},__vite__mapDeps([3,1]));return n()},immediateLoad:!1}};function bU(){return Object.values(P2).filter(n=>n.immediateLoad)}const Qs=cs()(Gm((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),qo=cs()(Gm((n,e)=>({visible:{OpenStreetMap:!0,Luchtfoto:!1,"Labels Overlay":!1,Aanlegsteigers:!1,Boothellingen:!1,Dieptekaart:!1,Viswater:!1,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=P2[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=Qs.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),ii=cs()(Gm(n=>({layerControlOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchFormLocationSource:null,catchFormInitialPhotos:[],catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e?.location||null,t.catchFormLocationSource=e?.locationSource||null,t.catchFormInitialPhotos=e?.photos||[]})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null,e.catchFormLocationSource=null,e.catchFormInitialPhotos=[]})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),kU={};function DU(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Dd=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Dd(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Dd(i)(t)}}}},MU=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:T=>T,version:0,merge:(T,P)=>({...P,...T}),...e},o=!1;const l=new Set,u=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...T)},i,r);const f=Dd(s.serialize),p=()=>{const T=s.partialize({...i()});let P;const M=f({state:T,version:s.version}).then(k=>h.setItem(s.name,k)).catch(k=>{P=k});if(P)throw P;return M},y=r.setState;r.setState=(T,P)=>{y(T,P),p()};const x=n((...T)=>{t(...T),p()},i,r);let I;const S=()=>{var T;if(!h)return;o=!1,l.forEach(M=>M(i()));const P=((T=s.onRehydrateStorage)==null?void 0:T.call(s,i()))||void 0;return Dd(h.getItem.bind(h))(s.name).then(M=>{if(M)return s.deserialize(M)}).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==s.version){if(s.migrate)return s.migrate(M.state,M.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return M.state}).then(M=>{var k;return I=s.merge(M,(k=i())!=null?k:x),t(I,!0),p()}).then(()=>{P?.(I,void 0),o=!0,u.forEach(M=>M(I))}).catch(M=>{P?.(void 0,M)})};return r.persist={setOptions:T=>{s={...s,...T},T.getStorage&&(h=T.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>S(),hasHydrated:()=>o,onHydrate:T=>(l.add(T),()=>{l.delete(T)}),onFinishHydration:T=>(u.add(T),()=>{u.delete(T)})},S(),I||x},NU=(n,e)=>(t,i,r)=>{let s={storage:DU(()=>localStorage),partialize:S=>S,version:0,merge:(S,T)=>({...T,...S}),...e},o=!1;const l=new Set,u=new Set;let h=s.storage;if(!h)return n((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...S)},i,r);const f=()=>{const S=s.partialize({...i()});return h.setItem(s.name,{state:S,version:s.version})},p=r.setState;r.setState=(S,T)=>{p(S,T),f()};const y=n((...S)=>{t(...S),f()},i,r);r.getInitialState=()=>y;let x;const I=()=>{var S,T;if(!h)return;o=!1,l.forEach(M=>{var k;return M((k=i())!=null?k:y)});const P=((T=s.onRehydrateStorage)==null?void 0:T.call(s,(S=i())!=null?S:y))||void 0;return Dd(h.getItem.bind(h))(s.name).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==s.version){if(s.migrate)return[!0,s.migrate(M.state,M.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,M.state];return[!1,void 0]}).then(M=>{var k;const[O,F]=M;if(x=s.merge(F,(k=i())!=null?k:y),t(x,!0),O)return f()}).then(()=>{P?.(x,void 0),x=i(),o=!0,u.forEach(M=>M(x))}).catch(M=>{P?.(void 0,M)})};return r.persist={setOptions:S=>{s={...s,...S},S.storage&&(h=S.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:S=>(l.add(S),()=>{l.delete(S)}),onFinishHydration:S=>(u.add(S),()=>{u.delete(S)})},s.skipHydration||I(),x||y},LU=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((kU?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),MU(n,e)):NU(n,e),af=LU,ln=cs()(af(n=>({defaultBackground:"OpenStreetMap",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e})}),{name:"visapp-settings"})),b2=cs()(af((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),k2=cs((n,e)=>({current:null,pressureHistory:[],loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code",hourly:"surface_pressure",past_hours:"24",forecast_hours:"48",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();let l=[];o.hourly?.time&&o.hourly?.surface_pressure&&(l=o.hourly.time.map((u,h)=>({time:u,pressure:o.hourly.surface_pressure[h]}))),o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},pressureHistory:l,loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"},getPressureTrend:()=>{const{pressureHistory:t}=e();if(t.length<6)return"stable";const i=t.slice(-6),r=t.slice(-12,-6);if(r.length===0)return"stable";const s=i.reduce((u,h)=>u+h.pressure,0)/i.length,o=r.reduce((u,h)=>u+h.pressure,0)/r.length,l=s-o;return l>2?"rising":l<-2?"falling":"stable"}})),D2=cs()(af(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),SC=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],CC=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],OU=cs()(af((n,e)=>({presets:SC,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=qo.getState().setLayerVisibility;CC.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=qo.getState().visible,r=CC.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:SC})}}),{name:"visapp-presets"})),FU=()=>{};var RC={};const M2=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},VU=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},N2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,f=s>>2,p=(s&3)<<4|l>>4;let y=(l&15)<<2|h>>6,x=h&63;u||(x=64,o||(y=64)),i.push(t[f],t[p],t[y],t[x])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(M2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):VU(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||p==null)throw new jU;const y=s<<2|l>>4;if(i.push(y),h!==64){const x=l<<4&240|h>>2;if(i.push(x),p!==64){const I=h<<6&192|p;i.push(I)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class jU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const UU=function(n){const e=M2(n);return N2.encodeByteArray(e,!0)},Wp=function(n){return UU(n).replace(/\./g,"")},L2=function(n){try{return N2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function O2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const zU=()=>O2().__FIREBASE_DEFAULTS__,BU=()=>{if(typeof process>"u"||typeof RC>"u")return;const n=RC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},GU=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&L2(n[1]);return e&&JSON.parse(e)},Wm=()=>{try{return FU()||zU()||BU()||GU()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},F2=n=>Wm()?.emulatorHosts?.[n],V2=n=>{const e=F2(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},j2=()=>Wm()?.config,U2=n=>Wm()?.[`_${n}`];class WU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Ml(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Fx(n){return(await fetch(n,{credentials:"include"})).ok}function z2(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Wp(JSON.stringify(t)),Wp(JSON.stringify(o)),""].join(".")}const td={};function $U(){const n={prod:[],emulator:[]};for(const e of Object.keys(td))td[e]?n.emulator.push(e):n.prod.push(e);return n}function KU(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let AC=!1;function Vx(n,e){if(typeof window>"u"||typeof document>"u"||!Ml(window.location.host)||td[n]===e||td[n]||AC)return;td[n]=e;function t(y){return`__firebase__banner__${y}`}const i="__firebase__banner",s=$U().prod.length>0;function o(){const y=document.getElementById(i);y&&y.remove()}function l(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,x){y.setAttribute("width","24"),y.setAttribute("id",x),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{AC=!0,o()},y}function f(y,x){y.setAttribute("id",x),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function p(){const y=KU(i),x=t("text"),I=document.getElementById(x)||document.createElement("span"),S=t("learnmore"),T=document.getElementById(S)||document.createElement("a"),P=t("preprendIcon"),M=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const k=y.element;l(k),f(T,S);const O=h();u(M,P),k.append(M,I,T,O),document.body.appendChild(k)}s?(I.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function Jt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function HU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jt())}function B2(){const n=Wm()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function XU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function qU(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function YU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ZU(){const n=Jt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function G2(){return!B2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function W2(){return!B2()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function $2(){try{return typeof indexedDB=="object"}catch{return!1}}function QU(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const JU="FirebaseError";class us extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=JU,Object.setPrototypeOf(this,us.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lf.prototype.create)}}class lf{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?ez(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new us(r,l,i)}}function ez(n,e){return n.replace(tz,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const tz=/\{\$([^}]+)}/g;function nz(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function wl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(PC(s)&&PC(o)){if(!wl(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function PC(n){return n!==null&&typeof n=="object"}function cf(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function iz(n,e){const t=new rz(n,e);return t.subscribe.bind(t)}class rz{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");sz(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=N0),r.error===void 0&&(r.error=N0),r.complete===void 0&&(r.complete=N0);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sz(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function N0(){}function Js(n){return n&&n._delegate?n._delegate:n}class na{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ba="[DEFAULT]";class oz{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new WU;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lz(e))try{this.getOrInitializeService({instanceIdentifier:Ba})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ba){return this.instances.has(e)}getOptions(e=Ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:az(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ba){return this.component?this.component.multipleInstances?e:Ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function az(n){return n===Ba?void 0:n}function lz(n){return n.instantiationMode==="EAGER"}class cz{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new oz(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ke;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ke||(Ke={}));const uz={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},hz=Ke.INFO,dz={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},fz=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=dz[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class jx{constructor(e){this.name=e,this._logLevel=hz,this._logHandler=fz,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?uz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const gz=(n,e)=>e.some(t=>n instanceof t);let bC,kC;function pz(){return bC||(bC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function mz(){return kC||(kC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const K2=new WeakMap,Vv=new WeakMap,H2=new WeakMap,L0=new WeakMap,Ux=new WeakMap;function yz(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Yo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&K2.set(t,n)}).catch(()=>{}),Ux.set(e,n),e}function _z(n){if(Vv.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Vv.set(n,e)}let jv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Vv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||H2.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Yo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function vz(n){jv=n(jv)}function wz(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(O0(this),e,...t);return H2.set(i,e.sort?e.sort():[e]),Yo(i)}:mz().includes(n)?function(...e){return n.apply(O0(this),e),Yo(K2.get(this))}:function(...e){return Yo(n.apply(O0(this),e))}}function xz(n){return typeof n=="function"?wz(n):(n instanceof IDBTransaction&&_z(n),gz(n,pz())?new Proxy(n,jv):n)}function Yo(n){if(n instanceof IDBRequest)return yz(n);if(L0.has(n))return L0.get(n);const e=xz(n);return e!==n&&(L0.set(n,e),Ux.set(e,n)),e}const O0=n=>Ux.get(n);function Ez(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Yo(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Yo(o.result),u.oldVersion,u.newVersion,Yo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const Tz=["get","getKey","getAll","getAllKeys","count"],Iz=["put","add","delete","clear"],F0=new Map;function DC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(F0.get(e))return F0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=Iz.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Tz.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&u.done]))[0]};return F0.set(e,s),s}vz(n=>({...n,get:(e,t,i)=>DC(e,t)||n.get(e,t,i),has:(e,t)=>!!DC(e,t)||n.has(e,t)}));class Sz{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Cz(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Cz(n){return n.getComponent()?.type==="VERSION"}const Uv="@firebase/app",MC="0.14.6";const Hs=new jx("@firebase/app"),Rz="@firebase/app-compat",Az="@firebase/analytics-compat",Pz="@firebase/analytics",bz="@firebase/app-check-compat",kz="@firebase/app-check",Dz="@firebase/auth",Mz="@firebase/auth-compat",Nz="@firebase/database",Lz="@firebase/data-connect",Oz="@firebase/database-compat",Fz="@firebase/functions",Vz="@firebase/functions-compat",jz="@firebase/installations",Uz="@firebase/installations-compat",zz="@firebase/messaging",Bz="@firebase/messaging-compat",Gz="@firebase/performance",Wz="@firebase/performance-compat",$z="@firebase/remote-config",Kz="@firebase/remote-config-compat",Hz="@firebase/storage",Xz="@firebase/storage-compat",qz="@firebase/firestore",Yz="@firebase/ai",Zz="@firebase/firestore-compat",Qz="firebase",Jz="12.6.0";const zv="[DEFAULT]",eB={[Uv]:"fire-core",[Rz]:"fire-core-compat",[Pz]:"fire-analytics",[Az]:"fire-analytics-compat",[kz]:"fire-app-check",[bz]:"fire-app-check-compat",[Dz]:"fire-auth",[Mz]:"fire-auth-compat",[Nz]:"fire-rtdb",[Lz]:"fire-data-connect",[Oz]:"fire-rtdb-compat",[Fz]:"fire-fn",[Vz]:"fire-fn-compat",[jz]:"fire-iid",[Uz]:"fire-iid-compat",[zz]:"fire-fcm",[Bz]:"fire-fcm-compat",[Gz]:"fire-perf",[Wz]:"fire-perf-compat",[$z]:"fire-rc",[Kz]:"fire-rc-compat",[Hz]:"fire-gcs",[Xz]:"fire-gcs-compat",[qz]:"fire-fst",[Zz]:"fire-fst-compat",[Yz]:"fire-vertex","fire-js":"fire-js",[Qz]:"fire-js-all"};const $p=new Map,tB=new Map,Bv=new Map;function NC(n,e){try{n.container.addComponent(e)}catch(t){Hs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function xl(n){const e=n.name;if(Bv.has(e))return Hs.debug(`There were multiple attempts to register component ${e}.`),!1;Bv.set(e,n);for(const t of $p.values())NC(t,n);for(const t of tB.values())NC(t,n);return!0}function $m(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function $i(n){return n==null?!1:n.settings!==void 0}const nB={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zo=new lf("app","Firebase",nB);class iB{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new na("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zo.create("app-deleted",{appName:this._name})}}const Nl=Jz;function X2(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:zv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Zo.create("bad-app-name",{appName:String(r)});if(t||(t=j2()),!t)throw Zo.create("no-options");const s=$p.get(r);if(s){if(wl(t,s.options)&&wl(i,s.config))return s;throw Zo.create("duplicate-app",{appName:r})}const o=new cz(r);for(const u of Bv.values())o.addComponent(u);const l=new iB(t,i,o);return $p.set(r,l),l}function zx(n=zv){const e=$p.get(n);if(!e&&n===zv&&j2())return X2();if(!e)throw Zo.create("no-app",{appName:n});return e}function is(n,e,t){let i=eB[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hs.warn(o.join(" "));return}xl(new na(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const rB="firebase-heartbeat-database",sB=1,Md="firebase-heartbeat-store";let V0=null;function q2(){return V0||(V0=Ez(rB,sB,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Md)}catch(t){console.warn(t)}}}}).catch(n=>{throw Zo.create("idb-open",{originalErrorMessage:n.message})})),V0}async function oB(n){try{const t=(await q2()).transaction(Md),i=await t.objectStore(Md).get(Y2(n));return await t.done,i}catch(e){if(e instanceof us)Hs.warn(e.message);else{const t=Zo.create("idb-get",{originalErrorMessage:e?.message});Hs.warn(t.message)}}}async function LC(n,e){try{const i=(await q2()).transaction(Md,"readwrite");await i.objectStore(Md).put(e,Y2(n)),await i.done}catch(t){if(t instanceof us)Hs.warn(t.message);else{const i=Zo.create("idb-set",{originalErrorMessage:t?.message});Hs.warn(i.message)}}}function Y2(n){return`${n.name}!${n.options.appId}`}const aB=1024,lB=30;class cB{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new hB(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=OC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>lB){const r=dB(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Hs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=OC(),{heartbeatsToSend:t,unsentEntries:i}=uB(this._heartbeatsCache.heartbeats),r=Wp(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Hs.warn(e),""}}}function OC(){return new Date().toISOString().substring(0,10)}function uB(n,e=aB){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),FC(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),FC(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class hB{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $2()?QU().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await oB(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return LC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return LC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function FC(n){return Wp(JSON.stringify({version:2,heartbeats:n})).length}function dB(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function fB(n){xl(new na("platform-logger",e=>new Sz(e),"PRIVATE")),xl(new na("heartbeat",e=>new cB(e),"PRIVATE")),is(Uv,MC,n),is(Uv,MC,"esm2020"),is("fire-js","")}fB("");function Z2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const gB=Z2,Q2=new lf("auth","Firebase",Z2());const Kp=new jx("@firebase/auth");function pB(n,...e){Kp.logLevel<=Ke.WARN&&Kp.warn(`Auth (${Nl}): ${n}`,...e)}function sp(n,...e){Kp.logLevel<=Ke.ERROR&&Kp.error(`Auth (${Nl}): ${n}`,...e)}function ss(n,...e){throw Gx(n,...e)}function xr(n,...e){return Gx(n,...e)}function Bx(n,e,t){const i={...gB(),[e]:t};return new lf("auth","Firebase",i).create(e,{appName:n.name})}function al(n){return Bx(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mB(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&ss(n,"argument-error"),Bx(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Gx(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return Q2.create(n,...e)}function Oe(n,e,...t){if(!n)throw Gx(e,...t)}function Os(n){const e="INTERNAL ASSERTION FAILED: "+n;throw sp(e),new Error(e)}function Xs(n,e){n||Os(e)}function Gv(){return typeof self<"u"&&self.location?.href||""}function yB(){return VC()==="http:"||VC()==="https:"}function VC(){return typeof self<"u"&&self.location?.protocol||null}function _B(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(yB()||qU()||"connection"in navigator)?navigator.onLine:!0}function vB(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class uf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xs(t>e,"Short delay should be less than long delay!"),this.isMobile=HU()||YU()}get(){return _B()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Wx(n,e){Xs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class J2{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Os("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Os("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Os("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const wB={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const xB=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],EB=new uf(3e4,6e4);function $x(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Mu(n,e,t,i,r={}){return ek(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=cf({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return XU()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Ml(n.emulatorConfig.host)&&(h.credentials="include"),J2.fetch()(await tk(n,n.config.apiHost,t,l),h)})}async function ek(n,e,t){n._canInitEmulator=!1;const i={...wB,...e};try{const r=new IB(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Gg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gg(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Gg(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Gg(n,"user-disabled",o);const f=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Bx(n,f,h);ss(n,f)}}catch(r){if(r instanceof us)throw r;ss(n,"network-request-failed",{message:String(r)})}}async function TB(n,e,t,i,r={}){const s=await Mu(n,e,t,i,r);return"mfaPendingCredential"in s&&ss(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function tk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?Wx(n.config,r):`${n.config.apiScheme}://${r}`;return xB.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class IB{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(xr(this.auth,"network-request-failed")),EB.get())})}}function Gg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=xr(n,e,i);return r.customData._tokenResponse=t,r}async function SB(n,e){return Mu(n,"POST","/v1/accounts:delete",e)}async function Hp(n,e){return Mu(n,"POST","/v1/accounts:lookup",e)}function nd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function CB(n,e=!1){const t=Js(n),i=await t.getIdToken(e),r=Kx(i);Oe(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:nd(j0(r.auth_time)),issuedAtTime:nd(j0(r.iat)),expirationTime:nd(j0(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function j0(n){return Number(n)*1e3}function Kx(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return sp("JWT malformed, contained fewer than 3 sections"),null;try{const r=L2(t);return r?JSON.parse(r):(sp("Failed to decode base64 JWT payload"),null)}catch(r){return sp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function jC(n){const e=Kx(n);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Nd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof us&&RB(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function RB({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class AB{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Wv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=nd(this.lastLoginAt),this.creationTime=nd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Xp(n){const e=n.auth,t=await n.getIdToken(),i=await Nd(n,Hp(e,{idToken:t}));Oe(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?nk(r.providerUserInfo):[],o=bB(n.providerData,s),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Wv(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function PB(n){const e=Js(n);await Xp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function bB(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function nk(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function kB(n,e){const t=await ek(n,{},async()=>{const i=cf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await tk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:i};return n.emulatorConfig&&Ml(n.emulatorConfig.host)&&(u.credentials="include"),J2.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function DB(n,e){return Mu(n,"POST","/v2/accounts:revokeToken",$x(n,e))}class Zc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):jC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const t=jC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await kB(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Zc;return i&&(Oe(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Oe(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Oe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zc,this.toJSON())}_performRefresh(){return Os("not implemented")}}function ko(n,e){Oe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class mr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new AB(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Wv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Nd(this,this.stsTokenManager.getToken(this.auth,e));return Oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return CB(this,e)}reload(){return PB(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new mr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Xp(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($i(this.auth.app))return Promise.reject(al(this.auth));const e=await this.getIdToken();return await Nd(this,SB(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:p,emailVerified:y,isAnonymous:x,providerData:I,stsTokenManager:S}=t;Oe(p&&S,e,"internal-error");const T=Zc.fromJSON(this.name,S);Oe(typeof p=="string",e,"internal-error"),ko(i,e.name),ko(r,e.name),Oe(typeof y=="boolean",e,"internal-error"),Oe(typeof x=="boolean",e,"internal-error"),ko(s,e.name),ko(o,e.name),ko(l,e.name),ko(u,e.name),ko(h,e.name),ko(f,e.name);const P=new mr({uid:p,auth:e,email:r,emailVerified:y,displayName:i,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:T,createdAt:h,lastLoginAt:f});return I&&Array.isArray(I)&&(P.providerData=I.map(M=>({...M}))),u&&(P._redirectEventId=u),P}static async _fromIdTokenResponse(e,t,i=!1){const r=new Zc;r.updateFromServerResponse(t);const s=new mr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Xp(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Oe(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?nk(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new Zc;l.updateFromIdToken(i);const u=new mr({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Wv(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const UC=new Map;function Fs(n){Xs(n instanceof Function,"Expected a class definition");let e=UC.get(n);return e?(Xs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,UC.set(n,e),e)}class ik{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ik.type="NONE";const zC=ik;function op(n,e,t){return`firebase:${n}:${e}:${t}`}class Qc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=op(this.userKey,r.apiKey,s),this.fullPersistenceKey=op("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Hp(this.auth,{idToken:e}).catch(()=>{});return t?mr._fromGetAccountInfoResponse(this.auth,t,e):null}return mr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Qc(Fs(zC),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Fs(zC);const o=op(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let p;if(typeof f=="string"){const y=await Hp(e,{idToken:f}).catch(()=>{});if(!y)break;p=await mr._fromGetAccountInfoResponse(e,y,f)}else p=mr._fromJSON(e,f);h!==s&&(l=p),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Qc(s,e,i):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Qc(s,e,i))}}function BC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ak(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(rk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ck(e))return"Blackberry";if(uk(e))return"Webos";if(sk(e))return"Safari";if((e.includes("chrome/")||ok(e))&&!e.includes("edge/"))return"Chrome";if(lk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function rk(n=Jt()){return/firefox\//i.test(n)}function sk(n=Jt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ok(n=Jt()){return/crios\//i.test(n)}function ak(n=Jt()){return/iemobile/i.test(n)}function lk(n=Jt()){return/android/i.test(n)}function ck(n=Jt()){return/blackberry/i.test(n)}function uk(n=Jt()){return/webos/i.test(n)}function Hx(n=Jt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function MB(n=Jt()){return Hx(n)&&!!window.navigator?.standalone}function NB(){return ZU()&&document.documentMode===10}function hk(n=Jt()){return Hx(n)||lk(n)||uk(n)||ck(n)||/windows phone/i.test(n)||ak(n)}function dk(n,e=[]){let t;switch(n){case"Browser":t=BC(Jt());break;case"Worker":t=`${BC(Jt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Nl}/${i}`}class LB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function OB(n,e={}){return Mu(n,"GET","/v2/passwordPolicy",$x(n,e))}const FB=6;class VB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??FB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class jB{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new GC(this),this.idTokenSubscription=new GC(this),this.beforeStateQueue=new LB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Q2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Fs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Qc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Hp(this,{idToken:e}),i=await mr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if($i(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Xp(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=vB()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($i(this.app))return Promise.reject(al(this));const t=e?Js(e):null;return t&&Oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $i(this.app)?Promise.reject(al(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $i(this.app)?Promise.reject(al(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await OB(this),t=new VB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lf("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await DB(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Fs(e)||this._popupRedirectResolver;Oe(t,this,"argument-error"),this.redirectPersistenceManager=await Qc.create(this,[Fs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=dk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if($i(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&pB(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Km(n){return Js(n)}class GC{constructor(e){this.auth=e,this.observer=null,this.addObserver=iz(t=>this.observer=t)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Xx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function UB(n){Xx=n}function zB(n){return Xx.loadJS(n)}function BB(){return Xx.gapiScript}function GB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function WB(n,e){const t=$m(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(wl(s,e??{}))return r;ss(r,"already-initialized")}return t.initialize({options:e})}function $B(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Fs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function KB(n,e,t){const i=Km(n);Oe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=fk(e),{host:o,port:l}=HB(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Oe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Oe(wl(h,i.config.emulator)&&wl(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Ml(o)?(Fx(`${s}//${o}${u}`),Vx("Auth",!0)):XB()}function fk(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function HB(n){const e=fk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:WC(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:WC(o)}}}function WC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function XB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class gk{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Os("not implemented")}_getIdTokenResponse(e){return Os("not implemented")}_linkToIdToken(e,t){return Os("not implemented")}_getReauthenticationResolver(e){return Os("not implemented")}}async function Jc(n,e){return TB(n,"POST","/v1/accounts:signInWithIdp",$x(n,e))}const qB="http://localhost";class El extends gk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new El(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ss("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new El(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Jc(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Jc(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Jc(e,t)}buildRequest(){const e={requestUri:qB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=cf(t)}return e}}class qx{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class hf extends qx{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class jo extends hf{constructor(){super("facebook.com")}static credential(e){return El._fromParams({providerId:jo.PROVIDER_ID,signInMethod:jo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jo.credentialFromTaggedObject(e)}static credentialFromError(e){return jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jo.credential(e.oauthAccessToken)}catch{return null}}}jo.FACEBOOK_SIGN_IN_METHOD="facebook.com";jo.PROVIDER_ID="facebook.com";class Ns extends hf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return El._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ns.credentialFromTaggedObject(e)}static credentialFromError(e){return Ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ns.credential(t,i)}catch{return null}}}Ns.GOOGLE_SIGN_IN_METHOD="google.com";Ns.PROVIDER_ID="google.com";class Uo extends hf{constructor(){super("github.com")}static credential(e){return El._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.GITHUB_SIGN_IN_METHOD="github.com";Uo.PROVIDER_ID="github.com";class zo extends hf{constructor(){super("twitter.com")}static credential(e,t){return El._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return zo.credential(t,i)}catch{return null}}}zo.TWITTER_SIGN_IN_METHOD="twitter.com";zo.PROVIDER_ID="twitter.com";class gu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await mr._fromIdTokenResponse(e,i,r),o=$C(i);return new gu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=$C(i);return new gu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function $C(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class qp extends us{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,qp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new qp(e,t,i,r)}}function pk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?qp._fromErrorAndOperation(n,s,e,i):s})}async function YB(n,e,t=!1){const i=await Nd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return gu._forOperation(n,"link",i)}async function ZB(n,e,t=!1){const{auth:i}=n;if($i(i.app))return Promise.reject(al(i));const r="reauthenticate";try{const s=await Nd(n,pk(i,r,e,n),t);Oe(s.idToken,i,"internal-error");const o=Kx(s.idToken);Oe(o,i,"internal-error");const{sub:l}=o;return Oe(n.uid===l,i,"user-mismatch"),gu._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&ss(i,"user-mismatch"),s}}async function QB(n,e,t=!1){if($i(n.app))return Promise.reject(al(n));const i="signIn",r=await pk(n,i,e),s=await gu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function JB(n,e,t,i){return Js(n).onIdTokenChanged(e,t,i)}function e9(n,e,t){return Js(n).beforeAuthStateChanged(e,t)}function t9(n,e,t,i){return Js(n).onAuthStateChanged(e,t,i)}function n9(n){return Js(n).signOut()}const Yp="__sak";class mk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Yp,"1"),this.storage.removeItem(Yp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const i9=1e3,r9=10;class yk extends mk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=hk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);NB()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,r9):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},i9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}yk.type="LOCAL";const s9=yk;class _k extends mk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}_k.type="SESSION";const vk=_k;function o9(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Hm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Hm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),u=await o9(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hm.receivers=[];function Yx(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class a9{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=Yx("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(p){const y=p;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(y.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function rs(){return window}function l9(n){rs().location.href=n}function wk(){return typeof rs().WorkerGlobalScope<"u"&&typeof rs().importScripts=="function"}async function c9(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function u9(){return navigator?.serviceWorker?.controller||null}function h9(){return wk()?self:null}const xk="firebaseLocalStorageDb",d9=1,Zp="firebaseLocalStorage",Ek="fbase_key";class df{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Xm(n,e){return n.transaction([Zp],e?"readwrite":"readonly").objectStore(Zp)}function f9(){const n=indexedDB.deleteDatabase(xk);return new df(n).toPromise()}function $v(){const n=indexedDB.open(xk,d9);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Zp,{keyPath:Ek})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Zp)?e(i):(i.close(),await f9(),e(await $v()))})})}async function KC(n,e,t){const i=Xm(n,!0).put({[Ek]:e,value:t});return new df(i).toPromise()}async function g9(n,e){const t=Xm(n,!1).get(e),i=await new df(t).toPromise();return i===void 0?null:i.value}function HC(n,e){const t=Xm(n,!0).delete(e);return new df(t).toPromise()}const p9=800,m9=3;class Tk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $v(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>m9)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hm._getInstance(h9()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await c9(),!this.activeServiceWorker)return;this.sender=new a9(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||u9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $v();return await KC(e,Yp,"1"),await HC(e,Yp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>KC(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>g9(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>HC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=Xm(r,!1).getAll();return new df(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),p9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Tk.type="LOCAL";const y9=Tk;new uf(3e4,6e4);function Ik(n,e){return e?Fs(e):(Oe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Zx extends gk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function _9(n){return QB(n.auth,new Zx(n),n.bypassAuthState)}function v9(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),ZB(t,new Zx(n),n.bypassAuthState)}async function w9(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),YB(t,new Zx(n),n.bypassAuthState)}class Sk{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _9;case"linkViaPopup":case"linkViaRedirect":return w9;case"reauthViaPopup":case"reauthViaRedirect":return v9;default:ss(this.auth,"internal-error")}}resolve(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const x9=new uf(2e3,1e4);async function E9(n,e,t){if($i(n.app))return Promise.reject(xr(n,"operation-not-supported-in-this-environment"));const i=Km(n);mB(n,e,qx);const r=Ik(i,t);return new tl(i,"signInViaPopup",e,r).executeNotNull()}class tl extends Sk{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,tl.currentPopupAction&&tl.currentPopupAction.cancel(),tl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){Xs(this.filter.length===1,"Popup operations only handle one event");const e=Yx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(xr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(xr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,x9.get())};e()}}tl.currentPopupAction=null;const T9="pendingRedirect",ap=new Map;class I9 extends Sk{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=ap.get(this.auth._key());if(!e){try{const i=await S9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}ap.set(this.auth._key(),e)}return this.bypassAuthState||ap.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function S9(n,e){const t=A9(e),i=R9(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function C9(n,e){ap.set(n._key(),e)}function R9(n){return Fs(n._redirectPersistence)}function A9(n){return op(T9,n.config.apiKey,n.name)}async function P9(n,e,t=!1){if($i(n.app))return Promise.reject(al(n));const i=Km(n),r=Ik(i,e),o=await new I9(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const b9=600*1e3;class k9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!D9(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Ck(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(xr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=b9&&this.cachedEventUids.clear(),this.cachedEventUids.has(XC(e))}saveEventToCache(e){this.cachedEventUids.add(XC(e)),this.lastProcessedEventTime=Date.now()}}function XC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Ck({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function D9(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ck(n);default:return!1}}async function M9(n,e={}){return Mu(n,"GET","/v1/projects",e)}const N9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,L9=/^https?/;async function O9(n){if(n.config.emulator)return;const{authorizedDomains:e}=await M9(n);for(const t of e)try{if(F9(t))return}catch{}ss(n,"unauthorized-domain")}function F9(n){const e=Gv(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!L9.test(t))return!1;if(N9.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const V9=new uf(3e4,6e4);function qC(){const n=rs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function j9(n){return new Promise((e,t)=>{function i(){qC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{qC(),t(xr(n,"network-request-failed"))},timeout:V9.get()})}if(rs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(rs().gapi?.load)i();else{const r=GB("iframefcb");return rs()[r]=()=>{gapi.load?i():t(xr(n,"network-request-failed"))},zB(`${BB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw lp=null,e})}let lp=null;function U9(n){return lp=lp||j9(n),lp}const z9=new uf(5e3,15e3),B9="__/auth/iframe",G9="emulator/auth/iframe",W9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function K9(n){const e=n.config;Oe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Wx(e,G9):`https://${n.config.authDomain}/${B9}`,i={apiKey:e.apiKey,appName:n.name,v:Nl},r=$9.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${cf(i).slice(1)}`}async function H9(n){const e=await U9(n),t=rs().gapi;return Oe(t,n,"internal-error"),e.open({where:document.body,url:K9(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:W9,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=xr(n,"network-request-failed"),l=rs().setTimeout(()=>{s(o)},z9.get());function u(){rs().clearTimeout(l),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const X9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},q9=500,Y9=600,Z9="_blank",Q9="http://localhost";class YC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function J9(n,e,t,i=q9,r=Y9){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u={...X9,width:i.toString(),height:r.toString(),top:s,left:o},h=Jt().toLowerCase();t&&(l=ok(h)?Z9:t),rk(h)&&(e=e||Q9,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[x,I])=>`${y}${x}=${I},`,"");if(MB(h)&&l!=="_self")return e8(e||"",l),new YC(null);const p=window.open(e||"",l,f);Oe(p,n,"popup-blocked");try{p.focus()}catch{}return new YC(p)}function e8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const t8="__/auth/handler",n8="emulator/auth/handler",i8=encodeURIComponent("fac");async function ZC(n,e,t,i,r,s){Oe(n.config.authDomain,n,"auth-domain-config-required"),Oe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Nl,eventId:r};if(e instanceof qx){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",nz(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof hf){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),h=u?`#${i8}=${encodeURIComponent(u)}`:"";return`${r8(n)}?${cf(l).slice(1)}${h}`}function r8({config:n}){return n.emulator?Wx(n,n8):`https://${n.authDomain}/${t8}`}const U0="webStorageSupport";class s8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vk,this._completeRedirectFn=P9,this._overrideRedirectResult=C9}async _openPopup(e,t,i,r){Xs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await ZC(e,t,i,Gv(),r);return J9(e,s,Yx())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await ZC(e,t,i,Gv(),r);return l9(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Xs(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await H9(e),i=new k9(e);return t.register("authEvent",r=>(Oe(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(U0,{type:U0},r=>{const s=r?.[0]?.[U0];s!==void 0&&t(!!s),ss(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=O9(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return hk()||sk()||Hx()}}const o8=s8;var QC="@firebase/auth",JC="1.12.0";class a8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function l8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function c8(n){xl(new na("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Oe(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:dk(n)},h=new jB(i,r,s,u);return $B(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),xl(new na("auth-internal",e=>{const t=Km(e.getProvider("auth").getImmediate());return(i=>new a8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),is(QC,JC,l8(n)),is(QC,JC,"esm2020")}const u8=300,h8=U2("authIdTokenMaxAge")||u8;let eR=null;const d8=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>h8)return;const r=t?.token;eR!==r&&(eR=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function f8(n=zx()){const e=$m(n,"auth");if(e.isInitialized())return e.getImmediate();const t=WB(n,{popupRedirectResolver:o8,persistence:[y9,s9,vk]}),i=U2("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=d8(s.toString());e9(t,o,()=>o(t.currentUser)),JB(t,l=>o(l))}}const r=F2("auth");return r&&KB(t,`http://${r}`),t}function g8(){return document.getElementsByTagName("head")?.[0]??document}UB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=xr("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",g8().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});c8("Browser");var p8="firebase",m8="12.7.0";is(p8,m8,"app");var tR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Qx;(function(){var n;function e(b,R){function D(){}D.prototype=R.prototype,b.F=R.prototype,b.prototype=new D,b.prototype.constructor=b,b.D=function(V,j,z){for(var N=Array(arguments.length-2),se=2;se<arguments.length;se++)N[se-2]=arguments[se];return R.prototype[j].apply(V,N)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(b,R,D){D||(D=0);const V=Array(16);if(typeof R=="string")for(var j=0;j<16;++j)V[j]=R.charCodeAt(D++)|R.charCodeAt(D++)<<8|R.charCodeAt(D++)<<16|R.charCodeAt(D++)<<24;else for(j=0;j<16;++j)V[j]=R[D++]|R[D++]<<8|R[D++]<<16|R[D++]<<24;R=b.g[0],D=b.g[1],j=b.g[2];let z=b.g[3],N;N=R+(z^D&(j^z))+V[0]+3614090360&4294967295,R=D+(N<<7&4294967295|N>>>25),N=z+(j^R&(D^j))+V[1]+3905402710&4294967295,z=R+(N<<12&4294967295|N>>>20),N=j+(D^z&(R^D))+V[2]+606105819&4294967295,j=z+(N<<17&4294967295|N>>>15),N=D+(R^j&(z^R))+V[3]+3250441966&4294967295,D=j+(N<<22&4294967295|N>>>10),N=R+(z^D&(j^z))+V[4]+4118548399&4294967295,R=D+(N<<7&4294967295|N>>>25),N=z+(j^R&(D^j))+V[5]+1200080426&4294967295,z=R+(N<<12&4294967295|N>>>20),N=j+(D^z&(R^D))+V[6]+2821735955&4294967295,j=z+(N<<17&4294967295|N>>>15),N=D+(R^j&(z^R))+V[7]+4249261313&4294967295,D=j+(N<<22&4294967295|N>>>10),N=R+(z^D&(j^z))+V[8]+1770035416&4294967295,R=D+(N<<7&4294967295|N>>>25),N=z+(j^R&(D^j))+V[9]+2336552879&4294967295,z=R+(N<<12&4294967295|N>>>20),N=j+(D^z&(R^D))+V[10]+4294925233&4294967295,j=z+(N<<17&4294967295|N>>>15),N=D+(R^j&(z^R))+V[11]+2304563134&4294967295,D=j+(N<<22&4294967295|N>>>10),N=R+(z^D&(j^z))+V[12]+1804603682&4294967295,R=D+(N<<7&4294967295|N>>>25),N=z+(j^R&(D^j))+V[13]+4254626195&4294967295,z=R+(N<<12&4294967295|N>>>20),N=j+(D^z&(R^D))+V[14]+2792965006&4294967295,j=z+(N<<17&4294967295|N>>>15),N=D+(R^j&(z^R))+V[15]+1236535329&4294967295,D=j+(N<<22&4294967295|N>>>10),N=R+(j^z&(D^j))+V[1]+4129170786&4294967295,R=D+(N<<5&4294967295|N>>>27),N=z+(D^j&(R^D))+V[6]+3225465664&4294967295,z=R+(N<<9&4294967295|N>>>23),N=j+(R^D&(z^R))+V[11]+643717713&4294967295,j=z+(N<<14&4294967295|N>>>18),N=D+(z^R&(j^z))+V[0]+3921069994&4294967295,D=j+(N<<20&4294967295|N>>>12),N=R+(j^z&(D^j))+V[5]+3593408605&4294967295,R=D+(N<<5&4294967295|N>>>27),N=z+(D^j&(R^D))+V[10]+38016083&4294967295,z=R+(N<<9&4294967295|N>>>23),N=j+(R^D&(z^R))+V[15]+3634488961&4294967295,j=z+(N<<14&4294967295|N>>>18),N=D+(z^R&(j^z))+V[4]+3889429448&4294967295,D=j+(N<<20&4294967295|N>>>12),N=R+(j^z&(D^j))+V[9]+568446438&4294967295,R=D+(N<<5&4294967295|N>>>27),N=z+(D^j&(R^D))+V[14]+3275163606&4294967295,z=R+(N<<9&4294967295|N>>>23),N=j+(R^D&(z^R))+V[3]+4107603335&4294967295,j=z+(N<<14&4294967295|N>>>18),N=D+(z^R&(j^z))+V[8]+1163531501&4294967295,D=j+(N<<20&4294967295|N>>>12),N=R+(j^z&(D^j))+V[13]+2850285829&4294967295,R=D+(N<<5&4294967295|N>>>27),N=z+(D^j&(R^D))+V[2]+4243563512&4294967295,z=R+(N<<9&4294967295|N>>>23),N=j+(R^D&(z^R))+V[7]+1735328473&4294967295,j=z+(N<<14&4294967295|N>>>18),N=D+(z^R&(j^z))+V[12]+2368359562&4294967295,D=j+(N<<20&4294967295|N>>>12),N=R+(D^j^z)+V[5]+4294588738&4294967295,R=D+(N<<4&4294967295|N>>>28),N=z+(R^D^j)+V[8]+2272392833&4294967295,z=R+(N<<11&4294967295|N>>>21),N=j+(z^R^D)+V[11]+1839030562&4294967295,j=z+(N<<16&4294967295|N>>>16),N=D+(j^z^R)+V[14]+4259657740&4294967295,D=j+(N<<23&4294967295|N>>>9),N=R+(D^j^z)+V[1]+2763975236&4294967295,R=D+(N<<4&4294967295|N>>>28),N=z+(R^D^j)+V[4]+1272893353&4294967295,z=R+(N<<11&4294967295|N>>>21),N=j+(z^R^D)+V[7]+4139469664&4294967295,j=z+(N<<16&4294967295|N>>>16),N=D+(j^z^R)+V[10]+3200236656&4294967295,D=j+(N<<23&4294967295|N>>>9),N=R+(D^j^z)+V[13]+681279174&4294967295,R=D+(N<<4&4294967295|N>>>28),N=z+(R^D^j)+V[0]+3936430074&4294967295,z=R+(N<<11&4294967295|N>>>21),N=j+(z^R^D)+V[3]+3572445317&4294967295,j=z+(N<<16&4294967295|N>>>16),N=D+(j^z^R)+V[6]+76029189&4294967295,D=j+(N<<23&4294967295|N>>>9),N=R+(D^j^z)+V[9]+3654602809&4294967295,R=D+(N<<4&4294967295|N>>>28),N=z+(R^D^j)+V[12]+3873151461&4294967295,z=R+(N<<11&4294967295|N>>>21),N=j+(z^R^D)+V[15]+530742520&4294967295,j=z+(N<<16&4294967295|N>>>16),N=D+(j^z^R)+V[2]+3299628645&4294967295,D=j+(N<<23&4294967295|N>>>9),N=R+(j^(D|~z))+V[0]+4096336452&4294967295,R=D+(N<<6&4294967295|N>>>26),N=z+(D^(R|~j))+V[7]+1126891415&4294967295,z=R+(N<<10&4294967295|N>>>22),N=j+(R^(z|~D))+V[14]+2878612391&4294967295,j=z+(N<<15&4294967295|N>>>17),N=D+(z^(j|~R))+V[5]+4237533241&4294967295,D=j+(N<<21&4294967295|N>>>11),N=R+(j^(D|~z))+V[12]+1700485571&4294967295,R=D+(N<<6&4294967295|N>>>26),N=z+(D^(R|~j))+V[3]+2399980690&4294967295,z=R+(N<<10&4294967295|N>>>22),N=j+(R^(z|~D))+V[10]+4293915773&4294967295,j=z+(N<<15&4294967295|N>>>17),N=D+(z^(j|~R))+V[1]+2240044497&4294967295,D=j+(N<<21&4294967295|N>>>11),N=R+(j^(D|~z))+V[8]+1873313359&4294967295,R=D+(N<<6&4294967295|N>>>26),N=z+(D^(R|~j))+V[15]+4264355552&4294967295,z=R+(N<<10&4294967295|N>>>22),N=j+(R^(z|~D))+V[6]+2734768916&4294967295,j=z+(N<<15&4294967295|N>>>17),N=D+(z^(j|~R))+V[13]+1309151649&4294967295,D=j+(N<<21&4294967295|N>>>11),N=R+(j^(D|~z))+V[4]+4149444226&4294967295,R=D+(N<<6&4294967295|N>>>26),N=z+(D^(R|~j))+V[11]+3174756917&4294967295,z=R+(N<<10&4294967295|N>>>22),N=j+(R^(z|~D))+V[2]+718787259&4294967295,j=z+(N<<15&4294967295|N>>>17),N=D+(z^(j|~R))+V[9]+3951481745&4294967295,b.g[0]=b.g[0]+R&4294967295,b.g[1]=b.g[1]+(j+(N<<21&4294967295|N>>>11))&4294967295,b.g[2]=b.g[2]+j&4294967295,b.g[3]=b.g[3]+z&4294967295}i.prototype.v=function(b,R){R===void 0&&(R=b.length);const D=R-this.blockSize,V=this.C;let j=this.h,z=0;for(;z<R;){if(j==0)for(;z<=D;)r(this,b,z),z+=this.blockSize;if(typeof b=="string"){for(;z<R;)if(V[j++]=b.charCodeAt(z++),j==this.blockSize){r(this,V),j=0;break}}else for(;z<R;)if(V[j++]=b[z++],j==this.blockSize){r(this,V),j=0;break}}this.h=j,this.o+=R},i.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var R=1;R<b.length-8;++R)b[R]=0;R=this.o*8;for(var D=b.length-8;D<b.length;++D)b[D]=R&255,R/=256;for(this.v(b),b=Array(16),R=0,D=0;D<4;++D)for(let V=0;V<32;V+=8)b[R++]=this.g[D]>>>V&255;return b};function s(b,R){var D=l;return Object.prototype.hasOwnProperty.call(D,b)?D[b]:D[b]=R(b)}function o(b,R){this.h=R;const D=[];let V=!0;for(let j=b.length-1;j>=0;j--){const z=b[j]|0;V&&z==R||(D[j]=z,V=!1)}this.g=D}var l={};function u(b){return-128<=b&&b<128?s(b,function(R){return new o([R|0],R<0?-1:0)}):new o([b|0],b<0?-1:0)}function h(b){if(isNaN(b)||!isFinite(b))return p;if(b<0)return T(h(-b));const R=[];let D=1;for(let V=0;b>=D;V++)R[V]=b/D|0,D*=4294967296;return new o(R,0)}function f(b,R){if(b.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(b.charAt(0)=="-")return T(f(b.substring(1),R));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=h(Math.pow(R,8));let V=p;for(let z=0;z<b.length;z+=8){var j=Math.min(8,b.length-z);const N=parseInt(b.substring(z,z+j),R);j<8?(j=h(Math.pow(R,j)),V=V.j(j).add(h(N))):(V=V.j(D),V=V.add(h(N)))}return V}var p=u(0),y=u(1),x=u(16777216);n=o.prototype,n.m=function(){if(S(this))return-T(this).m();let b=0,R=1;for(let D=0;D<this.g.length;D++){const V=this.i(D);b+=(V>=0?V:4294967296+V)*R,R*=4294967296}return b},n.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(I(this))return"0";if(S(this))return"-"+T(this).toString(b);const R=h(Math.pow(b,6));var D=this;let V="";for(;;){const j=O(D,R).g;D=P(D,j.j(R));let z=((D.g.length>0?D.g[0]:D.h)>>>0).toString(b);if(D=j,I(D))return z+V;for(;z.length<6;)z="0"+z;V=z+V}},n.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function I(b){if(b.h!=0)return!1;for(let R=0;R<b.g.length;R++)if(b.g[R]!=0)return!1;return!0}function S(b){return b.h==-1}n.l=function(b){return b=P(this,b),S(b)?-1:I(b)?0:1};function T(b){const R=b.g.length,D=[];for(let V=0;V<R;V++)D[V]=~b.g[V];return new o(D,~b.h).add(y)}n.abs=function(){return S(this)?T(this):this},n.add=function(b){const R=Math.max(this.g.length,b.g.length),D=[];let V=0;for(let j=0;j<=R;j++){let z=V+(this.i(j)&65535)+(b.i(j)&65535),N=(z>>>16)+(this.i(j)>>>16)+(b.i(j)>>>16);V=N>>>16,z&=65535,N&=65535,D[j]=N<<16|z}return new o(D,D[D.length-1]&-2147483648?-1:0)};function P(b,R){return b.add(T(R))}n.j=function(b){if(I(this)||I(b))return p;if(S(this))return S(b)?T(this).j(T(b)):T(T(this).j(b));if(S(b))return T(this.j(T(b)));if(this.l(x)<0&&b.l(x)<0)return h(this.m()*b.m());const R=this.g.length+b.g.length,D=[];for(var V=0;V<2*R;V++)D[V]=0;for(V=0;V<this.g.length;V++)for(let j=0;j<b.g.length;j++){const z=this.i(V)>>>16,N=this.i(V)&65535,se=b.i(j)>>>16,ge=b.i(j)&65535;D[2*V+2*j]+=N*ge,M(D,2*V+2*j),D[2*V+2*j+1]+=z*ge,M(D,2*V+2*j+1),D[2*V+2*j+1]+=N*se,M(D,2*V+2*j+1),D[2*V+2*j+2]+=z*se,M(D,2*V+2*j+2)}for(b=0;b<R;b++)D[b]=D[2*b+1]<<16|D[2*b];for(b=R;b<2*R;b++)D[b]=0;return new o(D,0)};function M(b,R){for(;(b[R]&65535)!=b[R];)b[R+1]+=b[R]>>>16,b[R]&=65535,R++}function k(b,R){this.g=b,this.h=R}function O(b,R){if(I(R))throw Error("division by zero");if(I(b))return new k(p,p);if(S(b))return R=O(T(b),R),new k(T(R.g),T(R.h));if(S(R))return R=O(b,T(R)),new k(T(R.g),R.h);if(b.g.length>30){if(S(b)||S(R))throw Error("slowDivide_ only works with positive integers.");for(var D=y,V=R;V.l(b)<=0;)D=F(D),V=F(V);var j=G(D,1),z=G(V,1);for(V=G(V,2),D=G(D,2);!I(V);){var N=z.add(V);N.l(b)<=0&&(j=j.add(D),z=N),V=G(V,1),D=G(D,1)}return R=P(b,j.j(R)),new k(j,R)}for(j=p;b.l(R)>=0;){for(D=Math.max(1,Math.floor(b.m()/R.m())),V=Math.ceil(Math.log(D)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),z=h(D),N=z.j(R);S(N)||N.l(b)>0;)D-=V,z=h(D),N=z.j(R);I(z)&&(z=y),j=j.add(z),b=P(b,N)}return new k(j,b)}n.B=function(b){return O(this,b).h},n.and=function(b){const R=Math.max(this.g.length,b.g.length),D=[];for(let V=0;V<R;V++)D[V]=this.i(V)&b.i(V);return new o(D,this.h&b.h)},n.or=function(b){const R=Math.max(this.g.length,b.g.length),D=[];for(let V=0;V<R;V++)D[V]=this.i(V)|b.i(V);return new o(D,this.h|b.h)},n.xor=function(b){const R=Math.max(this.g.length,b.g.length),D=[];for(let V=0;V<R;V++)D[V]=this.i(V)^b.i(V);return new o(D,this.h^b.h)};function F(b){const R=b.g.length+1,D=[];for(let V=0;V<R;V++)D[V]=b.i(V)<<1|b.i(V-1)>>>31;return new o(D,b.h)}function G(b,R){const D=R>>5;R%=32;const V=b.g.length-D,j=[];for(let z=0;z<V;z++)j[z]=R>0?b.i(z+D)>>>R|b.i(z+D+1)<<32-R:b.i(z+D);return new o(j,b.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,Qx=o}).apply(typeof tR<"u"?tR:typeof self<"u"?self:typeof window<"u"?window:{});var Wg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Rk,Hh,Ak,cp,Kv,Pk,bk,kk;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wg=="object"&&Wg];for(var w=0;w<g.length;++w){var C=g[w];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=t(this);function r(g,w){if(w)e:{var C=i;g=g.split(".");for(var L=0;L<g.length-1;L++){var X=g[L];if(!(X in C))break e;C=C[X]}g=g[g.length-1],L=C[g],w=w(L),w!=L&&w!=null&&e(C,g,{configurable:!0,writable:!0,value:w})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(w){var C=[],L;for(L in w)Object.prototype.hasOwnProperty.call(w,L)&&C.push([L,w[L]]);return C}});var s=s||{},o=this||self;function l(g){var w=typeof g;return w=="object"&&g!=null||w=="function"}function u(g,w,C){return g.call.apply(g.bind,arguments)}function h(g,w,C){return h=u,h.apply(null,arguments)}function f(g,w){var C=Array.prototype.slice.call(arguments,1);return function(){var L=C.slice();return L.push.apply(L,arguments),g.apply(this,L)}}function p(g,w){function C(){}C.prototype=w.prototype,g.Z=w.prototype,g.prototype=new C,g.prototype.constructor=g,g.Ob=function(L,X,ee){for(var de=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)de[Ve-2]=arguments[Ve];return w.prototype[X].apply(L,de)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function x(g){const w=g.length;if(w>0){const C=Array(w);for(let L=0;L<w;L++)C[L]=g[L];return C}return[]}function I(g,w){for(let L=1;L<arguments.length;L++){const X=arguments[L];var C=typeof X;if(C=C!="object"?C:X?Array.isArray(X)?"array":C:"null",C=="array"||C=="object"&&typeof X.length=="number"){C=g.length||0;const ee=X.length||0;g.length=C+ee;for(let de=0;de<ee;de++)g[C+de]=X[de]}else g.push(X)}}class S{constructor(w,C){this.i=w,this.j=C,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function T(g){o.setTimeout(()=>{throw g},0)}function P(){var g=b;let w=null;return g.g&&(w=g.g,g.g=g.g.next,g.g||(g.h=null),w.next=null),w}class M{constructor(){this.h=this.g=null}add(w,C){const L=k.get();L.set(w,C),this.h?this.h.next=L:this.g=L,this.h=L}}var k=new S(()=>new O,g=>g.reset());class O{constructor(){this.next=this.g=this.h=null}set(w,C){this.h=w,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let F,G=!1,b=new M,R=()=>{const g=Promise.resolve(void 0);F=()=>{g.then(D)}};function D(){for(var g;g=P();){try{g.h.call(g.g)}catch(C){T(C)}var w=k;w.j(g),w.h<100&&(w.h++,g.next=w.g,w.g=g)}G=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(g,w){this.type=g,this.g=this.target=w,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,w=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const C=()=>{};o.addEventListener("test",C,w),o.removeEventListener("test",C,w)}catch{}return g})();function N(g){return/^[\s\xa0]*$/.test(g)}function se(g,w){j.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,w)}p(se,j),se.prototype.init=function(g,w){const C=this.type=g.type,L=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=w,w=g.relatedTarget,w||(C=="mouseover"?w=g.fromElement:C=="mouseout"&&(w=g.toElement)),this.relatedTarget=w,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&se.Z.h.call(this)},se.prototype.h=function(){se.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var ge="closure_listenable_"+(Math.random()*1e6|0),ne=0;function ue(g,w,C,L,X){this.listener=g,this.proxy=null,this.src=w,this.type=C,this.capture=!!L,this.ha=X,this.key=++ne,this.da=this.fa=!1}function Z(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function le(g,w,C){for(const L in g)w.call(C,g[L],L,g)}function ie(g,w){for(const C in g)w.call(void 0,g[C],C,g)}function W(g){const w={};for(const C in g)w[C]=g[C];return w}const K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ee(g,w){let C,L;for(let X=1;X<arguments.length;X++){L=arguments[X];for(C in L)g[C]=L[C];for(let ee=0;ee<K.length;ee++)C=K[ee],Object.prototype.hasOwnProperty.call(L,C)&&(g[C]=L[C])}}function Te(g){this.src=g,this.g={},this.h=0}Te.prototype.add=function(g,w,C,L,X){const ee=g.toString();g=this.g[ee],g||(g=this.g[ee]=[],this.h++);const de=be(g,w,L,X);return de>-1?(w=g[de],C||(w.fa=!1)):(w=new ue(w,this.src,ee,!!L,X),w.fa=C,g.push(w)),w};function Ie(g,w){const C=w.type;if(C in g.g){var L=g.g[C],X=Array.prototype.indexOf.call(L,w,void 0),ee;(ee=X>=0)&&Array.prototype.splice.call(L,X,1),ee&&(Z(w),g.g[C].length==0&&(delete g.g[C],g.h--))}}function be(g,w,C,L){for(let X=0;X<g.length;++X){const ee=g[X];if(!ee.da&&ee.listener==w&&ee.capture==!!C&&ee.ha==L)return X}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),Fe={};function Ge(g,w,C,L,X){if(Array.isArray(w)){for(let ee=0;ee<w.length;ee++)Ge(g,w[ee],C,L,X);return null}return C=Ri(C),g&&g[ge]?g.J(w,C,l(L)?!!L.capture:!1,X):lt(g,w,C,!1,L,X)}function lt(g,w,C,L,X,ee){if(!w)throw Error("Invalid event type");const de=l(X)?!!X.capture:!!X;let Ve=dn(g);if(Ve||(g[Me]=Ve=new Te(g)),C=Ve.add(w,C,L,de,ee),C.proxy)return C;if(L=Qi(),C.proxy=L,L.src=g,L.listener=C,g.addEventListener)z||(X=de),X===void 0&&(X=!1),g.addEventListener(w.toString(),L,X);else if(g.attachEvent)g.attachEvent($n(w.toString()),L);else if(g.addListener&&g.removeListener)g.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Qi(){function g(C){return w.call(g.src,g.listener,C)}const w=hn;return g}function ds(g,w,C,L,X){if(Array.isArray(w))for(var ee=0;ee<w.length;ee++)ds(g,w[ee],C,L,X);else L=l(L)?!!L.capture:!!L,C=Ri(C),g&&g[ge]?(g=g.i,ee=String(w).toString(),ee in g.g&&(w=g.g[ee],C=be(w,C,L,X),C>-1&&(Z(w[C]),Array.prototype.splice.call(w,C,1),w.length==0&&(delete g.g[ee],g.h--)))):g&&(g=dn(g))&&(w=g.g[w.toString()],g=-1,w&&(g=be(w,C,L,X)),(C=g>-1?w[g]:null)&&Wn(C))}function Wn(g){if(typeof g!="number"&&g&&!g.da){var w=g.src;if(w&&w[ge])Ie(w.i,g);else{var C=g.type,L=g.proxy;w.removeEventListener?w.removeEventListener(C,L,g.capture):w.detachEvent?w.detachEvent($n(C),L):w.addListener&&w.removeListener&&w.removeListener(L),(C=dn(w))?(Ie(C,g),C.h==0&&(C.src=null,w[Me]=null)):Z(g)}}}function $n(g){return g in Fe?Fe[g]:Fe[g]="on"+g}function hn(g,w){if(g.da)g=!0;else{w=new se(w,this);const C=g.listener,L=g.ha||g.src;g.fa&&Wn(g),g=C.call(L,w)}return g}function dn(g){return g=g[Me],g instanceof Te?g:null}var Kn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ri(g){return typeof g=="function"?g:(g[Kn]||(g[Kn]=function(w){return g.handleEvent(w)}),g[Kn])}function yt(){V.call(this),this.i=new Te(this),this.M=this,this.G=null}p(yt,V),yt.prototype[ge]=!0,yt.prototype.removeEventListener=function(g,w,C,L){ds(this,g,w,C,L)};function ct(g,w){var C,L=g.G;if(L)for(C=[];L;L=L.G)C.push(L);if(g=g.M,L=w.type||w,typeof w=="string")w=new j(w,g);else if(w instanceof j)w.target=w.target||g;else{var X=w;w=new j(L,g),Ee(w,X)}X=!0;let ee,de;if(C)for(de=C.length-1;de>=0;de--)ee=w.g=C[de],X=tn(ee,L,!0,w)&&X;if(ee=w.g=g,X=tn(ee,L,!0,w)&&X,X=tn(ee,L,!1,w)&&X,C)for(de=0;de<C.length;de++)ee=w.g=C[de],X=tn(ee,L,!1,w)&&X}yt.prototype.N=function(){if(yt.Z.N.call(this),this.i){var g=this.i;for(const w in g.g){const C=g.g[w];for(let L=0;L<C.length;L++)Z(C[L]);delete g.g[w],g.h--}}this.G=null},yt.prototype.J=function(g,w,C,L){return this.i.add(String(g),w,!1,C,L)},yt.prototype.K=function(g,w,C,L){return this.i.add(String(g),w,!0,C,L)};function tn(g,w,C,L){if(w=g.i.g[String(w)],!w)return!0;w=w.concat();let X=!0;for(let ee=0;ee<w.length;++ee){const de=w[ee];if(de&&!de.da&&de.capture==C){const Ve=de.listener,Vt=de.ha||de.src;de.fa&&Ie(g.i,de),X=Ve.call(Vt,L)!==!1&&X}}return X&&!L.defaultPrevented}function Ai(g,w){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:o.setTimeout(g,w||0)}function It(g){g.g=Ai(()=>{g.g=null,g.i&&(g.i=!1,It(g))},g.l);const w=g.h;g.h=null,g.m.apply(null,w)}class to extends V{constructor(w,C){super(),this.m=w,this.l=C,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pi(g){V.call(this),this.h=g,this.g={}}p(Pi,V);var Cr=[];function Ji(g){le(g.g,function(w,C){this.g.hasOwnProperty(C)&&Wn(w)},g),g.g={}}Pi.prototype.N=function(){Pi.Z.N.call(this),Ji(this)},Pi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Rr=o.JSON.stringify,ca=o.JSON.parse,Ar=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function bi(){}function Ol(){}var Pr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function fs(){j.call(this,"d")}p(fs,j);function no(){j.call(this,"c")}p(no,j);var On={},gs=null;function br(){return gs=gs||new yt}On.Ia="serverreachability";function kr(g){j.call(this,On.Ia,g)}p(kr,j);function Fn(g){const w=br();ct(w,new kr(w))}On.STAT_EVENT="statevent";function Vn(g,w){j.call(this,On.STAT_EVENT,g),this.stat=w}p(Vn,j);function ft(g){const w=br();ct(w,new Vn(w,g))}On.Ja="timingevent";function io(g,w){j.call(this,On.Ja,g),this.size=w}p(io,j);function er(g,w){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},w)}function Ot(){this.g=!0}Ot.prototype.ua=function(){this.g=!1};function ki(g,w,C,L,X,ee){g.info(function(){if(g.g)if(ee){var de="",Ve=ee.split("&");for(let ut=0;ut<Ve.length;ut++){var Vt=Ve[ut].split("=");if(Vt.length>1){const Gt=Vt[0];Vt=Vt[1];const pi=Gt.split("_");de=pi.length>=2&&pi[1]=="type"?de+(Gt+"="+Vt+"&"):de+(Gt+"=redacted&")}}}else de=null;else de=ee;return"XMLHTTP REQ ("+L+") [attempt "+X+"]: "+w+`
`+C+`
`+de})}function fn(g,w,C,L,X,ee,de){g.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+X+"]: "+w+`
`+C+`
`+ee+" "+de})}function Ft(g,w,C,L){g.info(function(){return"XMLHTTP TEXT ("+w+"): "+pn(g,C)+(L?" "+L:"")})}function gn(g,w){g.info(function(){return"TIMEOUT: "+w})}Ot.prototype.info=function(){};function pn(g,w){if(!g.g)return w;if(!w)return null;try{const ee=JSON.parse(w);if(ee){for(g=0;g<ee.length;g++)if(Array.isArray(ee[g])){var C=ee[g];if(!(C.length<2)){var L=C[1];if(Array.isArray(L)&&!(L.length<1)){var X=L[0];if(X!="noop"&&X!="stop"&&X!="close")for(let de=1;de<L.length;de++)L[de]=""}}}}return Rr(ee)}catch{return w}}var nn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bt;function Xt(){}p(Xt,bi),Xt.prototype.g=function(){return new XMLHttpRequest},Bt=new Xt;function Di(g){return encodeURIComponent(String(g))}function Fl(g){var w=1;g=g.split(":");const C=[];for(;w>0&&g.length;)C.push(g.shift()),w--;return g.length&&C.push(g.join(":")),C}function Mi(g,w,C,L){this.j=g,this.i=w,this.l=C,this.S=L||1,this.V=new Pi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new yf}function yf(){this.i=null,this.g="",this.h=!1}var _f={},Ou={};function tr(g,w,C){g.M=1,g.A=ms(Ni(w)),g.u=C,g.R=!0,Fu(g,null)}function Fu(g,w){g.F=Date.now(),ua(g),g.B=Ni(g.A);var C=g.B,L=g.S;Array.isArray(L)||(L=[String(L)]),Hu(C.i,"t",L),g.C=0,C=g.j.L,g.h=new yf,g.g=Af(g.j,C?w:null,!g.u),g.P>0&&(g.O=new to(h(g.Y,g,g.g),g.P)),w=g.V,C=g.g,L=g.ba;var X="readystatechange";Array.isArray(X)||(X&&(Cr[0]=X.toString()),X=Cr);for(let ee=0;ee<X.length;ee++){const de=Ge(C,X[ee],L||w.handleEvent,!1,w.h||w);if(!de)break;w.g[de.key]=de}w=g.J?W(g.J):{},g.u?(g.v||(g.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,w)):(g.v="GET",g.g.ea(g.B,g.v,null,w)),Fn(),ki(g.i,g.v,g.B,g.l,g.S,g.u)}Mi.prototype.ba=function(g){g=g.target;const w=this.O;w&&Vr(g)==3?w.j():this.Y(g)},Mi.prototype.Y=function(g){try{if(g==this.g)e:{const Ve=Vr(this.g),Vt=this.g.ya(),ut=this.g.ca();if(!(Ve<3)&&(Ve!=3||this.g&&(this.h.h||this.g.la()||Cf(this.g)))){this.K||Ve!=4||Vt==7||(Vt==8||ut<=0?Fn(3):Fn(2)),Vl(this);var w=this.g.ca();this.X=w;var C=vf(this);if(this.o=w==200,fn(this.i,this.v,this.B,this.l,this.S,Ve,w),this.o){if(this.U&&!this.L){t:{if(this.g){var L,X=this.g;if((L=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(L)){var ee=L;break t}}ee=null}if(g=ee)Ft(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,vt(this,g);else{this.o=!1,this.m=3,ft(12),ps(this),ha(this);break e}}if(this.R){g=!0;let Gt;for(;!this.K&&this.C<C.length;)if(Gt=xf(this,C),Gt==Ou){Ve==4&&(this.m=4,ft(14),g=!1),Ft(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==_f){this.m=4,ft(15),Ft(this.i,this.l,C,"[Invalid Chunk]"),g=!1;break}else Ft(this.i,this.l,Gt,null),vt(this,Gt);if(wf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ve!=4||C.length!=0||this.h.h||(this.m=1,ft(16),g=!1),this.o=this.o&&g,!g)Ft(this.i,this.l,C,"[Invalid Chunked Response]"),ps(this),ha(this);else if(C.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),wa(de),de.P=!0,ft(11))}}else Ft(this.i,this.l,C,null),vt(this,C);Ve==4&&ps(this),this.o&&!this.K&&(Ve==4?Xl(this.j,this):(this.o=!1,ua(this)))}else qu(this.g),w==400&&C.indexOf("Unknown SID")>0?(this.m=3,ft(12)):(this.m=0,ft(13)),ps(this),ha(this)}}}catch{}};function vf(g){if(!wf(g))return g.g.la();const w=Cf(g.g);if(w==="")return"";let C="";const L=w.length,X=Vr(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ps(g),ha(g),"";g.h.i=new o.TextDecoder}for(let ee=0;ee<L;ee++)g.h.h=!0,C+=g.h.i.decode(w[ee],{stream:!(X&&ee==L-1)});return w.length=0,g.h.g+=C,g.C=0,g.h.g}function wf(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function xf(g,w){var C=g.C,L=w.indexOf(`
`,C);return L==-1?Ou:(C=Number(w.substring(C,L)),isNaN(C)?_f:(L+=1,L+C>w.length?Ou:(w=w.slice(L,L+C),g.C=L+C,w)))}Mi.prototype.cancel=function(){this.K=!0,ps(this)};function ua(g){g.T=Date.now()+g.H,Vu(g,g.H)}function Vu(g,w){if(g.D!=null)throw Error("WatchDog timer not null");g.D=er(h(g.aa,g),w)}function Vl(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Mi.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(gn(this.i,this.B),this.M!=2&&(Fn(),ft(17)),ps(this),this.m=2,ha(this)):Vu(this,this.T-g)};function ha(g){g.j.I==0||g.K||Xl(g.j,g)}function ps(g){Vl(g);var w=g.O;w&&typeof w.dispose=="function"&&w.dispose(),g.O=null,Ji(g.V),g.g&&(w=g.g,g.g=null,w.abort(),w.dispose())}function vt(g,w){try{var C=g.j;if(C.I!=0&&(C.g==g||Uu(C.h,g))){if(!g.L&&Uu(C.h,g)&&C.I==3){try{var L=C.Ba.g.parse(w)}catch{L=null}if(Array.isArray(L)&&L.length==3){var X=L;if(X[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<g.F)Hl(C),fi(C);else break e;zr(C),ft(18)}}else C.xa=X[1],0<C.xa-C.K&&X[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=er(h(C.Va,C),6e3));da(C.h)<=1&&C.ta&&(C.ta=void 0)}else gi(C,11)}else if((g.L||C.g==g)&&Hl(C),!N(w))for(X=C.Ba.g.parse(w),w=0;w<X.length;w++){let ut=X[w];const Gt=ut[0];if(!(Gt<=C.K))if(C.K=Gt,ut=ut[1],C.I==2)if(ut[0]=="c"){C.M=ut[1],C.ba=ut[2];const pi=ut[3];pi!=null&&(C.ka=pi,C.j.info("VER="+C.ka));const xs=ut[4];xs!=null&&(C.za=xs,C.j.info("SVER="+C.za));const Br=ut[5];Br!=null&&typeof Br=="number"&&Br>0&&(L=1.5*Br,C.O=L,C.j.info("backChannelRequestTimeoutMs_="+L)),L=C;const Gr=g.g;if(Gr){const Zl=Gr.g?Gr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zl){var ee=L.h;ee.g||Zl.indexOf("spdy")==-1&&Zl.indexOf("quic")==-1&&Zl.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(Ul(ee,ee.h),ee.h=null))}if(L.G){const Qu=Gr.g?Gr.g.getResponseHeader("X-HTTP-Session-Id"):null;Qu&&(L.wa=Qu,st(L.J,L.G,Qu))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-g.F,C.j.info("Handshake RTT: "+C.T+"ms")),L=C;var de=g;if(L.na=Zu(L,L.L?L.ba:null,L.W),de.L){fa(L.h,de);var Ve=de,Vt=L.O;Vt&&(Ve.H=Vt),Ve.D&&(Vl(Ve),ua(Ve)),L.g=de}else Cn(L);C.i.length>0&&ws(C)}else ut[0]!="stop"&&ut[0]!="close"||gi(C,7);else C.I==3&&(ut[0]=="stop"||ut[0]=="close"?ut[0]=="stop"?gi(C,7):$l(C):ut[0]!="noop"&&C.l&&C.l.qa(ut),C.A=0)}}Fn(4)}catch{}}var py=class{constructor(g,w){this.g=g,this.map=w}};function jl(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ju(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function da(g){return g.h?1:g.g?g.g.size:0}function Uu(g,w){return g.h?g.h==w:g.g?g.g.has(w):!1}function Ul(g,w){g.g?g.g.add(w):g.h=w}function fa(g,w){g.h&&g.h==w?g.h=null:g.g&&g.g.has(w)&&g.g.delete(w)}jl.prototype.cancel=function(){if(this.i=ui(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function ui(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let w=g.i;for(const C of g.g.values())w=w.concat(C.G);return w}return x(g.i)}var Ef=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hi(g,w){if(g){g=g.split("&");for(let C=0;C<g.length;C++){const L=g[C].indexOf("=");let X,ee=null;L>=0?(X=g[C].substring(0,L),ee=g[C].substring(L+1)):X=g[C],w(X,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Dr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;g instanceof Dr?(this.l=g.l,ga(this,g.j),this.o=g.o,this.g=g.g,Mr(this,g.u),this.h=g.h,ro(this,Xu(g.i)),this.m=g.m):g&&(w=String(g).match(Ef))?(this.l=!1,ga(this,w[1]||"",!0),this.o=pa(w[2]||""),this.g=pa(w[3]||"",!0),Mr(this,w[4]),this.h=pa(w[5]||"",!0),ro(this,w[6]||"",!0),this.m=pa(w[7]||"")):(this.l=!1,this.i=new He(null,this.l))}Dr.prototype.toString=function(){const g=[];var w=this.j;w&&g.push(ma(w,Bu,!0),":");var C=this.g;return(C||w=="file")&&(g.push("//"),(w=this.o)&&g.push(ma(w,Bu,!0),"@"),g.push(Di(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&g.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&g.push("/"),g.push(ma(C,C.charAt(0)=="/"?ya:Gu,!0))),(C=this.i.toString())&&g.push("?",C),(C=this.m)&&g.push("#",ma(C,Wu)),g.join("")},Dr.prototype.resolve=function(g){const w=Ni(this);let C=!!g.j;C?ga(w,g.j):C=!!g.o,C?w.o=g.o:C=!!g.g,C?w.g=g.g:C=g.u!=null;var L=g.h;if(C)Mr(w,g.u);else if(C=!!g.h){if(L.charAt(0)!="/")if(this.g&&!this.h)L="/"+L;else{var X=w.h.lastIndexOf("/");X!=-1&&(L=w.h.slice(0,X+1)+L)}if(X=L,X==".."||X==".")L="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){L=X.lastIndexOf("/",0)==0,X=X.split("/");const ee=[];for(let de=0;de<X.length;){const Ve=X[de++];Ve=="."?L&&de==X.length&&ee.push(""):Ve==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),L&&de==X.length&&ee.push("")):(ee.push(Ve),L=!0)}L=ee.join("/")}else L=X}return C?w.h=L:C=g.i.toString()!=="",C?ro(w,Xu(g.i)):C=!!g.m,C&&(w.m=g.m),w};function Ni(g){return new Dr(g)}function ga(g,w,C){g.j=C?pa(w,!0):w,g.j&&(g.j=g.j.replace(/:$/,""))}function Mr(g,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);g.u=w}else g.u=null}function ro(g,w,C){w instanceof He?(g.i=w,Bl(g.i,g.l)):(C||(w=ma(w,my)),g.i=new He(w,g.l))}function st(g,w,C){g.i.set(w,C)}function ms(g){return st(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function pa(g,w){return g?w?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ma(g,w,C){return typeof g=="string"?(g=encodeURI(g).replace(w,zu),C&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function zu(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Bu=/[#\/\?@]/g,Gu=/[#\?:]/g,ya=/[#\?]/g,my=/[#\?@]/g,Wu=/#/g;function He(g,w){this.h=this.g=null,this.i=g||null,this.j=!!w}function Nr(g){g.g||(g.g=new Map,g.h=0,g.i&&hi(g.i,function(w,C){g.add(decodeURIComponent(w.replace(/\+/g," ")),C)}))}n=He.prototype,n.add=function(g,w){Nr(this),this.i=null,g=Lr(this,g);let C=this.g.get(g);return C||this.g.set(g,C=[]),C.push(w),this.h+=1,this};function $u(g,w){Nr(g),w=Lr(g,w),g.g.has(w)&&(g.i=null,g.h-=g.g.get(w).length,g.g.delete(w))}function zl(g,w){return Nr(g),w=Lr(g,w),g.g.has(w)}n.forEach=function(g,w){Nr(this),this.g.forEach(function(C,L){C.forEach(function(X){g.call(w,X,L,this)},this)},this)};function Ku(g,w){Nr(g);let C=[];if(typeof w=="string")zl(g,w)&&(C=C.concat(g.g.get(Lr(g,w))));else for(g=Array.from(g.g.values()),w=0;w<g.length;w++)C=C.concat(g[w]);return C}n.set=function(g,w){return Nr(this),this.i=null,g=Lr(this,g),zl(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[w]),this.h+=1,this},n.get=function(g,w){return g?(g=Ku(this,g),g.length>0?String(g[0]):w):w};function Hu(g,w,C){$u(g,w),C.length>0&&(g.i=null,g.g.set(Lr(g,w),x(C)),g.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],w=Array.from(this.g.keys());for(let L=0;L<w.length;L++){var C=w[L];const X=Di(C);C=Ku(this,C);for(let ee=0;ee<C.length;ee++){let de=X;C[ee]!==""&&(de+="="+Di(C[ee])),g.push(de)}}return this.i=g.join("&")};function Xu(g){const w=new He;return w.i=g.i,g.g&&(w.g=new Map(g.g),w.h=g.h),w}function Lr(g,w){return w=String(w),g.j&&(w=w.toLowerCase()),w}function Bl(g,w){w&&!g.j&&(Nr(g),g.i=null,g.g.forEach(function(C,L){const X=L.toLowerCase();L!=X&&($u(this,L),Hu(this,X,C))},g)),g.j=w}function Or(g,w){const C=new Ot;if(o.Image){const L=new Image;L.onload=f(mn,C,"TestLoadImage: loaded",!0,w,L),L.onerror=f(mn,C,"TestLoadImage: error",!1,w,L),L.onabort=f(mn,C,"TestLoadImage: abort",!1,w,L),L.ontimeout=f(mn,C,"TestLoadImage: timeout",!1,w,L),o.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=g}else w(!1)}function Fr(g,w){const C=new Ot,L=new AbortController,X=setTimeout(()=>{L.abort(),mn(C,"TestPingServer: timeout",!1,w)},1e4);fetch(g,{signal:L.signal}).then(ee=>{clearTimeout(X),ee.ok?mn(C,"TestPingServer: ok",!0,w):mn(C,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(X),mn(C,"TestPingServer: error",!1,w)})}function mn(g,w,C,L,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),L(C)}catch{}}function _a(){this.g=new Ar}function ys(g){this.i=g.Sb||null,this.h=g.ab||!1}p(ys,bi),ys.prototype.g=function(){return new di(this.i,this.h)};function di(g,w){yt.call(this),this.H=g,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(di,yt),n=di.prototype,n.open=function(g,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=w,this.readyState=1,nr(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(w.body=g),(this.H||o).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,so(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,nr(this)),this.g&&(this.readyState=3,nr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Tf(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Tf(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var w=g.value?g.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!g.done}))&&(this.response=this.responseText+=w)}g.done?so(this):nr(this),this.readyState==3&&Tf(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,so(this))},n.Na=function(g){this.g&&(this.response=g,so(this))},n.ga=function(){this.g&&so(this)};function so(g){g.readyState=4,g.l=null,g.j=null,g.B=null,nr(g)}n.setRequestHeader=function(g,w){this.A.append(g,w)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],w=this.h.entries();for(var C=w.next();!C.done;)C=C.value,g.push(C[0]+": "+C[1]),C=w.next();return g.join(`\r
`)};function nr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function If(g){let w="";return le(g,function(C,L){w+=L,w+=":",w+=C,w+=`\r
`}),w}function Gl(g,w,C){e:{for(L in C){var L=!1;break e}L=!0}L||(C=If(C),typeof g=="string"?C!=null&&Di(C):st(g,w,C))}function pt(g){yt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(pt,yt);var Sf=/^https?$/i,yy=["POST","PUT"];n=pt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,w,C,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);w=w?w.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bt.g(),this.g.onreadystatechange=y(h(this.Ca,this));try{this.B=!0,this.g.open(w,String(g),!0),this.B=!1}catch(ee){oo(this,ee);return}if(g=C||"",C=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var X in L)C.set(X,L[X]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const ee of L.keys())C.set(ee,L.get(ee));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(C.keys()).find(ee=>ee.toLowerCase()=="content-type"),X=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(yy,w,void 0)>=0)||L||X||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,de]of C)this.g.setRequestHeader(ee,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(ee){oo(this,ee)}};function oo(g,w){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=w,g.o=5,ao(g),vs(g)}function ao(g){g.A||(g.A=!0,ct(g,"complete"),ct(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ct(this,"complete"),ct(this,"abort"),vs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vs(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?_s(this):this.Xa())},n.Xa=function(){_s(this)};function _s(g){if(g.h&&typeof s<"u"){if(g.v&&Vr(g)==4)setTimeout(g.Ca.bind(g),0);else if(ct(g,"readystatechange"),Vr(g)==4){g.h=!1;try{const ee=g.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var C;if(!(C=w)){var L;if(L=ee===0){let de=String(g.D).match(Ef)[1]||null;!de&&o.self&&o.self.location&&(de=o.self.location.protocol.slice(0,-1)),L=!Sf.test(de?de.toLowerCase():"")}C=L}if(C)ct(g,"complete"),ct(g,"success");else{g.o=6;try{var X=Vr(g)>2?g.g.statusText:""}catch{X=""}g.l=X+" ["+g.ca()+"]",ao(g)}}finally{vs(g)}}}}function vs(g,w){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const C=g.g;g.g=null,w||ct(g,"ready");try{C.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Vr(g){return g.g?g.g.readyState:0}n.ca=function(){try{return Vr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var w=this.g.responseText;return g&&w.indexOf(g)==0&&(w=w.substring(g.length)),ca(w)}};function Cf(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function qu(g){const w={};g=(g.g&&Vr(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<g.length;L++){if(N(g[L]))continue;var C=Fl(g[L]);const X=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ee=w[X]||[];w[X]=ee,ee.push(C)}ie(w,function(L){return L.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function jr(g,w,C){return C&&C.internalChannelParams&&C.internalChannelParams[g]||w}function Wl(g){this.za=0,this.i=[],this.j=new Ot,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=jr("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=jr("baseRetryDelayMs",5e3,g),this.Za=jr("retryDelaySeedMs",1e4,g),this.Ta=jr("forwardChannelMaxRetries",2,g),this.va=jr("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new jl(g&&g.concurrentRequestLimit),this.Ba=new _a,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Wl.prototype,n.ka=8,n.I=1,n.connect=function(g,w,C,L){ft(0),this.W=g,this.H=w||{},C&&L!==void 0&&(this.H.OSID=C,this.H.OAID=L),this.F=this.X,this.J=Zu(this,null,this.W),ws(this)};function $l(g){if(Kl(g),g.I==3){var w=g.V++,C=Ni(g.J);if(st(C,"SID",g.M),st(C,"RID",w),st(C,"TYPE","terminate"),Ur(g,C),w=new Mi(g,g.j,w),w.M=2,w.A=ms(Ni(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(w.A.toString(),"")}catch{}!C&&o.Image&&(new Image().src=w.A,C=!0),C||(w.g=Af(w.j,null),w.g.ea(w.A)),w.F=Date.now(),ua(w)}xa(g)}function fi(g){g.g&&(wa(g),g.g.cancel(),g.g=null)}function Kl(g){fi(g),g.v&&(o.clearTimeout(g.v),g.v=null),Hl(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function ws(g){if(!ju(g.h)&&!g.m){g.m=!0;var w=g.Ea;F||R(),G||(F(),G=!0),b.add(w,g),g.D=0}}function Rf(g,w){return da(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=w.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=er(h(g.Ea,g,w),ql(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const X=new Mi(this,this.j,g);let ee=this.o;if(this.U&&(ee?(ee=W(ee),Ee(ee,this.U)):ee=this.U),this.u!==null||this.R||(X.J=ee,ee=null),this.S)e:{for(var w=0,C=0;C<this.i.length;C++){t:{var L=this.i[C];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(w+=L,w>4096){w=C;break e}if(w===4096||C===this.i.length-1){w=C+1;break e}}w=1e3}else w=1e3;w=Yu(this,X,w),C=Ni(this.J),st(C,"RID",g),st(C,"CVER",22),this.G&&st(C,"X-HTTP-Session-Id",this.G),Ur(this,C),ee&&(this.R?w="headers="+Di(If(ee))+"&"+w:this.u&&Gl(C,this.u,ee)),Ul(this.h,X),this.Ra&&st(C,"TYPE","init"),this.S?(st(C,"$req",w),st(C,"SID","null"),X.U=!0,tr(X,C,null)):tr(X,C,w),this.I=2}}else this.I==3&&(g?va(this,g):this.i.length==0||ju(this.h)||va(this))};function va(g,w){var C;w?C=w.l:C=g.V++;const L=Ni(g.J);st(L,"SID",g.M),st(L,"RID",C),st(L,"AID",g.K),Ur(g,L),g.u&&g.o&&Gl(L,g.u,g.o),C=new Mi(g,g.j,C,g.D+1),g.u===null&&(C.J=g.o),w&&(g.i=w.G.concat(g.i)),w=Yu(g,C,1e3),C.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Ul(g.h,C),tr(C,L,w)}function Ur(g,w){g.H&&le(g.H,function(C,L){st(w,L,C)}),g.l&&le({},function(C,L){st(w,L,C)})}function Yu(g,w,C){C=Math.min(g.i.length,C);const L=g.l?h(g.l.Ka,g.l,g):null;e:{var X=g.i;let Ve=-1;for(;;){const Vt=["count="+C];Ve==-1?C>0?(Ve=X[0].g,Vt.push("ofs="+Ve)):Ve=0:Vt.push("ofs="+Ve);let ut=!0;for(let Gt=0;Gt<C;Gt++){var ee=X[Gt].g;const pi=X[Gt].map;if(ee-=Ve,ee<0)Ve=Math.max(0,X[Gt].g-100),ut=!1;else try{ee="req"+ee+"_"||"";try{var de=pi instanceof Map?pi:Object.entries(pi);for(const[xs,Br]of de){let Gr=Br;l(Br)&&(Gr=Rr(Br)),Vt.push(ee+xs+"="+encodeURIComponent(Gr))}}catch(xs){throw Vt.push(ee+"type="+encodeURIComponent("_badmap")),xs}}catch{L&&L(pi)}}if(ut){de=Vt.join("&");break e}}de=void 0}return g=g.i.splice(0,C),w.G=g,de}function Cn(g){if(!g.g&&!g.v){g.Y=1;var w=g.Da;F||R(),G||(F(),G=!0),b.add(w,g),g.A=0}}function zr(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=er(h(g.Da,g),ql(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,lo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=er(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ft(10),fi(this),lo(this))};function wa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function lo(g){g.g=new Mi(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var w=Ni(g.na);st(w,"RID","rpc"),st(w,"SID",g.M),st(w,"AID",g.K),st(w,"CI",g.F?"0":"1"),!g.F&&g.ia&&st(w,"TO",g.ia),st(w,"TYPE","xmlhttp"),Ur(g,w),g.u&&g.o&&Gl(w,g.u,g.o),g.O&&(g.g.H=g.O);var C=g.g;g=g.ba,C.M=1,C.A=ms(Ni(w)),C.u=null,C.R=!0,Fu(C,g)}n.Va=function(){this.C!=null&&(this.C=null,fi(this),zr(this),ft(19))};function Hl(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function Xl(g,w){var C=null;if(g.g==w){Hl(g),wa(g),g.g=null;var L=2}else if(Uu(g.h,w))C=w.G,fa(g.h,w),L=1;else return;if(g.I!=0){if(w.o)if(L==1){C=w.u?w.u.length:0,w=Date.now()-w.F;var X=g.D;L=br(),ct(L,new io(L,C)),ws(g)}else Cn(g);else if(X=w.m,X==3||X==0&&w.X>0||!(L==1&&Rf(g,w)||L==2&&zr(g)))switch(C&&C.length>0&&(w=g.h,w.i=w.i.concat(C)),X){case 1:gi(g,5);break;case 4:gi(g,10);break;case 3:gi(g,6);break;default:gi(g,2)}}}function ql(g,w){let C=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(C*=2),C*w}function gi(g,w){if(g.j.info("Error code "+w),w==2){var C=h(g.bb,g),L=g.Ua;const X=!L;L=new Dr(L||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ga(L,"https"),ms(L),X?Or(L.toString(),C):Fr(L.toString(),C)}else ft(2);g.I=0,g.l&&g.l.pa(w),xa(g),Kl(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function xa(g){if(g.I=0,g.ja=[],g.l){const w=ui(g.h);(w.length!=0||g.i.length!=0)&&(I(g.ja,w),I(g.ja,g.i),g.h.i.length=0,x(g.i),g.i.length=0),g.l.oa()}}function Zu(g,w,C){var L=C instanceof Dr?Ni(C):new Dr(C);if(L.g!="")w&&(L.g=w+"."+L.g),Mr(L,L.u);else{var X=o.location;L=X.protocol,w=w?w+"."+X.hostname:X.hostname,X=+X.port;const ee=new Dr(null);L&&ga(ee,L),w&&(ee.g=w),X&&Mr(ee,X),C&&(ee.h=C),L=ee}return C=g.G,w=g.wa,C&&w&&st(L,C,w),st(L,"VER",g.ka),Ur(g,L),L}function Af(g,w,C){if(w&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=g.Aa&&!g.ma?new pt(new ys({ab:C})):new pt(g.ma),w.Fa(g.L),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pf(){}n=Pf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Yl(){}Yl.prototype.g=function(g,w){return new yn(g,w)};function yn(g,w){yt.call(this),this.g=new Wl(w),this.l=g,this.h=w&&w.messageUrlParams||null,g=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(g?g["X-WebChannel-Content-Type"]=w.messageContentType:g={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(g?g["X-WebChannel-Client-Profile"]=w.sa:g={"X-WebChannel-Client-Profile":w.sa}),this.g.U=g,(g=w&&w.Qb)&&!N(g)&&(this.g.u=g),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!N(w)&&(this.g.G=w,g=this.h,g!==null&&w in g&&(g=this.h,w in g&&delete g[w])),this.j=new co(this)}p(yn,yt),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){$l(this.g)},yn.prototype.o=function(g){var w=this.g;if(typeof g=="string"){var C={};C.__data__=g,g=C}else this.v&&(C={},C.__data__=Rr(g),g=C);w.i.push(new py(w.Ya++,g)),w.I==3&&ws(w)},yn.prototype.N=function(){this.g.l=null,delete this.j,$l(this.g),delete this.g,yn.Z.N.call(this)};function bf(g){fs.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var w=g.__sm__;if(w){e:{for(const C in w){g=C;break e}g=void 0}(this.i=g)&&(g=this.i,w=w!==null&&g in w?w[g]:void 0),this.data=w}else this.data=g}p(bf,fs);function kf(){no.call(this),this.status=1}p(kf,no);function co(g){this.g=g}p(co,Pf),co.prototype.ra=function(){ct(this.g,"a")},co.prototype.qa=function(g){ct(this.g,new bf(g))},co.prototype.pa=function(g){ct(this.g,new kf)},co.prototype.oa=function(){ct(this.g,"b")},Yl.prototype.createWebChannel=Yl.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,kk=function(){return new Yl},bk=function(){return br()},Pk=On,Kv={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},nn.NO_ERROR=0,nn.TIMEOUT=8,nn.HTTP_ERROR=6,cp=nn,rt.COMPLETE="complete",Ak=rt,Ol.EventType=Pr,Pr.OPEN="a",Pr.CLOSE="b",Pr.ERROR="c",Pr.MESSAGE="d",yt.prototype.listen=yt.prototype.J,Hh=Ol,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,Rk=pt}).apply(typeof Wg<"u"?Wg:typeof self<"u"?self:typeof window<"u"?window:{});const nR="@firebase/firestore",iR="4.9.3";let xn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};xn.UNAUTHENTICATED=new xn(null),xn.GOOGLE_CREDENTIALS=new xn("google-credentials-uid"),xn.FIRST_PARTY=new xn("first-party-uid"),xn.MOCK_USER=new xn("mock-user");let Nu="12.7.0";const Tl=new jx("@firebase/firestore");function Lc(){return Tl.logLevel}function fe(n,...e){if(Tl.logLevel<=Ke.DEBUG){const t=e.map(Jx);Tl.debug(`Firestore (${Nu}): ${n}`,...t)}}function xi(n,...e){if(Tl.logLevel<=Ke.ERROR){const t=e.map(Jx);Tl.error(`Firestore (${Nu}): ${n}`,...t)}}function qm(n,...e){if(Tl.logLevel<=Ke.WARN){const t=e.map(Jx);Tl.warn(`Firestore (${Nu}): ${n}`,...t)}}function Jx(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Re(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Dk(n,i,t)}function Dk(n,e,t){let i=`FIRESTORE (${Nu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw xi(i),new Error(i)}function De(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||Dk(e,r,i)}function Tt(n,e){return n}const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class xe extends us{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ll{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Mk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class y8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(xn.UNAUTHENTICATED)))}shutdown(){}}class _8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class v8{constructor(e){this.t=e,this.currentUser=xn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){De(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new ll;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ll,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},l=u=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ll)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(De(typeof i.accessToken=="string",31837,{l:i}),new Mk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return De(e===null||typeof e=="string",2055,{h:e}),new xn(e)}}class w8{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=xn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class x8{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new w8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(xn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class rR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class E8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$i(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){De(this.o===void 0,3512);const i=s=>{s.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new rR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(De(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new rR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function T8(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Nk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=T8(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function $e(n,e){return n<e?-1:n>e?1:0}function Hv(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return z0(r)===z0(s)?$e(r,s):z0(r)?1:-1}return $e(n.length,e.length)}const I8=55296,S8=57343;function z0(n){const e=n.charCodeAt(0);return e>=I8&&e<=S8}function pu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function Lk(n){return n+"\0"}const sR="__name__";class Xr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Re(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Re(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Xr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Xr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Xr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return $e(e.length,t.length)}static compareSegments(e,t){const i=Xr.isNumericId(e),r=Xr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Xr.extractNumericId(e).compare(Xr.extractNumericId(t)):Hv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Qx.fromString(e.substring(4,e.length-2))}}class Ct extends Xr{construct(e,t,i){return new Ct(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new xe(ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Ct(t)}static emptyPath(){return new Ct([])}}const C8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends Xr{construct(e,t,i){return new zt(e,t,i)}static isValidIdentifier(e){return C8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===sR}static keyField(){return new zt([sR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new xe(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new xe(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new xe(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new xe(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(t)}static emptyPath(){return new zt([])}}class ve{constructor(e){this.path=e}static fromPath(e){return new ve(Ct.fromString(e))}static fromName(e){return new ve(Ct.fromString(e).popFirst(5))}static empty(){return new ve(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ve(new Ct(e.slice()))}}function R8(n,e,t,i){if(e===!0&&i===!0)throw new xe(ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function A8(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function P8(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Re(12329,{type:typeof n})}function Ok(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new xe(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=P8(n);throw new xe(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Ht(n,e){const t={typeString:n};return e&&(t.value=e),t}function ff(n,e){if(!A8(n))throw new xe(ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new xe(ae.INVALID_ARGUMENT,t);return!0}const oR=-62135596800,aR=1e6;class bt{static now(){return bt.fromMillis(Date.now())}static fromDate(e){return bt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*aR);return new bt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new xe(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new xe(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<oR)throw new xe(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new xe(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/aR}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ff(e,bt._jsonSchema))return new bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-oR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}bt._jsonSchemaVersion="firestore/timestamp/1.0",bt._jsonSchema={type:Ht("string",bt._jsonSchemaVersion),seconds:Ht("number"),nanoseconds:Ht("number")};class Ze{static fromTimestamp(e){return new Ze(e)}static min(){return new Ze(new bt(0,0))}static max(){return new Ze(new bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ld=-1;class Qp{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Xv(n){return n.fields.find((e=>e.kind===2))}function Ga(n){return n.fields.filter((e=>e.kind!==2))}Qp.UNKNOWN_ID=-1;class up{constructor(e,t){this.fieldPath=e,this.kind=t}}class Od{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Od(0,Ci.min())}}function b8(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Ze.fromTimestamp(i===1e9?new bt(t+1,0):new bt(t,i));return new Ci(r,ve.empty(),e)}function Fk(n){return new Ci(n.readTime,n.key,Ld)}class Ci{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ci(Ze.min(),ve.empty(),Ld)}static max(){return new Ci(Ze.max(),ve.empty(),Ld)}}function eE(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ve.comparator(n.documentKey,e.documentKey),t!==0?t:$e(n.largestBatchId,e.largestBatchId))}const Vk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ym(n){if(n.code!==ae.FAILED_PRECONDITION||n.message!==Vk)throw n;fe("LocalStore","Unexpectedly lost primary lease")}class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Y(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Y?t:Y.resolve(t)}catch(t){return Y.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Y.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Y.reject(t)}static resolve(e){return new Y(((t,i)=>{t(e)}))}static reject(e){return new Y(((t,i)=>{i(e)}))}static waitFor(e){return new Y(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=Y.resolve(!1);for(const i of e)t=t.next((r=>r?Y.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Y(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new Y(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const vi="SimpleDb";class Zm{static open(e,t,i,r){try{return new Zm(t,e.transaction(r,i))}catch(s){throw new id(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ll,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new id(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=tE(i.target.error);this.S.reject(new id(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(fe(vi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new D8(t)}}class Qo{static delete(e){return fe(vi,"Removing database:",e),Ka(O2().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!$2())return!1;if(Qo.F())return!0;const e=Jt(),t=Qo.M(e),i=0<t&&t<10,r=Uk(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Qo.M(Jt())===12.2&&xi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(fe(vi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new id(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new xe(ae.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new xe(ae.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new id(e,o))},r.onupgradeneeded=s=>{fe(vi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{fe(vi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=Zm.open(this.db,e,s?"readonly":"readwrite",i),u=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),Y.reject(h)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,h=u.name!=="FirebaseError"&&o<3;if(fe(vi,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Uk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class k8{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ka(this.U.delete())}}class id extends xe{constructor(e,t){super(ae.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ll(n){return n.name==="IndexedDbTransactionError"}class D8{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(fe(vi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(fe(vi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ka(i)}add(e){return fe(vi,"ADD",this.store.name,e,e),Ka(this.store.add(e))}get(e){return Ka(this.store.get(e)).next((t=>(t===void 0&&(t=null),fe(vi,"GET",this.store.name,e,t),t)))}delete(e){return fe(vi,"DELETE",this.store.name,e),Ka(this.store.delete(e))}count(){return fe(vi,"COUNT",this.store.name),Ka(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Y(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Y(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){fe(vi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Y(((i,r)=>{t.onerror=s=>{const o=tE(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Y(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new k8(l),h=t(l.primaryKey,l.value,u);if(h instanceof Y){const f=h.catch((p=>(u.done(),Y.reject(p))));i.push(f)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}})).next((()=>Y.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ka(n){return new Y(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=tE(i.target.error);t(r)}}))}let lR=!1;function tE(n){const e=Qo.M(Jt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new xe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return lR||(lR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const rd="IndexBackfiller";class M8{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){fe(rd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();fe(rd,`Documents written: ${t}`)}catch(t){Ll(t)?fe(rd,"Ignoring IndexedDB error during index backfill: ",t):await Ym(t)}await this.re(6e4)}))}}class N8{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Y.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return fe(rd,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(fe(rd,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=Fk(s);eE(o,i)>0&&(i=o)})),new Ci(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class yr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}yr.ce=-1;const cl=-1;function Qm(n){return n==null}function Jp(n){return n===0&&1/n==-1/0}const em="";function Gn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=cR(e)),e=L8(n.get(t),e);return cR(e)}function L8(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case em:t+="";break;default:t+=s}}return t}function cR(n){return n+em+""}function Qr(n){const e=n.length;if(De(e>=2,64408,{path:n}),e===2)return De(n.charAt(0)===em&&n.charAt(1)==="",56145,{path:n}),Ct.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(em,s);switch((o<0||o>t)&&Re(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Re(61167,{path:n})}s=o+2}return new Ct(i)}const Wa="remoteDocuments",gf="owner",Sc="owner",Fd="mutationQueues",O8="userId",hr="mutations",uR="batchId",nl="userMutationsIndex",hR=["userId","batchId"];function hp(n,e){return[n,Gn(e)]}function zk(n,e,t){return[n,Gn(e),t]}const F8={},mu="documentMutations",tm="remoteDocumentsV14",V8=["prefixPath","collectionGroup","readTime","documentId"],dp="documentKeyIndex",j8=["prefixPath","collectionGroup","documentId"],Bk="collectionGroupIndex",U8=["collectionGroup","readTime","prefixPath","documentId"],Vd="remoteDocumentGlobal",qv="remoteDocumentGlobalKey",yu="targets",Gk="queryTargetsIndex",z8=["canonicalId","targetId"],_u="targetDocuments",B8=["targetId","path"],nE="documentTargetsIndex",G8=["path","targetId"],nm="targetGlobalKey",ul="targetGlobal",jd="collectionParents",W8=["collectionId","parent"],vu="clientMetadata",$8="clientId",Jm="bundles",K8="bundleId",ey="namedQueries",H8="name",iE="indexConfiguration",X8="indexId",Yv="collectionGroupIndex",q8="collectionGroup",sd="indexState",Y8=["indexId","uid"],Wk="sequenceNumberIndex",Z8=["uid","sequenceNumber"],od="indexEntries",Q8=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],$k="documentKeyIndex",J8=["indexId","uid","orderedDocumentKey"],ty="documentOverlays",eG=["userId","collectionPath","documentId"],Zv="collectionPathOverlayIndex",tG=["userId","collectionPath","largestBatchId"],Kk="collectionGroupOverlayIndex",nG=["userId","collectionGroup","largestBatchId"],rE="globals",iG="name",Hk=[Fd,hr,mu,Wa,yu,gf,ul,_u,vu,Vd,jd,Jm,ey],rG=[...Hk,ty],Xk=[Fd,hr,mu,tm,yu,gf,ul,_u,vu,Vd,jd,Jm,ey,ty],qk=Xk,sE=[...qk,iE,sd,od],sG=sE,Yk=[...sE,rE],oG=Yk;class Qv extends jk{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function en(n,e){const t=Tt(n);return Qo.O(t.le,e)}function dR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function oE(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function aG(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class li{constructor(e,t){this.comparator=e,this.root=t||En.EMPTY}insert(e,t){return new li(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new li(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $g(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $g(this.root,e,this.comparator,!1)}getReverseIterator(){return new $g(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $g(this.root,e,this.comparator,!0)}}class $g{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??En.RED,this.left=r??En.EMPTY,this.right=s??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new En(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return En.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Re(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw Re(57766)}get value(){throw Re(16141)}get color(){throw Re(16727)}get left(){throw Re(29726)}get right(){throw Re(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new En(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class mt{constructor(e){this.comparator=e,this.data=new li(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new fR(this.data.getIterator())}getIteratorFrom(e){return new fR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new mt(this.comparator);return t.data=e,t}}class fR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Cc(n){return n.hasNext()?n.getNext():void 0}class Vs{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new Vs([])}unionWith(e){let t=new mt(zt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Vs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class lG extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ci{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new lG("Invalid base64 string: "+s):s}})(e);return new ci(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new ci(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ci.EMPTY_BYTE_STRING=new ci("");const cG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ia(n){if(De(!!n,39018),typeof n=="string"){let e=0;const t=cG.exec(n);if(De(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Kt(n.seconds),nanos:Kt(n.nanos)}}function Kt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wu(n){return typeof n=="string"?ci.fromBase64String(n):ci.fromUint8Array(n)}const Zk="server_timestamp",Qk="__type__",Jk="__previous_value__",eD="__local_write_time__";function aE(n){return(n?.mapValue?.fields||{})[Qk]?.stringValue===Zk}function tD(n){const e=n.mapValue.fields[Jk];return aE(e)?tD(e):e}function im(n){const e=ia(n.mapValue.fields[eD].timestampValue);return new bt(e.seconds,e.nanos)}class uG{constructor(e,t,i,r,s,o,l,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const rm="(default)";class xu{constructor(e,t){this.projectId=e,this.database=t||rm}static empty(){return new xu("","")}get isDefaultDatabase(){return this.database===rm}isEqual(e){return e instanceof xu&&e.projectId===this.projectId&&e.database===this.database}}const nD="__type__",iD="__max__",Ko={mapValue:{fields:{__type__:{stringValue:iD}}}},rD="__vector__",sm="value",fp={nullValue:"NULL_VALUE"};function Eu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?aE(n)?4:sD(n)?9007199254740991:ny(n)?10:11:Re(28295,{value:n})}function os(n,e){if(n===e)return!0;const t=Eu(n);if(t!==Eu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return im(n).isEqual(im(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ia(r.timestampValue),l=ia(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return wu(r.bytesValue).isEqual(wu(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Kt(r.geoPointValue.latitude)===Kt(s.geoPointValue.latitude)&&Kt(r.geoPointValue.longitude)===Kt(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Kt(r.integerValue)===Kt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Kt(r.doubleValue),l=Kt(s.doubleValue);return o===l?Jp(o)===Jp(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return pu(n.arrayValue.values||[],e.arrayValue.values||[],os);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(dR(o)!==dR(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!os(o[u],l[u])))return!1;return!0})(n,e);default:return Re(52216,{left:n})}}function Ud(n,e){return(n.values||[]).find((t=>os(t,e)))!==void 0}function ra(n,e){if(n===e)return 0;const t=Eu(n),i=Eu(e);if(t!==i)return $e(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return $e(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=Kt(s.integerValue||s.doubleValue),u=Kt(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return gR(n.timestampValue,e.timestampValue);case 4:return gR(im(n),im(e));case 5:return Hv(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=wu(s),u=wu(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=$e(l[h],u[h]);if(f!==0)return f}return $e(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=$e(Kt(s.latitude),Kt(o.latitude));return l!==0?l:$e(Kt(s.longitude),Kt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return pR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[sm]?.arrayValue,f=u[sm]?.arrayValue,p=$e(h?.values?.length||0,f?.values?.length||0);return p!==0?p:pR(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Ko.mapValue&&o===Ko.mapValue)return 0;if(s===Ko.mapValue)return 1;if(o===Ko.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const y=Hv(u[p],f[p]);if(y!==0)return y;const x=ra(l[u[p]],h[f[p]]);if(x!==0)return x}return $e(u.length,f.length)})(n.mapValue,e.mapValue);default:throw Re(23264,{he:t})}}function gR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return $e(n,e);const t=ia(n),i=ia(e),r=$e(t.seconds,i.seconds);return r!==0?r:$e(t.nanos,i.nanos)}function pR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=ra(t[r],i[r]);if(s)return s}return $e(t.length,i.length)}function Tu(n){return Jv(n)}function Jv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ia(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return wu(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ve.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=Jv(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${Jv(t.fields[o])}`;return r+"}"})(n.mapValue):Re(61005,{value:n})}function lE(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ew(n){return!!n&&"integerValue"in n}function zd(n){return!!n&&"arrayValue"in n}function mR(n){return!!n&&"nullValue"in n}function yR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function B0(n){return!!n&&"mapValue"in n}function ny(n){return(n?.mapValue?.fields||{})[nD]?.stringValue===rD}function ad(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return oE(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=ad(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ad(n.arrayValue.values[t]);return e}return{...n}}function sD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===iD}const oD={mapValue:{fields:{[nD]:{stringValue:rD},[sm]:{arrayValue:{}}}}};function hG(n){return"nullValue"in n?fp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?lE(xu.empty(),ve.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?ny(n)?oD:{mapValue:{}}:Re(35942,{value:n})}function dG(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?lE(xu.empty(),ve.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?oD:"mapValue"in n?ny(n)?{mapValue:{}}:Ko:Re(61959,{value:n})}function _R(n,e){const t=ra(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function vR(n,e){const t=ra(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class pr{constructor(e){this.value=e}static empty(){return new pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!B0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ad(t)}setAll(e){let t=zt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=ad(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());B0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return os(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];B0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){oE(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new pr(ad(this.value))}}class Tn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Ze.min(),Ze.min(),Ze.min(),pr.empty(),0)}static newFoundDocument(e,t,i,r){return new Tn(e,1,t,Ze.min(),i,r,0)}static newNoDocument(e,t){return new Tn(e,2,t,Ze.min(),Ze.min(),pr.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Ze.min(),Ze.min(),pr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ze.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ze.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Iu{constructor(e,t){this.position=e,this.inclusive=t}}function wR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=ve.comparator(ve.fromName(o.referenceValue),t.key):i=ra(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function xR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!os(n.position[t],e.position[t]))return!1;return!0}class om{constructor(e,t="asc"){this.field=e,this.dir=t}}function fG(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class aD{}class qe extends aD{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new gG(e,t,i):t==="array-contains"?new yG(e,i):t==="in"?new fD(e,i):t==="not-in"?new _G(e,i):t==="array-contains-any"?new vG(e,i):new qe(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new pG(e,i):new mG(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ra(t,this.value)):t!==null&&Eu(this.value)===Eu(t)&&this.matchesComparison(ra(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gt extends aD{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new gt(e,t)}matches(e){return Su(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Su(n){return n.op==="and"}function tw(n){return n.op==="or"}function cE(n){return lD(n)&&Su(n)}function lD(n){for(const e of n.filters)if(e instanceof gt)return!1;return!0}function nw(n){if(n instanceof qe)return n.field.canonicalString()+n.op.toString()+Tu(n.value);if(cE(n))return n.filters.map((e=>nw(e))).join(",");{const e=n.filters.map((t=>nw(t))).join(",");return`${n.op}(${e})`}}function cD(n,e){return n instanceof qe?(function(i,r){return r instanceof qe&&i.op===r.op&&i.field.isEqual(r.field)&&os(i.value,r.value)})(n,e):n instanceof gt?(function(i,r){return r instanceof gt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&cD(o,r.filters[l])),!0):!1})(n,e):void Re(19439)}function uD(n,e){const t=n.filters.concat(e);return gt.create(t,n.op)}function hD(n){return n instanceof qe?(function(t){return`${t.field.canonicalString()} ${t.op} ${Tu(t.value)}`})(n):n instanceof gt?(function(t){return t.op.toString()+" {"+t.getFilters().map(hD).join(" ,")+"}"})(n):"Filter"}class gG extends qe{constructor(e,t,i){super(e,t,i),this.key=ve.fromName(i.referenceValue)}matches(e){const t=ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class pG extends qe{constructor(e,t){super(e,"in",t),this.keys=dD("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class mG extends qe{constructor(e,t){super(e,"not-in",t),this.keys=dD("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function dD(n,e){return(e.arrayValue?.values||[]).map((t=>ve.fromName(t.referenceValue)))}class yG extends qe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return zd(t)&&Ud(t.arrayValue,this.value)}}class fD extends qe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ud(this.value.arrayValue,t)}}class _G extends qe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ud(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ud(this.value.arrayValue,t)}}class vG extends qe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!zd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Ud(this.value.arrayValue,i)))}}class wG{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function iw(n,e=null,t=[],i=[],r=null,s=null,o=null){return new wG(n,e,t,i,r,s,o)}function Il(n){const e=Tt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>nw(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),Qm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Tu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Tu(i))).join(",")),e.Te=t}return e.Te}function pf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!fG(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!cD(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!xR(n.startAt,e.startAt)&&xR(n.endAt,e.endAt)}function xG(n){return ve.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function am(n,e){return n.filters.filter((t=>t instanceof qe&&t.field.isEqual(e)))}function ER(n,e,t){let i=fp,r=!0;for(const s of am(n,e)){let o=fp,l=!0;switch(s.op){case"<":case"<=":o=hG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=fp}_R({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];_R({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function TR(n,e,t){let i=Ko,r=!0;for(const s of am(n,e)){let o=Ko,l=!0;switch(s.op){case">=":case">":o=dG(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Ko}vR({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];vR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class iy{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function EG(n,e,t,i,r,s,o,l){return new iy(n,e,t,i,r,s,o,l)}function gD(n){return new iy(n)}function IR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function TG(n){return n.collectionGroup!==null}function ld(n){const e=Tt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new mt(zt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new om(s,i))})),t.has(zt.keyField().canonicalString())||e.Ie.push(new om(zt.keyField(),i))}return e.Ie}function Ws(n){const e=Tt(n);return e.Ee||(e.Ee=IG(e,ld(n))),e.Ee}function IG(n,e){if(n.limitType==="F")return iw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new om(r.field,s)}));const t=n.endAt?new Iu(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Iu(n.startAt.position,n.startAt.inclusive):null;return iw(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function rw(n,e,t){return new iy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function pD(n,e){return pf(Ws(n),Ws(e))&&n.limitType===e.limitType}function mD(n){return`${Il(Ws(n))}|lt:${n.limitType}`}function kh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>hD(r))).join(", ")}]`),Qm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Tu(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Tu(r))).join(",")),`Target(${i})`})(Ws(n))}; limitType=${n.limitType})`}function ry(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):ve.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of ld(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,u){const h=wR(o,l,u);return o.inclusive?h<=0:h<0})(i.startAt,ld(i),r)||i.endAt&&!(function(o,l,u){const h=wR(o,l,u);return o.inclusive?h>=0:h>0})(i.endAt,ld(i),r))})(n,e)}function SG(n){return(e,t)=>{let i=!1;for(const r of ld(n)){const s=CG(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function CG(n,e,t){const i=n.field.isKeyField()?ve.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?ra(u,h):Re(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Re(19790,{direction:n.dir})}}class la{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){oE(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return aG(this.inner)}size(){return this.innerSize}}const RG=new li(ve.comparator);function il(){return RG}const yD=new li(ve.comparator);function Kg(...n){let e=yD;for(const t of n)e=e.insert(t.key,t);return e}function AG(n){let e=yD;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Jr(){return cd()}function _D(){return cd()}function cd(){return new la((n=>n.toString()),((n,e)=>n.isEqual(e)))}const PG=new li(ve.comparator),bG=new mt(ve.comparator);function In(...n){let e=bG;for(const t of n)e=e.add(t);return e}const kG=new mt($e);function DG(){return kG}function MG(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Jp(e)?"-0":e}}function NG(n){return{integerValue:""+n}}class sy{constructor(){this._=void 0}}function LG(n,e,t){return n instanceof Bd?(function(r,s){const o={fields:{[Qk]:{stringValue:Zk},[eD]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&aE(s)&&(s=tD(s)),s&&(o.fields[Jk]=s),{mapValue:o}})(t,e):n instanceof Cu?vD(n,e):n instanceof Ru?wD(n,e):(function(r,s){const o=FG(r,s),l=SR(o)+SR(r.Ae);return ew(o)&&ew(r.Ae)?NG(l):MG(r.serializer,l)})(n,e)}function OG(n,e,t){return n instanceof Cu?vD(n,e):n instanceof Ru?wD(n,e):t}function FG(n,e){return n instanceof Gd?(function(i){return ew(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class Bd extends sy{}class Cu extends sy{constructor(e){super(),this.elements=e}}function vD(n,e){const t=xD(e);for(const i of n.elements)t.some((r=>os(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Ru extends sy{constructor(e){super(),this.elements=e}}function wD(n,e){let t=xD(e);for(const i of n.elements)t=t.filter((r=>!os(r,i)));return{arrayValue:{values:t}}}class Gd extends sy{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function SR(n){return Kt(n.integerValue||n.doubleValue)}function xD(n){return zd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class VG{constructor(e,t){this.field=e,this.transform=t}}function jG(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Cu&&r instanceof Cu||i instanceof Ru&&r instanceof Ru?pu(i.elements,r.elements,os):i instanceof Gd&&r instanceof Gd?os(i.Ae,r.Ae):i instanceof Bd&&r instanceof Bd})(n.transform,e.transform)}class UG{constructor(e,t){this.version=e,this.transformResults=t}}class _r{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new _r}static exists(e){return new _r(void 0,e)}static updateTime(e){return new _r(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function gp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class oy{}function ED(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new uE(n.key,_r.none()):new mf(n.key,n.data,_r.none());{const t=n.data,i=pr.empty();let r=new mt(zt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Lu(n.key,i,new Vs(r.toArray()),_r.none())}}function zG(n,e,t){n instanceof mf?(function(r,s,o){const l=r.value.clone(),u=RR(r.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Lu?(function(r,s,o){if(!gp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=RR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(TD(r)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function ud(n,e,t,i){return n instanceof mf?(function(s,o,l,u){if(!gp(s.precondition,o))return l;const h=s.value.clone(),f=AR(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Lu?(function(s,o,l,u){if(!gp(s.precondition,o))return l;const h=AR(s.fieldTransforms,u,o),f=o.data;return f.setAll(TD(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((p=>p.field)))})(n,e,t,i):(function(s,o,l){return gp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function CR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&pu(i,r,((s,o)=>jG(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class mf extends oy{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Lu extends oy{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function TD(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function RR(n,e,t){const i=new Map;De(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,OG(o,l,t[r]))}return i}function AR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,LG(s,o,e))}return i}class uE extends oy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ID extends oy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class hE{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&zG(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=ud(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=ud(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=_D();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const u=ED(o,l);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Ze.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),In())}isEqual(e){return this.batchId===e.batchId&&pu(this.mutations,e.mutations,((t,i)=>CR(t,i)))&&pu(this.baseMutations,e.baseMutations,((t,i)=>CR(t,i)))}}class dE{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){De(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return PG})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new dE(e,t,i,r)}}class fE{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var $t,Ye;function BG(n){switch(n){case ae.OK:return Re(64938);case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return Re(15467,{code:n})}}function GG(n){if(n===void 0)return xi("GRPC error has no .code"),ae.UNKNOWN;switch(n){case $t.OK:return ae.OK;case $t.CANCELLED:return ae.CANCELLED;case $t.UNKNOWN:return ae.UNKNOWN;case $t.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case $t.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case $t.INTERNAL:return ae.INTERNAL;case $t.UNAVAILABLE:return ae.UNAVAILABLE;case $t.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case $t.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case $t.NOT_FOUND:return ae.NOT_FOUND;case $t.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case $t.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case $t.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case $t.ABORTED:return ae.ABORTED;case $t.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case $t.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case $t.DATA_LOSS:return ae.DATA_LOSS;default:return Re(39323,{code:n})}}(Ye=$t||($t={}))[Ye.OK=0]="OK",Ye[Ye.CANCELLED=1]="CANCELLED",Ye[Ye.UNKNOWN=2]="UNKNOWN",Ye[Ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ye[Ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ye[Ye.NOT_FOUND=5]="NOT_FOUND",Ye[Ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ye[Ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ye[Ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ye[Ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ye[Ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ye[Ye.ABORTED=10]="ABORTED",Ye[Ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ye[Ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ye[Ye.INTERNAL=13]="INTERNAL",Ye[Ye.UNAVAILABLE=14]="UNAVAILABLE",Ye[Ye.DATA_LOSS=15]="DATA_LOSS";new Qx([4294967295,4294967295],0);const WG={asc:"ASCENDING",desc:"DESCENDING"},$G={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},KG={and:"AND",or:"OR"};class HG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function XG(n,e){return n.useProto3Json||Qm(e)?e:{value:e}}function sw(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qG(n,e){return sw(n,e.toTimestamp())}function Er(n){return De(!!n,49232),Ze.fromTimestamp((function(t){const i=ia(t);return new bt(i.seconds,i.nanos)})(n))}function SD(n,e){return ow(n,e).canonicalString()}function ow(n,e){const t=(function(r){return new Ct(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function CD(n){const e=Ct.fromString(n);return De(sW(e),10190,{key:e.toString()}),e}function lm(n,e){return SD(n.databaseId,e.path)}function pp(n,e){const t=CD(e);if(t.get(1)!==n.databaseId.projectId)throw new xe(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new xe(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ve(PD(t))}function RD(n,e){return SD(n.databaseId,e)}function AD(n){const e=CD(n);return e.length===4?Ct.emptyPath():PD(e)}function YG(n){return new Ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function PD(n){return De(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function PR(n,e,t){return{name:lm(n,e),fields:t.value.mapValue.fields}}function ZG(n,e,t){const i=pp(n,e.name),r=Er(e.updateTime),s=e.createTime?Er(e.createTime):Ze.min(),o=new pr({mapValue:{fields:e.fields}}),l=Tn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function cm(n,e){let t;if(e instanceof mf)t={update:PR(n,e.key,e.value)};else if(e instanceof uE)t={delete:lm(n,e.key)};else if(e instanceof Lu)t={update:PR(n,e.key,e.data),updateMask:rW(e.fieldMask)};else{if(!(e instanceof ID))return Re(16599,{Vt:e.type});t={verify:lm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof Bd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Cu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ru)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Gd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Re(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:qG(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Re(27497)})(n,e.precondition)),t}function aw(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?_r.updateTime(Er(s.updateTime)):s.exists!==void 0?_r.exists(s.exists):_r.none()})(e.currentDocument):_r.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let u=null;if("setToServerValue"in l)De(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new Bd;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new Cu(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Ru(f)}else"increment"in l?u=new Gd(o,l.increment):Re(16584,{proto:l});const h=zt.fromServerFormat(l.fieldPath);return new VG(h,u)})(n,r))):[];if(e.update){e.update.name;const r=pp(n,e.update.name),s=new pr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new Vs(h.map((f=>zt.fromServerFormat(f))))})(e.updateMask);return new Lu(r,s,o,t,i)}return new mf(r,s,t,i)}if(e.delete){const r=pp(n,e.delete);return new uE(r,t)}if(e.verify){const r=pp(n,e.verify);return new ID(r,t)}return Re(1463,{proto:e})}function QG(n,e){return n&&n.length>0?(De(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Er(r.updateTime):Er(s);return o.isEqual(Ze.min())&&(o=Er(s)),new UG(o,r.transformResults||[])})(t,e)))):[]}function JG(n,e){return{documents:[RD(n,e.path)]}}function eW(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=RD(n,r);const s=(function(h){if(h.length!==0)return DD(gt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(y){return{field:Oc(y.field),direction:tW(y.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=XG(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function bD(n){let e=AD(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){De(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(p){const y=kD(p);return y instanceof gt&&cE(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((y=>(function(I){return new om(Fc(I.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(I.direction))})(y)))})(t.orderBy));let l=null;t.limit&&(l=(function(p){let y;return y=typeof p=="object"?p.value:p,Qm(y)?null:y})(t.limit));let u=null;t.startAt&&(u=(function(p){const y=!!p.before,x=p.values||[];return new Iu(x,y)})(t.startAt));let h=null;return t.endAt&&(h=(function(p){const y=!p.before,x=p.values||[];return new Iu(x,y)})(t.endAt)),EG(e,r,o,s,l,"F",u,h)}function kD(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Fc(t.unaryFilter.field);return qe.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Fc(t.unaryFilter.field);return qe.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Fc(t.unaryFilter.field);return qe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fc(t.unaryFilter.field);return qe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Re(61313);default:return Re(60726)}})(n):n.fieldFilter!==void 0?(function(t){return qe.create(Fc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Re(58110);default:return Re(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return gt.create(t.compositeFilter.filters.map((i=>kD(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Re(1026)}})(t.compositeFilter.op))})(n):Re(30097,{filter:n})}function tW(n){return WG[n]}function nW(n){return $G[n]}function iW(n){return KG[n]}function Oc(n){return{fieldPath:n.canonicalString()}}function Fc(n){return zt.fromServerFormat(n.fieldPath)}function DD(n){return n instanceof qe?(function(t){if(t.op==="=="){if(yR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NAN"}};if(mR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(yR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NOT_NAN"}};if(mR(t.value))return{unaryFilter:{field:Oc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oc(t.field),op:nW(t.op),value:t.value}}})(n):n instanceof gt?(function(t){const i=t.getFilters().map((r=>DD(r)));return i.length===1?i[0]:{compositeFilter:{op:iW(t.op),filters:i}}})(n):Re(54877,{filter:n})}function rW(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function sW(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Kc{constructor(e,t,i,r,s=Ze.min(),o=Ze.min(),l=ci.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Kc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Kc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class MD{constructor(e){this.yt=e}}function oW(n,e){let t;if(e.document)t=ZG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=ve.fromSegments(e.noDocument.path),r=Cl(e.noDocument.readTime);t=Tn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Re(56709);{const i=ve.fromSegments(e.unknownDocument.path),r=Cl(e.unknownDocument.version);t=Tn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new bt(r[0],r[1]);return Ze.fromTimestamp(s)})(e.readTime)),t}function bR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:um(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:lm(s,o.key),fields:o.data.value.mapValue.fields,updateTime:sw(s,o.version.toTimestamp()),createTime:sw(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Sl(e.version)};else{if(!e.isUnknownDocument())return Re(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Sl(e.version)}}return i}function um(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Sl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Cl(n){const e=new bt(n.seconds,n.nanoseconds);return Ze.fromTimestamp(e)}function Ha(n,e){const t=(e.baseMutations||[]).map((s=>aw(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>aw(n.yt,s))),r=bt.fromMillis(e.localWriteTimeMs);return new hE(e.batchId,r,t,i)}function Xh(n){const e=Cl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Cl(n.lastLimboFreeSnapshotVersion):Ze.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return De(o===1,1966,{count:o}),Ws(gD(AD(s.documents[0])))})(n.query):(function(s){return Ws(bD(s))})(n.query),new Kc(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ci.fromBase64String(n.resumeToken))}function ND(n,e){const t=Sl(e.snapshotVersion),i=Sl(e.lastLimboFreeSnapshotVersion);let r;r=xG(e.target)?JG(n.yt,e.target):eW(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Il(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function LD(n){const e=bD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?rw(e,e.limit,"L"):e}function G0(n,e){return new fE(e.largestBatchId,aw(n.yt,e.overlayMutation))}function kR(n,e){const t=e.path.lastSegment();return[n,Gn(e.path.popLast()),t]}function DR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Sl(i.readTime),documentKey:Gn(i.documentKey.path),largestBatchId:i.largestBatchId}}class aW{getBundleMetadata(e,t){return MR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Cl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return MR(e).put((function(r){return{bundleId:r.id,createTime:Sl(Er(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return NR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:LD(s.bundledQuery),readTime:Cl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return NR(e).put((function(r){return{name:r.name,readTime:Sl(Er(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function MR(n){return en(n,Jm)}function NR(n){return en(n,ey)}class ay{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new ay(e,i)}getOverlay(e,t){return Dh(e).get(kR(this.userId,t)).next((i=>i?G0(this.serializer,i):null))}getOverlays(e,t){const i=Jr();return Y.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new fE(t,o);r.push(this.St(e,l))})),Y.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Gn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Dh(e).Z(Zv,l))})),Y.waitFor(s)}getOverlaysForCollection(e,t,i){const r=Jr(),s=Gn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Dh(e).J(Zv,o).next((l=>{for(const u of l){const h=G0(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=Jr();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Dh(e).ee({index:Kk,range:l},((u,h,f)=>{const p=G0(this.serializer,h);s.size()<r||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Dh(e).put((function(r,s,o){const[l,u,h]=kR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:cm(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Dh(n){return en(n,ty)}class lW{bt(e){return en(e,rE)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?ci.fromUint8Array(i):ci.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Xa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Kt(e.integerValue));else if("doubleValue"in e){const i=Kt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Jp(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ia(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(wu(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?sD(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):ny(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Re(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=sm,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Kt(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),ve.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Xa.Kt=new Xa;const Rc=255;function cW(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function LR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=cW(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class uW{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=LR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=LR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Rc),this.sn(255)}_n(){this.an(Rc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Rc?(this.sn(Rc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Rc?(this.an(Rc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class hW{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class dW{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Mh{constructor(){this.cn=new uW,this.ln=new hW(this.cn),this.hn=new dW(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class qa{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new qa(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:mp(this.En),directionalValue:mp(this.dn),orderedDocumentKey:mp(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Do(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=OR(n.En,e.En),t!==0?t:(t=OR(n.dn,e.dn),t!==0?t:ve.comparator(n.In,e.In)))}function OR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function mp(n){return W2()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function FR(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class VR{constructor(e){this.mn=new mt(((t,i)=>zt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(De(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Xv(e);if(t!==void 0&&!this.wn(t))return!1;const i=Ga(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=i[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new mt(zt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new up(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new up(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new up(i.field,i.dir==="asc"?0:1)));return new Qp(Qp.UNKNOWN_ID,this.collectionId,t,Od.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function OD(n){if(De(n instanceof qe||n instanceof gt,20012),n instanceof qe){if(n instanceof fD){const t=n.value.arrayValue?.values?.map((i=>qe.create(n.field,"==",i)))||[];return gt.create(t,"or")}return n}const e=n.filters.map((t=>OD(t)));return gt.create(e,n.op)}function fW(n){if(n.getFilters().length===0)return[];const e=uw(OD(n));return De(FD(e),7391),lw(e)||cw(e)?[e]:e.getFilters()}function lw(n){return n instanceof qe}function cw(n){return n instanceof gt&&cE(n)}function FD(n){return lw(n)||cw(n)||(function(t){if(t instanceof gt&&tw(t)){for(const i of t.getFilters())if(!lw(i)&&!cw(i))return!1;return!0}return!1})(n)}function uw(n){if(De(n instanceof qe||n instanceof gt,34018),n instanceof qe)return n;if(n.filters.length===1)return uw(n.filters[0]);const e=n.filters.map((i=>uw(i)));let t=gt.create(e,n.op);return t=hm(t),FD(t)?t:(De(t instanceof gt,64498),De(Su(t),40251),De(t.filters.length>1,57927),t.filters.reduce(((i,r)=>gE(i,r))))}function gE(n,e){let t;return De(n instanceof qe||n instanceof gt,38388),De(e instanceof qe||e instanceof gt,25473),t=n instanceof qe?e instanceof qe?(function(r,s){return gt.create([r,s],"and")})(n,e):jR(n,e):e instanceof qe?jR(e,n):(function(r,s){if(De(r.filters.length>0&&s.filters.length>0,48005),Su(r)&&Su(s))return uD(r,s.getFilters());const o=tw(r)?r:s,l=tw(r)?s:r,u=o.filters.map((h=>gE(h,l)));return gt.create(u,"or")})(n,e),hm(t)}function jR(n,e){if(Su(e))return uD(e,n.getFilters());{const t=e.filters.map((i=>gE(n,i)));return gt.create(t,"or")}}function hm(n){if(De(n instanceof qe||n instanceof gt,11850),n instanceof qe)return n;const e=n.getFilters();if(e.length===1)return hm(e[0]);if(lD(n))return n;const t=e.map((r=>hm(r))),i=[];return t.forEach((r=>{r instanceof qe?i.push(r):r instanceof gt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:gt.create(i,n.op)}class gW{constructor(){this.Cn=new pE}addToCollectionParentIndex(e,t){return this.Cn.add(t),Y.resolve()}getCollectionParents(e,t){return Y.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Y.resolve()}deleteFieldIndex(e,t){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,t){return Y.resolve()}getDocumentsMatchingTarget(e,t){return Y.resolve(null)}getIndexType(e,t){return Y.resolve(0)}getFieldIndexes(e,t){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,t){return Y.resolve(Ci.min())}getMinOffsetFromCollectionGroup(e,t){return Y.resolve(Ci.min())}updateCollectionGroup(e,t,i){return Y.resolve()}updateIndexEntries(e,t){return Y.resolve()}}class pE{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new mt(Ct.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new mt(Ct.comparator)).toArray()}}const UR="IndexedDbIndexManager",Hg=new Uint8Array(0);class pW{constructor(e,t){this.databaseId=t,this.vn=new pE,this.Fn=new la((i=>Il(i)),((i,r)=>pf(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Gn(r)};return zR(e).put(s)}return Y.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[Lk(t),""],!1,!0);return zR(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Qr(o.parent))}return i}))}addFieldIndex(e,t){const i=Nh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=Pc(e);return s.next((l=>{o.put(DR(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Nh(e),r=Pc(e),s=Ac(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Nh(e),i=Ac(e),r=Pc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Y.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new VR(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Ac(e);let r=!0;const s=new Map;return Y.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=In();const l=[];return Y.forEach(s,((u,h)=>{fe(UR,`Using index ${(function(k){return`id=${k.indexId}|cg=${k.collectionGroup}|f=${k.fields.map((O=>`${O.fieldPath}:${O.kind}`)).join(",")}`})(u)} to execute ${Il(t)}`);const f=(function(k,O){const F=Xv(O);if(F===void 0)return null;for(const G of am(k,F.fieldPath))switch(G.op){case"array-contains-any":return G.value.arrayValue.values||[];case"array-contains":return[G.value]}return null})(h,u),p=(function(k,O){const F=new Map;for(const G of Ga(O))for(const b of am(k,G.fieldPath))switch(b.op){case"==":case"in":F.set(G.fieldPath.canonicalString(),b.value);break;case"not-in":case"!=":return F.set(G.fieldPath.canonicalString(),b.value),Array.from(F.values())}return null})(h,u),y=(function(k,O){const F=[];let G=!0;for(const b of Ga(O)){const R=b.kind===0?ER(k,b.fieldPath,k.startAt):TR(k,b.fieldPath,k.startAt);F.push(R.value),G&&(G=R.inclusive)}return new Iu(F,G)})(h,u),x=(function(k,O){const F=[];let G=!0;for(const b of Ga(O)){const R=b.kind===0?TR(k,b.fieldPath,k.endAt):ER(k,b.fieldPath,k.endAt);F.push(R.value),G&&(G=R.inclusive)}return new Iu(F,G)})(h,u),I=this.On(u,h,y),S=this.On(u,h,x),T=this.Nn(u,h,p),P=this.Bn(u.indexId,f,I,y.inclusive,S,x.inclusive,T);return Y.forEach(P,(M=>i.Y(M,t.limit).next((k=>{k.forEach((O=>{const F=ve.fromSegments(O.documentKey);o.has(F)||(o=o.add(F),l.push(F))}))}))))})).next((()=>l))}return Y.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=fW(gt.create(e.filters,"and")).map((i=>iw(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let p=0;p<u;++p){const y=t?this.Ln(t[p/h]):Hg,x=this.kn(e,y,i[p%h],r),I=this.qn(e,y,s[p%h],o),S=l.map((T=>this.kn(e,y,T,!0)));f.push(...this.createRange(x,I,S))}return f}kn(e,t,i,r){const s=new qa(e,ve.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new qa(e,ve.empty(),t,i);return r?s.An():s}xn(e,t){const i=new VR(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Y.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new mt(zt.comparator),f=!1;for(const p of u.filters)for(const y of p.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?f=!0:h=h.add(y.field));for(const p of u.orderBy)p.field.isKeyField()||(h=h.add(p.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Mh;for(const r of Ga(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);Xa.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Mh;return Xa.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Mh;return Xa.Kt.Dt(lE(this.databaseId,t),i.Pn((function(s){const o=Ga(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Mh);let s=0;for(const o of Ga(e)){const l=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&zd(l))r=this.Kn(r,o,l);else{const h=u.Pn(o.kind);Xa.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const u=new Mh;u.seed(l.un()),Xa.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof qe&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Nh(e),r=Pc(e);return(t?i.J(Yv,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Y.forEach(s,(l=>r.get([l.indexId,this.uid]).next((u=>{o.push((function(f,p){const y=p?new Od(p.sequenceNumber,new Ci(Cl(p.readTime),new ve(Qr(p.documentKey)),p.largestBatchId)):Od.empty(),x=f.fields.map((([I,S])=>new up(zt.fromServerFormat(I),S)));return new Qp(f.indexId,f.collectionGroup,x,y)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:$e(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Nh(e),s=Pc(e);return this.Gn(e).next((o=>r.J(Yv,IDBKeyRange.bound(t,t)).next((l=>Y.forEach(l,(u=>s.put(DR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Y.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Y.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),Y.forEach(l,(u=>this.zn(e,r,u).next((h=>{const f=this.jn(s,u);return h.isEqual(f)?Y.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,i,r){return Ac(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Ac(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Ac(e);let s=new mt(Do);return r.ee({index:$k,range:IDBKeyRange.only([i.indexId,this.uid,mp(this.$n(i,t))])},((o,l)=>{s=s.add(new qa(i.indexId,t,FR(l.arrayValue),FR(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new mt(Do);const r=this.Qn(t,e);if(r==null)return i;const s=Xv(t);if(s!=null){const o=e.data.field(s.fieldPath);if(zd(o))for(const l of o.arrayValue.values||[])i=i.add(new qa(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new qa(t.indexId,e.key,Hg,r));return i}Jn(e,t,i,r,s){fe(UR,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,f,p,y){const x=u.getIterator(),I=h.getIterator();let S=Cc(x),T=Cc(I);for(;S||T;){let P=!1,M=!1;if(S&&T){const k=f(S,T);k<0?M=!0:k>0&&(P=!0)}else S!=null?M=!0:P=!0;P?(p(T),T=Cc(I)):M?(y(S),S=Cc(x)):(S=Cc(x),T=Cc(I))}})(r,s,Do,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),Y.waitFor(o)}Gn(e){let t=1;return Pc(e).ee({index:Wk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>Do(o,l))).filter(((o,l,u)=>!l||Do(o,u[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=Do(o,e),u=Do(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,Hg,ve.empty()),u=r[o+1].Vn(this.uid,Hg,ve.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return Do(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(BR)}getMinOffset(e,t){return Y.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Re(44426))))).next(BR)}}function zR(n){return en(n,jd)}function Ac(n){return en(n,od)}function Nh(n){return en(n,iE)}function Pc(n){return en(n,sd)}function BR(n){De(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;eE(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ci(e.readTime,e.documentKey,t)}const GR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},VD=41943040;class Jn{static withCacheSize(e){return new Jn(e,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function jD(n,e,t){const i=n.store(hr),r=n.store(mu),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.ee({range:o},((f,p,y)=>(l++,y.delete())));s.push(u.next((()=>{De(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const p=zk(e,f.key.path,t.batchId);s.push(r.delete(p)),h.push(f.key)}return Y.waitFor(s).next((()=>h))}function dm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Re(14731);e=n.noDocument}return JSON.stringify(e).length}Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn(VD,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);class ly{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){De(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new ly(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Mo(e).ee({index:nl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Vc(e),o=Mo(e);return o.add({}).next((l=>{De(typeof l=="number",49019);const u=new hE(l,t,i,r),h=(function(x,I,S){const T=S.baseMutations.map((M=>cm(x.yt,M))),P=S.mutations.map((M=>cm(x.yt,M)));return{userId:I,batchId:S.batchId,localWriteTimeMs:S.localWriteTime.toMillis(),baseMutations:T,mutations:P}})(this.serializer,this.userId,u),f=[];let p=new mt(((y,x)=>$e(y.canonicalString(),x.canonicalString())));for(const y of r){const x=zk(this.userId,y.key.path,l);p=p.add(y.key.path.popLast()),f.push(o.put(h)),f.push(s.put(x,F8))}return p.forEach((y=>{f.push(this.indexManager.addToCollectionParentIndex(e,y))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),Y.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return Mo(e).get(t).next((i=>i?(De(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Ha(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Y.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Mo(e).ee({index:nl,range:r},((o,l,u)=>{l.userId===this.userId&&(De(l.batchId>=i,47524,{tr:i}),s=Ha(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=cl;return Mo(e).ee({index:nl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,cl],[this.userId,Number.POSITIVE_INFINITY]);return Mo(e).J(nl,t).next((i=>i.map((r=>Ha(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=hp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Vc(e).ee({range:r},((o,l,u)=>{const[h,f,p]=o,y=Qr(f);if(h===this.userId&&t.path.isEqual(y))return Mo(e).get(p).next((x=>{if(!x)throw Re(61480,{nr:o,batchId:p});De(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:p}),s.push(Ha(this.serializer,x))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt($e);const r=[];return t.forEach((s=>{const o=hp(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=Vc(e).ee({range:l},((h,f,p)=>{const[y,x,I]=h,S=Qr(x);y===this.userId&&s.path.isEqual(S)?i=i.add(I):p.done()}));r.push(u)})),Y.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=hp(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new mt($e);return Vc(e).ee({range:o},((u,h,f)=>{const[p,y,x]=u,I=Qr(y);p===this.userId&&i.isPrefixOf(I)?I.length===r&&(l=l.add(x)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(Mo(e).get(s).next((o=>{if(o===null)throw Re(35274,{batchId:s});De(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Ha(this.serializer,o))})))})),Y.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return jD(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Y.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Y.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Vc(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const u=Qr(s[1]);r.push(u)}else l.done()})).next((()=>{De(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return UD(e,this.userId,t)}_r(e){return zD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:cl,lastStreamToken:""}))}}function UD(n,e,t){const i=hp(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Vc(n).ee({range:s,X:!0},((l,u,h)=>{const[f,p,y]=l;f===e&&p===r&&(o=!0),h.done()})).next((()=>o))}function Mo(n){return en(n,hr)}function Vc(n){return en(n,mu)}function zD(n){return en(n,Fd)}class Rl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Rl(0)}static cr(){return new Rl(-1)}}class mW{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Rl(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ze.fromTimestamp(new bt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>bc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(De(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return bc(e).ee(((o,l)=>{const u=Xh(l);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>Y.waitFor(s))).next((()=>r))}forEachTarget(e,t){return bc(e).ee(((i,r)=>{const s=Xh(r);t(s)}))}lr(e){return WR(e).get(nm).next((t=>(De(t!==null,2888),t)))}hr(e,t){return WR(e).put(nm,t)}Pr(e,t){return bc(e).put(ND(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Il(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return bc(e).ee({range:r,index:Gk},((o,l,u)=>{const h=Xh(l);pf(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Bo(e);return t.forEach((o=>{const l=Gn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),Y.waitFor(r)}removeMatchingKeys(e,t,i){const r=Bo(e);return Y.forEach(t,(s=>{const o=Gn(s.path);return Y.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Bo(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Bo(e);let s=In();return r.ee({range:i,X:!0},((o,l,u)=>{const h=Qr(o[1]),f=new ve(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Gn(t.path),r=IDBKeyRange.bound([i],[Lk(i)],!1,!0);let s=0;return Bo(e).ee({index:nE,X:!0,range:r},(([o,l],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return bc(e).get(t).next((i=>i?Xh(i):null))}}function bc(n){return en(n,yu)}function WR(n){return en(n,ul)}function Bo(n){return en(n,_u)}const $R="LruGarbageCollector",yW=1048576;function KR([n,e],[t,i]){const r=$e(n,t);return r===0?$e(e,i):r}class _W{constructor(e){this.Ir=e,this.buffer=new mt(KR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();KR(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class vW{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){fe($R,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ll(t)?fe($R,"Ignoring IndexedDB error during garbage collection: ",t):await Ym(t)}await this.Vr(3e5)}))}}class wW{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Y.resolve(yr.ce);const i=new _W(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),Y.resolve(GR)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),GR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),r=this.params.maximumSequenceNumbersToCollect):r=p,o=Date.now(),this.nthSequenceNumber(e,r)))).next((p=>(i=p,l=Date.now(),this.removeTargets(e,i,t)))).next((p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((p=>(h=Date.now(),Lc()<=Ke.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Y.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:p}))))}}function xW(n,e){return new wW(n,e)}class EW{constructor(e,t){this.db=e,this.garbageCollector=xW(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return Xg(e,i)}removeReference(e,t,i){return Xg(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Xg(e,t)}br(e,t){return(function(r,s){let o=!1;return zD(r).te((l=>UD(r,l,s).next((u=>(u&&(o=!0),Y.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Ze.min()),Bo(e).delete((function(p){return[0,Gn(p.path)]})(o)))))}));r.push(u)}})).next((()=>Y.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Xg(e,t)}Sr(e,t){const i=Bo(e);let r,s=yr.ce;return i.ee({index:nE},(([o,l],{path:u,sequenceNumber:h})=>{o===0?(s!==yr.ce&&t(new ve(Qr(r)),s),s=h,r=u):s=yr.ce})).next((()=>{s!==yr.ce&&t(new ve(Qr(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Xg(n,e){return Bo(n).put((function(i,r){return{targetId:0,path:Gn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class BD{constructor(){this.changes=new la((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Y.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class TW{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Fa(e).put(i)}removeEntry(e,t,i){return Fa(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],um(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Tn.newInvalidDocument(t);return Fa(e).ee({index:dp,range:IDBKeyRange.only(Lh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Tn.newInvalidDocument(t)};return Fa(e).ee({index:dp,range:IDBKeyRange.only(Lh(t))},((r,s)=>{i={document:this.Cr(t,s),size:dm(s)}})).next((()=>i))}getEntries(e,t){let i=il();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=il(),r=new li(ve.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,dm(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Y.resolve();let r=new mt(qR);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Lh(r.first()),Lh(r.last())),o=r.getIterator();let l=o.getNext();return Fa(e).ee({index:dp,range:s},((u,h,f)=>{const p=ve.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&qR(l,p)<0;)i(l,null),l=o.getNext();l&&l.isEqual(p)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Lh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),um(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fa(e).J(IDBKeyRange.bound(l,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=il();for(const p of h){const y=this.Cr(ve.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);y.isFoundDocument()&&(ry(t,y)||r.has(y.key))&&(f=f.insert(y.key,y))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=il();const o=XR(t,i),l=XR(t,Ci.max());return Fa(e).ee({index:Bk,range:IDBKeyRange.bound(o,l,!0)},((u,h,f)=>{const p=this.Cr(ve.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(p.key,p),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new IW(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return HR(e).get(qv).next((t=>(De(!!t,20021),t)))}Dr(e,t){return HR(e).put(qv,t)}Cr(e,t){if(t){const i=oW(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Ze.min())))return i}return Tn.newInvalidDocument(e)}}function GD(n){return new TW(n)}class IW extends BD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new la((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new mt(((s,o)=>$e(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=bR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=dm(u);i+=h-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=l.size,this.trackRemovals){const u=bR(this.Nr.serializer,o.convertToNoDocument(Ze.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Y.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function HR(n){return en(n,Vd)}function Fa(n){return en(n,tm)}function Lh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function XR(n,e){const t=e.documentKey.path.toArray();return[n,um(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function qR(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=$e(t[s],i[s]),r)return r;return r=$e(t.length,i.length),r||(r=$e(t[t.length-2],i[i.length-2]),r||$e(t[t.length-1],i[i.length-1]))}class SW{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class WD{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&ud(i.mutation,r,Vs.empty(),bt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,In()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=In()){const r=Jr();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=Kg();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=Jr();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,In())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=il();const o=cd(),l=(function(){return cd()})();return t.forEach(((u,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Lu)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),ud(f.mutation,h,f.mutation.getFieldMask(),bt.now())):o.set(h.key,Vs.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new SW(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=cd();let r=new li(((o,l)=>o-l)),s=In();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=i.get(u)||Vs.empty();f=l.applyToLocalView(h,f),i.set(u,f);const p=(r.get(l.batchId)||In()).add(u);r=r.insert(l.batchId,p)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,p=_D();f.forEach((y=>{if(!s.has(y)){const x=ED(t.get(y),i.get(y));x!==null&&p.set(y,x),s=s.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return Y.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return ve.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):TG(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Y.resolve(Jr());let l=Ld,u=s;return o.next((h=>Y.forEach(h,((f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(f)?Y.resolve():this.remoteDocumentCache.getEntry(e,f).next((y=>{u=u.insert(f,y)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,In()))).next((f=>({batchId:l,changes:AG(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ve(t)).next((i=>{let r=Kg();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Kg();return this.indexManager.getCollectionParents(e,s).next((l=>Y.forEach(l,(u=>{const h=(function(p,y){return new iy(y,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((p,y)=>{o=o.insert(p,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Tn.newInvalidDocument(f)))}));let l=Kg();return o.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&ud(f.mutation,h,Vs.empty(),bt.now()),ry(t,h)&&(l=l.insert(u,h))})),l}))}}class CW{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Y.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Er(r.createTime)}})(t)),Y.resolve()}getNamedQuery(e,t){return Y.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:LD(r.bundledQuery),readTime:Er(r.readTime)}})(t)),Y.resolve()}}class RW{constructor(){this.overlays=new li(ve.comparator),this.qr=new Map}getOverlay(e,t){return Y.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Jr();return Y.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Y.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Y.resolve()}getOverlaysForCollection(e,t,i){const r=Jr(),s=t.length+1,o=new ve(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return Y.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new li(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=Jr(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=Jr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return Y.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new fE(t,i));let s=this.qr.get(t);s===void 0&&(s=In(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class AW{constructor(){this.sessionToken=ci.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Y.resolve()}}class mE{constructor(){this.Qr=new mt(cn.$r),this.Ur=new mt(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new cn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new cn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new ve(new Ct([])),i=new cn(t,e),r=new cn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ve(new Ct([])),i=new cn(t,e),r=new cn(t,e+1);let s=In();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new cn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class cn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ve.comparator(e.key,t.key)||$e(e.Yr,t.Yr)}static Kr(e,t){return $e(e.Yr,t.Yr)||ve.comparator(e.key,t.key)}}class PW{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new mt(cn.$r)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new hE(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new cn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Y.resolve(o)}lookupMutationBatch(e,t){return Y.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?cl:this.tr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new cn(t,0),r=new cn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),Y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt($e);return t.forEach((r=>{const s=new cn(r,0),o=new cn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),Y.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;ve.isDocumentKey(s)||(s=s.child(""));const o=new cn(new ve(s),0);let l=new mt($e);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(u.Yr)),!0)}),o),Y.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){De(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Y.forEach(t.mutations,(r=>{const s=new cn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new cn(t,0),r=this.Zr.firstAfterOrEqual(i);return Y.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class bW{constructor(e){this.ri=e,this.docs=(function(){return new li(ve.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Y.resolve(i?i.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let i=il();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Tn.newInvalidDocument(r))})),Y.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=il();const o=t.path,l=new ve(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||eE(Fk(f),i)<=0||(r.has(f.key)||ry(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Y.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Re(9500)}ii(e,t){return Y.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new kW(this)}getSize(e){return Y.resolve(this.size)}}class kW extends BD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Y.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class DW{constructor(e){this.persistence=e,this.si=new la((t=>Il(t)),pf),this.lastRemoteSnapshotVersion=Ze.min(),this.highestTargetId=0,this.oi=0,this._i=new mE,this.targetCount=0,this.ai=Rl.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Y.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Rl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Y.resolve()}updateTargetData(e,t){return this.Pr(t),Y.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),Y.waitFor(s).next((()=>r))}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Y.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Y.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Y.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Y.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Y.resolve(i)}containsKey(e,t){return Y.resolve(this._i.containsKey(t))}}class $D{constructor(e,t){this.ui={},this.overlays={},this.ci=new yr(0),this.li=!1,this.li=!0,this.hi=new AW,this.referenceDelegate=e(this),this.Pi=new DW(this),this.indexManager=new gW,this.remoteDocumentCache=(function(r){return new bW(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new MD(t),this.Ii=new CW(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new RW,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new PW(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe("MemoryPersistence","Starting transaction:",e);const r=new MW(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Y.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class MW extends jk{constructor(e){super(),this.currentSequenceNumber=e}}class cy{constructor(e){this.persistence=e,this.Ri=new mE,this.Vi=null}static mi(e){return new cy(e)}get fi(){if(this.Vi)return this.Vi;throw Re(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Y.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Y.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Y.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.fi,(i=>{const r=ve.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Ze.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Y.or([()=>Y.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class NW{constructor(e){this.serializer=e}k(e,t,i,r){const s=new Zm("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(gf)})(e),(function(u){u.createObjectStore(Fd,{keyPath:O8}),u.createObjectStore(hr,{keyPath:uR,autoIncrement:!0}).createIndex(nl,hR,{unique:!0}),u.createObjectStore(mu)})(e),YR(e),(function(u){u.createObjectStore(Wa)})(e));let o=Y.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(_u),u.deleteObjectStore(yu),u.deleteObjectStore(ul)})(e),YR(e)),o=o.next((()=>(function(u){const h=u.store(ul),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ze.min().toTimestamp(),targetCount:0};return h.put(nm,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(hr).J().next((p=>{u.deleteObjectStore(hr),u.createObjectStore(hr,{keyPath:uR,autoIncrement:!0}).createIndex(nl,hR,{unique:!0});const y=h.store(hr),x=p.map((I=>y.put(I)));return Y.waitFor(x)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(vu,{keyPath:$8})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Vd)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(Jm,{keyPath:K8})})(e),(function(u){u.createObjectStore(ey,{keyPath:H8})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(ty,{keyPath:eG});h.createIndex(Zv,tG,{unique:!1}),h.createIndex(Kk,nG,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(tm,{keyPath:V8});h.createIndex(dp,j8),h.createIndex(Bk,U8)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Wa)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(iE,{keyPath:X8,autoIncrement:!0}).createIndex(Yv,q8,{unique:!1}),u.createObjectStore(sd,{keyPath:Y8}).createIndex(Wk,Z8,{unique:!1}),u.createObjectStore(od,{keyPath:Q8}).createIndex($k,J8,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(sd).clear()})).next((()=>{t.objectStore(od).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(rE,{keyPath:iG})})(e)}))),i<18&&r>=18&&W2()&&(o=o.next((()=>{t.objectStore(sd).clear()})).next((()=>{t.objectStore(od).clear()}))),o}wi(e){let t=0;return e.store(Wa).ee(((i,r)=>{t+=dm(r)})).next((()=>{const i={byteSize:t};return e.store(Vd).put(qv,i)}))}yi(e){const t=e.store(Fd),i=e.store(hr);return t.J().next((r=>Y.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,cl],[s.userId,s.lastAcknowledgedBatchId]);return i.J(nl,o).next((l=>Y.forEach(l,(u=>{De(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=Ha(this.serializer,u);return jD(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(_u),i=e.store(Wa);return e.store(ul).get(nm).next((r=>{const s=[];return i.ee(((o,l)=>{const u=new Ct(o),h=(function(p){return[0,Gn(p)]})(u);s.push(t.get(h).next((f=>f?Y.resolve():(p=>t.put({targetId:0,path:Gn(p),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>Y.waitFor(s)))}))}bi(e,t){e.createObjectStore(jd,{keyPath:W8});const i=t.store(jd),r=new pE,s=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:Gn(u)})}};return t.store(Wa).ee({X:!0},((o,l)=>{const u=new Ct(o);return s(u.popLast())})).next((()=>t.store(mu).ee({X:!0},(([o,l,u],h)=>{const f=Qr(l);return s(f.popLast())}))))}Di(e){const t=e.store(yu);return t.ee(((i,r)=>{const s=Xh(r),o=ND(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(Wa),r=[];return i.ee(((s,o)=>{const l=t.store(tm),u=(function(p){return p.document?new ve(Ct.fromString(p.document.name).popFirst(5)):p.noDocument?ve.fromSegments(p.noDocument.path):p.unknownDocument?ve.fromSegments(p.unknownDocument.path):Re(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>Y.waitFor(r)))}Fi(e,t){const i=t.store(hr),r=GD(this.serializer),s=new $D(cy.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((u=>{let h=l.get(u.userId)??In();Ha(this.serializer,u).keys().forEach((f=>h=h.add(f))),l.set(u.userId,h)})),Y.forEach(l,((u,h)=>{const f=new xn(h),p=ay.wt(this.serializer,f),y=s.getIndexManager(f),x=ly.wt(f,this.serializer,y,s.referenceDelegate);return new WD(r,x,p,y).recalculateAndSaveOverlaysForDocumentKeys(new Qv(t,yr.ce),u).next()}))}))}}function YR(n){n.createObjectStore(_u,{keyPath:B8}).createIndex(nE,G8,{unique:!0}),n.createObjectStore(yu,{keyPath:"targetId"}).createIndex(Gk,z8,{unique:!0}),n.createObjectStore(ul)}const No="IndexedDbPersistence",W0=18e5,$0=5e3,K0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",LW="main";class yE{constructor(e,t,i,r,s,o,l,u,h,f,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=y=>Promise.resolve(),!yE.v())throw new xe(ae.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new EW(this,r),this.$i=t+LW,this.serializer=new MD(u),this.Ui=new Qo(this.$i,this.Ni,new NW(this.serializer)),this.hi=new lW,this.Pi=new mW(this.referenceDelegate,this.serializer),this.remoteDocumentCache=GD(this.serializer),this.Ii=new aW,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&xi(No,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new xe(ae.FAILED_PRECONDITION,K0);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new yr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>qg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ll(e))return fe(No,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe(No,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Oh(e).get(Sc).next((t=>Y.resolve(this.es(t))))}ts(e){return qg(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,W0)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=en(t,vu);return i.J().next((r=>{const s=this.ss(r,W0),o=r.filter((l=>s.indexOf(l)===-1));return Y.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Y.resolve(!0):Oh(e).get(Sc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,$0)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new xe(ae.FAILED_PRECONDITION,K0);return!1}}return!(!this.networkEnabled||!this.inForeground)||qg(e).J().next((i=>this.ss(i,$0).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&fe(No,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[gf,vu],(e=>{const t=new Qv(e,yr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>qg(e).J().next((t=>this.ss(t,W0).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return ly.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new pW(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return ay.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe(No,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?oG:u===17?Yk:u===16?sG:u===15?sE:u===14?qk:u===13?Xk:u===12?rG:u===11?Hk:void Re(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new Qv(l,this.ci?this.ci.next():yr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw xi(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new xe(ae.FAILED_PRECONDITION,Vk);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return Oh(e).get(Sc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,$0)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new xe(ae.FAILED_PRECONDITION,K0)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Oh(e).put(Sc,t)}static v(){return Qo.v()}Zi(e){const t=Oh(e);return t.get(Sc).next((i=>this.es(i)?(fe(No,"Releasing primary lease."),t.delete(Sc)):Y.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(xi(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;G2()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return fe(No,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return xi(No,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){xi("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Oh(n){return en(n,gf)}function qg(n){return en(n,vu)}function OW(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class _E{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=In(),r=In();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new _E(e,t.fromCache,i,r)}}class FW{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class KD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return G2()?8:Uk(Jt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new FW;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Lc()<=Ke.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",kh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Y.resolve()):(Lc()<=Ke.DEBUG&&fe("QueryEngine","Query:",kh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Lc()<=Ke.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",kh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ws(t))):Y.resolve())}ys(e,t){if(IR(t))return Y.resolve(null);let i=Ws(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=rw(t,null,"F"),i=Ws(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=In(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,l);return this.Cs(t,h,o,u.readTime)?this.ys(e,rw(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return IR(t)||r.isEqual(Ze.min())?Y.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Y.resolve(null):(Lc()<=Ke.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),kh(t)),this.vs(e,o,t,b8(r,Ld)).next((l=>l)))}))}Ds(e,t){let i=new mt(SG(e));return t.forEach(((r,s)=>{ry(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Lc()<=Ke.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",kh(t)),this.ps.getDocumentsMatchingQuery(e,t,Ci.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const VW="LocalStore";class jW{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new li($e),this.xs=new la((s=>Il(s)),pf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new WD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function HD(n,e,t,i){return new jW(n,e,t,i)}async function UW(n,e){const t=Tt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let u=In();for(const h of r){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function zW(n,e){const t=Tt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,f){const p=h.batch,y=p.keys();let x=Y.resolve();return y.forEach((I=>{x=x.next((()=>f.getEntry(u,I))).next((S=>{const T=h.docVersions.get(I);De(T!==null,48541),S.version.compareTo(T)<0&&(p.applyToRemoteDocument(S,h),S.isValidDocument()&&(S.setReadTime(h.commitVersion),f.addEntry(S)))}))})),x.next((()=>l.mutationQueue.removeMutationBatch(u,p)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let u=In();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function BW(n){const e=Tt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function GW(n,e){const t=Tt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=cl),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class ZR{constructor(){this.activeTargetIds=DG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class XD{constructor(){this.Mo=new ZR,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new ZR,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class WW{Oo(e){}shutdown(){}}const QR="ConnectivityMonitor";class JR{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){fe(QR,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){fe(QR,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Yg=null;function hw(){return Yg===null?Yg=(function(){return 268435456+Math.round(2147483648*Math.random())})():Yg++,"0x"+Yg.toString(16)}const H0="RestConnection",$W={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class KW{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===rm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=hw(),l=this.zo(e,t.toUriEncodedString());fe(H0,`Sending RPC '${e}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(l),f=Ml(h);return this.Jo(e,l,u,i,f).then((p=>(fe(H0,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw qm(H0,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",i),p}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Nu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=$W[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class HW{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const kn="WebChannelConnection";class XW extends KW{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=hw();return new Promise(((l,u)=>{const h=new Rk;h.setWithCredentials(!0),h.listenOnce(Ak.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case cp.NO_ERROR:const p=h.getResponseJson();fe(kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case cp.TIMEOUT:fe(kn,`RPC '${e}' ${o} timed out`),u(new xe(ae.DEADLINE_EXCEEDED,"Request time out"));break;case cp.HTTP_ERROR:const y=h.getStatus();if(fe(kn,`RPC '${e}' ${o} failed with status:`,y,"response text:",h.getResponseText()),y>0){let x=h.getResponseJson();Array.isArray(x)&&(x=x[0]);const I=x?.error;if(I&&I.status&&I.message){const S=(function(P){const M=P.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(M)>=0?M:ae.UNKNOWN})(I.status);u(new xe(S,I.message))}else u(new xe(ae.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new xe(ae.UNAVAILABLE,"Connection failed."));break;default:Re(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{fe(kn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);fe(kn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=hw(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=kk(),l=bk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const f=s.join("");fe(kn,`Creating RPC '${e}' stream ${r}: ${f}`,u);const p=o.createWebChannel(f,u);this.I_(p);let y=!1,x=!1;const I=new HW({Yo:T=>{x?fe(kn,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(y||(fe(kn,`Opening RPC '${e}' stream ${r} transport.`),p.open(),y=!0),fe(kn,`RPC '${e}' stream ${r} sending:`,T),p.send(T))},Zo:()=>p.close()}),S=(T,P,M)=>{T.listen(P,(k=>{try{M(k)}catch(O){setTimeout((()=>{throw O}),0)}}))};return S(p,Hh.EventType.OPEN,(()=>{x||(fe(kn,`RPC '${e}' stream ${r} transport opened.`),I.o_())})),S(p,Hh.EventType.CLOSE,(()=>{x||(x=!0,fe(kn,`RPC '${e}' stream ${r} transport closed`),I.a_(),this.E_(p))})),S(p,Hh.EventType.ERROR,(T=>{x||(x=!0,qm(kn,`RPC '${e}' stream ${r} transport errored. Name:`,T.name,"Message:",T.message),I.a_(new xe(ae.UNAVAILABLE,"The operation could not be completed")))})),S(p,Hh.EventType.MESSAGE,(T=>{if(!x){const P=T.data[0];De(!!P,16349);const M=P,k=M?.error||M[0]?.error;if(k){fe(kn,`RPC '${e}' stream ${r} received error:`,k);const O=k.status;let F=(function(R){const D=$t[R];if(D!==void 0)return GG(D)})(O),G=k.message;F===void 0&&(F=ae.INTERNAL,G="Unknown error status: "+O+" with message "+k.message),x=!0,I.a_(new xe(F,G)),p.close()}else fe(kn,`RPC '${e}' stream ${r} received:`,P),I.u_(P)}})),S(l,Pk.STAT_EVENT,(T=>{T.stat===Kv.PROXY?fe(kn,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===Kv.NOPROXY&&fe(kn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{I.__()}),0),I}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function qW(){return typeof window<"u"?window:null}function yp(){return typeof document<"u"?document:null}function qD(n){return new HG(n,!0)}class YD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&fe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const eA="PersistentStream";class YW{constructor(e,t,i,r,s,o,l,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new YD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ae.RESOURCE_EXHAUSTED?(xi(t.toString()),xi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new xe(ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return fe(eA,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(fe(eA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class ZW extends YW{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return De(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,De(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){De(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=QG(e.writeResults,e.commitTime),i=Er(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=YG(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>cm(this.serializer,i)))};this.q_(t)}}class QW{}class JW extends QW{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new xe(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,ow(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new xe(ae.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,ow(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new xe(ae.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class e7{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(xi(t),this.aa=!1):fe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const uy="RemoteStore";class t7{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{dy(this)&&(fe(uy,"Restarting streams for network reachability change."),await(async function(u){const h=Tt(u);h.Ea.add(4),await hy(h),h.Ra.set("Unknown"),h.Ea.delete(4),await vE(h)})(this))}))})),this.Ra=new e7(i,r)}}async function vE(n){if(dy(n))for(const e of n.da)await e(!0)}async function hy(n){for(const e of n.da)await e(!1)}function dy(n){return Tt(n).Ea.size===0}async function ZD(n,e,t){if(!Ll(e))throw e;n.Ea.add(1),await hy(n),n.Ra.set("Offline"),t||(t=()=>BW(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{fe(uy,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await vE(n)}))}function QD(n,e){return e().catch((t=>ZD(n,t,e)))}async function fy(n){const e=Tt(n),t=sa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:cl;for(;n7(e);)try{const r=await GW(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,i7(e,r)}catch(r){await ZD(e,r)}JD(e)&&eM(e)}function n7(n){return dy(n)&&n.Ta.length<10}function i7(n,e){n.Ta.push(e);const t=sa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function JD(n){return dy(n)&&!sa(n).x_()&&n.Ta.length>0}function eM(n){sa(n).start()}async function r7(n){sa(n).ra()}async function s7(n){const e=sa(n);for(const t of n.Ta)e.ea(t.mutations)}async function o7(n,e,t){const i=n.Ta.shift(),r=dE.from(i,e,t);await QD(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await fy(n)}async function a7(n,e){e&&sa(n).X_&&await(async function(i,r){if((function(o){return BG(o)&&o!==ae.ABORTED})(r.code)){const s=i.Ta.shift();sa(i).B_(),await QD(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await fy(i)}})(n,e),JD(n)&&eM(n)}async function l7(n,e){const t=Tt(n);e?(t.Ea.delete(2),await vE(t)):e||(t.Ea.add(2),await hy(t),t.Ra.set("Unknown"))}function sa(n){return n.fa||(n.fa=(function(t,i,r){const s=Tt(t);return s.sa(),new ZW(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:r7.bind(null,n),r_:a7.bind(null,n),ta:s7.bind(null,n),na:o7.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await fy(n)):(await n.fa.stop(),n.Ta.length>0&&(fe(uy,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class wE{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new ll,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new wE(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new xe(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function c7(n,e){if(xi("AsyncQueue",`${e}: ${n}`),Ll(n))return new xe(ae.UNAVAILABLE,`${e}: ${n}`);throw n}class u7{constructor(){this.queries=tA(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Tt(t),s=r.queries;r.queries=tA(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(i)}))})(this,new xe(ae.ABORTED,"Firestore shutting down"))}}function tA(){return new la((n=>mD(n)),pD)}function h7(n){n.Ca.forEach((e=>{e.next()}))}var nA,iA;(iA=nA||(nA={})).Ma="default",iA.Cache="cache";const d7="SyncEngine";class f7{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new la((l=>mD(l)),pD),this.Iu=new Map,this.Eu=new Set,this.du=new li(ve.comparator),this.Au=new Map,this.Ru=new mE,this.Vu={},this.mu=new Map,this.fu=Rl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function rA(n,e,t){const i=Tt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const u=Tt(o);u.onlineState=l;let h=!1;u.queries.forEach(((f,p)=>{for(const y of p.Sa)y.va(l)&&(h=!0)})),h&&h7(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function g7(n,e){const t=Tt(n),i=e.batch.batchId;try{const r=await zW(t.localStore,e);nM(t,i,null),tM(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await xE(t,r)}catch(r){await Ym(r)}}async function p7(n,e,t){const i=Tt(n);try{const r=await(function(o,l){const u=Tt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next((p=>(De(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);nM(i,e,t),tM(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await xE(i,r)}catch(r){await Ym(r)}}function tM(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function nM(n,e,t){const i=Tt(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function xE(n,e,t){const i=Tt(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){r.push(h);const f=_E.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const f=Tt(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>Y.forEach(h,(y=>Y.forEach(y.Es,(x=>f.persistence.referenceDelegate.addReference(p,y.targetId,x))).next((()=>Y.forEach(y.ds,(x=>f.persistence.referenceDelegate.removeReference(p,y.targetId,x)))))))))}catch(p){if(!Ll(p))throw p;fe(VW,"Failed to update sequence numbers: "+p)}for(const p of h){const y=p.targetId;if(!p.fromCache){const x=f.Ms.get(y),I=x.snapshotVersion,S=x.withLastLimboFreeSnapshotVersion(I);f.Ms=f.Ms.insert(y,S)}}})(i.localStore,s))}async function m7(n,e){const t=Tt(n);if(!t.currentUser.isEqual(e)){fe(d7,"User change. New user:",e.toKey());const i=await UW(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new xe(ae.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await xE(t,i.Ls)}}function y7(n){const e=Tt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=g7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=p7.bind(null,e),e}class dw{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=qD(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return HD(this.persistence,new KD,e.initialUser,this.serializer)}Cu(e){return new $D(cy.mi,this.serializer)}Du(e){return new XD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}dw.provider={build:()=>new dw};class _7 extends dw{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await y7(this.xu.syncEngine),await fy(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return HD(this.persistence,new KD,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new vW(i,e.asyncQueue,t)}Mu(e,t){const i=new N8(t,this.persistence);return new M8(e.asyncQueue,i)}Cu(e){const t=OW(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new yE(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,qW(),yp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new XD}}class fw{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>rA(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=m7.bind(null,this.syncEngine),await l7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new u7})()}createDatastore(e){const t=qD(e.databaseInfo.databaseId),i=(function(s){return new XW(s)})(e.databaseInfo);return(function(s,o,l,u){return new JW(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new t7(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>rA(this.syncEngine,t,0)),(function(){return JR.v()?new JR:new WW})())}createSyncEngine(e,t){return(function(r,s,o,l,u,h,f){const p=new f7(r,s,o,l,u,h);return f&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Tt(t);fe(uy,"RemoteStore shutting down."),i.Ea.add(5),await hy(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}fw.provider={build:()=>new fw};const sA="FirestoreClient";class v7{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=xn.UNAUTHENTICATED,this.clientId=Nk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{fe(sA,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(fe(sA,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ll;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=c7(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function iM(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const oA=new Map;const rM="firestore.googleapis.com",aA=!0;class lA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new xe(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rM,this.ssl=aA}else this.host=e.host,this.ssl=e.ssl??aA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=VD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yW)throw new xe(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}R8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iM(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new xe(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new xe(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new xe(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sM{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new xe(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new xe(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new y8;switch(i.type){case"firstParty":return new x8(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new xe(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=oA.get(t);i&&(fe("ComponentProvider","Removing Datastore"),oA.delete(t),i.terminate())})(this),Promise.resolve()}}function w7(n,e,t,i={}){n=Ok(n,sM);const r=Ml(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(Fx(`https://${l}`),Vx("Firestore",!0)),s.host!==rM&&s.host!==l&&qm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:r,emulatorOptions:i};if(!wl(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=xn.MOCK_USER;else{h=z2(i.mockUserToken,n._app?.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new xe(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new xn(p)}n._authCredentials=new _8(new Mk(h,f))}}class EE{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new EE(this.firestore,e,this._query)}}class es{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new TE(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new es(this.firestore,e,this._key)}toJSON(){return{type:es._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(ff(t,es._jsonSchema))return new es(e,i||null,new ve(Ct.fromString(t.referencePath)))}}es._jsonSchemaVersion="firestore/documentReference/1.0",es._jsonSchema={type:Ht("string",es._jsonSchemaVersion),referencePath:Ht("string")};class TE extends EE{constructor(e,t,i){super(e,t,gD(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new es(this.firestore,null,new ve(e))}withConverter(e){return new TE(this.firestore,e,this._path)}}const cA="AsyncQueue";class uA{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new YD(this,"async_queue_retry"),this._c=()=>{const i=yp();i&&fe(cA,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=yp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=yp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ll;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ll(e))throw e;fe(cA,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,xi("INTERNAL UNHANDLED ERROR: ",hA(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=wE.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Re(47125,{Pc:hA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function hA(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class oM extends sM{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new uA,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new uA(e),this._firestoreClient=void 0,await e}}}function x7(n,e){const t=typeof n=="object"?n:zx(),i=typeof n=="string"?n:rm,r=$m(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=V2("firestore");s&&w7(r,...s)}return r}function E7(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new uG(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,iM(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new v7(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function T7(n,e){qm("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return I7(n,fw.provider,{build:i=>new _7(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function I7(n,e,t){if((n=Ok(n,oM))._firestoreClient||n._terminated)throw new xe(ae.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new xe(ae.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},E7(n)}class Ls{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ls(ci.fromBase64String(e))}catch(t){throw new xe(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ls(ci.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ls._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ff(e,Ls._jsonSchema))return Ls.fromBase64String(e.bytes)}}Ls._jsonSchemaVersion="firestore/bytes/1.0",Ls._jsonSchema={type:Ht("string",Ls._jsonSchemaVersion),bytes:Ht("string")};class aM{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new xe(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new xe(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new xe(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:hl._jsonSchemaVersion}}static fromJSON(e){if(ff(e,hl._jsonSchema))return new hl(e.latitude,e.longitude)}}hl._jsonSchemaVersion="firestore/geoPoint/1.0",hl._jsonSchema={type:Ht("string",hl._jsonSchemaVersion),latitude:Ht("number"),longitude:Ht("number")};class dl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:dl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ff(e,dl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new dl(e.vectorValues);throw new xe(ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}dl._jsonSchemaVersion="firestore/vectorValue/1.0",dl._jsonSchema={type:Ht("string",dl._jsonSchemaVersion),vectorValues:Ht("object")};const S7=new RegExp("[~\\*/\\[\\]]");function C7(n,e,t){if(e.search(S7)>=0)throw dA(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new aM(...e.split("."))._internalPath}catch{throw dA(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function dA(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new xe(ae.INVALID_ARGUMENT,s+n+o)}class lM{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new es(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new R7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(cM("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class R7 extends lM{data(){return super.data()}}function cM(n,e){return typeof e=="string"?C7(n,e):e instanceof aM?e._internalPath:e._delegate._internalPath}class Zg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class eu extends lM{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new _p(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(cM("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new xe(ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=eu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}eu._jsonSchemaVersion="firestore/documentSnapshot/1.0",eu._jsonSchema={type:Ht("string",eu._jsonSchemaVersion),bundleSource:Ht("string","DocumentSnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class _p extends eu{data(e={}){return super.data(e)}}class hd{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Zg(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new _p(this._firestore,this._userDataWriter,i.key,i,new Zg(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new xe(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const u=new _p(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Zg(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new _p(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Zg(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:A7(l.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new xe(ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Nk.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function A7(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re(61501,{type:n})}}hd._jsonSchemaVersion="firestore/querySnapshot/1.0",hd._jsonSchema={type:Ht("string",hd._jsonSchemaVersion),bundleSource:Ht("string","QuerySnapshot"),bundleName:Ht("string"),bundle:Ht("string")};(function(e,t=!0){(function(r){Nu=r})(Nl),xl(new na("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new oM(new v8(i.getProvider("auth-internal")),new E8(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new xe(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xu(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),is(nR,iR,e),is(nR,iR,"esm2020")})();const uM="firebasestorage.googleapis.com",P7="storageBucket",b7=120*1e3,k7=600*1e3;class hs extends us{constructor(e,t,i=0){super(X0(e),`Firebase Storage: ${t} (${X0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,hs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return X0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var as;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(as||(as={}));function X0(n){return"storage/"+n}function D7(){const n="An unknown error occurred, please check the error payload for server response.";return new hs(as.UNKNOWN,n)}function M7(){return new hs(as.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function N7(){return new hs(as.CANCELED,"User canceled the upload/download.")}function L7(n){return new hs(as.INVALID_URL,"Invalid URL '"+n+"'.")}function O7(n){return new hs(as.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function fA(n){return new hs(as.INVALID_ARGUMENT,n)}function hM(){return new hs(as.APP_DELETED,"The Firebase app was deleted.")}function F7(n){return new hs(as.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class vr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=vr.makeFromUrl(e,t)}catch{return new vr(e,"")}if(i.path==="")return i;throw O7(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(O){O.path.charAt(O.path.length-1)==="/"&&(O.path_=O.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(O){O.path_=decodeURIComponent(O.path)}const f="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",x=new RegExp(`^https?://${p}/${f}/b/${r}/o${y}`,"i"),I={bucket:1,path:3},S=t===uM?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",P=new RegExp(`^https?://${S}/${r}/${T}`,"i"),k=[{regex:l,indices:u,postModify:s},{regex:x,indices:I,postModify:h},{regex:P,indices:{bucket:1,path:2},postModify:h}];for(let O=0;O<k.length;O++){const F=k[O],G=F.regex.exec(e);if(G){const b=G[F.indices.bucket];let R=G[F.indices.path];R||(R=""),i=new vr(b,R),F.postModify(i);break}}if(i==null)throw L7(e);return i}}class V7{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function j7(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function f(...T){h||(h=!0,e.apply(null,T))}function p(T){r=setTimeout(()=>{r=null,n(x,u())},T)}function y(){s&&clearTimeout(s)}function x(T,...P){if(h){y();return}if(T){y(),f.call(null,T,...P);return}if(u()||o){y(),f.call(null,T,...P);return}i<64&&(i*=2);let k;l===1?(l=2,k=0):k=(i+Math.random())*1e3,p(k)}let I=!1;function S(T){I||(I=!0,y(),!h&&(r!==null?(T||(l=2),clearTimeout(r),p(0)):T||(l=1)))}return p(0),s=setTimeout(()=>{o=!0,S(!0)},t),S}function U7(n){n(!1)}function z7(n){return n!==void 0}function gA(n,e,t,i){if(i<e)throw fA(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw fA(`Invalid value for '${n}'. Expected ${t} or less.`)}function B7(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var fm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(fm||(fm={}));function G7(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class W7{constructor(e,t,i,r,s,o,l,u,h,f,p,y=!0,x=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=p,this.retry=y,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((I,S)=>{this.resolve_=I,this.reject_=S,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new Qg(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===fm.NO_ERROR,u=s.getStatus();if(!l||G7(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===fm.ABORT;i(!1,new Qg(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new Qg(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());z7(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=D7();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?hM():N7();o(u)}else{const u=M7();o(u)}};this.canceled_?t(!1,new Qg(!1,null,!0)):this.backoffId_=j7(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&U7(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Qg{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function $7(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function K7(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function H7(n,e){e&&(n["X-Firebase-GMPID"]=e)}function X7(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function q7(n,e,t,i,r,s,o=!0,l=!1){const u=B7(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return H7(f,e),$7(f,t),K7(f,s),X7(f,i),new W7(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function Y7(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Z7(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class gm{constructor(e,t){this._service=e,t instanceof vr?this._location=t:this._location=vr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new gm(e,t)}get root(){const e=new vr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Z7(this._location.path)}get storage(){return this._service}get parent(){const e=Y7(this._location.path);if(e===null)return null;const t=new vr(this._location.bucket,e);return new gm(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw F7(e)}}function pA(n,e){const t=e?.[P7];return t==null?null:vr.makeFromBucketSpec(t,n)}function Q7(n,e,t,i={}){n.host=`${e}:${t}`;const r=Ml(e);r&&(Fx(`https://${n.host}/b`),Vx("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:z2(s,n.app.options.projectId))}class J7{constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=uM,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=b7,this._maxUploadRetryTime=k7,this._requests=new Set,r!=null?this._bucket=vr.makeFromBucketSpec(r,this._host):this._bucket=pA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=vr.makeFromBucketSpec(this._url,e):this._bucket=pA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){gA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){gA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if($i(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new gm(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new V7(hM());{const o=q7(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const mA="@firebase/storage",yA="0.14.0";const dM="storage";function e$(n=zx(),e){n=Js(n);const i=$m(n,dM).getImmediate({identifier:e}),r=V2("storage");return r&&t$(i,...r),i}function t$(n,e,t,i={}){Q7(n,e,t,i)}function n$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new J7(t,i,r,e,Nl)}function i$(){xl(new na(dM,n$,"PUBLIC").setMultipleInstances(!0)),is(mA,yA,""),is(mA,yA,"esm2020")}i$();const r$={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},IE=X2(r$),q0=f8(IE),s$=x7(IE);e$(IE);T7(s$).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const o$="visvriend2024",a$=new Ns,fM=cs()(af((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===o$;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await E9(q0,a$);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await n9(q0),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{t9(q0,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})}));function l$({target:n}){const e=J.useRef(null),t=J.useRef(null),i=Qs(s=>s.setMap),r=ln(s=>s.showScaleBar);return J.useEffect(()=>{if(!e.current){const s=new tU({target:n,controls:[],view:new Yr({center:gl([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),J.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new rU({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const c$=["OpenStreetMap","Luchtfoto"];function u$(){const n=J.useRef(null),e=J.useRef(!1);l$({target:"map"});const t=Qs(u=>u.map),i=qo(u=>u.registerLayer),r=qo(u=>u.setLayerVisibility),s=ln(u=>u.defaultBackground),o=ln(u=>u.gpsAutoStart),l=Wi(u=>u.startTracking);return J.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const u=new I0({properties:{title:"OpenStreetMap",type:"base"},visible:!0,source:new x6}),h=new I0({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Pv({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),f=new I0({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Pv({url:"https://{a-d}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})});t.addLayer(u),t.addLayer(h),t.addLayer(f),i("OpenStreetMap",u),i("Luchtfoto",h),i("Labels Overlay",f),t.updateSize(),p();async function p(){const y=bU();console.log(`Loading ${y.length} immediate layers...`),(await Promise.allSettled(y.map(async I=>{try{const S=await I.factory();return S?{name:I.name,layer:S}:null}catch(S){return console.warn(`Failed to create ${I.name}:`,S),null}}))).forEach(I=>{if(I.status==="fulfilled"&&I.value){const{name:S,layer:T}=I.value;t.addLayer(T),i(S,T)}})}},[t,i]),J.useEffect(()=>{if(!t||e.current)return;const u=setTimeout(()=>{const h=s||"OpenStreetMap";c$.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(u)},[t,s,r]),J.useEffect(()=>{if(!t||!o)return;const u=setTimeout(()=>l(),500);return()=>clearTimeout(u)},[t,o,l]),E.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const h$=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),d$=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),_A=n=>{const e=d$(n);return e.charAt(0).toUpperCase()+e.slice(1)},gM=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),f$=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var g$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const p$=J.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},u)=>J.createElement("svg",{ref:u,...g$,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:gM("lucide",r),...!s&&!f$(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>J.createElement(h,f)),...Array.isArray(s)?s:[s]]));const Be=(n,e)=>{const t=J.forwardRef(({className:i,...r},s)=>J.createElement(p$,{ref:s,iconNode:e,className:gM(`lucide-${h$(_A(n))}`,`lucide-${n}`,i),...r}));return t.displayName=_A(n),t};const m$=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],pM=Be("anchor",m$);const y$=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],_$=Be("book-open",y$);const v$=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],SE=Be("camera",v$);const w$=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],x$=Be("chart-column",w$);const E$=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],gw=Be("check",E$);const T$=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],I$=Be("chevron-up",T$);const S$=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],CE=Be("cloud",S$);const C$=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],mM=Be("external-link",C$);const R$=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],A$=Be("eye-off",R$);const P$=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],b$=Be("eye",P$);const k$=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],D$=Be("file-text",k$);const M$=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],Sr=Be("fish",M$);const N$=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],L$=Be("image-plus",N$);const O$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],yM=Be("info",O$);const F$=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],pm=Be("layers",F$);const V$=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],j$=Be("locate-fixed",V$);const U$=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],z$=Be("lock",U$);const B$=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],G$=Be("log-out",B$);const W$=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Al=Be("map-pin",W$);const $$=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],gy=Be("map",$$);const K$=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],H$=Be("menu",K$);const X$=[["path",{d:"M5 12h14",key:"1ays0h"}]],q$=Be("minus",X$);const Y$=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],_M=Be("navigation",Y$);const Z$=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],Q$=Be("person-standing",Z$);const J$=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],eK=Be("plus",J$);const tK=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],nK=Be("rotate-ccw",tK);const iK=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],rK=Be("ruler",iK);const sK=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],oK=Be("save",sK);const aK=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],lK=Be("scale",aK);const cK=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],vA=Be("search",cK);const uK=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],hK=Be("settings",uK);const dK=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],fK=Be("ship",dK);const gK=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],pw=Be("star",gK);const pK=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],mK=Be("tag",pK);const yK=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],_K=Be("thermometer",yK);const vK=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],wK=Be("trending-down",vK);const xK=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],EK=Be("trending-up",xK);const TK=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],IK=Be("user",TK);const SK=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],CK=Be("waves",SK);const RK=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],AK=Be("wind",RK);const PK=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],eo=Be("x",PK);async function bK(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e(null);return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,p=r.getUint16(f)===18761,y=kK(r,f,p);e(y);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e(null)},t.onerror=()=>e(null),t.readAsArrayBuffer(n)})}function kK(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null;for(let p=0;p<r;p++){const y=i+2+p*12;if(n.getUint16(y,t)===34853){s=e+n.getUint32(y+8,t);break}}if(!s)return null;const o=n.getUint16(s,t);let l=null,u=null,h=null,f=null;for(let p=0;p<o;p++){const y=s+2+p*12,x=n.getUint16(y,t),I=n.getUint16(y+2,t),S=n.getUint32(y+4,t),T=y+8;switch(x){case 1:l=String.fromCharCode(n.getUint8(T));break;case 2:u=wA(n,e+n.getUint32(T,t),3,t);break;case 3:h=String.fromCharCode(n.getUint8(T));break;case 4:f=wA(n,e+n.getUint32(T,t),3,t);break}}if(u&&f&&l&&h){const p=xA(u[0],u[1],u[2],l),y=xA(f[0],f[1],f[2],h);if(!isNaN(p)&&!isNaN(y))return{lat:p,lng:y}}return null}catch{return null}}function wA(n,e,t,i){const r=[];for(let s=0;s<t;s++){const o=n.getUint32(e+s*8,i),l=n.getUint32(e+s*8+4,i);r.push(l===0?0:o/l)}return r}function xA(n,e,t,i){let r=n+e/60+t/3600;return(i==="S"||i==="W")&&(r=-r),r}const vM=200,DK=.7;async function MK(n,e=vM){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,u=r.height;l>u?l>e&&(u=Math.round(u*e/l),l=e):u>e&&(l=Math.round(l*e/u),u=e),s.width=l,s.height=u,o?.drawImage(r,0,0,l,u),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",DK)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function NK(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function wM(n){const e=await MK(n,vM),t=await NK(e);return{thumbnailBlob:e,thumbnailBase64:t}}function xM(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function LK(){const n=Qs(k=>k.map),e=ii(k=>k.openCatchForm),[t,i]=J.useState(null),[r,s]=J.useState(!1),[o,l]=J.useState(!1),u=J.useRef(null),h=J.useRef(null);J.useEffect(()=>{if(!n)return;const k=n.getViewport();if(!k)return;const O=600,F=15,G=N=>{if(N.touches.length!==1)return;const se=N.touches[0];h.current={x:se.clientX,y:se.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const ge=window.__olMap;if(!ge)return;const ne=k.getBoundingClientRect(),ue=[h.current.x-ne.left,h.current.y-ne.top],Z=ge.getCoordinateFromPixel(ue);if(Z){const le=_S(Z);N.preventDefault(),i({pixel:[h.current.x,h.current.y],coordinate:le}),s(!0),l(!1),setTimeout(()=>l(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},O)},b=N=>{if(!u.current||!h.current)return;const se=N.touches[0],ge=se.clientX-h.current.x,ne=se.clientY-h.current.y;Math.sqrt(ge*ge+ne*ne)>F&&(clearTimeout(u.current),u.current=null)},R=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null},D=N=>{r&&N.preventDefault()},V=N=>{N.button===0&&(h.current={x:N.clientX,y:N.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const se=window.__olMap;if(!se)return;const ge=k.getBoundingClientRect(),ne=[h.current.x-ge.left,h.current.y-ge.top],ue=se.getCoordinateFromPixel(ne);if(ue){const Z=_S(ue);i({pixel:[h.current.x,h.current.y],coordinate:Z}),s(!0),l(!1),setTimeout(()=>l(!0),300)}},O))},j=N=>{if(!u.current||!h.current)return;const se=N.clientX-h.current.x,ge=N.clientY-h.current.y;Math.sqrt(se*se+ge*ge)>F&&(clearTimeout(u.current),u.current=null)},z=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null};return k.addEventListener("touchstart",G,{passive:!1}),k.addEventListener("touchmove",b,{passive:!0}),k.addEventListener("touchend",R),k.addEventListener("touchcancel",R),k.addEventListener("contextmenu",D),k.addEventListener("mousedown",V),k.addEventListener("mousemove",j),k.addEventListener("mouseup",z),k.addEventListener("mouseleave",z),()=>{k.removeEventListener("touchstart",G),k.removeEventListener("touchmove",b),k.removeEventListener("touchend",R),k.removeEventListener("touchcancel",R),k.removeEventListener("contextmenu",D),k.removeEventListener("mousedown",V),k.removeEventListener("mousemove",j),k.removeEventListener("mouseup",z),k.removeEventListener("mouseleave",z),u.current&&clearTimeout(u.current)}},[n,r]);const f=()=>{o&&(s(!1),i(null),l(!1))},p=()=>{s(!1),i(null),l(!1)},y=J.useRef(null),x=()=>{if(!t)return;const[k,O]=t.coordinate;e({location:{lat:O,lng:k},locationSource:"map"}),p()},I=()=>{y.current?.click()},S=async k=>{const O=k.target.files?.[0];if(!(!O||!t)){try{const F=await bK(O),{thumbnailBase64:G}=await wM(O),b={id:xM(),thumbnailBase64:G,createdAt:new Date().toISOString(),pendingUpload:!0};if(F)e({location:F,locationSource:"photo",photos:[b]});else{const[R,D]=t.coordinate;e({location:{lat:D,lng:R},locationSource:"map",photos:[b]})}}catch(F){console.error("Failed to process photo:",F);const[G,b]=t.coordinate;e({location:{lat:b,lng:G},locationSource:"map"})}k.target.value="",p()}},T=()=>{if(!t)return;const[k,O]=t.coordinate,F=`https://www.google.com/maps?q=${O},${k}`;window.open(F,"_blank"),p()},P=()=>{if(!t)return;const[k,O]=t.coordinate,F=`https://www.google.com/maps?layer=c&cbll=${O},${k}`;window.open(F,"_blank"),p()},M=k=>{const[O,F]=k;return`${F.toFixed(5)}N, ${O.toFixed(5)}E`};return E.jsx(qs,{children:r&&t&&E.jsxs(E.Fragment,{children:[E.jsx(Je.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),E.jsxs(Je.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(t.pixel[0],window.innerWidth-220),top:Math.min(t.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[E.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:E.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[E.jsx(Al,{size:16}),E.jsx("span",{className:"text-xs font-mono",children:M(t.coordinate)})]})}),E.jsxs("div",{className:"bg-white",children:[E.jsxs("button",{onClick:I,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[E.jsx(SE,{size:20,className:"text-green-500"}),E.jsx("span",{className:"font-medium",children:"Maak foto"})]}),E.jsxs("button",{onClick:x,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[E.jsx(Sr,{size:20,className:"text-orange-500"}),E.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),E.jsxs("button",{onClick:P,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[E.jsx(Q$,{size:20,className:"text-yellow-600"}),E.jsx("span",{className:"font-medium",children:"Street View"})]}),E.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[E.jsx(mM,{size:20,className:"text-blue-600"}),E.jsx("span",{className:"font-medium",children:"Google Maps"})]})]}),E.jsx("input",{ref:y,type:"file",accept:"image/*",capture:"environment",onChange:S,className:"hidden"}),E.jsx("div",{className:"bg-white",children:E.jsxs("button",{onClick:p,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[E.jsx(eo,{size:18}),E.jsx("span",{children:"Annuleren"})]})})]})]})})}function OK(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=Wi(),s=J.useCallback(l=>{i(l)},[i]),o=J.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return J.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function FK(){const{tracking:n,toggle:e}=OK();return E.jsx(Je.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:E.jsx(j$,{size:22,strokeWidth:2})})}const VK="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function jK(){const n=Qs(y=>y.map),e=Wi(y=>y.position),t=Wi(y=>y.accuracy),i=Wi(y=>y.tracking),r=Wi(y=>y.smoothHeading),s=ln(y=>y.showAccuracyCircle),o=Wi(y=>y.firstFix),l=Wi(y=>y.resetFirstFix),u=J.useRef(null),h=J.useRef(null),f=J.useRef(null),p=J.useMemo(()=>y=>new Yi({image:new wx({src:VK,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return J.useEffect(()=>{if(!n||!i&&!e)return;const y=gl([5.1214,52.0907]);return u.current=new ou({geometry:new pl(y)}),u.current.setStyle(p(0)),h.current=new ou({geometry:new pl(y)}),f.current=new Ax({source:new vx({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,p]),J.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const y=gl([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const x=n.getView().getResolution()||1,I=Math.min(t/x,80);h.current.setStyle(new Yi({image:new kl({radius:I,fill:new Tr({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new Yi({}));if(o&&i){n.getView().setCenter(y),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:y,duration:150})},[n,i,e,t,o,l,s]),J.useEffect(()=>{if(!u.current)return;const y=r!==null?r*Math.PI/180:0;u.current.setStyle(p(y))},[r,p]),null}function UK(){const n=Qs(k=>k.map),[e,t]=J.useState(!1),[i,r]=J.useState(""),[s,o]=J.useState([]),[l,u]=J.useState(!1),[h,f]=J.useState(!1),p=J.useRef(null),y=J.useRef(null),x=J.useRef();J.useEffect(()=>{e&&p.current&&p.current.focus()},[e]),J.useEffect(()=>{if(!e)return;const k=O=>{y.current&&!y.current.contains(O.target)&&I()};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[e]),J.useEffect(()=>{if(!e)return;const k=O=>{O.key==="Escape"&&I()};return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[e]),J.useEffect(()=>{if(x.current&&clearTimeout(x.current),i.length<2){o([]);return}return x.current=window.setTimeout(async()=>{f(!0);try{const O=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();O.response?.docs&&o(O.response.docs)}catch(k){console.error("Search error:",k),o([])}finally{f(!1)}},300),()=>{x.current&&clearTimeout(x.current)}},[i]);const I=()=>{t(!1),r(""),o([]),u(!1)},S=async k=>{try{const F=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(k)}`)).json();if(F.response?.docs?.[0]?.centroide_ll){const b=F.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(b)return{lng:parseFloat(b[1]),lat:parseFloat(b[2])}}}catch(O){console.error("Lookup error:",O)}return null},T=async k=>{if(!n)return;const O=await S(k.id);O&&n.getView().animate({center:gl([O.lng,O.lat]),zoom:16,duration:1e3}),I()},P=async(k,O)=>{O.stopPropagation();const F=await S(k.id);if(F){const G=`https://www.google.com/maps?q=${F.lat},${F.lng}`;window.open(G,"_blank")}I()},M={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?E.jsxs("div",{ref:y,className:"fixed left-[52px] right-14 z-[850]",style:M,children:[E.jsxs(Je.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[E.jsx(vA,{size:18,className:"search-icon"}),E.jsx("input",{ref:p,type:"text",value:i,onChange:k=>{r(k.target.value),u(!0)},onFocus:()=>u(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),E.jsx("button",{onClick:I,className:"search-clear",title:"Sluiten",children:E.jsx(eo,{size:18})})]}),E.jsx(qs,{children:l&&s.length>0&&E.jsx(Je.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(k=>E.jsxs("li",{className:"search-result-item",children:[E.jsx("div",{className:"search-result-content",onClick:()=>T(k),children:E.jsx("span",{className:"search-result-text",children:k.weergavenaam})}),E.jsx("button",{className:"search-navigate-btn",onClick:O=>P(k,O),title:"Open in Google Maps",children:E.jsx(mM,{size:20})})]},k.id))})}),l&&h&&E.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):E.jsx(Je.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:M,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:E.jsx(vA,{size:22,className:"text-gray-600"})})}function zK({size:n=18}){return E.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[E.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),E.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),E.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),E.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function BK(){const[n,e]=J.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=ii(),{user:r,loading:s,signInWithGoogle:o,logout:l}=fM(),u=ln(T=>T.showCatchButton),h=ln(T=>T.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},p=()=>e(!1),y=()=>{p(),t()},x=()=>{p(),i()},I=()=>{p(),o()},S=()=>{p(),l()};return E.jsxs(E.Fragment,{children:[E.jsx(Je.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?E.jsx(eo,{size:22,className:"text-white"}):E.jsx(H$,{size:22,className:"text-gray-600"})}),E.jsx(qs,{children:n&&E.jsxs(E.Fragment,{children:[E.jsx(Je.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:p}),E.jsxs(Je.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[E.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-blue-500",children:E.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?E.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:E.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):r?E.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:E.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?E.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):E.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:E.jsx(IK,{size:16,className:"text-white"})}),E.jsxs("div",{className:"flex-1 min-w-0",children:[E.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),E.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),E.jsx("button",{onClick:S,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:E.jsx(G$,{size:16})})]})}):E.jsxs("button",{onClick:I,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[E.jsx(zK,{size:18}),E.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),E.jsx("div",{className:"py-1",children:E.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[E.jsx(yM,{size:18,className:"text-blue-500"}),E.jsx("span",{children:"Info & handleiding"})]})}),E.jsx("div",{className:"py-1 border-t border-gray-100",children:E.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx(Sr,{size:18,className:"text-green-500"}),E.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),E.jsx("button",{onClick:()=>h(!u),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${u?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:E.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${u?"left-[22px]":"left-0.5"}`})})]})}),E.jsx("div",{className:"mt-auto border-t border-gray-100",children:E.jsxs("button",{onClick:x,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[E.jsx(hK,{size:18,className:"text-gray-500"}),E.jsx("span",{children:"Instellingen"})]})}),E.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.3"})]})]})})]})}function GK(){const{infoPanelOpen:n,toggleInfoPanel:e}=ii(),[t,i]=J.useState("info"),r=[{id:"info",label:"Info",icon:E.jsx(yM,{size:14})},{id:"functies",label:"Functies",icon:E.jsx(D$,{size:14})},{id:"handleiding",label:"Handleiding",icon:E.jsx(_$,{size:14})}];return E.jsx(qs,{children:n&&E.jsxs(E.Fragment,{children:[E.jsx(Je.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),E.jsxs(Je.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[E.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[E.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.3"}),E.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:E.jsx(eo,{size:18,className:"text-white",strokeWidth:2.5})})]}),E.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>E.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&E.jsx(WK,{}),t==="functies"&&E.jsx($K,{}),t==="handleiding"&&E.jsx(KK,{}),E.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:E.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.3 - Voor jou en je vismaat"})})]})]})]})})}function WK(){return E.jsxs(E.Fragment,{children:[E.jsxs("section",{children:[E.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),E.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),E.jsxs("section",{children:[E.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),E.jsxs("ul",{className:"space-y-2 text-gray-600",children:[E.jsxs("li",{children:[E.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",E.jsx("br",{}),E.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),E.jsxs("li",{children:[E.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",E.jsx("br",{}),E.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),E.jsxs("li",{children:[E.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",E.jsx("br",{}),E.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),E.jsxs("section",{children:[E.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),E.jsxs("div",{className:"text-gray-600 space-y-2",children:[E.jsxs("p",{children:[E.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),E.jsxs("p",{children:[E.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function $K(){return E.jsxs(E.Fragment,{children:[E.jsxs("section",{children:[E.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[E.jsx(gy,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),E.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[E.jsxs("li",{children:[E.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),E.jsxs("li",{children:[E.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),E.jsxs("li",{children:[E.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),E.jsxs("li",{children:[E.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),E.jsxs("li",{children:[E.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),E.jsxs("section",{children:[E.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[E.jsx(Sr,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),E.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[E.jsx("li",{children:"Registreer soort, gewicht en lengte"}),E.jsx("li",{children:"Vismethode en aas bijhouden"}),E.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),E.jsx("li",{children:"GPS locatie per vangst"})]})]}),E.jsxs("section",{children:[E.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[E.jsx(Al,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),E.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[E.jsx("li",{children:"Markeer je beste visplekken"}),E.jsx("li",{children:"Voeg notities en ratings toe"}),E.jsx("li",{children:"Welke vis zit waar?"})]})]}),E.jsxs("section",{children:[E.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[E.jsx(CE,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),E.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[E.jsx("li",{children:"Live weergegevens op je locatie"}),E.jsx("li",{children:"Windsnelheid en richting"}),E.jsx("li",{children:"Luchtdruk"}),E.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),E.jsxs("section",{children:[E.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[E.jsx(_M,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),E.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[E.jsx("li",{children:"Live GPS tracking"}),E.jsx("li",{children:"Zoek adressen en plaatsen"}),E.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function KK(){return E.jsxs(E.Fragment,{children:[E.jsxs("section",{children:[E.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),E.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[E.jsxs("li",{children:["Tik op de ",E.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),E.jsxs("li",{children:["Gebruik het ",E.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),E.jsxs("li",{children:["Tik op de ",E.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),E.jsxs("section",{children:[E.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),E.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[E.jsxs("p",{children:[E.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),E.jsxs("p",{children:[E.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),E.jsxs("p",{children:[E.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),E.jsxs("section",{children:[E.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),E.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[E.jsxs("p",{children:[E.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),E.jsxs("p",{children:[E.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),E.jsxs("p",{children:[E.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),E.jsxs("section",{children:[E.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),E.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[E.jsxs("p",{children:[E.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),E.jsxs("p",{children:[E.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),E.jsxs("p",{children:[E.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),E.jsxs("section",{children:[E.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),E.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[E.jsxs("li",{children:["Gebruik de ",E.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),E.jsxs("li",{children:["Check de ",E.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),E.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),E.jsxs("li",{children:["Markeer succesvolle plekken als ",E.jsx("strong",{children:"favoriet"})]})]})]})]})}const HK=gl([5.1214,52.0907]),XK=8;function qK(){const n=Qs(r=>r.map),e=qo(r=>r.setLayerVisibility),t=Wi(r=>r.stopTracking),i=()=>{t(),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Labels Overlay",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:HK,zoom:XK,rotation:0,duration:500})};return E.jsx(Je.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:E.jsx(nK,{size:18,className:"text-gray-600"})})}const YK={Map:gy,Fish:Sr,Anchor:pM,Layers:pm,Star:pw},ZK={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},QK={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function JK(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=OU(),[r,s]=J.useState(!1),[o,l]=J.useState(null),[u,h]=J.useState(!1),[f,p]=J.useState(""),y=S=>{e(S),s(!1)},x=(S,T)=>{S.stopPropagation();const{useLayerStore:P}=require("../../store"),M=P.getState().visible,k=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(O=>M[O]);t(T,{layers:k}),l(T),setTimeout(()=>l(null),2e3)},I=()=>{f.trim()&&(i(f.trim()),p(""),h(!1))};return E.jsxs(E.Fragment,{children:[E.jsx(Je.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?E.jsx(I$,{size:20,className:"text-blue-600"}):E.jsx(pm,{size:20,className:"text-gray-600"})}),E.jsx(qs,{children:r&&E.jsxs(E.Fragment,{children:[E.jsx(Je.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),E.jsxs(Je.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[E.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:E.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),E.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(S=>{const T=YK[S.icon]||pm,P=ZK[S.icon]||"text-blue-600",M=QK[S.icon]||"hover:bg-blue-50",k=o===S.id;return E.jsxs("button",{onClick:()=>y(S.id),className:`w-full h-9 flex items-center gap-2 px-2 ${M} rounded text-left transition-colors border-0 outline-none bg-transparent ${k?"bg-green-50":""}`,children:[E.jsx(T,{size:16,className:`${P} flex-shrink-0`}),E.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:S.name}),k?E.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:E.jsx(gw,{size:14,className:"text-green-500"})}):E.jsx("span",{onClick:O=>x(O,S.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:E.jsx(oK,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},S.id)})}),E.jsx("div",{className:"border-t border-gray-200 p-2",children:u?E.jsxs("div",{className:"flex gap-1",children:[E.jsx("input",{type:"text",value:f,onChange:S=>p(S.target.value),onKeyDown:S=>{S.key==="Enter"&&I(),S.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400"}),E.jsx("button",{onClick:I,disabled:!f.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):E.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",children:[E.jsx(eK,{size:14}),E.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const EA={lat:52.1326,lng:5.2913};function eH({size:n=18,className:e=""}){return E.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[E.jsx("path",{d:"M3 12h18"}),E.jsx("path",{d:"M21 12c-1.5 0-3-1-3-3s1.5-3 3-3"}),E.jsx("path",{d:"M21 12c-1.5 0-3 1-3 3s1.5 3 3 3"}),E.jsx("circle",{cx:"4",cy:"12",r:"1.5",fill:"currentColor"}),E.jsx("path",{d:"M8 12l2-3"}),E.jsx("path",{d:"M8 12l2 3"}),E.jsx("path",{d:"M12 12l2-3"}),E.jsx("path",{d:"M12 12l2 3"}),E.jsx("path",{d:"M16 12l1.5-2"}),E.jsx("path",{d:"M16 12l1.5 2"})]})}function TA({count:n,size:e=16,className:t=""}){return E.jsx("div",{className:"flex items-center -space-x-1",children:Array.from({length:n}).map((i,r)=>E.jsx(Sr,{size:e,className:t,style:{opacity:1-r*.15}},r))})}function tH({data:n,onClose:e}){if(n.length===0)return null;const t=n.map(T=>T.pressure),i=Math.min(...t)-2,r=Math.max(...t)+2,s=r-i,o=300,l=120,u={top:10,right:10,bottom:25,left:35},h=o-u.left-u.right,f=l-u.top-u.bottom,p=n.map((T,P)=>{const M=u.left+P/(n.length-1)*h,k=u.top+f-(T.pressure-i)/s*f;return{x:M,y:k,time:T.time,pressure:T.pressure}}),y=p.map((T,P)=>`${P===0?"M":"L"} ${T.x} ${T.y}`).join(" "),x=new Date,I=n.findIndex(T=>new Date(T.time)>=x)||Math.floor(n.length/3),S=T=>new Date(T).getHours().toString().padStart(2,"0")+":00";return E.jsx(Je.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:E.jsxs(Je.div,{className:"bg-white rounded-xl shadow-xl p-4 max-w-sm w-full",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:T=>T.stopPropagation(),children:[E.jsxs("div",{className:"flex items-center justify-between mb-3",children:[E.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[E.jsx(x$,{size:18,className:"text-blue-500"}),"Luchtdruk (72 uur)"]}),E.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:E.jsx(eo,{size:18,className:"text-gray-500"})})]}),E.jsxs("svg",{width:o,height:l,className:"w-full",children:[[0,.25,.5,.75,1].map(T=>{const P=u.top+T*f,M=Math.round(r-T*s);return E.jsxs("g",{children:[E.jsx("line",{x1:u.left,y1:P,x2:o-u.right,y2:P,stroke:"#e5e7eb",strokeWidth:"1"}),E.jsx("text",{x:u.left-4,y:P+4,fontSize:"9",fill:"#9ca3af",textAnchor:"end",children:M})]},T)}),[0,Math.floor(n.length/3),Math.floor(2*n.length/3),n.length-1].map(T=>{if(T>=n.length)return null;const P=u.left+T/(n.length-1)*h;return E.jsx("text",{x:P,y:l-5,fontSize:"8",fill:"#9ca3af",textAnchor:"middle",children:S(n[T].time)},T)}),E.jsx("path",{d:`${p.slice(0,I+1).map((T,P)=>`${P===0?"M":"L"} ${T.x} ${T.y}`).join(" ")} L ${p[I]?.x||u.left} ${l-u.bottom} L ${u.left} ${l-u.bottom} Z`,fill:"rgba(59, 130, 246, 0.15)"}),I<p.length-1&&E.jsx("path",{d:`${p.slice(I).map((T,P)=>`${P===0?"M":"L"} ${T.x} ${T.y}`).join(" ")} L ${p[p.length-1].x} ${l-u.bottom} L ${p[I].x} ${l-u.bottom} Z`,fill:"rgba(59, 130, 246, 0.08)"}),E.jsx("path",{d:y,fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),p[I]&&E.jsxs(E.Fragment,{children:[E.jsx("line",{x1:p[I].x,y1:u.top,x2:p[I].x,y2:l-u.bottom,stroke:"#f59e0b",strokeWidth:"1",strokeDasharray:"3,3"}),E.jsx("circle",{cx:p[I].x,cy:p[I].y,r:"4",fill:"#f59e0b"}),E.jsx("text",{x:p[I].x,y:u.top-2,fontSize:"8",fill:"#f59e0b",textAnchor:"middle",children:"Nu"})]})]}),E.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Lage druk + dalend = vaak beter bijten"})]})})}function nH(){const{current:n,loading:e,fetchWeather:t,getFishingCondition:i,pressureHistory:r,getPressureTrend:s}=k2(),o=Wi(P=>P.position),l=ln(P=>P.showWeatherWidget),[u,h]=J.useState(!1),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};if(J.useEffect(()=>{const P=o||EA;t(P.lat,P.lng)},[]),J.useEffect(()=>{o&&t(o.lat,o.lng)},[o,t]),J.useEffect(()=>{const P=o||EA,M=setInterval(()=>{t(P.lat,P.lng)},600*1e3);return()=>clearInterval(M)},[o,t]),!l||!n&&!e)return null;const p=i(),y={excellent:"text-green-500",good:"text-lime-500",moderate:"text-amber-500",poor:"text-red-500"},x={excellent:"bg-green-50 border-green-200",good:"bg-lime-50 border-lime-200",moderate:"bg-amber-50 border-amber-200",poor:"bg-red-50 border-red-200"},I={excellent:"Top!",good:"Goed",moderate:"Matig",poor:"Slecht"},S=P=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(P/45)%8],T=()=>{switch(p){case"poor":return E.jsx(eH,{size:20,className:y[p]});case"moderate":return E.jsx(Sr,{size:18,className:y[p]});case"good":return E.jsx(TA,{count:2,size:16,className:y[p]});case"excellent":return E.jsx(TA,{count:3,size:16,className:y[p]})}};return E.jsxs(Je.div,{className:`fixed left-2 z-[700] bg-white/95 backdrop-blur-sm rounded-xl shadow-sm p-3 min-w-[130px] border ${x[p]}`,style:f,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[e?E.jsx("div",{className:"text-sm text-gray-500",children:"Laden..."}):n?E.jsxs("div",{className:"space-y-2",children:[E.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-100",children:[T(),E.jsx("span",{className:`text-sm font-semibold ${y[p]}`,children:I[p]})]}),E.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[E.jsx(_K,{size:16,className:"text-gray-400"}),E.jsxs("span",{children:[Math.round(n.temperature),"C"]})]}),E.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[E.jsx(AK,{size:16,className:"text-gray-400"}),E.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",S(n.windDirection)]})]}),E.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 text-sm text-gray-500 hover:text-blue-500 transition-colors w-full border-0 outline-none bg-transparent p-0",children:[E.jsx(CE,{size:16,className:"text-gray-400"}),E.jsxs("span",{children:[Math.round(n.pressure)," hPa"]}),(()=>{const P=s();return P==="rising"?E.jsx(EK,{size:14,className:"text-green-500 ml-auto"}):P==="falling"?E.jsx(wK,{size:14,className:"text-red-500 ml-auto"}):E.jsx(q$,{size:14,className:"text-gray-400 ml-auto"})})()]})]}):null,E.jsx(qs,{children:u&&r.length>0&&E.jsx(tH,{data:r,onClose:()=>h(!1)})})]})}const EM=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],iH=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],rH=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],Y0=5;function sH({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=J.useRef(null),s=J.useRef(null),o=async u=>{const h=u.target.files;if(!h||h.length===0)return;const f=Y0-n.length,p=Array.from(h).slice(0,f);for(const y of p)try{const{thumbnailBase64:x}=await wM(y),I={id:xM(),thumbnailBase64:x,createdAt:new Date().toISOString(),pendingUpload:!0};e(I)}catch(x){console.error("Failed to process image:",x)}u.target.value=""},l=n.length<Y0;return E.jsxs("div",{className:"space-y-2",children:[E.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",Y0,")"]}),E.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(u=>E.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[E.jsx("img",{src:u.thumbnailUrl||u.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&E.jsx("button",{type:"button",onClick:()=>t(u.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:E.jsx(eo,{size:12,className:"text-white"})}),u.pendingUpload&&E.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},u.id)),l&&!i&&E.jsxs(E.Fragment,{children:[E.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[E.jsx(SE,{size:20,className:"text-gray-400"}),E.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),E.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[E.jsx(L$,{size:20,className:"text-gray-400"}),E.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),E.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),E.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}function oH({onClose:n,initialLocation:e,initialLocationSource:t,initialPhotos:i=[]}){const r=b2(ne=>ne.addCatch),s=k2(ne=>ne.current),o=Wi(ne=>ne.position),[l,u]=J.useState(e||(o?{lat:o.lat,lng:o.lng}:null)),[h,f]=J.useState(t||(o?"gps":null)),[p,y]=J.useState(""),[x,I]=J.useState(""),[S,T]=J.useState(""),[P,M]=J.useState(""),[k,O]=J.useState(""),[F,G]=J.useState(""),[b,R]=J.useState(i),D=async ne=>{R(ue=>[...ue,ne])},V=ne=>{R(ue=>ue.filter(Z=>Z.id!==ne))},j=()=>{o&&(u({lat:o.lat,lng:o.lng}),f("gps"))},z=ne=>{if(ne.preventDefault(),!p||!l){alert("Selecteer een vissoort en zorg dat er een locatie is");return}r({location:l,species:p,weight:x?parseInt(x):void 0,length:S?parseInt(S):void 0,photos:b.length>0?b:void 0,method:P||"Anders",bait:k||void 0,notes:F||void 0,weather:s?{temp:s.temperature,windSpeed:s.windSpeed,windDirection:s.windDirection,pressure:s.pressure}:void 0}),n()},se=(()=>{switch(h){case"gps":return{icon:_M,label:"GPS",color:"text-blue-500"};case"photo":return{icon:SE,label:"Foto EXIF",color:"text-green-500"};case"map":return{icon:gy,label:"Kaart",color:"text-orange-500"};default:return{icon:Al,label:"Locatie",color:"text-gray-500"}}})(),ge=se.icon;return E.jsx(Je.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:E.jsxs(Je.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:ne=>ne.stopPropagation(),children:[E.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(Sr,{className:"text-white",size:24}),E.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),E.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:E.jsx(eo,{size:20})})]}),E.jsxs("form",{onSubmit:z,className:"p-4 space-y-4",children:[E.jsx("div",{className:"space-y-2",children:l?E.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-gray-50 p-2 rounded-lg",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(ge,{size:16,className:se.color}),E.jsxs("span",{className:"text-gray-600",children:[l.lat.toFixed(5),", ",l.lng.toFixed(5)]})]}),E.jsx("span",{className:`text-xs ${se.color} font-medium`,children:se.label})]}):E.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-red-50 p-2 rounded-lg text-red-600",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(Al,{size:16}),E.jsx("span",{children:"Geen locatie"})]}),o&&E.jsx("button",{type:"button",onClick:j,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded-md border-0 outline-none",children:"Gebruik GPS"})]})}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vissoort *"}),E.jsxs("select",{value:p,onChange:ne=>y(ne.target.value),className:"form-select",required:!0,children:[E.jsx("option",{value:"",children:"Selecteer vissoort..."}),EM.map(ne=>E.jsx("option",{value:ne.name,children:ne.name},ne.name))]})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{children:[E.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[E.jsx(lK,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),E.jsx("input",{type:"number",value:x,onChange:ne=>I(ne.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),E.jsxs("div",{children:[E.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[E.jsx(rK,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),E.jsx("input",{type:"number",value:S,onChange:ne=>T(ne.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),E.jsxs("select",{value:P,onChange:ne=>M(ne.target.value),className:"form-select",children:[E.jsx("option",{value:"",children:"Selecteer methode..."}),iH.map(ne=>E.jsx("option",{value:ne,children:ne},ne))]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),E.jsxs("select",{value:k,onChange:ne=>O(ne.target.value),className:"form-select",children:[E.jsx("option",{value:"",children:"Selecteer aas..."}),rH.map(ne=>E.jsx("option",{value:ne,children:ne},ne))]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),E.jsx("textarea",{value:F,onChange:ne=>G(ne.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),E.jsx(sH,{photos:b,onAddPhoto:D,onRemovePhoto:V}),E.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function aH(){const n=ii(h=>h.catchFormOpen),e=ii(h=>h.catchFormLocation),t=ii(h=>h.catchFormLocationSource),i=ii(h=>h.catchFormInitialPhotos),r=ii(h=>h.openCatchForm),s=ii(h=>h.closeCatchForm),o=Wi(h=>h.position),l=ln(h=>h.showCatchButton),u=()=>{o?r({location:{lat:o.lat,lng:o.lng},locationSource:"gps"}):r()};return E.jsxs(E.Fragment,{children:[l&&E.jsx(Je.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:u,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:E.jsx(Sr,{size:22,strokeWidth:2})}),E.jsx(qs,{children:n&&E.jsx(oH,{onClose:s,initialLocation:e||void 0,initialLocationSource:t||void 0,initialPhotos:i})})]})}function lH(){const n=Qs(r=>r.map),e=b2(r=>r.catches),t=J.useRef(null),i=J.useRef(null);return J.useEffect(()=>{if(n)return i.current=new vx,t.current=new Ax({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),J.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=gl([r.location.lng,r.location.lat]),o=new ou({geometry:new pl(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new Yi({image:new kl({radius:14,fill:new Tr({color:"#22c55e"}),stroke:new bu({color:"#fff",width:2})}),text:new ef({text:l,font:"bold 12px sans-serif",fill:new Tr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function cH(){const n=Qs(r=>r.map),e=D2(r=>r.spots),t=J.useRef(null),i=J.useRef(null);return J.useEffect(()=>{if(n)return i.current=new vx,t.current=new Ax({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),J.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=gl([r.location.lng,r.location.lat]),o=new ou({geometry:new pl(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new Yi({image:new kl({radius:12,fill:new Tr({color:l}),stroke:new bu({color:"#fff",width:2})}),text:new ef({text:"",font:"bold 14px sans-serif",fill:new Tr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function uH({onClose:n,initialLocation:e}){const t=D2(T=>T.addSpot),[i,r]=J.useState(""),[s,o]=J.useState(""),[l,u]=J.useState([]),[h,f]=J.useState(""),[p,y]=J.useState(3),x=e,I=T=>{u(P=>P.includes(T)?P.filter(M=>M!==T):[...P,T])},S=T=>{if(T.preventDefault(),!i||!x){alert("Geef een naam op voor deze locatie");return}t({name:i,location:x,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:p}),n()};return E.jsx(Je.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:E.jsxs(Je.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:T=>T.stopPropagation(),children:[E.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(pw,{className:"text-white",size:24}),E.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),E.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:E.jsx(eo,{size:20})})]}),E.jsxs("form",{onSubmit:S,className:"p-4 space-y-4",children:[x&&E.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[E.jsx(Al,{size:16}),E.jsxs("span",{children:[x.lat.toFixed(5),", ",x.lng.toFixed(5)]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),E.jsx("input",{type:"text",value:i,onChange:T=>r(T.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),E.jsx("input",{type:"text",value:s,onChange:T=>o(T.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),E.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(T=>E.jsx("button",{type:"button",onClick:()=>y(T),className:"p-1 border-0 outline-none bg-transparent",children:E.jsx(pw,{size:28,className:T<=p?"text-yellow-400 fill-yellow-400":"text-gray-300"})},T))})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),E.jsx("div",{className:"flex flex-wrap gap-2",children:EM.slice(0,12).map(T=>E.jsx("button",{type:"button",onClick:()=>I(T.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(T.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:T.name},T.name))})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),E.jsx("textarea",{value:h,onChange:T=>f(T.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),E.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const hH=[{name:"Aanlegsteigers",icon:pM,color:"#2196F3"},{name:"Boothellingen",icon:fK,color:"#4CAF50"},{name:"Dieptekaart",icon:CK,color:"#00BCD4"},{name:"Viswater",icon:Al,color:"#9C27B0"}],IA=[{name:"OpenStreetMap",label:"Kaart"},{name:"Luchtfoto",label:"Satelliet"}];function dH(){const[n,e]=J.useState(!1),t=qo(l=>l.visible),i=qo(l=>l.toggleLayer),r=qo(l=>l.setLayerVisibility),s=l=>{IA.forEach(u=>{r(u.name,u.name===l)}),l==="Luchtfoto"?r("Labels Overlay",!0):r("Labels Overlay",!1)},o=()=>{r("Labels Overlay",!t["Labels Overlay"])};return E.jsxs("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:[E.jsx(Je.button,{className:"w-11 h-11 bg-white/90 hover:bg-white backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:E.jsx(pm,{size:22})}),E.jsx(qs,{children:n&&E.jsxs(E.Fragment,{children:[E.jsx(Je.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),E.jsxs(Je.div,{className:"absolute bottom-12 right-0 bg-white rounded-xl shadow-lg overflow-hidden min-w-[200px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},children:[E.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:E.jsx("span",{className:"font-medium text-white text-sm",children:"Kaartlagen"})}),E.jsxs("div",{className:"p-2",children:[E.jsxs("div",{className:"mb-2 pb-2 border-b border-gray-100",children:[E.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Achtergrond"}),E.jsx("div",{className:"flex gap-1",children:IA.map(l=>E.jsx("button",{className:`flex-1 px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t[l.name]?"bg-blue-500 text-white":"bg-transparent text-gray-600 hover:bg-blue-50"}`,onClick:()=>s(l.name),children:l.label},l.name))}),t.Luchtfoto&&E.jsxs("button",{onClick:o,className:`mt-1.5 w-full flex items-center justify-between px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t["Labels Overlay"]?"bg-blue-50 text-blue-600":"bg-transparent text-gray-500 hover:bg-blue-50"}`,children:[E.jsxs("span",{className:"flex items-center gap-1.5",children:[E.jsx(mK,{size:12}),"Labels overlay"]}),t["Labels Overlay"]&&E.jsx(gw,{size:12})]})]}),E.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Kaartlagen"}),E.jsx("div",{className:"space-y-0.5",children:hH.map(l=>{const u=l.icon,h=t[l.name];return E.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-colors border-0 outline-none ${h?"bg-blue-50":"bg-transparent hover:bg-blue-50"}`,onClick:()=>i(l.name),children:[E.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center transition-colors",style:{backgroundColor:h?l.color:"#e5e7eb"},children:E.jsx(u,{size:14,className:"text-white"})}),E.jsx("span",{className:`text-sm ${h?"text-blue-700":"text-gray-600"}`,children:l.name}),E.jsx("div",{className:"ml-auto",children:E.jsx("div",{className:"w-4 h-4 rounded flex items-center justify-center transition-all",style:{backgroundColor:h?"#3b82f6":"transparent",border:h?"2px solid #3b82f6":"2px solid #93c5fd"},children:h&&E.jsx(gw,{size:10,className:"text-white",strokeWidth:3})})})]},l.name)})})]})]})]})})]})}function fH(){const n=ii(y=>y.settingsPanelOpen),e=ii(y=>y.toggleSettingsPanel),t=ln(y=>y.showCatchButton),i=ln(y=>y.setShowCatchButton),r=ln(y=>y.showCatches),s=ln(y=>y.setShowCatches),o=ln(y=>y.showFavoriteSpots),l=ln(y=>y.setShowFavoriteSpots),u=ln(y=>y.defaultBackground),h=ln(y=>y.setDefaultBackground),f=ln(y=>y.showWeatherWidget),p=ln(y=>y.setShowWeatherWidget);return n?E.jsx(Je.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:E.jsxs(Je.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:y=>y.stopPropagation(),children:[E.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[E.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),E.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:E.jsx(eo,{size:20,className:"text-white"})})]}),E.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[E.jsxs("div",{className:"space-y-3",children:[E.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),E.jsx(Jg,{icon:E.jsx(Sr,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),E.jsx(Jg,{icon:E.jsx(Sr,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),E.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[E.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),E.jsx(Jg,{icon:E.jsx(Al,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),E.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[E.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:E.jsx(gy,{size:18,className:"text-gray-500"})}),E.jsxs("div",{className:"flex-1",children:[E.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),E.jsxs("select",{value:u,onChange:y=>h(y.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-400",children:[E.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),E.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),E.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[E.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weer"}),E.jsx(Jg,{icon:E.jsx(CE,{size:18,className:"text-blue-400"}),label:"Weer widget",description:"Toon temperatuur, wind en luchtdruk",checked:f,onChange:p})]})]}),E.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function Jg({icon:n,label:e,description:t,checked:i,onChange:r}){return E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),E.jsxs("div",{className:"flex-1",children:[E.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),E.jsx("p",{className:"text-xs text-gray-400",children:t})]}),E.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-blue-500":"bg-gray-300"}`,children:E.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function gH({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=fM(),[l,u]=J.useState(""),[h,f]=J.useState(!1),[p,y]=J.useState(!1),[x,I]=J.useState(null);if(J.useEffect(()=>{o()},[o]),s)return E.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center",children:E.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return E.jsx(E.Fragment,{children:n});const S=P=>{P.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},T=async()=>{try{I(null),await i()}catch{I("Google login mislukt"),setTimeout(()=>I(null),3e3)}};return E.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center p-4",children:E.jsxs(Je.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[E.jsxs("div",{className:"flex flex-col items-center mb-6",children:[E.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:E.jsx(Sr,{size:40,className:"text-white"})}),E.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),E.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),E.jsxs(Je.button,{onClick:T,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[E.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[E.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),E.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),E.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),E.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),x&&E.jsx(Je.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:x}),E.jsxs("div",{className:"flex items-center gap-3 my-4",children:[E.jsx("div",{className:"flex-1 h-px bg-gray-200"}),E.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),E.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),E.jsxs("form",{onSubmit:S,className:"space-y-4",children:[E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:E.jsx(z$,{size:20})}),E.jsx("input",{type:p?"text":"password",value:l,onChange:P=>u(P.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-blue-400"}`}),E.jsx("button",{type:"button",onClick:()=>y(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p?E.jsx(A$,{size:20}):E.jsx(b$,{size:20})})]}),h&&E.jsx(Je.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),E.jsx(Je.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),E.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function pH(){const n=ii(i=>i.spotFormOpen),e=ii(i=>i.spotFormLocation),t=ii(i=>i.closeSpotForm);return E.jsx(gH,{children:E.jsxs("div",{className:"h-screen w-screen overflow-hidden",children:[E.jsx(u$,{}),E.jsx(jK,{}),E.jsx(lH,{}),E.jsx(cH,{}),E.jsx(LK,{}),E.jsx(nH,{}),E.jsx(UK,{}),E.jsx(BK,{}),E.jsx(JK,{}),E.jsx(qK,{}),E.jsx(dH,{}),E.jsx(aH,{}),E.jsx(FK,{}),E.jsx(GK,{}),E.jsx(fH,{}),E.jsx(qs,{children:n&&E.jsx(uH,{onClose:t,initialLocation:e||void 0})})]})})}const mH="1.2.3";console.log(`%c VisApp v${mH}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");VN.createRoot(document.getElementById("root")).render(E.jsx(pH,{}));export{PH as $,Sb as A,Rt as B,kl as C,nt as D,ze as E,Tr as F,f4 as G,Sm as H,w3 as I,fl as J,Eb as K,Ib as L,TH as M,Dp as N,w4 as O,SH as P,Cb as Q,Hc as R,Yi as S,y6 as T,pl as U,vx as V,ib as W,wH as X,xH as Y,IH as Z,bH as _,Ax as a,ES as a0,u5 as a1,h5 as a2,AH as a3,RH as a4,Cd as a5,CH as a6,EH as a7,dr as a8,ou as a9,tt as aa,ip as ab,kp as ac,Bb as ad,Sv as ae,su as af,g4 as ag,bu as b,Bn as c,DH as d,Zi as e,ai as f,dt as g,oC as h,Jw as i,Yj as j,I0 as k,lx as l,ol as m,Qw as n,nb as o,xb as p,Tb as q,vH as r,_4 as s,Dm as t,IS as u,$c as v,TS as w,v4 as x,hx as y,ux as z};
//# sourceMappingURL=index-CDAJtRd0.js.map
