{"version":3,"file":"viswaterOL-C3fAJYv4.js","sources":["../../src/layers/viswaterOL.ts"],"sourcesContent":["import VectorLayer from 'ol/layer/Vector'\nimport VectorSource from 'ol/source/Vector'\nimport GeoJSON from 'ol/format/GeoJSON'\nimport { Style, Fill, Stroke } from 'ol/style'\n\n// Overpass API query for water bodies with fishing allowed\nconst OVERPASS_QUERY = `\n[out:json][timeout:90];\narea[\"name\"=\"Nederland\"]->.nl;\n(\n  way[\"natural\"=\"water\"][\"fishing\"=\"yes\"](area.nl);\n  relation[\"natural\"=\"water\"][\"fishing\"=\"yes\"](area.nl);\n  way[\"water\"=\"lake\"][\"fishing\"=\"yes\"](area.nl);\n  way[\"water\"=\"pond\"][\"fishing\"=\"yes\"](area.nl);\n);\nout geom;\n`\n\nexport async function createViswaterLayer(): Promise<VectorLayer<VectorSource>> {\n  const source = new VectorSource()\n\n  const layer = new VectorLayer({\n    source,\n    style: new Style({\n      fill: new Fill({\n        color: 'rgba(33, 150, 243, 0.2)'\n      }),\n      stroke: new Stroke({\n        color: '#2196F3',\n        width: 2\n      })\n    }),\n    properties: {\n      title: 'Viswater',\n      name: 'Viswater'\n    }\n  })\n\n  try {\n    const response = await fetch('https://overpass-api.de/api/interpreter', {\n      method: 'POST',\n      body: `data=${encodeURIComponent(OVERPASS_QUERY)}`\n    })\n\n    const data = await response.json()\n\n    // Convert Overpass response to GeoJSON\n    const features: any[] = []\n\n    data.elements.forEach((el: any) => {\n      if (el.type === 'way' && el.geometry) {\n        const tags = el.tags || {}\n        features.push({\n          type: 'Feature',\n          geometry: {\n            type: 'Polygon',\n            coordinates: [el.geometry.map((p: any) => [p.lon, p.lat])]\n          },\n          properties: {\n            layerType: 'viswater',\n            id: el.id,\n            name: tags.name || null,\n            fishing: tags.fishing,\n            access: tags.access,\n            operator: tags.operator || null\n          }\n        })\n      }\n    })\n\n    const geojson = {\n      type: 'FeatureCollection',\n      features\n    }\n\n    source.addFeatures(\n      new GeoJSON().readFeatures(geojson, {\n        featureProjection: 'EPSG:3857'\n      })\n    )\n\n    console.log(`Loaded ${features.length} viswateren`)\n  } catch (error) {\n    console.error('Failed to load viswater:', error)\n  }\n\n  return layer\n}\n"],"names":["OVERPASS_QUERY","createViswaterLayer","source","VectorSource","layer","VectorLayer","Style","Fill","Stroke","data","features","el","tags","p","geojson","GeoJSON","error"],"mappings":"8GAMA,MAAMA,EAAiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYvB,eAAsBC,GAA0D,CAC9E,MAAMC,EAAS,IAAIC,EAEbC,EAAQ,IAAIC,EAAY,CAC5B,OAAAH,EACA,MAAO,IAAII,EAAM,CACf,KAAM,IAAIC,EAAK,CACb,MAAO,yBAAA,CACR,EACD,OAAQ,IAAIC,EAAO,CACjB,MAAO,UACP,MAAO,CAAA,CACR,CAAA,CACF,EACD,WAAY,CACV,MAAO,WACP,KAAM,UAAA,CACR,CACD,EAED,GAAI,CAMF,MAAMC,EAAO,MALI,MAAM,MAAM,0CAA2C,CACtE,OAAQ,OACR,KAAM,QAAQ,mBAAmBT,CAAc,CAAC,EAAA,CACjD,GAE2B,KAAA,EAGtBU,EAAkB,CAAA,EAExBD,EAAK,SAAS,QAASE,GAAY,CACjC,GAAIA,EAAG,OAAS,OAASA,EAAG,SAAU,CACpC,MAAMC,EAAOD,EAAG,MAAQ,CAAA,EACxBD,EAAS,KAAK,CACZ,KAAM,UACN,SAAU,CACR,KAAM,UACN,YAAa,CAACC,EAAG,SAAS,IAAKE,GAAW,CAACA,EAAE,IAAKA,EAAE,GAAG,CAAC,CAAC,CAAA,EAE3D,WAAY,CACV,UAAW,WACX,GAAIF,EAAG,GACP,KAAMC,EAAK,MAAQ,KACnB,QAASA,EAAK,QACd,OAAQA,EAAK,OACb,SAAUA,EAAK,UAAY,IAAA,CAC7B,CACD,CACH,CACF,CAAC,EAED,MAAME,EAAU,CACd,KAAM,oBACN,SAAAJ,CAAA,EAGFR,EAAO,YACL,IAAIa,EAAA,EAAU,aAAaD,EAAS,CAClC,kBAAmB,WAAA,CACpB,CAAA,EAGH,QAAQ,IAAI,UAAUJ,EAAS,MAAM,aAAa,CACpD,OAASM,EAAO,CACd,QAAQ,MAAM,2BAA4BA,CAAK,CACjD,CAEA,OAAOZ,CACT"}