const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-Dx_GckPt.js","assets/GeoJSON-CkMfDwot.js","assets/iconStyles-CdZHp9tK.js","assets/boothellingenOL-CRSWdRTy.js","assets/viswaterOL-Bdb4e-gK.js","assets/hillshadeLayers-CuEfjC5N.js","assets/common-DpNHzTjJ.js","assets/pdokWaterOL-CFIJPpXz.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function kx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Z0={exports:{}},bh={},Q0={exports:{}},Ke={};var JT;function nL(){if(JT)return Ke;JT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function _(W){return W===null||typeof W!="object"?null:(W=p&&W[p]||W["@@iterator"],typeof W=="function"?W:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,I={};function T(W,$,oe){this.props=W,this.context=$,this.refs=I,this.updater=oe||x}T.prototype.isReactComponent={},T.prototype.setState=function(W,$){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,$,"setState")},T.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function b(){}b.prototype=T.prototype;function N(W,$,oe){this.props=W,this.context=$,this.refs=I,this.updater=oe||x}var M=N.prototype=new b;M.constructor=N,S(M,T.prototype),M.isPureReactComponent=!0;var L=Array.isArray,O=Object.prototype.hasOwnProperty,U={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function C(W,$,oe){var me,xe={},re=null,_e=null;if($!=null)for(me in $.ref!==void 0&&(_e=$.ref),$.key!==void 0&&(re=""+$.key),$)O.call($,me)&&!P.hasOwnProperty(me)&&(xe[me]=$[me]);var we=arguments.length-2;if(we===1)xe.children=oe;else if(1<we){for(var Ce=Array(we),Be=0;Be<we;Be++)Ce[Be]=arguments[Be+2];xe.children=Ce}if(W&&W.defaultProps)for(me in we=W.defaultProps,we)xe[me]===void 0&&(xe[me]=we[me]);return{$$typeof:n,type:W,key:re,ref:_e,props:xe,_owner:U.current}}function D(W,$){return{$$typeof:n,type:W.type,key:$,ref:W.ref,props:W.props,_owner:W._owner}}function F(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function V(W){var $={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(oe){return $[oe]})}var B=/\/+/g;function k(W,$){return typeof W=="object"&&W!==null&&W.key!=null?V(""+W.key):$.toString(36)}function te(W,$,oe,me,xe){var re=typeof W;(re==="undefined"||re==="boolean")&&(W=null);var _e=!1;if(W===null)_e=!0;else switch(re){case"string":case"number":_e=!0;break;case"object":switch(W.$$typeof){case n:case e:_e=!0}}if(_e)return _e=W,xe=xe(_e),W=me===""?"."+k(_e,0):me,L(xe)?(oe="",W!=null&&(oe=W.replace(B,"$&/")+"/"),te(xe,$,oe,"",function(Be){return Be})):xe!=null&&(F(xe)&&(xe=D(xe,oe+(!xe.key||_e&&_e.key===xe.key?"":(""+xe.key).replace(B,"$&/")+"/")+W)),$.push(xe)),1;if(_e=0,me=me===""?".":me+":",L(W))for(var we=0;we<W.length;we++){re=W[we];var Ce=me+k(re,we);_e+=te(re,$,oe,Ce,xe)}else if(Ce=_(W),typeof Ce=="function")for(W=Ce.call(W),we=0;!(re=W.next()).done;)re=re.value,Ce=me+k(re,we++),_e+=te(re,$,oe,Ce,xe);else if(re==="object")throw $=String(W),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return _e}function de(W,$,oe){if(W==null)return W;var me=[],xe=0;return te(W,me,"","",function(re){return $.call(oe,re,xe++)}),me}function ge(W){if(W._status===-1){var $=W._result;$=$(),$.then(function(oe){(W._status===0||W._status===-1)&&(W._status=1,W._result=oe)},function(oe){(W._status===0||W._status===-1)&&(W._status=2,W._result=oe)}),W._status===-1&&(W._status=0,W._result=$)}if(W._status===1)return W._result.default;throw W._result}var ue={current:null},G={transition:null},ie={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:G,ReactCurrentOwner:U};function ne(){throw Error("act(...) is not supported in production builds of React.")}return Ke.Children={map:de,forEach:function(W,$,oe){de(W,function(){$.apply(this,arguments)},oe)},count:function(W){var $=0;return de(W,function(){$++}),$},toArray:function(W){return de(W,function($){return $})||[]},only:function(W){if(!F(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Ke.Component=T,Ke.Fragment=t,Ke.Profiler=r,Ke.PureComponent=N,Ke.StrictMode=i,Ke.Suspense=u,Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ie,Ke.act=ne,Ke.cloneElement=function(W,$,oe){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var me=S({},W.props),xe=W.key,re=W.ref,_e=W._owner;if($!=null){if($.ref!==void 0&&(re=$.ref,_e=U.current),$.key!==void 0&&(xe=""+$.key),W.type&&W.type.defaultProps)var we=W.type.defaultProps;for(Ce in $)O.call($,Ce)&&!P.hasOwnProperty(Ce)&&(me[Ce]=$[Ce]===void 0&&we!==void 0?we[Ce]:$[Ce])}var Ce=arguments.length-2;if(Ce===1)me.children=oe;else if(1<Ce){we=Array(Ce);for(var Be=0;Be<Ce;Be++)we[Be]=arguments[Be+2];me.children=we}return{$$typeof:n,type:W.type,key:xe,ref:re,props:me,_owner:_e}},Ke.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:s,_context:W},W.Consumer=W},Ke.createElement=C,Ke.createFactory=function(W){var $=C.bind(null,W);return $.type=W,$},Ke.createRef=function(){return{current:null}},Ke.forwardRef=function(W){return{$$typeof:l,render:W}},Ke.isValidElement=F,Ke.lazy=function(W){return{$$typeof:f,_payload:{_status:-1,_result:W},_init:ge}},Ke.memo=function(W,$){return{$$typeof:h,type:W,compare:$===void 0?null:$}},Ke.startTransition=function(W){var $=G.transition;G.transition={};try{W()}finally{G.transition=$}},Ke.unstable_act=ne,Ke.useCallback=function(W,$){return ue.current.useCallback(W,$)},Ke.useContext=function(W){return ue.current.useContext(W)},Ke.useDebugValue=function(){},Ke.useDeferredValue=function(W){return ue.current.useDeferredValue(W)},Ke.useEffect=function(W,$){return ue.current.useEffect(W,$)},Ke.useId=function(){return ue.current.useId()},Ke.useImperativeHandle=function(W,$,oe){return ue.current.useImperativeHandle(W,$,oe)},Ke.useInsertionEffect=function(W,$){return ue.current.useInsertionEffect(W,$)},Ke.useLayoutEffect=function(W,$){return ue.current.useLayoutEffect(W,$)},Ke.useMemo=function(W,$){return ue.current.useMemo(W,$)},Ke.useReducer=function(W,$,oe){return ue.current.useReducer(W,$,oe)},Ke.useRef=function(W){return ue.current.useRef(W)},Ke.useState=function(W){return ue.current.useState(W)},Ke.useSyncExternalStore=function(W,$,oe){return ue.current.useSyncExternalStore(W,$,oe)},Ke.useTransition=function(){return ue.current.useTransition()},Ke.version="18.3.1",Ke}var eS;function ef(){return eS||(eS=1,Q0.exports=nL()),Q0.exports}var tS;function iL(){if(tS)return bh;tS=1;var n=ef(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var f,p={},_=null,x=null;h!==void 0&&(_=""+h),u.key!==void 0&&(_=""+u.key),u.ref!==void 0&&(x=u.ref);for(f in u)i.call(u,f)&&!s.hasOwnProperty(f)&&(p[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)p[f]===void 0&&(p[f]=u[f]);return{$$typeof:e,type:l,key:_,ref:x,props:p,_owner:r.current}}return bh.Fragment=t,bh.jsx=o,bh.jsxs=o,bh}var nS;function rL(){return nS||(nS=1,Z0.exports=iL()),Z0.exports}var y=rL(),Og={},J0={exports:{}},ni={},e_={exports:{}},t_={};var iS;function sL(){return iS||(iS=1,(function(n){function e(G,ie){var ne=G.length;G.push(ie);e:for(;0<ne;){var W=ne-1>>>1,$=G[W];if(0<r($,ie))G[W]=ie,G[ne]=$,ne=W;else break e}}function t(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var ie=G[0],ne=G.pop();if(ne!==ie){G[0]=ne;e:for(var W=0,$=G.length,oe=$>>>1;W<oe;){var me=2*(W+1)-1,xe=G[me],re=me+1,_e=G[re];if(0>r(xe,ne))re<$&&0>r(_e,xe)?(G[W]=_e,G[re]=ne,W=re):(G[W]=xe,G[me]=ne,W=me);else if(re<$&&0>r(_e,ne))G[W]=_e,G[re]=ne,W=re;else break e}}return ie}function r(G,ie){var ne=G.sortIndex-ie.sortIndex;return ne!==0?ne:G.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,p=null,_=3,x=!1,S=!1,I=!1,T=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(G){for(var ie=t(h);ie!==null;){if(ie.callback===null)i(h);else if(ie.startTime<=G)i(h),ie.sortIndex=ie.expirationTime,e(u,ie);else break;ie=t(h)}}function L(G){if(I=!1,M(G),!S)if(t(u)!==null)S=!0,ge(O);else{var ie=t(h);ie!==null&&ue(L,ie.startTime-G)}}function O(G,ie){S=!1,I&&(I=!1,b(C),C=-1),x=!0;var ne=_;try{for(M(ie),p=t(u);p!==null&&(!(p.expirationTime>ie)||G&&!V());){var W=p.callback;if(typeof W=="function"){p.callback=null,_=p.priorityLevel;var $=W(p.expirationTime<=ie);ie=n.unstable_now(),typeof $=="function"?p.callback=$:p===t(u)&&i(u),M(ie)}else i(u);p=t(u)}if(p!==null)var oe=!0;else{var me=t(h);me!==null&&ue(L,me.startTime-ie),oe=!1}return oe}finally{p=null,_=ne,x=!1}}var U=!1,P=null,C=-1,D=5,F=-1;function V(){return!(n.unstable_now()-F<D)}function B(){if(P!==null){var G=n.unstable_now();F=G;var ie=!0;try{ie=P(!0,G)}finally{ie?k():(U=!1,P=null)}}else U=!1}var k;if(typeof N=="function")k=function(){N(B)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,de=te.port2;te.port1.onmessage=B,k=function(){de.postMessage(null)}}else k=function(){T(B,0)};function ge(G){P=G,U||(U=!0,k())}function ue(G,ie){C=T(function(){G(n.unstable_now())},ie)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_continueExecution=function(){S||x||(S=!0,ge(O))},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(G){switch(_){case 1:case 2:case 3:var ie=3;break;default:ie=_}var ne=_;_=ie;try{return G()}finally{_=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(G,ie){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ne=_;_=G;try{return ie()}finally{_=ne}},n.unstable_scheduleCallback=function(G,ie,ne){var W=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?W+ne:W):ne=W,G){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,G={id:f++,callback:ie,priorityLevel:G,startTime:ne,expirationTime:$,sortIndex:-1},ne>W?(G.sortIndex=ne,e(h,G),t(u)===null&&G===t(h)&&(I?(b(C),C=-1):I=!0,ue(L,ne-W))):(G.sortIndex=$,e(u,G),S||x||(S=!0,ge(O))),G},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(G){var ie=_;return function(){var ne=_;_=ie;try{return G.apply(this,arguments)}finally{_=ne}}}})(t_)),t_}var rS;function oL(){return rS||(rS=1,e_.exports=sL()),e_.exports}var sS;function aL(){if(sS)return ni;sS=1;var n=ef(),e=oL();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)i.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function _(a){return u.call(p,a)?!0:u.call(f,a)?!1:h.test(a)?p[a]=!0:(f[a]=!0,!1)}function x(a,c,d,m){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return m?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function S(a,c,d,m){if(c===null||typeof c>"u"||x(a,c,d,m))return!0;if(m)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function I(a,c,d,m,v,w,A){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=w,this.removeEmptyString=A}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){T[a]=new I(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];T[c]=new I(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){T[a]=new I(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){T[a]=new I(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){T[a]=new I(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){T[a]=new I(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){T[a]=new I(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){T[a]=new I(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){T[a]=new I(a,5,!1,a.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function N(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(b,N);T[c]=new I(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(b,N);T[c]=new I(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(b,N);T[c]=new I(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){T[a]=new I(a,1,!1,a.toLowerCase(),null,!1,!1)}),T.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){T[a]=new I(a,1,!1,a.toLowerCase(),null,!0,!0)});function M(a,c,d,m){var v=T.hasOwnProperty(c)?T[c]:null;(v!==null?v.type!==0:m||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(S(c,d,v,m)&&(d=null),m||v===null?_(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):v.mustUseProperty?a[v.propertyName]=d===null?v.type===3?!1:"":d:(c=v.attributeName,m=v.attributeNamespace,d===null?a.removeAttribute(c):(v=v.type,d=v===3||v===4&&d===!0?"":""+d,m?a.setAttributeNS(m,c,d):a.setAttribute(c,d))))}var L=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),U=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),V=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),de=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),G=Symbol.iterator;function ie(a){return a===null||typeof a!="object"?null:(a=G&&a[G]||a["@@iterator"],typeof a=="function"?a:null)}var ne=Object.assign,W;function $(a){if(W===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);W=c&&c[1]||""}return`
`+W+a}var oe=!1;function me(a,c){if(!a||oe)return"";oe=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(J){var m=J}Reflect.construct(a,[],c)}else{try{c.call()}catch(J){m=J}a.call(c.prototype)}else{try{throw Error()}catch(J){m=J}a()}}catch(J){if(J&&m&&typeof J.stack=="string"){for(var v=J.stack.split(`
`),w=m.stack.split(`
`),A=v.length-1,z=w.length-1;1<=A&&0<=z&&v[A]!==w[z];)z--;for(;1<=A&&0<=z;A--,z--)if(v[A]!==w[z]){if(A!==1||z!==1)do if(A--,z--,0>z||v[A]!==w[z]){var H=`
`+v[A].replace(" at new "," at ");return a.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",a.displayName)),H}while(1<=A&&0<=z);break}}}finally{oe=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?$(a):""}function xe(a){switch(a.tag){case 5:return $(a.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return a=me(a.type,!1),a;case 11:return a=me(a.type.render,!1),a;case 1:return a=me(a.type,!0),a;default:return""}}function re(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case P:return"Fragment";case U:return"Portal";case D:return"Profiler";case C:return"StrictMode";case k:return"Suspense";case te:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case V:return(a.displayName||"Context")+".Consumer";case F:return(a._context.displayName||"Context")+".Provider";case B:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case de:return c=a.displayName||null,c!==null?c:re(a.type)||"Memo";case ge:c=a._payload,a=a._init;try{return re(a(c))}catch{}}return null}function _e(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return re(c);case 8:return c===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function we(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ce(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Be(a){var c=Ce(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),m=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,w=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return v.call(this)},set:function(A){m=""+A,w.call(this,A)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(A){m=""+A},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function Wt(a){a._valueTracker||(a._valueTracker=Be(a))}function Un(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),m="";return a&&(m=Ce(a)?a.checked?"true":"false":a.value),a=m,a!==d?(c.setValue(a),!0):!1}function Yt(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function bn(a,c){var d=c.checked;return ne({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function fn(a,c){var d=c.defaultValue==null?"":c.defaultValue,m=c.checked!=null?c.checked:c.defaultChecked;d=we(c.value!=null?c.value:d),a._wrapperState={initialChecked:m,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function gn(a,c){c=c.checked,c!=null&&M(a,"checked",c,!1)}function Yn(a,c){gn(a,c);var d=we(c.value),m=c.type;if(d!=null)m==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(m==="submit"||m==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?_t(a,c.type,d):c.hasOwnProperty("defaultValue")&&_t(a,c.type,we(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Ni(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var m=c.type;if(!(m!=="submit"&&m!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function _t(a,c,d){(c!=="number"||Yt(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ut=Array.isArray;function sn(a,c,d,m){if(a=a.options,c){c={};for(var v=0;v<d.length;v++)c["$"+d[v]]=!0;for(d=0;d<a.length;d++)v=c.hasOwnProperty("$"+a[d].value),a[d].selected!==v&&(a[d].selected=v),v&&m&&(a[d].defaultSelected=!0)}else{for(d=""+we(d),c=null,v=0;v<a.length;v++){if(a[v].value===d){a[v].selected=!0,m&&(a[v].defaultSelected=!0);return}c!==null||a[v].disabled||(c=a[v])}c!==null&&(c.selected=!0)}}function Di(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function It(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(t(92));if(ut(d)){if(1<d.length)throw Error(t(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:we(d)}}function io(a,c){var d=we(c.value),m=we(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),m!=null&&(a.defaultValue=""+m)}function Mi(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function Pr(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ir(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?Pr(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var kr,ua=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,m,v){MSApp.execUnsafeLocalFunction(function(){return a(c,d,m,v)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(kr=kr||document.createElement("div"),kr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=kr.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function Nr(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var Li={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ol=["Webkit","ms","Moz","O"];Object.keys(Li).forEach(function(a){Ol.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Li[c]=Li[a]})});function Dr(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||Li.hasOwnProperty(a)&&Li[a]?(""+c).trim():c+"px"}function ms(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var m=d.indexOf("--")===0,v=Dr(d,c[d],m);d==="float"&&(d="cssFloat"),m?a.setProperty(d,v):a[d]=v}}var ro=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bn(a,c){if(c){if(ro[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function ys(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mr=null;function Lr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Wn=null,Gn=null,gt=null;function so(a){if(a=fh(a)){if(typeof Wn!="function")throw Error(t(280));var c=a.stateNode;c&&(c=Zf(c),Wn(a.stateNode,a.type,c))}}function rr(a){Gn?gt?gt.push(a):gt=[a]:Gn=a}function jt(){if(Gn){var a=Gn,c=gt;if(gt=Gn=null,so(a),c)for(a=0;a<c.length;a++)so(c[a])}}function Oi(a,c){return a(c)}function pn(){}var Ft=!1;function mn(a,c,d){if(Ft)return a(c,d);Ft=!0;try{return Oi(a,c,d)}finally{Ft=!1,(Gn!==null||gt!==null)&&(pn(),jt())}}function yn(a,c){var d=a.stateNode;if(d===null)return null;var m=Zf(d);if(m===null)return null;d=m[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,c,typeof d));return d}var on=!1;if(l)try{var ot={};Object.defineProperty(ot,"passive",{get:function(){on=!0}}),window.addEventListener("test",ot,ot),window.removeEventListener("test",ot,ot)}catch{on=!1}function Gt(a,c,d,m,v,w,A,z,H){var J=Array.prototype.slice.call(arguments,3);try{c.apply(d,J)}catch(le){this.onError(le)}}var Zt=!1,ji=null,jl=!1,Fi=null,Af={onError:function(a){Zt=!0,ji=a}};function Pf(a,c,d,m,v,w,A,z,H){Zt=!1,ji=null,Gt.apply(Af,arguments)}function Uu(a,c,d,m,v,w,A,z,H){if(Pf.apply(this,arguments),Zt){if(Zt){var J=ji;Zt=!1,ji=null}else throw Error(t(198));jl||(jl=!0,Fi=J)}}function sr(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function Bu(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function kf(a){if(sr(a)!==a)throw Error(t(188))}function Nf(a){var c=a.alternate;if(!c){if(c=sr(a),c===null)throw Error(t(188));return c!==a?null:a}for(var d=a,m=c;;){var v=d.return;if(v===null)break;var w=v.alternate;if(w===null){if(m=v.return,m!==null){d=m;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===d)return kf(v),a;if(w===m)return kf(v),c;w=w.sibling}throw Error(t(188))}if(d.return!==m.return)d=v,m=w;else{for(var A=!1,z=v.child;z;){if(z===d){A=!0,d=v,m=w;break}if(z===m){A=!0,m=v,d=w;break}z=z.sibling}if(!A){for(z=w.child;z;){if(z===d){A=!0,d=w,m=v;break}if(z===m){A=!0,m=w,d=v;break}z=z.sibling}if(!A)throw Error(t(189))}}if(d.alternate!==m)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:c}function Df(a){return a=Nf(a),a!==null?ha(a):null}function ha(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=ha(a);if(c!==null)return c;a=a.sibling}return null}var Wu=e.unstable_scheduleCallback,Fl=e.unstable_cancelCallback,da=e.unstable_shouldYield,_s=e.unstable_requestPaint,xt=e.unstable_now,by=e.unstable_getCurrentPriorityLevel,Vl=e.unstable_ImmediatePriority,Gu=e.unstable_UserBlockingPriority,fa=e.unstable_NormalPriority,$u=e.unstable_LowPriority,zl=e.unstable_IdlePriority,ga=null,pi=null;function Mf(a){if(pi&&typeof pi.onCommitFiberRoot=="function")try{pi.onCommitFiberRoot(ga,a,void 0,(a.current.flags&128)===128)}catch{}}var mi=Math.clz32?Math.clz32:pa,Or=Math.log,Vi=Math.LN2;function pa(a){return a>>>=0,a===0?32:31-(Or(a)/Vi|0)|0}var jr=64,oo=4194304;function at(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function vs(a,c){var d=a.pendingLanes;if(d===0)return 0;var m=0,v=a.suspendedLanes,w=a.pingedLanes,A=d&268435455;if(A!==0){var z=A&~v;z!==0?m=at(z):(w&=A,w!==0&&(m=at(w)))}else A=d&~v,A!==0?m=at(A):w!==0&&(m=at(w));if(m===0)return 0;if(c!==0&&c!==m&&(c&v)===0&&(v=m&-m,w=c&-c,v>=w||v===16&&(w&4194240)!==0))return c;if((m&4)!==0&&(m|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=m;0<c;)d=31-mi(c),v=1<<d,m|=a[d],c&=~v;return m}function ma(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ya(a,c){for(var d=a.suspendedLanes,m=a.pingedLanes,v=a.expirationTimes,w=a.pendingLanes;0<w;){var A=31-mi(w),z=1<<A,H=v[A];H===-1?((z&d)===0||(z&m)!==0)&&(v[A]=ma(z,c)):H<=c&&(a.expiredLanes|=z),w&=~z}}function Hu(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Ku(){var a=jr;return jr<<=1,(jr&4194240)===0&&(jr=64),a}function qu(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function _a(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-mi(c),a[c]=d}function Ay(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var m=a.eventTimes;for(a=a.expirationTimes;0<d;){var v=31-mi(d),w=1<<v;c[v]=0,m[v]=-1,a[v]=-1,d&=~w}}function Xu(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var m=31-mi(d),v=1<<m;v&c|a[m]&c&&(a[m]|=c),d&=~v}}var Ye=0;function Fr(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Yu,Ul,Zu,Qu,Ju,Vr=!1,Bl=[],zr=null,Ur=null,_n=null,va=new Map,xs=new Map,yi=[],Lf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ao(a,c){switch(a){case"focusin":case"focusout":zr=null;break;case"dragenter":case"dragleave":Ur=null;break;case"mouseover":case"mouseout":_n=null;break;case"pointerover":case"pointerout":va.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":xs.delete(c.pointerId)}}function or(a,c,d,m,v,w){return a===null||a.nativeEvent!==w?(a={blockedOn:c,domEventName:d,eventSystemFlags:m,nativeEvent:w,targetContainers:[v]},c!==null&&(c=fh(c),c!==null&&Ul(c)),a):(a.eventSystemFlags|=m,c=a.targetContainers,v!==null&&c.indexOf(v)===-1&&c.push(v),a)}function Of(a,c,d,m,v){switch(c){case"focusin":return zr=or(zr,a,c,d,m,v),!0;case"dragenter":return Ur=or(Ur,a,c,d,m,v),!0;case"mouseover":return _n=or(_n,a,c,d,m,v),!0;case"pointerover":var w=v.pointerId;return va.set(w,or(va.get(w)||null,a,c,d,m,v)),!0;case"gotpointercapture":return w=v.pointerId,xs.set(w,or(xs.get(w)||null,a,c,d,m,v)),!0}return!1}function Wl(a){var c=Ta(a.target);if(c!==null){var d=sr(c);if(d!==null){if(c=d.tag,c===13){if(c=Bu(d),c!==null){a.blockedOn=c,Ju(a.priority,function(){Zu(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function mt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=Gl(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var m=new d.constructor(d.type,d);Mr=m,d.target.dispatchEvent(m),Mr=null}else return c=fh(d),c!==null&&Ul(c),a.blockedOn=d,!1;c.shift()}return!0}function jf(a,c,d){mt(a)&&d.delete(c)}function Py(){Vr=!1,zr!==null&&mt(zr)&&(zr=null),Ur!==null&&mt(Ur)&&(Ur=null),_n!==null&&mt(_n)&&(_n=null),va.forEach(jf),xs.forEach(jf)}function lo(a,c){a.blockedOn===c&&(a.blockedOn=null,Vr||(Vr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Py)))}function co(a){function c(v){return lo(v,a)}if(0<Bl.length){lo(Bl[0],a);for(var d=1;d<Bl.length;d++){var m=Bl[d];m.blockedOn===a&&(m.blockedOn=null)}}for(zr!==null&&lo(zr,a),Ur!==null&&lo(Ur,a),_n!==null&&lo(_n,a),va.forEach(c),xs.forEach(c),d=0;d<yi.length;d++)m=yi[d],m.blockedOn===a&&(m.blockedOn=null);for(;0<yi.length&&(d=yi[0],d.blockedOn===null);)Wl(d),d.blockedOn===null&&yi.shift()}var ws=L.ReactCurrentBatchConfig,Es=!0;function Br(a,c,d,m){var v=Ye,w=ws.transition;ws.transition=null;try{Ye=1,eh(a,c,d,m)}finally{Ye=v,ws.transition=w}}function Ff(a,c,d,m){var v=Ye,w=ws.transition;ws.transition=null;try{Ye=4,eh(a,c,d,m)}finally{Ye=v,ws.transition=w}}function eh(a,c,d,m){if(Es){var v=Gl(a,c,d,m);if(v===null)Uy(a,c,m,Wr,d),ao(a,m);else if(Of(v,a,c,d,m))m.stopPropagation();else if(ao(a,m),c&4&&-1<Lf.indexOf(a)){for(;v!==null;){var w=fh(v);if(w!==null&&Yu(w),w=Gl(a,c,d,m),w===null&&Uy(a,c,m,Wr,d),w===v)break;v=w}v!==null&&m.stopPropagation()}else Uy(a,c,m,null,d)}}var Wr=null;function Gl(a,c,d,m){if(Wr=null,a=Lr(m),a=Ta(a),a!==null)if(c=sr(a),c===null)a=null;else if(d=c.tag,d===13){if(a=Bu(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return Wr=a,null}function $l(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(by()){case Vl:return 1;case Gu:return 4;case fa:case $u:return 16;case zl:return 536870912;default:return 16}default:return 16}}var _i=null,Hl=null,Ts=null;function Vf(){if(Ts)return Ts;var a,c=Hl,d=c.length,m,v="value"in _i?_i.value:_i.textContent,w=v.length;for(a=0;a<d&&c[a]===v[a];a++);var A=d-a;for(m=1;m<=A&&c[d-m]===v[w-m];m++);return Ts=v.slice(a,1<m?1-m:void 0)}function xa(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Gr(){return!0}function th(){return!1}function An(a){function c(d,m,v,w,A){this._reactName=d,this._targetInst=v,this.type=m,this.nativeEvent=w,this.target=A,this.currentTarget=null;for(var z in a)a.hasOwnProperty(z)&&(d=a[z],this[z]=d?d(w):w[z]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Gr:th,this.isPropagationStopped=th,this}return ne(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Gr)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Gr)},persist:function(){},isPersistent:Gr}),c}var $r={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wa=An($r),uo=ne({},$r,{view:0,detail:0}),Kl=An(uo),ql,Xl,vi,Ea=ne({},uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ue,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==vi&&(vi&&a.type==="mousemove"?(ql=a.screenX-vi.screenX,Xl=a.screenY-vi.screenY):Xl=ql=0,vi=a),ql)},movementY:function(a){return"movementY"in a?a.movementY:Xl}}),nh=An(Ea),zf=ne({},Ea,{dataTransfer:0}),Uf=An(zf),Yl=ne({},uo,{relatedTarget:0}),vn=An(Yl),Bf=ne({},$r,{animationName:0,elapsedTime:0,pseudoElement:0}),Wf=An(Bf),ho=ne({},$r,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=An(ho),E=ne({},$r,{data:0}),R=An(E),j={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Y={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pe(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=ee[a])?!!c[a]:!1}function Ue(){return pe}var Vt=ne({},uo,{key:function(a){if(a.key){var c=j[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=xa(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Y[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ue,charCode:function(a){return a.type==="keypress"?xa(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?xa(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ht=An(Vt),$t=ne({},Ea,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xi=An($t),Ss=ne({},uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ue}),Hr=An(Ss),Kr=ne({},$r,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zl=An(Kr),ih=ne({},Ea,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),YD=An(ih),ZD=[9,13,27,32],ky=l&&"CompositionEvent"in window,rh=null;l&&"documentMode"in document&&(rh=document.documentMode);var QD=l&&"TextEvent"in window&&!rh,$w=l&&(!ky||rh&&8<rh&&11>=rh),Hw=" ",Kw=!1;function qw(a,c){switch(a){case"keyup":return ZD.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xw(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ql=!1;function JD(a,c){switch(a){case"compositionend":return Xw(c);case"keypress":return c.which!==32?null:(Kw=!0,Hw);case"textInput":return a=c.data,a===Hw&&Kw?null:a;default:return null}}function eM(a,c){if(Ql)return a==="compositionend"||!ky&&qw(a,c)?(a=Vf(),Ts=Hl=_i=null,Ql=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return $w&&c.locale!=="ko"?null:c.data;default:return null}}var tM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yw(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!tM[a.type]:c==="textarea"}function Zw(a,c,d,m){rr(m),c=qf(c,"onChange"),0<c.length&&(d=new wa("onChange","change",null,d,m),a.push({event:d,listeners:c}))}var sh=null,oh=null;function nM(a){pE(a,0)}function Gf(a){var c=ic(a);if(Un(c))return a}function iM(a,c){if(a==="change")return c}var Qw=!1;if(l){var Ny;if(l){var Dy="oninput"in document;if(!Dy){var Jw=document.createElement("div");Jw.setAttribute("oninput","return;"),Dy=typeof Jw.oninput=="function"}Ny=Dy}else Ny=!1;Qw=Ny&&(!document.documentMode||9<document.documentMode)}function eE(){sh&&(sh.detachEvent("onpropertychange",tE),oh=sh=null)}function tE(a){if(a.propertyName==="value"&&Gf(oh)){var c=[];Zw(c,oh,a,Lr(a)),mn(nM,c)}}function rM(a,c,d){a==="focusin"?(eE(),sh=c,oh=d,sh.attachEvent("onpropertychange",tE)):a==="focusout"&&eE()}function sM(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Gf(oh)}function oM(a,c){if(a==="click")return Gf(c)}function aM(a,c){if(a==="input"||a==="change")return Gf(c)}function lM(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var ar=typeof Object.is=="function"?Object.is:lM;function ah(a,c){if(ar(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),m=Object.keys(c);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var v=d[m];if(!u.call(c,v)||!ar(a[v],c[v]))return!1}return!0}function nE(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function iE(a,c){var d=nE(a);a=0;for(var m;d;){if(d.nodeType===3){if(m=a+d.textContent.length,a<=c&&m>=c)return{node:d,offset:c-a};a=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=nE(d)}}function rE(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?rE(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function sE(){for(var a=window,c=Yt();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=Yt(a.document)}return c}function My(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function cM(a){var c=sE(),d=a.focusedElem,m=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&rE(d.ownerDocument.documentElement,d)){if(m!==null&&My(d)){if(c=m.start,a=m.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var v=d.textContent.length,w=Math.min(m.start,v);m=m.end===void 0?w:Math.min(m.end,v),!a.extend&&w>m&&(v=m,m=w,w=v),v=iE(d,w);var A=iE(d,m);v&&A&&(a.rangeCount!==1||a.anchorNode!==v.node||a.anchorOffset!==v.offset||a.focusNode!==A.node||a.focusOffset!==A.offset)&&(c=c.createRange(),c.setStart(v.node,v.offset),a.removeAllRanges(),w>m?(a.addRange(c),a.extend(A.node,A.offset)):(c.setEnd(A.node,A.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var uM=l&&"documentMode"in document&&11>=document.documentMode,Jl=null,Ly=null,lh=null,Oy=!1;function oE(a,c,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Oy||Jl==null||Jl!==Yt(m)||(m=Jl,"selectionStart"in m&&My(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),lh&&ah(lh,m)||(lh=m,m=qf(Ly,"onSelect"),0<m.length&&(c=new wa("onSelect","select",null,c,d),a.push({event:c,listeners:m}),c.target=Jl)))}function $f(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var ec={animationend:$f("Animation","AnimationEnd"),animationiteration:$f("Animation","AnimationIteration"),animationstart:$f("Animation","AnimationStart"),transitionend:$f("Transition","TransitionEnd")},jy={},aE={};l&&(aE=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function Hf(a){if(jy[a])return jy[a];if(!ec[a])return a;var c=ec[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in aE)return jy[a]=c[d];return a}var lE=Hf("animationend"),cE=Hf("animationiteration"),uE=Hf("animationstart"),hE=Hf("transitionend"),dE=new Map,fE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fo(a,c){dE.set(a,c),s(c,[a])}for(var Fy=0;Fy<fE.length;Fy++){var Vy=fE[Fy],hM=Vy.toLowerCase(),dM=Vy[0].toUpperCase()+Vy.slice(1);fo(hM,"on"+dM)}fo(lE,"onAnimationEnd"),fo(cE,"onAnimationIteration"),fo(uE,"onAnimationStart"),fo("dblclick","onDoubleClick"),fo("focusin","onFocus"),fo("focusout","onBlur"),fo(hE,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ch="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fM=new Set("cancel close invalid load scroll toggle".split(" ").concat(ch));function gE(a,c,d){var m=a.type||"unknown-event";a.currentTarget=d,Uu(m,c,void 0,a),a.currentTarget=null}function pE(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var m=a[d],v=m.event;m=m.listeners;e:{var w=void 0;if(c)for(var A=m.length-1;0<=A;A--){var z=m[A],H=z.instance,J=z.currentTarget;if(z=z.listener,H!==w&&v.isPropagationStopped())break e;gE(v,z,J),w=H}else for(A=0;A<m.length;A++){if(z=m[A],H=z.instance,J=z.currentTarget,z=z.listener,H!==w&&v.isPropagationStopped())break e;gE(v,z,J),w=H}}}if(jl)throw a=Fi,jl=!1,Fi=null,a}function wt(a,c){var d=c[Ky];d===void 0&&(d=c[Ky]=new Set);var m=a+"__bubble";d.has(m)||(mE(c,a,2,!1),d.add(m))}function zy(a,c,d){var m=0;c&&(m|=4),mE(d,a,m,c)}var Kf="_reactListening"+Math.random().toString(36).slice(2);function uh(a){if(!a[Kf]){a[Kf]=!0,i.forEach(function(d){d!=="selectionchange"&&(fM.has(d)||zy(d,!1,a),zy(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Kf]||(c[Kf]=!0,zy("selectionchange",!1,c))}}function mE(a,c,d,m){switch($l(c)){case 1:var v=Br;break;case 4:v=Ff;break;default:v=eh}d=v.bind(null,c,d,a),v=void 0,!on||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(v=!0),m?v!==void 0?a.addEventListener(c,d,{capture:!0,passive:v}):a.addEventListener(c,d,!0):v!==void 0?a.addEventListener(c,d,{passive:v}):a.addEventListener(c,d,!1)}function Uy(a,c,d,m,v){var w=m;if((c&1)===0&&(c&2)===0&&m!==null)e:for(;;){if(m===null)return;var A=m.tag;if(A===3||A===4){var z=m.stateNode.containerInfo;if(z===v||z.nodeType===8&&z.parentNode===v)break;if(A===4)for(A=m.return;A!==null;){var H=A.tag;if((H===3||H===4)&&(H=A.stateNode.containerInfo,H===v||H.nodeType===8&&H.parentNode===v))return;A=A.return}for(;z!==null;){if(A=Ta(z),A===null)return;if(H=A.tag,H===5||H===6){m=w=A;continue e}z=z.parentNode}}m=m.return}mn(function(){var J=w,le=Lr(d),he=[];e:{var ae=dE.get(a);if(ae!==void 0){var ve=wa,Te=a;switch(a){case"keypress":if(xa(d)===0)break e;case"keydown":case"keyup":ve=ht;break;case"focusin":Te="focus",ve=vn;break;case"focusout":Te="blur",ve=vn;break;case"beforeblur":case"afterblur":ve=vn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=nh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=Uf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=Hr;break;case lE:case cE:case uE:ve=Wf;break;case hE:ve=Zl;break;case"scroll":ve=Kl;break;case"wheel":ve=YD;break;case"copy":case"cut":case"paste":ve=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=xi}var Se=(c&4)!==0,zt=!Se&&a==="scroll",X=Se?ae!==null?ae+"Capture":null:ae;Se=[];for(var K=J,Z;K!==null;){Z=K;var fe=Z.stateNode;if(Z.tag===5&&fe!==null&&(Z=fe,X!==null&&(fe=yn(K,X),fe!=null&&Se.push(hh(K,fe,Z)))),zt)break;K=K.return}0<Se.length&&(ae=new ve(ae,Te,null,d,le),he.push({event:ae,listeners:Se}))}}if((c&7)===0){e:{if(ae=a==="mouseover"||a==="pointerover",ve=a==="mouseout"||a==="pointerout",ae&&d!==Mr&&(Te=d.relatedTarget||d.fromElement)&&(Ta(Te)||Te[Is]))break e;if((ve||ae)&&(ae=le.window===le?le:(ae=le.ownerDocument)?ae.defaultView||ae.parentWindow:window,ve?(Te=d.relatedTarget||d.toElement,ve=J,Te=Te?Ta(Te):null,Te!==null&&(zt=sr(Te),Te!==zt||Te.tag!==5&&Te.tag!==6)&&(Te=null)):(ve=null,Te=J),ve!==Te)){if(Se=nh,fe="onMouseLeave",X="onMouseEnter",K="mouse",(a==="pointerout"||a==="pointerover")&&(Se=xi,fe="onPointerLeave",X="onPointerEnter",K="pointer"),zt=ve==null?ae:ic(ve),Z=Te==null?ae:ic(Te),ae=new Se(fe,K+"leave",ve,d,le),ae.target=zt,ae.relatedTarget=Z,fe=null,Ta(le)===J&&(Se=new Se(X,K+"enter",Te,d,le),Se.target=Z,Se.relatedTarget=zt,fe=Se),zt=fe,ve&&Te)t:{for(Se=ve,X=Te,K=0,Z=Se;Z;Z=tc(Z))K++;for(Z=0,fe=X;fe;fe=tc(fe))Z++;for(;0<K-Z;)Se=tc(Se),K--;for(;0<Z-K;)X=tc(X),Z--;for(;K--;){if(Se===X||X!==null&&Se===X.alternate)break t;Se=tc(Se),X=tc(X)}Se=null}else Se=null;ve!==null&&yE(he,ae,ve,Se,!1),Te!==null&&zt!==null&&yE(he,zt,Te,Se,!0)}}e:{if(ae=J?ic(J):window,ve=ae.nodeName&&ae.nodeName.toLowerCase(),ve==="select"||ve==="input"&&ae.type==="file")var Re=iM;else if(Yw(ae))if(Qw)Re=aM;else{Re=sM;var De=rM}else(ve=ae.nodeName)&&ve.toLowerCase()==="input"&&(ae.type==="checkbox"||ae.type==="radio")&&(Re=oM);if(Re&&(Re=Re(a,J))){Zw(he,Re,d,le);break e}De&&De(a,ae,J),a==="focusout"&&(De=ae._wrapperState)&&De.controlled&&ae.type==="number"&&_t(ae,"number",ae.value)}switch(De=J?ic(J):window,a){case"focusin":(Yw(De)||De.contentEditable==="true")&&(Jl=De,Ly=J,lh=null);break;case"focusout":lh=Ly=Jl=null;break;case"mousedown":Oy=!0;break;case"contextmenu":case"mouseup":case"dragend":Oy=!1,oE(he,d,le);break;case"selectionchange":if(uM)break;case"keydown":case"keyup":oE(he,d,le)}var Me;if(ky)e:{switch(a){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Ql?qw(a,d)&&(je="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(je="onCompositionStart");je&&($w&&d.locale!=="ko"&&(Ql||je!=="onCompositionStart"?je==="onCompositionEnd"&&Ql&&(Me=Vf()):(_i=le,Hl="value"in _i?_i.value:_i.textContent,Ql=!0)),De=qf(J,je),0<De.length&&(je=new R(je,a,null,d,le),he.push({event:je,listeners:De}),Me?je.data=Me:(Me=Xw(d),Me!==null&&(je.data=Me)))),(Me=QD?JD(a,d):eM(a,d))&&(J=qf(J,"onBeforeInput"),0<J.length&&(le=new R("onBeforeInput","beforeinput",null,d,le),he.push({event:le,listeners:J}),le.data=Me))}pE(he,c)})}function hh(a,c,d){return{instance:a,listener:c,currentTarget:d}}function qf(a,c){for(var d=c+"Capture",m=[];a!==null;){var v=a,w=v.stateNode;v.tag===5&&w!==null&&(v=w,w=yn(a,d),w!=null&&m.unshift(hh(a,w,v)),w=yn(a,c),w!=null&&m.push(hh(a,w,v))),a=a.return}return m}function tc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function yE(a,c,d,m,v){for(var w=c._reactName,A=[];d!==null&&d!==m;){var z=d,H=z.alternate,J=z.stateNode;if(H!==null&&H===m)break;z.tag===5&&J!==null&&(z=J,v?(H=yn(d,w),H!=null&&A.unshift(hh(d,H,z))):v||(H=yn(d,w),H!=null&&A.push(hh(d,H,z)))),d=d.return}A.length!==0&&a.push({event:c,listeners:A})}var gM=/\r\n?/g,pM=/\u0000|\uFFFD/g;function _E(a){return(typeof a=="string"?a:""+a).replace(gM,`
`).replace(pM,"")}function Xf(a,c,d){if(c=_E(c),_E(a)!==c&&d)throw Error(t(425))}function Yf(){}var By=null,Wy=null;function Gy(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var $y=typeof setTimeout=="function"?setTimeout:void 0,mM=typeof clearTimeout=="function"?clearTimeout:void 0,vE=typeof Promise=="function"?Promise:void 0,yM=typeof queueMicrotask=="function"?queueMicrotask:typeof vE<"u"?function(a){return vE.resolve(null).then(a).catch(_M)}:$y;function _M(a){setTimeout(function(){throw a})}function Hy(a,c){var d=c,m=0;do{var v=d.nextSibling;if(a.removeChild(d),v&&v.nodeType===8)if(d=v.data,d==="/$"){if(m===0){a.removeChild(v),co(c);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=v}while(d);co(c)}function go(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function xE(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var nc=Math.random().toString(36).slice(2),qr="__reactFiber$"+nc,dh="__reactProps$"+nc,Is="__reactContainer$"+nc,Ky="__reactEvents$"+nc,vM="__reactListeners$"+nc,xM="__reactHandles$"+nc;function Ta(a){var c=a[qr];if(c)return c;for(var d=a.parentNode;d;){if(c=d[Is]||d[qr]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=xE(a);a!==null;){if(d=a[qr])return d;a=xE(a)}return c}a=d,d=a.parentNode}return null}function fh(a){return a=a[qr]||a[Is],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ic(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Zf(a){return a[dh]||null}var qy=[],rc=-1;function po(a){return{current:a}}function Et(a){0>rc||(a.current=qy[rc],qy[rc]=null,rc--)}function vt(a,c){rc++,qy[rc]=a.current,a.current=c}var mo={},Pn=po(mo),Zn=po(!1),Sa=mo;function sc(a,c){var d=a.type.contextTypes;if(!d)return mo;var m=a.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===c)return m.__reactInternalMemoizedMaskedChildContext;var v={},w;for(w in d)v[w]=c[w];return m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=v),v}function Qn(a){return a=a.childContextTypes,a!=null}function Qf(){Et(Zn),Et(Pn)}function wE(a,c,d){if(Pn.current!==mo)throw Error(t(168));vt(Pn,c),vt(Zn,d)}function EE(a,c,d){var m=a.stateNode;if(c=c.childContextTypes,typeof m.getChildContext!="function")return d;m=m.getChildContext();for(var v in m)if(!(v in c))throw Error(t(108,_e(a)||"Unknown",v));return ne({},d,m)}function Jf(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||mo,Sa=Pn.current,vt(Pn,a),vt(Zn,Zn.current),!0}function TE(a,c,d){var m=a.stateNode;if(!m)throw Error(t(169));d?(a=EE(a,c,Sa),m.__reactInternalMemoizedMergedChildContext=a,Et(Zn),Et(Pn),vt(Pn,a)):Et(Zn),vt(Zn,d)}var Cs=null,eg=!1,Xy=!1;function SE(a){Cs===null?Cs=[a]:Cs.push(a)}function wM(a){eg=!0,SE(a)}function yo(){if(!Xy&&Cs!==null){Xy=!0;var a=0,c=Ye;try{var d=Cs;for(Ye=1;a<d.length;a++){var m=d[a];do m=m(!0);while(m!==null)}Cs=null,eg=!1}catch(v){throw Cs!==null&&(Cs=Cs.slice(a+1)),Wu(Vl,yo),v}finally{Ye=c,Xy=!1}}return null}var oc=[],ac=0,tg=null,ng=0,zi=[],Ui=0,Ia=null,Rs=1,bs="";function Ca(a,c){oc[ac++]=ng,oc[ac++]=tg,tg=a,ng=c}function IE(a,c,d){zi[Ui++]=Rs,zi[Ui++]=bs,zi[Ui++]=Ia,Ia=a;var m=Rs;a=bs;var v=32-mi(m)-1;m&=~(1<<v),d+=1;var w=32-mi(c)+v;if(30<w){var A=v-v%5;w=(m&(1<<A)-1).toString(32),m>>=A,v-=A,Rs=1<<32-mi(c)+v|d<<v|m,bs=w+a}else Rs=1<<w|d<<v|m,bs=a}function Yy(a){a.return!==null&&(Ca(a,1),IE(a,1,0))}function Zy(a){for(;a===tg;)tg=oc[--ac],oc[ac]=null,ng=oc[--ac],oc[ac]=null;for(;a===Ia;)Ia=zi[--Ui],zi[Ui]=null,bs=zi[--Ui],zi[Ui]=null,Rs=zi[--Ui],zi[Ui]=null}var wi=null,Ei=null,Ct=!1,lr=null;function CE(a,c){var d=$i(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function RE(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,wi=a,Ei=go(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,wi=a,Ei=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Ia!==null?{id:Rs,overflow:bs}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=$i(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,wi=a,Ei=null,!0):!1;default:return!1}}function Qy(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Jy(a){if(Ct){var c=Ei;if(c){var d=c;if(!RE(a,c)){if(Qy(a))throw Error(t(418));c=go(d.nextSibling);var m=wi;c&&RE(a,c)?CE(m,d):(a.flags=a.flags&-4097|2,Ct=!1,wi=a)}}else{if(Qy(a))throw Error(t(418));a.flags=a.flags&-4097|2,Ct=!1,wi=a}}}function bE(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;wi=a}function ig(a){if(a!==wi)return!1;if(!Ct)return bE(a),Ct=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!Gy(a.type,a.memoizedProps)),c&&(c=Ei)){if(Qy(a))throw AE(),Error(t(418));for(;c;)CE(a,c),c=go(c.nextSibling)}if(bE(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){Ei=go(a.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}Ei=null}}else Ei=wi?go(a.stateNode.nextSibling):null;return!0}function AE(){for(var a=Ei;a;)a=go(a.nextSibling)}function lc(){Ei=wi=null,Ct=!1}function e0(a){lr===null?lr=[a]:lr.push(a)}var EM=L.ReactCurrentBatchConfig;function gh(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var m=d.stateNode}if(!m)throw Error(t(147,a));var v=m,w=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===w?c.ref:(c=function(A){var z=v.refs;A===null?delete z[w]:z[w]=A},c._stringRef=w,c)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function rg(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function PE(a){var c=a._init;return c(a._payload)}function kE(a){function c(X,K){if(a){var Z=X.deletions;Z===null?(X.deletions=[K],X.flags|=16):Z.push(K)}}function d(X,K){if(!a)return null;for(;K!==null;)c(X,K),K=K.sibling;return null}function m(X,K){for(X=new Map;K!==null;)K.key!==null?X.set(K.key,K):X.set(K.index,K),K=K.sibling;return X}function v(X,K){return X=Io(X,K),X.index=0,X.sibling=null,X}function w(X,K,Z){return X.index=Z,a?(Z=X.alternate,Z!==null?(Z=Z.index,Z<K?(X.flags|=2,K):Z):(X.flags|=2,K)):(X.flags|=1048576,K)}function A(X){return a&&X.alternate===null&&(X.flags|=2),X}function z(X,K,Z,fe){return K===null||K.tag!==6?(K=$0(Z,X.mode,fe),K.return=X,K):(K=v(K,Z),K.return=X,K)}function H(X,K,Z,fe){var Re=Z.type;return Re===P?le(X,K,Z.props.children,fe,Z.key):K!==null&&(K.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ge&&PE(Re)===K.type)?(fe=v(K,Z.props),fe.ref=gh(X,K,Z),fe.return=X,fe):(fe=bg(Z.type,Z.key,Z.props,null,X.mode,fe),fe.ref=gh(X,K,Z),fe.return=X,fe)}function J(X,K,Z,fe){return K===null||K.tag!==4||K.stateNode.containerInfo!==Z.containerInfo||K.stateNode.implementation!==Z.implementation?(K=H0(Z,X.mode,fe),K.return=X,K):(K=v(K,Z.children||[]),K.return=X,K)}function le(X,K,Z,fe,Re){return K===null||K.tag!==7?(K=Ma(Z,X.mode,fe,Re),K.return=X,K):(K=v(K,Z),K.return=X,K)}function he(X,K,Z){if(typeof K=="string"&&K!==""||typeof K=="number")return K=$0(""+K,X.mode,Z),K.return=X,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case O:return Z=bg(K.type,K.key,K.props,null,X.mode,Z),Z.ref=gh(X,null,K),Z.return=X,Z;case U:return K=H0(K,X.mode,Z),K.return=X,K;case ge:var fe=K._init;return he(X,fe(K._payload),Z)}if(ut(K)||ie(K))return K=Ma(K,X.mode,Z,null),K.return=X,K;rg(X,K)}return null}function ae(X,K,Z,fe){var Re=K!==null?K.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Re!==null?null:z(X,K,""+Z,fe);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case O:return Z.key===Re?H(X,K,Z,fe):null;case U:return Z.key===Re?J(X,K,Z,fe):null;case ge:return Re=Z._init,ae(X,K,Re(Z._payload),fe)}if(ut(Z)||ie(Z))return Re!==null?null:le(X,K,Z,fe,null);rg(X,Z)}return null}function ve(X,K,Z,fe,Re){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return X=X.get(Z)||null,z(K,X,""+fe,Re);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case O:return X=X.get(fe.key===null?Z:fe.key)||null,H(K,X,fe,Re);case U:return X=X.get(fe.key===null?Z:fe.key)||null,J(K,X,fe,Re);case ge:var De=fe._init;return ve(X,K,Z,De(fe._payload),Re)}if(ut(fe)||ie(fe))return X=X.get(Z)||null,le(K,X,fe,Re,null);rg(K,fe)}return null}function Te(X,K,Z,fe){for(var Re=null,De=null,Me=K,je=K=0,cn=null;Me!==null&&je<Z.length;je++){Me.index>je?(cn=Me,Me=null):cn=Me.sibling;var nt=ae(X,Me,Z[je],fe);if(nt===null){Me===null&&(Me=cn);break}a&&Me&&nt.alternate===null&&c(X,Me),K=w(nt,K,je),De===null?Re=nt:De.sibling=nt,De=nt,Me=cn}if(je===Z.length)return d(X,Me),Ct&&Ca(X,je),Re;if(Me===null){for(;je<Z.length;je++)Me=he(X,Z[je],fe),Me!==null&&(K=w(Me,K,je),De===null?Re=Me:De.sibling=Me,De=Me);return Ct&&Ca(X,je),Re}for(Me=m(X,Me);je<Z.length;je++)cn=ve(Me,X,je,Z[je],fe),cn!==null&&(a&&cn.alternate!==null&&Me.delete(cn.key===null?je:cn.key),K=w(cn,K,je),De===null?Re=cn:De.sibling=cn,De=cn);return a&&Me.forEach(function(Co){return c(X,Co)}),Ct&&Ca(X,je),Re}function Se(X,K,Z,fe){var Re=ie(Z);if(typeof Re!="function")throw Error(t(150));if(Z=Re.call(Z),Z==null)throw Error(t(151));for(var De=Re=null,Me=K,je=K=0,cn=null,nt=Z.next();Me!==null&&!nt.done;je++,nt=Z.next()){Me.index>je?(cn=Me,Me=null):cn=Me.sibling;var Co=ae(X,Me,nt.value,fe);if(Co===null){Me===null&&(Me=cn);break}a&&Me&&Co.alternate===null&&c(X,Me),K=w(Co,K,je),De===null?Re=Co:De.sibling=Co,De=Co,Me=cn}if(nt.done)return d(X,Me),Ct&&Ca(X,je),Re;if(Me===null){for(;!nt.done;je++,nt=Z.next())nt=he(X,nt.value,fe),nt!==null&&(K=w(nt,K,je),De===null?Re=nt:De.sibling=nt,De=nt);return Ct&&Ca(X,je),Re}for(Me=m(X,Me);!nt.done;je++,nt=Z.next())nt=ve(Me,X,je,nt.value,fe),nt!==null&&(a&&nt.alternate!==null&&Me.delete(nt.key===null?je:nt.key),K=w(nt,K,je),De===null?Re=nt:De.sibling=nt,De=nt);return a&&Me.forEach(function(tL){return c(X,tL)}),Ct&&Ca(X,je),Re}function zt(X,K,Z,fe){if(typeof Z=="object"&&Z!==null&&Z.type===P&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case O:e:{for(var Re=Z.key,De=K;De!==null;){if(De.key===Re){if(Re=Z.type,Re===P){if(De.tag===7){d(X,De.sibling),K=v(De,Z.props.children),K.return=X,X=K;break e}}else if(De.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ge&&PE(Re)===De.type){d(X,De.sibling),K=v(De,Z.props),K.ref=gh(X,De,Z),K.return=X,X=K;break e}d(X,De);break}else c(X,De);De=De.sibling}Z.type===P?(K=Ma(Z.props.children,X.mode,fe,Z.key),K.return=X,X=K):(fe=bg(Z.type,Z.key,Z.props,null,X.mode,fe),fe.ref=gh(X,K,Z),fe.return=X,X=fe)}return A(X);case U:e:{for(De=Z.key;K!==null;){if(K.key===De)if(K.tag===4&&K.stateNode.containerInfo===Z.containerInfo&&K.stateNode.implementation===Z.implementation){d(X,K.sibling),K=v(K,Z.children||[]),K.return=X,X=K;break e}else{d(X,K);break}else c(X,K);K=K.sibling}K=H0(Z,X.mode,fe),K.return=X,X=K}return A(X);case ge:return De=Z._init,zt(X,K,De(Z._payload),fe)}if(ut(Z))return Te(X,K,Z,fe);if(ie(Z))return Se(X,K,Z,fe);rg(X,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"?(Z=""+Z,K!==null&&K.tag===6?(d(X,K.sibling),K=v(K,Z),K.return=X,X=K):(d(X,K),K=$0(Z,X.mode,fe),K.return=X,X=K),A(X)):d(X,K)}return zt}var cc=kE(!0),NE=kE(!1),sg=po(null),og=null,uc=null,t0=null;function n0(){t0=uc=og=null}function i0(a){var c=sg.current;Et(sg),a._currentValue=c}function r0(a,c,d){for(;a!==null;){var m=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),a===d)break;a=a.return}}function hc(a,c){og=a,t0=uc=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(Jn=!0),a.firstContext=null)}function Bi(a){var c=a._currentValue;if(t0!==a)if(a={context:a,memoizedValue:c,next:null},uc===null){if(og===null)throw Error(t(308));uc=a,og.dependencies={lanes:0,firstContext:a}}else uc=uc.next=a;return c}var Ra=null;function s0(a){Ra===null?Ra=[a]:Ra.push(a)}function DE(a,c,d,m){var v=c.interleaved;return v===null?(d.next=d,s0(c)):(d.next=v.next,v.next=d),c.interleaved=d,As(a,m)}function As(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var _o=!1;function o0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ME(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Ps(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function vo(a,c,d){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(tt&2)!==0){var v=m.pending;return v===null?c.next=c:(c.next=v.next,v.next=c),m.pending=c,As(a,d)}return v=m.interleaved,v===null?(c.next=c,s0(m)):(c.next=v.next,v.next=c),m.interleaved=c,As(a,d)}function ag(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,Xu(a,d)}}function LE(a,c){var d=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var v=null,w=null;if(d=d.firstBaseUpdate,d!==null){do{var A={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};w===null?v=w=A:w=w.next=A,d=d.next}while(d!==null);w===null?v=w=c:w=w.next=c}else v=w=c;d={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:m.shared,effects:m.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function lg(a,c,d,m){var v=a.updateQueue;_o=!1;var w=v.firstBaseUpdate,A=v.lastBaseUpdate,z=v.shared.pending;if(z!==null){v.shared.pending=null;var H=z,J=H.next;H.next=null,A===null?w=J:A.next=J,A=H;var le=a.alternate;le!==null&&(le=le.updateQueue,z=le.lastBaseUpdate,z!==A&&(z===null?le.firstBaseUpdate=J:z.next=J,le.lastBaseUpdate=H))}if(w!==null){var he=v.baseState;A=0,le=J=H=null,z=w;do{var ae=z.lane,ve=z.eventTime;if((m&ae)===ae){le!==null&&(le=le.next={eventTime:ve,lane:0,tag:z.tag,payload:z.payload,callback:z.callback,next:null});e:{var Te=a,Se=z;switch(ae=c,ve=d,Se.tag){case 1:if(Te=Se.payload,typeof Te=="function"){he=Te.call(ve,he,ae);break e}he=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=Se.payload,ae=typeof Te=="function"?Te.call(ve,he,ae):Te,ae==null)break e;he=ne({},he,ae);break e;case 2:_o=!0}}z.callback!==null&&z.lane!==0&&(a.flags|=64,ae=v.effects,ae===null?v.effects=[z]:ae.push(z))}else ve={eventTime:ve,lane:ae,tag:z.tag,payload:z.payload,callback:z.callback,next:null},le===null?(J=le=ve,H=he):le=le.next=ve,A|=ae;if(z=z.next,z===null){if(z=v.shared.pending,z===null)break;ae=z,z=ae.next,ae.next=null,v.lastBaseUpdate=ae,v.shared.pending=null}}while(!0);if(le===null&&(H=he),v.baseState=H,v.firstBaseUpdate=J,v.lastBaseUpdate=le,c=v.shared.interleaved,c!==null){v=c;do A|=v.lane,v=v.next;while(v!==c)}else w===null&&(v.shared.lanes=0);Pa|=A,a.lanes=A,a.memoizedState=he}}function OE(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var m=a[c],v=m.callback;if(v!==null){if(m.callback=null,m=d,typeof v!="function")throw Error(t(191,v));v.call(m)}}}var ph={},Xr=po(ph),mh=po(ph),yh=po(ph);function ba(a){if(a===ph)throw Error(t(174));return a}function a0(a,c){switch(vt(yh,c),vt(mh,a),vt(Xr,ph),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:ir(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=ir(c,a)}Et(Xr),vt(Xr,c)}function dc(){Et(Xr),Et(mh),Et(yh)}function jE(a){ba(yh.current);var c=ba(Xr.current),d=ir(c,a.type);c!==d&&(vt(mh,a),vt(Xr,d))}function l0(a){mh.current===a&&(Et(Xr),Et(mh))}var At=po(0);function cg(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var c0=[];function u0(){for(var a=0;a<c0.length;a++)c0[a]._workInProgressVersionPrimary=null;c0.length=0}var ug=L.ReactCurrentDispatcher,h0=L.ReactCurrentBatchConfig,Aa=0,Pt=null,Qt=null,an=null,hg=!1,_h=!1,vh=0,TM=0;function kn(){throw Error(t(321))}function d0(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!ar(a[d],c[d]))return!1;return!0}function f0(a,c,d,m,v,w){if(Aa=w,Pt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,ug.current=a===null||a.memoizedState===null?RM:bM,a=d(m,v),_h){w=0;do{if(_h=!1,vh=0,25<=w)throw Error(t(301));w+=1,an=Qt=null,c.updateQueue=null,ug.current=AM,a=d(m,v)}while(_h)}if(ug.current=gg,c=Qt!==null&&Qt.next!==null,Aa=0,an=Qt=Pt=null,hg=!1,c)throw Error(t(300));return a}function g0(){var a=vh!==0;return vh=0,a}function Yr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?Pt.memoizedState=an=a:an=an.next=a,an}function Wi(){if(Qt===null){var a=Pt.alternate;a=a!==null?a.memoizedState:null}else a=Qt.next;var c=an===null?Pt.memoizedState:an.next;if(c!==null)an=c,Qt=a;else{if(a===null)throw Error(t(310));Qt=a,a={memoizedState:Qt.memoizedState,baseState:Qt.baseState,baseQueue:Qt.baseQueue,queue:Qt.queue,next:null},an===null?Pt.memoizedState=an=a:an=an.next=a}return an}function xh(a,c){return typeof c=="function"?c(a):c}function p0(a){var c=Wi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=Qt,v=m.baseQueue,w=d.pending;if(w!==null){if(v!==null){var A=v.next;v.next=w.next,w.next=A}m.baseQueue=v=w,d.pending=null}if(v!==null){w=v.next,m=m.baseState;var z=A=null,H=null,J=w;do{var le=J.lane;if((Aa&le)===le)H!==null&&(H=H.next={lane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),m=J.hasEagerState?J.eagerState:a(m,J.action);else{var he={lane:le,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null};H===null?(z=H=he,A=m):H=H.next=he,Pt.lanes|=le,Pa|=le}J=J.next}while(J!==null&&J!==w);H===null?A=m:H.next=z,ar(m,c.memoizedState)||(Jn=!0),c.memoizedState=m,c.baseState=A,c.baseQueue=H,d.lastRenderedState=m}if(a=d.interleaved,a!==null){v=a;do w=v.lane,Pt.lanes|=w,Pa|=w,v=v.next;while(v!==a)}else v===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function m0(a){var c=Wi(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var m=d.dispatch,v=d.pending,w=c.memoizedState;if(v!==null){d.pending=null;var A=v=v.next;do w=a(w,A.action),A=A.next;while(A!==v);ar(w,c.memoizedState)||(Jn=!0),c.memoizedState=w,c.baseQueue===null&&(c.baseState=w),d.lastRenderedState=w}return[w,m]}function FE(){}function VE(a,c){var d=Pt,m=Wi(),v=c(),w=!ar(m.memoizedState,v);if(w&&(m.memoizedState=v,Jn=!0),m=m.queue,y0(BE.bind(null,d,m,a),[a]),m.getSnapshot!==c||w||an!==null&&an.memoizedState.tag&1){if(d.flags|=2048,wh(9,UE.bind(null,d,m,v,c),void 0,null),ln===null)throw Error(t(349));(Aa&30)!==0||zE(d,c,v)}return v}function zE(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function UE(a,c,d,m){c.value=d,c.getSnapshot=m,WE(c)&&GE(a)}function BE(a,c,d){return d(function(){WE(c)&&GE(a)})}function WE(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!ar(a,d)}catch{return!0}}function GE(a){var c=As(a,1);c!==null&&dr(c,a,1,-1)}function $E(a){var c=Yr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xh,lastRenderedState:a},c.queue=a,a=a.dispatch=CM.bind(null,Pt,a),[c.memoizedState,a]}function wh(a,c,d,m){return a={tag:a,create:c,destroy:d,deps:m,next:null},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(m=d.next,d.next=a,a.next=m,c.lastEffect=a)),a}function HE(){return Wi().memoizedState}function dg(a,c,d,m){var v=Yr();Pt.flags|=a,v.memoizedState=wh(1|c,d,void 0,m===void 0?null:m)}function fg(a,c,d,m){var v=Wi();m=m===void 0?null:m;var w=void 0;if(Qt!==null){var A=Qt.memoizedState;if(w=A.destroy,m!==null&&d0(m,A.deps)){v.memoizedState=wh(c,d,w,m);return}}Pt.flags|=a,v.memoizedState=wh(1|c,d,w,m)}function KE(a,c){return dg(8390656,8,a,c)}function y0(a,c){return fg(2048,8,a,c)}function qE(a,c){return fg(4,2,a,c)}function XE(a,c){return fg(4,4,a,c)}function YE(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function ZE(a,c,d){return d=d!=null?d.concat([a]):null,fg(4,4,YE.bind(null,c,a),d)}function _0(){}function QE(a,c){var d=Wi();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&d0(c,m[1])?m[0]:(d.memoizedState=[a,c],a)}function JE(a,c){var d=Wi();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&d0(c,m[1])?m[0]:(a=a(),d.memoizedState=[a,c],a)}function eT(a,c,d){return(Aa&21)===0?(a.baseState&&(a.baseState=!1,Jn=!0),a.memoizedState=d):(ar(d,c)||(d=Ku(),Pt.lanes|=d,Pa|=d,a.baseState=!0),c)}function SM(a,c){var d=Ye;Ye=d!==0&&4>d?d:4,a(!0);var m=h0.transition;h0.transition={};try{a(!1),c()}finally{Ye=d,h0.transition=m}}function tT(){return Wi().memoizedState}function IM(a,c,d){var m=To(a);if(d={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null},nT(a))iT(c,d);else if(d=DE(a,c,d,m),d!==null){var v=Hn();dr(d,a,m,v),rT(d,c,m)}}function CM(a,c,d){var m=To(a),v={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null};if(nT(a))iT(c,v);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=c.lastRenderedReducer,w!==null))try{var A=c.lastRenderedState,z=w(A,d);if(v.hasEagerState=!0,v.eagerState=z,ar(z,A)){var H=c.interleaved;H===null?(v.next=v,s0(c)):(v.next=H.next,H.next=v),c.interleaved=v;return}}catch{}d=DE(a,c,v,m),d!==null&&(v=Hn(),dr(d,a,m,v),rT(d,c,m))}}function nT(a){var c=a.alternate;return a===Pt||c!==null&&c===Pt}function iT(a,c){_h=hg=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function rT(a,c,d){if((d&4194240)!==0){var m=c.lanes;m&=a.pendingLanes,d|=m,c.lanes=d,Xu(a,d)}}var gg={readContext:Bi,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useInsertionEffect:kn,useLayoutEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useMutableSource:kn,useSyncExternalStore:kn,useId:kn,unstable_isNewReconciler:!1},RM={readContext:Bi,useCallback:function(a,c){return Yr().memoizedState=[a,c===void 0?null:c],a},useContext:Bi,useEffect:KE,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,dg(4194308,4,YE.bind(null,c,a),d)},useLayoutEffect:function(a,c){return dg(4194308,4,a,c)},useInsertionEffect:function(a,c){return dg(4,2,a,c)},useMemo:function(a,c){var d=Yr();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var m=Yr();return c=d!==void 0?d(c):c,m.memoizedState=m.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},m.queue=a,a=a.dispatch=IM.bind(null,Pt,a),[m.memoizedState,a]},useRef:function(a){var c=Yr();return a={current:a},c.memoizedState=a},useState:$E,useDebugValue:_0,useDeferredValue:function(a){return Yr().memoizedState=a},useTransition:function(){var a=$E(!1),c=a[0];return a=SM.bind(null,a[1]),Yr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var m=Pt,v=Yr();if(Ct){if(d===void 0)throw Error(t(407));d=d()}else{if(d=c(),ln===null)throw Error(t(349));(Aa&30)!==0||zE(m,c,d)}v.memoizedState=d;var w={value:d,getSnapshot:c};return v.queue=w,KE(BE.bind(null,m,w,a),[a]),m.flags|=2048,wh(9,UE.bind(null,m,w,d,c),void 0,null),d},useId:function(){var a=Yr(),c=ln.identifierPrefix;if(Ct){var d=bs,m=Rs;d=(m&~(1<<32-mi(m)-1)).toString(32)+d,c=":"+c+"R"+d,d=vh++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=TM++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},bM={readContext:Bi,useCallback:QE,useContext:Bi,useEffect:y0,useImperativeHandle:ZE,useInsertionEffect:qE,useLayoutEffect:XE,useMemo:JE,useReducer:p0,useRef:HE,useState:function(){return p0(xh)},useDebugValue:_0,useDeferredValue:function(a){var c=Wi();return eT(c,Qt.memoizedState,a)},useTransition:function(){var a=p0(xh)[0],c=Wi().memoizedState;return[a,c]},useMutableSource:FE,useSyncExternalStore:VE,useId:tT,unstable_isNewReconciler:!1},AM={readContext:Bi,useCallback:QE,useContext:Bi,useEffect:y0,useImperativeHandle:ZE,useInsertionEffect:qE,useLayoutEffect:XE,useMemo:JE,useReducer:m0,useRef:HE,useState:function(){return m0(xh)},useDebugValue:_0,useDeferredValue:function(a){var c=Wi();return Qt===null?c.memoizedState=a:eT(c,Qt.memoizedState,a)},useTransition:function(){var a=m0(xh)[0],c=Wi().memoizedState;return[a,c]},useMutableSource:FE,useSyncExternalStore:VE,useId:tT,unstable_isNewReconciler:!1};function cr(a,c){if(a&&a.defaultProps){c=ne({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function v0(a,c,d,m){c=a.memoizedState,d=d(m,c),d=d==null?c:ne({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var pg={isMounted:function(a){return(a=a._reactInternals)?sr(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var m=Hn(),v=To(a),w=Ps(m,v);w.payload=c,d!=null&&(w.callback=d),c=vo(a,w,v),c!==null&&(dr(c,a,v,m),ag(c,a,v))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var m=Hn(),v=To(a),w=Ps(m,v);w.tag=1,w.payload=c,d!=null&&(w.callback=d),c=vo(a,w,v),c!==null&&(dr(c,a,v,m),ag(c,a,v))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=Hn(),m=To(a),v=Ps(d,m);v.tag=2,c!=null&&(v.callback=c),c=vo(a,v,m),c!==null&&(dr(c,a,m,d),ag(c,a,m))}};function sT(a,c,d,m,v,w,A){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,w,A):c.prototype&&c.prototype.isPureReactComponent?!ah(d,m)||!ah(v,w):!0}function oT(a,c,d){var m=!1,v=mo,w=c.contextType;return typeof w=="object"&&w!==null?w=Bi(w):(v=Qn(c)?Sa:Pn.current,m=c.contextTypes,w=(m=m!=null)?sc(a,v):mo),c=new c(d,w),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=pg,a.stateNode=c,c._reactInternals=a,m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=w),c}function aT(a,c,d,m){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,m),c.state!==a&&pg.enqueueReplaceState(c,c.state,null)}function x0(a,c,d,m){var v=a.stateNode;v.props=d,v.state=a.memoizedState,v.refs={},o0(a);var w=c.contextType;typeof w=="object"&&w!==null?v.context=Bi(w):(w=Qn(c)?Sa:Pn.current,v.context=sc(a,w)),v.state=a.memoizedState,w=c.getDerivedStateFromProps,typeof w=="function"&&(v0(a,c,w,d),v.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(c=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),c!==v.state&&pg.enqueueReplaceState(v,v.state,null),lg(a,d,v,m),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function fc(a,c){try{var d="",m=c;do d+=xe(m),m=m.return;while(m);var v=d}catch(w){v=`
Error generating stack: `+w.message+`
`+w.stack}return{value:a,source:c,stack:v,digest:null}}function w0(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function E0(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var PM=typeof WeakMap=="function"?WeakMap:Map;function lT(a,c,d){d=Ps(-1,d),d.tag=3,d.payload={element:null};var m=c.value;return d.callback=function(){Eg||(Eg=!0,j0=m),E0(a,c)},d}function cT(a,c,d){d=Ps(-1,d),d.tag=3;var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var v=c.value;d.payload=function(){return m(v)},d.callback=function(){E0(a,c)}}var w=a.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(d.callback=function(){E0(a,c),typeof m!="function"&&(wo===null?wo=new Set([this]):wo.add(this));var A=c.stack;this.componentDidCatch(c.value,{componentStack:A!==null?A:""})}),d}function uT(a,c,d){var m=a.pingCache;if(m===null){m=a.pingCache=new PM;var v=new Set;m.set(c,v)}else v=m.get(c),v===void 0&&(v=new Set,m.set(c,v));v.has(d)||(v.add(d),a=GM.bind(null,a,c,d),c.then(a,a))}function hT(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function dT(a,c,d,m,v){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=Ps(-1,1),c.tag=2,vo(d,c,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=v,a)}var kM=L.ReactCurrentOwner,Jn=!1;function $n(a,c,d,m){c.child=a===null?NE(c,null,d,m):cc(c,a.child,d,m)}function fT(a,c,d,m,v){d=d.render;var w=c.ref;return hc(c,v),m=f0(a,c,d,m,w,v),d=g0(),a!==null&&!Jn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,ks(a,c,v)):(Ct&&d&&Yy(c),c.flags|=1,$n(a,c,m,v),c.child)}function gT(a,c,d,m,v){if(a===null){var w=d.type;return typeof w=="function"&&!G0(w)&&w.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=w,pT(a,c,w,m,v)):(a=bg(d.type,null,m,c,c.mode,v),a.ref=c.ref,a.return=c,c.child=a)}if(w=a.child,(a.lanes&v)===0){var A=w.memoizedProps;if(d=d.compare,d=d!==null?d:ah,d(A,m)&&a.ref===c.ref)return ks(a,c,v)}return c.flags|=1,a=Io(w,m),a.ref=c.ref,a.return=c,c.child=a}function pT(a,c,d,m,v){if(a!==null){var w=a.memoizedProps;if(ah(w,m)&&a.ref===c.ref)if(Jn=!1,c.pendingProps=m=w,(a.lanes&v)!==0)(a.flags&131072)!==0&&(Jn=!0);else return c.lanes=a.lanes,ks(a,c,v)}return T0(a,c,d,m,v)}function mT(a,c,d){var m=c.pendingProps,v=m.children,w=a!==null?a.memoizedState:null;if(m.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(pc,Ti),Ti|=d;else{if((d&1073741824)===0)return a=w!==null?w.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,vt(pc,Ti),Ti|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=w!==null?w.baseLanes:d,vt(pc,Ti),Ti|=m}else w!==null?(m=w.baseLanes|d,c.memoizedState=null):m=d,vt(pc,Ti),Ti|=m;return $n(a,c,v,d),c.child}function yT(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function T0(a,c,d,m,v){var w=Qn(d)?Sa:Pn.current;return w=sc(c,w),hc(c,v),d=f0(a,c,d,m,w,v),m=g0(),a!==null&&!Jn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,ks(a,c,v)):(Ct&&m&&Yy(c),c.flags|=1,$n(a,c,d,v),c.child)}function _T(a,c,d,m,v){if(Qn(d)){var w=!0;Jf(c)}else w=!1;if(hc(c,v),c.stateNode===null)yg(a,c),oT(c,d,m),x0(c,d,m,v),m=!0;else if(a===null){var A=c.stateNode,z=c.memoizedProps;A.props=z;var H=A.context,J=d.contextType;typeof J=="object"&&J!==null?J=Bi(J):(J=Qn(d)?Sa:Pn.current,J=sc(c,J));var le=d.getDerivedStateFromProps,he=typeof le=="function"||typeof A.getSnapshotBeforeUpdate=="function";he||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(z!==m||H!==J)&&aT(c,A,m,J),_o=!1;var ae=c.memoizedState;A.state=ae,lg(c,m,A,v),H=c.memoizedState,z!==m||ae!==H||Zn.current||_o?(typeof le=="function"&&(v0(c,d,le,m),H=c.memoizedState),(z=_o||sT(c,d,z,m,ae,H,J))?(he||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=H),A.props=m,A.state=H,A.context=J,m=z):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{A=c.stateNode,ME(a,c),z=c.memoizedProps,J=c.type===c.elementType?z:cr(c.type,z),A.props=J,he=c.pendingProps,ae=A.context,H=d.contextType,typeof H=="object"&&H!==null?H=Bi(H):(H=Qn(d)?Sa:Pn.current,H=sc(c,H));var ve=d.getDerivedStateFromProps;(le=typeof ve=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(z!==he||ae!==H)&&aT(c,A,m,H),_o=!1,ae=c.memoizedState,A.state=ae,lg(c,m,A,v);var Te=c.memoizedState;z!==he||ae!==Te||Zn.current||_o?(typeof ve=="function"&&(v0(c,d,ve,m),Te=c.memoizedState),(J=_o||sT(c,d,J,m,ae,Te,H)||!1)?(le||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(m,Te,H),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(m,Te,H)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||z===a.memoizedProps&&ae===a.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&ae===a.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=Te),A.props=m,A.state=Te,A.context=H,m=J):(typeof A.componentDidUpdate!="function"||z===a.memoizedProps&&ae===a.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||z===a.memoizedProps&&ae===a.memoizedState||(c.flags|=1024),m=!1)}return S0(a,c,d,m,w,v)}function S0(a,c,d,m,v,w){yT(a,c);var A=(c.flags&128)!==0;if(!m&&!A)return v&&TE(c,d,!1),ks(a,c,w);m=c.stateNode,kM.current=c;var z=A&&typeof d.getDerivedStateFromError!="function"?null:m.render();return c.flags|=1,a!==null&&A?(c.child=cc(c,a.child,null,w),c.child=cc(c,null,z,w)):$n(a,c,z,w),c.memoizedState=m.state,v&&TE(c,d,!0),c.child}function vT(a){var c=a.stateNode;c.pendingContext?wE(a,c.pendingContext,c.pendingContext!==c.context):c.context&&wE(a,c.context,!1),a0(a,c.containerInfo)}function xT(a,c,d,m,v){return lc(),e0(v),c.flags|=256,$n(a,c,d,m),c.child}var I0={dehydrated:null,treeContext:null,retryLane:0};function C0(a){return{baseLanes:a,cachePool:null,transitions:null}}function wT(a,c,d){var m=c.pendingProps,v=At.current,w=!1,A=(c.flags&128)!==0,z;if((z=A)||(z=a!==null&&a.memoizedState===null?!1:(v&2)!==0),z?(w=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),vt(At,v&1),a===null)return Jy(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(A=m.children,a=m.fallback,w?(m=c.mode,w=c.child,A={mode:"hidden",children:A},(m&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=A):w=Ag(A,m,0,null),a=Ma(a,m,d,null),w.return=c,a.return=c,w.sibling=a,c.child=w,c.child.memoizedState=C0(d),c.memoizedState=I0,a):R0(c,A));if(v=a.memoizedState,v!==null&&(z=v.dehydrated,z!==null))return NM(a,c,A,m,z,v,d);if(w){w=m.fallback,A=c.mode,v=a.child,z=v.sibling;var H={mode:"hidden",children:m.children};return(A&1)===0&&c.child!==v?(m=c.child,m.childLanes=0,m.pendingProps=H,c.deletions=null):(m=Io(v,H),m.subtreeFlags=v.subtreeFlags&14680064),z!==null?w=Io(z,w):(w=Ma(w,A,d,null),w.flags|=2),w.return=c,m.return=c,m.sibling=w,c.child=m,m=w,w=c.child,A=a.child.memoizedState,A=A===null?C0(d):{baseLanes:A.baseLanes|d,cachePool:null,transitions:A.transitions},w.memoizedState=A,w.childLanes=a.childLanes&~d,c.memoizedState=I0,m}return w=a.child,a=w.sibling,m=Io(w,{mode:"visible",children:m.children}),(c.mode&1)===0&&(m.lanes=d),m.return=c,m.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=m,c.memoizedState=null,m}function R0(a,c){return c=Ag({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function mg(a,c,d,m){return m!==null&&e0(m),cc(c,a.child,null,d),a=R0(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function NM(a,c,d,m,v,w,A){if(d)return c.flags&256?(c.flags&=-257,m=w0(Error(t(422))),mg(a,c,A,m)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(w=m.fallback,v=c.mode,m=Ag({mode:"visible",children:m.children},v,0,null),w=Ma(w,v,A,null),w.flags|=2,m.return=c,w.return=c,m.sibling=w,c.child=m,(c.mode&1)!==0&&cc(c,a.child,null,A),c.child.memoizedState=C0(A),c.memoizedState=I0,w);if((c.mode&1)===0)return mg(a,c,A,null);if(v.data==="$!"){if(m=v.nextSibling&&v.nextSibling.dataset,m)var z=m.dgst;return m=z,w=Error(t(419)),m=w0(w,m,void 0),mg(a,c,A,m)}if(z=(A&a.childLanes)!==0,Jn||z){if(m=ln,m!==null){switch(A&-A){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(m.suspendedLanes|A))!==0?0:v,v!==0&&v!==w.retryLane&&(w.retryLane=v,As(a,v),dr(m,a,v,-1))}return W0(),m=w0(Error(t(421))),mg(a,c,A,m)}return v.data==="$?"?(c.flags|=128,c.child=a.child,c=$M.bind(null,a),v._reactRetry=c,null):(a=w.treeContext,Ei=go(v.nextSibling),wi=c,Ct=!0,lr=null,a!==null&&(zi[Ui++]=Rs,zi[Ui++]=bs,zi[Ui++]=Ia,Rs=a.id,bs=a.overflow,Ia=c),c=R0(c,m.children),c.flags|=4096,c)}function ET(a,c,d){a.lanes|=c;var m=a.alternate;m!==null&&(m.lanes|=c),r0(a.return,c,d)}function b0(a,c,d,m,v){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:v}:(w.isBackwards=c,w.rendering=null,w.renderingStartTime=0,w.last=m,w.tail=d,w.tailMode=v)}function TT(a,c,d){var m=c.pendingProps,v=m.revealOrder,w=m.tail;if($n(a,c,m.children,d),m=At.current,(m&2)!==0)m=m&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&ET(a,d,c);else if(a.tag===19)ET(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}if(vt(At,m),(c.mode&1)===0)c.memoizedState=null;else switch(v){case"forwards":for(d=c.child,v=null;d!==null;)a=d.alternate,a!==null&&cg(a)===null&&(v=d),d=d.sibling;d=v,d===null?(v=c.child,c.child=null):(v=d.sibling,d.sibling=null),b0(c,!1,v,d,w);break;case"backwards":for(d=null,v=c.child,c.child=null;v!==null;){if(a=v.alternate,a!==null&&cg(a)===null){c.child=v;break}a=v.sibling,v.sibling=d,d=v,v=a}b0(c,!0,d,null,w);break;case"together":b0(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function yg(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function ks(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),Pa|=c.lanes,(d&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,d=Io(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=Io(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function DM(a,c,d){switch(c.tag){case 3:vT(c),lc();break;case 5:jE(c);break;case 1:Qn(c.type)&&Jf(c);break;case 4:a0(c,c.stateNode.containerInfo);break;case 10:var m=c.type._context,v=c.memoizedProps.value;vt(sg,m._currentValue),m._currentValue=v;break;case 13:if(m=c.memoizedState,m!==null)return m.dehydrated!==null?(vt(At,At.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?wT(a,c,d):(vt(At,At.current&1),a=ks(a,c,d),a!==null?a.sibling:null);vt(At,At.current&1);break;case 19:if(m=(d&c.childLanes)!==0,(a.flags&128)!==0){if(m)return TT(a,c,d);c.flags|=128}if(v=c.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),vt(At,At.current),m)break;return null;case 22:case 23:return c.lanes=0,mT(a,c,d)}return ks(a,c,d)}var ST,A0,IT,CT;ST=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},A0=function(){},IT=function(a,c,d,m){var v=a.memoizedProps;if(v!==m){a=c.stateNode,ba(Xr.current);var w=null;switch(d){case"input":v=bn(a,v),m=bn(a,m),w=[];break;case"select":v=ne({},v,{value:void 0}),m=ne({},m,{value:void 0}),w=[];break;case"textarea":v=Di(a,v),m=Di(a,m),w=[];break;default:typeof v.onClick!="function"&&typeof m.onClick=="function"&&(a.onclick=Yf)}Bn(d,m);var A;d=null;for(J in v)if(!m.hasOwnProperty(J)&&v.hasOwnProperty(J)&&v[J]!=null)if(J==="style"){var z=v[J];for(A in z)z.hasOwnProperty(A)&&(d||(d={}),d[A]="")}else J!=="dangerouslySetInnerHTML"&&J!=="children"&&J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(r.hasOwnProperty(J)?w||(w=[]):(w=w||[]).push(J,null));for(J in m){var H=m[J];if(z=v?.[J],m.hasOwnProperty(J)&&H!==z&&(H!=null||z!=null))if(J==="style")if(z){for(A in z)!z.hasOwnProperty(A)||H&&H.hasOwnProperty(A)||(d||(d={}),d[A]="");for(A in H)H.hasOwnProperty(A)&&z[A]!==H[A]&&(d||(d={}),d[A]=H[A])}else d||(w||(w=[]),w.push(J,d)),d=H;else J==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,z=z?z.__html:void 0,H!=null&&z!==H&&(w=w||[]).push(J,H)):J==="children"?typeof H!="string"&&typeof H!="number"||(w=w||[]).push(J,""+H):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&(r.hasOwnProperty(J)?(H!=null&&J==="onScroll"&&wt("scroll",a),w||z===H||(w=[])):(w=w||[]).push(J,H))}d&&(w=w||[]).push("style",d);var J=w;(c.updateQueue=J)&&(c.flags|=4)}},CT=function(a,c,d,m){d!==m&&(c.flags|=4)};function Eh(a,c){if(!Ct)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function Nn(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,m=0;if(c)for(var v=a.child;v!==null;)d|=v.lanes|v.childLanes,m|=v.subtreeFlags&14680064,m|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)d|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=m,a.childLanes=d,c}function MM(a,c,d){var m=c.pendingProps;switch(Zy(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nn(c),null;case 1:return Qn(c.type)&&Qf(),Nn(c),null;case 3:return m=c.stateNode,dc(),Et(Zn),Et(Pn),u0(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(ig(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,lr!==null&&(z0(lr),lr=null))),A0(a,c),Nn(c),null;case 5:l0(c);var v=ba(yh.current);if(d=c.type,a!==null&&c.stateNode!=null)IT(a,c,d,m,v),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!m){if(c.stateNode===null)throw Error(t(166));return Nn(c),null}if(a=ba(Xr.current),ig(c)){m=c.stateNode,d=c.type;var w=c.memoizedProps;switch(m[qr]=c,m[dh]=w,a=(c.mode&1)!==0,d){case"dialog":wt("cancel",m),wt("close",m);break;case"iframe":case"object":case"embed":wt("load",m);break;case"video":case"audio":for(v=0;v<ch.length;v++)wt(ch[v],m);break;case"source":wt("error",m);break;case"img":case"image":case"link":wt("error",m),wt("load",m);break;case"details":wt("toggle",m);break;case"input":fn(m,w),wt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!w.multiple},wt("invalid",m);break;case"textarea":It(m,w),wt("invalid",m)}Bn(d,w),v=null;for(var A in w)if(w.hasOwnProperty(A)){var z=w[A];A==="children"?typeof z=="string"?m.textContent!==z&&(w.suppressHydrationWarning!==!0&&Xf(m.textContent,z,a),v=["children",z]):typeof z=="number"&&m.textContent!==""+z&&(w.suppressHydrationWarning!==!0&&Xf(m.textContent,z,a),v=["children",""+z]):r.hasOwnProperty(A)&&z!=null&&A==="onScroll"&&wt("scroll",m)}switch(d){case"input":Wt(m),Ni(m,w,!0);break;case"textarea":Wt(m),Mi(m);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(m.onclick=Yf)}m=v,c.updateQueue=m,m!==null&&(c.flags|=4)}else{A=v.nodeType===9?v:v.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Pr(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=A.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof m.is=="string"?a=A.createElement(d,{is:m.is}):(a=A.createElement(d),d==="select"&&(A=a,m.multiple?A.multiple=!0:m.size&&(A.size=m.size))):a=A.createElementNS(a,d),a[qr]=c,a[dh]=m,ST(a,c,!1,!1),c.stateNode=a;e:{switch(A=ys(d,m),d){case"dialog":wt("cancel",a),wt("close",a),v=m;break;case"iframe":case"object":case"embed":wt("load",a),v=m;break;case"video":case"audio":for(v=0;v<ch.length;v++)wt(ch[v],a);v=m;break;case"source":wt("error",a),v=m;break;case"img":case"image":case"link":wt("error",a),wt("load",a),v=m;break;case"details":wt("toggle",a),v=m;break;case"input":fn(a,m),v=bn(a,m),wt("invalid",a);break;case"option":v=m;break;case"select":a._wrapperState={wasMultiple:!!m.multiple},v=ne({},m,{value:void 0}),wt("invalid",a);break;case"textarea":It(a,m),v=Di(a,m),wt("invalid",a);break;default:v=m}Bn(d,v),z=v;for(w in z)if(z.hasOwnProperty(w)){var H=z[w];w==="style"?ms(a,H):w==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,H!=null&&ua(a,H)):w==="children"?typeof H=="string"?(d!=="textarea"||H!=="")&&Nr(a,H):typeof H=="number"&&Nr(a,""+H):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(r.hasOwnProperty(w)?H!=null&&w==="onScroll"&&wt("scroll",a):H!=null&&M(a,w,H,A))}switch(d){case"input":Wt(a),Ni(a,m,!1);break;case"textarea":Wt(a),Mi(a);break;case"option":m.value!=null&&a.setAttribute("value",""+we(m.value));break;case"select":a.multiple=!!m.multiple,w=m.value,w!=null?sn(a,!!m.multiple,w,!1):m.defaultValue!=null&&sn(a,!!m.multiple,m.defaultValue,!0);break;default:typeof v.onClick=="function"&&(a.onclick=Yf)}switch(d){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Nn(c),null;case 6:if(a&&c.stateNode!=null)CT(a,c,a.memoizedProps,m);else{if(typeof m!="string"&&c.stateNode===null)throw Error(t(166));if(d=ba(yh.current),ba(Xr.current),ig(c)){if(m=c.stateNode,d=c.memoizedProps,m[qr]=c,(w=m.nodeValue!==d)&&(a=wi,a!==null))switch(a.tag){case 3:Xf(m.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Xf(m.nodeValue,d,(a.mode&1)!==0)}w&&(c.flags|=4)}else m=(d.nodeType===9?d:d.ownerDocument).createTextNode(m),m[qr]=c,c.stateNode=m}return Nn(c),null;case 13:if(Et(At),m=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Ct&&Ei!==null&&(c.mode&1)!==0&&(c.flags&128)===0)AE(),lc(),c.flags|=98560,w=!1;else if(w=ig(c),m!==null&&m.dehydrated!==null){if(a===null){if(!w)throw Error(t(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[qr]=c}else lc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Nn(c),w=!1}else lr!==null&&(z0(lr),lr=null),w=!0;if(!w)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(m=m!==null,m!==(a!==null&&a.memoizedState!==null)&&m&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(At.current&1)!==0?Jt===0&&(Jt=3):W0())),c.updateQueue!==null&&(c.flags|=4),Nn(c),null);case 4:return dc(),A0(a,c),a===null&&uh(c.stateNode.containerInfo),Nn(c),null;case 10:return i0(c.type._context),Nn(c),null;case 17:return Qn(c.type)&&Qf(),Nn(c),null;case 19:if(Et(At),w=c.memoizedState,w===null)return Nn(c),null;if(m=(c.flags&128)!==0,A=w.rendering,A===null)if(m)Eh(w,!1);else{if(Jt!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(A=cg(a),A!==null){for(c.flags|=128,Eh(w,!1),m=A.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),c.subtreeFlags=0,m=d,d=c.child;d!==null;)w=d,a=m,w.flags&=14680066,A=w.alternate,A===null?(w.childLanes=0,w.lanes=a,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=A.childLanes,w.lanes=A.lanes,w.child=A.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=A.memoizedProps,w.memoizedState=A.memoizedState,w.updateQueue=A.updateQueue,w.type=A.type,a=A.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return vt(At,At.current&1|2),c.child}a=a.sibling}w.tail!==null&&xt()>mc&&(c.flags|=128,m=!0,Eh(w,!1),c.lanes=4194304)}else{if(!m)if(a=cg(A),a!==null){if(c.flags|=128,m=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),Eh(w,!0),w.tail===null&&w.tailMode==="hidden"&&!A.alternate&&!Ct)return Nn(c),null}else 2*xt()-w.renderingStartTime>mc&&d!==1073741824&&(c.flags|=128,m=!0,Eh(w,!1),c.lanes=4194304);w.isBackwards?(A.sibling=c.child,c.child=A):(d=w.last,d!==null?d.sibling=A:c.child=A,w.last=A)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=xt(),c.sibling=null,d=At.current,vt(At,m?d&1|2:d&1),c):(Nn(c),null);case 22:case 23:return B0(),m=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==m&&(c.flags|=8192),m&&(c.mode&1)!==0?(Ti&1073741824)!==0&&(Nn(c),c.subtreeFlags&6&&(c.flags|=8192)):Nn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function LM(a,c){switch(Zy(c),c.tag){case 1:return Qn(c.type)&&Qf(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return dc(),Et(Zn),Et(Pn),u0(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return l0(c),null;case 13:if(Et(At),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));lc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return Et(At),null;case 4:return dc(),null;case 10:return i0(c.type._context),null;case 22:case 23:return B0(),null;case 24:return null;default:return null}}var _g=!1,Dn=!1,OM=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function gc(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(m){Mt(a,c,m)}else d.current=null}function P0(a,c,d){try{d()}catch(m){Mt(a,c,m)}}var RT=!1;function jM(a,c){if(By=Es,a=sE(),My(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var v=m.anchorOffset,w=m.focusNode;m=m.focusOffset;try{d.nodeType,w.nodeType}catch{d=null;break e}var A=0,z=-1,H=-1,J=0,le=0,he=a,ae=null;t:for(;;){for(var ve;he!==d||v!==0&&he.nodeType!==3||(z=A+v),he!==w||m!==0&&he.nodeType!==3||(H=A+m),he.nodeType===3&&(A+=he.nodeValue.length),(ve=he.firstChild)!==null;)ae=he,he=ve;for(;;){if(he===a)break t;if(ae===d&&++J===v&&(z=A),ae===w&&++le===m&&(H=A),(ve=he.nextSibling)!==null)break;he=ae,ae=he.parentNode}he=ve}d=z===-1||H===-1?null:{start:z,end:H}}else d=null}d=d||{start:0,end:0}}else d=null;for(Wy={focusedElem:a,selectionRange:d},Es=!1,Ee=c;Ee!==null;)if(c=Ee,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,Ee=a;else for(;Ee!==null;){c=Ee;try{var Te=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Te!==null){var Se=Te.memoizedProps,zt=Te.memoizedState,X=c.stateNode,K=X.getSnapshotBeforeUpdate(c.elementType===c.type?Se:cr(c.type,Se),zt);X.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var Z=c.stateNode.containerInfo;Z.nodeType===1?Z.textContent="":Z.nodeType===9&&Z.documentElement&&Z.removeChild(Z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(fe){Mt(c,c.return,fe)}if(a=c.sibling,a!==null){a.return=c.return,Ee=a;break}Ee=c.return}return Te=RT,RT=!1,Te}function Th(a,c,d){var m=c.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var v=m=m.next;do{if((v.tag&a)===a){var w=v.destroy;v.destroy=void 0,w!==void 0&&P0(c,d,w)}v=v.next}while(v!==m)}}function vg(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var m=d.create;d.destroy=m()}d=d.next}while(d!==c)}}function k0(a){var c=a.ref;if(c!==null){var d=a.stateNode;a.tag,a=d,typeof c=="function"?c(a):c.current=a}}function bT(a){var c=a.alternate;c!==null&&(a.alternate=null,bT(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[qr],delete c[dh],delete c[Ky],delete c[vM],delete c[xM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function AT(a){return a.tag===5||a.tag===3||a.tag===4}function PT(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||AT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function N0(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=Yf));else if(m!==4&&(a=a.child,a!==null))for(N0(a,c,d),a=a.sibling;a!==null;)N0(a,c,d),a=a.sibling}function D0(a,c,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(m!==4&&(a=a.child,a!==null))for(D0(a,c,d),a=a.sibling;a!==null;)D0(a,c,d),a=a.sibling}var xn=null,ur=!1;function xo(a,c,d){for(d=d.child;d!==null;)kT(a,c,d),d=d.sibling}function kT(a,c,d){if(pi&&typeof pi.onCommitFiberUnmount=="function")try{pi.onCommitFiberUnmount(ga,d)}catch{}switch(d.tag){case 5:Dn||gc(d,c);case 6:var m=xn,v=ur;xn=null,xo(a,c,d),xn=m,ur=v,xn!==null&&(ur?(a=xn,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):xn.removeChild(d.stateNode));break;case 18:xn!==null&&(ur?(a=xn,d=d.stateNode,a.nodeType===8?Hy(a.parentNode,d):a.nodeType===1&&Hy(a,d),co(a)):Hy(xn,d.stateNode));break;case 4:m=xn,v=ur,xn=d.stateNode.containerInfo,ur=!0,xo(a,c,d),xn=m,ur=v;break;case 0:case 11:case 14:case 15:if(!Dn&&(m=d.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){v=m=m.next;do{var w=v,A=w.destroy;w=w.tag,A!==void 0&&((w&2)!==0||(w&4)!==0)&&P0(d,c,A),v=v.next}while(v!==m)}xo(a,c,d);break;case 1:if(!Dn&&(gc(d,c),m=d.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=d.memoizedProps,m.state=d.memoizedState,m.componentWillUnmount()}catch(z){Mt(d,c,z)}xo(a,c,d);break;case 21:xo(a,c,d);break;case 22:d.mode&1?(Dn=(m=Dn)||d.memoizedState!==null,xo(a,c,d),Dn=m):xo(a,c,d);break;default:xo(a,c,d)}}function NT(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new OM),c.forEach(function(m){var v=HM.bind(null,a,m);d.has(m)||(d.add(m),m.then(v,v))})}}function hr(a,c){var d=c.deletions;if(d!==null)for(var m=0;m<d.length;m++){var v=d[m];try{var w=a,A=c,z=A;e:for(;z!==null;){switch(z.tag){case 5:xn=z.stateNode,ur=!1;break e;case 3:xn=z.stateNode.containerInfo,ur=!0;break e;case 4:xn=z.stateNode.containerInfo,ur=!0;break e}z=z.return}if(xn===null)throw Error(t(160));kT(w,A,v),xn=null,ur=!1;var H=v.alternate;H!==null&&(H.return=null),v.return=null}catch(J){Mt(v,c,J)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)DT(c,a),c=c.sibling}function DT(a,c){var d=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(hr(c,a),Zr(a),m&4){try{Th(3,a,a.return),vg(3,a)}catch(Se){Mt(a,a.return,Se)}try{Th(5,a,a.return)}catch(Se){Mt(a,a.return,Se)}}break;case 1:hr(c,a),Zr(a),m&512&&d!==null&&gc(d,d.return);break;case 5:if(hr(c,a),Zr(a),m&512&&d!==null&&gc(d,d.return),a.flags&32){var v=a.stateNode;try{Nr(v,"")}catch(Se){Mt(a,a.return,Se)}}if(m&4&&(v=a.stateNode,v!=null)){var w=a.memoizedProps,A=d!==null?d.memoizedProps:w,z=a.type,H=a.updateQueue;if(a.updateQueue=null,H!==null)try{z==="input"&&w.type==="radio"&&w.name!=null&&gn(v,w),ys(z,A);var J=ys(z,w);for(A=0;A<H.length;A+=2){var le=H[A],he=H[A+1];le==="style"?ms(v,he):le==="dangerouslySetInnerHTML"?ua(v,he):le==="children"?Nr(v,he):M(v,le,he,J)}switch(z){case"input":Yn(v,w);break;case"textarea":io(v,w);break;case"select":var ae=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!w.multiple;var ve=w.value;ve!=null?sn(v,!!w.multiple,ve,!1):ae!==!!w.multiple&&(w.defaultValue!=null?sn(v,!!w.multiple,w.defaultValue,!0):sn(v,!!w.multiple,w.multiple?[]:"",!1))}v[dh]=w}catch(Se){Mt(a,a.return,Se)}}break;case 6:if(hr(c,a),Zr(a),m&4){if(a.stateNode===null)throw Error(t(162));v=a.stateNode,w=a.memoizedProps;try{v.nodeValue=w}catch(Se){Mt(a,a.return,Se)}}break;case 3:if(hr(c,a),Zr(a),m&4&&d!==null&&d.memoizedState.isDehydrated)try{co(c.containerInfo)}catch(Se){Mt(a,a.return,Se)}break;case 4:hr(c,a),Zr(a);break;case 13:hr(c,a),Zr(a),v=a.child,v.flags&8192&&(w=v.memoizedState!==null,v.stateNode.isHidden=w,!w||v.alternate!==null&&v.alternate.memoizedState!==null||(O0=xt())),m&4&&NT(a);break;case 22:if(le=d!==null&&d.memoizedState!==null,a.mode&1?(Dn=(J=Dn)||le,hr(c,a),Dn=J):hr(c,a),Zr(a),m&8192){if(J=a.memoizedState!==null,(a.stateNode.isHidden=J)&&!le&&(a.mode&1)!==0)for(Ee=a,le=a.child;le!==null;){for(he=Ee=le;Ee!==null;){switch(ae=Ee,ve=ae.child,ae.tag){case 0:case 11:case 14:case 15:Th(4,ae,ae.return);break;case 1:gc(ae,ae.return);var Te=ae.stateNode;if(typeof Te.componentWillUnmount=="function"){m=ae,d=ae.return;try{c=m,Te.props=c.memoizedProps,Te.state=c.memoizedState,Te.componentWillUnmount()}catch(Se){Mt(m,d,Se)}}break;case 5:gc(ae,ae.return);break;case 22:if(ae.memoizedState!==null){OT(he);continue}}ve!==null?(ve.return=ae,Ee=ve):OT(he)}le=le.sibling}e:for(le=null,he=a;;){if(he.tag===5){if(le===null){le=he;try{v=he.stateNode,J?(w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(z=he.stateNode,H=he.memoizedProps.style,A=H!=null&&H.hasOwnProperty("display")?H.display:null,z.style.display=Dr("display",A))}catch(Se){Mt(a,a.return,Se)}}}else if(he.tag===6){if(le===null)try{he.stateNode.nodeValue=J?"":he.memoizedProps}catch(Se){Mt(a,a.return,Se)}}else if((he.tag!==22&&he.tag!==23||he.memoizedState===null||he===a)&&he.child!==null){he.child.return=he,he=he.child;continue}if(he===a)break e;for(;he.sibling===null;){if(he.return===null||he.return===a)break e;le===he&&(le=null),he=he.return}le===he&&(le=null),he.sibling.return=he.return,he=he.sibling}}break;case 19:hr(c,a),Zr(a),m&4&&NT(a);break;case 21:break;default:hr(c,a),Zr(a)}}function Zr(a){var c=a.flags;if(c&2){try{e:{for(var d=a.return;d!==null;){if(AT(d)){var m=d;break e}d=d.return}throw Error(t(160))}switch(m.tag){case 5:var v=m.stateNode;m.flags&32&&(Nr(v,""),m.flags&=-33);var w=PT(a);D0(a,w,v);break;case 3:case 4:var A=m.stateNode.containerInfo,z=PT(a);N0(a,z,A);break;default:throw Error(t(161))}}catch(H){Mt(a,a.return,H)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function FM(a,c,d){Ee=a,MT(a)}function MT(a,c,d){for(var m=(a.mode&1)!==0;Ee!==null;){var v=Ee,w=v.child;if(v.tag===22&&m){var A=v.memoizedState!==null||_g;if(!A){var z=v.alternate,H=z!==null&&z.memoizedState!==null||Dn;z=_g;var J=Dn;if(_g=A,(Dn=H)&&!J)for(Ee=v;Ee!==null;)A=Ee,H=A.child,A.tag===22&&A.memoizedState!==null?jT(v):H!==null?(H.return=A,Ee=H):jT(v);for(;w!==null;)Ee=w,MT(w),w=w.sibling;Ee=v,_g=z,Dn=J}LT(a)}else(v.subtreeFlags&8772)!==0&&w!==null?(w.return=v,Ee=w):LT(a)}}function LT(a){for(;Ee!==null;){var c=Ee;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Dn||vg(5,c);break;case 1:var m=c.stateNode;if(c.flags&4&&!Dn)if(d===null)m.componentDidMount();else{var v=c.elementType===c.type?d.memoizedProps:cr(c.type,d.memoizedProps);m.componentDidUpdate(v,d.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var w=c.updateQueue;w!==null&&OE(c,w,m);break;case 3:var A=c.updateQueue;if(A!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}OE(c,A,d)}break;case 5:var z=c.stateNode;if(d===null&&c.flags&4){d=z;var H=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":H.autoFocus&&d.focus();break;case"img":H.src&&(d.src=H.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var J=c.alternate;if(J!==null){var le=J.memoizedState;if(le!==null){var he=le.dehydrated;he!==null&&co(he)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Dn||c.flags&512&&k0(c)}catch(ae){Mt(c,c.return,ae)}}if(c===a){Ee=null;break}if(d=c.sibling,d!==null){d.return=c.return,Ee=d;break}Ee=c.return}}function OT(a){for(;Ee!==null;){var c=Ee;if(c===a){Ee=null;break}var d=c.sibling;if(d!==null){d.return=c.return,Ee=d;break}Ee=c.return}}function jT(a){for(;Ee!==null;){var c=Ee;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{vg(4,c)}catch(H){Mt(c,d,H)}break;case 1:var m=c.stateNode;if(typeof m.componentDidMount=="function"){var v=c.return;try{m.componentDidMount()}catch(H){Mt(c,v,H)}}var w=c.return;try{k0(c)}catch(H){Mt(c,w,H)}break;case 5:var A=c.return;try{k0(c)}catch(H){Mt(c,A,H)}}}catch(H){Mt(c,c.return,H)}if(c===a){Ee=null;break}var z=c.sibling;if(z!==null){z.return=c.return,Ee=z;break}Ee=c.return}}var VM=Math.ceil,xg=L.ReactCurrentDispatcher,M0=L.ReactCurrentOwner,Gi=L.ReactCurrentBatchConfig,tt=0,ln=null,Ht=null,wn=0,Ti=0,pc=po(0),Jt=0,Sh=null,Pa=0,wg=0,L0=0,Ih=null,ei=null,O0=0,mc=1/0,Ns=null,Eg=!1,j0=null,wo=null,Tg=!1,Eo=null,Sg=0,Ch=0,F0=null,Ig=-1,Cg=0;function Hn(){return(tt&6)!==0?xt():Ig!==-1?Ig:Ig=xt()}function To(a){return(a.mode&1)===0?1:(tt&2)!==0&&wn!==0?wn&-wn:EM.transition!==null?(Cg===0&&(Cg=Ku()),Cg):(a=Ye,a!==0||(a=window.event,a=a===void 0?16:$l(a.type)),a)}function dr(a,c,d,m){if(50<Ch)throw Ch=0,F0=null,Error(t(185));_a(a,d,m),((tt&2)===0||a!==ln)&&(a===ln&&((tt&2)===0&&(wg|=d),Jt===4&&So(a,wn)),ti(a,m),d===1&&tt===0&&(c.mode&1)===0&&(mc=xt()+500,eg&&yo()))}function ti(a,c){var d=a.callbackNode;ya(a,c);var m=vs(a,a===ln?wn:0);if(m===0)d!==null&&Fl(d),a.callbackNode=null,a.callbackPriority=0;else if(c=m&-m,a.callbackPriority!==c){if(d!=null&&Fl(d),c===1)a.tag===0?wM(VT.bind(null,a)):SE(VT.bind(null,a)),yM(function(){(tt&6)===0&&yo()}),d=null;else{switch(Fr(m)){case 1:d=Vl;break;case 4:d=Gu;break;case 16:d=fa;break;case 536870912:d=zl;break;default:d=fa}d=KT(d,FT.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function FT(a,c){if(Ig=-1,Cg=0,(tt&6)!==0)throw Error(t(327));var d=a.callbackNode;if(yc()&&a.callbackNode!==d)return null;var m=vs(a,a===ln?wn:0);if(m===0)return null;if((m&30)!==0||(m&a.expiredLanes)!==0||c)c=Rg(a,m);else{c=m;var v=tt;tt|=2;var w=UT();(ln!==a||wn!==c)&&(Ns=null,mc=xt()+500,Na(a,c));do try{BM();break}catch(z){zT(a,z)}while(!0);n0(),xg.current=w,tt=v,Ht!==null?c=0:(ln=null,wn=0,c=Jt)}if(c!==0){if(c===2&&(v=Hu(a),v!==0&&(m=v,c=V0(a,v))),c===1)throw d=Sh,Na(a,0),So(a,m),ti(a,xt()),d;if(c===6)So(a,m);else{if(v=a.current.alternate,(m&30)===0&&!zM(v)&&(c=Rg(a,m),c===2&&(w=Hu(a),w!==0&&(m=w,c=V0(a,w))),c===1))throw d=Sh,Na(a,0),So(a,m),ti(a,xt()),d;switch(a.finishedWork=v,a.finishedLanes=m,c){case 0:case 1:throw Error(t(345));case 2:Da(a,ei,Ns);break;case 3:if(So(a,m),(m&130023424)===m&&(c=O0+500-xt(),10<c)){if(vs(a,0)!==0)break;if(v=a.suspendedLanes,(v&m)!==m){Hn(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=$y(Da.bind(null,a,ei,Ns),c);break}Da(a,ei,Ns);break;case 4:if(So(a,m),(m&4194240)===m)break;for(c=a.eventTimes,v=-1;0<m;){var A=31-mi(m);w=1<<A,A=c[A],A>v&&(v=A),m&=~w}if(m=v,m=xt()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*VM(m/1960))-m,10<m){a.timeoutHandle=$y(Da.bind(null,a,ei,Ns),m);break}Da(a,ei,Ns);break;case 5:Da(a,ei,Ns);break;default:throw Error(t(329))}}}return ti(a,xt()),a.callbackNode===d?FT.bind(null,a):null}function V0(a,c){var d=Ih;return a.current.memoizedState.isDehydrated&&(Na(a,c).flags|=256),a=Rg(a,c),a!==2&&(c=ei,ei=d,c!==null&&z0(c)),a}function z0(a){ei===null?ei=a:ei.push.apply(ei,a)}function zM(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var m=0;m<d.length;m++){var v=d[m],w=v.getSnapshot;v=v.value;try{if(!ar(w(),v))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function So(a,c){for(c&=~L0,c&=~wg,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-mi(c),m=1<<d;a[d]=-1,c&=~m}}function VT(a){if((tt&6)!==0)throw Error(t(327));yc();var c=vs(a,0);if((c&1)===0)return ti(a,xt()),null;var d=Rg(a,c);if(a.tag!==0&&d===2){var m=Hu(a);m!==0&&(c=m,d=V0(a,m))}if(d===1)throw d=Sh,Na(a,0),So(a,c),ti(a,xt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Da(a,ei,Ns),ti(a,xt()),null}function U0(a,c){var d=tt;tt|=1;try{return a(c)}finally{tt=d,tt===0&&(mc=xt()+500,eg&&yo())}}function ka(a){Eo!==null&&Eo.tag===0&&(tt&6)===0&&yc();var c=tt;tt|=1;var d=Gi.transition,m=Ye;try{if(Gi.transition=null,Ye=1,a)return a()}finally{Ye=m,Gi.transition=d,tt=c,(tt&6)===0&&yo()}}function B0(){Ti=pc.current,Et(pc)}function Na(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,mM(d)),Ht!==null)for(d=Ht.return;d!==null;){var m=d;switch(Zy(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Qf();break;case 3:dc(),Et(Zn),Et(Pn),u0();break;case 5:l0(m);break;case 4:dc();break;case 13:Et(At);break;case 19:Et(At);break;case 10:i0(m.type._context);break;case 22:case 23:B0()}d=d.return}if(ln=a,Ht=a=Io(a.current,null),wn=Ti=c,Jt=0,Sh=null,L0=wg=Pa=0,ei=Ih=null,Ra!==null){for(c=0;c<Ra.length;c++)if(d=Ra[c],m=d.interleaved,m!==null){d.interleaved=null;var v=m.next,w=d.pending;if(w!==null){var A=w.next;w.next=v,m.next=A}d.pending=m}Ra=null}return a}function zT(a,c){do{var d=Ht;try{if(n0(),ug.current=gg,hg){for(var m=Pt.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}hg=!1}if(Aa=0,an=Qt=Pt=null,_h=!1,vh=0,M0.current=null,d===null||d.return===null){Jt=1,Sh=c,Ht=null;break}e:{var w=a,A=d.return,z=d,H=c;if(c=wn,z.flags|=32768,H!==null&&typeof H=="object"&&typeof H.then=="function"){var J=H,le=z,he=le.tag;if((le.mode&1)===0&&(he===0||he===11||he===15)){var ae=le.alternate;ae?(le.updateQueue=ae.updateQueue,le.memoizedState=ae.memoizedState,le.lanes=ae.lanes):(le.updateQueue=null,le.memoizedState=null)}var ve=hT(A);if(ve!==null){ve.flags&=-257,dT(ve,A,z,w,c),ve.mode&1&&uT(w,J,c),c=ve,H=J;var Te=c.updateQueue;if(Te===null){var Se=new Set;Se.add(H),c.updateQueue=Se}else Te.add(H);break e}else{if((c&1)===0){uT(w,J,c),W0();break e}H=Error(t(426))}}else if(Ct&&z.mode&1){var zt=hT(A);if(zt!==null){(zt.flags&65536)===0&&(zt.flags|=256),dT(zt,A,z,w,c),e0(fc(H,z));break e}}w=H=fc(H,z),Jt!==4&&(Jt=2),Ih===null?Ih=[w]:Ih.push(w),w=A;do{switch(w.tag){case 3:w.flags|=65536,c&=-c,w.lanes|=c;var X=lT(w,H,c);LE(w,X);break e;case 1:z=H;var K=w.type,Z=w.stateNode;if((w.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||Z!==null&&typeof Z.componentDidCatch=="function"&&(wo===null||!wo.has(Z)))){w.flags|=65536,c&=-c,w.lanes|=c;var fe=cT(w,z,c);LE(w,fe);break e}}w=w.return}while(w!==null)}WT(d)}catch(Re){c=Re,Ht===d&&d!==null&&(Ht=d=d.return);continue}break}while(!0)}function UT(){var a=xg.current;return xg.current=gg,a===null?gg:a}function W0(){(Jt===0||Jt===3||Jt===2)&&(Jt=4),ln===null||(Pa&268435455)===0&&(wg&268435455)===0||So(ln,wn)}function Rg(a,c){var d=tt;tt|=2;var m=UT();(ln!==a||wn!==c)&&(Ns=null,Na(a,c));do try{UM();break}catch(v){zT(a,v)}while(!0);if(n0(),tt=d,xg.current=m,Ht!==null)throw Error(t(261));return ln=null,wn=0,Jt}function UM(){for(;Ht!==null;)BT(Ht)}function BM(){for(;Ht!==null&&!da();)BT(Ht)}function BT(a){var c=HT(a.alternate,a,Ti);a.memoizedProps=a.pendingProps,c===null?WT(a):Ht=c,M0.current=null}function WT(a){var c=a;do{var d=c.alternate;if(a=c.return,(c.flags&32768)===0){if(d=MM(d,c,Ti),d!==null){Ht=d;return}}else{if(d=LM(d,c),d!==null){d.flags&=32767,Ht=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Jt=6,Ht=null;return}}if(c=c.sibling,c!==null){Ht=c;return}Ht=c=a}while(c!==null);Jt===0&&(Jt=5)}function Da(a,c,d){var m=Ye,v=Gi.transition;try{Gi.transition=null,Ye=1,WM(a,c,d,m)}finally{Gi.transition=v,Ye=m}return null}function WM(a,c,d,m){do yc();while(Eo!==null);if((tt&6)!==0)throw Error(t(327));d=a.finishedWork;var v=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var w=d.lanes|d.childLanes;if(Ay(a,w),a===ln&&(Ht=ln=null,wn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Tg||(Tg=!0,KT(fa,function(){return yc(),null})),w=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||w){w=Gi.transition,Gi.transition=null;var A=Ye;Ye=1;var z=tt;tt|=4,M0.current=null,jM(a,d),DT(d,a),cM(Wy),Es=!!By,Wy=By=null,a.current=d,FM(d),_s(),tt=z,Ye=A,Gi.transition=w}else a.current=d;if(Tg&&(Tg=!1,Eo=a,Sg=v),w=a.pendingLanes,w===0&&(wo=null),Mf(d.stateNode),ti(a,xt()),c!==null)for(m=a.onRecoverableError,d=0;d<c.length;d++)v=c[d],m(v.value,{componentStack:v.stack,digest:v.digest});if(Eg)throw Eg=!1,a=j0,j0=null,a;return(Sg&1)!==0&&a.tag!==0&&yc(),w=a.pendingLanes,(w&1)!==0?a===F0?Ch++:(Ch=0,F0=a):Ch=0,yo(),null}function yc(){if(Eo!==null){var a=Fr(Sg),c=Gi.transition,d=Ye;try{if(Gi.transition=null,Ye=16>a?16:a,Eo===null)var m=!1;else{if(a=Eo,Eo=null,Sg=0,(tt&6)!==0)throw Error(t(331));var v=tt;for(tt|=4,Ee=a.current;Ee!==null;){var w=Ee,A=w.child;if((Ee.flags&16)!==0){var z=w.deletions;if(z!==null){for(var H=0;H<z.length;H++){var J=z[H];for(Ee=J;Ee!==null;){var le=Ee;switch(le.tag){case 0:case 11:case 15:Th(8,le,w)}var he=le.child;if(he!==null)he.return=le,Ee=he;else for(;Ee!==null;){le=Ee;var ae=le.sibling,ve=le.return;if(bT(le),le===J){Ee=null;break}if(ae!==null){ae.return=ve,Ee=ae;break}Ee=ve}}}var Te=w.alternate;if(Te!==null){var Se=Te.child;if(Se!==null){Te.child=null;do{var zt=Se.sibling;Se.sibling=null,Se=zt}while(Se!==null)}}Ee=w}}if((w.subtreeFlags&2064)!==0&&A!==null)A.return=w,Ee=A;else e:for(;Ee!==null;){if(w=Ee,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:Th(9,w,w.return)}var X=w.sibling;if(X!==null){X.return=w.return,Ee=X;break e}Ee=w.return}}var K=a.current;for(Ee=K;Ee!==null;){A=Ee;var Z=A.child;if((A.subtreeFlags&2064)!==0&&Z!==null)Z.return=A,Ee=Z;else e:for(A=K;Ee!==null;){if(z=Ee,(z.flags&2048)!==0)try{switch(z.tag){case 0:case 11:case 15:vg(9,z)}}catch(Re){Mt(z,z.return,Re)}if(z===A){Ee=null;break e}var fe=z.sibling;if(fe!==null){fe.return=z.return,Ee=fe;break e}Ee=z.return}}if(tt=v,yo(),pi&&typeof pi.onPostCommitFiberRoot=="function")try{pi.onPostCommitFiberRoot(ga,a)}catch{}m=!0}return m}finally{Ye=d,Gi.transition=c}}return!1}function GT(a,c,d){c=fc(d,c),c=lT(a,c,1),a=vo(a,c,1),c=Hn(),a!==null&&(_a(a,1,c),ti(a,c))}function Mt(a,c,d){if(a.tag===3)GT(a,a,d);else for(;c!==null;){if(c.tag===3){GT(c,a,d);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(wo===null||!wo.has(m))){a=fc(d,a),a=cT(c,a,1),c=vo(c,a,1),a=Hn(),c!==null&&(_a(c,1,a),ti(c,a));break}}c=c.return}}function GM(a,c,d){var m=a.pingCache;m!==null&&m.delete(c),c=Hn(),a.pingedLanes|=a.suspendedLanes&d,ln===a&&(wn&d)===d&&(Jt===4||Jt===3&&(wn&130023424)===wn&&500>xt()-O0?Na(a,0):L0|=d),ti(a,c)}function $T(a,c){c===0&&((a.mode&1)===0?c=1:(c=oo,oo<<=1,(oo&130023424)===0&&(oo=4194304)));var d=Hn();a=As(a,c),a!==null&&(_a(a,c,d),ti(a,d))}function $M(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),$T(a,d)}function HM(a,c){var d=0;switch(a.tag){case 13:var m=a.stateNode,v=a.memoizedState;v!==null&&(d=v.retryLane);break;case 19:m=a.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(c),$T(a,d)}var HT;HT=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Zn.current)Jn=!0;else{if((a.lanes&d)===0&&(c.flags&128)===0)return Jn=!1,DM(a,c,d);Jn=(a.flags&131072)!==0}else Jn=!1,Ct&&(c.flags&1048576)!==0&&IE(c,ng,c.index);switch(c.lanes=0,c.tag){case 2:var m=c.type;yg(a,c),a=c.pendingProps;var v=sc(c,Pn.current);hc(c,d),v=f0(null,c,m,a,v,d);var w=g0();return c.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Qn(m)?(w=!0,Jf(c)):w=!1,c.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,o0(c),v.updater=pg,c.stateNode=v,v._reactInternals=c,x0(c,m,a,d),c=S0(null,c,m,!0,w,d)):(c.tag=0,Ct&&w&&Yy(c),$n(null,c,v,d),c=c.child),c;case 16:m=c.elementType;e:{switch(yg(a,c),a=c.pendingProps,v=m._init,m=v(m._payload),c.type=m,v=c.tag=qM(m),a=cr(m,a),v){case 0:c=T0(null,c,m,a,d);break e;case 1:c=_T(null,c,m,a,d);break e;case 11:c=fT(null,c,m,a,d);break e;case 14:c=gT(null,c,m,cr(m.type,a),d);break e}throw Error(t(306,m,""))}return c;case 0:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:cr(m,v),T0(a,c,m,v,d);case 1:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:cr(m,v),_T(a,c,m,v,d);case 3:e:{if(vT(c),a===null)throw Error(t(387));m=c.pendingProps,w=c.memoizedState,v=w.element,ME(a,c),lg(c,m,null,d);var A=c.memoizedState;if(m=A.element,w.isDehydrated)if(w={element:m,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},c.updateQueue.baseState=w,c.memoizedState=w,c.flags&256){v=fc(Error(t(423)),c),c=xT(a,c,m,d,v);break e}else if(m!==v){v=fc(Error(t(424)),c),c=xT(a,c,m,d,v);break e}else for(Ei=go(c.stateNode.containerInfo.firstChild),wi=c,Ct=!0,lr=null,d=NE(c,null,m,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(lc(),m===v){c=ks(a,c,d);break e}$n(a,c,m,d)}c=c.child}return c;case 5:return jE(c),a===null&&Jy(c),m=c.type,v=c.pendingProps,w=a!==null?a.memoizedProps:null,A=v.children,Gy(m,v)?A=null:w!==null&&Gy(m,w)&&(c.flags|=32),yT(a,c),$n(a,c,A,d),c.child;case 6:return a===null&&Jy(c),null;case 13:return wT(a,c,d);case 4:return a0(c,c.stateNode.containerInfo),m=c.pendingProps,a===null?c.child=cc(c,null,m,d):$n(a,c,m,d),c.child;case 11:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:cr(m,v),fT(a,c,m,v,d);case 7:return $n(a,c,c.pendingProps,d),c.child;case 8:return $n(a,c,c.pendingProps.children,d),c.child;case 12:return $n(a,c,c.pendingProps.children,d),c.child;case 10:e:{if(m=c.type._context,v=c.pendingProps,w=c.memoizedProps,A=v.value,vt(sg,m._currentValue),m._currentValue=A,w!==null)if(ar(w.value,A)){if(w.children===v.children&&!Zn.current){c=ks(a,c,d);break e}}else for(w=c.child,w!==null&&(w.return=c);w!==null;){var z=w.dependencies;if(z!==null){A=w.child;for(var H=z.firstContext;H!==null;){if(H.context===m){if(w.tag===1){H=Ps(-1,d&-d),H.tag=2;var J=w.updateQueue;if(J!==null){J=J.shared;var le=J.pending;le===null?H.next=H:(H.next=le.next,le.next=H),J.pending=H}}w.lanes|=d,H=w.alternate,H!==null&&(H.lanes|=d),r0(w.return,d,c),z.lanes|=d;break}H=H.next}}else if(w.tag===10)A=w.type===c.type?null:w.child;else if(w.tag===18){if(A=w.return,A===null)throw Error(t(341));A.lanes|=d,z=A.alternate,z!==null&&(z.lanes|=d),r0(A,d,c),A=w.sibling}else A=w.child;if(A!==null)A.return=w;else for(A=w;A!==null;){if(A===c){A=null;break}if(w=A.sibling,w!==null){w.return=A.return,A=w;break}A=A.return}w=A}$n(a,c,v.children,d),c=c.child}return c;case 9:return v=c.type,m=c.pendingProps.children,hc(c,d),v=Bi(v),m=m(v),c.flags|=1,$n(a,c,m,d),c.child;case 14:return m=c.type,v=cr(m,c.pendingProps),v=cr(m.type,v),gT(a,c,m,v,d);case 15:return pT(a,c,c.type,c.pendingProps,d);case 17:return m=c.type,v=c.pendingProps,v=c.elementType===m?v:cr(m,v),yg(a,c),c.tag=1,Qn(m)?(a=!0,Jf(c)):a=!1,hc(c,d),oT(c,m,v),x0(c,m,v,d),S0(null,c,m,!0,a,d);case 19:return TT(a,c,d);case 22:return mT(a,c,d)}throw Error(t(156,c.tag))};function KT(a,c){return Wu(a,c)}function KM(a,c,d,m){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $i(a,c,d,m){return new KM(a,c,d,m)}function G0(a){return a=a.prototype,!(!a||!a.isReactComponent)}function qM(a){if(typeof a=="function")return G0(a)?1:0;if(a!=null){if(a=a.$$typeof,a===B)return 11;if(a===de)return 14}return 2}function Io(a,c){var d=a.alternate;return d===null?(d=$i(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function bg(a,c,d,m,v,w){var A=2;if(m=a,typeof a=="function")G0(a)&&(A=1);else if(typeof a=="string")A=5;else e:switch(a){case P:return Ma(d.children,v,w,c);case C:A=8,v|=8;break;case D:return a=$i(12,d,c,v|2),a.elementType=D,a.lanes=w,a;case k:return a=$i(13,d,c,v),a.elementType=k,a.lanes=w,a;case te:return a=$i(19,d,c,v),a.elementType=te,a.lanes=w,a;case ue:return Ag(d,v,w,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case F:A=10;break e;case V:A=9;break e;case B:A=11;break e;case de:A=14;break e;case ge:A=16,m=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=$i(A,d,c,v),c.elementType=a,c.type=m,c.lanes=w,c}function Ma(a,c,d,m){return a=$i(7,a,m,c),a.lanes=d,a}function Ag(a,c,d,m){return a=$i(22,a,m,c),a.elementType=ue,a.lanes=d,a.stateNode={isHidden:!1},a}function $0(a,c,d){return a=$i(6,a,null,c),a.lanes=d,a}function H0(a,c,d){return c=$i(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function XM(a,c,d,m,v){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qu(0),this.expirationTimes=qu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qu(0),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function K0(a,c,d,m,v,w,A,z,H){return a=new XM(a,c,d,z,H),c===1?(c=1,w===!0&&(c|=8)):c=0,w=$i(3,null,null,c),a.current=w,w.stateNode=a,w.memoizedState={element:m,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},o0(w),a}function YM(a,c,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:m==null?null:""+m,children:a,containerInfo:c,implementation:d}}function qT(a){if(!a)return mo;a=a._reactInternals;e:{if(sr(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Qn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(Qn(d))return EE(a,d,c)}return c}function XT(a,c,d,m,v,w,A,z,H){return a=K0(d,m,!0,a,v,w,A,z,H),a.context=qT(null),d=a.current,m=Hn(),v=To(d),w=Ps(m,v),w.callback=c??null,vo(d,w,v),a.current.lanes=v,_a(a,v,m),ti(a,m),a}function Pg(a,c,d,m){var v=c.current,w=Hn(),A=To(v);return d=qT(d),c.context===null?c.context=d:c.pendingContext=d,c=Ps(w,A),c.payload={element:a},m=m===void 0?null:m,m!==null&&(c.callback=m),a=vo(v,c,A),a!==null&&(dr(a,v,A,w),ag(a,v,A)),A}function kg(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function YT(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function q0(a,c){YT(a,c),(a=a.alternate)&&YT(a,c)}function ZM(){return null}var ZT=typeof reportError=="function"?reportError:function(a){console.error(a)};function X0(a){this._internalRoot=a}Ng.prototype.render=X0.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));Pg(a,c,null,null)},Ng.prototype.unmount=X0.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;ka(function(){Pg(null,a,null,null)}),c[Is]=null}};function Ng(a){this._internalRoot=a}Ng.prototype.unstable_scheduleHydration=function(a){if(a){var c=Qu();a={blockedOn:null,target:a,priority:c};for(var d=0;d<yi.length&&c!==0&&c<yi[d].priority;d++);yi.splice(d,0,a),d===0&&Wl(a)}};function Y0(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Dg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function QT(){}function QM(a,c,d,m,v){if(v){if(typeof m=="function"){var w=m;m=function(){var J=kg(A);w.call(J)}}var A=XT(c,m,a,0,null,!1,!1,"",QT);return a._reactRootContainer=A,a[Is]=A.current,uh(a.nodeType===8?a.parentNode:a),ka(),A}for(;v=a.lastChild;)a.removeChild(v);if(typeof m=="function"){var z=m;m=function(){var J=kg(H);z.call(J)}}var H=K0(a,0,!1,null,null,!1,!1,"",QT);return a._reactRootContainer=H,a[Is]=H.current,uh(a.nodeType===8?a.parentNode:a),ka(function(){Pg(c,H,d,m)}),H}function Mg(a,c,d,m,v){var w=d._reactRootContainer;if(w){var A=w;if(typeof v=="function"){var z=v;v=function(){var H=kg(A);z.call(H)}}Pg(c,A,a,v)}else A=QM(d,c,a,v,m);return kg(A)}Yu=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=at(c.pendingLanes);d!==0&&(Xu(c,d|1),ti(c,xt()),(tt&6)===0&&(mc=xt()+500,yo()))}break;case 13:ka(function(){var m=As(a,1);if(m!==null){var v=Hn();dr(m,a,1,v)}}),q0(a,1)}},Ul=function(a){if(a.tag===13){var c=As(a,134217728);if(c!==null){var d=Hn();dr(c,a,134217728,d)}q0(a,134217728)}},Zu=function(a){if(a.tag===13){var c=To(a),d=As(a,c);if(d!==null){var m=Hn();dr(d,a,c,m)}q0(a,c)}},Qu=function(){return Ye},Ju=function(a,c){var d=Ye;try{return Ye=a,c()}finally{Ye=d}},Wn=function(a,c,d){switch(c){case"input":if(Yn(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var m=d[c];if(m!==a&&m.form===a.form){var v=Zf(m);if(!v)throw Error(t(90));Un(m),Yn(m,v)}}}break;case"textarea":io(a,d);break;case"select":c=d.value,c!=null&&sn(a,!!d.multiple,c,!1)}},Oi=U0,pn=ka;var JM={usingClientEntryPoint:!1,Events:[fh,ic,Zf,rr,jt,U0]},Rh={findFiberByHostInstance:Ta,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eL={bundleType:Rh.bundleType,version:Rh.version,rendererPackageName:Rh.rendererPackageName,rendererConfig:Rh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Df(a),a===null?null:a.stateNode},findFiberByHostInstance:Rh.findFiberByHostInstance||ZM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lg.isDisabled&&Lg.supportsFiber)try{ga=Lg.inject(eL),pi=Lg}catch{}}return ni.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JM,ni.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Y0(c))throw Error(t(200));return YM(a,c,null,d)},ni.createRoot=function(a,c){if(!Y0(a))throw Error(t(299));var d=!1,m="",v=ZT;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onRecoverableError!==void 0&&(v=c.onRecoverableError)),c=K0(a,1,!1,null,null,d,!1,m,v),a[Is]=c.current,uh(a.nodeType===8?a.parentNode:a),new X0(c)},ni.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Df(c),a=a===null?null:a.stateNode,a},ni.flushSync=function(a){return ka(a)},ni.hydrate=function(a,c,d){if(!Dg(c))throw Error(t(200));return Mg(null,a,c,!0,d)},ni.hydrateRoot=function(a,c,d){if(!Y0(a))throw Error(t(405));var m=d!=null&&d.hydratedSources||null,v=!1,w="",A=ZT;if(d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(A=d.onRecoverableError)),c=XT(c,null,a,1,d??null,v,!1,w,A),a[Is]=c.current,uh(a),m)for(a=0;a<m.length;a++)d=m[a],v=d._getVersion,v=v(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,v]:c.mutableSourceEagerHydrationData.push(d,v);return new Ng(c)},ni.render=function(a,c,d){if(!Dg(c))throw Error(t(200));return Mg(null,a,c,!1,d)},ni.unmountComponentAtNode=function(a){if(!Dg(a))throw Error(t(40));return a._reactRootContainer?(ka(function(){Mg(null,null,a,!1,function(){a._reactRootContainer=null,a[Is]=null})}),!0):!1},ni.unstable_batchedUpdates=U0,ni.unstable_renderSubtreeIntoContainer=function(a,c,d,m){if(!Dg(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Mg(a,c,d,!1,m)},ni.version="18.3.1-next-f1338f8080-20240426",ni}var oS;function lL(){if(oS)return J0.exports;oS=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),J0.exports=aL(),J0.exports}var aS;function cL(){if(aS)return Og;aS=1;var n=lL();return Og.createRoot=n.createRoot,Og.hydrateRoot=n.hydrateRoot,Og}var uL=cL();const hL=kx(uL);var q=ef();const dL=kx(q),Nx=q.createContext({});function Dx(n){const e=q.useRef(null);return e.current===null&&(e.current=n()),e.current}const Pm=q.createContext(null),Mx=q.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class fL extends q.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function gL({children:n,isPresent:e}){const t=q.useId(),i=q.useRef(null),r=q.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=q.useContext(Mx);return q.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),y.jsx(fL,{isPresent:e,childRef:i,sizeRef:r,children:q.cloneElement(n,{ref:i})})}const pL=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=Dx(mL),u=q.useId(),h=q.useCallback(p=>{l.set(p,!0);for(const _ of l.values())if(!_)return;i&&i()},[l,i]),f=q.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:p=>(l.set(p,!1),()=>l.delete(p))}),s?[Math.random(),h]:[t,h]);return q.useMemo(()=>{l.forEach((p,_)=>l.set(_,!1))},[t]),q.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=y.jsx(gL,{isPresent:t,children:n})),y.jsx(Pm.Provider,{value:f,children:n})};function mL(){return new Map}function Wb(n=!0){const e=q.useContext(Pm);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=q.useId();q.useEffect(()=>{n&&r(s)},[n]);const o=q.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const jg=n=>n.key||"";function lS(n){const e=[];return q.Children.forEach(n,t=>{q.isValidElement(t)&&e.push(t)}),e}const Lx=typeof window<"u",Gb=Lx?q.useLayoutEffect:q.useEffect,Vn=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,u]=Wb(o),h=q.useMemo(()=>lS(n),[n]),f=o&&!l?[]:h.map(jg),p=q.useRef(!0),_=q.useRef(h),x=Dx(()=>new Map),[S,I]=q.useState(h),[T,b]=q.useState(h);Gb(()=>{p.current=!1,_.current=h;for(let L=0;L<T.length;L++){const O=jg(T[L]);f.includes(O)?x.delete(O):x.get(O)!==!0&&x.set(O,!1)}},[T,f.length,f.join("-")]);const N=[];if(h!==S){let L=[...h];for(let O=0;O<T.length;O++){const U=T[O],P=jg(U);f.includes(P)||(L.splice(O,0,U),N.push(U))}s==="wait"&&N.length&&(L=N),b(lS(L)),I(h);return}const{forceRender:M}=q.useContext(Nx);return y.jsx(y.Fragment,{children:T.map(L=>{const O=jg(L),U=o&&!l?!1:h===T||f.includes(O),P=()=>{if(x.has(O))x.set(O,!0);else return;let C=!0;x.forEach(D=>{D||(C=!1)}),C&&(M?.(),b(_.current),o&&u?.(),i&&i())};return y.jsx(pL,{isPresent:U,initial:!p.current||t?void 0:!1,custom:U?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:U?void 0:P,children:L},O)})})},bi=n=>n;let $b=bi;function Ox(n){let e;return()=>(e===void 0&&(e=n()),e)}const ru=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},Bs=n=>n*1e3,Ws=n=>n/1e3,yL={useManualTiming:!1};function _L(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,f=!1,p=!1)=>{const x=p&&i?e:t;return f&&s.add(h),x.has(h)||x.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Fg=["read","resolveKeyframes","update","preRender","render","postRender"],vL=40;function Hb(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Fg.reduce((b,N)=>(b[N]=_L(s),b),{}),{read:l,resolveKeyframes:u,update:h,preRender:f,render:p,postRender:_}=o,x=()=>{const b=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(b-r.timestamp,vL),1),r.timestamp=b,r.isProcessing=!0,l.process(r),u.process(r),h.process(r),f.process(r),p.process(r),_.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(x))},S=()=>{t=!0,i=!0,r.isProcessing||n(x)};return{schedule:Fg.reduce((b,N)=>{const M=o[N];return b[N]=(L,O=!1,U=!1)=>(t||S(),M.schedule(L,O,U)),b},{}),cancel:b=>{for(let N=0;N<Fg.length;N++)o[Fg[N]].cancel(b)},state:r,steps:o}}const{schedule:Tt,cancel:ea,state:En,steps:n_}=Hb(typeof requestAnimationFrame<"u"?requestAnimationFrame:bi,!0),Kb=q.createContext({strict:!1}),cS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},su={};for(const n in cS)su[n]={isEnabled:e=>cS[n].some(t=>!!e[t])};function xL(n){for(const e in n)su[e]={...su[e],...n[e]}}const wL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Pp(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||wL.has(n)}let qb=n=>!Pp(n);function EL(n){n&&(qb=e=>e.startsWith("on")?!Pp(e):n(e))}try{EL(require("@emotion/is-prop-valid").default)}catch{}function TL(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(qb(r)||t===!0&&Pp(r)||!e&&!Pp(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function SL(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const km=q.createContext({});function xd(n){return typeof n=="string"||Array.isArray(n)}function Nm(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const jx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Fx=["initial",...jx];function Dm(n){return Nm(n.animate)||Fx.some(e=>xd(n[e]))}function Xb(n){return!!(Dm(n)||n.variants)}function IL(n,e){if(Dm(n)){const{initial:t,animate:i}=n;return{initial:t===!1||xd(t)?t:void 0,animate:xd(i)?i:void 0}}return n.inherit!==!1?e:{}}function CL(n){const{initial:e,animate:t}=IL(n,q.useContext(km));return q.useMemo(()=>({initial:e,animate:t}),[uS(e),uS(t)])}function uS(n){return Array.isArray(n)?n.join(" "):n}const RL=Symbol.for("motionComponentSymbol");function Uc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function bL(n,e,t){return q.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):Uc(t)&&(t.current=i))},[e])}const Vx=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),AL="framerAppearId",Yb="data-"+Vx(AL),{schedule:zx}=Hb(queueMicrotask,!1),Zb=q.createContext({});function PL(n,e,t,i,r){var s,o;const{visualElement:l}=q.useContext(km),u=q.useContext(Kb),h=q.useContext(Pm),f=q.useContext(Mx).reducedMotion,p=q.useRef(null);i=i||u.renderer,!p.current&&i&&(p.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const _=p.current,x=q.useContext(Zb);_&&!_.projection&&r&&(_.type==="html"||_.type==="svg")&&kL(p.current,t,r,x);const S=q.useRef(!1);q.useInsertionEffect(()=>{_&&S.current&&_.update(t,h)});const I=t[Yb],T=q.useRef(!!I&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,I))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,I)));return Gb(()=>{_&&(S.current=!0,window.MotionIsMounted=!0,_.updateFeatures(),zx.render(_.render),T.current&&_.animationState&&_.animationState.animateChanges())}),q.useEffect(()=>{_&&(!T.current&&_.animationState&&_.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)===null||b===void 0||b.call(window,I)}),T.current=!1))}),_}function kL(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:Qb(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&Uc(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function Qb(n){if(n)return n.options.allowProjection!==!1?n.projection:Qb(n.parent)}function NL({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&xL(n);function l(h,f){let p;const _={...q.useContext(Mx),...h,layoutId:DL(h)},{isStatic:x}=_,S=CL(h),I=i(h,x);if(!x&&Lx){ML();const T=LL(_);p=T.MeasureLayout,S.visualElement=PL(r,I,_,e,T.ProjectionNode)}return y.jsxs(km.Provider,{value:S,children:[p&&S.visualElement?y.jsx(p,{visualElement:S.visualElement,..._}):null,t(r,h,bL(I,S.visualElement,f),I,x,S.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=q.forwardRef(l);return u[RL]=r,u}function DL({layoutId:n}){const e=q.useContext(Nx).id;return e&&n!==void 0?e+"-"+n:n}function ML(n,e){q.useContext(Kb).strict}function LL(n){const{drag:e,layout:t}=su;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const OL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Ux(n){return typeof n!="string"||n.includes("-")?!1:!!(OL.indexOf(n)>-1||/[A-Z]/u.test(n))}function hS(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function Bx(n,e,t,i){if(typeof e=="function"){const[r,s]=hS(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=hS(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const cv=n=>Array.isArray(n),jL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),FL=n=>cv(n)?n[n.length-1]||0:n,zn=n=>!!(n&&n.getVelocity);function hp(n){const e=zn(n)?n.get():n;return jL(e)?e.toValue():e}function VL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:zL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const Jb=n=>(e,t)=>{const i=q.useContext(km),r=q.useContext(Pm),s=()=>VL(n,e,i,r);return t?s():Dx(s)};function zL(n,e,t,i){const r={},s=i(n,{});for(const _ in s)r[_]=hp(s[_]);let{initial:o,animate:l}=n;const u=Dm(n),h=Xb(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const p=f?l:o;if(p&&typeof p!="boolean"&&!Nm(p)){const _=Array.isArray(p)?p:[p];for(let x=0;x<_.length;x++){const S=Bx(n,_[x]);if(S){const{transitionEnd:I,transition:T,...b}=S;for(const N in b){let M=b[N];if(Array.isArray(M)){const L=f?M.length-1:0;M=M[L]}M!==null&&(r[N]=M)}for(const N in I)r[N]=I[N]}}}return r}const Du=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Al=new Set(Du),e2=n=>e=>typeof e=="string"&&e.startsWith(n),t2=e2("--"),UL=e2("var(--"),Wx=n=>UL(n)?BL.test(n.split("/*")[0].trim()):!1,BL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,n2=(n,e)=>e&&typeof n=="number"?e.transform(n):n,qs=(n,e,t)=>t>e?e:t<n?n:t,Mu={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},wd={...Mu,transform:n=>qs(0,1,n)},Vg={...Mu,default:1},tf=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),jo=tf("deg"),ss=tf("%"),Le=tf("px"),WL=tf("vh"),GL=tf("vw"),dS={...ss,parse:n=>ss.parse(n)/100,transform:n=>ss.transform(n*100)},$L={borderWidth:Le,borderTopWidth:Le,borderRightWidth:Le,borderBottomWidth:Le,borderLeftWidth:Le,borderRadius:Le,radius:Le,borderTopLeftRadius:Le,borderTopRightRadius:Le,borderBottomRightRadius:Le,borderBottomLeftRadius:Le,width:Le,maxWidth:Le,height:Le,maxHeight:Le,top:Le,right:Le,bottom:Le,left:Le,padding:Le,paddingTop:Le,paddingRight:Le,paddingBottom:Le,paddingLeft:Le,margin:Le,marginTop:Le,marginRight:Le,marginBottom:Le,marginLeft:Le,backgroundPositionX:Le,backgroundPositionY:Le},HL={rotate:jo,rotateX:jo,rotateY:jo,rotateZ:jo,scale:Vg,scaleX:Vg,scaleY:Vg,scaleZ:Vg,skew:jo,skewX:jo,skewY:jo,distance:Le,translateX:Le,translateY:Le,translateZ:Le,x:Le,y:Le,z:Le,perspective:Le,transformPerspective:Le,opacity:wd,originX:dS,originY:dS,originZ:Le},fS={...Mu,transform:Math.round},Gx={...$L,...HL,zIndex:fS,size:Le,fillOpacity:wd,strokeOpacity:wd,numOctaves:fS},KL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},qL=Du.length;function XL(n,e,t){let i="",r=!0;for(let s=0;s<qL;s++){const o=Du[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=n2(l,Gx[o]);if(!u){r=!1;const f=KL[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function $x(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const u in e){const h=e[u];if(Al.has(u)){o=!0;continue}else if(t2(u)){r[u]=h;continue}else{const f=n2(h,Gx[u]);u.startsWith("origin")?(l=!0,s[u]=f):i[u]=f}}if(e.transform||(o||t?i.transform=XL(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${u} ${h} ${f}`}}const YL={offset:"stroke-dashoffset",array:"stroke-dasharray"},ZL={offset:"strokeDashoffset",array:"strokeDasharray"};function QL(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?YL:ZL;n[s.offset]=Le.transform(-i);const o=Le.transform(e),l=Le.transform(t);n[s.array]=`${o} ${l}`}function gS(n,e,t){return typeof n=="string"?n:Le.transform(e+t*n)}function JL(n,e,t){const i=gS(e,n.x,n.width),r=gS(t,n.y,n.height);return`${i} ${r}`}function Hx(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...h},f,p){if($x(n,h,p),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:_,style:x,dimensions:S}=n;_.transform&&(S&&(x.transform=_.transform),delete _.transform),S&&(r!==void 0||s!==void 0||x.transform)&&(x.transformOrigin=JL(S,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(_.x=e),t!==void 0&&(_.y=t),i!==void 0&&(_.scale=i),o!==void 0&&QL(_,o,l,u,!1)}const Kx=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),i2=()=>({...Kx(),attrs:{}}),qx=n=>typeof n=="string"&&n.toLowerCase()==="svg";function r2(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const s2=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function o2(n,e,t,i){r2(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(s2.has(r)?r:Vx(r),e.attrs[r])}const kp={};function eO(n){Object.assign(kp,n)}function a2(n,{layout:e,layoutId:t}){return Al.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!kp[n]||n==="opacity")}function Xx(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(zn(r[o])||e.style&&zn(e.style[o])||a2(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function l2(n,e,t){const i=Xx(n,e,t);for(const r in n)if(zn(n[r])||zn(e[r])){const s=Du.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function tO(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const pS=["x","y","width","height","cx","cy","r"],nO={useVisualState:Jb({scrapeMotionValuesFromProps:l2,createRenderState:i2,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(Al.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<pS.length;l++){const u=pS[l];n[u]!==e[u]&&(o=!0)}o&&Tt.read(()=>{tO(t,i),Tt.render(()=>{Hx(i,r,qx(t.tagName),n.transformTemplate),o2(t,i)})})}})},iO={useVisualState:Jb({scrapeMotionValuesFromProps:Xx,createRenderState:Kx})};function c2(n,e,t){for(const i in e)!zn(e[i])&&!a2(i,t)&&(n[i]=e[i])}function rO({transformTemplate:n},e){return q.useMemo(()=>{const t=Kx();return $x(t,e,n),Object.assign({},t.vars,t.style)},[e])}function sO(n,e){const t=n.style||{},i={};return c2(i,t,n),Object.assign(i,rO(n,e)),i}function oO(n,e){const t={},i=sO(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function aO(n,e,t,i){const r=q.useMemo(()=>{const s=i2();return Hx(s,e,qx(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};c2(s,n.style,n),r.style={...s,...r.style}}return r}function lO(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(Ux(t)?aO:oO)(i,s,o,t),h=TL(i,typeof t=="string",n),f=t!==q.Fragment?{...h,...u,ref:r}:{},{children:p}=i,_=q.useMemo(()=>zn(p)?p.get():p,[p]);return q.createElement(t,{...f,children:_})}}function cO(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...Ux(i)?nO:iO,preloadedFeatures:n,useRender:lO(r),createVisualElement:e,Component:i};return NL(o)}}function u2(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function Mm(n,e,t){const i=n.getProps();return Bx(i,e,t!==void 0?t:i.custom,n)}const uO=Ox(()=>window.ScrollTimeline!==void 0);class hO{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(uO()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class dO extends hO{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Yx(n,e){return n?n[e]||n.default||n:void 0}const uv=2e4;function h2(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<uv;)e+=t,i=n.next(e);return e>=uv?1/0:e}function Zx(n){return typeof n=="function"}function mS(n,e){n.timeline=e,n.onfinish=null}const Qx=n=>Array.isArray(n)&&typeof n[0]=="number",fO={linearEasing:void 0};function gO(n,e){const t=Ox(n);return()=>{var i;return(i=fO[e])!==null&&i!==void 0?i:t()}}const Np=gO(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),d2=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(ru(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function f2(n){return!!(typeof n=="function"&&Np()||!n||typeof n=="string"&&(n in hv||Np())||Qx(n)||Array.isArray(n)&&n.every(f2))}const Wh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,hv={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Wh([0,.65,.55,1]),circOut:Wh([.55,0,1,.45]),backIn:Wh([.31,.01,.66,-.59]),backOut:Wh([.33,1.53,.69,.99])};function g2(n,e){if(n)return typeof n=="function"&&Np()?d2(n,e):Qx(n)?Wh(n):Array.isArray(n)?n.map(t=>g2(t,e)||hv.easeOut):hv[n]}const gr={x:!1,y:!1};function p2(){return gr.x||gr.y}function pO(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function m2(n,e){const t=pO(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function yS(n){return e=>{e.pointerType==="touch"||p2()||n(e)}}function mO(n,e,t={}){const[i,r,s]=m2(n,t),o=yS(l=>{const{target:u}=l,h=e(l);if(typeof h!="function"||!u)return;const f=yS(p=>{h(p),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const y2=(n,e)=>e?n===e?!0:y2(n,e.parentElement):!1,Jx=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,yO=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function _O(n){return yO.has(n.tagName)||n.tabIndex!==-1}const Gh=new WeakSet;function _S(n){return e=>{e.key==="Enter"&&n(e)}}function i_(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const vO=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=_S(()=>{if(Gh.has(t))return;i_(t,"down");const r=_S(()=>{i_(t,"up")}),s=()=>i_(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function vS(n){return Jx(n)&&!p2()}function xO(n,e,t={}){const[i,r,s]=m2(n,t),o=l=>{const u=l.currentTarget;if(!vS(l)||Gh.has(u))return;Gh.add(u);const h=e(l),f=(x,S)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",_),!(!vS(x)||!Gh.has(u))&&(Gh.delete(u),typeof h=="function"&&h(x,{success:S}))},p=x=>{f(x,t.useGlobalTarget||y2(u,x.target))},_=x=>{f(x,!1)};window.addEventListener("pointerup",p,r),window.addEventListener("pointercancel",_,r)};return i.forEach(l=>{!_O(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>vO(h,r),r)}),s}function wO(n){return n==="x"||n==="y"?gr[n]?null:(gr[n]=!0,()=>{gr[n]=!1}):gr.x||gr.y?null:(gr.x=gr.y=!0,()=>{gr.x=gr.y=!1})}const _2=new Set(["width","height","top","left","right","bottom",...Du]);let dp;function EO(){dp=void 0}const os={now:()=>(dp===void 0&&os.set(En.isProcessing||yL.useManualTiming?En.timestamp:performance.now()),dp),set:n=>{dp=n,queueMicrotask(EO)}};function e1(n,e){n.indexOf(e)===-1&&n.push(e)}function t1(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class n1{constructor(){this.subscriptions=[]}add(e){return e1(this.subscriptions,e),()=>t1(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function v2(n,e){return e?n*(1e3/e):0}const xS=30,TO=n=>!isNaN(parseFloat(n));class SO{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=os.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=os.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=TO(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new n1);const i=this.events[e].add(t);return e==="change"?()=>{i(),Tt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=os.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>xS)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,xS);return v2(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ed(n,e){return new SO(n,e)}function IO(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Ed(t))}function CO(n,e){const t=Mm(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=FL(s[o]);IO(n,o,l)}}function RO(n){return!!(zn(n)&&n.add)}function dv(n,e){const t=n.getValue("willChange");if(RO(t))return t.add(e)}function x2(n){return n.props[Yb]}const w2=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,bO=1e-7,AO=12;function PO(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=w2(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>bO&&++l<AO);return o}function nf(n,e,t,i){if(n===e&&t===i)return bi;const r=s=>PO(s,0,1,n,t);return s=>s===0||s===1?s:w2(r(s),e,i)}const E2=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,T2=n=>e=>1-n(1-e),S2=nf(.33,1.53,.69,.99),i1=T2(S2),I2=E2(i1),C2=n=>(n*=2)<1?.5*i1(n):.5*(2-Math.pow(2,-10*(n-1))),r1=n=>1-Math.sin(Math.acos(n)),R2=T2(r1),b2=E2(r1),A2=n=>/^0[^.\s]+$/u.test(n);function kO(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||A2(n):!0}const nd=n=>Math.round(n*1e5)/1e5,s1=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function NO(n){return n==null}const DO=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,o1=(n,e)=>t=>!!(typeof t=="string"&&DO.test(t)&&t.startsWith(n)||e&&!NO(t)&&Object.prototype.hasOwnProperty.call(t,e)),P2=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(s1);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},MO=n=>qs(0,255,n),r_={...Mu,transform:n=>Math.round(MO(n))},Za={test:o1("rgb","red"),parse:P2("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+r_.transform(n)+", "+r_.transform(e)+", "+r_.transform(t)+", "+nd(wd.transform(i))+")"};function LO(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const fv={test:o1("#"),parse:LO,transform:Za.transform},Bc={test:o1("hsl","hue"),parse:P2("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+ss.transform(nd(e))+", "+ss.transform(nd(t))+", "+nd(wd.transform(i))+")"},On={test:n=>Za.test(n)||fv.test(n)||Bc.test(n),parse:n=>Za.test(n)?Za.parse(n):Bc.test(n)?Bc.parse(n):fv.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Za.transform(n):Bc.transform(n)},OO=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function jO(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(s1))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(OO))===null||t===void 0?void 0:t.length)||0)>0}const k2="number",N2="color",FO="var",VO="var(",wS="${}",zO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Td(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(zO,u=>(On.test(u)?(i.color.push(s),r.push(N2),t.push(On.parse(u))):u.startsWith(VO)?(i.var.push(s),r.push(FO),t.push(u)):(i.number.push(s),r.push(k2),t.push(parseFloat(u))),++s,wS)).split(wS);return{values:t,split:l,indexes:i,types:r}}function D2(n){return Td(n).values}function M2(n){const{split:e,types:t}=Td(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===k2?s+=nd(r[o]):l===N2?s+=On.transform(r[o]):s+=r[o]}return s}}const UO=n=>typeof n=="number"?0:n;function BO(n){const e=D2(n);return M2(n)(e.map(UO))}const ta={test:jO,parse:D2,createTransformer:M2,getAnimatableNone:BO},WO=new Set(["brightness","contrast","saturate","opacity"]);function GO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(s1)||[];if(!i)return n;const r=t.replace(i,"");let s=WO.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const $O=/\b([a-z-]*)\(.*?\)/gu,gv={...ta,getAnimatableNone:n=>{const e=n.match($O);return e?e.map(GO).join(" "):n}},HO={...Gx,color:On,backgroundColor:On,outlineColor:On,fill:On,stroke:On,borderColor:On,borderTopColor:On,borderRightColor:On,borderBottomColor:On,borderLeftColor:On,filter:gv,WebkitFilter:gv},a1=n=>HO[n];function L2(n,e){let t=a1(n);return t!==gv&&(t=ta),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const KO=new Set(["auto","none","0"]);function qO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!KO.has(s)&&Td(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=L2(t,r)}const ES=n=>n===Mu||n===Le,TS=(n,e)=>parseFloat(n.split(", ")[e]),SS=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return TS(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?TS(s[1],n):0}},XO=new Set(["x","y","z"]),YO=Du.filter(n=>!XO.has(n));function ZO(n){const e=[];return YO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const ou={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:SS(4,13),y:SS(5,14)};ou.translateX=ou.x;ou.translateY=ou.y;const sl=new Set;let pv=!1,mv=!1;function O2(){if(mv){const n=Array.from(sl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=ZO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}mv=!1,pv=!1,sl.forEach(n=>n.complete()),sl.clear()}function j2(){sl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(mv=!0)})}function QO(){j2(),O2()}class l1{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(sl.add(this),pv||(pv=!0,Tt.read(j2),Tt.resolveKeyframes(O2))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),sl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,sl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const F2=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),JO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function e5(n){const e=JO.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function V2(n,e,t=1){const[i,r]=e5(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return F2(o)?parseFloat(o):o}return Wx(r)?V2(r,e,t+1):r}const z2=n=>e=>e.test(n),t5={test:n=>n==="auto",parse:n=>n},U2=[Mu,Le,ss,jo,GL,WL,t5],IS=n=>U2.find(z2(n));class B2 extends l1{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),Wx(h))){const f=V2(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!_2.has(i)||e.length!==2)return;const[r,s]=e,o=IS(r),l=IS(s);if(o!==l)if(ES(o)&&ES(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)kO(e[r])&&i.push(r);i.length&&qO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ou[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=ou[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const CS=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ta.test(n)||n==="0")&&!n.startsWith("url("));function n5(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function i5(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=CS(r,e),l=CS(s,e);return!o||!l?!1:n5(n)||(t==="spring"||Zx(t))&&i}const r5=n=>n!==null;function Lm(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(r5),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const s5=40;class W2{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=os.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>s5?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&QO(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=os.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:u,isGenerator:h}=this.options;if(!h&&!i5(e,i,r,s))if(o)this.options.duration=0;else{u&&u(Lm(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Nt=(n,e,t)=>n+(e-n)*t;function s_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function o5({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;r=s_(u,l,n+1/3),s=s_(u,l,n),o=s_(u,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Dp(n,e){return t=>t>0?e:n}const o_=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},a5=[fv,Za,Bc],l5=n=>a5.find(e=>e.test(n));function RS(n){const e=l5(n);if(!e)return!1;let t=e.parse(n);return e===Bc&&(t=o5(t)),t}const bS=(n,e)=>{const t=RS(n),i=RS(e);if(!t||!i)return Dp(n,e);const r={...t};return s=>(r.red=o_(t.red,i.red,s),r.green=o_(t.green,i.green,s),r.blue=o_(t.blue,i.blue,s),r.alpha=Nt(t.alpha,i.alpha,s),Za.transform(r))},c5=(n,e)=>t=>e(n(t)),rf=(...n)=>n.reduce(c5),yv=new Set(["none","hidden"]);function u5(n,e){return yv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function h5(n,e){return t=>Nt(n,e,t)}function c1(n){return typeof n=="number"?h5:typeof n=="string"?Wx(n)?Dp:On.test(n)?bS:g5:Array.isArray(n)?G2:typeof n=="object"?On.test(n)?bS:d5:Dp}function G2(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>c1(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function d5(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=c1(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function f5(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],u=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const g5=(n,e)=>{const t=ta.createTransformer(e),i=Td(n),r=Td(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?yv.has(n)&&!r.values.length||yv.has(e)&&!i.values.length?u5(n,e):rf(G2(f5(i,r),r.values),t):Dp(n,e)};function $2(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Nt(n,e,t):c1(n)(n,e)}const p5=5;function H2(n,e,t){const i=Math.max(e-p5,0);return v2(t-n(i),e-i)}const Ot={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},a_=.001;function m5({duration:n=Ot.duration,bounce:e=Ot.bounce,velocity:t=Ot.velocity,mass:i=Ot.mass}){let r,s,o=1-e;o=qs(Ot.minDamping,Ot.maxDamping,o),n=qs(Ot.minDuration,Ot.maxDuration,Ws(n)),o<1?(r=h=>{const f=h*o,p=f*n,_=f-t,x=_v(h,o),S=Math.exp(-p);return a_-_/x*S},s=h=>{const p=h*o*n,_=p*t+t,x=Math.pow(o,2)*Math.pow(h,2)*n,S=Math.exp(-p),I=_v(Math.pow(h,2),o);return(-r(h)+a_>0?-1:1)*((_-x)*S)/I}):(r=h=>{const f=Math.exp(-h*n),p=(h-t)*n+1;return-a_+f*p},s=h=>{const f=Math.exp(-h*n),p=(t-h)*(n*n);return f*p});const l=5/n,u=_5(r,s,l);if(n=Bs(n),isNaN(u))return{stiffness:Ot.stiffness,damping:Ot.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const y5=12;function _5(n,e,t){let i=t;for(let r=1;r<y5;r++)i=i-n(i)/e(i);return i}function _v(n,e){return n*Math.sqrt(1-e*e)}const v5=["duration","bounce"],x5=["stiffness","damping","mass"];function AS(n,e){return e.some(t=>n[t]!==void 0)}function w5(n){let e={velocity:Ot.velocity,stiffness:Ot.stiffness,damping:Ot.damping,mass:Ot.mass,isResolvedFromDuration:!1,...n};if(!AS(n,x5)&&AS(n,v5))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*qs(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Ot.mass,stiffness:r,damping:s}}else{const t=m5(n);e={...e,...t,mass:Ot.mass},e.isResolvedFromDuration=!0}return e}function K2(n=Ot.visualDuration,e=Ot.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:p,velocity:_,isResolvedFromDuration:x}=w5({...t,velocity:-Ws(t.velocity||0)}),S=_||0,I=h/(2*Math.sqrt(u*f)),T=o-s,b=Ws(Math.sqrt(u/f)),N=Math.abs(T)<5;i||(i=N?Ot.restSpeed.granular:Ot.restSpeed.default),r||(r=N?Ot.restDelta.granular:Ot.restDelta.default);let M;if(I<1){const O=_v(b,I);M=U=>{const P=Math.exp(-I*b*U);return o-P*((S+I*b*T)/O*Math.sin(O*U)+T*Math.cos(O*U))}}else if(I===1)M=O=>o-Math.exp(-b*O)*(T+(S+b*T)*O);else{const O=b*Math.sqrt(I*I-1);M=U=>{const P=Math.exp(-I*b*U),C=Math.min(O*U,300);return o-P*((S+I*b*T)*Math.sinh(C)+O*T*Math.cosh(C))/O}}const L={calculatedDuration:x&&p||null,next:O=>{const U=M(O);if(x)l.done=O>=p;else{let P=0;I<1&&(P=O===0?Bs(S):H2(M,O,U));const C=Math.abs(P)<=i,D=Math.abs(o-U)<=r;l.done=C&&D}return l.value=l.done?o:U,l},toString:()=>{const O=Math.min(h2(L),uv),U=d2(P=>L.next(O*P).value,O,30);return O+"ms "+U}};return L}function PS({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:f}){const p=n[0],_={done:!1,value:p},x=C=>l!==void 0&&C<l||u!==void 0&&C>u,S=C=>l===void 0?u:u===void 0||Math.abs(l-C)<Math.abs(u-C)?l:u;let I=t*e;const T=p+I,b=o===void 0?T:o(T);b!==T&&(I=b-p);const N=C=>-I*Math.exp(-C/i),M=C=>b+N(C),L=C=>{const D=N(C),F=M(C);_.done=Math.abs(D)<=h,_.value=_.done?b:F};let O,U;const P=C=>{x(_.value)&&(O=C,U=K2({keyframes:[_.value,S(_.value)],velocity:H2(M,C,_.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return P(0),{calculatedDuration:null,next:C=>{let D=!1;return!U&&O===void 0&&(D=!0,L(C),P(C)),O!==void 0&&C>=O?U.next(C-O):(!D&&L(C),_)}}}const E5=nf(.42,0,1,1),T5=nf(0,0,.58,1),q2=nf(.42,0,.58,1),S5=n=>Array.isArray(n)&&typeof n[0]!="number",I5={linear:bi,easeIn:E5,easeInOut:q2,easeOut:T5,circIn:r1,circInOut:b2,circOut:R2,backIn:i1,backInOut:I2,backOut:S2,anticipate:C2},kS=n=>{if(Qx(n)){$b(n.length===4);const[e,t,i,r]=n;return nf(e,t,i,r)}else if(typeof n=="string")return I5[n];return n};function C5(n,e,t){const i=[],r=t||$2,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||bi:e;l=rf(u,l)}i.push(l)}return i}function R5(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if($b(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=C5(e,i,r),u=l.length,h=f=>{if(o&&f<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(f<n[p+1]);p++);const _=ru(n[p],n[p+1],f);return l[p](_)};return t?f=>h(qs(n[0],n[s-1],f)):h}function b5(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=ru(0,e,i);n.push(Nt(t,1,r))}}function A5(n){const e=[0];return b5(e,n.length-1),e}function P5(n,e){return n.map(t=>t*e)}function k5(n,e){return n.map(()=>e||q2).splice(0,n.length-1)}function Mp({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=S5(i)?i.map(kS):kS(i),s={done:!1,value:e[0]},o=P5(t&&t.length===e.length?t:A5(e),n),l=R5(o,e,{ease:Array.isArray(r)?r:k5(e,r)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const N5=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Tt.update(e,!0),stop:()=>ea(e),now:()=>En.isProcessing?En.timestamp:os.now()}},D5={decay:PS,inertia:PS,tween:Mp,keyframes:Mp,spring:K2},M5=n=>n/100;class u1 extends W2{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||l1,l=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=Zx(t)?t:D5[t]||Mp;let u,h;l!==Mp&&typeof e[0]!="number"&&(u=rf(M5,$2(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=h2(f));const{calculatedDuration:p}=f,_=p+r,x=_*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:p,resolvedDuration:_,totalDuration:x}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:p}=i;if(this.startTime===null)return s.next(0);const{delay:_,repeat:x,repeatType:S,repeatDelay:I,onUpdate:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const b=this.currentTime-_*(this.speed>=0?1:-1),N=this.speed>=0?b<0:b>f;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let M=this.currentTime,L=s;if(x){const C=Math.min(this.currentTime,f)/p;let D=Math.floor(C),F=C%1;!F&&C>=1&&(F=1),F===1&&D--,D=Math.min(D,x+1),D%2&&(S==="reverse"?(F=1-F,I&&(F-=I/p)):S==="mirror"&&(L=o)),M=qs(0,1,F)*p}const O=N?{done:!1,value:u[0]}:L.next(M);l&&(O.value=l(O.value));let{done:U}=O;!N&&h!==null&&(U=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&U);return P&&r!==void 0&&(O.value=Lm(u,this.options,r)),T&&T(O.value),P&&this.finish(),O}get duration(){const{resolved:e}=this;return e?Ws(e.calculatedDuration):0}get time(){return Ws(this.currentTime)}set time(e){e=Bs(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Ws(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=N5,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const L5=new Set(["opacity","clipPath","filter","transform"]);function O5(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=g2(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const j5=Ox(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Lp=10,F5=2e4;function V5(n){return Zx(n.type)||n.type==="spring"||!f2(n.ease)}function z5(n,e){const t=new u1({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<F5;)i=t.sample(s),r.push(i.value),s+=Lp;return{times:void 0,keyframes:r,duration:s-Lp,ease:"linear"}}const X2={anticipate:C2,backInOut:I2,circInOut:b2};function U5(n){return n in X2}class NS extends W2{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new B2(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:u,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&Np()&&U5(s)&&(s=X2[s]),V5(this.options)){const{onComplete:p,onUpdate:_,motionValue:x,element:S,...I}=this.options,T=z5(e,I);e=T.keyframes,e.length===1&&(e[1]=e[0]),i=T.duration,r=T.times,s=T.ease,o="keyframes"}const f=O5(l.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(mS(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:p}=this.options;l.set(Lm(e,this.options,t)),p&&p(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Ws(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Ws(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=Bs(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return bi;const{animation:i}=t;mS(i,e)}return bi}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:p,element:_,...x}=this.options,S=new u1({...x,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),I=Bs(this.time);h.setWithVelocity(S.sample(I-Lp).value,S.sample(I).value,Lp)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return j5()&&i&&L5.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const B5={type:"spring",stiffness:500,damping:25,restSpeed:10},W5=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),G5={type:"keyframes",duration:.8},$5={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},H5=(n,{keyframes:e})=>e.length>2?G5:Al.has(n)?n.startsWith("scale")?W5(e[1]):B5:$5;function K5({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const h1=(n,e,t,i={},r,s)=>o=>{const l=Yx(i,n)||{},u=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-Bs(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:_=>{e.set(_),l.onUpdate&&l.onUpdate(_)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};K5(l)||(f={...f,...H5(n,f)}),f.duration&&(f.duration=Bs(f.duration)),f.repeatDelay&&(f.repeatDelay=Bs(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(p=!0)),p&&!s&&e.get()!==void 0){const _=Lm(f.keyframes,l);if(_!==void 0)return Tt.update(()=>{f.onUpdate(_),f.onComplete()}),new dO([])}return!s&&NS.supports(f)?new NS(f):new u1(f)};function q5({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function Y2(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...u}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const p in u){const _=n.getValue(p,(s=n.latestValues[p])!==null&&s!==void 0?s:null),x=u[p];if(x===void 0||f&&q5(f,p))continue;const S={delay:t,...Yx(o||{},p)};let I=!1;if(window.MotionHandoffAnimation){const b=x2(n);if(b){const N=window.MotionHandoffAnimation(b,p,Tt);N!==null&&(S.startTime=N,I=!0)}}dv(n,p),_.start(h1(p,_,x,n.shouldReduceMotion&&_2.has(p)?{type:!1}:S,n,I));const T=_.animation;T&&h.push(T)}return l&&Promise.all(h).then(()=>{Tt.update(()=>{l&&CO(n,l)})}),h}function vv(n,e,t={}){var i;const r=Mm(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(Y2(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:p,staggerDirection:_}=s;return X5(n,e,f+h,p,_,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function X5(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(Y5).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(vv(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function Y5(n,e){return n.sortNodePosition(e)}function Z5(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>vv(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=vv(n,e,t);else{const r=typeof e=="function"?Mm(n,e,t.custom):e;i=Promise.all(Y2(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const Q5=Fx.length;function Z2(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?Z2(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<Q5;t++){const i=Fx[t],r=n.props[i];(xd(r)||r===!1)&&(e[i]=r)}return e}const J5=[...jx].reverse(),ej=jx.length;function tj(n){return e=>Promise.all(e.map(({animation:t,options:i})=>Z5(n,t,i)))}function nj(n){let e=tj(n),t=DS(),i=!0;const r=u=>(h,f)=>{var p;const _=Mm(n,f,u==="exit"?(p=n.presenceContext)===null||p===void 0?void 0:p.custom:void 0);if(_){const{transition:x,transitionEnd:S,...I}=_;h={...h,...I,...S}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,f=Z2(n.parent)||{},p=[],_=new Set;let x={},S=1/0;for(let T=0;T<ej;T++){const b=J5[T],N=t[b],M=h[b]!==void 0?h[b]:f[b],L=xd(M),O=b===u?N.isActive:null;O===!1&&(S=T);let U=M===f[b]&&M!==h[b]&&L;if(U&&i&&n.manuallyAnimateOnMount&&(U=!1),N.protectedKeys={...x},!N.isActive&&O===null||!M&&!N.prevProp||Nm(M)||typeof M=="boolean")continue;const P=ij(N.prevProp,M);let C=P||b===u&&N.isActive&&!U&&L||T>S&&L,D=!1;const F=Array.isArray(M)?M:[M];let V=F.reduce(r(b),{});O===!1&&(V={});const{prevResolvedValues:B={}}=N,k={...B,...V},te=ue=>{C=!0,_.has(ue)&&(D=!0,_.delete(ue)),N.needsAnimating[ue]=!0;const G=n.getValue(ue);G&&(G.liveStyle=!1)};for(const ue in k){const G=V[ue],ie=B[ue];if(x.hasOwnProperty(ue))continue;let ne=!1;cv(G)&&cv(ie)?ne=!u2(G,ie):ne=G!==ie,ne?G!=null?te(ue):_.add(ue):G!==void 0&&_.has(ue)?te(ue):N.protectedKeys[ue]=!0}N.prevProp=M,N.prevResolvedValues=V,N.isActive&&(x={...x,...V}),i&&n.blockInitialAnimation&&(C=!1),C&&(!(U&&P)||D)&&p.push(...F.map(ue=>({animation:ue,options:{type:b}})))}if(_.size){const T={};_.forEach(b=>{const N=n.getBaseTarget(b),M=n.getValue(b);M&&(M.liveStyle=!0),T[b]=N??null}),p.push({animation:T})}let I=!!p.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(I=!1),i=!1,I?e(p):Promise.resolve()}function l(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(_=>{var x;return(x=_.animationState)===null||x===void 0?void 0:x.setActive(u,h)}),t[u].isActive=h;const p=o(u);for(const _ in t)t[_].protectedKeys={};return p}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=DS(),i=!0}}}function ij(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!u2(e,n):!1}function La(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function DS(){return{animate:La(!0),whileInView:La(),whileHover:La(),whileTap:La(),whileDrag:La(),whileFocus:La(),exit:La()}}let aa=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class rj extends aa{constructor(e){super(e),e.animationState||(e.animationState=nj(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Nm(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let sj=0;class oj extends aa{constructor(){super(...arguments),this.id=sj++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const aj={animation:{Feature:rj},exit:{Feature:oj}};function Sd(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function sf(n){return{point:{x:n.pageX,y:n.pageY}}}const lj=n=>e=>Jx(e)&&n(e,sf(e));function id(n,e,t,i){return Sd(n,e,lj(t),i)}const MS=(n,e)=>Math.abs(n-e);function cj(n,e){const t=MS(n.x,e.x),i=MS(n.y,e.y);return Math.sqrt(t**2+i**2)}class Q2{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=c_(this.lastMoveEventInfo,this.history),_=this.startEvent!==null,x=cj(p.offset,{x:0,y:0})>=3;if(!_&&!x)return;const{point:S}=p,{timestamp:I}=En;this.history.push({...S,timestamp:I});const{onStart:T,onMove:b}=this.handlers;_||(T&&T(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,p)},this.handlePointerMove=(p,_)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=l_(_,this.transformPagePoint),Tt.update(this.updatePoint,!0)},this.handlePointerUp=(p,_)=>{this.end();const{onEnd:x,onSessionEnd:S,resumeAnimation:I}=this.handlers;if(this.dragSnapToOrigin&&I&&I(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=c_(p.type==="pointercancel"?this.lastMoveEventInfo:l_(_,this.transformPagePoint),this.history);this.startEvent&&x&&x(p,T),S&&S(p,T)},!Jx(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=sf(e),l=l_(o,this.transformPagePoint),{point:u}=l,{timestamp:h}=En;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,c_(l,this.history)),this.removeListeners=rf(id(this.contextWindow,"pointermove",this.handlePointerMove),id(this.contextWindow,"pointerup",this.handlePointerUp),id(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ea(this.updatePoint)}}function l_(n,e){return e?{point:e(n.point)}:n}function LS(n,e){return{x:n.x-e.x,y:n.y-e.y}}function c_({point:n},e){return{point:n,delta:LS(n,J2(e)),offset:LS(n,uj(e)),velocity:hj(e,.1)}}function uj(n){return n[0]}function J2(n){return n[n.length-1]}function hj(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=J2(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>Bs(e)));)t--;if(!i)return{x:0,y:0};const s=Ws(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const eA=1e-4,dj=1-eA,fj=1+eA,tA=.01,gj=0-tA,pj=0+tA;function Ai(n){return n.max-n.min}function mj(n,e,t){return Math.abs(n-e)<=t}function OS(n,e,t,i=.5){n.origin=i,n.originPoint=Nt(e.min,e.max,n.origin),n.scale=Ai(t)/Ai(e),n.translate=Nt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=dj&&n.scale<=fj||isNaN(n.scale))&&(n.scale=1),(n.translate>=gj&&n.translate<=pj||isNaN(n.translate))&&(n.translate=0)}function rd(n,e,t,i){OS(n.x,e.x,t.x,i?i.originX:void 0),OS(n.y,e.y,t.y,i?i.originY:void 0)}function jS(n,e,t){n.min=t.min+e.min,n.max=n.min+Ai(e)}function yj(n,e,t){jS(n.x,e.x,t.x),jS(n.y,e.y,t.y)}function FS(n,e,t){n.min=e.min-t.min,n.max=n.min+Ai(e)}function sd(n,e,t){FS(n.x,e.x,t.x),FS(n.y,e.y,t.y)}function _j(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?Nt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?Nt(t,n,i.max):Math.min(n,t)),n}function VS(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function vj(n,{top:e,left:t,bottom:i,right:r}){return{x:VS(n.x,t,r),y:VS(n.y,e,i)}}function zS(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function xj(n,e){return{x:zS(n.x,e.x),y:zS(n.y,e.y)}}function wj(n,e){let t=.5;const i=Ai(n),r=Ai(e);return r>i?t=ru(e.min,e.max-i,n.min):i>r&&(t=ru(n.min,n.max-r,e.min)),qs(0,1,t)}function Ej(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const xv=.35;function Tj(n=xv){return n===!1?n=0:n===!0&&(n=xv),{x:US(n,"left","right"),y:US(n,"top","bottom")}}function US(n,e,t){return{min:BS(n,e),max:BS(n,t)}}function BS(n,e){return typeof n=="number"?n:n[e]||0}const WS=()=>({translate:0,scale:1,origin:0,originPoint:0}),Wc=()=>({x:WS(),y:WS()}),GS=()=>({min:0,max:0}),Ut=()=>({x:GS(),y:GS()});function qi(n){return[n("x"),n("y")]}function nA({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function Sj({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function Ij(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function u_(n){return n===void 0||n===1}function wv({scale:n,scaleX:e,scaleY:t}){return!u_(n)||!u_(e)||!u_(t)}function Va(n){return wv(n)||iA(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function iA(n){return $S(n.x)||$S(n.y)}function $S(n){return n&&n!=="0%"}function Op(n,e,t){const i=n-t,r=e*i;return t+r}function HS(n,e,t,i,r){return r!==void 0&&(n=Op(n,r,i)),Op(n,t,i)+e}function Ev(n,e=0,t=1,i,r){n.min=HS(n.min,e,t,i,r),n.max=HS(n.max,e,t,i,r)}function rA(n,{x:e,y:t}){Ev(n.x,e.translate,e.scale,e.originPoint),Ev(n.y,t.translate,t.scale,t.originPoint)}const KS=.999999999999,qS=1.0000000000001;function Cj(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&$c(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,rA(n,o)),i&&Va(s.latestValues)&&$c(n,s.latestValues))}e.x<qS&&e.x>KS&&(e.x=1),e.y<qS&&e.y>KS&&(e.y=1)}function Gc(n,e){n.min=n.min+e,n.max=n.max+e}function XS(n,e,t,i,r=.5){const s=Nt(n.min,n.max,r);Ev(n,e,t,s,i)}function $c(n,e){XS(n.x,e.x,e.scaleX,e.scale,e.originX),XS(n.y,e.y,e.scaleY,e.scale,e.originY)}function sA(n,e){return nA(Ij(n.getBoundingClientRect(),e))}function Rj(n,e,t){const i=sA(n,t),{scroll:r}=e;return r&&(Gc(i.x,r.offset.x),Gc(i.y,r.offset.y)),i}const oA=({current:n})=>n?n.ownerDocument.defaultView:null,bj=new WeakMap;class Aj{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(sf(f).point)},s=(f,p)=>{const{drag:_,dragPropagation:x,onDragStart:S}=this.getProps();if(_&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=wO(_),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),qi(T=>{let b=this.getAxisMotionValue(T).get()||0;if(ss.test(b)){const{projection:N}=this.visualElement;if(N&&N.layout){const M=N.layout.layoutBox[T];M&&(b=Ai(M)*(parseFloat(b)/100))}}this.originPoint[T]=b}),S&&Tt.postRender(()=>S(f,p)),dv(this.visualElement,"transform");const{animationState:I}=this.visualElement;I&&I.setActive("whileDrag",!0)},o=(f,p)=>{const{dragPropagation:_,dragDirectionLock:x,onDirectionLock:S,onDrag:I}=this.getProps();if(!_&&!this.openDragLock)return;const{offset:T}=p;if(x&&this.currentDirection===null){this.currentDirection=Pj(T),this.currentDirection!==null&&S&&S(this.currentDirection);return}this.updateAxis("x",p.point,T),this.updateAxis("y",p.point,T),this.visualElement.render(),I&&I(f,p)},l=(f,p)=>this.stop(f,p),u=()=>qi(f=>{var p;return this.getAnimationState(f)==="paused"&&((p=this.getAxisMotionValue(f).animation)===null||p===void 0?void 0:p.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new Q2(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:oA(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Tt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!zg(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=_j(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Uc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=vj(r.layoutBox,t):this.constraints=!1,this.elastic=Tj(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&qi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Ej(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Uc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=Rj(i,r.root,this.visualElement.getTransformPagePoint());let o=xj(r.layout.layoutBox,s);if(t){const l=t(Sj(o));this.hasMutatedConstraints=!!l,l&&(o=nA(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=qi(f=>{if(!zg(f,t,this.currentDirection))return;let p=u&&u[f]||{};o&&(p={min:0,max:0});const _=r?200:1e6,x=r?40:1e7,S={type:"inertia",velocity:i?e[f]:0,bounceStiffness:_,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...s,...p};return this.startAxisValueAnimation(f,S)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return dv(this.visualElement,e),i.start(h1(e,i,0,t,this.visualElement,!1))}stopAnimation(){qi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){qi(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){qi(t=>{const{drag:i}=this.getProps();if(!zg(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-Nt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Uc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};qi(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();r[o]=wj({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),qi(o=>{if(!zg(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(Nt(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;bj.set(this.visualElement,this);const e=this.visualElement.current,t=id(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();Uc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Tt.read(i);const o=Sd(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(qi(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=u[f].translate,p.set(p.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=xv,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function zg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function Pj(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class kj extends aa{constructor(e){super(e),this.removeGroupControls=bi,this.removeListeners=bi,this.controls=new Aj(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||bi}unmount(){this.removeGroupControls(),this.removeListeners()}}const YS=n=>(e,t)=>{n&&Tt.postRender(()=>n(e,t))};class Nj extends aa{constructor(){super(...arguments),this.removePointerDownListener=bi}onPointerDown(e){this.session=new Q2(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:oA(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:YS(e),onStart:YS(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Tt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=id(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const fp={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ZS(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Ah={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Le.test(n))n=parseFloat(n);else return n;const t=ZS(n,e.target.x),i=ZS(n,e.target.y);return`${t}% ${i}%`}},Dj={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=ta.parse(n);if(r.length>5)return i;const s=ta.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=u;const h=Nt(l,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class Mj extends q.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;eO(Lj),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),fp.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Tt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),zx.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function aA(n){const[e,t]=Wb(),i=q.useContext(Nx);return y.jsx(Mj,{...n,layoutGroup:i,switchLayoutGroup:q.useContext(Zb),isPresent:e,safeToRemove:t})}const Lj={borderRadius:{...Ah,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ah,borderTopRightRadius:Ah,borderBottomLeftRadius:Ah,borderBottomRightRadius:Ah,boxShadow:Dj};function Oj(n,e,t){const i=zn(n)?n:Ed(n);return i.start(h1("",i,e,t)),i.animation}function jj(n){return n instanceof SVGElement&&n.tagName!=="svg"}const Fj=(n,e)=>n.depth-e.depth;class Vj{constructor(){this.children=[],this.isDirty=!1}add(e){e1(this.children,e),this.isDirty=!0}remove(e){t1(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Fj),this.isDirty=!1,this.children.forEach(e)}}function zj(n,e){const t=os.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(ea(i),n(s-e))};return Tt.read(i,!0),()=>ea(i)}const lA=["TopLeft","TopRight","BottomLeft","BottomRight"],Uj=lA.length,QS=n=>typeof n=="string"?parseFloat(n):n,JS=n=>typeof n=="number"||Le.test(n);function Bj(n,e,t,i,r,s){r?(n.opacity=Nt(0,t.opacity!==void 0?t.opacity:1,Wj(i)),n.opacityExit=Nt(e.opacity!==void 0?e.opacity:1,0,Gj(i))):s&&(n.opacity=Nt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<Uj;o++){const l=`border${lA[o]}Radius`;let u=eI(e,l),h=eI(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||JS(u)===JS(h)?(n[l]=Math.max(Nt(QS(u),QS(h),i),0),(ss.test(h)||ss.test(u))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=Nt(e.rotate||0,t.rotate||0,i))}function eI(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Wj=cA(0,.5,R2),Gj=cA(.5,.95,bi);function cA(n,e,t){return i=>i<n?0:i>e?1:t(ru(n,e,i))}function tI(n,e){n.min=e.min,n.max=e.max}function Hi(n,e){tI(n.x,e.x),tI(n.y,e.y)}function nI(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function iI(n,e,t,i,r){return n-=e,n=Op(n,1/t,i),r!==void 0&&(n=Op(n,1/r,i)),n}function $j(n,e=0,t=1,i=.5,r,s=n,o=n){if(ss.test(e)&&(e=parseFloat(e),e=Nt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=Nt(s.min,s.max,i);n===s&&(l-=e),n.min=iI(n.min,e,t,l,r),n.max=iI(n.max,e,t,l,r)}function rI(n,e,[t,i,r],s,o){$j(n,e[t],e[i],e[r],e.scale,s,o)}const Hj=["x","scaleX","originX"],Kj=["y","scaleY","originY"];function sI(n,e,t,i){rI(n.x,e,Hj,t?t.x:void 0,i?i.x:void 0),rI(n.y,e,Kj,t?t.y:void 0,i?i.y:void 0)}function oI(n){return n.translate===0&&n.scale===1}function uA(n){return oI(n.x)&&oI(n.y)}function aI(n,e){return n.min===e.min&&n.max===e.max}function qj(n,e){return aI(n.x,e.x)&&aI(n.y,e.y)}function lI(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function hA(n,e){return lI(n.x,e.x)&&lI(n.y,e.y)}function cI(n){return Ai(n.x)/Ai(n.y)}function uI(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class Xj{constructor(){this.members=[]}add(e){e1(this.members,e),e.scheduleRender()}remove(e){if(t1(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Yj(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:p,rotateY:_,skewX:x,skewY:S}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),p&&(i+=`rotateX(${p}deg) `),_&&(i+=`rotateY(${_}deg) `),x&&(i+=`skewX(${x}deg) `),S&&(i+=`skewY(${S}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(i+=`scale(${l}, ${u})`),i||"none"}const za={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},$h=typeof window<"u"&&window.MotionDebug!==void 0,h_=["","X","Y","Z"],Zj={visibility:"hidden"},hI=1e3;let Qj=0;function d_(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function dA(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=x2(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Tt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&dA(i)}function fA({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=Qj++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,$h&&(za.totalNodes=za.resolvedTargetDeltas=za.recalculatedProjection=0),this.nodes.forEach(tF),this.nodes.forEach(oF),this.nodes.forEach(aF),this.nodes.forEach(nF),$h&&window.MotionDebug.record(za)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new Vj)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new n1),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=jj(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||u)&&(this.isLayoutDirty=!0),n){let p;const _=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=zj(_,250),fp.hasAnimatedSinceResize&&(fp.hasAnimatedSinceResize=!1,this.nodes.forEach(fI))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:_,hasRelativeTargetChanged:x,layout:S})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||f.getDefaultTransition()||dF,{onLayoutAnimationStart:T,onLayoutAnimationComplete:b}=f.getProps(),N=!this.targetLayout||!hA(this.targetLayout,S)||x,M=!_&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||M||_&&(N||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,M);const L={...Yx(I,"layout"),onPlay:T,onComplete:b};(f.shouldReduceMotion||this.options.layoutRoot)&&(L.delay=0,L.type=!1),this.startAnimation(L)}else _||fI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=S})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ea(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(lF),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&dA(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(dI);return}this.isUpdating||this.nodes.forEach(rF),this.isUpdating=!1,this.nodes.forEach(sF),this.nodes.forEach(Jj),this.nodes.forEach(eF),this.clearAllSnapshots();const l=os.now();En.delta=qs(0,1e3/60,l-En.timestamp),En.timestamp=l,En.isProcessing=!0,n_.update.process(En),n_.preRender.process(En),n_.render.process(En),En.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,zx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(iF),this.sharedNodes.forEach(cF)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Tt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Tt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!uA(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||Va(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),fF(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(gF))){const{scroll:f}=this.root;f&&(Gc(u.x,f.offset.x),Gc(u.y,f.offset.y))}return u}removeElementScroll(o){var l;const u=Ut();if(Hi(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:p,options:_}=f;f!==this.root&&p&&_.layoutScroll&&(p.wasRoot&&Hi(u,o),Gc(u.x,p.offset.x),Gc(u.y,p.offset.y))}return u}applyTransform(o,l=!1){const u=Ut();Hi(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&$c(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Va(f.latestValues)&&$c(u,f.latestValues)}return Va(this.latestValues)&&$c(u,this.latestValues),u}removeTransform(o){const l=Ut();Hi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Va(h.latestValues))continue;wv(h.latestValues)&&h.updateSnapshot();const f=Ut(),p=h.measurePageBox();Hi(f,p),sI(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return Va(this.latestValues)&&sI(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==En.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:_}=this.options;if(!(!this.layout||!(p||_))){if(this.resolvedRelativeTargetAt=En.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),sd(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),Hi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),yj(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Hi(this.target,this.layout.layoutBox),rA(this.target,this.targetDelta)):Hi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),sd(this.relativeTargetOrigin,this.target,x.target),Hi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}$h&&za.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||wv(this.parent.latestValues)||iA(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===En.timestamp&&(h=!1),h)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;Hi(this.layoutCorrected,this.layout.layoutBox);const _=this.treeScale.x,x=this.treeScale.y;Cj(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:S}=l;if(!S){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(nI(this.prevProjectionDelta.x,this.projectionDelta.x),nI(this.prevProjectionDelta.y,this.projectionDelta.y)),rd(this.projectionDelta,this.layoutCorrected,S,this.latestValues),(this.treeScale.x!==_||this.treeScale.y!==x||!uI(this.projectionDelta.x,this.prevProjectionDelta.x)||!uI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",S)),$h&&za.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Wc(),this.projectionDelta=Wc(),this.projectionDeltaWithTransform=Wc()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},p=Wc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const _=Ut(),x=u?u.source:void 0,S=this.layout?this.layout.source:void 0,I=x!==S,T=this.getStack(),b=!T||T.members.length<=1,N=!!(I&&!b&&this.options.crossfade===!0&&!this.path.some(hF));this.animationProgress=0;let M;this.mixTargetDelta=L=>{const O=L/1e3;gI(p.x,o.x,O),gI(p.y,o.y,O),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(sd(_,this.layout.layoutBox,this.relativeParent.layout.layoutBox),uF(this.relativeTarget,this.relativeTargetOrigin,_,O),M&&qj(this.relativeTarget,M)&&(this.isProjectionDirty=!1),M||(M=Ut()),Hi(M,this.relativeTarget)),I&&(this.animationValues=f,Bj(f,h,this.latestValues,O,N,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=O},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ea(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Tt.update(()=>{fp.hasAnimatedSinceResize=!0,this.currentAnimation=Oj(0,hI,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(hI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:f}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&gA(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Ut();const p=Ai(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const _=Ai(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+_}Hi(l,u),$c(l,f),rd(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Xj),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&d_("z",o,h,this.animationValues);for(let f=0;f<h_.length;f++)d_(`rotate${h_[f]}`,o,h,this.animationValues),d_(`skew${h_[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Zj;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=hp(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const I={};return this.options.layoutId&&(I.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,I.pointerEvents=hp(o?.pointerEvents)||""),this.hasProjected&&!Va(this.latestValues)&&(I.transform=f?f({},""):"none",this.hasProjected=!1),I}const _=p.animationValues||p.latestValues;this.applyTransformsToTarget(),h.transform=Yj(this.projectionDeltaWithTransform,this.treeScale,_),f&&(h.transform=f(_,h.transform));const{x,y:S}=this.projectionDelta;h.transformOrigin=`${x.origin*100}% ${S.origin*100}% 0`,p.animationValues?h.opacity=p===this?(u=(l=_.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:_.opacityExit:h.opacity=p===this?_.opacity!==void 0?_.opacity:"":_.opacityExit!==void 0?_.opacityExit:0;for(const I in kp){if(_[I]===void 0)continue;const{correct:T,applyTo:b}=kp[I],N=h.transform==="none"?_[I]:T(_[I],p);if(b){const M=b.length;for(let L=0;L<M;L++)h[b[L]]=N}else h[I]=N}return this.options.layoutId&&(h.pointerEvents=p===this?hp(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(dI),this.root.sharedNodes.clear()}}}function Jj(n){n.updateLayout()}function eF(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?qi(p=>{const _=o?t.measuredBox[p]:t.layoutBox[p],x=Ai(_);_.min=i[p].min,_.max=_.min+x}):gA(s,t.layoutBox,i)&&qi(p=>{const _=o?t.measuredBox[p]:t.layoutBox[p],x=Ai(i[p]);_.max=_.min+x,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[p].max=n.relativeTarget[p].min+x)});const l=Wc();rd(l,i,t.layoutBox);const u=Wc();o?rd(u,n.applyTransform(r,!0),t.measuredBox):rd(u,i,t.layoutBox);const h=!uA(l);let f=!1;if(!n.resumeFrom){const p=n.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:_,layout:x}=p;if(_&&x){const S=Ut();sd(S,t.layoutBox,_.layoutBox);const I=Ut();sd(I,i,x.layoutBox),hA(S,I)||(f=!0),p.options.layoutRoot&&(n.relativeTarget=I,n.relativeTargetOrigin=S,n.relativeParent=p)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function tF(n){$h&&za.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function nF(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function iF(n){n.clearSnapshot()}function dI(n){n.clearMeasurements()}function rF(n){n.isLayoutDirty=!1}function sF(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function fI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function oF(n){n.resolveTargetDelta()}function aF(n){n.calcProjection()}function lF(n){n.resetSkewAndRotation()}function cF(n){n.removeLeadSnapshot()}function gI(n,e,t){n.translate=Nt(e.translate,0,t),n.scale=Nt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function pI(n,e,t,i){n.min=Nt(e.min,t.min,i),n.max=Nt(e.max,t.max,i)}function uF(n,e,t,i){pI(n.x,e.x,t.x,i),pI(n.y,e.y,t.y,i)}function hF(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const dF={duration:.45,ease:[.4,0,.1,1]},mI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),yI=mI("applewebkit/")&&!mI("chrome/")?Math.round:bi;function _I(n){n.min=yI(n.min),n.max=yI(n.max)}function fF(n){_I(n.x),_I(n.y)}function gA(n,e,t){return n==="position"||n==="preserve-aspect"&&!mj(cI(e),cI(t),.2)}function gF(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const pF=fA({attachResizeListener:(n,e)=>Sd(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),f_={current:void 0},pA=fA({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!f_.current){const n=new pF({});n.mount(window),n.setOptions({layoutScroll:!0}),f_.current=n}return f_.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),mF={pan:{Feature:Nj},drag:{Feature:kj,ProjectionNode:pA,MeasureLayout:aA}};function vI(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Tt.postRender(()=>s(e,sf(e)))}class yF extends aa{mount(){const{current:e}=this.node;e&&(this.unmount=mO(e,t=>(vI(this.node,t,"Start"),i=>vI(this.node,i,"End"))))}unmount(){}}class _F extends aa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=rf(Sd(this.node.current,"focus",()=>this.onFocus()),Sd(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function xI(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Tt.postRender(()=>s(e,sf(e)))}class vF extends aa{mount(){const{current:e}=this.node;e&&(this.unmount=xO(e,t=>(xI(this.node,t,"Start"),(i,{success:r})=>xI(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Tv=new WeakMap,g_=new WeakMap,xF=n=>{const e=Tv.get(n.target);e&&e(n)},wF=n=>{n.forEach(xF)};function EF({root:n,...e}){const t=n||document;g_.has(t)||g_.set(t,{});const i=g_.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(wF,{root:n,...e})),i[r]}function TF(n,e,t){const i=EF(e);return Tv.set(n,t),i.observe(n),()=>{Tv.delete(n),i.unobserve(n)}}const SF={some:0,all:1};class IF extends aa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:SF[r]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),_=h?f:p;_&&_(u)};return TF(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(CF(e,t))&&this.startObserver()}unmount(){}}function CF({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const RF={inView:{Feature:IF},tap:{Feature:vF},focus:{Feature:_F},hover:{Feature:yF}},bF={layout:{ProjectionNode:pA,MeasureLayout:aA}},Sv={current:null},mA={current:!1};function AF(){if(mA.current=!0,!!Lx)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Sv.current=n.matches;n.addListener(e),e()}else Sv.current=!1}const PF=[...U2,On,ta],kF=n=>PF.find(z2(n)),wI=new WeakMap;function NF(n,e,t){for(const i in e){const r=e[i],s=t[i];if(zn(r))n.addValue(i,r);else if(zn(s))n.addValue(i,Ed(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,Ed(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const EI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class DF{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=l1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=os.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,Tt.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=Dm(t),this.isVariantNode=Xb(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,..._}=this.scrapeMotionValuesFromProps(t,{},this);for(const x in _){const S=_[x];u[x]!==void 0&&zn(S)&&S.set(u[x],!1)}}mount(e){this.current=e,wI.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),mA.current||AF(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Sv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){wI.delete(this.current),this.projection&&this.projection.unmount(),ea(this.notifyUpdate),ea(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Al.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Tt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in su){const t=su[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<EI.length;i++){const r=EI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=NF(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=Ed(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(F2(r)||A2(r))?r=parseFloat(r):!kF(r)&&ta.test(t)&&(r=L2(e,t)),this.setBaseTarget(e,zn(r)?r.get():r)),zn(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=Bx(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!zn(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new n1),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class yA extends DF{constructor(){super(...arguments),this.KeyframeResolver=B2}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;zn(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function MF(n){return window.getComputedStyle(n)}class LF extends yA{constructor(){super(...arguments),this.type="html",this.renderInstance=r2}readValueFromInstance(e,t){if(Al.has(t)){const i=a1(t);return i&&i.default||0}else{const i=MF(e),r=(t2(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return sA(e,t)}build(e,t,i){$x(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return Xx(e,t,i)}}class OF extends yA{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Al.has(t)){const i=a1(t);return i&&i.default||0}return t=s2.has(t)?t:Vx(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return l2(e,t,i)}build(e,t,i){Hx(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){o2(e,t,i,r)}mount(e){this.isSVGTag=qx(e.tagName),super.mount(e)}}const jF=(n,e)=>Ux(n)?new OF(e):new LF(e,{allowProjection:n!==q.Fragment}),FF=cO({...aj,...RF,...mF,...bF},jF),We=SL(FF),ri={ADD:"add",REMOVE:"remove"},au={PROPERTYCHANGE:"propertychange"},Ge={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Om{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function VF(n,e,t){let i,r;t=t||Gs;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function Gs(n,e){return n>e?1:n<e?-1:0}function zF(n,e){return n<e?1:n>e?-1:0}function d1(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function UF(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function f1(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function la(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function BF(n,e,t){const i=e||Gs;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Id(){return!0}function jm(){return!1}function Cd(){}function _A(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!la(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function vA(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function of(n){for(const e in n)delete n[e]}function lu(n){let e;for(e in n)return!1;return!e}class eo{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class af extends Om{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new eo(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let u;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,Cd);delete o[i]}return u}disposeInternal(){this.listeners_&&of(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=Cd,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function rt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function jp(n,e,t,i){return rt(n,e,t,i,!0)}function bt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),of(n))}class lf extends af{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Ge.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=rt(this,e[s],t);return r}return rt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=jp(this,e[s],t)}else i=jp(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)WF(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}lf.prototype.on;lf.prototype.once;lf.prototype.un;function WF(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)bt(n[e]);else bt(n)}function it(){throw new Error("Unimplemented abstract method.")}let GF=0;function st(n){return n.ol_uid||(n.ol_uid=String(++GF))}class TI extends eo{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class ds extends lf{constructor(e){super(),this.on,this.once,this.un,st(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new TI(i,e,t)),i=au.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new TI(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],lu(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const SI={LENGTH:"length"};class Ug extends eo{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Zi extends ds{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(SI.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Ug(ri.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Ug(ri.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Ug(ri.REMOVE,r,e)),this.dispatchEvent(new Ug(ri.ADD,t,e))}updateLength_(){this.set(SI.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function ct(n,e){if(!n)throw new Error(e)}class cu extends ds{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new cu(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(bt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=rt(e,Ge.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?$F(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function $F(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(ct(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const un={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function II(n){const e=nr();for(let t=0,i=n.length;t<i;++t)od(e,n[t]);return e}function g1(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function xA(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function wA(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function uu(n,e){return EA(n,e[0],e[1])}function Hh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function EA(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function Iv(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let u=un.UNKNOWN;return o<t?u=u|un.LEFT:o>r&&(u=u|un.RIGHT),l<i?u=u|un.BELOW:l>s&&(u=u|un.ABOVE),u===un.UNKNOWN&&(u=un.INTERSECTING),u}function nr(){return[1/0,1/0,-1/0,-1/0]}function na(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Fm(n){return na(1/0,1/0,-1/0,-1/0,n)}function TA(n,e){const t=n[0],i=n[1];return na(t,i,t,i,e)}function p1(n,e,t,i,r){const s=Fm(r);return SA(s,n,e,t,i)}function Rd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function HF(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function od(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function SA(n,e,t,i,r){for(;t<i;t+=r)KF(n,e[t],e[t+1]);return n}function KF(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function IA(n,e){let t;return t=e(Vm(n)),t||(t=e(zm(n)),t)||(t=e(Um(n)),t)||(t=e(Pl(n)),t)?t:!1}function Cv(n){let e=0;return Bm(n)||(e=ft(n)*qn(n)),e}function Vm(n){return[n[0],n[1]]}function zm(n){return[n[2],n[1]]}function gl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function qF(n,e){let t;if(e==="bottom-left")t=Vm(n);else if(e==="bottom-right")t=zm(n);else if(e==="top-left")t=Pl(n);else if(e==="top-right")t=Um(n);else throw new Error("Invalid corner");return t}function Rv(n,e,t,i,r){const[s,o,l,u,h,f,p,_]=CA(n,e,t,i);return na(Math.min(s,l,h,p),Math.min(o,u,f,_),Math.max(s,l,h,p),Math.max(o,u,f,_),r)}function CA(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),u=r*o,h=r*l,f=s*o,p=s*l,_=n[0],x=n[1];return[_-u+p,x-h-f,_-u-p,x-h+f,_+u-p,x+h+f,_+u+p,x+h-f,_-u+p,x-h-f]}function qn(n){return n[3]-n[1]}function ol(n,e,t){const i=t||nr();return li(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Fm(i),i}function Pl(n){return[n[0],n[3]]}function Um(n){return[n[2],n[3]]}function ft(n){return n[2]-n[0]}function li(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Bm(n){return n[2]<n[0]||n[3]<n[1]}function XF(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function YF(n,e,t){let i=!1;const r=Iv(n,e),s=Iv(n,t);if(r===un.INTERSECTING||s===un.INTERSECTING)i=!0;else{const o=n[0],l=n[1],u=n[2],h=n[3],f=e[0],p=e[1],_=t[0],x=t[1],S=(x-p)/(_-f);let I,T;s&un.ABOVE&&!(r&un.ABOVE)&&(I=_-(x-h)/S,i=I>=o&&I<=u),!i&&s&un.RIGHT&&!(r&un.RIGHT)&&(T=x-(_-u)*S,i=T>=l&&T<=h),!i&&s&un.BELOW&&!(r&un.BELOW)&&(I=_-(x-l)/S,i=I>=o&&I<=u),!i&&s&un.LEFT&&!(r&un.LEFT)&&(T=x-(_-o)*S,i=T>=l&&T<=h)}return i}function RA(n,e){const t=e.getExtent(),i=gl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=ft(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function bA(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];RA(n,e);const r=ft(i);if(ft(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Dt(n,e,t){return Math.min(Math.max(n,e),t)}function ZF(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const u=((n-t)*o+(e-i)*l)/(o*o+l*l);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=l*u)}return Yc(n,e,t,i)}function Yc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function QF(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const u=Math.abs(n[l][i]);u>s&&(s=u,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const u=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function CI(n){return n*180/Math.PI}function Xo(n){return n*Math.PI/180}function al(n,e){const t=n%e;return t*e<0?t+e:t}function Ii(n,e,t){return n+t*(e-n)}function cf(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function jq(n,e){return Math.round(cf(n,e))}function Bg(n,e){return Math.floor(cf(n,e))}function Wg(n,e){return Math.ceil(cf(n,e))}function bv(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function JF(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Fp(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function m1(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function eV(n,e){return n[0]*=e,n[1]*=e,n}function AA(n,e){if(e.canWrapX()){const t=ft(e.getExtent()),i=tV(n,e,t);i&&(n[0]-=i*t)}return n}function tV(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||ft(i),r=Math.floor((n[0]-i[0])/t)),r}function PA(...n){console.warn(...n)}const hu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class y1{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||hu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const uf=6378137,Hc=Math.PI*uf,nV=[-Hc,-Hc,Hc,Hc],iV=[-180,-85,180,85],Gg=uf*Math.log(Math.tan(Math.PI/2));class _c extends y1{constructor(e){super({code:e,units:"m",extent:nV,global:!0,worldExtent:iV,getPointResolution:function(t,i){return t/Math.cosh(i[1]/uf)}})}}const RI=[new _c("EPSG:3857"),new _c("EPSG:102100"),new _c("EPSG:102113"),new _c("EPSG:900913"),new _c("http://www.opengis.net/def/crs/EPSG/0/3857"),new _c("http://www.opengis.net/gml/srs/epsg.xml#3857")];function rV(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Hc*n[s]/180;let o=uf*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>Gg?o=Gg:o<-Gg&&(o=-Gg),e[s+1]=o}return e}function sV(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Hc,e[s+1]=360*Math.atan(Math.exp(n[s+1]/uf))/Math.PI-90;return e}const oV=6378137,bI=[-180,-90,180,90],aV=Math.PI*oV/180;class Oa extends y1{constructor(e,t){super({code:e,units:"degrees",extent:bI,axisOrientation:t,global:!0,metersPerUnit:aV,worldExtent:bI})}}const AI=[new Oa("CRS:84"),new Oa("EPSG:4326","neu"),new Oa("urn:ogc:def:crs:OGC:1.3:CRS84"),new Oa("urn:ogc:def:crs:OGC:2:84"),new Oa("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Oa("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Oa("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Av={};function lV(n){return Av[n]||Av[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function cV(n,e){Av[n]=e}let Zc={};function bd(n,e,t){const i=n.getCode(),r=e.getCode();i in Zc||(Zc[i]={}),Zc[i][r]=t}function p_(n,e){return n in Zc&&e in Zc[n]?Zc[n][e]:null}const Vp=.9996,er=.00669438,Wm=er*er,Gm=Wm*er,Qa=er/(1-er),PI=Math.sqrt(1-er),du=(1-PI)/(1+PI),kA=du*du,_1=kA*du,v1=_1*du,NA=v1*du,DA=1-er/4-3*Wm/64-5*Gm/256,uV=3*er/8+3*Wm/32+45*Gm/1024,hV=15*Wm/256+45*Gm/1024,dV=35*Gm/3072,fV=3/2*du-27/32*_1+269/512*NA,gV=21/16*kA-55/32*v1,pV=151/96*_1-417/128*NA,mV=1097/512*v1,zp=6378137;function yV(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/Vp/(zp*DA),l=o+fV*Math.sin(2*o)+gV*Math.sin(4*o)+pV*Math.sin(6*o)+mV*Math.sin(8*o),u=Math.sin(l),h=u*u,f=Math.cos(l),p=u/f,_=p*p,x=_*_,S=1-er*h,I=Math.sqrt(1-er*h),T=zp/I,b=(1-er)/S,N=Qa*f**2,M=N*N,L=i/(T*Vp),O=L*L,U=O*L,P=U*L,C=P*L,D=C*L,F=l-p/b*(O/2-P/24*(5+3*_+10*N-4*M-9*Qa))+D/720*(61+90*_+298*N+45*x-252*Qa-3*M);let V=(L-U/6*(1+2*_+N)+C/120*(5-2*N+28*_-3*M+8*Qa+24*x))/f;return V=bv(V+Xo(MA(t.number)),-Math.PI,Math.PI),[CI(V),CI(F)]}const kI=-80,NI=84,_V=-180,vV=180;function xV(n,e,t){n=bv(n,_V,vV),e<kI?e=kI:e>NI&&(e=NI);const i=Xo(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,u=l*l,h=Xo(n),f=MA(t.number),p=Xo(f),_=zp/Math.sqrt(1-er*r**2),x=Qa*s**2,S=s*bv(h-p,-Math.PI,Math.PI),I=S*S,T=I*S,b=T*S,N=b*S,M=N*S,L=zp*(DA*i-uV*Math.sin(2*i)+hV*Math.sin(4*i)-dV*Math.sin(6*i)),O=Vp*_*(S+T/6*(1-l+x)+N/120*(5-18*l+u+72*x-58*Qa))+5e5;let U=Vp*(L+_*o*(I/2+b/24*(5-l+9*x+4*x**2)+M/720*(61-58*l+u+600*x-330*Qa)));return t.north||(U+=1e7),[O,U]}function MA(n){return(n-1)*6-180+3}const wV=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function LA(n){let e=0;for(const r of wV){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function DI(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const u=t[l],h=t[l+1],f=n(u,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function EV(n){return LA(n)?new y1({code:n,units:"m"}):null}function TV(n){const e=LA(n.getCode());return e?{forward:DI(xV,e),inverse:DI(yV,e)}:null}const SV=63710088e-1;function MI(n,e,t){t=t||SV;const i=Xo(n[1]),r=Xo(e[1]),s=(r-i)/2,o=Xo(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const IV=[TV],CV=[EV];let Pv=!0;function OA(n){Pv=!1}function x1(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function kv(n){cV(n.getCode(),n),bd(n,n,x1)}function RV(n){n.forEach(kv)}function hi(n){if(typeof n!="string")return n;const e=lV(n);if(e)return e;for(const t of CV){const i=t(n);if(i)return i}return null}function Up(n,e,t,i){n=hi(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/hu[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=E1(n,hi("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=MI(h.slice(0,2),h.slice(2,4)),p=MI(h.slice(4,6),h.slice(6,8));r=(f+p)/2}const u=i?hu[i]:n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function LI(n){RV(n),n.forEach(function(e){n.forEach(function(t){e!==t&&bd(e,t,x1)})})}function bV(n,e,t,i){n.forEach(function(r){e.forEach(function(s){bd(r,s,t),bd(s,r,i)})})}function w1(n,e){return n?typeof n=="string"?hi(n):n:hi(e)}function AV(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),u=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=u?e[o+h]:l[h]}return t})}function pl(n,e){return OA(),$m(n,"EPSG:4326","EPSG:3857")}function Nv(n,e){const t=$m(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=al(i+180,360)-180),t}function gp(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||E1(n,e)===x1)&&t}function E1(n,e){const t=n.getCode(),i=e.getCode();let r=p_(t,i);if(r)return r;let s=null,o=null;for(const u of IV)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=m_(s.inverse,o.forward);else{const u=p_(t,l);u&&(r=m_(u,o.forward))}else{const u=p_(l,i);u&&(r=m_(s.inverse,u))}return r&&(kv(n),kv(e),bd(n,e,r)),r}function m_(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Bp(n,e){const t=hi(n),i=hi(e);return E1(t,i)}function $m(n,e,t){const i=Bp(e,t);if(!i){const r=hi(e).getCode(),s=hi(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Dv(n,e){return n}function Ls(n,e){return Pv&&!Fp(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Pv=!1,PA("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function jA(n,e){return n}function $o(n,e){return n}function PV(){LI(RI),LI(AI),bV(AI,RI,rV,sV)}PV();new Array(6);function Sr(){return[1,0,0,1,0,0]}function kV(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function dn(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Xs(n,e,t,i,r,s,o,l){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-l*i*u+e,n[5]=o*r*u+l*r*h+t,n}function FA(n,e){const t=NV(e);ct(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*l)/t,n[5]=-(i*u-r*l)/t,n}function NV(n){return n[0]*n[3]-n[1]*n[2]}const DV=[1e5,1e5,1e5,1e5,2,2];function MV(n){return"matrix("+n.join(", ")+")"}function Mv(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function LV(n,e){const t=Mv(n),i=Mv(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*DV[r])!==0)return!1;return!0}function Yo(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let u=e;u<t;u+=i){const h=n[u],f=n[u+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let p=2;p<o;p++)s[l++]=n[u+p]}return s&&s.length!=l&&(s.length=l),s}function VA(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),u=Math.sin(r),h=s[0],f=s[1];let p=0;for(let _=e;_<t;_+=i){const x=n[_]-h,S=n[_+1]-f;o[p++]=h+x*l-S*u,o[p++]=f+x*u+S*l;for(let I=_+2;I<_+i;++I)o[p++]=n[I]}return o&&o.length!=p&&(o.length=p),o}function OV(n,e,t,i,r,s,o,l){l=l||[];const u=o[0],h=o[1];let f=0;for(let p=e;p<t;p+=i){const _=n[p]-u,x=n[p+1]-h;l[f++]=u+r*_,l[f++]=h+s*x;for(let S=p+2;S<p+i;++S)l[f++]=n[S]}return l&&l.length!=f&&(l.length=f),l}function jV(n,e,t,i,r,s,o){o=o||[];let l=0;for(let u=e;u<t;u+=i){o[l++]=n[u]+r,o[l++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const OI=Sr(),FV=[NaN,NaN];class VV extends ds{constructor(){super(),this.extent_=nr(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=_A((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return it()}closestPointXY(e,t,i,r){return it()}containsXY(e,t){return this.closestPointXY(e,t,FV,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return it()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Fm(t),this.extentRevision_=this.getRevision()}return XF(this.extent_,e)}rotate(e,t){it()}scale(e,t,i){it()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return it()}getType(){return it()}applyTransform(e){it()}intersectsExtent(e){return it()}translate(e,t){it()}transform(e,t){const i=hi(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const u=i.getExtent(),h=i.getWorldExtent(),f=qn(h)/qn(u);Xs(OI,h[0],h[3],f,-f,0,0,0);const p=Yo(s,0,s.length,l,OI,o),_=Bp(i,t);return _?_(p,p,l):p}:Bp(i,t);return this.applyTransform(r),this}}class T1 extends VV{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return p1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return it()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=jI(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){it()}setLayout(e,t,i){let r;if(e)r=jI(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=zV(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();VA(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=gl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();OV(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();jV(i,0,i.length,r,e,t,i),this.changed()}}}function zV(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function jI(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function UV(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Yo(i,0,i.length,r,e,t)}function FI(n,e,t,i,r,s,o){const l=n[e],u=n[e+1],h=n[t]-l,f=n[t+1]-u;let p;if(h===0&&f===0)p=e;else{const _=((r-l)*h+(s-u)*f)/(h*h+f*f);if(_>1)p=t;else if(_>0){for(let x=0;x<i;++x)o[x]=Ii(n[e+x],n[t+x],_);o.length=i;return}else p=e}for(let _=0;_<i;++_)o[_]=n[p+_];o.length=i}function zA(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],u=n[e+1],h=Yc(s,o,l,u);h>r&&(r=h),s=l,o=u}return r}function UA(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=zA(n,e,l,i,r),e=l}return r}function Fq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=UA(n,e,l,i,r),e=l[l.length-1]}return r}function BA(n,e,t,i,r,s,o,l,u,h,f){if(e==t)return h;let p,_;if(r===0){if(_=Yc(o,l,n[e],n[e+1]),_<h){for(p=0;p<i;++p)u[p]=n[e+p];return u.length=i,_}return h}f=f||[NaN,NaN];let x=e+i;for(;x<t;)if(FI(n,x-i,x,i,o,l,f),_=Yc(o,l,f[0],f[1]),_<h){for(h=_,p=0;p<i;++p)u[p]=f[p];u.length=i,x+=i}else x+=i*Math.max((Math.sqrt(_)-Math.sqrt(h))/r|0,1);if(s&&(FI(n,t-i,e,i,o,l,f),_=Yc(o,l,f[0],f[1]),_<h)){for(h=_,p=0;p<i;++p)u[p]=f[p];u.length=i}return h}function WA(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,_=t.length;p<_;++p){const x=t[p];h=BA(n,e,x,i,r,s,o,l,u,h,f),e=x}return h}function Vq(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let p=0,_=t.length;p<_;++p){const x=t[p];h=WA(n,e,x,i,r,s,o,l,u,h,f),e=x[x.length-1]}return h}function BV(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function GA(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function $A(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=GA(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function zq(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=$A(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function Kc(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Wp(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=Kc(n,e,u,i,r[s]),e=u}return r.length=s,r}function VI(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:Wp(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function zI(n,e,t,i,r,s,o){let l,u;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,u=r;else if(h!==0){let f=n[e],p=n[e+1],_=0;const x=[0];for(let T=e+i;T<t;T+=i){const b=n[T],N=n[T+1];_+=Math.sqrt((b-f)*(b-f)+(N-p)*(N-p)),x.push(_),f=b,p=N}const S=r*_,I=VF(x,S);I<0?(u=(S-x[-I-2])/(x[-I-1]-x[-I-2]),l=e+(-I-2)*i):l=e+I*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:u===void 0?n[l+f]:Ii(n[l+f],n[l+i+f],u);return s}function UI(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,u=t/i;for(;l<u;){const _=l+u>>1;r<n[(_+1)*i-1]?u=_:l=_+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],p=(r-h)/(f-h);o=[];for(let _=0;_<i-1;++_)o.push(Ii(n[(l-1)*i+_],n[l*i+_],p));return o.push(r),o}function Uq(n,e,t,i,r,s,o){if(o)return UI(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let u=0,h=t.length;u<h;++u){const f=t[u];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return UI(n,e,f,i,r,!1);e=f}}return null}function WV(n,e,t,i,r){return!IA(r,function(o){return!Ja(n,e,t,i,o[0],o[1])})}function Ja(n,e,t,i,r,s){let o=0,l=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];u<=s?f>s&&(h-l)*(s-u)-(r-l)*(f-u)>0&&o++:f<=s&&(h-l)*(s-u)-(r-l)*(f-u)<0&&o--,l=h,u=f}return o!==0}function S1(n,e,t,i,r,s){if(t.length===0||!Ja(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(Ja(n,t[o-1],t[o],i,r,s))return!1;return!0}function Bq(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const u=t[o];if(S1(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function GV(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function I1(n,e,t,i,r,s){return s=s??SA(nr(),n,e,t,i),li(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:GV(n,e,t,i,function(o,l){return YF(r,o,l)}):!1}function Wq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(I1(n,e,t[s],i,r))return!0;e=t[s]}return!1}function HA(n,e,t,i,r){return!!(I1(n,e,t,i,r)||Ja(n,e,t,i,r[0],r[1])||Ja(n,e,t,i,r[0],r[3])||Ja(n,e,t,i,r[2],r[1])||Ja(n,e,t,i,r[2],r[3]))}function KA(n,e,t,i,r){if(!HA(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(WV(n,t[s-1],t[s],i,r)&&!I1(n,t[s-1],t[s],i,r))return!1;return!0}function Gq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(KA(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function $V(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const u=n[l],h=n[l+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function C1(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(l);u[0]=1,u[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const p=h.pop(),_=h.pop();let x=0;const S=n[_],I=n[_+1],T=n[p],b=n[p+1];for(let N=_+i;N<p;N+=i){const M=n[N],L=n[N+1],O=ZF(M,L,S,I,T,b);O>x&&(f=N,x=O)}x>r&&(u[(f-e)/i]=1,_+i<f&&h.push(_,f),f+i<p&&h.push(f,p))}for(let p=0;p<l;++p)u[p]&&(s[o++]=n[e+p*i],s[o++]=n[e+p*i+1]);return o}function HV(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=C1(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Ua(n,e){return e*Math.round(n/e)}function KV(n,e,t,i,r,s,o){if(e==t)return o;let l=Ua(n[e],r),u=Ua(n[e+1],r);e+=i,s[o++]=l,s[o++]=u;let h,f;do if(h=Ua(n[e],r),f=Ua(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==u);for(;e<t;){const p=Ua(n[e],r),_=Ua(n[e+1],r);if(e+=i,p==h&&_==f)continue;const x=h-l,S=f-u,I=p-l,T=_-u;if(x*T==S*I&&(x<0&&I<x||x==I||x>0&&I>x)&&(S<0&&T<S||S==T||S>0&&T>S)){h=p,f=_;continue}s[o++]=h,s[o++]=f,l=h,u=f,h=p,f=_}return s[o++]=h,s[o++]=f,o}function R1(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=KV(n,e,f,i,r,s,o),l.push(o),e=f}return o}function $q(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u],p=[];o=R1(n,e,f,i,r,s,o,p),l.push(p),e=f[f.length-1]}return o}class ml extends T1{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new ml(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Yc(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let u=0;u<l;++u)i[u]=s[u];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return TA(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return EA(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=BV(this.flatCoordinates,0,e,this.stride),this.changed()}}const Qi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},yl=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",qV=yl.includes("safari")&&!yl.includes("chrom");qV&&(yl.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(yl));const XV=yl.includes("webkit")&&!yl.includes("edge"),qA=yl.includes("macintosh"),YV=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ri=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,b1=typeof Image<"u"&&Image.prototype.decode,XA=typeof createImageBitmap=="function",YA=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),ze={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function tn(n,e,t,i){let r;return t&&t.length?r=t.shift():Ri?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let y_;function Gp(){return y_||(y_=tn(1,1)),y_}function Hm(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function BI(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function ZV(n){for(;n.lastChild;)n.lastChild.remove()}function QV(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function ZA(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Ho(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const A1=[NaN,NaN,NaN,0];let __;function JV(){return __||(__=tn(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),__}const e4=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,t4=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,n4=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,i4=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function $g(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function ad(n){throw new Error('failed to parse "'+n+'" as color')}function QA(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(t4)||n.match(e4)||n.match(n4);if(s){const o=s[4],l=100/255;return[Dt($g(s[1],l)+.5|0,0,255),Dt($g(s[2],l)+.5|0,0,255),Dt($g(s[3],l)+.5|0,0,255),o!==void 0?Dt($g(o,100),0,1):1]}ad(n)}if(n.startsWith("#")){if(i4.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let f=parseInt(s.substring(u,u+o),16);o===1&&(f+=f<<4),l[u/o]=f}return l[3]=l[3]/255,l}ad(n)}const e=JV();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&ad(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return QA(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=cf(r[3]/255,3),r}function r4(n){return typeof n=="string"?n:k1(n)}const s4=1024,Ph={};let v_=0;function o4(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function x_(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function w_(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function E_(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function T_(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function WI(n){const e=E_(n[0]),t=E_(n[1]),i=E_(n[2]),r=T_(e*.222488403+t*.716873169+i*.06060791),s=500*(T_(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-T_(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function a4(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=w_(e),s=w_(e+t/500*Math.cos(i)),o=w_(e-t/200*Math.sin(i)),l=x_(s*3.021973625-r*1.617392459-o*.404875592),u=x_(s*-.943766287+r*1.916279586+o*.027607165),h=x_(s*.069407491-r*.22898585+o*1.159737864);return[Dt(l+.5|0,0,255),Dt(u+.5|0,0,255),Dt(h+.5|0,0,255),n[3]]}function P1(n){if(n==="none")return A1;if(Ph.hasOwnProperty(n))return Ph[n];if(v_>=s4){let t=0;for(const i in Ph)(t++&3)===0&&(delete Ph[i],--v_)}const e=QA(n);e.length!==4&&ad(n);for(const t of e)isNaN(t)&&ad(n);return Ph[n]=e,++v_,e}function fu(n){return Array.isArray(n)?n:P1(n)}function k1(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}class Hq extends af{constructor(e,t,i,r){super(),this.extent=e,this.pixelRatio_=i,this.resolution=t,this.state=typeof r=="function"?ze.IDLE:r,this.image_=null,this.loader=typeof r=="function"?r:null}changed(){this.dispatchEvent(Ge.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==ze.IDLE&&this.loader){this.state=ze.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;vA(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||XA&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=ze.LOADED}).catch(i=>{this.state=ze.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function l4(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[jp(i,Ge.LOAD,function(){o=!0,s||e()})];return i.src&&b1?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):l.push(jp(i,Ge.ERROR,t)),function(){r=!1,l.forEach(bt)}}function c4(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function JA(n,e){return e&&(n.src=e),n.src&&b1?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):c4(n)}function Kq(n,e){return e&&(n.src=e),n.src&&b1&&XA?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):JA(n)}class u4{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=S_(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=S_(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=S_(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===ze.IDLE&&r.load(),r.getImageState()===ze.LOADING?r.ready().then(()=>{this.patternCache_[o]=Gp().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Gp().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function S_(n,e,t){const i=t?fu(t):"null";return e+":"+n+":"+i}const Ji=new u4;let kh=null;class eP extends af{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?ze.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===ze.LOADED){kh||(kh=tn(1,1,void 0,{willReadFrequently:!0})),kh.drawImage(this.image_,0,0);try{kh.getImageData(0,0,1,1),this.tainted_=!1}catch{kh=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Ge.CHANGE)}handleImageError_(){this.imageState_=ze.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ze.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=tn(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ze.IDLE){this.image_||this.initializeImage_(),this.imageState_=ze.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&JA(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==ze.LOADED)return;const t=this.image_,i=tn(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=r4(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===ze.LOADED||this.imageState_===ze.ERROR)e();else{const t=()=>{(this.imageState_===ze.LOADED||this.imageState_===ze.ERROR)&&(this.removeEventListener(Ge.CHANGE,t),e())};this.addEventListener(Ge.CHANGE,t)}})),this.ready_}}function $p(n,e,t,i,r,s){let o=e===void 0?void 0:Ji.get(e,t,r);return o||(o=new eP(n,n&&"src"in n?n.src||void 0:e,t,i,r),Ji.set(e,t,r,o,s)),s&&o&&!Ji.getPattern(e,t,r)&&Ji.set(e,t,r,o,s),o}function ts(n){return n?Array.isArray(n)?k1(n):typeof n=="object"&&"src"in n?h4(n):n:null}function h4(n){if(!n.offset||!n.size)return Ji.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Ji.getPattern(e,void 0,n.color);if(t)return t;const i=Ji.get(n.src,"anonymous",null);if(i.getImageState()!==ze.LOADED)return null;const r=tn(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),$p(r.canvas,e,void 0,ze.LOADED,n.color,!0),Ji.getPattern(e,void 0,n.color)}class tP{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Hg="ol-hidden",hf="ol-unselectable",N1="ol-control",GI="ol-collapsed",d4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),$I=["style","variant","weight","size","lineHeight","family"],Lv={normal:400,bold:700},Ov=function(n){const e=n.match(d4);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=$I.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[$I[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in Lv&&(t.weight=Lv[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},nP="10px sans-serif",si="#000",gu="round",$s=[],Hs=0,pu="round",Ad=10,Pd="#000",kd="center",Hp="middle",el=[0,0,0,0],Nd=1,Dc=new ds;let Nh=null,HI;const jv={},f4=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function g4(n,e,t){return`${n} ${e} 16px "${t}"`}const p4=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=Ov(s),u=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const p=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),_=Lv[f.weight]||f.weight;return p===u&&f.style===l.style&&_==h})}async function r(){await t.ready;let s=!0;const o=Dc.getProperties(),l=Object.keys(o).filter(u=>o[u]<100);for(let u=l.length-1;u>=0;--u){const h=l[u];let f=o[h];f<100&&(await i(h)?(of(jv),Dc.set(h,100)):(f+=10,Dc.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Ri?self.fonts:document.fonts);const o=Ov(s);if(!o)return;const l=o.families;let u=!1;for(const h of l){if(f4.has(h))continue;const f=g4(o.style,o.weight,h);Dc.get(f)===void 0&&(Dc.set(f,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),m4=(function(){let n;return function(e){let t=jv[e];if(t==null){if(Ri){const i=Ov(e),r=iP(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);jv[e]=t}return t}})();function iP(n,e){return Nh||(Nh=tn(1,1)),n!=HI&&(Nh.font=n,HI=Nh.font),Nh.measureText(e)}function rP(n,e){return iP(n,e).width}function KI(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,rP(n,s)),0);return t[e]=i,i}function y4(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,u=0;for(let h=0,f=e.length;h<=f;h+=2){const p=e[h];if(p===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=u,u=0;continue}const _=e[h+1]||n.font,x=rP(_,p);t.push(x),o+=x;const S=m4(_);i.push(S),u=Math.max(u,S)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function _4(n,e,t,i,r,s,o,l,u,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=p=>p.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(f[0],f[1]),v4(i,n)):f[0]<0||f[1]<0?(n.translate(u,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,u,h,o*f[0],l*f[1]),n.restore()}function v4(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class x4 extends tP{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?cf(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Sr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Yo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,p=s.length;f<p;f+=2){const _=s[f]-this.imageAnchorX_,x=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const S=_+this.imageAnchorX_,I=x+this.imageAnchorY_;Xs(l,S,I,1,1,h,-S,-I),o.save(),o.transform.apply(o,l),o.translate(S,I),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,_,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Yo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=Yo(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let u=l.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!li(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=UV(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!li(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(li(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!li(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!li(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,u=s.length;l<u;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),la(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:kd;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:ts(i||si)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),f=s||$s;this.strokeState_={lineCap:r!==void 0?r:gu,lineDash:this.pixelRatio_===1?f:f.map(p=>p*this.pixelRatio_),lineDashOffset:(o||Hs)*this.pixelRatio_,lineJoin:l!==void 0?l:pu,lineWidth:(u!==void 0?u:Nd)*this.pixelRatio_,miterLimit:h!==void 0?h:Ad,strokeStyle:ts(i||Pd)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const x=t.getColor();this.textFillState_={fillStyle:ts(x||si)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const x=i.getColor(),S=i.getLineCap(),I=i.getLineDash(),T=i.getLineDashOffset(),b=i.getLineJoin(),N=i.getWidth(),M=i.getMiterLimit();this.textStrokeState_={lineCap:S!==void 0?S:gu,lineDash:I||$s,lineDashOffset:T||Hs,lineJoin:b!==void 0?b:pu,lineWidth:N!==void 0?N:Nd,miterLimit:M!==void 0?M:Ad,strokeStyle:ts(x||Pd)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),f=e.getText(),p=e.getTextAlign(),_=e.getTextBaseline();this.textState_={font:r!==void 0?r:nP,textAlign:p!==void 0?p:kd,textBaseline:_!==void 0?_:Hp},this.text_=f!==void 0?Array.isArray(f)?f.reduce((x,S,I)=>x+=I%2?" ":S,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const w4=.5,sP={Point:A4,LineString:C4,Polygon:k4,MultiPoint:P4,MultiLineString:R4,MultiPolygon:b4,GeometryCollection:I4,Circle:T4};function E4(n,e){return parseInt(st(n),10)-parseInt(st(e),10)}function qI(n,e){const t=oP(n,e);return t*t}function oP(n,e){return w4*n/e}function T4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}function XI(n,e,t,i,r,s,o,l){const u=[],h=t.getImage();if(h){let _=!0;const x=h.getImageState();x==ze.LOADED||x==ze.ERROR?_=!1:x==ze.IDLE&&h.load(),_&&u.push(h.ready())}const f=t.getFill();f&&f.loading()&&u.push(f.ready());const p=u.length>0;return p&&Promise.all(u).then(()=>r(null)),S4(n,e,t,i,s,o,l),p}function S4(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const u=l.simplifyTransformed(i,r);if(t.getRenderer())aP(n,u,t,e,o);else{const f=sP[u.getType()];f(n,u,t,e,o,s)}}function aP(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,u=o.length;l<u;++l)aP(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function I4(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,u;for(l=0,u=o.length;l<u;++l){const h=sP[o[l].getType()];h(n,o[l],t,i,r,s)}}function C4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function R4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function b4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}function A4(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=ze.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function P4(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=ze.LOADED)return;const p=n.getBuilder(t.getZIndex(),"Image");p.setImageStyle(o,f),p.drawMultiPoint(e,i,r)}if(h){const p=n.getBuilder(t.getZIndex(),"Text");p.setTextStyle(u,f),p.drawText(e,i,r)}}function k4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}let N4=!1;function D4(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=N4,l.onload=function(u){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function YI(n,e){return function(t,i,r,s,o){D4(n,e,t,i,r,(l,u)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function M4(n,e){return[[-1/0,-1/0,1/0,1/0]]}function L4(n,e,t,i){const r=[];let s=nr();for(let o=0,l=t.length;o<l;++o){const u=t[o];s=p1(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function D1(n,e,t,i,r,s,o){let l,u,h,f,p,_,x;const S=r[s+1],I=[];for(let N=0,M=t.length;N<M;++N){const L=t[N];for(f=n[L-i],_=n[L-i+1],l=e;l<L;l+=i)p=n[l],x=n[l+1],(S<=_&&x<=S||_<=S&&S<=x)&&(h=(S-_)/(x-_)*(p-f)+f,I.push(h)),f=p,_=x}let T=NaN,b=-1/0;for(I.sort(Gs),f=I[0],l=1,u=I.length;l<u;++l){p=I[l];const N=Math.abs(p-f);N>b&&(h=(f+p)/2,S1(n,e,t,i,h,S)&&(T=h,b=N)),f=p}return isNaN(T)&&(T=r[s]),o?(o.push(T,S,b),o):[T,S,b]}function O4(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const u=t[o];s=D1(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function j4(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function M1(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],u=n[e+1];r+=(l-s)*(u+o),s=l,o=u}return r===0?void 0:r>0}function lP(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=M1(n,e,l,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function qq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!lP(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function Fv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=M1(n,e,l,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&j4(n,e,l,i),e=l}return e}function Xq(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=Fv(n,e,t[s],i,r);return e}function F4(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const u=e[o],h=M1(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function cP(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,u=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=u*h-l*f,l=h,u=f}return r/2}function uP(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=cP(n,e,l,i),e=l}return r}function Yq(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=uP(n,e,l,i),e=l[l.length-1]}return r}class Dd extends T1{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Dd(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<wA(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(zA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),BA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return cP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Kc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=C1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Dd(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=GA(this.flatCoordinates,0,e,this.stride),this.changed()}}class Md extends T1{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?f1(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Md(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<wA(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(UA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),WA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return S1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return uP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Fv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Wp(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=gl(this.getExtent());this.flatInteriorPoint_=D1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new ml(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Dd(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const u=i[o],h=new Dd(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;lP(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Fv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=R1(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Md(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return KA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=$A(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function ZI(n){if(Bm(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Md(s,"XY",[s.length])}const QI=Sr();class mr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?TA(this.flatCoordinates_):p1(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=gl(this.getExtent());this.flatInteriorPoints_=D1(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=F4(this.flatCoordinates_,this.ends_),t=L4(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=O4(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=zI(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=zI(e,t,o,2,.5);f1(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=hi(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=qn(i)/qn(t);Xs(QI,i[0],i[3],r,-r,0,0,0),Yo(this.flatCoordinates_,0,this.flatCoordinates_.length,2,QI,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new mr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=_A((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=C1(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=HV(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=R1(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new mr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}mr.prototype.getFlatCoordinates=mr.prototype.getOrientedFlatCoordinates;function hP(n,e,t=0,i=n.length-1,r=V4){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,f=Math.log(u),p=.5*Math.exp(2*f/3),_=.5*Math.sqrt(f*p*(u-p)/u)*(h-u/2<0?-1:1),x=Math.max(t,Math.floor(e-h*p/u+_)),S=Math.min(i,Math.floor(e+(u-h)*p/u+_));hP(n,e,x,S,r)}const s=n[e];let o=t,l=i;for(Dh(n,t,e),r(n[i],s)>0&&Dh(n,t,i);o<l;){for(Dh(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?Dh(n,t,l):(l++,Dh(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function Dh(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function V4(n,e){return n<e?-1:n>e?1:0}let dP=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!qg(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],u=t.leaf?r(l):l;qg(e,u)&&(t.leaf?i.push(l):C_(e,u)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!qg(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(qg(e,o)){if(t.leaf||C_(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Mc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=z4(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&C_(i,r)?(s.push(i),o.push(l),l=0,u=i,i=i.children[0]):u?(l++,i=u.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=Mc(e.slice(t,i+1)),vc(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=Mc([]),l.leaf=!1,l.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));JI(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const p=Math.min(f+h-1,i);JI(e,f,p,u,this.compareMinY);for(let _=f;_<=p;_+=u){const x=Math.min(_+u-1,p);l.children.push(this._build(e,_,x,r-1))}}return vc(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let u=0;u<t.children.length;u++){const h=t.children[u],f=I_(h),p=W4(e,h)-f;p<o?(o=p,s=f<s?f:s,l=h):p===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),qh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=Mc(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,vc(i,this.toBBox),vc(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=Mc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,vc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const u=Kh(e,0,l,this.toBBox),h=Kh(e,l,i,this.toBBox),f=G4(u,h),p=I_(u)+I_(h);f<s?(s=f,r=l,o=p<o?p:o):f===s&&p<o&&(o=p,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:U4,s=e.leaf?this.compareMinY:B4,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Kh(e,0,t,s),l=Kh(e,i-t,i,s);let u=Kg(o)+Kg(l);for(let h=t;h<i-t;h++){const f=e.children[h];qh(o,e.leaf?s(f):f),u+=Kg(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];qh(l,e.leaf?s(f):f),u+=Kg(l)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)qh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():vc(e[t],this.toBBox)}};function z4(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function vc(n,e){Kh(n,0,n.children.length,e,n)}function Kh(n,e,t,i,r){r||(r=Mc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];qh(r,n.leaf?i(o):o)}return r}function qh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function U4(n,e){return n.minX-e.minX}function B4(n,e){return n.minY-e.minY}function I_(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Kg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function W4(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function G4(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function C_(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function qg(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Mc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function JI(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;hP(n,o,e,t,r),s.push(e,o,o,t)}}class eC{constructor(e){this.rbush_=new dP(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[st(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=u,this.items_[st(l)]=u}this.rbush_.load(i)}remove(e){const t=st(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[st(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Rd(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return lu(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return na(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class fP extends ds{constructor(e){super(),this.projection=hi(e.projection),this.attributions_=tC(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=tC(e),this.changed()}setState(e){this.state_=e,this.changed()}}function tC(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const Ki={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Ro extends eo{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class L1 extends fP{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Cd,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(ct(this.format_,"`format` must be set when `url` is set"),this.loader_=YI(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:M4;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new eC:null,this.loadedExtentsRtree_=new eC,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Zi(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=st(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Ro(Ki.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof mr||(this.featureChangeKeys_[e]=[rt(t,Ge.CHANGE,this.handleFeatureChange_,this),rt(t,au.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof mr){const s=this.idIndex_[r];s instanceof mr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(ct(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],u=st(l);this.addToIndex_(u,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],u=st(l);this.setupChangeEvents_(u,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(Ki.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Ro(Ki.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Ki.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(Ki.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(ri.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(ri.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(bt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Ro(Ki.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof mr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof mr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),lu(this.nullGeometryFeatures_)||f1(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=bA(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||Id,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const f=h.getGeometry(),p=l;if(l=f instanceof mr?0:f.closestPointXY(i,r,o,l),l<p){s=h;const _=Math.sqrt(l);u[0]=i-_,u[1]=r-_,u[2]=i+_,u[3]=r+_}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=st(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new Ro(Ki.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:st(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&lu(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const u=s[o];r.forEachInExtent(u,function(f){return Hh(f.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Ro(Ki.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ro(Ki.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ro(Ki.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Rd(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=st(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(bt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(Ki.REMOVEFEATURE)&&this.dispatchEvent(new Ro(Ki.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){ct(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(YI(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Rr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Rr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=$p(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===ze.IDLE&&t.load(),t.getImageState()===ze.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?st(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:fu(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Lu{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Lu({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function nC(n){return n[0]>0&&n[1]>0}function $4(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function ui(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Km{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=ui(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Km({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return it()}getImage(e){return it()}getHitDetectionImage(){return it()}getPixelRatio(e){return 1}getImageState(){return it()}getImageSize(){return it()}getOrigin(){return it()}getSize(){return it()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ui(e)}listenImageChange(e){it()}load(){it()}unlistenImageChange(e){it()}ready(){return Promise.resolve()}}class qm extends Km{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?ze.LOADING:ze.LOADED,this.imageState_===ze.LOADING&&this.ready().then(()=>this.imageState_=ze.LOADED),this.render()}clone(){const e=this.getScale(),t=new qm({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Ji.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=tn(o,o);this.draw_(s,l,e),r=l.canvas,Ji.set(i,null,null,new eP(r,void 0,null,ze.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const U=r;r=s,s=U}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,u=s*Math.sin(l),h=Math.sqrt(s*s-u*u),f=r-h,p=Math.sqrt(u*u+f*f),_=p/u;if(e==="miter"&&_<=i)return _*t;const x=t/2/_,S=t/2*(f/p),T=Math.sqrt((r+x)*(r+x)+S*S)-r;if(this.radius2_===void 0||e==="bevel")return T*2;const b=r*Math.sin(l),N=Math.sqrt(r*r-b*b),M=s-N,O=Math.sqrt(b*b+M*M)/b;if(O<=i){const U=O*t/2-s-r;return 2*Math.max(T,U)}return T*2}createRenderOptions(){let e=gu,t=pu,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=ts(this.stroke_.getColor()??Pd),l=this.stroke_.getWidth()??Nd,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??pu,e=this.stroke_.getLineCap()??gu,i=this.stroke_.getMiterLimit()??Ad);const u=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=si),t.fillStyle=ts(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=fu(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=tn(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const u=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=si,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class kl extends qm{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new kl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class tr{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=iC,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new tr({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=iC,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function H4(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(ct(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let R_=null;function gP(n,e){if(!R_){const t=new Rr({color:"rgba(255,255,255,0.4)"}),i=new Lu({color:"#3399CC",width:1.25});R_=[new tr({image:new kl({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return R_}function iC(n){return n.getGeometry()}const K4="#333";class df{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=ui(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Rr({color:K4}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new df({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Rr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ui(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const jn={ANIMATING:0,INTERACTING:1},Pe={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Xg=[Pe.FILL],Ko=[Pe.STROKE],tl=[Pe.BEGIN_PATH],rC=[Pe.CLOSE_PATH];class ff extends tP{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,u=e.length;l<u;l+=t)r[0]=e[l],r[1]=e[l+1],uu(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let u=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],p=e[t+1];const _=this.tmpCoordinate_;let x=!0,S,I,T;for(S=t+r;S<i;S+=r)_[0]=e[S],_[1]=e[S+1],T=Iv(h,_),T!==I?(x&&(l[u++]=f,l[u++]=p,x=!1),l[u++]=_[0],l[u++]=_[1]):T===un.INTERSECTING?(l[u++]=_[0],l[u++]=_[1],x=!1):x=!0,f=_[0],p=_[1],I=T;return(s&&x||S===t+r)&&(l[u++]=f,l[u++]=p),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),u=this.coordinates.length;let h,f,p,_,x;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),_=[];const S=e.getEndss();x=0;for(let I=0,T=S.length;I<T;++I){const b=[];x=this.drawCustomCoordinates_(h,x,S[I],l,b),_.push(b)}this.instructions.push([Pe.CUSTOM,u,_,e,i,VI,s]),this.hitDetectionInstructions.push([Pe.CUSTOM,u,_,e,r||i,VI,s]);break;case"Polygon":case"MultiLineString":p=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),x=this.drawCustomCoordinates_(h,0,e.getEnds(),l,p),this.instructions.push([Pe.CUSTOM,u,p,e,i,Wp,s]),this.hitDetectionInstructions.push([Pe.CUSTOM,u,p,e,r||i,Wp,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Pe.CUSTOM,u,f,e,i,Kc,s]),this.hitDetectionInstructions.push([Pe.CUSTOM,u,f,e,r||i,Kc,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>u&&(this.instructions.push([Pe.CUSTOM,u,f,e,i,Kc,s]),this.hitDetectionInstructions.push([Pe.CUSTOM,u,f,e,r||i,Kc,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Pe.CUSTOM,u,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Pe.CUSTOM,u,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Pe.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Pe.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Pe.END_GEOMETRY?o=t:s==Pe.BEGIN_GEOMETRY&&(r[2]=t,UF(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=ts(i||si)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=ts(i||Pd);const r=e.getLineCap();t.lineCap=r!==void 0?r:gu;const s=e.getLineDash();t.lineDash=s?s.slice():$s;const o=e.getLineDashOffset();t.lineDashOffset=o||Hs;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:pu;const u=e.getWidth();t.lineWidth=u!==void 0?u:Nd;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Ad,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Pe.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Pe.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!la(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Pe.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=xA(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;g1(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class q4 extends ff{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!uu(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Pe.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Pe.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||uu(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Pe.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Pe.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class X4 extends ff{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Pe.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Pe.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,$s,Hs],tl);const l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push(Ko),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Pe.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,$s,Hs],tl);const l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,_=l.length;p<_;++p)f=this.drawFlatCoordinates_(u,f,l[p],h);this.hitDetectionInstructions.push(Ko),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Ko),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Ko),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(tl)}}class sC extends ff{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,u=i.length;this.instructions.push(tl),this.hitDetectionInstructions.push(tl);for(let h=0;h<u;++h){const f=i[h],p=this.coordinates.length,_=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),x=[Pe.MOVE_TO_LINE_TO,p,_];this.instructions.push(x),this.hitDetectionInstructions.push(x),l&&(this.instructions.push(rC),this.hitDetectionInstructions.push(rC)),t=f}return o&&(this.instructions.push(Xg),this.hitDetectionInstructions.push(Xg)),l&&(this.instructions.push(Ko),this.hitDetectionInstructions.push(Ko)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Pe.SET_FILL_STYLE,si]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Pe.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,$s,Hs]);const l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);const f=[Pe.CIRCLE,h];this.instructions.push(tl,f),this.hitDetectionInstructions.push(tl,f),r.fillStyle!==void 0&&(this.instructions.push(Xg),this.hitDetectionInstructions.push(Xg)),r.strokeStyle!==void 0&&(this.instructions.push(Ko),this.hitDetectionInstructions.push(Ko)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Pe.SET_FILL_STYLE,si]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Pe.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,$s,Hs]);const l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Pe.SET_FILL_STYLE,si]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Pe.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,$s,Hs]);const l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let p=0,_=l.length;p<_;++p)f=this.drawFlatCoordinatess_(u,f,l[p],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Ua(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function Y4(n,e,t,i,r){const s=[];let o=t,l=0,u=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=u.slice(-2),p=e[o+r],_=e[o+r+1],x=Math.sqrt((p-h)*(p-h)+(_-f)*(_-f));if(l+=x,l>=n){const S=(n-l+x)/x,I=Ii(h,p,S),T=Ii(f,_,S);u.push(I,T),s.push(u),u=[I,T],l==n&&(o+=r),l=0}else if(l<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const S=x-l,I=Ii(h,p,S/x),T=Ii(f,_,S/x);u.push(I,T),s.push(u),u=[I,T],l=0,o+=r}}return l>0&&s.push(u),s}function Z4(n,e,t,i,r){let s=t,o=t,l=0,u=0,h=t,f,p,_,x,S,I,T,b,N,M;for(p=t;p<i;p+=r){const L=e[p],O=e[p+1];S!==void 0&&(N=L-S,M=O-I,x=Math.sqrt(N*N+M*M),T!==void 0&&(u+=_,f=Math.acos((T*N+b*M)/(_*x)),f>n&&(u>l&&(l=u,s=h,o=p),u=0,h=p-r)),_=x,T=N,b=M),S=L,I=O}return u+=x,u>l?[h,p]:[s,o]}const Kp={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Q4 extends ff{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[si]={fillStyle:si},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let u=l.length;const h=e.getType();let f=null,p=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!li(this.maxExtent,e.getExtent()))return;let _;if(f=e.getFlatCoordinates(),h=="LineString")_=[f.length];else if(h=="MultiLineString")_=e.getEnds();else if(h=="Polygon")_=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const T=e.getEndss();_=[];for(let b=0,N=T.length;b<N;++b)_.push(T[b][0])}this.beginGeometry(e,t,i);const x=o.repeat,S=x?void 0:o.textAlign;let I=0;for(let T=0,b=_.length;T<b;++T){let N;x?N=Y4(x*this.resolution,f,I,_[T],p):N=[f.slice(I,_[T])];for(let M=0,L=N.length;M<L;++M){const O=N[M];let U=0,P=O.length;if(S==null){const D=Z4(o.maxAngle,O,0,O.length,2);U=D[0],P=D[1]}for(let D=U;D<P;D+=p)l.push(O[D],O[D+1]);const C=l.length;I=_[T],this.drawChars_(u,C),u=C}}this.endGeometry(t)}else{let _=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),p=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||_.push(f[2]/this.resolution),p=3;break;case"MultiPolygon":const L=e.getFlatInteriorPoints();f=[];for(let O=0,U=L.length;O<U;O+=3)o.overflow||_.push(L[O+2]/this.resolution),f.push(L[O],L[O+1]);if(f.length===0)return;p=2;break}const x=this.appendFlatPointCoordinates(f,p);if(x===u)return;if(_&&(x-u)/2!==f.length/p){let L=u/2;_=_.filter((O,U)=>{const P=l[(L+U)*2]===f[U*p]&&l[(L+U)*2+1]===f[U*p+1];return P||--L,P})}this.saveTextStates_();const S=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,I=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let T=o.padding;if(T!=el&&(o.scale[0]<0||o.scale[1]<0)){let L=o.padding[0],O=o.padding[1],U=o.padding[2],P=o.padding[3];o.scale[0]<0&&(O=-O,P=-P),o.scale[1]<0&&(L=-L,U=-U),T=[L,O,U,P]}const b=this.pixelRatio;this.instructions.push([Pe.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,T==el?el:T.map(function(L){return L*b}),S,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]);const N=1/b,M=S?S.slice(0):null;M&&(M[1]=si),this.hitDetectionInstructions.push([Pe.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[N,N],NaN,this.declutterMode_,this.declutterImageWithText_,T,M,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?si:this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||kd,justify:t.justify,textBaseline:t.textBaseline||Hp,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=Kp[r.textBaseline],f=this.textOffsetY_*u,p=this.text_,_=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Pe.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,u,f,s,_*u,p,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Pe.DRAW_CHARS,e,t,h,r.overflow,l&&si,r.maxAngle,u,f,s,_*u,p,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=ts(o.getColor()||si)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const I=l.getLineDash(),T=l.getLineDashOffset(),b=l.getWidth(),N=l.getMiterLimit();s.lineCap=l.getLineCap()||gu,s.lineDash=I?I.slice():$s,s.lineDashOffset=T===void 0?Hs:T,s.lineJoin=l.getLineJoin()||pu,s.lineWidth=b===void 0?Nd:b,s.miterLimit=N===void 0?Ad:N,s.strokeStyle=ts(l.getColor()||Pd)}i=this.textState_;const u=e.getFont()||nP;p4(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Hp,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||el,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),p=e.getOffsetY(),_=e.getRotateWithView(),x=e.getKeepUpright(),S=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=p===void 0?0:p,this.textRotateWithView_=_===void 0?!1:_,this.textKeepUpright_=x===void 0?!0:x,this.textRotation_=S===void 0?0:S,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:st(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+st(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const J4={Circle:sC,Default:ff,Image:q4,LineString:X4,Polygon:sC,Text:Q4};class e3{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=J4[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function t3(n,e,t,i,r,s,o,l,u,h,f,p,_=!0){let x=n[e],S=n[e+1],I=0,T=0,b=0,N=0;function M(){I=x,T=S,e+=i,x=n[e],S=n[e+1],N+=b,b=Math.sqrt((x-I)*(x-I)+(S-T)*(S-T))}do M();while(e<t-i&&N+b<s);let L=b===0?0:(s-N)/b;const O=Ii(I,x,L),U=Ii(T,S,L),P=e-i,C=N,D=s+l*u(h,r,f);for(;e<t-i&&N+b<D;)M();L=b===0?0:(D-N)/b;const F=Ii(I,x,L),V=Ii(T,S,L);let B=!1;if(_)if(p){const ue=[O,U,F,V];VA(ue,0,4,2,p,ue,ue),B=ue[0]>ue[2]}else B=O>F;const k=Math.PI,te=[],de=P+i===e;e=P,b=0,N=C,x=n[e],S=n[e+1];let ge;if(de){M(),ge=Math.atan2(S-T,x-I),B&&(ge+=ge>0?-k:k);const ue=(F+O)/2,G=(V+U)/2;return te[0]=[ue,G,(D-s)/2,ge,r],te}r=r.replace(/\n/g," ");for(let ue=0,G=r.length;ue<G;){M();let ie=Math.atan2(S-T,x-I);if(B&&(ie+=ie>0?-k:k),ge!==void 0){let xe=ie-ge;if(xe+=xe>k?-2*k:xe<-k?2*k:0,Math.abs(xe)>o)return null}ge=ie;const ne=ue;let W=0;for(;ue<G;++ue){const xe=B?G-ue-1:ue,re=l*u(h,r[xe],f);if(e+i<t&&N+b<s+W+re/2)break;W+=re}if(ue===ne)continue;const $=B?r.substring(G-ne,G-ue):r.substring(ne,ue);L=b===0?0:(s+W/2-N)/b;const oe=Ii(I,x,L),me=Ii(T,S,L);te.push([oe,me,W/2,ie,$]),s+=W}return te}class pP{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Gp(),{get:(e,t)=>{if(typeof Gp()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const xc=nr(),bo=[],Ds=[],Ms=[],Ao=[];function oC(n){return n[3].declutterBox}const aC=new RegExp("[-----]");function b_(n,e){return e==="start"?e=aC.test(n)?"right":"left":e==="end"&&(e=aC.test(n)?"left":"right"),Kp[e]}function n3(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function i3(n,e,t){return t%2===0&&(n+=e),n}class r3{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Sr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new pP:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,f=[u.scale[0]*h,u.scale[1]*h],p=u.justify?Kp[u.justify]:b_(Array.isArray(e)?e[0]:e,u.textAlign||kd),_=r&&o.lineWidth?o.lineWidth:0,x=Array.isArray(e)?e:String(e).split(`
`).reduce(n3,[]),{width:S,height:I,widths:T,heights:b,lineWidths:N}=y4(u,x),M=S+_,L=[],O=(M+2)*f[0],U=(I+_)*f[1],P={width:O<0?Math.floor(O):Math.ceil(O),height:U<0?Math.floor(U):Math.ceil(U),contextInstructions:L};(f[0]!=1||f[1]!=1)&&L.push("scale",f),r&&(L.push("strokeStyle",o.strokeStyle),L.push("lineWidth",_),L.push("lineCap",o.lineCap),L.push("lineJoin",o.lineJoin),L.push("miterLimit",o.miterLimit),L.push("setLineDash",[o.lineDash]),L.push("lineDashOffset",o.lineDashOffset)),i&&L.push("fillStyle",l.fillStyle),L.push("textBaseline","middle"),L.push("textAlign","center");const C=.5-p;let D=p*M+C*_;const F=[],V=[];let B=0,k=0,te=0,de=0,ge;for(let ue=0,G=x.length;ue<G;ue+=2){const ie=x[ue];if(ie===`
`){k+=B,B=0,D=p*M+C*_,++de;continue}const ne=x[ue+1]||u.font;ne!==ge&&(r&&F.push("font",ne),i&&V.push("font",ne),ge=ne),B=Math.max(B,b[te]);const W=[ie,D+C*T[te]+p*(T[te]-N[de]),.5*(_+B)+k];D+=T[te],r&&F.push("strokeText",W),i&&V.push("fillText",W),++te}return Array.prototype.push.apply(L,F),Array.prototype.push.apply(L,V),this.labels_[s]=P,P}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,u,h,f,p,_,x,S,I,T){l*=_[0],u*=_[1];let b=i-l,N=r-u;const M=s+h>e?e-h:s,L=o+f>t?t-f:o,O=S[3]+M*_[0]+S[1],U=S[0]+L*_[1]+S[2],P=b-S[3],C=N-S[0];(I||p!==0)&&(bo[0]=P,Ao[0]=P,bo[1]=C,Ds[1]=C,Ds[0]=P+O,Ms[0]=Ds[0],Ms[1]=C+U,Ao[1]=Ms[1]);let D;return p!==0?(D=Xs(Sr(),i,r,1,1,p,-i,-r),dn(D,bo),dn(D,Ds),dn(D,Ms),dn(D,Ao),na(Math.min(bo[0],Ds[0],Ms[0],Ao[0]),Math.min(bo[1],Ds[1],Ms[1],Ao[1]),Math.max(bo[0],Ds[0],Ms[0],Ao[0]),Math.max(bo[1],Ds[1],Ms[1],Ao[1]),xc)):na(Math.min(P,P+O),Math.min(C,C+U),Math.max(P,P+O),Math.max(C,C+U),xc),x&&(b=Math.round(b),N=Math.round(N)),{drawImageX:b,drawImageY:N,drawImageW:M,drawImageH:L,originX:h,originY:f,declutterBox:{minX:xc[0],minY:xc[1],maxX:xc[2],maxY:xc[3],value:T},canvasTransform:D,scale:_}}replayImageOrLabel_(e,t,i,r,s,o,l){const u=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(u&&this.replayTextBackground_(e,bo,Ds,Ms,Ao,o,l),_4(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=dn(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],u=this.pixelRatio,h=b_(Array.isArray(e)?e[0]:e,s.textAlign||kd),f=Kp[s.textBaseline||Hp],p=l&&l.lineWidth?l.lineWidth:0,_=o.width/u-2*s.scale[0],x=h*_+2*(.5-h)*p,S=f*o.height/u+2*(.5-f)*p;return{label:o,anchorX:x,anchorY:S}}execute_(e,t,i,r,s,o,l,u){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&la(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=Yo(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),kV(this.renderedTransform_,i));let p=0;const _=r.length;let x=0,S,I,T,b,N,M,L,O,U,P,C,D,F,V=0,B=0;const k=this.coordinateCache_,te=this.viewRotation_,de=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ge={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:te},ue=this.instructions!=r||this.overlaps?0:200;let G,ie,ne,W;for(;p<_;){const $=r[p];switch($[0]){case Pe.BEGIN_GEOMETRY:G=$[1],W=$[3],G.getGeometry()?l!==void 0&&!li(l,W.getExtent())?p=$[2]+1:++p:p=$[2],h&&(h.zIndex=$[4]);break;case Pe.BEGIN_PATH:V>ue&&(this.fill_(e),V=0),B>ue&&(e.stroke(),B=0),!V&&!B&&(e.beginPath(),N=NaN,M=NaN),++p;break;case Pe.CIRCLE:x=$[1];const me=f[x],xe=f[x+1],re=f[x+2],_e=f[x+3],we=re-me,Ce=_e-xe,Be=Math.sqrt(we*we+Ce*Ce);e.moveTo(me+Be,xe),e.arc(me,xe,Be,0,2*Math.PI,!0),++p;break;case Pe.CLOSE_PATH:e.closePath(),++p;break;case Pe.CUSTOM:x=$[1],S=$[2];const Wt=$[3],Un=$[4],Yt=$[5];ge.geometry=Wt,ge.feature=G,p in k||(k[p]=[]);const bn=k[p];Yt?Yt(f,x,S,2,bn):(bn[0]=f[x],bn[1]=f[x+1],bn.length=2),h&&(h.zIndex=$[6]),Un(bn,ge),++p;break;case Pe.DRAW_IMAGE:x=$[1],S=$[2],U=$[3],I=$[4],T=$[5];let fn=$[6];const gn=$[7],Yn=$[8],Ni=$[9],_t=$[10];let ut=$[11];const sn=$[12];let Di=$[13];b=$[14]||"declutter";const It=$[15];if(!U&&$.length>=20){P=$[19],C=$[20],D=$[21],F=$[22];const jt=this.drawLabelWithPointPlacement_(P,C,D,F);U=jt.label,$[3]=U;const Oi=$[23];I=(jt.anchorX-Oi)*this.pixelRatio,$[4]=I;const pn=$[24];T=(jt.anchorY-pn)*this.pixelRatio,$[5]=T,fn=U.height,$[6]=fn,Di=U.width,$[13]=Di}let io;$.length>25&&(io=$[25]);let Mi,Pr,ir;$.length>17?(Mi=$[16],Pr=$[17],ir=$[18]):(Mi=el,Pr=null,ir=null),_t&&de?ut+=te:!_t&&!de&&(ut-=te);let kr=0;for(;x<S;x+=2){if(io&&io[kr++]<Di/this.pixelRatio)continue;const jt=this.calculateImageOrLabelDimensions_(U.width,U.height,f[x],f[x+1],Di,fn,I,T,Yn,Ni,ut,sn,s,Mi,!!Pr||!!ir,G),Oi=[e,t,U,jt,gn,Pr,ir];if(u){let pn,Ft,mn;if(It){const ot=S-x;if(!It[ot]){It[ot]={args:Oi,declutterMode:b};continue}const Gt=It[ot];pn=Gt.args,Ft=Gt.declutterMode,delete It[ot],mn=oC(pn)}let yn,on;if(pn&&(Ft!=="declutter"||!u.collides(mn))&&(yn=!0),(b!=="declutter"||!u.collides(jt.declutterBox))&&(on=!0),Ft==="declutter"&&b==="declutter"){const ot=yn&&on;yn=ot,on=ot}yn&&(Ft!=="none"&&u.insert(mn),this.replayImageOrLabel_.apply(this,pn)),on&&(b!=="none"&&u.insert(jt.declutterBox),this.replayImageOrLabel_.apply(this,Oi))}else this.replayImageOrLabel_.apply(this,Oi)}++p;break;case Pe.DRAW_CHARS:const ua=$[1],Nr=$[2],Li=$[3],Ol=$[4];F=$[5];const Dr=$[6],ms=$[7],ro=$[8];D=$[9];const Bn=$[10];P=$[11],Array.isArray(P)&&(P=P.reduce(i3,"")),C=$[12];const ys=[$[13],$[13]];b=$[14]||"declutter";const Mr=$[15],Lr=this.textStates[C],Wn=Lr.font,Gn=[Lr.scale[0]*ms,Lr.scale[1]*ms];let gt;Wn in this.widths_?gt=this.widths_[Wn]:(gt={},this.widths_[Wn]=gt);const so=$V(f,ua,Nr,2),rr=Math.abs(Gn[0])*KI(Wn,P,gt);if(Ol||rr<=so){const jt=this.textStates[C].textAlign,Oi=(so-rr)*b_(P,jt),pn=t3(f,ua,Nr,2,P,Oi,Dr,Math.abs(Gn[0]),KI,Wn,gt,de?0:this.viewRotation_,Mr);e:if(pn){const Ft=[];let mn,yn,on,ot,Gt;if(D)for(mn=0,yn=pn.length;mn<yn;++mn){Gt=pn[mn],on=Gt[4],ot=this.createLabel(on,C,"",D),I=Gt[2]+(Gn[0]<0?-Bn:Bn),T=Li*ot.height+(.5-Li)*2*Bn*Gn[1]/Gn[0]-ro;const Zt=this.calculateImageOrLabelDimensions_(ot.width,ot.height,Gt[0],Gt[1],ot.width,ot.height,I,T,0,0,Gt[3],ys,!1,el,!1,G);if(u&&b==="declutter"&&u.collides(Zt.declutterBox))break e;Ft.push([e,t,ot,Zt,1,null,null])}if(F)for(mn=0,yn=pn.length;mn<yn;++mn){Gt=pn[mn],on=Gt[4],ot=this.createLabel(on,C,F,""),I=Gt[2],T=Li*ot.height-ro;const Zt=this.calculateImageOrLabelDimensions_(ot.width,ot.height,Gt[0],Gt[1],ot.width,ot.height,I,T,0,0,Gt[3],ys,!1,el,!1,G);if(u&&b==="declutter"&&u.collides(Zt.declutterBox))break e;Ft.push([e,t,ot,Zt,1,null,null])}u&&b!=="none"&&u.load(Ft.map(oC));for(let Zt=0,ji=Ft.length;Zt<ji;++Zt)this.replayImageOrLabel_.apply(this,Ft[Zt])}}++p;break;case Pe.END_GEOMETRY:if(o!==void 0){G=$[1];const jt=o(G,W,b);if(jt)return jt}++p;break;case Pe.FILL:ue?V++:this.fill_(e),++p;break;case Pe.MOVE_TO_LINE_TO:for(x=$[1],S=$[2],ie=f[x],ne=f[x+1],e.moveTo(ie,ne),N=ie+.5|0,M=ne+.5|0,x+=2;x<S;x+=2)ie=f[x],ne=f[x+1],L=ie+.5|0,O=ne+.5|0,(x==S-2||L!==N||O!==M)&&(e.lineTo(ie,ne),N=L,M=O);++p;break;case Pe.SET_FILL_STYLE:this.alignAndScaleFill_=$[2],V&&(this.fill_(e),V=0,B&&(e.stroke(),B=0)),e.fillStyle=$[1],++p;break;case Pe.SET_STROKE_STYLE:B&&(e.stroke(),B=0),this.setStrokeStyle_(e,$),++p;break;case Pe.STROKE:ue?B++:e.stroke(),++p;break;default:++p;break}}V&&this.fill_(e),B&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Ha=["Polygon","Circle","LineString","Image","Text","Default"],mP=["Image","Text"],s3=Ha.filter(n=>!mP.includes(n));class o3{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Sr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new r3(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,u=Xs(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=tn(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let p;this.renderBuffer_!==void 0&&(p=nr(),od(p,e),g1(p,t*(this.renderBuffer_+r),p));const _=a3(r);let x;function S(O,U,P){const C=f.getImageData(0,0,l,l).data;for(let D=0,F=_.length;D<F;D++)if(C[_[D]]>0){if(!o||P==="none"||x!=="Image"&&x!=="Text"||o.includes(O)){const V=(_[D]-3)/4,B=r-V%l,k=r-(V/l|0),te=s(O,U,B*B+k*k);if(te)return te}f.clearRect(0,0,l,l);break}}const I=Object.keys(this.executorsByZIndex_).map(Number);I.sort(Gs);let T,b,N,M,L;for(T=I.length-1;T>=0;--T){const O=I[T].toString();for(N=this.executorsByZIndex_[O],b=Ha.length-1;b>=0;--b)if(x=Ha[b],M=N[x],M!==void 0&&(L=M.executeHitDetection(f,u,i,S,p),L))return L}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return Yo(l,0,8,2,e,l),l}isEmpty(){return lu(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(l?zF:Gs),o=o||Ha;const h=Ha.length;for(let f=0,p=u.length;f<p;++f){const _=u[f].toString(),x=this.executorsByZIndex_[_];for(let S=0,I=o.length;S<I;++S){const T=o[S],b=x[T];if(b!==void 0){const N=l===null?void 0:b.getZIndexContext(),M=N?N.getContext():e,L=this.maxExtent_&&T!=="Image"&&T!=="Text";if(L&&(M.save(),this.clip(M,i)),!N||T==="Text"||T==="Image"?b.execute(M,t,i,r,s,l):N.pushFunction(O=>b.execute(O,t,i,r,s,l)),L&&M.restore(),N){N.offset();const O=u[f]*h+Ha.indexOf(T);this.deferredZIndexContexts_[O]||(this.deferredZIndexContexts_[O]=[]),this.deferredZIndexContexts_[O].push(N)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Gs);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const A_={};function a3(n){if(A_[n]!==void 0)return A_[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let u=i[l];u||(u=[],i[l]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return A_[n]=r,r}function lC(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let O1=class yP extends Km{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;ct(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||st(o)),ct(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),ct(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=ze.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?ze.LOADED:ze.IDLE:u=ze.LOADING:u=ze.LOADED),this.color_=e.color!==void 0?fu(e.color):null,this.iconImage_=$p(o,l,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const p=this.getImage(1);if(p.width&&p.height)h=p.width,f=p.height;else if(p instanceof HTMLImageElement){this.initialOptions_=e;const _=()=>{if(this.unlistenImageChange(_),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale(lC(x[0],x[1],e.width,e.height))};this.listenImageChange(_);return}}h!==void 0&&this.setScale(lC(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new yP({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=$p(null,e,this.crossOrigin_,ze.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==ze.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==ze.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Ge.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Ge.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Jr=.5;function l3(n,e,t,i,r,s,o,l,u){const h=r,f=n[0]*Jr,p=n[1]*Jr,_=tn(f,p);_.imageSmoothingEnabled=!1;const x=_.canvas,S=new x4(_,Jr,r,null,o,l,null),I=t.length,T=Math.floor((256*256*256-1)/I),b={};for(let M=1;M<=I;++M){const L=t[M-1],O=L.getStyleFunction()||i;if(!O)continue;let U=O(L,s);if(!U)continue;Array.isArray(U)||(U=[U]);const C=(M*T).toString(16).padStart(7,"#00000");for(let D=0,F=U.length;D<F;++D){const V=U[D],B=V.getGeometryFunction()(L);if(!B||!li(h,B.getExtent()))continue;const k=V.clone(),te=k.getFill();te&&te.setColor(C);const de=k.getStroke();de&&(de.setColor(C),de.setLineDash(null)),k.setText(void 0);const ge=V.getImage();if(ge){const ne=ge.getImageSize();if(!ne)continue;const W=tn(ne[0],ne[1],void 0,{alpha:!1}),$=W.canvas;W.fillStyle=C,W.fillRect(0,0,$.width,$.height),k.setImage(new O1({img:$,anchor:ge.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ge.getOrigin(),opacity:1,size:ge.getSize(),scale:ge.getScale(),rotation:ge.getRotation(),rotateWithView:ge.getRotateWithView()}))}const ue=k.getZIndex()||0;let G=b[ue];G||(G={},b[ue]=G,G.Polygon=[],G.Circle=[],G.LineString=[],G.Point=[]);const ie=B.getType();if(ie==="GeometryCollection"){const ne=B.getGeometriesArrayRecursive();for(let W=0,$=ne.length;W<$;++W){const oe=ne[W];G[oe.getType().replace("Multi","")].push(oe,k)}}else G[ie.replace("Multi","")].push(B,k)}}const N=Object.keys(b).map(Number).sort(Gs);for(let M=0,L=N.length;M<L;++M){const O=b[N[M]];for(const U in O){const P=O[U];for(let C=0,D=P.length;C<D;C+=2){S.setStyle(P[C+1]);for(let F=0,V=e.length;F<V;++F)S.setTransform(e[F]),S.drawGeometry(P[C])}}}return _.getImageData(0,0,x.width,x.height)}function c3(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Jr),s=Math.floor(Math.round(n[1])*Jr),o=(Dt(r,0,t.width-1)+Dt(s,0,t.height-1)*t.width)*4,l=t.data[o],u=t.data[o+1],f=t.data[o+2]+256*(u+256*l),p=Math.floor((256*256*256-1)/e.length);f&&f%p===0&&i.push(e[f/p-1])}return i}class _P extends eo{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const u3=5;class h3 extends lf{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=u3}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return it()}getData(e){return null}prepareFrame(e){return it()}renderFrame(e,t){return it()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===ze.LOADED||t.getState()===ze.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=ze.LOADED&&t!=ze.ERROR&&e.addEventListener(Ge.CHANGE,this.boundHandleImageChange_),t==ze.IDLE&&(e.load(),t=e.getState()),t==ze.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const cC=[];let Lc=null;function d3(){Lc=tn(1,1,void 0,{willReadFrequently:!0})}class vP extends h3{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Sr(),this.pixelTransform=Sr(),this.inversePixelTransform=Sr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Lc||d3(),Lc.clearRect(0,0,1,1);let r;try{Lc.drawImage(e,t,i,1,1,0,0,1,1),r=Lc.getImageData(0,0,1,1).data}catch{return Lc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&la(fu(e.style.backgroundColor),fu(i)))){const l=e.firstElementChild;Ho(l)&&(o=l.getContext("2d"))}if(o&&LV(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Ri?ZA():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=tn();const u=o.canvas;s.appendChild(u),l=u.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Pl(i),s=Um(i),o=zm(i),l=Vm(i);dn(t.coordinateToPixelTransform,r),dn(t.coordinateToPixelTransform,s),dn(t.coordinateToPixelTransform,o),dn(t.coordinateToPixelTransform,l);const u=this.inversePixelTransform;dn(u,r),dn(u,s),dn(u,o),dn(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(ft(i)/r*o),u=Math.round(qn(i)/r*o);Xs(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-u/2),FA(this.inversePixelTransform,this.pixelTransform);const h=MV(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=u?(f.width=l,f.height=u):this.context.clearRect(0,0,l,u),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new _P(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Qi.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Qi.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new pP),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Qi.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Qi.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const u=s/2,h=o/2,f=r/t,p=-f,_=-e[0]+l,x=-e[1];return Xs(this.tempTransform,u,h,f,p,-i,_,x)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class f3 extends vP{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=nr(),this.wrappedRenderedExtent_=nr(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,u=s.projection,h=s.rotation,f=u.getExtent(),p=this.getLayer().getSource(),_=this.getLayer().getDeclutter(),x=t.pixelRatio,S=t.viewHints,I=!(S[jn.ANIMATING]||S[jn.INTERACTING]),T=this.context,b=Math.round(ft(r)/l*x),N=Math.round(qn(r)/l*x),M=p.getWrapX()&&u.canWrapX(),L=M?ft(f):null,O=M?Math.ceil((r[2]-f[2])/L)+1:1;let U=M?Math.floor((r[0]-f[0])/L):0;do{let P=this.getRenderTransform(o,l,0,x,b,N,U*L);t.declutter&&(P=P.slice(0)),e.execute(T,[T.canvas.width,T.canvas.height],P,h,I,i===void 0?Ha:i?mP:s3,i?_&&t.declutter[_]:void 0)}while(++U<O)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=tn(this.context.canvas.width,this.context.canvas.height,cC))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Hm(this.context),cC.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(Qi.PRERENDER)||this.getLayer().hasListener(Qi.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const u=$o(i.extent);l=li(u,e.extent),this.clipped_=l&&!Hh(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],p=i[0]*Jr,_=i[1]*Jr;f.push(this.getRenderTransform(r,s,o,Jr,p,_,0).slice());const x=h.getSource(),S=l.getExtent();if(x.getWrapX()&&l.canWrapX()&&!Hh(S,u)){let I=u[0];const T=ft(S);let b=0,N;for(;I<S[0];)--b,N=T*b,f.push(this.getRenderTransform(r,s,o,Jr,p,_,N).slice()),I+=T;for(b=0,I=u[2];I>S[2];)++b,N=T*b,f.push(this.getRenderTransform(r,s,o,Jr,p,_,N).slice()),I-=T}this.hitDetectionImageData_=l3(i,f,this.renderedFeatures_,h.getStyleFunction(),u,s,o,qI(s,this.renderedPixelRatio_))}t(c3(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},f=function(_,x,S){const I=st(_),T=h[I];if(T){if(T!==!0&&S<T.distanceSq){if(S===0)return h[I]=!0,s.splice(s.lastIndexOf(T),1),r(_,u,x);T.geometry=x,T.distanceSq=S}}else{if(S===0)return h[I]=!0,r(_,u,x);s.push(h[I]={feature:_,layer:u,geometry:x,distanceSq:S,callback:r})}},p=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,p?t.declutter?.[p]?.all().map(_=>_.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[jn.ANIMATING],s=e.viewHints[jn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,f=h.projection,p=h.resolution,_=e.pixelRatio,x=t.getRevision(),S=t.getRenderBuffer();let I=t.getRenderOrder();I===void 0&&(I=E4);const T=h.center.slice(),b=g1(u,S*p),N=b.slice(),M=[b.slice()],L=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Hh(L,e.extent)){const te=ft(L),de=Math.max(ft(b)/2,te);b[0]=L[0]-de,b[2]=L[2]+de,AA(T,f);const ge=RA(M[0],f);ge[0]<L[0]&&ge[2]<L[2]?M.push([ge[0]+te,ge[1],ge[2]+te,ge[3]]):ge[0]>L[0]&&ge[2]>L[2]&&M.push([ge[0]-te,ge[1],ge[2]-te,ge[3]])}if(this.ready&&this.renderedResolution_==p&&this.renderedRevision_==x&&this.renderedRenderOrder_==I&&this.renderedFrameDeclutter_===!!e.declutter&&Hh(this.wrappedRenderedExtent_,b))return la(this.renderedExtent_,N)||(this.hitDetectionImageData_=null,this.renderedExtent_=N),this.renderedCenter_=T,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const O=new e3(oP(p,_),b,p,_);let U;for(let te=0,de=M.length;te<de;++te)i.loadFeatures(M[te],p,f);const P=qI(p,_);let C=!0;const D=(te,de)=>{let ge;const ue=te.getStyleFunction()||t.getStyleFunction();if(ue&&(ge=ue(te,p)),ge){const G=this.renderFeature(te,P,ge,O,U,this.getLayer().getDeclutter(),de);C=C&&!G}},F=jA(b),V=i.getFeaturesInExtent(F);I&&V.sort(I);for(let te=0,de=V.length;te<de;++te)D(V[te],te);this.renderedFeatures_=V,this.ready=C;const B=O.finish(),k=new o3(b,p,_,i.getOverlaps(),B,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=p,this.renderedRevision_=x,this.renderedRenderOrder_=I,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=N,this.wrappedRenderedExtent_=b,this.renderedCenter_=T,this.renderedProjection_=f,this.renderedPixelRatio_=_,this.replayGroup_=k,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)u=XI(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||u;else u=XI(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return u}}let Nl=0;const Kn=1<<Nl++,Ze=1<<Nl++,oi=1<<Nl++,yr=1<<Nl++,_l=1<<Nl++,Xh=1<<Nl++,Yg=Math.pow(2,Nl)-1,j1={[Kn]:"boolean",[Ze]:"number",[oi]:"string",[yr]:"color",[_l]:"number[]",[Xh]:"size"},g3=Object.keys(j1).map(Number).sort(Gs);function p3(n){return n in j1}function Yh(n){const e=[];for(const t of g3)Zh(n,t)&&e.push(j1[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Zh(n,e){return(n&e)===e}function Po(n,e){return n===e}class en{constructor(e,t){if(!p3(e))throw new Error(`literal expressions must have a specific type, got ${Yh(e)}`);this.type=e,this.value=t}}class m3{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function xP(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Rn(n,e,t){switch(typeof n){case"boolean":{if(Po(e,oi))return new en(oi,n?"true":"false");if(!Zh(e,Kn))throw new Error(`got a boolean, but expected ${Yh(e)}`);return new en(Kn,n)}case"number":{if(Po(e,Xh))return new en(Xh,ui(n));if(Po(e,Kn))return new en(Kn,!!n);if(Po(e,oi))return new en(oi,n.toString());if(!Zh(e,Ze))throw new Error(`got a number, but expected ${Yh(e)}`);return new en(Ze,n)}case"string":{if(Po(e,yr))return new en(yr,P1(n));if(Po(e,Kn))return new en(Kn,!!n);if(!Zh(e,oi))throw new Error(`got a string, but expected ${Yh(e)}`);return new en(oi,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return R3(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Po(e,Xh)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new en(Xh,n)}if(Po(e,yr)){if(n.length===3)return new en(yr,[...n,1]);if(n.length===4)return new en(yr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Zh(e,_l))throw new Error(`got an array of numbers, but expected ${Yh(e)}`);return new en(_l,n)}const se={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},y3={[se.Get]:Fe($e(1,1/0),uC),[se.Var]:Fe($e(1,1),_3),[se.Has]:Fe($e(1,1/0),uC),[se.Id]:Fe(v3,wc),[se.Concat]:Fe($e(2,1/0),lt(oi)),[se.GeometryType]:Fe(x3,wc),[se.LineMetric]:Fe(wc),[se.Resolution]:Fe(P_,wc),[se.Zoom]:Fe(P_,wc),[se.Time]:Fe(P_,wc),[se.Any]:Fe($e(2,1/0),lt(Kn)),[se.All]:Fe($e(2,1/0),lt(Kn)),[se.Not]:Fe($e(1,1),lt(Kn)),[se.Equal]:Fe($e(2,2),lt(Yg)),[se.NotEqual]:Fe($e(2,2),lt(Yg)),[se.GreaterThan]:Fe($e(2,2),lt(Ze)),[se.GreaterThanOrEqualTo]:Fe($e(2,2),lt(Ze)),[se.LessThan]:Fe($e(2,2),lt(Ze)),[se.LessThanOrEqualTo]:Fe($e(2,2),lt(Ze)),[se.Multiply]:Fe($e(2,1/0),hC),[se.Coalesce]:Fe($e(2,1/0),hC),[se.Divide]:Fe($e(2,2),lt(Ze)),[se.Add]:Fe($e(2,1/0),lt(Ze)),[se.Subtract]:Fe($e(2,2),lt(Ze)),[se.Clamp]:Fe($e(3,3),lt(Ze)),[se.Mod]:Fe($e(2,2),lt(Ze)),[se.Pow]:Fe($e(2,2),lt(Ze)),[se.Abs]:Fe($e(1,1),lt(Ze)),[se.Floor]:Fe($e(1,1),lt(Ze)),[se.Ceil]:Fe($e(1,1),lt(Ze)),[se.Round]:Fe($e(1,1),lt(Ze)),[se.Sin]:Fe($e(1,1),lt(Ze)),[se.Cos]:Fe($e(1,1),lt(Ze)),[se.Atan]:Fe($e(1,2),lt(Ze)),[se.Sqrt]:Fe($e(1,1),lt(Ze)),[se.Match]:Fe($e(4,1/0),dC,E3),[se.Between]:Fe($e(3,3),lt(Ze)),[se.Interpolate]:Fe($e(6,1/0),dC,T3),[se.Case]:Fe($e(3,1/0),w3,S3),[se.In]:Fe($e(2,2),I3),[se.Number]:Fe($e(1,1/0),lt(Yg)),[se.String]:Fe($e(1,1/0),lt(Yg)),[se.Array]:Fe($e(1,1/0),lt(Ze)),[se.Color]:Fe($e(1,4),lt(Ze)),[se.Band]:Fe($e(1,3),lt(Ze)),[se.Palette]:Fe($e(2,2),C3),[se.ToString]:Fe($e(1,1),lt(Kn|Ze|oi|yr))};function uC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new en(Ze,o);break}case"string":{r[s]=new en(oi,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function _3(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new en(oi,i)]}function v3(n,e,t){t.featureId=!0}function x3(n,e,t){t.geometryType=!0}function P_(n,e,t){t.mapState=!0}function wc(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function $e(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function hC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Rn(n[s+1],e,t);r[s]=o}return r}function lt(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=Rn(e[o+1],n,i);s[o]=l}return s}}function w3(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function dC(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function E3(n,e,t){const i=n.length-1,r=oi|Ze|Kn,s=Rn(n[1],r,t),o=Rn(n[n.length-1],e,t),l=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=Rn(n[u+2],s.type,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=Rn(n[u+3],o.type,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...l,o]}function T3(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new en(Ze,r);let o;try{o=Rn(n[2],Ze,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const l=new Array(n.length-3);for(let u=0;u<l.length;u+=2){try{const h=Rn(n[u+3],Ze,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=Rn(n[u+4],e,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function S3(n,e,t){const i=Rn(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Rn(n[s+1],Kn,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Rn(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function I3(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=oi}else r=Ze;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const u=Rn(i[l],r,t);s[l]=u}catch(u){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${u.message}`)}return[Rn(n[1],r,t),...s]}function C3(n,e,t){let i;try{i=Rn(n[1],Ze,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=Rn(r[o],yr,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(l instanceof en))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Fe(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new m3(t,r,...s)}}function R3(n,e,t){const i=n[0],r=y3[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function wP(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return wP(n.getGeometries()[0]);default:return""}}function EP(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function to(n,e,t){const i=Rn(n,e,t);return br(i)}function br(n,e){if(n instanceof en){if(n.type===yr&&typeof n.value=="string"){const i=P1(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case se.Number:case se.String:case se.Coalesce:return b3(n);case se.Get:case se.Var:case se.Has:return A3(n);case se.Id:return i=>i.featureId;case se.GeometryType:return i=>i.geometryType;case se.Concat:{const i=n.args.map(r=>br(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case se.Resolution:return i=>i.resolution;case se.Any:case se.All:case se.Between:case se.In:case se.Not:return k3(n);case se.Equal:case se.NotEqual:case se.LessThan:case se.LessThanOrEqualTo:case se.GreaterThan:case se.GreaterThanOrEqualTo:return P3(n);case se.Multiply:case se.Divide:case se.Add:case se.Subtract:case se.Clamp:case se.Mod:case se.Pow:case se.Abs:case se.Floor:case se.Ceil:case se.Round:case se.Sin:case se.Cos:case se.Atan:case se.Sqrt:return N3(n);case se.Case:return D3(n);case se.Match:return M3(n);case se.Interpolate:return L3(n);case se.ToString:return O3(n);default:throw new Error(`Unsupported operator ${t}`)}}function b3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=br(n.args[s]);switch(t){case se.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case se.Number:case se.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function A3(n,e){const i=n.args[0].value;switch(n.operator){case se.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;o=o[f]}return o};case se.Var:return r=>r.variables[i];case se.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function P3(n,e){const t=n.operator,i=br(n.args[0]),r=br(n.args[1]);switch(t){case se.Equal:return s=>i(s)===r(s);case se.NotEqual:return s=>i(s)!==r(s);case se.LessThan:return s=>i(s)<r(s);case se.LessThanOrEqualTo:return s=>i(s)<=r(s);case se.GreaterThan:return s=>i(s)>r(s);case se.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function k3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=br(n.args[s]);switch(t){case se.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case se.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case se.Between:return s=>{const o=r[0](s),l=r[1](s),u=r[2](s);return o>=l&&o<=u};case se.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case se.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function N3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=br(n.args[s]);switch(t){case se.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case se.Divide:return s=>r[0](s)/r[1](s);case se.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case se.Subtract:return s=>r[0](s)-r[1](s);case se.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const u=r[2](s);return o>u?u:o};case se.Mod:return s=>r[0](s)%r[1](s);case se.Pow:return s=>Math.pow(r[0](s),r[1](s));case se.Abs:return s=>Math.abs(r[0](s));case se.Floor:return s=>Math.floor(r[0](s));case se.Ceil:return s=>Math.ceil(r[0](s));case se.Round:return s=>Math.round(r[0](s));case se.Sin:return s=>Math.sin(r[0](s));case se.Cos:return s=>Math.cos(r[0](s));case se.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case se.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function D3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=br(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function M3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=br(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function L3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=br(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,u;for(let h=2;h<t;h+=2){const f=i[h](r);let p=i[h+1](r);const _=Array.isArray(p);if(_&&(p=o4(p)),f>=o)return h===2?p:_?j3(s,o,l,u,f,p):Qh(s,o,l,u,f,p);l=f,u=p}return u}}function O3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=br(n.args[s]);if(t===se.ToString)return s=>{const o=r[0](s);return n.args[0].type===yr?k1(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function Qh(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,u=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function j3(n,e,t,i,r,s){if(r-t===0)return i;const l=WI(i),u=WI(s);let h=u[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[Qh(n,e,t,l[0],r,u[0]),Qh(n,e,t,l[1],r,u[1]),l[2]+Qh(n,e,t,0,r,h),Qh(n,e,t,i[3],r,s[3])];return a4(f)}function F3(n){return!0}function V3(n){const e=xP(),t=z3(n,e),i=EP();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=wP(r.getGeometry())),t(i)}}function fC(n){const e=xP(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Vv(n[o],e);const r=EP(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[u]=f,u+=1)}return s.length=u,s}}function z3(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?to(s.filter,Kn,e):F3;let l;if(Array.isArray(s.style)){const u=s.style.length;l=new Array(u);for(let h=0;h<u;++h)l[h]=Vv(s.style[h],e)}else l=[Vv(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const u=i[l].filter;if(u(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function Vv(n,e){const t=Ld(n,"",e),i=Od(n,"",e),r=U3(n,e),s=B3(n,e),o=ci(n,"z-index",e);if(!t&&!i&&!r&&!s&&!lu(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new tr;return function(u){let h=!0;if(t){const f=t(u);f&&(h=!1),l.setFill(f)}if(i){const f=i(u);f&&(h=!1),l.setStroke(f)}if(r){const f=r(u);f&&(h=!1),l.setText(f)}if(s){const f=s(u);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(u)),h?null:l}}function Ld(n,e,t){let i;if(e+"fill-pattern-src"in n)i=H3(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=F1(n,e+"fill-color",t)}if(!i)return null;const r=new Rr;return function(s){const o=i(s);return o===A1?null:(r.setColor(o),r)}}function Od(n,e,t){const i=ci(n,e+"stroke-width",t),r=F1(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Os(n,e+"stroke-line-cap",t),o=Os(n,e+"stroke-line-join",t),l=TP(n,e+"stroke-line-dash",t),u=ci(n,e+"stroke-line-dash-offset",t),h=ci(n,e+"stroke-miter-limit",t),f=new Lu;return function(p){if(r){const _=r(p);if(_===A1)return null;f.setColor(_)}if(i&&f.setWidth(i(p)),s){const _=s(p);if(_!=="butt"&&_!=="round"&&_!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(_)}if(o){const _=o(p);if(_!=="bevel"&&_!=="round"&&_!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(_)}return l&&f.setLineDash(l(p)),u&&f.setLineDashOffset(u(p)),h&&f.setMiterLimit(h(p)),f}}function U3(n,e){const t="text-",i=Os(n,t+"value",e);if(!i)return null;const r=Ld(n,t,e),s=Ld(n,t+"background-",e),o=Od(n,t,e),l=Od(n,t+"background-",e),u=Os(n,t+"font",e),h=ci(n,t+"max-angle",e),f=ci(n,t+"offset-x",e),p=ci(n,t+"offset-y",e),_=Qc(n,t+"overflow",e),x=Os(n,t+"placement",e),S=ci(n,t+"repeat",e),I=Xm(n,t+"scale",e),T=Qc(n,t+"rotate-with-view",e),b=ci(n,t+"rotation",e),N=Os(n,t+"align",e),M=Os(n,t+"justify",e),L=Os(n,t+"baseline",e),O=Qc(n,t+"keep-upright",e),U=TP(n,t+"padding",e),P=Ym(n,t+"declutter-mode"),C=new df({declutterMode:P});return function(D){if(C.setText(i(D)),r&&C.setFill(r(D)),s&&C.setBackgroundFill(s(D)),o&&C.setStroke(o(D)),l&&C.setBackgroundStroke(l(D)),u&&C.setFont(u(D)),h&&C.setMaxAngle(h(D)),f&&C.setOffsetX(f(D)),p&&C.setOffsetY(p(D)),_&&C.setOverflow(_(D)),x){const F=x(D);if(F!=="point"&&F!=="line")throw new Error("Expected point or line for text-placement");C.setPlacement(F)}if(S&&C.setRepeat(S(D)),I&&C.setScale(I(D)),T&&C.setRotateWithView(T(D)),b&&C.setRotation(b(D)),N){const F=N(D);if(F!=="left"&&F!=="center"&&F!=="right"&&F!=="end"&&F!=="start")throw new Error("Expected left, right, center, start, or end for text-align");C.setTextAlign(F)}if(M){const F=M(D);if(F!=="left"&&F!=="right"&&F!=="center")throw new Error("Expected left, right, or center for text-justify");C.setJustify(F)}if(L){const F=L(D);if(F!=="bottom"&&F!=="top"&&F!=="middle"&&F!=="alphabetic"&&F!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");C.setTextBaseline(F)}return U&&C.setPadding(U(D)),O&&C.setKeepUpright(O(D)),C}}function B3(n,e){return"icon-src"in n?W3(n,e):"shape-points"in n?G3(n,e):"circle-radius"in n?$3(n,e):null}function W3(n,e){const t="icon-",i=t+"src",r=SP(n[i],i),s=qp(n,t+"anchor",e),o=Xm(n,t+"scale",e),l=ci(n,t+"opacity",e),u=qp(n,t+"displacement",e),h=ci(n,t+"rotation",e),f=Qc(n,t+"rotate-with-view",e),p=pC(n,t+"anchor-origin"),_=mC(n,t+"anchor-x-units"),x=mC(n,t+"anchor-y-units"),S=Y3(n,t+"color"),I=q3(n,t+"cross-origin"),T=X3(n,t+"offset"),b=pC(n,t+"offset-origin"),N=Xp(n,t+"width"),M=Xp(n,t+"height"),L=K3(n,t+"size"),O=Ym(n,t+"declutter-mode"),U=new O1({src:r,anchorOrigin:p,anchorXUnits:_,anchorYUnits:x,color:S,crossOrigin:I,offset:T,offsetOrigin:b,height:M,width:N,size:L,declutterMode:O});return function(P){return l&&U.setOpacity(l(P)),u&&U.setDisplacement(u(P)),h&&U.setRotation(h(P)),f&&U.setRotateWithView(f(P)),o&&U.setScale(o(P)),s&&U.setAnchor(s(P)),U}}function G3(n,e){const t="shape-",i=t+"points",r=t+"radius",s=zv(n[i],i),o=zv(n[r],r),l=Ld(n,t,e),u=Od(n,t,e),h=Xm(n,t+"scale",e),f=qp(n,t+"displacement",e),p=ci(n,t+"rotation",e),_=Qc(n,t+"rotate-with-view",e),x=Xp(n,t+"radius2"),S=Xp(n,t+"angle"),I=Ym(n,t+"declutter-mode"),T=new qm({points:s,radius:o,radius2:x,angle:S,declutterMode:I});return function(b){return l&&T.setFill(l(b)),u&&T.setStroke(u(b)),f&&T.setDisplacement(f(b)),p&&T.setRotation(p(b)),_&&T.setRotateWithView(_(b)),h&&T.setScale(h(b)),T}}function $3(n,e){const t="circle-",i=Ld(n,t,e),r=Od(n,t,e),s=ci(n,t+"radius",e),o=Xm(n,t+"scale",e),l=qp(n,t+"displacement",e),u=ci(n,t+"rotation",e),h=Qc(n,t+"rotate-with-view",e),f=Ym(n,t+"declutter-mode"),p=new kl({radius:5,declutterMode:f});return function(_){return s&&p.setRadius(s(_)),i&&p.setFill(i(_)),r&&p.setStroke(r(_)),l&&p.setDisplacement(l(_)),u&&p.setRotation(u(_)),h&&p.setRotateWithView(h(_)),o&&p.setScale(o(_)),p}}function ci(n,e,t){if(!(e in n))return;const i=to(n[e],Ze,t);return function(r){return zv(i(r),e)}}function Os(n,e,t){if(!(e in n))return null;const i=to(n[e],oi,t);return function(r){return SP(i(r),e)}}function H3(n,e,t){const i=Os(n,e+"pattern-src",t),r=gC(n,e+"pattern-offset",t),s=gC(n,e+"pattern-size",t),o=F1(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function Qc(n,e,t){if(!(e in n))return null;const i=to(n[e],Kn,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function F1(n,e,t){if(!(e in n))return null;const i=to(n[e],yr,t);return function(r){return IP(i(r),e)}}function TP(n,e,t){if(!(e in n))return null;const i=to(n[e],_l,t);return function(r){return gf(i(r),e)}}function qp(n,e,t){if(!(e in n))return null;const i=to(n[e],_l,t);return function(r){const s=gf(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function gC(n,e,t){if(!(e in n))return null;const i=to(n[e],_l,t);return function(r){return CP(i(r),e)}}function Xm(n,e,t){if(!(e in n))return null;const i=to(n[e],_l|Ze,t);return function(r){return Z3(i(r),e)}}function Xp(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function K3(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return ui(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function q3(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function pC(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function mC(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function X3(n,e){const t=n[e];if(t!==void 0)return gf(t,e)}function Ym(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function Y3(n,e){const t=n[e];if(t!==void 0)return IP(t,e)}function gf(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function SP(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function zv(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function IP(n,e){if(typeof n=="string")return n;const t=gf(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function CP(n,e){const t=gf(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function Z3(n,e){return typeof n=="number"?n:CP(n,e)}const fr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function yC(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,p=l?l[1]:0;let _=n[0]+u/2+f,x=n[2]-u/2+f,S=n[1]+h/2+p,I=n[3]-h/2+p;_>x&&(_=(x+_)/2,x=_),S>I&&(S=(I+S)/2,I=S);let T=Dt(i[0],_,x),b=Dt(i[1],S,I);if(o&&t&&r){const N=30*r;T+=-N*Math.log(1+Math.max(0,_-i[0])/N)+N*Math.log(1+Math.max(0,i[0]-x)/N),b+=-N*Math.log(1+Math.max(0,S-i[1])/N)+N*Math.log(1+Math.max(0,i[1]-I)/N)}return[T,b]})}function Q3(n){return n}function RP(n){return Math.pow(n,3)}function Ou(n){return 1-RP(1-n)}function J3(n){return 3*n*n-2*n*n*n}function e6(n){return n}function V1(n,e,t,i){const r=ft(e)/t[0],s=qn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function z1(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Dt(i,t/2,e*2)}function t6(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const u=n[0],h=n[n.length-1],f=t?V1(u,t,o,i):u;if(l)return e?z1(r,f,h):Dt(r,h,f);const p=Math.min(f,r),_=Math.floor(d1(n,p,s));return n[_]>f&&_<n.length-1?n[_+1]:n[_]}})}function n6(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,u,h){if(o!==void 0){const f=r?V1(e,r,u,s):e;if(h)return i?z1(o,f,t):Dt(o,t,f);const p=1e-9,_=Math.ceil(Math.log(e/f)/Math.log(n)-p),x=-l*(.5-p)+.5,S=Math.min(f,o),I=Math.floor(Math.log(e/S)/Math.log(n)+x),T=Math.max(_,I),b=e/Math.pow(n,T);return Dt(b,t,f)}})}function _C(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,u){if(s!==void 0){const h=i?V1(n,i,l,r):n;return!t||!u?Dt(s,e,h):z1(s,h,e)}})}function U1(n){if(n!==void 0)return 0}function vC(n){if(n!==void 0)return n}function i6(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function r6(n){const e=Xo(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const s6=42,B1=256,k_=0;class es extends ds{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=w1(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&OA(),e.center&&(e.center=Ls(e.center,this.projection_)),e.extent&&(e.extent=$o(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in fr)delete t[l];this.setProperties(t,!0);const i=a6(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=o6(e),s=i.constraint,o=l6(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ls(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ls(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&Zg(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],p={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||J3,callback:i};if(f.center&&(p.sourceCenter=o,p.targetCenter=f.center.slice(),o=p.targetCenter),f.zoom!==void 0?(p.sourceResolution=l,p.targetResolution=this.getResolutionForZoom(f.zoom),l=p.targetResolution):f.resolution&&(p.sourceResolution=l,p.targetResolution=f.resolution,l=p.targetResolution),f.rotation!==void 0){p.sourceRotation=u;const _=al(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=u+_,u=p.targetRotation}c6(p)?p.complete=!0:s+=p.duration,h.push(p)}this.animations_.push(h),this.setHint(jn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[jn.ANIMATING]>0}getInteracting(){return this.hints_[jn.INTERACTING]>0}cancelAnimations(){this.setHint(jn.ANIMATING,-this.hints_[jn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&Zg(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let f=u.duration>0?h/u.duration:1;f>=1?(u.complete=!0,f=1):s=!1;const p=u.easing(f);if(u.sourceCenter){const _=u.sourceCenter[0],x=u.sourceCenter[1],S=u.targetCenter[0],I=u.targetCenter[1];this.nextCenter_=u.targetCenter;const T=_+p*(S-_),b=x+p*(I-x);this.targetCenter_=[T,b]}if(u.sourceResolution&&u.targetResolution){const _=p===1?u.targetResolution:u.sourceResolution+p*(u.targetResolution-u.sourceResolution);if(u.anchor){const x=this.getViewportSize_(this.getRotation()),S=this.constraints_.resolution(_,0,x,!0);this.targetCenter_=this.calculateCenterZoom(S,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=_,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const _=p===1?al(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+p*(u.targetRotation-u.sourceRotation);if(u.anchor){const x=this.constraints_.rotation(_,!0);this.targetCenter_=this.calculateCenterRotate(x,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=_}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(jn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Zg(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],m1(i,e-this.getRotation()),JF(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Dv(e,this.getProjection())}getCenterInternal(){return this.get(fr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return jA(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();ct(t,"The view center is not defined");const i=this.getResolution();ct(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return ct(r!==void 0,"The view rotation is not defined"),Rv(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(fr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal($o(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=ft(e)/t[0],r=qn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(fr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=N_(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=d1(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Dt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Dt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(ct(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){ct(!Bm(e),"Cannot fit empty extent provided as `geometry`");const r=$o(e,this.getProjection());i=ZI(r)}else if(e.getType()==="Circle"){const r=$o(e.getExtent(),this.getProjection());i=ZI(r),i.rotate(this.getRotation(),gl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,u=1/0,h=-1/0,f=-1/0;for(let p=0,_=s.length;p<_;p+=o){const x=s[p]*i-s[p+1]*r,S=s[p]*r+s[p+1]*i;l=Math.min(l,x),u=Math.min(u,S),h=Math.max(h,x),f=Math.max(f,S)}return[l,u,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),f=Math.sin(h),p=Math.cos(h),_=gl(l);_[0]+=(r[1]-r[3])/2*u,_[1]+=(r[0]-r[2])/2*u;const x=_[0]*p-_[1]*f,S=_[1]*p+_[0]*f,I=this.getConstrainedCenter([x,S],u),T=t.callback?t.callback:Cd;t.duration!==void 0?this.animateInternal({resolution:u,center:I,duration:t.duration,easing:t.easing},T):(this.targetResolution_=u,this.targetCenter_=I,this.applyTargetState_(!1,!0),Zg(T,!0))}centerOn(e,t,i){this.centerOnInternal(Ls(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(N_(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),u=N_(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Dv(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ls(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ls(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ls(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(fr.ROTATION)!==r&&this.set(fr.ROTATION,r),this.get(fr.RESOLUTION)!==o&&(this.set(fr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(fr.CENTER)||!Fp(this.get(fr.CENTER),l))&&this.set(fr.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Fp(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:e,easing:Ou,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(jn.INTERACTING,1)}endInteraction(e,t,i){i=i&&Ls(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(jn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Zg(n,e){setTimeout(function(){n(e)},0)}function o6(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return yC(n.extent,n.constrainOnlyCenter,t)}const e=w1(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,yC(t,!1,!1)}return Q3}function a6(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:k_,l=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,p=n.showFullExtent!==void 0?n.showFullExtent:!1,_=w1(n.projection,"EPSG:3857"),x=_.getExtent();let S=n.constrainOnlyCenter,I=n.extent;if(!h&&!I&&_.isGlobal()&&(S=!1,I=x),n.resolutions!==void 0){const T=n.resolutions;t=T[o],i=T[l]!==void 0?T[l]:T[T.length-1],n.constrainResolution?e=t6(T,f,!S&&I,p):e=_C(t,i,f,!S&&I,p)}else{const b=(x?Math.max(ft(x),qn(x)):360*hu.degrees/_.getMetersPerUnit())/B1/Math.pow(2,k_),N=b/Math.pow(2,28-k_);t=n.maxResolution,t!==void 0?o=0:t=b/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,l):i=b/Math.pow(u,l):i=N),l=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,l-o),n.constrainResolution?e=n6(u,t,i,f,!S&&I,p):e=_C(t,i,f,!S&&I,p)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function l6(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?r6():t===!1?vC:typeof t=="number"?i6(t):vC}return U1}function c6(n){return!(n.sourceCenter&&n.targetCenter&&!Fp(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function N_(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-u*o,f=u*s+l*o;return[h,f]}const dt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class bP extends ds{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[dt.OPACITY]=e.opacity!==void 0?e.opacity:1,ct(typeof t[dt.OPACITY]=="number","Layer opacity must be a number"),t[dt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[dt.Z_INDEX]=e.zIndex,t[dt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[dt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[dt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[dt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Dt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return it()}getLayerStatesArray(e){return it()}getExtent(){return this.get(dt.EXTENT)}getMaxResolution(){return this.get(dt.MAX_RESOLUTION)}getMinResolution(){return this.get(dt.MIN_RESOLUTION)}getMinZoom(){return this.get(dt.MIN_ZOOM)}getMaxZoom(){return this.get(dt.MAX_ZOOM)}getOpacity(){return this.get(dt.OPACITY)}getSourceState(){return it()}getVisible(){return this.get(dt.VISIBLE)}getZIndex(){return this.get(dt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(dt.EXTENT,e)}setMaxResolution(e){this.set(dt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(dt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(dt.MAX_ZOOM,e)}setMinZoom(e){this.set(dt.MIN_ZOOM,e)}setOpacity(e){ct(typeof e=="number","Layer opacity must be a number"),this.set(dt.OPACITY,e)}setVisible(e){this.set(dt.VISIBLE,e)}setZIndex(e){this.set(dt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Zm extends bP{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(dt.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(dt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(bt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=rt(e,Ge.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof es?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return W1(r,t.viewState)&&(!s||li(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof es?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(dt.MAP,e)}getMapInternal(){return this.get(dt.MAP)}setMap(e){this.mapPrecomposeKey_&&(bt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(bt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=rt(e,Qi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=rt(this,Ge.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);ct(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(dt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function W1(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const xC={RENDER_ORDER:"renderOrder"};class AP extends Zm{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(xC.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new dP(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(xC.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?gP:e;const t=u6(e);this.styleFunction_=e===null?void 0:H4(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function u6(n){if(n===void 0)return gP;if(!n)return null;if(typeof n=="function"||n instanceof tr)return n;if(!Array.isArray(n))return fC([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof tr){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof tr))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return V3(r)}return fC(n)}class G1 extends AP{constructor(e){super(e)}createRenderer(){return new f3(this)}}const ko={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class zo extends eo{constructor(e,t){super(e),this.layer=t}}const D_={LAYERS:"layers"};class ju extends bP{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(D_.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Zi(i.slice(),{unique:!0}):ct(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Zi(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(bt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(rt(e,ri.ADD,this.handleLayersAdd_,this),rt(e,ri.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(bt);of(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new zo(ko.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[rt(e,au.PROPERTYCHANGE,this.handleLayerChange_,this),rt(e,Ge.CHANGE,this.handleLayerChange_,this)];e instanceof ju&&t.push(rt(e,ko.ADDLAYER,this.handleLayerGroupAdd_,this),rt(e,ko.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[st(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new zo(ko.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new zo(ko.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new zo(ko.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=st(t);this.listenerKeys_[i].forEach(bt),delete this.listenerKeys_[i],this.dispatchEvent(new zo(ko.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(D_.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new zo(ko.REMOVELAYER,i[r]))}this.set(D_.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=ol(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}}const ke={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class $1 extends af{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(Ge.CHANGE)}release(){this.setState(ke.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==ke.EMPTY){if(this.state!==ke.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){it()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:RP(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Uv(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const h6=new Error("disposed"),d6=[256,256];class wC extends $1{constructor(e){const t=ke.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Uv(this.data_);return e?[e.width,e.height]:d6}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==ke.IDLE&&this.state!==ke.ERROR)return;this.state=ke.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=ke.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=ke.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(h6),this.controller_=null),super.disposeInternal()}}class PP extends $1{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Ri?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=ke.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=ke.ERROR,this.unlistenImage_(),this.image_=f6(),this.changed()}handleImageLoad_(){if(Ri)this.state=ke.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=ke.LOADED:this.state=ke.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==ke.ERROR&&(this.state=ke.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ke.IDLE&&(this.state=ke.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=l4(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function f6(){const n=tn(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let M_;const Jc=[];function EC(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function L_(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function g6(){if(M_===void 0){const n=tn(6,6,Jc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",EC(n,4,5,4,0),EC(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;M_=L_(e,0)||L_(e,4)||L_(e,8),Hm(n),Jc.push(n.canvas)}return M_}function TC(n,e,t,i){const r=$m(t,e,n);let s=Up(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const u=n.getExtent();if(!u||uu(u,r)){const h=Up(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function p6(n,e,t,i){const r=gl(t);let s=TC(n,e,r,i);return(!isFinite(s)||s<=0)&&IA(t,function(o){return s=TC(n,e,o,i),isFinite(s)&&s>0}),s}function m6(n,e,t,i,r,s,o,l,u,h,f,p,_,x){const S=tn(Math.round(t*n),Math.round(t*e),Jc);if(p||(S.imageSmoothingEnabled=!1),u.length===0)return S.canvas;S.scale(t,t);function I(O){return Math.round(O*t)/t}S.globalCompositeOperation="lighter";const T=nr();u.forEach(function(O,U,P){HF(T,O.extent)});let b;const N=t/i,M=(p?1:1+Math.pow(2,-24))/N;(!_||u.length!==1||h!==0)&&(b=tn(Math.round(ft(T)*N),Math.round(qn(T)*N),Jc),p||(b.imageSmoothingEnabled=!1),u.forEach(function(O,U,P){if(O.image.width>0&&O.image.height>0){if(O.clipExtent){b.save();const B=(O.clipExtent[0]-T[0])*N,k=-(O.clipExtent[3]-T[3])*N,te=ft(O.clipExtent)*N,de=qn(O.clipExtent)*N;b.rect(p?B:Math.round(B),p?k:Math.round(k),p?te:Math.round(B+te)-Math.round(B),p?de:Math.round(k+de)-Math.round(k)),b.clip()}const C=(O.extent[0]-T[0])*N,D=-(O.extent[3]-T[3])*N,F=ft(O.extent)*N,V=qn(O.extent)*N;b.drawImage(O.image,h,h,O.image.width-2*h,O.image.height-2*h,p?C:Math.round(C),p?D:Math.round(D),p?F:Math.round(C+F)-Math.round(C),p?V:Math.round(D+V)-Math.round(D)),O.clipExtent&&b.restore()}}));const L=Pl(o);return l.getTriangles().forEach(function(O,U,P){const C=O.source,D=O.target;let F=C[0][0],V=C[0][1],B=C[1][0],k=C[1][1],te=C[2][0],de=C[2][1];const ge=I((D[0][0]-L[0])/s),ue=I(-(D[0][1]-L[1])/s),G=I((D[1][0]-L[0])/s),ie=I(-(D[1][1]-L[1])/s),ne=I((D[2][0]-L[0])/s),W=I(-(D[2][1]-L[1])/s),$=F,oe=V;F=0,V=0,B-=$,k-=oe,te-=$,de-=oe;const me=[[B,k,0,0,G-ge],[te,de,0,0,ne-ge],[0,0,B,k,ie-ue],[0,0,te,de,W-ue]],xe=QF(me);if(!xe)return;if(S.save(),S.beginPath(),g6()||!p){S.moveTo(G,ie);const _e=4,we=ge-G,Ce=ue-ie;for(let Be=0;Be<_e;Be++)S.lineTo(G+I((Be+1)*we/_e),ie+I(Be*Ce/(_e-1))),Be!=_e-1&&S.lineTo(G+I((Be+1)*we/_e),ie+I((Be+1)*Ce/(_e-1)));S.lineTo(ne,W)}else S.moveTo(G,ie),S.lineTo(ge,ue),S.lineTo(ne,W);S.clip(),S.transform(xe[0],xe[2],xe[1],xe[3],ge,ue),S.translate(T[0]-$,T[3]-oe);let re;if(b)re=b.canvas,S.scale(M,-M);else{const _e=u[0],we=_e.extent;re=_e.image,S.scale(ft(we)/re.width,-qn(we)/re.height)}S.drawImage(re,0,0),S.restore()}),b&&(Hm(b),Jc.push(b.canvas)),f&&(S.save(),S.globalCompositeOperation="source-over",S.strokeStyle="black",S.lineWidth=1,l.getTriangles().forEach(function(O,U,P){const C=O.target,D=(C[0][0]-L[0])/s,F=-(C[0][1]-L[1])/s,V=(C[1][0]-L[0])/s,B=-(C[1][1]-L[1])/s,k=(C[2][0]-L[0])/s,te=-(C[2][1]-L[1])/s;S.beginPath(),S.moveTo(V,B),S.lineTo(D,F),S.lineTo(k,te),S.closePath(),S.stroke()}),S.restore()),S.canvas}const y6=10,SC=.25;class _6{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let u={};const h=l?AV(M=>dn(l,$m(M,this.targetProj_,this.sourceProj_))):Bp(this.targetProj_,this.sourceProj_);this.transformInv_=function(M){const L=M[0]+"/"+M[1];return u[L]||(u[L]=h(M)),u[L]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ft(r)>=ft(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ft(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ft(this.targetProj_.getExtent()):null;const f=Pl(i),p=Um(i),_=zm(i),x=Vm(i),S=this.transformInv_(f),I=this.transformInv_(p),T=this.transformInv_(_),b=this.transformInv_(x),N=y6+(o?Math.max(0,Math.ceil(Math.log2(Cv(i)/(o*o*256*256)))):0);if(this.addQuad_(f,p,_,x,S,I,T,b,N),this.wrapsXInSource_){let M=1/0;this.triangles_.forEach(function(L,O,U){M=Math.min(M,L.source[0][0],L.source[1][0],L.source[2][0])}),this.triangles_.forEach(L=>{if(Math.max(L.source[0][0],L.source[1][0],L.source[2][0])-M>this.sourceWorldWidth_/2){const O=[[L.source[0][0],L.source[0][1]],[L.source[1][0],L.source[1][1]],[L.source[2][0],L.source[2][1]]];O[0][0]-M>this.sourceWorldWidth_/2&&(O[0][0]-=this.sourceWorldWidth_),O[1][0]-M>this.sourceWorldWidth_/2&&(O[1][0]-=this.sourceWorldWidth_),O[2][0]-M>this.sourceWorldWidth_/2&&(O[2][0]-=this.sourceWorldWidth_);const U=Math.min(O[0][0],O[1][0],O[2][0]);Math.max(O[0][0],O[1][0],O[2][0])-U<this.sourceWorldWidth_/2&&(L.source=O)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,u,h){const f=II([s,o,l,u]),p=this.sourceWorldWidth_?ft(f)/this.sourceWorldWidth_:null,_=this.sourceWorldWidth_,x=this.sourceProj_.canWrapX()&&p>.5&&p<1;let S=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const T=II([e,t,i,r]);S=ft(T)/this.targetWorldWidth_>SC||S}!x&&this.sourceProj_.isGlobal()&&p&&(S=p>SC||S)}if(!S&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!li(f,this.maxSourceExtent_))return;let I=0;if(!S&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)S=!0;else if(I=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),I!=1&&I!=2&&I!=4&&I!=8)return}if(h>0){if(!S){const T=[(e[0]+i[0])/2,(e[1]+i[1])/2],b=this.transformInv_(T);let N;x?N=(al(s[0],_)+al(l[0],_))/2-al(b[0],_):N=(s[0]+l[0])/2-b[0];const M=(s[1]+l[1])/2-b[1];S=N*N+M*M>this.errorThresholdSquared_}if(S){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const T=[(t[0]+i[0])/2,(t[1]+i[1])/2],b=this.transformInv_(T),N=[(r[0]+e[0])/2,(r[1]+e[1])/2],M=this.transformInv_(N);this.addQuad_(e,t,T,N,s,o,b,M,h-1),this.addQuad_(N,T,i,r,M,b,l,u,h-1)}else{const T=[(e[0]+t[0])/2,(e[1]+t[1])/2],b=this.transformInv_(T),N=[(i[0]+r[0])/2,(i[1]+r[1])/2],M=this.transformInv_(N);this.addQuad_(e,T,N,r,s,b,M,u,h-1),this.addQuad_(T,t,i,N,b,o,l,M,h-1)}return}}if(x){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(I&11)==0&&this.addTriangle_(e,i,r,s,l,u),(I&14)==0&&this.addTriangle_(e,i,t,s,l,o),I&&((I&13)==0&&this.addTriangle_(t,r,e,o,u,s),(I&7)==0&&this.addTriangle_(t,r,i,o,u,l))}calculateSourceExtent(){const e=nr();return this.triangles_.forEach(function(t,i,r){const s=t.source;od(e,s[0]),od(e,s[1]),od(e,s[2])}),e}getTriangles(){return this.triangles_}}const v6=.5;class kP extends $1{constructor(e,t,i,r,s,o,l,u,h,f,p,_){super(s,ke.IDLE,_),this.renderEdges_=p!==void 0?p:!1,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const x=r.getTileCoordExtent(this.wrappedTileCoord_),S=this.targetTileGrid_.getExtent();let I=this.sourceTileGrid_.getExtent();const T=S?ol(x,S):x;if(Cv(T)===0){this.state=ke.EMPTY;return}const b=e.getExtent();b&&(I?I=ol(I,b):I=b);const N=r.getResolution(this.wrappedTileCoord_[0]),M=p6(e,i,T,N);if(!isFinite(M)||M<=0){this.state=ke.EMPTY;return}const L=f!==void 0?f:v6;if(this.triangulation_=new _6(e,i,T,I,M*L,N),this.triangulation_.getTriangles().length===0){this.state=ke.EMPTY;return}this.sourceZ_=t.getZForResolution(M);let O=this.triangulation_.calculateSourceExtent();if(I&&(e.canWrapX()?(O[1]=Dt(O[1],I[1],I[3]),O[3]=Dt(O[3],I[1],I[3])):O=ol(O,I)),!Cv(O))this.state=ke.EMPTY;else{let U=0,P=0;e.canWrapX()&&(U=ft(b),P=Math.floor((O[0]-b[0])/U)),bA(O.slice(),e,!0).forEach(D=>{const F=t.getTileRangeForExtentAndZ(D,this.sourceZ_);for(let V=F.minX;V<=F.maxX;V++)for(let B=F.minY;B<=F.maxY;B++){const k=h(this.sourceZ_,V,B,l);if(k){const te=P*U;this.sourceTiles_.push({tile:k,offset:te})}}++P}),this.sourceTiles_.length===0&&(this.state=ke.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==ke.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=ke.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=m6(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=ke.LOADED}this.changed()}load(){if(this.state==ke.IDLE){this.state=ke.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==ke.IDLE||i==ke.LOADING){e++;const r=rt(t,Ge.CHANGE,s=>{const o=t.getState();(o==ke.LOADED||o==ke.ERROR||o==ke.EMPTY)&&(bt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==ke.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(bt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Hm(this.canvas_.getContext("2d")),Jc.push(this.canvas_),this.canvas_=null),super.release()}}class H1{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Ec(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new H1(n,e,t,i)}class IC{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Om&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return ct(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return ct(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){ct(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function Yp(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function x6(n,e,t){return n+"/"+e+"/"+t}function pp(n,e,t,i,r){return`${st(n)},${e},${x6(t,i,r)}`}function w6(n){return E6(n[0],n[1],n[2])}function E6(n,e,t){return(e<<n)+t}function T6(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function O_(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function S6(n,e,t){const i=n[t];return i?i.delete(e):!1}function CC(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=ol(e,$o(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=ol(e,r))}return e}class I6 extends vP{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=nr(),this.tempTileRange_=new H1(0,0,0,0),this.tempTileCoord_=Yp(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new IC(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new IC(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),u=pp(l,l.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const f=r.viewState.projection,p=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!p||gp(p,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=dn(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!uu(s,r))return null;const o=t.viewState,l=i.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const p=u.getTileCoordForCoordAndZ(r,f),_=this.getTile(f,p[1],p[2],t);if(!_||_.getState()!==ke.LOADED)continue;const x=u.getOrigin(f),S=ui(u.getTileSize(f)),I=u.getResolution(f);let T;if(_ instanceof PP||_ instanceof kP)T=_.getImage();else if(_ instanceof wC){if(T=Uv(_.getData()),!T)continue}else continue;const b=Math.floor(h*((r[0]-x[0])/I-p[1]*S[0])),N=Math.floor(h*((x[1]-r[1])/I-p[2]*S[1])),M=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(T,b+M,N+M)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(o.projection),f=st(u);f in e.wantedTiles||(e.wantedTiles[f]={});const p=e.wantedTiles[f],_=l.getMapInternal(),x=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),_?_.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),S=o.rotation,I=S?CA(o.center,o.resolution,S,e.size):void 0;for(let T=i;T>=x;--T){const b=h.getTileRangeForExtentAndZ(t,T,this.tempTileRange_),N=h.getResolution(T);for(let M=b.minX;M<=b.maxX;++M)for(let L=b.minY;L<=b.maxY;++L){if(S&&!h.tileCoordIntersectsViewport([T,M,L],I))continue;const O=this.getTile(T,M,L,e);if(!O||!O_(r,O,T))continue;const P=O.getKey();if(p[P]=!0,O.getState()===ke.IDLE&&!e.tileQueue.isKeyQueued(P)){const C=Yp(T,M,L,this.tempTileCoord_);e.tileQueue.enqueue([O,f,h.getTileCoordCenter(C),N])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let u=0;u<l.length;++u){const h=pp(this.getLayer().getSource(),l[u],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===ke.LOADED)return f.endTransition(st(this)),O_(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let p=s.minY;p<=s.maxY;++p){const _=pp(u,h,i,f,p);let x=!1;if(l.containsKey(_)){const S=l.peek(_);S.getState()===ke.LOADED&&(O_(r,S,i),x=!0)}x||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,u=e.pixelRatio,h=this.getLayer(),f=h.getSource(),p=f.getTileGridForProjection(s),_=p.getZForResolution(o,f.zDirection),x=p.getResolution(_),S=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==S&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=S):this.renderedSourceKey_=S;let I=e.extent;const T=f.getTilePixelRatio(u);this.prepareContainer(e,t);const b=this.context.canvas.width,N=this.context.canvas.height,M=i.extent&&$o(i.extent);M&&(I=ol(I,$o(i.extent)));const L=x*b/2/T,O=x*N/2/T,U=[l[0]-L,l[1]-O,l[0]+L,l[1]+O],P={};this.renderedTiles.length=0;const C=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const G=p.getZForResolution(r.nextResolution,f.zDirection),ie=CC(e,e.nextExtent);this.enqueueTiles(e,ie,G,P,C)}const D=CC(e,I);if(this.enqueueTiles(e,D,_,P,0),C>0&&setTimeout(()=>{this.enqueueTiles(e,D,_-1,P,C-1)},0),!(_ in P))return this.container;const F=st(this),V=e.time;for(const G of P[_]){const ie=G.getState();if(ie===ke.EMPTY)continue;const ne=G.tileCoord;if(ie===ke.LOADED&&G.getAlpha(F,V)===1){G.endTransition(F);continue}if(ie!==ke.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,P)){S6(P,G,_),e.animate=!0;continue}if(this.findAltTiles_(p,ne,_+1,P))continue;const oe=p.getMinZoom();for(let me=_-1;me>=oe&&!this.findAltTiles_(p,ne,me,P);--me);}const B=x/o*u/T,k=this.getRenderContext(e);Xs(this.tempTransform,b/2,N/2,B,B,0,-b/2,-N/2),i.extent&&this.clipUnrotated(k,e,M),f.getInterpolate()||(k.imageSmoothingEnabled=!1),this.preRender(k,e);const te=Object.keys(P).map(Number);te.sort(Gs);let de;const ge=[],ue=[];for(let G=te.length-1;G>=0;--G){const ie=te[G],ne=f.getTilePixelSize(ie,u,s),$=p.getResolution(ie)/x,oe=ne[0]*$*B,me=ne[1]*$*B,xe=p.getTileCoordForCoordAndZ(Pl(U),ie),re=p.getTileCoordExtent(xe),_e=dn(this.tempTransform,[T*(re[0]-U[0])/x,T*(U[3]-re[3])/x]),we=T*f.getGutterForProjection(s);for(const Ce of P[ie]){if(Ce.getState()!==ke.LOADED)continue;const Be=Ce.tileCoord,Wt=xe[1]-Be[1],Un=Math.round(_e[0]-(Wt-1)*oe),Yt=xe[2]-Be[2],bn=Math.round(_e[1]-(Yt-1)*me),fn=Math.round(_e[0]-Wt*oe),gn=Math.round(_e[1]-Yt*me),Yn=Un-fn,Ni=bn-gn,_t=te.length===1;let ut=!1;de=[fn,gn,fn+Yn,gn,fn+Yn,gn+Ni,fn,gn+Ni];for(let sn=0,Di=ge.length;sn<Di;++sn)if(!_t&&ie<ue[sn]){const It=ge[sn];li([fn,gn,fn+Yn,gn+Ni],[It[0],It[3],It[4],It[7]])&&(ut||(k.save(),ut=!0),k.beginPath(),k.moveTo(de[0],de[1]),k.lineTo(de[2],de[3]),k.lineTo(de[4],de[5]),k.lineTo(de[6],de[7]),k.moveTo(It[6],It[7]),k.lineTo(It[4],It[5]),k.lineTo(It[2],It[3]),k.lineTo(It[0],It[1]),k.clip())}ge.push(de),ue.push(ie),this.drawTile(Ce,e,fn,gn,Yn,Ni,we,_t),ut&&k.restore(),this.renderedTiles.unshift(Ce),this.updateUsedTiles(e.usedTiles,f,Ce)}}if(this.renderedResolution=x,this.extentChanged=!this.renderedExtent_||!Rd(this.renderedExtent_,U),this.renderedExtent_=U,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&k.restore(),k.imageSmoothingEnabled=!0,this.renderComplete){const G=(ie,ne)=>{const W=st(f),$=ne.wantedTiles[W],oe=$?Object.keys($).length:0;this.updateCacheSize(oe),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(G)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,u){let h;if(e instanceof wC){if(h=Uv(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),p=st(this),_=t.layerStatesArray[t.layerIndex],x=_.opacity*(u?e.getAlpha(p,t.time):1),S=x!==f.globalAlpha;S&&(f.save(),f.globalAlpha=x),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),S&&f.restore(),x!==_.opacity?t.animate=!0:u&&e.endTransition(p)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=st(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Qg={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class C6 extends Zm{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Qg.PRELOAD)}setPreload(e){this.set(Qg.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Qg.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Qg.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Mh extends C6{constructor(e){super(e)}createRenderer(){return new I6(this,{cacheSize:this.getCacheSize()})}}const Tc=[0,0,0],No=5;class NP{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,ct(BF(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,ct(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Pl(i)),ct(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,ct(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:B1,ct(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new H1(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,u=r.maxY;l<=u;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Ec(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Ec(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Ec(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),f=Math.floor(o*u);if(t<r)return Ec(h,h,f,f,i);const p=Math.floor(u*(s+1))-1,_=Math.floor(u*(o+1))-1;return Ec(h,p,f,_,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Tc);const r=Tc[1],s=Tc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Tc);const o=Tc[1],l=Tc[2];return Ec(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=ui(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=ui(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=l+s[1]*r;return na(o,l,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),u=this.getOrigin(o),h=ui(this.getTileSize(o),this.tmpSize_);let f=l*(e-u[0])/i/h[0],p=l*(u[1]-t)/i/h[1];return r?(f=Wg(f,No)-1,p=Wg(p,No)-1):(f=Bg(f,No),p=Bg(p,No)),Yp(o,f,p,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),u=ui(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/u[0],f=(o[1]-t)/l/u[1];return r?(h=Wg(h,No)-1,f=Wg(f,No)-1):(h=Bg(h,No),f=Bg(f,No)),Yp(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=d1(this.resolutions_,e,t||0);return Dt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return HA(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function DP(n){let e=n.getDefaultTileGrid();return e||(e=P6(n),n.setDefaultTileGrid(e)),e}function R6(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=K1(t);if(!uu(s,r)){const o=ft(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function b6(n,e,t,i){i=i!==void 0?i:"top-left";const r=MP(n,e,t);return new NP({extent:n,origin:qF(n,i),resolutions:r,tileSize:t})}function A6(n){const e=n||{},t=e.extent||hi("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:MP(t,e.maxZoom,e.tileSize,e.maxResolution)};return new NP(i)}function MP(n,e,t,i){e=e!==void 0?e:s6,t=ui(t!==void 0?t:B1);const r=qn(n),s=ft(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let u=0;u<o;++u)l[u]=i/Math.pow(2,u);return l}function P6(n,e,t,i){const r=K1(n);return b6(r,e,t,i)}function K1(n){n=hi(n);let e=n.getExtent();if(!e){const t=180*hu.degrees/n.getMetersPerUnit();e=na(-t,-t,t,t)}return e}function Qq(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const k6=/\{z\}/g,N6=/\{x\}/g,D6=/\{y\}/g,M6=/\{-y\}/g;function L6(n,e,t,i,r){return n.replace(k6,e.toString()).replace(N6,t.toString()).replace(D6,i.toString()).replace(M6,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function O6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function j6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return L6(n,o,t[1],t[2],s)})}function F6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=j6(n[r],e);return V6(i)}function V6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=w6(e),s=al(r,n.length);return n[s](e,t,i)})}class z6 extends fP{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&ui(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||st(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return it()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:DP(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=ui(r.getTileSize(e),this.tmpSize);return s==1?o:$4(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=R6(r,e,i)),T6(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class U6 extends eo{constructor(e,t){super(e),this.tile=t}}const j_={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class q1 extends z6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===q1.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=st(t),r=t.getState();let s;r==ke.LOADING?(this.tileLoadingKeys_[i]=!0,s=j_.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==ke.ERROR?j_.TILELOADERROR:r==ke.LOADED?j_.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new U6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=O6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(F6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class B6 extends q1{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:LP,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:PP,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!gp(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||gp(t,e)))return this.tileGrid;const i=st(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=DP(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(l,h!==void 0?ke.IDLE:ke.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(Ge.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||gp(l,s))return this.getTileInternal(e,t,i,r,l||s);const u=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),p=this.getTileGridForProjection(s),_=this.getTileCoordForTileUrlFunction(u,s),x=new kP(l,f,s,p,u,_,this.getTilePixelRatio(r),this.getGutter(),(S,I,T,b)=>this.getTileInternal(S,I,T,b,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return x.key=h,x}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),u=pp(this,l,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,l);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=hi(e);if(i){const r=st(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function LP(n,e){if(Ri){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Jh extends B6{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:A6({extent:K1(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const W6="modulepreload",G6=function(n){return"/visapp/"+n},RC={},Sc=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=G6(h),h in RC)return;RC[h]=!0;const f=h.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const _=document.createElement("link");if(_.rel=f?"stylesheet":W6,f||(_.as="script"),_.crossOrigin="",_.href=h,l&&_.setAttribute("nonce",l),document.head.appendChild(_),f)return new Promise((x,S)=>{_.addEventListener("load",x),_.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},$6='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class H6 extends Jh{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[$6];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Ri&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||LP)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const Zp=1/0;class K6{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,of(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){ct(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=Zp?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[u]?h:u;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,u;for(l=0;l<s;++l)o=t[l],u=e(o),u==Zp?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class q6 extends K6{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Ge.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===ke.LOADED||i===ke.ERROR||i===ke.EMPTY){i!==ke.ERROR&&t.removeEventListener(Ge.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===ke.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function X6(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Zp;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Oc extends eo{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Fo extends Oc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Lt={SINGLECLICK:"singleclick",CLICK:Ge.CLICK,DBLCLICK:Ge.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Bv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class Y6 extends af{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=rt(i,Bv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=rt(i,Bv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Ge.TOUCHMOVE,this.boundHandleTouchMove_,YA?{passive:!1}:!1)}emulateClick_(e){let t=new Fo(Lt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Fo(Lt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Fo(Lt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Lt.POINTERUP||t.type==Lt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Lt.POINTERDOWN||t.type==Lt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Fo(Lt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(bt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Fo(Lt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(rt(i,Lt.POINTERMOVE,this.handlePointerMove_,this),rt(i,Lt.POINTERUP,this.handlePointerUp_,this),rt(this.element_,Lt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(rt(this.element_.getRootNode(),Lt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Fo(Lt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Fo(Lt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(bt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Ge.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(bt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(bt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Vo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Ln={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Qm extends ds{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)bt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Cd&&this.listenerKeys.push(rt(e,Vo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class Z6 extends Qm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(Ge.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+hf+" "+N1+(this.collapsed_&&this.collapsible_?" "+GI:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>vA(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!la(t,this.renderedAttributions_)){ZV(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(GI),this.collapsed_?BI(this.collapseLabel_,this.label_):BI(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class Q6 extends Qm{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Ge.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+hf+" "+N1,u=this.element;u.className=l,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Hg)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Ou}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Hg);!s&&i===0?this.element.classList.add(Hg):s&&i!==0&&this.element.classList.remove(Hg)}this.label_.style.transform=r}this.rotation_=i}}class J6 extends Qm{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Ge.CLICK,this.handleClick_.bind(this,i),!1);const p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=h,p.appendChild(typeof l=="string"?document.createTextNode(l):l),p.addEventListener(Ge.CLICK,this.handleClick_.bind(this,-i),!1);const _=t+" "+hf+" "+N1,x=this.element;x.className=_,x.appendChild(f),x.appendChild(p),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Ou})):i.setZoom(s)}}}function e9(n){n=n||{};const e=new Zi;return(n.zoom===void 0||n.zoom)&&e.push(new J6(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new Q6(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new Z6(n.attributionOptions)),e}class t9{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const bC={ACTIVE:"active"};class pf extends ds{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(bC.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(bC.ACTIVE,e)}setMap(e){this.map_=e}}function n9(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:e6,center:n.getConstrainedCenter(r)})}}function X1(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Ou})}class i9 extends pf{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Lt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();X1(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function Wv(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const r9=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},s9=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},OP=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?s9(n):!0},o9=Id,jP=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(XV&&qA&&e.ctrlKey)},FP=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},a9=function(n){const e=n.originalEvent;return qA?e.metaKey:e.ctrlKey},l9=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},VP=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},F_=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},c9=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class mf extends pf{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Lt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Lt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Lt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Lt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function Y1(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class u9 extends mf{constructor(e){super({stopDown:jm}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Wv(FP,c9);this.condition_=e.onFocusOnly?Wv(OP,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(Y1(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();eV(s,l.getResolution()),m1(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:Ou})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class h9 extends mf{constructor(e){e=e||{},super({stopDown:jm}),this.condition_=e.condition?e.condition:r9,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!F_(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===U1)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return F_(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return F_(e)&&jP(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class d9 extends Om{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Md([r])}getGeometry(){return this.geometry_}}const Ic={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Lh extends eo{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class f9 extends mf{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new d9(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??jP,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Lh(Ic.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Lh(t?Ic.BOXEND:Ic.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Lh(Ic.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Lh(Ic.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Lh(Ic.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class g9 extends f9{constructor(e){e=e||{};const t=e.condition?e.condition:l9;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:Ou})}}const ja={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class p9 extends pf{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return FP(t)&&VP(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Ge.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==ja.DOWN||r==ja.LEFT||r==ja.RIGHT||r==ja.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==ja.DOWN?h=-l:r==ja.LEFT?u=-l:r==ja.RIGHT?u=l:h=l;const f=[u,h];m1(f,o.getRotation()),n9(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class m9 extends pf{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!a9(t)&&VP(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Ge.KEYDOWN||e.type==Ge.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();X1(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const y9=40,_9=300;class v9 extends pf{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:o9;this.condition_=e.onFocusOnly?Wv(OP,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Ge.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=y9;break;case WheelEvent.DOM_DELTA_PAGE:s*=_9;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),X1(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class x9 extends mf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=jm),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==U1&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Y1(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class w9 extends mf{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=jm),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(Y1(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function E9(n){n=n||{};const e=new Zi,t=new t9(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new h9),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new i9({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new u9({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new x9),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new w9({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new p9),e.push(new m9({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new v9({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new g9({duration:n.zoomDuration})),e}class T9 extends Om{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){it()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Xs(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),FA(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,u){let h;const f=t.viewState;function p(L,O,U,P){return s.call(o,O,L?U:null,P)}const _=f.projection,x=AA(e.slice(),_),S=[[0,0]];if(_.canWrapX()&&r){const L=_.getExtent(),O=ft(L);S.push([-O,0],[O,0])}const I=t.layerStatesArray,T=I.length,b=[],N=[];for(let L=0;L<S.length;L++)for(let O=T-1;O>=0;--O){const U=I[O],P=U.layer;if(P.hasRenderer()&&W1(U,f)&&l.call(u,P)){const C=P.getRenderer(),D=P.getSource();if(C&&D){const F=D.getWrapX()?x:e,V=p.bind(null,U.managed);N[0]=F[0]+S[L][0],N[1]=F[1]+S[L][1],h=C.forEachFeatureAtCoordinate(N,t,i,V,b)}if(h)return h}}if(b.length===0)return;const M=1/b.length;return b.forEach((L,O)=>L.distanceSq+=O*M),b.sort((L,O)=>L.distanceSq-O.distanceSq),b.some(L=>h=L.callback(L.feature,L.layer,L.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,Id,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){it()}scheduleExpireIconCache(e){Ji.canExpireCache()&&e.postRenderFunctions.push(S9)}}function S9(n,e){Ji.expire()}class I9 extends T9{constructor(e){super(e),this.fontChangeListenerKey_=rt(Dc,au.PROPERTYCHANGE,e.redrawText,e),this.element_=Ri?ZA():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=hf+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new _P(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){bt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Qi.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof AP&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const p=t[h];e.layerIndex=h;const _=p.layer,x=_.getSourceState();if(!W1(p,r)||x!="ready"&&x!="undefined"){_.unrender();continue}const S=_.render(e,o);S&&(S!==o&&(this.children_.push(S),o=S),s.push(p))}this.declutter(e,s),QV(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Ho(u)){const h=u.getContext("2d");for(const f of this.children_){const p=f.firstElementChild||f,_=f.style.backgroundColor;if(_&&(!Ho(p)||p.width>0)&&(h.fillStyle=_,h.fillRect(0,0,u.width,u.height)),Ho(p)&&p.width>0){const x=f.style.opacity||p.style.opacity;h.globalAlpha=x===""?1:Number(x);const S=p.style.transform;if(S)h.setTransform(...Mv(S));else{const I=parseFloat(p.style.width)/p.width,T=parseFloat(p.style.height)/p.height;h.setTransform(I,0,0,T,0,0)}h.drawImage(p,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Qi.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function zP(n){if(n instanceof Zm){n.setMapInternal(null);return}n instanceof ju&&n.getLayers().forEach(zP)}function UP(n,e){if(n instanceof Zm){n.setMapInternal(e);return}if(n instanceof ju){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)UP(t[i],e)}}let C9=class extends ds{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=R9(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:YV,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Sr(),this.pixelToCoordinateTransform_=Sr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ri||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ri||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ri?new Zi:e9()),this.interactions=t.interactions||(Ri?new Zi:E9({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new q6(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Ln.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Ln.VIEW,this.handleViewChanged_),this.addChangeListener(Ln.SIZE,this.handleSizeChanged_),this.addChangeListener(Ln.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof es)&&e.view.then(function(r){i.setView(new es(r))}),this.controls.addEventListener(ri.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(ri.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(ri.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(ri.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(ri.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(ri.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){UP(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Id,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof ju?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:Id,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(Ln.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Dv(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?dn(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Ln.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Zi){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ls(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?dn(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Ln.SIZE)}getView(){return this.get(Ln.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return X6(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Fo(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Bv.POINTERDOWN||i===Ge.WHEEL||i===Ge.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[jn.ANIMATING]||o[jn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Qi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Qi.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Oc(Vo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Oc(Vo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)bt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Ge.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Ge.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Ho(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Ho(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new I9(this)),!Ho(t)){this.mapBrowserEventHandler_=new Y6(this,this.moveTolerance_);for(const r in Lt)this.mapBrowserEventHandler_.addEventListener(Lt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Ge.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Ge.WHEEL,this.boundHandleBrowserEvent_,YA?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[rt(i,Ge.KEYDOWN,this.handleBrowserEvent,this),rt(i,Ge.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(bt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(bt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=rt(e,au.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=rt(e,Ge.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(bt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new zo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[rt(e,au.PROPERTYCHANGE,this.render,this),rt(e,Ge.CHANGE,this.render,this),rt(e,"addlayer",this.handleLayerAdd_,this),rt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){zP(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&nC(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Rv(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:st(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=Rv(l.nextCenter,l.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Bm(this.previousExtent_)&&!Rd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Oc(Vo.MOVESTART,this,r)),this.previousExtent_=Fm(this.previousExtent_)),this.previousExtent_&&!s.viewHints[jn.ANIMATING]&&!s.viewHints[jn.INTERACTING]&&!Rd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Oc(Vo.MOVEEND,this,s)),xA(s.extent,this.previousExtent_))),this.dispatchEvent(new Oc(Vo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Vo.LOADSTART)||this.hasListener(Vo.LOADEND)||this.hasListener(Qi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new zo("removelayer",t)),this.set(Ln.LAYERGROUP,e)}setSize(e){this.set(Ln.SIZE,e)}setTarget(e){this.set(Ln.TARGET,e)}setView(e){if(!e||e instanceof es){this.set(Ln.VIEW,e);return}this.set(Ln.VIEW,new es);const t=this;e.then(function(i){t.setView(new es(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Ho(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!nC(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&PA("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!la(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function R9(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new ju({layers:n.layers});t[Ln.LAYERGROUP]=i,t[Ln.TARGET]=n.target,t[Ln.VIEW]=n.view instanceof es?n.view:new es;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Zi(n.controls.slice()):(ct(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Zi(n.interactions.slice()):(ct(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Zi(n.overlays.slice()):(ct(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Zi,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const V_="units",b9=[1,2,5],Oh=25.4/.28;class A9 extends Qm{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+hf,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(V_,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(V_)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(V_,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Up(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||Oh)/Oh,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Oh)/Oh:void 0;let h=l*o,f="";if(r=="degrees"){const M=hu.degrees;h*=M,h<M/60?(f="",o*=3600):h<M?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let p=3*Math.floor(Math.log(l*o)/Math.log(10)),_,x,S,I=0,T,b;for(;;){S=Math.floor(p/3);const M=Math.pow(10,S);if(_=b9[(p%3+3)%3]*M,x=Math.round(_/o),isNaN(x)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&x>=u){_=I,x=T,S=b;break}else if(x>=l)break;I=_,T=x,b=S,++p}const N=this.scaleBar_?this.createScaleBar(x,_,f):_.toFixed(S<0?-S:0)+" "+f;this.renderedHTML_!=N&&(this.innerElement_.innerHTML=N,this.renderedHTML_=N),this.renderedWidth_!=x&&(this.innerElement_.style.width=x+"px",this.renderedWidth_=x),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,u=[this.createMarker("absolute")];for(let f=0;f<o;++f){const p=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${p}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return u.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),u=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=Up(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Oh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const P9={},AC=n=>{let e;const t=new Set,i=(f,p)=>{const _=typeof f=="function"?f(e):f;if(!Object.is(_,e)){const x=e;e=p??(typeof _!="object"||_===null)?_:Object.assign({},e,_),t.forEach(S=>S(e,x))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(P9?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},k9=n=>n?AC(n):AC;var z_={exports:{}},U_={},B_={exports:{}},W_={};var PC;function N9(){if(PC)return W_;PC=1;var n=ef();function e(p,_){return p===_&&(p!==0||1/p===1/_)||p!==p&&_!==_}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(p,_){var x=_(),S=i({inst:{value:x,getSnapshot:_}}),I=S[0].inst,T=S[1];return s(function(){I.value=x,I.getSnapshot=_,u(I)&&T({inst:I})},[p,x,_]),r(function(){return u(I)&&T({inst:I}),p(function(){u(I)&&T({inst:I})})},[p]),o(x),x}function u(p){var _=p.getSnapshot;p=p.value;try{var x=_();return!t(p,x)}catch{return!0}}function h(p,_){return _()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return W_.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,W_}var kC;function D9(){return kC||(kC=1,B_.exports=N9()),B_.exports}var NC;function M9(){if(NC)return U_;NC=1;var n=ef(),e=D9();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return U_.useSyncExternalStoreWithSelector=function(h,f,p,_,x){var S=s(null);if(S.current===null){var I={hasValue:!1,value:null};S.current=I}else I=S.current;S=l(function(){function b(U){if(!N){if(N=!0,M=U,U=_(U),x!==void 0&&I.hasValue){var P=I.value;if(x(P,U))return L=P}return L=U}if(P=L,i(M,U))return P;var C=_(U);return x!==void 0&&x(P,C)?(M=U,P):(M=U,L=C)}var N=!1,M,L,O=p===void 0?null:p;return[function(){return b(f())},O===null?void 0:function(){return b(O())}]},[f,p,_,x]);var T=r(h,S[0],S[1]);return o(function(){I.hasValue=!0,I.value=T},[T]),u(T),T},U_}var DC;function L9(){return DC||(DC=1,z_.exports=M9()),z_.exports}var O9=L9();const j9=kx(O9),BP={},{useDebugValue:F9}=dL,{useSyncExternalStoreWithSelector:V9}=j9;let MC=!1;const z9=n=>n;function U9(n,e=z9,t){(BP?"production":void 0)!=="production"&&t&&!MC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),MC=!0);const i=V9(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return F9(i),i}const LC=n=>{(BP?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?k9(n):n,t=(i,r)=>U9(e,i,r);return Object.assign(t,e),t},Ar=n=>n?LC(n):LC;var WP=Symbol.for("immer-nothing"),OC=Symbol.for("immer-draftable"),Pi=Symbol.for("immer-state");function _r(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var jd=Object.getPrototypeOf;function mu(n){return!!n&&!!n[Pi]}function vl(n){return n?GP(n)||Array.isArray(n)||!!n[OC]||!!n.constructor?.[OC]||yf(n)||ey(n):!1}var B9=Object.prototype.constructor.toString(),jC=new WeakMap;function GP(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=jC.get(t);return i===void 0&&(i=Function.toString.call(t),jC.set(t,i)),i===B9}function Qp(n,e,t=!0){Jm(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function Jm(n){const e=n[Pi];return e?e.type_:Array.isArray(n)?1:yf(n)?2:ey(n)?3:0}function Gv(n,e){return Jm(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function $P(n,e,t){const i=Jm(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function W9(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function yf(n){return n instanceof Map}function ey(n){return n instanceof Set}function Ba(n){return n.copy_||n.base_}function $v(n,e){if(yf(n))return new Map(n);if(ey(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=GP(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Pi];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(jd(n),i)}else{const i=jd(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function Z1(n,e=!1){return ty(n)||mu(n)||!vl(n)||(Jm(n)>1&&Object.defineProperties(n,{set:Jg,add:Jg,clear:Jg,delete:Jg}),Object.freeze(n),e&&Object.values(n).forEach(t=>Z1(t,!0))),n}function G9(){_r(2)}var Jg={value:G9};function ty(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var $9={};function xl(n){const e=$9[n];return e||_r(0,n),e}var Fd;function HP(){return Fd}function H9(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function FC(n,e){e&&(xl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Hv(n){Kv(n),n.drafts_.forEach(K9),n.drafts_=null}function Kv(n){n===Fd&&(Fd=n.parent_)}function VC(n){return Fd=H9(Fd,n)}function K9(n){const e=n[Pi];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function zC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Pi].modified_&&(Hv(e),_r(4)),vl(n)&&(n=Jp(e,n),e.parent_||em(e,n)),e.patches_&&xl("Patches").generateReplacementPatches_(t[Pi].base_,n,e.patches_,e.inversePatches_)):n=Jp(e,t,[]),Hv(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==WP?n:void 0}function Jp(n,e,t){if(ty(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Pi];if(!r)return Qp(e,(s,o)=>UC(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return em(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),Qp(o,(u,h)=>UC(n,r,s,u,h,t,l),i),em(n,s,!1),t&&n.patches_&&xl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function UC(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=ty(r);if(!(l&&!o)){if(mu(r)){const u=s&&e&&e.type_!==3&&!Gv(e.assigned_,i)?s.concat(i):void 0,h=Jp(n,r,u);if($P(t,i,h),mu(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(vl(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;Jp(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(yf(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&em(n,r)}}}function em(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&Z1(e,t)}function q9(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:HP(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=Q1;t&&(r=[i],s=Vd);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var Q1={get(n,e){if(e===Pi)return n;const t=Ba(n);if(!Gv(t,e))return X9(n,t,e);const i=t[e];return n.finalized_||!vl(i)?i:i===G_(n.base_,e)?($_(n),n.copy_[e]=Xv(i,n)):i},has(n,e){return e in Ba(n)},ownKeys(n){return Reflect.ownKeys(Ba(n))},set(n,e,t){const i=KP(Ba(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=G_(Ba(n),e),s=r?.[Pi];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(W9(t,r)&&(t!==void 0||Gv(n.base_,e)))return!0;$_(n),qv(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return G_(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,$_(n),qv(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Ba(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){_r(11)},getPrototypeOf(n){return jd(n.base_)},setPrototypeOf(){_r(12)}},Vd={};Qp(Q1,(n,e)=>{Vd[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Vd.deleteProperty=function(n,e){return Vd.set.call(this,n,e,void 0)};Vd.set=function(n,e,t){return Q1.set.call(this,n[0],e,t,n[0])};function G_(n,e){const t=n[Pi];return(t?Ba(t):n)[e]}function X9(n,e,t){const i=KP(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function KP(n,e){if(!(e in n))return;let t=jd(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=jd(t)}}function qv(n){n.modified_||(n.modified_=!0,n.parent_&&qv(n.parent_))}function $_(n){n.copy_||(n.copy_=$v(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var Y9=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,f=>t.call(this,f,...h))}}typeof t!="function"&&_r(6),i!==void 0&&typeof i!="function"&&_r(7);let r;if(vl(e)){const s=VC(this),o=Xv(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?Hv(s):Kv(s)}return FC(s,i),zC(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===WP&&(r=void 0),this.autoFreeze_&&Z1(r,!0),i){const s=[],o=[];xl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else _r(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){vl(n)||_r(8),mu(n)&&(n=Z9(n));const e=VC(this),t=Xv(n,void 0);return t[Pi].isManual_=!0,Kv(e),t}finishDraft(n,e){const t=n&&n[Pi];(!t||!t.isManual_)&&_r(9);const{scope_:i}=t;return FC(i,e),zC(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=xl("Patches").applyPatches_;return mu(n)?i(n,e):this.produce(n,r=>i(r,e))}};function Xv(n,e){const t=yf(n)?xl("MapSet").proxyMap_(n,e):ey(n)?xl("MapSet").proxySet_(n,e):q9(n,e);return(e?e.scope_:HP()).drafts_.push(t),t}function Z9(n){return mu(n)||_r(10,n),qP(n)}function qP(n){if(!vl(n)||ty(n))return n;const e=n[Pi];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=$v(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=$v(n,!0);return Qp(t,(r,s)=>{$P(t,r,qP(s))},i),e&&(e.finalized_=!1),t}var Q9=new Y9,J9=Q9.produce;const ez=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?J9(r):r;return e(l,s,...o)},n(i.setState,t,i)),ny=ez,ai=Ar()(ny((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),XP={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await Sc(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-Dx_GckPt.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1,2]));return n()},immediateLoad:!1},Trailerhellingen:{name:"Trailerhellingen",factory:async()=>{const{createBoothellingenLayer:n}=await Sc(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-CRSWdRTy.js");return{createBoothellingenLayer:e}},__vite__mapDeps([3,1,2]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await Sc(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-CHrLs7xt.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await Sc(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-Bdb4e-gK.js");return{createViswaterLayer:e}},__vite__mapDeps([4,1]));return n()},immediateLoad:!1},"AHN4 Hillshade":{name:"AHN4 Hillshade",factory:async()=>{const{createAHN4MultiHillshadeLayer:n}=await Sc(async()=>{const{createAHN4MultiHillshadeLayer:e}=await import("./hillshadeLayers-CuEfjC5N.js");return{createAHN4MultiHillshadeLayer:e}},__vite__mapDeps([5,6]));return n()},immediateLoad:!0},"PDOK Water NL":{name:"PDOK Water NL",factory:async()=>{const{createPDOKWaterLayer:n}=await Sc(async()=>{const{createPDOKWaterLayer:e}=await import("./pdokWaterOL-CFIJPpXz.js");return{createPDOKWaterLayer:e}},__vite__mapDeps([7,6]));return n()},immediateLoad:!0}};function tz(){return Object.values(XP).filter(n=>n.immediateLoad)}const fs=Ar()(ny((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Xi=Ar()(ny((n,e)=>({visible:{"CartoDB Light":!0,OpenStreetMap:!1,Luchtfoto:!1,Terrein:!1,"Labels Overlay":!1,Aanlegsteigers:!1,Trailerhellingen:!1,Dieptekaart:!1,Viswater:!1,"PDOK Water NL":!0,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5,"PDOK Water NL":1},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=XP[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=fs.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),Fn=Ar()(ny(n=>({layerControlOpen:!1,layerPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchFormLocationSource:null,catchFormInitialPhotos:[],catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleLayerPanel:()=>{n(e=>{const t=e.layerPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.layerPanelOpen=!0)})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e?.location||null,t.catchFormLocationSource=e?.locationSource||null,t.catchFormInitialPhotos=e?.photos||[]})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null,e.catchFormLocationSource=null,e.catchFormInitialPhotos=[]})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.layerPanelOpen=!1,e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),nz={};function iz(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const zd=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return zd(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return zd(i)(t)}}}},rz=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:T=>T,version:0,merge:(T,b)=>({...b,...T}),...e},o=!1;const l=new Set,u=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...T)},i,r);const f=zd(s.serialize),p=()=>{const T=s.partialize({...i()});let b;const N=f({state:T,version:s.version}).then(M=>h.setItem(s.name,M)).catch(M=>{b=M});if(b)throw b;return N},_=r.setState;r.setState=(T,b)=>{_(T,b),p()};const x=n((...T)=>{t(...T),p()},i,r);let S;const I=()=>{var T;if(!h)return;o=!1,l.forEach(N=>N(i()));const b=((T=s.onRehydrateStorage)==null?void 0:T.call(s,i()))||void 0;return zd(h.getItem.bind(h))(s.name).then(N=>{if(N)return s.deserialize(N)}).then(N=>{if(N)if(typeof N.version=="number"&&N.version!==s.version){if(s.migrate)return s.migrate(N.state,N.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return N.state}).then(N=>{var M;return S=s.merge(N,(M=i())!=null?M:x),t(S,!0),p()}).then(()=>{b?.(S,void 0),o=!0,u.forEach(N=>N(S))}).catch(N=>{b?.(void 0,N)})};return r.persist={setOptions:T=>{s={...s,...T},T.getStorage&&(h=T.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:T=>(l.add(T),()=>{l.delete(T)}),onFinishHydration:T=>(u.add(T),()=>{u.delete(T)})},I(),S||x},sz=(n,e)=>(t,i,r)=>{let s={storage:iz(()=>localStorage),partialize:I=>I,version:0,merge:(I,T)=>({...T,...I}),...e},o=!1;const l=new Set,u=new Set;let h=s.storage;if(!h)return n((...I)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...I)},i,r);const f=()=>{const I=s.partialize({...i()});return h.setItem(s.name,{state:I,version:s.version})},p=r.setState;r.setState=(I,T)=>{p(I,T),f()};const _=n((...I)=>{t(...I),f()},i,r);r.getInitialState=()=>_;let x;const S=()=>{var I,T;if(!h)return;o=!1,l.forEach(N=>{var M;return N((M=i())!=null?M:_)});const b=((T=s.onRehydrateStorage)==null?void 0:T.call(s,(I=i())!=null?I:_))||void 0;return zd(h.getItem.bind(h))(s.name).then(N=>{if(N)if(typeof N.version=="number"&&N.version!==s.version){if(s.migrate)return[!0,s.migrate(N.state,N.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,N.state];return[!1,void 0]}).then(N=>{var M;const[L,O]=N;if(x=s.merge(O,(M=i())!=null?M:_),t(x,!0),L)return f()}).then(()=>{b?.(x,void 0),x=i(),o=!0,u.forEach(N=>N(x))}).catch(N=>{b?.(void 0,N)})};return r.persist={setOptions:I=>{s={...s,...I},I.storage&&(h=I.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>S(),hasHydrated:()=>o,onHydrate:I=>(l.add(I),()=>{l.delete(I)}),onFinishHydration:I=>(u.add(I),()=>{u.delete(I)})},s.skipHydration||S(),x||_},oz=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((nz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),rz(n,e)):sz(n,e),_f=oz,He=Ar()(_f(n=>({defaultBackground:"CartoDB Light",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,showWindIndicator:!1,showTideWidget:!1,showBuienradarWidget:!1,showWaterflowWidget:!1,showForecastSlider:!1,showWaterDataWidget:!1,widgetOrder:["weather","wind","tide","buienradar","waterflow","forecast","waterData"],fontScale:100,showFontSliders:!1,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e}),setShowWindIndicator:e=>n({showWindIndicator:e}),setShowTideWidget:e=>n({showTideWidget:e}),setShowBuienradarWidget:e=>n({showBuienradarWidget:e}),setShowWaterflowWidget:e=>n({showWaterflowWidget:e}),setShowForecastSlider:e=>n({showForecastSlider:e}),setShowWaterDataWidget:e=>n({showWaterDataWidget:e}),setWidgetOrder:e=>n({widgetOrder:e}),setFontScale:e=>n({fontScale:e}),setShowFontSliders:e=>n({showFontSliders:e})}),{name:"visapp-settings",version:3,migrate:(n,e)=>{const t=n;return e<3?{...t,defaultBackground:"CartoDB Light"}:t}})),YP=Ar()(_f((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),J1=Ar((n,e)=>({current:null,pressureHistory:[],hourlyForecast:[],precipitation15min:[],loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code,precipitation",hourly:"temperature_2m,wind_speed_10m,wind_direction_10m,surface_pressure,weather_code,precipitation_probability,precipitation",minutely_15:"precipitation",past_hours:"24",forecast_hours:"48",past_minutely_15:"0",forecast_minutely_15:"8",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();let l=[],u=[],h=[];o.hourly?.time&&o.hourly?.surface_pressure&&(l=o.hourly.time.map((f,p)=>({time:f,pressure:o.hourly.surface_pressure[p]})),u=o.hourly.time.map((f,p)=>({time:f,temperature:o.hourly.temperature_2m[p],windSpeed:o.hourly.wind_speed_10m[p],windDirection:o.hourly.wind_direction_10m[p],pressure:o.hourly.surface_pressure[p],weatherCode:o.hourly.weather_code[p],precipitationProbability:o.hourly.precipitation_probability?.[p]||0,precipitation:o.hourly.precipitation?.[p]||0}))),o.minutely_15?.time&&o.minutely_15?.precipitation&&(h=o.minutely_15.time.map((f,p)=>({time:f,precipitation:o.minutely_15.precipitation[p]||0}))),o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},pressureHistory:l,hourlyForecast:u,precipitation15min:h,loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"},getFishingScore:()=>{const{current:t}=e();if(!t)return 1;let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),Math.max(0,Math.min(3,i/2))},getPressureTrend:()=>{const{pressureHistory:t}=e();if(t.length<6)return"stable";const i=t.slice(-6),r=t.slice(-12,-6);if(r.length===0)return"stable";const s=i.reduce((u,h)=>u+h.pressure,0)/i.length,o=r.reduce((u,h)=>u+h.pressure,0)/r.length,l=s-o;return l>2?"rising":l<-2?"falling":"stable"},getWeatherAtTime:t=>{const{hourlyForecast:i}=e();if(i.length===0)return null;t.toISOString().slice(0,13)+"";let r=i[0],s=1/0;for(const o of i){const l=new Date(o.time).getTime(),u=Math.abs(l-t.getTime());u<s&&(s=u,r=o)}return r}})),ZP=Ar()(_f(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),BC=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],WC=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],az=Ar()(_f((n,e)=>({presets:BC,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=Xi.getState().setLayerVisibility;WC.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=Xi.getState().visible,r=WC.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:BC})}}),{name:"visapp-presets"})),lz=()=>{};var GC={};const QP=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},cz=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},JP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,f=s>>2,p=(s&3)<<4|l>>4;let _=(l&15)<<2|h>>6,x=h&63;u||(x=64,o||(_=64)),i.push(t[f],t[p],t[_],t[x])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(QP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):cz(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||p==null)throw new uz;const _=s<<2|l>>4;if(i.push(_),h!==64){const x=l<<4&240|h>>2;if(i.push(x),p!==64){const S=h<<6&192|p;i.push(S)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class uz extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hz=function(n){const e=QP(n);return JP.encodeByteArray(e,!0)},tm=function(n){return hz(n).replace(/\./g,"")},ek=function(n){try{return JP.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function tk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const dz=()=>tk().__FIREBASE_DEFAULTS__,fz=()=>{if(typeof process>"u"||typeof GC>"u")return;const n=GC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},gz=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&ek(n[1]);return e&&JSON.parse(e)},iy=()=>{try{return lz()||dz()||fz()||gz()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nk=n=>iy()?.emulatorHosts?.[n],ik=n=>{const e=nk(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},rk=()=>iy()?.config,sk=n=>iy()?.[`_${n}`];class pz{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Dl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ew(n){return(await fetch(n,{credentials:"include"})).ok}function ok(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[tm(JSON.stringify(t)),tm(JSON.stringify(o)),""].join(".")}const ld={};function mz(){const n={prod:[],emulator:[]};for(const e of Object.keys(ld))ld[e]?n.emulator.push(e):n.prod.push(e);return n}function yz(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let $C=!1;function tw(n,e){if(typeof window>"u"||typeof document>"u"||!Dl(window.location.host)||ld[n]===e||ld[n]||$C)return;ld[n]=e;function t(_){return`__firebase__banner__${_}`}const i="__firebase__banner",s=mz().prod.length>0;function o(){const _=document.getElementById(i);_&&_.remove()}function l(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function u(_,x){_.setAttribute("width","24"),_.setAttribute("id",x),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{$C=!0,o()},_}function f(_,x){_.setAttribute("id",x),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function p(){const _=yz(i),x=t("text"),S=document.getElementById(x)||document.createElement("span"),I=t("learnmore"),T=document.getElementById(I)||document.createElement("a"),b=t("preprendIcon"),N=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const M=_.element;l(M),f(T,I);const L=h();u(N,b),M.append(N,S,T,L),document.body.appendChild(M)}s?(S.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function nn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function _z(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(nn())}function ak(){const n=iy()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function vz(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function xz(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function wz(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ez(){const n=nn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function lk(){return!ak()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ck(){return!ak()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function uk(){try{return typeof indexedDB=="object"}catch{return!1}}function Tz(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const Sz="FirebaseError";class gs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Sz,Object.setPrototypeOf(this,gs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vf.prototype.create)}}class vf{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?Iz(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new gs(r,l,i)}}function Iz(n,e){return n.replace(Cz,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const Cz=/\{\$([^}]+)}/g;function Rz(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function wl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(HC(s)&&HC(o)){if(!wl(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function HC(n){return n!==null&&typeof n=="object"}function xf(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function bz(n,e){const t=new Az(n,e);return t.subscribe.bind(t)}class Az{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Pz(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=H_),r.error===void 0&&(r.error=H_),r.complete===void 0&&(r.complete=H_);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Pz(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function H_(){}function no(n){return n&&n._delegate?n._delegate:n}class ia{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Wa="[DEFAULT]";class kz{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new pz;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Dz(e))try{this.getOrInitializeService({instanceIdentifier:Wa})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Wa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Wa){return this.instances.has(e)}getOptions(e=Wa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Nz(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Wa){return this.component?this.component.multipleInstances?e:Wa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Nz(n){return n===Wa?void 0:n}function Dz(n){return n.instantiationMode==="EAGER"}class Mz{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new kz(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Xe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Xe||(Xe={}));const Lz={debug:Xe.DEBUG,verbose:Xe.VERBOSE,info:Xe.INFO,warn:Xe.WARN,error:Xe.ERROR,silent:Xe.SILENT},Oz=Xe.INFO,jz={[Xe.DEBUG]:"log",[Xe.VERBOSE]:"log",[Xe.INFO]:"info",[Xe.WARN]:"warn",[Xe.ERROR]:"error"},Fz=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=jz[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class nw{constructor(e){this.name=e,this._logLevel=Oz,this._logHandler=Fz,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Lz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xe.DEBUG,...e),this._logHandler(this,Xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xe.VERBOSE,...e),this._logHandler(this,Xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xe.INFO,...e),this._logHandler(this,Xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xe.WARN,...e),this._logHandler(this,Xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xe.ERROR,...e),this._logHandler(this,Xe.ERROR,...e)}}const Vz=(n,e)=>e.some(t=>n instanceof t);let KC,qC;function zz(){return KC||(KC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Uz(){return qC||(qC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const hk=new WeakMap,Yv=new WeakMap,dk=new WeakMap,K_=new WeakMap,iw=new WeakMap;function Bz(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Zo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&hk.set(t,n)}).catch(()=>{}),iw.set(e,n),e}function Wz(n){if(Yv.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Yv.set(n,e)}let Zv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Yv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||dk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Gz(n){Zv=n(Zv)}function $z(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(q_(this),e,...t);return dk.set(i,e.sort?e.sort():[e]),Zo(i)}:Uz().includes(n)?function(...e){return n.apply(q_(this),e),Zo(hk.get(this))}:function(...e){return Zo(n.apply(q_(this),e))}}function Hz(n){return typeof n=="function"?$z(n):(n instanceof IDBTransaction&&Wz(n),Vz(n,zz())?new Proxy(n,Zv):n)}function Zo(n){if(n instanceof IDBRequest)return Bz(n);if(K_.has(n))return K_.get(n);const e=Hz(n);return e!==n&&(K_.set(n,e),iw.set(e,n)),e}const q_=n=>iw.get(n);function Kz(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Zo(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Zo(o.result),u.oldVersion,u.newVersion,Zo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const qz=["get","getKey","getAll","getAllKeys","count"],Xz=["put","add","delete","clear"],X_=new Map;function XC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(X_.get(e))return X_.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=Xz.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||qz.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&u.done]))[0]};return X_.set(e,s),s}Gz(n=>({...n,get:(e,t,i)=>XC(e,t)||n.get(e,t,i),has:(e,t)=>!!XC(e,t)||n.has(e,t)}));class Yz{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Zz(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Zz(n){return n.getComponent()?.type==="VERSION"}const Qv="@firebase/app",YC="0.14.6";const Ys=new nw("@firebase/app"),Qz="@firebase/app-compat",Jz="@firebase/analytics-compat",eU="@firebase/analytics",tU="@firebase/app-check-compat",nU="@firebase/app-check",iU="@firebase/auth",rU="@firebase/auth-compat",sU="@firebase/database",oU="@firebase/data-connect",aU="@firebase/database-compat",lU="@firebase/functions",cU="@firebase/functions-compat",uU="@firebase/installations",hU="@firebase/installations-compat",dU="@firebase/messaging",fU="@firebase/messaging-compat",gU="@firebase/performance",pU="@firebase/performance-compat",mU="@firebase/remote-config",yU="@firebase/remote-config-compat",_U="@firebase/storage",vU="@firebase/storage-compat",xU="@firebase/firestore",wU="@firebase/ai",EU="@firebase/firestore-compat",TU="firebase",SU="12.6.0";const Jv="[DEFAULT]",IU={[Qv]:"fire-core",[Qz]:"fire-core-compat",[eU]:"fire-analytics",[Jz]:"fire-analytics-compat",[nU]:"fire-app-check",[tU]:"fire-app-check-compat",[iU]:"fire-auth",[rU]:"fire-auth-compat",[sU]:"fire-rtdb",[oU]:"fire-data-connect",[aU]:"fire-rtdb-compat",[lU]:"fire-fn",[cU]:"fire-fn-compat",[uU]:"fire-iid",[hU]:"fire-iid-compat",[dU]:"fire-fcm",[fU]:"fire-fcm-compat",[gU]:"fire-perf",[pU]:"fire-perf-compat",[mU]:"fire-rc",[yU]:"fire-rc-compat",[_U]:"fire-gcs",[vU]:"fire-gcs-compat",[xU]:"fire-fst",[EU]:"fire-fst-compat",[wU]:"fire-vertex","fire-js":"fire-js",[TU]:"fire-js-all"};const nm=new Map,CU=new Map,ex=new Map;function ZC(n,e){try{n.container.addComponent(e)}catch(t){Ys.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function El(n){const e=n.name;if(ex.has(e))return Ys.debug(`There were multiple attempts to register component ${e}.`),!1;ex.set(e,n);for(const t of nm.values())ZC(t,n);for(const t of CU.values())ZC(t,n);return!0}function ry(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Yi(n){return n==null?!1:n.settings!==void 0}const RU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qo=new vf("app","Firebase",RU);class bU{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ia("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qo.create("app-deleted",{appName:this._name})}}const Ml=SU;function fk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Jv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Qo.create("bad-app-name",{appName:String(r)});if(t||(t=rk()),!t)throw Qo.create("no-options");const s=nm.get(r);if(s){if(wl(t,s.options)&&wl(i,s.config))return s;throw Qo.create("duplicate-app",{appName:r})}const o=new Mz(r);for(const u of ex.values())o.addComponent(u);const l=new bU(t,i,o);return nm.set(r,l),l}function rw(n=Jv){const e=nm.get(n);if(!e&&n===Jv&&rk())return fk();if(!e)throw Qo.create("no-app",{appName:n});return e}function as(n,e,t){let i=IU[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ys.warn(o.join(" "));return}El(new ia(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const AU="firebase-heartbeat-database",PU=1,Ud="firebase-heartbeat-store";let Y_=null;function gk(){return Y_||(Y_=Kz(AU,PU,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ud)}catch(t){console.warn(t)}}}}).catch(n=>{throw Qo.create("idb-open",{originalErrorMessage:n.message})})),Y_}async function kU(n){try{const t=(await gk()).transaction(Ud),i=await t.objectStore(Ud).get(pk(n));return await t.done,i}catch(e){if(e instanceof gs)Ys.warn(e.message);else{const t=Qo.create("idb-get",{originalErrorMessage:e?.message});Ys.warn(t.message)}}}async function QC(n,e){try{const i=(await gk()).transaction(Ud,"readwrite");await i.objectStore(Ud).put(e,pk(n)),await i.done}catch(t){if(t instanceof gs)Ys.warn(t.message);else{const i=Qo.create("idb-set",{originalErrorMessage:t?.message});Ys.warn(i.message)}}}function pk(n){return`${n.name}!${n.options.appId}`}const NU=1024,DU=30;class MU{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new OU(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=JC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>DU){const r=jU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ys.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=JC(),{heartbeatsToSend:t,unsentEntries:i}=LU(this._heartbeatsCache.heartbeats),r=tm(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Ys.warn(e),""}}}function JC(){return new Date().toISOString().substring(0,10)}function LU(n,e=NU){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),eR(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),eR(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class OU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return uk()?Tz().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await kU(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return QC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return QC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function eR(n){return tm(JSON.stringify({version:2,heartbeats:n})).length}function jU(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function FU(n){El(new ia("platform-logger",e=>new Yz(e),"PRIVATE")),El(new ia("heartbeat",e=>new MU(e),"PRIVATE")),as(Qv,YC,n),as(Qv,YC,"esm2020"),as("fire-js","")}FU("");function mk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const VU=mk,yk=new vf("auth","Firebase",mk());const im=new nw("@firebase/auth");function zU(n,...e){im.logLevel<=Xe.WARN&&im.warn(`Auth (${Ml}): ${n}`,...e)}function mp(n,...e){im.logLevel<=Xe.ERROR&&im.error(`Auth (${Ml}): ${n}`,...e)}function cs(n,...e){throw ow(n,...e)}function Ir(n,...e){return ow(n,...e)}function sw(n,e,t){const i={...VU(),[e]:t};return new vf("auth","Firebase",i).create(e,{appName:n.name})}function ll(n){return sw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function UU(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&cs(n,"argument-error"),sw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ow(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return yk.create(n,...e)}function Ve(n,e,...t){if(!n)throw ow(e,...t)}function Vs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw mp(e),new Error(e)}function Zs(n,e){n||Vs(e)}function tx(){return typeof self<"u"&&self.location?.href||""}function BU(){return tR()==="http:"||tR()==="https:"}function tR(){return typeof self<"u"&&self.location?.protocol||null}function WU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(BU()||xz()||"connection"in navigator)?navigator.onLine:!0}function GU(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class wf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Zs(t>e,"Short delay should be less than long delay!"),this.isMobile=_z()||wz()}get(){return WU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function aw(n,e){Zs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class _k{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const $U={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const HU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],KU=new wf(3e4,6e4);function lw(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Fu(n,e,t,i,r={}){return vk(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=xf({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return vz()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(h.credentials="include"),_k.fetch()(await xk(n,n.config.apiHost,t,l),h)})}async function vk(n,e,t){n._canInitEmulator=!1;const i={...$U,...e};try{const r=new XU(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw ep(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw ep(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw ep(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw ep(n,"user-disabled",o);const f=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw sw(n,f,h);cs(n,f)}}catch(r){if(r instanceof gs)throw r;cs(n,"network-request-failed",{message:String(r)})}}async function qU(n,e,t,i,r={}){const s=await Fu(n,e,t,i,r);return"mfaPendingCredential"in s&&cs(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function xk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?aw(n.config,r):`${n.config.apiScheme}://${r}`;return HU.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class XU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ir(this.auth,"network-request-failed")),KU.get())})}}function ep(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Ir(n,e,i);return r.customData._tokenResponse=t,r}async function YU(n,e){return Fu(n,"POST","/v1/accounts:delete",e)}async function rm(n,e){return Fu(n,"POST","/v1/accounts:lookup",e)}function cd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ZU(n,e=!1){const t=no(n),i=await t.getIdToken(e),r=cw(i);Ve(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:cd(Z_(r.auth_time)),issuedAtTime:cd(Z_(r.iat)),expirationTime:cd(Z_(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Z_(n){return Number(n)*1e3}function cw(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return mp("JWT malformed, contained fewer than 3 sections"),null;try{const r=ek(t);return r?JSON.parse(r):(mp("Failed to decode base64 JWT payload"),null)}catch(r){return mp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function nR(n){const e=cw(n);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Bd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof gs&&QU(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function QU({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class JU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class nx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=cd(this.lastLoginAt),this.creationTime=cd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function sm(n){const e=n.auth,t=await n.getIdToken(),i=await Bd(n,rm(e,{idToken:t}));Ve(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?wk(r.providerUserInfo):[],o=tB(n.providerData,s),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new nx(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function eB(n){const e=no(n);await sm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function tB(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function wk(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function nB(n,e){const t=await vk(n,{},async()=>{const i=xf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await xk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:i};return n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(u.credentials="include"),_k.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function iB(n,e){return Fu(n,"POST","/v2/accounts:revokeToken",lw(n,e))}class eu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nR(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ve(e.length!==0,"internal-error");const t=nR(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await nB(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new eu;return i&&(Ve(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Ve(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Ve(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new eu,this.toJSON())}_performRefresh(){return Vs("not implemented")}}function Do(n,e){Ve(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class xr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new JU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new nx(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Bd(this,this.stsTokenManager.getToken(this.auth,e));return Ve(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return ZU(this,e)}reload(){return eB(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new xr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await sm(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Yi(this.auth.app))return Promise.reject(ll(this.auth));const e=await this.getIdToken();return await Bd(this,YU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:p,emailVerified:_,isAnonymous:x,providerData:S,stsTokenManager:I}=t;Ve(p&&I,e,"internal-error");const T=eu.fromJSON(this.name,I);Ve(typeof p=="string",e,"internal-error"),Do(i,e.name),Do(r,e.name),Ve(typeof _=="boolean",e,"internal-error"),Ve(typeof x=="boolean",e,"internal-error"),Do(s,e.name),Do(o,e.name),Do(l,e.name),Do(u,e.name),Do(h,e.name),Do(f,e.name);const b=new xr({uid:p,auth:e,email:r,emailVerified:_,displayName:i,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:T,createdAt:h,lastLoginAt:f});return S&&Array.isArray(S)&&(b.providerData=S.map(N=>({...N}))),u&&(b._redirectEventId=u),b}static async _fromIdTokenResponse(e,t,i=!1){const r=new eu;r.updateFromServerResponse(t);const s=new xr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await sm(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Ve(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?wk(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new eu;l.updateFromIdToken(i);const u=new xr({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new nx(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const iR=new Map;function zs(n){Zs(n instanceof Function,"Expected a class definition");let e=iR.get(n);return e?(Zs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,iR.set(n,e),e)}class Ek{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ek.type="NONE";const rR=Ek;function yp(n,e,t){return`firebase:${n}:${e}:${t}`}class tu{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=yp(this.userKey,r.apiKey,s),this.fullPersistenceKey=yp("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await rm(this.auth,{idToken:e}).catch(()=>{});return t?xr._fromGetAccountInfoResponse(this.auth,t,e):null}return xr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new tu(zs(rR),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||zs(rR);const o=yp(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let p;if(typeof f=="string"){const _=await rm(e,{idToken:f}).catch(()=>{});if(!_)break;p=await xr._fromGetAccountInfoResponse(e,_,f)}else p=xr._fromJSON(e,f);h!==s&&(l=p),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new tu(s,e,i):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new tu(s,e,i))}}function sR(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ck(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Tk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(bk(e))return"Blackberry";if(Ak(e))return"Webos";if(Sk(e))return"Safari";if((e.includes("chrome/")||Ik(e))&&!e.includes("edge/"))return"Chrome";if(Rk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Tk(n=nn()){return/firefox\//i.test(n)}function Sk(n=nn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ik(n=nn()){return/crios\//i.test(n)}function Ck(n=nn()){return/iemobile/i.test(n)}function Rk(n=nn()){return/android/i.test(n)}function bk(n=nn()){return/blackberry/i.test(n)}function Ak(n=nn()){return/webos/i.test(n)}function uw(n=nn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function rB(n=nn()){return uw(n)&&!!window.navigator?.standalone}function sB(){return Ez()&&document.documentMode===10}function Pk(n=nn()){return uw(n)||Rk(n)||Ak(n)||bk(n)||/windows phone/i.test(n)||Ck(n)}function kk(n,e=[]){let t;switch(n){case"Browser":t=sR(nn());break;case"Worker":t=`${sR(nn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ml}/${i}`}class oB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function aB(n,e={}){return Fu(n,"GET","/v2/passwordPolicy",lw(n,e))}const lB=6;class cB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??lB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class uB{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new oR(this),this.idTokenSubscription=new oR(this),this.beforeStateQueue=new oB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=zs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await tu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await rm(this,{idToken:e}),i=await xr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Yi(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await sm(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=GU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Yi(this.app))return Promise.reject(ll(this));const t=e?no(e):null;return t&&Ve(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Yi(this.app)?Promise.reject(ll(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Yi(this.app)?Promise.reject(ll(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aB(this),t=new cB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new vf("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await iB(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&zs(e)||this._popupRedirectResolver;Ve(t,this,"argument-error"),this.redirectPersistenceManager=await tu.create(this,[zs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ve(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Yi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&zU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function sy(n){return no(n)}class oR{constructor(e){this.auth=e,this.observer=null,this.addObserver=bz(t=>this.observer=t)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let hw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hB(n){hw=n}function dB(n){return hw.loadJS(n)}function fB(){return hw.gapiScript}function gB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function pB(n,e){const t=ry(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(wl(s,e??{}))return r;cs(r,"already-initialized")}return t.initialize({options:e})}function mB(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(zs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function yB(n,e,t){const i=sy(n);Ve(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=Nk(e),{host:o,port:l}=_B(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Ve(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ve(wl(h,i.config.emulator)&&wl(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Dl(o)?(ew(`${s}//${o}${u}`),tw("Auth",!0)):vB()}function Nk(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function _B(n){const e=Nk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:aR(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:aR(o)}}}function aR(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function vB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Dk{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Vs("not implemented")}_getIdTokenResponse(e){return Vs("not implemented")}_linkToIdToken(e,t){return Vs("not implemented")}_getReauthenticationResolver(e){return Vs("not implemented")}}async function nu(n,e){return qU(n,"POST","/v1/accounts:signInWithIdp",lw(n,e))}const xB="http://localhost";class Tl extends Dk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Tl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):cs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new Tl(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return nu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,nu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,nu(e,t)}buildRequest(){const e={requestUri:xB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=xf(t)}return e}}class dw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ef extends dw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Uo extends Ef{constructor(){super("facebook.com")}static credential(e){return Tl._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uo.PROVIDER_ID="facebook.com";class js extends Ef{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Tl._fromParams({providerId:js.PROVIDER_ID,signInMethod:js.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return js.credentialFromTaggedObject(e)}static credentialFromError(e){return js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return js.credential(t,i)}catch{return null}}}js.GOOGLE_SIGN_IN_METHOD="google.com";js.PROVIDER_ID="google.com";class Bo extends Ef{constructor(){super("github.com")}static credential(e){return Tl._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bo.credential(e.oauthAccessToken)}catch{return null}}}Bo.GITHUB_SIGN_IN_METHOD="github.com";Bo.PROVIDER_ID="github.com";class Wo extends Ef{constructor(){super("twitter.com")}static credential(e,t){return Tl._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Wo.credential(t,i)}catch{return null}}}Wo.TWITTER_SIGN_IN_METHOD="twitter.com";Wo.PROVIDER_ID="twitter.com";class yu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await xr._fromIdTokenResponse(e,i,r),o=lR(i);return new yu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=lR(i);return new yu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function lR(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class om extends gs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,om.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new om(e,t,i,r)}}function Mk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?om._fromErrorAndOperation(n,s,e,i):s})}async function wB(n,e,t=!1){const i=await Bd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return yu._forOperation(n,"link",i)}async function EB(n,e,t=!1){const{auth:i}=n;if(Yi(i.app))return Promise.reject(ll(i));const r="reauthenticate";try{const s=await Bd(n,Mk(i,r,e,n),t);Ve(s.idToken,i,"internal-error");const o=cw(s.idToken);Ve(o,i,"internal-error");const{sub:l}=o;return Ve(n.uid===l,i,"user-mismatch"),yu._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&cs(i,"user-mismatch"),s}}async function TB(n,e,t=!1){if(Yi(n.app))return Promise.reject(ll(n));const i="signIn",r=await Mk(n,i,e),s=await yu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function SB(n,e,t,i){return no(n).onIdTokenChanged(e,t,i)}function IB(n,e,t){return no(n).beforeAuthStateChanged(e,t)}function CB(n,e,t,i){return no(n).onAuthStateChanged(e,t,i)}function RB(n){return no(n).signOut()}const am="__sak";class Lk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(am,"1"),this.storage.removeItem(am),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const bB=1e3,AB=10;class Ok extends Lk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Pk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);sB()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,AB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},bB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ok.type="LOCAL";const PB=Ok;class jk extends Lk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}jk.type="SESSION";const Fk=jk;function kB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class oy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new oy(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),u=await kB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}oy.receivers=[];function fw(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class NB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=fw("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(p){const _=p;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(_.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function ls(){return window}function DB(n){ls().location.href=n}function Vk(){return typeof ls().WorkerGlobalScope<"u"&&typeof ls().importScripts=="function"}async function MB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function LB(){return navigator?.serviceWorker?.controller||null}function OB(){return Vk()?self:null}const zk="firebaseLocalStorageDb",jB=1,lm="firebaseLocalStorage",Uk="fbase_key";class Tf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ay(n,e){return n.transaction([lm],e?"readwrite":"readonly").objectStore(lm)}function FB(){const n=indexedDB.deleteDatabase(zk);return new Tf(n).toPromise()}function ix(){const n=indexedDB.open(zk,jB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(lm,{keyPath:Uk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(lm)?e(i):(i.close(),await FB(),e(await ix()))})})}async function cR(n,e,t){const i=ay(n,!0).put({[Uk]:e,value:t});return new Tf(i).toPromise()}async function VB(n,e){const t=ay(n,!1).get(e),i=await new Tf(t).toPromise();return i===void 0?null:i.value}function uR(n,e){const t=ay(n,!0).delete(e);return new Tf(t).toPromise()}const zB=800,UB=3;class Bk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ix(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>UB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Vk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=oy._getInstance(OB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await MB(),!this.activeServiceWorker)return;this.sender=new NB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||LB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ix();return await cR(e,am,"1"),await uR(e,am),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>cR(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>VB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>uR(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=ay(r,!1).getAll();return new Tf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),zB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Bk.type="LOCAL";const BB=Bk;new wf(3e4,6e4);function Wk(n,e){return e?zs(e):(Ve(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class gw extends Dk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return nu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return nu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return nu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function WB(n){return TB(n.auth,new gw(n),n.bypassAuthState)}function GB(n){const{auth:e,user:t}=n;return Ve(t,e,"internal-error"),EB(t,new gw(n),n.bypassAuthState)}async function $B(n){const{auth:e,user:t}=n;return Ve(t,e,"internal-error"),wB(t,new gw(n),n.bypassAuthState)}class Gk{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return WB;case"linkViaPopup":case"linkViaRedirect":return $B;case"reauthViaPopup":case"reauthViaRedirect":return GB;default:cs(this.auth,"internal-error")}}resolve(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const HB=new wf(2e3,1e4);async function KB(n,e,t){if(Yi(n.app))return Promise.reject(Ir(n,"operation-not-supported-in-this-environment"));const i=sy(n);UU(n,e,dw);const r=Wk(i,t);return new nl(i,"signInViaPopup",e,r).executeNotNull()}class nl extends Gk{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,nl.currentPopupAction&&nl.currentPopupAction.cancel(),nl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ve(e,this.auth,"internal-error"),e}async onExecution(){Zs(this.filter.length===1,"Popup operations only handle one event");const e=fw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ir(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ir(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ir(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,HB.get())};e()}}nl.currentPopupAction=null;const qB="pendingRedirect",_p=new Map;class XB extends Gk{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=_p.get(this.auth._key());if(!e){try{const i=await YB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}_p.set(this.auth._key(),e)}return this.bypassAuthState||_p.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function YB(n,e){const t=JB(e),i=QB(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function ZB(n,e){_p.set(n._key(),e)}function QB(n){return zs(n._redirectPersistence)}function JB(n){return yp(qB,n.config.apiKey,n.name)}async function e8(n,e,t=!1){if(Yi(n.app))return Promise.reject(ll(n));const i=sy(n),r=Wk(i,e),o=await new XB(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const t8=600*1e3;class n8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!i8(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!$k(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ir(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=t8&&this.cachedEventUids.clear(),this.cachedEventUids.has(hR(e))}saveEventToCache(e){this.cachedEventUids.add(hR(e)),this.lastProcessedEventTime=Date.now()}}function hR(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function $k({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function i8(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $k(n);default:return!1}}async function r8(n,e={}){return Fu(n,"GET","/v1/projects",e)}const s8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,o8=/^https?/;async function a8(n){if(n.config.emulator)return;const{authorizedDomains:e}=await r8(n);for(const t of e)try{if(l8(t))return}catch{}cs(n,"unauthorized-domain")}function l8(n){const e=tx(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!o8.test(t))return!1;if(s8.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const c8=new wf(3e4,6e4);function dR(){const n=ls().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function u8(n){return new Promise((e,t)=>{function i(){dR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dR(),t(Ir(n,"network-request-failed"))},timeout:c8.get()})}if(ls().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ls().gapi?.load)i();else{const r=gB("iframefcb");return ls()[r]=()=>{gapi.load?i():t(Ir(n,"network-request-failed"))},dB(`${fB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw vp=null,e})}let vp=null;function h8(n){return vp=vp||u8(n),vp}const d8=new wf(5e3,15e3),f8="__/auth/iframe",g8="emulator/auth/iframe",p8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},m8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function y8(n){const e=n.config;Ve(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?aw(e,g8):`https://${n.config.authDomain}/${f8}`,i={apiKey:e.apiKey,appName:n.name,v:Ml},r=m8.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${xf(i).slice(1)}`}async function _8(n){const e=await h8(n),t=ls().gapi;return Ve(t,n,"internal-error"),e.open({where:document.body,url:y8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:p8,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Ir(n,"network-request-failed"),l=ls().setTimeout(()=>{s(o)},d8.get());function u(){ls().clearTimeout(l),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const v8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},x8=500,w8=600,E8="_blank",T8="http://localhost";class fR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function S8(n,e,t,i=x8,r=w8){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u={...v8,width:i.toString(),height:r.toString(),top:s,left:o},h=nn().toLowerCase();t&&(l=Ik(h)?E8:t),Tk(h)&&(e=e||T8,u.scrollbars="yes");const f=Object.entries(u).reduce((_,[x,S])=>`${_}${x}=${S},`,"");if(rB(h)&&l!=="_self")return I8(e||"",l),new fR(null);const p=window.open(e||"",l,f);Ve(p,n,"popup-blocked");try{p.focus()}catch{}return new fR(p)}function I8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const C8="__/auth/handler",R8="emulator/auth/handler",b8=encodeURIComponent("fac");async function gR(n,e,t,i,r,s){Ve(n.config.authDomain,n,"auth-domain-config-required"),Ve(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ml,eventId:r};if(e instanceof dw){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Rz(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof Ef){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),h=u?`#${b8}=${encodeURIComponent(u)}`:"";return`${A8(n)}?${xf(l).slice(1)}${h}`}function A8({config:n}){return n.emulator?aw(n,R8):`https://${n.authDomain}/${C8}`}const Q_="webStorageSupport";class P8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Fk,this._completeRedirectFn=e8,this._overrideRedirectResult=ZB}async _openPopup(e,t,i,r){Zs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await gR(e,t,i,tx(),r);return S8(e,s,fw())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await gR(e,t,i,tx(),r);return DB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Zs(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await _8(e),i=new n8(e);return t.register("authEvent",r=>(Ve(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Q_,{type:Q_},r=>{const s=r?.[0]?.[Q_];s!==void 0&&t(!!s),cs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=a8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Pk()||Sk()||uw()}}const k8=P8;var pR="@firebase/auth",mR="1.12.0";class N8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function D8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function M8(n){El(new ia("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Ve(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kk(n)},h=new uB(i,r,s,u);return mB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),El(new ia("auth-internal",e=>{const t=sy(e.getProvider("auth").getImmediate());return(i=>new N8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),as(pR,mR,D8(n)),as(pR,mR,"esm2020")}const L8=300,O8=sk("authIdTokenMaxAge")||L8;let yR=null;const j8=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>O8)return;const r=t?.token;yR!==r&&(yR=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function F8(n=rw()){const e=ry(n,"auth");if(e.isInitialized())return e.getImmediate();const t=pB(n,{popupRedirectResolver:k8,persistence:[BB,PB,Fk]}),i=sk("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=j8(s.toString());IB(t,o,()=>o(t.currentUser)),SB(t,l=>o(l))}}const r=nk("auth");return r&&yB(t,`http://${r}`),t}function V8(){return document.getElementsByTagName("head")?.[0]??document}hB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Ir("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",V8().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});M8("Browser");var z8="firebase",U8="12.7.0";as(z8,U8,"app");var _R=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var pw;(function(){var n;function e(P,C){function D(){}D.prototype=C.prototype,P.F=C.prototype,P.prototype=new D,P.prototype.constructor=P,P.D=function(F,V,B){for(var k=Array(arguments.length-2),te=2;te<arguments.length;te++)k[te-2]=arguments[te];return C.prototype[V].apply(F,k)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(P,C,D){D||(D=0);const F=Array(16);if(typeof C=="string")for(var V=0;V<16;++V)F[V]=C.charCodeAt(D++)|C.charCodeAt(D++)<<8|C.charCodeAt(D++)<<16|C.charCodeAt(D++)<<24;else for(V=0;V<16;++V)F[V]=C[D++]|C[D++]<<8|C[D++]<<16|C[D++]<<24;C=P.g[0],D=P.g[1],V=P.g[2];let B=P.g[3],k;k=C+(B^D&(V^B))+F[0]+3614090360&4294967295,C=D+(k<<7&4294967295|k>>>25),k=B+(V^C&(D^V))+F[1]+3905402710&4294967295,B=C+(k<<12&4294967295|k>>>20),k=V+(D^B&(C^D))+F[2]+606105819&4294967295,V=B+(k<<17&4294967295|k>>>15),k=D+(C^V&(B^C))+F[3]+3250441966&4294967295,D=V+(k<<22&4294967295|k>>>10),k=C+(B^D&(V^B))+F[4]+4118548399&4294967295,C=D+(k<<7&4294967295|k>>>25),k=B+(V^C&(D^V))+F[5]+1200080426&4294967295,B=C+(k<<12&4294967295|k>>>20),k=V+(D^B&(C^D))+F[6]+2821735955&4294967295,V=B+(k<<17&4294967295|k>>>15),k=D+(C^V&(B^C))+F[7]+4249261313&4294967295,D=V+(k<<22&4294967295|k>>>10),k=C+(B^D&(V^B))+F[8]+1770035416&4294967295,C=D+(k<<7&4294967295|k>>>25),k=B+(V^C&(D^V))+F[9]+2336552879&4294967295,B=C+(k<<12&4294967295|k>>>20),k=V+(D^B&(C^D))+F[10]+4294925233&4294967295,V=B+(k<<17&4294967295|k>>>15),k=D+(C^V&(B^C))+F[11]+2304563134&4294967295,D=V+(k<<22&4294967295|k>>>10),k=C+(B^D&(V^B))+F[12]+1804603682&4294967295,C=D+(k<<7&4294967295|k>>>25),k=B+(V^C&(D^V))+F[13]+4254626195&4294967295,B=C+(k<<12&4294967295|k>>>20),k=V+(D^B&(C^D))+F[14]+2792965006&4294967295,V=B+(k<<17&4294967295|k>>>15),k=D+(C^V&(B^C))+F[15]+1236535329&4294967295,D=V+(k<<22&4294967295|k>>>10),k=C+(V^B&(D^V))+F[1]+4129170786&4294967295,C=D+(k<<5&4294967295|k>>>27),k=B+(D^V&(C^D))+F[6]+3225465664&4294967295,B=C+(k<<9&4294967295|k>>>23),k=V+(C^D&(B^C))+F[11]+643717713&4294967295,V=B+(k<<14&4294967295|k>>>18),k=D+(B^C&(V^B))+F[0]+3921069994&4294967295,D=V+(k<<20&4294967295|k>>>12),k=C+(V^B&(D^V))+F[5]+3593408605&4294967295,C=D+(k<<5&4294967295|k>>>27),k=B+(D^V&(C^D))+F[10]+38016083&4294967295,B=C+(k<<9&4294967295|k>>>23),k=V+(C^D&(B^C))+F[15]+3634488961&4294967295,V=B+(k<<14&4294967295|k>>>18),k=D+(B^C&(V^B))+F[4]+3889429448&4294967295,D=V+(k<<20&4294967295|k>>>12),k=C+(V^B&(D^V))+F[9]+568446438&4294967295,C=D+(k<<5&4294967295|k>>>27),k=B+(D^V&(C^D))+F[14]+3275163606&4294967295,B=C+(k<<9&4294967295|k>>>23),k=V+(C^D&(B^C))+F[3]+4107603335&4294967295,V=B+(k<<14&4294967295|k>>>18),k=D+(B^C&(V^B))+F[8]+1163531501&4294967295,D=V+(k<<20&4294967295|k>>>12),k=C+(V^B&(D^V))+F[13]+2850285829&4294967295,C=D+(k<<5&4294967295|k>>>27),k=B+(D^V&(C^D))+F[2]+4243563512&4294967295,B=C+(k<<9&4294967295|k>>>23),k=V+(C^D&(B^C))+F[7]+1735328473&4294967295,V=B+(k<<14&4294967295|k>>>18),k=D+(B^C&(V^B))+F[12]+2368359562&4294967295,D=V+(k<<20&4294967295|k>>>12),k=C+(D^V^B)+F[5]+4294588738&4294967295,C=D+(k<<4&4294967295|k>>>28),k=B+(C^D^V)+F[8]+2272392833&4294967295,B=C+(k<<11&4294967295|k>>>21),k=V+(B^C^D)+F[11]+1839030562&4294967295,V=B+(k<<16&4294967295|k>>>16),k=D+(V^B^C)+F[14]+4259657740&4294967295,D=V+(k<<23&4294967295|k>>>9),k=C+(D^V^B)+F[1]+2763975236&4294967295,C=D+(k<<4&4294967295|k>>>28),k=B+(C^D^V)+F[4]+1272893353&4294967295,B=C+(k<<11&4294967295|k>>>21),k=V+(B^C^D)+F[7]+4139469664&4294967295,V=B+(k<<16&4294967295|k>>>16),k=D+(V^B^C)+F[10]+3200236656&4294967295,D=V+(k<<23&4294967295|k>>>9),k=C+(D^V^B)+F[13]+681279174&4294967295,C=D+(k<<4&4294967295|k>>>28),k=B+(C^D^V)+F[0]+3936430074&4294967295,B=C+(k<<11&4294967295|k>>>21),k=V+(B^C^D)+F[3]+3572445317&4294967295,V=B+(k<<16&4294967295|k>>>16),k=D+(V^B^C)+F[6]+76029189&4294967295,D=V+(k<<23&4294967295|k>>>9),k=C+(D^V^B)+F[9]+3654602809&4294967295,C=D+(k<<4&4294967295|k>>>28),k=B+(C^D^V)+F[12]+3873151461&4294967295,B=C+(k<<11&4294967295|k>>>21),k=V+(B^C^D)+F[15]+530742520&4294967295,V=B+(k<<16&4294967295|k>>>16),k=D+(V^B^C)+F[2]+3299628645&4294967295,D=V+(k<<23&4294967295|k>>>9),k=C+(V^(D|~B))+F[0]+4096336452&4294967295,C=D+(k<<6&4294967295|k>>>26),k=B+(D^(C|~V))+F[7]+1126891415&4294967295,B=C+(k<<10&4294967295|k>>>22),k=V+(C^(B|~D))+F[14]+2878612391&4294967295,V=B+(k<<15&4294967295|k>>>17),k=D+(B^(V|~C))+F[5]+4237533241&4294967295,D=V+(k<<21&4294967295|k>>>11),k=C+(V^(D|~B))+F[12]+1700485571&4294967295,C=D+(k<<6&4294967295|k>>>26),k=B+(D^(C|~V))+F[3]+2399980690&4294967295,B=C+(k<<10&4294967295|k>>>22),k=V+(C^(B|~D))+F[10]+4293915773&4294967295,V=B+(k<<15&4294967295|k>>>17),k=D+(B^(V|~C))+F[1]+2240044497&4294967295,D=V+(k<<21&4294967295|k>>>11),k=C+(V^(D|~B))+F[8]+1873313359&4294967295,C=D+(k<<6&4294967295|k>>>26),k=B+(D^(C|~V))+F[15]+4264355552&4294967295,B=C+(k<<10&4294967295|k>>>22),k=V+(C^(B|~D))+F[6]+2734768916&4294967295,V=B+(k<<15&4294967295|k>>>17),k=D+(B^(V|~C))+F[13]+1309151649&4294967295,D=V+(k<<21&4294967295|k>>>11),k=C+(V^(D|~B))+F[4]+4149444226&4294967295,C=D+(k<<6&4294967295|k>>>26),k=B+(D^(C|~V))+F[11]+3174756917&4294967295,B=C+(k<<10&4294967295|k>>>22),k=V+(C^(B|~D))+F[2]+718787259&4294967295,V=B+(k<<15&4294967295|k>>>17),k=D+(B^(V|~C))+F[9]+3951481745&4294967295,P.g[0]=P.g[0]+C&4294967295,P.g[1]=P.g[1]+(V+(k<<21&4294967295|k>>>11))&4294967295,P.g[2]=P.g[2]+V&4294967295,P.g[3]=P.g[3]+B&4294967295}i.prototype.v=function(P,C){C===void 0&&(C=P.length);const D=C-this.blockSize,F=this.C;let V=this.h,B=0;for(;B<C;){if(V==0)for(;B<=D;)r(this,P,B),B+=this.blockSize;if(typeof P=="string"){for(;B<C;)if(F[V++]=P.charCodeAt(B++),V==this.blockSize){r(this,F),V=0;break}}else for(;B<C;)if(F[V++]=P[B++],V==this.blockSize){r(this,F),V=0;break}}this.h=V,this.o+=C},i.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var C=1;C<P.length-8;++C)P[C]=0;C=this.o*8;for(var D=P.length-8;D<P.length;++D)P[D]=C&255,C/=256;for(this.v(P),P=Array(16),C=0,D=0;D<4;++D)for(let F=0;F<32;F+=8)P[C++]=this.g[D]>>>F&255;return P};function s(P,C){var D=l;return Object.prototype.hasOwnProperty.call(D,P)?D[P]:D[P]=C(P)}function o(P,C){this.h=C;const D=[];let F=!0;for(let V=P.length-1;V>=0;V--){const B=P[V]|0;F&&B==C||(D[V]=B,F=!1)}this.g=D}var l={};function u(P){return-128<=P&&P<128?s(P,function(C){return new o([C|0],C<0?-1:0)}):new o([P|0],P<0?-1:0)}function h(P){if(isNaN(P)||!isFinite(P))return p;if(P<0)return T(h(-P));const C=[];let D=1;for(let F=0;P>=D;F++)C[F]=P/D|0,D*=4294967296;return new o(C,0)}function f(P,C){if(P.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(P.charAt(0)=="-")return T(f(P.substring(1),C));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=h(Math.pow(C,8));let F=p;for(let B=0;B<P.length;B+=8){var V=Math.min(8,P.length-B);const k=parseInt(P.substring(B,B+V),C);V<8?(V=h(Math.pow(C,V)),F=F.j(V).add(h(k))):(F=F.j(D),F=F.add(h(k)))}return F}var p=u(0),_=u(1),x=u(16777216);n=o.prototype,n.m=function(){if(I(this))return-T(this).m();let P=0,C=1;for(let D=0;D<this.g.length;D++){const F=this.i(D);P+=(F>=0?F:4294967296+F)*C,C*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(S(this))return"0";if(I(this))return"-"+T(this).toString(P);const C=h(Math.pow(P,6));var D=this;let F="";for(;;){const V=L(D,C).g;D=b(D,V.j(C));let B=((D.g.length>0?D.g[0]:D.h)>>>0).toString(P);if(D=V,S(D))return B+F;for(;B.length<6;)B="0"+B;F=B+F}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function S(P){if(P.h!=0)return!1;for(let C=0;C<P.g.length;C++)if(P.g[C]!=0)return!1;return!0}function I(P){return P.h==-1}n.l=function(P){return P=b(this,P),I(P)?-1:S(P)?0:1};function T(P){const C=P.g.length,D=[];for(let F=0;F<C;F++)D[F]=~P.g[F];return new o(D,~P.h).add(_)}n.abs=function(){return I(this)?T(this):this},n.add=function(P){const C=Math.max(this.g.length,P.g.length),D=[];let F=0;for(let V=0;V<=C;V++){let B=F+(this.i(V)&65535)+(P.i(V)&65535),k=(B>>>16)+(this.i(V)>>>16)+(P.i(V)>>>16);F=k>>>16,B&=65535,k&=65535,D[V]=k<<16|B}return new o(D,D[D.length-1]&-2147483648?-1:0)};function b(P,C){return P.add(T(C))}n.j=function(P){if(S(this)||S(P))return p;if(I(this))return I(P)?T(this).j(T(P)):T(T(this).j(P));if(I(P))return T(this.j(T(P)));if(this.l(x)<0&&P.l(x)<0)return h(this.m()*P.m());const C=this.g.length+P.g.length,D=[];for(var F=0;F<2*C;F++)D[F]=0;for(F=0;F<this.g.length;F++)for(let V=0;V<P.g.length;V++){const B=this.i(F)>>>16,k=this.i(F)&65535,te=P.i(V)>>>16,de=P.i(V)&65535;D[2*F+2*V]+=k*de,N(D,2*F+2*V),D[2*F+2*V+1]+=B*de,N(D,2*F+2*V+1),D[2*F+2*V+1]+=k*te,N(D,2*F+2*V+1),D[2*F+2*V+2]+=B*te,N(D,2*F+2*V+2)}for(P=0;P<C;P++)D[P]=D[2*P+1]<<16|D[2*P];for(P=C;P<2*C;P++)D[P]=0;return new o(D,0)};function N(P,C){for(;(P[C]&65535)!=P[C];)P[C+1]+=P[C]>>>16,P[C]&=65535,C++}function M(P,C){this.g=P,this.h=C}function L(P,C){if(S(C))throw Error("division by zero");if(S(P))return new M(p,p);if(I(P))return C=L(T(P),C),new M(T(C.g),T(C.h));if(I(C))return C=L(P,T(C)),new M(T(C.g),C.h);if(P.g.length>30){if(I(P)||I(C))throw Error("slowDivide_ only works with positive integers.");for(var D=_,F=C;F.l(P)<=0;)D=O(D),F=O(F);var V=U(D,1),B=U(F,1);for(F=U(F,2),D=U(D,2);!S(F);){var k=B.add(F);k.l(P)<=0&&(V=V.add(D),B=k),F=U(F,1),D=U(D,1)}return C=b(P,V.j(C)),new M(V,C)}for(V=p;P.l(C)>=0;){for(D=Math.max(1,Math.floor(P.m()/C.m())),F=Math.ceil(Math.log(D)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),B=h(D),k=B.j(C);I(k)||k.l(P)>0;)D-=F,B=h(D),k=B.j(C);S(B)&&(B=_),V=V.add(B),P=b(P,k)}return new M(V,P)}n.B=function(P){return L(this,P).h},n.and=function(P){const C=Math.max(this.g.length,P.g.length),D=[];for(let F=0;F<C;F++)D[F]=this.i(F)&P.i(F);return new o(D,this.h&P.h)},n.or=function(P){const C=Math.max(this.g.length,P.g.length),D=[];for(let F=0;F<C;F++)D[F]=this.i(F)|P.i(F);return new o(D,this.h|P.h)},n.xor=function(P){const C=Math.max(this.g.length,P.g.length),D=[];for(let F=0;F<C;F++)D[F]=this.i(F)^P.i(F);return new o(D,this.h^P.h)};function O(P){const C=P.g.length+1,D=[];for(let F=0;F<C;F++)D[F]=P.i(F)<<1|P.i(F-1)>>>31;return new o(D,P.h)}function U(P,C){const D=C>>5;C%=32;const F=P.g.length-D,V=[];for(let B=0;B<F;B++)V[B]=C>0?P.i(B+D)>>>C|P.i(B+D+1)<<32-C:P.i(B+D);return new o(V,P.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,pw=o}).apply(typeof _R<"u"?_R:typeof self<"u"?self:typeof window<"u"?window:{});var tp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Hk,ed,Kk,xp,rx,qk,Xk,Yk;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof tp=="object"&&tp];for(var E=0;E<g.length;++E){var R=g[E];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var i=t(this);function r(g,E){if(E)e:{var R=i;g=g.split(".");for(var j=0;j<g.length-1;j++){var Y=g[j];if(!(Y in R))break e;R=R[Y]}g=g[g.length-1],j=R[g],E=E(j),E!=j&&E!=null&&e(R,g,{configurable:!0,writable:!0,value:E})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(E){var R=[],j;for(j in E)Object.prototype.hasOwnProperty.call(E,j)&&R.push([j,E[j]]);return R}});var s=s||{},o=this||self;function l(g){var E=typeof g;return E=="object"&&g!=null||E=="function"}function u(g,E,R){return g.call.apply(g.bind,arguments)}function h(g,E,R){return h=u,h.apply(null,arguments)}function f(g,E){var R=Array.prototype.slice.call(arguments,1);return function(){var j=R.slice();return j.push.apply(j,arguments),g.apply(this,j)}}function p(g,E){function R(){}R.prototype=E.prototype,g.Z=E.prototype,g.prototype=new R,g.prototype.constructor=g,g.Ob=function(j,Y,ee){for(var pe=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)pe[Ue-2]=arguments[Ue];return E.prototype[Y].apply(j,pe)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function x(g){const E=g.length;if(E>0){const R=Array(E);for(let j=0;j<E;j++)R[j]=g[j];return R}return[]}function S(g,E){for(let j=1;j<arguments.length;j++){const Y=arguments[j];var R=typeof Y;if(R=R!="object"?R:Y?Array.isArray(Y)?"array":R:"null",R=="array"||R=="object"&&typeof Y.length=="number"){R=g.length||0;const ee=Y.length||0;g.length=R+ee;for(let pe=0;pe<ee;pe++)g[R+pe]=Y[pe]}else g.push(Y)}}class I{constructor(E,R){this.i=E,this.j=R,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function T(g){o.setTimeout(()=>{throw g},0)}function b(){var g=P;let E=null;return g.g&&(E=g.g,g.g=g.g.next,g.g||(g.h=null),E.next=null),E}class N{constructor(){this.h=this.g=null}add(E,R){const j=M.get();j.set(E,R),this.h?this.h.next=j:this.g=j,this.h=j}}var M=new I(()=>new L,g=>g.reset());class L{constructor(){this.next=this.g=this.h=null}set(E,R){this.h=E,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let O,U=!1,P=new N,C=()=>{const g=Promise.resolve(void 0);O=()=>{g.then(D)}};function D(){for(var g;g=b();){try{g.h.call(g.g)}catch(R){T(R)}var E=M;E.j(g),E.h<100&&(E.h++,g.next=E.g,E.g=g)}U=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(g,E){this.type=g,this.g=this.target=E,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,E=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const R=()=>{};o.addEventListener("test",R,E),o.removeEventListener("test",R,E)}catch{}return g})();function k(g){return/^[\s\xa0]*$/.test(g)}function te(g,E){V.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,E)}p(te,V),te.prototype.init=function(g,E){const R=this.type=g.type,j=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=E,E=g.relatedTarget,E||(R=="mouseover"?E=g.fromElement:R=="mouseout"&&(E=g.toElement)),this.relatedTarget=E,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&te.Z.h.call(this)},te.prototype.h=function(){te.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var de="closure_listenable_"+(Math.random()*1e6|0),ge=0;function ue(g,E,R,j,Y){this.listener=g,this.proxy=null,this.src=E,this.type=R,this.capture=!!j,this.ha=Y,this.key=++ge,this.da=this.fa=!1}function G(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function ie(g,E,R){for(const j in g)E.call(R,g[j],j,g)}function ne(g,E){for(const R in g)E.call(void 0,g[R],R,g)}function W(g){const E={};for(const R in g)E[R]=g[R];return E}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function oe(g,E){let R,j;for(let Y=1;Y<arguments.length;Y++){j=arguments[Y];for(R in j)g[R]=j[R];for(let ee=0;ee<$.length;ee++)R=$[ee],Object.prototype.hasOwnProperty.call(j,R)&&(g[R]=j[R])}}function me(g){this.src=g,this.g={},this.h=0}me.prototype.add=function(g,E,R,j,Y){const ee=g.toString();g=this.g[ee],g||(g=this.g[ee]=[],this.h++);const pe=re(g,E,j,Y);return pe>-1?(E=g[pe],R||(E.fa=!1)):(E=new ue(E,this.src,ee,!!j,Y),E.fa=R,g.push(E)),E};function xe(g,E){const R=E.type;if(R in g.g){var j=g.g[R],Y=Array.prototype.indexOf.call(j,E,void 0),ee;(ee=Y>=0)&&Array.prototype.splice.call(j,Y,1),ee&&(G(E),g.g[R].length==0&&(delete g.g[R],g.h--))}}function re(g,E,R,j){for(let Y=0;Y<g.length;++Y){const ee=g[Y];if(!ee.da&&ee.listener==E&&ee.capture==!!R&&ee.ha==j)return Y}return-1}var _e="closure_lm_"+(Math.random()*1e6|0),we={};function Ce(g,E,R,j,Y){if(Array.isArray(E)){for(let ee=0;ee<E.length;ee++)Ce(g,E[ee],R,j,Y);return null}return R=Ni(R),g&&g[de]?g.J(E,R,l(j)?!!j.capture:!1,Y):Be(g,E,R,!1,j,Y)}function Be(g,E,R,j,Y,ee){if(!E)throw Error("Invalid event type");const pe=l(Y)?!!Y.capture:!!Y;let Ue=gn(g);if(Ue||(g[_e]=Ue=new me(g)),R=Ue.add(E,R,j,pe,ee),R.proxy)return R;if(j=Wt(),R.proxy=j,j.src=g,j.listener=R,g.addEventListener)B||(Y=pe),Y===void 0&&(Y=!1),g.addEventListener(E.toString(),j,Y);else if(g.attachEvent)g.attachEvent(bn(E.toString()),j);else if(g.addListener&&g.removeListener)g.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return R}function Wt(){function g(R){return E.call(g.src,g.listener,R)}const E=fn;return g}function Un(g,E,R,j,Y){if(Array.isArray(E))for(var ee=0;ee<E.length;ee++)Un(g,E[ee],R,j,Y);else j=l(j)?!!j.capture:!!j,R=Ni(R),g&&g[de]?(g=g.i,ee=String(E).toString(),ee in g.g&&(E=g.g[ee],R=re(E,R,j,Y),R>-1&&(G(E[R]),Array.prototype.splice.call(E,R,1),E.length==0&&(delete g.g[ee],g.h--)))):g&&(g=gn(g))&&(E=g.g[E.toString()],g=-1,E&&(g=re(E,R,j,Y)),(R=g>-1?E[g]:null)&&Yt(R))}function Yt(g){if(typeof g!="number"&&g&&!g.da){var E=g.src;if(E&&E[de])xe(E.i,g);else{var R=g.type,j=g.proxy;E.removeEventListener?E.removeEventListener(R,j,g.capture):E.detachEvent?E.detachEvent(bn(R),j):E.addListener&&E.removeListener&&E.removeListener(j),(R=gn(E))?(xe(R,g),R.h==0&&(R.src=null,E[_e]=null)):G(g)}}}function bn(g){return g in we?we[g]:we[g]="on"+g}function fn(g,E){if(g.da)g=!0;else{E=new te(E,this);const R=g.listener,j=g.ha||g.src;g.fa&&Yt(g),g=R.call(j,E)}return g}function gn(g){return g=g[_e],g instanceof me?g:null}var Yn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ni(g){return typeof g=="function"?g:(g[Yn]||(g[Yn]=function(E){return g.handleEvent(E)}),g[Yn])}function _t(){F.call(this),this.i=new me(this),this.M=this,this.G=null}p(_t,F),_t.prototype[de]=!0,_t.prototype.removeEventListener=function(g,E,R,j){Un(this,g,E,R,j)};function ut(g,E){var R,j=g.G;if(j)for(R=[];j;j=j.G)R.push(j);if(g=g.M,j=E.type||E,typeof E=="string")E=new V(E,g);else if(E instanceof V)E.target=E.target||g;else{var Y=E;E=new V(j,g),oe(E,Y)}Y=!0;let ee,pe;if(R)for(pe=R.length-1;pe>=0;pe--)ee=E.g=R[pe],Y=sn(ee,j,!0,E)&&Y;if(ee=E.g=g,Y=sn(ee,j,!0,E)&&Y,Y=sn(ee,j,!1,E)&&Y,R)for(pe=0;pe<R.length;pe++)ee=E.g=R[pe],Y=sn(ee,j,!1,E)&&Y}_t.prototype.N=function(){if(_t.Z.N.call(this),this.i){var g=this.i;for(const E in g.g){const R=g.g[E];for(let j=0;j<R.length;j++)G(R[j]);delete g.g[E],g.h--}}this.G=null},_t.prototype.J=function(g,E,R,j){return this.i.add(String(g),E,!1,R,j)},_t.prototype.K=function(g,E,R,j){return this.i.add(String(g),E,!0,R,j)};function sn(g,E,R,j){if(E=g.i.g[String(E)],!E)return!0;E=E.concat();let Y=!0;for(let ee=0;ee<E.length;++ee){const pe=E[ee];if(pe&&!pe.da&&pe.capture==R){const Ue=pe.listener,Vt=pe.ha||pe.src;pe.fa&&xe(g.i,pe),Y=Ue.call(Vt,j)!==!1&&Y}}return Y&&!j.defaultPrevented}function Di(g,E){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:o.setTimeout(g,E||0)}function It(g){g.g=Di(()=>{g.g=null,g.i&&(g.i=!1,It(g))},g.l);const E=g.h;g.h=null,g.m.apply(null,E)}class io extends F{constructor(E,R){super(),this.m=E,this.l=R,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mi(g){F.call(this),this.h=g,this.g={}}p(Mi,F);var Pr=[];function ir(g){ie(g.g,function(E,R){this.g.hasOwnProperty(R)&&Yt(E)},g),g.g={}}Mi.prototype.N=function(){Mi.Z.N.call(this),ir(this)},Mi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var kr=o.JSON.stringify,ua=o.JSON.parse,Nr=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function Li(){}function Ol(){}var Dr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ms(){V.call(this,"d")}p(ms,V);function ro(){V.call(this,"c")}p(ro,V);var Bn={},ys=null;function Mr(){return ys=ys||new _t}Bn.Ia="serverreachability";function Lr(g){V.call(this,Bn.Ia,g)}p(Lr,V);function Wn(g){const E=Mr();ut(E,new Lr(E))}Bn.STAT_EVENT="statevent";function Gn(g,E){V.call(this,Bn.STAT_EVENT,g),this.stat=E}p(Gn,V);function gt(g){const E=Mr();ut(E,new Gn(E,g))}Bn.Ja="timingevent";function so(g,E){V.call(this,Bn.Ja,g),this.size=E}p(so,V);function rr(g,E){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},E)}function jt(){this.g=!0}jt.prototype.ua=function(){this.g=!1};function Oi(g,E,R,j,Y,ee){g.info(function(){if(g.g)if(ee){var pe="",Ue=ee.split("&");for(let ht=0;ht<Ue.length;ht++){var Vt=Ue[ht].split("=");if(Vt.length>1){const $t=Vt[0];Vt=Vt[1];const xi=$t.split("_");pe=xi.length>=2&&xi[1]=="type"?pe+($t+"="+Vt+"&"):pe+($t+"=redacted&")}}}else pe=null;else pe=ee;return"XMLHTTP REQ ("+j+") [attempt "+Y+"]: "+E+`
`+R+`
`+pe})}function pn(g,E,R,j,Y,ee,pe){g.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+Y+"]: "+E+`
`+R+`
`+ee+" "+pe})}function Ft(g,E,R,j){g.info(function(){return"XMLHTTP TEXT ("+E+"): "+yn(g,R)+(j?" "+j:"")})}function mn(g,E){g.info(function(){return"TIMEOUT: "+E})}jt.prototype.info=function(){};function yn(g,E){if(!g.g)return E;if(!E)return null;try{const ee=JSON.parse(E);if(ee){for(g=0;g<ee.length;g++)if(Array.isArray(ee[g])){var R=ee[g];if(!(R.length<2)){var j=R[1];if(Array.isArray(j)&&!(j.length<1)){var Y=j[0];if(Y!="noop"&&Y!="stop"&&Y!="close")for(let pe=1;pe<j.length;pe++)j[pe]=""}}}}return kr(ee)}catch{return E}}var on={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ot={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Gt;function Zt(){}p(Zt,Li),Zt.prototype.g=function(){return new XMLHttpRequest},Gt=new Zt;function ji(g){return encodeURIComponent(String(g))}function jl(g){var E=1;g=g.split(":");const R=[];for(;E>0&&g.length;)R.push(g.shift()),E--;return g.length&&R.push(g.join(":")),R}function Fi(g,E,R,j){this.j=g,this.i=E,this.l=R,this.S=j||1,this.V=new Mi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Af}function Af(){this.i=null,this.g="",this.h=!1}var Pf={},Uu={};function sr(g,E,R){g.M=1,g.A=vs(Vi(E)),g.u=R,g.R=!0,Bu(g,null)}function Bu(g,E){g.F=Date.now(),ha(g),g.B=Vi(g.A);var R=g.B,j=g.S;Array.isArray(j)||(j=[String(j)]),Qu(R.i,"t",j),g.C=0,R=g.j.L,g.h=new Af,g.g=zf(g.j,R?E:null,!g.u),g.P>0&&(g.O=new io(h(g.Y,g,g.g),g.P)),E=g.V,R=g.g,j=g.ba;var Y="readystatechange";Array.isArray(Y)||(Y&&(Pr[0]=Y.toString()),Y=Pr);for(let ee=0;ee<Y.length;ee++){const pe=Ce(R,Y[ee],j||E.handleEvent,!1,E.h||E);if(!pe)break;E.g[pe.key]=pe}E=g.J?W(g.J):{},g.u?(g.v||(g.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,E)):(g.v="GET",g.g.ea(g.B,g.v,null,E)),Wn(),Oi(g.i,g.v,g.B,g.l,g.S,g.u)}Fi.prototype.ba=function(g){g=g.target;const E=this.O;E&&Br(g)==3?E.j():this.Y(g)},Fi.prototype.Y=function(g){try{if(g==this.g)e:{const Ue=Br(this.g),Vt=this.g.ya(),ht=this.g.ca();if(!(Ue<3)&&(Ue!=3||this.g&&(this.h.h||this.g.la()||Ff(this.g)))){this.K||Ue!=4||Vt==7||(Vt==8||ht<=0?Wn(3):Wn(2)),Fl(this);var E=this.g.ca();this.X=E;var R=kf(this);if(this.o=E==200,pn(this.i,this.v,this.B,this.l,this.S,Ue,E),this.o){if(this.U&&!this.L){t:{if(this.g){var j,Y=this.g;if((j=Y.g?Y.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(j)){var ee=j;break t}}ee=null}if(g=ee)Ft(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,xt(this,g);else{this.o=!1,this.m=3,gt(12),_s(this),da(this);break e}}if(this.R){g=!0;let $t;for(;!this.K&&this.C<R.length;)if($t=Df(this,R),$t==Uu){Ue==4&&(this.m=4,gt(14),g=!1),Ft(this.i,this.l,null,"[Incomplete Response]");break}else if($t==Pf){this.m=4,gt(15),Ft(this.i,this.l,R,"[Invalid Chunk]"),g=!1;break}else Ft(this.i,this.l,$t,null),xt(this,$t);if(Nf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ue!=4||R.length!=0||this.h.h||(this.m=1,gt(16),g=!1),this.o=this.o&&g,!g)Ft(this.i,this.l,R,"[Invalid Chunked Response]"),_s(this),da(this);else if(R.length>0&&!this.W){this.W=!0;var pe=this.j;pe.g==this&&pe.aa&&!pe.P&&(pe.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),wa(pe),pe.P=!0,gt(11))}}else Ft(this.i,this.l,R,null),xt(this,R);Ue==4&&_s(this),this.o&&!this.K&&(Ue==4?ql(this.j,this):(this.o=!1,ha(this)))}else eh(this.g),E==400&&R.indexOf("Unknown SID")>0?(this.m=3,gt(12)):(this.m=0,gt(13)),_s(this),da(this)}}}catch{}};function kf(g){if(!Nf(g))return g.g.la();const E=Ff(g.g);if(E==="")return"";let R="";const j=E.length,Y=Br(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return _s(g),da(g),"";g.h.i=new o.TextDecoder}for(let ee=0;ee<j;ee++)g.h.h=!0,R+=g.h.i.decode(E[ee],{stream:!(Y&&ee==j-1)});return E.length=0,g.h.g+=R,g.C=0,g.h.g}function Nf(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Df(g,E){var R=g.C,j=E.indexOf(`
`,R);return j==-1?Uu:(R=Number(E.substring(R,j)),isNaN(R)?Pf:(j+=1,j+R>E.length?Uu:(E=E.slice(j,j+R),g.C=j+R,E)))}Fi.prototype.cancel=function(){this.K=!0,_s(this)};function ha(g){g.T=Date.now()+g.H,Wu(g,g.H)}function Wu(g,E){if(g.D!=null)throw Error("WatchDog timer not null");g.D=rr(h(g.aa,g),E)}function Fl(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Fi.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(mn(this.i,this.B),this.M!=2&&(Wn(),gt(17)),_s(this),this.m=2,da(this)):Wu(this,this.T-g)};function da(g){g.j.I==0||g.K||ql(g.j,g)}function _s(g){Fl(g);var E=g.O;E&&typeof E.dispose=="function"&&E.dispose(),g.O=null,ir(g.V),g.g&&(E=g.g,g.g=null,E.abort(),E.dispose())}function xt(g,E){try{var R=g.j;if(R.I!=0&&(R.g==g||$u(R.h,g))){if(!g.L&&$u(R.h,g)&&R.I==3){try{var j=R.Ba.g.parse(E)}catch{j=null}if(Array.isArray(j)&&j.length==3){var Y=j;if(Y[0]==0){e:if(!R.v){if(R.g)if(R.g.F+3e3<g.F)Kl(R),_i(R);else break e;$r(R),gt(18)}}else R.xa=Y[1],0<R.xa-R.K&&Y[2]<37500&&R.F&&R.A==0&&!R.C&&(R.C=rr(h(R.Va,R),6e3));fa(R.h)<=1&&R.ta&&(R.ta=void 0)}else vi(R,11)}else if((g.L||R.g==g)&&Kl(R),!k(E))for(Y=R.Ba.g.parse(E),E=0;E<Y.length;E++){let ht=Y[E];const $t=ht[0];if(!($t<=R.K))if(R.K=$t,ht=ht[1],R.I==2)if(ht[0]=="c"){R.M=ht[1],R.ba=ht[2];const xi=ht[3];xi!=null&&(R.ka=xi,R.j.info("VER="+R.ka));const Ss=ht[4];Ss!=null&&(R.za=Ss,R.j.info("SVER="+R.za));const Hr=ht[5];Hr!=null&&typeof Hr=="number"&&Hr>0&&(j=1.5*Hr,R.O=j,R.j.info("backChannelRequestTimeoutMs_="+j)),j=R;const Kr=g.g;if(Kr){const Zl=Kr.g?Kr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zl){var ee=j.h;ee.g||Zl.indexOf("spdy")==-1&&Zl.indexOf("quic")==-1&&Zl.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(zl(ee,ee.h),ee.h=null))}if(j.G){const ih=Kr.g?Kr.g.getResponseHeader("X-HTTP-Session-Id"):null;ih&&(j.wa=ih,at(j.J,j.G,ih))}}R.I=3,R.l&&R.l.ra(),R.aa&&(R.T=Date.now()-g.F,R.j.info("Handshake RTT: "+R.T+"ms")),j=R;var pe=g;if(j.na=nh(j,j.L?j.ba:null,j.W),pe.L){ga(j.h,pe);var Ue=pe,Vt=j.O;Vt&&(Ue.H=Vt),Ue.D&&(Fl(Ue),ha(Ue)),j.g=pe}else An(j);R.i.length>0&&Ts(R)}else ht[0]!="stop"&&ht[0]!="close"||vi(R,7);else R.I==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?vi(R,7):$l(R):ht[0]!="noop"&&R.l&&R.l.qa(ht),R.A=0)}}Wn(4)}catch{}}var by=class{constructor(g,E){this.g=g,this.map=E}};function Vl(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Gu(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function fa(g){return g.h?1:g.g?g.g.size:0}function $u(g,E){return g.h?g.h==E:g.g?g.g.has(E):!1}function zl(g,E){g.g?g.g.add(E):g.h=E}function ga(g,E){g.h&&g.h==E?g.h=null:g.g&&g.g.has(E)&&g.g.delete(E)}Vl.prototype.cancel=function(){if(this.i=pi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function pi(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let E=g.i;for(const R of g.g.values())E=E.concat(R.G);return E}return x(g.i)}var Mf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mi(g,E){if(g){g=g.split("&");for(let R=0;R<g.length;R++){const j=g[R].indexOf("=");let Y,ee=null;j>=0?(Y=g[R].substring(0,j),ee=g[R].substring(j+1)):Y=g[R],E(Y,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Or(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;g instanceof Or?(this.l=g.l,pa(this,g.j),this.o=g.o,this.g=g.g,jr(this,g.u),this.h=g.h,oo(this,Ju(g.i)),this.m=g.m):g&&(E=String(g).match(Mf))?(this.l=!1,pa(this,E[1]||"",!0),this.o=ma(E[2]||""),this.g=ma(E[3]||"",!0),jr(this,E[4]),this.h=ma(E[5]||"",!0),oo(this,E[6]||"",!0),this.m=ma(E[7]||"")):(this.l=!1,this.i=new Ye(null,this.l))}Or.prototype.toString=function(){const g=[];var E=this.j;E&&g.push(ya(E,Ku,!0),":");var R=this.g;return(R||E=="file")&&(g.push("//"),(E=this.o)&&g.push(ya(E,Ku,!0),"@"),g.push(ji(R).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.u,R!=null&&g.push(":",String(R))),(R=this.h)&&(this.g&&R.charAt(0)!="/"&&g.push("/"),g.push(ya(R,R.charAt(0)=="/"?_a:qu,!0))),(R=this.i.toString())&&g.push("?",R),(R=this.m)&&g.push("#",ya(R,Xu)),g.join("")},Or.prototype.resolve=function(g){const E=Vi(this);let R=!!g.j;R?pa(E,g.j):R=!!g.o,R?E.o=g.o:R=!!g.g,R?E.g=g.g:R=g.u!=null;var j=g.h;if(R)jr(E,g.u);else if(R=!!g.h){if(j.charAt(0)!="/")if(this.g&&!this.h)j="/"+j;else{var Y=E.h.lastIndexOf("/");Y!=-1&&(j=E.h.slice(0,Y+1)+j)}if(Y=j,Y==".."||Y==".")j="";else if(Y.indexOf("./")!=-1||Y.indexOf("/.")!=-1){j=Y.lastIndexOf("/",0)==0,Y=Y.split("/");const ee=[];for(let pe=0;pe<Y.length;){const Ue=Y[pe++];Ue=="."?j&&pe==Y.length&&ee.push(""):Ue==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),j&&pe==Y.length&&ee.push("")):(ee.push(Ue),j=!0)}j=ee.join("/")}else j=Y}return R?E.h=j:R=g.i.toString()!=="",R?oo(E,Ju(g.i)):R=!!g.m,R&&(E.m=g.m),E};function Vi(g){return new Or(g)}function pa(g,E,R){g.j=R?ma(E,!0):E,g.j&&(g.j=g.j.replace(/:$/,""))}function jr(g,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);g.u=E}else g.u=null}function oo(g,E,R){E instanceof Ye?(g.i=E,Bl(g.i,g.l)):(R||(E=ya(E,Ay)),g.i=new Ye(E,g.l))}function at(g,E,R){g.i.set(E,R)}function vs(g){return at(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function ma(g,E){return g?E?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ya(g,E,R){return typeof g=="string"?(g=encodeURI(g).replace(E,Hu),R&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Hu(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Ku=/[#\/\?@]/g,qu=/[#\?:]/g,_a=/[#\?]/g,Ay=/[#\?@]/g,Xu=/#/g;function Ye(g,E){this.h=this.g=null,this.i=g||null,this.j=!!E}function Fr(g){g.g||(g.g=new Map,g.h=0,g.i&&mi(g.i,function(E,R){g.add(decodeURIComponent(E.replace(/\+/g," ")),R)}))}n=Ye.prototype,n.add=function(g,E){Fr(this),this.i=null,g=Vr(this,g);let R=this.g.get(g);return R||this.g.set(g,R=[]),R.push(E),this.h+=1,this};function Yu(g,E){Fr(g),E=Vr(g,E),g.g.has(E)&&(g.i=null,g.h-=g.g.get(E).length,g.g.delete(E))}function Ul(g,E){return Fr(g),E=Vr(g,E),g.g.has(E)}n.forEach=function(g,E){Fr(this),this.g.forEach(function(R,j){R.forEach(function(Y){g.call(E,Y,j,this)},this)},this)};function Zu(g,E){Fr(g);let R=[];if(typeof E=="string")Ul(g,E)&&(R=R.concat(g.g.get(Vr(g,E))));else for(g=Array.from(g.g.values()),E=0;E<g.length;E++)R=R.concat(g[E]);return R}n.set=function(g,E){return Fr(this),this.i=null,g=Vr(this,g),Ul(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[E]),this.h+=1,this},n.get=function(g,E){return g?(g=Zu(this,g),g.length>0?String(g[0]):E):E};function Qu(g,E,R){Yu(g,E),R.length>0&&(g.i=null,g.g.set(Vr(g,E),x(R)),g.h+=R.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],E=Array.from(this.g.keys());for(let j=0;j<E.length;j++){var R=E[j];const Y=ji(R);R=Zu(this,R);for(let ee=0;ee<R.length;ee++){let pe=Y;R[ee]!==""&&(pe+="="+ji(R[ee])),g.push(pe)}}return this.i=g.join("&")};function Ju(g){const E=new Ye;return E.i=g.i,g.g&&(E.g=new Map(g.g),E.h=g.h),E}function Vr(g,E){return E=String(E),g.j&&(E=E.toLowerCase()),E}function Bl(g,E){E&&!g.j&&(Fr(g),g.i=null,g.g.forEach(function(R,j){const Y=j.toLowerCase();j!=Y&&(Yu(this,j),Qu(this,Y,R))},g)),g.j=E}function zr(g,E){const R=new jt;if(o.Image){const j=new Image;j.onload=f(_n,R,"TestLoadImage: loaded",!0,E,j),j.onerror=f(_n,R,"TestLoadImage: error",!1,E,j),j.onabort=f(_n,R,"TestLoadImage: abort",!1,E,j),j.ontimeout=f(_n,R,"TestLoadImage: timeout",!1,E,j),o.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=g}else E(!1)}function Ur(g,E){const R=new jt,j=new AbortController,Y=setTimeout(()=>{j.abort(),_n(R,"TestPingServer: timeout",!1,E)},1e4);fetch(g,{signal:j.signal}).then(ee=>{clearTimeout(Y),ee.ok?_n(R,"TestPingServer: ok",!0,E):_n(R,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(Y),_n(R,"TestPingServer: error",!1,E)})}function _n(g,E,R,j,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),j(R)}catch{}}function va(){this.g=new Nr}function xs(g){this.i=g.Sb||null,this.h=g.ab||!1}p(xs,Li),xs.prototype.g=function(){return new yi(this.i,this.h)};function yi(g,E){_t.call(this),this.H=g,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(yi,_t),n=yi.prototype,n.open=function(g,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=E,this.readyState=1,or(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(E.body=g),(this.H||o).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,or(this)),this.g&&(this.readyState=3,or(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Lf(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Lf(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var E=g.value?g.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!g.done}))&&(this.response=this.responseText+=E)}g.done?ao(this):or(this),this.readyState==3&&Lf(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,ao(this))},n.Na=function(g){this.g&&(this.response=g,ao(this))},n.ga=function(){this.g&&ao(this)};function ao(g){g.readyState=4,g.l=null,g.j=null,g.B=null,or(g)}n.setRequestHeader=function(g,E){this.A.append(g,E)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],E=this.h.entries();for(var R=E.next();!R.done;)R=R.value,g.push(R[0]+": "+R[1]),R=E.next();return g.join(`\r
`)};function or(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(yi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Of(g){let E="";return ie(g,function(R,j){E+=j,E+=":",E+=R,E+=`\r
`}),E}function Wl(g,E,R){e:{for(j in R){var j=!1;break e}j=!0}j||(R=Of(R),typeof g=="string"?R!=null&&ji(R):at(g,E,R))}function mt(g){_t.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(mt,_t);var jf=/^https?$/i,Py=["POST","PUT"];n=mt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,E,R,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);E=E?E.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Gt.g(),this.g.onreadystatechange=_(h(this.Ca,this));try{this.B=!0,this.g.open(E,String(g),!0),this.B=!1}catch(ee){lo(this,ee);return}if(g=R||"",R=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var Y in j)R.set(Y,j[Y]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const ee of j.keys())R.set(ee,j.get(ee));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(R.keys()).find(ee=>ee.toLowerCase()=="content-type"),Y=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(Py,E,void 0)>=0)||j||Y||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,pe]of R)this.g.setRequestHeader(ee,pe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(ee){lo(this,ee)}};function lo(g,E){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=E,g.o=5,co(g),Es(g)}function co(g){g.A||(g.A=!0,ut(g,"complete"),ut(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ut(this,"complete"),ut(this,"abort"),Es(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Es(this,!0)),mt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ws(this):this.Xa())},n.Xa=function(){ws(this)};function ws(g){if(g.h&&typeof s<"u"){if(g.v&&Br(g)==4)setTimeout(g.Ca.bind(g),0);else if(ut(g,"readystatechange"),Br(g)==4){g.h=!1;try{const ee=g.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var R;if(!(R=E)){var j;if(j=ee===0){let pe=String(g.D).match(Mf)[1]||null;!pe&&o.self&&o.self.location&&(pe=o.self.location.protocol.slice(0,-1)),j=!jf.test(pe?pe.toLowerCase():"")}R=j}if(R)ut(g,"complete"),ut(g,"success");else{g.o=6;try{var Y=Br(g)>2?g.g.statusText:""}catch{Y=""}g.l=Y+" ["+g.ca()+"]",co(g)}}finally{Es(g)}}}}function Es(g,E){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const R=g.g;g.g=null,E||ut(g,"ready");try{R.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Br(g){return g.g?g.g.readyState:0}n.ca=function(){try{return Br(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var E=this.g.responseText;return g&&E.indexOf(g)==0&&(E=E.substring(g.length)),ua(E)}};function Ff(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function eh(g){const E={};g=(g.g&&Br(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<g.length;j++){if(k(g[j]))continue;var R=jl(g[j]);const Y=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const ee=E[Y]||[];E[Y]=ee,ee.push(R)}ne(E,function(j){return j.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Wr(g,E,R){return R&&R.internalChannelParams&&R.internalChannelParams[g]||E}function Gl(g){this.za=0,this.i=[],this.j=new jt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Wr("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Wr("baseRetryDelayMs",5e3,g),this.Za=Wr("retryDelaySeedMs",1e4,g),this.Ta=Wr("forwardChannelMaxRetries",2,g),this.va=Wr("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Vl(g&&g.concurrentRequestLimit),this.Ba=new va,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Gl.prototype,n.ka=8,n.I=1,n.connect=function(g,E,R,j){gt(0),this.W=g,this.H=E||{},R&&j!==void 0&&(this.H.OSID=R,this.H.OAID=j),this.F=this.X,this.J=nh(this,null,this.W),Ts(this)};function $l(g){if(Hl(g),g.I==3){var E=g.V++,R=Vi(g.J);if(at(R,"SID",g.M),at(R,"RID",E),at(R,"TYPE","terminate"),Gr(g,R),E=new Fi(g,g.j,E),E.M=2,E.A=vs(Vi(R)),R=!1,o.navigator&&o.navigator.sendBeacon)try{R=o.navigator.sendBeacon(E.A.toString(),"")}catch{}!R&&o.Image&&(new Image().src=E.A,R=!0),R||(E.g=zf(E.j,null),E.g.ea(E.A)),E.F=Date.now(),ha(E)}Ea(g)}function _i(g){g.g&&(wa(g),g.g.cancel(),g.g=null)}function Hl(g){_i(g),g.v&&(o.clearTimeout(g.v),g.v=null),Kl(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function Ts(g){if(!Gu(g.h)&&!g.m){g.m=!0;var E=g.Ea;O||C(),U||(O(),U=!0),P.add(E,g),g.D=0}}function Vf(g,E){return fa(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=E.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=rr(h(g.Ea,g,E),Xl(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const Y=new Fi(this,this.j,g);let ee=this.o;if(this.U&&(ee?(ee=W(ee),oe(ee,this.U)):ee=this.U),this.u!==null||this.R||(Y.J=ee,ee=null),this.S)e:{for(var E=0,R=0;R<this.i.length;R++){t:{var j=this.i[R];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(E+=j,E>4096){E=R;break e}if(E===4096||R===this.i.length-1){E=R+1;break e}}E=1e3}else E=1e3;E=th(this,Y,E),R=Vi(this.J),at(R,"RID",g),at(R,"CVER",22),this.G&&at(R,"X-HTTP-Session-Id",this.G),Gr(this,R),ee&&(this.R?E="headers="+ji(Of(ee))+"&"+E:this.u&&Wl(R,this.u,ee)),zl(this.h,Y),this.Ra&&at(R,"TYPE","init"),this.S?(at(R,"$req",E),at(R,"SID","null"),Y.U=!0,sr(Y,R,null)):sr(Y,R,E),this.I=2}}else this.I==3&&(g?xa(this,g):this.i.length==0||Gu(this.h)||xa(this))};function xa(g,E){var R;E?R=E.l:R=g.V++;const j=Vi(g.J);at(j,"SID",g.M),at(j,"RID",R),at(j,"AID",g.K),Gr(g,j),g.u&&g.o&&Wl(j,g.u,g.o),R=new Fi(g,g.j,R,g.D+1),g.u===null&&(R.J=g.o),E&&(g.i=E.G.concat(g.i)),E=th(g,R,1e3),R.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),zl(g.h,R),sr(R,j,E)}function Gr(g,E){g.H&&ie(g.H,function(R,j){at(E,j,R)}),g.l&&ie({},function(R,j){at(E,j,R)})}function th(g,E,R){R=Math.min(g.i.length,R);const j=g.l?h(g.l.Ka,g.l,g):null;e:{var Y=g.i;let Ue=-1;for(;;){const Vt=["count="+R];Ue==-1?R>0?(Ue=Y[0].g,Vt.push("ofs="+Ue)):Ue=0:Vt.push("ofs="+Ue);let ht=!0;for(let $t=0;$t<R;$t++){var ee=Y[$t].g;const xi=Y[$t].map;if(ee-=Ue,ee<0)Ue=Math.max(0,Y[$t].g-100),ht=!1;else try{ee="req"+ee+"_"||"";try{var pe=xi instanceof Map?xi:Object.entries(xi);for(const[Ss,Hr]of pe){let Kr=Hr;l(Hr)&&(Kr=kr(Hr)),Vt.push(ee+Ss+"="+encodeURIComponent(Kr))}}catch(Ss){throw Vt.push(ee+"type="+encodeURIComponent("_badmap")),Ss}}catch{j&&j(xi)}}if(ht){pe=Vt.join("&");break e}}pe=void 0}return g=g.i.splice(0,R),E.G=g,pe}function An(g){if(!g.g&&!g.v){g.Y=1;var E=g.Da;O||C(),U||(O(),U=!0),P.add(E,g),g.A=0}}function $r(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=rr(h(g.Da,g),Xl(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,uo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=rr(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,gt(10),_i(this),uo(this))};function wa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function uo(g){g.g=new Fi(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var E=Vi(g.na);at(E,"RID","rpc"),at(E,"SID",g.M),at(E,"AID",g.K),at(E,"CI",g.F?"0":"1"),!g.F&&g.ia&&at(E,"TO",g.ia),at(E,"TYPE","xmlhttp"),Gr(g,E),g.u&&g.o&&Wl(E,g.u,g.o),g.O&&(g.g.H=g.O);var R=g.g;g=g.ba,R.M=1,R.A=vs(Vi(E)),R.u=null,R.R=!0,Bu(R,g)}n.Va=function(){this.C!=null&&(this.C=null,_i(this),$r(this),gt(19))};function Kl(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function ql(g,E){var R=null;if(g.g==E){Kl(g),wa(g),g.g=null;var j=2}else if($u(g.h,E))R=E.G,ga(g.h,E),j=1;else return;if(g.I!=0){if(E.o)if(j==1){R=E.u?E.u.length:0,E=Date.now()-E.F;var Y=g.D;j=Mr(),ut(j,new so(j,R)),Ts(g)}else An(g);else if(Y=E.m,Y==3||Y==0&&E.X>0||!(j==1&&Vf(g,E)||j==2&&$r(g)))switch(R&&R.length>0&&(E=g.h,E.i=E.i.concat(R)),Y){case 1:vi(g,5);break;case 4:vi(g,10);break;case 3:vi(g,6);break;default:vi(g,2)}}}function Xl(g,E){let R=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(R*=2),R*E}function vi(g,E){if(g.j.info("Error code "+E),E==2){var R=h(g.bb,g),j=g.Ua;const Y=!j;j=new Or(j||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||pa(j,"https"),vs(j),Y?zr(j.toString(),R):Ur(j.toString(),R)}else gt(2);g.I=0,g.l&&g.l.pa(E),Ea(g),Hl(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Ea(g){if(g.I=0,g.ja=[],g.l){const E=pi(g.h);(E.length!=0||g.i.length!=0)&&(S(g.ja,E),S(g.ja,g.i),g.h.i.length=0,x(g.i),g.i.length=0),g.l.oa()}}function nh(g,E,R){var j=R instanceof Or?Vi(R):new Or(R);if(j.g!="")E&&(j.g=E+"."+j.g),jr(j,j.u);else{var Y=o.location;j=Y.protocol,E=E?E+"."+Y.hostname:Y.hostname,Y=+Y.port;const ee=new Or(null);j&&pa(ee,j),E&&(ee.g=E),Y&&jr(ee,Y),R&&(ee.h=R),j=ee}return R=g.G,E=g.wa,R&&E&&at(j,R,E),at(j,"VER",g.ka),Gr(g,j),j}function zf(g,E,R){if(E&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=g.Aa&&!g.ma?new mt(new xs({ab:R})):new mt(g.ma),E.Fa(g.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Uf(){}n=Uf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Yl(){}Yl.prototype.g=function(g,E){return new vn(g,E)};function vn(g,E){_t.call(this),this.g=new Gl(E),this.l=g,this.h=E&&E.messageUrlParams||null,g=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(g?g["X-WebChannel-Content-Type"]=E.messageContentType:g={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(g?g["X-WebChannel-Client-Profile"]=E.sa:g={"X-WebChannel-Client-Profile":E.sa}),this.g.U=g,(g=E&&E.Qb)&&!k(g)&&(this.g.u=g),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!k(E)&&(this.g.G=E,g=this.h,g!==null&&E in g&&(g=this.h,E in g&&delete g[E])),this.j=new ho(this)}p(vn,_t),vn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){$l(this.g)},vn.prototype.o=function(g){var E=this.g;if(typeof g=="string"){var R={};R.__data__=g,g=R}else this.v&&(R={},R.__data__=kr(g),g=R);E.i.push(new by(E.Ya++,g)),E.I==3&&Ts(E)},vn.prototype.N=function(){this.g.l=null,delete this.j,$l(this.g),delete this.g,vn.Z.N.call(this)};function Bf(g){ms.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var E=g.__sm__;if(E){e:{for(const R in E){g=R;break e}g=void 0}(this.i=g)&&(g=this.i,E=E!==null&&g in E?E[g]:void 0),this.data=E}else this.data=g}p(Bf,ms);function Wf(){ro.call(this),this.status=1}p(Wf,ro);function ho(g){this.g=g}p(ho,Uf),ho.prototype.ra=function(){ut(this.g,"a")},ho.prototype.qa=function(g){ut(this.g,new Bf(g))},ho.prototype.pa=function(g){ut(this.g,new Wf)},ho.prototype.oa=function(){ut(this.g,"b")},Yl.prototype.createWebChannel=Yl.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,Yk=function(){return new Yl},Xk=function(){return Mr()},qk=Bn,rx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},on.NO_ERROR=0,on.TIMEOUT=8,on.HTTP_ERROR=6,xp=on,ot.COMPLETE="complete",Kk=ot,Ol.EventType=Dr,Dr.OPEN="a",Dr.CLOSE="b",Dr.ERROR="c",Dr.MESSAGE="d",_t.prototype.listen=_t.prototype.J,ed=Ol,mt.prototype.listenOnce=mt.prototype.K,mt.prototype.getLastError=mt.prototype.Ha,mt.prototype.getLastErrorCode=mt.prototype.ya,mt.prototype.getStatus=mt.prototype.ca,mt.prototype.getResponseJson=mt.prototype.La,mt.prototype.getResponseText=mt.prototype.la,mt.prototype.send=mt.prototype.ea,mt.prototype.setWithCredentials=mt.prototype.Fa,Hk=mt}).apply(typeof tp<"u"?tp:typeof self<"u"?self:typeof window<"u"?window:{});const vR="@firebase/firestore",xR="4.9.3";let Tn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Tn.UNAUTHENTICATED=new Tn(null),Tn.GOOGLE_CREDENTIALS=new Tn("google-credentials-uid"),Tn.FIRST_PARTY=new Tn("first-party-uid"),Tn.MOCK_USER=new Tn("mock-user");let Vu="12.7.0";const Sl=new nw("@firebase/firestore");function jc(){return Sl.logLevel}function ye(n,...e){if(Sl.logLevel<=Xe.DEBUG){const t=e.map(mw);Sl.debug(`Firestore (${Vu}): ${n}`,...t)}}function Ci(n,...e){if(Sl.logLevel<=Xe.ERROR){const t=e.map(mw);Sl.error(`Firestore (${Vu}): ${n}`,...t)}}function ly(n,...e){if(Sl.logLevel<=Xe.WARN){const t=e.map(mw);Sl.warn(`Firestore (${Vu}): ${n}`,...t)}}function mw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ne(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Zk(n,i,t)}function Zk(n,e,t){let i=`FIRESTORE (${Vu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ci(i),new Error(i)}function Oe(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||Zk(e,r,i)}function St(n,e){return n}const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class be extends gs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class cl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Qk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class B8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Tn.UNAUTHENTICATED)))}shutdown(){}}class W8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class G8{constructor(e){this.t=e,this.currentUser=Tn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Oe(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new cl;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new cl,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},l=u=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new cl)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Oe(typeof i.accessToken=="string",31837,{l:i}),new Qk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Oe(e===null||typeof e=="string",2055,{h:e}),new Tn(e)}}class $8{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Tn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class H8{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new $8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Tn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class K8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Yi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Oe(this.o===void 0,3512);const i=s=>{s.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ye("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new wR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Oe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new wR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function q8(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Jk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=q8(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function qe(n,e){return n<e?-1:n>e?1:0}function sx(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return J_(r)===J_(s)?qe(r,s):J_(r)?1:-1}return qe(n.length,e.length)}const X8=55296,Y8=57343;function J_(n){const e=n.charCodeAt(0);return e>=X8&&e<=Y8}function _u(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function eN(n){return n+"\0"}const ER="__name__";class Qr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ne(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ne(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Qr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Qr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return qe(e.length,t.length)}static compareSegments(e,t){const i=Qr.isNumericId(e),r=Qr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Qr.extractNumericId(e).compare(Qr.extractNumericId(t)):sx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return pw.fromString(e.substring(4,e.length-2))}}class Rt extends Qr{construct(e,t,i){return new Rt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new be(ce.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Rt(t)}static emptyPath(){return new Rt([])}}const Z8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bt extends Qr{construct(e,t,i){return new Bt(e,t,i)}static isValidIdentifier(e){return Z8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ER}static keyField(){return new Bt([ER])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new be(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new be(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new be(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new be(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bt(t)}static emptyPath(){return new Bt([])}}class Ie{constructor(e){this.path=e}static fromPath(e){return new Ie(Rt.fromString(e))}static fromName(e){return new Ie(Rt.fromString(e).popFirst(5))}static empty(){return new Ie(Rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Rt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ie(new Rt(e.slice()))}}function Q8(n,e,t,i){if(e===!0&&i===!0)throw new be(ce.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function J8(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function e7(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ne(12329,{type:typeof n})}function tN(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new be(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=e7(n);throw new be(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Xt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Sf(n,e){if(!J8(n))throw new be(ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new be(ce.INVALID_ARGUMENT,t);return!0}const TR=-62135596800,SR=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*SR);return new kt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new be(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new be(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<TR)throw new be(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new be(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/SR}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Sf(e,kt._jsonSchema))return new kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-TR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}kt._jsonSchemaVersion="firestore/timestamp/1.0",kt._jsonSchema={type:Xt("string",kt._jsonSchemaVersion),seconds:Xt("number"),nanoseconds:Xt("number")};class et{static fromTimestamp(e){return new et(e)}static min(){return new et(new kt(0,0))}static max(){return new et(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Wd=-1;class cm{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function ox(n){return n.fields.find((e=>e.kind===2))}function Ga(n){return n.fields.filter((e=>e.kind!==2))}cm.UNKNOWN_ID=-1;class wp{constructor(e,t){this.fieldPath=e,this.kind=t}}class Gd{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Gd(0,ki.min())}}function t7(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=et.fromTimestamp(i===1e9?new kt(t+1,0):new kt(t,i));return new ki(r,Ie.empty(),e)}function nN(n){return new ki(n.readTime,n.key,Wd)}class ki{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ki(et.min(),Ie.empty(),Wd)}static max(){return new ki(et.max(),Ie.empty(),Wd)}}function yw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ie.comparator(n.documentKey,e.documentKey),t!==0?t:qe(n.largestBatchId,e.largestBatchId))}const iN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function cy(n){if(n.code!==ce.FAILED_PRECONDITION||n.message!==iN)throw n;ye("LocalStore","Unexpectedly lost primary lease")}class Q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Q(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Q?t:Q.resolve(t)}catch(t){return Q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Q.reject(t)}static resolve(e){return new Q(((t,i)=>{t(e)}))}static reject(e){return new Q(((t,i)=>{i(e)}))}static waitFor(e){return new Q(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=Q.resolve(!1);for(const i of e)t=t.next((r=>r?Q.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Q(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new Q(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const Si="SimpleDb";class uy{static open(e,t,i,r){try{return new uy(t,e.transaction(r,i))}catch(s){throw new ud(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new cl,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ud(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=_w(i.target.error);this.S.reject(new ud(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ye(Si,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new i7(t)}}class Jo{static delete(e){return ye(Si,"Removing database:",e),Ka(tk().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!uk())return!1;if(Jo.F())return!0;const e=nn(),t=Jo.M(e),i=0<t&&t<10,r=sN(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Jo.M(nn())===12.2&&Ci("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ye(Si,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new ud(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new be(ce.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new be(ce.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new ud(e,o))},r.onupgradeneeded=s=>{ye(Si,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{ye(Si,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=uy.open(this.db,e,s?"readonly":"readwrite",i),u=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),Q.reject(h)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,h=u.name!=="FirebaseError"&&o<3;if(ye(Si,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function sN(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class n7{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ka(this.U.delete())}}class ud extends be{constructor(e,t){super(ce.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ll(n){return n.name==="IndexedDbTransactionError"}class i7{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ye(Si,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ye(Si,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ka(i)}add(e){return ye(Si,"ADD",this.store.name,e,e),Ka(this.store.add(e))}get(e){return Ka(this.store.get(e)).next((t=>(t===void 0&&(t=null),ye(Si,"GET",this.store.name,e,t),t)))}delete(e){return ye(Si,"DELETE",this.store.name,e),Ka(this.store.delete(e))}count(){return ye(Si,"COUNT",this.store.name),Ka(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Q(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Q(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){ye(Si,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Q(((i,r)=>{t.onerror=s=>{const o=_w(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Q(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new n7(l),h=t(l.primaryKey,l.value,u);if(h instanceof Q){const f=h.catch((p=>(u.done(),Q.reject(p))));i.push(f)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}})).next((()=>Q.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ka(n){return new Q(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=_w(i.target.error);t(r)}}))}let IR=!1;function _w(n){const e=Jo.M(nn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new be("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return IR||(IR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const hd="IndexBackfiller";class r7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ye(hd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ye(hd,`Documents written: ${t}`)}catch(t){Ll(t)?ye(hd,"Ignoring IndexedDB error during index backfill: ",t):await cy(t)}await this.re(6e4)}))}}class s7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Q.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return ye(hd,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(ye(hd,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=nN(s);yw(o,i)>0&&(i=o)})),new ki(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class wr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}wr.ce=-1;const ul=-1;function hy(n){return n==null}function um(n){return n===0&&1/n==-1/0}const hm="";function Xn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=CR(e)),e=o7(n.get(t),e);return CR(e)}function o7(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case hm:t+="";break;default:t+=s}}return t}function CR(n){return n+hm+""}function ns(n){const e=n.length;if(Oe(e>=2,64408,{path:n}),e===2)return Oe(n.charAt(0)===hm&&n.charAt(1)==="",56145,{path:n}),Rt.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(hm,s);switch((o<0||o>t)&&Ne(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Ne(61167,{path:n})}s=o+2}return new Rt(i)}const $a="remoteDocuments",If="owner",Cc="owner",$d="mutationQueues",a7="userId",pr="mutations",RR="batchId",il="userMutationsIndex",bR=["userId","batchId"];function Ep(n,e){return[n,Xn(e)]}function oN(n,e,t){return[n,Xn(e),t]}const l7={},vu="documentMutations",dm="remoteDocumentsV14",c7=["prefixPath","collectionGroup","readTime","documentId"],Tp="documentKeyIndex",u7=["prefixPath","collectionGroup","documentId"],aN="collectionGroupIndex",h7=["collectionGroup","readTime","prefixPath","documentId"],Hd="remoteDocumentGlobal",ax="remoteDocumentGlobalKey",xu="targets",lN="queryTargetsIndex",d7=["canonicalId","targetId"],wu="targetDocuments",f7=["targetId","path"],vw="documentTargetsIndex",g7=["path","targetId"],fm="targetGlobalKey",hl="targetGlobal",Kd="collectionParents",p7=["collectionId","parent"],Eu="clientMetadata",m7="clientId",dy="bundles",y7="bundleId",fy="namedQueries",_7="name",xw="indexConfiguration",v7="indexId",lx="collectionGroupIndex",x7="collectionGroup",dd="indexState",w7=["indexId","uid"],cN="sequenceNumberIndex",E7=["uid","sequenceNumber"],fd="indexEntries",T7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],uN="documentKeyIndex",S7=["indexId","uid","orderedDocumentKey"],gy="documentOverlays",I7=["userId","collectionPath","documentId"],cx="collectionPathOverlayIndex",C7=["userId","collectionPath","largestBatchId"],hN="collectionGroupOverlayIndex",R7=["userId","collectionGroup","largestBatchId"],ww="globals",b7="name",dN=[$d,pr,vu,$a,xu,If,hl,wu,Eu,Hd,Kd,dy,fy],A7=[...dN,gy],fN=[$d,pr,vu,dm,xu,If,hl,wu,Eu,Hd,Kd,dy,fy,gy],gN=fN,Ew=[...gN,xw,dd,fd],P7=Ew,pN=[...Ew,ww],k7=pN;class ux extends rN{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function rn(n,e){const t=St(n);return Jo.O(t.le,e)}function AR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Tw(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function N7(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class di{constructor(e,t){this.comparator=e,this.root=t||Sn.EMPTY}insert(e,t){return new di(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Sn.BLACK,null,null))}remove(e){return new di(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new np(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new np(this.root,e,this.comparator,!1)}getReverseIterator(){return new np(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new np(this.root,e,this.comparator,!0)}}class np{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Sn{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Sn.RED,this.left=r??Sn.EMPTY,this.right=s??Sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new Sn(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Sn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ne(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ne(27949);return e+(this.isRed()?0:1)}}Sn.EMPTY=null,Sn.RED=!0,Sn.BLACK=!1;Sn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ne(57766)}get value(){throw Ne(16141)}get color(){throw Ne(16727)}get left(){throw Ne(29726)}get right(){throw Ne(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new Sn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class yt{constructor(e){this.comparator=e,this.data=new di(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new PR(this.data.getIterator())}getIteratorFrom(e){return new PR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof yt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new yt(this.comparator);return t.data=e,t}}class PR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Rc(n){return n.hasNext()?n.getNext():void 0}class Us{constructor(e){this.fields=e,e.sort(Bt.comparator)}static empty(){return new Us([])}unionWith(e){let t=new yt(Bt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Us(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _u(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class D7 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class fi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new D7("Invalid base64 string: "+s):s}})(e);return new fi(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new fi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fi.EMPTY_BYTE_STRING=new fi("");const M7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ra(n){if(Oe(!!n,39018),typeof n=="string"){let e=0;const t=M7.exec(n);if(Oe(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:qt(n.seconds),nanos:qt(n.nanos)}}function qt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Tu(n){return typeof n=="string"?fi.fromBase64String(n):fi.fromUint8Array(n)}const mN="server_timestamp",yN="__type__",_N="__previous_value__",vN="__local_write_time__";function Sw(n){return(n?.mapValue?.fields||{})[yN]?.stringValue===mN}function xN(n){const e=n.mapValue.fields[_N];return Sw(e)?xN(e):e}function gm(n){const e=ra(n.mapValue.fields[vN].timestampValue);return new kt(e.seconds,e.nanos)}class L7{constructor(e,t,i,r,s,o,l,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const pm="(default)";class Su{constructor(e,t){this.projectId=e,this.database=t||pm}static empty(){return new Su("","")}get isDefaultDatabase(){return this.database===pm}isEqual(e){return e instanceof Su&&e.projectId===this.projectId&&e.database===this.database}}const wN="__type__",EN="__max__",qo={mapValue:{fields:{__type__:{stringValue:EN}}}},TN="__vector__",mm="value",Sp={nullValue:"NULL_VALUE"};function Iu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Sw(n)?4:SN(n)?9007199254740991:py(n)?10:11:Ne(28295,{value:n})}function us(n,e){if(n===e)return!0;const t=Iu(n);if(t!==Iu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return gm(n).isEqual(gm(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ra(r.timestampValue),l=ra(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return Tu(r.bytesValue).isEqual(Tu(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return qt(r.geoPointValue.latitude)===qt(s.geoPointValue.latitude)&&qt(r.geoPointValue.longitude)===qt(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return qt(r.integerValue)===qt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=qt(r.doubleValue),l=qt(s.doubleValue);return o===l?um(o)===um(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return _u(n.arrayValue.values||[],e.arrayValue.values||[],us);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(AR(o)!==AR(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!us(o[u],l[u])))return!1;return!0})(n,e);default:return Ne(52216,{left:n})}}function qd(n,e){return(n.values||[]).find((t=>us(t,e)))!==void 0}function sa(n,e){if(n===e)return 0;const t=Iu(n),i=Iu(e);if(t!==i)return qe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return qe(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=qt(s.integerValue||s.doubleValue),u=qt(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return kR(n.timestampValue,e.timestampValue);case 4:return kR(gm(n),gm(e));case 5:return sx(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=Tu(s),u=Tu(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=qe(l[h],u[h]);if(f!==0)return f}return qe(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=qe(qt(s.latitude),qt(o.latitude));return l!==0?l:qe(qt(s.longitude),qt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return NR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[mm]?.arrayValue,f=u[mm]?.arrayValue,p=qe(h?.values?.length||0,f?.values?.length||0);return p!==0?p:NR(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===qo.mapValue&&o===qo.mapValue)return 0;if(s===qo.mapValue)return 1;if(o===qo.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const _=sx(u[p],f[p]);if(_!==0)return _;const x=sa(l[u[p]],h[f[p]]);if(x!==0)return x}return qe(u.length,f.length)})(n.mapValue,e.mapValue);default:throw Ne(23264,{he:t})}}function kR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return qe(n,e);const t=ra(n),i=ra(e),r=qe(t.seconds,i.seconds);return r!==0?r:qe(t.nanos,i.nanos)}function NR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=sa(t[r],i[r]);if(s)return s}return qe(t.length,i.length)}function Cu(n){return hx(n)}function hx(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ra(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Tu(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ie.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=hx(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${hx(t.fields[o])}`;return r+"}"})(n.mapValue):Ne(61005,{value:n})}function Iw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function dx(n){return!!n&&"integerValue"in n}function Xd(n){return!!n&&"arrayValue"in n}function DR(n){return!!n&&"nullValue"in n}function MR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ev(n){return!!n&&"mapValue"in n}function py(n){return(n?.mapValue?.fields||{})[wN]?.stringValue===TN}function gd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Tw(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=gd(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gd(n.arrayValue.values[t]);return e}return{...n}}function SN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===EN}const IN={mapValue:{fields:{[wN]:{stringValue:TN},[mm]:{arrayValue:{}}}}};function O7(n){return"nullValue"in n?Sp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Iw(Su.empty(),Ie.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?py(n)?IN:{mapValue:{}}:Ne(35942,{value:n})}function j7(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Iw(Su.empty(),Ie.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?IN:"mapValue"in n?py(n)?{mapValue:{}}:qo:Ne(61959,{value:n})}function LR(n,e){const t=sa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function OR(n,e){const t=sa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class vr{constructor(e){this.value=e}static empty(){return new vr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!ev(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gd(t)}setAll(e){let t=Bt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=gd(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());ev(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return us(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];ev(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Tw(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new vr(gd(this.value))}}class In{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new In(e,0,et.min(),et.min(),et.min(),vr.empty(),0)}static newFoundDocument(e,t,i,r){return new In(e,1,t,et.min(),i,r,0)}static newNoDocument(e,t){return new In(e,2,t,et.min(),et.min(),vr.empty(),0)}static newUnknownDocument(e,t){return new In(e,3,t,et.min(),et.min(),vr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(et.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=vr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=vr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof In&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new In(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ru{constructor(e,t){this.position=e,this.inclusive=t}}function jR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Ie.comparator(Ie.fromName(o.referenceValue),t.key):i=sa(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function FR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!us(n.position[t],e.position[t]))return!1;return!0}class ym{constructor(e,t="asc"){this.field=e,this.dir=t}}function F7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class CN{}class Qe extends CN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new V7(e,t,i):t==="array-contains"?new B7(e,i):t==="in"?new NN(e,i):t==="not-in"?new W7(e,i):t==="array-contains-any"?new G7(e,i):new Qe(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new z7(e,i):new U7(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(sa(t,this.value)):t!==null&&Iu(this.value)===Iu(t)&&this.matchesComparison(sa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pt extends CN{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new pt(e,t)}matches(e){return bu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function bu(n){return n.op==="and"}function fx(n){return n.op==="or"}function Cw(n){return RN(n)&&bu(n)}function RN(n){for(const e of n.filters)if(e instanceof pt)return!1;return!0}function gx(n){if(n instanceof Qe)return n.field.canonicalString()+n.op.toString()+Cu(n.value);if(Cw(n))return n.filters.map((e=>gx(e))).join(",");{const e=n.filters.map((t=>gx(t))).join(",");return`${n.op}(${e})`}}function bN(n,e){return n instanceof Qe?(function(i,r){return r instanceof Qe&&i.op===r.op&&i.field.isEqual(r.field)&&us(i.value,r.value)})(n,e):n instanceof pt?(function(i,r){return r instanceof pt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&bN(o,r.filters[l])),!0):!1})(n,e):void Ne(19439)}function AN(n,e){const t=n.filters.concat(e);return pt.create(t,n.op)}function PN(n){return n instanceof Qe?(function(t){return`${t.field.canonicalString()} ${t.op} ${Cu(t.value)}`})(n):n instanceof pt?(function(t){return t.op.toString()+" {"+t.getFilters().map(PN).join(" ,")+"}"})(n):"Filter"}class V7 extends Qe{constructor(e,t,i){super(e,t,i),this.key=Ie.fromName(i.referenceValue)}matches(e){const t=Ie.comparator(e.key,this.key);return this.matchesComparison(t)}}class z7 extends Qe{constructor(e,t){super(e,"in",t),this.keys=kN("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class U7 extends Qe{constructor(e,t){super(e,"not-in",t),this.keys=kN("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function kN(n,e){return(e.arrayValue?.values||[]).map((t=>Ie.fromName(t.referenceValue)))}class B7 extends Qe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Xd(t)&&qd(t.arrayValue,this.value)}}class NN extends Qe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&qd(this.value.arrayValue,t)}}class W7 extends Qe{constructor(e,t){super(e,"not-in",t)}matches(e){if(qd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!qd(this.value.arrayValue,t)}}class G7 extends Qe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Xd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>qd(this.value.arrayValue,i)))}}class $7{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function px(n,e=null,t=[],i=[],r=null,s=null,o=null){return new $7(n,e,t,i,r,s,o)}function Il(n){const e=St(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>gx(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),hy(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Cu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Cu(i))).join(",")),e.Te=t}return e.Te}function Cf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!F7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!bN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!FR(n.startAt,e.startAt)&&FR(n.endAt,e.endAt)}function H7(n){return Ie.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function _m(n,e){return n.filters.filter((t=>t instanceof Qe&&t.field.isEqual(e)))}function VR(n,e,t){let i=Sp,r=!0;for(const s of _m(n,e)){let o=Sp,l=!0;switch(s.op){case"<":case"<=":o=O7(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=Sp}LR({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];LR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function zR(n,e,t){let i=qo,r=!0;for(const s of _m(n,e)){let o=qo,l=!0;switch(s.op){case">=":case">":o=j7(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=qo}OR({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];OR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class my{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function K7(n,e,t,i,r,s,o,l){return new my(n,e,t,i,r,s,o,l)}function DN(n){return new my(n)}function UR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function q7(n){return n.collectionGroup!==null}function pd(n){const e=St(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new yt(Bt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new ym(s,i))})),t.has(Bt.keyField().canonicalString())||e.Ie.push(new ym(Bt.keyField(),i))}return e.Ie}function Ks(n){const e=St(n);return e.Ee||(e.Ee=X7(e,pd(n))),e.Ee}function X7(n,e){if(n.limitType==="F")return px(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new ym(r.field,s)}));const t=n.endAt?new Ru(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ru(n.startAt.position,n.startAt.inclusive):null;return px(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function mx(n,e,t){return new my(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function MN(n,e){return Cf(Ks(n),Ks(e))&&n.limitType===e.limitType}function LN(n){return`${Il(Ks(n))}|lt:${n.limitType}`}function jh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>PN(r))).join(", ")}]`),hy(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Cu(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Cu(r))).join(",")),`Target(${i})`})(Ks(n))}; limitType=${n.limitType})`}function yy(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ie.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of pd(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,u){const h=jR(o,l,u);return o.inclusive?h<=0:h<0})(i.startAt,pd(i),r)||i.endAt&&!(function(o,l,u){const h=jR(o,l,u);return o.inclusive?h>=0:h>0})(i.endAt,pd(i),r))})(n,e)}function Y7(n){return(e,t)=>{let i=!1;for(const r of pd(n)){const s=Z7(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function Z7(n,e,t){const i=n.field.isKeyField()?Ie.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?sa(u,h):Ne(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ne(19790,{direction:n.dir})}}class ca{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Tw(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return N7(this.inner)}size(){return this.innerSize}}const Q7=new di(Ie.comparator);function rl(){return Q7}const ON=new di(Ie.comparator);function ip(...n){let e=ON;for(const t of n)e=e.insert(t.key,t);return e}function J7(n){let e=ON;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function is(){return md()}function jN(){return md()}function md(){return new ca((n=>n.toString()),((n,e)=>n.isEqual(e)))}const eW=new di(Ie.comparator),tW=new yt(Ie.comparator);function Cn(...n){let e=tW;for(const t of n)e=e.add(t);return e}const nW=new yt(qe);function iW(){return nW}function rW(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:um(e)?"-0":e}}function sW(n){return{integerValue:""+n}}class _y{constructor(){this._=void 0}}function oW(n,e,t){return n instanceof Yd?(function(r,s){const o={fields:{[yN]:{stringValue:mN},[vN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Sw(s)&&(s=xN(s)),s&&(o.fields[_N]=s),{mapValue:o}})(t,e):n instanceof Au?FN(n,e):n instanceof Pu?VN(n,e):(function(r,s){const o=lW(r,s),l=BR(o)+BR(r.Ae);return dx(o)&&dx(r.Ae)?sW(l):rW(r.serializer,l)})(n,e)}function aW(n,e,t){return n instanceof Au?FN(n,e):n instanceof Pu?VN(n,e):t}function lW(n,e){return n instanceof Zd?(function(i){return dx(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class Yd extends _y{}class Au extends _y{constructor(e){super(),this.elements=e}}function FN(n,e){const t=zN(e);for(const i of n.elements)t.some((r=>us(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Pu extends _y{constructor(e){super(),this.elements=e}}function VN(n,e){let t=zN(e);for(const i of n.elements)t=t.filter((r=>!us(r,i)));return{arrayValue:{values:t}}}class Zd extends _y{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function BR(n){return qt(n.integerValue||n.doubleValue)}function zN(n){return Xd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class cW{constructor(e,t){this.field=e,this.transform=t}}function uW(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Au&&r instanceof Au||i instanceof Pu&&r instanceof Pu?_u(i.elements,r.elements,us):i instanceof Zd&&r instanceof Zd?us(i.Ae,r.Ae):i instanceof Yd&&r instanceof Yd})(n.transform,e.transform)}class hW{constructor(e,t){this.version=e,this.transformResults=t}}class Er{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Er}static exists(e){return new Er(void 0,e)}static updateTime(e){return new Er(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ip(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class vy{}function UN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Rw(n.key,Er.none()):new Rf(n.key,n.data,Er.none());{const t=n.data,i=vr.empty();let r=new yt(Bt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new zu(n.key,i,new Us(r.toArray()),Er.none())}}function dW(n,e,t){n instanceof Rf?(function(r,s,o){const l=r.value.clone(),u=GR(r.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof zu?(function(r,s,o){if(!Ip(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=GR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(BN(r)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function yd(n,e,t,i){return n instanceof Rf?(function(s,o,l,u){if(!Ip(s.precondition,o))return l;const h=s.value.clone(),f=$R(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof zu?(function(s,o,l,u){if(!Ip(s.precondition,o))return l;const h=$R(s.fieldTransforms,u,o),f=o.data;return f.setAll(BN(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((p=>p.field)))})(n,e,t,i):(function(s,o,l){return Ip(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function WR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&_u(i,r,((s,o)=>uW(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Rf extends vy{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class zu extends vy{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function BN(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function GR(n,e,t){const i=new Map;Oe(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,aW(o,l,t[r]))}return i}function $R(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,oW(s,o,e))}return i}class Rw extends vy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class WN extends vy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class bw{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&dW(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=yd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=yd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=jN();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const u=UN(o,l);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(et.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Cn())}isEqual(e){return this.batchId===e.batchId&&_u(this.mutations,e.mutations,((t,i)=>WR(t,i)))&&_u(this.baseMutations,e.baseMutations,((t,i)=>WR(t,i)))}}class Aw{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Oe(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return eW})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new Aw(e,t,i,r)}}class Pw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var Kt,Je;function fW(n){switch(n){case ce.OK:return Ne(64938);case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return Ne(15467,{code:n})}}function gW(n){if(n===void 0)return Ci("GRPC error has no .code"),ce.UNKNOWN;switch(n){case Kt.OK:return ce.OK;case Kt.CANCELLED:return ce.CANCELLED;case Kt.UNKNOWN:return ce.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return ce.INTERNAL;case Kt.UNAVAILABLE:return ce.UNAVAILABLE;case Kt.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case Kt.NOT_FOUND:return ce.NOT_FOUND;case Kt.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case Kt.ABORTED:return ce.ABORTED;case Kt.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case Kt.DATA_LOSS:return ce.DATA_LOSS;default:return Ne(39323,{code:n})}}(Je=Kt||(Kt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";new pw([4294967295,4294967295],0);const pW={asc:"ASCENDING",desc:"DESCENDING"},mW={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},yW={and:"AND",or:"OR"};class _W{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vW(n,e){return n.useProto3Json||hy(e)?e:{value:e}}function yx(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xW(n,e){return yx(n,e.toTimestamp())}function Cr(n){return Oe(!!n,49232),et.fromTimestamp((function(t){const i=ra(t);return new kt(i.seconds,i.nanos)})(n))}function GN(n,e){return _x(n,e).canonicalString()}function _x(n,e){const t=(function(r){return new Rt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function $N(n){const e=Rt.fromString(n);return Oe(PW(e),10190,{key:e.toString()}),e}function vm(n,e){return GN(n.databaseId,e.path)}function Cp(n,e){const t=$N(e);if(t.get(1)!==n.databaseId.projectId)throw new be(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new be(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ie(qN(t))}function HN(n,e){return GN(n.databaseId,e)}function KN(n){const e=$N(n);return e.length===4?Rt.emptyPath():qN(e)}function wW(n){return new Rt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function qN(n){return Oe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function HR(n,e,t){return{name:vm(n,e),fields:t.value.mapValue.fields}}function EW(n,e,t){const i=Cp(n,e.name),r=Cr(e.updateTime),s=e.createTime?Cr(e.createTime):et.min(),o=new vr({mapValue:{fields:e.fields}}),l=In.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function xm(n,e){let t;if(e instanceof Rf)t={update:HR(n,e.key,e.value)};else if(e instanceof Rw)t={delete:vm(n,e.key)};else if(e instanceof zu)t={update:HR(n,e.key,e.data),updateMask:AW(e.fieldMask)};else{if(!(e instanceof WN))return Ne(16599,{Vt:e.type});t={verify:vm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof Yd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Au)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Pu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Zd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Ne(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:xW(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ne(27497)})(n,e.precondition)),t}function vx(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?Er.updateTime(Cr(s.updateTime)):s.exists!==void 0?Er.exists(s.exists):Er.none()})(e.currentDocument):Er.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let u=null;if("setToServerValue"in l)Oe(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new Yd;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new Au(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Pu(f)}else"increment"in l?u=new Zd(o,l.increment):Ne(16584,{proto:l});const h=Bt.fromServerFormat(l.fieldPath);return new cW(h,u)})(n,r))):[];if(e.update){e.update.name;const r=Cp(n,e.update.name),s=new vr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new Us(h.map((f=>Bt.fromServerFormat(f))))})(e.updateMask);return new zu(r,s,o,t,i)}return new Rf(r,s,t,i)}if(e.delete){const r=Cp(n,e.delete);return new Rw(r,t)}if(e.verify){const r=Cp(n,e.verify);return new WN(r,t)}return Ne(1463,{proto:e})}function TW(n,e){return n&&n.length>0?(Oe(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Cr(r.updateTime):Cr(s);return o.isEqual(et.min())&&(o=Cr(s)),new hW(o,r.transformResults||[])})(t,e)))):[]}function SW(n,e){return{documents:[HN(n,e.path)]}}function IW(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=HN(n,r);const s=(function(h){if(h.length!==0)return ZN(pt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(_){return{field:Fc(_.field),direction:CW(_.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=vW(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function XN(n){let e=KN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Oe(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(p){const _=YN(p);return _ instanceof pt&&Cw(_)?_.getFilters():[_]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((_=>(function(S){return new ym(Vc(S.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(_)))})(t.orderBy));let l=null;t.limit&&(l=(function(p){let _;return _=typeof p=="object"?p.value:p,hy(_)?null:_})(t.limit));let u=null;t.startAt&&(u=(function(p){const _=!!p.before,x=p.values||[];return new Ru(x,_)})(t.startAt));let h=null;return t.endAt&&(h=(function(p){const _=!p.before,x=p.values||[];return new Ru(x,_)})(t.endAt)),K7(e,r,o,s,l,"F",u,h)}function YN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Vc(t.unaryFilter.field);return Qe.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Vc(t.unaryFilter.field);return Qe.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Vc(t.unaryFilter.field);return Qe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Vc(t.unaryFilter.field);return Qe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ne(61313);default:return Ne(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Qe.create(Vc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ne(58110);default:return Ne(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return pt.create(t.compositeFilter.filters.map((i=>YN(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ne(1026)}})(t.compositeFilter.op))})(n):Ne(30097,{filter:n})}function CW(n){return pW[n]}function RW(n){return mW[n]}function bW(n){return yW[n]}function Fc(n){return{fieldPath:n.canonicalString()}}function Vc(n){return Bt.fromServerFormat(n.fieldPath)}function ZN(n){return n instanceof Qe?(function(t){if(t.op==="=="){if(MR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NAN"}};if(DR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(MR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NOT_NAN"}};if(DR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fc(t.field),op:RW(t.op),value:t.value}}})(n):n instanceof pt?(function(t){const i=t.getFilters().map((r=>ZN(r)));return i.length===1?i[0]:{compositeFilter:{op:bW(t.op),filters:i}}})(n):Ne(54877,{filter:n})}function AW(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function PW(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class qc{constructor(e,t,i,r,s=et.min(),o=et.min(),l=fi.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new qc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new qc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class QN{constructor(e){this.yt=e}}function kW(n,e){let t;if(e.document)t=EW(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Ie.fromSegments(e.noDocument.path),r=Rl(e.noDocument.readTime);t=In.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ne(56709);{const i=Ie.fromSegments(e.unknownDocument.path),r=Rl(e.unknownDocument.version);t=In.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new kt(r[0],r[1]);return et.fromTimestamp(s)})(e.readTime)),t}function KR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:wm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:vm(s,o.key),fields:o.data.value.mapValue.fields,updateTime:yx(s,o.version.toTimestamp()),createTime:yx(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Cl(e.version)};else{if(!e.isUnknownDocument())return Ne(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Cl(e.version)}}return i}function wm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Cl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Rl(n){const e=new kt(n.seconds,n.nanoseconds);return et.fromTimestamp(e)}function qa(n,e){const t=(e.baseMutations||[]).map((s=>vx(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>vx(n.yt,s))),r=kt.fromMillis(e.localWriteTimeMs);return new bw(e.batchId,r,t,i)}function td(n){const e=Rl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Rl(n.lastLimboFreeSnapshotVersion):et.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return Oe(o===1,1966,{count:o}),Ks(DN(KN(s.documents[0])))})(n.query):(function(s){return Ks(XN(s))})(n.query),new qc(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,fi.fromBase64String(n.resumeToken))}function JN(n,e){const t=Cl(e.snapshotVersion),i=Cl(e.lastLimboFreeSnapshotVersion);let r;r=H7(e.target)?SW(n.yt,e.target):IW(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Il(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function eD(n){const e=XN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?mx(e,e.limit,"L"):e}function tv(n,e){return new Pw(e.largestBatchId,vx(n.yt,e.overlayMutation))}function qR(n,e){const t=e.path.lastSegment();return[n,Xn(e.path.popLast()),t]}function XR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Cl(i.readTime),documentKey:Xn(i.documentKey.path),largestBatchId:i.largestBatchId}}class NW{getBundleMetadata(e,t){return YR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Rl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return YR(e).put((function(r){return{bundleId:r.id,createTime:Cl(Cr(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return ZR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:eD(s.bundledQuery),readTime:Rl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return ZR(e).put((function(r){return{name:r.name,readTime:Cl(Cr(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function YR(n){return rn(n,dy)}function ZR(n){return rn(n,fy)}class xy{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new xy(e,i)}getOverlay(e,t){return Fh(e).get(qR(this.userId,t)).next((i=>i?tv(this.serializer,i):null))}getOverlays(e,t){const i=is();return Q.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new Pw(t,o);r.push(this.St(e,l))})),Q.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Xn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Fh(e).Z(cx,l))})),Q.waitFor(s)}getOverlaysForCollection(e,t,i){const r=is(),s=Xn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Fh(e).J(cx,o).next((l=>{for(const u of l){const h=tv(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=is();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Fh(e).ee({index:hN,range:l},((u,h,f)=>{const p=tv(this.serializer,h);s.size()<r||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Fh(e).put((function(r,s,o){const[l,u,h]=qR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:xm(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Fh(n){return rn(n,gy)}class DW{bt(e){return rn(e,ww)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?fi.fromUint8Array(i):fi.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Xa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(qt(e.integerValue));else if("doubleValue"in e){const i=qt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),um(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ra(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Tu(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?SN(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):py(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ne(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=mm,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(qt(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ie.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Xa.Kt=new Xa;const bc=255;function MW(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function QR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=MW(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class LW{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=QR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=QR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(bc),this.sn(255)}_n(){this.an(bc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===bc?(this.sn(bc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===bc?(this.an(bc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class OW{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class jW{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Vh{constructor(){this.cn=new LW,this.ln=new OW(this.cn),this.hn=new jW(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Ya{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Ya(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Rp(this.En),directionalValue:Rp(this.dn),orderedDocumentKey:Rp(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Mo(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=JR(n.En,e.En),t!==0?t:(t=JR(n.dn,e.dn),t!==0?t:Ie.comparator(n.In,e.In)))}function JR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Rp(n){return ck()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function eb(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class tb{constructor(e){this.mn=new yt(((t,i)=>Bt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Oe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=ox(e);if(t!==void 0&&!this.wn(t))return!1;const i=Ga(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=i[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new yt(Bt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new wp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new wp(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new wp(i.field,i.dir==="asc"?0:1)));return new cm(cm.UNKNOWN_ID,this.collectionId,t,Gd.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function tD(n){if(Oe(n instanceof Qe||n instanceof pt,20012),n instanceof Qe){if(n instanceof NN){const t=n.value.arrayValue?.values?.map((i=>Qe.create(n.field,"==",i)))||[];return pt.create(t,"or")}return n}const e=n.filters.map((t=>tD(t)));return pt.create(e,n.op)}function FW(n){if(n.getFilters().length===0)return[];const e=Ex(tD(n));return Oe(nD(e),7391),xx(e)||wx(e)?[e]:e.getFilters()}function xx(n){return n instanceof Qe}function wx(n){return n instanceof pt&&Cw(n)}function nD(n){return xx(n)||wx(n)||(function(t){if(t instanceof pt&&fx(t)){for(const i of t.getFilters())if(!xx(i)&&!wx(i))return!1;return!0}return!1})(n)}function Ex(n){if(Oe(n instanceof Qe||n instanceof pt,34018),n instanceof Qe)return n;if(n.filters.length===1)return Ex(n.filters[0]);const e=n.filters.map((i=>Ex(i)));let t=pt.create(e,n.op);return t=Em(t),nD(t)?t:(Oe(t instanceof pt,64498),Oe(bu(t),40251),Oe(t.filters.length>1,57927),t.filters.reduce(((i,r)=>kw(i,r))))}function kw(n,e){let t;return Oe(n instanceof Qe||n instanceof pt,38388),Oe(e instanceof Qe||e instanceof pt,25473),t=n instanceof Qe?e instanceof Qe?(function(r,s){return pt.create([r,s],"and")})(n,e):nb(n,e):e instanceof Qe?nb(e,n):(function(r,s){if(Oe(r.filters.length>0&&s.filters.length>0,48005),bu(r)&&bu(s))return AN(r,s.getFilters());const o=fx(r)?r:s,l=fx(r)?s:r,u=o.filters.map((h=>kw(h,l)));return pt.create(u,"or")})(n,e),Em(t)}function nb(n,e){if(bu(e))return AN(e,n.getFilters());{const t=e.filters.map((i=>kw(n,i)));return pt.create(t,"or")}}function Em(n){if(Oe(n instanceof Qe||n instanceof pt,11850),n instanceof Qe)return n;const e=n.getFilters();if(e.length===1)return Em(e[0]);if(RN(n))return n;const t=e.map((r=>Em(r))),i=[];return t.forEach((r=>{r instanceof Qe?i.push(r):r instanceof pt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:pt.create(i,n.op)}class VW{constructor(){this.Cn=new Nw}addToCollectionParentIndex(e,t){return this.Cn.add(t),Q.resolve()}getCollectionParents(e,t){return Q.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Q.resolve()}deleteFieldIndex(e,t){return Q.resolve()}deleteAllFieldIndexes(e){return Q.resolve()}createTargetIndexes(e,t){return Q.resolve()}getDocumentsMatchingTarget(e,t){return Q.resolve(null)}getIndexType(e,t){return Q.resolve(0)}getFieldIndexes(e,t){return Q.resolve([])}getNextCollectionGroupToUpdate(e){return Q.resolve(null)}getMinOffset(e,t){return Q.resolve(ki.min())}getMinOffsetFromCollectionGroup(e,t){return Q.resolve(ki.min())}updateCollectionGroup(e,t,i){return Q.resolve()}updateIndexEntries(e,t){return Q.resolve()}}class Nw{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new yt(Rt.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new yt(Rt.comparator)).toArray()}}const ib="IndexedDbIndexManager",rp=new Uint8Array(0);class zW{constructor(e,t){this.databaseId=t,this.vn=new Nw,this.Fn=new ca((i=>Il(i)),((i,r)=>Cf(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Xn(r)};return rb(e).put(s)}return Q.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[eN(t),""],!1,!0);return rb(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(ns(o.parent))}return i}))}addFieldIndex(e,t){const i=zh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=Pc(e);return s.next((l=>{o.put(XR(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=zh(e),r=Pc(e),s=Ac(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=zh(e),i=Ac(e),r=Pc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Q.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new tb(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=Ac(e);let r=!0;const s=new Map;return Q.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=Cn();const l=[];return Q.forEach(s,((u,h)=>{ye(ib,`Using index ${(function(M){return`id=${M.indexId}|cg=${M.collectionGroup}|f=${M.fields.map((L=>`${L.fieldPath}:${L.kind}`)).join(",")}`})(u)} to execute ${Il(t)}`);const f=(function(M,L){const O=ox(L);if(O===void 0)return null;for(const U of _m(M,O.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null})(h,u),p=(function(M,L){const O=new Map;for(const U of Ga(L))for(const P of _m(M,U.fieldPath))switch(P.op){case"==":case"in":O.set(U.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return O.set(U.fieldPath.canonicalString(),P.value),Array.from(O.values())}return null})(h,u),_=(function(M,L){const O=[];let U=!0;for(const P of Ga(L)){const C=P.kind===0?VR(M,P.fieldPath,M.startAt):zR(M,P.fieldPath,M.startAt);O.push(C.value),U&&(U=C.inclusive)}return new Ru(O,U)})(h,u),x=(function(M,L){const O=[];let U=!0;for(const P of Ga(L)){const C=P.kind===0?zR(M,P.fieldPath,M.endAt):VR(M,P.fieldPath,M.endAt);O.push(C.value),U&&(U=C.inclusive)}return new Ru(O,U)})(h,u),S=this.On(u,h,_),I=this.On(u,h,x),T=this.Nn(u,h,p),b=this.Bn(u.indexId,f,S,_.inclusive,I,x.inclusive,T);return Q.forEach(b,(N=>i.Y(N,t.limit).next((M=>{M.forEach((L=>{const O=Ie.fromSegments(L.documentKey);o.has(O)||(o=o.add(O),l.push(O))}))}))))})).next((()=>l))}return Q.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=FW(pt.create(e.filters,"and")).map((i=>px(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let p=0;p<u;++p){const _=t?this.Ln(t[p/h]):rp,x=this.kn(e,_,i[p%h],r),S=this.qn(e,_,s[p%h],o),I=l.map((T=>this.kn(e,_,T,!0)));f.push(...this.createRange(x,S,I))}return f}kn(e,t,i,r){const s=new Ya(e,Ie.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Ya(e,Ie.empty(),t,i);return r?s.An():s}xn(e,t){const i=new tb(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Q.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new yt(Bt.comparator),f=!1;for(const p of u.filters)for(const _ of p.getFlattenedFilters())_.field.isKeyField()||(_.op==="array-contains"||_.op==="array-contains-any"?f=!0:h=h.add(_.field));for(const p of u.orderBy)p.field.isKeyField()||(h=h.add(p.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Vh;for(const r of Ga(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);Xa.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Vh;return Xa.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Vh;return Xa.Kt.Dt(Iw(this.databaseId,t),i.Pn((function(s){const o=Ga(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Vh);let s=0;for(const o of Ga(e)){const l=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&Xd(l))r=this.Kn(r,o,l);else{const h=u.Pn(o.kind);Xa.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const u=new Vh;u.seed(l.un()),Xa.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof Qe&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=zh(e),r=Pc(e);return(t?i.J(lx,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Q.forEach(s,(l=>r.get([l.indexId,this.uid]).next((u=>{o.push((function(f,p){const _=p?new Gd(p.sequenceNumber,new ki(Rl(p.readTime),new Ie(ns(p.documentKey)),p.largestBatchId)):Gd.empty(),x=f.fields.map((([S,I])=>new wp(Bt.fromServerFormat(S),I)));return new cm(f.indexId,f.collectionGroup,x,_)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:qe(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=zh(e),s=Pc(e);return this.Gn(e).next((o=>r.J(lx,IDBKeyRange.bound(t,t)).next((l=>Q.forEach(l,(u=>s.put(XR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Q.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Q.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),Q.forEach(l,(u=>this.zn(e,r,u).next((h=>{const f=this.jn(s,u);return h.isEqual(f)?Q.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,i,r){return Ac(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Ac(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Ac(e);let s=new yt(Mo);return r.ee({index:uN,range:IDBKeyRange.only([i.indexId,this.uid,Rp(this.$n(i,t))])},((o,l)=>{s=s.add(new Ya(i.indexId,t,eb(l.arrayValue),eb(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new yt(Mo);const r=this.Qn(t,e);if(r==null)return i;const s=ox(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Xd(o))for(const l of o.arrayValue.values||[])i=i.add(new Ya(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new Ya(t.indexId,e.key,rp,r));return i}Jn(e,t,i,r,s){ye(ib,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,f,p,_){const x=u.getIterator(),S=h.getIterator();let I=Rc(x),T=Rc(S);for(;I||T;){let b=!1,N=!1;if(I&&T){const M=f(I,T);M<0?N=!0:M>0&&(b=!0)}else I!=null?N=!0:b=!0;b?(p(T),T=Rc(S)):N?(_(I),I=Rc(x)):(I=Rc(x),T=Rc(S))}})(r,s,Mo,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),Q.waitFor(o)}Gn(e){let t=1;return Pc(e).ee({index:cN,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>Mo(o,l))).filter(((o,l,u)=>!l||Mo(o,u[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=Mo(o,e),u=Mo(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,rp,Ie.empty()),u=r[o+1].Vn(this.uid,rp,Ie.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return Mo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(sb)}getMinOffset(e,t){return Q.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Ne(44426))))).next(sb)}}function rb(n){return rn(n,Kd)}function Ac(n){return rn(n,fd)}function zh(n){return rn(n,xw)}function Pc(n){return rn(n,dd)}function sb(n){Oe(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;yw(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new ki(e.readTime,e.documentKey,t)}const ob={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},iD=41943040;class ii{static withCacheSize(e){return new ii(e,ii.DEFAULT_COLLECTION_PERCENTILE,ii.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function rD(n,e,t){const i=n.store(pr),r=n.store(vu),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.ee({range:o},((f,p,_)=>(l++,_.delete())));s.push(u.next((()=>{Oe(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const p=oN(e,f.key.path,t.batchId);s.push(r.delete(p)),h.push(f.key)}return Q.waitFor(s).next((()=>h))}function Tm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ne(14731);e=n.noDocument}return JSON.stringify(e).length}ii.DEFAULT_COLLECTION_PERCENTILE=10,ii.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ii.DEFAULT=new ii(iD,ii.DEFAULT_COLLECTION_PERCENTILE,ii.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ii.DISABLED=new ii(-1,0,0);class wy{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){Oe(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new wy(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Lo(e).ee({index:il,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=zc(e),o=Lo(e);return o.add({}).next((l=>{Oe(typeof l=="number",49019);const u=new bw(l,t,i,r),h=(function(x,S,I){const T=I.baseMutations.map((N=>xm(x.yt,N))),b=I.mutations.map((N=>xm(x.yt,N)));return{userId:S,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:T,mutations:b}})(this.serializer,this.userId,u),f=[];let p=new yt(((_,x)=>qe(_.canonicalString(),x.canonicalString())));for(const _ of r){const x=oN(this.userId,_.key.path,l);p=p.add(_.key.path.popLast()),f.push(o.put(h)),f.push(s.put(x,l7))}return p.forEach((_=>{f.push(this.indexManager.addToCollectionParentIndex(e,_))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),Q.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return Lo(e).get(t).next((i=>i?(Oe(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),qa(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Q.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Lo(e).ee({index:il,range:r},((o,l,u)=>{l.userId===this.userId&&(Oe(l.batchId>=i,47524,{tr:i}),s=qa(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ul;return Lo(e).ee({index:il,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ul],[this.userId,Number.POSITIVE_INFINITY]);return Lo(e).J(il,t).next((i=>i.map((r=>qa(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Ep(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return zc(e).ee({range:r},((o,l,u)=>{const[h,f,p]=o,_=ns(f);if(h===this.userId&&t.path.isEqual(_))return Lo(e).get(p).next((x=>{if(!x)throw Ne(61480,{nr:o,batchId:p});Oe(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:p}),s.push(qa(this.serializer,x))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(qe);const r=[];return t.forEach((s=>{const o=Ep(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=zc(e).ee({range:l},((h,f,p)=>{const[_,x,S]=h,I=ns(x);_===this.userId&&s.path.isEqual(I)?i=i.add(S):p.done()}));r.push(u)})),Q.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=Ep(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new yt(qe);return zc(e).ee({range:o},((u,h,f)=>{const[p,_,x]=u,S=ns(_);p===this.userId&&i.isPrefixOf(S)?S.length===r&&(l=l.add(x)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(Lo(e).get(s).next((o=>{if(o===null)throw Ne(35274,{batchId:s});Oe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(qa(this.serializer,o))})))})),Q.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return rD(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Q.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Q.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return zc(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const u=ns(s[1]);r.push(u)}else l.done()})).next((()=>{Oe(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return sD(e,this.userId,t)}_r(e){return oD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:ul,lastStreamToken:""}))}}function sD(n,e,t){const i=Ep(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return zc(n).ee({range:s,X:!0},((l,u,h)=>{const[f,p,_]=l;f===e&&p===r&&(o=!0),h.done()})).next((()=>o))}function Lo(n){return rn(n,pr)}function zc(n){return rn(n,vu)}function oD(n){return rn(n,$d)}class bl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new bl(0)}static cr(){return new bl(-1)}}class UW{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new bl(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>et.fromTimestamp(new kt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>kc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Oe(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return kc(e).ee(((o,l)=>{const u=td(l);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>Q.waitFor(s))).next((()=>r))}forEachTarget(e,t){return kc(e).ee(((i,r)=>{const s=td(r);t(s)}))}lr(e){return ab(e).get(fm).next((t=>(Oe(t!==null,2888),t)))}hr(e,t){return ab(e).put(fm,t)}Pr(e,t){return kc(e).put(JN(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Il(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return kc(e).ee({range:r,index:lN},((o,l,u)=>{const h=td(l);Cf(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Go(e);return t.forEach((o=>{const l=Xn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),Q.waitFor(r)}removeMatchingKeys(e,t,i){const r=Go(e);return Q.forEach(t,(s=>{const o=Xn(s.path);return Q.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Go(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Go(e);let s=Cn();return r.ee({range:i,X:!0},((o,l,u)=>{const h=ns(o[1]),f=new Ie(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Xn(t.path),r=IDBKeyRange.bound([i],[eN(i)],!1,!0);let s=0;return Go(e).ee({index:vw,X:!0,range:r},(([o,l],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return kc(e).get(t).next((i=>i?td(i):null))}}function kc(n){return rn(n,xu)}function ab(n){return rn(n,hl)}function Go(n){return rn(n,wu)}const lb="LruGarbageCollector",BW=1048576;function cb([n,e],[t,i]){const r=qe(n,t);return r===0?qe(e,i):r}class WW{constructor(e){this.Ir=e,this.buffer=new yt(cb),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();cb(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class GW{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ye(lb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ll(t)?ye(lb,"Ignoring IndexedDB error during garbage collection: ",t):await cy(t)}await this.Vr(3e5)}))}}class $W{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Q.resolve(wr.ce);const i=new WW(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),Q.resolve(ob)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ob):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),r=this.params.maximumSequenceNumbersToCollect):r=p,o=Date.now(),this.nthSequenceNumber(e,r)))).next((p=>(i=p,l=Date.now(),this.removeTargets(e,i,t)))).next((p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((p=>(h=Date.now(),jc()<=Xe.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Q.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:p}))))}}function HW(n,e){return new $W(n,e)}class KW{constructor(e,t){this.db=e,this.garbageCollector=HW(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return sp(e,i)}removeReference(e,t,i){return sp(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return sp(e,t)}br(e,t){return(function(r,s){let o=!1;return oD(r).te((l=>sD(r,l,s).next((u=>(u&&(o=!0),Q.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,et.min()),Go(e).delete((function(p){return[0,Xn(p.path)]})(o)))))}));r.push(u)}})).next((()=>Q.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return sp(e,t)}Sr(e,t){const i=Go(e);let r,s=wr.ce;return i.ee({index:vw},(([o,l],{path:u,sequenceNumber:h})=>{o===0?(s!==wr.ce&&t(new Ie(ns(r)),s),s=h,r=u):s=wr.ce})).next((()=>{s!==wr.ce&&t(new Ie(ns(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function sp(n,e){return Go(n).put((function(i,r){return{targetId:0,path:Xn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class aD{constructor(){this.changes=new ca((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,In.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Q.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class qW{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Fa(e).put(i)}removeEntry(e,t,i){return Fa(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],wm(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=In.newInvalidDocument(t);return Fa(e).ee({index:Tp,range:IDBKeyRange.only(Uh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:In.newInvalidDocument(t)};return Fa(e).ee({index:Tp,range:IDBKeyRange.only(Uh(t))},((r,s)=>{i={document:this.Cr(t,s),size:Tm(s)}})).next((()=>i))}getEntries(e,t){let i=rl();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=rl(),r=new di(Ie.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,Tm(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Q.resolve();let r=new yt(db);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Uh(r.first()),Uh(r.last())),o=r.getIterator();let l=o.getNext();return Fa(e).ee({index:Tp,range:s},((u,h,f)=>{const p=Ie.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&db(l,p)<0;)i(l,null),l=o.getNext();l&&l.isEqual(p)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Uh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),wm(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fa(e).J(IDBKeyRange.bound(l,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=rl();for(const p of h){const _=this.Cr(Ie.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);_.isFoundDocument()&&(yy(t,_)||r.has(_.key))&&(f=f.insert(_.key,_))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=rl();const o=hb(t,i),l=hb(t,ki.max());return Fa(e).ee({index:aN,range:IDBKeyRange.bound(o,l,!0)},((u,h,f)=>{const p=this.Cr(Ie.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(p.key,p),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new XW(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return ub(e).get(ax).next((t=>(Oe(!!t,20021),t)))}Dr(e,t){return ub(e).put(ax,t)}Cr(e,t){if(t){const i=kW(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(et.min())))return i}return In.newInvalidDocument(e)}}function lD(n){return new qW(n)}class XW extends aD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ca((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new yt(((s,o)=>qe(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=KR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=Tm(u);i+=h-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=l.size,this.trackRemovals){const u=KR(this.Nr.serializer,o.convertToNoDocument(et.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Q.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function ub(n){return rn(n,Hd)}function Fa(n){return rn(n,dm)}function Uh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function hb(n,e){const t=e.documentKey.path.toArray();return[n,wm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function db(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=qe(t[s],i[s]),r)return r;return r=qe(t.length,i.length),r||(r=qe(t[t.length-2],i[i.length-2]),r||qe(t[t.length-1],i[i.length-1]))}class YW{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class cD{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&yd(i.mutation,r,Us.empty(),kt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Cn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Cn()){const r=is();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=ip();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=is();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Cn())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=rl();const o=md(),l=(function(){return md()})();return t.forEach(((u,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof zu)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),yd(f.mutation,h,f.mutation.getFieldMask(),kt.now())):o.set(h.key,Us.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new YW(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=md();let r=new di(((o,l)=>o-l)),s=Cn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=i.get(u)||Us.empty();f=l.applyToLocalView(h,f),i.set(u,f);const p=(r.get(l.batchId)||Cn()).add(u);r=r.insert(l.batchId,p)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,p=jN();f.forEach((_=>{if(!s.has(_)){const x=UN(t.get(_),i.get(_));x!==null&&p.set(_,x),s=s.add(_)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return Q.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):q7(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Q.resolve(is());let l=Wd,u=s;return o.next((h=>Q.forEach(h,((f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(f)?Q.resolve():this.remoteDocumentCache.getEntry(e,f).next((_=>{u=u.insert(f,_)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Cn()))).next((f=>({batchId:l,changes:J7(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ie(t)).next((i=>{let r=ip();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=ip();return this.indexManager.getCollectionParents(e,s).next((l=>Q.forEach(l,(u=>{const h=(function(p,_){return new my(_,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((p,_)=>{o=o.insert(p,_)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,In.newInvalidDocument(f)))}));let l=ip();return o.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&yd(f.mutation,h,Us.empty(),kt.now()),yy(t,h)&&(l=l.insert(u,h))})),l}))}}class ZW{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Q.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Cr(r.createTime)}})(t)),Q.resolve()}getNamedQuery(e,t){return Q.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:eD(r.bundledQuery),readTime:Cr(r.readTime)}})(t)),Q.resolve()}}class QW{constructor(){this.overlays=new di(Ie.comparator),this.qr=new Map}getOverlay(e,t){return Q.resolve(this.overlays.get(t))}getOverlays(e,t){const i=is();return Q.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Q.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Q.resolve()}getOverlaysForCollection(e,t,i){const r=is(),s=t.length+1,o=new Ie(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return Q.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new di(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=is(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=is(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return Q.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Pw(t,i));let s=this.qr.get(t);s===void 0&&(s=Cn(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class JW{constructor(){this.sessionToken=fi.EMPTY_BYTE_STRING}getSessionToken(e){return Q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Q.resolve()}}class Dw{constructor(){this.Qr=new yt(hn.$r),this.Ur=new yt(hn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new hn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new hn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ie(new Rt([])),i=new hn(t,e),r=new hn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ie(new Rt([])),i=new hn(t,e),r=new hn(t,e+1);let s=Cn();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new hn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class hn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ie.comparator(e.key,t.key)||qe(e.Yr,t.Yr)}static Kr(e,t){return qe(e.Yr,t.Yr)||Ie.comparator(e.key,t.key)}}class eG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new yt(hn.$r)}checkEmpty(e){return Q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new bw(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new hn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Q.resolve(o)}lookupMutationBatch(e,t){return Q.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Q.resolve(this.mutationQueue.length===0?ul:this.tr-1)}getAllMutationBatches(e){return Q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new hn(t,0),r=new hn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),Q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(qe);return t.forEach((r=>{const s=new hn(r,0),o=new hn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),Q.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Ie.isDocumentKey(s)||(s=s.child(""));const o=new hn(new Ie(s),0);let l=new yt(qe);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(u.Yr)),!0)}),o),Q.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Oe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Q.forEach(t.mutations,(r=>{const s=new hn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new hn(t,0),r=this.Zr.firstAfterOrEqual(i);return Q.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Q.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class tG{constructor(e){this.ri=e,this.docs=(function(){return new di(Ie.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Q.resolve(i?i.document.mutableCopy():In.newInvalidDocument(t))}getEntries(e,t){let i=rl();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():In.newInvalidDocument(r))})),Q.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=rl();const o=t.path,l=new Ie(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||yw(nN(f),i)<=0||(r.has(f.key)||yy(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Q.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Ne(9500)}ii(e,t){return Q.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new nG(this)}getSize(e){return Q.resolve(this.size)}}class nG extends aD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Q.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class iG{constructor(e){this.persistence=e,this.si=new ca((t=>Il(t)),Cf),this.lastRemoteSnapshotVersion=et.min(),this.highestTargetId=0,this.oi=0,this._i=new Dw,this.targetCount=0,this.ai=bl.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Q.resolve()}getLastRemoteSnapshotVersion(e){return Q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Q.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new bl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Q.resolve()}updateTargetData(e,t){return this.Pr(t),Q.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Q.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),Q.waitFor(s).next((()=>r))}getTargetCount(e){return Q.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Q.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Q.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Q.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Q.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Q.resolve(i)}containsKey(e,t){return Q.resolve(this._i.containsKey(t))}}class uD{constructor(e,t){this.ui={},this.overlays={},this.ci=new wr(0),this.li=!1,this.li=!0,this.hi=new JW,this.referenceDelegate=e(this),this.Pi=new iG(this),this.indexManager=new VW,this.remoteDocumentCache=(function(r){return new tG(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new QN(t),this.Ii=new ZW(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new QW,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new eG(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){ye("MemoryPersistence","Starting transaction:",e);const r=new rG(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Q.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class rG extends rN{constructor(e){super(),this.currentSequenceNumber=e}}class Ey{constructor(e){this.persistence=e,this.Ri=new Dw,this.Vi=null}static mi(e){return new Ey(e)}get fi(){if(this.Vi)return this.Vi;throw Ne(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Q.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Q.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Q.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Q.forEach(this.fi,(i=>{const r=Ie.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,et.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Q.or([()=>Q.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class sG{constructor(e){this.serializer=e}k(e,t,i,r){const s=new uy("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(If)})(e),(function(u){u.createObjectStore($d,{keyPath:a7}),u.createObjectStore(pr,{keyPath:RR,autoIncrement:!0}).createIndex(il,bR,{unique:!0}),u.createObjectStore(vu)})(e),fb(e),(function(u){u.createObjectStore($a)})(e));let o=Q.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(wu),u.deleteObjectStore(xu),u.deleteObjectStore(hl)})(e),fb(e)),o=o.next((()=>(function(u){const h=u.store(hl),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:et.min().toTimestamp(),targetCount:0};return h.put(fm,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(pr).J().next((p=>{u.deleteObjectStore(pr),u.createObjectStore(pr,{keyPath:RR,autoIncrement:!0}).createIndex(il,bR,{unique:!0});const _=h.store(pr),x=p.map((S=>_.put(S)));return Q.waitFor(x)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(Eu,{keyPath:m7})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Hd)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(dy,{keyPath:y7})})(e),(function(u){u.createObjectStore(fy,{keyPath:_7})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(gy,{keyPath:I7});h.createIndex(cx,C7,{unique:!1}),h.createIndex(hN,R7,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(dm,{keyPath:c7});h.createIndex(Tp,u7),h.createIndex(aN,h7)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore($a)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(xw,{keyPath:v7,autoIncrement:!0}).createIndex(lx,x7,{unique:!1}),u.createObjectStore(dd,{keyPath:w7}).createIndex(cN,E7,{unique:!1}),u.createObjectStore(fd,{keyPath:T7}).createIndex(uN,S7,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(dd).clear()})).next((()=>{t.objectStore(fd).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(ww,{keyPath:b7})})(e)}))),i<18&&r>=18&&ck()&&(o=o.next((()=>{t.objectStore(dd).clear()})).next((()=>{t.objectStore(fd).clear()}))),o}wi(e){let t=0;return e.store($a).ee(((i,r)=>{t+=Tm(r)})).next((()=>{const i={byteSize:t};return e.store(Hd).put(ax,i)}))}yi(e){const t=e.store($d),i=e.store(pr);return t.J().next((r=>Q.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,ul],[s.userId,s.lastAcknowledgedBatchId]);return i.J(il,o).next((l=>Q.forEach(l,(u=>{Oe(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=qa(this.serializer,u);return rD(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(wu),i=e.store($a);return e.store(hl).get(fm).next((r=>{const s=[];return i.ee(((o,l)=>{const u=new Rt(o),h=(function(p){return[0,Xn(p)]})(u);s.push(t.get(h).next((f=>f?Q.resolve():(p=>t.put({targetId:0,path:Xn(p),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>Q.waitFor(s)))}))}bi(e,t){e.createObjectStore(Kd,{keyPath:p7});const i=t.store(Kd),r=new Nw,s=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:Xn(u)})}};return t.store($a).ee({X:!0},((o,l)=>{const u=new Rt(o);return s(u.popLast())})).next((()=>t.store(vu).ee({X:!0},(([o,l,u],h)=>{const f=ns(l);return s(f.popLast())}))))}Di(e){const t=e.store(xu);return t.ee(((i,r)=>{const s=td(r),o=JN(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store($a),r=[];return i.ee(((s,o)=>{const l=t.store(dm),u=(function(p){return p.document?new Ie(Rt.fromString(p.document.name).popFirst(5)):p.noDocument?Ie.fromSegments(p.noDocument.path):p.unknownDocument?Ie.fromSegments(p.unknownDocument.path):Ne(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>Q.waitFor(r)))}Fi(e,t){const i=t.store(pr),r=lD(this.serializer),s=new uD(Ey.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((u=>{let h=l.get(u.userId)??Cn();qa(this.serializer,u).keys().forEach((f=>h=h.add(f))),l.set(u.userId,h)})),Q.forEach(l,((u,h)=>{const f=new Tn(h),p=xy.wt(this.serializer,f),_=s.getIndexManager(f),x=wy.wt(f,this.serializer,_,s.referenceDelegate);return new cD(r,x,p,_).recalculateAndSaveOverlaysForDocumentKeys(new ux(t,wr.ce),u).next()}))}))}}function fb(n){n.createObjectStore(wu,{keyPath:f7}).createIndex(vw,g7,{unique:!0}),n.createObjectStore(xu,{keyPath:"targetId"}).createIndex(lN,d7,{unique:!0}),n.createObjectStore(hl)}const Oo="IndexedDbPersistence",nv=18e5,iv=5e3,rv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",oG="main";class Mw{constructor(e,t,i,r,s,o,l,u,h,f,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=_=>Promise.resolve(),!Mw.v())throw new be(ce.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new KW(this,r),this.$i=t+oG,this.serializer=new QN(u),this.Ui=new Jo(this.$i,this.Ni,new sG(this.serializer)),this.hi=new DW,this.Pi=new UW(this.referenceDelegate,this.serializer),this.remoteDocumentCache=lD(this.serializer),this.Ii=new NW,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&Ci(Oo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new be(ce.FAILED_PRECONDITION,rv);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new wr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>op(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ll(e))return ye(Oo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ye(Oo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Bh(e).get(Cc).next((t=>Q.resolve(this.es(t))))}ts(e){return op(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,nv)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=rn(t,Eu);return i.J().next((r=>{const s=this.ss(r,nv),o=r.filter((l=>s.indexOf(l)===-1));return Q.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Q.resolve(!0):Bh(e).get(Cc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,iv)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new be(ce.FAILED_PRECONDITION,rv);return!1}}return!(!this.networkEnabled||!this.inForeground)||op(e).J().next((i=>this.ss(i,iv).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ye(Oo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[If,Eu],(e=>{const t=new ux(e,wr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>op(e).J().next((t=>this.ss(t,nv).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return wy.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new zW(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return xy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){ye(Oo,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?k7:u===17?pN:u===16?P7:u===15?Ew:u===14?gN:u===13?fN:u===12?A7:u===11?dN:void Ne(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new ux(l,this.ci?this.ci.next():wr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Ci(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new be(ce.FAILED_PRECONDITION,iN);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return Bh(e).get(Cc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,iv)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new be(ce.FAILED_PRECONDITION,rv)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Bh(e).put(Cc,t)}static v(){return Jo.v()}Zi(e){const t=Bh(e);return t.get(Cc).next((i=>this.es(i)?(ye(Oo,"Releasing primary lease."),t.delete(Cc)):Q.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Ci(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;lk()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return ye(Oo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ci(Oo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ci("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Bh(n){return rn(n,If)}function op(n){return rn(n,Eu)}function aG(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Lw{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Cn(),r=Cn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Lw(e,t.fromCache,i,r)}}class lG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class hD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return lk()?8:sN(nn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new lG;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(jc()<=Xe.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",jh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Q.resolve()):(jc()<=Xe.DEBUG&&ye("QueryEngine","Query:",jh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(jc()<=Xe.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",jh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ks(t))):Q.resolve())}ys(e,t){if(UR(t))return Q.resolve(null);let i=Ks(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=mx(t,null,"F"),i=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Cn(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,l);return this.Cs(t,h,o,u.readTime)?this.ys(e,mx(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return UR(t)||r.isEqual(et.min())?Q.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Q.resolve(null):(jc()<=Xe.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),jh(t)),this.vs(e,o,t,t7(r,Wd)).next((l=>l)))}))}Ds(e,t){let i=new yt(Y7(e));return t.forEach(((r,s)=>{yy(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return jc()<=Xe.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",jh(t)),this.ps.getDocumentsMatchingQuery(e,t,ki.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const cG="LocalStore";class uG{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new di(qe),this.xs=new ca((s=>Il(s)),Cf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function dD(n,e,t,i){return new uG(n,e,t,i)}async function hG(n,e){const t=St(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let u=Cn();for(const h of r){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function dG(n,e){const t=St(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,f){const p=h.batch,_=p.keys();let x=Q.resolve();return _.forEach((S=>{x=x.next((()=>f.getEntry(u,S))).next((I=>{const T=h.docVersions.get(S);Oe(T!==null,48541),I.version.compareTo(T)<0&&(p.applyToRemoteDocument(I,h),I.isValidDocument()&&(I.setReadTime(h.commitVersion),f.addEntry(I)))}))})),x.next((()=>l.mutationQueue.removeMutationBatch(u,p)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let u=Cn();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function fG(n){const e=St(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function gG(n,e){const t=St(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ul),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class gb{constructor(){this.activeTargetIds=iW()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fD{constructor(){this.Mo=new gb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new gb,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class pG{Oo(e){}shutdown(){}}const pb="ConnectivityMonitor";class mb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ye(pb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ye(pb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ap=null;function Tx(){return ap===null?ap=(function(){return 268435456+Math.round(2147483648*Math.random())})():ap++,"0x"+ap.toString(16)}const sv="RestConnection",mG={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class yG{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===pm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=Tx(),l=this.zo(e,t.toUriEncodedString());ye(sv,`Sending RPC '${e}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(l),f=Dl(h);return this.Jo(e,l,u,i,f).then((p=>(ye(sv,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw ly(sv,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",i),p}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Vu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=mG[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class _G{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Mn="WebChannelConnection";class vG extends yG{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=Tx();return new Promise(((l,u)=>{const h=new Hk;h.setWithCredentials(!0),h.listenOnce(Kk.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case xp.NO_ERROR:const p=h.getResponseJson();ye(Mn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case xp.TIMEOUT:ye(Mn,`RPC '${e}' ${o} timed out`),u(new be(ce.DEADLINE_EXCEEDED,"Request time out"));break;case xp.HTTP_ERROR:const _=h.getStatus();if(ye(Mn,`RPC '${e}' ${o} failed with status:`,_,"response text:",h.getResponseText()),_>0){let x=h.getResponseJson();Array.isArray(x)&&(x=x[0]);const S=x?.error;if(S&&S.status&&S.message){const I=(function(b){const N=b.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(N)>=0?N:ce.UNKNOWN})(S.status);u(new be(I,S.message))}else u(new be(ce.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new be(ce.UNAVAILABLE,"Connection failed."));break;default:Ne(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{ye(Mn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);ye(Mn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=Tx(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Yk(),l=Xk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const f=s.join("");ye(Mn,`Creating RPC '${e}' stream ${r}: ${f}`,u);const p=o.createWebChannel(f,u);this.I_(p);let _=!1,x=!1;const S=new _G({Yo:T=>{x?ye(Mn,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(_||(ye(Mn,`Opening RPC '${e}' stream ${r} transport.`),p.open(),_=!0),ye(Mn,`RPC '${e}' stream ${r} sending:`,T),p.send(T))},Zo:()=>p.close()}),I=(T,b,N)=>{T.listen(b,(M=>{try{N(M)}catch(L){setTimeout((()=>{throw L}),0)}}))};return I(p,ed.EventType.OPEN,(()=>{x||(ye(Mn,`RPC '${e}' stream ${r} transport opened.`),S.o_())})),I(p,ed.EventType.CLOSE,(()=>{x||(x=!0,ye(Mn,`RPC '${e}' stream ${r} transport closed`),S.a_(),this.E_(p))})),I(p,ed.EventType.ERROR,(T=>{x||(x=!0,ly(Mn,`RPC '${e}' stream ${r} transport errored. Name:`,T.name,"Message:",T.message),S.a_(new be(ce.UNAVAILABLE,"The operation could not be completed")))})),I(p,ed.EventType.MESSAGE,(T=>{if(!x){const b=T.data[0];Oe(!!b,16349);const N=b,M=N?.error||N[0]?.error;if(M){ye(Mn,`RPC '${e}' stream ${r} received error:`,M);const L=M.status;let O=(function(C){const D=Kt[C];if(D!==void 0)return gW(D)})(L),U=M.message;O===void 0&&(O=ce.INTERNAL,U="Unknown error status: "+L+" with message "+M.message),x=!0,S.a_(new be(O,U)),p.close()}else ye(Mn,`RPC '${e}' stream ${r} received:`,b),S.u_(b)}})),I(l,qk.STAT_EVENT,(T=>{T.stat===rx.PROXY?ye(Mn,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===rx.NOPROXY&&ye(Mn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function xG(){return typeof window<"u"?window:null}function bp(){return typeof document<"u"?document:null}function gD(n){return new _W(n,!0)}class pD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&ye("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const yb="PersistentStream";class wG{constructor(e,t,i,r,s,o,l,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new pD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ce.RESOURCE_EXHAUSTED?(Ci(t.toString()),Ci("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new be(ce.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ye(yb,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ye(yb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class EG extends wG{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=TW(e.writeResults,e.commitTime),i=Cr(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=wW(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>xm(this.serializer,i)))};this.q_(t)}}class TG{}class SG extends TG{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new be(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,_x(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new be(ce.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,_x(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new be(ce.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class IG{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ci(t),this.aa=!1):ye("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ty="RemoteStore";class CG{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{Iy(this)&&(ye(Ty,"Restarting streams for network reachability change."),await(async function(u){const h=St(u);h.Ea.add(4),await Sy(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Ow(h)})(this))}))})),this.Ra=new IG(i,r)}}async function Ow(n){if(Iy(n))for(const e of n.da)await e(!0)}async function Sy(n){for(const e of n.da)await e(!1)}function Iy(n){return St(n).Ea.size===0}async function mD(n,e,t){if(!Ll(e))throw e;n.Ea.add(1),await Sy(n),n.Ra.set("Offline"),t||(t=()=>fG(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ye(Ty,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Ow(n)}))}function yD(n,e){return e().catch((t=>mD(n,t,e)))}async function Cy(n){const e=St(n),t=oa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ul;for(;RG(e);)try{const r=await gG(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,bG(e,r)}catch(r){await mD(e,r)}_D(e)&&vD(e)}function RG(n){return Iy(n)&&n.Ta.length<10}function bG(n,e){n.Ta.push(e);const t=oa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function _D(n){return Iy(n)&&!oa(n).x_()&&n.Ta.length>0}function vD(n){oa(n).start()}async function AG(n){oa(n).ra()}async function PG(n){const e=oa(n);for(const t of n.Ta)e.ea(t.mutations)}async function kG(n,e,t){const i=n.Ta.shift(),r=Aw.from(i,e,t);await yD(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Cy(n)}async function NG(n,e){e&&oa(n).X_&&await(async function(i,r){if((function(o){return fW(o)&&o!==ce.ABORTED})(r.code)){const s=i.Ta.shift();oa(i).B_(),await yD(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await Cy(i)}})(n,e),_D(n)&&vD(n)}async function DG(n,e){const t=St(n);e?(t.Ea.delete(2),await Ow(t)):e||(t.Ea.add(2),await Sy(t),t.Ra.set("Unknown"))}function oa(n){return n.fa||(n.fa=(function(t,i,r){const s=St(t);return s.sa(),new EG(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:AG.bind(null,n),r_:NG.bind(null,n),ta:PG.bind(null,n),na:kG.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Cy(n)):(await n.fa.stop(),n.Ta.length>0&&(ye(Ty,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class jw{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new cl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new jw(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new be(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function MG(n,e){if(Ci("AsyncQueue",`${e}: ${n}`),Ll(n))return new be(ce.UNAVAILABLE,`${e}: ${n}`);throw n}class LG{constructor(){this.queries=_b(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=St(t),s=r.queries;r.queries=_b(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(i)}))})(this,new be(ce.ABORTED,"Firestore shutting down"))}}function _b(){return new ca((n=>LN(n)),MN)}function OG(n){n.Ca.forEach((e=>{e.next()}))}var vb,xb;(xb=vb||(vb={})).Ma="default",xb.Cache="cache";const jG="SyncEngine";class FG{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ca((l=>LN(l)),MN),this.Iu=new Map,this.Eu=new Set,this.du=new di(Ie.comparator),this.Au=new Map,this.Ru=new Dw,this.Vu={},this.mu=new Map,this.fu=bl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function wb(n,e,t){const i=St(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const u=St(o);u.onlineState=l;let h=!1;u.queries.forEach(((f,p)=>{for(const _ of p.Sa)_.va(l)&&(h=!0)})),h&&OG(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function VG(n,e){const t=St(n),i=e.batch.batchId;try{const r=await dG(t.localStore,e);wD(t,i,null),xD(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Fw(t,r)}catch(r){await cy(r)}}async function zG(n,e,t){const i=St(n);try{const r=await(function(o,l){const u=St(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next((p=>(Oe(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);wD(i,e,t),xD(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Fw(i,r)}catch(r){await cy(r)}}function xD(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function wD(n,e,t){const i=St(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function Fw(n,e,t){const i=St(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){r.push(h);const f=Lw.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const f=St(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>Q.forEach(h,(_=>Q.forEach(_.Es,(x=>f.persistence.referenceDelegate.addReference(p,_.targetId,x))).next((()=>Q.forEach(_.ds,(x=>f.persistence.referenceDelegate.removeReference(p,_.targetId,x)))))))))}catch(p){if(!Ll(p))throw p;ye(cG,"Failed to update sequence numbers: "+p)}for(const p of h){const _=p.targetId;if(!p.fromCache){const x=f.Ms.get(_),S=x.snapshotVersion,I=x.withLastLimboFreeSnapshotVersion(S);f.Ms=f.Ms.insert(_,I)}}})(i.localStore,s))}async function UG(n,e){const t=St(n);if(!t.currentUser.isEqual(e)){ye(jG,"User change. New user:",e.toKey());const i=await hG(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new be(ce.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Fw(t,i.Ls)}}function BG(n){const e=St(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VG.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zG.bind(null,e),e}class Sx{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gD(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return dD(this.persistence,new hD,e.initialUser,this.serializer)}Cu(e){return new uD(Ey.mi,this.serializer)}Du(e){return new fD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sx.provider={build:()=>new Sx};class WG extends Sx{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await BG(this.xu.syncEngine),await Cy(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return dD(this.persistence,new hD,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new GW(i,e.asyncQueue,t)}Mu(e,t){const i=new s7(t,this.persistence);return new r7(e.asyncQueue,i)}Cu(e){const t=aG(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?ii.withCacheSize(this.cacheSizeBytes):ii.DEFAULT;return new Mw(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,xG(),bp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new fD}}class Ix{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>wb(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=UG.bind(null,this.syncEngine),await DG(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new LG})()}createDatastore(e){const t=gD(e.databaseInfo.databaseId),i=(function(s){return new vG(s)})(e.databaseInfo);return(function(s,o,l,u){return new SG(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new CG(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>wb(this.syncEngine,t,0)),(function(){return mb.v()?new mb:new pG})())}createSyncEngine(e,t){return(function(r,s,o,l,u,h,f){const p=new FG(r,s,o,l,u,h);return f&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=St(t);ye(Ty,"RemoteStore shutting down."),i.Ea.add(5),await Sy(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ix.provider={build:()=>new Ix};const Eb="FirestoreClient";class GG{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Tn.UNAUTHENTICATED,this.clientId=Jk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{ye(Eb,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(ye(Eb,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=MG(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function ED(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const Tb=new Map;const TD="firestore.googleapis.com",Sb=!0;class Ib{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new be(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=TD,this.ssl=Sb}else this.host=e.host,this.ssl=e.ssl??Sb;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=iD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<BW)throw new be(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Q8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ED(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new be(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new be(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new be(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class SD{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ib({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new be(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new be(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ib(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new B8;switch(i.type){case"firstParty":return new H8(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new be(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Tb.get(t);i&&(ye("ComponentProvider","Removing Datastore"),Tb.delete(t),i.terminate())})(this),Promise.resolve()}}function $G(n,e,t,i={}){n=tN(n,SD);const r=Dl(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(ew(`https://${l}`),tw("Firestore",!0)),s.host!==TD&&s.host!==l&&ly("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:r,emulatorOptions:i};if(!wl(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=Tn.MOCK_USER;else{h=ok(i.mockUserToken,n._app?.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new be(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Tn(p)}n._authCredentials=new W8(new Qk(h,f))}}class Vw{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Vw(this.firestore,e,this._query)}}class rs{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zw(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rs(this.firestore,e,this._key)}toJSON(){return{type:rs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Sf(t,rs._jsonSchema))return new rs(e,i||null,new Ie(Rt.fromString(t.referencePath)))}}rs._jsonSchemaVersion="firestore/documentReference/1.0",rs._jsonSchema={type:Xt("string",rs._jsonSchemaVersion),referencePath:Xt("string")};class zw extends Vw{constructor(e,t,i){super(e,t,DN(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rs(this.firestore,null,new Ie(e))}withConverter(e){return new zw(this.firestore,e,this._path)}}const Cb="AsyncQueue";class Rb{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new pD(this,"async_queue_retry"),this._c=()=>{const i=bp();i&&ye(Cb,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=bp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=bp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new cl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ll(e))throw e;ye(Cb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ci("INTERNAL UNHANDLED ERROR: ",bb(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=jw.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Ne(47125,{Pc:bb(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function bb(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class ID extends SD{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Rb,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Rb(e),this._firestoreClient=void 0,await e}}}function HG(n,e){const t=typeof n=="object"?n:rw(),i=typeof n=="string"?n:pm,r=ry(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=ik("firestore");s&&$G(r,...s)}return r}function KG(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new L7(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,ED(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new GG(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function qG(n,e){ly("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return XG(n,Ix.provider,{build:i=>new WG(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function XG(n,e,t){if((n=tN(n,ID))._firestoreClient||n._terminated)throw new be(ce.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new be(ce.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},KG(n)}class Fs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fs(fi.fromBase64String(e))}catch(t){throw new be(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Fs(fi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Fs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Sf(e,Fs._jsonSchema))return Fs.fromBase64String(e.bytes)}}Fs._jsonSchemaVersion="firestore/bytes/1.0",Fs._jsonSchema={type:Xt("string",Fs._jsonSchemaVersion),bytes:Xt("string")};class CD{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new be(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class dl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new be(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new be(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:dl._jsonSchemaVersion}}static fromJSON(e){if(Sf(e,dl._jsonSchema))return new dl(e.latitude,e.longitude)}}dl._jsonSchemaVersion="firestore/geoPoint/1.0",dl._jsonSchema={type:Xt("string",dl._jsonSchemaVersion),latitude:Xt("number"),longitude:Xt("number")};class fl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:fl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Sf(e,fl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new fl(e.vectorValues);throw new be(ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fl._jsonSchemaVersion="firestore/vectorValue/1.0",fl._jsonSchema={type:Xt("string",fl._jsonSchemaVersion),vectorValues:Xt("object")};const YG=new RegExp("[~\\*/\\[\\]]");function ZG(n,e,t){if(e.search(YG)>=0)throw Ab(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new CD(...e.split("."))._internalPath}catch{throw Ab(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function Ab(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new be(ce.INVALID_ARGUMENT,s+n+o)}class RD{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new rs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QG(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(bD("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class QG extends RD{data(){return super.data()}}function bD(n,e){return typeof e=="string"?ZG(n,e):e instanceof CD?e._internalPath:e._delegate._internalPath}class lp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class iu extends RD{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ap(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(bD("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new be(ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=iu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}iu._jsonSchemaVersion="firestore/documentSnapshot/1.0",iu._jsonSchema={type:Xt("string",iu._jsonSchemaVersion),bundleSource:Xt("string","DocumentSnapshot"),bundleName:Xt("string"),bundle:Xt("string")};class Ap extends iu{data(e={}){return super.data(e)}}class _d{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new lp(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Ap(this._firestore,this._userDataWriter,i.key,i,new lp(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new be(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const u=new Ap(r._firestore,r._userDataWriter,l.doc.key,l.doc,new lp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new Ap(r._firestore,r._userDataWriter,l.doc.key,l.doc,new lp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:JG(l.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new be(ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=_d._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Jk.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function JG(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ne(61501,{type:n})}}_d._jsonSchemaVersion="firestore/querySnapshot/1.0",_d._jsonSchema={type:Xt("string",_d._jsonSchemaVersion),bundleSource:Xt("string","QuerySnapshot"),bundleName:Xt("string"),bundle:Xt("string")};(function(e,t=!0){(function(r){Vu=r})(Ml),El(new ia("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new ID(new G8(i.getProvider("auth-internal")),new K8(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new be(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Su(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),as(vR,xR,e),as(vR,xR,"esm2020")})();const AD="firebasestorage.googleapis.com",e$="storageBucket",t$=120*1e3,n$=600*1e3;class ps extends gs{constructor(e,t,i=0){super(ov(e),`Firebase Storage: ${t} (${ov(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ps.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ov(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var hs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(hs||(hs={}));function ov(n){return"storage/"+n}function i$(){const n="An unknown error occurred, please check the error payload for server response.";return new ps(hs.UNKNOWN,n)}function r$(){return new ps(hs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function s$(){return new ps(hs.CANCELED,"User canceled the upload/download.")}function o$(n){return new ps(hs.INVALID_URL,"Invalid URL '"+n+"'.")}function a$(n){return new ps(hs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Pb(n){return new ps(hs.INVALID_ARGUMENT,n)}function PD(){return new ps(hs.APP_DELETED,"The Firebase app was deleted.")}function l$(n){return new ps(hs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Tr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Tr.makeFromUrl(e,t)}catch{return new Tr(e,"")}if(i.path==="")return i;throw a$(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(L){L.path_=decodeURIComponent(L.path)}const f="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",x=new RegExp(`^https?://${p}/${f}/b/${r}/o${_}`,"i"),S={bucket:1,path:3},I=t===AD?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",b=new RegExp(`^https?://${I}/${r}/${T}`,"i"),M=[{regex:l,indices:u,postModify:s},{regex:x,indices:S,postModify:h},{regex:b,indices:{bucket:1,path:2},postModify:h}];for(let L=0;L<M.length;L++){const O=M[L],U=O.regex.exec(e);if(U){const P=U[O.indices.bucket];let C=U[O.indices.path];C||(C=""),i=new Tr(P,C),O.postModify(i);break}}if(i==null)throw o$(e);return i}}class c${constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function u$(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function f(...T){h||(h=!0,e.apply(null,T))}function p(T){r=setTimeout(()=>{r=null,n(x,u())},T)}function _(){s&&clearTimeout(s)}function x(T,...b){if(h){_();return}if(T){_(),f.call(null,T,...b);return}if(u()||o){_(),f.call(null,T,...b);return}i<64&&(i*=2);let M;l===1?(l=2,M=0):M=(i+Math.random())*1e3,p(M)}let S=!1;function I(T){S||(S=!0,_(),!h&&(r!==null?(T||(l=2),clearTimeout(r),p(0)):T||(l=1)))}return p(0),s=setTimeout(()=>{o=!0,I(!0)},t),I}function h$(n){n(!1)}function d$(n){return n!==void 0}function kb(n,e,t,i){if(i<e)throw Pb(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Pb(`Invalid value for '${n}'. Expected ${t} or less.`)}function f$(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var Sm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Sm||(Sm={}));function g$(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class p${constructor(e,t,i,r,s,o,l,u,h,f,p,_=!0,x=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=p,this.retry=_,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,I)=>{this.resolve_=S,this.reject_=I,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new cp(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===Sm.NO_ERROR,u=s.getStatus();if(!l||g$(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===Sm.ABORT;i(!1,new cp(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new cp(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());d$(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=i$();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?PD():s$();o(u)}else{const u=r$();o(u)}};this.canceled_?t(!1,new cp(!1,null,!0)):this.backoffId_=u$(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&h$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class cp{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function m$(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function y$(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function _$(n,e){e&&(n["X-Firebase-GMPID"]=e)}function v$(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function x$(n,e,t,i,r,s,o=!0,l=!1){const u=f$(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return _$(f,e),m$(f,t),y$(f,s),v$(f,i),new p$(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function w$(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function E$(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Im{constructor(e,t){this._service=e,t instanceof Tr?this._location=t:this._location=Tr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Im(e,t)}get root(){const e=new Tr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return E$(this._location.path)}get storage(){return this._service}get parent(){const e=w$(this._location.path);if(e===null)return null;const t=new Tr(this._location.bucket,e);return new Im(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw l$(e)}}function Nb(n,e){const t=e?.[e$];return t==null?null:Tr.makeFromBucketSpec(t,n)}function T$(n,e,t,i={}){n.host=`${e}:${t}`;const r=Dl(e);r&&(ew(`https://${n.host}/b`),tw("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:ok(s,n.app.options.projectId))}class S${constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=AD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=t$,this._maxUploadRetryTime=n$,this._requests=new Set,r!=null?this._bucket=Tr.makeFromBucketSpec(r,this._host):this._bucket=Nb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Tr.makeFromBucketSpec(this._url,e):this._bucket=Nb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){kb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){kb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Yi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Im(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new c$(PD());{const o=x$(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const Db="@firebase/storage",Mb="0.14.0";const kD="storage";function I$(n=rw(),e){n=no(n);const i=ry(n,kD).getImmediate({identifier:e}),r=ik("storage");return r&&C$(i,...r),i}function C$(n,e,t,i={}){T$(n,e,t,i)}function R$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new S$(t,i,r,e,Ml)}function b$(){El(new ia(kD,R$,"PUBLIC").setMultipleInstances(!0)),as(Db,Mb,""),as(Db,Mb,"esm2020")}b$();const A$={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},Uw=fk(A$),av=F8(Uw),P$=HG(Uw);I$(Uw);qG(P$).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const k$="visvriend2024",N$=new js,ND=Ar()(_f((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===k$;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await KB(av,N$);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await RB(av),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{CB(av,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})})),Bw="https://waterwebservices.rijkswaterstaat.nl/ONLINEWAARNEMINGENSERVICES_DBO",Qd=[{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556,x:97580,y:497920},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664,x:75580,y:458220},{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12,x:65150,y:444150},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961,x:30410,y:385360},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456,x:109200,y:553200},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083,x:158e3,y:576500},{id:"TERSLNZE",name:"Terschelling",lat:53.4397,lng:5.3281,x:155e3,y:606e3},{id:"TEXLHORS",name:"Texel Hors",lat:52.9983,lng:4.6981,x:106e3,y:557e3},{id:"EEMHVN",name:"Eemhaven",lat:51.9,lng:4.4833,x:9e4,y:436e3},{id:"KATSVR",name:"Kats",lat:51.5694,lng:3.9389,x:53e3,y:399e3}];function D$(n,e){let t=Qd[0],i=1/0;for(const r of Qd){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}async function M$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"T"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Bw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching water temperature:",r),null}}async function L$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"GOLFHTE"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Bw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching wave height:",r),null}}async function O$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"STROOMSHD"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Bw}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0){const l=o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null;return l!==null?{speed:l,direction:0}:null}}return null}catch(r){return console.error("Error fetching current speed:",r),null}}async function j$(n){const[e,t,i]=await Promise.all([M$(n),L$(n),O$(n)]);return{temperature:e??void 0,waveHeight:t??void 0,currentSpeed:i?.speed??void 0,currentDirection:i?.direction??void 0,timestamp:new Date,station:n}}function Lb(n){const e=new Date().getMonth(),i=[5,4,5,8,12,16,18,19,17,13,9,6][e]+(Math.random()*2-1),r=30+Math.random()*80,s=Math.random()*60,o=Math.random()*360;return{temperature:Math.round(i*10)/10,waveHeight:Math.round(r),currentSpeed:Math.round(s),currentDirection:Math.round(o),timestamp:new Date,station:n}}const Ob=Ar((n,e)=>({station:Qd[1],waterData:null,lastUpdated:null,isLoading:!1,error:null,useSimulatedData:!0,setStation:t=>n({station:t}),setStationByPosition:(t,i)=>{const r=D$(t,i);n({station:r})},fetchData:async()=>{const{station:t,useSimulatedData:i}=e();if(t){n({isLoading:!0,error:null});try{let r;i?r=Lb(t):r=await j$(t),n({waterData:r,lastUpdated:new Date,isLoading:!1})}catch(r){console.error("Error fetching water data:",r);const s=Lb(t);n({waterData:s,lastUpdated:new Date,isLoading:!1,error:"Kon geen live data ophalen, gesimuleerde data wordt getoond"})}}},setUseSimulatedData:t=>n({useSimulatedData:t})}));function F$({target:n}){const e=q.useRef(null),t=q.useRef(null),i=fs(s=>s.setMap),r=He(s=>s.showScaleBar);return q.useEffect(()=>{if(!e.current){const s=new C9({target:n,controls:[],view:new es({center:pl([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),q.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new A9({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const V$=["OpenStreetMap","Luchtfoto","Terrein","CartoDB Light"];function z$(){const n=q.useRef(null),e=q.useRef(!1);F$({target:"map"});const t=fs(u=>u.map),i=Xi(u=>u.registerLayer),r=Xi(u=>u.setLayerVisibility);Xi(u=>u.setLayerOpacity);const s=He(u=>u.defaultBackground),o=He(u=>u.gpsAutoStart),l=ai(u=>u.startTracking);return q.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const u=He.getState().defaultBackground||"CartoDB Light",h=u==="OpenStreetMap",f=u==="Luchtfoto",p=u==="Terrein",_=u==="CartoDB Light";console.log("Background setting:",u);const x=new Mh({properties:{title:"CartoDB Light",type:"base"},visible:_,source:new Jh({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20})}),S=new Mh({properties:{title:"Terrein",type:"base"},visible:p,source:new Jh({url:"https://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors, SRTM | Map style:  OpenTopoMap (CC-BY-SA)",maxZoom:17})}),I=new Mh({properties:{title:"OpenStreetMap",type:"base"},visible:h,source:new H6}),T=new Mh({properties:{title:"Luchtfoto",type:"base"},visible:f,source:new Jh({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),b=new Mh({properties:{title:"Labels Overlay",type:"overlay"},visible:f,source:new Jh({url:"https://{a-d}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})});t.addLayer(x),t.addLayer(S),t.addLayer(I),t.addLayer(T),t.addLayer(b),i("CartoDB Light",x),i("Terrein",S),i("OpenStreetMap",I),i("Luchtfoto",T),i("Labels Overlay",b),r("CartoDB Light",_),r("Terrein",p),r("OpenStreetMap",h),r("Luchtfoto",f),r("Labels Overlay",f),t.updateSize(),N();async function N(){const M=tz();console.log(`Loading ${M.length} immediate layers...`),(await Promise.allSettled(M.map(async O=>{try{const U=await O.factory();return U?{name:O.name,layer:U}:null}catch(U){return console.warn(`Failed to create ${O.name}:`,U),null}}))).forEach(O=>{if(O.status==="fulfilled"&&O.value){const{name:U,layer:P}=O.value;t.addLayer(P),i(U,P)}})}},[t,i]),q.useEffect(()=>{if(!t||e.current)return;const u=setTimeout(()=>{const h=s||"OpenStreetMap";V$.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(u)},[t,s,r]),q.useEffect(()=>{if(!t||!o)return;const u=setTimeout(()=>l(),500);return()=>clearTimeout(u)},[t,o,l]),y.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const U$=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),B$=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),jb=n=>{const e=B$(n);return e.charAt(0).toUpperCase()+e.slice(1)},DD=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),W$=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var G$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const $$=q.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},u)=>q.createElement("svg",{ref:u,...G$,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:DD("lucide",r),...!s&&!W$(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>q.createElement(h,f)),...Array.isArray(s)?s:[s]]));const Ae=(n,e)=>{const t=q.forwardRef(({className:i,...r},s)=>q.createElement($$,{ref:s,iconNode:e,className:DD(`lucide-${U$(jb(n))}`,`lucide-${n}`,i),...r}));return t.displayName=jb(n),t};const H$=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],MD=Ae("anchor",H$);const K$=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],q$=Ae("book-open",K$);const X$=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Ww=Ae("camera",X$);const Y$=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],LD=Ae("chart-column",Y$);const Z$=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Cm=Ae("check",Z$);const Q$=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],J$=Ae("chevron-down",Q$);const eH=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],tH=Ae("chevron-left",eH);const nH=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Xc=Ae("chevron-right",nH);const iH=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],OD=Ae("chevron-up",iH);const rH=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],sH=Ae("cloud-fog",rH);const oH=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],aH=Ae("cloud-lightning",oH);const lH=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],bf=Ae("cloud-rain",lH);const cH=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],uH=Ae("cloud-snow",cH);const hH=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],ku=Ae("cloud",hH);const dH=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],Gw=Ae("droplets",dH);const fH=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],jD=Ae("external-link",fH);const gH=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],pH=Ae("eye-off",gH);const mH=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],yH=Ae("eye",mH);const _H=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],vH=Ae("file-text",_H);const xH=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],Qs=Ae("fish",xH);const wH=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],FD=Ae("gauge",wH);const EH=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],TH=Ae("image-plus",EH);const SH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],VD=Ae("info",SH);const IH=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Jd=Ae("layers",IH);const CH=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],RH=Ae("loader-circle",CH);const bH=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],AH=Ae("locate-fixed",bH);const PH=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],kH=Ae("lock",PH);const NH=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],DH=Ae("log-out",NH);const MH=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Js=Ae("map-pin",MH);const LH=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Ry=Ae("map",LH);const OH=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],jH=Ae("menu",OH);const FH=[["path",{d:"M5 12h14",key:"1ays0h"}]],zD=Ae("minus",FH);const VH=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],zH=Ae("mountain",VH);const UH=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],Nu=Ae("navigation",UH);const BH=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],WH=Ae("pause",BH);const GH=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],$H=Ae("person-standing",GH);const HH=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],KH=Ae("play",HH);const qH=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],XH=Ae("plus",qH);const YH=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ZH=Ae("refresh-cw",YH);const QH=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],JH=Ae("rotate-ccw",QH);const eK=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],tK=Ae("ruler",eK);const nK=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],iK=Ae("save",nK);const rK=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],sK=Ae("scale",rK);const oK=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Cx=Ae("search",oK);const aK=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],lK=Ae("settings",aK);const cK=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],uK=Ae("ship",cK);const hK=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],dK=Ae("sparkles",hK);const fK=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Rx=Ae("star",fK);const gK=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],pK=Ae("sun",gK);const mK=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],yK=Ae("tag",mK);const _K=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],UD=Ae("thermometer",_K);const vK=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],BD=Ae("trending-down",vK);const xK=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],WD=Ae("trending-up",xK);const wK=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],EK=Ae("type",wK);const TK=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],SK=Ae("user",TK);const IK=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],Rm=Ae("waves",IK);const CK=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],bx=Ae("wind",CK);const RK=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],gi=Ae("x",RK);async function bK(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e(null);return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,p=r.getUint16(f)===18761,_=AK(r,f,p);e(_);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e(null)},t.onerror=()=>e(null),t.readAsArrayBuffer(n)})}function AK(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null;for(let p=0;p<r;p++){const _=i+2+p*12;if(n.getUint16(_,t)===34853){s=e+n.getUint32(_+8,t);break}}if(!s)return null;const o=n.getUint16(s,t);let l=null,u=null,h=null,f=null;for(let p=0;p<o;p++){const _=s+2+p*12,x=n.getUint16(_,t),S=n.getUint16(_+2,t),I=n.getUint32(_+4,t),T=_+8;switch(x){case 1:l=String.fromCharCode(n.getUint8(T));break;case 2:u=Fb(n,e+n.getUint32(T,t),3,t);break;case 3:h=String.fromCharCode(n.getUint8(T));break;case 4:f=Fb(n,e+n.getUint32(T,t),3,t);break}}if(u&&f&&l&&h){const p=Vb(u[0],u[1],u[2],l),_=Vb(f[0],f[1],f[2],h);if(!isNaN(p)&&!isNaN(_))return{lat:p,lng:_}}return null}catch{return null}}function Fb(n,e,t,i){const r=[];for(let s=0;s<t;s++){const o=n.getUint32(e+s*8,i),l=n.getUint32(e+s*8+4,i);r.push(l===0?0:o/l)}return r}function Vb(n,e,t,i){let r=n+e/60+t/3600;return(i==="S"||i==="W")&&(r=-r),r}const GD=200,PK=.7;async function kK(n,e=GD){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,u=r.height;l>u?l>e&&(u=Math.round(u*e/l),l=e):u>e&&(l=Math.round(l*e/u),u=e),s.width=l,s.height=u,o?.drawImage(r,0,0,l,u),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",PK)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function NK(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function $D(n){const e=await kK(n,GD),t=await NK(e);return{thumbnailBlob:e,thumbnailBase64:t}}function HD(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function DK(){const n=fs(G=>G.map),e=Fn(G=>G.openCatchForm),t=He(G=>G.showWeatherWidget),i=He(G=>G.setShowWeatherWidget),r=He(G=>G.showWindIndicator),s=He(G=>G.setShowWindIndicator),o=He(G=>G.showTideWidget),l=He(G=>G.setShowTideWidget),u=He(G=>G.showBuienradarWidget),h=He(G=>G.setShowBuienradarWidget),f=He(G=>G.showWaterflowWidget),p=He(G=>G.setShowWaterflowWidget),_=He(G=>G.showForecastSlider),x=He(G=>G.setShowForecastSlider),[S,I]=q.useState(null),[T,b]=q.useState(!1),[N,M]=q.useState(!1),[L,O]=q.useState(!1),U=q.useRef(null),P=q.useRef(null);q.useEffect(()=>{if(!n)return;const G=n.getViewport();if(!G)return;const ie=600,ne=15,W=we=>{if(we.touches.length!==1)return;const Ce=we.touches[0];P.current={x:Ce.clientX,y:Ce.clientY},U.current&&clearTimeout(U.current),U.current=window.setTimeout(()=>{if(!P.current)return;const Be=window.__olMap;if(!Be)return;const Wt=G.getBoundingClientRect(),Un=[P.current.x-Wt.left,P.current.y-Wt.top],Yt=Be.getCoordinateFromPixel(Un);if(Yt){const bn=Nv(Yt);we.preventDefault(),I({pixel:[P.current.x,P.current.y],coordinate:bn}),b(!0),M(!1),setTimeout(()=>M(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},ie)},$=we=>{if(!U.current||!P.current)return;const Ce=we.touches[0],Be=Ce.clientX-P.current.x,Wt=Ce.clientY-P.current.y;Math.sqrt(Be*Be+Wt*Wt)>ne&&(clearTimeout(U.current),U.current=null)},oe=()=>{U.current&&(clearTimeout(U.current),U.current=null),P.current=null},me=we=>{T&&we.preventDefault()},xe=we=>{we.button===0&&(P.current={x:we.clientX,y:we.clientY},U.current&&clearTimeout(U.current),U.current=window.setTimeout(()=>{if(!P.current)return;const Ce=window.__olMap;if(!Ce)return;const Be=G.getBoundingClientRect(),Wt=[P.current.x-Be.left,P.current.y-Be.top],Un=Ce.getCoordinateFromPixel(Wt);if(Un){const Yt=Nv(Un);I({pixel:[P.current.x,P.current.y],coordinate:Yt}),b(!0),M(!1),setTimeout(()=>M(!0),300)}},ie))},re=we=>{if(!U.current||!P.current)return;const Ce=we.clientX-P.current.x,Be=we.clientY-P.current.y;Math.sqrt(Ce*Ce+Be*Be)>ne&&(clearTimeout(U.current),U.current=null)},_e=()=>{U.current&&(clearTimeout(U.current),U.current=null),P.current=null};return G.addEventListener("touchstart",W,{passive:!1}),G.addEventListener("touchmove",$,{passive:!0}),G.addEventListener("touchend",oe),G.addEventListener("touchcancel",oe),G.addEventListener("contextmenu",me),G.addEventListener("mousedown",xe),G.addEventListener("mousemove",re),G.addEventListener("mouseup",_e),G.addEventListener("mouseleave",_e),()=>{G.removeEventListener("touchstart",W),G.removeEventListener("touchmove",$),G.removeEventListener("touchend",oe),G.removeEventListener("touchcancel",oe),G.removeEventListener("contextmenu",me),G.removeEventListener("mousedown",xe),G.removeEventListener("mousemove",re),G.removeEventListener("mouseup",_e),G.removeEventListener("mouseleave",_e),U.current&&clearTimeout(U.current)}},[n,T]);const C=()=>{N&&(b(!1),I(null),M(!1))},D=()=>{b(!1),I(null),M(!1),O(!1)},F=q.useRef(null),V=()=>{if(!S)return;const[G,ie]=S.coordinate;e({location:{lat:ie,lng:G},locationSource:"map"}),D()},B=()=>{F.current?.click()},k=async G=>{const ie=G.target.files?.[0];if(!(!ie||!S)){try{const ne=await bK(ie),{thumbnailBase64:W}=await $D(ie),$={id:HD(),thumbnailBase64:W,createdAt:new Date().toISOString(),pendingUpload:!0};if(ne)e({location:ne,locationSource:"photo",photos:[$]});else{const[oe,me]=S.coordinate;e({location:{lat:me,lng:oe},locationSource:"map",photos:[$]})}}catch(ne){console.error("Failed to process photo:",ne);const[W,$]=S.coordinate;e({location:{lat:$,lng:W},locationSource:"map"})}G.target.value="",D()}},te=()=>{if(!S)return;const[G,ie]=S.coordinate,ne=`https://www.google.com/maps?q=${ie},${G}`;window.open(ne,"_blank"),D()},de=()=>{if(!S)return;const[G,ie]=S.coordinate,ne=`https://www.google.com/maps?layer=c&cbll=${ie},${G}`;window.open(ne,"_blank"),D()},ge=G=>{const[ie,ne]=G;return`${ne.toFixed(5)}N, ${ie.toFixed(5)}E`},ue=()=>{if(!S)return{};const G=220,ie=340,W=L?ie+280:ie;let $=S.pixel[0];$+G>window.innerWidth&&($=window.innerWidth-G-10),$<10&&($=10);let oe=S.pixel[1];const me=window.innerHeight-S.pixel[1],xe=S.pixel[1];return me<W&&xe>W?oe=S.pixel[1]-W+40:me<W&&(oe=Math.max(10,window.innerHeight-W-10)),{left:$,top:oe}};return y.jsx(Vn,{children:T&&S&&y.jsxs(y.Fragment,{children:[y.jsx(We.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:C}),y.jsxs(We.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none max-h-[90vh] overflow-y-auto",style:ue(),initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[y.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:y.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[y.jsx(Js,{size:16}),y.jsx("span",{className:"text-xs font-mono",children:ge(S.coordinate)})]})}),y.jsxs("div",{className:"bg-white",children:[y.jsxs("button",{onClick:B,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(Ww,{size:20,className:"text-green-500"}),y.jsx("span",{className:"font-medium",children:"Maak foto"})]}),y.jsxs("button",{onClick:V,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(Qs,{size:20,className:"text-orange-500"}),y.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),y.jsxs("button",{onClick:de,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx($H,{size:20,className:"text-yellow-600"}),y.jsx("span",{className:"font-medium",children:"Street View"})]}),y.jsxs("button",{onClick:te,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(jD,{size:20,className:"text-blue-600"}),y.jsx("span",{className:"font-medium",children:"Google Maps"})]}),y.jsxs("button",{onClick:()=>O(!L),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(ku,{size:20,className:"text-purple-500"}),y.jsx("span",{className:"font-medium",children:"Widgets"}),y.jsx(Xc,{size:16,className:`ml-auto text-gray-400 transition-transform ${L?"rotate-90":""}`})]}),y.jsx(Vn,{children:L&&y.jsx(We.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden bg-gray-50 border-t border-gray-100",children:y.jsxs("div",{className:"py-1 px-2",children:[y.jsx("div",{className:"px-2 py-1.5 text-xs text-gray-400 font-medium",children:"Toon/verberg widgets"}),y.jsx(Nc,{icon:y.jsx(UD,{size:16,className:"text-orange-500"}),label:"Weer & visvriendelijkheid",checked:t,onChange:i}),y.jsx(Nc,{icon:y.jsx(bx,{size:16,className:"text-cyan-500"}),label:"Wind indicator",checked:r,onChange:s}),y.jsx(Nc,{icon:y.jsx(Rm,{size:16,className:"text-blue-500"}),label:"Getijden",checked:o,onChange:l}),y.jsx(Nc,{icon:y.jsx(bf,{size:16,className:"text-indigo-500"}),label:"Buienradar",checked:u,onChange:h}),y.jsx(Nc,{icon:y.jsx(Gw,{size:16,className:"text-cyan-600"}),label:"Waterafvoer rivieren",checked:f,onChange:p}),y.jsx(Nc,{icon:y.jsx(LD,{size:16,className:"text-green-500"}),label:"Voorspelling schuif",checked:_,onChange:x})]})})})]}),y.jsx("input",{ref:F,type:"file",accept:"image/*",capture:"environment",onChange:k,className:"hidden"}),y.jsx("div",{className:"bg-white border-t border-gray-100",children:y.jsxs("button",{onClick:D,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[y.jsx(gi,{size:18}),y.jsx("span",{children:"Annuleren"})]})})]})]})})}function Nc({icon:n,label:e,checked:t,onChange:i}){return y.jsxs("button",{onClick:()=>i(!t),className:"w-full px-2 py-2 flex items-center gap-2 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:[n,y.jsx("span",{className:"text-sm text-gray-700 flex-1 text-left",children:e}),y.jsx("div",{className:`w-9 h-5 rounded-full transition-colors flex-shrink-0 ${t?"bg-orange-500":"bg-gray-300"}`,children:y.jsx("div",{className:"w-4 h-4 mt-0.5 rounded-full bg-white shadow transition-transform",style:{marginLeft:t?"18px":"2px"}})})]})}function MK(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=ai(),s=q.useCallback(l=>{i(l)},[i]),o=q.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return q.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function LK(){const{tracking:n,toggle:e}=MK();return y.jsx(We.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:y.jsx(AH,{size:22,strokeWidth:2})})}const OK="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function jK(){const n=fs(_=>_.map),e=ai(_=>_.position),t=ai(_=>_.accuracy),i=ai(_=>_.tracking),r=ai(_=>_.smoothHeading),s=He(_=>_.showAccuracyCircle),o=ai(_=>_.firstFix),l=ai(_=>_.resetFirstFix),u=q.useRef(null),h=q.useRef(null),f=q.useRef(null),p=q.useMemo(()=>_=>new tr({image:new O1({src:OK,scale:.9,rotation:_,rotateWithView:!1,anchor:[.5,.5]})}),[]);return q.useEffect(()=>{if(!n||!i&&!e)return;const _=pl([5.1214,52.0907]);return u.current=new cu({geometry:new ml(_)}),u.current.setStyle(p(0)),h.current=new cu({geometry:new ml(_)}),f.current=new G1({source:new L1({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,p]),q.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const _=pl([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(_),h.current.getGeometry()?.setCoordinates(_),s&&t){const x=n.getView().getResolution()||1,S=Math.min(t/x,80);h.current.setStyle(new tr({image:new kl({radius:S,fill:new Rr({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new tr({}));if(o&&i){n.getView().setCenter(_),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:_,duration:150})},[n,i,e,t,o,l,s]),q.useEffect(()=>{if(!u.current)return;const _=r!==null?r*Math.PI/180:0;u.current.setStyle(p(_))},[r,p]),null}function FK(){const n=fs(M=>M.map),[e,t]=q.useState(!1),[i,r]=q.useState(""),[s,o]=q.useState([]),[l,u]=q.useState(!1),[h,f]=q.useState(!1),p=q.useRef(null),_=q.useRef(null),x=q.useRef();q.useEffect(()=>{e&&p.current&&p.current.focus()},[e]),q.useEffect(()=>{if(!e)return;const M=L=>{_.current&&!_.current.contains(L.target)&&S()};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[e]),q.useEffect(()=>{if(!e)return;const M=L=>{L.key==="Escape"&&S()};return document.addEventListener("keydown",M),()=>document.removeEventListener("keydown",M)},[e]),q.useEffect(()=>{if(x.current&&clearTimeout(x.current),i.length<2){o([]);return}return x.current=window.setTimeout(async()=>{f(!0);try{const L=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();L.response?.docs&&o(L.response.docs)}catch(M){console.error("Search error:",M),o([])}finally{f(!1)}},300),()=>{x.current&&clearTimeout(x.current)}},[i]);const S=()=>{t(!1),r(""),o([]),u(!1)},I=async M=>{try{const O=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(M)}`)).json();if(O.response?.docs?.[0]?.centroide_ll){const P=O.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(P)return{lng:parseFloat(P[1]),lat:parseFloat(P[2])}}}catch(L){console.error("Lookup error:",L)}return null},T=async M=>{if(!n)return;const L=await I(M.id);L&&n.getView().animate({center:pl([L.lng,L.lat]),zoom:16,duration:1e3}),S()},b=async(M,L)=>{L.stopPropagation();const O=await I(M.id);if(O){const U=`https://www.google.com/maps?q=${O.lat},${O.lng}`;window.open(U,"_blank")}S()},N={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?y.jsxs("div",{ref:_,className:"fixed left-[52px] right-14 z-[850]",style:N,children:[y.jsxs(We.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[y.jsx(Cx,{size:18,className:"search-icon"}),y.jsx("input",{ref:p,type:"text",value:i,onChange:M=>{r(M.target.value),u(!0)},onFocus:()=>u(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),y.jsx("button",{onClick:S,className:"search-clear",title:"Sluiten",children:y.jsx(gi,{size:18})})]}),y.jsx(Vn,{children:l&&s.length>0&&y.jsx(We.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(M=>y.jsxs("li",{className:"search-result-item",children:[y.jsx("div",{className:"search-result-content",onClick:()=>T(M),children:y.jsx("span",{className:"search-result-text",children:M.weergavenaam})}),y.jsx("button",{className:"search-navigate-btn",onClick:L=>b(M,L),title:"Open in Google Maps",children:y.jsx(jD,{size:20})})]},M.id))})}),l&&h&&y.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):y.jsx(We.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:N,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:y.jsx(Cx,{size:22,className:"text-gray-600"})})}function VK({size:n=18}){return y.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[y.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),y.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),y.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),y.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function zK(){const[n,e]=q.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=Fn(),{user:r,loading:s,signInWithGoogle:o,logout:l}=ND(),u=He(T=>T.showCatchButton),h=He(T=>T.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},p=()=>e(!1),_=()=>{p(),t()},x=()=>{p(),i()},S=()=>{p(),o()},I=()=>{p(),l()};return y.jsxs(y.Fragment,{children:[y.jsx(We.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-orange-500 hover:bg-orange-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?y.jsx(gi,{size:22,className:"text-white"}):y.jsx(jH,{size:22,className:"text-gray-600"})}),y.jsx(Vn,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(We.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:p}),y.jsxs(We.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[y.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-orange-500",children:y.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?y.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:y.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-orange-500 rounded-full animate-spin"})}):r?y.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:y.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?y.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):y.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:y.jsx(SK,{size:16,className:"text-white"})}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),y.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),y.jsx("button",{onClick:I,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:y.jsx(DH,{size:16})})]})}):y.jsxs("button",{onClick:S,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[y.jsx(VK,{size:18}),y.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),y.jsx("div",{className:"py-1",children:y.jsxs("button",{onClick:_,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[y.jsx(VD,{size:18,className:"text-blue-500"}),y.jsx("span",{children:"Info & handleiding"})]})}),y.jsx("div",{className:"py-1 border-t border-gray-100",children:y.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(Qs,{size:18,className:"text-green-500"}),y.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),y.jsx("button",{onClick:()=>h(!u),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${u?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:y.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${u?"left-[22px]":"left-0.5"}`})})]})}),y.jsx("div",{className:"mt-auto border-t border-gray-100",children:y.jsxs("button",{onClick:x,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[y.jsx(lK,{size:18,className:"text-gray-500"}),y.jsx("span",{children:"Instellingen"})]})}),y.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.5"})]})]})})]})}function UK(){const{infoPanelOpen:n,toggleInfoPanel:e}=Fn(),[t,i]=q.useState("info"),r=[{id:"info",label:"Info",icon:y.jsx(VD,{size:14})},{id:"functies",label:"Functies",icon:y.jsx(vH,{size:14})},{id:"handleiding",label:"Handleiding",icon:y.jsx(q$,{size:14})}];return y.jsx(Vn,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(We.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),y.jsxs(We.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600",children:[y.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.5"}),y.jsx("button",{onClick:e,className:"p-1 rounded bg-orange-400/50 hover:bg-orange-400 transition-colors border-0 outline-none",children:y.jsx(gi,{size:18,className:"text-white",strokeWidth:2.5})})]}),y.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>y.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-orange-600 border-b-2 border-orange-600 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),y.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&y.jsx(BK,{}),t==="functies"&&y.jsx(WK,{}),t==="handleiding"&&y.jsx(GK,{}),y.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:y.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.5 - Voor jou en je vismaat"})})]})]})]})})}function BK(){return y.jsxs(y.Fragment,{children:[y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),y.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),y.jsxs("ul",{className:"space-y-2 text-gray-600",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),y.jsxs("li",{children:[y.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),y.jsxs("div",{className:"text-gray-600 space-y-2",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function WK(){return y.jsxs(y.Fragment,{children:[y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(Ry,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(Qs,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:"Registreer soort, gewicht en lengte"}),y.jsx("li",{children:"Vismethode en aas bijhouden"}),y.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),y.jsx("li",{children:"GPS locatie per vangst"})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(Js,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:"Markeer je beste visplekken"}),y.jsx("li",{children:"Voeg notities en ratings toe"}),y.jsx("li",{children:"Welke vis zit waar?"})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(ku,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:"Live weergegevens op je locatie"}),y.jsx("li",{children:"Windsnelheid en richting"}),y.jsx("li",{children:"Luchtdruk"}),y.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(Nu,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:"Live GPS tracking"}),y.jsx("li",{children:"Zoek adressen en plaatsen"}),y.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function GK(){return y.jsxs(y.Fragment,{children:[y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),y.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[y.jsxs("li",{children:["Tik op de ",y.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),y.jsxs("li",{children:["Gebruik het ",y.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),y.jsxs("li",{children:["Tik op de ",y.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),y.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),y.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),y.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[y.jsxs("li",{children:["Gebruik de ",y.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),y.jsxs("li",{children:["Check de ",y.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),y.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),y.jsxs("li",{children:["Markeer succesvolle plekken als ",y.jsx("strong",{children:"favoriet"})]})]})]})]})}const $K=pl([5.1214,52.0907]),HK=8;function KK(){const n=fs(r=>r.map),e=Xi(r=>r.setLayerVisibility),t=ai(r=>r.stopTracking),i=()=>{t(),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Labels Overlay",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:$K,zoom:HK,rotation:0,duration:500})};return y.jsx(We.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:y.jsx(JH,{size:18,className:"text-gray-600"})})}const qK={Map:Ry,Fish:Qs,Anchor:MD,Layers:Jd,Star:Rx},XK={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},YK={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function ZK(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=az(),[r,s]=q.useState(!1),[o,l]=q.useState(null),[u,h]=q.useState(!1),[f,p]=q.useState(""),_=I=>{e(I),s(!1)},x=(I,T)=>{I.stopPropagation();const{useLayerStore:b}=require("../../store"),N=b.getState().visible,M=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(L=>N[L]);t(T,{layers:M}),l(T),setTimeout(()=>l(null),2e3)},S=()=>{f.trim()&&(i(f.trim()),p(""),h(!1))};return y.jsxs(y.Fragment,{children:[y.jsx(We.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?y.jsx(OD,{size:20,className:"text-orange-600"}):y.jsx(Jd,{size:20,className:"text-gray-600"})}),y.jsx(Vn,{children:r&&y.jsxs(y.Fragment,{children:[y.jsx(We.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),y.jsxs(We.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[y.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-orange-500 to-orange-600",children:y.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),y.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(I=>{const T=qK[I.icon]||Jd,b=XK[I.icon]||"text-blue-600",N=YK[I.icon]||"hover:bg-blue-50",M=o===I.id;return y.jsxs("button",{onClick:()=>_(I.id),className:`w-full h-9 flex items-center gap-2 px-2 ${N} rounded text-left transition-colors border-0 outline-none bg-transparent ${M?"bg-green-50":""}`,children:[y.jsx(T,{size:16,className:`${b} flex-shrink-0`}),y.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:I.name}),M?y.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:y.jsx(Cm,{size:14,className:"text-green-500"})}):y.jsx("span",{onClick:L=>x(L,I.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:y.jsx(iK,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},I.id)})}),y.jsx("div",{className:"border-t border-gray-200 p-2",children:u?y.jsxs("div",{className:"flex gap-1",children:[y.jsx("input",{type:"text",value:f,onChange:I=>p(I.target.value),onKeyDown:I=>{I.key==="Enter"&&S(),I.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-orange-400"}),y.jsx("button",{onClick:S,disabled:!f.trim(),className:"px-2 py-1 bg-orange-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):y.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",children:[y.jsx(XH,{size:14}),y.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const vd={lat:52.1326,lng:5.2913},QK={0:"Helder",1:"Overwegend helder",2:"Halfbewolkt",3:"Bewolkt",45:"Mist",48:"Rijpmist",51:"Lichte motregen",53:"Motregen",55:"Zware motregen",61:"Lichte regen",63:"Regen",65:"Zware regen",71:"Lichte sneeuw",73:"Sneeuw",75:"Zware sneeuw",80:"Lichte buien",81:"Buien",82:"Zware buien",95:"Onweer",96:"Onweer met hagel",99:"Zwaar onweer"};function KD({code:n,size:e=18}){return n===0?y.jsx(pK,{size:e,className:"text-yellow-500"}):n>=1&&n<=3?y.jsx(ku,{size:e,className:"text-gray-400"}):n===45||n===48?y.jsx(sH,{size:e,className:"text-gray-400"}):n>=51&&n<=67||n>=80&&n<=82?y.jsx(bf,{size:e,className:"text-blue-500"}):n>=71&&n<=77||n>=85&&n<=86?y.jsx(uH,{size:e,className:"text-cyan-500"}):n>=95?y.jsx(aH,{size:e,className:"text-purple-500"}):y.jsx(ku,{size:e,className:"text-gray-400"})}function JK({degrees:n,size:e=14}){return y.jsx("div",{style:{transform:`rotate(${n+180}deg)`},className:"inline-flex",children:y.jsx(Nu,{size:e,className:"text-blue-500"})})}function eq({size:n=16,className:e=""}){return y.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[y.jsx("path",{d:"M2 12h16"}),y.jsx("path",{d:"M18 12l4-4"}),y.jsx("path",{d:"M18 12l4 4"}),y.jsx("circle",{cx:"3",cy:"12",r:"1.5",fill:"currentColor"}),y.jsx("path",{d:"M6 12l1.5-3"}),y.jsx("path",{d:"M6 12l1.5 3"}),y.jsx("path",{d:"M10 12l1.5-3"}),y.jsx("path",{d:"M10 12l1.5 3"}),y.jsx("path",{d:"M14 12l1.5-2.5"}),y.jsx("path",{d:"M14 12l1.5 2.5"})]})}function Ax({size:n=16,className:e="",clipPercent:t=100}){const i=`fish-clip-${Math.random().toString(36).substr(2,9)}`;return y.jsxs("svg",{width:n*(t/100),height:n,viewBox:`0 0 ${24*(t/100)} 24`,fill:"currentColor",className:e,style:{overflow:"hidden"},children:[y.jsx("defs",{children:y.jsx("clipPath",{id:i,children:y.jsx("rect",{x:"0",y:"0",width:24*(t/100),height:"24"})})}),y.jsxs("g",{clipPath:`url(#${i})`,children:[y.jsx("ellipse",{cx:"12",cy:"12",rx:"8",ry:"5"}),y.jsx("path",{d:"M3 12L0 7V17L3 12Z"}),y.jsx("circle",{cx:"17",cy:"10.5",r:"1.2",fill:"white"}),y.jsx("circle",{cx:"17.3",cy:"10.5",r:"0.5",fill:"black"}),y.jsx("path",{d:"M10 7L12 4L14 7",fill:"currentColor"}),y.jsx("path",{d:"M11 17L12 19L13 17",fill:"currentColor"})]})]})}function qD({value:n,maxFish:e=3,color:t}){const i=Math.floor(n),r=n%1,s=[];for(let o=0;o<i&&o<e;o++)s.push(y.jsx(Ax,{size:18,className:t},o));return r>=.5&&i<e&&s.push(y.jsx(Ax,{size:18,className:t,clipPercent:60},"half")),y.jsx("div",{className:"flex items-center gap-1",children:s.length>0?s:y.jsx(eq,{size:18,className:t})})}function bm(n){const e=29.53058867,t=new Date("2000-01-06T18:14:00Z");return(n.getTime()-t.getTime())/(1e3*60*60*24)%e/e}function tq(n){return n<.03||n>.97?"Nieuwe maan":n<.22?"Wassende sikkel":n<.28?"Eerste kwartier":n<.47?"Wassende maan":n<.53?"Volle maan":n<.72?"Afnemende maan":n<.78?"Laatste kwartier":"Afnemende sikkel"}const nq="https://svs.gsfc.nasa.gov/vis/a000000/a004700/a004720/lroc_color_poles_1k.jpg";function XD({phase:n,size:e=20}){const t=n<=.5?n*2:(1-n)*2,i=n<.5;let r;return n<=.5?r=1-n*4:r=(n-.5)*4-1,r=Math.max(-1,Math.min(1,r)),y.jsxs("div",{className:"relative rounded-full overflow-hidden",style:{width:e,height:e,boxShadow:`0 ${e*.05}px ${e*.15}px rgba(0,0,0,0.4)`},children:[y.jsx("div",{className:"absolute inset-0 rounded-full",style:{backgroundImage:`url(${nq})`,backgroundSize:"cover",backgroundPosition:"center",filter:"contrast(1.1) brightness(1.05)"}}),y.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`
            radial-gradient(circle at 30% 25%, rgba(200,200,190,0.4) 0%, transparent 25%),
            radial-gradient(circle at 70% 60%, rgba(180,180,170,0.3) 0%, transparent 20%),
            radial-gradient(circle at 45% 75%, rgba(160,160,150,0.3) 0%, transparent 15%),
            radial-gradient(circle at 60% 30%, rgba(170,170,160,0.25) 0%, transparent 18%),
            radial-gradient(circle at 25% 55%, rgba(190,190,180,0.2) 0%, transparent 12%),
            linear-gradient(135deg, #d4d4c8 0%, #a8a89c 50%, #8c8c80 100%)
          `,mixBlendMode:"overlay"}}),y.jsxs("svg",{className:"absolute inset-0",viewBox:"0 0 100 100",style:{width:e,height:e},children:[y.jsx("defs",{children:y.jsxs("linearGradient",{id:`moonShadow-${e}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[y.jsx("stop",{offset:"0%",stopColor:"rgba(5,5,15,0.97)"}),y.jsx("stop",{offset:"40%",stopColor:"rgba(5,5,15,0.95)"}),y.jsx("stop",{offset:"100%",stopColor:"rgba(5,5,15,0)"})]})}),n<.03||n>.97?y.jsx("circle",{cx:"50",cy:"50",r:"50",fill:"rgba(5,5,15,0.95)"}):n>.47&&n<.53?null:y.jsx("ellipse",{cx:50+r*50,cy:"50",rx:Math.abs(50*(1-Math.abs(r*.8))),ry:"50",fill:"rgba(5,5,15,0.95)",style:{transform:"none"}})]}),t>.1&&y.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none",style:{background:i?`radial-gradient(circle at ${85-r*20}% 50%, rgba(255,255,240,0.15) 0%, transparent 50%)`:`radial-gradient(circle at ${15-r*20}% 50%, rgba(255,255,240,0.15) 0%, transparent 50%)`}})]})}function iq(n){const e=bm(n),t=n.getHours(),i=Math.floor((e*24+12)%24),r=(i+6)%24,s=(i+18)%24,o=(i+12)%24,l=[i,o],u=[r,s];let h=.3;return(e<.1||e>.9||e>.4&&e<.6)&&(h+=.3),l.forEach(f=>{const p=Math.abs(t-f);p<=1||p>=23?h+=.3:(p<=2||p>=22)&&(h+=.15)}),u.forEach(f=>{Math.abs(t-f)<=1&&(h-=.1)}),{activity:Math.max(.1,Math.min(1,h)),besteTijden:l,slechteTijden:u}}function rq(n){return n<.1||n>.9||n>.4&&n<.6?{type:"Springtij",color:"text-green-600"}:n>.2&&n<.3||n>.7&&n<.8?{type:"Doodtij",color:"text-orange-600"}:{type:"Normaal",color:"text-blue-600"}}function Px(n,e){const t=[],i=29.53058867,r=new Date("2000-01-06T18:14:00Z"),s=745;for(let o=0;o<e;o++){const l=new Date(n);l.setDate(l.getDate()+o),l.setHours(0,0,0,0);const h=(l.getTime()-r.getTime())/(1e3*60*60*24)%i/i;let f=h*s*2%1440;for(let p=0;p<4;p++){const _=p%2===0,x=p*(s/2);let S=f+x;const I=Math.floor(S/1440);S=S%1440;const T=Math.floor(S/60),b=Math.floor(S%60),N=new Date(l);N.setDate(N.getDate()+I),N.setHours(T,b,0,0);const M=Math.abs(Math.sin(h*Math.PI*2)),L=_?1.8:.4,O=M*.5;t.push({time:N,height:_?L+O:L-O*.5,type:_?"high":"low"})}}return t.sort((o,l)=>o.time.getTime()-l.time.getTime())}function sq({data:n,showHeader:e=!1}){if(!n||n.length===0)return null;const t=Math.max(...n.map(s=>s.precipitation),.5),i=n.some(s=>s.precipitation>0),r=s=>{const o=new Date(s);return`${o.getHours()}:${o.getMinutes().toString().padStart(2,"0")}`};return y.jsxs("div",{className:"space-y-1",children:[e&&y.jsx("div",{className:"flex items-center justify-between",children:y.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag komende 2 uur"})}),!i&&y.jsx("div",{className:"text-[10px] text-green-600 font-medium text-right",children:"Droog"}),y.jsxs("div",{className:"relative h-10 bg-gray-100 rounded-lg overflow-hidden",children:[y.jsx("div",{className:"absolute inset-0 flex",children:[...Array(8)].map((s,o)=>y.jsx("div",{className:"flex-1 border-r border-gray-200/50"},o))}),y.jsx("div",{className:"absolute inset-0 flex items-end px-0.5",children:n.map((s,o)=>{const l=s.precipitation/t*100,u=s.precipitation>2?"bg-blue-600":s.precipitation>.5?"bg-blue-500":s.precipitation>0?"bg-blue-400":"bg-transparent";return y.jsx("div",{className:"flex-1 mx-px",title:`${r(s.time)}: ${s.precipitation.toFixed(1)} mm`,children:y.jsx("div",{className:`w-full rounded-t transition-all ${u}`,style:{height:`${Math.max(l,s.precipitation>0?8:0)}%`}})},o)})}),y.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-1 text-[8px] text-gray-400",children:[y.jsx("span",{children:"Nu"}),y.jsx("span",{children:"+1u"}),y.jsx("span",{children:"+2u"})]})]}),i&&y.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-gray-500",children:[y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-400"}),y.jsx("span",{children:"Licht"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-500"}),y.jsx("span",{children:"Matig"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2 h-2 rounded-sm bg-blue-600"}),y.jsx("span",{children:"Zwaar"})]})]})]})}function oq({hourly:n}){const e=new Date,t=e.getHours(),i=n.filter(r=>new Date(r.time)>=e).slice(0,8);return i.length===0?null:y.jsxs("div",{className:"space-y-1",children:[y.jsx("div",{className:"text-[10px] text-gray-500",children:"Komende uren"}),y.jsx("div",{className:"flex gap-1 overflow-x-auto py-1 -mx-1 px-1",children:i.map((r,s)=>{const o=new Date(r.time),l=o.getHours()===t;return y.jsxs("div",{className:`flex flex-col items-center p-1.5 rounded-lg min-w-[36px] ${l?"bg-blue-100":"bg-gray-50"}`,children:[y.jsx("span",{className:"text-[9px] text-gray-500",children:l?"Nu":`${o.getHours()}:00`}),y.jsx(KD,{code:r.weatherCode,size:14}),y.jsxs("span",{className:"text-[10px] font-medium",children:[Math.round(r.temperature),""]}),r.precipitationProbability>20&&y.jsxs("span",{className:"text-[8px] text-blue-500",children:[r.precipitationProbability,"%"]})]},r.time)})})]})}const aq=[{name:"Amsterdam",lat:52.3676,lng:4.9041},{name:"Rotterdam",lat:51.9244,lng:4.4777},{name:"Den Haag",lat:52.0705,lng:4.3007},{name:"Utrecht",lat:52.0907,lng:5.1214},{name:"Eindhoven",lat:51.4416,lng:5.4697},{name:"Groningen",lat:53.2194,lng:6.5665},{name:"Tilburg",lat:51.5555,lng:5.0913},{name:"Almere",lat:52.3508,lng:5.2647},{name:"Breda",lat:51.5719,lng:4.7683},{name:"Nijmegen",lat:51.8126,lng:5.8372},{name:"Arnhem",lat:51.9851,lng:5.8987},{name:"Haarlem",lat:52.3874,lng:4.6462},{name:"Enschede",lat:52.2215,lng:6.8937},{name:"Zwolle",lat:52.5168,lng:6.083},{name:"Maastricht",lat:50.8514,lng:5.6909},{name:"Leiden",lat:52.1601,lng:4.497},{name:"Dordrecht",lat:51.8133,lng:4.6901},{name:"Zoetermeer",lat:52.0575,lng:4.4931},{name:"Leeuwarden",lat:53.2012,lng:5.7999},{name:"Den Bosch",lat:51.6978,lng:5.3037}];function lq({hourlyData:n,onClose:e,onLocationChange:t}){const[i,r]=q.useState(new Date),[s,o]=q.useState(""),[l,u]=q.useState(!1),[h,f]=q.useState(null),p=new Date,_=q.useMemo(()=>{const C=new Date(p);return C.setHours(C.getHours(),0,0,0),C},[]),x=q.useMemo(()=>{const C=new Date(_);return C.setHours(C.getHours()+48),C},[_]),S=x.getTime()-_.getTime(),I=(i.getTime()-_.getTime())/S*100,T=n.filter(C=>{const D=new Date(C.time);return D>=_&&D<=x}),b=aq.filter(C=>C.name.toLowerCase().includes(s.toLowerCase())).slice(0,6),N=C=>{const D=new Date;D.setHours(0,0,0,0);const F=new Date(C);F.setHours(0,0,0,0);const V=Math.floor((F.getTime()-D.getTime())/(1440*60*1e3));return V===0?"Vandaag":V===1?"Morgen":V===2?"Overmorgen":C.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},M=C=>`${C.getHours().toString().padStart(2,"0")}:00`,L=T.find(C=>{const D=new Date(C.time);return D.getHours()===i.getHours()&&D.getDate()===i.getDate()}),O=Math.max(...T.map(C=>C.precipitation),1),U=T.some(C=>C.precipitation>0),P=C=>{f(C.name),u(!1),o(""),t&&t(C.lat,C.lng,C.name)};return y.jsx(We.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:y.jsx(We.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:C=>C.stopPropagation(),children:y.jsxs("div",{className:"p-4 space-y-3",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(bf,{size:20,className:"text-blue-500"}),y.jsx("span",{className:"font-semibold text-gray-800",children:"Neerslag 48 uur"}),!U&&y.jsx("span",{className:"text-xs text-green-600 font-medium bg-green-50 px-2 py-0.5 rounded-full",children:"Droog"})]}),y.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:y.jsx(gi,{size:16,className:"text-gray-500"})})]}),y.jsxs("div",{className:"relative",children:[y.jsxs("button",{onClick:()=>u(!l),className:"w-full flex items-center gap-2 px-3 py-2 bg-gray-50 hover:bg-gray-100 rounded-xl transition-colors border-0 outline-none text-left",children:[y.jsx(Js,{size:16,className:"text-gray-400"}),y.jsx("span",{className:"flex-1 text-sm text-gray-700",children:h||"Huidige locatie"}),y.jsx(Cx,{size:14,className:"text-gray-400"})]}),l&&y.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white rounded-xl shadow-lg border border-gray-100 z-10 overflow-hidden",children:[y.jsx("div",{className:"p-2 border-b border-gray-100",children:y.jsx("input",{type:"text",value:s,onChange:C=>o(C.target.value),placeholder:"Zoek plaats...",className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg outline-none focus:ring-2 focus:ring-blue-400",autoFocus:!0})}),y.jsxs("div",{className:"max-h-40 overflow-y-auto",children:[y.jsxs("button",{onClick:()=>{f(null),u(!1),t&&t(vd.lat,vd.lng,"Huidige locatie")},className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 border-0 outline-none bg-transparent text-left",children:[y.jsx(Nu,{size:14,className:"text-blue-500"}),y.jsx("span",{className:"text-sm text-gray-700",children:"Huidige locatie"})]}),b.map(C=>y.jsxs("button",{onClick:()=>P(C),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 border-0 outline-none bg-transparent text-left",children:[y.jsx(Js,{size:14,className:"text-gray-400"}),y.jsx("span",{className:"text-sm text-gray-700",children:C.name})]},C.name))]})]})]}),y.jsxs("div",{className:"bg-blue-50 rounded-xl p-3 flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsx("div",{className:"text-xs text-gray-500",children:N(i)}),y.jsx("div",{className:"text-xl font-bold text-blue-600",children:M(i)})]}),y.jsxs("div",{className:"text-right",children:[y.jsx("div",{className:"text-2xl font-bold text-blue-600",children:L?`${L.precipitation.toFixed(1)} mm`:"0 mm"}),L&&L.precipitationProbability>0&&y.jsxs("div",{className:"text-xs text-blue-500",children:[L.precipitationProbability,"% kans"]})]})]}),y.jsxs("div",{className:"relative bg-gray-100 rounded-xl p-2 h-28",children:[y.jsx("div",{className:"absolute top-1 left-2 text-[9px] font-medium text-amber-600",children:" Nu"}),y.jsx("div",{className:"absolute inset-2 pt-3 flex items-end gap-px",children:T.map((C,D)=>{const F=C.precipitation/O*100,V=new Date(C.time),B=V.getHours()===i.getHours()&&V.getDate()===i.getDate(),k=D===0,te=C.precipitation>2?"bg-blue-600":C.precipitation>.5?"bg-blue-500":C.precipitation>0?"bg-blue-400":"bg-gray-200";return y.jsx("div",{className:"flex-1 cursor-pointer h-full flex flex-col justify-end",onClick:()=>r(V),children:y.jsx("div",{className:`w-full rounded-t transition-all ${te} ${B?"ring-2 ring-amber-400 ring-offset-1":""} ${k?"ring-1 ring-amber-500":""}`,style:{height:`${Math.max(F,C.precipitation>0?8:3)}%`}})},D)})}),y.jsxs("div",{className:"absolute bottom-0.5 left-2 right-2 flex justify-between text-[8px] text-gray-400",children:[y.jsx("span",{children:"Nu"}),y.jsx("span",{children:"+24u"}),y.jsx("span",{children:"+48u"})]})]}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("input",{type:"range",min:"0",max:"100",value:I,onChange:C=>r(new Date(_.getTime()+parseFloat(C.target.value)/100*S)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[y.jsx("span",{className:I<5?"text-amber-600 font-medium":"",children:"Nu"}),y.jsxs("span",{children:[N(i)," ",M(i)]}),y.jsx("span",{children:"+48u"})]})]}),y.jsxs("div",{className:"flex items-center justify-center gap-4 text-[10px] text-gray-400",children:[y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-400"}),y.jsx("span",{children:"Licht"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-500"}),y.jsx("span",{children:"Matig"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2.5 h-2.5 rounded-sm bg-blue-600"}),y.jsx("span",{children:"Zwaar"})]})]})]})})})}function cq(n,e=52.1){const t=Math.floor((n.getTime()-new Date(n.getFullYear(),0,0).getTime())/864e5),i=-23.45*Math.cos(360/365*(t+10)*Math.PI/180),r=Math.acos(-Math.tan(e*Math.PI/180)*Math.tan(i*Math.PI/180))*180/Math.PI,s=12-.1,o=s-r/15,l=s+r/15;return{sunrise:Math.max(0,o),sunset:Math.min(24,l)}}function uq({onClose:n}){const[e,t]=q.useState(new Date),i=ai(k=>k.position),{current:r}=J1(),s=[{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664},{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12},{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961}],o=(k,te)=>{let de=s[0],ge=1/0;for(const ue of s){const G=Math.sqrt(Math.pow(ue.lat-k,2)+Math.pow(ue.lng-te,2));G<ge&&(ge=G,de=ue)}return de},[l,u]=q.useState(()=>i?o(i.lat,i.lng):s[0]),h=q.useMemo(()=>{const k=new Date(e);return k.setHours(0,0,0,0),Px(k,2).filter(te=>{const de=new Date(te.time);de.setHours(0,0,0,0);const ge=new Date(e);return ge.setHours(0,0,0,0),de.getTime()===ge.getTime()})},[e]),f=h.filter(k=>k.type==="low"),p=h.filter(k=>k.type==="high"),_=k=>{const te=Px(new Date(e.getTime()-864e5),3);if(te.length<2)return 1;let de=te[0],ge=te[1];for(let W=0;W<te.length-1;W++)if(te[W].time<=k&&te[W+1].time>k){de=te[W],ge=te[W+1];break}const ue=ge.time.getTime()-de.time.getTime(),G=k.getTime()-de.time.getTime(),ie=Math.max(0,Math.min(1,G/ue)),ne=(1-Math.cos(ie*Math.PI))/2;return de.height+(ge.height-de.height)*ne},x=q.useMemo(()=>{const k=[],te=new Date(e);te.setHours(0,0,0,0);for(let de=0;de<=24;de+=.25){const ge=new Date(te.getTime()+de*60*60*1e3);k.push({hour:de,height:_(ge)})}return k},[e]),S=new Date,I=e.toDateString()===S.toDateString(),T=S.getHours()+S.getMinutes()/60,b=I?_(S):null,N=h.find(k=>k.time>S),M=()=>{if(!I)return"stable";const k=_(S),te=_(new Date(S.getTime()-600*1e3));return k>te?"rising":"falling"},L=bm(e),O=Math.round((L<=.5?L*2:(1-L)*2)*100),U=L>.5,P=cq(e,l.lat),C=[2.4,2,1.6,1.2,.8,.4,0],D=2.4,F=k=>k.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"}),V=()=>{const k=new Date;k.setHours(0,0,0,0);const te=new Date(e);te.setHours(0,0,0,0);const de=Math.floor((te.getTime()-k.getTime())/(1440*60*1e3));return de===0?"(Today)":de===1?"(Morgen)":de===-1?"(Gisteren)":""},B=r?.weatherCode?r.weatherCode>=3?75:r.weatherCode>=2?50:r.weatherCode>=1?25:0:0;return y.jsx(We.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:y.jsxs(We.div,{className:"bg-white w-full max-w-md mx-4 rounded-2xl overflow-hidden shadow-2xl select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:k=>k.stopPropagation(),children:[y.jsx("div",{className:"bg-[#3b82f6] px-4 py-3",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("select",{value:l.id,onChange:k=>{const te=s.find(de=>de.id===k.target.value);te&&u(te)},className:"bg-transparent text-white font-semibold text-lg border-0 outline-none cursor-pointer appearance-none",style:{backgroundImage:"none"},children:s.map(k=>y.jsx("option",{value:k.id,className:"text-gray-800",children:k.name},k.id))}),y.jsx("button",{onClick:n,className:"p-1 hover:bg-white/20 rounded-full transition-colors border-0 outline-none bg-transparent",children:y.jsx(gi,{size:20,className:"text-white"})})]})}),y.jsxs("div",{className:"bg-[#3b82f6] px-4 pb-4 flex items-center justify-between",children:[y.jsxs("div",{className:"flex flex-col items-center",children:[y.jsx(XD,{phase:L,size:40}),y.jsxs("span",{className:"text-white/90 text-[10px] mt-1",children:[O,"% ",U?"Waning":"Waxing"]})]}),y.jsxs("div",{className:"text-center",children:[y.jsx("input",{type:"date",value:e.toISOString().split("T")[0],onChange:k=>t(new Date(k.target.value)),className:"bg-transparent text-white text-lg font-semibold border-0 outline-none text-center cursor-pointer",style:{colorScheme:"dark"}}),y.jsx("div",{className:"text-white/80 text-sm",children:V()})]}),y.jsxs("div",{className:"flex flex-col items-center",children:[y.jsx(ku,{size:32,className:"text-white"}),y.jsxs("span",{className:"text-white/90 text-[10px] mt-1",children:[B,"%"]})]})]}),y.jsxs("div",{className:"relative bg-white",style:{height:280},children:[y.jsx("div",{className:"absolute top-0 bottom-8 bg-[#f5f5dc]/60",style:{left:`${P.sunrise/24*100}%`,width:`${(P.sunset-P.sunrise)/24*100}%`}}),C.map((k,te)=>y.jsxs("div",{className:"absolute left-0 right-0 flex items-center",style:{top:`${te/(C.length-1)*248}px`},children:[y.jsxs("span",{className:"text-gray-500 text-xs w-10 text-right pr-2",children:[k," m"]}),y.jsx("div",{className:"flex-1 border-t border-gray-200"})]},k)),y.jsxs("svg",{className:"absolute left-10 right-0 top-0",style:{height:248},viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[y.jsx("path",{d:`M ${x.map(k=>`${k.hour/24*100} ${100-k.height/D*100}`).join(" L ")}`,fill:"none",stroke:"#1e3a5f",strokeWidth:"0.8"}),I&&T>=0&&T<=24&&y.jsx(y.Fragment,{children:y.jsx("line",{x1:T/24*100,y1:"0",x2:T/24*100,y2:"100",stroke:"#ef4444",strokeWidth:"0.5"})})]}),I&&b!==null&&y.jsxs("div",{className:"absolute bg-white border border-gray-300 rounded px-2 py-0.5 text-sm font-medium text-red-500 shadow-sm",style:{left:`calc(${10+T/24*90}% - 30px)`,top:4},children:[b.toFixed(2)," m",M()==="rising"?"":""]}),N&&I&&y.jsxs("div",{className:"absolute bg-white border border-gray-200 rounded-lg px-3 py-2 shadow-lg",style:{right:16,top:`${100-N.height/D*100}px`},children:[y.jsxs("div",{className:"text-blue-600 font-semibold",children:[N.height.toFixed(1)," m"]}),y.jsx("div",{className:"text-blue-500 text-sm",children:F(N.time)})]}),y.jsx("div",{className:"absolute top-2 right-2 text-gray-400 text-xs",children:"LAT"}),y.jsx("div",{className:"absolute bottom-0 left-10 right-0 flex justify-between px-1 text-xs text-gray-500",style:{height:24},children:[2,4,6,8,10,12,14,16,18,20,22].map(k=>y.jsx("span",{style:{width:"8%",textAlign:"center"},children:k.toString().padStart(2,"0")},k))})]}),y.jsxs("div",{className:"bg-[#1e3a5f] px-4 py-3 flex",children:[y.jsxs("div",{className:"flex-1",children:[y.jsx("div",{className:"text-white font-semibold text-sm mb-1",children:"Low Tides:"}),f.length>0?f.map((k,te)=>y.jsxs("div",{className:"text-white/90 text-sm",children:[k.height.toFixed(1)," m @ ",F(k.time)]},te)):y.jsx("div",{className:"text-white/60 text-sm",children:"-"})]}),y.jsxs("div",{className:"flex-1 text-right",children:[y.jsx("div",{className:"text-white font-semibold text-sm mb-1",children:"High Tides:"}),p.length>0?p.map((k,te)=>y.jsxs("div",{className:"text-white/90 text-sm",children:[k.height.toFixed(1)," m @ ",F(k.time)]},te)):y.jsx("div",{className:"text-white/60 text-sm",children:"-"})]})]}),y.jsxs("div",{className:"bg-[#1e3a5f] px-4 pb-3 flex gap-2",children:[y.jsx("button",{onClick:()=>{const k=new Date;k.setDate(k.getDate()-1),t(k)},className:"flex-1 py-1.5 text-xs bg-white/10 hover:bg-white/20 text-white rounded transition-colors border-0",children:"Gisteren"}),y.jsx("button",{onClick:()=>t(new Date),className:"flex-1 py-1.5 text-xs bg-white/20 hover:bg-white/30 text-white rounded transition-colors border-0 font-medium",children:"Vandaag"}),y.jsx("button",{onClick:()=>{const k=new Date;k.setDate(k.getDate()+1),t(k)},className:"flex-1 py-1.5 text-xs bg-white/10 hover:bg-white/20 text-white rounded transition-colors border-0",children:"Morgen"})]})]})})}function hq({pressureHistory:n,currentPressure:e,trend:t,onClose:i}){const[r,s]=q.useState(12),o=new Date,l=n.slice(-72),u=Math.min(...l.map(T=>T.pressure),990),h=Math.max(...l.map(T=>T.pressure),1040),f=h-u||20,p=T=>{if(T>=l.length-1||T<1)return .5;const b=l[T].pressure-l[T-1].pressure,N=l[T].pressure;let M=.5;return b>.5?M+=.3:b<-.5&&(M-=.2),N>=1010&&N<=1025&&(M+=.2),N>1020&&Math.abs(b)<.3&&(M+=.2),Math.max(0,Math.min(1,M))},x=[...l.map((T,b)=>({hour:b,activity:p(b)}))].sort((T,b)=>b.activity-T.activity).slice(0,5),S=()=>t==="rising"?y.jsx(WD,{size:16,className:"text-green-500"}):t==="falling"?y.jsx(BD,{size:16,className:"text-red-500"}):y.jsx(zD,{size:16,className:"text-gray-400"}),I=()=>t==="rising"?"Stijgend - Goed voor vissen!":t==="falling"?"Dalend - Minder activiteit":"Stabiel";return y.jsx(We.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i,children:y.jsx(We.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:T=>T.stopPropagation(),children:y.jsxs("div",{className:"p-4 space-y-4",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(FD,{size:20,className:"text-purple-500"}),y.jsx("span",{className:"font-semibold text-gray-800",children:"Luchtdruk"})]}),y.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:y.jsx(gi,{size:16,className:"text-gray-500"})})]}),y.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-4",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[Math.round(e)," hPa"]}),y.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[S(),y.jsx("span",{className:"text-sm text-gray-600",children:I()})]})]}),y.jsxs("div",{className:"text-right",children:[y.jsx(qD,{value:p(l.length-1)*3,color:p(l.length-1)>.7?"text-green-500":p(l.length-1)>.4?"text-amber-500":"text-red-500"}),y.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:"Nu"})]})]})}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("div",{className:"text-[10px] text-gray-500",children:"Druk & visactiviteit (48 uur)"}),y.jsxs("div",{className:"relative bg-gray-100 rounded-xl p-2 h-32",children:[y.jsxs("svg",{className:"absolute inset-2 w-[calc(100%-16px)] h-[calc(100%-16px)]",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[l.slice(-48).map((T,b)=>{const N=p(l.length-48+b),M=b/47*100,L=N*30,O=N>.7?"#22c55e":N>.4?"#f59e0b":"#ef4444";return y.jsx("rect",{x:M-1,y:100-L,width:2,height:L,fill:O,opacity:"0.3"},b)}),y.jsx("path",{d:`M ${l.slice(-48).map((T,b)=>{const N=b/47*100,M=100-(T.pressure-u)/f*80;return`${N} ${M}`}).join(" L ")}`,fill:"none",stroke:"#8b5cf6",strokeWidth:"2"}),y.jsx("rect",{x:"0",y:100-(1025-u)/f*80,width:"100",height:15/f*80,fill:"#22c55e",opacity:"0.1"})]}),y.jsx("div",{className:"absolute top-1 left-2 text-[9px] text-gray-400",children:Math.round(h)}),y.jsx("div",{className:"absolute bottom-4 left-2 text-[9px] text-gray-400",children:Math.round(u)}),y.jsxs("div",{className:"absolute bottom-0.5 left-2 right-2 flex justify-between text-[8px] text-gray-400",children:[y.jsx("span",{children:"-48u"}),y.jsx("span",{children:"-24u"}),y.jsx("span",{children:"Nu"})]})]})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsxs("div",{className:"text-[10px] text-gray-500 flex items-center gap-1",children:[y.jsx(Ax,{size:12,className:"text-green-500"}),"Beste vistijden (op basis van druk)"]}),y.jsx("div",{className:"flex flex-wrap gap-1",children:x.slice(0,4).map((T,b)=>{const N=new Date(l[T.hour]?.time||o),M=N.getDate()===o.getDate();return y.jsxs("div",{className:"bg-green-50 rounded-lg px-2 py-1 text-xs",children:[y.jsxs("span",{className:"text-green-700 font-medium",children:[M?"Vandaag":"Morgen"," ",N.getHours(),":00"]}),y.jsxs("span",{className:"text-green-500 ml-1",children:[Math.round(T.activity*100),"%"]})]},b)})})]}),y.jsxs("div",{className:"flex items-center justify-center gap-4 text-[10px] text-gray-400",children:[y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-3 h-1.5 rounded-sm bg-green-400 opacity-50"}),y.jsx("span",{children:"Actief"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-3 h-1.5 rounded-sm bg-amber-400 opacity-50"}),y.jsx("span",{children:"Matig"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-8 h-3 rounded-sm bg-green-500 opacity-20"}),y.jsx("span",{children:"Optimale zone"})]})]})]})})})}function dq({onClose:n}){const[e,t]=q.useState(!0),[i,r]=q.useState(0),[s,o]=q.useState([]),l=ai(T=>T.position);q.useEffect(()=>{(async()=>{try{const N=await(await fetch("https://api.rainviewer.com/public/weather-maps.json")).json();if(N.radar?.past){const M=N.radar.past.map(L=>`https://tilecache.rainviewer.com${L.path}/256/{z}/{x}/{y}/2/1_1.png`);N.radar?.nowcast&&M.push(...N.radar.nowcast.map(L=>`https://tilecache.rainviewer.com${L.path}/256/{z}/{x}/{y}/2/1_1.png`)),o(M)}}catch(b){console.error("Failed to fetch radar data:",b)}})()},[]),q.useEffect(()=>{if(!e||s.length===0)return;const T=setInterval(()=>{r(b=>(b+1)%s.length)},500);return()=>clearInterval(T)},[e,s.length]);const u=l?.lat||52.1326,h=l?.lng||5.2913,f=7,p=Math.pow(2,f),_=Math.floor((h+180)/360*p),x=Math.floor((1-Math.log(Math.tan(u*Math.PI/180)+1/Math.cos(u*Math.PI/180))/Math.PI)/2*p),S=()=>s.length===0?null:s[i]?.replace("{z}",f.toString()).replace("{x}",_.toString()).replace("{y}",x.toString()),I=()=>{if(s.length===0)return"Laden...";const b=i-12;return b<-5?`-${Math.abs(b)*5} min`:b<0?`-${Math.abs(b)*5} min`:b===0?"Nu":`+${b*5} min`};return y.jsx(We.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:y.jsx(We.div,{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden select-none",initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:T=>T.stopPropagation(),children:y.jsxs("div",{className:"p-4 space-y-3",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(bf,{size:20,className:"text-blue-500"}),y.jsx("span",{className:"font-semibold text-gray-800",children:"Buienradar"})]}),y.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-full transition-colors border-0 outline-none bg-transparent",children:y.jsx(gi,{size:16,className:"text-gray-500"})})]}),y.jsxs("div",{className:"relative bg-gray-200 rounded-xl overflow-hidden",style:{aspectRatio:"1/1"},children:[y.jsx("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-3",children:[-1,0,1].map(T=>[-1,0,1].map(b=>y.jsx("img",{src:`https://tile.openstreetmap.org/${f}/${_+b}/${x+T}.png`,alt:"",className:"w-full h-full object-cover",style:{filter:"saturate(0.3) brightness(1.1)"}},`${b}-${T}`)))}),S()&&y.jsx("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-3",children:[-1,0,1].map(T=>[-1,0,1].map(b=>y.jsx("img",{src:s[i]?.replace("{z}",f.toString()).replace("{x}",(_+b).toString()).replace("{y}",(x+T).toString()),alt:"",className:"w-full h-full object-cover",style:{mixBlendMode:"multiply"}},`radar-${b}-${T}`)))}),y.jsx("div",{className:"absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-sm font-medium",children:I()}),y.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:y.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full border-2 border-white shadow-lg"})})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("input",{type:"range",min:"0",max:Math.max(0,s.length-1),value:i,onChange:T=>{t(!1),r(parseInt(T.target.value))},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[y.jsx("span",{children:"-1 uur"}),y.jsx("span",{children:"Nu"}),y.jsx("span",{children:"+30 min"})]})]}),y.jsx("div",{className:"flex items-center justify-center gap-3",children:y.jsxs("button",{onClick:()=>t(!e),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-xl transition-colors border-0 outline-none",children:[e?y.jsx(WH,{size:16}):y.jsx(KH,{size:16}),y.jsx("span",{className:"text-sm font-medium",children:e?"Pauzeren":"Afspelen"})]})}),y.jsxs("div",{className:"flex items-center justify-center gap-2 text-[10px] text-gray-500",children:[y.jsx("span",{children:"Licht"}),y.jsxs("div",{className:"flex h-2",children:[y.jsx("div",{className:"w-4 bg-blue-200 rounded-l"}),y.jsx("div",{className:"w-4 bg-blue-400"}),y.jsx("div",{className:"w-4 bg-blue-600"}),y.jsx("div",{className:"w-4 bg-purple-600"}),y.jsx("div",{className:"w-4 bg-red-500 rounded-r"})]}),y.jsx("span",{children:"Zwaar"})]})]})})})}const zb=[{id:"lobith",name:"Lobith",river:"Rijn",normalFlow:2300},{id:"borgharen",name:"Borgharen",river:"Maas",normalFlow:250},{id:"tiel",name:"Tiel",river:"Waal",normalFlow:1500},{id:"deventer",name:"Deventer",river:"IJssel",normalFlow:400}];function fq(n){const e=new Date,t=Math.floor((e.getTime()-new Date(e.getFullYear(),0,0).getTime())/(1e3*60*60*24)),i=1+.4*Math.sin((t-100)*Math.PI/182),r=.9+Math.random()*.2;return Math.round(n.normalFlow*i*r)}function gq(){const{current:n,loading:e,fetchWeather:t,getFishingScore:i,pressureHistory:r,getPressureTrend:s,hourlyForecast:o,precipitation15min:l}=J1(),u=ai(re=>re.position),h=He(re=>re.showWeatherWidget),f=He(re=>re.showTideWidget),p=He(re=>re.showBuienradarWidget),_=He(re=>re.showWaterflowWidget),x=He(re=>re.showForecastSlider),S=He(re=>re.showWaterDataWidget),{waterData:I,station:T,fetchData:b}=Ob(),[N,M]=q.useState(!1),[L,O]=q.useState(!1),[U,P]=q.useState(!1),[C,D]=q.useState(0),[F,V]=q.useState(!1),[B,k]=q.useState(!1),[te,de]=q.useState(new Map);q.useEffect(()=>{const re=new Map;zb.forEach(_e=>re.set(_e.id,fq(_e))),de(re)},[]),q.useEffect(()=>{const re=u||vd;t(re.lat,re.lng),b()},[]),q.useEffect(()=>{u&&t(u.lat,u.lng)},[u,t]),q.useEffect(()=>{const re=u||vd,_e=setInterval(()=>{t(re.lat,re.lng),b()},600*1e3);return()=>clearInterval(_e)},[u,t,b]);const ge=new Date;bm(ge);const ue=iq(ge),ie=q.useMemo(()=>{const re=new Date;return re.setHours(0,0,0,0),Px(re,2)},[]).filter(re=>re.time>ge).slice(0,4),ne=i?i():1,W=Math.min(3,ne/2+ue.activity*1.5),$=re=>re>=2.5?"text-green-500":re>=1.5?"text-lime-500":re>=.8?"text-amber-500":"text-red-500",oe=re=>re>=2.5?"Uitstekend":re>=1.5?"Goed":re>=.8?"Matig":"Slecht",me=re=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(re/45)%8],xe=re=>re.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return h?y.jsxs(y.Fragment,{children:[N&&y.jsx("div",{className:"fixed inset-0 z-[1499]",onClick:()=>M(!1)}),y.jsxs(We.div,{className:"fixed left-2 z-[1500] bg-white shadow-lg border border-gray-200 select-none rounded-xl",style:N?{top:"0.5rem",bottom:"0.5rem",width:"220px",overflowY:"auto"}:{top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[e&&!n?y.jsxs("div",{className:"p-3 flex items-center gap-2",children:[y.jsx(ZH,{size:16,className:"animate-spin text-blue-500"}),y.jsx("span",{className:"text-sm text-gray-500",children:"Laden..."})]}):n?y.jsxs("div",{className:"p-2.5",children:[y.jsxs("button",{onClick:()=>M(!N),className:"w-full border-0 outline-none bg-transparent p-0",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(KD,{code:n.weatherCode,size:24}),y.jsx("div",{className:"flex flex-col leading-tight",children:y.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[Math.round(n.temperature),""]})})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx(bx,{size:14,className:"text-gray-400"}),y.jsx("span",{className:"text-sm text-gray-600",children:Math.round(n.windSpeed)}),y.jsx(JK,{degrees:n.windDirection,size:12})]}),y.jsx("div",{className:"ml-auto",children:N?y.jsx(OD,{size:16,className:"text-gray-400"}):y.jsx(J$,{size:16,className:"text-gray-400"})})]}),y.jsxs("div",{className:"flex items-center gap-2 mt-1.5 pt-1.5 border-t border-gray-200/50",children:[y.jsx(qD,{value:W,color:$(W)}),y.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:y.jsx("div",{className:`h-full transition-all ${W>=2.5?"bg-green-500":W>=1.5?"bg-lime-500":W>=.8?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.max(W/3*100,5)}%`}})}),y.jsx("span",{className:`text-[10px] font-medium ${$(W)}`,children:oe(W)})]})]}),y.jsx(Vn,{children:N&&y.jsx(We.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:y.jsxs("div",{className:"pt-3 mt-2 border-t border-gray-200/50 space-y-3",children:[y.jsx("div",{className:"text-xs text-gray-600",children:QK[n.weatherCode]||"Onbekend"}),(()=>{const re=new Date;re.setDate(re.getDate()+C);const _e=bm(re),we=rq(_e),Ce=C===0?"Vandaag":C===1?"Morgen":C===-1?"Gisteren":re.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric",month:"short"});return y.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-3",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(XD,{phase:_e,size:40}),y.jsxs("div",{className:"flex-1",children:[y.jsx("div",{className:"text-gray-800 text-sm font-medium",children:tq(_e)}),y.jsxs("div",{className:"text-gray-500 text-[10px]",children:[Math.round(_e*100),"% verlicht"]}),y.jsx("div",{className:`text-[10px] font-medium ${we.color}`,children:we.type})]}),y.jsxs("div",{className:"text-right",children:[y.jsx("div",{className:"text-xs text-gray-600",children:Ce}),C!==0&&y.jsx("button",{onClick:()=>D(0),className:"text-[10px] text-blue-500 hover:underline border-0 bg-transparent p-0 outline-none",children:"Vandaag"})]})]}),y.jsxs("div",{className:"space-y-1",children:[y.jsx("input",{type:"range",min:"-14",max:"14",value:C,onChange:Be=>D(parseInt(Be.target.value)),className:"w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400",children:[y.jsx("span",{children:"-14d"}),y.jsx("span",{children:"Nu"}),y.jsx("span",{children:"+14d"})]})]})]})})(),y.jsxs("div",{className:"space-y-1",children:[y.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[y.jsx("span",{className:"text-gray-500",children:"Maanactiviteit"}),y.jsxs("span",{className:"text-gray-600",children:[Math.round(ue.activity*100),"%"]})]}),y.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:y.jsx("div",{className:`h-full transition-all ${ue.activity>=.7?"bg-green-500":ue.activity>=.5?"bg-lime-500":ue.activity>=.3?"bg-amber-500":"bg-red-400"}`,style:{width:`${ue.activity*100}%`}})})]}),S&&y.jsxs("div",{className:"space-y-2",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Gw,{size:14,className:"text-cyan-500"}),y.jsx("select",{value:T?.id||"",onChange:re=>{re.stopPropagation();const _e=Qd.find(we=>we.id===re.target.value);if(_e){const{setStation:we,fetchData:Ce}=Ob.getState();we(_e),setTimeout(()=>Ce(),50)}},className:"flex-1 px-2 py-1 text-xs border border-gray-200 rounded-lg bg-white/80 outline-none focus:ring-1 focus:ring-cyan-400",children:Qd.map(re=>y.jsx("option",{value:re.id,children:re.name},re.id))})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[I?.temperature!==void 0&&y.jsxs("div",{className:"bg-cyan-50 rounded-lg p-2",children:[y.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[y.jsx(UD,{size:12,className:"text-cyan-500"}),y.jsx("span",{children:"Water"})]}),y.jsxs("div",{className:"text-sm font-bold text-cyan-600",children:[I.temperature.toFixed(1),"C"]})]}),I?.waveHeight!==void 0&&y.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[y.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[y.jsx(Rm,{size:12,className:"text-blue-500"}),y.jsx("span",{children:"Golven"})]}),y.jsxs("div",{className:"text-sm font-bold text-blue-600",children:[I.waveHeight," cm"]})]}),I?.currentSpeed!==void 0&&y.jsxs("div",{className:"bg-green-50 rounded-lg p-2",children:[y.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[y.jsx(Nu,{size:12,className:"text-green-500"}),y.jsx("span",{children:"Stroming"})]}),y.jsxs("div",{className:"text-sm font-bold text-green-600",children:[I.currentSpeed," cm/s"]})]}),I?.currentDirection!==void 0&&y.jsxs("div",{className:"bg-purple-50 rounded-lg p-2",children:[y.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[y.jsx(Nu,{size:12,className:"text-purple-500",style:{transform:`rotate(${I.currentDirection}deg)`}}),y.jsx("span",{children:"Richting"})]}),y.jsxs("div",{className:"text-sm font-bold text-purple-600",children:[Math.round(I.currentDirection),""]})]})]})]}),_&&y.jsxs("div",{className:"space-y-2",children:[y.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-500",children:[y.jsx(LD,{size:14,className:"text-cyan-600"}),y.jsx("span",{className:"font-medium",children:"Waterafvoer rivieren"})]}),y.jsx("div",{className:"grid grid-cols-2 gap-2",children:zb.map(re=>{const _e=te.get(re.id)||0,we=_e/re.normalFlow,Ce=we<.7?{text:"Laag",color:"text-orange-500",bg:"bg-orange-50"}:we>1.3?{text:"Hoog",color:"text-blue-600",bg:"bg-blue-50"}:{text:"Normaal",color:"text-green-500",bg:"bg-green-50"};return y.jsxs("div",{className:`${Ce.bg} rounded-lg p-2`,children:[y.jsx("div",{className:"text-[10px] text-gray-500",children:re.river}),y.jsxs("div",{className:`text-sm font-bold ${Ce.color}`,children:[_e.toLocaleString()," m/s"]}),y.jsx("div",{className:`text-[9px] ${Ce.color}`,children:Ce.text})]},re.id)})})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[y.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600",children:[y.jsx(bx,{size:12,className:"text-gray-400"}),y.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",me(n.windDirection)]})]}),y.jsxs("button",{onClick:()=>V(!0),className:"flex items-center gap-1.5 text-gray-600 hover:bg-purple-50 rounded-lg p-1 -m-1 transition-colors border-0 bg-transparent cursor-pointer",children:[y.jsx(FD,{size:12,className:"text-purple-500"}),y.jsxs("span",{children:[Math.round(n.pressure)," hPa"]}),(()=>{const re=s();return re==="rising"?y.jsx(WD,{size:12,className:"text-green-500"}):re==="falling"?y.jsx(BD,{size:12,className:"text-red-500"}):y.jsx(zD,{size:12,className:"text-gray-400"})})(),y.jsx(Xc,{size:10,className:"text-gray-400 ml-auto"})]})]}),p&&y.jsxs(y.Fragment,{children:[y.jsxs("button",{onClick:()=>k(!0),className:"w-full flex items-center gap-2 p-2 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors border-0 cursor-pointer",children:[y.jsx(bf,{size:16,className:"text-blue-500"}),y.jsx("span",{className:"text-sm text-blue-700 font-medium",children:"Buienradar"}),y.jsx("span",{className:"text-xs text-blue-500 ml-auto",children:"Live kaart"}),y.jsx(Xc,{size:14,className:"text-blue-400"})]}),l.length>0&&y.jsx("button",{onClick:()=>P(!0),className:"w-full border-0 bg-transparent p-0 cursor-pointer text-left",children:y.jsxs("div",{className:"hover:bg-gray-50 rounded-lg p-1 -m-1 transition-colors",children:[y.jsxs("div",{className:"flex items-center justify-between mb-1",children:[y.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag komende 2 uur"}),y.jsx(Xc,{size:12,className:"text-gray-400"})]}),y.jsx(sq,{data:l})]})})]}),x&&o.length>0&&y.jsx(oq,{hourly:o}),f&&ie.length>0&&y.jsx("button",{onClick:()=>O(!0),className:"w-full border-0 bg-transparent p-0 cursor-pointer text-left",children:y.jsxs("div",{className:"space-y-1 hover:bg-gray-50 rounded-lg p-1 -m-1 transition-colors",children:[y.jsxs("div",{className:"text-[10px] text-gray-500 flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx(Rm,{size:12}),y.jsx("span",{children:"Volgende getijden"})]}),y.jsx(Xc,{size:12,className:"text-gray-400"})]}),y.jsx("div",{className:"flex gap-1",children:ie.map((re,_e)=>y.jsxs("div",{className:`flex-1 p-1.5 rounded text-center ${re.type==="high"?"bg-green-50":"bg-red-50"}`,children:[y.jsx("div",{className:`text-[9px] font-medium ${re.type==="high"?"text-green-600":"text-red-600"}`,children:re.type==="high"?"HW":"LW"}),y.jsx("div",{className:"text-[10px] font-medium",children:xe(re.time)})]},_e))})]})}),T&&y.jsxs("div",{className:"text-[9px] text-gray-400 text-center",children:["Waterdata: ",T.name]})]})})})]}):y.jsxs("button",{onClick:()=>{const re=u||vd;t(re.lat,re.lng)},className:"p-3 flex items-center gap-2 border-0 outline-none bg-transparent",children:[y.jsx(ku,{size:18,className:"text-gray-400"}),y.jsx("span",{className:"text-sm text-gray-500",children:"Weer laden"})]}),y.jsx(Vn,{children:L&&y.jsx(uq,{onClose:()=>O(!1)})}),y.jsx(Vn,{children:U&&o.length>0&&y.jsx(lq,{hourlyData:o,onClose:()=>P(!1)})}),y.jsx(Vn,{children:F&&n&&y.jsx(hq,{pressureHistory:r,currentPressure:n.pressure,trend:s(),onClose:()=>V(!1)})}),y.jsx(Vn,{children:B&&y.jsx(dq,{onClose:()=>k(!1)})})]})]}):null}const Am=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],pq=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],mq=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],lv=5;function yq({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=q.useRef(null),s=q.useRef(null),o=async u=>{const h=u.target.files;if(!h||h.length===0)return;const f=lv-n.length,p=Array.from(h).slice(0,f);for(const _ of p)try{const{thumbnailBase64:x}=await $D(_),S={id:HD(),thumbnailBase64:x,createdAt:new Date().toISOString(),pendingUpload:!0};e(S)}catch(x){console.error("Failed to process image:",x)}u.target.value=""},l=n.length<lv;return y.jsxs("div",{className:"space-y-2",children:[y.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",lv,")"]}),y.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(u=>y.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[y.jsx("img",{src:u.thumbnailUrl||u.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&y.jsx("button",{type:"button",onClick:()=>t(u.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:y.jsx(gi,{size:12,className:"text-white"})}),u.pendingUpload&&y.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},u.id)),l&&!i&&y.jsxs(y.Fragment,{children:[y.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[y.jsx(Ww,{size:20,className:"text-gray-400"}),y.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),y.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[y.jsx(TH,{size:20,className:"text-gray-400"}),y.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),y.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),y.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}const _q={Snoek:{colors:["green","yellow","spotted"],pattern:"elongated with spots"},Snoekbaars:{colors:["gray","silver","striped"],pattern:"elongated with stripes"},Baars:{colors:["green","black","striped","red-fins"],pattern:"oval with stripes"},Karper:{colors:["brown","gold","orange"],pattern:"large oval"},Brasem:{colors:["silver","bronze"],pattern:"flat oval"},Voorn:{colors:["silver","red-fins"],pattern:"small oval"},Zeelt:{colors:["green","brown","slimy"],pattern:"elongated"},Meerval:{colors:["dark","brown","black"],pattern:"large with whiskers"},Aal:{colors:["dark","silver-belly"],pattern:"snake-like"},Forel:{colors:["spotted","pink","silver"],pattern:"streamlined with spots"}};async function vq(n){return new Promise(e=>{const t=new Image;t.onload=()=>{const i=document.createElement("canvas"),r=i.getContext("2d");if(!r){e([]);return}const s=100;i.width=s,i.height=s;const o=(t.width-s)/2,l=(t.height-s)/2;r.drawImage(t,o,l,s,s,0,0,s,s);const h=r.getImageData(0,0,s,s).data;let f=0,p=0,_=0,x=0,S=0,I=0;const T=h.length/4;for(let L=0;L<h.length;L+=4){const O=h[L],U=h[L+1],P=h[L+2];f+=O,p+=U,U>O&&U>P&&_++,O>100&&U>80&&U<150&&P<100&&x++,O>150&&U>150&&P>150&&S++,O<80&&U<80&&P<80&&I++}const b=[];_/T>.2&&b.push("green"),x/T>.2&&b.push("brown"),S/T>.2&&b.push("silver"),I/T>.3&&b.push("dark");const N=f/T,M=p/T;N>150&&M>100&&M<180&&b.push("gold"),e(b)},t.src=n})}function xq(n){const e=[];for(const[t,i]of Object.entries(_q)){let r=0;for(const s of n)i.colors.some(o=>o.includes(s)||s.includes(o))&&r++;r>0&&e.push({species:t,score:r/i.colors.length})}return e.sort((t,i)=>i.score-t.score)}async function wq(n){try{const e=await vq(n),t=xq(e);if(t.length===0)return{species:"",confidence:0,suggestions:Am.slice(0,5).map(o=>o.name)};const i=t[0],r=t.slice(0,5).map(o=>o.species),s=["Snoek","Baars","Karper","Snoekbaars","Brasem"];for(const o of s)!r.includes(o)&&r.length<5&&r.push(o);return{species:i.score>.3?i.species:"",confidence:i.score,suggestions:r.slice(0,5)}}catch(e){return console.error("Fish recognition error:",e),{species:"",confidence:0,suggestions:Am.slice(0,5).map(t=>t.name)}}}function Eq(n){return{Snoek:{avgWeight:3e3,avgLength:70},Snoekbaars:{avgWeight:2500,avgLength:60},Baars:{avgWeight:500,avgLength:30},Karper:{avgWeight:8e3,avgLength:60},Brasem:{avgWeight:2e3,avgLength:45},Voorn:{avgWeight:300,avgLength:25},Zeelt:{avgWeight:1500,avgLength:40},Meerval:{avgWeight:15e3,avgLength:120},Aal:{avgWeight:800,avgLength:60},Forel:{avgWeight:1e3,avgLength:40},Kolblei:{avgWeight:500,avgLength:30},Winde:{avgWeight:1e3,avgLength:40},Kopvoorn:{avgWeight:800,avgLength:35},Ruisvoorn:{avgWeight:400,avgLength:25},Blankvoorn:{avgWeight:300,avgLength:25}}[n]||null}function Tq({onClose:n,initialLocation:e,initialLocationSource:t,initialPhotos:i=[]}){const r=YP(oe=>oe.addCatch),s=J1(oe=>oe.current),o=ai(oe=>oe.position),[l,u]=q.useState(e||(o?{lat:o.lat,lng:o.lng}:null)),[h,f]=q.useState(t||(o?"gps":null)),[p,_]=q.useState(""),[x,S]=q.useState(""),[I,T]=q.useState(""),[b,N]=q.useState(""),[M,L]=q.useState(""),[O,U]=q.useState(""),[P,C]=q.useState(i),[D,F]=q.useState(!1),[V,B]=q.useState([]),[k,te]=q.useState(0),de=async oe=>{if(C(me=>[...me,oe]),oe.dataUrl&&!p){F(!0);try{const me=await wq(oe.dataUrl);if(B(me.suggestions),te(me.confidence),me.species&&me.confidence>.4){_(me.species);const xe=Eq(me.species)}}catch(me){console.error("AI recognition failed:",me)}finally{F(!1)}}},ge=oe=>{_(oe),B([])},ue=oe=>{C(me=>me.filter(xe=>xe.id!==oe))},G=()=>{o&&(u({lat:o.lat,lng:o.lng}),f("gps"))},ie=oe=>{if(oe.preventDefault(),!p||!l){alert("Selecteer een vissoort en zorg dat er een locatie is");return}r({location:l,species:p,weight:x?parseInt(x):void 0,length:I?parseInt(I):void 0,photos:P.length>0?P:void 0,method:b||"Anders",bait:M||void 0,notes:O||void 0,weather:s?{temp:s.temperature,windSpeed:s.windSpeed,windDirection:s.windDirection,pressure:s.pressure}:void 0}),n()},W=(()=>{switch(h){case"gps":return{icon:Nu,label:"GPS",color:"text-blue-500"};case"photo":return{icon:Ww,label:"Foto EXIF",color:"text-green-500"};case"map":return{icon:Ry,label:"Kaart",color:"text-orange-500"};default:return{icon:Js,label:"Locatie",color:"text-gray-500"}}})(),$=W.icon;return y.jsx(We.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:y.jsxs(We.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:oe=>oe.stopPropagation(),children:[y.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Qs,{className:"text-white",size:24}),y.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),y.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:y.jsx(gi,{size:20})})]}),y.jsxs("form",{onSubmit:ie,className:"p-4 space-y-4",children:[y.jsx("div",{className:"space-y-2",children:l?y.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-gray-50 p-2 rounded-lg",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx($,{size:16,className:W.color}),y.jsxs("span",{className:"text-gray-600",children:[l.lat.toFixed(5),", ",l.lng.toFixed(5)]})]}),y.jsx("span",{className:`text-xs ${W.color} font-medium`,children:W.label})]}):y.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-red-50 p-2 rounded-lg text-red-600",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Js,{size:16}),y.jsx("span",{children:"Geen locatie"})]}),o&&y.jsx("button",{type:"button",onClick:G,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded-md border-0 outline-none",children:"Gebruik GPS"})]})}),y.jsxs("div",{children:[y.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:["Vissoort *",D&&y.jsxs("span",{className:"flex items-center gap-1 text-xs text-blue-500",children:[y.jsx(RH,{size:12,className:"animate-spin"}),"AI analyseert..."]})]}),y.jsx(Vn,{children:V.length>0&&!p&&y.jsxs(We.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-2 p-2 bg-blue-50 rounded-lg border border-blue-200",children:[y.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mb-2",children:[y.jsx(dK,{size:12}),y.jsxs("span",{children:["AI suggesties ",k>.3?`(${Math.round(k*100)}% zeker)`:""]})]}),y.jsx("div",{className:"flex flex-wrap gap-1",children:V.map(oe=>y.jsx("button",{type:"button",onClick:()=>ge(oe),className:"px-2 py-1 text-xs bg-white border border-blue-300 text-blue-700 rounded-full hover:bg-blue-100 transition-colors",children:oe},oe))})]})}),y.jsxs("select",{value:p,onChange:oe=>{_(oe.target.value),B([])},className:"form-select",required:!0,children:[y.jsx("option",{value:"",children:"Selecteer vissoort..."}),Am.map(oe=>y.jsx("option",{value:oe.name,children:oe.name},oe.name))]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{children:[y.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[y.jsx(sK,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),y.jsx("input",{type:"number",value:x,onChange:oe=>S(oe.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),y.jsxs("div",{children:[y.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[y.jsx(tK,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),y.jsx("input",{type:"number",value:I,onChange:oe=>T(oe.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),y.jsxs("select",{value:b,onChange:oe=>N(oe.target.value),className:"form-select",children:[y.jsx("option",{value:"",children:"Selecteer methode..."}),pq.map(oe=>y.jsx("option",{value:oe,children:oe},oe))]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),y.jsxs("select",{value:M,onChange:oe=>L(oe.target.value),className:"form-select",children:[y.jsx("option",{value:"",children:"Selecteer aas..."}),mq.map(oe=>y.jsx("option",{value:oe,children:oe},oe))]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),y.jsx("textarea",{value:O,onChange:oe=>U(oe.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),y.jsx(yq,{photos:P,onAddPhoto:de,onRemovePhoto:ue}),y.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function Sq(){const n=Fn(h=>h.catchFormOpen),e=Fn(h=>h.catchFormLocation),t=Fn(h=>h.catchFormLocationSource),i=Fn(h=>h.catchFormInitialPhotos),r=Fn(h=>h.openCatchForm),s=Fn(h=>h.closeCatchForm),o=ai(h=>h.position),l=He(h=>h.showCatchButton),u=()=>{o?r({location:{lat:o.lat,lng:o.lng},locationSource:"gps"}):r()};return y.jsxs(y.Fragment,{children:[l&&y.jsx(We.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:u,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:y.jsx(Qs,{size:22,strokeWidth:2})}),y.jsx(Vn,{children:n&&y.jsx(Tq,{onClose:s,initialLocation:e||void 0,initialLocationSource:t||void 0,initialPhotos:i})})]})}function Iq(){const n=fs(r=>r.map),e=YP(r=>r.catches),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new L1,t.current=new G1({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=pl([r.location.lng,r.location.lat]),o=new cu({geometry:new ml(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new tr({image:new kl({radius:14,fill:new Rr({color:"#22c55e"}),stroke:new Lu({color:"#fff",width:2})}),text:new df({text:l,font:"bold 12px sans-serif",fill:new Rr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function Cq(){const n=fs(r=>r.map),e=ZP(r=>r.spots),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new L1,t.current=new G1({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=pl([r.location.lng,r.location.lat]),o=new cu({geometry:new ml(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new tr({image:new kl({radius:12,fill:new Rr({color:l}),stroke:new Lu({color:"#fff",width:2})}),text:new df({text:"",font:"bold 14px sans-serif",fill:new Rr({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function Rq({onClose:n,initialLocation:e}){const t=ZP(T=>T.addSpot),[i,r]=q.useState(""),[s,o]=q.useState(""),[l,u]=q.useState([]),[h,f]=q.useState(""),[p,_]=q.useState(3),x=e,S=T=>{u(b=>b.includes(T)?b.filter(N=>N!==T):[...b,T])},I=T=>{if(T.preventDefault(),!i||!x){alert("Geef een naam op voor deze locatie");return}t({name:i,location:x,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:p}),n()};return y.jsx(We.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:y.jsxs(We.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:T=>T.stopPropagation(),children:[y.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Rx,{className:"text-white",size:24}),y.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),y.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:y.jsx(gi,{size:20})})]}),y.jsxs("form",{onSubmit:I,className:"p-4 space-y-4",children:[x&&y.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[y.jsx(Js,{size:16}),y.jsxs("span",{children:[x.lat.toFixed(5),", ",x.lng.toFixed(5)]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),y.jsx("input",{type:"text",value:i,onChange:T=>r(T.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),y.jsx("input",{type:"text",value:s,onChange:T=>o(T.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),y.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(T=>y.jsx("button",{type:"button",onClick:()=>_(T),className:"p-1 border-0 outline-none bg-transparent",children:y.jsx(Rx,{size:28,className:T<=p?"text-yellow-400 fill-yellow-400":"text-gray-300"})},T))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),y.jsx("div",{className:"flex flex-wrap gap-2",children:Am.slice(0,12).map(T=>y.jsx("button",{type:"button",onClick:()=>S(T.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(T.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:T.name},T.name))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),y.jsx("textarea",{value:h,onChange:T=>f(T.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),y.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const bq=[{name:"Aanlegsteigers",icon:MD,color:"#2196F3"},{name:"Trailerhellingen",icon:uK,color:"#4CAF50"},{name:"Dieptekaart",icon:Rm,color:"#00BCD4"},{name:"Viswater",icon:Js,color:"#9C27B0"}],Ub=[{name:"CartoDB Light",label:"Light"},{name:"Terrein",label:"Terrein"},{name:"OpenStreetMap",label:"Kaart"},{name:"Luchtfoto",label:"Satelliet"}];function Aq(){const n=Fn(x=>x.layerPanelOpen),e=Fn(x=>x.toggleLayerPanel),t=Xi(x=>x.visible),i=Xi(x=>x.opacity),r=Xi(x=>x.toggleLayer),s=Xi(x=>x.setLayerVisibility),o=Xi(x=>x.setLayerOpacity),l=x=>{Ub.forEach(S=>{s(S.name,S.name===x)}),x==="Luchtfoto"?s("Labels Overlay",!0):s("Labels Overlay",!1)},u=()=>{s("Labels Overlay",!t["Labels Overlay"])},h=i["AHN4 Hillshade"]??.5,f=t["AHN4 Hillshade"],p=i["PDOK Water NL"]??.7,_=t["PDOK Water NL"];return y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:y.jsx(We.button,{className:"w-11 h-11 bg-white/90 hover:bg-white backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:y.jsx(Jd,{size:22})})}),y.jsx(Vn,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(We.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),y.jsxs(We.div,{className:"fixed top-2 right-2 z-[1601] bg-white rounded-lg shadow-lg overflow-hidden w-[280px] max-h-[calc(100vh-100px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[y.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-orange-500",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Jd,{size:14,className:"text-white"}),y.jsx("span",{className:"font-medium text-white text-sm",children:"Kaartlagen"})]}),y.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-orange-400/50 hover:bg-orange-400 transition-colors",children:y.jsx(gi,{size:16,className:"text-white",strokeWidth:2.5})})]}),y.jsxs("div",{className:"p-2 overflow-y-auto flex-1",children:[y.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[y.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1.5 px-1 uppercase tracking-wide",children:"Achtergrond"}),y.jsx("div",{className:"flex gap-1",children:Ub.map(x=>y.jsx("button",{className:`flex-1 px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t[x.name]?"bg-orange-500 text-white":"bg-gray-100 text-gray-600 hover:bg-orange-50"}`,onClick:()=>l(x.name),children:x.label},x.name))}),t.Luchtfoto&&y.jsxs("button",{onClick:u,className:`mt-1.5 w-full flex items-center justify-between px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t["Labels Overlay"]?"bg-orange-50 text-orange-600":"bg-transparent text-gray-500 hover:bg-orange-50"}`,children:[y.jsxs("span",{className:"flex items-center gap-1.5",children:[y.jsx(yK,{size:12}),"Labels overlay"]}),t["Labels Overlay"]&&y.jsx(Cm,{size:12})]})]}),y.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[y.jsx("div",{className:"text-xs font-medium text-amber-600 mb-1.5 px-1 uppercase tracking-wide",children:"Hoogtekaart"}),y.jsx(Bb,{name:"AHN4 Hillshade",icon:zH,color:"#f59e0b",visible:f,opacity:h,onToggle:()=>r("AHN4 Hillshade"),onOpacityChange:x=>o("AHN4 Hillshade",x)})]}),y.jsxs("div",{className:"mb-3 pb-2 border-b border-gray-100",children:[y.jsx("div",{className:"text-xs font-medium text-cyan-600 mb-1.5 px-1 uppercase tracking-wide",children:"Water"}),y.jsx(Bb,{name:"PDOK Water NL",label:"Waterlopen NL",icon:Gw,color:"#0284c7",visible:_,opacity:p,onToggle:()=>r("PDOK Water NL"),onOpacityChange:x=>o("PDOK Water NL",x)})]}),y.jsxs("div",{children:[y.jsx("div",{className:"text-xs font-medium text-orange-600 mb-1.5 px-1 uppercase tracking-wide",children:"Vislagen"}),y.jsx("div",{className:"space-y-0.5",children:bq.map(x=>{const S=x.icon,I=t[x.name];return y.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors border-0 outline-none ${I?"bg-orange-50":"bg-transparent hover:bg-orange-50"}`,onClick:()=>r(x.name),children:[y.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center transition-colors",style:{backgroundColor:I?x.color:"#e5e7eb"},children:y.jsx(S,{size:12,className:"text-white"})}),y.jsx("span",{className:`text-sm ${I?"text-orange-700":"text-gray-600"}`,children:x.name}),y.jsx("div",{className:"ml-auto",children:y.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all",style:{backgroundColor:I?x.color:"white",border:`2px solid ${I?x.color:"#d1d5db"}`},children:I&&y.jsx(Cm,{size:10,className:"text-white",strokeWidth:3})})})]},x.name)})})]})]})]})]})})]})}function Bb({name:n,label:e,icon:t,color:i,visible:r,opacity:s,onToggle:o,onOpacityChange:l}){const u=e||n;return y.jsxs("div",{children:[y.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-colors border-0 outline-none ${r?"bg-gray-50":"bg-transparent hover:bg-gray-50"}`,onClick:o,children:[y.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center transition-colors",style:{backgroundColor:r?i:"#e5e7eb"},children:y.jsx(t,{size:12,className:"text-white"})}),y.jsx("span",{className:`text-sm ${r?"text-gray-800":"text-gray-600"}`,children:u}),y.jsx("div",{className:"ml-auto",children:y.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all",style:{backgroundColor:r?i:"white",border:`2px solid ${r?i:"#d1d5db"}`},children:r&&y.jsx(Cm,{size:10,className:"text-white",strokeWidth:3})})})]}),r&&y.jsx("div",{className:"mt-1 px-2 pb-1",children:y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[10px] text-gray-400 w-16",children:"Transparantie"}),y.jsx("input",{type:"range",min:"10",max:"100",value:s*100,onChange:h=>l(parseInt(h.target.value)/100),className:"flex-1 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{accentColor:i}}),y.jsxs("span",{className:"text-[10px] text-gray-400 w-6 text-right",children:[Math.round(s*100),"%"]})]})})]})}function Pq(){const n=Fn(T=>T.settingsPanelOpen),e=Fn(T=>T.toggleSettingsPanel),t=He(T=>T.showCatchButton),i=He(T=>T.setShowCatchButton),r=He(T=>T.showCatches),s=He(T=>T.setShowCatches),o=He(T=>T.showFavoriteSpots),l=He(T=>T.setShowFavoriteSpots),u=He(T=>T.defaultBackground),h=He(T=>T.setDefaultBackground),f=He(T=>T.fontScale),p=He(T=>T.setFontScale),_=He(T=>T.showFontSliders),x=He(T=>T.setShowFontSliders),S=Xi(T=>T.setLayerVisibility),I=T=>{h(T),S("Terrein",T==="Terrein"),S("OpenStreetMap",T==="OpenStreetMap"),S("Luchtfoto",T==="Luchtfoto"),S("Labels Overlay",T==="Luchtfoto")};return n?y.jsx(We.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:y.jsxs(We.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:T=>T.stopPropagation(),children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600",children:[y.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),y.jsx("button",{onClick:e,className:"p-1.5 rounded-lg bg-orange-600 hover:bg-orange-700 transition-colors border-0 outline-none",children:y.jsx(gi,{size:18,className:"text-white"})})]}),y.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[y.jsxs("div",{className:"space-y-3",children:[y.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),y.jsx(up,{icon:y.jsx(Qs,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),y.jsx(up,{icon:y.jsx(Qs,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),y.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[y.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),y.jsx(up,{icon:y.jsx(Js,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),y.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[y.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:y.jsx(Ry,{size:18,className:"text-gray-500"})}),y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),y.jsxs("select",{value:u,onChange:T=>I(T.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-orange-400",children:[y.jsx("option",{value:"Terrein",children:"Terrein (relif)"}),y.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),y.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),y.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[y.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weergave"}),y.jsx(up,{icon:y.jsx(EK,{size:18,className:"text-purple-500"}),label:"Tekstgrootte aanpassen",description:"Toon schuifbalk voor tekstgrootte",checked:_,onChange:x}),_&&y.jsxs("div",{className:"flex items-center gap-3 pl-2",children:[y.jsx("span",{className:"text-xs text-gray-500",children:"T"}),y.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:f,onChange:T=>p(parseInt(T.target.value)),className:"flex-1"}),y.jsx("span",{className:"text-lg text-gray-500",children:"T"}),y.jsxs("span",{className:"text-xs text-gray-500 w-10",children:[f,"%"]})]}),y.jsx("p",{className:"text-xs text-gray-400 pl-2",children:"Widgets via lang drukken op kaart  Widgets"})]})]}),y.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function up({icon:n,label:e,description:t,checked:i,onChange:r}){return y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),y.jsx("p",{className:"text-xs text-gray-400",children:t})]}),y.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-orange-500":"bg-gray-300"}`,children:y.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function kq(){const n=fs(S=>S.map),[e,t]=q.useState([]),[i,r]=q.useState(0),[s,o]=q.useState(!1),[l,u]=q.useState(null),h=e.length,f=e[i]||"";q.useEffect(()=>{if(!n)return;const S=async I=>{const T=[];if(n.forEachFeatureAtPixel(I.pixel,(b,N)=>{const M=b.getProperties(),L=N?.get("title")||"";let O="";if(L==="Aanlegsteigers"||M.layerType==="aanlegsteiger"){const U=M.name||"Aanlegsteiger",P=M.operator||"",C=M.access||"",D=M.fee||"",F=M.capacity||"",V=M.website||"";O=`<strong class="text-blue-800">${U}</strong>`,P&&(O+=`<br/><span class="text-sm text-gray-600">Beheerder: ${P}</span>`),C&&(O+=`<br/><span class="text-sm text-gray-600">Toegang: ${C==="yes"?"Openbaar":C==="private"?"Priv":C}</span>`),D&&(O+=`<br/><span class="text-sm text-gray-600">Kosten: ${D==="yes"?"Betaald":D==="no"?"Gratis":D}</span>`),F&&(O+=`<br/><span class="text-sm text-gray-600">Capaciteit: ${F} boten</span>`),V&&(O+=`<br/><a href="${V}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Website</a>`)}else if(L==="Trailerhellingen"||M.layerType==="trailerhelling"){const U=M.name||null,P=M.operator||"",C=M.access||"",D=M.fee||"",F=M.surface||"",V=M.website||"",B=M.description||"",k=M.opening_hours||"";let te="";D==="no"?te='<span class="inline-block px-2 py-0.5 bg-green-100 text-green-700 text-xs font-medium rounded-full">Gratis</span>':D==="yes"?te='<span class="inline-block px-2 py-0.5 bg-orange-100 text-orange-700 text-xs font-medium rounded-full">Betaald</span>':D&&(te=`<span class="inline-block px-2 py-0.5 bg-orange-100 text-orange-700 text-xs font-medium rounded-full">${D}</span>`),U?(O=`<strong class="text-green-800 text-lg">${U}</strong>`,te&&(O+=` ${te}`)):(O='<strong class="text-green-800 text-lg">Trailerhelling</strong>',te&&(O+=` ${te}`)),C&&(O+=`<br/><span class="text-sm text-gray-600">Toegang: ${C==="yes"||C==="public"||C==="permissive"?"Openbaar":C==="private"?"Priv":C==="customers"?"Alleen klanten":C}</span>`),P&&(O+=`<br/><span class="text-sm text-gray-600">Beheerder: ${P}</span>`),F&&(O+=`<br/><span class="text-sm text-gray-600">Ondergrond: ${{concrete:"Beton",asphalt:"Asfalt",gravel:"Grind",paved:"Verhard",unpaved:"Onverhard",grass:"Gras",sand:"Zand",wood:"Hout"}[F]||F}</span>`),k&&(O+=`<br/><span class="text-sm text-gray-600">Openingstijden: ${k}</span>`),B&&(O+=`<br/><span class="text-sm text-gray-500 italic">${B}</span>`),V&&(O+=`<br/><a href="${V}" target="_blank" rel="noopener noreferrer" class="text-green-600 hover:underline text-sm">Website</a>`)}else if(L==="Viswater"||M.layerType==="viswater"){const U=M.name||"Viswater",P=M.fishing||"",C=M.access||"",D=M.operator||"";O=`<strong class="text-purple-800">${U}</strong>`,P&&(O+=`<br/><span class="text-sm text-purple-700">Type: ${P}</span>`),D&&(O+=`<br/><span class="text-sm text-gray-600">Beheerder: ${D}</span>`),C&&(O+=`<br/><span class="text-sm text-gray-600">Toegang: ${C}</span>`)}else(M.name||M.title)&&(O=`<strong class="text-gray-800">${M.name||M.title}</strong>`,M.description&&(O+=`<br/><span class="text-sm text-gray-600">${M.description}</span>`));O&&T.push({content:O,coordinate:I.coordinate})}),T.length>0){t(T.map(N=>N.content)),r(0),o(!0);const b=Nv(T[0].coordinate);u(`https://www.google.com/maps/dir/?api=1&destination=${b[1]},${b[0]}`)}};return n.on("singleclick",S),()=>{n.un("singleclick",S)}},[n]);const p=()=>{o(!1),t([]),r(0),u(null)},_=()=>{i<h-1&&r(i+1)},x=()=>{i>0&&r(i-1)};return y.jsx(Vn,{children:s&&f&&y.jsxs(We.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},className:"fixed bottom-0 left-0 right-0 z-[1200] bg-white rounded-t-2xl shadow-lg max-h-[50vh] overflow-hidden",children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100 bg-gradient-to-r from-orange-500 to-orange-600",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[h>1&&y.jsxs("div",{className:"flex items-center gap-1 mr-2",children:[y.jsx("button",{onClick:x,disabled:i===0,className:"p-1 rounded bg-orange-600 hover:bg-orange-700 disabled:opacity-50 border-0 outline-none",children:y.jsx(tH,{size:16,className:"text-white"})}),y.jsxs("span",{className:"text-white text-xs px-1",children:[i+1,"/",h]}),y.jsx("button",{onClick:_,disabled:i===h-1,className:"p-1 rounded bg-orange-600 hover:bg-orange-700 disabled:opacity-50 border-0 outline-none",children:y.jsx(Xc,{size:16,className:"text-white"})})]}),y.jsx("span",{className:"font-medium text-white text-sm",children:"Info"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[l&&y.jsx("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 rounded bg-orange-600 hover:bg-orange-700 border-0 outline-none",title:"Navigeer met Google Maps",onClick:S=>S.stopPropagation(),children:y.jsx(Navigation2,{size:16,className:"text-white"})}),y.jsx("button",{onClick:p,className:"p-1.5 rounded bg-blue-600 hover:bg-blue-700 border-0 outline-none",children:y.jsx(gi,{size:16,className:"text-white"})})]})]}),y.jsx("div",{className:"p-4 overflow-y-auto",style:{maxHeight:"calc(50vh - 56px)"},dangerouslySetInnerHTML:{__html:f}})]})})}function Nq({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=ND(),[l,u]=q.useState(""),[h,f]=q.useState(!1),[p,_]=q.useState(!1),[x,S]=q.useState(null);if(q.useEffect(()=>{o()},[o]),s)return y.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-500 via-orange-600 to-orange-800 flex items-center justify-center",children:y.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return y.jsx(y.Fragment,{children:n});const I=b=>{b.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},T=async()=>{try{S(null),await i()}catch{S("Google login mislukt"),setTimeout(()=>S(null),3e3)}};return y.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-500 via-orange-600 to-orange-800 flex items-center justify-center p-4",children:y.jsxs(We.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[y.jsxs("div",{className:"flex flex-col items-center mb-6",children:[y.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-orange-500 to-orange-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:y.jsx(Qs,{size:40,className:"text-white"})}),y.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),y.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),y.jsxs(We.button,{onClick:T,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[y.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[y.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),y.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),y.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),y.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),x&&y.jsx(We.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:x}),y.jsxs("div",{className:"flex items-center gap-3 my-4",children:[y.jsx("div",{className:"flex-1 h-px bg-gray-200"}),y.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),y.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),y.jsxs("form",{onSubmit:I,className:"space-y-4",children:[y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:y.jsx(kH,{size:20})}),y.jsx("input",{type:p?"text":"password",value:l,onChange:b=>u(b.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-orange-400"}`}),y.jsx("button",{type:"button",onClick:()=>_(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p?y.jsx(pH,{size:20}):y.jsx(yH,{size:20})})]}),h&&y.jsx(We.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),y.jsx(We.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),y.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function Dq(){const n=Fn(s=>s.spotFormOpen),e=Fn(s=>s.spotFormLocation),t=Fn(s=>s.closeSpotForm),r=14*He(s=>s.fontScale)/100;return y.jsx(Nq,{children:y.jsxs("div",{className:"h-screen w-screen overflow-hidden",style:{fontSize:`${r}px`},children:[y.jsx(z$,{}),y.jsx(jK,{}),y.jsx(Iq,{}),y.jsx(Cq,{}),y.jsx(kq,{}),y.jsx(DK,{}),y.jsx(gq,{}),y.jsx(FK,{}),y.jsx(zK,{}),y.jsx(ZK,{}),y.jsx(KK,{}),y.jsx(Aq,{}),y.jsx(Sq,{}),y.jsx(LK,{}),y.jsx(UK,{}),y.jsx(Pq,{}),y.jsx(Vn,{children:n&&y.jsx(Rq,{onClose:t,initialLocation:e||void 0})})]})})}const Mq="1.2.40";console.log(`%c VisApp v${Mq}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");hL.createRoot(document.getElementById("root")).render(y.jsx(Dq,{}));export{hi as $,$A as A,Yc as B,EA as C,Fq as D,Ge as E,Rr as F,VV as G,Vq as H,O1 as I,Bq as J,Yq as K,Xq as L,VI as M,L4 as N,O4 as O,ml as P,qq as Q,$q as R,tr as S,Mh as T,Md as U,L1 as V,Gq as W,Jh as X,zq as Y,mr as Z,cu as _,G1 as a,it as a0,gp as a1,Bp as a2,lP as a3,Fv as a4,lu as a5,zV as a6,vP as a7,ol as a8,$o as a9,nr as aA,$m as aB,g1 as aC,al as aD,w6 as aE,jn as aa,Bm as ab,ze as ac,dn as ad,uu as ae,ft as af,qn as ag,li as ah,Hh as ai,Xs as aj,Zm as ak,Hq as al,TC as am,_6 as an,m6 as ao,v6 as ap,fP as aq,d1 as ar,Rd as as,Wg as at,Rv as au,eo as av,Kq as aw,jq as ax,Qq as ay,B6 as az,Lu as b,T1 as c,wA as d,f1 as e,BA as f,GV as g,zI as h,Kc as i,$V as j,C1 as k,UI as l,zA as m,I1 as n,GA as o,rt as p,Fm as q,HF as r,gl as s,UA as t,bt as u,WA as v,Uq as w,Wp as x,HV as y,Wq as z};
//# sourceMappingURL=index-BUGO8xKO.js.map
