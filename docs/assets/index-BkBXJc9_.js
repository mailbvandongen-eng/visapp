const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/aanlegsteigersOL-C-iGXQ4_.js","assets/GeoJSON-RYcd9IyI.js","assets/boothellingenOL-BUEgpQfw.js","assets/viswaterOL-B8TRm3Yq.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Rx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var $_={exports:{}},Sh={},K_={exports:{}},$e={};var YT;function HM(){if(YT)return $e;YT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator;function y(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,I={};function S(G,$,ie){this.props=G,this.context=$,this.refs=I,this.updater=ie||x}S.prototype.isReactComponent={},S.prototype.setState=function(G,$){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,$,"setState")},S.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function A(){}A.prototype=S.prototype;function D(G,$,ie){this.props=G,this.context=$,this.refs=I,this.updater=ie||x}var N=D.prototype=new A;N.constructor=D,T(N,S.prototype),N.isPureReactComponent=!0;var R=Array.isArray,L=Object.prototype.hasOwnProperty,j={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function b(G,$,ie){var pe,xe={},ke=null,Me=null;if($!=null)for(pe in $.ref!==void 0&&(Me=$.ref),$.key!==void 0&&(ke=""+$.key),$)L.call($,pe)&&!k.hasOwnProperty(pe)&&(xe[pe]=$[pe]);var je=arguments.length-2;if(je===1)xe.children=ie;else if(1<je){for(var Ge=Array(je),ct=0;ct<je;ct++)Ge[ct]=arguments[ct+2];xe.children=Ge}if(G&&G.defaultProps)for(pe in je=G.defaultProps,je)xe[pe]===void 0&&(xe[pe]=je[pe]);return{$$typeof:n,type:G,key:ke,ref:Me,props:xe,_owner:j.current}}function M(G,$){return{$$typeof:n,type:G.type,key:$,ref:G.ref,props:G.props,_owner:G._owner}}function V(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function z(G){var $={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(ie){return $[ie]})}var B=/\/+/g;function O(G,$){return typeof G=="object"&&G!==null&&G.key!=null?z(""+G.key):$.toString(36)}function le(G,$,ie,pe,xe){var ke=typeof G;(ke==="undefined"||ke==="boolean")&&(G=null);var Me=!1;if(G===null)Me=!0;else switch(ke){case"string":case"number":Me=!0;break;case"object":switch(G.$$typeof){case n:case e:Me=!0}}if(Me)return Me=G,xe=xe(Me),G=pe===""?"."+O(Me,0):pe,R(xe)?(ie="",G!=null&&(ie=G.replace(B,"$&/")+"/"),le(xe,$,ie,"",function(ct){return ct})):xe!=null&&(V(xe)&&(xe=M(xe,ie+(!xe.key||Me&&Me.key===xe.key?"":(""+xe.key).replace(B,"$&/")+"/")+G)),$.push(xe)),1;if(Me=0,pe=pe===""?".":pe+":",R(G))for(var je=0;je<G.length;je++){ke=G[je];var Ge=pe+O(ke,je);Me+=le(ke,$,ie,Ge,xe)}else if(Ge=y(G),typeof Ge=="function")for(G=Ge.call(G),je=0;!(ke=G.next()).done;)ke=ke.value,Ge=pe+O(ke,je++),Me+=le(ke,$,ie,Ge,xe);else if(ke==="object")throw $=String(G),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Me}function me(G,$,ie){if(G==null)return G;var pe=[],xe=0;return le(G,pe,"","",function(ke){return $.call(ie,ke,xe++)}),pe}function ge(G){if(G._status===-1){var $=G._result;$=$(),$.then(function(ie){(G._status===0||G._status===-1)&&(G._status=1,G._result=ie)},function(ie){(G._status===0||G._status===-1)&&(G._status=2,G._result=ie)}),G._status===-1&&(G._status=0,G._result=$)}if(G._status===1)return G._result.default;throw G._result}var ue={current:null},Q={transition:null},se={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:Q,ReactCurrentOwner:j};function ne(){throw Error("act(...) is not supported in production builds of React.")}return $e.Children={map:me,forEach:function(G,$,ie){me(G,function(){$.apply(this,arguments)},ie)},count:function(G){var $=0;return me(G,function(){$++}),$},toArray:function(G){return me(G,function($){return $})||[]},only:function(G){if(!V(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},$e.Component=S,$e.Fragment=t,$e.Profiler=r,$e.PureComponent=D,$e.StrictMode=i,$e.Suspense=u,$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=se,$e.act=ne,$e.cloneElement=function(G,$,ie){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var pe=T({},G.props),xe=G.key,ke=G.ref,Me=G._owner;if($!=null){if($.ref!==void 0&&(ke=$.ref,Me=j.current),$.key!==void 0&&(xe=""+$.key),G.type&&G.type.defaultProps)var je=G.type.defaultProps;for(Ge in $)L.call($,Ge)&&!k.hasOwnProperty(Ge)&&(pe[Ge]=$[Ge]===void 0&&je!==void 0?je[Ge]:$[Ge])}var Ge=arguments.length-2;if(Ge===1)pe.children=ie;else if(1<Ge){je=Array(Ge);for(var ct=0;ct<Ge;ct++)je[ct]=arguments[ct+2];pe.children=je}return{$$typeof:n,type:G.type,key:xe,ref:ke,props:pe,_owner:Me}},$e.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:s,_context:G},G.Consumer=G},$e.createElement=b,$e.createFactory=function(G){var $=b.bind(null,G);return $.type=G,$},$e.createRef=function(){return{current:null}},$e.forwardRef=function(G){return{$$typeof:l,render:G}},$e.isValidElement=V,$e.lazy=function(G){return{$$typeof:f,_payload:{_status:-1,_result:G},_init:ge}},$e.memo=function(G,$){return{$$typeof:h,type:G,compare:$===void 0?null:$}},$e.startTransition=function(G){var $=Q.transition;Q.transition={};try{G()}finally{Q.transition=$}},$e.unstable_act=ne,$e.useCallback=function(G,$){return ue.current.useCallback(G,$)},$e.useContext=function(G){return ue.current.useContext(G)},$e.useDebugValue=function(){},$e.useDeferredValue=function(G){return ue.current.useDeferredValue(G)},$e.useEffect=function(G,$){return ue.current.useEffect(G,$)},$e.useId=function(){return ue.current.useId()},$e.useImperativeHandle=function(G,$,ie){return ue.current.useImperativeHandle(G,$,ie)},$e.useInsertionEffect=function(G,$){return ue.current.useInsertionEffect(G,$)},$e.useLayoutEffect=function(G,$){return ue.current.useLayoutEffect(G,$)},$e.useMemo=function(G,$){return ue.current.useMemo(G,$)},$e.useReducer=function(G,$,ie){return ue.current.useReducer(G,$,ie)},$e.useRef=function(G){return ue.current.useRef(G)},$e.useState=function(G){return ue.current.useState(G)},$e.useSyncExternalStore=function(G,$,ie){return ue.current.useSyncExternalStore(G,$,ie)},$e.useTransition=function(){return ue.current.useTransition()},$e.version="18.3.1",$e}var ZT;function Zd(){return ZT||(ZT=1,K_.exports=HM()),K_.exports}var QT;function XM(){if(QT)return Sh;QT=1;var n=Zd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var f,m={},y=null,x=null;h!==void 0&&(y=""+h),u.key!==void 0&&(y=""+u.key),u.ref!==void 0&&(x=u.ref);for(f in u)i.call(u,f)&&!s.hasOwnProperty(f)&&(m[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)m[f]===void 0&&(m[f]=u[f]);return{$$typeof:e,type:l,key:y,ref:x,props:m,_owner:r.current}}return Sh.Fragment=t,Sh.jsx=o,Sh.jsxs=o,Sh}var JT;function qM(){return JT||(JT=1,$_.exports=XM()),$_.exports}var _=qM(),kg={},H_={exports:{}},Qn={},X_={exports:{}},q_={};var eS;function YM(){return eS||(eS=1,(function(n){function e(Q,se){var ne=Q.length;Q.push(se);e:for(;0<ne;){var G=ne-1>>>1,$=Q[G];if(0<r($,se))Q[G]=se,Q[ne]=$,ne=G;else break e}}function t(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var se=Q[0],ne=Q.pop();if(ne!==se){Q[0]=ne;e:for(var G=0,$=Q.length,ie=$>>>1;G<ie;){var pe=2*(G+1)-1,xe=Q[pe],ke=pe+1,Me=Q[ke];if(0>r(xe,ne))ke<$&&0>r(Me,xe)?(Q[G]=Me,Q[ke]=ne,G=ke):(Q[G]=xe,Q[pe]=ne,G=pe);else if(ke<$&&0>r(Me,ne))Q[G]=Me,Q[ke]=ne,G=ke;else break e}}return se}function r(Q,se){var ne=Q.sortIndex-se.sortIndex;return ne!==0?ne:Q.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,m=null,y=3,x=!1,T=!1,I=!1,S=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Q){for(var se=t(h);se!==null;){if(se.callback===null)i(h);else if(se.startTime<=Q)i(h),se.sortIndex=se.expirationTime,e(u,se);else break;se=t(h)}}function R(Q){if(I=!1,N(Q),!T)if(t(u)!==null)T=!0,ge(L);else{var se=t(h);se!==null&&ue(R,se.startTime-Q)}}function L(Q,se){T=!1,I&&(I=!1,A(b),b=-1),x=!0;var ne=y;try{for(N(se),m=t(u);m!==null&&(!(m.expirationTime>se)||Q&&!z());){var G=m.callback;if(typeof G=="function"){m.callback=null,y=m.priorityLevel;var $=G(m.expirationTime<=se);se=n.unstable_now(),typeof $=="function"?m.callback=$:m===t(u)&&i(u),N(se)}else i(u);m=t(u)}if(m!==null)var ie=!0;else{var pe=t(h);pe!==null&&ue(R,pe.startTime-se),ie=!1}return ie}finally{m=null,y=ne,x=!1}}var j=!1,k=null,b=-1,M=5,V=-1;function z(){return!(n.unstable_now()-V<M)}function B(){if(k!==null){var Q=n.unstable_now();V=Q;var se=!0;try{se=k(!0,Q)}finally{se?O():(j=!1,k=null)}}else j=!1}var O;if(typeof D=="function")O=function(){D(B)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,me=le.port2;le.port1.onmessage=B,O=function(){me.postMessage(null)}}else O=function(){S(B,0)};function ge(Q){k=Q,j||(j=!0,O())}function ue(Q,se){b=S(function(){Q(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_continueExecution=function(){T||x||(T=!0,ge(L))},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(Q){switch(y){case 1:case 2:case 3:var se=3;break;default:se=y}var ne=y;y=se;try{return Q()}finally{y=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Q,se){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ne=y;y=Q;try{return se()}finally{y=ne}},n.unstable_scheduleCallback=function(Q,se,ne){var G=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?G+ne:G):ne=G,Q){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,Q={id:f++,callback:se,priorityLevel:Q,startTime:ne,expirationTime:$,sortIndex:-1},ne>G?(Q.sortIndex=ne,e(h,Q),t(u)===null&&Q===t(h)&&(I?(A(b),b=-1):I=!0,ue(R,ne-G))):(Q.sortIndex=$,e(u,Q),T||x||(T=!0,ge(L))),Q},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(Q){var se=y;return function(){var ne=y;y=se;try{return Q.apply(this,arguments)}finally{y=ne}}}})(q_)),q_}var tS;function ZM(){return tS||(tS=1,X_.exports=YM()),X_.exports}var nS;function QM(){if(nS)return Qn;nS=1;var n=Zd(),e=ZM();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(r[a]=c,a=0;a<c.length;a++)i.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function y(a){return u.call(m,a)?!0:u.call(f,a)?!1:h.test(a)?m[a]=!0:(f[a]=!0,!1)}function x(a,c,d,p){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return p?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function T(a,c,d,p){if(c===null||typeof c>"u"||x(a,c,d,p))return!0;if(p)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function I(a,c,d,p,v,w,P){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=p,this.attributeNamespace=v,this.mustUseProperty=d,this.propertyName=a,this.type=c,this.sanitizeURL=w,this.removeEmptyString=P}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){S[a]=new I(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];S[c]=new I(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){S[a]=new I(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){S[a]=new I(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){S[a]=new I(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){S[a]=new I(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){S[a]=new I(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){S[a]=new I(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){S[a]=new I(a,5,!1,a.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function D(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(A,D);S[c]=new I(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(A,D);S[c]=new I(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(A,D);S[c]=new I(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){S[a]=new I(a,1,!1,a.toLowerCase(),null,!1,!1)}),S.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){S[a]=new I(a,1,!1,a.toLowerCase(),null,!0,!0)});function N(a,c,d,p){var v=S.hasOwnProperty(c)?S[c]:null;(v!==null?v.type!==0:p||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(T(c,d,v,p)&&(d=null),p||v===null?y(c)&&(d===null?a.removeAttribute(c):a.setAttribute(c,""+d)):v.mustUseProperty?a[v.propertyName]=d===null?v.type===3?!1:"":d:(c=v.attributeName,p=v.attributeNamespace,d===null?a.removeAttribute(c):(v=v.type,d=v===3||v===4&&d===!0?"":""+d,p?a.setAttributeNS(p,c,d):a.setAttribute(c,d))))}var R=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),j=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),z=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),ge=Symbol.for("react.lazy"),ue=Symbol.for("react.offscreen"),Q=Symbol.iterator;function se(a){return a===null||typeof a!="object"?null:(a=Q&&a[Q]||a["@@iterator"],typeof a=="function"?a:null)}var ne=Object.assign,G;function $(a){if(G===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);G=c&&c[1]||""}return`
`+G+a}var ie=!1;function pe(a,c){if(!a||ie)return"";ie=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(J){var p=J}Reflect.construct(a,[],c)}else{try{c.call()}catch(J){p=J}a.call(c.prototype)}else{try{throw Error()}catch(J){p=J}a()}}catch(J){if(J&&p&&typeof J.stack=="string"){for(var v=J.stack.split(`
`),w=p.stack.split(`
`),P=v.length-1,U=w.length-1;1<=P&&0<=U&&v[P]!==w[U];)U--;for(;1<=P&&0<=U;P--,U--)if(v[P]!==w[U]){if(P!==1||U!==1)do if(P--,U--,0>U||v[P]!==w[U]){var W=`
`+v[P].replace(" at new "," at ");return a.displayName&&W.includes("<anonymous>")&&(W=W.replace("<anonymous>",a.displayName)),W}while(1<=P&&0<=U);break}}}finally{ie=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?$(a):""}function xe(a){switch(a.tag){case 5:return $(a.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return a=pe(a.type,!1),a;case 11:return a=pe(a.type.render,!1),a;case 1:return a=pe(a.type,!0),a;default:return""}}function ke(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case k:return"Fragment";case j:return"Portal";case M:return"Profiler";case b:return"StrictMode";case O:return"Suspense";case le:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case z:return(a.displayName||"Context")+".Consumer";case V:return(a._context.displayName||"Context")+".Provider";case B:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case me:return c=a.displayName||null,c!==null?c:ke(a.type)||"Memo";case ge:c=a._payload,a=a._init;try{return ke(a(c))}catch{}}return null}function Me(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ke(c);case 8:return c===b?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function je(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ge(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ct(a){var c=Ge(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),p=""+a[c];if(!a.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,w=d.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return v.call(this)},set:function(P){p=""+P,w.call(this,P)}}),Object.defineProperty(a,c,{enumerable:d.enumerable}),{getValue:function(){return p},setValue:function(P){p=""+P},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function er(a){a._valueTracker||(a._valueTracker=ct(a))}function fs(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var d=c.getValue(),p="";return a&&(p=Ge(a)?a.checked?"true":"false":a.value),a=p,a!==d?(c.setValue(a),!0):!1}function Gn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function $n(a,c){var d=c.checked;return ne({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function hn(a,c){var d=c.defaultValue==null?"":c.defaultValue,p=c.checked!=null?c.checked:c.defaultChecked;d=je(c.value!=null?c.value:d),a._wrapperState={initialChecked:p,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function dn(a,c){c=c.checked,c!=null&&N(a,"checked",c,!1)}function Kn(a,c){dn(a,c);var d=je(c.value),p=c.type;if(d!=null)p==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(p==="submit"||p==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?_t(a,c.type,d):c.hasOwnProperty("defaultValue")&&_t(a,c.type,je(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function Pi(a,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var p=c.type;if(!(p!=="submit"&&p!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,d||c===a.value||(a.value=c),a.defaultValue=c}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function _t(a,c,d){(c!=="number"||Gn(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var ut=Array.isArray;function nn(a,c,d,p){if(a=a.options,c){c={};for(var v=0;v<d.length;v++)c["$"+d[v]]=!0;for(d=0;d<a.length;d++)v=c.hasOwnProperty("$"+a[d].value),a[d].selected!==v&&(a[d].selected=v),v&&p&&(a[d].defaultSelected=!0)}else{for(d=""+je(d),c=null,v=0;v<a.length;v++){if(a[v].value===d){a[v].selected=!0,p&&(a[v].defaultSelected=!0);return}c!==null||a[v].disabled||(c=a[v])}c!==null&&(c.selected=!0)}}function ki(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function It(a,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(t(92));if(ut(d)){if(1<d.length)throw Error(t(93));d=d[0]}c=d}c==null&&(c=""),d=c}a._wrapperState={initialValue:je(d)}}function to(a,c){var d=je(c.value),p=je(c.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),c.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),p!=null&&(a.defaultValue=""+p)}function Ni(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function Ar(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tr(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?Ar(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var br,ua=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,p,v){MSApp.execUnsafeLocalFunction(function(){return a(c,d,p,v)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(br=br||document.createElement("div"),br.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=br.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function Pr(a,c){if(c){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=c;return}}a.textContent=c}var Di={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fl=["Webkit","ms","Moz","O"];Object.keys(Di).forEach(function(a){Fl.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Di[c]=Di[a]})});function kr(a,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||Di.hasOwnProperty(a)&&Di[a]?(""+c).trim():c+"px"}function gs(a,c){a=a.style;for(var d in c)if(c.hasOwnProperty(d)){var p=d.indexOf("--")===0,v=kr(d,c[d],p);d==="float"&&(d="cssFloat"),p?a.setProperty(d,v):a[d]=v}}var no=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function On(a,c){if(c){if(no[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function ms(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nr=null;function Dr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Fn=null,Vn=null,gt=null;function io(a){if(a=ch(a)){if(typeof Fn!="function")throw Error(t(280));var c=a.stateNode;c&&(c=Kf(c),Fn(a.stateNode,a.type,c))}}function nr(a){Vn?gt?gt.push(a):gt=[a]:Vn=a}function Ft(){if(Vn){var a=Vn,c=gt;if(gt=Vn=null,io(a),c)for(a=0;a<c.length;a++)io(c[a])}}function Mi(a,c){return a(c)}function fn(){}var Vt=!1;function gn(a,c,d){if(Vt)return a(c,d);Vt=!0;try{return Mi(a,c,d)}finally{Vt=!1,(Vn!==null||gt!==null)&&(fn(),Ft())}}function mn(a,c){var d=a.stateNode;if(d===null)return null;var p=Kf(d);if(p===null)return null;d=p[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(a=a.type,p=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!p;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,c,typeof d));return d}var rn=!1;if(l)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){rn=!0}}),window.addEventListener("test",rt,rt),window.removeEventListener("test",rt,rt)}catch{rn=!1}function Wt(a,c,d,p,v,w,P,U,W){var J=Array.prototype.slice.call(arguments,3);try{c.apply(d,J)}catch(oe){this.onError(oe)}}var qt=!1,Li=null,Vl=!1,Oi=null,Sf={onError:function(a){qt=!0,Li=a}};function If(a,c,d,p,v,w,P,U,W){qt=!1,Li=null,Wt.apply(Sf,arguments)}function Fu(a,c,d,p,v,w,P,U,W){if(If.apply(this,arguments),qt){if(qt){var J=Li;qt=!1,Li=null}else throw Error(t(198));Vl||(Vl=!0,Oi=J)}}function ir(a){var c=a,d=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(d=c.return),a=c.return;while(a)}return c.tag===3?d:null}function Vu(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function Cf(a){if(ir(a)!==a)throw Error(t(188))}function Rf(a){var c=a.alternate;if(!c){if(c=ir(a),c===null)throw Error(t(188));return c!==a?null:a}for(var d=a,p=c;;){var v=d.return;if(v===null)break;var w=v.alternate;if(w===null){if(p=v.return,p!==null){d=p;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===d)return Cf(v),a;if(w===p)return Cf(v),c;w=w.sibling}throw Error(t(188))}if(d.return!==p.return)d=v,p=w;else{for(var P=!1,U=v.child;U;){if(U===d){P=!0,d=v,p=w;break}if(U===p){P=!0,p=v,d=w;break}U=U.sibling}if(!P){for(U=w.child;U;){if(U===d){P=!0,d=w,p=v;break}if(U===p){P=!0,p=w,d=v;break}U=U.sibling}if(!P)throw Error(t(189))}}if(d.alternate!==p)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:c}function Af(a){return a=Rf(a),a!==null?ha(a):null}function ha(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=ha(a);if(c!==null)return c;a=a.sibling}return null}var ju=e.unstable_scheduleCallback,jl=e.unstable_cancelCallback,da=e.unstable_shouldYield,ps=e.unstable_requestPaint,xt=e.unstable_now,Ey=e.unstable_getCurrentPriorityLevel,zl=e.unstable_ImmediatePriority,zu=e.unstable_UserBlockingPriority,fa=e.unstable_NormalPriority,Uu=e.unstable_LowPriority,Ul=e.unstable_IdlePriority,ga=null,di=null;function bf(a){if(di&&typeof di.onCommitFiberRoot=="function")try{di.onCommitFiberRoot(ga,a,void 0,(a.current.flags&128)===128)}catch{}}var fi=Math.clz32?Math.clz32:ma,Mr=Math.log,Fi=Math.LN2;function ma(a){return a>>>=0,a===0?32:31-(Mr(a)/Fi|0)|0}var Lr=64,ro=4194304;function st(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ys(a,c){var d=a.pendingLanes;if(d===0)return 0;var p=0,v=a.suspendedLanes,w=a.pingedLanes,P=d&268435455;if(P!==0){var U=P&~v;U!==0?p=st(U):(w&=P,w!==0&&(p=st(w)))}else P=d&~v,P!==0?p=st(P):w!==0&&(p=st(w));if(p===0)return 0;if(c!==0&&c!==p&&(c&v)===0&&(v=p&-p,w=c&-c,v>=w||v===16&&(w&4194240)!==0))return c;if((p&4)!==0&&(p|=d&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=p;0<c;)d=31-fi(c),v=1<<d,p|=a[d],c&=~v;return p}function pa(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ya(a,c){for(var d=a.suspendedLanes,p=a.pingedLanes,v=a.expirationTimes,w=a.pendingLanes;0<w;){var P=31-fi(w),U=1<<P,W=v[P];W===-1?((U&d)===0||(U&p)!==0)&&(v[P]=pa(U,c)):W<=c&&(a.expiredLanes|=U),w&=~U}}function Bu(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Wu(){var a=Lr;return Lr<<=1,(Lr&4194240)===0&&(Lr=64),a}function Gu(a){for(var c=[],d=0;31>d;d++)c.push(a);return c}function _a(a,c,d){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-fi(c),a[c]=d}function Ty(a,c){var d=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var p=a.eventTimes;for(a=a.expirationTimes;0<d;){var v=31-fi(d),w=1<<v;c[v]=0,p[v]=-1,a[v]=-1,d&=~w}}function $u(a,c){var d=a.entangledLanes|=c;for(a=a.entanglements;d;){var p=31-fi(d),v=1<<p;v&c|a[p]&c&&(a[p]|=c),d&=~v}}var Xe=0;function Or(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Ku,Bl,Hu,Xu,qu,Fr=!1,Wl=[],Vr=null,jr=null,pn=null,va=new Map,_s=new Map,gi=[],Pf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function so(a,c){switch(a){case"focusin":case"focusout":Vr=null;break;case"dragenter":case"dragleave":jr=null;break;case"mouseover":case"mouseout":pn=null;break;case"pointerover":case"pointerout":va.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":_s.delete(c.pointerId)}}function rr(a,c,d,p,v,w){return a===null||a.nativeEvent!==w?(a={blockedOn:c,domEventName:d,eventSystemFlags:p,nativeEvent:w,targetContainers:[v]},c!==null&&(c=ch(c),c!==null&&Bl(c)),a):(a.eventSystemFlags|=p,c=a.targetContainers,v!==null&&c.indexOf(v)===-1&&c.push(v),a)}function kf(a,c,d,p,v){switch(c){case"focusin":return Vr=rr(Vr,a,c,d,p,v),!0;case"dragenter":return jr=rr(jr,a,c,d,p,v),!0;case"mouseover":return pn=rr(pn,a,c,d,p,v),!0;case"pointerover":var w=v.pointerId;return va.set(w,rr(va.get(w)||null,a,c,d,p,v)),!0;case"gotpointercapture":return w=v.pointerId,_s.set(w,rr(_s.get(w)||null,a,c,d,p,v)),!0}return!1}function Gl(a){var c=Ta(a.target);if(c!==null){var d=ir(c);if(d!==null){if(c=d.tag,c===13){if(c=Vu(d),c!==null){a.blockedOn=c,qu(a.priority,function(){Hu(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function pt(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var d=$l(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var p=new d.constructor(d.type,d);Nr=p,d.target.dispatchEvent(p),Nr=null}else return c=ch(d),c!==null&&Bl(c),a.blockedOn=d,!1;c.shift()}return!0}function Nf(a,c,d){pt(a)&&d.delete(c)}function Sy(){Fr=!1,Vr!==null&&pt(Vr)&&(Vr=null),jr!==null&&pt(jr)&&(jr=null),pn!==null&&pt(pn)&&(pn=null),va.forEach(Nf),_s.forEach(Nf)}function oo(a,c){a.blockedOn===c&&(a.blockedOn=null,Fr||(Fr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Sy)))}function ao(a){function c(v){return oo(v,a)}if(0<Wl.length){oo(Wl[0],a);for(var d=1;d<Wl.length;d++){var p=Wl[d];p.blockedOn===a&&(p.blockedOn=null)}}for(Vr!==null&&oo(Vr,a),jr!==null&&oo(jr,a),pn!==null&&oo(pn,a),va.forEach(c),_s.forEach(c),d=0;d<gi.length;d++)p=gi[d],p.blockedOn===a&&(p.blockedOn=null);for(;0<gi.length&&(d=gi[0],d.blockedOn===null);)Gl(d),d.blockedOn===null&&gi.shift()}var vs=R.ReactCurrentBatchConfig,xs=!0;function zr(a,c,d,p){var v=Xe,w=vs.transition;vs.transition=null;try{Xe=1,Yu(a,c,d,p)}finally{Xe=v,vs.transition=w}}function Df(a,c,d,p){var v=Xe,w=vs.transition;vs.transition=null;try{Xe=4,Yu(a,c,d,p)}finally{Xe=v,vs.transition=w}}function Yu(a,c,d,p){if(xs){var v=$l(a,c,d,p);if(v===null)Ly(a,c,p,Ur,d),so(a,p);else if(kf(v,a,c,d,p))p.stopPropagation();else if(so(a,p),c&4&&-1<Pf.indexOf(a)){for(;v!==null;){var w=ch(v);if(w!==null&&Ku(w),w=$l(a,c,d,p),w===null&&Ly(a,c,p,Ur,d),w===v)break;v=w}v!==null&&p.stopPropagation()}else Ly(a,c,p,null,d)}}var Ur=null;function $l(a,c,d,p){if(Ur=null,a=Dr(p),a=Ta(a),a!==null)if(c=ir(a),c===null)a=null;else if(d=c.tag,d===13){if(a=Vu(c),a!==null)return a;a=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return Ur=a,null}function Kl(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ey()){case zl:return 1;case zu:return 4;case fa:case Uu:return 16;case Ul:return 536870912;default:return 16}default:return 16}}var mi=null,Hl=null,ws=null;function Mf(){if(ws)return ws;var a,c=Hl,d=c.length,p,v="value"in mi?mi.value:mi.textContent,w=v.length;for(a=0;a<d&&c[a]===v[a];a++);var P=d-a;for(p=1;p<=P&&c[d-p]===v[w-p];p++);return ws=v.slice(a,1<p?1-p:void 0)}function xa(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Br(){return!0}function Zu(){return!1}function Cn(a){function c(d,p,v,w,P){this._reactName=d,this._targetInst=v,this.type=p,this.nativeEvent=w,this.target=P,this.currentTarget=null;for(var U in a)a.hasOwnProperty(U)&&(d=a[U],this[U]=d?d(w):w[U]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Br:Zu,this.isPropagationStopped=Zu,this}return ne(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Br)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Br)},persist:function(){},isPersistent:Br}),c}var Wr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wa=Cn(Wr),lo=ne({},Wr,{view:0,detail:0}),Xl=Cn(lo),ql,Yl,pi,Ea=ne({},lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ze,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==pi&&(pi&&a.type==="mousemove"?(ql=a.screenX-pi.screenX,Yl=a.screenY-pi.screenY):Yl=ql=0,pi=a),ql)},movementY:function(a){return"movementY"in a?a.movementY:Yl}}),Qu=Cn(Ea),Lf=ne({},Ea,{dataTransfer:0}),Of=Cn(Lf),Zl=ne({},lo,{relatedTarget:0}),yn=Cn(Zl),Ff=ne({},Wr,{animationName:0,elapsedTime:0,pseudoElement:0}),Vf=Cn(Ff),co=ne({},Wr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),g=Cn(co),E=ne({},Wr,{data:0}),C=Cn(E),F={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function de(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=ee[a])?!!c[a]:!1}function ze(){return de}var jt=ne({},lo,{key:function(a){if(a.key){var c=F[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=xa(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?X[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ze,charCode:function(a){return a.type==="keypress"?xa(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?xa(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),ht=Cn(jt),Gt=ne({},Ea,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yi=Cn(Gt),Es=ne({},lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ze}),Gr=Cn(Es),$r=ne({},Wr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ql=Cn($r),Ju=ne({},Ea,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),UD=Cn(Ju),BD=[9,13,27,32],Iy=l&&"CompositionEvent"in window,eh=null;l&&"documentMode"in document&&(eh=document.documentMode);var WD=l&&"TextEvent"in window&&!eh,Bw=l&&(!Iy||eh&&8<eh&&11>=eh),Ww=" ",Gw=!1;function $w(a,c){switch(a){case"keyup":return BD.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kw(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Jl=!1;function GD(a,c){switch(a){case"compositionend":return Kw(c);case"keypress":return c.which!==32?null:(Gw=!0,Ww);case"textInput":return a=c.data,a===Ww&&Gw?null:a;default:return null}}function $D(a,c){if(Jl)return a==="compositionend"||!Iy&&$w(a,c)?(a=Mf(),ws=Hl=mi=null,Jl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Bw&&c.locale!=="ko"?null:c.data;default:return null}}var KD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hw(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!KD[a.type]:c==="textarea"}function Xw(a,c,d,p){nr(p),c=Wf(c,"onChange"),0<c.length&&(d=new wa("onChange","change",null,d,p),a.push({event:d,listeners:c}))}var th=null,nh=null;function HD(a){dE(a,0)}function jf(a){var c=rc(a);if(fs(c))return a}function XD(a,c){if(a==="change")return c}var qw=!1;if(l){var Cy;if(l){var Ry="oninput"in document;if(!Ry){var Yw=document.createElement("div");Yw.setAttribute("oninput","return;"),Ry=typeof Yw.oninput=="function"}Cy=Ry}else Cy=!1;qw=Cy&&(!document.documentMode||9<document.documentMode)}function Zw(){th&&(th.detachEvent("onpropertychange",Qw),nh=th=null)}function Qw(a){if(a.propertyName==="value"&&jf(nh)){var c=[];Xw(c,nh,a,Dr(a)),gn(HD,c)}}function qD(a,c,d){a==="focusin"?(Zw(),th=c,nh=d,th.attachEvent("onpropertychange",Qw)):a==="focusout"&&Zw()}function YD(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return jf(nh)}function ZD(a,c){if(a==="click")return jf(c)}function QD(a,c){if(a==="input"||a==="change")return jf(c)}function JD(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var sr=typeof Object.is=="function"?Object.is:JD;function ih(a,c){if(sr(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var d=Object.keys(a),p=Object.keys(c);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var v=d[p];if(!u.call(c,v)||!sr(a[v],c[v]))return!1}return!0}function Jw(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function eE(a,c){var d=Jw(a);a=0;for(var p;d;){if(d.nodeType===3){if(p=a+d.textContent.length,a<=c&&p>=c)return{node:d,offset:c-a};a=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Jw(d)}}function tE(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?tE(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function nE(){for(var a=window,c=Gn();c instanceof a.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)a=c.contentWindow;else break;c=Gn(a.document)}return c}function Ay(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function eM(a){var c=nE(),d=a.focusedElem,p=a.selectionRange;if(c!==d&&d&&d.ownerDocument&&tE(d.ownerDocument.documentElement,d)){if(p!==null&&Ay(d)){if(c=p.start,a=p.end,a===void 0&&(a=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(a,d.value.length);else if(a=(c=d.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var v=d.textContent.length,w=Math.min(p.start,v);p=p.end===void 0?w:Math.min(p.end,v),!a.extend&&w>p&&(v=p,p=w,w=v),v=eE(d,w);var P=eE(d,p);v&&P&&(a.rangeCount!==1||a.anchorNode!==v.node||a.anchorOffset!==v.offset||a.focusNode!==P.node||a.focusOffset!==P.offset)&&(c=c.createRange(),c.setStart(v.node,v.offset),a.removeAllRanges(),w>p?(a.addRange(c),a.extend(P.node,P.offset)):(c.setEnd(P.node,P.offset),a.addRange(c)))}}for(c=[],a=d;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)a=c[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var tM=l&&"documentMode"in document&&11>=document.documentMode,ec=null,by=null,rh=null,Py=!1;function iE(a,c,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Py||ec==null||ec!==Gn(p)||(p=ec,"selectionStart"in p&&Ay(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),rh&&ih(rh,p)||(rh=p,p=Wf(by,"onSelect"),0<p.length&&(c=new wa("onSelect","select",null,c,d),a.push({event:c,listeners:p}),c.target=ec)))}function zf(a,c){var d={};return d[a.toLowerCase()]=c.toLowerCase(),d["Webkit"+a]="webkit"+c,d["Moz"+a]="moz"+c,d}var tc={animationend:zf("Animation","AnimationEnd"),animationiteration:zf("Animation","AnimationIteration"),animationstart:zf("Animation","AnimationStart"),transitionend:zf("Transition","TransitionEnd")},ky={},rE={};l&&(rE=document.createElement("div").style,"AnimationEvent"in window||(delete tc.animationend.animation,delete tc.animationiteration.animation,delete tc.animationstart.animation),"TransitionEvent"in window||delete tc.transitionend.transition);function Uf(a){if(ky[a])return ky[a];if(!tc[a])return a;var c=tc[a],d;for(d in c)if(c.hasOwnProperty(d)&&d in rE)return ky[a]=c[d];return a}var sE=Uf("animationend"),oE=Uf("animationiteration"),aE=Uf("animationstart"),lE=Uf("transitionend"),cE=new Map,uE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function uo(a,c){cE.set(a,c),s(c,[a])}for(var Ny=0;Ny<uE.length;Ny++){var Dy=uE[Ny],nM=Dy.toLowerCase(),iM=Dy[0].toUpperCase()+Dy.slice(1);uo(nM,"on"+iM)}uo(sE,"onAnimationEnd"),uo(oE,"onAnimationIteration"),uo(aE,"onAnimationStart"),uo("dblclick","onDoubleClick"),uo("focusin","onFocus"),uo("focusout","onBlur"),uo(lE,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rM=new Set("cancel close invalid load scroll toggle".split(" ").concat(sh));function hE(a,c,d){var p=a.type||"unknown-event";a.currentTarget=d,Fu(p,c,void 0,a),a.currentTarget=null}function dE(a,c){c=(c&4)!==0;for(var d=0;d<a.length;d++){var p=a[d],v=p.event;p=p.listeners;e:{var w=void 0;if(c)for(var P=p.length-1;0<=P;P--){var U=p[P],W=U.instance,J=U.currentTarget;if(U=U.listener,W!==w&&v.isPropagationStopped())break e;hE(v,U,J),w=W}else for(P=0;P<p.length;P++){if(U=p[P],W=U.instance,J=U.currentTarget,U=U.listener,W!==w&&v.isPropagationStopped())break e;hE(v,U,J),w=W}}}if(Vl)throw a=Oi,Vl=!1,Oi=null,a}function wt(a,c){var d=c[Uy];d===void 0&&(d=c[Uy]=new Set);var p=a+"__bubble";d.has(p)||(fE(c,a,2,!1),d.add(p))}function My(a,c,d){var p=0;c&&(p|=4),fE(d,a,p,c)}var Bf="_reactListening"+Math.random().toString(36).slice(2);function oh(a){if(!a[Bf]){a[Bf]=!0,i.forEach(function(d){d!=="selectionchange"&&(rM.has(d)||My(d,!1,a),My(d,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Bf]||(c[Bf]=!0,My("selectionchange",!1,c))}}function fE(a,c,d,p){switch(Kl(c)){case 1:var v=zr;break;case 4:v=Df;break;default:v=Yu}d=v.bind(null,c,d,a),v=void 0,!rn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(v=!0),p?v!==void 0?a.addEventListener(c,d,{capture:!0,passive:v}):a.addEventListener(c,d,!0):v!==void 0?a.addEventListener(c,d,{passive:v}):a.addEventListener(c,d,!1)}function Ly(a,c,d,p,v){var w=p;if((c&1)===0&&(c&2)===0&&p!==null)e:for(;;){if(p===null)return;var P=p.tag;if(P===3||P===4){var U=p.stateNode.containerInfo;if(U===v||U.nodeType===8&&U.parentNode===v)break;if(P===4)for(P=p.return;P!==null;){var W=P.tag;if((W===3||W===4)&&(W=P.stateNode.containerInfo,W===v||W.nodeType===8&&W.parentNode===v))return;P=P.return}for(;U!==null;){if(P=Ta(U),P===null)return;if(W=P.tag,W===5||W===6){p=w=P;continue e}U=U.parentNode}}p=p.return}gn(function(){var J=w,oe=Dr(d),ce=[];e:{var re=cE.get(a);if(re!==void 0){var ye=wa,ve=a;switch(a){case"keypress":if(xa(d)===0)break e;case"keydown":case"keyup":ye=ht;break;case"focusin":ve="focus",ye=yn;break;case"focusout":ve="blur",ye=yn;break;case"beforeblur":case"afterblur":ye=yn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=Qu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=Of;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=Gr;break;case sE:case oE:case aE:ye=Vf;break;case lE:ye=Ql;break;case"scroll":ye=Xl;break;case"wheel":ye=UD;break;case"copy":case"cut":case"paste":ye=g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=yi}var we=(c&4)!==0,zt=!we&&a==="scroll",H=we?re!==null?re+"Capture":null:re;we=[];for(var K=J,Y;K!==null;){Y=K;var he=Y.stateNode;if(Y.tag===5&&he!==null&&(Y=he,H!==null&&(he=mn(K,H),he!=null&&we.push(ah(K,he,Y)))),zt)break;K=K.return}0<we.length&&(re=new ye(re,ve,null,d,oe),ce.push({event:re,listeners:we}))}}if((c&7)===0){e:{if(re=a==="mouseover"||a==="pointerover",ye=a==="mouseout"||a==="pointerout",re&&d!==Nr&&(ve=d.relatedTarget||d.fromElement)&&(Ta(ve)||ve[Ts]))break e;if((ye||re)&&(re=oe.window===oe?oe:(re=oe.ownerDocument)?re.defaultView||re.parentWindow:window,ye?(ve=d.relatedTarget||d.toElement,ye=J,ve=ve?Ta(ve):null,ve!==null&&(zt=ir(ve),ve!==zt||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(ye=null,ve=J),ye!==ve)){if(we=Qu,he="onMouseLeave",H="onMouseEnter",K="mouse",(a==="pointerout"||a==="pointerover")&&(we=yi,he="onPointerLeave",H="onPointerEnter",K="pointer"),zt=ye==null?re:rc(ye),Y=ve==null?re:rc(ve),re=new we(he,K+"leave",ye,d,oe),re.target=zt,re.relatedTarget=Y,he=null,Ta(oe)===J&&(we=new we(H,K+"enter",ve,d,oe),we.target=Y,we.relatedTarget=zt,he=we),zt=he,ye&&ve)t:{for(we=ye,H=ve,K=0,Y=we;Y;Y=nc(Y))K++;for(Y=0,he=H;he;he=nc(he))Y++;for(;0<K-Y;)we=nc(we),K--;for(;0<Y-K;)H=nc(H),Y--;for(;K--;){if(we===H||H!==null&&we===H.alternate)break t;we=nc(we),H=nc(H)}we=null}else we=null;ye!==null&&gE(ce,re,ye,we,!1),ve!==null&&zt!==null&&gE(ce,zt,ve,we,!0)}}e:{if(re=J?rc(J):window,ye=re.nodeName&&re.nodeName.toLowerCase(),ye==="select"||ye==="input"&&re.type==="file")var Te=XD;else if(Hw(re))if(qw)Te=QD;else{Te=YD;var be=qD}else(ye=re.nodeName)&&ye.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Te=ZD);if(Te&&(Te=Te(a,J))){Xw(ce,Te,d,oe);break e}be&&be(a,re,J),a==="focusout"&&(be=re._wrapperState)&&be.controlled&&re.type==="number"&&_t(re,"number",re.value)}switch(be=J?rc(J):window,a){case"focusin":(Hw(be)||be.contentEditable==="true")&&(ec=be,by=J,rh=null);break;case"focusout":rh=by=ec=null;break;case"mousedown":Py=!0;break;case"contextmenu":case"mouseup":case"dragend":Py=!1,iE(ce,d,oe);break;case"selectionchange":if(tM)break;case"keydown":case"keyup":iE(ce,d,oe)}var Pe;if(Iy)e:{switch(a){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else Jl?$w(a,d)&&(Le="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Le="onCompositionStart");Le&&(Bw&&d.locale!=="ko"&&(Jl||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&Jl&&(Pe=Mf()):(mi=oe,Hl="value"in mi?mi.value:mi.textContent,Jl=!0)),be=Wf(J,Le),0<be.length&&(Le=new C(Le,a,null,d,oe),ce.push({event:Le,listeners:be}),Pe?Le.data=Pe:(Pe=Kw(d),Pe!==null&&(Le.data=Pe)))),(Pe=WD?GD(a,d):$D(a,d))&&(J=Wf(J,"onBeforeInput"),0<J.length&&(oe=new C("onBeforeInput","beforeinput",null,d,oe),ce.push({event:oe,listeners:J}),oe.data=Pe))}dE(ce,c)})}function ah(a,c,d){return{instance:a,listener:c,currentTarget:d}}function Wf(a,c){for(var d=c+"Capture",p=[];a!==null;){var v=a,w=v.stateNode;v.tag===5&&w!==null&&(v=w,w=mn(a,d),w!=null&&p.unshift(ah(a,w,v)),w=mn(a,c),w!=null&&p.push(ah(a,w,v))),a=a.return}return p}function nc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function gE(a,c,d,p,v){for(var w=c._reactName,P=[];d!==null&&d!==p;){var U=d,W=U.alternate,J=U.stateNode;if(W!==null&&W===p)break;U.tag===5&&J!==null&&(U=J,v?(W=mn(d,w),W!=null&&P.unshift(ah(d,W,U))):v||(W=mn(d,w),W!=null&&P.push(ah(d,W,U)))),d=d.return}P.length!==0&&a.push({event:c,listeners:P})}var sM=/\r\n?/g,oM=/\u0000|\uFFFD/g;function mE(a){return(typeof a=="string"?a:""+a).replace(sM,`
`).replace(oM,"")}function Gf(a,c,d){if(c=mE(c),mE(a)!==c&&d)throw Error(t(425))}function $f(){}var Oy=null,Fy=null;function Vy(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var jy=typeof setTimeout=="function"?setTimeout:void 0,aM=typeof clearTimeout=="function"?clearTimeout:void 0,pE=typeof Promise=="function"?Promise:void 0,lM=typeof queueMicrotask=="function"?queueMicrotask:typeof pE<"u"?function(a){return pE.resolve(null).then(a).catch(cM)}:jy;function cM(a){setTimeout(function(){throw a})}function zy(a,c){var d=c,p=0;do{var v=d.nextSibling;if(a.removeChild(d),v&&v.nodeType===8)if(d=v.data,d==="/$"){if(p===0){a.removeChild(v),ao(c);return}p--}else d!=="$"&&d!=="$?"&&d!=="$!"||p++;d=v}while(d);ao(c)}function ho(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function yE(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return a;c--}else d==="/$"&&c++}a=a.previousSibling}return null}var ic=Math.random().toString(36).slice(2),Kr="__reactFiber$"+ic,lh="__reactProps$"+ic,Ts="__reactContainer$"+ic,Uy="__reactEvents$"+ic,uM="__reactListeners$"+ic,hM="__reactHandles$"+ic;function Ta(a){var c=a[Kr];if(c)return c;for(var d=a.parentNode;d;){if(c=d[Ts]||d[Kr]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(a=yE(a);a!==null;){if(d=a[Kr])return d;a=yE(a)}return c}a=d,d=a.parentNode}return null}function ch(a){return a=a[Kr]||a[Ts],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function rc(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Kf(a){return a[lh]||null}var By=[],sc=-1;function fo(a){return{current:a}}function Et(a){0>sc||(a.current=By[sc],By[sc]=null,sc--)}function vt(a,c){sc++,By[sc]=a.current,a.current=c}var go={},Rn=fo(go),Hn=fo(!1),Sa=go;function oc(a,c){var d=a.type.contextTypes;if(!d)return go;var p=a.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===c)return p.__reactInternalMemoizedMaskedChildContext;var v={},w;for(w in d)v[w]=c[w];return p&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=v),v}function Xn(a){return a=a.childContextTypes,a!=null}function Hf(){Et(Hn),Et(Rn)}function _E(a,c,d){if(Rn.current!==go)throw Error(t(168));vt(Rn,c),vt(Hn,d)}function vE(a,c,d){var p=a.stateNode;if(c=c.childContextTypes,typeof p.getChildContext!="function")return d;p=p.getChildContext();for(var v in p)if(!(v in c))throw Error(t(108,Me(a)||"Unknown",v));return ne({},d,p)}function Xf(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||go,Sa=Rn.current,vt(Rn,a),vt(Hn,Hn.current),!0}function xE(a,c,d){var p=a.stateNode;if(!p)throw Error(t(169));d?(a=vE(a,c,Sa),p.__reactInternalMemoizedMergedChildContext=a,Et(Hn),Et(Rn),vt(Rn,a)):Et(Hn),vt(Hn,d)}var Ss=null,qf=!1,Wy=!1;function wE(a){Ss===null?Ss=[a]:Ss.push(a)}function dM(a){qf=!0,wE(a)}function mo(){if(!Wy&&Ss!==null){Wy=!0;var a=0,c=Xe;try{var d=Ss;for(Xe=1;a<d.length;a++){var p=d[a];do p=p(!0);while(p!==null)}Ss=null,qf=!1}catch(v){throw Ss!==null&&(Ss=Ss.slice(a+1)),ju(zl,mo),v}finally{Xe=c,Wy=!1}}return null}var ac=[],lc=0,Yf=null,Zf=0,Vi=[],ji=0,Ia=null,Is=1,Cs="";function Ca(a,c){ac[lc++]=Zf,ac[lc++]=Yf,Yf=a,Zf=c}function EE(a,c,d){Vi[ji++]=Is,Vi[ji++]=Cs,Vi[ji++]=Ia,Ia=a;var p=Is;a=Cs;var v=32-fi(p)-1;p&=~(1<<v),d+=1;var w=32-fi(c)+v;if(30<w){var P=v-v%5;w=(p&(1<<P)-1).toString(32),p>>=P,v-=P,Is=1<<32-fi(c)+v|d<<v|p,Cs=w+a}else Is=1<<w|d<<v|p,Cs=a}function Gy(a){a.return!==null&&(Ca(a,1),EE(a,1,0))}function $y(a){for(;a===Yf;)Yf=ac[--lc],ac[lc]=null,Zf=ac[--lc],ac[lc]=null;for(;a===Ia;)Ia=Vi[--ji],Vi[ji]=null,Cs=Vi[--ji],Vi[ji]=null,Is=Vi[--ji],Vi[ji]=null}var _i=null,vi=null,Ct=!1,or=null;function TE(a,c){var d=Wi(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=a,c=a.deletions,c===null?(a.deletions=[d],a.flags|=16):c.push(d)}function SE(a,c){switch(a.tag){case 5:var d=a.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,_i=a,vi=ho(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,_i=a,vi=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Ia!==null?{id:Is,overflow:Cs}:null,a.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=Wi(18,null,null,0),d.stateNode=c,d.return=a,a.child=d,_i=a,vi=null,!0):!1;default:return!1}}function Ky(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Hy(a){if(Ct){var c=vi;if(c){var d=c;if(!SE(a,c)){if(Ky(a))throw Error(t(418));c=ho(d.nextSibling);var p=_i;c&&SE(a,c)?TE(p,d):(a.flags=a.flags&-4097|2,Ct=!1,_i=a)}}else{if(Ky(a))throw Error(t(418));a.flags=a.flags&-4097|2,Ct=!1,_i=a}}}function IE(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;_i=a}function Qf(a){if(a!==_i)return!1;if(!Ct)return IE(a),Ct=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!Vy(a.type,a.memoizedProps)),c&&(c=vi)){if(Ky(a))throw CE(),Error(t(418));for(;c;)TE(a,c),c=ho(c.nextSibling)}if(IE(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(c===0){vi=ho(a.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}a=a.nextSibling}vi=null}}else vi=_i?ho(a.stateNode.nextSibling):null;return!0}function CE(){for(var a=vi;a;)a=ho(a.nextSibling)}function cc(){vi=_i=null,Ct=!1}function Xy(a){or===null?or=[a]:or.push(a)}var fM=R.ReactCurrentBatchConfig;function uh(a,c,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var p=d.stateNode}if(!p)throw Error(t(147,a));var v=p,w=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===w?c.ref:(c=function(P){var U=v.refs;P===null?delete U[w]:U[w]=P},c._stringRef=w,c)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function Jf(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function RE(a){var c=a._init;return c(a._payload)}function AE(a){function c(H,K){if(a){var Y=H.deletions;Y===null?(H.deletions=[K],H.flags|=16):Y.push(K)}}function d(H,K){if(!a)return null;for(;K!==null;)c(H,K),K=K.sibling;return null}function p(H,K){for(H=new Map;K!==null;)K.key!==null?H.set(K.key,K):H.set(K.index,K),K=K.sibling;return H}function v(H,K){return H=To(H,K),H.index=0,H.sibling=null,H}function w(H,K,Y){return H.index=Y,a?(Y=H.alternate,Y!==null?(Y=Y.index,Y<K?(H.flags|=2,K):Y):(H.flags|=2,K)):(H.flags|=1048576,K)}function P(H){return a&&H.alternate===null&&(H.flags|=2),H}function U(H,K,Y,he){return K===null||K.tag!==6?(K=j_(Y,H.mode,he),K.return=H,K):(K=v(K,Y),K.return=H,K)}function W(H,K,Y,he){var Te=Y.type;return Te===k?oe(H,K,Y.props.children,he,Y.key):K!==null&&(K.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&RE(Te)===K.type)?(he=v(K,Y.props),he.ref=uh(H,K,Y),he.return=H,he):(he=Tg(Y.type,Y.key,Y.props,null,H.mode,he),he.ref=uh(H,K,Y),he.return=H,he)}function J(H,K,Y,he){return K===null||K.tag!==4||K.stateNode.containerInfo!==Y.containerInfo||K.stateNode.implementation!==Y.implementation?(K=z_(Y,H.mode,he),K.return=H,K):(K=v(K,Y.children||[]),K.return=H,K)}function oe(H,K,Y,he,Te){return K===null||K.tag!==7?(K=Ma(Y,H.mode,he,Te),K.return=H,K):(K=v(K,Y),K.return=H,K)}function ce(H,K,Y){if(typeof K=="string"&&K!==""||typeof K=="number")return K=j_(""+K,H.mode,Y),K.return=H,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case L:return Y=Tg(K.type,K.key,K.props,null,H.mode,Y),Y.ref=uh(H,null,K),Y.return=H,Y;case j:return K=z_(K,H.mode,Y),K.return=H,K;case ge:var he=K._init;return ce(H,he(K._payload),Y)}if(ut(K)||se(K))return K=Ma(K,H.mode,Y,null),K.return=H,K;Jf(H,K)}return null}function re(H,K,Y,he){var Te=K!==null?K.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Te!==null?null:U(H,K,""+Y,he);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case L:return Y.key===Te?W(H,K,Y,he):null;case j:return Y.key===Te?J(H,K,Y,he):null;case ge:return Te=Y._init,re(H,K,Te(Y._payload),he)}if(ut(Y)||se(Y))return Te!==null?null:oe(H,K,Y,he,null);Jf(H,Y)}return null}function ye(H,K,Y,he,Te){if(typeof he=="string"&&he!==""||typeof he=="number")return H=H.get(Y)||null,U(K,H,""+he,Te);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case L:return H=H.get(he.key===null?Y:he.key)||null,W(K,H,he,Te);case j:return H=H.get(he.key===null?Y:he.key)||null,J(K,H,he,Te);case ge:var be=he._init;return ye(H,K,Y,be(he._payload),Te)}if(ut(he)||se(he))return H=H.get(Y)||null,oe(K,H,he,Te,null);Jf(K,he)}return null}function ve(H,K,Y,he){for(var Te=null,be=null,Pe=K,Le=K=0,an=null;Pe!==null&&Le<Y.length;Le++){Pe.index>Le?(an=Pe,Pe=null):an=Pe.sibling;var et=re(H,Pe,Y[Le],he);if(et===null){Pe===null&&(Pe=an);break}a&&Pe&&et.alternate===null&&c(H,Pe),K=w(et,K,Le),be===null?Te=et:be.sibling=et,be=et,Pe=an}if(Le===Y.length)return d(H,Pe),Ct&&Ca(H,Le),Te;if(Pe===null){for(;Le<Y.length;Le++)Pe=ce(H,Y[Le],he),Pe!==null&&(K=w(Pe,K,Le),be===null?Te=Pe:be.sibling=Pe,be=Pe);return Ct&&Ca(H,Le),Te}for(Pe=p(H,Pe);Le<Y.length;Le++)an=ye(Pe,H,Le,Y[Le],he),an!==null&&(a&&an.alternate!==null&&Pe.delete(an.key===null?Le:an.key),K=w(an,K,Le),be===null?Te=an:be.sibling=an,be=an);return a&&Pe.forEach(function(So){return c(H,So)}),Ct&&Ca(H,Le),Te}function we(H,K,Y,he){var Te=se(Y);if(typeof Te!="function")throw Error(t(150));if(Y=Te.call(Y),Y==null)throw Error(t(151));for(var be=Te=null,Pe=K,Le=K=0,an=null,et=Y.next();Pe!==null&&!et.done;Le++,et=Y.next()){Pe.index>Le?(an=Pe,Pe=null):an=Pe.sibling;var So=re(H,Pe,et.value,he);if(So===null){Pe===null&&(Pe=an);break}a&&Pe&&So.alternate===null&&c(H,Pe),K=w(So,K,Le),be===null?Te=So:be.sibling=So,be=So,Pe=an}if(et.done)return d(H,Pe),Ct&&Ca(H,Le),Te;if(Pe===null){for(;!et.done;Le++,et=Y.next())et=ce(H,et.value,he),et!==null&&(K=w(et,K,Le),be===null?Te=et:be.sibling=et,be=et);return Ct&&Ca(H,Le),Te}for(Pe=p(H,Pe);!et.done;Le++,et=Y.next())et=ye(Pe,H,Le,et.value,he),et!==null&&(a&&et.alternate!==null&&Pe.delete(et.key===null?Le:et.key),K=w(et,K,Le),be===null?Te=et:be.sibling=et,be=et);return a&&Pe.forEach(function(KM){return c(H,KM)}),Ct&&Ca(H,Le),Te}function zt(H,K,Y,he){if(typeof Y=="object"&&Y!==null&&Y.type===k&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case L:e:{for(var Te=Y.key,be=K;be!==null;){if(be.key===Te){if(Te=Y.type,Te===k){if(be.tag===7){d(H,be.sibling),K=v(be,Y.props.children),K.return=H,H=K;break e}}else if(be.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===ge&&RE(Te)===be.type){d(H,be.sibling),K=v(be,Y.props),K.ref=uh(H,be,Y),K.return=H,H=K;break e}d(H,be);break}else c(H,be);be=be.sibling}Y.type===k?(K=Ma(Y.props.children,H.mode,he,Y.key),K.return=H,H=K):(he=Tg(Y.type,Y.key,Y.props,null,H.mode,he),he.ref=uh(H,K,Y),he.return=H,H=he)}return P(H);case j:e:{for(be=Y.key;K!==null;){if(K.key===be)if(K.tag===4&&K.stateNode.containerInfo===Y.containerInfo&&K.stateNode.implementation===Y.implementation){d(H,K.sibling),K=v(K,Y.children||[]),K.return=H,H=K;break e}else{d(H,K);break}else c(H,K);K=K.sibling}K=z_(Y,H.mode,he),K.return=H,H=K}return P(H);case ge:return be=Y._init,zt(H,K,be(Y._payload),he)}if(ut(Y))return ve(H,K,Y,he);if(se(Y))return we(H,K,Y,he);Jf(H,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,K!==null&&K.tag===6?(d(H,K.sibling),K=v(K,Y),K.return=H,H=K):(d(H,K),K=j_(Y,H.mode,he),K.return=H,H=K),P(H)):d(H,K)}return zt}var uc=AE(!0),bE=AE(!1),eg=fo(null),tg=null,hc=null,qy=null;function Yy(){qy=hc=tg=null}function Zy(a){var c=eg.current;Et(eg),a._currentValue=c}function Qy(a,c,d){for(;a!==null;){var p=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,p!==null&&(p.childLanes|=c)):p!==null&&(p.childLanes&c)!==c&&(p.childLanes|=c),a===d)break;a=a.return}}function dc(a,c){tg=a,qy=hc=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(qn=!0),a.firstContext=null)}function zi(a){var c=a._currentValue;if(qy!==a)if(a={context:a,memoizedValue:c,next:null},hc===null){if(tg===null)throw Error(t(308));hc=a,tg.dependencies={lanes:0,firstContext:a}}else hc=hc.next=a;return c}var Ra=null;function Jy(a){Ra===null?Ra=[a]:Ra.push(a)}function PE(a,c,d,p){var v=c.interleaved;return v===null?(d.next=d,Jy(c)):(d.next=v.next,v.next=d),c.interleaved=d,Rs(a,p)}function Rs(a,c){a.lanes|=c;var d=a.alternate;for(d!==null&&(d.lanes|=c),d=a,a=a.return;a!==null;)a.childLanes|=c,d=a.alternate,d!==null&&(d.childLanes|=c),d=a,a=a.return;return d.tag===3?d.stateNode:null}var po=!1;function e_(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kE(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function As(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function yo(a,c,d){var p=a.updateQueue;if(p===null)return null;if(p=p.shared,(Je&2)!==0){var v=p.pending;return v===null?c.next=c:(c.next=v.next,v.next=c),p.pending=c,Rs(a,d)}return v=p.interleaved,v===null?(c.next=c,Jy(p)):(c.next=v.next,v.next=c),p.interleaved=c,Rs(a,d)}function ng(a,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var p=c.lanes;p&=a.pendingLanes,d|=p,c.lanes=d,$u(a,d)}}function NE(a,c){var d=a.updateQueue,p=a.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var v=null,w=null;if(d=d.firstBaseUpdate,d!==null){do{var P={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};w===null?v=w=P:w=w.next=P,d=d.next}while(d!==null);w===null?v=w=c:w=w.next=c}else v=w=c;d={baseState:p.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:p.shared,effects:p.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=c}function ig(a,c,d,p){var v=a.updateQueue;po=!1;var w=v.firstBaseUpdate,P=v.lastBaseUpdate,U=v.shared.pending;if(U!==null){v.shared.pending=null;var W=U,J=W.next;W.next=null,P===null?w=J:P.next=J,P=W;var oe=a.alternate;oe!==null&&(oe=oe.updateQueue,U=oe.lastBaseUpdate,U!==P&&(U===null?oe.firstBaseUpdate=J:U.next=J,oe.lastBaseUpdate=W))}if(w!==null){var ce=v.baseState;P=0,oe=J=W=null,U=w;do{var re=U.lane,ye=U.eventTime;if((p&re)===re){oe!==null&&(oe=oe.next={eventTime:ye,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var ve=a,we=U;switch(re=c,ye=d,we.tag){case 1:if(ve=we.payload,typeof ve=="function"){ce=ve.call(ye,ce,re);break e}ce=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=we.payload,re=typeof ve=="function"?ve.call(ye,ce,re):ve,re==null)break e;ce=ne({},ce,re);break e;case 2:po=!0}}U.callback!==null&&U.lane!==0&&(a.flags|=64,re=v.effects,re===null?v.effects=[U]:re.push(U))}else ye={eventTime:ye,lane:re,tag:U.tag,payload:U.payload,callback:U.callback,next:null},oe===null?(J=oe=ye,W=ce):oe=oe.next=ye,P|=re;if(U=U.next,U===null){if(U=v.shared.pending,U===null)break;re=U,U=re.next,re.next=null,v.lastBaseUpdate=re,v.shared.pending=null}}while(!0);if(oe===null&&(W=ce),v.baseState=W,v.firstBaseUpdate=J,v.lastBaseUpdate=oe,c=v.shared.interleaved,c!==null){v=c;do P|=v.lane,v=v.next;while(v!==c)}else w===null&&(v.shared.lanes=0);Pa|=P,a.lanes=P,a.memoizedState=ce}}function DE(a,c,d){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var p=a[c],v=p.callback;if(v!==null){if(p.callback=null,p=d,typeof v!="function")throw Error(t(191,v));v.call(p)}}}var hh={},Hr=fo(hh),dh=fo(hh),fh=fo(hh);function Aa(a){if(a===hh)throw Error(t(174));return a}function t_(a,c){switch(vt(fh,c),vt(dh,a),vt(Hr,hh),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:tr(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=tr(c,a)}Et(Hr),vt(Hr,c)}function fc(){Et(Hr),Et(dh),Et(fh)}function ME(a){Aa(fh.current);var c=Aa(Hr.current),d=tr(c,a.type);c!==d&&(vt(dh,a),vt(Hr,d))}function n_(a){dh.current===a&&(Et(Hr),Et(dh))}var bt=fo(0);function rg(a){for(var c=a;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var i_=[];function r_(){for(var a=0;a<i_.length;a++)i_[a]._workInProgressVersionPrimary=null;i_.length=0}var sg=R.ReactCurrentDispatcher,s_=R.ReactCurrentBatchConfig,ba=0,Pt=null,Yt=null,sn=null,og=!1,gh=!1,mh=0,gM=0;function An(){throw Error(t(321))}function o_(a,c){if(c===null)return!1;for(var d=0;d<c.length&&d<a.length;d++)if(!sr(a[d],c[d]))return!1;return!0}function a_(a,c,d,p,v,w){if(ba=w,Pt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,sg.current=a===null||a.memoizedState===null?_M:vM,a=d(p,v),gh){w=0;do{if(gh=!1,mh=0,25<=w)throw Error(t(301));w+=1,sn=Yt=null,c.updateQueue=null,sg.current=xM,a=d(p,v)}while(gh)}if(sg.current=cg,c=Yt!==null&&Yt.next!==null,ba=0,sn=Yt=Pt=null,og=!1,c)throw Error(t(300));return a}function l_(){var a=mh!==0;return mh=0,a}function Xr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?Pt.memoizedState=sn=a:sn=sn.next=a,sn}function Ui(){if(Yt===null){var a=Pt.alternate;a=a!==null?a.memoizedState:null}else a=Yt.next;var c=sn===null?Pt.memoizedState:sn.next;if(c!==null)sn=c,Yt=a;else{if(a===null)throw Error(t(310));Yt=a,a={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},sn===null?Pt.memoizedState=sn=a:sn=sn.next=a}return sn}function ph(a,c){return typeof c=="function"?c(a):c}function c_(a){var c=Ui(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var p=Yt,v=p.baseQueue,w=d.pending;if(w!==null){if(v!==null){var P=v.next;v.next=w.next,w.next=P}p.baseQueue=v=w,d.pending=null}if(v!==null){w=v.next,p=p.baseState;var U=P=null,W=null,J=w;do{var oe=J.lane;if((ba&oe)===oe)W!==null&&(W=W.next={lane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),p=J.hasEagerState?J.eagerState:a(p,J.action);else{var ce={lane:oe,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null};W===null?(U=W=ce,P=p):W=W.next=ce,Pt.lanes|=oe,Pa|=oe}J=J.next}while(J!==null&&J!==w);W===null?P=p:W.next=U,sr(p,c.memoizedState)||(qn=!0),c.memoizedState=p,c.baseState=P,c.baseQueue=W,d.lastRenderedState=p}if(a=d.interleaved,a!==null){v=a;do w=v.lane,Pt.lanes|=w,Pa|=w,v=v.next;while(v!==a)}else v===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function u_(a){var c=Ui(),d=c.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var p=d.dispatch,v=d.pending,w=c.memoizedState;if(v!==null){d.pending=null;var P=v=v.next;do w=a(w,P.action),P=P.next;while(P!==v);sr(w,c.memoizedState)||(qn=!0),c.memoizedState=w,c.baseQueue===null&&(c.baseState=w),d.lastRenderedState=w}return[w,p]}function LE(){}function OE(a,c){var d=Pt,p=Ui(),v=c(),w=!sr(p.memoizedState,v);if(w&&(p.memoizedState=v,qn=!0),p=p.queue,h_(jE.bind(null,d,p,a),[a]),p.getSnapshot!==c||w||sn!==null&&sn.memoizedState.tag&1){if(d.flags|=2048,yh(9,VE.bind(null,d,p,v,c),void 0,null),on===null)throw Error(t(349));(ba&30)!==0||FE(d,c,v)}return v}function FE(a,c,d){a.flags|=16384,a={getSnapshot:c,value:d},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.stores=[a]):(d=c.stores,d===null?c.stores=[a]:d.push(a))}function VE(a,c,d,p){c.value=d,c.getSnapshot=p,zE(c)&&UE(a)}function jE(a,c,d){return d(function(){zE(c)&&UE(a)})}function zE(a){var c=a.getSnapshot;a=a.value;try{var d=c();return!sr(a,d)}catch{return!0}}function UE(a){var c=Rs(a,1);c!==null&&ur(c,a,1,-1)}function BE(a){var c=Xr();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ph,lastRenderedState:a},c.queue=a,a=a.dispatch=yM.bind(null,Pt,a),[c.memoizedState,a]}function yh(a,c,d,p){return a={tag:a,create:c,destroy:d,deps:p,next:null},c=Pt.updateQueue,c===null?(c={lastEffect:null,stores:null},Pt.updateQueue=c,c.lastEffect=a.next=a):(d=c.lastEffect,d===null?c.lastEffect=a.next=a:(p=d.next,d.next=a,a.next=p,c.lastEffect=a)),a}function WE(){return Ui().memoizedState}function ag(a,c,d,p){var v=Xr();Pt.flags|=a,v.memoizedState=yh(1|c,d,void 0,p===void 0?null:p)}function lg(a,c,d,p){var v=Ui();p=p===void 0?null:p;var w=void 0;if(Yt!==null){var P=Yt.memoizedState;if(w=P.destroy,p!==null&&o_(p,P.deps)){v.memoizedState=yh(c,d,w,p);return}}Pt.flags|=a,v.memoizedState=yh(1|c,d,w,p)}function GE(a,c){return ag(8390656,8,a,c)}function h_(a,c){return lg(2048,8,a,c)}function $E(a,c){return lg(4,2,a,c)}function KE(a,c){return lg(4,4,a,c)}function HE(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function XE(a,c,d){return d=d!=null?d.concat([a]):null,lg(4,4,HE.bind(null,c,a),d)}function d_(){}function qE(a,c){var d=Ui();c=c===void 0?null:c;var p=d.memoizedState;return p!==null&&c!==null&&o_(c,p[1])?p[0]:(d.memoizedState=[a,c],a)}function YE(a,c){var d=Ui();c=c===void 0?null:c;var p=d.memoizedState;return p!==null&&c!==null&&o_(c,p[1])?p[0]:(a=a(),d.memoizedState=[a,c],a)}function ZE(a,c,d){return(ba&21)===0?(a.baseState&&(a.baseState=!1,qn=!0),a.memoizedState=d):(sr(d,c)||(d=Wu(),Pt.lanes|=d,Pa|=d,a.baseState=!0),c)}function mM(a,c){var d=Xe;Xe=d!==0&&4>d?d:4,a(!0);var p=s_.transition;s_.transition={};try{a(!1),c()}finally{Xe=d,s_.transition=p}}function QE(){return Ui().memoizedState}function pM(a,c,d){var p=wo(a);if(d={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null},JE(a))eT(c,d);else if(d=PE(a,c,d,p),d!==null){var v=zn();ur(d,a,p,v),tT(d,c,p)}}function yM(a,c,d){var p=wo(a),v={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null};if(JE(a))eT(c,v);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=c.lastRenderedReducer,w!==null))try{var P=c.lastRenderedState,U=w(P,d);if(v.hasEagerState=!0,v.eagerState=U,sr(U,P)){var W=c.interleaved;W===null?(v.next=v,Jy(c)):(v.next=W.next,W.next=v),c.interleaved=v;return}}catch{}d=PE(a,c,v,p),d!==null&&(v=zn(),ur(d,a,p,v),tT(d,c,p))}}function JE(a){var c=a.alternate;return a===Pt||c!==null&&c===Pt}function eT(a,c){gh=og=!0;var d=a.pending;d===null?c.next=c:(c.next=d.next,d.next=c),a.pending=c}function tT(a,c,d){if((d&4194240)!==0){var p=c.lanes;p&=a.pendingLanes,d|=p,c.lanes=d,$u(a,d)}}var cg={readContext:zi,useCallback:An,useContext:An,useEffect:An,useImperativeHandle:An,useInsertionEffect:An,useLayoutEffect:An,useMemo:An,useReducer:An,useRef:An,useState:An,useDebugValue:An,useDeferredValue:An,useTransition:An,useMutableSource:An,useSyncExternalStore:An,useId:An,unstable_isNewReconciler:!1},_M={readContext:zi,useCallback:function(a,c){return Xr().memoizedState=[a,c===void 0?null:c],a},useContext:zi,useEffect:GE,useImperativeHandle:function(a,c,d){return d=d!=null?d.concat([a]):null,ag(4194308,4,HE.bind(null,c,a),d)},useLayoutEffect:function(a,c){return ag(4194308,4,a,c)},useInsertionEffect:function(a,c){return ag(4,2,a,c)},useMemo:function(a,c){var d=Xr();return c=c===void 0?null:c,a=a(),d.memoizedState=[a,c],a},useReducer:function(a,c,d){var p=Xr();return c=d!==void 0?d(c):c,p.memoizedState=p.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},p.queue=a,a=a.dispatch=pM.bind(null,Pt,a),[p.memoizedState,a]},useRef:function(a){var c=Xr();return a={current:a},c.memoizedState=a},useState:BE,useDebugValue:d_,useDeferredValue:function(a){return Xr().memoizedState=a},useTransition:function(){var a=BE(!1),c=a[0];return a=mM.bind(null,a[1]),Xr().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,d){var p=Pt,v=Xr();if(Ct){if(d===void 0)throw Error(t(407));d=d()}else{if(d=c(),on===null)throw Error(t(349));(ba&30)!==0||FE(p,c,d)}v.memoizedState=d;var w={value:d,getSnapshot:c};return v.queue=w,GE(jE.bind(null,p,w,a),[a]),p.flags|=2048,yh(9,VE.bind(null,p,w,d,c),void 0,null),d},useId:function(){var a=Xr(),c=on.identifierPrefix;if(Ct){var d=Cs,p=Is;d=(p&~(1<<32-fi(p)-1)).toString(32)+d,c=":"+c+"R"+d,d=mh++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=gM++,c=":"+c+"r"+d.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},vM={readContext:zi,useCallback:qE,useContext:zi,useEffect:h_,useImperativeHandle:XE,useInsertionEffect:$E,useLayoutEffect:KE,useMemo:YE,useReducer:c_,useRef:WE,useState:function(){return c_(ph)},useDebugValue:d_,useDeferredValue:function(a){var c=Ui();return ZE(c,Yt.memoizedState,a)},useTransition:function(){var a=c_(ph)[0],c=Ui().memoizedState;return[a,c]},useMutableSource:LE,useSyncExternalStore:OE,useId:QE,unstable_isNewReconciler:!1},xM={readContext:zi,useCallback:qE,useContext:zi,useEffect:h_,useImperativeHandle:XE,useInsertionEffect:$E,useLayoutEffect:KE,useMemo:YE,useReducer:u_,useRef:WE,useState:function(){return u_(ph)},useDebugValue:d_,useDeferredValue:function(a){var c=Ui();return Yt===null?c.memoizedState=a:ZE(c,Yt.memoizedState,a)},useTransition:function(){var a=u_(ph)[0],c=Ui().memoizedState;return[a,c]},useMutableSource:LE,useSyncExternalStore:OE,useId:QE,unstable_isNewReconciler:!1};function ar(a,c){if(a&&a.defaultProps){c=ne({},c),a=a.defaultProps;for(var d in a)c[d]===void 0&&(c[d]=a[d]);return c}return c}function f_(a,c,d,p){c=a.memoizedState,d=d(p,c),d=d==null?c:ne({},c,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var ug={isMounted:function(a){return(a=a._reactInternals)?ir(a)===a:!1},enqueueSetState:function(a,c,d){a=a._reactInternals;var p=zn(),v=wo(a),w=As(p,v);w.payload=c,d!=null&&(w.callback=d),c=yo(a,w,v),c!==null&&(ur(c,a,v,p),ng(c,a,v))},enqueueReplaceState:function(a,c,d){a=a._reactInternals;var p=zn(),v=wo(a),w=As(p,v);w.tag=1,w.payload=c,d!=null&&(w.callback=d),c=yo(a,w,v),c!==null&&(ur(c,a,v,p),ng(c,a,v))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var d=zn(),p=wo(a),v=As(d,p);v.tag=2,c!=null&&(v.callback=c),c=yo(a,v,p),c!==null&&(ur(c,a,p,d),ng(c,a,p))}};function nT(a,c,d,p,v,w,P){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(p,w,P):c.prototype&&c.prototype.isPureReactComponent?!ih(d,p)||!ih(v,w):!0}function iT(a,c,d){var p=!1,v=go,w=c.contextType;return typeof w=="object"&&w!==null?w=zi(w):(v=Xn(c)?Sa:Rn.current,p=c.contextTypes,w=(p=p!=null)?oc(a,v):go),c=new c(d,w),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=ug,a.stateNode=c,c._reactInternals=a,p&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=w),c}function rT(a,c,d,p){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,p),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,p),c.state!==a&&ug.enqueueReplaceState(c,c.state,null)}function g_(a,c,d,p){var v=a.stateNode;v.props=d,v.state=a.memoizedState,v.refs={},e_(a);var w=c.contextType;typeof w=="object"&&w!==null?v.context=zi(w):(w=Xn(c)?Sa:Rn.current,v.context=oc(a,w)),v.state=a.memoizedState,w=c.getDerivedStateFromProps,typeof w=="function"&&(f_(a,c,w,d),v.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(c=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),c!==v.state&&ug.enqueueReplaceState(v,v.state,null),ig(a,d,v,p),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function gc(a,c){try{var d="",p=c;do d+=xe(p),p=p.return;while(p);var v=d}catch(w){v=`
Error generating stack: `+w.message+`
`+w.stack}return{value:a,source:c,stack:v,digest:null}}function m_(a,c,d){return{value:a,source:null,stack:d??null,digest:c??null}}function p_(a,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var wM=typeof WeakMap=="function"?WeakMap:Map;function sT(a,c,d){d=As(-1,d),d.tag=3,d.payload={element:null};var p=c.value;return d.callback=function(){yg||(yg=!0,k_=p),p_(a,c)},d}function oT(a,c,d){d=As(-1,d),d.tag=3;var p=a.type.getDerivedStateFromError;if(typeof p=="function"){var v=c.value;d.payload=function(){return p(v)},d.callback=function(){p_(a,c)}}var w=a.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(d.callback=function(){p_(a,c),typeof p!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var P=c.stack;this.componentDidCatch(c.value,{componentStack:P!==null?P:""})}),d}function aT(a,c,d){var p=a.pingCache;if(p===null){p=a.pingCache=new wM;var v=new Set;p.set(c,v)}else v=p.get(c),v===void 0&&(v=new Set,p.set(c,v));v.has(d)||(v.add(d),a=LM.bind(null,a,c,d),c.then(a,a))}function lT(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function cT(a,c,d,p,v){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=As(-1,1),c.tag=2,yo(d,c,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=v,a)}var EM=R.ReactCurrentOwner,qn=!1;function jn(a,c,d,p){c.child=a===null?bE(c,null,d,p):uc(c,a.child,d,p)}function uT(a,c,d,p,v){d=d.render;var w=c.ref;return dc(c,v),p=a_(a,c,d,p,w,v),d=l_(),a!==null&&!qn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,bs(a,c,v)):(Ct&&d&&Gy(c),c.flags|=1,jn(a,c,p,v),c.child)}function hT(a,c,d,p,v){if(a===null){var w=d.type;return typeof w=="function"&&!V_(w)&&w.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=w,dT(a,c,w,p,v)):(a=Tg(d.type,null,p,c,c.mode,v),a.ref=c.ref,a.return=c,c.child=a)}if(w=a.child,(a.lanes&v)===0){var P=w.memoizedProps;if(d=d.compare,d=d!==null?d:ih,d(P,p)&&a.ref===c.ref)return bs(a,c,v)}return c.flags|=1,a=To(w,p),a.ref=c.ref,a.return=c,c.child=a}function dT(a,c,d,p,v){if(a!==null){var w=a.memoizedProps;if(ih(w,p)&&a.ref===c.ref)if(qn=!1,c.pendingProps=p=w,(a.lanes&v)!==0)(a.flags&131072)!==0&&(qn=!0);else return c.lanes=a.lanes,bs(a,c,v)}return y_(a,c,d,p,v)}function fT(a,c,d){var p=c.pendingProps,v=p.children,w=a!==null?a.memoizedState:null;if(p.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(pc,xi),xi|=d;else{if((d&1073741824)===0)return a=w!==null?w.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,vt(pc,xi),xi|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=w!==null?w.baseLanes:d,vt(pc,xi),xi|=p}else w!==null?(p=w.baseLanes|d,c.memoizedState=null):p=d,vt(pc,xi),xi|=p;return jn(a,c,v,d),c.child}function gT(a,c){var d=c.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function y_(a,c,d,p,v){var w=Xn(d)?Sa:Rn.current;return w=oc(c,w),dc(c,v),d=a_(a,c,d,p,w,v),p=l_(),a!==null&&!qn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~v,bs(a,c,v)):(Ct&&p&&Gy(c),c.flags|=1,jn(a,c,d,v),c.child)}function mT(a,c,d,p,v){if(Xn(d)){var w=!0;Xf(c)}else w=!1;if(dc(c,v),c.stateNode===null)dg(a,c),iT(c,d,p),g_(c,d,p,v),p=!0;else if(a===null){var P=c.stateNode,U=c.memoizedProps;P.props=U;var W=P.context,J=d.contextType;typeof J=="object"&&J!==null?J=zi(J):(J=Xn(d)?Sa:Rn.current,J=oc(c,J));var oe=d.getDerivedStateFromProps,ce=typeof oe=="function"||typeof P.getSnapshotBeforeUpdate=="function";ce||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(U!==p||W!==J)&&rT(c,P,p,J),po=!1;var re=c.memoizedState;P.state=re,ig(c,p,P,v),W=c.memoizedState,U!==p||re!==W||Hn.current||po?(typeof oe=="function"&&(f_(c,d,oe,p),W=c.memoizedState),(U=po||nT(c,d,U,p,re,W,J))?(ce||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(c.flags|=4194308)):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=p,c.memoizedState=W),P.props=p,P.state=W,P.context=J,p=U):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),p=!1)}else{P=c.stateNode,kE(a,c),U=c.memoizedProps,J=c.type===c.elementType?U:ar(c.type,U),P.props=J,ce=c.pendingProps,re=P.context,W=d.contextType,typeof W=="object"&&W!==null?W=zi(W):(W=Xn(d)?Sa:Rn.current,W=oc(c,W));var ye=d.getDerivedStateFromProps;(oe=typeof ye=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(U!==ce||re!==W)&&rT(c,P,p,W),po=!1,re=c.memoizedState,P.state=re,ig(c,p,P,v);var ve=c.memoizedState;U!==ce||re!==ve||Hn.current||po?(typeof ye=="function"&&(f_(c,d,ye,p),ve=c.memoizedState),(J=po||nT(c,d,J,p,re,ve,W)||!1)?(oe||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(p,ve,W),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(p,ve,W)),typeof P.componentDidUpdate=="function"&&(c.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof P.componentDidUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=1024),c.memoizedProps=p,c.memoizedState=ve),P.props=p,P.state=ve,P.context=W,p=J):(typeof P.componentDidUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&re===a.memoizedState||(c.flags|=1024),p=!1)}return __(a,c,d,p,w,v)}function __(a,c,d,p,v,w){gT(a,c);var P=(c.flags&128)!==0;if(!p&&!P)return v&&xE(c,d,!1),bs(a,c,w);p=c.stateNode,EM.current=c;var U=P&&typeof d.getDerivedStateFromError!="function"?null:p.render();return c.flags|=1,a!==null&&P?(c.child=uc(c,a.child,null,w),c.child=uc(c,null,U,w)):jn(a,c,U,w),c.memoizedState=p.state,v&&xE(c,d,!0),c.child}function pT(a){var c=a.stateNode;c.pendingContext?_E(a,c.pendingContext,c.pendingContext!==c.context):c.context&&_E(a,c.context,!1),t_(a,c.containerInfo)}function yT(a,c,d,p,v){return cc(),Xy(v),c.flags|=256,jn(a,c,d,p),c.child}var v_={dehydrated:null,treeContext:null,retryLane:0};function x_(a){return{baseLanes:a,cachePool:null,transitions:null}}function _T(a,c,d){var p=c.pendingProps,v=bt.current,w=!1,P=(c.flags&128)!==0,U;if((U=P)||(U=a!==null&&a.memoizedState===null?!1:(v&2)!==0),U?(w=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),vt(bt,v&1),a===null)return Hy(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(P=p.children,a=p.fallback,w?(p=c.mode,w=c.child,P={mode:"hidden",children:P},(p&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=P):w=Sg(P,p,0,null),a=Ma(a,p,d,null),w.return=c,a.return=c,w.sibling=a,c.child=w,c.child.memoizedState=x_(d),c.memoizedState=v_,a):w_(c,P));if(v=a.memoizedState,v!==null&&(U=v.dehydrated,U!==null))return TM(a,c,P,p,U,v,d);if(w){w=p.fallback,P=c.mode,v=a.child,U=v.sibling;var W={mode:"hidden",children:p.children};return(P&1)===0&&c.child!==v?(p=c.child,p.childLanes=0,p.pendingProps=W,c.deletions=null):(p=To(v,W),p.subtreeFlags=v.subtreeFlags&14680064),U!==null?w=To(U,w):(w=Ma(w,P,d,null),w.flags|=2),w.return=c,p.return=c,p.sibling=w,c.child=p,p=w,w=c.child,P=a.child.memoizedState,P=P===null?x_(d):{baseLanes:P.baseLanes|d,cachePool:null,transitions:P.transitions},w.memoizedState=P,w.childLanes=a.childLanes&~d,c.memoizedState=v_,p}return w=a.child,a=w.sibling,p=To(w,{mode:"visible",children:p.children}),(c.mode&1)===0&&(p.lanes=d),p.return=c,p.sibling=null,a!==null&&(d=c.deletions,d===null?(c.deletions=[a],c.flags|=16):d.push(a)),c.child=p,c.memoizedState=null,p}function w_(a,c){return c=Sg({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function hg(a,c,d,p){return p!==null&&Xy(p),uc(c,a.child,null,d),a=w_(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function TM(a,c,d,p,v,w,P){if(d)return c.flags&256?(c.flags&=-257,p=m_(Error(t(422))),hg(a,c,P,p)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(w=p.fallback,v=c.mode,p=Sg({mode:"visible",children:p.children},v,0,null),w=Ma(w,v,P,null),w.flags|=2,p.return=c,w.return=c,p.sibling=w,c.child=p,(c.mode&1)!==0&&uc(c,a.child,null,P),c.child.memoizedState=x_(P),c.memoizedState=v_,w);if((c.mode&1)===0)return hg(a,c,P,null);if(v.data==="$!"){if(p=v.nextSibling&&v.nextSibling.dataset,p)var U=p.dgst;return p=U,w=Error(t(419)),p=m_(w,p,void 0),hg(a,c,P,p)}if(U=(P&a.childLanes)!==0,qn||U){if(p=on,p!==null){switch(P&-P){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(p.suspendedLanes|P))!==0?0:v,v!==0&&v!==w.retryLane&&(w.retryLane=v,Rs(a,v),ur(p,a,v,-1))}return F_(),p=m_(Error(t(421))),hg(a,c,P,p)}return v.data==="$?"?(c.flags|=128,c.child=a.child,c=OM.bind(null,a),v._reactRetry=c,null):(a=w.treeContext,vi=ho(v.nextSibling),_i=c,Ct=!0,or=null,a!==null&&(Vi[ji++]=Is,Vi[ji++]=Cs,Vi[ji++]=Ia,Is=a.id,Cs=a.overflow,Ia=c),c=w_(c,p.children),c.flags|=4096,c)}function vT(a,c,d){a.lanes|=c;var p=a.alternate;p!==null&&(p.lanes|=c),Qy(a.return,c,d)}function E_(a,c,d,p,v){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:v}:(w.isBackwards=c,w.rendering=null,w.renderingStartTime=0,w.last=p,w.tail=d,w.tailMode=v)}function xT(a,c,d){var p=c.pendingProps,v=p.revealOrder,w=p.tail;if(jn(a,c,p.children,d),p=bt.current,(p&2)!==0)p=p&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&vT(a,d,c);else if(a.tag===19)vT(a,d,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}p&=1}if(vt(bt,p),(c.mode&1)===0)c.memoizedState=null;else switch(v){case"forwards":for(d=c.child,v=null;d!==null;)a=d.alternate,a!==null&&rg(a)===null&&(v=d),d=d.sibling;d=v,d===null?(v=c.child,c.child=null):(v=d.sibling,d.sibling=null),E_(c,!1,v,d,w);break;case"backwards":for(d=null,v=c.child,c.child=null;v!==null;){if(a=v.alternate,a!==null&&rg(a)===null){c.child=v;break}a=v.sibling,v.sibling=d,d=v,v=a}E_(c,!0,d,null,w);break;case"together":E_(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function dg(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function bs(a,c,d){if(a!==null&&(c.dependencies=a.dependencies),Pa|=c.lanes,(d&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,d=To(a,a.pendingProps),c.child=d,d.return=c;a.sibling!==null;)a=a.sibling,d=d.sibling=To(a,a.pendingProps),d.return=c;d.sibling=null}return c.child}function SM(a,c,d){switch(c.tag){case 3:pT(c),cc();break;case 5:ME(c);break;case 1:Xn(c.type)&&Xf(c);break;case 4:t_(c,c.stateNode.containerInfo);break;case 10:var p=c.type._context,v=c.memoizedProps.value;vt(eg,p._currentValue),p._currentValue=v;break;case 13:if(p=c.memoizedState,p!==null)return p.dehydrated!==null?(vt(bt,bt.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?_T(a,c,d):(vt(bt,bt.current&1),a=bs(a,c,d),a!==null?a.sibling:null);vt(bt,bt.current&1);break;case 19:if(p=(d&c.childLanes)!==0,(a.flags&128)!==0){if(p)return xT(a,c,d);c.flags|=128}if(v=c.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),vt(bt,bt.current),p)break;return null;case 22:case 23:return c.lanes=0,fT(a,c,d)}return bs(a,c,d)}var wT,T_,ET,TT;wT=function(a,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},T_=function(){},ET=function(a,c,d,p){var v=a.memoizedProps;if(v!==p){a=c.stateNode,Aa(Hr.current);var w=null;switch(d){case"input":v=$n(a,v),p=$n(a,p),w=[];break;case"select":v=ne({},v,{value:void 0}),p=ne({},p,{value:void 0}),w=[];break;case"textarea":v=ki(a,v),p=ki(a,p),w=[];break;default:typeof v.onClick!="function"&&typeof p.onClick=="function"&&(a.onclick=$f)}On(d,p);var P;d=null;for(J in v)if(!p.hasOwnProperty(J)&&v.hasOwnProperty(J)&&v[J]!=null)if(J==="style"){var U=v[J];for(P in U)U.hasOwnProperty(P)&&(d||(d={}),d[P]="")}else J!=="dangerouslySetInnerHTML"&&J!=="children"&&J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(r.hasOwnProperty(J)?w||(w=[]):(w=w||[]).push(J,null));for(J in p){var W=p[J];if(U=v?.[J],p.hasOwnProperty(J)&&W!==U&&(W!=null||U!=null))if(J==="style")if(U){for(P in U)!U.hasOwnProperty(P)||W&&W.hasOwnProperty(P)||(d||(d={}),d[P]="");for(P in W)W.hasOwnProperty(P)&&U[P]!==W[P]&&(d||(d={}),d[P]=W[P])}else d||(w||(w=[]),w.push(J,d)),d=W;else J==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,U=U?U.__html:void 0,W!=null&&U!==W&&(w=w||[]).push(J,W)):J==="children"?typeof W!="string"&&typeof W!="number"||(w=w||[]).push(J,""+W):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&(r.hasOwnProperty(J)?(W!=null&&J==="onScroll"&&wt("scroll",a),w||U===W||(w=[])):(w=w||[]).push(J,W))}d&&(w=w||[]).push("style",d);var J=w;(c.updateQueue=J)&&(c.flags|=4)}},TT=function(a,c,d,p){d!==p&&(c.flags|=4)};function _h(a,c){if(!Ct)switch(a.tailMode){case"hidden":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:p.sibling=null}}function bn(a){var c=a.alternate!==null&&a.alternate.child===a.child,d=0,p=0;if(c)for(var v=a.child;v!==null;)d|=v.lanes|v.childLanes,p|=v.subtreeFlags&14680064,p|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)d|=v.lanes|v.childLanes,p|=v.subtreeFlags,p|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=p,a.childLanes=d,c}function IM(a,c,d){var p=c.pendingProps;switch($y(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(c),null;case 1:return Xn(c.type)&&Hf(),bn(c),null;case 3:return p=c.stateNode,fc(),Et(Hn),Et(Rn),r_(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(a===null||a.child===null)&&(Qf(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,or!==null&&(M_(or),or=null))),T_(a,c),bn(c),null;case 5:n_(c);var v=Aa(fh.current);if(d=c.type,a!==null&&c.stateNode!=null)ET(a,c,d,p,v),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!p){if(c.stateNode===null)throw Error(t(166));return bn(c),null}if(a=Aa(Hr.current),Qf(c)){p=c.stateNode,d=c.type;var w=c.memoizedProps;switch(p[Kr]=c,p[lh]=w,a=(c.mode&1)!==0,d){case"dialog":wt("cancel",p),wt("close",p);break;case"iframe":case"object":case"embed":wt("load",p);break;case"video":case"audio":for(v=0;v<sh.length;v++)wt(sh[v],p);break;case"source":wt("error",p);break;case"img":case"image":case"link":wt("error",p),wt("load",p);break;case"details":wt("toggle",p);break;case"input":hn(p,w),wt("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!w.multiple},wt("invalid",p);break;case"textarea":It(p,w),wt("invalid",p)}On(d,w),v=null;for(var P in w)if(w.hasOwnProperty(P)){var U=w[P];P==="children"?typeof U=="string"?p.textContent!==U&&(w.suppressHydrationWarning!==!0&&Gf(p.textContent,U,a),v=["children",U]):typeof U=="number"&&p.textContent!==""+U&&(w.suppressHydrationWarning!==!0&&Gf(p.textContent,U,a),v=["children",""+U]):r.hasOwnProperty(P)&&U!=null&&P==="onScroll"&&wt("scroll",p)}switch(d){case"input":er(p),Pi(p,w,!0);break;case"textarea":er(p),Ni(p);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(p.onclick=$f)}p=v,c.updateQueue=p,p!==null&&(c.flags|=4)}else{P=v.nodeType===9?v:v.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Ar(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=P.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof p.is=="string"?a=P.createElement(d,{is:p.is}):(a=P.createElement(d),d==="select"&&(P=a,p.multiple?P.multiple=!0:p.size&&(P.size=p.size))):a=P.createElementNS(a,d),a[Kr]=c,a[lh]=p,wT(a,c,!1,!1),c.stateNode=a;e:{switch(P=ms(d,p),d){case"dialog":wt("cancel",a),wt("close",a),v=p;break;case"iframe":case"object":case"embed":wt("load",a),v=p;break;case"video":case"audio":for(v=0;v<sh.length;v++)wt(sh[v],a);v=p;break;case"source":wt("error",a),v=p;break;case"img":case"image":case"link":wt("error",a),wt("load",a),v=p;break;case"details":wt("toggle",a),v=p;break;case"input":hn(a,p),v=$n(a,p),wt("invalid",a);break;case"option":v=p;break;case"select":a._wrapperState={wasMultiple:!!p.multiple},v=ne({},p,{value:void 0}),wt("invalid",a);break;case"textarea":It(a,p),v=ki(a,p),wt("invalid",a);break;default:v=p}On(d,v),U=v;for(w in U)if(U.hasOwnProperty(w)){var W=U[w];w==="style"?gs(a,W):w==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,W!=null&&ua(a,W)):w==="children"?typeof W=="string"?(d!=="textarea"||W!=="")&&Pr(a,W):typeof W=="number"&&Pr(a,""+W):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(r.hasOwnProperty(w)?W!=null&&w==="onScroll"&&wt("scroll",a):W!=null&&N(a,w,W,P))}switch(d){case"input":er(a),Pi(a,p,!1);break;case"textarea":er(a),Ni(a);break;case"option":p.value!=null&&a.setAttribute("value",""+je(p.value));break;case"select":a.multiple=!!p.multiple,w=p.value,w!=null?nn(a,!!p.multiple,w,!1):p.defaultValue!=null&&nn(a,!!p.multiple,p.defaultValue,!0);break;default:typeof v.onClick=="function"&&(a.onclick=$f)}switch(d){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return bn(c),null;case 6:if(a&&c.stateNode!=null)TT(a,c,a.memoizedProps,p);else{if(typeof p!="string"&&c.stateNode===null)throw Error(t(166));if(d=Aa(fh.current),Aa(Hr.current),Qf(c)){if(p=c.stateNode,d=c.memoizedProps,p[Kr]=c,(w=p.nodeValue!==d)&&(a=_i,a!==null))switch(a.tag){case 3:Gf(p.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Gf(p.nodeValue,d,(a.mode&1)!==0)}w&&(c.flags|=4)}else p=(d.nodeType===9?d:d.ownerDocument).createTextNode(p),p[Kr]=c,c.stateNode=p}return bn(c),null;case 13:if(Et(bt),p=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Ct&&vi!==null&&(c.mode&1)!==0&&(c.flags&128)===0)CE(),cc(),c.flags|=98560,w=!1;else if(w=Qf(c),p!==null&&p.dehydrated!==null){if(a===null){if(!w)throw Error(t(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[Kr]=c}else cc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;bn(c),w=!1}else or!==null&&(M_(or),or=null),w=!0;if(!w)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(p=p!==null,p!==(a!==null&&a.memoizedState!==null)&&p&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(bt.current&1)!==0?Zt===0&&(Zt=3):F_())),c.updateQueue!==null&&(c.flags|=4),bn(c),null);case 4:return fc(),T_(a,c),a===null&&oh(c.stateNode.containerInfo),bn(c),null;case 10:return Zy(c.type._context),bn(c),null;case 17:return Xn(c.type)&&Hf(),bn(c),null;case 19:if(Et(bt),w=c.memoizedState,w===null)return bn(c),null;if(p=(c.flags&128)!==0,P=w.rendering,P===null)if(p)_h(w,!1);else{if(Zt!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(P=rg(a),P!==null){for(c.flags|=128,_h(w,!1),p=P.updateQueue,p!==null&&(c.updateQueue=p,c.flags|=4),c.subtreeFlags=0,p=d,d=c.child;d!==null;)w=d,a=p,w.flags&=14680066,P=w.alternate,P===null?(w.childLanes=0,w.lanes=a,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=P.childLanes,w.lanes=P.lanes,w.child=P.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=P.memoizedProps,w.memoizedState=P.memoizedState,w.updateQueue=P.updateQueue,w.type=P.type,a=P.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return vt(bt,bt.current&1|2),c.child}a=a.sibling}w.tail!==null&&xt()>yc&&(c.flags|=128,p=!0,_h(w,!1),c.lanes=4194304)}else{if(!p)if(a=rg(P),a!==null){if(c.flags|=128,p=!0,d=a.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),_h(w,!0),w.tail===null&&w.tailMode==="hidden"&&!P.alternate&&!Ct)return bn(c),null}else 2*xt()-w.renderingStartTime>yc&&d!==1073741824&&(c.flags|=128,p=!0,_h(w,!1),c.lanes=4194304);w.isBackwards?(P.sibling=c.child,c.child=P):(d=w.last,d!==null?d.sibling=P:c.child=P,w.last=P)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=xt(),c.sibling=null,d=bt.current,vt(bt,p?d&1|2:d&1),c):(bn(c),null);case 22:case 23:return O_(),p=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==p&&(c.flags|=8192),p&&(c.mode&1)!==0?(xi&1073741824)!==0&&(bn(c),c.subtreeFlags&6&&(c.flags|=8192)):bn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function CM(a,c){switch($y(c),c.tag){case 1:return Xn(c.type)&&Hf(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return fc(),Et(Hn),Et(Rn),r_(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return n_(c),null;case 13:if(Et(bt),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));cc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return Et(bt),null;case 4:return fc(),null;case 10:return Zy(c.type._context),null;case 22:case 23:return O_(),null;case 24:return null;default:return null}}var fg=!1,Pn=!1,RM=typeof WeakSet=="function"?WeakSet:Set,_e=null;function mc(a,c){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(p){Mt(a,c,p)}else d.current=null}function S_(a,c,d){try{d()}catch(p){Mt(a,c,p)}}var ST=!1;function AM(a,c){if(Oy=xs,a=nE(),Ay(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var v=p.anchorOffset,w=p.focusNode;p=p.focusOffset;try{d.nodeType,w.nodeType}catch{d=null;break e}var P=0,U=-1,W=-1,J=0,oe=0,ce=a,re=null;t:for(;;){for(var ye;ce!==d||v!==0&&ce.nodeType!==3||(U=P+v),ce!==w||p!==0&&ce.nodeType!==3||(W=P+p),ce.nodeType===3&&(P+=ce.nodeValue.length),(ye=ce.firstChild)!==null;)re=ce,ce=ye;for(;;){if(ce===a)break t;if(re===d&&++J===v&&(U=P),re===w&&++oe===p&&(W=P),(ye=ce.nextSibling)!==null)break;ce=re,re=ce.parentNode}ce=ye}d=U===-1||W===-1?null:{start:U,end:W}}else d=null}d=d||{start:0,end:0}}else d=null;for(Fy={focusedElem:a,selectionRange:d},xs=!1,_e=c;_e!==null;)if(c=_e,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,_e=a;else for(;_e!==null;){c=_e;try{var ve=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var we=ve.memoizedProps,zt=ve.memoizedState,H=c.stateNode,K=H.getSnapshotBeforeUpdate(c.elementType===c.type?we:ar(c.type,we),zt);H.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var Y=c.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Mt(c,c.return,he)}if(a=c.sibling,a!==null){a.return=c.return,_e=a;break}_e=c.return}return ve=ST,ST=!1,ve}function vh(a,c,d){var p=c.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var v=p=p.next;do{if((v.tag&a)===a){var w=v.destroy;v.destroy=void 0,w!==void 0&&S_(c,d,w)}v=v.next}while(v!==p)}}function gg(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&a)===a){var p=d.create;d.destroy=p()}d=d.next}while(d!==c)}}function I_(a){var c=a.ref;if(c!==null){var d=a.stateNode;a.tag,a=d,typeof c=="function"?c(a):c.current=a}}function IT(a){var c=a.alternate;c!==null&&(a.alternate=null,IT(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[Kr],delete c[lh],delete c[Uy],delete c[uM],delete c[hM])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function CT(a){return a.tag===5||a.tag===3||a.tag===4}function RT(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||CT(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function C_(a,c,d){var p=a.tag;if(p===5||p===6)a=a.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(a,c):d.insertBefore(a,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(a,d)):(c=d,c.appendChild(a)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=$f));else if(p!==4&&(a=a.child,a!==null))for(C_(a,c,d),a=a.sibling;a!==null;)C_(a,c,d),a=a.sibling}function R_(a,c,d){var p=a.tag;if(p===5||p===6)a=a.stateNode,c?d.insertBefore(a,c):d.appendChild(a);else if(p!==4&&(a=a.child,a!==null))for(R_(a,c,d),a=a.sibling;a!==null;)R_(a,c,d),a=a.sibling}var _n=null,lr=!1;function _o(a,c,d){for(d=d.child;d!==null;)AT(a,c,d),d=d.sibling}function AT(a,c,d){if(di&&typeof di.onCommitFiberUnmount=="function")try{di.onCommitFiberUnmount(ga,d)}catch{}switch(d.tag){case 5:Pn||mc(d,c);case 6:var p=_n,v=lr;_n=null,_o(a,c,d),_n=p,lr=v,_n!==null&&(lr?(a=_n,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):_n.removeChild(d.stateNode));break;case 18:_n!==null&&(lr?(a=_n,d=d.stateNode,a.nodeType===8?zy(a.parentNode,d):a.nodeType===1&&zy(a,d),ao(a)):zy(_n,d.stateNode));break;case 4:p=_n,v=lr,_n=d.stateNode.containerInfo,lr=!0,_o(a,c,d),_n=p,lr=v;break;case 0:case 11:case 14:case 15:if(!Pn&&(p=d.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){v=p=p.next;do{var w=v,P=w.destroy;w=w.tag,P!==void 0&&((w&2)!==0||(w&4)!==0)&&S_(d,c,P),v=v.next}while(v!==p)}_o(a,c,d);break;case 1:if(!Pn&&(mc(d,c),p=d.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=d.memoizedProps,p.state=d.memoizedState,p.componentWillUnmount()}catch(U){Mt(d,c,U)}_o(a,c,d);break;case 21:_o(a,c,d);break;case 22:d.mode&1?(Pn=(p=Pn)||d.memoizedState!==null,_o(a,c,d),Pn=p):_o(a,c,d);break;default:_o(a,c,d)}}function bT(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new RM),c.forEach(function(p){var v=FM.bind(null,a,p);d.has(p)||(d.add(p),p.then(v,v))})}}function cr(a,c){var d=c.deletions;if(d!==null)for(var p=0;p<d.length;p++){var v=d[p];try{var w=a,P=c,U=P;e:for(;U!==null;){switch(U.tag){case 5:_n=U.stateNode,lr=!1;break e;case 3:_n=U.stateNode.containerInfo,lr=!0;break e;case 4:_n=U.stateNode.containerInfo,lr=!0;break e}U=U.return}if(_n===null)throw Error(t(160));AT(w,P,v),_n=null,lr=!1;var W=v.alternate;W!==null&&(W.return=null),v.return=null}catch(J){Mt(v,c,J)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)PT(c,a),c=c.sibling}function PT(a,c){var d=a.alternate,p=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(cr(c,a),qr(a),p&4){try{vh(3,a,a.return),gg(3,a)}catch(we){Mt(a,a.return,we)}try{vh(5,a,a.return)}catch(we){Mt(a,a.return,we)}}break;case 1:cr(c,a),qr(a),p&512&&d!==null&&mc(d,d.return);break;case 5:if(cr(c,a),qr(a),p&512&&d!==null&&mc(d,d.return),a.flags&32){var v=a.stateNode;try{Pr(v,"")}catch(we){Mt(a,a.return,we)}}if(p&4&&(v=a.stateNode,v!=null)){var w=a.memoizedProps,P=d!==null?d.memoizedProps:w,U=a.type,W=a.updateQueue;if(a.updateQueue=null,W!==null)try{U==="input"&&w.type==="radio"&&w.name!=null&&dn(v,w),ms(U,P);var J=ms(U,w);for(P=0;P<W.length;P+=2){var oe=W[P],ce=W[P+1];oe==="style"?gs(v,ce):oe==="dangerouslySetInnerHTML"?ua(v,ce):oe==="children"?Pr(v,ce):N(v,oe,ce,J)}switch(U){case"input":Kn(v,w);break;case"textarea":to(v,w);break;case"select":var re=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!w.multiple;var ye=w.value;ye!=null?nn(v,!!w.multiple,ye,!1):re!==!!w.multiple&&(w.defaultValue!=null?nn(v,!!w.multiple,w.defaultValue,!0):nn(v,!!w.multiple,w.multiple?[]:"",!1))}v[lh]=w}catch(we){Mt(a,a.return,we)}}break;case 6:if(cr(c,a),qr(a),p&4){if(a.stateNode===null)throw Error(t(162));v=a.stateNode,w=a.memoizedProps;try{v.nodeValue=w}catch(we){Mt(a,a.return,we)}}break;case 3:if(cr(c,a),qr(a),p&4&&d!==null&&d.memoizedState.isDehydrated)try{ao(c.containerInfo)}catch(we){Mt(a,a.return,we)}break;case 4:cr(c,a),qr(a);break;case 13:cr(c,a),qr(a),v=a.child,v.flags&8192&&(w=v.memoizedState!==null,v.stateNode.isHidden=w,!w||v.alternate!==null&&v.alternate.memoizedState!==null||(P_=xt())),p&4&&bT(a);break;case 22:if(oe=d!==null&&d.memoizedState!==null,a.mode&1?(Pn=(J=Pn)||oe,cr(c,a),Pn=J):cr(c,a),qr(a),p&8192){if(J=a.memoizedState!==null,(a.stateNode.isHidden=J)&&!oe&&(a.mode&1)!==0)for(_e=a,oe=a.child;oe!==null;){for(ce=_e=oe;_e!==null;){switch(re=_e,ye=re.child,re.tag){case 0:case 11:case 14:case 15:vh(4,re,re.return);break;case 1:mc(re,re.return);var ve=re.stateNode;if(typeof ve.componentWillUnmount=="function"){p=re,d=re.return;try{c=p,ve.props=c.memoizedProps,ve.state=c.memoizedState,ve.componentWillUnmount()}catch(we){Mt(p,d,we)}}break;case 5:mc(re,re.return);break;case 22:if(re.memoizedState!==null){DT(ce);continue}}ye!==null?(ye.return=re,_e=ye):DT(ce)}oe=oe.sibling}e:for(oe=null,ce=a;;){if(ce.tag===5){if(oe===null){oe=ce;try{v=ce.stateNode,J?(w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(U=ce.stateNode,W=ce.memoizedProps.style,P=W!=null&&W.hasOwnProperty("display")?W.display:null,U.style.display=kr("display",P))}catch(we){Mt(a,a.return,we)}}}else if(ce.tag===6){if(oe===null)try{ce.stateNode.nodeValue=J?"":ce.memoizedProps}catch(we){Mt(a,a.return,we)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===a)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===a)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===a)break e;oe===ce&&(oe=null),ce=ce.return}oe===ce&&(oe=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:cr(c,a),qr(a),p&4&&bT(a);break;case 21:break;default:cr(c,a),qr(a)}}function qr(a){var c=a.flags;if(c&2){try{e:{for(var d=a.return;d!==null;){if(CT(d)){var p=d;break e}d=d.return}throw Error(t(160))}switch(p.tag){case 5:var v=p.stateNode;p.flags&32&&(Pr(v,""),p.flags&=-33);var w=RT(a);R_(a,w,v);break;case 3:case 4:var P=p.stateNode.containerInfo,U=RT(a);C_(a,U,P);break;default:throw Error(t(161))}}catch(W){Mt(a,a.return,W)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function bM(a,c,d){_e=a,kT(a)}function kT(a,c,d){for(var p=(a.mode&1)!==0;_e!==null;){var v=_e,w=v.child;if(v.tag===22&&p){var P=v.memoizedState!==null||fg;if(!P){var U=v.alternate,W=U!==null&&U.memoizedState!==null||Pn;U=fg;var J=Pn;if(fg=P,(Pn=W)&&!J)for(_e=v;_e!==null;)P=_e,W=P.child,P.tag===22&&P.memoizedState!==null?MT(v):W!==null?(W.return=P,_e=W):MT(v);for(;w!==null;)_e=w,kT(w),w=w.sibling;_e=v,fg=U,Pn=J}NT(a)}else(v.subtreeFlags&8772)!==0&&w!==null?(w.return=v,_e=w):NT(a)}}function NT(a){for(;_e!==null;){var c=_e;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Pn||gg(5,c);break;case 1:var p=c.stateNode;if(c.flags&4&&!Pn)if(d===null)p.componentDidMount();else{var v=c.elementType===c.type?d.memoizedProps:ar(c.type,d.memoizedProps);p.componentDidUpdate(v,d.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var w=c.updateQueue;w!==null&&DE(c,w,p);break;case 3:var P=c.updateQueue;if(P!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}DE(c,P,d)}break;case 5:var U=c.stateNode;if(d===null&&c.flags&4){d=U;var W=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":W.autoFocus&&d.focus();break;case"img":W.src&&(d.src=W.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var J=c.alternate;if(J!==null){var oe=J.memoizedState;if(oe!==null){var ce=oe.dehydrated;ce!==null&&ao(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Pn||c.flags&512&&I_(c)}catch(re){Mt(c,c.return,re)}}if(c===a){_e=null;break}if(d=c.sibling,d!==null){d.return=c.return,_e=d;break}_e=c.return}}function DT(a){for(;_e!==null;){var c=_e;if(c===a){_e=null;break}var d=c.sibling;if(d!==null){d.return=c.return,_e=d;break}_e=c.return}}function MT(a){for(;_e!==null;){var c=_e;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{gg(4,c)}catch(W){Mt(c,d,W)}break;case 1:var p=c.stateNode;if(typeof p.componentDidMount=="function"){var v=c.return;try{p.componentDidMount()}catch(W){Mt(c,v,W)}}var w=c.return;try{I_(c)}catch(W){Mt(c,w,W)}break;case 5:var P=c.return;try{I_(c)}catch(W){Mt(c,P,W)}}}catch(W){Mt(c,c.return,W)}if(c===a){_e=null;break}var U=c.sibling;if(U!==null){U.return=c.return,_e=U;break}_e=c.return}}var PM=Math.ceil,mg=R.ReactCurrentDispatcher,A_=R.ReactCurrentOwner,Bi=R.ReactCurrentBatchConfig,Je=0,on=null,$t=null,vn=0,xi=0,pc=fo(0),Zt=0,xh=null,Pa=0,pg=0,b_=0,wh=null,Yn=null,P_=0,yc=1/0,Ps=null,yg=!1,k_=null,vo=null,_g=!1,xo=null,vg=0,Eh=0,N_=null,xg=-1,wg=0;function zn(){return(Je&6)!==0?xt():xg!==-1?xg:xg=xt()}function wo(a){return(a.mode&1)===0?1:(Je&2)!==0&&vn!==0?vn&-vn:fM.transition!==null?(wg===0&&(wg=Wu()),wg):(a=Xe,a!==0||(a=window.event,a=a===void 0?16:Kl(a.type)),a)}function ur(a,c,d,p){if(50<Eh)throw Eh=0,N_=null,Error(t(185));_a(a,d,p),((Je&2)===0||a!==on)&&(a===on&&((Je&2)===0&&(pg|=d),Zt===4&&Eo(a,vn)),Zn(a,p),d===1&&Je===0&&(c.mode&1)===0&&(yc=xt()+500,qf&&mo()))}function Zn(a,c){var d=a.callbackNode;ya(a,c);var p=ys(a,a===on?vn:0);if(p===0)d!==null&&jl(d),a.callbackNode=null,a.callbackPriority=0;else if(c=p&-p,a.callbackPriority!==c){if(d!=null&&jl(d),c===1)a.tag===0?dM(OT.bind(null,a)):wE(OT.bind(null,a)),lM(function(){(Je&6)===0&&mo()}),d=null;else{switch(Or(p)){case 1:d=zl;break;case 4:d=zu;break;case 16:d=fa;break;case 536870912:d=Ul;break;default:d=fa}d=GT(d,LT.bind(null,a))}a.callbackPriority=c,a.callbackNode=d}}function LT(a,c){if(xg=-1,wg=0,(Je&6)!==0)throw Error(t(327));var d=a.callbackNode;if(_c()&&a.callbackNode!==d)return null;var p=ys(a,a===on?vn:0);if(p===0)return null;if((p&30)!==0||(p&a.expiredLanes)!==0||c)c=Eg(a,p);else{c=p;var v=Je;Je|=2;var w=VT();(on!==a||vn!==c)&&(Ps=null,yc=xt()+500,Na(a,c));do try{DM();break}catch(U){FT(a,U)}while(!0);Yy(),mg.current=w,Je=v,$t!==null?c=0:(on=null,vn=0,c=Zt)}if(c!==0){if(c===2&&(v=Bu(a),v!==0&&(p=v,c=D_(a,v))),c===1)throw d=xh,Na(a,0),Eo(a,p),Zn(a,xt()),d;if(c===6)Eo(a,p);else{if(v=a.current.alternate,(p&30)===0&&!kM(v)&&(c=Eg(a,p),c===2&&(w=Bu(a),w!==0&&(p=w,c=D_(a,w))),c===1))throw d=xh,Na(a,0),Eo(a,p),Zn(a,xt()),d;switch(a.finishedWork=v,a.finishedLanes=p,c){case 0:case 1:throw Error(t(345));case 2:Da(a,Yn,Ps);break;case 3:if(Eo(a,p),(p&130023424)===p&&(c=P_+500-xt(),10<c)){if(ys(a,0)!==0)break;if(v=a.suspendedLanes,(v&p)!==p){zn(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=jy(Da.bind(null,a,Yn,Ps),c);break}Da(a,Yn,Ps);break;case 4:if(Eo(a,p),(p&4194240)===p)break;for(c=a.eventTimes,v=-1;0<p;){var P=31-fi(p);w=1<<P,P=c[P],P>v&&(v=P),p&=~w}if(p=v,p=xt()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*PM(p/1960))-p,10<p){a.timeoutHandle=jy(Da.bind(null,a,Yn,Ps),p);break}Da(a,Yn,Ps);break;case 5:Da(a,Yn,Ps);break;default:throw Error(t(329))}}}return Zn(a,xt()),a.callbackNode===d?LT.bind(null,a):null}function D_(a,c){var d=wh;return a.current.memoizedState.isDehydrated&&(Na(a,c).flags|=256),a=Eg(a,c),a!==2&&(c=Yn,Yn=d,c!==null&&M_(c)),a}function M_(a){Yn===null?Yn=a:Yn.push.apply(Yn,a)}function kM(a){for(var c=a;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var p=0;p<d.length;p++){var v=d[p],w=v.getSnapshot;v=v.value;try{if(!sr(w(),v))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Eo(a,c){for(c&=~b_,c&=~pg,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var d=31-fi(c),p=1<<d;a[d]=-1,c&=~p}}function OT(a){if((Je&6)!==0)throw Error(t(327));_c();var c=ys(a,0);if((c&1)===0)return Zn(a,xt()),null;var d=Eg(a,c);if(a.tag!==0&&d===2){var p=Bu(a);p!==0&&(c=p,d=D_(a,p))}if(d===1)throw d=xh,Na(a,0),Eo(a,c),Zn(a,xt()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,Da(a,Yn,Ps),Zn(a,xt()),null}function L_(a,c){var d=Je;Je|=1;try{return a(c)}finally{Je=d,Je===0&&(yc=xt()+500,qf&&mo())}}function ka(a){xo!==null&&xo.tag===0&&(Je&6)===0&&_c();var c=Je;Je|=1;var d=Bi.transition,p=Xe;try{if(Bi.transition=null,Xe=1,a)return a()}finally{Xe=p,Bi.transition=d,Je=c,(Je&6)===0&&mo()}}function O_(){xi=pc.current,Et(pc)}function Na(a,c){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,aM(d)),$t!==null)for(d=$t.return;d!==null;){var p=d;switch($y(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&Hf();break;case 3:fc(),Et(Hn),Et(Rn),r_();break;case 5:n_(p);break;case 4:fc();break;case 13:Et(bt);break;case 19:Et(bt);break;case 10:Zy(p.type._context);break;case 22:case 23:O_()}d=d.return}if(on=a,$t=a=To(a.current,null),vn=xi=c,Zt=0,xh=null,b_=pg=Pa=0,Yn=wh=null,Ra!==null){for(c=0;c<Ra.length;c++)if(d=Ra[c],p=d.interleaved,p!==null){d.interleaved=null;var v=p.next,w=d.pending;if(w!==null){var P=w.next;w.next=v,p.next=P}d.pending=p}Ra=null}return a}function FT(a,c){do{var d=$t;try{if(Yy(),sg.current=cg,og){for(var p=Pt.memoizedState;p!==null;){var v=p.queue;v!==null&&(v.pending=null),p=p.next}og=!1}if(ba=0,sn=Yt=Pt=null,gh=!1,mh=0,A_.current=null,d===null||d.return===null){Zt=1,xh=c,$t=null;break}e:{var w=a,P=d.return,U=d,W=c;if(c=vn,U.flags|=32768,W!==null&&typeof W=="object"&&typeof W.then=="function"){var J=W,oe=U,ce=oe.tag;if((oe.mode&1)===0&&(ce===0||ce===11||ce===15)){var re=oe.alternate;re?(oe.updateQueue=re.updateQueue,oe.memoizedState=re.memoizedState,oe.lanes=re.lanes):(oe.updateQueue=null,oe.memoizedState=null)}var ye=lT(P);if(ye!==null){ye.flags&=-257,cT(ye,P,U,w,c),ye.mode&1&&aT(w,J,c),c=ye,W=J;var ve=c.updateQueue;if(ve===null){var we=new Set;we.add(W),c.updateQueue=we}else ve.add(W);break e}else{if((c&1)===0){aT(w,J,c),F_();break e}W=Error(t(426))}}else if(Ct&&U.mode&1){var zt=lT(P);if(zt!==null){(zt.flags&65536)===0&&(zt.flags|=256),cT(zt,P,U,w,c),Xy(gc(W,U));break e}}w=W=gc(W,U),Zt!==4&&(Zt=2),wh===null?wh=[w]:wh.push(w),w=P;do{switch(w.tag){case 3:w.flags|=65536,c&=-c,w.lanes|=c;var H=sT(w,W,c);NE(w,H);break e;case 1:U=W;var K=w.type,Y=w.stateNode;if((w.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(vo===null||!vo.has(Y)))){w.flags|=65536,c&=-c,w.lanes|=c;var he=oT(w,U,c);NE(w,he);break e}}w=w.return}while(w!==null)}zT(d)}catch(Te){c=Te,$t===d&&d!==null&&($t=d=d.return);continue}break}while(!0)}function VT(){var a=mg.current;return mg.current=cg,a===null?cg:a}function F_(){(Zt===0||Zt===3||Zt===2)&&(Zt=4),on===null||(Pa&268435455)===0&&(pg&268435455)===0||Eo(on,vn)}function Eg(a,c){var d=Je;Je|=2;var p=VT();(on!==a||vn!==c)&&(Ps=null,Na(a,c));do try{NM();break}catch(v){FT(a,v)}while(!0);if(Yy(),Je=d,mg.current=p,$t!==null)throw Error(t(261));return on=null,vn=0,Zt}function NM(){for(;$t!==null;)jT($t)}function DM(){for(;$t!==null&&!da();)jT($t)}function jT(a){var c=WT(a.alternate,a,xi);a.memoizedProps=a.pendingProps,c===null?zT(a):$t=c,A_.current=null}function zT(a){var c=a;do{var d=c.alternate;if(a=c.return,(c.flags&32768)===0){if(d=IM(d,c,xi),d!==null){$t=d;return}}else{if(d=CM(d,c),d!==null){d.flags&=32767,$t=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Zt=6,$t=null;return}}if(c=c.sibling,c!==null){$t=c;return}$t=c=a}while(c!==null);Zt===0&&(Zt=5)}function Da(a,c,d){var p=Xe,v=Bi.transition;try{Bi.transition=null,Xe=1,MM(a,c,d,p)}finally{Bi.transition=v,Xe=p}return null}function MM(a,c,d,p){do _c();while(xo!==null);if((Je&6)!==0)throw Error(t(327));d=a.finishedWork;var v=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var w=d.lanes|d.childLanes;if(Ty(a,w),a===on&&($t=on=null,vn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||_g||(_g=!0,GT(fa,function(){return _c(),null})),w=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||w){w=Bi.transition,Bi.transition=null;var P=Xe;Xe=1;var U=Je;Je|=4,A_.current=null,AM(a,d),PT(d,a),eM(Fy),xs=!!Oy,Fy=Oy=null,a.current=d,bM(d),ps(),Je=U,Xe=P,Bi.transition=w}else a.current=d;if(_g&&(_g=!1,xo=a,vg=v),w=a.pendingLanes,w===0&&(vo=null),bf(d.stateNode),Zn(a,xt()),c!==null)for(p=a.onRecoverableError,d=0;d<c.length;d++)v=c[d],p(v.value,{componentStack:v.stack,digest:v.digest});if(yg)throw yg=!1,a=k_,k_=null,a;return(vg&1)!==0&&a.tag!==0&&_c(),w=a.pendingLanes,(w&1)!==0?a===N_?Eh++:(Eh=0,N_=a):Eh=0,mo(),null}function _c(){if(xo!==null){var a=Or(vg),c=Bi.transition,d=Xe;try{if(Bi.transition=null,Xe=16>a?16:a,xo===null)var p=!1;else{if(a=xo,xo=null,vg=0,(Je&6)!==0)throw Error(t(331));var v=Je;for(Je|=4,_e=a.current;_e!==null;){var w=_e,P=w.child;if((_e.flags&16)!==0){var U=w.deletions;if(U!==null){for(var W=0;W<U.length;W++){var J=U[W];for(_e=J;_e!==null;){var oe=_e;switch(oe.tag){case 0:case 11:case 15:vh(8,oe,w)}var ce=oe.child;if(ce!==null)ce.return=oe,_e=ce;else for(;_e!==null;){oe=_e;var re=oe.sibling,ye=oe.return;if(IT(oe),oe===J){_e=null;break}if(re!==null){re.return=ye,_e=re;break}_e=ye}}}var ve=w.alternate;if(ve!==null){var we=ve.child;if(we!==null){ve.child=null;do{var zt=we.sibling;we.sibling=null,we=zt}while(we!==null)}}_e=w}}if((w.subtreeFlags&2064)!==0&&P!==null)P.return=w,_e=P;else e:for(;_e!==null;){if(w=_e,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:vh(9,w,w.return)}var H=w.sibling;if(H!==null){H.return=w.return,_e=H;break e}_e=w.return}}var K=a.current;for(_e=K;_e!==null;){P=_e;var Y=P.child;if((P.subtreeFlags&2064)!==0&&Y!==null)Y.return=P,_e=Y;else e:for(P=K;_e!==null;){if(U=_e,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:gg(9,U)}}catch(Te){Mt(U,U.return,Te)}if(U===P){_e=null;break e}var he=U.sibling;if(he!==null){he.return=U.return,_e=he;break e}_e=U.return}}if(Je=v,mo(),di&&typeof di.onPostCommitFiberRoot=="function")try{di.onPostCommitFiberRoot(ga,a)}catch{}p=!0}return p}finally{Xe=d,Bi.transition=c}}return!1}function UT(a,c,d){c=gc(d,c),c=sT(a,c,1),a=yo(a,c,1),c=zn(),a!==null&&(_a(a,1,c),Zn(a,c))}function Mt(a,c,d){if(a.tag===3)UT(a,a,d);else for(;c!==null;){if(c.tag===3){UT(c,a,d);break}else if(c.tag===1){var p=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(vo===null||!vo.has(p))){a=gc(d,a),a=oT(c,a,1),c=yo(c,a,1),a=zn(),c!==null&&(_a(c,1,a),Zn(c,a));break}}c=c.return}}function LM(a,c,d){var p=a.pingCache;p!==null&&p.delete(c),c=zn(),a.pingedLanes|=a.suspendedLanes&d,on===a&&(vn&d)===d&&(Zt===4||Zt===3&&(vn&130023424)===vn&&500>xt()-P_?Na(a,0):b_|=d),Zn(a,c)}function BT(a,c){c===0&&((a.mode&1)===0?c=1:(c=ro,ro<<=1,(ro&130023424)===0&&(ro=4194304)));var d=zn();a=Rs(a,c),a!==null&&(_a(a,c,d),Zn(a,d))}function OM(a){var c=a.memoizedState,d=0;c!==null&&(d=c.retryLane),BT(a,d)}function FM(a,c){var d=0;switch(a.tag){case 13:var p=a.stateNode,v=a.memoizedState;v!==null&&(d=v.retryLane);break;case 19:p=a.stateNode;break;default:throw Error(t(314))}p!==null&&p.delete(c),BT(a,d)}var WT;WT=function(a,c,d){if(a!==null)if(a.memoizedProps!==c.pendingProps||Hn.current)qn=!0;else{if((a.lanes&d)===0&&(c.flags&128)===0)return qn=!1,SM(a,c,d);qn=(a.flags&131072)!==0}else qn=!1,Ct&&(c.flags&1048576)!==0&&EE(c,Zf,c.index);switch(c.lanes=0,c.tag){case 2:var p=c.type;dg(a,c),a=c.pendingProps;var v=oc(c,Rn.current);dc(c,d),v=a_(null,c,p,a,v,d);var w=l_();return c.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Xn(p)?(w=!0,Xf(c)):w=!1,c.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,e_(c),v.updater=ug,c.stateNode=v,v._reactInternals=c,g_(c,p,a,d),c=__(null,c,p,!0,w,d)):(c.tag=0,Ct&&w&&Gy(c),jn(null,c,v,d),c=c.child),c;case 16:p=c.elementType;e:{switch(dg(a,c),a=c.pendingProps,v=p._init,p=v(p._payload),c.type=p,v=c.tag=jM(p),a=ar(p,a),v){case 0:c=y_(null,c,p,a,d);break e;case 1:c=mT(null,c,p,a,d);break e;case 11:c=uT(null,c,p,a,d);break e;case 14:c=hT(null,c,p,ar(p.type,a),d);break e}throw Error(t(306,p,""))}return c;case 0:return p=c.type,v=c.pendingProps,v=c.elementType===p?v:ar(p,v),y_(a,c,p,v,d);case 1:return p=c.type,v=c.pendingProps,v=c.elementType===p?v:ar(p,v),mT(a,c,p,v,d);case 3:e:{if(pT(c),a===null)throw Error(t(387));p=c.pendingProps,w=c.memoizedState,v=w.element,kE(a,c),ig(c,p,null,d);var P=c.memoizedState;if(p=P.element,w.isDehydrated)if(w={element:p,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},c.updateQueue.baseState=w,c.memoizedState=w,c.flags&256){v=gc(Error(t(423)),c),c=yT(a,c,p,d,v);break e}else if(p!==v){v=gc(Error(t(424)),c),c=yT(a,c,p,d,v);break e}else for(vi=ho(c.stateNode.containerInfo.firstChild),_i=c,Ct=!0,or=null,d=bE(c,null,p,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(cc(),p===v){c=bs(a,c,d);break e}jn(a,c,p,d)}c=c.child}return c;case 5:return ME(c),a===null&&Hy(c),p=c.type,v=c.pendingProps,w=a!==null?a.memoizedProps:null,P=v.children,Vy(p,v)?P=null:w!==null&&Vy(p,w)&&(c.flags|=32),gT(a,c),jn(a,c,P,d),c.child;case 6:return a===null&&Hy(c),null;case 13:return _T(a,c,d);case 4:return t_(c,c.stateNode.containerInfo),p=c.pendingProps,a===null?c.child=uc(c,null,p,d):jn(a,c,p,d),c.child;case 11:return p=c.type,v=c.pendingProps,v=c.elementType===p?v:ar(p,v),uT(a,c,p,v,d);case 7:return jn(a,c,c.pendingProps,d),c.child;case 8:return jn(a,c,c.pendingProps.children,d),c.child;case 12:return jn(a,c,c.pendingProps.children,d),c.child;case 10:e:{if(p=c.type._context,v=c.pendingProps,w=c.memoizedProps,P=v.value,vt(eg,p._currentValue),p._currentValue=P,w!==null)if(sr(w.value,P)){if(w.children===v.children&&!Hn.current){c=bs(a,c,d);break e}}else for(w=c.child,w!==null&&(w.return=c);w!==null;){var U=w.dependencies;if(U!==null){P=w.child;for(var W=U.firstContext;W!==null;){if(W.context===p){if(w.tag===1){W=As(-1,d&-d),W.tag=2;var J=w.updateQueue;if(J!==null){J=J.shared;var oe=J.pending;oe===null?W.next=W:(W.next=oe.next,oe.next=W),J.pending=W}}w.lanes|=d,W=w.alternate,W!==null&&(W.lanes|=d),Qy(w.return,d,c),U.lanes|=d;break}W=W.next}}else if(w.tag===10)P=w.type===c.type?null:w.child;else if(w.tag===18){if(P=w.return,P===null)throw Error(t(341));P.lanes|=d,U=P.alternate,U!==null&&(U.lanes|=d),Qy(P,d,c),P=w.sibling}else P=w.child;if(P!==null)P.return=w;else for(P=w;P!==null;){if(P===c){P=null;break}if(w=P.sibling,w!==null){w.return=P.return,P=w;break}P=P.return}w=P}jn(a,c,v.children,d),c=c.child}return c;case 9:return v=c.type,p=c.pendingProps.children,dc(c,d),v=zi(v),p=p(v),c.flags|=1,jn(a,c,p,d),c.child;case 14:return p=c.type,v=ar(p,c.pendingProps),v=ar(p.type,v),hT(a,c,p,v,d);case 15:return dT(a,c,c.type,c.pendingProps,d);case 17:return p=c.type,v=c.pendingProps,v=c.elementType===p?v:ar(p,v),dg(a,c),c.tag=1,Xn(p)?(a=!0,Xf(c)):a=!1,dc(c,d),iT(c,p,v),g_(c,p,v,d),__(null,c,p,!0,a,d);case 19:return xT(a,c,d);case 22:return fT(a,c,d)}throw Error(t(156,c.tag))};function GT(a,c){return ju(a,c)}function VM(a,c,d,p){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wi(a,c,d,p){return new VM(a,c,d,p)}function V_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function jM(a){if(typeof a=="function")return V_(a)?1:0;if(a!=null){if(a=a.$$typeof,a===B)return 11;if(a===me)return 14}return 2}function To(a,c){var d=a.alternate;return d===null?(d=Wi(a.tag,c,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=c,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,c=a.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function Tg(a,c,d,p,v,w){var P=2;if(p=a,typeof a=="function")V_(a)&&(P=1);else if(typeof a=="string")P=5;else e:switch(a){case k:return Ma(d.children,v,w,c);case b:P=8,v|=8;break;case M:return a=Wi(12,d,c,v|2),a.elementType=M,a.lanes=w,a;case O:return a=Wi(13,d,c,v),a.elementType=O,a.lanes=w,a;case le:return a=Wi(19,d,c,v),a.elementType=le,a.lanes=w,a;case ue:return Sg(d,v,w,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case V:P=10;break e;case z:P=9;break e;case B:P=11;break e;case me:P=14;break e;case ge:P=16,p=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=Wi(P,d,c,v),c.elementType=a,c.type=p,c.lanes=w,c}function Ma(a,c,d,p){return a=Wi(7,a,p,c),a.lanes=d,a}function Sg(a,c,d,p){return a=Wi(22,a,p,c),a.elementType=ue,a.lanes=d,a.stateNode={isHidden:!1},a}function j_(a,c,d){return a=Wi(6,a,null,c),a.lanes=d,a}function z_(a,c,d){return c=Wi(4,a.children!==null?a.children:[],a.key,c),c.lanes=d,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function zM(a,c,d,p,v){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gu(0),this.expirationTimes=Gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gu(0),this.identifierPrefix=p,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function U_(a,c,d,p,v,w,P,U,W){return a=new zM(a,c,d,U,W),c===1?(c=1,w===!0&&(c|=8)):c=0,w=Wi(3,null,null,c),a.current=w,w.stateNode=a,w.memoizedState={element:p,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},e_(w),a}function UM(a,c,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j,key:p==null?null:""+p,children:a,containerInfo:c,implementation:d}}function $T(a){if(!a)return go;a=a._reactInternals;e:{if(ir(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Xn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(Xn(d))return vE(a,d,c)}return c}function KT(a,c,d,p,v,w,P,U,W){return a=U_(d,p,!0,a,v,w,P,U,W),a.context=$T(null),d=a.current,p=zn(),v=wo(d),w=As(p,v),w.callback=c??null,yo(d,w,v),a.current.lanes=v,_a(a,v,p),Zn(a,p),a}function Ig(a,c,d,p){var v=c.current,w=zn(),P=wo(v);return d=$T(d),c.context===null?c.context=d:c.pendingContext=d,c=As(w,P),c.payload={element:a},p=p===void 0?null:p,p!==null&&(c.callback=p),a=yo(v,c,P),a!==null&&(ur(a,v,P,w),ng(a,v,P)),P}function Cg(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function HT(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<c?d:c}}function B_(a,c){HT(a,c),(a=a.alternate)&&HT(a,c)}function BM(){return null}var XT=typeof reportError=="function"?reportError:function(a){console.error(a)};function W_(a){this._internalRoot=a}Rg.prototype.render=W_.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));Ig(a,c,null,null)},Rg.prototype.unmount=W_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;ka(function(){Ig(null,a,null,null)}),c[Ts]=null}};function Rg(a){this._internalRoot=a}Rg.prototype.unstable_scheduleHydration=function(a){if(a){var c=Xu();a={blockedOn:null,target:a,priority:c};for(var d=0;d<gi.length&&c!==0&&c<gi[d].priority;d++);gi.splice(d,0,a),d===0&&Gl(a)}};function G_(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Ag(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function qT(){}function WM(a,c,d,p,v){if(v){if(typeof p=="function"){var w=p;p=function(){var J=Cg(P);w.call(J)}}var P=KT(c,p,a,0,null,!1,!1,"",qT);return a._reactRootContainer=P,a[Ts]=P.current,oh(a.nodeType===8?a.parentNode:a),ka(),P}for(;v=a.lastChild;)a.removeChild(v);if(typeof p=="function"){var U=p;p=function(){var J=Cg(W);U.call(J)}}var W=U_(a,0,!1,null,null,!1,!1,"",qT);return a._reactRootContainer=W,a[Ts]=W.current,oh(a.nodeType===8?a.parentNode:a),ka(function(){Ig(c,W,d,p)}),W}function bg(a,c,d,p,v){var w=d._reactRootContainer;if(w){var P=w;if(typeof v=="function"){var U=v;v=function(){var W=Cg(P);U.call(W)}}Ig(c,P,a,v)}else P=WM(d,c,a,v,p);return Cg(P)}Ku=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var d=st(c.pendingLanes);d!==0&&($u(c,d|1),Zn(c,xt()),(Je&6)===0&&(yc=xt()+500,mo()))}break;case 13:ka(function(){var p=Rs(a,1);if(p!==null){var v=zn();ur(p,a,1,v)}}),B_(a,1)}},Bl=function(a){if(a.tag===13){var c=Rs(a,134217728);if(c!==null){var d=zn();ur(c,a,134217728,d)}B_(a,134217728)}},Hu=function(a){if(a.tag===13){var c=wo(a),d=Rs(a,c);if(d!==null){var p=zn();ur(d,a,c,p)}B_(a,c)}},Xu=function(){return Xe},qu=function(a,c){var d=Xe;try{return Xe=a,c()}finally{Xe=d}},Fn=function(a,c,d){switch(c){case"input":if(Kn(a,d),c=d.name,d.type==="radio"&&c!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var p=d[c];if(p!==a&&p.form===a.form){var v=Kf(p);if(!v)throw Error(t(90));fs(p),Kn(p,v)}}}break;case"textarea":to(a,d);break;case"select":c=d.value,c!=null&&nn(a,!!d.multiple,c,!1)}},Mi=L_,fn=ka;var GM={usingClientEntryPoint:!1,Events:[ch,rc,Kf,nr,Ft,L_]},Th={findFiberByHostInstance:Ta,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$M={bundleType:Th.bundleType,version:Th.version,rendererPackageName:Th.rendererPackageName,rendererConfig:Th.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Af(a),a===null?null:a.stateNode},findFiberByHostInstance:Th.findFiberByHostInstance||BM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pg.isDisabled&&Pg.supportsFiber)try{ga=Pg.inject($M),di=Pg}catch{}}return Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GM,Qn.createPortal=function(a,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!G_(c))throw Error(t(200));return UM(a,c,null,d)},Qn.createRoot=function(a,c){if(!G_(a))throw Error(t(299));var d=!1,p="",v=XT;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onRecoverableError!==void 0&&(v=c.onRecoverableError)),c=U_(a,1,!1,null,null,d,!1,p,v),a[Ts]=c.current,oh(a.nodeType===8?a.parentNode:a),new W_(c)},Qn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Af(c),a=a===null?null:a.stateNode,a},Qn.flushSync=function(a){return ka(a)},Qn.hydrate=function(a,c,d){if(!Ag(c))throw Error(t(200));return bg(null,a,c,!0,d)},Qn.hydrateRoot=function(a,c,d){if(!G_(a))throw Error(t(405));var p=d!=null&&d.hydratedSources||null,v=!1,w="",P=XT;if(d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(P=d.onRecoverableError)),c=KT(c,null,a,1,d??null,v,!1,w,P),a[Ts]=c.current,oh(a),p)for(a=0;a<p.length;a++)d=p[a],v=d._getVersion,v=v(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,v]:c.mutableSourceEagerHydrationData.push(d,v);return new Rg(c)},Qn.render=function(a,c,d){if(!Ag(c))throw Error(t(200));return bg(null,a,c,!1,d)},Qn.unmountComponentAtNode=function(a){if(!Ag(a))throw Error(t(40));return a._reactRootContainer?(ka(function(){bg(null,null,a,!1,function(){a._reactRootContainer=null,a[Ts]=null})}),!0):!1},Qn.unstable_batchedUpdates=L_,Qn.unstable_renderSubtreeIntoContainer=function(a,c,d,p){if(!Ag(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return bg(a,c,d,!1,p)},Qn.version="18.3.1-next-f1338f8080-20240426",Qn}var iS;function JM(){if(iS)return H_.exports;iS=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),H_.exports=QM(),H_.exports}var rS;function eL(){if(rS)return kg;rS=1;var n=JM();return kg.createRoot=n.createRoot,kg.hydrateRoot=n.hydrateRoot,kg}var tL=eL();const nL=Rx(tL);var q=Zd();const iL=Rx(q),Ax=q.createContext({});function bx(n){const e=q.useRef(null);return e.current===null&&(e.current=n()),e.current}const Tp=q.createContext(null),Px=q.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class rL extends q.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function sL({children:n,isPresent:e}){const t=q.useId(),i=q.useRef(null),r=q.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=q.useContext(Px);return q.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:h}=r.current;if(e||!i.current||!o||!l)return;i.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),_.jsx(rL,{isPresent:e,childRef:i,sizeRef:r,children:q.cloneElement(n,{ref:i})})}const oL=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const l=bx(aL),u=q.useId(),h=q.useCallback(m=>{l.set(m,!0);for(const y of l.values())if(!y)return;i&&i()},[l,i]),f=q.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:m=>(l.set(m,!1),()=>l.delete(m))}),s?[Math.random(),h]:[t,h]);return q.useMemo(()=>{l.forEach((m,y)=>l.set(y,!1))},[t]),q.useEffect(()=>{!t&&!l.size&&i&&i()},[t]),o==="popLayout"&&(n=_.jsx(sL,{isPresent:t,children:n})),_.jsx(Tp.Provider,{value:f,children:n})};function aL(){return new Map}function B2(n=!0){const e=q.useContext(Tp);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=q.useId();q.useEffect(()=>{n&&r(s)},[n]);const o=q.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Ng=n=>n.key||"";function sS(n){const e=[];return q.Children.forEach(n,t=>{q.isValidElement(t)&&e.push(t)}),e}const kx=typeof window<"u",W2=kx?q.useLayoutEffect:q.useEffect,li=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[l,u]=B2(o),h=q.useMemo(()=>sS(n),[n]),f=o&&!l?[]:h.map(Ng),m=q.useRef(!0),y=q.useRef(h),x=bx(()=>new Map),[T,I]=q.useState(h),[S,A]=q.useState(h);W2(()=>{m.current=!1,y.current=h;for(let R=0;R<S.length;R++){const L=Ng(S[R]);f.includes(L)?x.delete(L):x.get(L)!==!0&&x.set(L,!1)}},[S,f.length,f.join("-")]);const D=[];if(h!==T){let R=[...h];for(let L=0;L<S.length;L++){const j=S[L],k=Ng(j);f.includes(k)||(R.splice(L,0,j),D.push(j))}s==="wait"&&D.length&&(R=D),A(sS(R)),I(h);return}const{forceRender:N}=q.useContext(Ax);return _.jsx(_.Fragment,{children:S.map(R=>{const L=Ng(R),j=o&&!l?!1:h===S||f.includes(L),k=()=>{if(x.has(L))x.set(L,!0);else return;let b=!0;x.forEach(M=>{M||(b=!1)}),b&&(N?.(),A(y.current),o&&u?.(),i&&i())};return _.jsx(oL,{isPresent:j,initial:!m.current||t?void 0:!1,custom:j?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:j?void 0:k,children:R},L)})})},Ii=n=>n;let G2=Ii;function Nx(n){let e;return()=>(e===void 0&&(e=n()),e)}const nu=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},zs=n=>n*1e3,Us=n=>n/1e3,lL={useManualTiming:!1};function cL(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,f=!1,m=!1)=>{const x=m&&i?e:t;return f&&s.add(h),x.has(h)||x.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(l),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Dg=["read","resolveKeyframes","update","preRender","render","postRender"],uL=40;function $2(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Dg.reduce((A,D)=>(A[D]=cL(s),A),{}),{read:l,resolveKeyframes:u,update:h,preRender:f,render:m,postRender:y}=o,x=()=>{const A=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(A-r.timestamp,uL),1),r.timestamp=A,r.isProcessing=!0,l.process(r),u.process(r),h.process(r),f.process(r),m.process(r),y.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(x))},T=()=>{t=!0,i=!0,r.isProcessing||n(x)};return{schedule:Dg.reduce((A,D)=>{const N=o[D];return A[D]=(R,L=!1,j=!1)=>(t||T(),N.schedule(R,L,j)),A},{}),cancel:A=>{for(let D=0;D<Dg.length;D++)o[Dg[D]].cancel(A)},state:r,steps:o}}const{schedule:Tt,cancel:ea,state:xn,steps:Y_}=$2(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ii,!0),K2=q.createContext({strict:!1}),oS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},iu={};for(const n in oS)iu[n]={isEnabled:e=>oS[n].some(t=>!!e[t])};function hL(n){for(const e in n)iu[e]={...iu[e],...n[e]}}const dL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Im(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||dL.has(n)}let H2=n=>!Im(n);function fL(n){n&&(H2=e=>e.startsWith("on")?!Im(e):n(e))}try{fL(require("@emotion/is-prop-valid").default)}catch{}function gL(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(H2(r)||t===!0&&Im(r)||!e&&!Im(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function mL(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const Sp=q.createContext({});function pd(n){return typeof n=="string"||Array.isArray(n)}function Ip(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const Dx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Mx=["initial",...Dx];function Cp(n){return Ip(n.animate)||Mx.some(e=>pd(n[e]))}function X2(n){return!!(Cp(n)||n.variants)}function pL(n,e){if(Cp(n)){const{initial:t,animate:i}=n;return{initial:t===!1||pd(t)?t:void 0,animate:pd(i)?i:void 0}}return n.inherit!==!1?e:{}}function yL(n){const{initial:e,animate:t}=pL(n,q.useContext(Sp));return q.useMemo(()=>({initial:e,animate:t}),[aS(e),aS(t)])}function aS(n){return Array.isArray(n)?n.join(" "):n}const _L=Symbol.for("motionComponentSymbol");function zc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function vL(n,e,t){return q.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):zc(t)&&(t.current=i))},[e])}const Lx=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),xL="framerAppearId",q2="data-"+Lx(xL),{schedule:Ox}=$2(queueMicrotask,!1),Y2=q.createContext({});function wL(n,e,t,i,r){var s,o;const{visualElement:l}=q.useContext(Sp),u=q.useContext(K2),h=q.useContext(Tp),f=q.useContext(Px).reducedMotion,m=q.useRef(null);i=i||u.renderer,!m.current&&i&&(m.current=i(n,{visualState:e,parent:l,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const y=m.current,x=q.useContext(Y2);y&&!y.projection&&r&&(y.type==="html"||y.type==="svg")&&EL(m.current,t,r,x);const T=q.useRef(!1);q.useInsertionEffect(()=>{y&&T.current&&y.update(t,h)});const I=t[q2],S=q.useRef(!!I&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,I))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,I)));return W2(()=>{y&&(T.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),Ox.render(y.render),S.current&&y.animationState&&y.animationState.animateChanges())}),q.useEffect(()=>{y&&(!S.current&&y.animationState&&y.animationState.animateChanges(),S.current&&(queueMicrotask(()=>{var A;(A=window.MotionHandoffMarkAsComplete)===null||A===void 0||A.call(window,I)}),S.current=!1))}),y}function EL(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:Z2(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||l&&zc(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function Z2(n){if(n)return n.options.allowProjection!==!1?n.projection:Z2(n.parent)}function TL({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&hL(n);function l(h,f){let m;const y={...q.useContext(Px),...h,layoutId:SL(h)},{isStatic:x}=y,T=yL(h),I=i(h,x);if(!x&&kx){IL();const S=CL(y);m=S.MeasureLayout,T.visualElement=wL(r,I,y,e,S.ProjectionNode)}return _.jsxs(Sp.Provider,{value:T,children:[m&&T.visualElement?_.jsx(m,{visualElement:T.visualElement,...y}):null,t(r,h,vL(I,T.visualElement,f),I,x,T.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=q.forwardRef(l);return u[_L]=r,u}function SL({layoutId:n}){const e=q.useContext(Ax).id;return e&&n!==void 0?e+"-"+n:n}function IL(n,e){q.useContext(K2).strict}function CL(n){const{drag:e,layout:t}=iu;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const RL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Fx(n){return typeof n!="string"||n.includes("-")?!1:!!(RL.indexOf(n)>-1||/[A-Z]/u.test(n))}function lS(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function Vx(n,e,t,i){if(typeof e=="function"){const[r,s]=lS(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=lS(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const rv=n=>Array.isArray(n),AL=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),bL=n=>rv(n)?n[n.length-1]||0:n,Ln=n=>!!(n&&n.getVelocity);function om(n){const e=Ln(n)?n.get():n;return AL(e)?e.toValue():e}function PL({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:kL(i,r,s,n),renderState:e()};return t&&(o.onMount=l=>t({props:i,current:l,...o}),o.onUpdate=l=>t(l)),o}const Q2=n=>(e,t)=>{const i=q.useContext(Sp),r=q.useContext(Tp),s=()=>PL(n,e,i,r);return t?s():bx(s)};function kL(n,e,t,i){const r={},s=i(n,{});for(const y in s)r[y]=om(s[y]);let{initial:o,animate:l}=n;const u=Cp(n),h=X2(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const m=f?l:o;if(m&&typeof m!="boolean"&&!Ip(m)){const y=Array.isArray(m)?m:[m];for(let x=0;x<y.length;x++){const T=Vx(n,y[x]);if(T){const{transitionEnd:I,transition:S,...A}=T;for(const D in A){let N=A[D];if(Array.isArray(N)){const R=f?N.length-1:0;N=N[R]}N!==null&&(r[D]=N)}for(const D in I)r[D]=I[D]}}}return r}const bu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Pl=new Set(bu),J2=n=>e=>typeof e=="string"&&e.startsWith(n),eA=J2("--"),NL=J2("var(--"),jx=n=>NL(n)?DL.test(n.split("/*")[0].trim()):!1,DL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,tA=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Ks=(n,e,t)=>t>e?e:t<n?n:t,Pu={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},yd={...Pu,transform:n=>Ks(0,1,n)},Mg={...Pu,default:1},Qd=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Oo=Qd("deg"),is=Qd("%"),Ne=Qd("px"),ML=Qd("vh"),LL=Qd("vw"),cS={...is,parse:n=>is.parse(n)/100,transform:n=>is.transform(n*100)},OL={borderWidth:Ne,borderTopWidth:Ne,borderRightWidth:Ne,borderBottomWidth:Ne,borderLeftWidth:Ne,borderRadius:Ne,radius:Ne,borderTopLeftRadius:Ne,borderTopRightRadius:Ne,borderBottomRightRadius:Ne,borderBottomLeftRadius:Ne,width:Ne,maxWidth:Ne,height:Ne,maxHeight:Ne,top:Ne,right:Ne,bottom:Ne,left:Ne,padding:Ne,paddingTop:Ne,paddingRight:Ne,paddingBottom:Ne,paddingLeft:Ne,margin:Ne,marginTop:Ne,marginRight:Ne,marginBottom:Ne,marginLeft:Ne,backgroundPositionX:Ne,backgroundPositionY:Ne},FL={rotate:Oo,rotateX:Oo,rotateY:Oo,rotateZ:Oo,scale:Mg,scaleX:Mg,scaleY:Mg,scaleZ:Mg,skew:Oo,skewX:Oo,skewY:Oo,distance:Ne,translateX:Ne,translateY:Ne,translateZ:Ne,x:Ne,y:Ne,z:Ne,perspective:Ne,transformPerspective:Ne,opacity:yd,originX:cS,originY:cS,originZ:Ne},uS={...Pu,transform:Math.round},zx={...OL,...FL,zIndex:uS,size:Ne,fillOpacity:yd,strokeOpacity:yd,numOctaves:uS},VL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},jL=bu.length;function zL(n,e,t){let i="",r=!0;for(let s=0;s<jL;s++){const o=bu[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=tA(l,zx[o]);if(!u){r=!1;const f=VL[o]||o;i+=`${f}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function Ux(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,l=!1;for(const u in e){const h=e[u];if(Pl.has(u)){o=!0;continue}else if(eA(u)){r[u]=h;continue}else{const f=tA(h,zx[u]);u.startsWith("origin")?(l=!0,s[u]=f):i[u]=f}}if(e.transform||(o||t?i.transform=zL(e,n.transform,t):i.transform&&(i.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;i.transformOrigin=`${u} ${h} ${f}`}}const UL={offset:"stroke-dashoffset",array:"stroke-dasharray"},BL={offset:"strokeDashoffset",array:"strokeDasharray"};function WL(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?UL:BL;n[s.offset]=Ne.transform(-i);const o=Ne.transform(e),l=Ne.transform(t);n[s.array]=`${o} ${l}`}function hS(n,e,t){return typeof n=="string"?n:Ne.transform(e+t*n)}function GL(n,e,t){const i=hS(e,n.x,n.width),r=hS(t,n.y,n.height);return`${i} ${r}`}function Bx(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...h},f,m){if(Ux(n,h,m),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:y,style:x,dimensions:T}=n;y.transform&&(T&&(x.transform=y.transform),delete y.transform),T&&(r!==void 0||s!==void 0||x.transform)&&(x.transformOrigin=GL(T,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(y.x=e),t!==void 0&&(y.y=t),i!==void 0&&(y.scale=i),o!==void 0&&WL(y,o,l,u,!1)}const Wx=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),nA=()=>({...Wx(),attrs:{}}),Gx=n=>typeof n=="string"&&n.toLowerCase()==="svg";function iA(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const rA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function sA(n,e,t,i){iA(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(rA.has(r)?r:Lx(r),e.attrs[r])}const Cm={};function $L(n){Object.assign(Cm,n)}function oA(n,{layout:e,layoutId:t}){return Pl.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Cm[n]||n==="opacity")}function $x(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(Ln(r[o])||e.style&&Ln(e.style[o])||oA(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function aA(n,e,t){const i=$x(n,e,t);for(const r in n)if(Ln(n[r])||Ln(e[r])){const s=bu.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function KL(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const dS=["x","y","width","height","cx","cy","r"],HL={useVisualState:Q2({scrapeMotionValuesFromProps:aA,createRenderState:nA,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const l in r)if(Pl.has(l)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let l=0;l<dS.length;l++){const u=dS[l];n[u]!==e[u]&&(o=!0)}o&&Tt.read(()=>{KL(t,i),Tt.render(()=>{Bx(i,r,Gx(t.tagName),n.transformTemplate),sA(t,i)})})}})},XL={useVisualState:Q2({scrapeMotionValuesFromProps:$x,createRenderState:Wx})};function lA(n,e,t){for(const i in e)!Ln(e[i])&&!oA(i,t)&&(n[i]=e[i])}function qL({transformTemplate:n},e){return q.useMemo(()=>{const t=Wx();return Ux(t,e,n),Object.assign({},t.vars,t.style)},[e])}function YL(n,e){const t=n.style||{},i={};return lA(i,t,n),Object.assign(i,qL(n,e)),i}function ZL(n,e){const t={},i=YL(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function QL(n,e,t,i){const r=q.useMemo(()=>{const s=nA();return Bx(s,e,Gx(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};lA(s,n.style,n),r.style={...s,...r.style}}return r}function JL(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(Fx(t)?QL:ZL)(i,s,o,t),h=gL(i,typeof t=="string",n),f=t!==q.Fragment?{...h,...u,ref:r}:{},{children:m}=i,y=q.useMemo(()=>Ln(m)?m.get():m,[m]);return q.createElement(t,{...f,children:y})}}function eO(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...Fx(i)?HL:XL,preloadedFeatures:n,useRender:JL(r),createVisualElement:e,Component:i};return TL(o)}}function cA(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function Rp(n,e,t){const i=n.getProps();return Vx(i,e,t!==void 0?t:i.custom,n)}const tO=Nx(()=>window.ScrollTimeline!==void 0);class nO{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(tO()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class iO extends nO{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Kx(n,e){return n?n[e]||n.default||n:void 0}const sv=2e4;function uA(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<sv;)e+=t,i=n.next(e);return e>=sv?1/0:e}function Hx(n){return typeof n=="function"}function fS(n,e){n.timeline=e,n.onfinish=null}const Xx=n=>Array.isArray(n)&&typeof n[0]=="number",rO={linearEasing:void 0};function sO(n,e){const t=Nx(n);return()=>{var i;return(i=rO[e])!==null&&i!==void 0?i:t()}}const Rm=sO(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),hA=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(nu(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function dA(n){return!!(typeof n=="function"&&Rm()||!n||typeof n=="string"&&(n in ov||Rm())||Xx(n)||Array.isArray(n)&&n.every(dA))}const Vh=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,ov={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Vh([0,.65,.55,1]),circOut:Vh([.55,0,1,.45]),backIn:Vh([.31,.01,.66,-.59]),backOut:Vh([.33,1.53,.69,.99])};function fA(n,e){if(n)return typeof n=="function"&&Rm()?hA(n,e):Xx(n)?Vh(n):Array.isArray(n)?n.map(t=>fA(t,e)||ov.easeOut):ov[n]}const dr={x:!1,y:!1};function gA(){return dr.x||dr.y}function oO(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function mA(n,e){const t=oO(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function gS(n){return e=>{e.pointerType==="touch"||gA()||n(e)}}function aO(n,e,t={}){const[i,r,s]=mA(n,t),o=gS(l=>{const{target:u}=l,h=e(l);if(typeof h!="function"||!u)return;const f=gS(m=>{h(m),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,r)});return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),s}const pA=(n,e)=>e?n===e?!0:pA(n,e.parentElement):!1,qx=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,lO=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function cO(n){return lO.has(n.tagName)||n.tabIndex!==-1}const jh=new WeakSet;function mS(n){return e=>{e.key==="Enter"&&n(e)}}function Z_(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const uO=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=mS(()=>{if(jh.has(t))return;Z_(t,"down");const r=mS(()=>{Z_(t,"up")}),s=()=>Z_(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function pS(n){return qx(n)&&!gA()}function hO(n,e,t={}){const[i,r,s]=mA(n,t),o=l=>{const u=l.currentTarget;if(!pS(l)||jh.has(u))return;jh.add(u);const h=e(l),f=(x,T)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",y),!(!pS(x)||!jh.has(u))&&(jh.delete(u),typeof h=="function"&&h(x,{success:T}))},m=x=>{f(x,t.useGlobalTarget||pA(u,x.target))},y=x=>{f(x,!1)};window.addEventListener("pointerup",m,r),window.addEventListener("pointercancel",y,r)};return i.forEach(l=>{!cO(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),l.addEventListener("focus",h=>uO(h,r),r)}),s}function dO(n){return n==="x"||n==="y"?dr[n]?null:(dr[n]=!0,()=>{dr[n]=!1}):dr.x||dr.y?null:(dr.x=dr.y=!0,()=>{dr.x=dr.y=!1})}const yA=new Set(["width","height","top","left","right","bottom",...bu]);let am;function fO(){am=void 0}const rs={now:()=>(am===void 0&&rs.set(xn.isProcessing||lL.useManualTiming?xn.timestamp:performance.now()),am),set:n=>{am=n,queueMicrotask(fO)}};function Yx(n,e){n.indexOf(e)===-1&&n.push(e)}function Zx(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class Qx{constructor(){this.subscriptions=[]}add(e){return Yx(this.subscriptions,e),()=>Zx(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function _A(n,e){return e?n*(1e3/e):0}const yS=30,gO=n=>!isNaN(parseFloat(n));class mO{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=rs.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=rs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=gO(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Qx);const i=this.events[e].add(t);return e==="change"?()=>{i(),Tt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=rs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>yS)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,yS);return _A(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function _d(n,e){return new mO(n,e)}function pO(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,_d(t))}function yO(n,e){const t=Rp(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const l=bL(s[o]);pO(n,o,l)}}function _O(n){return!!(Ln(n)&&n.add)}function av(n,e){const t=n.getValue("willChange");if(_O(t))return t.add(e)}function vA(n){return n.props[q2]}const xA=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,vO=1e-7,xO=12;function wO(n,e,t,i,r){let s,o,l=0;do o=e+(t-e)/2,s=xA(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>vO&&++l<xO);return o}function Jd(n,e,t,i){if(n===e&&t===i)return Ii;const r=s=>wO(s,0,1,n,t);return s=>s===0||s===1?s:xA(r(s),e,i)}const wA=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,EA=n=>e=>1-n(1-e),TA=Jd(.33,1.53,.69,.99),Jx=EA(TA),SA=wA(Jx),IA=n=>(n*=2)<1?.5*Jx(n):.5*(2-Math.pow(2,-10*(n-1))),e1=n=>1-Math.sin(Math.acos(n)),CA=EA(e1),RA=wA(e1),AA=n=>/^0[^.\s]+$/u.test(n);function EO(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||AA(n):!0}const Yh=n=>Math.round(n*1e5)/1e5,t1=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function TO(n){return n==null}const SO=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,n1=(n,e)=>t=>!!(typeof t=="string"&&SO.test(t)&&t.startsWith(n)||e&&!TO(t)&&Object.prototype.hasOwnProperty.call(t,e)),bA=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,l]=i.match(t1);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},IO=n=>Ks(0,255,n),Q_={...Pu,transform:n=>Math.round(IO(n))},Za={test:n1("rgb","red"),parse:bA("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+Q_.transform(n)+", "+Q_.transform(e)+", "+Q_.transform(t)+", "+Yh(yd.transform(i))+")"};function CO(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const lv={test:n1("#"),parse:CO,transform:Za.transform},Uc={test:n1("hsl","hue"),parse:bA("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+is.transform(Yh(e))+", "+is.transform(Yh(t))+", "+Yh(yd.transform(i))+")"},Dn={test:n=>Za.test(n)||lv.test(n)||Uc.test(n),parse:n=>Za.test(n)?Za.parse(n):Uc.test(n)?Uc.parse(n):lv.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Za.transform(n):Uc.transform(n)},RO=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function AO(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(t1))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(RO))===null||t===void 0?void 0:t.length)||0)>0}const PA="number",kA="color",bO="var",PO="var(",_S="${}",kO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function vd(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const l=e.replace(kO,u=>(Dn.test(u)?(i.color.push(s),r.push(kA),t.push(Dn.parse(u))):u.startsWith(PO)?(i.var.push(s),r.push(bO),t.push(u)):(i.number.push(s),r.push(PA),t.push(parseFloat(u))),++s,_S)).split(_S);return{values:t,split:l,indexes:i,types:r}}function NA(n){return vd(n).values}function DA(n){const{split:e,types:t}=vd(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const l=t[o];l===PA?s+=Yh(r[o]):l===kA?s+=Dn.transform(r[o]):s+=r[o]}return s}}const NO=n=>typeof n=="number"?0:n;function DO(n){const e=NA(n);return DA(n)(e.map(NO))}const ta={test:AO,parse:NA,createTransformer:DA,getAnimatableNone:DO},MO=new Set(["brightness","contrast","saturate","opacity"]);function LO(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(t1)||[];if(!i)return n;const r=t.replace(i,"");let s=MO.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const OO=/\b([a-z-]*)\(.*?\)/gu,cv={...ta,getAnimatableNone:n=>{const e=n.match(OO);return e?e.map(LO).join(" "):n}},FO={...zx,color:Dn,backgroundColor:Dn,outlineColor:Dn,fill:Dn,stroke:Dn,borderColor:Dn,borderTopColor:Dn,borderRightColor:Dn,borderBottomColor:Dn,borderLeftColor:Dn,filter:cv,WebkitFilter:cv},i1=n=>FO[n];function MA(n,e){let t=i1(n);return t!==cv&&(t=ta),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const VO=new Set(["auto","none","0"]);function jO(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!VO.has(s)&&vd(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=MA(t,r)}const vS=n=>n===Pu||n===Ne,xS=(n,e)=>parseFloat(n.split(", ")[e]),wS=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return xS(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?xS(s[1],n):0}},zO=new Set(["x","y","z"]),UO=bu.filter(n=>!zO.has(n));function BO(n){const e=[];return UO.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const ru={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:wS(4,13),y:wS(5,14)};ru.translateX=ru.x;ru.translateY=ru.y;const sl=new Set;let uv=!1,hv=!1;function LA(){if(hv){const n=Array.from(sl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=BO(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var l;(l=i.getValue(s))===null||l===void 0||l.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}hv=!1,uv=!1,sl.forEach(n=>n.complete()),sl.clear()}function OA(){sl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(hv=!0)})}function WO(){OA(),LA()}class r1{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(sl.add(this),uv||(uv=!0,Tt.read(OA),Tt.resolveKeyframes(LA))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),sl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,sl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const FA=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),GO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function $O(n){const e=GO.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function VA(n,e,t=1){const[i,r]=$O(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return FA(o)?parseFloat(o):o}return jx(r)?VA(r,e,t+1):r}const jA=n=>e=>e.test(n),KO={test:n=>n==="auto",parse:n=>n},zA=[Pu,Ne,is,Oo,LL,ML,KO],ES=n=>zA.find(jA(n));class UA extends r1{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),jx(h))){const f=VA(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!yA.has(i)||e.length!==2)return;const[r,s]=e,o=ES(r),l=ES(s);if(o!==l)if(vS(o)&&vS(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)EO(e[r])&&i.push(r);i.length&&jO(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ru[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,l=r[o];r[o]=ru[i](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const TS=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ta.test(n)||n==="0")&&!n.startsWith("url("));function HO(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function XO(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=TS(r,e),l=TS(s,e);return!o||!l?!1:HO(n)||(t==="spring"||Hx(t))&&i}const qO=n=>n!==null;function Ap(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(qO),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const YO=40;class BA{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=rs.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>YO?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&WO(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=rs.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:l,onUpdate:u,isGenerator:h}=this.options;if(!h&&!XO(e,i,r,s))if(o)this.options.duration=0;else{u&&u(Ap(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Nt=(n,e,t)=>n+(e-n)*t;function J_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function ZO({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;r=J_(u,l,n+1/3),s=J_(u,l,n),o=J_(u,l,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function Am(n,e){return t=>t>0?e:n}const e0=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},QO=[lv,Za,Uc],JO=n=>QO.find(e=>e.test(n));function SS(n){const e=JO(n);if(!e)return!1;let t=e.parse(n);return e===Uc&&(t=ZO(t)),t}const IS=(n,e)=>{const t=SS(n),i=SS(e);if(!t||!i)return Am(n,e);const r={...t};return s=>(r.red=e0(t.red,i.red,s),r.green=e0(t.green,i.green,s),r.blue=e0(t.blue,i.blue,s),r.alpha=Nt(t.alpha,i.alpha,s),Za.transform(r))},eF=(n,e)=>t=>e(n(t)),ef=(...n)=>n.reduce(eF),dv=new Set(["none","hidden"]);function tF(n,e){return dv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function nF(n,e){return t=>Nt(n,e,t)}function s1(n){return typeof n=="number"?nF:typeof n=="string"?jx(n)?Am:Dn.test(n)?IS:sF:Array.isArray(n)?WA:typeof n=="object"?Dn.test(n)?IS:iF:Am}function WA(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>s1(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function iF(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=s1(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function rF(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],l=n.indexes[o][r[o]],u=(t=n.values[l])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const sF=(n,e)=>{const t=ta.createTransformer(e),i=vd(n),r=vd(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?dv.has(n)&&!r.values.length||dv.has(e)&&!i.values.length?tF(n,e):ef(WA(rF(i,r),r.values),t):Am(n,e)};function GA(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Nt(n,e,t):s1(n)(n,e)}const oF=5;function $A(n,e,t){const i=Math.max(e-oF,0);return _A(t-n(i),e-i)}const Ot={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},t0=.001;function aF({duration:n=Ot.duration,bounce:e=Ot.bounce,velocity:t=Ot.velocity,mass:i=Ot.mass}){let r,s,o=1-e;o=Ks(Ot.minDamping,Ot.maxDamping,o),n=Ks(Ot.minDuration,Ot.maxDuration,Us(n)),o<1?(r=h=>{const f=h*o,m=f*n,y=f-t,x=fv(h,o),T=Math.exp(-m);return t0-y/x*T},s=h=>{const m=h*o*n,y=m*t+t,x=Math.pow(o,2)*Math.pow(h,2)*n,T=Math.exp(-m),I=fv(Math.pow(h,2),o);return(-r(h)+t0>0?-1:1)*((y-x)*T)/I}):(r=h=>{const f=Math.exp(-h*n),m=(h-t)*n+1;return-t0+f*m},s=h=>{const f=Math.exp(-h*n),m=(t-h)*(n*n);return f*m});const l=5/n,u=cF(r,s,l);if(n=zs(n),isNaN(u))return{stiffness:Ot.stiffness,damping:Ot.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const lF=12;function cF(n,e,t){let i=t;for(let r=1;r<lF;r++)i=i-n(i)/e(i);return i}function fv(n,e){return n*Math.sqrt(1-e*e)}const uF=["duration","bounce"],hF=["stiffness","damping","mass"];function CS(n,e){return e.some(t=>n[t]!==void 0)}function dF(n){let e={velocity:Ot.velocity,stiffness:Ot.stiffness,damping:Ot.damping,mass:Ot.mass,isResolvedFromDuration:!1,...n};if(!CS(n,hF)&&CS(n,uF))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Ks(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Ot.mass,stiffness:r,damping:s}}else{const t=aF(n);e={...e,...t,mass:Ot.mass},e.isResolvedFromDuration=!0}return e}function KA(n=Ot.visualDuration,e=Ot.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:m,velocity:y,isResolvedFromDuration:x}=dF({...t,velocity:-Us(t.velocity||0)}),T=y||0,I=h/(2*Math.sqrt(u*f)),S=o-s,A=Us(Math.sqrt(u/f)),D=Math.abs(S)<5;i||(i=D?Ot.restSpeed.granular:Ot.restSpeed.default),r||(r=D?Ot.restDelta.granular:Ot.restDelta.default);let N;if(I<1){const L=fv(A,I);N=j=>{const k=Math.exp(-I*A*j);return o-k*((T+I*A*S)/L*Math.sin(L*j)+S*Math.cos(L*j))}}else if(I===1)N=L=>o-Math.exp(-A*L)*(S+(T+A*S)*L);else{const L=A*Math.sqrt(I*I-1);N=j=>{const k=Math.exp(-I*A*j),b=Math.min(L*j,300);return o-k*((T+I*A*S)*Math.sinh(b)+L*S*Math.cosh(b))/L}}const R={calculatedDuration:x&&m||null,next:L=>{const j=N(L);if(x)l.done=L>=m;else{let k=0;I<1&&(k=L===0?zs(T):$A(N,L,j));const b=Math.abs(k)<=i,M=Math.abs(o-j)<=r;l.done=b&&M}return l.value=l.done?o:j,l},toString:()=>{const L=Math.min(uA(R),sv),j=hA(k=>R.next(L*k).value,L,30);return L+"ms "+j}};return R}function RS({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:f}){const m=n[0],y={done:!1,value:m},x=b=>l!==void 0&&b<l||u!==void 0&&b>u,T=b=>l===void 0?u:u===void 0||Math.abs(l-b)<Math.abs(u-b)?l:u;let I=t*e;const S=m+I,A=o===void 0?S:o(S);A!==S&&(I=A-m);const D=b=>-I*Math.exp(-b/i),N=b=>A+D(b),R=b=>{const M=D(b),V=N(b);y.done=Math.abs(M)<=h,y.value=y.done?A:V};let L,j;const k=b=>{x(y.value)&&(L=b,j=KA({keyframes:[y.value,T(y.value)],velocity:$A(N,b,y.value),damping:r,stiffness:s,restDelta:h,restSpeed:f}))};return k(0),{calculatedDuration:null,next:b=>{let M=!1;return!j&&L===void 0&&(M=!0,R(b),k(b)),L!==void 0&&b>=L?j.next(b-L):(!M&&R(b),y)}}}const fF=Jd(.42,0,1,1),gF=Jd(0,0,.58,1),HA=Jd(.42,0,.58,1),mF=n=>Array.isArray(n)&&typeof n[0]!="number",pF={linear:Ii,easeIn:fF,easeInOut:HA,easeOut:gF,circIn:e1,circInOut:RA,circOut:CA,backIn:Jx,backInOut:SA,backOut:TA,anticipate:IA},AS=n=>{if(Xx(n)){G2(n.length===4);const[e,t,i,r]=n;return Jd(e,t,i,r)}else if(typeof n=="string")return pF[n];return n};function yF(n,e,t){const i=[],r=t||GA,s=n.length-1;for(let o=0;o<s;o++){let l=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ii:e;l=ef(u,l)}i.push(l)}return i}function _F(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(G2(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=yF(e,i,r),u=l.length,h=f=>{if(o&&f<n[0])return e[0];let m=0;if(u>1)for(;m<n.length-2&&!(f<n[m+1]);m++);const y=nu(n[m],n[m+1],f);return l[m](y)};return t?f=>h(Ks(n[0],n[s-1],f)):h}function vF(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=nu(0,e,i);n.push(Nt(t,1,r))}}function xF(n){const e=[0];return vF(e,n.length-1),e}function wF(n,e){return n.map(t=>t*e)}function EF(n,e){return n.map(()=>e||HA).splice(0,n.length-1)}function bm({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=mF(i)?i.map(AS):AS(i),s={done:!1,value:e[0]},o=wF(t&&t.length===e.length?t:xF(e),n),l=_F(o,e,{ease:Array.isArray(r)?r:EF(e,r)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const TF=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Tt.update(e,!0),stop:()=>ea(e),now:()=>xn.isProcessing?xn.timestamp:rs.now()}},SF={decay:RS,inertia:RS,tween:bm,keyframes:bm,spring:KA},IF=n=>n/100;class o1 extends BA{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||r1,l=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,l,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,l=Hx(t)?t:SF[t]||bm;let u,h;l!==bm&&typeof e[0]!="number"&&(u=ef(IF,GA(e[0],e[1])),e=[0,100]);const f=l({...this.options,keyframes:e});s==="mirror"&&(h=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=uA(f));const{calculatedDuration:m}=f,y=m+r,x=y*(i+1)-r;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:m,resolvedDuration:y,totalDuration:x}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:b}=this.options;return{done:!0,value:b[b.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:m}=i;if(this.startTime===null)return s.next(0);const{delay:y,repeat:x,repeatType:T,repeatDelay:I,onUpdate:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const A=this.currentTime-y*(this.speed>=0?1:-1),D=this.speed>=0?A<0:A>f;this.currentTime=Math.max(A,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let N=this.currentTime,R=s;if(x){const b=Math.min(this.currentTime,f)/m;let M=Math.floor(b),V=b%1;!V&&b>=1&&(V=1),V===1&&M--,M=Math.min(M,x+1),M%2&&(T==="reverse"?(V=1-V,I&&(V-=I/m)):T==="mirror"&&(R=o)),N=Ks(0,1,V)*m}const L=D?{done:!1,value:u[0]}:R.next(N);l&&(L.value=l(L.value));let{done:j}=L;!D&&h!==null&&(j=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&j);return k&&r!==void 0&&(L.value=Ap(u,this.options,r)),S&&S(L.value),k&&this.finish(),L}get duration(){const{resolved:e}=this;return e?Us(e.calculatedDuration):0}get time(){return Us(this.currentTime)}set time(e){e=zs(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Us(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=TF,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const CF=new Set(["opacity","clipPath","filter","transform"]);function RF(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=fA(l,r);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:i,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const AF=Nx(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Pm=10,bF=2e4;function PF(n){return Hx(n.type)||n.type==="spring"||!dA(n.ease)}function kF(n,e){const t=new o1({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<bF;)i=t.sample(s),r.push(i.value),s+=Pm;return{times:void 0,keyframes:r,duration:s-Pm,ease:"linear"}}const XA={anticipate:IA,backInOut:SA,circInOut:RA};function NF(n){return n in XA}class bS extends BA{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new UA(s,(o,l)=>this.onKeyframesResolved(o,l),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:l,name:u,startTime:h}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof s=="string"&&Rm()&&NF(s)&&(s=XA[s]),PF(this.options)){const{onComplete:m,onUpdate:y,motionValue:x,element:T,...I}=this.options,S=kF(e,I);e=S.keyframes,e.length===1&&(e[1]=e[0]),i=S.duration,r=S.times,s=S.ease,o="keyframes"}const f=RF(l.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(fS(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:m}=this.options;l.set(Ap(e,this.options,t)),m&&m(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Us(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Us(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=zs(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Ii;const{animation:i}=t;fS(i,e)}return Ii}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:m,element:y,...x}=this.options,T=new o1({...x,keyframes:i,duration:r,type:s,ease:o,times:l,isGenerator:!0}),I=zs(this.time);h.setWithVelocity(T.sample(I-Pm).value,T.sample(I).value,Pm)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return AF()&&i&&CF.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&l!=="inertia"}}const DF={type:"spring",stiffness:500,damping:25,restSpeed:10},MF=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),LF={type:"keyframes",duration:.8},OF={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},FF=(n,{keyframes:e})=>e.length>2?LF:Pl.has(n)?n.startsWith("scale")?MF(e[1]):DF:OF;function VF({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const a1=(n,e,t,i={},r,s)=>o=>{const l=Kx(i,n)||{},u=l.delay||i.delay||0;let{elapsed:h=0}=i;h=h-zs(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:y=>{e.set(y),l.onUpdate&&l.onUpdate(y)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:s?void 0:r};VF(l)||(f={...f,...FF(n,f)}),f.duration&&(f.duration=zs(f.duration)),f.repeatDelay&&(f.repeatDelay=zs(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let m=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(m=!0)),m&&!s&&e.get()!==void 0){const y=Ap(f.keyframes,l);if(y!==void 0)return Tt.update(()=>{f.onUpdate(y),f.onComplete()}),new iO([])}return!s&&bS.supports(f)?new bS(f):new o1(f)};function jF({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function qA(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:l,...u}=e;i&&(o=i);const h=[],f=r&&n.animationState&&n.animationState.getState()[r];for(const m in u){const y=n.getValue(m,(s=n.latestValues[m])!==null&&s!==void 0?s:null),x=u[m];if(x===void 0||f&&jF(f,m))continue;const T={delay:t,...Kx(o||{},m)};let I=!1;if(window.MotionHandoffAnimation){const A=vA(n);if(A){const D=window.MotionHandoffAnimation(A,m,Tt);D!==null&&(T.startTime=D,I=!0)}}av(n,m),y.start(a1(m,y,x,n.shouldReduceMotion&&yA.has(m)?{type:!1}:T,n,I));const S=y.animation;S&&h.push(S)}return l&&Promise.all(h).then(()=>{Tt.update(()=>{l&&yO(n,l)})}),h}function gv(n,e,t={}){var i;const r=Rp(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(qA(n,r,t)):()=>Promise.resolve(),l=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:m,staggerDirection:y}=s;return zF(n,e,f+h,m,y,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[o,l]:[l,o];return h().then(()=>f())}else return Promise.all([o(),l(t.delay)])}function zF(n,e,t=0,i=0,r=1,s){const o=[],l=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>l-h*i;return Array.from(n.variantChildren).sort(UF).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(gv(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function UF(n,e){return n.sortNodePosition(e)}function BF(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>gv(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=gv(n,e,t);else{const r=typeof e=="function"?Rp(n,e,t.custom):e;i=Promise.all(qA(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const WF=Mx.length;function YA(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?YA(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<WF;t++){const i=Mx[t],r=n.props[i];(pd(r)||r===!1)&&(e[i]=r)}return e}const GF=[...Dx].reverse(),$F=Dx.length;function KF(n){return e=>Promise.all(e.map(({animation:t,options:i})=>BF(n,t,i)))}function HF(n){let e=KF(n),t=PS(),i=!0;const r=u=>(h,f)=>{var m;const y=Rp(n,f,u==="exit"?(m=n.presenceContext)===null||m===void 0?void 0:m.custom:void 0);if(y){const{transition:x,transitionEnd:T,...I}=y;h={...h,...I,...T}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,f=YA(n.parent)||{},m=[],y=new Set;let x={},T=1/0;for(let S=0;S<$F;S++){const A=GF[S],D=t[A],N=h[A]!==void 0?h[A]:f[A],R=pd(N),L=A===u?D.isActive:null;L===!1&&(T=S);let j=N===f[A]&&N!==h[A]&&R;if(j&&i&&n.manuallyAnimateOnMount&&(j=!1),D.protectedKeys={...x},!D.isActive&&L===null||!N&&!D.prevProp||Ip(N)||typeof N=="boolean")continue;const k=XF(D.prevProp,N);let b=k||A===u&&D.isActive&&!j&&R||S>T&&R,M=!1;const V=Array.isArray(N)?N:[N];let z=V.reduce(r(A),{});L===!1&&(z={});const{prevResolvedValues:B={}}=D,O={...B,...z},le=ue=>{b=!0,y.has(ue)&&(M=!0,y.delete(ue)),D.needsAnimating[ue]=!0;const Q=n.getValue(ue);Q&&(Q.liveStyle=!1)};for(const ue in O){const Q=z[ue],se=B[ue];if(x.hasOwnProperty(ue))continue;let ne=!1;rv(Q)&&rv(se)?ne=!cA(Q,se):ne=Q!==se,ne?Q!=null?le(ue):y.add(ue):Q!==void 0&&y.has(ue)?le(ue):D.protectedKeys[ue]=!0}D.prevProp=N,D.prevResolvedValues=z,D.isActive&&(x={...x,...z}),i&&n.blockInitialAnimation&&(b=!1),b&&(!(j&&k)||M)&&m.push(...V.map(ue=>({animation:ue,options:{type:A}})))}if(y.size){const S={};y.forEach(A=>{const D=n.getBaseTarget(A),N=n.getValue(A);N&&(N.liveStyle=!0),S[A]=D??null}),m.push({animation:S})}let I=!!m.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(I=!1),i=!1,I?e(m):Promise.resolve()}function l(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(y=>{var x;return(x=y.animationState)===null||x===void 0?void 0:x.setActive(u,h)}),t[u].isActive=h;const m=o(u);for(const y in t)t[y].protectedKeys={};return m}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>t,reset:()=>{t=PS(),i=!0}}}function XF(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!cA(e,n):!1}function La(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function PS(){return{animate:La(!0),whileInView:La(),whileHover:La(),whileTap:La(),whileDrag:La(),whileFocus:La(),exit:La()}}let aa=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class qF extends aa{constructor(e){super(e),e.animationState||(e.animationState=HF(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Ip(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let YF=0;class ZF extends aa{constructor(){super(...arguments),this.id=YF++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const QF={animation:{Feature:qF},exit:{Feature:ZF}};function xd(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function tf(n){return{point:{x:n.pageX,y:n.pageY}}}const JF=n=>e=>qx(e)&&n(e,tf(e));function Zh(n,e,t,i){return xd(n,e,JF(t),i)}const kS=(n,e)=>Math.abs(n-e);function eV(n,e){const t=kS(n.x,e.x),i=kS(n.y,e.y);return Math.sqrt(t**2+i**2)}class ZA{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=i0(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,x=eV(m.offset,{x:0,y:0})>=3;if(!y&&!x)return;const{point:T}=m,{timestamp:I}=xn;this.history.push({...T,timestamp:I});const{onStart:S,onMove:A}=this.handlers;y||(S&&S(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,m)},this.handlePointerMove=(m,y)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=n0(y,this.transformPagePoint),Tt.update(this.updatePoint,!0)},this.handlePointerUp=(m,y)=>{this.end();const{onEnd:x,onSessionEnd:T,resumeAnimation:I}=this.handlers;if(this.dragSnapToOrigin&&I&&I(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=i0(m.type==="pointercancel"?this.lastMoveEventInfo:n0(y,this.transformPagePoint),this.history);this.startEvent&&x&&x(m,S),T&&T(m,S)},!qx(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=tf(e),l=n0(o,this.transformPagePoint),{point:u}=l,{timestamp:h}=xn;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,i0(l,this.history)),this.removeListeners=ef(Zh(this.contextWindow,"pointermove",this.handlePointerMove),Zh(this.contextWindow,"pointerup",this.handlePointerUp),Zh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ea(this.updatePoint)}}function n0(n,e){return e?{point:e(n.point)}:n}function NS(n,e){return{x:n.x-e.x,y:n.y-e.y}}function i0({point:n},e){return{point:n,delta:NS(n,QA(e)),offset:NS(n,tV(e)),velocity:nV(e,.1)}}function tV(n){return n[0]}function QA(n){return n[n.length-1]}function nV(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=QA(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>zs(e)));)t--;if(!i)return{x:0,y:0};const s=Us(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const JA=1e-4,iV=1-JA,rV=1+JA,eb=.01,sV=0-eb,oV=0+eb;function Ci(n){return n.max-n.min}function aV(n,e,t){return Math.abs(n-e)<=t}function DS(n,e,t,i=.5){n.origin=i,n.originPoint=Nt(e.min,e.max,n.origin),n.scale=Ci(t)/Ci(e),n.translate=Nt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=iV&&n.scale<=rV||isNaN(n.scale))&&(n.scale=1),(n.translate>=sV&&n.translate<=oV||isNaN(n.translate))&&(n.translate=0)}function Qh(n,e,t,i){DS(n.x,e.x,t.x,i?i.originX:void 0),DS(n.y,e.y,t.y,i?i.originY:void 0)}function MS(n,e,t){n.min=t.min+e.min,n.max=n.min+Ci(e)}function lV(n,e,t){MS(n.x,e.x,t.x),MS(n.y,e.y,t.y)}function LS(n,e,t){n.min=e.min-t.min,n.max=n.min+Ci(e)}function Jh(n,e,t){LS(n.x,e.x,t.x),LS(n.y,e.y,t.y)}function cV(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?Nt(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?Nt(t,n,i.max):Math.min(n,t)),n}function OS(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function uV(n,{top:e,left:t,bottom:i,right:r}){return{x:OS(n.x,t,r),y:OS(n.y,e,i)}}function FS(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function hV(n,e){return{x:FS(n.x,e.x),y:FS(n.y,e.y)}}function dV(n,e){let t=.5;const i=Ci(n),r=Ci(e);return r>i?t=nu(e.min,e.max-i,n.min):i>r&&(t=nu(n.min,n.max-r,e.min)),Ks(0,1,t)}function fV(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const mv=.35;function gV(n=mv){return n===!1?n=0:n===!0&&(n=mv),{x:VS(n,"left","right"),y:VS(n,"top","bottom")}}function VS(n,e,t){return{min:jS(n,e),max:jS(n,t)}}function jS(n,e){return typeof n=="number"?n:n[e]||0}const zS=()=>({translate:0,scale:1,origin:0,originPoint:0}),Bc=()=>({x:zS(),y:zS()}),US=()=>({min:0,max:0}),Ut=()=>({x:US(),y:US()});function Ki(n){return[n("x"),n("y")]}function tb({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function mV({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function pV(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function r0(n){return n===void 0||n===1}function pv({scale:n,scaleX:e,scaleY:t}){return!r0(n)||!r0(e)||!r0(t)}function ja(n){return pv(n)||nb(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function nb(n){return BS(n.x)||BS(n.y)}function BS(n){return n&&n!=="0%"}function km(n,e,t){const i=n-t,r=e*i;return t+r}function WS(n,e,t,i,r){return r!==void 0&&(n=km(n,r,i)),km(n,t,i)+e}function yv(n,e=0,t=1,i,r){n.min=WS(n.min,e,t,i,r),n.max=WS(n.max,e,t,i,r)}function ib(n,{x:e,y:t}){yv(n.x,e.translate,e.scale,e.originPoint),yv(n.y,t.translate,t.scale,t.originPoint)}const GS=.999999999999,$S=1.0000000000001;function yV(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let l=0;l<r;l++){s=t[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Gc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,ib(n,o)),i&&ja(s.latestValues)&&Gc(n,s.latestValues))}e.x<$S&&e.x>GS&&(e.x=1),e.y<$S&&e.y>GS&&(e.y=1)}function Wc(n,e){n.min=n.min+e,n.max=n.max+e}function KS(n,e,t,i,r=.5){const s=Nt(n.min,n.max,r);yv(n,e,t,s,i)}function Gc(n,e){KS(n.x,e.x,e.scaleX,e.scale,e.originX),KS(n.y,e.y,e.scaleY,e.scale,e.originY)}function rb(n,e){return tb(pV(n.getBoundingClientRect(),e))}function _V(n,e,t){const i=rb(n,t),{scroll:r}=e;return r&&(Wc(i.x,r.offset.x),Wc(i.y,r.offset.y)),i}const sb=({current:n})=>n?n.ownerDocument.defaultView:null,vV=new WeakMap;class xV{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ut(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(tf(f).point)},s=(f,m)=>{const{drag:y,dragPropagation:x,onDragStart:T}=this.getProps();if(y&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=dO(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ki(S=>{let A=this.getAxisMotionValue(S).get()||0;if(is.test(A)){const{projection:D}=this.visualElement;if(D&&D.layout){const N=D.layout.layoutBox[S];N&&(A=Ci(N)*(parseFloat(A)/100))}}this.originPoint[S]=A}),T&&Tt.postRender(()=>T(f,m)),av(this.visualElement,"transform");const{animationState:I}=this.visualElement;I&&I.setActive("whileDrag",!0)},o=(f,m)=>{const{dragPropagation:y,dragDirectionLock:x,onDirectionLock:T,onDrag:I}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:S}=m;if(x&&this.currentDirection===null){this.currentDirection=wV(S),this.currentDirection!==null&&T&&T(this.currentDirection);return}this.updateAxis("x",m.point,S),this.updateAxis("y",m.point,S),this.visualElement.render(),I&&I(f,m)},l=(f,m)=>this.stop(f,m),u=()=>Ki(f=>{var m;return this.getAnimationState(f)==="paused"&&((m=this.getAxisMotionValue(f).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new ZA(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:sb(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Tt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Lg(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=cV(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&zc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=uV(r.layoutBox,t):this.constraints=!1,this.elastic=gV(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ki(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=fV(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!zc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=_V(i,r.root,this.visualElement.getTransformPagePoint());let o=hV(r.layout.layoutBox,s);if(t){const l=t(mV(o));this.hasMutatedConstraints=!!l,l&&(o=tb(l))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=Ki(f=>{if(!Lg(f,t,this.currentDirection))return;let m=u&&u[f]||{};o&&(m={min:0,max:0});const y=r?200:1e6,x=r?40:1e7,T={type:"inertia",velocity:i?e[f]:0,bounceStiffness:y,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...s,...m};return this.startAxisValueAnimation(f,T)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return av(this.visualElement,e),i.start(a1(e,i,0,t,this.visualElement,!1))}stopAnimation(){Ki(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ki(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Ki(t=>{const{drag:i}=this.getProps();if(!Lg(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[t];s.set(e[t]-Nt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!zc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Ki(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();r[o]=dV({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Ki(o=>{if(!Lg(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(Nt(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;vV.set(this.visualElement,this);const e=this.visualElement.current,t=Zh(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();zc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Tt.read(i);const o=xd(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(Ki(f=>{const m=this.getAxisMotionValue(f);m&&(this.originPoint[f]+=u[f].translate,m.set(m.get()+u[f].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=mv,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function Lg(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function wV(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class EV extends aa{constructor(e){super(e),this.removeGroupControls=Ii,this.removeListeners=Ii,this.controls=new xV(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ii}unmount(){this.removeGroupControls(),this.removeListeners()}}const HS=n=>(e,t)=>{n&&Tt.postRender(()=>n(e,t))};class TV extends aa{constructor(){super(...arguments),this.removePointerDownListener=Ii}onPointerDown(e){this.session=new ZA(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:sb(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:HS(e),onStart:HS(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Tt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Zh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const lm={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function XS(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Ih={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ne.test(n))n=parseFloat(n);else return n;const t=XS(n,e.target.x),i=XS(n,e.target.y);return`${t}% ${i}%`}},SV={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=ta.parse(n);if(r.length>5)return i;const s=ta.createTransformer(n),o=typeof r[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=l,r[1+o]/=u;const h=Nt(l,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class IV extends q.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;$L(CV),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),lm.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Tt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Ox.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function ob(n){const[e,t]=B2(),i=q.useContext(Ax);return _.jsx(IV,{...n,layoutGroup:i,switchLayoutGroup:q.useContext(Y2),isPresent:e,safeToRemove:t})}const CV={borderRadius:{...Ih,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ih,borderTopRightRadius:Ih,borderBottomLeftRadius:Ih,borderBottomRightRadius:Ih,boxShadow:SV};function RV(n,e,t){const i=Ln(n)?n:_d(n);return i.start(a1("",i,e,t)),i.animation}function AV(n){return n instanceof SVGElement&&n.tagName!=="svg"}const bV=(n,e)=>n.depth-e.depth;class PV{constructor(){this.children=[],this.isDirty=!1}add(e){Yx(this.children,e),this.isDirty=!0}remove(e){Zx(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(bV),this.isDirty=!1,this.children.forEach(e)}}function kV(n,e){const t=rs.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(ea(i),n(s-e))};return Tt.read(i,!0),()=>ea(i)}const ab=["TopLeft","TopRight","BottomLeft","BottomRight"],NV=ab.length,qS=n=>typeof n=="string"?parseFloat(n):n,YS=n=>typeof n=="number"||Ne.test(n);function DV(n,e,t,i,r,s){r?(n.opacity=Nt(0,t.opacity!==void 0?t.opacity:1,MV(i)),n.opacityExit=Nt(e.opacity!==void 0?e.opacity:1,0,LV(i))):s&&(n.opacity=Nt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<NV;o++){const l=`border${ab[o]}Radius`;let u=ZS(e,l),h=ZS(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||YS(u)===YS(h)?(n[l]=Math.max(Nt(qS(u),qS(h),i),0),(is.test(h)||is.test(u))&&(n[l]+="%")):n[l]=h}(e.rotate||t.rotate)&&(n.rotate=Nt(e.rotate||0,t.rotate||0,i))}function ZS(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const MV=lb(0,.5,CA),LV=lb(.5,.95,Ii);function lb(n,e,t){return i=>i<n?0:i>e?1:t(nu(n,e,i))}function QS(n,e){n.min=e.min,n.max=e.max}function Gi(n,e){QS(n.x,e.x),QS(n.y,e.y)}function JS(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function eI(n,e,t,i,r){return n-=e,n=km(n,1/t,i),r!==void 0&&(n=km(n,1/r,i)),n}function OV(n,e=0,t=1,i=.5,r,s=n,o=n){if(is.test(e)&&(e=parseFloat(e),e=Nt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=Nt(s.min,s.max,i);n===s&&(l-=e),n.min=eI(n.min,e,t,l,r),n.max=eI(n.max,e,t,l,r)}function tI(n,e,[t,i,r],s,o){OV(n,e[t],e[i],e[r],e.scale,s,o)}const FV=["x","scaleX","originX"],VV=["y","scaleY","originY"];function nI(n,e,t,i){tI(n.x,e,FV,t?t.x:void 0,i?i.x:void 0),tI(n.y,e,VV,t?t.y:void 0,i?i.y:void 0)}function iI(n){return n.translate===0&&n.scale===1}function cb(n){return iI(n.x)&&iI(n.y)}function rI(n,e){return n.min===e.min&&n.max===e.max}function jV(n,e){return rI(n.x,e.x)&&rI(n.y,e.y)}function sI(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function ub(n,e){return sI(n.x,e.x)&&sI(n.y,e.y)}function oI(n){return Ci(n.x)/Ci(n.y)}function aI(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class zV{constructor(){this.members=[]}add(e){Yx(this.members,e),e.scheduleRender()}remove(e){if(Zx(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function UV(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:m,rotateY:y,skewX:x,skewY:T}=t;h&&(i=`perspective(${h}px) ${i}`),f&&(i+=`rotate(${f}deg) `),m&&(i+=`rotateX(${m}deg) `),y&&(i+=`rotateY(${y}deg) `),x&&(i+=`skewX(${x}deg) `),T&&(i+=`skewY(${T}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(i+=`scale(${l}, ${u})`),i||"none"}const za={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},zh=typeof window<"u"&&window.MotionDebug!==void 0,s0=["","X","Y","Z"],BV={visibility:"hidden"},lI=1e3;let WV=0;function o0(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function hb(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=vA(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Tt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&hb(i)}function db({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=e?.()){this.id=WV++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,zh&&(za.totalNodes=za.resolvedTargetDeltas=za.recalculatedProjection=0),this.nodes.forEach(KV),this.nodes.forEach(ZV),this.nodes.forEach(QV),this.nodes.forEach(HV),zh&&window.MotionDebug.record(za)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new PV)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Qx),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=AV(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(h||u)&&(this.isLayoutDirty=!0),n){let m;const y=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=kV(y,250),lm.hasAnimatedSinceResize&&(lm.hasAnimatedSinceResize=!1,this.nodes.forEach(uI))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:y,hasRelativeTargetChanged:x,layout:T})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||f.getDefaultTransition()||i5,{onLayoutAnimationStart:S,onLayoutAnimationComplete:A}=f.getProps(),D=!this.targetLayout||!ub(this.targetLayout,T)||x,N=!y&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||N||y&&(D||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,N);const R={...Kx(I,"layout"),onPlay:S,onComplete:A};(f.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R)}else y||uI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=T})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ea(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(JV),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&hb(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const m=this.path[f];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(cI);return}this.isUpdating||this.nodes.forEach(qV),this.isUpdating=!1,this.nodes.forEach(YV),this.nodes.forEach(GV),this.nodes.forEach($V),this.clearAllSnapshots();const l=rs.now();xn.delta=Ks(0,1e3/60,l-xn.timestamp),xn.timestamp=l,xn.isProcessing=!0,Y_.update.process(xn),Y_.preRender.process(xn),Y_.render.process(xn),xn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Ox.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(XV),this.sharedNodes.forEach(e5)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Tt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Tt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ut(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!cb(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(l||ja(this.latestValues)||f)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),r5(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Ut();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(s5))){const{scroll:f}=this.root;f&&(Wc(u.x,f.offset.x),Wc(u.y,f.offset.y))}return u}removeElementScroll(o){var l;const u=Ut();if(Gi(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:m,options:y}=f;f!==this.root&&m&&y.layoutScroll&&(m.wasRoot&&Gi(u,o),Wc(u.x,m.offset.x),Wc(u.y,m.offset.y))}return u}applyTransform(o,l=!1){const u=Ut();Gi(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Gc(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),ja(f.latestValues)&&Gc(u,f.latestValues)}return ja(this.latestValues)&&Gc(u,this.latestValues),u}removeTransform(o){const l=Ut();Gi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!ja(h.latestValues))continue;pv(h.latestValues)&&h.updateSnapshot();const f=Ut(),m=h.measurePageBox();Gi(f,m),nI(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return ja(this.latestValues)&&nI(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==xn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:y}=this.options;if(!(!this.layout||!(m||y))){if(this.resolvedRelativeTargetAt=xn.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Jh(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),Gi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ut(),this.targetWithTransforms=Ut()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),lV(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Gi(this.target,this.layout.layoutBox),ib(this.target,this.targetDelta)):Gi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ut(),this.relativeTargetOrigin=Ut(),Jh(this.relativeTargetOrigin,this.target,x.target),Gi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}zh&&za.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||pv(this.parent.latestValues)||nb(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===xn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||m))return;Gi(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,x=this.treeScale.y;yV(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ut());const{target:T}=l;if(!T){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(JS(this.prevProjectionDelta.x,this.projectionDelta.x),JS(this.prevProjectionDelta.y,this.projectionDelta.y)),Qh(this.projectionDelta,this.layoutCorrected,T,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==x||!aI(this.projectionDelta.x,this.prevProjectionDelta.x)||!aI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",T)),zh&&za.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Bc(),this.projectionDelta=Bc(),this.projectionDeltaWithTransform=Bc()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},m=Bc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const y=Ut(),x=u?u.source:void 0,T=this.layout?this.layout.source:void 0,I=x!==T,S=this.getStack(),A=!S||S.members.length<=1,D=!!(I&&!A&&this.options.crossfade===!0&&!this.path.some(n5));this.animationProgress=0;let N;this.mixTargetDelta=R=>{const L=R/1e3;hI(m.x,o.x,L),hI(m.y,o.y,L),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Jh(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),t5(this.relativeTarget,this.relativeTargetOrigin,y,L),N&&jV(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=Ut()),Gi(N,this.relativeTarget)),I&&(this.animationValues=f,DV(f,h,this.latestValues,L,D,A)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=L},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ea(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Tt.update(()=>{lm.hasAnimatedSinceResize=!0,this.currentAnimation=RV(0,lI,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(lI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:f}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&fb(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Ut();const m=Ci(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+m;const y=Ci(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+y}Gi(l,u),Gc(l,f),Qh(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new zV),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&o0("z",o,h,this.animationValues);for(let f=0;f<s0.length;f++)o0(`rotate${s0[f]}`,o,h,this.animationValues),o0(`skew${s0[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return BV;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=om(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const I={};return this.options.layoutId&&(I.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,I.pointerEvents=om(o?.pointerEvents)||""),this.hasProjected&&!ja(this.latestValues)&&(I.transform=f?f({},""):"none",this.hasProjected=!1),I}const y=m.animationValues||m.latestValues;this.applyTransformsToTarget(),h.transform=UV(this.projectionDeltaWithTransform,this.treeScale,y),f&&(h.transform=f(y,h.transform));const{x,y:T}=this.projectionDelta;h.transformOrigin=`${x.origin*100}% ${T.origin*100}% 0`,m.animationValues?h.opacity=m===this?(u=(l=y.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:h.opacity=m===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const I in Cm){if(y[I]===void 0)continue;const{correct:S,applyTo:A}=Cm[I],D=h.transform==="none"?y[I]:S(y[I],m);if(A){const N=A.length;for(let R=0;R<N;R++)h[A[R]]=D}else h[I]=D}return this.options.layoutId&&(h.pointerEvents=m===this?om(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(cI),this.root.sharedNodes.clear()}}}function GV(n){n.updateLayout()}function $V(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?Ki(m=>{const y=o?t.measuredBox[m]:t.layoutBox[m],x=Ci(y);y.min=i[m].min,y.max=y.min+x}):fb(s,t.layoutBox,i)&&Ki(m=>{const y=o?t.measuredBox[m]:t.layoutBox[m],x=Ci(i[m]);y.max=y.min+x,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[m].max=n.relativeTarget[m].min+x)});const l=Bc();Qh(l,i,t.layoutBox);const u=Bc();o?Qh(u,n.applyTransform(r,!0),t.measuredBox):Qh(u,i,t.layoutBox);const h=!cb(l);let f=!1;if(!n.resumeFrom){const m=n.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:y,layout:x}=m;if(y&&x){const T=Ut();Jh(T,t.layoutBox,y.layoutBox);const I=Ut();Jh(I,i,x.layoutBox),ub(T,I)||(f=!0),m.options.layoutRoot&&(n.relativeTarget=I,n.relativeTargetOrigin=T,n.relativeParent=m)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function KV(n){zh&&za.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function HV(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function XV(n){n.clearSnapshot()}function cI(n){n.clearMeasurements()}function qV(n){n.isLayoutDirty=!1}function YV(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function uI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function ZV(n){n.resolveTargetDelta()}function QV(n){n.calcProjection()}function JV(n){n.resetSkewAndRotation()}function e5(n){n.removeLeadSnapshot()}function hI(n,e,t){n.translate=Nt(e.translate,0,t),n.scale=Nt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function dI(n,e,t,i){n.min=Nt(e.min,t.min,i),n.max=Nt(e.max,t.max,i)}function t5(n,e,t,i){dI(n.x,e.x,t.x,i),dI(n.y,e.y,t.y,i)}function n5(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const i5={duration:.45,ease:[.4,0,.1,1]},fI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),gI=fI("applewebkit/")&&!fI("chrome/")?Math.round:Ii;function mI(n){n.min=gI(n.min),n.max=gI(n.max)}function r5(n){mI(n.x),mI(n.y)}function fb(n,e,t){return n==="position"||n==="preserve-aspect"&&!aV(oI(e),oI(t),.2)}function s5(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const o5=db({attachResizeListener:(n,e)=>xd(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),a0={current:void 0},gb=db({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!a0.current){const n=new o5({});n.mount(window),n.setOptions({layoutScroll:!0}),a0.current=n}return a0.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),a5={pan:{Feature:TV},drag:{Feature:EV,ProjectionNode:gb,MeasureLayout:ob}};function pI(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Tt.postRender(()=>s(e,tf(e)))}class l5 extends aa{mount(){const{current:e}=this.node;e&&(this.unmount=aO(e,t=>(pI(this.node,t,"Start"),i=>pI(this.node,i,"End"))))}unmount(){}}class c5 extends aa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ef(xd(this.node.current,"focus",()=>this.onFocus()),xd(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function yI(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Tt.postRender(()=>s(e,tf(e)))}class u5 extends aa{mount(){const{current:e}=this.node;e&&(this.unmount=hO(e,t=>(yI(this.node,t,"Start"),(i,{success:r})=>yI(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const _v=new WeakMap,l0=new WeakMap,h5=n=>{const e=_v.get(n.target);e&&e(n)},d5=n=>{n.forEach(h5)};function f5({root:n,...e}){const t=n||document;l0.has(t)||l0.set(t,{});const i=l0.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(d5,{root:n,...e})),i[r]}function g5(n,e,t){const i=f5(e);return _v.set(n,t),i.observe(n),()=>{_v.delete(n),i.unobserve(n)}}const m5={some:0,all:1};class p5 extends aa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:m5[r]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:m}=this.node.getProps(),y=h?f:m;y&&y(u)};return g5(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(y5(e,t))&&this.startObserver()}unmount(){}}function y5({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const _5={inView:{Feature:p5},tap:{Feature:u5},focus:{Feature:c5},hover:{Feature:l5}},v5={layout:{ProjectionNode:gb,MeasureLayout:ob}},vv={current:null},mb={current:!1};function x5(){if(mb.current=!0,!!kx)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>vv.current=n.matches;n.addListener(e),e()}else vv.current=!1}const w5=[...zA,Dn,ta],E5=n=>w5.find(jA(n)),_I=new WeakMap;function T5(n,e,t){for(const i in e){const r=e[i],s=t[i];if(Ln(r))n.addValue(i,r);else if(Ln(s))n.addValue(i,_d(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,_d(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const vI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class S5{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=r1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=rs.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,Tt.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!s,this.isControllingVariants=Cp(t),this.isVariantNode=X2(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:m,...y}=this.scrapeMotionValuesFromProps(t,{},this);for(const x in y){const T=y[x];u[x]!==void 0&&Ln(T)&&T.set(u[x],!1)}}mount(e){this.current=e,_I.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),mb.current||x5(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:vv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){_I.delete(this.current),this.projection&&this.projection.unmount(),ea(this.notifyUpdate),ea(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Pl.has(e),r=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Tt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in iu){const t=iu[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ut()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<vI.length;i++){const r=vI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=T5(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=_d(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(FA(r)||AA(r))?r=parseFloat(r):!E5(r)&&ta.test(t)&&(r=MA(e,t)),this.setBaseTarget(e,Ln(r)?r.get():r)),Ln(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=Vx(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ln(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new Qx),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class pb extends S5{constructor(){super(...arguments),this.KeyframeResolver=UA}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ln(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function I5(n){return window.getComputedStyle(n)}class C5 extends pb{constructor(){super(...arguments),this.type="html",this.renderInstance=iA}readValueFromInstance(e,t){if(Pl.has(t)){const i=i1(t);return i&&i.default||0}else{const i=I5(e),r=(eA(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return rb(e,t)}build(e,t,i){Ux(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return $x(e,t,i)}}class R5 extends pb{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ut}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Pl.has(t)){const i=i1(t);return i&&i.default||0}return t=rA.has(t)?t:Lx(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return aA(e,t,i)}build(e,t,i){Bx(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){sA(e,t,i,r)}mount(e){this.isSVGTag=Gx(e.tagName),super.mount(e)}}const A5=(n,e)=>Fx(n)?new R5(e):new C5(e,{allowProjection:n!==q.Fragment}),b5=eO({...QF,..._5,...a5,...v5},A5),Ve=mL(b5),ei={ADD:"add",REMOVE:"remove"},su={PROPERTYCHANGE:"propertychange"},We={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class bp{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function P5(n,e,t){let i,r;t=t||Bs;let s=0,o=n.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}function Bs(n,e){return n>e?1:n<e?-1:0}function k5(n,e){return n<e?1:n>e?-1:0}function l1(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function N5(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function c1(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function la(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function D5(n,e,t){const i=e||Bs;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function wd(){return!0}function Pp(){return!1}function Ed(){}function yb(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!la(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function M5(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function nf(n){for(const e in n)delete n[e]}function ou(n){let e;for(e in n)return!1;return!e}class Zs{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class kp extends bp{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Zs(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let u;for(let h=0,f=r.length;h<f;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=l[i];for(delete l[i];h--;)this.removeEventListener(i,Ed);delete o[i]}return u}disposeInternal(){this.listeners_&&nf(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=Ed,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function nt(n,e,t,i,r){if(r){const o=t;t=function(l){return n.removeEventListener(e,t),o.call(i??this,l)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Nm(n,e,t,i){return nt(n,e,t,i,!0)}function At(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),nf(n))}class rf extends kp{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(We.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=nt(this,e[s],t);return r}return nt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Nm(this,e[s],t)}else i=Nm(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)L5(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}rf.prototype.on;rf.prototype.once;rf.prototype.un;function L5(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)At(n[e]);else At(n)}function tt(){throw new Error("Unimplemented abstract method.")}let O5=0;function it(n){return n.ol_uid||(n.ol_uid=String(++O5))}class xI extends Zs{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class us extends rf{constructor(e){super(),this.on,this.once,this.un,it(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new xI(i,e,t)),i=su.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new xI(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],ou(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const wI={LENGTH:"length"};class Og extends Zs{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Xi extends us{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(wI.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Og(ei.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Og(ei.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Og(ei.REMOVE,r,e)),this.dispatchEvent(new Og(ei.ADD,t,e))}updateLength_(){this.set(wI.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function lt(n,e){if(!n)throw new Error(e)}class au extends us{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new au(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(At(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=nt(e,We.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?F5(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function F5(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(lt(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const ln={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function EI(n){const e=Ji();for(let t=0,i=n.length;t<i;++t)ed(e,n[t]);return e}function u1(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function _b(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function vb(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function lu(n,e){return xb(n,e[0],e[1])}function Uh(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function xb(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function xv(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],l=e[1];let u=ln.UNKNOWN;return o<t?u=u|ln.LEFT:o>r&&(u=u|ln.RIGHT),l<i?u=u|ln.BELOW:l>s&&(u=u|ln.ABOVE),u===ln.UNKNOWN&&(u=ln.INTERSECTING),u}function Ji(){return[1/0,1/0,-1/0,-1/0]}function na(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function Np(n){return na(1/0,1/0,-1/0,-1/0,n)}function wb(n,e){const t=n[0],i=n[1];return na(t,i,t,i,e)}function h1(n,e,t,i,r){const s=Np(r);return Eb(s,n,e,t,i)}function Td(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function V5(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function ed(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function Eb(n,e,t,i,r){for(;t<i;t+=r)j5(n,e[t],e[t+1]);return n}function j5(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function Tb(n,e){let t;return t=e(Dp(n)),t||(t=e(Mp(n)),t)||(t=e(Lp(n)),t)||(t=e(kl(n)),t)?t:!1}function wv(n){let e=0;return Op(n)||(e=ft(n)*Bn(n)),e}function Dp(n){return[n[0],n[1]]}function Mp(n){return[n[2],n[1]]}function gl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function z5(n,e){let t;if(e==="bottom-left")t=Dp(n);else if(e==="bottom-right")t=Mp(n);else if(e==="top-left")t=kl(n);else if(e==="top-right")t=Lp(n);else throw new Error("Invalid corner");return t}function Ev(n,e,t,i,r){const[s,o,l,u,h,f,m,y]=Sb(n,e,t,i);return na(Math.min(s,l,h,m),Math.min(o,u,f,y),Math.max(s,l,h,m),Math.max(o,u,f,y),r)}function Sb(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),l=Math.sin(t),u=r*o,h=r*l,f=s*o,m=s*l,y=n[0],x=n[1];return[y-u+m,x-h-f,y-u-m,x-h+f,y+u-m,x+h+f,y+u+m,x+h-f,y-u+m,x-h-f]}function Bn(n){return n[3]-n[1]}function ol(n,e,t){const i=t||Ji();return si(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):Np(i),i}function kl(n){return[n[0],n[3]]}function Lp(n){return[n[2],n[3]]}function ft(n){return n[2]-n[0]}function si(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Op(n){return n[2]<n[0]||n[3]<n[1]}function U5(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function B5(n,e,t){let i=!1;const r=xv(n,e),s=xv(n,t);if(r===ln.INTERSECTING||s===ln.INTERSECTING)i=!0;else{const o=n[0],l=n[1],u=n[2],h=n[3],f=e[0],m=e[1],y=t[0],x=t[1],T=(x-m)/(y-f);let I,S;s&ln.ABOVE&&!(r&ln.ABOVE)&&(I=y-(x-h)/T,i=I>=o&&I<=u),!i&&s&ln.RIGHT&&!(r&ln.RIGHT)&&(S=x-(y-u)*T,i=S>=l&&S<=h),!i&&s&ln.BELOW&&!(r&ln.BELOW)&&(I=y-(x-l)/T,i=I>=o&&I<=u),!i&&s&ln.LEFT&&!(r&ln.LEFT)&&(S=x-(y-o)*T,i=S>=l&&S<=h)}return i}function Ib(n,e){const t=e.getExtent(),i=gl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=ft(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function Cb(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];Ib(n,e);const r=ft(i);if(ft(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Dt(n,e,t){return Math.min(Math.max(n,e),t)}function W5(n,e,t,i,r,s){const o=r-t,l=s-i;if(o!==0||l!==0){const u=((n-t)*o+(e-i)*l)/(o*o+l*l);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=l*u)}return Xc(n,e,t,i)}function Xc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function G5(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let l=i+1;l<e;l++){const u=Math.abs(n[l][i]);u>s&&(s=u,r=l)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let l=i+1;l<e;l++){const u=-n[l][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[l][h]=0:n[l][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function TI(n){return n*180/Math.PI}function Xo(n){return n*Math.PI/180}function al(n,e){const t=n%e;return t*e<0?t+e:t}function Ei(n,e,t){return n+t*(e-n)}function sf(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function SX(n,e){return Math.round(sf(n,e))}function Fg(n,e){return Math.floor(sf(n,e))}function Vg(n,e){return Math.ceil(sf(n,e))}function Tv(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function $5(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Dm(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function d1(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function K5(n,e){return n[0]*=e,n[1]*=e,n}function Rb(n,e){if(e.canWrapX()){const t=ft(e.getExtent()),i=H5(n,e,t);i&&(n[0]-=i*t)}return n}function H5(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||ft(i),r=Math.floor((n[0]-i[0])/t)),r}function Ab(...n){console.warn(...n)}const cu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class f1{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||cu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const of=6378137,$c=Math.PI*of,X5=[-$c,-$c,$c,$c],q5=[-180,-85,180,85],jg=of*Math.log(Math.tan(Math.PI/2));class vc extends f1{constructor(e){super({code:e,units:"m",extent:X5,global:!0,worldExtent:q5,getPointResolution:function(t,i){return t/Math.cosh(i[1]/of)}})}}const SI=[new vc("EPSG:3857"),new vc("EPSG:102100"),new vc("EPSG:102113"),new vc("EPSG:900913"),new vc("http://www.opengis.net/def/crs/EPSG/0/3857"),new vc("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Y5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=$c*n[s]/180;let o=of*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>jg?o=jg:o<-jg&&(o=-jg),e[s+1]=o}return e}function Z5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/$c,e[s+1]=360*Math.atan(Math.exp(n[s+1]/of))/Math.PI-90;return e}const Q5=6378137,II=[-180,-90,180,90],J5=Math.PI*Q5/180;class Oa extends f1{constructor(e,t){super({code:e,units:"degrees",extent:II,axisOrientation:t,global:!0,metersPerUnit:J5,worldExtent:II})}}const CI=[new Oa("CRS:84"),new Oa("EPSG:4326","neu"),new Oa("urn:ogc:def:crs:OGC:1.3:CRS84"),new Oa("urn:ogc:def:crs:OGC:2:84"),new Oa("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Oa("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Oa("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Sv={};function ej(n){return Sv[n]||Sv[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function tj(n,e){Sv[n]=e}let qc={};function Sd(n,e,t){const i=n.getCode(),r=e.getCode();i in qc||(qc[i]={}),qc[i][r]=t}function c0(n,e){return n in qc&&e in qc[n]?qc[n][e]:null}const Mm=.9996,Zi=.00669438,Fp=Zi*Zi,Vp=Fp*Zi,Qa=Zi/(1-Zi),RI=Math.sqrt(1-Zi),uu=(1-RI)/(1+RI),bb=uu*uu,g1=bb*uu,m1=g1*uu,Pb=m1*uu,kb=1-Zi/4-3*Fp/64-5*Vp/256,nj=3*Zi/8+3*Fp/32+45*Vp/1024,ij=15*Fp/256+45*Vp/1024,rj=35*Vp/3072,sj=3/2*uu-27/32*g1+269/512*Pb,oj=21/16*bb-55/32*m1,aj=151/96*g1-417/128*Pb,lj=1097/512*m1,Lm=6378137;function cj(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/Mm/(Lm*kb),l=o+sj*Math.sin(2*o)+oj*Math.sin(4*o)+aj*Math.sin(6*o)+lj*Math.sin(8*o),u=Math.sin(l),h=u*u,f=Math.cos(l),m=u/f,y=m*m,x=y*y,T=1-Zi*h,I=Math.sqrt(1-Zi*h),S=Lm/I,A=(1-Zi)/T,D=Qa*f**2,N=D*D,R=i/(S*Mm),L=R*R,j=L*R,k=j*R,b=k*R,M=b*R,V=l-m/A*(L/2-k/24*(5+3*y+10*D-4*N-9*Qa))+M/720*(61+90*y+298*D+45*x-252*Qa-3*N);let z=(R-j/6*(1+2*y+D)+b/120*(5-2*D+28*y-3*N+8*Qa+24*x))/f;return z=Tv(z+Xo(Nb(t.number)),-Math.PI,Math.PI),[TI(z),TI(V)]}const AI=-80,bI=84,uj=-180,hj=180;function dj(n,e,t){n=Tv(n,uj,hj),e<AI?e=AI:e>bI&&(e=bI);const i=Xo(e),r=Math.sin(i),s=Math.cos(i),o=r/s,l=o*o,u=l*l,h=Xo(n),f=Nb(t.number),m=Xo(f),y=Lm/Math.sqrt(1-Zi*r**2),x=Qa*s**2,T=s*Tv(h-m,-Math.PI,Math.PI),I=T*T,S=I*T,A=S*T,D=A*T,N=D*T,R=Lm*(kb*i-nj*Math.sin(2*i)+ij*Math.sin(4*i)-rj*Math.sin(6*i)),L=Mm*y*(T+S/6*(1-l+x)+D/120*(5-18*l+u+72*x-58*Qa))+5e5;let j=Mm*(R+y*o*(I/2+A/24*(5-l+9*x+4*x**2)+N/720*(61-58*l+u+600*x-330*Qa)));return t.north||(j+=1e7),[L,j]}function Nb(n){return(n-1)*6-180+3}const fj=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function Db(n){let e=0;for(const r of fj){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function PI(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let l=0;l<o;l+=s){const u=t[l],h=t[l+1],f=n(u,h,e);i[l]=f[0],i[l+1]=f[1]}return i}}function gj(n){return Db(n)?new f1({code:n,units:"m"}):null}function mj(n){const e=Db(n.getCode());return e?{forward:PI(dj,e),inverse:PI(cj,e)}:null}const pj=63710088e-1;function kI(n,e,t){t=t||pj;const i=Xo(n[1]),r=Xo(e[1]),s=(r-i)/2,o=Xo(e[0]-n[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}const yj=[mj],_j=[gj];let Iv=!0;function Mb(n){Iv=!1}function p1(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function Cv(n){tj(n.getCode(),n),Sd(n,n,p1)}function vj(n){n.forEach(Cv)}function ci(n){if(typeof n!="string")return n;const e=ej(n);if(e)return e;for(const t of _j){const i=t(n);if(i)return i}return null}function Om(n,e,t,i){n=ci(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/cu[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const l=_1(n,ci("EPSG:4326"));if(!l&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=l(h,h,2);const f=kI(h.slice(0,2),h.slice(2,4)),m=kI(h.slice(4,6),h.slice(6,8));r=(f+m)/2}const u=i?cu[i]:n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function NI(n){vj(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Sd(e,t,p1)})})}function xj(n,e,t,i){n.forEach(function(r){e.forEach(function(s){Sd(r,s,t),Sd(s,r,i)})})}function y1(n,e){return n?typeof n=="string"?ci(n):n:ci(e)}function wj(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const l=n(e.slice(o,o+i)),u=l.length;for(let h=0,f=r;h<f;++h)t[o+h]=h>=u?e[o+h]:l[h]}return t})}function ml(n,e){return Mb(),jp(n,"EPSG:4326","EPSG:3857")}function DI(n,e){const t=jp(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=al(i+180,360)-180),t}function cm(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||_1(n,e)===p1)&&t}function _1(n,e){const t=n.getCode(),i=e.getCode();let r=c0(t,i);if(r)return r;let s=null,o=null;for(const u of yj)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const l="EPSG:4326";if(o)if(s)r=u0(s.inverse,o.forward);else{const u=c0(t,l);u&&(r=u0(u,o.forward))}else{const u=c0(l,i);u&&(r=u0(s.inverse,u))}return r&&(Cv(n),Cv(e),Sd(n,e,r)),r}function u0(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Fm(n,e){const t=ci(n),i=ci(e);return _1(t,i)}function jp(n,e,t){const i=Fm(e,t);if(!i){const r=ci(e).getCode(),s=ci(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Rv(n,e){return n}function Ds(n,e){return Iv&&!Dm(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Iv=!1,Ab("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function Lb(n,e){return n}function Go(n,e){return n}function Ej(){NI(SI),NI(CI),xj(CI,SI,Y5,Z5)}Ej();new Array(6);function Er(){return[1,0,0,1,0,0]}function Tj(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function un(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Hs(n,e,t,i,r,s,o,l){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-l*i*u+e,n[5]=o*r*u+l*r*h+t,n}function Ob(n,e){const t=Sj(e);lt(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],l=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*l)/t,n[5]=-(i*u-r*l)/t,n}function Sj(n){return n[0]*n[3]-n[1]*n[2]}const Ij=[1e5,1e5,1e5,1e5,2,2];function Cj(n){return"matrix("+n.join(", ")+")"}function Av(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function Rj(n,e){const t=Av(n),i=Av(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*Ij[r])!==0)return!1;return!0}function qo(n,e,t,i,r,s,o){s=s||[],o=o||2;let l=0;for(let u=e;u<t;u+=i){const h=n[u],f=n[u+1];s[l++]=r[0]*h+r[2]*f+r[4],s[l++]=r[1]*h+r[3]*f+r[5];for(let m=2;m<o;m++)s[l++]=n[u+m]}return s&&s.length!=l&&(s.length=l),s}function Fb(n,e,t,i,r,s,o){o=o||[];const l=Math.cos(r),u=Math.sin(r),h=s[0],f=s[1];let m=0;for(let y=e;y<t;y+=i){const x=n[y]-h,T=n[y+1]-f;o[m++]=h+x*l-T*u,o[m++]=f+x*u+T*l;for(let I=y+2;I<y+i;++I)o[m++]=n[I]}return o&&o.length!=m&&(o.length=m),o}function Aj(n,e,t,i,r,s,o,l){l=l||[];const u=o[0],h=o[1];let f=0;for(let m=e;m<t;m+=i){const y=n[m]-u,x=n[m+1]-h;l[f++]=u+r*y,l[f++]=h+s*x;for(let T=m+2;T<m+i;++T)l[f++]=n[T]}return l&&l.length!=f&&(l.length=f),l}function bj(n,e,t,i,r,s,o){o=o||[];let l=0;for(let u=e;u<t;u+=i){o[l++]=n[u]+r,o[l++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[l++]=n[h]}return o&&o.length!=l&&(o.length=l),o}const MI=Er(),Pj=[NaN,NaN];class kj extends us{constructor(){super(),this.extent_=Ji(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=yb((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return tt()}closestPointXY(e,t,i,r){return tt()}containsXY(e,t){return this.closestPointXY(e,t,Pj,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return tt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Np(t),this.extentRevision_=this.getRevision()}return U5(this.extent_,e)}rotate(e,t){tt()}scale(e,t,i){tt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return tt()}getType(){return tt()}applyTransform(e){tt()}intersectsExtent(e){return tt()}translate(e,t){tt()}transform(e,t){const i=ci(e),r=i.getUnits()=="tile-pixels"?function(s,o,l){const u=i.getExtent(),h=i.getWorldExtent(),f=Bn(h)/Bn(u);Hs(MI,h[0],h[3],f,-f,0,0,0);const m=qo(s,0,s.length,l,MI,o),y=Fm(i,t);return y?y(m,m,l):m}:Fm(i,t);return this.applyTransform(r),this}}class v1 extends kj{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return h1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return tt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=LI(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){tt()}setLayout(e,t,i){let r;if(e)r=LI(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=Nj(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Fb(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=gl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Aj(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();bj(i,0,i.length,r,e,t,i),this.changed()}}}function Nj(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function LI(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function Dj(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return qo(i,0,i.length,r,e,t)}function OI(n,e,t,i,r,s,o){const l=n[e],u=n[e+1],h=n[t]-l,f=n[t+1]-u;let m;if(h===0&&f===0)m=e;else{const y=((r-l)*h+(s-u)*f)/(h*h+f*f);if(y>1)m=t;else if(y>0){for(let x=0;x<i;++x)o[x]=Ei(n[e+x],n[t+x],y);o.length=i;return}else m=e}for(let y=0;y<i;++y)o[y]=n[m+y];o.length=i}function Vb(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const l=n[e],u=n[e+1],h=Xc(s,o,l,u);h>r&&(r=h),s=l,o=u}return r}function jb(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=Vb(n,e,l,i,r),e=l}return r}function IX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];r=jb(n,e,l,i,r),e=l[l.length-1]}return r}function zb(n,e,t,i,r,s,o,l,u,h,f){if(e==t)return h;let m,y;if(r===0){if(y=Xc(o,l,n[e],n[e+1]),y<h){for(m=0;m<i;++m)u[m]=n[e+m];return u.length=i,y}return h}f=f||[NaN,NaN];let x=e+i;for(;x<t;)if(OI(n,x-i,x,i,o,l,f),y=Xc(o,l,f[0],f[1]),y<h){for(h=y,m=0;m<i;++m)u[m]=f[m];u.length=i,x+=i}else x+=i*Math.max((Math.sqrt(y)-Math.sqrt(h))/r|0,1);if(s&&(OI(n,t-i,e,i,o,l,f),y=Xc(o,l,f[0],f[1]),y<h)){for(h=y,m=0;m<i;++m)u[m]=f[m];u.length=i}return h}function Ub(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let m=0,y=t.length;m<y;++m){const x=t[m];h=zb(n,e,x,i,r,s,o,l,u,h,f),e=x}return h}function CX(n,e,t,i,r,s,o,l,u,h,f){f=f||[NaN,NaN];for(let m=0,y=t.length;m<y;++m){const x=t[m];h=Ub(n,e,x,i,r,s,o,l,u,h,f),e=x[x.length-1]}return h}function Mj(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function Bb(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let l=0;l<i;++l)n[e++]=o[l]}return e}function Wb(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=Bb(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function RX(n,e,t,i,r){r=r||[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=Wb(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function Kc(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Vm(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=Kc(n,e,u,i,r[s]),e=u}return r.length=s,r}function FI(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,l=t.length;o<l;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:Vm(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function VI(n,e,t,i,r,s,o){let l,u;const h=(t-e)/i;if(h===1)l=e;else if(h===2)l=e,u=r;else if(h!==0){let f=n[e],m=n[e+1],y=0;const x=[0];for(let S=e+i;S<t;S+=i){const A=n[S],D=n[S+1];y+=Math.sqrt((A-f)*(A-f)+(D-m)*(D-m)),x.push(y),f=A,m=D}const T=r*y,I=P5(x,T);I<0?(u=(T-x[-I-2])/(x[-I-1]-x[-I-2]),l=e+(-I-2)*i):l=e+I*i}o=o>1?o:2,s=s||new Array(o);for(let f=0;f<o;++f)s[f]=l===void 0?NaN:u===void 0?n[l+f]:Ei(n[l+f],n[l+i+f],u);return s}function jI(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let l=e/i,u=t/i;for(;l<u;){const y=l+u>>1;r<n[(y+1)*i-1]?u=y:l=y+1}const h=n[l*i-1];if(r==h)return n.slice((l-1)*i,(l-1)*i+i);const f=n[(l+1)*i-1],m=(r-h)/(f-h);o=[];for(let y=0;y<i-1;++y)o.push(Ei(n[(l-1)*i+y],n[l*i+y],m));return o.push(r),o}function AX(n,e,t,i,r,s,o){if(o)return jI(n,e,t[t.length-1],i,r,s);let l;if(r<n[i-1])return s?(l=n.slice(0,i),l[i-1]=r,l):null;if(n[n.length-1]<r)return s?(l=n.slice(n.length-i),l[i-1]=r,l):null;for(let u=0,h=t.length;u<h;++u){const f=t[u];if(e!=f){if(r<n[e+i-1])return null;if(r<=n[f-1])return jI(n,e,f,i,r,!1);e=f}}return null}function Lj(n,e,t,i,r){return!Tb(r,function(o){return!Ja(n,e,t,i,o[0],o[1])})}function Ja(n,e,t,i,r,s){let o=0,l=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],f=n[e+1];u<=s?f>s&&(h-l)*(s-u)-(r-l)*(f-u)>0&&o++:f<=s&&(h-l)*(s-u)-(r-l)*(f-u)<0&&o--,l=h,u=f}return o!==0}function x1(n,e,t,i,r,s){if(t.length===0||!Ja(n,e,t[0],i,r,s))return!1;for(let o=1,l=t.length;o<l;++o)if(Ja(n,t[o-1],t[o],i,r,s))return!1;return!0}function bX(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,l=t.length;o<l;++o){const u=t[o];if(x1(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function Oj(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function w1(n,e,t,i,r,s){return s=s??Eb(Ji(),n,e,t,i),si(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:Oj(n,e,t,i,function(o,l){return B5(r,o,l)}):!1}function PX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(w1(n,e,t[s],i,r))return!0;e=t[s]}return!1}function Gb(n,e,t,i,r){return!!(w1(n,e,t,i,r)||Ja(n,e,t,i,r[0],r[1])||Ja(n,e,t,i,r[0],r[3])||Ja(n,e,t,i,r[2],r[1])||Ja(n,e,t,i,r[2],r[3]))}function $b(n,e,t,i,r){if(!Gb(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(Lj(n,t[s-1],t[s],i,r)&&!w1(n,t[s-1],t[s],i,r))return!1;return!0}function kX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if($b(n,e,l,i,r))return!0;e=l[l.length-1]}return!1}function Fj(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let l=e+i;l<t;l+=i){const u=n[l],h=n[l+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function E1(n,e,t,i,r,s,o){const l=(t-e)/i;if(l<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(l);u[0]=1,u[l-1]=1;const h=[e,t-i];let f=0;for(;h.length>0;){const m=h.pop(),y=h.pop();let x=0;const T=n[y],I=n[y+1],S=n[m],A=n[m+1];for(let D=y+i;D<m;D+=i){const N=n[D],R=n[D+1],L=W5(N,R,T,I,S,A);L>x&&(f=D,x=L)}x>r&&(u[(f-e)/i]=1,y+i<f&&h.push(y,f),f+i<m&&h.push(f,m))}for(let m=0;m<l;++m)u[m]&&(s[o++]=n[e+m*i],s[o++]=n[e+m*i+1]);return o}function Vj(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=E1(n,e,f,i,r,s,o),l.push(o),e=f}return o}function Ua(n,e){return e*Math.round(n/e)}function jj(n,e,t,i,r,s,o){if(e==t)return o;let l=Ua(n[e],r),u=Ua(n[e+1],r);e+=i,s[o++]=l,s[o++]=u;let h,f;do if(h=Ua(n[e],r),f=Ua(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=f,o;while(h==l&&f==u);for(;e<t;){const m=Ua(n[e],r),y=Ua(n[e+1],r);if(e+=i,m==h&&y==f)continue;const x=h-l,T=f-u,I=m-l,S=y-u;if(x*S==T*I&&(x<0&&I<x||x==I||x>0&&I>x)&&(T<0&&S<T||T==S||T>0&&S>T)){h=m,f=y;continue}s[o++]=h,s[o++]=f,l=h,u=f,h=m,f=y}return s[o++]=h,s[o++]=f,o}function T1(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u];o=jj(n,e,f,i,r,s,o),l.push(o),e=f}return o}function NX(n,e,t,i,r,s,o,l){for(let u=0,h=t.length;u<h;++u){const f=t[u],m=[];o=T1(n,e,f,i,r,s,o,m),l.push(m),e=f[f.length-1]}return o}class pl extends v1{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new pl(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Xc(e,t,s[0],s[1]);if(o<r){const l=this.stride;for(let u=0;u<l;++u)i[u]=s[u];return i.length=l,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return wb(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return xb(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Mj(this.flatCoordinates,0,e,this.stride),this.changed()}}const qi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},yl=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",zj=yl.includes("safari")&&!yl.includes("chrom");zj&&(yl.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(yl));const Uj=yl.includes("webkit")&&!yl.includes("edge"),Kb=yl.includes("macintosh"),Bj=typeof devicePixelRatio<"u"?devicePixelRatio:1,Si=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Hb=typeof Image<"u"&&Image.prototype.decode,Xb=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),Be={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Jt(n,e,t,i){let r;return t&&t.length?r=t.shift():Si?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let h0;function jm(){return h0||(h0=Jt(1,1)),h0}function zp(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function zI(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function Wj(n){for(;n.lastChild;)n.lastChild.remove()}function Gj(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function qb(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function $o(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const S1=[NaN,NaN,NaN,0];let d0;function $j(){return d0||(d0=Jt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),d0}const Kj=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Hj=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Xj=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,qj=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function zg(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function td(n){throw new Error('failed to parse "'+n+'" as color')}function Yb(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(Hj)||n.match(Kj)||n.match(Xj);if(s){const o=s[4],l=100/255;return[Dt(zg(s[1],l)+.5|0,0,255),Dt(zg(s[2],l)+.5|0,0,255),Dt(zg(s[3],l)+.5|0,0,255),o!==void 0?Dt(zg(o,100),0,1):1]}td(n)}if(n.startsWith("#")){if(qj.test(n)){const s=n.substring(1),o=s.length<=4?1:2,l=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let f=parseInt(s.substring(u,u+o),16);o===1&&(f+=f<<4),l[u/o]=f}return l[3]=l[3]/255,l}td(n)}const e=$j();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&td(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Yb(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=sf(r[3]/255,3),r}function Yj(n){return typeof n=="string"?n:C1(n)}const Zj=1024,Ch={};let f0=0;function Qj(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function g0(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function m0(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function p0(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function y0(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function UI(n){const e=p0(n[0]),t=p0(n[1]),i=p0(n[2]),r=y0(e*.222488403+t*.716873169+i*.06060791),s=500*(y0(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-y0(e*.016863605+t*.117638439+i*.865350722)),l=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),l<0?l+360:l,n[3]]}function Jj(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=m0(e),s=m0(e+t/500*Math.cos(i)),o=m0(e-t/200*Math.sin(i)),l=g0(s*3.021973625-r*1.617392459-o*.404875592),u=g0(s*-.943766287+r*1.916279586+o*.027607165),h=g0(s*.069407491-r*.22898585+o*1.159737864);return[Dt(l+.5|0,0,255),Dt(u+.5|0,0,255),Dt(h+.5|0,0,255),n[3]]}function I1(n){if(n==="none")return S1;if(Ch.hasOwnProperty(n))return Ch[n];if(f0>=Zj){let t=0;for(const i in Ch)(t++&3)===0&&(delete Ch[i],--f0)}const e=Yb(n);e.length!==4&&td(n);for(const t of e)isNaN(t)&&td(n);return Ch[n]=e,++f0,e}function hu(n){return Array.isArray(n)?n:I1(n)}function C1(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}function e4(n,e,t){const i=n;let r=!0,s=!1,o=!1;const l=[Nm(i,We.LOAD,function(){o=!0,s||e()})];return i.src&&Hb?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):l.push(Nm(i,We.ERROR,t)),function(){r=!1,l.forEach(At)}}function t4(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function n4(n,e){return e&&(n.src=e),n.src&&Hb?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):t4(n)}class i4{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=_0(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=_0(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=_0(e,t,i),l=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===Be.IDLE&&r.load(),r.getImageState()===Be.LOADING?r.ready().then(()=>{this.patternCache_[o]=jm().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=jm().createPattern(r.getImage(1),"repeat")),l||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function _0(n,e,t){const i=t?hu(t):"null";return e+":"+n+":"+i}const Yi=new i4;let Rh=null;class Zb extends kp{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Be.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Be.LOADED){Rh||(Rh=Jt(1,1,void 0,{willReadFrequently:!0})),Rh.drawImage(this.image_,0,0);try{Rh.getImageData(0,0,1,1),this.tainted_=!1}catch{Rh=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(We.CHANGE)}handleImageError_(){this.imageState_=Be.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Be.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=Jt(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Be.IDLE){this.image_||this.initializeImage_(),this.imageState_=Be.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&n4(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Be.LOADED)return;const t=this.image_,i=Jt(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=Yj(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Be.LOADED||this.imageState_===Be.ERROR)e();else{const t=()=>{(this.imageState_===Be.LOADED||this.imageState_===Be.ERROR)&&(this.removeEventListener(We.CHANGE,t),e())};this.addEventListener(We.CHANGE,t)}})),this.ready_}}function zm(n,e,t,i,r,s){let o=e===void 0?void 0:Yi.get(e,t,r);return o||(o=new Zb(n,n&&"src"in n?n.src||void 0:e,t,i,r),Yi.set(e,t,r,o,s)),s&&o&&!Yi.getPattern(e,t,r)&&Yi.set(e,t,r,o,s),o}function Jr(n){return n?Array.isArray(n)?C1(n):typeof n=="object"&&"src"in n?r4(n):n:null}function r4(n){if(!n.offset||!n.size)return Yi.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Yi.getPattern(e,void 0,n.color);if(t)return t;const i=Yi.get(n.src,"anonymous",null);if(i.getImageState()!==Be.LOADED)return null;const r=Jt(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),zm(r.canvas,e,void 0,Be.LOADED,n.color,!0),Yi.getPattern(e,void 0,n.color)}class Qb{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Ug="ol-hidden",af="ol-unselectable",R1="ol-control",BI="ol-collapsed",s4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),WI=["style","variant","weight","size","lineHeight","family"],bv={normal:400,bold:700},Pv=function(n){const e=n.match(s4);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=WI.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[WI[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in bv&&(t.weight=bv[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},Jb="10px sans-serif",ti="#000",du="round",Ws=[],Gs=0,fu="round",Id=10,Cd="#000",Rd="center",Um="middle",el=[0,0,0,0],Ad=1,Nc=new us;let Ah=null,GI;const kv={},o4=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function a4(n,e,t){return`${n} ${e} 16px "${t}"`}const l4=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const l=Pv(s),u=l.families[0].toLowerCase(),h=l.weight;return o.some(f=>{const m=f.family.replace(/^['"]|['"]$/g,"").toLowerCase(),y=bv[f.weight]||f.weight;return m===u&&f.style===l.style&&y==h})}async function r(){await t.ready;let s=!0;const o=Nc.getProperties(),l=Object.keys(o).filter(u=>o[u]<100);for(let u=l.length-1;u>=0;--u){const h=l[u];let f=o[h];f<100&&(await i(h)?(nf(kv),Nc.set(h,100)):(f+=10,Nc.set(h,f,!0),f<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Si?self.fonts:document.fonts);const o=Pv(s);if(!o)return;const l=o.families;let u=!1;for(const h of l){if(o4.has(h))continue;const f=a4(o.style,o.weight,h);Nc.get(f)===void 0&&(Nc.set(f,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),c4=(function(){let n;return function(e){let t=kv[e];if(t==null){if(Si){const i=Pv(e),r=eP(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);kv[e]=t}return t}})();function eP(n,e){return Ah||(Ah=Jt(1,1)),n!=GI&&(Ah.font=n,GI=Ah.font),Ah.measureText(e)}function tP(n,e){return eP(n,e).width}function $I(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,tP(n,s)),0);return t[e]=i,i}function u4(n,e){const t=[],i=[],r=[];let s=0,o=0,l=0,u=0;for(let h=0,f=e.length;h<=f;h+=2){const m=e[h];if(m===`
`||h===f){s=Math.max(s,o),r.push(o),o=0,l+=u,u=0;continue}const y=e[h+1]||n.font,x=tP(y,m);t.push(x),o+=x;const T=c4(y);i.push(T),u=Math.max(u,T)}return{width:s,height:l,widths:t,heights:i,lineWidths:r}}function h4(n,e,t,i,r,s,o,l,u,h,f){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=m=>m.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(f[0],f[1]),d4(i,n)):f[0]<0||f[1]<0?(n.translate(u,h),n.scale(f[0],f[1]),n.drawImage(i,r,s,o,l,0,0,o,l)):n.drawImage(i,r,s,o,l,u,h,o*f[0],l*f[1]),n.restore()}function d4(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class f4 extends Qb{constructor(e,t,i,r,s,o,l){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?sf(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Er()}drawImages_(e,t,i,r){if(!this.image_)return;const s=qo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,l=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let f=0,m=s.length;f<m;f+=2){const y=s[f]-this.imageAnchorX_,x=s[f+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const T=y+this.imageAnchorX_,I=x+this.imageAnchorY_;Hs(l,T,I,1,1,h,-T,-I),o.save(),o.transform.apply(o,l),o.translate(T,I),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=qo(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let l=this.textRotation_;for(this.transformRotation_===0&&(l-=this.viewRotation_),this.textRotateWithView_&&(l+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;l!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(l),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,l=qo(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(l[0],l[1]);let u=l.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(l[h],l[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!si(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=Dj(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!si(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(si(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),l=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],l,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!si(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!si(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let l=0,u=s.length;l<u;++l){const h=s[l];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),la(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Rd;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Jr(i||ti)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),l=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),f=s||Ws;this.strokeState_={lineCap:r!==void 0?r:du,lineDash:this.pixelRatio_===1?f:f.map(m=>m*this.pixelRatio_),lineDashOffset:(o||Gs)*this.pixelRatio_,lineJoin:l!==void 0?l:fu,lineWidth:(u!==void 0?u:Ad)*this.pixelRatio_,miterLimit:h!==void 0?h:Id,strokeStyle:Jr(i||Cd)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const x=t.getColor();this.textFillState_={fillStyle:Jr(x||ti)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const x=i.getColor(),T=i.getLineCap(),I=i.getLineDash(),S=i.getLineDashOffset(),A=i.getLineJoin(),D=i.getWidth(),N=i.getMiterLimit();this.textStrokeState_={lineCap:T!==void 0?T:du,lineDash:I||Ws,lineDashOffset:S||Gs,lineJoin:A!==void 0?A:fu,lineWidth:D!==void 0?D:Ad,miterLimit:N!==void 0?N:Id,strokeStyle:Jr(x||Cd)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),l=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),f=e.getText(),m=e.getTextAlign(),y=e.getTextBaseline();this.textState_={font:r!==void 0?r:Jb,textAlign:m!==void 0?m:Rd,textBaseline:y!==void 0?y:Um},this.text_=f!==void 0?Array.isArray(f)?f.reduce((x,T,I)=>x+=I%2?" ":T,""):f:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=l!==void 0?l:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const g4=.5,nP={Point:E4,LineString:v4,Polygon:S4,MultiPoint:T4,MultiLineString:x4,MultiPolygon:w4,GeometryCollection:_4,Circle:p4};function m4(n,e){return parseInt(it(n),10)-parseInt(it(e),10)}function KI(n,e){const t=iP(n,e);return t*t}function iP(n,e){return g4*n/e}function p4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i)}}function HI(n,e,t,i,r,s,o,l){const u=[],h=t.getImage();if(h){let y=!0;const x=h.getImageState();x==Be.LOADED||x==Be.ERROR?y=!1:x==Be.IDLE&&h.load(),y&&u.push(h.ready())}const f=t.getFill();f&&f.loading()&&u.push(f.ready());const m=u.length>0;return m&&Promise.all(u).then(()=>r(null)),y4(n,e,t,i,s,o,l),m}function y4(n,e,t,i,r,s,o){const l=t.getGeometryFunction()(e);if(!l)return;const u=l.simplifyTransformed(i,r);if(t.getRenderer())rP(n,u,t,e,o);else{const f=nP[u.getType()];f(n,u,t,e,o,s)}}function rP(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let l=0,u=o.length;l<u;++l)rP(n,o[l],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function _4(n,e,t,i,r,s){const o=e.getGeometriesArray();let l,u;for(l=0,u=o.length;l<u;++l){const h=nP[o[l].getType()];h(n,o[l],t,i,r,s)}}function v4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function x4(n,e,t,i,r){const s=t.getStroke();if(s){const l=n.getBuilder(t.getZIndex(),"LineString");l.setFillStrokeStyle(null,s),l.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,i,r)}}function w4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}function E4(n,e,t,i,r,s){const o=t.getImage(),l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=Be.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(o,h),f.drawPoint(e,i,r)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,i,r)}}function T4(n,e,t,i,r,s){const o=t.getImage(),l=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),f=s&&l&&h?{}:void 0;if(l){if(o.getImageState()!=Be.LOADED)return;const m=n.getBuilder(t.getZIndex(),"Image");m.setImageStyle(o,f),m.drawMultiPoint(e,i,r)}if(h){const m=n.getBuilder(t.getZIndex(),"Text");m.setTextStyle(u,f),m.drawText(e,i,r)}}function S4(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const l=t.getText();if(l&&l.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l),u.drawText(e,i,r)}}let I4=!1;function C4(n,e,t,i,r,s,o){const l=new XMLHttpRequest;l.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(l.responseType="arraybuffer"),l.withCredentials=I4,l.onload=function(u){if(!l.status||l.status>=200&&l.status<300){const h=e.getType();try{let f;h=="text"||h=="json"?f=l.responseText:h=="xml"?f=l.responseXML||l.responseText:h=="arraybuffer"&&(f=l.response),f?s(e.readFeatures(f,{extent:t,featureProjection:r}),e.readProjection(f)):o()}catch{o()}}else o()},l.onerror=o,l.send()}function XI(n,e){return function(t,i,r,s,o){C4(n,e,t,i,r,(l,u)=>{this.addFeatures(l),s!==void 0&&s(l)},()=>{this.changed(),o!==void 0&&o()})}}function R4(n,e){return[[-1/0,-1/0,1/0,1/0]]}function A4(n,e,t,i){const r=[];let s=Ji();for(let o=0,l=t.length;o<l;++o){const u=t[o];s=h1(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function A1(n,e,t,i,r,s,o){let l,u,h,f,m,y,x;const T=r[s+1],I=[];for(let D=0,N=t.length;D<N;++D){const R=t[D];for(f=n[R-i],y=n[R-i+1],l=e;l<R;l+=i)m=n[l],x=n[l+1],(T<=y&&x<=T||y<=T&&T<=x)&&(h=(T-y)/(x-y)*(m-f)+f,I.push(h)),f=m,y=x}let S=NaN,A=-1/0;for(I.sort(Bs),f=I[0],l=1,u=I.length;l<u;++l){m=I[l];const D=Math.abs(m-f);D>A&&(h=(f+m)/2,x1(n,e,t,i,h,T)&&(S=h,A=D)),f=m}return isNaN(S)&&(S=r[s]),o?(o.push(S,T,A),o):[S,T,A]}function b4(n,e,t,i,r){let s=[];for(let o=0,l=t.length;o<l;++o){const u=t[o];s=A1(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function P4(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function b1(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const l=n[e],u=n[e+1];r+=(l-s)*(u+o),s=l,o=u}return r===0?void 0:r>0}function sP(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=b1(n,e,l,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function DX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const l=t[s];if(!sP(n,e,l,i,r))return!1;l.length&&(e=l[l.length-1])}return!0}function Nv(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const l=t[s],u=b1(n,e,l,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&P4(n,e,l,i),e=l}return e}function MX(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=Nv(n,e,t[s],i,r);return e}function k4(n,e){const t=[];let i=0,r=0,s;for(let o=0,l=e.length;o<l;++o){const u=e[o],h=b1(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function oP(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let l=0,u=0;for(;e<t;e+=i){const h=n[e]-s,f=n[e+1]-o;r+=u*h-l*f,l=h,u=f}return r/2}function aP(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=oP(n,e,l,i),e=l}return r}function LX(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const l=t[s];r+=aP(n,e,l,i),e=l[l.length-1]}return r}class bd extends v1{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new bd(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<vb(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Vb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),zb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return oP(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Kc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=E1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new bd(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Bb(this.flatCoordinates,0,e,this.stride),this.changed()}}class Pd extends v1{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?c1(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Pd(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<vb(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jb(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ub(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return x1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return aP(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Nv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Vm(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=gl(this.getExtent());this.flatInteriorPoint_=A1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new pl(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new bd(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,l=i.length;o<l;++o){const u=i[o],h=new bd(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;sP(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Nv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=T1(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Pd(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return $b(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Wb(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function qI(n){if(Op(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Pd(s,"XY",[s.length])}const YI=Er();class gr{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?wb(this.flatCoordinates_):h1(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=gl(this.getExtent());this.flatInteriorPoints_=A1(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=k4(this.flatCoordinates_,this.ends_),t=A4(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=b4(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=VI(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],l=VI(e,t,o,2,.5);c1(this.flatMidpoints_,l),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ci(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Bn(i)/Bn(t);Hs(YI,i[0],i[3],r,-r,0,0,0),qo(this.flatCoordinates_,0,this.flatCoordinates_.length,2,YI,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new gr(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=yb((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=E1(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=Vj(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=T1(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new gr(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}gr.prototype.getFlatCoordinates=gr.prototype.getOrientedFlatCoordinates;function lP(n,e,t=0,i=n.length-1,r=N4){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,f=Math.log(u),m=.5*Math.exp(2*f/3),y=.5*Math.sqrt(f*m*(u-m)/u)*(h-u/2<0?-1:1),x=Math.max(t,Math.floor(e-h*m/u+y)),T=Math.min(i,Math.floor(e+(u-h)*m/u+y));lP(n,e,x,T,r)}const s=n[e];let o=t,l=i;for(bh(n,t,e),r(n[i],s)>0&&bh(n,t,i);o<l;){for(bh(n,o,l),o++,l--;r(n[o],s)<0;)o++;for(;r(n[l],s)>0;)l--}r(n[t],s)===0?bh(n,t,l):(l++,bh(n,l,i)),l<=e&&(t=l+1),e<=l&&(i=l-1)}}function bh(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function N4(n,e){return n<e?-1:n>e?1:0}let cP=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!Wg(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const l=t.children[o],u=t.leaf?r(l):l;Wg(e,u)&&(t.leaf?i.push(l):x0(e,u)?this._all(l,i):s.push(l))}t=s.pop()}return i}collides(e){let t=this.data;if(!Wg(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(Wg(e,o)){if(t.leaf||x0(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Dc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let l,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],l=o.pop(),h=!0),i.leaf){const f=D4(e,i.children,t);if(f!==-1)return i.children.splice(f,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&x0(i,r)?(s.push(i),o.push(l),l=0,u=i,i=i.children[0]):u?(l++,i=u.children[l],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,l;if(s<=o)return l=Dc(e.slice(t,i+1)),xc(l,this.toBBox),l;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),l=Dc([]),l.leaf=!1,l.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));ZI(e,t,i,h,this.compareMinX);for(let f=t;f<=i;f+=h){const m=Math.min(f+h-1,i);ZI(e,f,m,u,this.compareMinY);for(let y=f;y<=m;y+=u){const x=Math.min(y+u-1,m);l.children.push(this._build(e,y,x,r-1))}}return xc(l,this.toBBox),l}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,l;for(let u=0;u<t.children.length;u++){const h=t.children[u],f=v0(h),m=O4(e,h)-f;m<o?(o=m,s=f<s?f:s,l=h):m===o&&f<s&&(s=f,l=h)}t=l||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Wh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),l=Dc(i.children.splice(o,i.children.length-o));l.height=i.height,l.leaf=i.leaf,xc(i,this.toBBox),xc(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(i,l)}_splitRoot(e,t){this.data=Dc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,xc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let l=t;l<=i-t;l++){const u=Bh(e,0,l,this.toBBox),h=Bh(e,l,i,this.toBBox),f=F4(u,h),m=v0(u)+v0(h);f<s?(s=f,r=l,o=m<o?m:o):f===s&&m<o&&(o=m,r=l)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:M4,s=e.leaf?this.compareMinY:L4,o=this._allDistMargin(e,t,i,r),l=this._allDistMargin(e,t,i,s);o<l&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Bh(e,0,t,s),l=Bh(e,i-t,i,s);let u=Bg(o)+Bg(l);for(let h=t;h<i-t;h++){const f=e.children[h];Wh(o,e.leaf?s(f):f),u+=Bg(o)}for(let h=i-t-1;h>=t;h--){const f=e.children[h];Wh(l,e.leaf?s(f):f),u+=Bg(l)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Wh(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():xc(e[t],this.toBBox)}};function D4(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function xc(n,e){Bh(n,0,n.children.length,e,n)}function Bh(n,e,t,i,r){r||(r=Dc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Wh(r,n.leaf?i(o):o)}return r}function Wh(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function M4(n,e){return n.minX-e.minX}function L4(n,e){return n.minY-e.minY}function v0(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Bg(n){return n.maxX-n.minX+(n.maxY-n.minY)}function O4(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function F4(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function x0(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Wg(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Dc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ZI(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;lP(n,o,e,t,r),s.push(e,o,o,t)}}class QI{constructor(e){this.rbush_=new cP(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[it(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],l=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:l};i[r]=u,this.items_[it(l)]=u}this.rbush_.load(i)}remove(e){const t=it(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[it(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Td(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return ou(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return na(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class uP extends us{constructor(e){super(),this.projection=ci(e.projection),this.attributions_=JI(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=JI(e),this.changed()}setState(e){this.state_=e,this.changed()}}function JI(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const $i={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Io extends Zs{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class P1 extends uP{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Ed,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(lt(this.format_,"`format` must be set when `url` is set"),this.loader_=XI(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:R4;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new QI:null,this.loadedExtentsRtree_=new QI,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Xi(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=it(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Io($i.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof gr||(this.featureChangeKeys_[e]=[nt(t,We.CHANGE,this.handleFeatureChange_,this),nt(t,su.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof gr){const s=this.idIndex_[r];s instanceof gr?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(lt(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const l=e[s],u=it(l);this.addToIndex_(u,l)&&i.push(l)}for(let s=0,o=i.length;s<o;s++){const l=i[s],u=it(l);this.setupChangeEvents_(u,l);const h=l.getGeometry();if(h){const f=h.getExtent();t.push(f),r.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener($i.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Io($i.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener($i.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener($i.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(ei.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(ei.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(At);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Io($i.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof gr||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof gr||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),ou(this.nullGeometryFeatures_)||c1(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=Cb(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let l=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||wd,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const f=h.getGeometry(),m=l;if(l=f instanceof gr?0:f.closestPointXY(i,r,o,l),l<m){s=h;const y=Math.sqrt(l);u[0]=i-y,u[1]=r-y,u[2]=i+y,u[3]=r+y}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=it(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new Io($i.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:it(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&ou(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,l=s.length;o<l;++o){const u=s[o];r.forEachInExtent(u,function(f){return Uh(f.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Io($i.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,f=>{--this.loadingExtentsCount_,this.dispatchEvent(new Io($i.FEATURESLOADEND,void 0,f))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Io($i.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Td(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=it(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(At),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener($i.REMOVEFEATURE)&&this.dispatchEvent(new Io($i.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){lt(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(XI(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Ir{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Ir({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=zm(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===Be.IDLE&&t.load(),t.getImageState()===Be.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?it(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:hu(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class ku{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new ku({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function eC(n){return n[0]>0&&n[1]>0}function V4(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function ai(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Up{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=ai(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Up({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return tt()}getImage(e){return tt()}getHitDetectionImage(){return tt()}getPixelRatio(e){return 1}getImageState(){return tt()}getImageSize(){return tt()}getOrigin(){return tt()}getSize(){return tt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ai(e)}listenImageChange(e){tt()}load(){tt()}unlistenImageChange(e){tt()}ready(){return Promise.resolve()}}class Bp extends Up{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Be.LOADING:Be.LOADED,this.imageState_===Be.LOADING&&this.ready().then(()=>this.imageState_=Be.LOADED),this.render()}clone(){const e=this.getScale(),t=new Bp({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=Yi.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),l=Jt(o,o);this.draw_(s,l,e),r=l.canvas,Yi.set(i,null,null,new Zb(r,void 0,null,Be.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const j=r;r=s,s=j}const o=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/o,u=s*Math.sin(l),h=Math.sqrt(s*s-u*u),f=r-h,m=Math.sqrt(u*u+f*f),y=m/u;if(e==="miter"&&y<=i)return y*t;const x=t/2/y,T=t/2*(f/m),S=Math.sqrt((r+x)*(r+x)+T*T)-r;if(this.radius2_===void 0||e==="bevel")return S*2;const A=r*Math.sin(l),D=Math.sqrt(r*r-A*A),N=s-D,L=Math.sqrt(A*A+N*N)/A;if(L<=i){const j=L*t/2-s-r;return 2*Math.max(S,j)}return S*2}createRenderOptions(){let e=du,t=fu,i=0,r=null,s=0,o,l=0;this.stroke_&&(o=Jr(this.stroke_.getColor()??Cd),l=this.stroke_.getWidth()??Ad,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??fu,e=this.stroke_.getLineCap()??du,i=this.stroke_.getMiterLimit()??Id);const u=this.calculateLineJoinSize_(t,l,i),h=Math.max(this.radius,this.radius2_||0),f=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:l,size:f,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=ti),t.fillStyle=Jr(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=hu(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=Jt(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let l=0;l<t;l++){const u=s+l*o,h=l%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ti,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Nl extends Bp{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Nl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Qi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=tC,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Qi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=tC,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function j4(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(lt(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let w0=null;function hP(n,e){if(!w0){const t=new Ir({color:"rgba(255,255,255,0.4)"}),i=new ku({color:"#3399CC",width:1.25});w0=[new Qi({image:new Nl({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return w0}function tC(n){return n.getGeometry()}const z4="#333";class lf{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=ai(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Ir({color:z4}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new lf({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Ir?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ai(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Mn={ANIMATING:0,INTERACTING:1},Ce={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Gg=[Ce.FILL],Ko=[Ce.STROKE],tl=[Ce.BEGIN_PATH],nC=[Ce.CLOSE_PATH];class cf extends Qb{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let l=0,u=e.length;l<u;l+=t)r[0]=e[l],r[1]=e[l+1],lu(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const l=this.coordinates;let u=l.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let f=e[t],m=e[t+1];const y=this.tmpCoordinate_;let x=!0,T,I,S;for(T=t+r;T<i;T+=r)y[0]=e[T],y[1]=e[T+1],S=xv(h,y),S!==I?(x&&(l[u++]=f,l[u++]=m,x=!1),l[u++]=y[0],l[u++]=y[1]):S===ln.INTERSECTING?(l[u++]=y[0],l[u++]=y[1],x=!1):x=!0,f=y[0],m=y[1],I=S;return(s&&x||T===t+r)&&(l[u++]=f,l[u++]=m),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,l=i.length;o<l;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),l=e.getStride(),u=this.coordinates.length;let h,f,m,y,x;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),y=[];const T=e.getEndss();x=0;for(let I=0,S=T.length;I<S;++I){const A=[];x=this.drawCustomCoordinates_(h,x,T[I],l,A),y.push(A)}this.instructions.push([Ce.CUSTOM,u,y,e,i,FI,s]),this.hitDetectionInstructions.push([Ce.CUSTOM,u,y,e,r||i,FI,s]);break;case"Polygon":case"MultiLineString":m=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),x=this.drawCustomCoordinates_(h,0,e.getEnds(),l,m),this.instructions.push([Ce.CUSTOM,u,m,e,i,Vm,s]),this.hitDetectionInstructions.push([Ce.CUSTOM,u,m,e,r||i,Vm,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),f=this.appendFlatLineCoordinates(h,0,h.length,l,!1,!1),this.instructions.push([Ce.CUSTOM,u,f,e,i,Kc,s]),this.hitDetectionInstructions.push([Ce.CUSTOM,u,f,e,r||i,Kc,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),f=this.appendFlatPointCoordinates(h,l),f>u&&(this.instructions.push([Ce.CUSTOM,u,f,e,i,Kc,s]),this.hitDetectionInstructions.push([Ce.CUSTOM,u,f,e,r||i,Kc,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),f=this.coordinates.length,this.instructions.push([Ce.CUSTOM,u,f,e,i,void 0,s]),this.hitDetectionInstructions.push([Ce.CUSTOM,u,f,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Ce.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ce.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Ce.END_GEOMETRY?o=t:s==Ce.BEGIN_GEOMETRY&&(r[2]=t,N5(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Jr(i||ti)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Jr(i||Cd);const r=e.getLineCap();t.lineCap=r!==void 0?r:du;const s=e.getLineDash();t.lineDash=s?s.slice():Ws;const o=e.getLineDashOffset();t.lineDashOffset=o||Gs;const l=e.getLineJoin();t.lineJoin=l!==void 0?l:fu;const u=e.getWidth();t.lineWidth=u!==void 0?u:Ad;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:Id,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Ce.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ce.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,l=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!la(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=l||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=l,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Ce.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=_b(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;u1(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class U4 extends cf{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!lu(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,l=this.appendFlatPointCoordinates(r,s);this.instructions.push([Ce.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ce.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||lu(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,l=this.appendFlatPointCoordinates(s,2);this.instructions.push([Ce.DRAW_IMAGE,o,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ce.DRAW_IMAGE,o,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class B4 extends cf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),l=[Ce.MOVE_TO_LINE_TO,s,o];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ce.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ws,Gs],tl);const l=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(l,0,l.length,u),this.hitDetectionInstructions.push(Ko),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Ce.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ws,Gs],tl);const l=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let f=0;for(let m=0,y=l.length;m<y;++m)f=this.drawFlatCoordinates_(u,f,l[m],h);this.hitDetectionInstructions.push(Ko),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Ko),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Ko),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(tl)}}class iC extends cf{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,l=s.strokeStyle!==void 0,u=i.length;this.instructions.push(tl),this.hitDetectionInstructions.push(tl);for(let h=0;h<u;++h){const f=i[h],m=this.coordinates.length,y=this.appendFlatLineCoordinates(e,t,f,r,!0,!l),x=[Ce.MOVE_TO_LINE_TO,m,y];this.instructions.push(x),this.hitDetectionInstructions.push(x),l&&(this.instructions.push(nC),this.hitDetectionInstructions.push(nC)),t=f}return o&&(this.instructions.push(Gg),this.hitDetectionInstructions.push(Gg)),l&&(this.instructions.push(Ko),this.hitDetectionInstructions.push(Ko)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ws,Gs]);const l=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,u,!1,!1);const f=[Ce.CIRCLE,h];this.instructions.push(tl,f),this.hitDetectionInstructions.push(tl,f),r.fillStyle!==void 0&&(this.instructions.push(Gg),this.hitDetectionInstructions.push(Gg)),r.strokeStyle!==void 0&&(this.instructions.push(Ko),this.hitDetectionInstructions.push(Ko)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ws,Gs]);const l=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,l,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_FILL_STYLE,ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ce.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ws,Gs]);const l=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let f=0;for(let m=0,y=l.length;m<y;++m)f=this.drawFlatCoordinatess_(u,f,l[m],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Ua(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function W4(n,e,t,i,r){const s=[];let o=t,l=0,u=e.slice(t,2);for(;l<n&&o+r<i;){const[h,f]=u.slice(-2),m=e[o+r],y=e[o+r+1],x=Math.sqrt((m-h)*(m-h)+(y-f)*(y-f));if(l+=x,l>=n){const T=(n-l+x)/x,I=Ei(h,m,T),S=Ei(f,y,T);u.push(I,S),s.push(u),u=[I,S],l==n&&(o+=r),l=0}else if(l<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const T=x-l,I=Ei(h,m,T/x),S=Ei(f,y,T/x);u.push(I,S),s.push(u),u=[I,S],l=0,o+=r}}return l>0&&s.push(u),s}function G4(n,e,t,i,r){let s=t,o=t,l=0,u=0,h=t,f,m,y,x,T,I,S,A,D,N;for(m=t;m<i;m+=r){const R=e[m],L=e[m+1];T!==void 0&&(D=R-T,N=L-I,x=Math.sqrt(D*D+N*N),S!==void 0&&(u+=y,f=Math.acos((S*D+A*N)/(y*x)),f>n&&(u>l&&(l=u,s=h,o=m),u=0,h=m-r)),y=x,S=D,A=N),T=R,I=L}return u+=x,u>l?[h,m]:[s,o]}const Bm={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class $4 extends cf{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ti]={fillStyle:ti},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const l=this.coordinates;let u=l.length;const h=e.getType();let f=null,m=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!si(this.maxExtent,e.getExtent()))return;let y;if(f=e.getFlatCoordinates(),h=="LineString")y=[f.length];else if(h=="MultiLineString")y=e.getEnds();else if(h=="Polygon")y=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const S=e.getEndss();y=[];for(let A=0,D=S.length;A<D;++A)y.push(S[A][0])}this.beginGeometry(e,t,i);const x=o.repeat,T=x?void 0:o.textAlign;let I=0;for(let S=0,A=y.length;S<A;++S){let D;x?D=W4(x*this.resolution,f,I,y[S],m):D=[f.slice(I,y[S])];for(let N=0,R=D.length;N<R;++N){const L=D[N];let j=0,k=L.length;if(T==null){const M=G4(o.maxAngle,L,0,L.length,2);j=M[0],k=M[1]}for(let M=j;M<k;M+=m)l.push(L[M],L[M+1]);const b=l.length;I=y[S],this.drawChars_(u,b),u=b}}this.endGeometry(t)}else{let y=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":f=e.getFlatCoordinates();break;case"LineString":f=e.getFlatMidpoint();break;case"Circle":f=e.getCenter();break;case"MultiLineString":f=e.getFlatMidpoints(),m=2;break;case"Polygon":f=e.getFlatInteriorPoint(),o.overflow||y.push(f[2]/this.resolution),m=3;break;case"MultiPolygon":const R=e.getFlatInteriorPoints();f=[];for(let L=0,j=R.length;L<j;L+=3)o.overflow||y.push(R[L+2]/this.resolution),f.push(R[L],R[L+1]);if(f.length===0)return;m=2;break}const x=this.appendFlatPointCoordinates(f,m);if(x===u)return;if(y&&(x-u)/2!==f.length/m){let R=u/2;y=y.filter((L,j)=>{const k=l[(R+j)*2]===f[j*m]&&l[(R+j)*2+1]===f[j*m+1];return k||--R,k})}this.saveTextStates_();const T=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,I=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let S=o.padding;if(S!=el&&(o.scale[0]<0||o.scale[1]<0)){let R=o.padding[0],L=o.padding[1],j=o.padding[2],k=o.padding[3];o.scale[0]<0&&(L=-L,k=-k),o.scale[1]<0&&(R=-R,j=-j),S=[R,L,j,k]}const A=this.pixelRatio;this.instructions.push([Ce.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,S==el?el:S.map(function(R){return R*A}),T,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]);const D=1/A,N=T?T.slice(0):null;N&&(N[1]=ti),this.hitDetectionInstructions.push([Ce.DRAW_IMAGE,u,x,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[D,D],NaN,this.declutterMode_,this.declutterImageWithText_,S,N,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ti:this.fillKey_,this.textOffsetX_,this.textOffsetY_,y]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Rd,justify:t.justify,textBaseline:t.textBaseline||Um,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,l=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=Bm[r.textBaseline],f=this.textOffsetY_*u,m=this.text_,y=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Ce.DRAW_CHARS,e,t,h,r.overflow,l,r.maxAngle,u,f,s,y*u,m,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ce.DRAW_CHARS,e,t,h,r.overflow,l&&ti,r.maxAngle,u,f,s,y*u,m,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Jr(o.getColor()||ti)):(r=null,this.textFillState_=r);const l=e.getStroke();if(!l)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const I=l.getLineDash(),S=l.getLineDashOffset(),A=l.getWidth(),D=l.getMiterLimit();s.lineCap=l.getLineCap()||du,s.lineDash=I?I.slice():Ws,s.lineDashOffset=S===void 0?Gs:S,s.lineJoin=l.getLineJoin()||fu,s.lineWidth=A===void 0?Ad:A,s.miterLimit=D===void 0?Id:D,s.strokeStyle=Jr(l.getColor()||Cd)}i=this.textState_;const u=e.getFont()||Jb;l4(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Um,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||el,i.scale=h===void 0?[1,1]:h;const f=e.getOffsetX(),m=e.getOffsetY(),y=e.getRotateWithView(),x=e.getKeepUpright(),T=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=f===void 0?0:f,this.textOffsetY_=m===void 0?0:m,this.textRotateWithView_=y===void 0?!1:y,this.textKeepUpright_=x===void 0?!0:x,this.textRotation_=T===void 0?0:T,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:it(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+it(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const K4={Circle:iC,Default:cf,Image:U4,LineString:B4,Polygon:iC,Text:$4};class H4{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=K4[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function X4(n,e,t,i,r,s,o,l,u,h,f,m,y=!0){let x=n[e],T=n[e+1],I=0,S=0,A=0,D=0;function N(){I=x,S=T,e+=i,x=n[e],T=n[e+1],D+=A,A=Math.sqrt((x-I)*(x-I)+(T-S)*(T-S))}do N();while(e<t-i&&D+A<s);let R=A===0?0:(s-D)/A;const L=Ei(I,x,R),j=Ei(S,T,R),k=e-i,b=D,M=s+l*u(h,r,f);for(;e<t-i&&D+A<M;)N();R=A===0?0:(M-D)/A;const V=Ei(I,x,R),z=Ei(S,T,R);let B=!1;if(y)if(m){const ue=[L,j,V,z];Fb(ue,0,4,2,m,ue,ue),B=ue[0]>ue[2]}else B=L>V;const O=Math.PI,le=[],me=k+i===e;e=k,A=0,D=b,x=n[e],T=n[e+1];let ge;if(me){N(),ge=Math.atan2(T-S,x-I),B&&(ge+=ge>0?-O:O);const ue=(V+L)/2,Q=(z+j)/2;return le[0]=[ue,Q,(M-s)/2,ge,r],le}r=r.replace(/\n/g," ");for(let ue=0,Q=r.length;ue<Q;){N();let se=Math.atan2(T-S,x-I);if(B&&(se+=se>0?-O:O),ge!==void 0){let xe=se-ge;if(xe+=xe>O?-2*O:xe<-O?2*O:0,Math.abs(xe)>o)return null}ge=se;const ne=ue;let G=0;for(;ue<Q;++ue){const xe=B?Q-ue-1:ue,ke=l*u(h,r[xe],f);if(e+i<t&&D+A<s+G+ke/2)break;G+=ke}if(ue===ne)continue;const $=B?r.substring(Q-ne,Q-ue):r.substring(ne,ue);R=A===0?0:(s+G/2-D)/A;const ie=Ei(I,x,R),pe=Ei(S,T,R);le.push([ie,pe,G/2,se,$]),s+=G}return le}class dP{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(jm(),{get:(e,t)=>{if(typeof jm()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const wc=Ji(),Co=[],ks=[],Ns=[],Ro=[];function rC(n){return n[3].declutterBox}const sC=new RegExp("[-----]");function E0(n,e){return e==="start"?e=sC.test(n)?"right":"left":e==="end"&&(e=sC.test(n)?"left":"right"),Bm[e]}function q4(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function Y4(n,e,t){return t%2===0&&(n+=e),n}class Z4{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Er(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new dP:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,l=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,f=[u.scale[0]*h,u.scale[1]*h],m=u.justify?Bm[u.justify]:E0(Array.isArray(e)?e[0]:e,u.textAlign||Rd),y=r&&o.lineWidth?o.lineWidth:0,x=Array.isArray(e)?e:String(e).split(`
`).reduce(q4,[]),{width:T,height:I,widths:S,heights:A,lineWidths:D}=u4(u,x),N=T+y,R=[],L=(N+2)*f[0],j=(I+y)*f[1],k={width:L<0?Math.floor(L):Math.ceil(L),height:j<0?Math.floor(j):Math.ceil(j),contextInstructions:R};(f[0]!=1||f[1]!=1)&&R.push("scale",f),r&&(R.push("strokeStyle",o.strokeStyle),R.push("lineWidth",y),R.push("lineCap",o.lineCap),R.push("lineJoin",o.lineJoin),R.push("miterLimit",o.miterLimit),R.push("setLineDash",[o.lineDash]),R.push("lineDashOffset",o.lineDashOffset)),i&&R.push("fillStyle",l.fillStyle),R.push("textBaseline","middle"),R.push("textAlign","center");const b=.5-m;let M=m*N+b*y;const V=[],z=[];let B=0,O=0,le=0,me=0,ge;for(let ue=0,Q=x.length;ue<Q;ue+=2){const se=x[ue];if(se===`
`){O+=B,B=0,M=m*N+b*y,++me;continue}const ne=x[ue+1]||u.font;ne!==ge&&(r&&V.push("font",ne),i&&z.push("font",ne),ge=ne),B=Math.max(B,A[le]);const G=[se,M+b*S[le]+m*(S[le]-D[me]),.5*(y+B)+O];M+=S[le],r&&V.push("strokeText",G),i&&z.push("fillText",G),++le}return Array.prototype.push.apply(R,V),Array.prototype.push.apply(R,z),this.labels_[s]=k,k}replayTextBackground_(e,t,i,r,s,o,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,l,u,h,f,m,y,x,T,I,S){l*=y[0],u*=y[1];let A=i-l,D=r-u;const N=s+h>e?e-h:s,R=o+f>t?t-f:o,L=T[3]+N*y[0]+T[1],j=T[0]+R*y[1]+T[2],k=A-T[3],b=D-T[0];(I||m!==0)&&(Co[0]=k,Ro[0]=k,Co[1]=b,ks[1]=b,ks[0]=k+L,Ns[0]=ks[0],Ns[1]=b+j,Ro[1]=Ns[1]);let M;return m!==0?(M=Hs(Er(),i,r,1,1,m,-i,-r),un(M,Co),un(M,ks),un(M,Ns),un(M,Ro),na(Math.min(Co[0],ks[0],Ns[0],Ro[0]),Math.min(Co[1],ks[1],Ns[1],Ro[1]),Math.max(Co[0],ks[0],Ns[0],Ro[0]),Math.max(Co[1],ks[1],Ns[1],Ro[1]),wc)):na(Math.min(k,k+L),Math.min(b,b+j),Math.max(k,k+L),Math.max(b,b+j),wc),x&&(A=Math.round(A),D=Math.round(D)),{drawImageX:A,drawImageY:D,drawImageW:N,drawImageH:R,originX:h,originY:f,declutterBox:{minX:wc[0],minY:wc[1],maxX:wc[2],maxY:wc[3],value:S},canvasTransform:M,scale:y}}replayImageOrLabel_(e,t,i,r,s,o,l){const u=!!(o||l),h=r.declutterBox,f=l?l[2]*r.scale[0]/2:0;return h.minX-f<=t[0]&&h.maxX+f>=0&&h.minY-f<=t[1]&&h.maxY+f>=0&&(u&&this.replayTextBackground_(e,Co,ks,Ns,Ro,o,l),h4(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=un(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),l=this.strokeStates[i],u=this.pixelRatio,h=E0(Array.isArray(e)?e[0]:e,s.textAlign||Rd),f=Bm[s.textBaseline||Um],m=l&&l.lineWidth?l.lineWidth:0,y=o.width/u-2*s.scale[0],x=h*y+2*(.5-h)*m,T=f*o.height/u+2*(.5-f)*m;return{label:o,anchorX:x,anchorY:T}}execute_(e,t,i,r,s,o,l,u){const h=this.zIndexContext_;let f;this.pixelCoordinates_&&la(i,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=qo(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Tj(this.renderedTransform_,i));let m=0;const y=r.length;let x=0,T,I,S,A,D,N,R,L,j,k,b,M,V,z=0,B=0;const O=this.coordinateCache_,le=this.viewRotation_,me=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ge={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:le},ue=this.instructions!=r||this.overlaps?0:200;let Q,se,ne,G;for(;m<y;){const $=r[m];switch($[0]){case Ce.BEGIN_GEOMETRY:Q=$[1],G=$[3],Q.getGeometry()?l!==void 0&&!si(l,G.getExtent())?m=$[2]+1:++m:m=$[2],h&&(h.zIndex=$[4]);break;case Ce.BEGIN_PATH:z>ue&&(this.fill_(e),z=0),B>ue&&(e.stroke(),B=0),!z&&!B&&(e.beginPath(),D=NaN,N=NaN),++m;break;case Ce.CIRCLE:x=$[1];const pe=f[x],xe=f[x+1],ke=f[x+2],Me=f[x+3],je=ke-pe,Ge=Me-xe,ct=Math.sqrt(je*je+Ge*Ge);e.moveTo(pe+ct,xe),e.arc(pe,xe,ct,0,2*Math.PI,!0),++m;break;case Ce.CLOSE_PATH:e.closePath(),++m;break;case Ce.CUSTOM:x=$[1],T=$[2];const er=$[3],fs=$[4],Gn=$[5];ge.geometry=er,ge.feature=Q,m in O||(O[m]=[]);const $n=O[m];Gn?Gn(f,x,T,2,$n):($n[0]=f[x],$n[1]=f[x+1],$n.length=2),h&&(h.zIndex=$[6]),fs($n,ge),++m;break;case Ce.DRAW_IMAGE:x=$[1],T=$[2],j=$[3],I=$[4],S=$[5];let hn=$[6];const dn=$[7],Kn=$[8],Pi=$[9],_t=$[10];let ut=$[11];const nn=$[12];let ki=$[13];A=$[14]||"declutter";const It=$[15];if(!j&&$.length>=20){k=$[19],b=$[20],M=$[21],V=$[22];const Ft=this.drawLabelWithPointPlacement_(k,b,M,V);j=Ft.label,$[3]=j;const Mi=$[23];I=(Ft.anchorX-Mi)*this.pixelRatio,$[4]=I;const fn=$[24];S=(Ft.anchorY-fn)*this.pixelRatio,$[5]=S,hn=j.height,$[6]=hn,ki=j.width,$[13]=ki}let to;$.length>25&&(to=$[25]);let Ni,Ar,tr;$.length>17?(Ni=$[16],Ar=$[17],tr=$[18]):(Ni=el,Ar=null,tr=null),_t&&me?ut+=le:!_t&&!me&&(ut-=le);let br=0;for(;x<T;x+=2){if(to&&to[br++]<ki/this.pixelRatio)continue;const Ft=this.calculateImageOrLabelDimensions_(j.width,j.height,f[x],f[x+1],ki,hn,I,S,Kn,Pi,ut,nn,s,Ni,!!Ar||!!tr,Q),Mi=[e,t,j,Ft,dn,Ar,tr];if(u){let fn,Vt,gn;if(It){const rt=T-x;if(!It[rt]){It[rt]={args:Mi,declutterMode:A};continue}const Wt=It[rt];fn=Wt.args,Vt=Wt.declutterMode,delete It[rt],gn=rC(fn)}let mn,rn;if(fn&&(Vt!=="declutter"||!u.collides(gn))&&(mn=!0),(A!=="declutter"||!u.collides(Ft.declutterBox))&&(rn=!0),Vt==="declutter"&&A==="declutter"){const rt=mn&&rn;mn=rt,rn=rt}mn&&(Vt!=="none"&&u.insert(gn),this.replayImageOrLabel_.apply(this,fn)),rn&&(A!=="none"&&u.insert(Ft.declutterBox),this.replayImageOrLabel_.apply(this,Mi))}else this.replayImageOrLabel_.apply(this,Mi)}++m;break;case Ce.DRAW_CHARS:const ua=$[1],Pr=$[2],Di=$[3],Fl=$[4];V=$[5];const kr=$[6],gs=$[7],no=$[8];M=$[9];const On=$[10];k=$[11],Array.isArray(k)&&(k=k.reduce(Y4,"")),b=$[12];const ms=[$[13],$[13]];A=$[14]||"declutter";const Nr=$[15],Dr=this.textStates[b],Fn=Dr.font,Vn=[Dr.scale[0]*gs,Dr.scale[1]*gs];let gt;Fn in this.widths_?gt=this.widths_[Fn]:(gt={},this.widths_[Fn]=gt);const io=Fj(f,ua,Pr,2),nr=Math.abs(Vn[0])*$I(Fn,k,gt);if(Fl||nr<=io){const Ft=this.textStates[b].textAlign,Mi=(io-nr)*E0(k,Ft),fn=X4(f,ua,Pr,2,k,Mi,kr,Math.abs(Vn[0]),$I,Fn,gt,me?0:this.viewRotation_,Nr);e:if(fn){const Vt=[];let gn,mn,rn,rt,Wt;if(M)for(gn=0,mn=fn.length;gn<mn;++gn){Wt=fn[gn],rn=Wt[4],rt=this.createLabel(rn,b,"",M),I=Wt[2]+(Vn[0]<0?-On:On),S=Di*rt.height+(.5-Di)*2*On*Vn[1]/Vn[0]-no;const qt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Wt[0],Wt[1],rt.width,rt.height,I,S,0,0,Wt[3],ms,!1,el,!1,Q);if(u&&A==="declutter"&&u.collides(qt.declutterBox))break e;Vt.push([e,t,rt,qt,1,null,null])}if(V)for(gn=0,mn=fn.length;gn<mn;++gn){Wt=fn[gn],rn=Wt[4],rt=this.createLabel(rn,b,V,""),I=Wt[2],S=Di*rt.height-no;const qt=this.calculateImageOrLabelDimensions_(rt.width,rt.height,Wt[0],Wt[1],rt.width,rt.height,I,S,0,0,Wt[3],ms,!1,el,!1,Q);if(u&&A==="declutter"&&u.collides(qt.declutterBox))break e;Vt.push([e,t,rt,qt,1,null,null])}u&&A!=="none"&&u.load(Vt.map(rC));for(let qt=0,Li=Vt.length;qt<Li;++qt)this.replayImageOrLabel_.apply(this,Vt[qt])}}++m;break;case Ce.END_GEOMETRY:if(o!==void 0){Q=$[1];const Ft=o(Q,G,A);if(Ft)return Ft}++m;break;case Ce.FILL:ue?z++:this.fill_(e),++m;break;case Ce.MOVE_TO_LINE_TO:for(x=$[1],T=$[2],se=f[x],ne=f[x+1],e.moveTo(se,ne),D=se+.5|0,N=ne+.5|0,x+=2;x<T;x+=2)se=f[x],ne=f[x+1],R=se+.5|0,L=ne+.5|0,(x==T-2||R!==D||L!==N)&&(e.lineTo(se,ne),D=R,N=L);++m;break;case Ce.SET_FILL_STYLE:this.alignAndScaleFill_=$[2],z&&(this.fill_(e),z=0,B&&(e.stroke(),B=0)),e.fillStyle=$[1],++m;break;case Ce.SET_STROKE_STYLE:B&&(e.stroke(),B=0),this.setStrokeStyle_(e,$),++m;break;case Ce.STROKE:ue?B++:e.stroke(),++m;break;default:++m;break}}z&&this.fill_(e),B&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Ka=["Polygon","Circle","LineString","Image","Text","Default"],fP=["Image","Text"],Q4=Ka.filter(n=>!fP.includes(n));class J4{constructor(e,t,i,r,s,o,l){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Er(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,l)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const l=s[o];r[o]=new Z4(this.resolution_,this.pixelRatio_,this.overlaps_,l,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const l=r*2+1,u=Hs(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Jt(l,l));const f=this.hitDetectionContext_;f.canvas.width!==l||f.canvas.height!==l?(f.canvas.width=l,f.canvas.height=l):h||f.clearRect(0,0,l,l);let m;this.renderBuffer_!==void 0&&(m=Ji(),ed(m,e),u1(m,t*(this.renderBuffer_+r),m));const y=e3(r);let x;function T(L,j,k){const b=f.getImageData(0,0,l,l).data;for(let M=0,V=y.length;M<V;M++)if(b[y[M]]>0){if(!o||k==="none"||x!=="Image"&&x!=="Text"||o.includes(L)){const z=(y[M]-3)/4,B=r-z%l,O=r-(z/l|0),le=s(L,j,B*B+O*O);if(le)return le}f.clearRect(0,0,l,l);break}}const I=Object.keys(this.executorsByZIndex_).map(Number);I.sort(Bs);let S,A,D,N,R;for(S=I.length-1;S>=0;--S){const L=I[S].toString();for(D=this.executorsByZIndex_[L],A=Ka.length-1;A>=0;--A)if(x=Ka[A],N=D[x],N!==void 0&&(R=N.executeHitDetection(f,u,i,T,m),R))return R}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],l=[i,r,i,o,s,o,s,r];return qo(l,0,8,2,e,l),l}isEmpty(){return ou(this.executorsByZIndex_)}execute(e,t,i,r,s,o,l){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(l?k5:Bs),o=o||Ka;const h=Ka.length;for(let f=0,m=u.length;f<m;++f){const y=u[f].toString(),x=this.executorsByZIndex_[y];for(let T=0,I=o.length;T<I;++T){const S=o[T],A=x[S];if(A!==void 0){const D=l===null?void 0:A.getZIndexContext(),N=D?D.getContext():e,R=this.maxExtent_&&S!=="Image"&&S!=="Text";if(R&&(N.save(),this.clip(N,i)),!D||S==="Text"||S==="Image"?A.execute(N,t,i,r,s,l):D.pushFunction(L=>A.execute(L,t,i,r,s,l)),R&&N.restore(),D){D.offset();const L=u[f]*h+Ka.indexOf(S);this.deferredZIndexContexts_[L]||(this.deferredZIndexContexts_[L]=[]),this.deferredZIndexContexts_[L].push(D)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Bs);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const T0={};function e3(n){if(T0[n]!==void 0)return T0[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const l=s*s+o*o;if(l>t)break;let u=i[l];u||(u=[],i[l]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return T0[n]=r,r}function oC(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let k1=class gP extends Up{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let l=e.src;lt(!(l!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(l===void 0||l.length===0)&&o&&(l=o.src||it(o)),lt(l!==void 0&&l.length>0,"A defined and non-empty `src` or `image` must be provided"),lt(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=Be.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?Be.LOADED:Be.IDLE:u=Be.LOADING:u=Be.LOADED),this.color_=e.color!==void 0?hu(e.color):null,this.iconImage_=zm(o,l,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,f;if(e.size)[h,f]=e.size;else{const m=this.getImage(1);if(m.width&&m.height)h=m.width,f=m.height;else if(m instanceof HTMLImageElement){this.initialOptions_=e;const y=()=>{if(this.unlistenImageChange(y),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale(oC(x[0],x[1],e.width,e.height))};this.listenImageChange(y);return}}h!==void 0&&this.setScale(oC(h,f,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new gP({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=zm(null,e,this.crossOrigin_,Be.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Be.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Be.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(We.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(We.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Zr=.5;function t3(n,e,t,i,r,s,o,l,u){const h=r,f=n[0]*Zr,m=n[1]*Zr,y=Jt(f,m);y.imageSmoothingEnabled=!1;const x=y.canvas,T=new f4(y,Zr,r,null,o,l,null),I=t.length,S=Math.floor((256*256*256-1)/I),A={};for(let N=1;N<=I;++N){const R=t[N-1],L=R.getStyleFunction()||i;if(!L)continue;let j=L(R,s);if(!j)continue;Array.isArray(j)||(j=[j]);const b=(N*S).toString(16).padStart(7,"#00000");for(let M=0,V=j.length;M<V;++M){const z=j[M],B=z.getGeometryFunction()(R);if(!B||!si(h,B.getExtent()))continue;const O=z.clone(),le=O.getFill();le&&le.setColor(b);const me=O.getStroke();me&&(me.setColor(b),me.setLineDash(null)),O.setText(void 0);const ge=z.getImage();if(ge){const ne=ge.getImageSize();if(!ne)continue;const G=Jt(ne[0],ne[1],void 0,{alpha:!1}),$=G.canvas;G.fillStyle=b,G.fillRect(0,0,$.width,$.height),O.setImage(new k1({img:$,anchor:ge.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ge.getOrigin(),opacity:1,size:ge.getSize(),scale:ge.getScale(),rotation:ge.getRotation(),rotateWithView:ge.getRotateWithView()}))}const ue=O.getZIndex()||0;let Q=A[ue];Q||(Q={},A[ue]=Q,Q.Polygon=[],Q.Circle=[],Q.LineString=[],Q.Point=[]);const se=B.getType();if(se==="GeometryCollection"){const ne=B.getGeometriesArrayRecursive();for(let G=0,$=ne.length;G<$;++G){const ie=ne[G];Q[ie.getType().replace("Multi","")].push(ie,O)}}else Q[se.replace("Multi","")].push(B,O)}}const D=Object.keys(A).map(Number).sort(Bs);for(let N=0,R=D.length;N<R;++N){const L=A[D[N]];for(const j in L){const k=L[j];for(let b=0,M=k.length;b<M;b+=2){T.setStyle(k[b+1]);for(let V=0,z=e.length;V<z;++V)T.setTransform(e[V]),T.drawGeometry(k[b])}}}return y.getImageData(0,0,x.width,x.height)}function n3(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Zr),s=Math.floor(Math.round(n[1])*Zr),o=(Dt(r,0,t.width-1)+Dt(s,0,t.height-1)*t.width)*4,l=t.data[o],u=t.data[o+1],f=t.data[o+2]+256*(u+256*l),m=Math.floor((256*256*256-1)/e.length);f&&f%m===0&&i.push(e[f/m-1])}return i}class mP extends Zs{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const i3=5;class r3 extends rf{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=i3}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return tt()}getData(e){return null}prepareFrame(e){return tt()}renderFrame(e,t){return tt()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Be.LOADED||t.getState()===Be.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Be.LOADED&&t!=Be.ERROR&&e.addEventListener(We.CHANGE,this.boundHandleImageChange_),t==Be.IDLE&&(e.load(),t=e.getState()),t==Be.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const aC=[];let Mc=null;function s3(){Mc=Jt(1,1,void 0,{willReadFrequently:!0})}class pP extends r3{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Er(),this.pixelTransform=Er(),this.inversePixelTransform=Er(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Mc||s3(),Mc.clearRect(0,0,1,1);let r;try{Mc.drawImage(e,t,i,1,1,0,0,1,1),r=Mc.getImageData(0,0,1,1).data}catch{return Mc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&la(hu(e.style.backgroundColor),hu(i)))){const l=e.firstElementChild;$o(l)&&(o=l.getContext("2d"))}if(o&&Rj(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Si?qb():document.createElement("div"),s.className=r;let l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Jt();const u=o.canvas;s.appendChild(u),l=u.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=kl(i),s=Lp(i),o=Mp(i),l=Dp(i);un(t.coordinateToPixelTransform,r),un(t.coordinateToPixelTransform,s),un(t.coordinateToPixelTransform,o),un(t.coordinateToPixelTransform,l);const u=this.inversePixelTransform;un(u,r),un(u,s),un(u,o),un(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,l=Math.round(ft(i)/r*o),u=Math.round(Bn(i)/r*o);Hs(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-l/2,-u/2),Ob(this.inversePixelTransform,this.pixelTransform);const h=Cj(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const f=this.context.canvas;f.width!=l||f.height!=u?(f.width=l,f.height=u):this.context.clearRect(0,0,l,u),h!==f.style.transform&&(f.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new mP(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(qi.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(qi.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new dP),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(qi.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(qi.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,l){const u=s/2,h=o/2,f=r/t,m=-f,y=-e[0]+l,x=-e[1];return Hs(this.tempTransform,u,h,f,m,-i,y,x)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class o3 extends pP{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Ji(),this.wrappedRenderedExtent_=Ji(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,l=s.resolution,u=s.projection,h=s.rotation,f=u.getExtent(),m=this.getLayer().getSource(),y=this.getLayer().getDeclutter(),x=t.pixelRatio,T=t.viewHints,I=!(T[Mn.ANIMATING]||T[Mn.INTERACTING]),S=this.context,A=Math.round(ft(r)/l*x),D=Math.round(Bn(r)/l*x),N=m.getWrapX()&&u.canWrapX(),R=N?ft(f):null,L=N?Math.ceil((r[2]-f[2])/R)+1:1;let j=N?Math.floor((r[0]-f[0])/R):0;do{let k=this.getRenderTransform(o,l,0,x,A,D,j*R);t.declutter&&(k=k.slice(0)),e.execute(S,[S.canvas.width,S.canvas.height],k,h,I,i===void 0?Ka:i?fP:Q4,i?y&&t.declutter[y]:void 0)}while(++j<L)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Jt(this.context.canvas.width,this.context.canvas.height,aC))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,zp(this.context),aC.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let l=o&&!o.isEmpty();if(!l&&!(this.getLayer().hasListener(qi.PRERENDER)||this.getLayer().hasListener(qi.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,l&&i.extent&&this.clipping){const u=Go(i.extent);l=si(u,e.extent),this.clipped_=l&&!Uh(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return l&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,l=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),f=[],m=i[0]*Zr,y=i[1]*Zr;f.push(this.getRenderTransform(r,s,o,Zr,m,y,0).slice());const x=h.getSource(),T=l.getExtent();if(x.getWrapX()&&l.canWrapX()&&!Uh(T,u)){let I=u[0];const S=ft(T);let A=0,D;for(;I<T[0];)--A,D=S*A,f.push(this.getRenderTransform(r,s,o,Zr,m,y,D).slice()),I+=S;for(A=0,I=u[2];I>T[2];)++A,D=S*A,f.push(this.getRenderTransform(r,s,o,Zr,m,y,D).slice()),I-=S}this.hitDetectionImageData_=t3(i,f,this.renderedFeatures_,h.getStyleFunction(),u,s,o,KI(s,this.renderedPixelRatio_))}t(n3(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},f=function(y,x,T){const I=it(y),S=h[I];if(S){if(S!==!0&&T<S.distanceSq){if(T===0)return h[I]=!0,s.splice(s.lastIndexOf(S),1),r(y,u,x);S.geometry=x,S.distanceSq=T}}else{if(T===0)return h[I]=!0,r(y,u,x);s.push(h[I]={feature:y,layer:u,geometry:x,distanceSq:T,callback:r})}},m=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,l,i,f,m?t.declutter?.[m]?.all().map(y=>y.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Mn.ANIMATING],s=e.viewHints[Mn.INTERACTING],o=t.getUpdateWhileAnimating(),l=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!l&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,f=h.projection,m=h.resolution,y=e.pixelRatio,x=t.getRevision(),T=t.getRenderBuffer();let I=t.getRenderOrder();I===void 0&&(I=m4);const S=h.center.slice(),A=u1(u,T*m),D=A.slice(),N=[A.slice()],R=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Uh(R,e.extent)){const le=ft(R),me=Math.max(ft(A)/2,le);A[0]=R[0]-me,A[2]=R[2]+me,Rb(S,f);const ge=Ib(N[0],f);ge[0]<R[0]&&ge[2]<R[2]?N.push([ge[0]+le,ge[1],ge[2]+le,ge[3]]):ge[0]>R[0]&&ge[2]>R[2]&&N.push([ge[0]-le,ge[1],ge[2]-le,ge[3]])}if(this.ready&&this.renderedResolution_==m&&this.renderedRevision_==x&&this.renderedRenderOrder_==I&&this.renderedFrameDeclutter_===!!e.declutter&&Uh(this.wrappedRenderedExtent_,A))return la(this.renderedExtent_,D)||(this.hitDetectionImageData_=null,this.renderedExtent_=D),this.renderedCenter_=S,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const L=new H4(iP(m,y),A,m,y);let j;for(let le=0,me=N.length;le<me;++le)i.loadFeatures(N[le],m,f);const k=KI(m,y);let b=!0;const M=(le,me)=>{let ge;const ue=le.getStyleFunction()||t.getStyleFunction();if(ue&&(ge=ue(le,m)),ge){const Q=this.renderFeature(le,k,ge,L,j,this.getLayer().getDeclutter(),me);b=b&&!Q}},V=Lb(A),z=i.getFeaturesInExtent(V);I&&z.sort(I);for(let le=0,me=z.length;le<me;++le)M(z[le],le);this.renderedFeatures_=z,this.ready=b;const B=L.finish(),O=new J4(A,m,y,i.getOverlaps(),B,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=m,this.renderedRevision_=x,this.renderedRenderOrder_=I,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=D,this.wrappedRenderedExtent_=A,this.renderedCenter_=S,this.renderedProjection_=f,this.renderedPixelRatio_=y,this.replayGroup_=O,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,l){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,f=i.length;h<f;++h)u=HI(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,l)||u;else u=HI(r,e,i,t,this.boundHandleStyleImageChange_,s,o,l);return u}}let Dl=0;const Un=1<<Dl++,qe=1<<Dl++,ni=1<<Dl++,mr=1<<Dl++,_l=1<<Dl++,Gh=1<<Dl++,$g=Math.pow(2,Dl)-1,N1={[Un]:"boolean",[qe]:"number",[ni]:"string",[mr]:"color",[_l]:"number[]",[Gh]:"size"},a3=Object.keys(N1).map(Number).sort(Bs);function l3(n){return n in N1}function $h(n){const e=[];for(const t of a3)Kh(n,t)&&e.push(N1[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Kh(n,e){return(n&e)===e}function Ao(n,e){return n===e}class Qt{constructor(e,t){if(!l3(e))throw new Error(`literal expressions must have a specific type, got ${$h(e)}`);this.type=e,this.value=t}}class c3{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function yP(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function In(n,e,t){switch(typeof n){case"boolean":{if(Ao(e,ni))return new Qt(ni,n?"true":"false");if(!Kh(e,Un))throw new Error(`got a boolean, but expected ${$h(e)}`);return new Qt(Un,n)}case"number":{if(Ao(e,Gh))return new Qt(Gh,ai(n));if(Ao(e,Un))return new Qt(Un,!!n);if(Ao(e,ni))return new Qt(ni,n.toString());if(!Kh(e,qe))throw new Error(`got a number, but expected ${$h(e)}`);return new Qt(qe,n)}case"string":{if(Ao(e,mr))return new Qt(mr,I1(n));if(Ao(e,Un))return new Qt(Un,!!n);if(!Kh(e,ni))throw new Error(`got a string, but expected ${$h(e)}`);return new Qt(ni,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return x3(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(Ao(e,Gh)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Qt(Gh,n)}if(Ao(e,mr)){if(n.length===3)return new Qt(mr,[...n,1]);if(n.length===4)return new Qt(mr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Kh(e,_l))throw new Error(`got an array of numbers, but expected ${$h(e)}`);return new Qt(_l,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},u3={[te.Get]:Oe(Ue(1,1/0),lC),[te.Var]:Oe(Ue(1,1),h3),[te.Has]:Oe(Ue(1,1/0),lC),[te.Id]:Oe(d3,Ec),[te.Concat]:Oe(Ue(2,1/0),ot(ni)),[te.GeometryType]:Oe(f3,Ec),[te.LineMetric]:Oe(Ec),[te.Resolution]:Oe(S0,Ec),[te.Zoom]:Oe(S0,Ec),[te.Time]:Oe(S0,Ec),[te.Any]:Oe(Ue(2,1/0),ot(Un)),[te.All]:Oe(Ue(2,1/0),ot(Un)),[te.Not]:Oe(Ue(1,1),ot(Un)),[te.Equal]:Oe(Ue(2,2),ot($g)),[te.NotEqual]:Oe(Ue(2,2),ot($g)),[te.GreaterThan]:Oe(Ue(2,2),ot(qe)),[te.GreaterThanOrEqualTo]:Oe(Ue(2,2),ot(qe)),[te.LessThan]:Oe(Ue(2,2),ot(qe)),[te.LessThanOrEqualTo]:Oe(Ue(2,2),ot(qe)),[te.Multiply]:Oe(Ue(2,1/0),cC),[te.Coalesce]:Oe(Ue(2,1/0),cC),[te.Divide]:Oe(Ue(2,2),ot(qe)),[te.Add]:Oe(Ue(2,1/0),ot(qe)),[te.Subtract]:Oe(Ue(2,2),ot(qe)),[te.Clamp]:Oe(Ue(3,3),ot(qe)),[te.Mod]:Oe(Ue(2,2),ot(qe)),[te.Pow]:Oe(Ue(2,2),ot(qe)),[te.Abs]:Oe(Ue(1,1),ot(qe)),[te.Floor]:Oe(Ue(1,1),ot(qe)),[te.Ceil]:Oe(Ue(1,1),ot(qe)),[te.Round]:Oe(Ue(1,1),ot(qe)),[te.Sin]:Oe(Ue(1,1),ot(qe)),[te.Cos]:Oe(Ue(1,1),ot(qe)),[te.Atan]:Oe(Ue(1,2),ot(qe)),[te.Sqrt]:Oe(Ue(1,1),ot(qe)),[te.Match]:Oe(Ue(4,1/0),uC,m3),[te.Between]:Oe(Ue(3,3),ot(qe)),[te.Interpolate]:Oe(Ue(6,1/0),uC,p3),[te.Case]:Oe(Ue(3,1/0),g3,y3),[te.In]:Oe(Ue(2,2),_3),[te.Number]:Oe(Ue(1,1/0),ot($g)),[te.String]:Oe(Ue(1,1/0),ot($g)),[te.Array]:Oe(Ue(1,1/0),ot(qe)),[te.Color]:Oe(Ue(1,4),ot(qe)),[te.Band]:Oe(Ue(1,3),ot(qe)),[te.Palette]:Oe(Ue(2,2),v3),[te.ToString]:Oe(Ue(1,1),ot(Un|qe|ni|mr))};function lC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Qt(qe,o);break}case"string":{r[s]=new Qt(ni,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function h3(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Qt(ni,i)]}function d3(n,e,t){t.featureId=!0}function f3(n,e,t){t.geometryType=!0}function S0(n,e,t){t.mapState=!0}function Ec(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Ue(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const l=n===1?"":"s";throw new Error(`expected ${n} argument${l} for ${s}, got ${o}`)}}else if(o<n||o>e){const l=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${l} arguments for ${s}, got ${o}`)}}}function cC(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=In(n[s+1],e,t);r[s]=o}return r}function ot(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const l=In(e[o+1],n,i);s[o]=l}return s}}function g3(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function uC(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function m3(n,e,t){const i=n.length-1,r=ni|qe|Un,s=In(n[1],r,t),o=In(n[n.length-1],e,t),l=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=In(n[u+2],s.type,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=In(n[u+3],o.type,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...l,o]}function p3(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Qt(qe,r);let o;try{o=In(n[2],qe,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const l=new Array(n.length-3);for(let u=0;u<l.length;u+=2){try{const h=In(n[u+3],qe,t);l[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=In(n[u+4],e,t);l[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...l]}function y3(n,e,t){const i=In(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=In(n[s+1],Un,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=In(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function _3(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=ni}else r=qe;const s=new Array(i.length);for(let l=0;l<s.length;l++)try{const u=In(i[l],r,t);s[l]=u}catch(u){throw new Error(`failed to parse haystack item ${l} for "in" expression: ${u.message}`)}return[In(n[1],r,t),...s]}function v3(n,e,t){let i;try{i=In(n[1],qe,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let l;try{l=In(r[o],mr,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(l instanceof Qt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=l}return[i,...s]}function Oe(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const l=n[o](e,t,i);if(o==n.length-1){if(!l)throw new Error("expected last argument validator to return the parsed args");s=l}}return new c3(t,r,...s)}}function x3(n,e,t){const i=n[0],r=u3[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function _P(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return _P(n.getGeometries()[0]);default:return""}}function vP(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Qs(n,e,t){const i=In(n,e,t);return Cr(i)}function Cr(n,e){if(n instanceof Qt){if(n.type===mr&&typeof n.value=="string"){const i=I1(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return w3(n);case te.Get:case te.Var:case te.Has:return E3(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Cr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return S3(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return T3(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return I3(n);case te.Case:return C3(n);case te.Match:return R3(n);case te.Interpolate:return A3(n);case te.ToString:return b3(n);default:throw new Error(`Unsupported operator ${t}`)}}function w3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l<"u"&&l!==null)return l}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const l=r[o](s);if(typeof l===t)return l}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function E3(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;o=o[f]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let l=1,u=s.length;l<u;++l){const f=s[l].value;if(!o||!Object.hasOwn(o,f))return!1;o=o[f]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function T3(n,e){const t=n.operator,i=Cr(n.args[0]),r=Cr(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function S3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),l=r[1](s),u=r[2](s);return o>=l&&o<=u};case te.In:return s=>{const o=r[0](s);for(let l=1;l<i;++l)if(o===r[l](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function I3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let l=0;l<i;++l)o*=r[l](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let l=0;l<i;++l)o+=r[l](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),l=r[1](s);if(o<l)return l;const u=r[2](s);return o>u?u:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function C3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function R3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function A3(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Cr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let l,u;for(let h=2;h<t;h+=2){const f=i[h](r);let m=i[h+1](r);const y=Array.isArray(m);if(y&&(m=Qj(m)),f>=o)return h===2?m:y?P3(s,o,l,u,f,m):Hh(s,o,l,u,f,m);l=f,u=m}return u}}function b3(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Cr(n.args[s]);if(t===te.ToString)return s=>{const o=r[0](s);return n.args[0].type===mr?C1(o):o.toString()};throw new Error(`Unsupported convert operator ${t}`)}function Hh(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const l=e-t,u=n===1?l/o:(Math.pow(n,l)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function P3(n,e,t,i,r,s){if(r-t===0)return i;const l=UI(i),u=UI(s);let h=u[2]-l[2];h>180?h-=360:h<-180&&(h+=360);const f=[Hh(n,e,t,l[0],r,u[0]),Hh(n,e,t,l[1],r,u[1]),l[2]+Hh(n,e,t,0,r,h),Hh(n,e,t,i[3],r,s[3])];return Jj(f)}function k3(n){return!0}function N3(n){const e=yP(),t=D3(n,e),i=vP();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=_P(r.getGeometry())),t(i)}}function hC(n){const e=yP(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Dv(n[o],e);const r=vP(),s=new Array(t);return function(o,l){if(r.properties=o.getPropertiesInternal(),r.resolution=l,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const f=i[h](r);f&&(s[u]=f,u+=1)}return s.length=u,s}}function D3(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Qs(s.filter,Un,e):k3;let l;if(Array.isArray(s.style)){const u=s.style.length;l=new Array(u);for(let h=0;h<u;++h)l[h]=Dv(s.style[h],e)}else l=[Dv(s.style,e)];i[r]={filter:o,styles:l}}return function(r){const s=[];let o=!1;for(let l=0;l<t;++l){const u=i[l].filter;if(u(r)&&!(n[l].else&&o)){o=!0;for(const h of i[l].styles){const f=h(r);f&&s.push(f)}}}return s}}function Dv(n,e){const t=kd(n,"",e),i=Nd(n,"",e),r=M3(n,e),s=L3(n,e),o=oi(n,"z-index",e);if(!t&&!i&&!r&&!s&&!ou(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const l=new Qi;return function(u){let h=!0;if(t){const f=t(u);f&&(h=!1),l.setFill(f)}if(i){const f=i(u);f&&(h=!1),l.setStroke(f)}if(r){const f=r(u);f&&(h=!1),l.setText(f)}if(s){const f=s(u);f&&(h=!1),l.setImage(f)}return o&&l.setZIndex(o(u)),h?null:l}}function kd(n,e,t){let i;if(e+"fill-pattern-src"in n)i=j3(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=D1(n,e+"fill-color",t)}if(!i)return null;const r=new Ir;return function(s){const o=i(s);return o===S1?null:(r.setColor(o),r)}}function Nd(n,e,t){const i=oi(n,e+"stroke-width",t),r=D1(n,e+"stroke-color",t);if(!i&&!r)return null;const s=Ms(n,e+"stroke-line-cap",t),o=Ms(n,e+"stroke-line-join",t),l=xP(n,e+"stroke-line-dash",t),u=oi(n,e+"stroke-line-dash-offset",t),h=oi(n,e+"stroke-miter-limit",t),f=new ku;return function(m){if(r){const y=r(m);if(y===S1)return null;f.setColor(y)}if(i&&f.setWidth(i(m)),s){const y=s(m);if(y!=="butt"&&y!=="round"&&y!=="square")throw new Error("Expected butt, round, or square line cap");f.setLineCap(y)}if(o){const y=o(m);if(y!=="bevel"&&y!=="round"&&y!=="miter")throw new Error("Expected bevel, round, or miter line join");f.setLineJoin(y)}return l&&f.setLineDash(l(m)),u&&f.setLineDashOffset(u(m)),h&&f.setMiterLimit(h(m)),f}}function M3(n,e){const t="text-",i=Ms(n,t+"value",e);if(!i)return null;const r=kd(n,t,e),s=kd(n,t+"background-",e),o=Nd(n,t,e),l=Nd(n,t+"background-",e),u=Ms(n,t+"font",e),h=oi(n,t+"max-angle",e),f=oi(n,t+"offset-x",e),m=oi(n,t+"offset-y",e),y=Yc(n,t+"overflow",e),x=Ms(n,t+"placement",e),T=oi(n,t+"repeat",e),I=Wp(n,t+"scale",e),S=Yc(n,t+"rotate-with-view",e),A=oi(n,t+"rotation",e),D=Ms(n,t+"align",e),N=Ms(n,t+"justify",e),R=Ms(n,t+"baseline",e),L=Yc(n,t+"keep-upright",e),j=xP(n,t+"padding",e),k=Gp(n,t+"declutter-mode"),b=new lf({declutterMode:k});return function(M){if(b.setText(i(M)),r&&b.setFill(r(M)),s&&b.setBackgroundFill(s(M)),o&&b.setStroke(o(M)),l&&b.setBackgroundStroke(l(M)),u&&b.setFont(u(M)),h&&b.setMaxAngle(h(M)),f&&b.setOffsetX(f(M)),m&&b.setOffsetY(m(M)),y&&b.setOverflow(y(M)),x){const V=x(M);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");b.setPlacement(V)}if(T&&b.setRepeat(T(M)),I&&b.setScale(I(M)),S&&b.setRotateWithView(S(M)),A&&b.setRotation(A(M)),D){const V=D(M);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");b.setTextAlign(V)}if(N){const V=N(M);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");b.setJustify(V)}if(R){const V=R(M);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");b.setTextBaseline(V)}return j&&b.setPadding(j(M)),L&&b.setKeepUpright(L(M)),b}}function L3(n,e){return"icon-src"in n?O3(n,e):"shape-points"in n?F3(n,e):"circle-radius"in n?V3(n,e):null}function O3(n,e){const t="icon-",i=t+"src",r=wP(n[i],i),s=Wm(n,t+"anchor",e),o=Wp(n,t+"scale",e),l=oi(n,t+"opacity",e),u=Wm(n,t+"displacement",e),h=oi(n,t+"rotation",e),f=Yc(n,t+"rotate-with-view",e),m=fC(n,t+"anchor-origin"),y=gC(n,t+"anchor-x-units"),x=gC(n,t+"anchor-y-units"),T=W3(n,t+"color"),I=U3(n,t+"cross-origin"),S=B3(n,t+"offset"),A=fC(n,t+"offset-origin"),D=Gm(n,t+"width"),N=Gm(n,t+"height"),R=z3(n,t+"size"),L=Gp(n,t+"declutter-mode"),j=new k1({src:r,anchorOrigin:m,anchorXUnits:y,anchorYUnits:x,color:T,crossOrigin:I,offset:S,offsetOrigin:A,height:N,width:D,size:R,declutterMode:L});return function(k){return l&&j.setOpacity(l(k)),u&&j.setDisplacement(u(k)),h&&j.setRotation(h(k)),f&&j.setRotateWithView(f(k)),o&&j.setScale(o(k)),s&&j.setAnchor(s(k)),j}}function F3(n,e){const t="shape-",i=t+"points",r=t+"radius",s=Mv(n[i],i),o=Mv(n[r],r),l=kd(n,t,e),u=Nd(n,t,e),h=Wp(n,t+"scale",e),f=Wm(n,t+"displacement",e),m=oi(n,t+"rotation",e),y=Yc(n,t+"rotate-with-view",e),x=Gm(n,t+"radius2"),T=Gm(n,t+"angle"),I=Gp(n,t+"declutter-mode"),S=new Bp({points:s,radius:o,radius2:x,angle:T,declutterMode:I});return function(A){return l&&S.setFill(l(A)),u&&S.setStroke(u(A)),f&&S.setDisplacement(f(A)),m&&S.setRotation(m(A)),y&&S.setRotateWithView(y(A)),h&&S.setScale(h(A)),S}}function V3(n,e){const t="circle-",i=kd(n,t,e),r=Nd(n,t,e),s=oi(n,t+"radius",e),o=Wp(n,t+"scale",e),l=Wm(n,t+"displacement",e),u=oi(n,t+"rotation",e),h=Yc(n,t+"rotate-with-view",e),f=Gp(n,t+"declutter-mode"),m=new Nl({radius:5,declutterMode:f});return function(y){return s&&m.setRadius(s(y)),i&&m.setFill(i(y)),r&&m.setStroke(r(y)),l&&m.setDisplacement(l(y)),u&&m.setRotation(u(y)),h&&m.setRotateWithView(h(y)),o&&m.setScale(o(y)),m}}function oi(n,e,t){if(!(e in n))return;const i=Qs(n[e],qe,t);return function(r){return Mv(i(r),e)}}function Ms(n,e,t){if(!(e in n))return null;const i=Qs(n[e],ni,t);return function(r){return wP(i(r),e)}}function j3(n,e,t){const i=Ms(n,e+"pattern-src",t),r=dC(n,e+"pattern-offset",t),s=dC(n,e+"pattern-size",t),o=D1(n,e+"color",t);return function(l){return{src:i(l),offset:r&&r(l),size:s&&s(l),color:o&&o(l)}}}function Yc(n,e,t){if(!(e in n))return null;const i=Qs(n[e],Un,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function D1(n,e,t){if(!(e in n))return null;const i=Qs(n[e],mr,t);return function(r){return EP(i(r),e)}}function xP(n,e,t){if(!(e in n))return null;const i=Qs(n[e],_l,t);return function(r){return uf(i(r),e)}}function Wm(n,e,t){if(!(e in n))return null;const i=Qs(n[e],_l,t);return function(r){const s=uf(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function dC(n,e,t){if(!(e in n))return null;const i=Qs(n[e],_l,t);return function(r){return TP(i(r),e)}}function Wp(n,e,t){if(!(e in n))return null;const i=Qs(n[e],_l|qe,t);return function(r){return G3(i(r),e)}}function Gm(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function z3(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return ai(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function U3(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function fC(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function gC(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function B3(n,e){const t=n[e];if(t!==void 0)return uf(t,e)}function Gp(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function W3(n,e){const t=n[e];if(t!==void 0)return EP(t,e)}function uf(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function wP(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function Mv(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function EP(n,e){if(typeof n=="string")return n;const t=uf(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function TP(n,e){const t=uf(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function G3(n,e){return typeof n=="number"?n:TP(n,e)}const hr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function mC(n,e,t){return(function(i,r,s,o,l){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,f=l?l[0]:0,m=l?l[1]:0;let y=n[0]+u/2+f,x=n[2]-u/2+f,T=n[1]+h/2+m,I=n[3]-h/2+m;y>x&&(y=(x+y)/2,x=y),T>I&&(T=(I+T)/2,I=T);let S=Dt(i[0],y,x),A=Dt(i[1],T,I);if(o&&t&&r){const D=30*r;S+=-D*Math.log(1+Math.max(0,y-i[0])/D)+D*Math.log(1+Math.max(0,i[0]-x)/D),A+=-D*Math.log(1+Math.max(0,T-i[1])/D)+D*Math.log(1+Math.max(0,i[1]-I)/D)}return[S,A]})}function $3(n){return n}function SP(n){return Math.pow(n,3)}function Nu(n){return 1-SP(1-n)}function K3(n){return 3*n*n-2*n*n*n}function H3(n){return n}function M1(n,e,t,i){const r=ft(e)/t[0],s=Bn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function L1(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Dt(i,t/2,e*2)}function X3(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,l){if(r!==void 0){const u=n[0],h=n[n.length-1],f=t?M1(u,t,o,i):u;if(l)return e?L1(r,f,h):Dt(r,h,f);const m=Math.min(f,r),y=Math.floor(l1(n,m,s));return n[y]>f&&y<n.length-1?n[y+1]:n[y]}})}function q3(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,l,u,h){if(o!==void 0){const f=r?M1(e,r,u,s):e;if(h)return i?L1(o,f,t):Dt(o,t,f);const m=1e-9,y=Math.ceil(Math.log(e/f)/Math.log(n)-m),x=-l*(.5-m)+.5,T=Math.min(f,o),I=Math.floor(Math.log(e/T)/Math.log(n)+x),S=Math.max(y,I),A=e/Math.pow(n,S);return Dt(A,t,f)}})}function pC(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,l,u){if(s!==void 0){const h=i?M1(n,i,l,r):n;return!t||!u?Dt(s,e,h):L1(s,h,e)}})}function O1(n){if(n!==void 0)return 0}function yC(n){if(n!==void 0)return n}function Y3(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function Z3(n){const e=Xo(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const Q3=42,F1=256,I0=0;class Qr extends us{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=y1(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Mb(),e.center&&(e.center=Ds(e.center,this.projection_)),e.extent&&(e.extent=Go(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const l in hr)delete t[l];this.setProperties(t,!0);const i=e6(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=J3(e),s=i.constraint,o=t6(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),l=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ds(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ds(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const f=arguments[r];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(r===t){i&&Kg(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const f=arguments[r],m={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||K3,callback:i};if(f.center&&(m.sourceCenter=o,m.targetCenter=f.center.slice(),o=m.targetCenter),f.zoom!==void 0?(m.sourceResolution=l,m.targetResolution=this.getResolutionForZoom(f.zoom),l=m.targetResolution):f.resolution&&(m.sourceResolution=l,m.targetResolution=f.resolution,l=m.targetResolution),f.rotation!==void 0){m.sourceRotation=u;const y=al(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;m.targetRotation=u+y,u=m.targetRotation}n6(m)?m.complete=!0:s+=m.duration,h.push(m)}this.animations_.push(h),this.setHint(Mn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Mn.ANIMATING]>0}getInteracting(){return this.hints_[Mn.INTERACTING]>0}cancelAnimations(){this.setHint(Mn.ANIMATING,-this.hints_[Mn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&Kg(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const l=r[s];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,l=r.length;o<l;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let f=u.duration>0?h/u.duration:1;f>=1?(u.complete=!0,f=1):s=!1;const m=u.easing(f);if(u.sourceCenter){const y=u.sourceCenter[0],x=u.sourceCenter[1],T=u.targetCenter[0],I=u.targetCenter[1];this.nextCenter_=u.targetCenter;const S=y+m*(T-y),A=x+m*(I-x);this.targetCenter_=[S,A]}if(u.sourceResolution&&u.targetResolution){const y=m===1?u.targetResolution:u.sourceResolution+m*(u.targetResolution-u.sourceResolution);if(u.anchor){const x=this.getViewportSize_(this.getRotation()),T=this.constraints_.resolution(y,0,x,!0);this.targetCenter_=this.calculateCenterZoom(T,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const y=m===1?al(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+m*(u.targetRotation-u.sourceRotation);if(u.anchor){const x=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(x,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=y}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Mn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Kg(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],d1(i,e-this.getRotation()),$5(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,l=t[1]-e*(t[1]-r[1])/s;i=[o,l]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Rv(e,this.getProjection())}getCenterInternal(){return this.get(hr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return Lb(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();lt(t,"The view center is not defined");const i=this.getResolution();lt(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return lt(r!==void 0,"The view rotation is not defined"),Ev(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(hr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Go(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=ft(e)/t[0],r=Bn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(hr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=C0(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=l1(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Dt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Dt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(lt(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){lt(!Op(e),"Cannot fit empty extent provided as `geometry`");const r=Go(e,this.getProjection());i=qI(r)}else if(e.getType()==="Circle"){const r=Go(e.getExtent(),this.getProjection());i=qI(r),i.rotate(this.getRotation(),gl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let l=1/0,u=1/0,h=-1/0,f=-1/0;for(let m=0,y=s.length;m<y;m+=o){const x=s[m]*i-s[m+1]*r,T=s[m]*r+s[m+1]*i;l=Math.min(l,x),u=Math.min(u,T),h=Math.max(h,x),f=Math.max(f,T)}return[l,u,h,f]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const l=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(l,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),f=Math.sin(h),m=Math.cos(h),y=gl(l);y[0]+=(r[1]-r[3])/2*u,y[1]+=(r[0]-r[2])/2*u;const x=y[0]*m-y[1]*f,T=y[1]*m+y[0]*f,I=this.getConstrainedCenter([x,T],u),S=t.callback?t.callback:Ed;t.duration!==void 0?this.animateInternal({resolution:u,center:I,duration:t.duration,easing:t.easing},S):(this.targetResolution_=u,this.targetCenter_=I,this.applyTargetState_(!1,!0),Kg(S,!0))}centerOn(e,t,i){this.centerOnInternal(Ds(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(C0(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const l=this.getViewportSizeMinusPadding_(-i),u=C0(e,r,[l[0]/2+o[3],l[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Rv(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ds(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ds(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ds(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),l=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(hr.ROTATION)!==r&&this.set(hr.ROTATION,r),this.get(hr.RESOLUTION)!==o&&(this.set(hr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(hr.CENTER)||!Dm(this.get(hr.CENTER),l))&&this.set(hr.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!Dm(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:e,easing:Nu,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Mn.INTERACTING,1)}endInteraction(e,t,i){i=i&&Ds(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Mn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Kg(n,e){setTimeout(function(){n(e)},0)}function J3(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return mC(n.extent,n.constrainOnlyCenter,t)}const e=y1(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,mC(t,!1,!1)}return $3}function e6(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:I0,l=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,f=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,m=n.showFullExtent!==void 0?n.showFullExtent:!1,y=y1(n.projection,"EPSG:3857"),x=y.getExtent();let T=n.constrainOnlyCenter,I=n.extent;if(!h&&!I&&y.isGlobal()&&(T=!1,I=x),n.resolutions!==void 0){const S=n.resolutions;t=S[o],i=S[l]!==void 0?S[l]:S[S.length-1],n.constrainResolution?e=X3(S,f,!T&&I,m):e=pC(t,i,f,!T&&I,m)}else{const A=(x?Math.max(ft(x),Bn(x)):360*cu.degrees/y.getMetersPerUnit())/F1/Math.pow(2,I0),D=A/Math.pow(2,28-I0);t=n.maxResolution,t!==void 0?o=0:t=A/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,l):i=A/Math.pow(u,l):i=D),l=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,l-o),n.constrainResolution?e=q3(u,t,i,f,!T&&I,m):e=pC(t,i,f,!T&&I,m)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function t6(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?Z3():t===!1?yC:typeof t=="number"?Y3(t):yC}return O1}function n6(n){return!(n.sourceCenter&&n.targetCenter&&!Dm(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function C0(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),l=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;l+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=l*s-u*o,f=u*s+l*o;return[h,f]}const dt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class IP extends us{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[dt.OPACITY]=e.opacity!==void 0?e.opacity:1,lt(typeof t[dt.OPACITY]=="number","Layer opacity must be a number"),t[dt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[dt.Z_INDEX]=e.zIndex,t[dt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[dt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[dt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[dt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Dt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return tt()}getLayerStatesArray(e){return tt()}getExtent(){return this.get(dt.EXTENT)}getMaxResolution(){return this.get(dt.MAX_RESOLUTION)}getMinResolution(){return this.get(dt.MIN_RESOLUTION)}getMinZoom(){return this.get(dt.MIN_ZOOM)}getMaxZoom(){return this.get(dt.MAX_ZOOM)}getOpacity(){return this.get(dt.OPACITY)}getSourceState(){return tt()}getVisible(){return this.get(dt.VISIBLE)}getZIndex(){return this.get(dt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(dt.EXTENT,e)}setMaxResolution(e){this.set(dt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(dt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(dt.MAX_ZOOM,e)}setMinZoom(e){this.set(dt.MIN_ZOOM,e)}setOpacity(e){lt(typeof e=="number","Layer opacity must be a number"),this.set(dt.OPACITY,e)}setVisible(e){this.set(dt.VISIBLE,e)}setZIndex(e){this.set(dt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class $p extends IP{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(dt.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(dt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(At(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=nt(e,We.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Qr?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return V1(r,t.viewState)&&(!s||si(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof Qr?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(dt.MAP,e)}getMapInternal(){return this.get(dt.MAP)}setMap(e){this.mapPrecomposeKey_&&(At(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(At(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=nt(e,qi.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=nt(this,We.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);lt(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(dt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function V1(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const _C={RENDER_ORDER:"renderOrder"};class CP extends $p{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(_C.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new cP(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(_C.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?hP:e;const t=i6(e);this.styleFunction_=e===null?void 0:j4(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function i6(n){if(n===void 0)return hP;if(!n)return null;if(typeof n=="function"||n instanceof Qi)return n;if(!Array.isArray(n))return hC([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Qi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Qi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return N3(r)}return hC(n)}class j1 extends CP{constructor(e){super(e)}createRenderer(){return new o3(this)}}const bo={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class jo extends Zs{constructor(e,t){super(e),this.layer=t}}const R0={LAYERS:"layers"};class Du extends IP{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(R0.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Xi(i.slice(),{unique:!0}):lt(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Xi(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(At),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(nt(e,ei.ADD,this.handleLayersAdd_,this),nt(e,ei.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(At);nf(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new jo(bo.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[nt(e,su.PROPERTYCHANGE,this.handleLayerChange_,this),nt(e,We.CHANGE,this.handleLayerChange_,this)];e instanceof Du&&t.push(nt(e,bo.ADDLAYER,this.handleLayerGroupAdd_,this),nt(e,bo.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[it(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new jo(bo.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new jo(bo.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new jo(bo.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=it(t);this.listenerKeys_[i].forEach(At),delete this.listenerKeys_[i],this.dispatchEvent(new jo(bo.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(R0.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new jo(bo.REMOVELAYER,i[r]))}this.set(R0.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,l=t.length;o<l;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=ol(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}}const Re={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class z1 extends kp{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(We.CHANGE)}release(){this.setState(Re.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Re.EMPTY){if(this.state!==Re.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){tt()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:SP(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Lv(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const r6=new Error("disposed"),s6=[256,256];class vC extends z1{constructor(e){const t=Re.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Lv(this.data_);return e?[e.width,e.height]:s6}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Re.IDLE&&this.state!==Re.ERROR)return;this.state=Re.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Re.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Re.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(r6),this.controller_=null),super.disposeInternal()}}class RP extends z1{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Si?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Re.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Re.ERROR,this.unlistenImage_(),this.image_=o6(),this.changed()}handleImageLoad_(){if(Si)this.state=Re.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Re.LOADED:this.state=Re.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Re.ERROR&&(this.state=Re.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Re.IDLE&&(this.state=Re.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=e4(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function o6(){const n=Jt(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let A0;const Zc=[];function xC(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function b0(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function a6(){if(A0===void 0){const n=Jt(6,6,Zc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",xC(n,4,5,4,0),xC(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;A0=b0(e,0)||b0(e,4)||b0(e,8),zp(n),Zc.push(n.canvas)}return A0}function wC(n,e,t,i){const r=jp(t,e,n);let s=Om(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const l=n.getMetersPerUnit();l!==void 0&&(s/=l);const u=n.getExtent();if(!u||lu(u,r)){const h=Om(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function l6(n,e,t,i){const r=gl(t);let s=wC(n,e,r,i);return(!isFinite(s)||s<=0)&&Tb(t,function(o){return s=wC(n,e,o,i),isFinite(s)&&s>0}),s}function c6(n,e,t,i,r,s,o,l,u,h,f,m,y,x){const T=Jt(Math.round(t*n),Math.round(t*e),Zc);if(m||(T.imageSmoothingEnabled=!1),u.length===0)return T.canvas;T.scale(t,t);function I(L){return Math.round(L*t)/t}T.globalCompositeOperation="lighter";const S=Ji();u.forEach(function(L,j,k){V5(S,L.extent)});let A;const D=t/i,N=(m?1:1+Math.pow(2,-24))/D;A=Jt(Math.round(ft(S)*D),Math.round(Bn(S)*D),Zc),m||(A.imageSmoothingEnabled=!1),u.forEach(function(L,j,k){if(L.image.width>0&&L.image.height>0){if(L.clipExtent){A.save();const B=(L.clipExtent[0]-S[0])*D,O=-(L.clipExtent[3]-S[3])*D,le=ft(L.clipExtent)*D,me=Bn(L.clipExtent)*D;A.rect(m?B:Math.round(B),m?O:Math.round(O),m?le:Math.round(B+le)-Math.round(B),m?me:Math.round(O+me)-Math.round(O)),A.clip()}const b=(L.extent[0]-S[0])*D,M=-(L.extent[3]-S[3])*D,V=ft(L.extent)*D,z=Bn(L.extent)*D;A.drawImage(L.image,h,h,L.image.width-2*h,L.image.height-2*h,m?b:Math.round(b),m?M:Math.round(M),m?V:Math.round(b+V)-Math.round(b),m?z:Math.round(M+z)-Math.round(M)),L.clipExtent&&A.restore()}});const R=kl(o);return l.getTriangles().forEach(function(L,j,k){const b=L.source,M=L.target;let V=b[0][0],z=b[0][1],B=b[1][0],O=b[1][1],le=b[2][0],me=b[2][1];const ge=I((M[0][0]-R[0])/s),ue=I(-(M[0][1]-R[1])/s),Q=I((M[1][0]-R[0])/s),se=I(-(M[1][1]-R[1])/s),ne=I((M[2][0]-R[0])/s),G=I(-(M[2][1]-R[1])/s),$=V,ie=z;V=0,z=0,B-=$,O-=ie,le-=$,me-=ie;const pe=[[B,O,0,0,Q-ge],[le,me,0,0,ne-ge],[0,0,B,O,se-ue],[0,0,le,me,G-ue]],xe=G5(pe);if(!xe)return;if(T.save(),T.beginPath(),a6()||!m){T.moveTo(Q,se);const Me=4,je=ge-Q,Ge=ue-se;for(let ct=0;ct<Me;ct++)T.lineTo(Q+I((ct+1)*je/Me),se+I(ct*Ge/(Me-1))),ct!=Me-1&&T.lineTo(Q+I((ct+1)*je/Me),se+I((ct+1)*Ge/(Me-1)));T.lineTo(ne,G)}else T.moveTo(Q,se),T.lineTo(ge,ue),T.lineTo(ne,G);T.clip(),T.transform(xe[0],xe[2],xe[1],xe[3],ge,ue),T.translate(S[0]-$,S[3]-ie);let ke;if(A)ke=A.canvas,T.scale(N,-N);else{const Me=u[0],je=Me.extent;ke=Me.image,T.scale(ft(je)/ke.width,-Bn(je)/ke.height)}T.drawImage(ke,0,0),T.restore()}),A&&(zp(A),Zc.push(A.canvas)),f&&(T.save(),T.globalCompositeOperation="source-over",T.strokeStyle="black",T.lineWidth=1,l.getTriangles().forEach(function(L,j,k){const b=L.target,M=(b[0][0]-R[0])/s,V=-(b[0][1]-R[1])/s,z=(b[1][0]-R[0])/s,B=-(b[1][1]-R[1])/s,O=(b[2][0]-R[0])/s,le=-(b[2][1]-R[1])/s;T.beginPath(),T.moveTo(z,B),T.lineTo(M,V),T.lineTo(O,le),T.closePath(),T.stroke()}),T.restore()),T.canvas}const u6=10,EC=.25;class h6{constructor(e,t,i,r,s,o,l){this.sourceProj_=e,this.targetProj_=t;let u={};const h=l?wj(N=>un(l,jp(N,this.targetProj_,this.sourceProj_))):Fm(this.targetProj_,this.sourceProj_);this.transformInv_=function(N){const R=N[0]+"/"+N[1];return u[R]||(u[R]=h(N)),u[R]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ft(r)>=ft(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ft(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ft(this.targetProj_.getExtent()):null;const f=kl(i),m=Lp(i),y=Mp(i),x=Dp(i),T=this.transformInv_(f),I=this.transformInv_(m),S=this.transformInv_(y),A=this.transformInv_(x),D=u6+(o?Math.max(0,Math.ceil(Math.log2(wv(i)/(o*o*256*256)))):0);if(this.addQuad_(f,m,y,x,T,I,S,A,D),this.wrapsXInSource_){let N=1/0;this.triangles_.forEach(function(R,L,j){N=Math.min(N,R.source[0][0],R.source[1][0],R.source[2][0])}),this.triangles_.forEach(R=>{if(Math.max(R.source[0][0],R.source[1][0],R.source[2][0])-N>this.sourceWorldWidth_/2){const L=[[R.source[0][0],R.source[0][1]],[R.source[1][0],R.source[1][1]],[R.source[2][0],R.source[2][1]]];L[0][0]-N>this.sourceWorldWidth_/2&&(L[0][0]-=this.sourceWorldWidth_),L[1][0]-N>this.sourceWorldWidth_/2&&(L[1][0]-=this.sourceWorldWidth_),L[2][0]-N>this.sourceWorldWidth_/2&&(L[2][0]-=this.sourceWorldWidth_);const j=Math.min(L[0][0],L[1][0],L[2][0]);Math.max(L[0][0],L[1][0],L[2][0])-j<this.sourceWorldWidth_/2&&(R.source=L)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,l,u,h){const f=EI([s,o,l,u]),m=this.sourceWorldWidth_?ft(f)/this.sourceWorldWidth_:null,y=this.sourceWorldWidth_,x=this.sourceProj_.canWrapX()&&m>.5&&m<1;let T=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const S=EI([e,t,i,r]);T=ft(S)/this.targetWorldWidth_>EC||T}!x&&this.sourceProj_.isGlobal()&&m&&(T=m>EC||T)}if(!T&&this.maxSourceExtent_&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3])&&!si(f,this.maxSourceExtent_))return;let I=0;if(!T&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)T=!0;else if(I=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),I!=1&&I!=2&&I!=4&&I!=8)return}if(h>0){if(!T){const S=[(e[0]+i[0])/2,(e[1]+i[1])/2],A=this.transformInv_(S);let D;x?D=(al(s[0],y)+al(l[0],y))/2-al(A[0],y):D=(s[0]+l[0])/2-A[0];const N=(s[1]+l[1])/2-A[1];T=D*D+N*N>this.errorThresholdSquared_}if(T){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const S=[(t[0]+i[0])/2,(t[1]+i[1])/2],A=this.transformInv_(S),D=[(r[0]+e[0])/2,(r[1]+e[1])/2],N=this.transformInv_(D);this.addQuad_(e,t,S,D,s,o,A,N,h-1),this.addQuad_(D,S,i,r,N,A,l,u,h-1)}else{const S=[(e[0]+t[0])/2,(e[1]+t[1])/2],A=this.transformInv_(S),D=[(i[0]+r[0])/2,(i[1]+r[1])/2],N=this.transformInv_(D);this.addQuad_(e,S,D,r,s,A,N,u,h-1),this.addQuad_(S,t,i,D,A,o,l,N,h-1)}return}}if(x){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(I&11)==0&&this.addTriangle_(e,i,r,s,l,u),(I&14)==0&&this.addTriangle_(e,i,t,s,l,o),I&&((I&13)==0&&this.addTriangle_(t,r,e,o,u,s),(I&7)==0&&this.addTriangle_(t,r,i,o,u,l))}calculateSourceExtent(){const e=Ji();return this.triangles_.forEach(function(t,i,r){const s=t.source;ed(e,s[0]),ed(e,s[1]),ed(e,s[2])}),e}getTriangles(){return this.triangles_}}const d6=.5;class AP extends z1{constructor(e,t,i,r,s,o,l,u,h,f,m,y){super(s,Re.IDLE,y),this.renderEdges_=m!==void 0?m:!1,this.pixelRatio_=l,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const x=r.getTileCoordExtent(this.wrappedTileCoord_),T=this.targetTileGrid_.getExtent();let I=this.sourceTileGrid_.getExtent();const S=T?ol(x,T):x;if(wv(S)===0){this.state=Re.EMPTY;return}const A=e.getExtent();A&&(I?I=ol(I,A):I=A);const D=r.getResolution(this.wrappedTileCoord_[0]),N=l6(e,i,S,D);if(!isFinite(N)||N<=0){this.state=Re.EMPTY;return}const R=f!==void 0?f:d6;if(this.triangulation_=new h6(e,i,S,I,N*R,D),this.triangulation_.getTriangles().length===0){this.state=Re.EMPTY;return}this.sourceZ_=t.getZForResolution(N);let L=this.triangulation_.calculateSourceExtent();if(I&&(e.canWrapX()?(L[1]=Dt(L[1],I[1],I[3]),L[3]=Dt(L[3],I[1],I[3])):L=ol(L,I)),!wv(L))this.state=Re.EMPTY;else{let j=0,k=0;e.canWrapX()&&(j=ft(A),k=Math.floor((L[0]-A[0])/j)),Cb(L.slice(),e,!0).forEach(M=>{const V=t.getTileRangeForExtentAndZ(M,this.sourceZ_);for(let z=V.minX;z<=V.maxX;z++)for(let B=V.minY;B<=V.maxY;B++){const O=h(this.sourceZ_,z,B,l);if(O){const le=k*j;this.sourceTiles_.push({tile:O,offset:le})}}++k}),this.sourceTiles_.length===0&&(this.state=Re.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==Re.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Re.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=c6(r,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Re.LOADED}this.changed()}load(){if(this.state==Re.IDLE){this.state=Re.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==Re.IDLE||i==Re.LOADING){e++;const r=nt(t,We.CHANGE,s=>{const o=t.getState();(o==Re.LOADED||o==Re.ERROR||o==Re.EMPTY)&&(At(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==Re.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(At),this.sourcesListenerKeys_=null}release(){this.canvas_&&(zp(this.canvas_.getContext("2d")),Zc.push(this.canvas_),this.canvas_=null),super.release()}}class U1{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Tc(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new U1(n,e,t,i)}class TC{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof bp&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return lt(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return lt(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){lt(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function $m(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function f6(n,e,t){return n+"/"+e+"/"+t}function um(n,e,t,i,r){return`${it(n)},${e},${f6(t,i,r)}`}function g6(n){return m6(n[0],n[1],n[2])}function m6(n,e,t){return(e<<n)+t}function p6(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function P0(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function y6(n,e,t){const i=n[t];return i?i.delete(e):!1}function SC(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=ol(e,Go(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=ol(e,r))}return e}class _6 extends pP{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Ji(),this.tempTileRange_=new U1(0,0,0,0),this.tempTileCoord_=$m(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new TC(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new TC(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,l=this.getLayer().getSource(),u=um(l,l.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const f=r.viewState.projection,m=l.getProjection();if(h=l.getTile(e,t,i,r.pixelRatio,f,!m||cm(m,f)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=un(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!lu(s,r))return null;const o=t.viewState,l=i.getRenderSource(),u=l.getTileGridForProjection(o.projection),h=l.getTilePixelRatio(t.pixelRatio);for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const m=u.getTileCoordForCoordAndZ(r,f),y=this.getTile(f,m[1],m[2],t);if(!y||y.getState()!==Re.LOADED)continue;const x=u.getOrigin(f),T=ai(u.getTileSize(f)),I=u.getResolution(f);let S;if(y instanceof RP||y instanceof AP)S=y.getImage();else if(y instanceof vC){if(S=Lv(y.getData()),!S)continue}else continue;const A=Math.floor(h*((r[0]-x[0])/I-m[1]*T[0])),D=Math.floor(h*((x[1]-r[1])/I-m[2]*T[1])),N=Math.round(h*l.getGutterForProjection(o.projection));return this.getImageData(S,A+N,D+N)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,l=this.getLayer(),u=l.getRenderSource(),h=u.getTileGridForProjection(o.projection),f=it(u);f in e.wantedTiles||(e.wantedTiles[f]={});const m=e.wantedTiles[f],y=l.getMapInternal(),x=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(l.getMaxResolution(),y?y.getView().getResolutionForZoom(Math.max(l.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),T=o.rotation,I=T?Sb(o.center,o.resolution,T,e.size):void 0;for(let S=i;S>=x;--S){const A=h.getTileRangeForExtentAndZ(t,S,this.tempTileRange_),D=h.getResolution(S);for(let N=A.minX;N<=A.maxX;++N)for(let R=A.minY;R<=A.maxY;++R){if(T&&!h.tileCoordIntersectsViewport([S,N,R],I))continue;const L=this.getTile(S,N,R,e);if(!L||!P0(r,L,S))continue;const k=L.getKey();if(m[k]=!0,L.getState()===Re.IDLE&&!e.tileQueue.isKeyQueued(k)){const b=$m(S,N,R,this.tempTileCoord_);e.tileQueue.enqueue([L,f,h.getTileCoordCenter(b),D])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],l=this.getStaleKeys();for(let u=0;u<l.length;++u){const h=um(this.getLayer().getSource(),l[u],r,s,o);if(i.containsKey(h)){const f=i.peek(h);if(f.getState()===Re.LOADED)return f.endTransition(it(this)),P0(t,f,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const l=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let f=s.minX;f<=s.maxX;++f)for(let m=s.minY;m<=s.maxY;++m){const y=um(u,h,i,f,m);let x=!1;if(l.containsKey(y)){const T=l.peek(y);T.getState()===Re.LOADED&&(P0(r,T,i),x=!0)}x||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,l=r.center,u=e.pixelRatio,h=this.getLayer(),f=h.getSource(),m=f.getTileGridForProjection(s),y=m.getZForResolution(o,f.zDirection),x=m.getResolution(y),T=f.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==T&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=T):this.renderedSourceKey_=T;let I=e.extent;const S=f.getTilePixelRatio(u);this.prepareContainer(e,t);const A=this.context.canvas.width,D=this.context.canvas.height,N=i.extent&&Go(i.extent);N&&(I=ol(I,Go(i.extent)));const R=x*A/2/S,L=x*D/2/S,j=[l[0]-R,l[1]-L,l[0]+R,l[1]+L],k={};this.renderedTiles.length=0;const b=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const Q=m.getZForResolution(r.nextResolution,f.zDirection),se=SC(e,e.nextExtent);this.enqueueTiles(e,se,Q,k,b)}const M=SC(e,I);if(this.enqueueTiles(e,M,y,k,0),b>0&&setTimeout(()=>{this.enqueueTiles(e,M,y-1,k,b-1)},0),!(y in k))return this.container;const V=it(this),z=e.time;for(const Q of k[y]){const se=Q.getState();if(se===Re.EMPTY)continue;const ne=Q.tileCoord;if(se===Re.LOADED&&Q.getAlpha(V,z)===1){Q.endTransition(V);continue}if(se!==Re.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,k)){y6(k,Q,y),e.animate=!0;continue}if(this.findAltTiles_(m,ne,y+1,k))continue;const ie=m.getMinZoom();for(let pe=y-1;pe>=ie&&!this.findAltTiles_(m,ne,pe,k);--pe);}const B=x/o*u/S,O=this.getRenderContext(e);Hs(this.tempTransform,A/2,D/2,B,B,0,-A/2,-D/2),i.extent&&this.clipUnrotated(O,e,N),f.getInterpolate()||(O.imageSmoothingEnabled=!1),this.preRender(O,e);const le=Object.keys(k).map(Number);le.sort(Bs);let me;const ge=[],ue=[];for(let Q=le.length-1;Q>=0;--Q){const se=le[Q],ne=f.getTilePixelSize(se,u,s),$=m.getResolution(se)/x,ie=ne[0]*$*B,pe=ne[1]*$*B,xe=m.getTileCoordForCoordAndZ(kl(j),se),ke=m.getTileCoordExtent(xe),Me=un(this.tempTransform,[S*(ke[0]-j[0])/x,S*(j[3]-ke[3])/x]),je=S*f.getGutterForProjection(s);for(const Ge of k[se]){if(Ge.getState()!==Re.LOADED)continue;const ct=Ge.tileCoord,er=xe[1]-ct[1],fs=Math.round(Me[0]-(er-1)*ie),Gn=xe[2]-ct[2],$n=Math.round(Me[1]-(Gn-1)*pe),hn=Math.round(Me[0]-er*ie),dn=Math.round(Me[1]-Gn*pe),Kn=fs-hn,Pi=$n-dn,_t=le.length===1;let ut=!1;me=[hn,dn,hn+Kn,dn,hn+Kn,dn+Pi,hn,dn+Pi];for(let nn=0,ki=ge.length;nn<ki;++nn)if(!_t&&se<ue[nn]){const It=ge[nn];si([hn,dn,hn+Kn,dn+Pi],[It[0],It[3],It[4],It[7]])&&(ut||(O.save(),ut=!0),O.beginPath(),O.moveTo(me[0],me[1]),O.lineTo(me[2],me[3]),O.lineTo(me[4],me[5]),O.lineTo(me[6],me[7]),O.moveTo(It[6],It[7]),O.lineTo(It[4],It[5]),O.lineTo(It[2],It[3]),O.lineTo(It[0],It[1]),O.clip())}ge.push(me),ue.push(se),this.drawTile(Ge,e,hn,dn,Kn,Pi,je,_t),ut&&O.restore(),this.renderedTiles.unshift(Ge),this.updateUsedTiles(e.usedTiles,f,Ge)}}if(this.renderedResolution=x,this.extentChanged=!this.renderedExtent_||!Td(this.renderedExtent_,j),this.renderedExtent_=j,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&O.restore(),O.imageSmoothingEnabled=!0,this.renderComplete){const Q=(se,ne)=>{const G=it(f),$=ne.wantedTiles[G],ie=$?Object.keys($).length:0;this.updateCacheSize(ie),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(Q)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,l,u){let h;if(e instanceof vC){if(h=Lv(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const f=this.getRenderContext(t),m=it(this),y=t.layerStatesArray[t.layerIndex],x=y.opacity*(u?e.getAlpha(m,t.time):1),T=x!==f.globalAlpha;T&&(f.save(),f.globalAlpha=x),f.drawImage(h,l,l,h.width-2*l,h.height-2*l,i,r,s,o),T&&f.restore(),x!==y.opacity?t.animate=!0:u&&e.endTransition(m)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=it(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Hg={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class v6 extends $p{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Hg.PRELOAD)}setPreload(e){this.set(Hg.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Hg.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Hg.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class k0 extends v6{constructor(e){super(e)}createRenderer(){return new _6(this,{cacheSize:this.getCacheSize()})}}const Sc=[0,0,0],Po=5;class bP{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,lt(D5(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,lt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=kl(i)),lt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,lt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:F1,lt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new U1(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(l.minX,o.minX),o.maxX=Math.min(l.maxX,o.maxX),o.minY=Math.max(l.minY,o.minY),o.maxY=Math.min(l.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let l=r.minY,u=r.maxY;l<=u;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,l,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],l=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&l!==void 0?(o=Math.floor(o/2),l=Math.floor(l/2),s=Tc(o,o,l,l,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Tc(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Tc(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),f=Math.floor(o*u);if(t<r)return Tc(h,h,f,f,i);const m=Math.floor(u*(s+1))-1,y=Math.floor(u*(o+1))-1;return Tc(h,m,f,y,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Sc);const r=Sc[1],s=Sc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Sc);const o=Sc[1],l=Sc[2];return Tc(r,o,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=ai(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=ai(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,l=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=l+s[1]*r;return na(o,l,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),l=i/this.getResolution(o),u=this.getOrigin(o),h=ai(this.getTileSize(o),this.tmpSize_);let f=l*(e-u[0])/i/h[0],m=l*(u[1]-t)/i/h[1];return r?(f=Vg(f,Po)-1,m=Vg(m,Po)-1):(f=Fg(f,Po),m=Fg(m,Po)),$m(o,f,m,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),l=this.getResolution(i),u=ai(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/l/u[0],f=(o[1]-t)/l/u[1];return r?(h=Vg(h,Po)-1,f=Vg(f,Po)-1):(h=Fg(h,Po),f=Fg(f,Po)),$m(i,h,f,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=l1(this.resolutions_,e,t||0);return Dt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return Gb(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function PP(n){let e=n.getDefaultTileGrid();return e||(e=T6(n),n.setDefaultTileGrid(e)),e}function x6(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=B1(t);if(!lu(s,r)){const o=ft(s),l=Math.ceil((s[0]-r[0])/o);return r[0]+=o*l,n.getTileCoordForCoordAndZ(r,i)}return e}function w6(n,e,t,i){i=i!==void 0?i:"top-left";const r=kP(n,e,t);return new bP({extent:n,origin:z5(n,i),resolutions:r,tileSize:t})}function E6(n){const e=n||{},t=e.extent||ci("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:kP(t,e.maxZoom,e.tileSize,e.maxResolution)};return new bP(i)}function kP(n,e,t,i){e=e!==void 0?e:Q3,t=ai(t!==void 0?t:F1);const r=Bn(n),s=ft(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,l=new Array(o);for(let u=0;u<o;++u)l[u]=i/Math.pow(2,u);return l}function T6(n,e,t,i){const r=B1(n);return w6(r,e,t,i)}function B1(n){n=ci(n);let e=n.getExtent();if(!e){const t=180*cu.degrees/n.getMetersPerUnit();e=na(-t,-t,t,t)}return e}function FX(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const S6=/\{z\}/g,I6=/\{x\}/g,C6=/\{y\}/g,R6=/\{-y\}/g;function A6(n,e,t,i,r){return n.replace(S6,e.toString()).replace(I6,t.toString()).replace(C6,i.toString()).replace(R6,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function b6(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function P6(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const l=e.getFullTileRange(o);l&&(s=l.getHeight()-1)}return A6(n,o,t[1],t[2],s)})}function k6(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=P6(n[r],e);return N6(i)}function N6(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=g6(e),s=al(r,n.length);return n[s](e,t,i)})}class D6 extends uP{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&ai(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||it(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return tt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:PP(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=ai(r.getTileSize(e),this.tmpSize);return s==1?o:V4(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=x6(r,e,i)),p6(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class M6 extends Zs{constructor(e,t){super(e),this.tile=t}}const N0={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class W1 extends D6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===W1.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=it(t),r=t.getState();let s;r==Re.LOADING?(this.tileLoadingKeys_[i]=!0,s=N0.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Re.ERROR?N0.TILELOADERROR:r==Re.LOADED?N0.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new M6(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=b6(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(k6(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class L6 extends W1{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:NP,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:RP,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!cm(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||cm(t,e)))return this.tileGrid;const i=it(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=PP(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const l=[e,t,i],u=this.getTileCoordForTileUrlFunction(l,s),h=u?this.tileUrlFunction(u,r,s):void 0,f=new this.tileClass(l,h!==void 0?Re.IDLE:Re.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(We.CHANGE,this.handleTileChange.bind(this)),f}getTile(e,t,i,r,s,o){const l=this.getProjection();if(!l||!s||cm(l,s))return this.getTileInternal(e,t,i,r,l||s);const u=[e,t,i],h=this.getKey(),f=this.getTileGridForProjection(l),m=this.getTileGridForProjection(s),y=this.getTileCoordForTileUrlFunction(u,s),x=new AP(l,f,s,m,u,y,this.getTilePixelRatio(r),this.getGutter(),(T,I,S,A)=>this.getTileInternal(T,I,S,A,l,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return x.key=h,x}getTileInternal(e,t,i,r,s,o){const l=this.getKey(),u=um(this,l,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,l);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=ci(e);if(i){const r=it(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function NP(n,e){if(Si){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Ov extends L6{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:E6({extent:B1(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const O6="modulepreload",F6=function(n){return"/visapp/"+n},IC={},Xg=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=F6(h),h in IC)return;IC[h]=!0;const f=h.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":O6,f||(y.as="script"),y.crossOrigin="",y.href=h,l&&y.setAttribute("nonce",l),document.head.appendChild(y),f)return new Promise((x,T)=>{y.addEventListener("load",x),y.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},V6='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class j6 extends Ov{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[V6];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const l=s.getImage();!Si&&l instanceof HTMLImageElement&&(l.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||NP)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const Km=1/0;class z6{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,nf(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){lt(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=Km?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],l=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),f=h<r&&i[h]<i[u]?h:u;t[e]=t[f],i[e]=i[f],e=f}t[e]=s,i[e]=o,this.siftDown_(l,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const l=this.getParentIndex_(t);if(r[l]>o)i[t]=i[l],r[t]=r[l],t=l;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,l,u;for(l=0;l<s;++l)o=t[l],u=e(o),u==Km?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class U6 extends z6{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(We.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===Re.LOADED||i===Re.ERROR||i===Re.EMPTY){i!==Re.ERROR&&t.removeEventListener(We.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===Re.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function B6(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Km;const s=n.viewState.center,o=i[0]-s[0],l=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+l*l)/r}class Lc extends Zs{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Fo extends Lc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Lt={SINGLECLICK:"singleclick",CLICK:We.CLICK,DBLCLICK:We.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Fv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class W6 extends kp{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=nt(i,Fv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=nt(i,Fv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(We.TOUCHMOVE,this.boundHandleTouchMove_,Xb?{passive:!1}:!1)}emulateClick_(e){let t=new Fo(Lt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Fo(Lt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Fo(Lt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Lt.POINTERUP||t.type==Lt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Lt.POINTERDOWN||t.type==Lt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Fo(Lt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(At),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Fo(Lt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(nt(i,Lt.POINTERMOVE,this.handlePointerMove_,this),nt(i,Lt.POINTERUP,this.handlePointerUp_,this),nt(this.element_,Lt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(nt(this.element_.getRootNode(),Lt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Fo(Lt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Fo(Lt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(At(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(We.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(At(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(At),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Vo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Nn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Kp extends us{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)At(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Ed&&this.listenerKeys.push(nt(e,Vo.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class G6 extends Kp{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const l=e.label!==void 0?e.label:"i";typeof l=="string"?(this.label_=document.createElement("span"),this.label_.textContent=l,this.label_.className=r):this.label_=l;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(We.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+af+" "+R1+(this.collapsed_&&this.collapsible_?" "+BI:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=h,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>M5(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!la(t,this.renderedAttributions_)){Wj(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(BI),this.collapsed_?zI(this.collapseLabel_,this.label_):zI(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class $6 extends Kp{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(We.CLICK,this.handleClick_.bind(this),!1);const l=t+" "+af+" "+R1,u=this.element;u.className=l,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ug)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Nu}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Ug);!s&&i===0?this.element.classList.add(Ug):s&&i!==0&&this.element.classList.remove(Ug)}this.label_.style.transform=r}this.rotation_=i}}class K6 extends Kp{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",l=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=r,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(We.CLICK,this.handleClick_.bind(this,i),!1);const m=document.createElement("button");m.className=s,m.setAttribute("type","button"),m.title=h,m.appendChild(typeof l=="string"?document.createTextNode(l):l),m.addEventListener(We.CLICK,this.handleClick_.bind(this,-i),!1);const y=t+" "+af+" "+R1,x=this.element;x.className=y,x.appendChild(f),x.appendChild(m),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Nu})):i.setZoom(s)}}}function H6(n){n=n||{};const e=new Xi;return(n.zoom===void 0||n.zoom)&&e.push(new K6(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new $6(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new G6(n.attributionOptions)),e}class X6{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const CC={ACTIVE:"active"};class hf extends us{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(CC.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(CC.ACTIVE,e)}setMap(e){this.map_=e}}function q6(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:H3,center:n.getConstrainedCenter(r)})}}function G1(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Nu})}class Y6 extends hf{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Lt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,l=r.getView();G1(l,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function Vv(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const Z6=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Q6=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},DP=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?Q6(n):!0},J6=wd,MP=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(Uj&&Kb&&e.ctrlKey)},LP=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},e9=function(n){const e=n.originalEvent;return Kb?e.metaKey:e.ctrlKey},t9=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},OP=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},D0=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},n9=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class df extends hf{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Lt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Lt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Lt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Lt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function $1(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class i9 extends df{constructor(e){super({stopDown:Pp}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Vv(LP,n9);this.condition_=e.onFocusOnly?Vv(DP,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel($1(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],l=e.map.getView();K5(s,l.getResolution()),d1(s,l.getRotation()),l.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),l=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([l[0]-r*Math.cos(s),l[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:Nu})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class r9 extends df{constructor(e){e=e||{},super({stopDown:Pp}),this.condition_=e.condition?e.condition:Z6,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!D0(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===O1)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const l=o-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=o}handleUpEvent(e){return D0(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return D0(e)&&MP(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class s9 extends bp{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Pd([r])}getGeometry(){return this.geometry_}}const Ic={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ph extends Zs{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class o9 extends df{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new s9(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??MP,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ph(Ic.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Ph(t?Ic.BOXEND:Ic.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ph(Ic.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Ic.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ph(Ic.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class a9 extends o9{constructor(e){e=e||{};const t=e.condition?e.condition:t9;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),l=i.getResolution()/o;r=r.clone(),r.scale(l*l)}i.fitInternal(r,{duration:this.duration_,easing:Nu})}}const Fa={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class l9 extends hf{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return LP(t)&&OP(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==We.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Fa.DOWN||r==Fa.LEFT||r==Fa.RIGHT||r==Fa.UP)){const o=e.map.getView(),l=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==Fa.DOWN?h=-l:r==Fa.LEFT?u=-l:r==Fa.RIGHT?u=l:h=l;const f=[u,h];d1(f,o.getRotation()),q6(o,f,this.duration_),i.preventDefault(),t=!0}}return!t}}class c9 extends hf{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!e9(t)&&OP(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==We.KEYDOWN||e.type==We.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,l=s.getView();G1(l,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const u9=40,h9=300;class d9 extends hf{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:J6;this.condition_=e.onFocusOnly?Vv(DP,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==We.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=u9;break;case WheelEvent.DOM_DELTA_PAGE:s*=h9;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const l=i.getView();if(this.mode_==="trackpad"&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),G1(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class f9 extends df{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Pp),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,l=o.getView();l.getConstraints().rotation!==O1&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel($1(this.targetPointers))),this.rotating_&&(o.render(),l.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class g9 extends df{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Pp),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,l=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/l),this.lastDistance_=l;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel($1(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function m9(n){n=n||{};const e=new Xi,t=new X6(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new r9),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new Y6({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new i9({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new f9),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new g9({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new l9),e.push(new c9({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new d9({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new a9({duration:n.zoomDuration})),e}class p9 extends bp{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){tt()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;Hs(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),Ob(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,l,u){let h;const f=t.viewState;function m(R,L,j,k){return s.call(o,L,R?j:null,k)}const y=f.projection,x=Rb(e.slice(),y),T=[[0,0]];if(y.canWrapX()&&r){const R=y.getExtent(),L=ft(R);T.push([-L,0],[L,0])}const I=t.layerStatesArray,S=I.length,A=[],D=[];for(let R=0;R<T.length;R++)for(let L=S-1;L>=0;--L){const j=I[L],k=j.layer;if(k.hasRenderer()&&V1(j,f)&&l.call(u,k)){const b=k.getRenderer(),M=k.getSource();if(b&&M){const V=M.getWrapX()?x:e,z=m.bind(null,j.managed);D[0]=V[0]+T[R][0],D[1]=V[1]+T[R][1],h=b.forEachFeatureAtCoordinate(D,t,i,z,A)}if(h)return h}}if(A.length===0)return;const N=1/A.length;return A.forEach((R,L)=>R.distanceSq+=L*N),A.sort((R,L)=>R.distanceSq-L.distanceSq),A.some(R=>h=R.callback(R.feature,R.layer,R.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,wd,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){tt()}scheduleExpireIconCache(e){Yi.canExpireCache()&&e.postRenderFunctions.push(y9)}}function y9(n,e){Yi.expire()}class _9 extends p9{constructor(e){super(e),this.fontChangeListenerKey_=nt(Nc,su.PROPERTYCHANGE,e.redrawText,e),this.element_=Si?qb():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=af+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new mP(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){At(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(qi.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,f)=>h.zIndex-f.zIndex);t.some(h=>h.layer instanceof CP&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,f=t.length;h<f;++h){const m=t[h];e.layerIndex=h;const y=m.layer,x=y.getSourceState();if(!V1(m,r)||x!="ready"&&x!="undefined"){y.unrender();continue}const T=y.render(e,o);T&&(T!==o&&(this.children_.push(T),o=T),s.push(m))}this.declutter(e,s),Gj(this.element_,this.children_);const u=this.getMap().getTargetElement();if($o(u)){const h=u.getContext("2d");for(const f of this.children_){const m=f.firstElementChild||f,y=f.style.backgroundColor;if(y&&(!$o(m)||m.width>0)&&(h.fillStyle=y,h.fillRect(0,0,u.width,u.height)),$o(m)&&m.width>0){const x=f.style.opacity||m.style.opacity;h.globalAlpha=x===""?1:Number(x);const T=m.style.transform;if(T)h.setTransform(...Av(T));else{const I=parseFloat(m.style.width)/m.width,S=parseFloat(m.style.height)/m.height;h.setTransform(I,0,0,S,0,0)}h.drawImage(m,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(qi.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function FP(n){if(n instanceof $p){n.setMapInternal(null);return}n instanceof Du&&n.getLayers().forEach(FP)}function VP(n,e){if(n instanceof $p){n.setMapInternal(e);return}if(n instanceof Du){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)VP(t[i],e)}}let v9=class extends us{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=x9(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:Bj,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Er(),this.pixelToCoordinateTransform_=Er(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Si||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Si||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Si?new Xi:H6()),this.interactions=t.interactions||(Si?new Xi:m9({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new U6(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Nn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Nn.VIEW,this.handleViewChanged_),this.addChangeListener(Nn.SIZE,this.handleSizeChanged_),this.addChangeListener(Nn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Qr)&&e.view.then(function(r){i.setView(new Qr(r))}),this.controls.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(ei.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(ei.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(ei.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(ei.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){VP(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:wd,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,l,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof Du?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:wd,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],l="changedTouches"in e?e.changedTouches[0]:e;return[(l.clientX-i.left)/s,(l.clientY-i.top)/o]}getTarget(){return this.get(Nn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Rv(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?un(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Nn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Xi){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ds(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?un(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Nn.SIZE)}getView(){return this.get(Nn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return B6(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Fo(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Fv.POINTERDOWN||i===We.WHEEL||i===We.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,l=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!l.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Mn.ANIMATING]||o[Mn.INTERACTING]){const l=Date.now()-e.time>8;r=l?0:8,s=l?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(qi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(qi.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Lc(Vo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Lc(Vo.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)At(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(We.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(We.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!$o(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if($o(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new _9(this)),!$o(t)){this.mapBrowserEventHandler_=new W6(this,this.moveTolerance_);for(const r in Lt)this.mapBrowserEventHandler_.addEventListener(Lt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(We.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(We.WHEEL,this.boundHandleBrowserEvent_,Xb?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[nt(i,We.KEYDOWN,this.handleBrowserEvent,this),nt(i,We.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(At(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(At(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=nt(e,su.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=nt(e,We.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(At),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new jo("addlayer",e)),this.layerGroupPropertyListenerKeys_=[nt(e,su.PROPERTYCHANGE,this.render,this),nt(e,We.CHANGE,this.render,this),nt(e,"addlayer",this.handleLayerAdd_,this),nt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){FP(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&eC(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Ev(l.center,l.resolution,l.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:l,viewHints:o,wantedTiles:{},mapId:it(this),renderTargets:{}},l.nextCenter&&l.nextResolution){const u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=Ev(l.nextCenter,l.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Op(this.previousExtent_)&&!Td(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Lc(Vo.MOVESTART,this,r)),this.previousExtent_=Np(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Mn.ANIMATING]&&!s.viewHints[Mn.INTERACTING]&&!Td(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Lc(Vo.MOVEEND,this,s)),_b(s.extent,this.previousExtent_))),this.dispatchEvent(new Lc(Vo.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Vo.LOADSTART)||this.hasListener(Vo.LOADEND)||this.hasListener(qi.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new jo("removelayer",t)),this.set(Nn.LAYERGROUP,e)}setSize(e){this.set(Nn.SIZE,e)}setTarget(e){this.set(Nn.TARGET,e)}setView(e){if(!e||e instanceof Qr){this.set(Nn.VIEW,e);return}this.set(Nn.VIEW,new Qr);const t=this;e.then(function(i){t.setView(new Qr(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if($o(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!eC(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&Ab("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!la(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function x9(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Du({layers:n.layers});t[Nn.LAYERGROUP]=i,t[Nn.TARGET]=n.target,t[Nn.VIEW]=n.view instanceof Qr?n.view:new Qr;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Xi(n.controls.slice()):(lt(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Xi(n.interactions.slice()):(lt(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Xi(n.overlays.slice()):(lt(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Xi,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const M0="units",w9=[1,2,5],kh=25.4/.28;class E9 extends Kp{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+af,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(M0,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(M0)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(M0,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Om(i,e.resolution,t,s);const l=this.minWidth_*(this.dpi_||kh)/kh,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||kh)/kh:void 0;let h=l*o,f="";if(r=="degrees"){const N=cu.degrees;h*=N,h<N/60?(f="",o*=3600):h<N?(f="",o*=60):f=""}else if(r=="imperial")h<.9144?(f="in",o/=.0254):h<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344);else if(r=="nautical")o/=1852,f="NM";else if(r=="metric")h<1e-6?(f="nm",o*=1e9):h<.001?(f="m",o*=1e6):h<1?(f="mm",o*=1e3):h<1e3?f="m":(f="km",o/=1e3);else if(r=="us")h<.9144?(f="in",o*=39.37):h<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472);else throw new Error("Invalid units");let m=3*Math.floor(Math.log(l*o)/Math.log(10)),y,x,T,I=0,S,A;for(;;){T=Math.floor(m/3);const N=Math.pow(10,T);if(y=w9[(m%3+3)%3]*N,x=Math.round(y/o),isNaN(x)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&x>=u){y=I,x=S,T=A;break}else if(x>=l)break;I=y,S=x,A=T,++m}const D=this.scaleBar_?this.createScaleBar(x,y,f):y.toFixed(T<0?-T:0)+" "+f;this.renderedHTML_!=D&&(this.innerElement_.innerHTML=D,this.renderedHTML_=D),this.renderedWidth_!=x&&(this.innerElement_.style.width=x+"px",this.renderedWidth_=x),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,l=e/o,u=[this.createMarker("absolute")];for(let f=0;f<o;++f){const m=f%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${m}" style="width: ${l}px;"></div>`+this.createMarker("relative")+(f%2===0||o===2?this.createStepText(f,e,!1,t,i):"")+"</div>")}return u.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const l=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),u=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+l+"</div>"}getScaleForResolution(){const e=Om(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||kh,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const T9={},RC=n=>{let e;const t=new Set,i=(f,m)=>{const y=typeof f=="function"?f(e):f;if(!Object.is(y,e)){const x=e;e=m??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(T=>T(e,x))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(T9?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},S9=n=>n?RC(n):RC;var L0={exports:{}},O0={},F0={exports:{}},V0={};var AC;function I9(){if(AC)return V0;AC=1;var n=Zd();function e(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(m,y){var x=y(),T=i({inst:{value:x,getSnapshot:y}}),I=T[0].inst,S=T[1];return s(function(){I.value=x,I.getSnapshot=y,u(I)&&S({inst:I})},[m,x,y]),r(function(){return u(I)&&S({inst:I}),m(function(){u(I)&&S({inst:I})})},[m]),o(x),x}function u(m){var y=m.getSnapshot;m=m.value;try{var x=y();return!t(m,x)}catch{return!0}}function h(m,y){return y()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return V0.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,V0}var bC;function C9(){return bC||(bC=1,F0.exports=I9()),F0.exports}var PC;function R9(){if(PC)return O0;PC=1;var n=Zd(),e=C9();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return O0.useSyncExternalStoreWithSelector=function(h,f,m,y,x){var T=s(null);if(T.current===null){var I={hasValue:!1,value:null};T.current=I}else I=T.current;T=l(function(){function A(j){if(!D){if(D=!0,N=j,j=y(j),x!==void 0&&I.hasValue){var k=I.value;if(x(k,j))return R=k}return R=j}if(k=R,i(N,j))return k;var b=y(j);return x!==void 0&&x(k,b)?(N=j,k):(N=j,R=b)}var D=!1,N,R,L=m===void 0?null:m;return[function(){return A(f())},L===null?void 0:function(){return A(L())}]},[f,m,y,x]);var S=r(h,T[0],T[1]);return o(function(){I.hasValue=!0,I.value=S},[S]),u(S),S},O0}var kC;function A9(){return kC||(kC=1,L0.exports=R9()),L0.exports}var b9=A9();const P9=Rx(b9),jP={},{useDebugValue:k9}=iL,{useSyncExternalStoreWithSelector:N9}=P9;let NC=!1;const D9=n=>n;function M9(n,e=D9,t){(jP?"production":void 0)!=="production"&&t&&!NC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),NC=!0);const i=N9(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return k9(i),i}const DC=n=>{(jP?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?S9(n):n,t=(i,r)=>M9(e,i,r);return Object.assign(t,e),t},Rr=n=>n?DC(n):DC;var zP=Symbol.for("immer-nothing"),MC=Symbol.for("immer-draftable"),Ri=Symbol.for("immer-state");function pr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Dd=Object.getPrototypeOf;function gu(n){return!!n&&!!n[Ri]}function vl(n){return n?UP(n)||Array.isArray(n)||!!n[MC]||!!n.constructor?.[MC]||ff(n)||Xp(n):!1}var L9=Object.prototype.constructor.toString(),LC=new WeakMap;function UP(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=LC.get(t);return i===void 0&&(i=Function.toString.call(t),LC.set(t,i)),i===L9}function Hm(n,e,t=!0){Hp(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function Hp(n){const e=n[Ri];return e?e.type_:Array.isArray(n)?1:ff(n)?2:Xp(n)?3:0}function jv(n,e){return Hp(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function BP(n,e,t){const i=Hp(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function O9(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function ff(n){return n instanceof Map}function Xp(n){return n instanceof Set}function Ba(n){return n.copy_||n.base_}function zv(n,e){if(ff(n))return new Map(n);if(Xp(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=UP(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Ri];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:n[o]})}return Object.create(Dd(n),i)}else{const i=Dd(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function K1(n,e=!1){return qp(n)||gu(n)||!vl(n)||(Hp(n)>1&&Object.defineProperties(n,{set:qg,add:qg,clear:qg,delete:qg}),Object.freeze(n),e&&Object.values(n).forEach(t=>K1(t,!0))),n}function F9(){pr(2)}var qg={value:F9};function qp(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var V9={};function xl(n){const e=V9[n];return e||pr(0,n),e}var Md;function WP(){return Md}function j9(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function OC(n,e){e&&(xl("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function Uv(n){Bv(n),n.drafts_.forEach(z9),n.drafts_=null}function Bv(n){n===Md&&(Md=n.parent_)}function FC(n){return Md=j9(Md,n)}function z9(n){const e=n[Ri];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function VC(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Ri].modified_&&(Uv(e),pr(4)),vl(n)&&(n=Xm(e,n),e.parent_||qm(e,n)),e.patches_&&xl("Patches").generateReplacementPatches_(t[Ri].base_,n,e.patches_,e.inversePatches_)):n=Xm(e,t,[]),Uv(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==zP?n:void 0}function Xm(n,e,t){if(qp(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Ri];if(!r)return Hm(e,(s,o)=>jC(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return qm(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,l=!1;r.type_===3&&(o=new Set(s),s.clear(),l=!0),Hm(o,(u,h)=>jC(n,r,s,u,h,t,l),i),qm(n,s,!1),t&&n.patches_&&xl("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function jC(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const l=qp(r);if(!(l&&!o)){if(gu(r)){const u=s&&e&&e.type_!==3&&!jv(e.assigned_,i)?s.concat(i):void 0,h=Xm(n,r,u);if(BP(t,i,h),gu(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(vl(r)&&!l){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&l)return;Xm(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(ff(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&qm(n,r)}}}function qm(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&K1(e,t)}function U9(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:WP(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=H1;t&&(r=[i],s=Ld);const{revoke:o,proxy:l}=Proxy.revocable(r,s);return i.draft_=l,i.revoke_=o,l}var H1={get(n,e){if(e===Ri)return n;const t=Ba(n);if(!jv(t,e))return B9(n,t,e);const i=t[e];return n.finalized_||!vl(i)?i:i===j0(n.base_,e)?(z0(n),n.copy_[e]=Gv(i,n)):i},has(n,e){return e in Ba(n)},ownKeys(n){return Reflect.ownKeys(Ba(n))},set(n,e,t){const i=GP(Ba(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=j0(Ba(n),e),s=r?.[Ri];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(O9(t,r)&&(t!==void 0||jv(n.base_,e)))return!0;z0(n),Wv(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return j0(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,z0(n),Wv(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Ba(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){pr(11)},getPrototypeOf(n){return Dd(n.base_)},setPrototypeOf(){pr(12)}},Ld={};Hm(H1,(n,e)=>{Ld[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Ld.deleteProperty=function(n,e){return Ld.set.call(this,n,e,void 0)};Ld.set=function(n,e,t){return H1.set.call(this,n[0],e,t,n[0])};function j0(n,e){const t=n[Ri];return(t?Ba(t):n)[e]}function B9(n,e,t){const i=GP(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function GP(n,e){if(!(e in n))return;let t=Dd(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Dd(t)}}function Wv(n){n.modified_||(n.modified_=!0,n.parent_&&Wv(n.parent_))}function z0(n){n.copy_||(n.copy_=zv(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var W9=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,f=>t.call(this,f,...h))}}typeof t!="function"&&pr(6),i!==void 0&&typeof i!="function"&&pr(7);let r;if(vl(e)){const s=FC(this),o=Gv(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?Uv(s):Bv(s)}return OC(s,i),VC(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===zP&&(r=void 0),this.autoFreeze_&&K1(r,!0),i){const s=[],o=[];xl("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else pr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,u=>e(u,...l));let i,r;return[this.produce(e,t,(o,l)=>{i=o,r=l}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){vl(n)||pr(8),gu(n)&&(n=G9(n));const e=FC(this),t=Gv(n,void 0);return t[Ri].isManual_=!0,Bv(e),t}finishDraft(n,e){const t=n&&n[Ri];(!t||!t.isManual_)&&pr(9);const{scope_:i}=t;return OC(i,e),VC(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=xl("Patches").applyPatches_;return gu(n)?i(n,e):this.produce(n,r=>i(r,e))}};function Gv(n,e){const t=ff(n)?xl("MapSet").proxyMap_(n,e):Xp(n)?xl("MapSet").proxySet_(n,e):U9(n,e);return(e?e.scope_:WP()).drafts_.push(t),t}function G9(n){return gu(n)||pr(10,n),$P(n)}function $P(n){if(!vl(n)||qp(n))return n;const e=n[Ri];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=zv(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=zv(n,!0);return Hm(t,(r,s)=>{BP(t,r,$P(s))},i),e&&(e.finalized_=!1),t}var $9=new W9,K9=$9.produce;const H9=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const l=typeof r=="function"?K9(r):r;return e(l,s,...o)},n(i.setState,t,i)),Yp=H9,ii=Rr()(Yp((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s?(i.headingSource="gps",e().updateHeading(t.coords.heading,"gps")):i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const s=e().smoothHeading;if(s===null){r.smoothHeading=t,r.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=i==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(i==="gps"?.5:.35);r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),KP={Aanlegsteigers:{name:"Aanlegsteigers",factory:async()=>{const{createAanlegsteigersLayer:n}=await Xg(async()=>{const{createAanlegsteigersLayer:e}=await import("./aanlegsteigersOL-C-iGXQ4_.js");return{createAanlegsteigersLayer:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Boothellingen:{name:"Boothellingen",factory:async()=>{const{createBoothellingenLayer:n}=await Xg(async()=>{const{createBoothellingenLayer:e}=await import("./boothellingenOL-BUEgpQfw.js");return{createBoothellingenLayer:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},Dieptekaart:{name:"Dieptekaart",factory:async()=>{const{createDieptekaartLayer:n}=await Xg(async()=>{const{createDieptekaartLayer:e}=await import("./dieptekaartOL-Ci_hBbN9.js");return{createDieptekaartLayer:e}},[]);return n()},immediateLoad:!0},Viswater:{name:"Viswater",factory:async()=>{const{createViswaterLayer:n}=await Xg(async()=>{const{createViswaterLayer:e}=await import("./viswaterOL-B8TRm3Yq.js");return{createViswaterLayer:e}},__vite__mapDeps([3,1]));return n()},immediateLoad:!1}};function X9(){return Object.values(KP).filter(n=>n.immediateLoad)}const Js=Rr()(Yp((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Yo=Rr()(Yp((n,e)=>({visible:{OpenStreetMap:!0,Luchtfoto:!1,"Labels Overlay":!1,Aanlegsteigers:!1,Boothellingen:!1,Dieptekaart:!1,Viswater:!1,"Mijn Vangsten":!0,"Favoriete Plekken":!0},opacity:{Dieptekaart:.7,Viswater:.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=KP[t];if(!r){console.warn(`Layer "${t}" not found in registry`);return}const s=Js.getState().map;if(!s){console.warn(`Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(`Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const l=e();o.setVisible(l.visible[t]??!1),l.opacity[t]!==void 0&&o.setOpacity(l.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(`Layer loaded: ${t}`)}catch(o){console.error(`Failed to load layer "${t}":`,o),n(l=>{l.loadingState[t]="error"})}}}))),ri=Rr()(Yp(n=>({layerControlOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,catchFormOpen:!1,catchFormLocation:null,catchFormLocationSource:null,catchFormInitialPhotos:[],catchDashboardOpen:!1,spotFormOpen:!1,spotFormLocation:null,spotsDashboardOpen:!1,weatherPanelOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(e=>{e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1})},toggleLayerControl:()=>{n(e=>{e.layerControlOpen=!e.layerControlOpen})},toggleSettingsPanel:()=>{n(e=>{const t=e.settingsPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(e=>{const t=e.infoPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.infoPanelOpen=!0)})},toggleCategory:e=>{n(t=>{t.collapsedCategories.has(e)?t.collapsedCategories.delete(e):t.collapsedCategories.add(e)})},openCatchForm:e=>{n(t=>{t.catchFormOpen=!0,t.catchFormLocation=e?.location||null,t.catchFormLocationSource=e?.locationSource||null,t.catchFormInitialPhotos=e?.photos||[]})},closeCatchForm:()=>{n(e=>{e.catchFormOpen=!1,e.catchFormLocation=null,e.catchFormLocationSource=null,e.catchFormInitialPhotos=[]})},toggleCatchDashboard:()=>{n(e=>{e.catchDashboardOpen=!e.catchDashboardOpen})},openSpotForm:e=>{n(t=>{t.spotFormOpen=!0,t.spotFormLocation=e||null})},closeSpotForm:()=>{n(e=>{e.spotFormOpen=!1,e.spotFormLocation=null})},toggleSpotsDashboard:()=>{n(e=>{e.spotsDashboardOpen=!e.spotsDashboardOpen})},toggleWeatherPanel:()=>{n(e=>{const t=e.weatherPanelOpen;e.settingsPanelOpen=!1,e.infoPanelOpen=!1,e.weatherPanelOpen=!1,t||(e.weatherPanelOpen=!0)})}}))),q9={};function Y9(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=t.getItem(r))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const Od=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return Od(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return Od(i)(t)}}}},Z9=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:S=>S,version:0,merge:(S,A)=>({...A,...S}),...e},o=!1;const l=new Set,u=new Set;let h;try{h=s.getStorage()}catch{}if(!h)return n((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...S)},i,r);const f=Od(s.serialize),m=()=>{const S=s.partialize({...i()});let A;const D=f({state:S,version:s.version}).then(N=>h.setItem(s.name,N)).catch(N=>{A=N});if(A)throw A;return D},y=r.setState;r.setState=(S,A)=>{y(S,A),m()};const x=n((...S)=>{t(...S),m()},i,r);let T;const I=()=>{var S;if(!h)return;o=!1,l.forEach(D=>D(i()));const A=((S=s.onRehydrateStorage)==null?void 0:S.call(s,i()))||void 0;return Od(h.getItem.bind(h))(s.name).then(D=>{if(D)return s.deserialize(D)}).then(D=>{if(D)if(typeof D.version=="number"&&D.version!==s.version){if(s.migrate)return s.migrate(D.state,D.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return D.state}).then(D=>{var N;return T=s.merge(D,(N=i())!=null?N:x),t(T,!0),m()}).then(()=>{A?.(T,void 0),o=!0,u.forEach(D=>D(T))}).catch(D=>{A?.(void 0,D)})};return r.persist={setOptions:S=>{s={...s,...S},S.getStorage&&(h=S.getStorage())},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>I(),hasHydrated:()=>o,onHydrate:S=>(l.add(S),()=>{l.delete(S)}),onFinishHydration:S=>(u.add(S),()=>{u.delete(S)})},I(),T||x},Q9=(n,e)=>(t,i,r)=>{let s={storage:Y9(()=>localStorage),partialize:I=>I,version:0,merge:(I,S)=>({...S,...I}),...e},o=!1;const l=new Set,u=new Set;let h=s.storage;if(!h)return n((...I)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...I)},i,r);const f=()=>{const I=s.partialize({...i()});return h.setItem(s.name,{state:I,version:s.version})},m=r.setState;r.setState=(I,S)=>{m(I,S),f()};const y=n((...I)=>{t(...I),f()},i,r);r.getInitialState=()=>y;let x;const T=()=>{var I,S;if(!h)return;o=!1,l.forEach(D=>{var N;return D((N=i())!=null?N:y)});const A=((S=s.onRehydrateStorage)==null?void 0:S.call(s,(I=i())!=null?I:y))||void 0;return Od(h.getItem.bind(h))(s.name).then(D=>{if(D)if(typeof D.version=="number"&&D.version!==s.version){if(s.migrate)return[!0,s.migrate(D.state,D.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,D.state];return[!1,void 0]}).then(D=>{var N;const[R,L]=D;if(x=s.merge(L,(N=i())!=null?N:y),t(x,!0),R)return f()}).then(()=>{A?.(x,void 0),x=i(),o=!0,u.forEach(D=>D(x))}).catch(D=>{A?.(void 0,D)})};return r.persist={setOptions:I=>{s={...s,...I},I.storage&&(h=I.storage)},clearStorage:()=>{h?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>T(),hasHydrated:()=>o,onHydrate:I=>(l.add(I),()=>{l.delete(I)}),onFinishHydration:I=>(u.add(I),()=>{u.delete(I)})},s.skipHydration||T(),x||y},J9=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((q9?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Z9(n,e)):Q9(n,e),gf=J9,at=Rr()(gf(n=>({defaultBackground:"OpenStreetMap",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,showCatchButton:!0,showCatches:!0,showFavoriteSpots:!0,showWeatherWidget:!0,showWindIndicator:!1,showTideWidget:!1,showForecastSlider:!1,showWaterDataWidget:!1,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setShowCatchButton:e=>n({showCatchButton:e}),setShowCatches:e=>n({showCatches:e}),setShowFavoriteSpots:e=>n({showFavoriteSpots:e}),setShowWeatherWidget:e=>n({showWeatherWidget:e}),setShowWindIndicator:e=>n({showWindIndicator:e}),setShowTideWidget:e=>n({showTideWidget:e}),setShowForecastSlider:e=>n({showForecastSlider:e}),setShowWaterDataWidget:e=>n({showWaterDataWidget:e})}),{name:"visapp-settings"})),HP=Rr()(gf((n,e)=>({catches:[],addCatch:t=>n(i=>({catches:[...i.catches,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeCatch:t=>n(i=>({catches:i.catches.filter(r=>r.id!==t)})),updateCatch:(t,i)=>n(r=>({catches:r.catches.map(s=>s.id===t?{...s,...i}:s)})),clearAll:()=>n({catches:[]}),exportAsGeoJSON:()=>{const t=e().catches;if(t.length===0){alert("Geen vangsten om te exporteren");return}const i={type:"FeatureCollection",features:t.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:[l.location.lng,l.location.lat]},properties:{id:l.id,species:l.species,weight:l.weight,length:l.length,method:l.method,bait:l.bait,notes:l.notes,timestamp:l.timestamp,weather:l.weather}}))},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`mijn-vangsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}}),{name:"visapp-catches"})),Fd=Rr((n,e)=>({current:null,pressureHistory:[],hourlyForecast:[],loading:!1,lastUpdate:null,error:null,fetchWeather:async(t,i)=>{n({loading:!0,error:null});try{const r=new URLSearchParams({latitude:t.toString(),longitude:i.toString(),current:"temperature_2m,relative_humidity_2m,surface_pressure,wind_speed_10m,wind_direction_10m,weather_code",hourly:"temperature_2m,wind_speed_10m,wind_direction_10m,surface_pressure,weather_code",past_hours:"24",forecast_hours:"48",timezone:"Europe/Amsterdam"}),o=await(await fetch(`https://api.open-meteo.com/v1/forecast?${r}`)).json();let l=[],u=[];o.hourly?.time&&o.hourly?.surface_pressure&&(l=o.hourly.time.map((h,f)=>({time:h,pressure:o.hourly.surface_pressure[f]})),u=o.hourly.time.map((h,f)=>({time:h,temperature:o.hourly.temperature_2m[f],windSpeed:o.hourly.wind_speed_10m[f],windDirection:o.hourly.wind_direction_10m[f],pressure:o.hourly.surface_pressure[f],weatherCode:o.hourly.weather_code[f]}))),o.current&&n({current:{temperature:o.current.temperature_2m,windSpeed:o.current.wind_speed_10m,windDirection:o.current.wind_direction_10m,pressure:o.current.surface_pressure,humidity:o.current.relative_humidity_2m,weatherCode:o.current.weather_code},pressureHistory:l,hourlyForecast:u,loading:!1,lastUpdate:Date.now()})}catch{n({error:"Kon weer niet ophalen",loading:!1})}},getFishingCondition:()=>{const{current:t}=e();if(!t)return"moderate";let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),i>=5?"excellent":i>=3?"good":i>=1?"moderate":"poor"},getFishingScore:()=>{const{current:t}=e();if(!t)return 1;let i=0;return t.windSpeed<15?i+=2:t.windSpeed<25?i+=1:i-=1,t.pressure>1013&&(i+=1),t.pressure>1020&&(i+=1),t.temperature>=10&&t.temperature<=20?i+=2:t.temperature>=5&&t.temperature<=25&&(i+=1),t.weatherCode<50&&(i+=1),Math.max(0,Math.min(3,i/2))},getPressureTrend:()=>{const{pressureHistory:t}=e();if(t.length<6)return"stable";const i=t.slice(-6),r=t.slice(-12,-6);if(r.length===0)return"stable";const s=i.reduce((u,h)=>u+h.pressure,0)/i.length,o=r.reduce((u,h)=>u+h.pressure,0)/r.length,l=s-o;return l>2?"rising":l<-2?"falling":"stable"},getWeatherAtTime:t=>{const{hourlyForecast:i}=e();if(i.length===0)return null;t.toISOString().slice(0,13)+"";let r=i[0],s=1/0;for(const o of i){const l=new Date(o.time).getTime(),u=Math.abs(l-t.getTime());u<s&&(s=u,r=o)}return r}})),XP=Rr()(gf(n=>({spots:[],addSpot:e=>n(t=>({spots:[...t.spots,{...e,id:crypto.randomUUID(),createdAt:new Date().toISOString()}]})),removeSpot:e=>n(t=>({spots:t.spots.filter(i=>i.id!==e)})),updateSpot:(e,t)=>n(i=>({spots:i.spots.map(r=>r.id===e?{...r,...t}:r)})),clearAll:()=>n({spots:[]})}),{name:"visapp-spots"})),zC=[{id:"standaard",name:"Standaard",icon:"Map",layers:[],isBuiltIn:!0},{id:"vissen",name:"Vissen",icon:"Fish",layers:["Dieptekaart","Viswater"],isBuiltIn:!0},{id:"boot",name:"Boot",icon:"Anchor",layers:["Aanlegsteigers","Boothellingen","Dieptekaart"],isBuiltIn:!0},{id:"alles",name:"Alles",icon:"Layers",layers:["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],isBuiltIn:!0}],UC=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"],ez=Rr()(gf((n,e)=>({presets:zC,applyPreset:t=>{const i=e().presets.find(s=>s.id===t);if(!i)return;const r=Yo.getState().setLayerVisibility;UC.forEach(s=>{r(s,!1)}),i.layers.forEach(s=>{r(s,!0)})},updatePreset:(t,i)=>{n(r=>({presets:r.presets.map(s=>s.id===t?{...s,...i}:s)}))},createPreset:t=>{const i=Yo.getState().visible,r=UC.filter(o=>i[o]),s={id:crypto.randomUUID(),name:t,icon:"Star",layers:r,isBuiltIn:!1};n(o=>({presets:[...o.presets,s]}))},deletePreset:t=>{n(i=>({presets:i.presets.filter(r=>r.id!==t||r.isBuiltIn)}))},resetToDefaults:()=>{n({presets:zC})}}),{name:"visapp-presets"})),tz=()=>{};var BC={};const qP=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},nz=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],l=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},YP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,l=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,f=s>>2,m=(s&3)<<4|l>>4;let y=(l&15)<<2|h>>6,x=h&63;u||(x=64,o||(y=64)),i.push(t[f],t[m],t[y],t[x])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(qP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):nz(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const m=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||l==null||h==null||m==null)throw new iz;const y=s<<2|l>>4;if(i.push(y),h!==64){const x=l<<4&240|h>>2;if(i.push(x),m!==64){const T=h<<6&192|m;i.push(T)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class iz extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const rz=function(n){const e=qP(n);return YP.encodeByteArray(e,!0)},Ym=function(n){return rz(n).replace(/\./g,"")},ZP=function(n){try{return YP.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function QP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const sz=()=>QP().__FIREBASE_DEFAULTS__,oz=()=>{if(typeof process>"u"||typeof BC>"u")return;const n=BC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},az=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&ZP(n[1]);return e&&JSON.parse(e)},Zp=()=>{try{return tz()||sz()||oz()||az()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},JP=n=>Zp()?.emulatorHosts?.[n],ek=n=>{const e=JP(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},tk=()=>Zp()?.config,nk=n=>Zp()?.[`_${n}`];class lz{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Ml(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function X1(n){return(await fetch(n,{credentials:"include"})).ok}function ik(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Ym(JSON.stringify(t)),Ym(JSON.stringify(o)),""].join(".")}const nd={};function cz(){const n={prod:[],emulator:[]};for(const e of Object.keys(nd))nd[e]?n.emulator.push(e):n.prod.push(e);return n}function uz(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let WC=!1;function q1(n,e){if(typeof window>"u"||typeof document>"u"||!Ml(window.location.host)||nd[n]===e||nd[n]||WC)return;nd[n]=e;function t(y){return`__firebase__banner__${y}`}const i="__firebase__banner",s=cz().prod.length>0;function o(){const y=document.getElementById(i);y&&y.remove()}function l(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,x){y.setAttribute("width","24"),y.setAttribute("id",x),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{WC=!0,o()},y}function f(y,x){y.setAttribute("id",x),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function m(){const y=uz(i),x=t("text"),T=document.getElementById(x)||document.createElement("span"),I=t("learnmore"),S=document.getElementById(I)||document.createElement("a"),A=t("preprendIcon"),D=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const N=y.element;l(N),f(S,I);const R=h();u(D,A),N.append(D,T,S,R),document.body.appendChild(N)}s?(T.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function en(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hz(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(en())}function rk(){const n=Zp()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function dz(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function fz(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function gz(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mz(){const n=en();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function sk(){return!rk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ok(){return!rk()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ak(){try{return typeof indexedDB=="object"}catch{return!1}}function pz(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const yz="FirebaseError";class hs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=yz,Object.setPrototypeOf(this,hs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mf.prototype.create)}}class mf{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?_z(s,i):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new hs(r,l,i)}}function _z(n,e){return n.replace(vz,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const vz=/\{\$([^}]+)}/g;function xz(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function wl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(GC(s)&&GC(o)){if(!wl(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function GC(n){return n!==null&&typeof n=="object"}function pf(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function wz(n,e){const t=new Ez(n,e);return t.subscribe.bind(t)}class Ez{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Tz(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=U0),r.error===void 0&&(r.error=U0),r.complete===void 0&&(r.complete=U0);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Tz(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function U0(){}function eo(n){return n&&n._delegate?n._delegate:n}class ia{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Wa="[DEFAULT]";class Sz{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new lz;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Cz(e))try{this.getOrInitializeService({instanceIdentifier:Wa})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Wa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Wa){return this.instances.has(e)}getOptions(e=Wa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);i===l&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Iz(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Wa){return this.component?this.component.multipleInstances?e:Wa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Iz(n){return n===Wa?void 0:n}function Cz(n){return n.instantiationMode==="EAGER"}class Rz{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Sz(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var He;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(He||(He={}));const Az={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},bz=He.INFO,Pz={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},kz=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=Pz[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Y1{constructor(e){this.name=e,this._logLevel=bz,this._logHandler=kz,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Az[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const Nz=(n,e)=>e.some(t=>n instanceof t);let $C,KC;function Dz(){return $C||($C=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Mz(){return KC||(KC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lk=new WeakMap,$v=new WeakMap,ck=new WeakMap,B0=new WeakMap,Z1=new WeakMap;function Lz(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Zo(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&lk.set(t,n)}).catch(()=>{}),Z1.set(e,n),e}function Oz(n){if($v.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});$v.set(n,e)}let Kv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return $v.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ck.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Fz(n){Kv=n(Kv)}function Vz(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(W0(this),e,...t);return ck.set(i,e.sort?e.sort():[e]),Zo(i)}:Mz().includes(n)?function(...e){return n.apply(W0(this),e),Zo(lk.get(this))}:function(...e){return Zo(n.apply(W0(this),e))}}function jz(n){return typeof n=="function"?Vz(n):(n instanceof IDBTransaction&&Oz(n),Nz(n,Dz())?new Proxy(n,Kv):n)}function Zo(n){if(n instanceof IDBRequest)return Lz(n);if(B0.has(n))return B0.get(n);const e=jz(n);return e!==n&&(B0.set(n,e),Z1.set(e,n)),e}const W0=n=>Z1.get(n);function zz(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),l=Zo(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Zo(o.result),u.oldVersion,u.newVersion,Zo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const Uz=["get","getKey","getAll","getAllKeys","count"],Bz=["put","add","delete","clear"],G0=new Map;function HC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(G0.get(e))return G0.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=Bz.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Uz.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),r&&u.done]))[0]};return G0.set(e,s),s}Fz(n=>({...n,get:(e,t,i)=>HC(e,t)||n.get(e,t,i),has:(e,t)=>!!HC(e,t)||n.has(e,t)}));class Wz{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Gz(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Gz(n){return n.getComponent()?.type==="VERSION"}const Hv="@firebase/app",XC="0.14.6";const Xs=new Y1("@firebase/app"),$z="@firebase/app-compat",Kz="@firebase/analytics-compat",Hz="@firebase/analytics",Xz="@firebase/app-check-compat",qz="@firebase/app-check",Yz="@firebase/auth",Zz="@firebase/auth-compat",Qz="@firebase/database",Jz="@firebase/data-connect",eU="@firebase/database-compat",tU="@firebase/functions",nU="@firebase/functions-compat",iU="@firebase/installations",rU="@firebase/installations-compat",sU="@firebase/messaging",oU="@firebase/messaging-compat",aU="@firebase/performance",lU="@firebase/performance-compat",cU="@firebase/remote-config",uU="@firebase/remote-config-compat",hU="@firebase/storage",dU="@firebase/storage-compat",fU="@firebase/firestore",gU="@firebase/ai",mU="@firebase/firestore-compat",pU="firebase",yU="12.6.0";const Xv="[DEFAULT]",_U={[Hv]:"fire-core",[$z]:"fire-core-compat",[Hz]:"fire-analytics",[Kz]:"fire-analytics-compat",[qz]:"fire-app-check",[Xz]:"fire-app-check-compat",[Yz]:"fire-auth",[Zz]:"fire-auth-compat",[Qz]:"fire-rtdb",[Jz]:"fire-data-connect",[eU]:"fire-rtdb-compat",[tU]:"fire-fn",[nU]:"fire-fn-compat",[iU]:"fire-iid",[rU]:"fire-iid-compat",[sU]:"fire-fcm",[oU]:"fire-fcm-compat",[aU]:"fire-perf",[lU]:"fire-perf-compat",[cU]:"fire-rc",[uU]:"fire-rc-compat",[hU]:"fire-gcs",[dU]:"fire-gcs-compat",[fU]:"fire-fst",[mU]:"fire-fst-compat",[gU]:"fire-vertex","fire-js":"fire-js",[pU]:"fire-js-all"};const Zm=new Map,vU=new Map,qv=new Map;function qC(n,e){try{n.container.addComponent(e)}catch(t){Xs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function El(n){const e=n.name;if(qv.has(e))return Xs.debug(`There were multiple attempts to register component ${e}.`),!1;qv.set(e,n);for(const t of Zm.values())qC(t,n);for(const t of vU.values())qC(t,n);return!0}function Qp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Hi(n){return n==null?!1:n.settings!==void 0}const xU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qo=new mf("app","Firebase",xU);class wU{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ia("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qo.create("app-deleted",{appName:this._name})}}const Ll=yU;function uk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Xv,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Qo.create("bad-app-name",{appName:String(r)});if(t||(t=tk()),!t)throw Qo.create("no-options");const s=Zm.get(r);if(s){if(wl(t,s.options)&&wl(i,s.config))return s;throw Qo.create("duplicate-app",{appName:r})}const o=new Rz(r);for(const u of qv.values())o.addComponent(u);const l=new wU(t,i,o);return Zm.set(r,l),l}function Q1(n=Xv){const e=Zm.get(n);if(!e&&n===Xv&&tk())return uk();if(!e)throw Qo.create("no-app",{appName:n});return e}function ss(n,e,t){let i=_U[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xs.warn(o.join(" "));return}El(new ia(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const EU="firebase-heartbeat-database",TU=1,Vd="firebase-heartbeat-store";let $0=null;function hk(){return $0||($0=zz(EU,TU,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Vd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Qo.create("idb-open",{originalErrorMessage:n.message})})),$0}async function SU(n){try{const t=(await hk()).transaction(Vd),i=await t.objectStore(Vd).get(dk(n));return await t.done,i}catch(e){if(e instanceof hs)Xs.warn(e.message);else{const t=Qo.create("idb-get",{originalErrorMessage:e?.message});Xs.warn(t.message)}}}async function YC(n,e){try{const i=(await hk()).transaction(Vd,"readwrite");await i.objectStore(Vd).put(e,dk(n)),await i.done}catch(t){if(t instanceof hs)Xs.warn(t.message);else{const i=Qo.create("idb-set",{originalErrorMessage:t?.message});Xs.warn(i.message)}}}function dk(n){return`${n.name}!${n.options.appId}`}const IU=1024,CU=30;class RU{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new bU(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ZC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>CU){const r=PU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=ZC(),{heartbeatsToSend:t,unsentEntries:i}=AU(this._heartbeatsCache.heartbeats),r=Ym(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Xs.warn(e),""}}}function ZC(){return new Date().toISOString().substring(0,10)}function AU(n,e=IU){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),QC(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),QC(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class bU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ak()?pz().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await SU(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return YC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return YC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function QC(n){return Ym(JSON.stringify({version:2,heartbeats:n})).length}function PU(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function kU(n){El(new ia("platform-logger",e=>new Wz(e),"PRIVATE")),El(new ia("heartbeat",e=>new RU(e),"PRIVATE")),ss(Hv,XC,n),ss(Hv,XC,"esm2020"),ss("fire-js","")}kU("");function fk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const NU=fk,gk=new mf("auth","Firebase",fk());const Qm=new Y1("@firebase/auth");function DU(n,...e){Qm.logLevel<=He.WARN&&Qm.warn(`Auth (${Ll}): ${n}`,...e)}function hm(n,...e){Qm.logLevel<=He.ERROR&&Qm.error(`Auth (${Ll}): ${n}`,...e)}function as(n,...e){throw ew(n,...e)}function Tr(n,...e){return ew(n,...e)}function J1(n,e,t){const i={...NU(),[e]:t};return new mf("auth","Firebase",i).create(e,{appName:n.name})}function ll(n){return J1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function MU(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&as(n,"argument-error"),J1(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ew(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return gk.create(n,...e)}function Fe(n,e,...t){if(!n)throw ew(e,...t)}function Fs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw hm(e),new Error(e)}function qs(n,e){n||Fs(e)}function Yv(){return typeof self<"u"&&self.location?.href||""}function LU(){return JC()==="http:"||JC()==="https:"}function JC(){return typeof self<"u"&&self.location?.protocol||null}function OU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(LU()||fz()||"connection"in navigator)?navigator.onLine:!0}function FU(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class yf{constructor(e,t){this.shortDelay=e,this.longDelay=t,qs(t>e,"Short delay should be less than long delay!"),this.isMobile=hz()||gz()}get(){return OU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function tw(n,e){qs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class mk{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const VU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const jU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],zU=new yf(3e4,6e4);function nw(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Mu(n,e,t,i,r={}){return pk(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const l=pf({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return dz()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Ml(n.emulatorConfig.host)&&(h.credentials="include"),mk.fetch()(await yk(n,n.config.apiHost,t,l),h)})}async function pk(n,e,t){n._canInitEmulator=!1;const i={...VU,...e};try{const r=new BU(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Yg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yg(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Yg(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Yg(n,"user-disabled",o);const f=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw J1(n,f,h);as(n,f)}}catch(r){if(r instanceof hs)throw r;as(n,"network-request-failed",{message:String(r)})}}async function UU(n,e,t,i,r={}){const s=await Mu(n,e,t,i,r);return"mfaPendingCredential"in s&&as(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function yk(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?tw(n.config,r):`${n.config.apiScheme}://${r}`;return jU.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class BU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Tr(this.auth,"network-request-failed")),zU.get())})}}function Yg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Tr(n,e,i);return r.customData._tokenResponse=t,r}async function WU(n,e){return Mu(n,"POST","/v1/accounts:delete",e)}async function Jm(n,e){return Mu(n,"POST","/v1/accounts:lookup",e)}function id(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function GU(n,e=!1){const t=eo(n),i=await t.getIdToken(e),r=iw(i);Fe(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:id(K0(r.auth_time)),issuedAtTime:id(K0(r.iat)),expirationTime:id(K0(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function K0(n){return Number(n)*1e3}function iw(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return hm("JWT malformed, contained fewer than 3 sections"),null;try{const r=ZP(t);return r?JSON.parse(r):(hm("Failed to decode base64 JWT payload"),null)}catch(r){return hm("Caught error parsing JWT payload as JSON",r?.toString()),null}}function eR(n){const e=iw(n);return Fe(e,"internal-error"),Fe(typeof e.exp<"u","internal-error"),Fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function jd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof hs&&$U(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function $U({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class KU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Zv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=id(this.lastLoginAt),this.creationTime=id(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ep(n){const e=n.auth,t=await n.getIdToken(),i=await jd(n,Jm(e,{idToken:t}));Fe(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?_k(r.providerUserInfo):[],o=XU(n.providerData,s),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Zv(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function HU(n){const e=eo(n);await ep(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function XU(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function _k(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function qU(n,e){const t=await pk(n,{},async()=>{const i=pf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await yk(n,r,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:i};return n.emulatorConfig&&Ml(n.emulatorConfig.host)&&(u.credentials="include"),mk.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function YU(n,e){return Mu(n,"POST","/v2/accounts:revokeToken",nw(n,e))}class Qc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Fe(e.idToken,"internal-error"),Fe(typeof e.idToken<"u","internal-error"),Fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):eR(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Fe(e.length!==0,"internal-error");const t=eR(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await qU(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Qc;return i&&(Fe(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Fe(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Fe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qc,this.toJSON())}_performRefresh(){return Fs("not implemented")}}function ko(n,e){Fe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class _r{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new KU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Zv(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await jd(this,this.stsTokenManager.getToken(this.auth,e));return Fe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return GU(this,e)}reload(){return HU(this)}_assign(e){this!==e&&(Fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _r({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await ep(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Hi(this.auth.app))return Promise.reject(ll(this.auth));const e=await this.getIdToken();return await jd(this,WU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:m,emailVerified:y,isAnonymous:x,providerData:T,stsTokenManager:I}=t;Fe(m&&I,e,"internal-error");const S=Qc.fromJSON(this.name,I);Fe(typeof m=="string",e,"internal-error"),ko(i,e.name),ko(r,e.name),Fe(typeof y=="boolean",e,"internal-error"),Fe(typeof x=="boolean",e,"internal-error"),ko(s,e.name),ko(o,e.name),ko(l,e.name),ko(u,e.name),ko(h,e.name),ko(f,e.name);const A=new _r({uid:m,auth:e,email:r,emailVerified:y,displayName:i,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:S,createdAt:h,lastLoginAt:f});return T&&Array.isArray(T)&&(A.providerData=T.map(D=>({...D}))),u&&(A._redirectEventId=u),A}static async _fromIdTokenResponse(e,t,i=!1){const r=new Qc;r.updateFromServerResponse(t);const s=new _r({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await ep(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Fe(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?_k(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,l=new Qc;l.updateFromIdToken(i);const u=new _r({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Zv(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const tR=new Map;function Vs(n){qs(n instanceof Function,"Expected a class definition");let e=tR.get(n);return e?(qs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,tR.set(n,e),e)}class vk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}vk.type="NONE";const nR=vk;function dm(n,e,t){return`firebase:${n}:${e}:${t}`}class Jc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=dm(this.userKey,r.apiKey,s),this.fullPersistenceKey=dm("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Jm(this.auth,{idToken:e}).catch(()=>{});return t?_r._fromGetAccountInfoResponse(this.auth,t,e):null}return _r._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Jc(Vs(nR),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Vs(nR);const o=dm(i,e.config.apiKey,e.name);let l=null;for(const h of t)try{const f=await h._get(o);if(f){let m;if(typeof f=="string"){const y=await Jm(e,{idToken:f}).catch(()=>{});if(!y)break;m=await _r._fromGetAccountInfoResponse(e,y,f)}else m=_r._fromJSON(e,f);h!==s&&(l=m),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Jc(s,e,i):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Jc(s,e,i))}}function iR(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Tk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ik(e))return"Blackberry";if(Ck(e))return"Webos";if(wk(e))return"Safari";if((e.includes("chrome/")||Ek(e))&&!e.includes("edge/"))return"Chrome";if(Sk(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function xk(n=en()){return/firefox\//i.test(n)}function wk(n=en()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ek(n=en()){return/crios\//i.test(n)}function Tk(n=en()){return/iemobile/i.test(n)}function Sk(n=en()){return/android/i.test(n)}function Ik(n=en()){return/blackberry/i.test(n)}function Ck(n=en()){return/webos/i.test(n)}function rw(n=en()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function ZU(n=en()){return rw(n)&&!!window.navigator?.standalone}function QU(){return mz()&&document.documentMode===10}function Rk(n=en()){return rw(n)||Sk(n)||Ck(n)||Ik(n)||/windows phone/i.test(n)||Tk(n)}function Ak(n,e=[]){let t;switch(n){case"Browser":t=iR(en());break;case"Worker":t=`${iR(en())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ll}/${i}`}class JU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function eB(n,e={}){return Mu(n,"GET","/v2/passwordPolicy",nw(n,e))}const tB=6;class nB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??tB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class iB{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rR(this),this.idTokenSubscription=new rR(this),this.beforeStateQueue=new JU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Jc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Jm(this,{idToken:e}),i=await _r._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Hi(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&l?.user&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ep(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=FU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Hi(this.app))return Promise.reject(ll(this));const t=e?eo(e):null;return t&&Fe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Hi(this.app)?Promise.reject(ll(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Hi(this.app)?Promise.reject(ll(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await eB(this),t=new nB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new mf("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await YU(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Vs(e)||this._popupRedirectResolver;Fe(t,this,"argument-error"),this.redirectPersistenceManager=await Jc.create(this,[Vs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Fe(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ak(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Hi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&DU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Jp(n){return eo(n)}class rR{constructor(e){this.auth=e,this.observer=null,this.addObserver=wz(t=>this.observer=t)}get next(){return Fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let sw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rB(n){sw=n}function sB(n){return sw.loadJS(n)}function oB(){return sw.gapiScript}function aB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function lB(n,e){const t=Qp(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(wl(s,e??{}))return r;as(r,"already-initialized")}return t.initialize({options:e})}function cB(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Vs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function uB(n,e,t){const i=Jp(n);Fe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=bk(e),{host:o,port:l}=hB(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Fe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Fe(wl(h,i.config.emulator)&&wl(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Ml(o)?(X1(`${s}//${o}${u}`),q1("Auth",!0)):dB()}function bk(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function hB(n){const e=bk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:sR(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:sR(o)}}}function sR(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function dB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Pk{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fs("not implemented")}_getIdTokenResponse(e){return Fs("not implemented")}_linkToIdToken(e,t){return Fs("not implemented")}_getReauthenticationResolver(e){return Fs("not implemented")}}async function eu(n,e){return UU(n,"POST","/v1/accounts:signInWithIdp",nw(n,e))}const fB="http://localhost";class Tl extends Pk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Tl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):as("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new Tl(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return eu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,eu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,eu(e,t)}buildRequest(){const e={requestUri:fB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=pf(t)}return e}}class ow{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class _f extends ow{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class zo extends _f{constructor(){super("facebook.com")}static credential(e){return Tl._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zo.credential(e.oauthAccessToken)}catch{return null}}}zo.FACEBOOK_SIGN_IN_METHOD="facebook.com";zo.PROVIDER_ID="facebook.com";class Ls extends _f{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Tl._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ls.credential(t,i)}catch{return null}}}Ls.GOOGLE_SIGN_IN_METHOD="google.com";Ls.PROVIDER_ID="google.com";class Uo extends _f{constructor(){super("github.com")}static credential(e){return Tl._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.GITHUB_SIGN_IN_METHOD="github.com";Uo.PROVIDER_ID="github.com";class Bo extends _f{constructor(){super("twitter.com")}static credential(e,t){return Tl._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Bo.credential(t,i)}catch{return null}}}Bo.TWITTER_SIGN_IN_METHOD="twitter.com";Bo.PROVIDER_ID="twitter.com";class mu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await _r._fromIdTokenResponse(e,i,r),o=oR(i);return new mu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=oR(i);return new mu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function oR(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class tp extends hs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,tp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new tp(e,t,i,r)}}function kk(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?tp._fromErrorAndOperation(n,s,e,i):s})}async function gB(n,e,t=!1){const i=await jd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return mu._forOperation(n,"link",i)}async function mB(n,e,t=!1){const{auth:i}=n;if(Hi(i.app))return Promise.reject(ll(i));const r="reauthenticate";try{const s=await jd(n,kk(i,r,e,n),t);Fe(s.idToken,i,"internal-error");const o=iw(s.idToken);Fe(o,i,"internal-error");const{sub:l}=o;return Fe(n.uid===l,i,"user-mismatch"),mu._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&as(i,"user-mismatch"),s}}async function pB(n,e,t=!1){if(Hi(n.app))return Promise.reject(ll(n));const i="signIn",r=await kk(n,i,e),s=await mu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function yB(n,e,t,i){return eo(n).onIdTokenChanged(e,t,i)}function _B(n,e,t){return eo(n).beforeAuthStateChanged(e,t)}function vB(n,e,t,i){return eo(n).onAuthStateChanged(e,t,i)}function xB(n){return eo(n).signOut()}const np="__sak";class Nk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(np,"1"),this.storage.removeItem(np),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const wB=1e3,EB=10;class Dk extends Nk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Rk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);QU()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,EB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},wB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Dk.type="LOCAL";const TB=Dk;class Mk extends Nk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Mk.type="SESSION";const Lk=Mk;function SB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ey{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new ey(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const l=Array.from(o).map(async h=>h(t.origin,s)),u=await SB(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ey.receivers=[];function aw(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class IB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=aw("",20);r.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(m){const y=m;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(y.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function os(){return window}function CB(n){os().location.href=n}function Ok(){return typeof os().WorkerGlobalScope<"u"&&typeof os().importScripts=="function"}async function RB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function AB(){return navigator?.serviceWorker?.controller||null}function bB(){return Ok()?self:null}const Fk="firebaseLocalStorageDb",PB=1,ip="firebaseLocalStorage",Vk="fbase_key";class vf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ty(n,e){return n.transaction([ip],e?"readwrite":"readonly").objectStore(ip)}function kB(){const n=indexedDB.deleteDatabase(Fk);return new vf(n).toPromise()}function Qv(){const n=indexedDB.open(Fk,PB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(ip,{keyPath:Vk})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(ip)?e(i):(i.close(),await kB(),e(await Qv()))})})}async function aR(n,e,t){const i=ty(n,!0).put({[Vk]:e,value:t});return new vf(i).toPromise()}async function NB(n,e){const t=ty(n,!1).get(e),i=await new vf(t).toPromise();return i===void 0?null:i.value}function lR(n,e){const t=ty(n,!0).delete(e);return new vf(t).toPromise()}const DB=800,MB=3;class jk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Qv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>MB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ok()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ey._getInstance(bB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await RB(),!this.activeServiceWorker)return;this.sender=new IB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||AB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Qv();return await aR(e,np,"1"),await lR(e,np),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>aR(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>NB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>lR(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=ty(r,!1).getAll();return new vf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),DB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}jk.type="LOCAL";const LB=jk;new yf(3e4,6e4);function zk(n,e){return e?Vs(e):(Fe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class lw extends Pk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return eu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return eu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return eu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function OB(n){return pB(n.auth,new lw(n),n.bypassAuthState)}function FB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),mB(t,new lw(n),n.bypassAuthState)}async function VB(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),gB(t,new lw(n),n.bypassAuthState)}class Uk{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OB;case"linkViaPopup":case"linkViaRedirect":return VB;case"reauthViaPopup":case"reauthViaRedirect":return FB;default:as(this.auth,"internal-error")}}resolve(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const jB=new yf(2e3,1e4);async function zB(n,e,t){if(Hi(n.app))return Promise.reject(Tr(n,"operation-not-supported-in-this-environment"));const i=Jp(n);MU(n,e,ow);const r=zk(i,t);return new nl(i,"signInViaPopup",e,r).executeNotNull()}class nl extends Uk{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,nl.currentPopupAction&&nl.currentPopupAction.cancel(),nl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Fe(e,this.auth,"internal-error"),e}async onExecution(){qs(this.filter.length===1,"Popup operations only handle one event");const e=aw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,jB.get())};e()}}nl.currentPopupAction=null;const UB="pendingRedirect",fm=new Map;class BB extends Uk{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=fm.get(this.auth._key());if(!e){try{const i=await WB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}fm.set(this.auth._key(),e)}return this.bypassAuthState||fm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function WB(n,e){const t=KB(e),i=$B(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function GB(n,e){fm.set(n._key(),e)}function $B(n){return Vs(n._redirectPersistence)}function KB(n){return dm(UB,n.config.apiKey,n.name)}async function HB(n,e,t=!1){if(Hi(n.app))return Promise.reject(ll(n));const i=Jp(n),r=zk(i,e),o=await new BB(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const XB=600*1e3;class qB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!YB(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Bk(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Tr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=XB&&this.cachedEventUids.clear(),this.cachedEventUids.has(cR(e))}saveEventToCache(e){this.cachedEventUids.add(cR(e)),this.lastProcessedEventTime=Date.now()}}function cR(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Bk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function YB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Bk(n);default:return!1}}async function ZB(n,e={}){return Mu(n,"GET","/v1/projects",e)}const QB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,JB=/^https?/;async function e8(n){if(n.config.emulator)return;const{authorizedDomains:e}=await ZB(n);for(const t of e)try{if(t8(t))return}catch{}as(n,"unauthorized-domain")}function t8(n){const e=Yv(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!JB.test(t))return!1;if(QB.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const n8=new yf(3e4,6e4);function uR(){const n=os().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function i8(n){return new Promise((e,t)=>{function i(){uR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{uR(),t(Tr(n,"network-request-failed"))},timeout:n8.get()})}if(os().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(os().gapi?.load)i();else{const r=aB("iframefcb");return os()[r]=()=>{gapi.load?i():t(Tr(n,"network-request-failed"))},sB(`${oB()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw gm=null,e})}let gm=null;function r8(n){return gm=gm||i8(n),gm}const s8=new yf(5e3,15e3),o8="__/auth/iframe",a8="emulator/auth/iframe",l8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},c8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function u8(n){const e=n.config;Fe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?tw(e,a8):`https://${n.config.authDomain}/${o8}`,i={apiKey:e.apiKey,appName:n.name,v:Ll},r=c8.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${pf(i).slice(1)}`}async function h8(n){const e=await r8(n),t=os().gapi;return Fe(t,n,"internal-error"),e.open({where:document.body,url:u8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:l8,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Tr(n,"network-request-failed"),l=os().setTimeout(()=>{s(o)},s8.get());function u(){os().clearTimeout(l),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const d8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},f8=500,g8=600,m8="_blank",p8="http://localhost";class hR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function y8(n,e,t,i=f8,r=g8){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u={...d8,width:i.toString(),height:r.toString(),top:s,left:o},h=en().toLowerCase();t&&(l=Ek(h)?m8:t),xk(h)&&(e=e||p8,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[x,T])=>`${y}${x}=${T},`,"");if(ZU(h)&&l!=="_self")return _8(e||"",l),new hR(null);const m=window.open(e||"",l,f);Fe(m,n,"popup-blocked");try{m.focus()}catch{}return new hR(m)}function _8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const v8="__/auth/handler",x8="emulator/auth/handler",w8=encodeURIComponent("fac");async function dR(n,e,t,i,r,s){Fe(n.config.authDomain,n,"auth-domain-config-required"),Fe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ll,eventId:r};if(e instanceof ow){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",xz(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof _f){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await n._getAppCheckToken(),h=u?`#${w8}=${encodeURIComponent(u)}`:"";return`${E8(n)}?${pf(l).slice(1)}${h}`}function E8({config:n}){return n.emulator?tw(n,x8):`https://${n.authDomain}/${v8}`}const H0="webStorageSupport";class T8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Lk,this._completeRedirectFn=HB,this._overrideRedirectResult=GB}async _openPopup(e,t,i,r){qs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await dR(e,t,i,Yv(),r);return y8(e,s,aw())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await dR(e,t,i,Yv(),r);return CB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(qs(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await h8(e),i=new qB(e);return t.register("authEvent",r=>(Fe(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(H0,{type:H0},r=>{const s=r?.[0]?.[H0];s!==void 0&&t(!!s),as(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=e8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Rk()||wk()||rw()}}const S8=T8;var fR="@firebase/auth",gR="1.12.0";class I8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function C8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function R8(n){El(new ia("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=i.options;Fe(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ak(n)},h=new iB(i,r,s,u);return cB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),El(new ia("auth-internal",e=>{const t=Jp(e.getProvider("auth").getImmediate());return(i=>new I8(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ss(fR,gR,C8(n)),ss(fR,gR,"esm2020")}const A8=300,b8=nk("authIdTokenMaxAge")||A8;let mR=null;const P8=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>b8)return;const r=t?.token;mR!==r&&(mR=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function k8(n=Q1()){const e=Qp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=lB(n,{popupRedirectResolver:S8,persistence:[LB,TB,Lk]}),i=nk("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=P8(s.toString());_B(t,o,()=>o(t.currentUser)),yB(t,l=>o(l))}}const r=JP("auth");return r&&uB(t,`http://${r}`),t}function N8(){return document.getElementsByTagName("head")?.[0]??document}rB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Tr("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",N8().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});R8("Browser");var D8="firebase",M8="12.7.0";ss(D8,M8,"app");var pR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var cw;(function(){var n;function e(k,b){function M(){}M.prototype=b.prototype,k.F=b.prototype,k.prototype=new M,k.prototype.constructor=k,k.D=function(V,z,B){for(var O=Array(arguments.length-2),le=2;le<arguments.length;le++)O[le-2]=arguments[le];return b.prototype[z].apply(V,O)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,b,M){M||(M=0);const V=Array(16);if(typeof b=="string")for(var z=0;z<16;++z)V[z]=b.charCodeAt(M++)|b.charCodeAt(M++)<<8|b.charCodeAt(M++)<<16|b.charCodeAt(M++)<<24;else for(z=0;z<16;++z)V[z]=b[M++]|b[M++]<<8|b[M++]<<16|b[M++]<<24;b=k.g[0],M=k.g[1],z=k.g[2];let B=k.g[3],O;O=b+(B^M&(z^B))+V[0]+3614090360&4294967295,b=M+(O<<7&4294967295|O>>>25),O=B+(z^b&(M^z))+V[1]+3905402710&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(M^B&(b^M))+V[2]+606105819&4294967295,z=B+(O<<17&4294967295|O>>>15),O=M+(b^z&(B^b))+V[3]+3250441966&4294967295,M=z+(O<<22&4294967295|O>>>10),O=b+(B^M&(z^B))+V[4]+4118548399&4294967295,b=M+(O<<7&4294967295|O>>>25),O=B+(z^b&(M^z))+V[5]+1200080426&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(M^B&(b^M))+V[6]+2821735955&4294967295,z=B+(O<<17&4294967295|O>>>15),O=M+(b^z&(B^b))+V[7]+4249261313&4294967295,M=z+(O<<22&4294967295|O>>>10),O=b+(B^M&(z^B))+V[8]+1770035416&4294967295,b=M+(O<<7&4294967295|O>>>25),O=B+(z^b&(M^z))+V[9]+2336552879&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(M^B&(b^M))+V[10]+4294925233&4294967295,z=B+(O<<17&4294967295|O>>>15),O=M+(b^z&(B^b))+V[11]+2304563134&4294967295,M=z+(O<<22&4294967295|O>>>10),O=b+(B^M&(z^B))+V[12]+1804603682&4294967295,b=M+(O<<7&4294967295|O>>>25),O=B+(z^b&(M^z))+V[13]+4254626195&4294967295,B=b+(O<<12&4294967295|O>>>20),O=z+(M^B&(b^M))+V[14]+2792965006&4294967295,z=B+(O<<17&4294967295|O>>>15),O=M+(b^z&(B^b))+V[15]+1236535329&4294967295,M=z+(O<<22&4294967295|O>>>10),O=b+(z^B&(M^z))+V[1]+4129170786&4294967295,b=M+(O<<5&4294967295|O>>>27),O=B+(M^z&(b^M))+V[6]+3225465664&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^M&(B^b))+V[11]+643717713&4294967295,z=B+(O<<14&4294967295|O>>>18),O=M+(B^b&(z^B))+V[0]+3921069994&4294967295,M=z+(O<<20&4294967295|O>>>12),O=b+(z^B&(M^z))+V[5]+3593408605&4294967295,b=M+(O<<5&4294967295|O>>>27),O=B+(M^z&(b^M))+V[10]+38016083&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^M&(B^b))+V[15]+3634488961&4294967295,z=B+(O<<14&4294967295|O>>>18),O=M+(B^b&(z^B))+V[4]+3889429448&4294967295,M=z+(O<<20&4294967295|O>>>12),O=b+(z^B&(M^z))+V[9]+568446438&4294967295,b=M+(O<<5&4294967295|O>>>27),O=B+(M^z&(b^M))+V[14]+3275163606&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^M&(B^b))+V[3]+4107603335&4294967295,z=B+(O<<14&4294967295|O>>>18),O=M+(B^b&(z^B))+V[8]+1163531501&4294967295,M=z+(O<<20&4294967295|O>>>12),O=b+(z^B&(M^z))+V[13]+2850285829&4294967295,b=M+(O<<5&4294967295|O>>>27),O=B+(M^z&(b^M))+V[2]+4243563512&4294967295,B=b+(O<<9&4294967295|O>>>23),O=z+(b^M&(B^b))+V[7]+1735328473&4294967295,z=B+(O<<14&4294967295|O>>>18),O=M+(B^b&(z^B))+V[12]+2368359562&4294967295,M=z+(O<<20&4294967295|O>>>12),O=b+(M^z^B)+V[5]+4294588738&4294967295,b=M+(O<<4&4294967295|O>>>28),O=B+(b^M^z)+V[8]+2272392833&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^M)+V[11]+1839030562&4294967295,z=B+(O<<16&4294967295|O>>>16),O=M+(z^B^b)+V[14]+4259657740&4294967295,M=z+(O<<23&4294967295|O>>>9),O=b+(M^z^B)+V[1]+2763975236&4294967295,b=M+(O<<4&4294967295|O>>>28),O=B+(b^M^z)+V[4]+1272893353&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^M)+V[7]+4139469664&4294967295,z=B+(O<<16&4294967295|O>>>16),O=M+(z^B^b)+V[10]+3200236656&4294967295,M=z+(O<<23&4294967295|O>>>9),O=b+(M^z^B)+V[13]+681279174&4294967295,b=M+(O<<4&4294967295|O>>>28),O=B+(b^M^z)+V[0]+3936430074&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^M)+V[3]+3572445317&4294967295,z=B+(O<<16&4294967295|O>>>16),O=M+(z^B^b)+V[6]+76029189&4294967295,M=z+(O<<23&4294967295|O>>>9),O=b+(M^z^B)+V[9]+3654602809&4294967295,b=M+(O<<4&4294967295|O>>>28),O=B+(b^M^z)+V[12]+3873151461&4294967295,B=b+(O<<11&4294967295|O>>>21),O=z+(B^b^M)+V[15]+530742520&4294967295,z=B+(O<<16&4294967295|O>>>16),O=M+(z^B^b)+V[2]+3299628645&4294967295,M=z+(O<<23&4294967295|O>>>9),O=b+(z^(M|~B))+V[0]+4096336452&4294967295,b=M+(O<<6&4294967295|O>>>26),O=B+(M^(b|~z))+V[7]+1126891415&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~M))+V[14]+2878612391&4294967295,z=B+(O<<15&4294967295|O>>>17),O=M+(B^(z|~b))+V[5]+4237533241&4294967295,M=z+(O<<21&4294967295|O>>>11),O=b+(z^(M|~B))+V[12]+1700485571&4294967295,b=M+(O<<6&4294967295|O>>>26),O=B+(M^(b|~z))+V[3]+2399980690&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~M))+V[10]+4293915773&4294967295,z=B+(O<<15&4294967295|O>>>17),O=M+(B^(z|~b))+V[1]+2240044497&4294967295,M=z+(O<<21&4294967295|O>>>11),O=b+(z^(M|~B))+V[8]+1873313359&4294967295,b=M+(O<<6&4294967295|O>>>26),O=B+(M^(b|~z))+V[15]+4264355552&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~M))+V[6]+2734768916&4294967295,z=B+(O<<15&4294967295|O>>>17),O=M+(B^(z|~b))+V[13]+1309151649&4294967295,M=z+(O<<21&4294967295|O>>>11),O=b+(z^(M|~B))+V[4]+4149444226&4294967295,b=M+(O<<6&4294967295|O>>>26),O=B+(M^(b|~z))+V[11]+3174756917&4294967295,B=b+(O<<10&4294967295|O>>>22),O=z+(b^(B|~M))+V[2]+718787259&4294967295,z=B+(O<<15&4294967295|O>>>17),O=M+(B^(z|~b))+V[9]+3951481745&4294967295,k.g[0]=k.g[0]+b&4294967295,k.g[1]=k.g[1]+(z+(O<<21&4294967295|O>>>11))&4294967295,k.g[2]=k.g[2]+z&4294967295,k.g[3]=k.g[3]+B&4294967295}i.prototype.v=function(k,b){b===void 0&&(b=k.length);const M=b-this.blockSize,V=this.C;let z=this.h,B=0;for(;B<b;){if(z==0)for(;B<=M;)r(this,k,B),B+=this.blockSize;if(typeof k=="string"){for(;B<b;)if(V[z++]=k.charCodeAt(B++),z==this.blockSize){r(this,V),z=0;break}}else for(;B<b;)if(V[z++]=k[B++],z==this.blockSize){r(this,V),z=0;break}}this.h=z,this.o+=b},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var b=1;b<k.length-8;++b)k[b]=0;b=this.o*8;for(var M=k.length-8;M<k.length;++M)k[M]=b&255,b/=256;for(this.v(k),k=Array(16),b=0,M=0;M<4;++M)for(let V=0;V<32;V+=8)k[b++]=this.g[M]>>>V&255;return k};function s(k,b){var M=l;return Object.prototype.hasOwnProperty.call(M,k)?M[k]:M[k]=b(k)}function o(k,b){this.h=b;const M=[];let V=!0;for(let z=k.length-1;z>=0;z--){const B=k[z]|0;V&&B==b||(M[z]=B,V=!1)}this.g=M}var l={};function u(k){return-128<=k&&k<128?s(k,function(b){return new o([b|0],b<0?-1:0)}):new o([k|0],k<0?-1:0)}function h(k){if(isNaN(k)||!isFinite(k))return m;if(k<0)return S(h(-k));const b=[];let M=1;for(let V=0;k>=M;V++)b[V]=k/M|0,M*=4294967296;return new o(b,0)}function f(k,b){if(k.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(k.charAt(0)=="-")return S(f(k.substring(1),b));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=h(Math.pow(b,8));let V=m;for(let B=0;B<k.length;B+=8){var z=Math.min(8,k.length-B);const O=parseInt(k.substring(B,B+z),b);z<8?(z=h(Math.pow(b,z)),V=V.j(z).add(h(O))):(V=V.j(M),V=V.add(h(O)))}return V}var m=u(0),y=u(1),x=u(16777216);n=o.prototype,n.m=function(){if(I(this))return-S(this).m();let k=0,b=1;for(let M=0;M<this.g.length;M++){const V=this.i(M);k+=(V>=0?V:4294967296+V)*b,b*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(T(this))return"0";if(I(this))return"-"+S(this).toString(k);const b=h(Math.pow(k,6));var M=this;let V="";for(;;){const z=R(M,b).g;M=A(M,z.j(b));let B=((M.g.length>0?M.g[0]:M.h)>>>0).toString(k);if(M=z,T(M))return B+V;for(;B.length<6;)B="0"+B;V=B+V}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function T(k){if(k.h!=0)return!1;for(let b=0;b<k.g.length;b++)if(k.g[b]!=0)return!1;return!0}function I(k){return k.h==-1}n.l=function(k){return k=A(this,k),I(k)?-1:T(k)?0:1};function S(k){const b=k.g.length,M=[];for(let V=0;V<b;V++)M[V]=~k.g[V];return new o(M,~k.h).add(y)}n.abs=function(){return I(this)?S(this):this},n.add=function(k){const b=Math.max(this.g.length,k.g.length),M=[];let V=0;for(let z=0;z<=b;z++){let B=V+(this.i(z)&65535)+(k.i(z)&65535),O=(B>>>16)+(this.i(z)>>>16)+(k.i(z)>>>16);V=O>>>16,B&=65535,O&=65535,M[z]=O<<16|B}return new o(M,M[M.length-1]&-2147483648?-1:0)};function A(k,b){return k.add(S(b))}n.j=function(k){if(T(this)||T(k))return m;if(I(this))return I(k)?S(this).j(S(k)):S(S(this).j(k));if(I(k))return S(this.j(S(k)));if(this.l(x)<0&&k.l(x)<0)return h(this.m()*k.m());const b=this.g.length+k.g.length,M=[];for(var V=0;V<2*b;V++)M[V]=0;for(V=0;V<this.g.length;V++)for(let z=0;z<k.g.length;z++){const B=this.i(V)>>>16,O=this.i(V)&65535,le=k.i(z)>>>16,me=k.i(z)&65535;M[2*V+2*z]+=O*me,D(M,2*V+2*z),M[2*V+2*z+1]+=B*me,D(M,2*V+2*z+1),M[2*V+2*z+1]+=O*le,D(M,2*V+2*z+1),M[2*V+2*z+2]+=B*le,D(M,2*V+2*z+2)}for(k=0;k<b;k++)M[k]=M[2*k+1]<<16|M[2*k];for(k=b;k<2*b;k++)M[k]=0;return new o(M,0)};function D(k,b){for(;(k[b]&65535)!=k[b];)k[b+1]+=k[b]>>>16,k[b]&=65535,b++}function N(k,b){this.g=k,this.h=b}function R(k,b){if(T(b))throw Error("division by zero");if(T(k))return new N(m,m);if(I(k))return b=R(S(k),b),new N(S(b.g),S(b.h));if(I(b))return b=R(k,S(b)),new N(S(b.g),b.h);if(k.g.length>30){if(I(k)||I(b))throw Error("slowDivide_ only works with positive integers.");for(var M=y,V=b;V.l(k)<=0;)M=L(M),V=L(V);var z=j(M,1),B=j(V,1);for(V=j(V,2),M=j(M,2);!T(V);){var O=B.add(V);O.l(k)<=0&&(z=z.add(M),B=O),V=j(V,1),M=j(M,1)}return b=A(k,z.j(b)),new N(z,b)}for(z=m;k.l(b)>=0;){for(M=Math.max(1,Math.floor(k.m()/b.m())),V=Math.ceil(Math.log(M)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),B=h(M),O=B.j(b);I(O)||O.l(k)>0;)M-=V,B=h(M),O=B.j(b);T(B)&&(B=y),z=z.add(B),k=A(k,O)}return new N(z,k)}n.B=function(k){return R(this,k).h},n.and=function(k){const b=Math.max(this.g.length,k.g.length),M=[];for(let V=0;V<b;V++)M[V]=this.i(V)&k.i(V);return new o(M,this.h&k.h)},n.or=function(k){const b=Math.max(this.g.length,k.g.length),M=[];for(let V=0;V<b;V++)M[V]=this.i(V)|k.i(V);return new o(M,this.h|k.h)},n.xor=function(k){const b=Math.max(this.g.length,k.g.length),M=[];for(let V=0;V<b;V++)M[V]=this.i(V)^k.i(V);return new o(M,this.h^k.h)};function L(k){const b=k.g.length+1,M=[];for(let V=0;V<b;V++)M[V]=k.i(V)<<1|k.i(V-1)>>>31;return new o(M,k.h)}function j(k,b){const M=b>>5;b%=32;const V=k.g.length-M,z=[];for(let B=0;B<V;B++)z[B]=b>0?k.i(B+M)>>>b|k.i(B+M+1)<<32-b:k.i(B+M);return new o(z,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,cw=o}).apply(typeof pR<"u"?pR:typeof self<"u"?self:typeof window<"u"?window:{});var Zg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Wk,Xh,Gk,mm,Jv,$k,Kk,Hk;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zg=="object"&&Zg];for(var E=0;E<g.length;++E){var C=g[E];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=t(this);function r(g,E){if(E)e:{var C=i;g=g.split(".");for(var F=0;F<g.length-1;F++){var X=g[F];if(!(X in C))break e;C=C[X]}g=g[g.length-1],F=C[g],E=E(F),E!=F&&E!=null&&e(C,g,{configurable:!0,writable:!0,value:E})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(E){var C=[],F;for(F in E)Object.prototype.hasOwnProperty.call(E,F)&&C.push([F,E[F]]);return C}});var s=s||{},o=this||self;function l(g){var E=typeof g;return E=="object"&&g!=null||E=="function"}function u(g,E,C){return g.call.apply(g.bind,arguments)}function h(g,E,C){return h=u,h.apply(null,arguments)}function f(g,E){var C=Array.prototype.slice.call(arguments,1);return function(){var F=C.slice();return F.push.apply(F,arguments),g.apply(this,F)}}function m(g,E){function C(){}C.prototype=E.prototype,g.Z=E.prototype,g.prototype=new C,g.prototype.constructor=g,g.Ob=function(F,X,ee){for(var de=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)de[ze-2]=arguments[ze];return E.prototype[X].apply(F,de)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function x(g){const E=g.length;if(E>0){const C=Array(E);for(let F=0;F<E;F++)C[F]=g[F];return C}return[]}function T(g,E){for(let F=1;F<arguments.length;F++){const X=arguments[F];var C=typeof X;if(C=C!="object"?C:X?Array.isArray(X)?"array":C:"null",C=="array"||C=="object"&&typeof X.length=="number"){C=g.length||0;const ee=X.length||0;g.length=C+ee;for(let de=0;de<ee;de++)g[C+de]=X[de]}else g.push(X)}}class I{constructor(E,C){this.i=E,this.j=C,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function S(g){o.setTimeout(()=>{throw g},0)}function A(){var g=k;let E=null;return g.g&&(E=g.g,g.g=g.g.next,g.g||(g.h=null),E.next=null),E}class D{constructor(){this.h=this.g=null}add(E,C){const F=N.get();F.set(E,C),this.h?this.h.next=F:this.g=F,this.h=F}}var N=new I(()=>new R,g=>g.reset());class R{constructor(){this.next=this.g=this.h=null}set(E,C){this.h=E,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let L,j=!1,k=new D,b=()=>{const g=Promise.resolve(void 0);L=()=>{g.then(M)}};function M(){for(var g;g=A();){try{g.h.call(g.g)}catch(C){S(C)}var E=N;E.j(g),E.h<100&&(E.h++,g.next=E.g,E.g=g)}j=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(g,E){this.type=g,this.g=this.target=E,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,E=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const C=()=>{};o.addEventListener("test",C,E),o.removeEventListener("test",C,E)}catch{}return g})();function O(g){return/^[\s\xa0]*$/.test(g)}function le(g,E){z.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,E)}m(le,z),le.prototype.init=function(g,E){const C=this.type=g.type,F=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=E,E=g.relatedTarget,E||(C=="mouseover"?E=g.fromElement:C=="mouseout"&&(E=g.toElement)),this.relatedTarget=E,F?(this.clientX=F.clientX!==void 0?F.clientX:F.pageX,this.clientY=F.clientY!==void 0?F.clientY:F.pageY,this.screenX=F.screenX||0,this.screenY=F.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&le.Z.h.call(this)},le.prototype.h=function(){le.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var me="closure_listenable_"+(Math.random()*1e6|0),ge=0;function ue(g,E,C,F,X){this.listener=g,this.proxy=null,this.src=E,this.type=C,this.capture=!!F,this.ha=X,this.key=++ge,this.da=this.fa=!1}function Q(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function se(g,E,C){for(const F in g)E.call(C,g[F],F,g)}function ne(g,E){for(const C in g)E.call(void 0,g[C],C,g)}function G(g){const E={};for(const C in g)E[C]=g[C];return E}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(g,E){let C,F;for(let X=1;X<arguments.length;X++){F=arguments[X];for(C in F)g[C]=F[C];for(let ee=0;ee<$.length;ee++)C=$[ee],Object.prototype.hasOwnProperty.call(F,C)&&(g[C]=F[C])}}function pe(g){this.src=g,this.g={},this.h=0}pe.prototype.add=function(g,E,C,F,X){const ee=g.toString();g=this.g[ee],g||(g=this.g[ee]=[],this.h++);const de=ke(g,E,F,X);return de>-1?(E=g[de],C||(E.fa=!1)):(E=new ue(E,this.src,ee,!!F,X),E.fa=C,g.push(E)),E};function xe(g,E){const C=E.type;if(C in g.g){var F=g.g[C],X=Array.prototype.indexOf.call(F,E,void 0),ee;(ee=X>=0)&&Array.prototype.splice.call(F,X,1),ee&&(Q(E),g.g[C].length==0&&(delete g.g[C],g.h--))}}function ke(g,E,C,F){for(let X=0;X<g.length;++X){const ee=g[X];if(!ee.da&&ee.listener==E&&ee.capture==!!C&&ee.ha==F)return X}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),je={};function Ge(g,E,C,F,X){if(Array.isArray(E)){for(let ee=0;ee<E.length;ee++)Ge(g,E[ee],C,F,X);return null}return C=Pi(C),g&&g[me]?g.J(E,C,l(F)?!!F.capture:!1,X):ct(g,E,C,!1,F,X)}function ct(g,E,C,F,X,ee){if(!E)throw Error("Invalid event type");const de=l(X)?!!X.capture:!!X;let ze=dn(g);if(ze||(g[Me]=ze=new pe(g)),C=ze.add(E,C,F,de,ee),C.proxy)return C;if(F=er(),C.proxy=F,F.src=g,F.listener=C,g.addEventListener)B||(X=de),X===void 0&&(X=!1),g.addEventListener(E.toString(),F,X);else if(g.attachEvent)g.attachEvent($n(E.toString()),F);else if(g.addListener&&g.removeListener)g.addListener(F);else throw Error("addEventListener and attachEvent are unavailable.");return C}function er(){function g(C){return E.call(g.src,g.listener,C)}const E=hn;return g}function fs(g,E,C,F,X){if(Array.isArray(E))for(var ee=0;ee<E.length;ee++)fs(g,E[ee],C,F,X);else F=l(F)?!!F.capture:!!F,C=Pi(C),g&&g[me]?(g=g.i,ee=String(E).toString(),ee in g.g&&(E=g.g[ee],C=ke(E,C,F,X),C>-1&&(Q(E[C]),Array.prototype.splice.call(E,C,1),E.length==0&&(delete g.g[ee],g.h--)))):g&&(g=dn(g))&&(E=g.g[E.toString()],g=-1,E&&(g=ke(E,C,F,X)),(C=g>-1?E[g]:null)&&Gn(C))}function Gn(g){if(typeof g!="number"&&g&&!g.da){var E=g.src;if(E&&E[me])xe(E.i,g);else{var C=g.type,F=g.proxy;E.removeEventListener?E.removeEventListener(C,F,g.capture):E.detachEvent?E.detachEvent($n(C),F):E.addListener&&E.removeListener&&E.removeListener(F),(C=dn(E))?(xe(C,g),C.h==0&&(C.src=null,E[Me]=null)):Q(g)}}}function $n(g){return g in je?je[g]:je[g]="on"+g}function hn(g,E){if(g.da)g=!0;else{E=new le(E,this);const C=g.listener,F=g.ha||g.src;g.fa&&Gn(g),g=C.call(F,E)}return g}function dn(g){return g=g[Me],g instanceof pe?g:null}var Kn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Pi(g){return typeof g=="function"?g:(g[Kn]||(g[Kn]=function(E){return g.handleEvent(E)}),g[Kn])}function _t(){V.call(this),this.i=new pe(this),this.M=this,this.G=null}m(_t,V),_t.prototype[me]=!0,_t.prototype.removeEventListener=function(g,E,C,F){fs(this,g,E,C,F)};function ut(g,E){var C,F=g.G;if(F)for(C=[];F;F=F.G)C.push(F);if(g=g.M,F=E.type||E,typeof E=="string")E=new z(E,g);else if(E instanceof z)E.target=E.target||g;else{var X=E;E=new z(F,g),ie(E,X)}X=!0;let ee,de;if(C)for(de=C.length-1;de>=0;de--)ee=E.g=C[de],X=nn(ee,F,!0,E)&&X;if(ee=E.g=g,X=nn(ee,F,!0,E)&&X,X=nn(ee,F,!1,E)&&X,C)for(de=0;de<C.length;de++)ee=E.g=C[de],X=nn(ee,F,!1,E)&&X}_t.prototype.N=function(){if(_t.Z.N.call(this),this.i){var g=this.i;for(const E in g.g){const C=g.g[E];for(let F=0;F<C.length;F++)Q(C[F]);delete g.g[E],g.h--}}this.G=null},_t.prototype.J=function(g,E,C,F){return this.i.add(String(g),E,!1,C,F)},_t.prototype.K=function(g,E,C,F){return this.i.add(String(g),E,!0,C,F)};function nn(g,E,C,F){if(E=g.i.g[String(E)],!E)return!0;E=E.concat();let X=!0;for(let ee=0;ee<E.length;++ee){const de=E[ee];if(de&&!de.da&&de.capture==C){const ze=de.listener,jt=de.ha||de.src;de.fa&&xe(g.i,de),X=ze.call(jt,F)!==!1&&X}}return X&&!F.defaultPrevented}function ki(g,E){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:o.setTimeout(g,E||0)}function It(g){g.g=ki(()=>{g.g=null,g.i&&(g.i=!1,It(g))},g.l);const E=g.h;g.h=null,g.m.apply(null,E)}class to extends V{constructor(E,C){super(),this.m=E,this.l=C,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ni(g){V.call(this),this.h=g,this.g={}}m(Ni,V);var Ar=[];function tr(g){se(g.g,function(E,C){this.g.hasOwnProperty(C)&&Gn(E)},g),g.g={}}Ni.prototype.N=function(){Ni.Z.N.call(this),tr(this)},Ni.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var br=o.JSON.stringify,ua=o.JSON.parse,Pr=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function Di(){}function Fl(){}var kr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gs(){z.call(this,"d")}m(gs,z);function no(){z.call(this,"c")}m(no,z);var On={},ms=null;function Nr(){return ms=ms||new _t}On.Ia="serverreachability";function Dr(g){z.call(this,On.Ia,g)}m(Dr,z);function Fn(g){const E=Nr();ut(E,new Dr(E))}On.STAT_EVENT="statevent";function Vn(g,E){z.call(this,On.STAT_EVENT,g),this.stat=E}m(Vn,z);function gt(g){const E=Nr();ut(E,new Vn(E,g))}On.Ja="timingevent";function io(g,E){z.call(this,On.Ja,g),this.size=E}m(io,z);function nr(g,E){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},E)}function Ft(){this.g=!0}Ft.prototype.ua=function(){this.g=!1};function Mi(g,E,C,F,X,ee){g.info(function(){if(g.g)if(ee){var de="",ze=ee.split("&");for(let ht=0;ht<ze.length;ht++){var jt=ze[ht].split("=");if(jt.length>1){const Gt=jt[0];jt=jt[1];const yi=Gt.split("_");de=yi.length>=2&&yi[1]=="type"?de+(Gt+"="+jt+"&"):de+(Gt+"=redacted&")}}}else de=null;else de=ee;return"XMLHTTP REQ ("+F+") [attempt "+X+"]: "+E+`
`+C+`
`+de})}function fn(g,E,C,F,X,ee,de){g.info(function(){return"XMLHTTP RESP ("+F+") [ attempt "+X+"]: "+E+`
`+C+`
`+ee+" "+de})}function Vt(g,E,C,F){g.info(function(){return"XMLHTTP TEXT ("+E+"): "+mn(g,C)+(F?" "+F:"")})}function gn(g,E){g.info(function(){return"TIMEOUT: "+E})}Ft.prototype.info=function(){};function mn(g,E){if(!g.g)return E;if(!E)return null;try{const ee=JSON.parse(E);if(ee){for(g=0;g<ee.length;g++)if(Array.isArray(ee[g])){var C=ee[g];if(!(C.length<2)){var F=C[1];if(Array.isArray(F)&&!(F.length<1)){var X=F[0];if(X!="noop"&&X!="stop"&&X!="close")for(let de=1;de<F.length;de++)F[de]=""}}}}return br(ee)}catch{return E}}var rn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Wt;function qt(){}m(qt,Di),qt.prototype.g=function(){return new XMLHttpRequest},Wt=new qt;function Li(g){return encodeURIComponent(String(g))}function Vl(g){var E=1;g=g.split(":");const C=[];for(;E>0&&g.length;)C.push(g.shift()),E--;return g.length&&C.push(g.join(":")),C}function Oi(g,E,C,F){this.j=g,this.i=E,this.l=C,this.S=F||1,this.V=new Ni(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Sf}function Sf(){this.i=null,this.g="",this.h=!1}var If={},Fu={};function ir(g,E,C){g.M=1,g.A=ys(Fi(E)),g.u=C,g.R=!0,Vu(g,null)}function Vu(g,E){g.F=Date.now(),ha(g),g.B=Fi(g.A);var C=g.B,F=g.S;Array.isArray(F)||(F=[String(F)]),Xu(C.i,"t",F),g.C=0,C=g.j.L,g.h=new Sf,g.g=Lf(g.j,C?E:null,!g.u),g.P>0&&(g.O=new to(h(g.Y,g,g.g),g.P)),E=g.V,C=g.g,F=g.ba;var X="readystatechange";Array.isArray(X)||(X&&(Ar[0]=X.toString()),X=Ar);for(let ee=0;ee<X.length;ee++){const de=Ge(C,X[ee],F||E.handleEvent,!1,E.h||E);if(!de)break;E.g[de.key]=de}E=g.J?G(g.J):{},g.u?(g.v||(g.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,E)):(g.v="GET",g.g.ea(g.B,g.v,null,E)),Fn(),Mi(g.i,g.v,g.B,g.l,g.S,g.u)}Oi.prototype.ba=function(g){g=g.target;const E=this.O;E&&zr(g)==3?E.j():this.Y(g)},Oi.prototype.Y=function(g){try{if(g==this.g)e:{const ze=zr(this.g),jt=this.g.ya(),ht=this.g.ca();if(!(ze<3)&&(ze!=3||this.g&&(this.h.h||this.g.la()||Df(this.g)))){this.K||ze!=4||jt==7||(jt==8||ht<=0?Fn(3):Fn(2)),jl(this);var E=this.g.ca();this.X=E;var C=Cf(this);if(this.o=E==200,fn(this.i,this.v,this.B,this.l,this.S,ze,E),this.o){if(this.U&&!this.L){t:{if(this.g){var F,X=this.g;if((F=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(F)){var ee=F;break t}}ee=null}if(g=ee)Vt(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,xt(this,g);else{this.o=!1,this.m=3,gt(12),ps(this),da(this);break e}}if(this.R){g=!0;let Gt;for(;!this.K&&this.C<C.length;)if(Gt=Af(this,C),Gt==Fu){ze==4&&(this.m=4,gt(14),g=!1),Vt(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==If){this.m=4,gt(15),Vt(this.i,this.l,C,"[Invalid Chunk]"),g=!1;break}else Vt(this.i,this.l,Gt,null),xt(this,Gt);if(Rf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ze!=4||C.length!=0||this.h.h||(this.m=1,gt(16),g=!1),this.o=this.o&&g,!g)Vt(this.i,this.l,C,"[Invalid Chunked Response]"),ps(this),da(this);else if(C.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),wa(de),de.P=!0,gt(11))}}else Vt(this.i,this.l,C,null),xt(this,C);ze==4&&ps(this),this.o&&!this.K&&(ze==4?ql(this.j,this):(this.o=!1,ha(this)))}else Yu(this.g),E==400&&C.indexOf("Unknown SID")>0?(this.m=3,gt(12)):(this.m=0,gt(13)),ps(this),da(this)}}}catch{}};function Cf(g){if(!Rf(g))return g.g.la();const E=Df(g.g);if(E==="")return"";let C="";const F=E.length,X=zr(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ps(g),da(g),"";g.h.i=new o.TextDecoder}for(let ee=0;ee<F;ee++)g.h.h=!0,C+=g.h.i.decode(E[ee],{stream:!(X&&ee==F-1)});return E.length=0,g.h.g+=C,g.C=0,g.h.g}function Rf(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Af(g,E){var C=g.C,F=E.indexOf(`
`,C);return F==-1?Fu:(C=Number(E.substring(C,F)),isNaN(C)?If:(F+=1,F+C>E.length?Fu:(E=E.slice(F,F+C),g.C=F+C,E)))}Oi.prototype.cancel=function(){this.K=!0,ps(this)};function ha(g){g.T=Date.now()+g.H,ju(g,g.H)}function ju(g,E){if(g.D!=null)throw Error("WatchDog timer not null");g.D=nr(h(g.aa,g),E)}function jl(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Oi.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(gn(this.i,this.B),this.M!=2&&(Fn(),gt(17)),ps(this),this.m=2,da(this)):ju(this,this.T-g)};function da(g){g.j.I==0||g.K||ql(g.j,g)}function ps(g){jl(g);var E=g.O;E&&typeof E.dispose=="function"&&E.dispose(),g.O=null,tr(g.V),g.g&&(E=g.g,g.g=null,E.abort(),E.dispose())}function xt(g,E){try{var C=g.j;if(C.I!=0&&(C.g==g||Uu(C.h,g))){if(!g.L&&Uu(C.h,g)&&C.I==3){try{var F=C.Ba.g.parse(E)}catch{F=null}if(Array.isArray(F)&&F.length==3){var X=F;if(X[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<g.F)Xl(C),mi(C);else break e;Wr(C),gt(18)}}else C.xa=X[1],0<C.xa-C.K&&X[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=nr(h(C.Va,C),6e3));fa(C.h)<=1&&C.ta&&(C.ta=void 0)}else pi(C,11)}else if((g.L||C.g==g)&&Xl(C),!O(E))for(X=C.Ba.g.parse(E),E=0;E<X.length;E++){let ht=X[E];const Gt=ht[0];if(!(Gt<=C.K))if(C.K=Gt,ht=ht[1],C.I==2)if(ht[0]=="c"){C.M=ht[1],C.ba=ht[2];const yi=ht[3];yi!=null&&(C.ka=yi,C.j.info("VER="+C.ka));const Es=ht[4];Es!=null&&(C.za=Es,C.j.info("SVER="+C.za));const Gr=ht[5];Gr!=null&&typeof Gr=="number"&&Gr>0&&(F=1.5*Gr,C.O=F,C.j.info("backChannelRequestTimeoutMs_="+F)),F=C;const $r=g.g;if($r){const Ql=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ql){var ee=F.h;ee.g||Ql.indexOf("spdy")==-1&&Ql.indexOf("quic")==-1&&Ql.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(Ul(ee,ee.h),ee.h=null))}if(F.G){const Ju=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;Ju&&(F.wa=Ju,st(F.J,F.G,Ju))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-g.F,C.j.info("Handshake RTT: "+C.T+"ms")),F=C;var de=g;if(F.na=Qu(F,F.L?F.ba:null,F.W),de.L){ga(F.h,de);var ze=de,jt=F.O;jt&&(ze.H=jt),ze.D&&(jl(ze),ha(ze)),F.g=de}else Cn(F);C.i.length>0&&ws(C)}else ht[0]!="stop"&&ht[0]!="close"||pi(C,7);else C.I==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?pi(C,7):Kl(C):ht[0]!="noop"&&C.l&&C.l.qa(ht),C.A=0)}}Fn(4)}catch{}}var Ey=class{constructor(g,E){this.g=g,this.map=E}};function zl(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function zu(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function fa(g){return g.h?1:g.g?g.g.size:0}function Uu(g,E){return g.h?g.h==E:g.g?g.g.has(E):!1}function Ul(g,E){g.g?g.g.add(E):g.h=E}function ga(g,E){g.h&&g.h==E?g.h=null:g.g&&g.g.has(E)&&g.g.delete(E)}zl.prototype.cancel=function(){if(this.i=di(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function di(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let E=g.i;for(const C of g.g.values())E=E.concat(C.G);return E}return x(g.i)}var bf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fi(g,E){if(g){g=g.split("&");for(let C=0;C<g.length;C++){const F=g[C].indexOf("=");let X,ee=null;F>=0?(X=g[C].substring(0,F),ee=g[C].substring(F+1)):X=g[C],E(X,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Mr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;g instanceof Mr?(this.l=g.l,ma(this,g.j),this.o=g.o,this.g=g.g,Lr(this,g.u),this.h=g.h,ro(this,qu(g.i)),this.m=g.m):g&&(E=String(g).match(bf))?(this.l=!1,ma(this,E[1]||"",!0),this.o=pa(E[2]||""),this.g=pa(E[3]||"",!0),Lr(this,E[4]),this.h=pa(E[5]||"",!0),ro(this,E[6]||"",!0),this.m=pa(E[7]||"")):(this.l=!1,this.i=new Xe(null,this.l))}Mr.prototype.toString=function(){const g=[];var E=this.j;E&&g.push(ya(E,Wu,!0),":");var C=this.g;return(C||E=="file")&&(g.push("//"),(E=this.o)&&g.push(ya(E,Wu,!0),"@"),g.push(Li(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&g.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&g.push("/"),g.push(ya(C,C.charAt(0)=="/"?_a:Gu,!0))),(C=this.i.toString())&&g.push("?",C),(C=this.m)&&g.push("#",ya(C,$u)),g.join("")},Mr.prototype.resolve=function(g){const E=Fi(this);let C=!!g.j;C?ma(E,g.j):C=!!g.o,C?E.o=g.o:C=!!g.g,C?E.g=g.g:C=g.u!=null;var F=g.h;if(C)Lr(E,g.u);else if(C=!!g.h){if(F.charAt(0)!="/")if(this.g&&!this.h)F="/"+F;else{var X=E.h.lastIndexOf("/");X!=-1&&(F=E.h.slice(0,X+1)+F)}if(X=F,X==".."||X==".")F="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){F=X.lastIndexOf("/",0)==0,X=X.split("/");const ee=[];for(let de=0;de<X.length;){const ze=X[de++];ze=="."?F&&de==X.length&&ee.push(""):ze==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),F&&de==X.length&&ee.push("")):(ee.push(ze),F=!0)}F=ee.join("/")}else F=X}return C?E.h=F:C=g.i.toString()!=="",C?ro(E,qu(g.i)):C=!!g.m,C&&(E.m=g.m),E};function Fi(g){return new Mr(g)}function ma(g,E,C){g.j=C?pa(E,!0):E,g.j&&(g.j=g.j.replace(/:$/,""))}function Lr(g,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);g.u=E}else g.u=null}function ro(g,E,C){E instanceof Xe?(g.i=E,Wl(g.i,g.l)):(C||(E=ya(E,Ty)),g.i=new Xe(E,g.l))}function st(g,E,C){g.i.set(E,C)}function ys(g){return st(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function pa(g,E){return g?E?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ya(g,E,C){return typeof g=="string"?(g=encodeURI(g).replace(E,Bu),C&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Bu(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Wu=/[#\/\?@]/g,Gu=/[#\?:]/g,_a=/[#\?]/g,Ty=/[#\?@]/g,$u=/#/g;function Xe(g,E){this.h=this.g=null,this.i=g||null,this.j=!!E}function Or(g){g.g||(g.g=new Map,g.h=0,g.i&&fi(g.i,function(E,C){g.add(decodeURIComponent(E.replace(/\+/g," ")),C)}))}n=Xe.prototype,n.add=function(g,E){Or(this),this.i=null,g=Fr(this,g);let C=this.g.get(g);return C||this.g.set(g,C=[]),C.push(E),this.h+=1,this};function Ku(g,E){Or(g),E=Fr(g,E),g.g.has(E)&&(g.i=null,g.h-=g.g.get(E).length,g.g.delete(E))}function Bl(g,E){return Or(g),E=Fr(g,E),g.g.has(E)}n.forEach=function(g,E){Or(this),this.g.forEach(function(C,F){C.forEach(function(X){g.call(E,X,F,this)},this)},this)};function Hu(g,E){Or(g);let C=[];if(typeof E=="string")Bl(g,E)&&(C=C.concat(g.g.get(Fr(g,E))));else for(g=Array.from(g.g.values()),E=0;E<g.length;E++)C=C.concat(g[E]);return C}n.set=function(g,E){return Or(this),this.i=null,g=Fr(this,g),Bl(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[E]),this.h+=1,this},n.get=function(g,E){return g?(g=Hu(this,g),g.length>0?String(g[0]):E):E};function Xu(g,E,C){Ku(g,E),C.length>0&&(g.i=null,g.g.set(Fr(g,E),x(C)),g.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],E=Array.from(this.g.keys());for(let F=0;F<E.length;F++){var C=E[F];const X=Li(C);C=Hu(this,C);for(let ee=0;ee<C.length;ee++){let de=X;C[ee]!==""&&(de+="="+Li(C[ee])),g.push(de)}}return this.i=g.join("&")};function qu(g){const E=new Xe;return E.i=g.i,g.g&&(E.g=new Map(g.g),E.h=g.h),E}function Fr(g,E){return E=String(E),g.j&&(E=E.toLowerCase()),E}function Wl(g,E){E&&!g.j&&(Or(g),g.i=null,g.g.forEach(function(C,F){const X=F.toLowerCase();F!=X&&(Ku(this,F),Xu(this,X,C))},g)),g.j=E}function Vr(g,E){const C=new Ft;if(o.Image){const F=new Image;F.onload=f(pn,C,"TestLoadImage: loaded",!0,E,F),F.onerror=f(pn,C,"TestLoadImage: error",!1,E,F),F.onabort=f(pn,C,"TestLoadImage: abort",!1,E,F),F.ontimeout=f(pn,C,"TestLoadImage: timeout",!1,E,F),o.setTimeout(function(){F.ontimeout&&F.ontimeout()},1e4),F.src=g}else E(!1)}function jr(g,E){const C=new Ft,F=new AbortController,X=setTimeout(()=>{F.abort(),pn(C,"TestPingServer: timeout",!1,E)},1e4);fetch(g,{signal:F.signal}).then(ee=>{clearTimeout(X),ee.ok?pn(C,"TestPingServer: ok",!0,E):pn(C,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(X),pn(C,"TestPingServer: error",!1,E)})}function pn(g,E,C,F,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),F(C)}catch{}}function va(){this.g=new Pr}function _s(g){this.i=g.Sb||null,this.h=g.ab||!1}m(_s,Di),_s.prototype.g=function(){return new gi(this.i,this.h)};function gi(g,E){_t.call(this),this.H=g,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(gi,_t),n=gi.prototype,n.open=function(g,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=E,this.readyState=1,rr(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(E.body=g),(this.H||o).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,so(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,rr(this)),this.g&&(this.readyState=3,rr(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Pf(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Pf(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var E=g.value?g.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!g.done}))&&(this.response=this.responseText+=E)}g.done?so(this):rr(this),this.readyState==3&&Pf(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,so(this))},n.Na=function(g){this.g&&(this.response=g,so(this))},n.ga=function(){this.g&&so(this)};function so(g){g.readyState=4,g.l=null,g.j=null,g.B=null,rr(g)}n.setRequestHeader=function(g,E){this.A.append(g,E)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],E=this.h.entries();for(var C=E.next();!C.done;)C=C.value,g.push(C[0]+": "+C[1]),C=E.next();return g.join(`\r
`)};function rr(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(gi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function kf(g){let E="";return se(g,function(C,F){E+=F,E+=":",E+=C,E+=`\r
`}),E}function Gl(g,E,C){e:{for(F in C){var F=!1;break e}F=!0}F||(C=kf(C),typeof g=="string"?C!=null&&Li(C):st(g,E,C))}function pt(g){_t.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(pt,_t);var Nf=/^https?$/i,Sy=["POST","PUT"];n=pt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,E,C,F){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);E=E?E.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Wt.g(),this.g.onreadystatechange=y(h(this.Ca,this));try{this.B=!0,this.g.open(E,String(g),!0),this.B=!1}catch(ee){oo(this,ee);return}if(g=C||"",C=new Map(this.headers),F)if(Object.getPrototypeOf(F)===Object.prototype)for(var X in F)C.set(X,F[X]);else if(typeof F.keys=="function"&&typeof F.get=="function")for(const ee of F.keys())C.set(ee,F.get(ee));else throw Error("Unknown input type for opt_headers: "+String(F));F=Array.from(C.keys()).find(ee=>ee.toLowerCase()=="content-type"),X=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(Sy,E,void 0)>=0)||F||X||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,de]of C)this.g.setRequestHeader(ee,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(ee){oo(this,ee)}};function oo(g,E){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=E,g.o=5,ao(g),xs(g)}function ao(g){g.A||(g.A=!0,ut(g,"complete"),ut(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ut(this,"complete"),ut(this,"abort"),xs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xs(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?vs(this):this.Xa())},n.Xa=function(){vs(this)};function vs(g){if(g.h&&typeof s<"u"){if(g.v&&zr(g)==4)setTimeout(g.Ca.bind(g),0);else if(ut(g,"readystatechange"),zr(g)==4){g.h=!1;try{const ee=g.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var C;if(!(C=E)){var F;if(F=ee===0){let de=String(g.D).match(bf)[1]||null;!de&&o.self&&o.self.location&&(de=o.self.location.protocol.slice(0,-1)),F=!Nf.test(de?de.toLowerCase():"")}C=F}if(C)ut(g,"complete"),ut(g,"success");else{g.o=6;try{var X=zr(g)>2?g.g.statusText:""}catch{X=""}g.l=X+" ["+g.ca()+"]",ao(g)}}finally{xs(g)}}}}function xs(g,E){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const C=g.g;g.g=null,E||ut(g,"ready");try{C.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function zr(g){return g.g?g.g.readyState:0}n.ca=function(){try{return zr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var E=this.g.responseText;return g&&E.indexOf(g)==0&&(E=E.substring(g.length)),ua(E)}};function Df(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Yu(g){const E={};g=(g.g&&zr(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let F=0;F<g.length;F++){if(O(g[F]))continue;var C=Vl(g[F]);const X=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ee=E[X]||[];E[X]=ee,ee.push(C)}ne(E,function(F){return F.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ur(g,E,C){return C&&C.internalChannelParams&&C.internalChannelParams[g]||E}function $l(g){this.za=0,this.i=[],this.j=new Ft,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ur("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ur("baseRetryDelayMs",5e3,g),this.Za=Ur("retryDelaySeedMs",1e4,g),this.Ta=Ur("forwardChannelMaxRetries",2,g),this.va=Ur("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new zl(g&&g.concurrentRequestLimit),this.Ba=new va,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=$l.prototype,n.ka=8,n.I=1,n.connect=function(g,E,C,F){gt(0),this.W=g,this.H=E||{},C&&F!==void 0&&(this.H.OSID=C,this.H.OAID=F),this.F=this.X,this.J=Qu(this,null,this.W),ws(this)};function Kl(g){if(Hl(g),g.I==3){var E=g.V++,C=Fi(g.J);if(st(C,"SID",g.M),st(C,"RID",E),st(C,"TYPE","terminate"),Br(g,C),E=new Oi(g,g.j,E),E.M=2,E.A=ys(Fi(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(E.A.toString(),"")}catch{}!C&&o.Image&&(new Image().src=E.A,C=!0),C||(E.g=Lf(E.j,null),E.g.ea(E.A)),E.F=Date.now(),ha(E)}Ea(g)}function mi(g){g.g&&(wa(g),g.g.cancel(),g.g=null)}function Hl(g){mi(g),g.v&&(o.clearTimeout(g.v),g.v=null),Xl(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function ws(g){if(!zu(g.h)&&!g.m){g.m=!0;var E=g.Ea;L||b(),j||(L(),j=!0),k.add(E,g),g.D=0}}function Mf(g,E){return fa(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=E.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=nr(h(g.Ea,g,E),Yl(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const X=new Oi(this,this.j,g);let ee=this.o;if(this.U&&(ee?(ee=G(ee),ie(ee,this.U)):ee=this.U),this.u!==null||this.R||(X.J=ee,ee=null),this.S)e:{for(var E=0,C=0;C<this.i.length;C++){t:{var F=this.i[C];if("__data__"in F.map&&(F=F.map.__data__,typeof F=="string")){F=F.length;break t}F=void 0}if(F===void 0)break;if(E+=F,E>4096){E=C;break e}if(E===4096||C===this.i.length-1){E=C+1;break e}}E=1e3}else E=1e3;E=Zu(this,X,E),C=Fi(this.J),st(C,"RID",g),st(C,"CVER",22),this.G&&st(C,"X-HTTP-Session-Id",this.G),Br(this,C),ee&&(this.R?E="headers="+Li(kf(ee))+"&"+E:this.u&&Gl(C,this.u,ee)),Ul(this.h,X),this.Ra&&st(C,"TYPE","init"),this.S?(st(C,"$req",E),st(C,"SID","null"),X.U=!0,ir(X,C,null)):ir(X,C,E),this.I=2}}else this.I==3&&(g?xa(this,g):this.i.length==0||zu(this.h)||xa(this))};function xa(g,E){var C;E?C=E.l:C=g.V++;const F=Fi(g.J);st(F,"SID",g.M),st(F,"RID",C),st(F,"AID",g.K),Br(g,F),g.u&&g.o&&Gl(F,g.u,g.o),C=new Oi(g,g.j,C,g.D+1),g.u===null&&(C.J=g.o),E&&(g.i=E.G.concat(g.i)),E=Zu(g,C,1e3),C.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Ul(g.h,C),ir(C,F,E)}function Br(g,E){g.H&&se(g.H,function(C,F){st(E,F,C)}),g.l&&se({},function(C,F){st(E,F,C)})}function Zu(g,E,C){C=Math.min(g.i.length,C);const F=g.l?h(g.l.Ka,g.l,g):null;e:{var X=g.i;let ze=-1;for(;;){const jt=["count="+C];ze==-1?C>0?(ze=X[0].g,jt.push("ofs="+ze)):ze=0:jt.push("ofs="+ze);let ht=!0;for(let Gt=0;Gt<C;Gt++){var ee=X[Gt].g;const yi=X[Gt].map;if(ee-=ze,ee<0)ze=Math.max(0,X[Gt].g-100),ht=!1;else try{ee="req"+ee+"_"||"";try{var de=yi instanceof Map?yi:Object.entries(yi);for(const[Es,Gr]of de){let $r=Gr;l(Gr)&&($r=br(Gr)),jt.push(ee+Es+"="+encodeURIComponent($r))}}catch(Es){throw jt.push(ee+"type="+encodeURIComponent("_badmap")),Es}}catch{F&&F(yi)}}if(ht){de=jt.join("&");break e}}de=void 0}return g=g.i.splice(0,C),E.G=g,de}function Cn(g){if(!g.g&&!g.v){g.Y=1;var E=g.Da;L||b(),j||(L(),j=!0),k.add(E,g),g.A=0}}function Wr(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=nr(h(g.Da,g),Yl(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,lo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=nr(h(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,gt(10),mi(this),lo(this))};function wa(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function lo(g){g.g=new Oi(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var E=Fi(g.na);st(E,"RID","rpc"),st(E,"SID",g.M),st(E,"AID",g.K),st(E,"CI",g.F?"0":"1"),!g.F&&g.ia&&st(E,"TO",g.ia),st(E,"TYPE","xmlhttp"),Br(g,E),g.u&&g.o&&Gl(E,g.u,g.o),g.O&&(g.g.H=g.O);var C=g.g;g=g.ba,C.M=1,C.A=ys(Fi(E)),C.u=null,C.R=!0,Vu(C,g)}n.Va=function(){this.C!=null&&(this.C=null,mi(this),Wr(this),gt(19))};function Xl(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function ql(g,E){var C=null;if(g.g==E){Xl(g),wa(g),g.g=null;var F=2}else if(Uu(g.h,E))C=E.G,ga(g.h,E),F=1;else return;if(g.I!=0){if(E.o)if(F==1){C=E.u?E.u.length:0,E=Date.now()-E.F;var X=g.D;F=Nr(),ut(F,new io(F,C)),ws(g)}else Cn(g);else if(X=E.m,X==3||X==0&&E.X>0||!(F==1&&Mf(g,E)||F==2&&Wr(g)))switch(C&&C.length>0&&(E=g.h,E.i=E.i.concat(C)),X){case 1:pi(g,5);break;case 4:pi(g,10);break;case 3:pi(g,6);break;default:pi(g,2)}}}function Yl(g,E){let C=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(C*=2),C*E}function pi(g,E){if(g.j.info("Error code "+E),E==2){var C=h(g.bb,g),F=g.Ua;const X=!F;F=new Mr(F||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ma(F,"https"),ys(F),X?Vr(F.toString(),C):jr(F.toString(),C)}else gt(2);g.I=0,g.l&&g.l.pa(E),Ea(g),Hl(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Ea(g){if(g.I=0,g.ja=[],g.l){const E=di(g.h);(E.length!=0||g.i.length!=0)&&(T(g.ja,E),T(g.ja,g.i),g.h.i.length=0,x(g.i),g.i.length=0),g.l.oa()}}function Qu(g,E,C){var F=C instanceof Mr?Fi(C):new Mr(C);if(F.g!="")E&&(F.g=E+"."+F.g),Lr(F,F.u);else{var X=o.location;F=X.protocol,E=E?E+"."+X.hostname:X.hostname,X=+X.port;const ee=new Mr(null);F&&ma(ee,F),E&&(ee.g=E),X&&Lr(ee,X),C&&(ee.h=C),F=ee}return C=g.G,E=g.wa,C&&E&&st(F,C,E),st(F,"VER",g.ka),Br(g,F),F}function Lf(g,E,C){if(E&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=g.Aa&&!g.ma?new pt(new _s({ab:C})):new pt(g.ma),E.Fa(g.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Of(){}n=Of.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Zl(){}Zl.prototype.g=function(g,E){return new yn(g,E)};function yn(g,E){_t.call(this),this.g=new $l(E),this.l=g,this.h=E&&E.messageUrlParams||null,g=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(g?g["X-WebChannel-Content-Type"]=E.messageContentType:g={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(g?g["X-WebChannel-Client-Profile"]=E.sa:g={"X-WebChannel-Client-Profile":E.sa}),this.g.U=g,(g=E&&E.Qb)&&!O(g)&&(this.g.u=g),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!O(E)&&(this.g.G=E,g=this.h,g!==null&&E in g&&(g=this.h,E in g&&delete g[E])),this.j=new co(this)}m(yn,_t),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){Kl(this.g)},yn.prototype.o=function(g){var E=this.g;if(typeof g=="string"){var C={};C.__data__=g,g=C}else this.v&&(C={},C.__data__=br(g),g=C);E.i.push(new Ey(E.Ya++,g)),E.I==3&&ws(E)},yn.prototype.N=function(){this.g.l=null,delete this.j,Kl(this.g),delete this.g,yn.Z.N.call(this)};function Ff(g){gs.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var E=g.__sm__;if(E){e:{for(const C in E){g=C;break e}g=void 0}(this.i=g)&&(g=this.i,E=E!==null&&g in E?E[g]:void 0),this.data=E}else this.data=g}m(Ff,gs);function Vf(){no.call(this),this.status=1}m(Vf,no);function co(g){this.g=g}m(co,Of),co.prototype.ra=function(){ut(this.g,"a")},co.prototype.qa=function(g){ut(this.g,new Ff(g))},co.prototype.pa=function(g){ut(this.g,new Vf)},co.prototype.oa=function(){ut(this.g,"b")},Zl.prototype.createWebChannel=Zl.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,Hk=function(){return new Zl},Kk=function(){return Nr()},$k=On,Jv={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},rn.NO_ERROR=0,rn.TIMEOUT=8,rn.HTTP_ERROR=6,mm=rn,rt.COMPLETE="complete",Gk=rt,Fl.EventType=kr,kr.OPEN="a",kr.CLOSE="b",kr.ERROR="c",kr.MESSAGE="d",_t.prototype.listen=_t.prototype.J,Xh=Fl,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,Wk=pt}).apply(typeof Zg<"u"?Zg:typeof self<"u"?self:typeof window<"u"?window:{});const yR="@firebase/firestore",_R="4.9.3";let wn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};wn.UNAUTHENTICATED=new wn(null),wn.GOOGLE_CREDENTIALS=new wn("google-credentials-uid"),wn.FIRST_PARTY=new wn("first-party-uid"),wn.MOCK_USER=new wn("mock-user");let Lu="12.7.0";const Sl=new Y1("@firebase/firestore");function Oc(){return Sl.logLevel}function fe(n,...e){if(Sl.logLevel<=He.DEBUG){const t=e.map(uw);Sl.debug(`Firestore (${Lu}): ${n}`,...t)}}function Ti(n,...e){if(Sl.logLevel<=He.ERROR){const t=e.map(uw);Sl.error(`Firestore (${Lu}): ${n}`,...t)}}function ny(n,...e){if(Sl.logLevel<=He.WARN){const t=e.map(uw);Sl.warn(`Firestore (${Lu}): ${n}`,...t)}}function uw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ae(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Xk(n,i,t)}function Xk(n,e,t){let i=`FIRESTORE (${Lu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ti(i),new Error(i)}function De(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||Xk(e,r,i)}function St(n,e){return n}const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends hs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class cl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class qk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class L8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(wn.UNAUTHENTICATED)))}shutdown(){}}class O8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class F8{constructor(e){this.t=e,this.currentUser=wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){De(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new cl;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new cl,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},l=u=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new cl)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(De(typeof i.accessToken=="string",31837,{l:i}),new qk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return De(e===null||typeof e=="string",2055,{h:e}),new wn(e)}}class V8{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class j8{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new V8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(wn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class vR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class z8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Hi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){De(this.o===void 0,3512);const i=s=>{s.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new vR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(De(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new vR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function U8(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Yk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=U8(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function Ke(n,e){return n<e?-1:n>e?1:0}function ex(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return X0(r)===X0(s)?Ke(r,s):X0(r)?1:-1}return Ke(n.length,e.length)}const B8=55296,W8=57343;function X0(n){const e=n.charCodeAt(0);return e>=B8&&e<=W8}function pu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function Zk(n){return n+"\0"}const xR="__name__";class Yr{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ae(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ae(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Yr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Yr.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return Ke(e.length,t.length)}static compareSegments(e,t){const i=Yr.isNumericId(e),r=Yr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Yr.extractNumericId(e).compare(Yr.extractNumericId(t)):ex(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return cw.fromString(e.substring(4,e.length-2))}}class Rt extends Yr{construct(e,t,i){return new Rt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Se(ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Rt(t)}static emptyPath(){return new Rt([])}}const G8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Bt extends Yr{construct(e,t,i){return new Bt(e,t,i)}static isValidIdentifier(e){return G8.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Bt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===xR}static keyField(){return new Bt([xR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Se(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Se(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Se(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(i+=l,r++):(s(),r++)}if(s(),o)throw new Se(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Bt(t)}static emptyPath(){return new Bt([])}}class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(Rt.fromString(e))}static fromName(e){return new Ee(Rt.fromString(e).popFirst(5))}static empty(){return new Ee(Rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Rt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new Rt(e.slice()))}}function $8(n,e,t,i){if(e===!0&&i===!0)throw new Se(ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function K8(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function H8(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ae(12329,{type:typeof n})}function Qk(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Se(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=H8(n);throw new Se(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Xt(n,e){const t={typeString:n};return e&&(t.value=e),t}function xf(n,e){if(!K8(n))throw new Se(ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Se(ae.INVALID_ARGUMENT,t);return!0}const wR=-62135596800,ER=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*ER);return new kt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Se(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Se(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<wR)throw new Se(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ER}_compareTo(e){return this.seconds===e.seconds?Ke(this.nanoseconds,e.nanoseconds):Ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xf(e,kt._jsonSchema))return new kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-wR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}kt._jsonSchemaVersion="firestore/timestamp/1.0",kt._jsonSchema={type:Xt("string",kt._jsonSchemaVersion),seconds:Xt("number"),nanoseconds:Xt("number")};class Qe{static fromTimestamp(e){return new Qe(e)}static min(){return new Qe(new kt(0,0))}static max(){return new Qe(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const zd=-1;class rp{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function tx(n){return n.fields.find((e=>e.kind===2))}function Ga(n){return n.fields.filter((e=>e.kind!==2))}rp.UNKNOWN_ID=-1;class pm{constructor(e,t){this.fieldPath=e,this.kind=t}}class Ud{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ud(0,Ai.min())}}function X8(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Qe.fromTimestamp(i===1e9?new kt(t+1,0):new kt(t,i));return new Ai(r,Ee.empty(),e)}function Jk(n){return new Ai(n.readTime,n.key,zd)}class Ai{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ai(Qe.min(),Ee.empty(),zd)}static max(){return new Ai(Qe.max(),Ee.empty(),zd)}}function hw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:Ke(n.largestBatchId,e.largestBatchId))}const eN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class tN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function iy(n){if(n.code!==ae.FAILED_PRECONDITION||n.message!==eN)throw n;fe("LocalStore","Unexpectedly lost primary lease")}class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Z(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Z?t:Z.resolve(t)}catch(t){return Z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Z.reject(t)}static resolve(e){return new Z(((t,i)=>{t(e)}))}static reject(e){return new Z(((t,i)=>{i(e)}))}static waitFor(e){return new Z(((t,i)=>{let r=0,s=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=Z.resolve(!1);for(const i of e)t=t.next((r=>r?Z.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Z(((i,r)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{o[h]=f,++l,l===s&&i(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new Z(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const wi="SimpleDb";class ry{static open(e,t,i,r){try{return new ry(t,e.transaction(r,i))}catch(s){throw new rd(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new cl,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new rd(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=dw(i.target.error);this.S.reject(new rd(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(fe(wi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Y8(t)}}class Jo{static delete(e){return fe(wi,"Removing database:",e),Ha(QP().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ak())return!1;if(Jo.F())return!0;const e=en(),t=Jo.M(e),i=0<t&&t<10,r=nN(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Jo.M(en())===12.2&&Ti("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(fe(wi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new rd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new Se(ae.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new Se(ae.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new rd(e,o))},r.onupgradeneeded=s=>{fe(wi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{fe(wi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=ry.open(this.db,e,s?"readonly":"readwrite",i),u=r(l).next((h=>(l.C(),h))).catch((h=>(l.abort(h),Z.reject(h)))).toPromise();return u.catch((()=>{})),await l.D,u}catch(l){const u=l,h=u.name!=="FirebaseError"&&o<3;if(fe(wi,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function nN(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class q8{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ha(this.U.delete())}}class rd extends Se{constructor(e,t){super(ae.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ol(n){return n.name==="IndexedDbTransactionError"}class Y8{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(fe(wi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(fe(wi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ha(i)}add(e){return fe(wi,"ADD",this.store.name,e,e),Ha(this.store.add(e))}get(e){return Ha(this.store.get(e)).next((t=>(t===void 0&&(t=null),fe(wi,"GET",this.store.name,e,t),t)))}delete(e){return fe(wi,"DELETE",this.store.name,e),Ha(this.store.delete(e))}count(){return fe(wi,"COUNT",this.store.name),Ha(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new Z(((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((l,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new Z(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){fe(wi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,l)=>l.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new Z(((i,r)=>{t.onerror=s=>{const o=dw(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():i()})):i()}}))}H(e,t){const i=[];return new Z(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const u=new q8(l),h=t(l.primaryKey,l.value,u);if(h instanceof Z){const f=h.catch((m=>(u.done(),Z.reject(m))));i.push(f)}u.isDone?r():u.G===null?l.continue():l.continue(u.G)}})).next((()=>Z.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ha(n){return new Z(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=dw(i.target.error);t(r)}}))}let TR=!1;function dw(n){const e=Jo.M(en());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Se("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return TR||(TR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const sd="IndexBackfiller";class Z8{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){fe(sd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();fe(sd,`Documents written: ${t}`)}catch(t){Ol(t)?fe(sd,"Ignoring IndexedDB error during index backfill: ",t):await iy(t)}await this.re(6e4)}))}}class Q8{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return Z.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return fe(sd,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((l=>(fe(sd,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=Jk(s);hw(o,i)>0&&(i=o)})),new Ai(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class vr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}vr.ce=-1;const ul=-1;function sy(n){return n==null}function sp(n){return n===0&&1/n==-1/0}const op="";function Wn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=SR(e)),e=J8(n.get(t),e);return SR(e)}function J8(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case op:t+="";break;default:t+=s}}return t}function SR(n){return n+op+""}function es(n){const e=n.length;if(De(e>=2,64408,{path:n}),e===2)return De(n.charAt(0)===op&&n.charAt(1)==="",56145,{path:n}),Rt.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(op,s);switch((o<0||o>t)&&Ae(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let u;r.length===0?u=l:(r+=l,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Ae(61167,{path:n})}s=o+2}return new Rt(i)}const $a="remoteDocuments",wf="owner",Cc="owner",Bd="mutationQueues",eW="userId",fr="mutations",IR="batchId",il="userMutationsIndex",CR=["userId","batchId"];function ym(n,e){return[n,Wn(e)]}function iN(n,e,t){return[n,Wn(e),t]}const tW={},yu="documentMutations",ap="remoteDocumentsV14",nW=["prefixPath","collectionGroup","readTime","documentId"],_m="documentKeyIndex",iW=["prefixPath","collectionGroup","documentId"],rN="collectionGroupIndex",rW=["collectionGroup","readTime","prefixPath","documentId"],Wd="remoteDocumentGlobal",nx="remoteDocumentGlobalKey",_u="targets",sN="queryTargetsIndex",sW=["canonicalId","targetId"],vu="targetDocuments",oW=["targetId","path"],fw="documentTargetsIndex",aW=["path","targetId"],lp="targetGlobalKey",hl="targetGlobal",Gd="collectionParents",lW=["collectionId","parent"],xu="clientMetadata",cW="clientId",oy="bundles",uW="bundleId",ay="namedQueries",hW="name",gw="indexConfiguration",dW="indexId",ix="collectionGroupIndex",fW="collectionGroup",od="indexState",gW=["indexId","uid"],oN="sequenceNumberIndex",mW=["uid","sequenceNumber"],ad="indexEntries",pW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],aN="documentKeyIndex",yW=["indexId","uid","orderedDocumentKey"],ly="documentOverlays",_W=["userId","collectionPath","documentId"],rx="collectionPathOverlayIndex",vW=["userId","collectionPath","largestBatchId"],lN="collectionGroupOverlayIndex",xW=["userId","collectionGroup","largestBatchId"],mw="globals",wW="name",cN=[Bd,fr,yu,$a,_u,wf,hl,vu,xu,Wd,Gd,oy,ay],EW=[...cN,ly],uN=[Bd,fr,yu,ap,_u,wf,hl,vu,xu,Wd,Gd,oy,ay,ly],hN=uN,pw=[...hN,gw,od,ad],TW=pw,dN=[...pw,mw],SW=dN;class sx extends tN{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function tn(n,e){const t=St(n);return Jo.O(t.le,e)}function RR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function yw(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function IW(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ui{constructor(e,t){this.comparator=e,this.root=t||En.EMPTY}insert(e,t){return new ui(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new ui(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qg(this.root,e,this.comparator,!0)}}class Qg{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??En.RED,this.left=r??En.EMPTY,this.right=s??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new En(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return En.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ae(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae(57766)}get value(){throw Ae(16141)}get color(){throw Ae(16727)}get left(){throw Ae(29726)}get right(){throw Ae(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new En(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class yt{constructor(e){this.comparator=e,this.data=new ui(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new AR(this.data.getIterator())}getIteratorFrom(e){return new AR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof yt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new yt(this.comparator);return t.data=e,t}}class AR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Rc(n){return n.hasNext()?n.getNext():void 0}class js{constructor(e){this.fields=e,e.sort(Bt.comparator)}static empty(){return new js([])}unionWith(e){let t=new yt(Bt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new js(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class CW extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class hi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new CW("Invalid base64 string: "+s):s}})(e);return new hi(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new hi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}hi.EMPTY_BYTE_STRING=new hi("");const RW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ra(n){if(De(!!n,39018),typeof n=="string"){let e=0;const t=RW.exec(n);if(De(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ht(n.seconds),nanos:Ht(n.nanos)}}function Ht(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wu(n){return typeof n=="string"?hi.fromBase64String(n):hi.fromUint8Array(n)}const fN="server_timestamp",gN="__type__",mN="__previous_value__",pN="__local_write_time__";function _w(n){return(n?.mapValue?.fields||{})[gN]?.stringValue===fN}function yN(n){const e=n.mapValue.fields[mN];return _w(e)?yN(e):e}function cp(n){const e=ra(n.mapValue.fields[pN].timestampValue);return new kt(e.seconds,e.nanos)}class AW{constructor(e,t,i,r,s,o,l,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const up="(default)";class Eu{constructor(e,t){this.projectId=e,this.database=t||up}static empty(){return new Eu("","")}get isDefaultDatabase(){return this.database===up}isEqual(e){return e instanceof Eu&&e.projectId===this.projectId&&e.database===this.database}}const _N="__type__",vN="__max__",Ho={mapValue:{fields:{__type__:{stringValue:vN}}}},xN="__vector__",hp="value",vm={nullValue:"NULL_VALUE"};function Tu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?_w(n)?4:wN(n)?9007199254740991:cy(n)?10:11:Ae(28295,{value:n})}function ls(n,e){if(n===e)return!0;const t=Tu(n);if(t!==Tu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return cp(n).isEqual(cp(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ra(r.timestampValue),l=ra(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return wu(r.bytesValue).isEqual(wu(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Ht(r.geoPointValue.latitude)===Ht(s.geoPointValue.latitude)&&Ht(r.geoPointValue.longitude)===Ht(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Ht(r.integerValue)===Ht(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Ht(r.doubleValue),l=Ht(s.doubleValue);return o===l?sp(o)===sp(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return pu(n.arrayValue.values||[],e.arrayValue.values||[],ls);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(RR(o)!==RR(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!ls(o[u],l[u])))return!1;return!0})(n,e);default:return Ae(52216,{left:n})}}function $d(n,e){return(n.values||[]).find((t=>ls(t,e)))!==void 0}function sa(n,e){if(n===e)return 0;const t=Tu(n),i=Tu(e);if(t!==i)return Ke(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ke(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const l=Ht(s.integerValue||s.doubleValue),u=Ht(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,e);case 3:return bR(n.timestampValue,e.timestampValue);case 4:return bR(cp(n),cp(e));case 5:return ex(n.stringValue,e.stringValue);case 6:return(function(s,o){const l=wu(s),u=wu(o);return l.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=Ke(l[h],u[h]);if(f!==0)return f}return Ke(l.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const l=Ke(Ht(s.latitude),Ht(o.latitude));return l!==0?l:Ke(Ht(s.longitude),Ht(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return PR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[hp]?.arrayValue,f=u[hp]?.arrayValue,m=Ke(h?.values?.length||0,f?.values?.length||0);return m!==0?m:PR(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Ho.mapValue&&o===Ho.mapValue)return 0;if(s===Ho.mapValue)return 1;if(o===Ho.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const y=ex(u[m],f[m]);if(y!==0)return y;const x=sa(l[u[m]],h[f[m]]);if(x!==0)return x}return Ke(u.length,f.length)})(n.mapValue,e.mapValue);default:throw Ae(23264,{he:t})}}function bR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ke(n,e);const t=ra(n),i=ra(e),r=Ke(t.seconds,i.seconds);return r!==0?r:Ke(t.nanos,i.nanos)}function PR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=sa(t[r],i[r]);if(s)return s}return Ke(t.length,i.length)}function Su(n){return ox(n)}function ox(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ra(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return wu(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ee.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=ox(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${ox(t.fields[o])}`;return r+"}"})(n.mapValue):Ae(61005,{value:n})}function vw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ax(n){return!!n&&"integerValue"in n}function Kd(n){return!!n&&"arrayValue"in n}function kR(n){return!!n&&"nullValue"in n}function NR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function q0(n){return!!n&&"mapValue"in n}function cy(n){return(n?.mapValue?.fields||{})[_N]?.stringValue===xN}function ld(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return yw(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=ld(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ld(n.arrayValue.values[t]);return e}return{...n}}function wN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===vN}const EN={mapValue:{fields:{[_N]:{stringValue:xN},[hp]:{arrayValue:{}}}}};function bW(n){return"nullValue"in n?vm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?vw(Eu.empty(),Ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?cy(n)?EN:{mapValue:{}}:Ae(35942,{value:n})}function PW(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?vw(Eu.empty(),Ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?EN:"mapValue"in n?cy(n)?{mapValue:{}}:Ho:Ae(61959,{value:n})}function DR(n,e){const t=sa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function MR(n,e){const t=sa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class yr{constructor(e){this.value=e}static empty(){return new yr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!q0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ld(t)}setAll(e){let t=Bt.emptyPath(),i={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=l.popLast()}o?i[l.lastSegment()]=ld(o):r.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());q0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ls(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];q0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){yw(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new yr(ld(this.value))}}class Tn{constructor(e,t,i,r,s,o,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tn(e,0,Qe.min(),Qe.min(),Qe.min(),yr.empty(),0)}static newFoundDocument(e,t,i,r){return new Tn(e,1,t,Qe.min(),i,r,0)}static newNoDocument(e,t){return new Tn(e,2,t,Qe.min(),Qe.min(),yr.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,Qe.min(),Qe.min(),yr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Iu{constructor(e,t){this.position=e,this.inclusive=t}}function LR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=Ee.comparator(Ee.fromName(o.referenceValue),t.key):i=sa(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function OR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ls(n.position[t],e.position[t]))return!1;return!0}class dp{constructor(e,t="asc"){this.field=e,this.dir=t}}function kW(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class TN{}class Ye extends TN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new NW(e,t,i):t==="array-contains"?new LW(e,i):t==="in"?new bN(e,i):t==="not-in"?new OW(e,i):t==="array-contains-any"?new FW(e,i):new Ye(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new DW(e,i):new MW(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(sa(t,this.value)):t!==null&&Tu(this.value)===Tu(t)&&this.matchesComparison(sa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mt extends TN{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new mt(e,t)}matches(e){return Cu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Cu(n){return n.op==="and"}function lx(n){return n.op==="or"}function xw(n){return SN(n)&&Cu(n)}function SN(n){for(const e of n.filters)if(e instanceof mt)return!1;return!0}function cx(n){if(n instanceof Ye)return n.field.canonicalString()+n.op.toString()+Su(n.value);if(xw(n))return n.filters.map((e=>cx(e))).join(",");{const e=n.filters.map((t=>cx(t))).join(",");return`${n.op}(${e})`}}function IN(n,e){return n instanceof Ye?(function(i,r){return r instanceof Ye&&i.op===r.op&&i.field.isEqual(r.field)&&ls(i.value,r.value)})(n,e):n instanceof mt?(function(i,r){return r instanceof mt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,l)=>s&&IN(o,r.filters[l])),!0):!1})(n,e):void Ae(19439)}function CN(n,e){const t=n.filters.concat(e);return mt.create(t,n.op)}function RN(n){return n instanceof Ye?(function(t){return`${t.field.canonicalString()} ${t.op} ${Su(t.value)}`})(n):n instanceof mt?(function(t){return t.op.toString()+" {"+t.getFilters().map(RN).join(" ,")+"}"})(n):"Filter"}class NW extends Ye{constructor(e,t,i){super(e,t,i),this.key=Ee.fromName(i.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class DW extends Ye{constructor(e,t){super(e,"in",t),this.keys=AN("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class MW extends Ye{constructor(e,t){super(e,"not-in",t),this.keys=AN("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function AN(n,e){return(e.arrayValue?.values||[]).map((t=>Ee.fromName(t.referenceValue)))}class LW extends Ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Kd(t)&&$d(t.arrayValue,this.value)}}class bN extends Ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&$d(this.value.arrayValue,t)}}class OW extends Ye{constructor(e,t){super(e,"not-in",t)}matches(e){if($d(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!$d(this.value.arrayValue,t)}}class FW extends Ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Kd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>$d(this.value.arrayValue,i)))}}class VW{constructor(e,t=null,i=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function ux(n,e=null,t=[],i=[],r=null,s=null,o=null){return new VW(n,e,t,i,r,s,o)}function Il(n){const e=St(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>cx(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),sy(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Su(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Su(i))).join(",")),e.Te=t}return e.Te}function Ef(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!kW(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!IN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!OR(n.startAt,e.startAt)&&OR(n.endAt,e.endAt)}function jW(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function fp(n,e){return n.filters.filter((t=>t instanceof Ye&&t.field.isEqual(e)))}function FR(n,e,t){let i=vm,r=!0;for(const s of fp(n,e)){let o=vm,l=!0;switch(s.op){case"<":case"<=":o=bW(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=vm}DR({value:i,inclusive:r},{value:o,inclusive:l})<0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];DR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function VR(n,e,t){let i=Ho,r=!0;for(const s of fp(n,e)){let o=Ho,l=!0;switch(s.op){case">=":case">":o=PW(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Ho}MR({value:i,inclusive:r},{value:o,inclusive:l})>0&&(i=o,r=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];MR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class uy{constructor(e,t=null,i=[],r=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function zW(n,e,t,i,r,s,o,l){return new uy(n,e,t,i,r,s,o,l)}function PN(n){return new uy(n)}function jR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function UW(n){return n.collectionGroup!==null}function cd(n){const e=St(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new yt(Bt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new dp(s,i))})),t.has(Bt.keyField().canonicalString())||e.Ie.push(new dp(Bt.keyField(),i))}return e.Ie}function $s(n){const e=St(n);return e.Ee||(e.Ee=BW(e,cd(n))),e.Ee}function BW(n,e){if(n.limitType==="F")return ux(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new dp(r.field,s)}));const t=n.endAt?new Iu(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Iu(n.startAt.position,n.startAt.inclusive):null;return ux(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function hx(n,e,t){return new uy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function kN(n,e){return Ef($s(n),$s(e))&&n.limitType===e.limitType}function NN(n){return`${Il($s(n))}|lt:${n.limitType}`}function Nh(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>RN(r))).join(", ")}]`),sy(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>Su(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>Su(r))).join(",")),`Target(${i})`})($s(n))}; limitType=${n.limitType})`}function hy(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ee.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of cd(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,l,u){const h=LR(o,l,u);return o.inclusive?h<=0:h<0})(i.startAt,cd(i),r)||i.endAt&&!(function(o,l,u){const h=LR(o,l,u);return o.inclusive?h>=0:h>0})(i.endAt,cd(i),r))})(n,e)}function WW(n){return(e,t)=>{let i=!1;for(const r of cd(n)){const s=GW(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function GW(n,e,t){const i=n.field.isKeyField()?Ee.comparator(e.key,t.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?sa(u,h):Ae(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ae(19790,{direction:n.dir})}}class ca{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){yw(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return IW(this.inner)}size(){return this.innerSize}}const $W=new ui(Ee.comparator);function rl(){return $W}const DN=new ui(Ee.comparator);function Jg(...n){let e=DN;for(const t of n)e=e.insert(t.key,t);return e}function KW(n){let e=DN;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function ts(){return ud()}function MN(){return ud()}function ud(){return new ca((n=>n.toString()),((n,e)=>n.isEqual(e)))}const HW=new ui(Ee.comparator),XW=new yt(Ee.comparator);function Sn(...n){let e=XW;for(const t of n)e=e.add(t);return e}const qW=new yt(Ke);function YW(){return qW}function ZW(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sp(e)?"-0":e}}function QW(n){return{integerValue:""+n}}class dy{constructor(){this._=void 0}}function JW(n,e,t){return n instanceof Hd?(function(r,s){const o={fields:{[gN]:{stringValue:fN},[pN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&_w(s)&&(s=yN(s)),s&&(o.fields[mN]=s),{mapValue:o}})(t,e):n instanceof Ru?LN(n,e):n instanceof Au?ON(n,e):(function(r,s){const o=tG(r,s),l=zR(o)+zR(r.Ae);return ax(o)&&ax(r.Ae)?QW(l):ZW(r.serializer,l)})(n,e)}function eG(n,e,t){return n instanceof Ru?LN(n,e):n instanceof Au?ON(n,e):t}function tG(n,e){return n instanceof Xd?(function(i){return ax(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class Hd extends dy{}class Ru extends dy{constructor(e){super(),this.elements=e}}function LN(n,e){const t=FN(e);for(const i of n.elements)t.some((r=>ls(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Au extends dy{constructor(e){super(),this.elements=e}}function ON(n,e){let t=FN(e);for(const i of n.elements)t=t.filter((r=>!ls(r,i)));return{arrayValue:{values:t}}}class Xd extends dy{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function zR(n){return Ht(n.integerValue||n.doubleValue)}function FN(n){return Kd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class nG{constructor(e,t){this.field=e,this.transform=t}}function iG(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Ru&&r instanceof Ru||i instanceof Au&&r instanceof Au?pu(i.elements,r.elements,ls):i instanceof Xd&&r instanceof Xd?ls(i.Ae,r.Ae):i instanceof Hd&&r instanceof Hd})(n.transform,e.transform)}class rG{constructor(e,t){this.version=e,this.transformResults=t}}class xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xr}static exists(e){return new xr(void 0,e)}static updateTime(e){return new xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class fy{}function VN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ww(n.key,xr.none()):new Tf(n.key,n.data,xr.none());{const t=n.data,i=yr.empty();let r=new yt(Bt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Ou(n.key,i,new js(r.toArray()),xr.none())}}function sG(n,e,t){n instanceof Tf?(function(r,s,o){const l=r.value.clone(),u=BR(r.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Ou?(function(r,s,o){if(!xm(r.precondition,s))return void s.convertToUnknownDocument(o.version);const l=BR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(jN(r)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function hd(n,e,t,i){return n instanceof Tf?(function(s,o,l,u){if(!xm(s.precondition,o))return l;const h=s.value.clone(),f=WR(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Ou?(function(s,o,l,u){if(!xm(s.precondition,o))return l;const h=WR(s.fieldTransforms,u,o),f=o.data;return f.setAll(jN(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((m=>m.field)))})(n,e,t,i):(function(s,o,l){return xm(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function UR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&pu(i,r,((s,o)=>iG(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Tf extends fy{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ou extends fy{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function jN(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function BR(n,e,t){const i=new Map;De(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,l=e.data.field(s.field);i.set(s.field,eG(o,l,t[r]))}return i}function WR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,JW(s,o,e))}return i}class ww extends fy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zN extends fy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ew{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&sG(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=hd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=hd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=MN();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;const u=VN(o,l);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Qe.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Sn())}isEqual(e){return this.batchId===e.batchId&&pu(this.mutations,e.mutations,((t,i)=>UR(t,i)))&&pu(this.baseMutations,e.baseMutations,((t,i)=>UR(t,i)))}}class Tw{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){De(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return HW})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new Tw(e,t,i,r)}}class Sw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var Kt,Ze;function oG(n){switch(n){case ae.OK:return Ae(64938);case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return Ae(15467,{code:n})}}function aG(n){if(n===void 0)return Ti("GRPC error has no .code"),ae.UNKNOWN;switch(n){case Kt.OK:return ae.OK;case Kt.CANCELLED:return ae.CANCELLED;case Kt.UNKNOWN:return ae.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return ae.INTERNAL;case Kt.UNAVAILABLE:return ae.UNAVAILABLE;case Kt.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case Kt.NOT_FOUND:return ae.NOT_FOUND;case Kt.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case Kt.ABORTED:return ae.ABORTED;case Kt.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case Kt.DATA_LOSS:return ae.DATA_LOSS;default:return Ae(39323,{code:n})}}(Ze=Kt||(Kt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";new cw([4294967295,4294967295],0);const lG={asc:"ASCENDING",desc:"DESCENDING"},cG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uG={and:"AND",or:"OR"};class hG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function dG(n,e){return n.useProto3Json||sy(e)?e:{value:e}}function dx(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fG(n,e){return dx(n,e.toTimestamp())}function Sr(n){return De(!!n,49232),Qe.fromTimestamp((function(t){const i=ra(t);return new kt(i.seconds,i.nanos)})(n))}function UN(n,e){return fx(n,e).canonicalString()}function fx(n,e){const t=(function(r){return new Rt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function BN(n){const e=Rt.fromString(n);return De(TG(e),10190,{key:e.toString()}),e}function gp(n,e){return UN(n.databaseId,e.path)}function wm(n,e){const t=BN(e);if(t.get(1)!==n.databaseId.projectId)throw new Se(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Se(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee($N(t))}function WN(n,e){return UN(n.databaseId,e)}function GN(n){const e=BN(n);return e.length===4?Rt.emptyPath():$N(e)}function gG(n){return new Rt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function $N(n){return De(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function GR(n,e,t){return{name:gp(n,e),fields:t.value.mapValue.fields}}function mG(n,e,t){const i=wm(n,e.name),r=Sr(e.updateTime),s=e.createTime?Sr(e.createTime):Qe.min(),o=new yr({mapValue:{fields:e.fields}}),l=Tn.newFoundDocument(i,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function mp(n,e){let t;if(e instanceof Tf)t={update:GR(n,e.key,e.value)};else if(e instanceof ww)t={delete:gp(n,e.key)};else if(e instanceof Ou)t={update:GR(n,e.key,e.data),updateMask:EG(e.fieldMask)};else{if(!(e instanceof zN))return Ae(16599,{Vt:e.type});t={verify:gp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const l=o.transform;if(l instanceof Hd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ru)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Au)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Xd)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Ae(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:fG(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ae(27497)})(n,e.precondition)),t}function gx(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?xr.updateTime(Sr(s.updateTime)):s.exists!==void 0?xr.exists(s.exists):xr.none()})(e.currentDocument):xr.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let u=null;if("setToServerValue"in l)De(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new Hd;else if("appendMissingElements"in l){const f=l.appendMissingElements.values||[];u=new Ru(f)}else if("removeAllFromArray"in l){const f=l.removeAllFromArray.values||[];u=new Au(f)}else"increment"in l?u=new Xd(o,l.increment):Ae(16584,{proto:l});const h=Bt.fromServerFormat(l.fieldPath);return new nG(h,u)})(n,r))):[];if(e.update){e.update.name;const r=wm(n,e.update.name),s=new yr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new js(h.map((f=>Bt.fromServerFormat(f))))})(e.updateMask);return new Ou(r,s,o,t,i)}return new Tf(r,s,t,i)}if(e.delete){const r=wm(n,e.delete);return new ww(r,t)}if(e.verify){const r=wm(n,e.verify);return new zN(r,t)}return Ae(1463,{proto:e})}function pG(n,e){return n&&n.length>0?(De(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?Sr(r.updateTime):Sr(s);return o.isEqual(Qe.min())&&(o=Sr(s)),new rG(o,r.transformResults||[])})(t,e)))):[]}function yG(n,e){return{documents:[WN(n,e.path)]}}function _G(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=WN(n,r);const s=(function(h){if(h.length!==0)return XN(mt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((f=>(function(y){return{field:Fc(y.field),direction:vG(y.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=dG(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function KN(n){let e=GN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){De(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(m){const y=HN(m);return y instanceof mt&&xw(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(m){return m.map((y=>(function(T){return new dp(Vc(T.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(y)))})(t.orderBy));let l=null;t.limit&&(l=(function(m){let y;return y=typeof m=="object"?m.value:m,sy(y)?null:y})(t.limit));let u=null;t.startAt&&(u=(function(m){const y=!!m.before,x=m.values||[];return new Iu(x,y)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const y=!m.before,x=m.values||[];return new Iu(x,y)})(t.endAt)),zW(e,r,o,s,l,"F",u,h)}function HN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Vc(t.unaryFilter.field);return Ye.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Vc(t.unaryFilter.field);return Ye.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Vc(t.unaryFilter.field);return Ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Vc(t.unaryFilter.field);return Ye.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ae(61313);default:return Ae(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ye.create(Vc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ae(58110);default:return Ae(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return mt.create(t.compositeFilter.filters.map((i=>HN(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ae(1026)}})(t.compositeFilter.op))})(n):Ae(30097,{filter:n})}function vG(n){return lG[n]}function xG(n){return cG[n]}function wG(n){return uG[n]}function Fc(n){return{fieldPath:n.canonicalString()}}function Vc(n){return Bt.fromServerFormat(n.fieldPath)}function XN(n){return n instanceof Ye?(function(t){if(t.op==="=="){if(NR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NAN"}};if(kR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(NR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NOT_NAN"}};if(kR(t.value))return{unaryFilter:{field:Fc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fc(t.field),op:xG(t.op),value:t.value}}})(n):n instanceof mt?(function(t){const i=t.getFilters().map((r=>XN(r)));return i.length===1?i[0]:{compositeFilter:{op:wG(t.op),filters:i}}})(n):Ae(54877,{filter:n})}function EG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function TG(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Hc{constructor(e,t,i,r,s=Qe.min(),o=Qe.min(),l=hi.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Hc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Hc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Hc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Hc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class qN{constructor(e){this.yt=e}}function SG(n,e){let t;if(e.document)t=mG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Ee.fromSegments(e.noDocument.path),r=Rl(e.noDocument.readTime);t=Tn.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ae(56709);{const i=Ee.fromSegments(e.unknownDocument.path),r=Rl(e.unknownDocument.version);t=Tn.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new kt(r[0],r[1]);return Qe.fromTimestamp(s)})(e.readTime)),t}function $R(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:pp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:gp(s,o.key),fields:o.data.value.mapValue.fields,updateTime:dx(s,o.version.toTimestamp()),createTime:dx(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Cl(e.version)};else{if(!e.isUnknownDocument())return Ae(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Cl(e.version)}}return i}function pp(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Cl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Rl(n){const e=new kt(n.seconds,n.nanoseconds);return Qe.fromTimestamp(e)}function Xa(n,e){const t=(e.baseMutations||[]).map((s=>gx(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>gx(n.yt,s))),r=kt.fromMillis(e.localWriteTimeMs);return new Ew(e.batchId,r,t,i)}function qh(n){const e=Rl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Rl(n.lastLimboFreeSnapshotVersion):Qe.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return De(o===1,1966,{count:o}),$s(PN(GN(s.documents[0])))})(n.query):(function(s){return $s(KN(s))})(n.query),new Hc(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,hi.fromBase64String(n.resumeToken))}function YN(n,e){const t=Cl(e.snapshotVersion),i=Cl(e.lastLimboFreeSnapshotVersion);let r;r=jW(e.target)?yG(n.yt,e.target):_G(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Il(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function ZN(n){const e=KN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?hx(e,e.limit,"L"):e}function Y0(n,e){return new Sw(e.largestBatchId,gx(n.yt,e.overlayMutation))}function KR(n,e){const t=e.path.lastSegment();return[n,Wn(e.path.popLast()),t]}function HR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Cl(i.readTime),documentKey:Wn(i.documentKey.path),largestBatchId:i.largestBatchId}}class IG{getBundleMetadata(e,t){return XR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:Rl(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return XR(e).put((function(r){return{bundleId:r.id,createTime:Cl(Sr(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return qR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:ZN(s.bundledQuery),readTime:Rl(s.readTime)}})(i)}))}saveNamedQuery(e,t){return qR(e).put((function(r){return{name:r.name,readTime:Cl(Sr(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function XR(n){return tn(n,oy)}function qR(n){return tn(n,ay)}class gy{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new gy(e,i)}getOverlay(e,t){return Dh(e).get(KR(this.userId,t)).next((i=>i?Y0(this.serializer,i):null))}getOverlays(e,t){const i=ts();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const l=new Sw(t,o);r.push(this.St(e,l))})),Z.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(Wn(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Dh(e).Z(rx,l))})),Z.waitFor(s)}getOverlaysForCollection(e,t,i){const r=ts(),s=Wn(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Dh(e).J(rx,o).next((l=>{for(const u of l){const h=Y0(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=ts();let o;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Dh(e).ee({index:lN,range:l},((u,h,f)=>{const m=Y0(this.serializer,h);s.size()<r||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Dh(e).put((function(r,s,o){const[l,u,h]=KR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:mp(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Dh(n){return tn(n,ly)}class CG{bt(e){return tn(e,mw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?hi.fromUint8Array(i):hi.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class qa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ht(e.integerValue));else if("doubleValue"in e){const i=Ht(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),sp(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ra(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(wu(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?wN(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):cy(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ae(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=hp,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ht(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ee.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}qa.Kt=new qa;const Ac=255;function RG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function YR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=RG(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class AG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=YR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=YR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Ac),this.sn(255)}_n(){this.an(Ac),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ac?(this.sn(Ac),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ac?(this.an(Ac),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class bG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class PG{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Mh{constructor(){this.cn=new AG,this.ln=new bG(this.cn),this.hn=new PG(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Ya{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Ya(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Em(this.En),directionalValue:Em(this.dn),orderedDocumentKey:Em(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function No(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=ZR(n.En,e.En),t!==0?t:(t=ZR(n.dn,e.dn),t!==0?t:Ee.comparator(n.In,e.In)))}function ZR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Em(n){return ok()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function QR(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class JR{constructor(e){this.mn=new yt(((t,i)=>Bt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(De(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=tx(e);if(t!==void 0&&!this.wn(t))return!1;const i=Ga(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const u=i[s];if(!this.Sn(l,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const l=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new yt(Bt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new pm(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new pm(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new pm(i.field,i.dir==="asc"?0:1)));return new rp(rp.UNKNOWN_ID,this.collectionId,t,Ud.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function QN(n){if(De(n instanceof Ye||n instanceof mt,20012),n instanceof Ye){if(n instanceof bN){const t=n.value.arrayValue?.values?.map((i=>Ye.create(n.field,"==",i)))||[];return mt.create(t,"or")}return n}const e=n.filters.map((t=>QN(t)));return mt.create(e,n.op)}function kG(n){if(n.getFilters().length===0)return[];const e=yx(QN(n));return De(JN(e),7391),mx(e)||px(e)?[e]:e.getFilters()}function mx(n){return n instanceof Ye}function px(n){return n instanceof mt&&xw(n)}function JN(n){return mx(n)||px(n)||(function(t){if(t instanceof mt&&lx(t)){for(const i of t.getFilters())if(!mx(i)&&!px(i))return!1;return!0}return!1})(n)}function yx(n){if(De(n instanceof Ye||n instanceof mt,34018),n instanceof Ye)return n;if(n.filters.length===1)return yx(n.filters[0]);const e=n.filters.map((i=>yx(i)));let t=mt.create(e,n.op);return t=yp(t),JN(t)?t:(De(t instanceof mt,64498),De(Cu(t),40251),De(t.filters.length>1,57927),t.filters.reduce(((i,r)=>Iw(i,r))))}function Iw(n,e){let t;return De(n instanceof Ye||n instanceof mt,38388),De(e instanceof Ye||e instanceof mt,25473),t=n instanceof Ye?e instanceof Ye?(function(r,s){return mt.create([r,s],"and")})(n,e):e2(n,e):e instanceof Ye?e2(e,n):(function(r,s){if(De(r.filters.length>0&&s.filters.length>0,48005),Cu(r)&&Cu(s))return CN(r,s.getFilters());const o=lx(r)?r:s,l=lx(r)?s:r,u=o.filters.map((h=>Iw(h,l)));return mt.create(u,"or")})(n,e),yp(t)}function e2(n,e){if(Cu(e))return CN(e,n.getFilters());{const t=e.filters.map((i=>Iw(n,i)));return mt.create(t,"or")}}function yp(n){if(De(n instanceof Ye||n instanceof mt,11850),n instanceof Ye)return n;const e=n.getFilters();if(e.length===1)return yp(e[0]);if(SN(n))return n;const t=e.map((r=>yp(r))),i=[];return t.forEach((r=>{r instanceof Ye?i.push(r):r instanceof mt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:mt.create(i,n.op)}class NG{constructor(){this.Cn=new Cw}addToCollectionParentIndex(e,t){return this.Cn.add(t),Z.resolve()}getCollectionParents(e,t){return Z.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Z.resolve()}deleteFieldIndex(e,t){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,t){return Z.resolve()}getDocumentsMatchingTarget(e,t){return Z.resolve(null)}getIndexType(e,t){return Z.resolve(0)}getFieldIndexes(e,t){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,t){return Z.resolve(Ai.min())}getMinOffsetFromCollectionGroup(e,t){return Z.resolve(Ai.min())}updateCollectionGroup(e,t,i){return Z.resolve()}updateIndexEntries(e,t){return Z.resolve()}}class Cw{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new yt(Rt.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new yt(Rt.comparator)).toArray()}}const t2="IndexedDbIndexManager",em=new Uint8Array(0);class DG{constructor(e,t){this.databaseId=t,this.vn=new Cw,this.Fn=new ca((i=>Il(i)),((i,r)=>Ef(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:Wn(r)};return n2(e).put(s)}return Z.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[Zk(t),""],!1,!0);return n2(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(es(o.parent))}return i}))}addFieldIndex(e,t){const i=Lh(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=Pc(e);return s.next((l=>{o.put(HR(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Lh(e),r=Pc(e),s=bc(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Lh(e),i=bc(e),r=Pc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return Z.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new JR(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=bc(e);let r=!0;const s=new Map;return Z.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),s.set(o,l)})))).next((()=>{if(r){let o=Sn();const l=[];return Z.forEach(s,((u,h)=>{fe(t2,`Using index ${(function(N){return`id=${N.indexId}|cg=${N.collectionGroup}|f=${N.fields.map((R=>`${R.fieldPath}:${R.kind}`)).join(",")}`})(u)} to execute ${Il(t)}`);const f=(function(N,R){const L=tx(R);if(L===void 0)return null;for(const j of fp(N,L.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null})(h,u),m=(function(N,R){const L=new Map;for(const j of Ga(R))for(const k of fp(N,j.fieldPath))switch(k.op){case"==":case"in":L.set(j.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return L.set(j.fieldPath.canonicalString(),k.value),Array.from(L.values())}return null})(h,u),y=(function(N,R){const L=[];let j=!0;for(const k of Ga(R)){const b=k.kind===0?FR(N,k.fieldPath,N.startAt):VR(N,k.fieldPath,N.startAt);L.push(b.value),j&&(j=b.inclusive)}return new Iu(L,j)})(h,u),x=(function(N,R){const L=[];let j=!0;for(const k of Ga(R)){const b=k.kind===0?VR(N,k.fieldPath,N.endAt):FR(N,k.fieldPath,N.endAt);L.push(b.value),j&&(j=b.inclusive)}return new Iu(L,j)})(h,u),T=this.On(u,h,y),I=this.On(u,h,x),S=this.Nn(u,h,m),A=this.Bn(u.indexId,f,T,y.inclusive,I,x.inclusive,S);return Z.forEach(A,(D=>i.Y(D,t.limit).next((N=>{N.forEach((R=>{const L=Ee.fromSegments(R.documentKey);o.has(L)||(o=o.add(L),l.push(L))}))}))))})).next((()=>l))}return Z.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=kG(mt.create(e.filters,"and")).map((i=>ux(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,l){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let m=0;m<u;++m){const y=t?this.Ln(t[m/h]):em,x=this.kn(e,y,i[m%h],r),T=this.qn(e,y,s[m%h],o),I=l.map((S=>this.kn(e,y,S,!0)));f.push(...this.createRange(x,T,I))}return f}kn(e,t,i,r){const s=new Ya(e,Ee.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Ya(e,Ee.empty(),t,i);return r?s.An():s}xn(e,t){const i=new JR(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const l of s)i.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return Z.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new yt(Bt.comparator),f=!1;for(const m of u.filters)for(const y of m.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?f=!0:h=h.add(y.field));for(const m of u.orderBy)m.field.isKeyField()||(h=h.add(m.field));return h.size+(f?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Mh;for(const r of Ga(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);qa.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Mh;return qa.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Mh;return qa.Kt.Dt(vw(this.databaseId,t),i.Pn((function(s){const o=Ga(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Mh);let s=0;for(const o of Ga(e)){const l=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&Kd(l))r=this.Kn(r,o,l);else{const h=u.Pn(o.kind);qa.Kt.Dt(l,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const l of r){const u=new Mh;u.seed(l.un()),qa.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof Ye&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Lh(e),r=Pc(e);return(t?i.J(ix,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return Z.forEach(s,(l=>r.get([l.indexId,this.uid]).next((u=>{o.push((function(f,m){const y=m?new Ud(m.sequenceNumber,new Ai(Rl(m.readTime),new Ee(es(m.documentKey)),m.largestBatchId)):Ud.empty(),x=f.fields.map((([T,I])=>new pm(Bt.fromServerFormat(T),I)));return new rp(f.indexId,f.collectionGroup,x,y)})(l,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:Ke(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Lh(e),s=Pc(e);return this.Gn(e).next((o=>r.J(ix,IDBKeyRange.bound(t,t)).next((l=>Z.forEach(l,(u=>s.put(HR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return Z.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?Z.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(i.set(r.collectionGroup,l),Z.forEach(l,(u=>this.zn(e,r,u).next((h=>{const f=this.jn(s,u);return h.isEqual(f)?Z.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,i,r){return bc(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return bc(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=bc(e);let s=new yt(No);return r.ee({index:aN,range:IDBKeyRange.only([i.indexId,this.uid,Em(this.$n(i,t))])},((o,l)=>{s=s.add(new Ya(i.indexId,t,QR(l.arrayValue),QR(l.directionalValue)))})).next((()=>s))}jn(e,t){let i=new yt(No);const r=this.Qn(t,e);if(r==null)return i;const s=tx(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Kd(o))for(const l of o.arrayValue.values||[])i=i.add(new Ya(t.indexId,e.key,this.Ln(l),r))}else i=i.add(new Ya(t.indexId,e.key,em,r));return i}Jn(e,t,i,r,s){fe(t2,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,f,m,y){const x=u.getIterator(),T=h.getIterator();let I=Rc(x),S=Rc(T);for(;I||S;){let A=!1,D=!1;if(I&&S){const N=f(I,S);N<0?D=!0:N>0&&(A=!0)}else I!=null?D=!0:A=!0;A?(m(S),S=Rc(T)):D?(y(I),I=Rc(x)):(I=Rc(x),S=Rc(T))}})(r,s,No,(l=>{o.push(this.Hn(e,t,i,l))}),(l=>{o.push(this.Yn(e,t,i,l))})),Z.waitFor(o)}Gn(e){let t=1;return Pc(e).ee({index:oN,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,l)=>No(o,l))).filter(((o,l,u)=>!l||No(o,u[l-1])!==0));const r=[];r.push(e);for(const o of i){const l=No(o,e),u=No(o,t);if(l===0)r[0]=e.An();else if(l>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,em,Ee.empty()),u=r[o+1].Vn(this.uid,em,Ee.empty());s.push(IDBKeyRange.bound(l,u))}return s}Zn(e,t){return No(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(i2)}getMinOffset(e,t){return Z.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Ae(44426))))).next(i2)}}function n2(n){return tn(n,Gd)}function bc(n){return tn(n,ad)}function Lh(n){return tn(n,gw)}function Pc(n){return tn(n,od)}function i2(n){De(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;hw(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ai(e.readTime,e.documentKey,t)}const r2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},eD=41943040;class Jn{static withCacheSize(e){return new Jn(e,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function tD(n,e,t){const i=n.store(fr),r=n.store(yu),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.ee({range:o},((f,m,y)=>(l++,y.delete())));s.push(u.next((()=>{De(l===1,47070,{batchId:t.batchId})})));const h=[];for(const f of t.mutations){const m=iN(e,f.key.path,t.batchId);s.push(r.delete(m)),h.push(f.key)}return Z.waitFor(s).next((()=>h))}function _p(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ae(14731);e=n.noDocument}return JSON.stringify(e).length}Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn(eD,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);class my{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){De(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new my(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).ee({index:il,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=jc(e),o=Do(e);return o.add({}).next((l=>{De(typeof l=="number",49019);const u=new Ew(l,t,i,r),h=(function(x,T,I){const S=I.baseMutations.map((D=>mp(x.yt,D))),A=I.mutations.map((D=>mp(x.yt,D)));return{userId:T,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:S,mutations:A}})(this.serializer,this.userId,u),f=[];let m=new yt(((y,x)=>Ke(y.canonicalString(),x.canonicalString())));for(const y of r){const x=iN(this.userId,y.key.path,l);m=m.add(y.key.path.popLast()),f.push(o.put(h)),f.push(s.put(x,tW))}return m.forEach((y=>{f.push(this.indexManager.addToCollectionParentIndex(e,y))})),e.addOnCommittedListener((()=>{this.Xn[l]=u.keys()})),Z.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return Do(e).get(t).next((i=>i?(De(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Xa(this.serializer,i)):null))}er(e,t){return this.Xn[t]?Z.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Do(e).ee({index:il,range:r},((o,l,u)=>{l.userId===this.userId&&(De(l.batchId>=i,47524,{tr:i}),s=Xa(this.serializer,l)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ul;return Do(e).ee({index:il,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ul],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).J(il,t).next((i=>i.map((r=>Xa(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=ym(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return jc(e).ee({range:r},((o,l,u)=>{const[h,f,m]=o,y=es(f);if(h===this.userId&&t.path.isEqual(y))return Do(e).get(m).next((x=>{if(!x)throw Ae(61480,{nr:o,batchId:m});De(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:m}),s.push(Xa(this.serializer,x))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(Ke);const r=[];return t.forEach((s=>{const o=ym(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=jc(e).ee({range:l},((h,f,m)=>{const[y,x,T]=h,I=es(x);y===this.userId&&s.path.isEqual(I)?i=i.add(T):m.done()}));r.push(u)})),Z.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=ym(this.userId,i),o=IDBKeyRange.lowerBound(s);let l=new yt(Ke);return jc(e).ee({range:o},((u,h,f)=>{const[m,y,x]=u,T=es(y);m===this.userId&&i.isPrefixOf(T)?T.length===r&&(l=l.add(x)):f.done()})).next((()=>this.rr(e,l)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(Do(e).get(s).next((o=>{if(o===null)throw Ae(35274,{batchId:s});De(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Xa(this.serializer,o))})))})),Z.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return tD(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),Z.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Z.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return jc(e).ee({range:i},((s,o,l)=>{if(s[0]===this.userId){const u=es(s[1]);r.push(u)}else l.done()})).next((()=>{De(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return nD(e,this.userId,t)}_r(e){return iD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:ul,lastStreamToken:""}))}}function nD(n,e,t){const i=ym(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return jc(n).ee({range:s,X:!0},((l,u,h)=>{const[f,m,y]=l;f===e&&m===r&&(o=!0),h.done()})).next((()=>o))}function Do(n){return tn(n,fr)}function jc(n){return tn(n,yu)}function iD(n){return tn(n,Bd)}class Al{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Al(0)}static cr(){return new Al(-1)}}class MG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Al(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Qe.fromTimestamp(new kt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>kc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(De(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return kc(e).ee(((o,l)=>{const u=qh(l);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>Z.waitFor(s))).next((()=>r))}forEachTarget(e,t){return kc(e).ee(((i,r)=>{const s=qh(r);t(s)}))}lr(e){return s2(e).get(lp).next((t=>(De(t!==null,2888),t)))}hr(e,t){return s2(e).put(lp,t)}Pr(e,t){return kc(e).put(YN(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Il(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return kc(e).ee({range:r,index:sN},((o,l,u)=>{const h=qh(l);Ef(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=Wo(e);return t.forEach((o=>{const l=Wn(o.path);r.push(s.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,o))})),Z.waitFor(r)}removeMatchingKeys(e,t,i){const r=Wo(e);return Z.forEach(t,(s=>{const o=Wn(s.path);return Z.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=Wo(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Wo(e);let s=Sn();return r.ee({range:i,X:!0},((o,l,u)=>{const h=es(o[1]),f=new Ee(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){const i=Wn(t.path),r=IDBKeyRange.bound([i],[Zk(i)],!1,!0);let s=0;return Wo(e).ee({index:fw,X:!0,range:r},(([o,l],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return kc(e).get(t).next((i=>i?qh(i):null))}}function kc(n){return tn(n,_u)}function s2(n){return tn(n,hl)}function Wo(n){return tn(n,vu)}const o2="LruGarbageCollector",LG=1048576;function a2([n,e],[t,i]){const r=Ke(n,t);return r===0?Ke(e,i):r}class OG{constructor(e){this.Ir=e,this.buffer=new yt(a2),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();a2(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class FG{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){fe(o2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ol(t)?fe(o2,"Ignoring IndexedDB error during garbage collection: ",t):await iy(t)}await this.Vr(3e5)}))}}class VG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Z.resolve(vr.ce);const i=new OG(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(r2)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),r2):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,o=Date.now(),this.nthSequenceNumber(e,r)))).next((m=>(i=m,l=Date.now(),this.removeTargets(e,i,t)))).next((m=>(s=m,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((m=>(h=Date.now(),Oc()<=He.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${m} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:m}))))}}function jG(n,e){return new VG(n,e)}class zG{constructor(e,t){this.db=e,this.garbageCollector=jG(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return tm(e,i)}removeReference(e,t,i){return tm(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return tm(e,t)}br(e,t){return(function(r,s){let o=!1;return iD(r).te((l=>nD(r,l,s).next((u=>(u&&(o=!0),Z.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,l)=>{if(l<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Qe.min()),Wo(e).delete((function(m){return[0,Wn(m.path)]})(o)))))}));r.push(u)}})).next((()=>Z.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return tm(e,t)}Sr(e,t){const i=Wo(e);let r,s=vr.ce;return i.ee({index:fw},(([o,l],{path:u,sequenceNumber:h})=>{o===0?(s!==vr.ce&&t(new Ee(es(r)),s),s=h,r=u):s=vr.ce})).next((()=>{s!==vr.ce&&t(new Ee(es(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function tm(n,e){return Wo(n).put((function(i,r){return{targetId:0,path:Wn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class rD{constructor(){this.changes=new ca((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Z.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class UG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Va(e).put(i)}removeEntry(e,t,i){return Va(e).delete((function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],pp(o),l[l.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Tn.newInvalidDocument(t);return Va(e).ee({index:_m,range:IDBKeyRange.only(Oh(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Tn.newInvalidDocument(t)};return Va(e).ee({index:_m,range:IDBKeyRange.only(Oh(t))},((r,s)=>{i={document:this.Cr(t,s),size:_p(s)}})).next((()=>i))}getEntries(e,t){let i=rl();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=rl(),r=new ui(Ee.comparator);return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l),r=r.insert(s,_p(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return Z.resolve();let r=new yt(u2);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Oh(r.first()),Oh(r.last())),o=r.getIterator();let l=o.getNext();return Va(e).ee({index:_m,range:s},((u,h,f)=>{const m=Ee.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&u2(l,m)<0;)i(l,null),l=o.getNext();l&&l.isEqual(m)&&(i(l,h),l=o.hasNext()?o.getNext():null),l?f.j(Oh(l)):f.done()})).next((()=>{for(;l;)i(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),pp(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Va(e).J(IDBKeyRange.bound(l,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=rl();for(const m of h){const y=this.Cr(Ee.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);y.isFoundDocument()&&(hy(t,y)||r.has(y.key))&&(f=f.insert(y.key,y))}return f}))}getAllFromCollectionGroup(e,t,i,r){let s=rl();const o=c2(t,i),l=c2(t,Ai.max());return Va(e).ee({index:rN,range:IDBKeyRange.bound(o,l,!0)},((u,h,f)=>{const m=this.Cr(Ee.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(m.key,m),s.size===r&&f.done()})).next((()=>s))}newChangeBuffer(e){return new BG(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return l2(e).get(nx).next((t=>(De(!!t,20021),t)))}Dr(e,t){return l2(e).put(nx,t)}Cr(e,t){if(t){const i=SG(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Qe.min())))return i}return Tn.newInvalidDocument(e)}}function sD(n){return new UG(n)}class BG extends rD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ca((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new yt(((s,o)=>Ke(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const l=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=$R(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=_p(u);i+=h-l.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=l.size,this.trackRemovals){const u=$R(this.Nr.serializer,o.convertToNoDocument(Qe.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),Z.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function l2(n){return tn(n,Wd)}function Va(n){return tn(n,ap)}function Oh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function c2(n,e){const t=e.documentKey.path.toArray();return[n,pp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function u2(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=Ke(t[s],i[s]),r)return r;return r=Ke(t.length,i.length),r||(r=Ke(t[t.length-2],i[i.length-2]),r||Ke(t[t.length-1],i[i.length-1]))}class WG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class oD{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&hd(i.mutation,r,js.empty(),kt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Sn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Sn()){const r=ts();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=Jg();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=ts();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Sn())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,i,r){let s=rl();const o=ud(),l=(function(){return ud()})();return t.forEach(((u,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Ou)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),hd(f.mutation,h,f.mutation.getFieldMask(),kt.now())):o.set(h.key,js.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>l.set(h,new WG(f,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const i=ud();let r=new ui(((o,l)=>o-l)),s=Sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=i.get(u)||js.empty();f=l.applyToLocalView(h,f),i.set(u,f);const m=(r.get(l.batchId)||Sn()).add(u);r=r.insert(l.batchId,m)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,m=MN();f.forEach((y=>{if(!s.has(y)){const x=VN(t.get(y),i.get(y));x!==null&&m.set(y,x),s=s.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return Z.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):UW(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Z.resolve(ts());let l=zd,u=s;return o.next((h=>Z.forEach(h,((f,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(f)?Z.resolve():this.remoteDocumentCache.getEntry(e,f).next((y=>{u=u.insert(f,y)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Sn()))).next((f=>({batchId:l,changes:KW(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next((i=>{let r=Jg();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Jg();return this.indexManager.getCollectionParents(e,s).next((l=>Z.forEach(l,(u=>{const h=(function(m,y){return new uy(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((f=>{f.forEach(((m,y)=>{o=o.insert(m,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Tn.newInvalidDocument(f)))}));let l=Jg();return o.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&hd(f.mutation,h,js.empty(),kt.now()),hy(t,h)&&(l=l.insert(u,h))})),l}))}}class GG{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Z.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Sr(r.createTime)}})(t)),Z.resolve()}getNamedQuery(e,t){return Z.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:ZN(r.bundledQuery),readTime:Sr(r.readTime)}})(t)),Z.resolve()}}class $G{constructor(){this.overlays=new ui(Ee.comparator),this.qr=new Map}getOverlay(e,t){return Z.resolve(this.overlays.get(t))}getOverlays(e,t){const i=ts();return Z.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),Z.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),Z.resolve()}getOverlaysForCollection(e,t,i){const r=ts(),s=t.length+1,o=new Ee(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return Z.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new ui(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=ts(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=ts(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>l.set(h,f))),!(l.size()>=r)););return Z.resolve(l)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Sw(t,i));let s=this.qr.get(t);s===void 0&&(s=Sn(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class KG{constructor(){this.sessionToken=hi.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Z.resolve()}}class Rw{constructor(){this.Qr=new yt(cn.$r),this.Ur=new yt(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new cn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new cn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ee(new Rt([])),i=new cn(t,e),r=new cn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ee(new Rt([])),i=new cn(t,e),r=new cn(t,e+1);let s=Sn();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new cn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class cn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ee.comparator(e.key,t.key)||Ke(e.Yr,t.Yr)}static Kr(e,t){return Ke(e.Yr,t.Yr)||Ee.comparator(e.key,t.key)}}class HG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new yt(cn.$r)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ew(s,t,i,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new cn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Z.resolve(o)}lookupMutationBatch(e,t){return Z.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?ul:this.tr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new cn(t,0),r=new cn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const l=this.Xr(o.Yr);s.push(l)})),Z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new yt(Ke);return t.forEach((r=>{const s=new cn(r,0),o=new cn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(l=>{i=i.add(l.Yr)}))})),Z.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Ee.isDocumentKey(s)||(s=s.child(""));const o=new cn(new Ee(s),0);let l=new yt(Ke);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(u.Yr)),!0)}),o),Z.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){De(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Z.forEach(t.mutations,(r=>{const s=new cn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new cn(t,0),r=this.Zr.firstAfterOrEqual(i);return Z.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class XG{constructor(e){this.ri=e,this.docs=(function(){return new ui(Ee.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Z.resolve(i?i.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let i=rl();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Tn.newInvalidDocument(r))})),Z.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=rl();const o=t.path,l=new Ee(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||hw(Jk(f),i)<=0||(r.has(f.key)||hy(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Z.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Ae(9500)}ii(e,t){return Z.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new qG(this)}getSize(e){return Z.resolve(this.size)}}class qG extends rD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),Z.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class YG{constructor(e){this.persistence=e,this.si=new ca((t=>Il(t)),Ef),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.oi=0,this._i=new Rw,this.targetCount=0,this.ai=Al.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Z.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Al(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Z.resolve()}updateTargetData(e,t){return this.Pr(t),Z.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),Z.waitFor(s).next((()=>r))}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Z.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Z.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Z.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Z.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Z.resolve(i)}containsKey(e,t){return Z.resolve(this._i.containsKey(t))}}class aD{constructor(e,t){this.ui={},this.overlays={},this.ci=new vr(0),this.li=!1,this.li=!0,this.hi=new KG,this.referenceDelegate=e(this),this.Pi=new YG(this),this.indexManager=new NG,this.remoteDocumentCache=(function(r){return new XG(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new qN(t),this.Ii=new GG(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new $G,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new HG(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe("MemoryPersistence","Starting transaction:",e);const r=new ZG(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return Z.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class ZG extends tN{constructor(e){super(),this.currentSequenceNumber=e}}class py{constructor(e){this.persistence=e,this.Ri=new Rw,this.Vi=null}static mi(e){return new py(e)}get fi(){if(this.Vi)return this.Vi;throw Ae(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Z.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Z.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Z.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.fi,(i=>{const r=Ee.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Qe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Z.or([()=>Z.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class QG{constructor(e){this.serializer=e}k(e,t,i,r){const s=new ry("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(wf)})(e),(function(u){u.createObjectStore(Bd,{keyPath:eW}),u.createObjectStore(fr,{keyPath:IR,autoIncrement:!0}).createIndex(il,CR,{unique:!0}),u.createObjectStore(yu)})(e),h2(e),(function(u){u.createObjectStore($a)})(e));let o=Z.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(vu),u.deleteObjectStore(_u),u.deleteObjectStore(hl)})(e),h2(e)),o=o.next((()=>(function(u){const h=u.store(hl),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Qe.min().toTimestamp(),targetCount:0};return h.put(lp,f)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(fr).J().next((m=>{u.deleteObjectStore(fr),u.createObjectStore(fr,{keyPath:IR,autoIncrement:!0}).createIndex(il,CR,{unique:!0});const y=h.store(fr),x=m.map((T=>y.put(T)));return Z.waitFor(x)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(xu,{keyPath:cW})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Wd)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(oy,{keyPath:uW})})(e),(function(u){u.createObjectStore(ay,{keyPath:hW})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore(ly,{keyPath:_W});h.createIndex(rx,vW,{unique:!1}),h.createIndex(lN,xW,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(ap,{keyPath:nW});h.createIndex(_m,iW),h.createIndex(rN,rW)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore($a)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(gw,{keyPath:dW,autoIncrement:!0}).createIndex(ix,fW,{unique:!1}),u.createObjectStore(od,{keyPath:gW}).createIndex(oN,mW,{unique:!1}),u.createObjectStore(ad,{keyPath:pW}).createIndex(aN,yW,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(od).clear()})).next((()=>{t.objectStore(ad).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(mw,{keyPath:wW})})(e)}))),i<18&&r>=18&&ok()&&(o=o.next((()=>{t.objectStore(od).clear()})).next((()=>{t.objectStore(ad).clear()}))),o}wi(e){let t=0;return e.store($a).ee(((i,r)=>{t+=_p(r)})).next((()=>{const i={byteSize:t};return e.store(Wd).put(nx,i)}))}yi(e){const t=e.store(Bd),i=e.store(fr);return t.J().next((r=>Z.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,ul],[s.userId,s.lastAcknowledgedBatchId]);return i.J(il,o).next((l=>Z.forEach(l,(u=>{De(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=Xa(this.serializer,u);return tD(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(vu),i=e.store($a);return e.store(hl).get(lp).next((r=>{const s=[];return i.ee(((o,l)=>{const u=new Rt(o),h=(function(m){return[0,Wn(m)]})(u);s.push(t.get(h).next((f=>f?Z.resolve():(m=>t.put({targetId:0,path:Wn(m),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>Z.waitFor(s)))}))}bi(e,t){e.createObjectStore(Gd,{keyPath:lW});const i=t.store(Gd),r=new Cw,s=o=>{if(r.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:Wn(u)})}};return t.store($a).ee({X:!0},((o,l)=>{const u=new Rt(o);return s(u.popLast())})).next((()=>t.store(yu).ee({X:!0},(([o,l,u],h)=>{const f=es(l);return s(f.popLast())}))))}Di(e){const t=e.store(_u);return t.ee(((i,r)=>{const s=qh(r),o=YN(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store($a),r=[];return i.ee(((s,o)=>{const l=t.store(ap),u=(function(m){return m.document?new Ee(Rt.fromString(m.document.name).popFirst(5)):m.noDocument?Ee.fromSegments(m.noDocument.path):m.unknownDocument?Ee.fromSegments(m.unknownDocument.path):Ae(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))})).next((()=>Z.waitFor(r)))}Fi(e,t){const i=t.store(fr),r=sD(this.serializer),s=new aD(py.mi,this.serializer.yt);return i.J().next((o=>{const l=new Map;return o.forEach((u=>{let h=l.get(u.userId)??Sn();Xa(this.serializer,u).keys().forEach((f=>h=h.add(f))),l.set(u.userId,h)})),Z.forEach(l,((u,h)=>{const f=new wn(h),m=gy.wt(this.serializer,f),y=s.getIndexManager(f),x=my.wt(f,this.serializer,y,s.referenceDelegate);return new oD(r,x,m,y).recalculateAndSaveOverlaysForDocumentKeys(new sx(t,vr.ce),u).next()}))}))}}function h2(n){n.createObjectStore(vu,{keyPath:oW}).createIndex(fw,aW,{unique:!0}),n.createObjectStore(_u,{keyPath:"targetId"}).createIndex(sN,sW,{unique:!0}),n.createObjectStore(hl)}const Mo="IndexedDbPersistence",Z0=18e5,Q0=5e3,J0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",JG="main";class Aw{constructor(e,t,i,r,s,o,l,u,h,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=l,this.xi=h,this.Oi=f,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=y=>Promise.resolve(),!Aw.v())throw new Se(ae.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new zG(this,r),this.$i=t+JG,this.serializer=new qN(u),this.Ui=new Jo(this.$i,this.Ni,new QG(this.serializer)),this.hi=new CG,this.Pi=new MG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=sD(this.serializer),this.Ii=new IG,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&Ti(Mo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Se(ae.FAILED_PRECONDITION,J0);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new vr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>nm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ol(e))return fe(Mo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe(Mo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Fh(e).get(Cc).next((t=>Z.resolve(this.es(t))))}ts(e){return nm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Z0)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=tn(t,xu);return i.J().next((r=>{const s=this.ss(r,Z0),o=r.filter((l=>s.indexOf(l)===-1));return Z.forEach(o,(l=>i.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Z.resolve(!0):Fh(e).get(Cc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Q0)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Se(ae.FAILED_PRECONDITION,J0);return!1}}return!(!this.networkEnabled||!this.inForeground)||nm(e).J().next((i=>this.ss(i,Q0).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&fe(Mo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[wf,xu],(e=>{const t=new sx(e,vr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>nm(e).J().next((t=>this.ss(t,Z0).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return my.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new DG(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return gy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){fe(Mo,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?SW:u===17?dN:u===16?TW:u===15?pw:u===14?hN:u===13?uN:u===12?EW:u===11?cN:void Ae(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(l=>(o=new sx(l,this.ci?this.ci.next():vr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Ti(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Se(ae.FAILED_PRECONDITION,eN);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return Fh(e).get(Cc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Q0)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Se(ae.FAILED_PRECONDITION,J0)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Fh(e).put(Cc,t)}static v(){return Jo.v()}Zi(e){const t=Fh(e);return t.get(Cc).next((i=>this.es(i)?(fe(Mo,"Releasing primary lease."),t.delete(Cc)):Z.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Ti(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;sk()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return fe(Mo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ti(Mo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ti("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Fh(n){return tn(n,wf)}function nm(n){return tn(n,xu)}function e7(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class bw{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Sn(),r=Sn();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new bw(e,t.fromCache,i,r)}}class t7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class lD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return sk()?8:nN(en())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new t7;return this.Ss(e,t,o).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Oc()<=He.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",Nh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Z.resolve()):(Oc()<=He.DEBUG&&fe("QueryEngine","Query:",Nh(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Oc()<=He.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",Nh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$s(t))):Z.resolve())}ys(e,t){if(jR(t))return Z.resolve(null);let i=$s(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=hx(t,null,"F"),i=$s(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Sn(...s);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,l);return this.Cs(t,h,o,u.readTime)?this.ys(e,hx(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return jR(t)||r.isEqual(Qe.min())?Z.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Z.resolve(null):(Oc()<=He.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Nh(t)),this.vs(e,o,t,X8(r,zd)).next((l=>l)))}))}Ds(e,t){let i=new yt(WW(e));return t.forEach(((r,s)=>{hy(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Oc()<=He.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",Nh(t)),this.ps.getDocumentsMatchingQuery(e,t,Ai.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const n7="LocalStore";class i7{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new ui(Ke),this.xs=new ca((s=>Il(s)),Ef),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function cD(n,e,t,i){return new i7(n,e,t,i)}async function r7(n,e){const t=St(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],l=[];let u=Sn();for(const h of r){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function s7(n,e){const t=St(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,f){const m=h.batch,y=m.keys();let x=Z.resolve();return y.forEach((T=>{x=x.next((()=>f.getEntry(u,T))).next((I=>{const S=h.docVersions.get(T);De(S!==null,48541),I.version.compareTo(S)<0&&(m.applyToRemoteDocument(I,h),I.isValidDocument()&&(I.setReadTime(h.commitVersion),f.addEntry(I)))}))})),x.next((()=>l.mutationQueue.removeMutationBatch(u,m)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(l){let u=Sn();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function o7(n){const e=St(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function a7(n,e){const t=St(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ul),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}class d2{constructor(){this.activeTargetIds=YW()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class uD{constructor(){this.Mo=new d2,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new d2,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class l7{Oo(e){}shutdown(){}}const f2="ConnectivityMonitor";class g2{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){fe(f2,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){fe(f2,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let im=null;function _x(){return im===null?im=(function(){return 268435456+Math.round(2147483648*Math.random())})():im++,"0x"+im.toString(16)}const ev="RestConnection",c7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class u7{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===up?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=_x(),l=this.zo(e,t.toUriEncodedString());fe(ev,`Sending RPC '${e}' ${o}:`,l,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(l),f=Ml(h);return this.Jo(e,l,u,i,f).then((m=>(fe(ev,`Received RPC '${e}' ${o}: `,m),m)),(m=>{throw ny(ev,`RPC '${e}' ${o} failed with error: `,m,"url: ",l,"request:",i),m}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Lu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=c7[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class h7{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const kn="WebChannelConnection";class d7 extends u7{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=_x();return new Promise(((l,u)=>{const h=new Wk;h.setWithCredentials(!0),h.listenOnce(Gk.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case mm.NO_ERROR:const m=h.getResponseJson();fe(kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),l(m);break;case mm.TIMEOUT:fe(kn,`RPC '${e}' ${o} timed out`),u(new Se(ae.DEADLINE_EXCEEDED,"Request time out"));break;case mm.HTTP_ERROR:const y=h.getStatus();if(fe(kn,`RPC '${e}' ${o} failed with status:`,y,"response text:",h.getResponseText()),y>0){let x=h.getResponseJson();Array.isArray(x)&&(x=x[0]);const T=x?.error;if(T&&T.status&&T.message){const I=(function(A){const D=A.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(D)>=0?D:ae.UNKNOWN})(T.status);u(new Se(I,T.message))}else u(new Se(ae.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Se(ae.UNAVAILABLE,"Connection failed."));break;default:Ae(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{fe(kn,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);fe(kn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)}))}T_(e,t,i){const r=_x(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Hk(),l=Kk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const f=s.join("");fe(kn,`Creating RPC '${e}' stream ${r}: ${f}`,u);const m=o.createWebChannel(f,u);this.I_(m);let y=!1,x=!1;const T=new h7({Yo:S=>{x?fe(kn,`Not sending because RPC '${e}' stream ${r} is closed:`,S):(y||(fe(kn,`Opening RPC '${e}' stream ${r} transport.`),m.open(),y=!0),fe(kn,`RPC '${e}' stream ${r} sending:`,S),m.send(S))},Zo:()=>m.close()}),I=(S,A,D)=>{S.listen(A,(N=>{try{D(N)}catch(R){setTimeout((()=>{throw R}),0)}}))};return I(m,Xh.EventType.OPEN,(()=>{x||(fe(kn,`RPC '${e}' stream ${r} transport opened.`),T.o_())})),I(m,Xh.EventType.CLOSE,(()=>{x||(x=!0,fe(kn,`RPC '${e}' stream ${r} transport closed`),T.a_(),this.E_(m))})),I(m,Xh.EventType.ERROR,(S=>{x||(x=!0,ny(kn,`RPC '${e}' stream ${r} transport errored. Name:`,S.name,"Message:",S.message),T.a_(new Se(ae.UNAVAILABLE,"The operation could not be completed")))})),I(m,Xh.EventType.MESSAGE,(S=>{if(!x){const A=S.data[0];De(!!A,16349);const D=A,N=D?.error||D[0]?.error;if(N){fe(kn,`RPC '${e}' stream ${r} received error:`,N);const R=N.status;let L=(function(b){const M=Kt[b];if(M!==void 0)return aG(M)})(R),j=N.message;L===void 0&&(L=ae.INTERNAL,j="Unknown error status: "+R+" with message "+N.message),x=!0,T.a_(new Se(L,j)),m.close()}else fe(kn,`RPC '${e}' stream ${r} received:`,A),T.u_(A)}})),I(l,$k.STAT_EVENT,(S=>{S.stat===Jv.PROXY?fe(kn,`RPC '${e}' stream ${r} detected buffering proxy`):S.stat===Jv.NOPROXY&&fe(kn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{T.__()}),0),T}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function f7(){return typeof window<"u"?window:null}function Tm(){return typeof document<"u"?document:null}function hD(n){return new hG(n,!0)}class dD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&fe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const m2="PersistentStream";class g7{constructor(e,t,i,r,s,o,l,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new dD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ae.RESOURCE_EXHAUSTED?(Ti(t.toString()),Ti("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Se(ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return fe(m2,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(fe(m2,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class m7 extends g7{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return De(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,De(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){De(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=pG(e.writeResults,e.commitTime),i=Sr(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=gG(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>mp(this.serializer,i)))};this.q_(t)}}class p7{}class y7 extends p7{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Se(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,fx(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Se(ae.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,fx(t,i),r,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Se(ae.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class _7{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ti(t),this.aa=!1):fe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const yy="RemoteStore";class v7{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{vy(this)&&(fe(yy,"Restarting streams for network reachability change."),await(async function(u){const h=St(u);h.Ea.add(4),await _y(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Pw(h)})(this))}))})),this.Ra=new _7(i,r)}}async function Pw(n){if(vy(n))for(const e of n.da)await e(!0)}async function _y(n){for(const e of n.da)await e(!1)}function vy(n){return St(n).Ea.size===0}async function fD(n,e,t){if(!Ol(e))throw e;n.Ea.add(1),await _y(n),n.Ra.set("Offline"),t||(t=()=>o7(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{fe(yy,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Pw(n)}))}function gD(n,e){return e().catch((t=>fD(n,t,e)))}async function xy(n){const e=St(n),t=oa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ul;for(;x7(e);)try{const r=await a7(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,w7(e,r)}catch(r){await fD(e,r)}mD(e)&&pD(e)}function x7(n){return vy(n)&&n.Ta.length<10}function w7(n,e){n.Ta.push(e);const t=oa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function mD(n){return vy(n)&&!oa(n).x_()&&n.Ta.length>0}function pD(n){oa(n).start()}async function E7(n){oa(n).ra()}async function T7(n){const e=oa(n);for(const t of n.Ta)e.ea(t.mutations)}async function S7(n,e,t){const i=n.Ta.shift(),r=Tw.from(i,e,t);await gD(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await xy(n)}async function I7(n,e){e&&oa(n).X_&&await(async function(i,r){if((function(o){return oG(o)&&o!==ae.ABORTED})(r.code)){const s=i.Ta.shift();oa(i).B_(),await gD(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await xy(i)}})(n,e),mD(n)&&pD(n)}async function C7(n,e){const t=St(n);e?(t.Ea.delete(2),await Pw(t)):e||(t.Ea.add(2),await _y(t),t.Ra.set("Unknown"))}function oa(n){return n.fa||(n.fa=(function(t,i,r){const s=St(t);return s.sa(),new m7(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:E7.bind(null,n),r_:I7.bind(null,n),ta:T7.bind(null,n),na:S7.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await xy(n)):(await n.fa.stop(),n.Ta.length>0&&(fe(yy,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class kw{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new cl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,l=new kw(e,t,o,r,s);return l.start(i),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function R7(n,e){if(Ti("AsyncQueue",`${e}: ${n}`),Ol(n))return new Se(ae.UNAVAILABLE,`${e}: ${n}`);throw n}class A7{constructor(){this.queries=p2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=St(t),s=r.queries;r.queries=p2(),s.forEach(((o,l)=>{for(const u of l.Sa)u.onError(i)}))})(this,new Se(ae.ABORTED,"Firestore shutting down"))}}function p2(){return new ca((n=>NN(n)),kN)}function b7(n){n.Ca.forEach((e=>{e.next()}))}var y2,_2;(_2=y2||(y2={})).Ma="default",_2.Cache="cache";const P7="SyncEngine";class k7{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ca((l=>NN(l)),kN),this.Iu=new Map,this.Eu=new Set,this.du=new ui(Ee.comparator),this.Au=new Map,this.Ru=new Rw,this.Vu={},this.mu=new Map,this.fu=Al.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function v2(n,e,t){const i=St(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const u=St(o);u.onlineState=l;let h=!1;u.queries.forEach(((f,m)=>{for(const y of m.Sa)y.va(l)&&(h=!0)})),h&&b7(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function N7(n,e){const t=St(n),i=e.batch.batchId;try{const r=await s7(t.localStore,e);_D(t,i,null),yD(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Nw(t,r)}catch(r){await iy(r)}}async function D7(n,e,t){const i=St(n);try{const r=await(function(o,l){const u=St(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next((m=>(De(m!==null,37113),f=m.keys(),u.mutationQueue.removeMutationBatch(h,m)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(i.localStore,e);_D(i,e,t),yD(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Nw(i,r)}catch(r){await iy(r)}}function yD(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function _D(n,e,t){const i=St(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}async function Nw(n,e,t){const i=St(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((l,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){r.push(h);const f=bw.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const f=St(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>Z.forEach(h,(y=>Z.forEach(y.Es,(x=>f.persistence.referenceDelegate.addReference(m,y.targetId,x))).next((()=>Z.forEach(y.ds,(x=>f.persistence.referenceDelegate.removeReference(m,y.targetId,x)))))))))}catch(m){if(!Ol(m))throw m;fe(n7,"Failed to update sequence numbers: "+m)}for(const m of h){const y=m.targetId;if(!m.fromCache){const x=f.Ms.get(y),T=x.snapshotVersion,I=x.withLastLimboFreeSnapshotVersion(T);f.Ms=f.Ms.insert(y,I)}}})(i.localStore,s))}async function M7(n,e){const t=St(n);if(!t.currentUser.isEqual(e)){fe(P7,"User change. New user:",e.toKey());const i=await r7(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new Se(ae.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Nw(t,i.Ls)}}function L7(n){const e=St(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=N7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=D7.bind(null,e),e}class vx{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hD(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return cD(this.persistence,new lD,e.initialUser,this.serializer)}Cu(e){return new aD(py.mi,this.serializer)}Du(e){return new uD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vx.provider={build:()=>new vx};class O7 extends vx{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await L7(this.xu.syncEngine),await xy(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return cD(this.persistence,new lD,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new FG(i,e.asyncQueue,t)}Mu(e,t){const i=new Q8(t,this.persistence);return new Z8(e.asyncQueue,i)}Cu(e){const t=e7(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new Aw(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,f7(),Tm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new uD}}class xx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>v2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=M7.bind(null,this.syncEngine),await C7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new A7})()}createDatastore(e){const t=hD(e.databaseInfo.databaseId),i=(function(s){return new d7(s)})(e.databaseInfo);return(function(s,o,l,u){return new y7(s,o,l,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,l){return new v7(i,r,s,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>v2(this.syncEngine,t,0)),(function(){return g2.v()?new g2:new l7})())}createSyncEngine(e,t){return(function(r,s,o,l,u,h,f){const m=new k7(r,s,o,l,u,h);return f&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=St(t);fe(yy,"RemoteStore shutting down."),i.Ea.add(5),await _y(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}xx.provider={build:()=>new xx};const x2="FirestoreClient";class F7{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=wn.UNAUTHENTICATED,this.clientId=Yk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{fe(x2,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(fe(x2,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=R7(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}function vD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const w2=new Map;const xD="firestore.googleapis.com",E2=!0;class T2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Se(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=xD,this.ssl=E2}else this.host=e.host,this.ssl=e.ssl??E2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=eD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<LG)throw new Se(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vD(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wD{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new T2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new T2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new L8;switch(i.type){case"firstParty":return new j8(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Se(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=w2.get(t);i&&(fe("ComponentProvider","Removing Datastore"),w2.delete(t),i.terminate())})(this),Promise.resolve()}}function V7(n,e,t,i={}){n=Qk(n,wD);const r=Ml(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${e}:${t}`;r&&(X1(`https://${l}`),q1("Firestore",!0)),s.host!==xD&&s.host!==l&&ny("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:r,emulatorOptions:i};if(!wl(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,f;if(typeof i.mockUserToken=="string")h=i.mockUserToken,f=wn.MOCK_USER;else{h=ik(i.mockUserToken,n._app?.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new Se(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new wn(m)}n._authCredentials=new O8(new qk(h,f))}}class Dw{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Dw(this.firestore,e,this._query)}}class ns{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mw(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ns(this.firestore,e,this._key)}toJSON(){return{type:ns._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(xf(t,ns._jsonSchema))return new ns(e,i||null,new Ee(Rt.fromString(t.referencePath)))}}ns._jsonSchemaVersion="firestore/documentReference/1.0",ns._jsonSchema={type:Xt("string",ns._jsonSchemaVersion),referencePath:Xt("string")};class Mw extends Dw{constructor(e,t,i){super(e,t,PN(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ns(this.firestore,null,new Ee(e))}withConverter(e){return new Mw(this.firestore,e,this._path)}}const S2="AsyncQueue";class I2{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new dD(this,"async_queue_retry"),this._c=()=>{const i=Tm();i&&fe(S2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Tm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Tm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new cl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ol(e))throw e;fe(S2,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ti("INTERNAL UNHANDLED ERROR: ",C2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=kw.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Ae(47125,{Pc:C2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function C2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class ED extends wD{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new I2,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new I2(e),this._firestoreClient=void 0,await e}}}function j7(n,e){const t=typeof n=="object"?n:Q1(),i=typeof n=="string"?n:up,r=Qp(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=ek("firestore");s&&V7(r,...s)}return r}function z7(n){const e=n._freezeSettings(),t=(function(r,s,o,l){return new AW(r,s,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,vD(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new F7(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function U7(n,e){ny("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return B7(n,xx.provider,{build:i=>new O7(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function B7(n,e,t){if((n=Qk(n,ED))._firestoreClient||n._terminated)throw new Se(ae.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Se(ae.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},z7(n)}class Os{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Os(hi.fromBase64String(e))}catch(t){throw new Se(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Os(hi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Os._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xf(e,Os._jsonSchema))return Os.fromBase64String(e.bytes)}}Os._jsonSchemaVersion="firestore/bytes/1.0",Os._jsonSchema={type:Xt("string",Os._jsonSchemaVersion),bytes:Xt("string")};class TD{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Se(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class dl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Se(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Se(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ke(this._lat,e._lat)||Ke(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:dl._jsonSchemaVersion}}static fromJSON(e){if(xf(e,dl._jsonSchema))return new dl(e.latitude,e.longitude)}}dl._jsonSchemaVersion="firestore/geoPoint/1.0",dl._jsonSchema={type:Xt("string",dl._jsonSchemaVersion),latitude:Xt("number"),longitude:Xt("number")};class fl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:fl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xf(e,fl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new fl(e.vectorValues);throw new Se(ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fl._jsonSchemaVersion="firestore/vectorValue/1.0",fl._jsonSchema={type:Xt("string",fl._jsonSchemaVersion),vectorValues:Xt("object")};const W7=new RegExp("[~\\*/\\[\\]]");function G7(n,e,t){if(e.search(W7)>=0)throw R2(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new TD(...e.split("."))._internalPath}catch{throw R2(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function R2(n,e,t,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new Se(ae.INVALID_ARGUMENT,s+n+o)}class SD{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ns(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new $7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ID("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class $7 extends SD{data(){return super.data()}}function ID(n,e){return typeof e=="string"?G7(n,e):e instanceof TD?e._internalPath:e._delegate._internalPath}class rm{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class tu extends SD{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Sm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(ID("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=tu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}tu._jsonSchemaVersion="firestore/documentSnapshot/1.0",tu._jsonSchema={type:Xt("string",tu._jsonSchemaVersion),bundleSource:Xt("string","DocumentSnapshot"),bundleName:Xt("string"),bundle:Xt("string")};class Sm extends tu{data(e={}){return super.data(e)}}class dd{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new rm(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Sm(this._firestore,this._userDataWriter,i.key,i,new rm(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Se(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const u=new Sm(r._firestore,r._userDataWriter,l.doc.key,l.doc,new rm(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new Sm(r._firestore,r._userDataWriter,l.doc.key,l.doc,new rm(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:K7(l.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=dd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Yk.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function K7(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ae(61501,{type:n})}}dd._jsonSchemaVersion="firestore/querySnapshot/1.0",dd._jsonSchema={type:Xt("string",dd._jsonSchemaVersion),bundleSource:Xt("string","QuerySnapshot"),bundleName:Xt("string"),bundle:Xt("string")};(function(e,t=!0){(function(r){Lu=r})(Ll),El(new ia("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),l=new ED(new F8(i.getProvider("auth-internal")),new z8(o,i.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Se(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Eu(h.options.projectId,f)})(o,r),o);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),ss(yR,_R,e),ss(yR,_R,"esm2020")})();const CD="firebasestorage.googleapis.com",H7="storageBucket",X7=120*1e3,q7=600*1e3;class ds extends hs{constructor(e,t,i=0){super(tv(e),`Firebase Storage: ${t} (${tv(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return tv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var cs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(cs||(cs={}));function tv(n){return"storage/"+n}function Y7(){const n="An unknown error occurred, please check the error payload for server response.";return new ds(cs.UNKNOWN,n)}function Z7(){return new ds(cs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Q7(){return new ds(cs.CANCELED,"User canceled the upload/download.")}function J7(n){return new ds(cs.INVALID_URL,"Invalid URL '"+n+"'.")}function e$(n){return new ds(cs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function A2(n){return new ds(cs.INVALID_ARGUMENT,n)}function RD(){return new ds(cs.APP_DELETED,"The Firebase app was deleted.")}function t$(n){return new ds(cs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class wr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=wr.makeFromUrl(e,t)}catch{return new wr(e,"")}if(i.path==="")return i;throw e$(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(R){R.path_=decodeURIComponent(R.path)}const f="v[A-Za-z0-9_]+",m=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",x=new RegExp(`^https?://${m}/${f}/b/${r}/o${y}`,"i"),T={bucket:1,path:3},I=t===CD?"(?:storage.googleapis.com|storage.cloud.google.com)":t,S="([^?#]*)",A=new RegExp(`^https?://${I}/${r}/${S}`,"i"),N=[{regex:l,indices:u,postModify:s},{regex:x,indices:T,postModify:h},{regex:A,indices:{bucket:1,path:2},postModify:h}];for(let R=0;R<N.length;R++){const L=N[R],j=L.regex.exec(e);if(j){const k=j[L.indices.bucket];let b=j[L.indices.path];b||(b=""),i=new wr(k,b),L.postModify(i);break}}if(i==null)throw J7(e);return i}}class n${constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function i$(n,e,t){let i=1,r=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function f(...S){h||(h=!0,e.apply(null,S))}function m(S){r=setTimeout(()=>{r=null,n(x,u())},S)}function y(){s&&clearTimeout(s)}function x(S,...A){if(h){y();return}if(S){y(),f.call(null,S,...A);return}if(u()||o){y(),f.call(null,S,...A);return}i<64&&(i*=2);let N;l===1?(l=2,N=0):N=(i+Math.random())*1e3,m(N)}let T=!1;function I(S){T||(T=!0,y(),!h&&(r!==null?(S||(l=2),clearTimeout(r),m(0)):S||(l=1)))}return m(0),s=setTimeout(()=>{o=!0,I(!0)},t),I}function r$(n){n(!1)}function s$(n){return n!==void 0}function b2(n,e,t,i){if(i<e)throw A2(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw A2(`Invalid value for '${n}'. Expected ${t} or less.`)}function o$(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var vp;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(vp||(vp={}));function a$(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class l${constructor(e,t,i,r,s,o,l,u,h,f,m,y=!0,x=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=m,this.retry=y,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,I)=>{this.resolve_=T,this.reject_=I,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new sm(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===vp.NO_ERROR,u=s.getStatus();if(!l||a$(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===vp.ABORT;i(!1,new sm(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new sm(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());s$(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=Y7();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(r.canceled){const u=this.appDelete_?RD():Q7();o(u)}else{const u=Z7();o(u)}};this.canceled_?t(!1,new sm(!1,null,!0)):this.backoffId_=i$(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&r$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class sm{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function c$(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function u$(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function h$(n,e){e&&(n["X-Firebase-GMPID"]=e)}function d$(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function f$(n,e,t,i,r,s,o=!0,l=!1){const u=o$(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return h$(f,e),c$(f,t),u$(f,s),d$(f,i),new l$(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,l)}function g$(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function m$(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class xp{constructor(e,t){this._service=e,t instanceof wr?this._location=t:this._location=wr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new xp(e,t)}get root(){const e=new wr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return m$(this._location.path)}get storage(){return this._service}get parent(){const e=g$(this._location.path);if(e===null)return null;const t=new wr(this._location.bucket,e);return new xp(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw t$(e)}}function P2(n,e){const t=e?.[H7];return t==null?null:wr.makeFromBucketSpec(t,n)}function p$(n,e,t,i={}){n.host=`${e}:${t}`;const r=Ml(e);r&&(X1(`https://${n.host}/b`),q1("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:ik(s,n.app.options.projectId))}class y${constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=CD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=X7,this._maxUploadRetryTime=q7,this._requests=new Set,r!=null?this._bucket=wr.makeFromBucketSpec(r,this._host):this._bucket=P2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=wr.makeFromBucketSpec(this._url,e):this._bucket=P2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){b2("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){b2("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Hi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new xp(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new n$(RD());{const o=f$(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const k2="@firebase/storage",N2="0.14.0";const AD="storage";function _$(n=Q1(),e){n=eo(n);const i=Qp(n,AD).getImmediate({identifier:e}),r=ek("storage");return r&&v$(i,...r),i}function v$(n,e,t,i={}){p$(n,e,t,i)}function x$(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new y$(t,i,r,e,Ll)}function w$(){El(new ia(AD,x$,"PUBLIC").setMultipleInstances(!0)),ss(k2,N2,""),ss(k2,N2,"esm2020")}w$();const E$={apiKey:"AIzaSyDsC3MhJwjLu-2Gq3rRNP6cfgAQc2sLF88",authDomain:"visapp-nl.firebaseapp.com",projectId:"visapp-nl",storageBucket:"visapp-nl.firebasestorage.app",messagingSenderId:"1095904118758",appId:"1:1095904118758:web:38f8be80439bcd788a7827"},Lw=uk(E$),nv=k8(Lw),T$=j7(Lw);_$(Lw);U7(T$).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const S$="visvriend2024",I$=new Ls,bD=Rr()(gf((n,e)=>({isAuthenticated:!1,user:null,loading:!0,checkPassword:t=>{const i=t===S$;return i&&n({isAuthenticated:!0}),i},signInWithGoogle:async()=>{try{const t=await zB(nv,I$);n({user:t.user,isAuthenticated:!0})}catch(t){throw console.error("Google sign-in error:",t),t}},logout:async()=>{try{await xB(nv),n({user:null,isAuthenticated:!1})}catch(t){console.error("Logout error:",t)}},initAuth:()=>{vB(nv,t=>{n(t?{user:t,isAuthenticated:!0,loading:!1}:{user:null,loading:!1})})}}),{name:"visapp-auth",partialize:n=>({isAuthenticated:n.isAuthenticated})})),Ow="https://waterwebservices.rijkswaterstaat.nl/ONLINEWAARNEMINGENSERVICES_DBO",qd=[{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556,x:97580,y:497920},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664,x:75580,y:458220},{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12,x:65150,y:444150},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961,x:30410,y:385360},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456,x:109200,y:553200},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083,x:158e3,y:576500},{id:"TERSLNZE",name:"Terschelling",lat:53.4397,lng:5.3281,x:155e3,y:606e3},{id:"TEXLHORS",name:"Texel Hors",lat:52.9983,lng:4.6981,x:106e3,y:557e3},{id:"EEMHVN",name:"Eemhaven",lat:51.9,lng:4.4833,x:9e4,y:436e3},{id:"KATSVR",name:"Kats",lat:51.5694,lng:3.9389,x:53e3,y:399e3}];function C$(n,e){let t=qd[0],i=1/0;for(const r of qd){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}async function R$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"T"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Ow}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching water temperature:",r),null}}async function A$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"GOLFHTE"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Ow}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0)return o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null}return null}catch(r){return console.error("Error fetching wave height:",r),null}}async function b$(n){const e=new Date,t=new Date(e.getTime()-3600*1e3),i={AquoPlusWaarnemingMetadata:{AquoMetadata:{Compartiment:{Code:"OW"},Grootheid:{Code:"STROOMSHD"}}},Locatie:{X:n.x,Y:n.y,Code:n.id},Periode:{Begindatumtijd:t.toISOString(),Einddatumtijd:e.toISOString()}};try{const s=await(await fetch(`${Ow}/OphalenLaatsteWaarnemingen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(s.Succesvol&&s.WaarnemingenLijst?.length>0){const o=s.WaarnemingenLijst[0];if(o.MetingenLijst?.length>0){const l=o.MetingenLijst[0].Meetwaarde?.Waarde_Numeriek??null;return l!==null?{speed:l,direction:0}:null}}return null}catch(r){return console.error("Error fetching current speed:",r),null}}async function P$(n){const[e,t,i]=await Promise.all([R$(n),A$(n),b$(n)]);return{temperature:e??void 0,waveHeight:t??void 0,currentSpeed:i?.speed??void 0,currentDirection:i?.direction??void 0,timestamp:new Date,station:n}}function D2(n){const e=new Date().getMonth(),i=[5,4,5,8,12,16,18,19,17,13,9,6][e]+(Math.random()*2-1),r=30+Math.random()*80,s=Math.random()*60,o=Math.random()*360;return{temperature:Math.round(i*10)/10,waveHeight:Math.round(r),currentSpeed:Math.round(s),currentDirection:Math.round(o),timestamp:new Date,station:n}}const k$=Rr((n,e)=>({station:qd[1],waterData:null,lastUpdated:null,isLoading:!1,error:null,useSimulatedData:!0,setStation:t=>n({station:t}),setStationByPosition:(t,i)=>{const r=C$(t,i);n({station:r})},fetchData:async()=>{const{station:t,useSimulatedData:i}=e();if(t){n({isLoading:!0,error:null});try{let r;i?r=D2(t):r=await P$(t),n({waterData:r,lastUpdated:new Date,isLoading:!1})}catch(r){console.error("Error fetching water data:",r);const s=D2(t);n({waterData:s,lastUpdated:new Date,isLoading:!1,error:"Kon geen live data ophalen, gesimuleerde data wordt getoond"})}}},setUseSimulatedData:t=>n({useSimulatedData:t})}));function N$({target:n}){const e=q.useRef(null),t=q.useRef(null),i=Js(s=>s.setMap),r=at(s=>s.showScaleBar);return q.useEffect(()=>{if(!e.current){const s=new v9({target:n,controls:[],view:new Qr({center:ml([5.1214,52.0907]),zoom:8,rotation:0,minZoom:3,maxZoom:19})});e.current=s,i(s),window.__olMap=s}return()=>{e.current&&(e.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,i]),q.useEffect(()=>{const s=e.current;s&&(r?t.current||(t.current=new E9({units:"metric",bar:!1,text:!0,minWidth:80}),s.addControl(t.current)):t.current&&(s.removeControl(t.current),t.current=null))},[r]),e.current}const D$=["OpenStreetMap","Luchtfoto"];function M$(){const n=q.useRef(null),e=q.useRef(!1);N$({target:"map"});const t=Js(u=>u.map),i=Yo(u=>u.registerLayer),r=Yo(u=>u.setLayerVisibility),s=at(u=>u.defaultBackground),o=at(u=>u.gpsAutoStart),l=ii(u=>u.startTracking);return q.useEffect(()=>{if(!t)return;console.log("Initializing map layers...");const u=new k0({properties:{title:"OpenStreetMap",type:"base"},visible:!0,source:new j6}),h=new k0({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Ov({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),f=new k0({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Ov({url:"https://{a-d}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})});t.addLayer(u),t.addLayer(h),t.addLayer(f),i("OpenStreetMap",u),i("Luchtfoto",h),i("Labels Overlay",f),t.updateSize(),m();async function m(){const y=X9();console.log(`Loading ${y.length} immediate layers...`),(await Promise.allSettled(y.map(async T=>{try{const I=await T.factory();return I?{name:T.name,layer:I}:null}catch(I){return console.warn(`Failed to create ${T.name}:`,I),null}}))).forEach(T=>{if(T.status==="fulfilled"&&T.value){const{name:I,layer:S}=T.value;t.addLayer(S),i(I,S)}})}},[t,i]),q.useEffect(()=>{if(!t||e.current)return;const u=setTimeout(()=>{const h=s||"OpenStreetMap";D$.forEach(f=>r(f,!1)),r(h,!0),e.current=!0},100);return()=>clearTimeout(u)},[t,s,r]),q.useEffect(()=>{if(!t||!o)return;const u=setTimeout(()=>l(),500);return()=>clearTimeout(u)},[t,o,l]),_.jsx("div",{id:"map",ref:n,style:{width:"100%",height:"100vh"}})}const L$=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),O$=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),M2=n=>{const e=O$(n);return e.charAt(0).toUpperCase()+e.slice(1)},PD=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),F$=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var V$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const j$=q.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...l},u)=>q.createElement("svg",{ref:u,...V$,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:PD("lucide",r),...!s&&!F$(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,f])=>q.createElement(h,f)),...Array.isArray(s)?s:[s]]));const Ie=(n,e)=>{const t=q.forwardRef(({className:i,...r},s)=>q.createElement(j$,{ref:s,iconNode:e,className:PD(`lucide-${L$(M2(n))}`,`lucide-${n}`,i),...r}));return t.displayName=M2(n),t};const z$=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],kD=Ie("anchor",z$);const U$=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],B$=Ie("book-open",U$);const W$=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Fw=Ie("camera",W$);const G$=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],ND=Ie("chart-column",G$);const $$=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],wx=Ie("check",$$);const K$=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],H$=Ie("chevron-left",K$);const X$=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],DD=Ie("chevron-right",X$);const q$=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Y$=Ie("chevron-up",q$);const Z$=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ex=Ie("clock",Z$);const Q$=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],J$=Ie("cloud-lightning",Q$);const eK=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],tK=Ie("cloud-rain",eK);const nK=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],iK=Ie("cloud-snow",nK);const rK=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],fd=Ie("cloud",rK);const sK=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],Tx=Ie("droplets",sK);const oK=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],MD=Ie("external-link",oK);const aK=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],lK=Ie("eye-off",aK);const cK=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],uK=Ie("eye",cK);const hK=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],dK=Ie("file-text",hK);const fK=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],Ys=Ie("fish",fK);const gK=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],mK=Ie("image-plus",gK);const pK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Vw=Ie("info",pK);const yK=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],wp=Ie("layers",yK);const _K=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],vK=Ie("loader-circle",_K);const xK=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],wK=Ie("locate-fixed",xK);const EK=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],TK=Ie("lock",EK);const SK=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],IK=Ie("log-out",SK);const CK=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],bl=Ie("map-pin",CK);const RK=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],wy=Ie("map",RK);const AK=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],bK=Ie("menu",AK);const PK=[["path",{d:"M5 12h14",key:"1ays0h"}]],kK=Ie("minus",PK);const NK=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],DK=Ie("moon",NK);const MK=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],gd=Ie("navigation",MK);const LK=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],LD=Ie("pause",LK);const OK=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],FK=Ie("person-standing",OK);const VK=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],OD=Ie("play",VK);const jK=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],zK=Ie("plus",jK);const UK=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],BK=Ie("refresh-cw",UK);const WK=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],GK=Ie("rotate-ccw",WK);const $K=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],KK=Ie("ruler",$K);const HK=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],XK=Ie("save",HK);const qK=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],YK=Ie("scale",qK);const ZK=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],L2=Ie("search",ZK);const QK=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],JK=Ie("settings",QK);const eH=[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]],tH=Ie("ship",eH);const nH=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],iH=Ie("sparkles",nH);const rH=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Sx=Ie("star",rH);const sH=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],oH=Ie("sun",sH);const aH=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],lH=Ie("tag",aH);const cH=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],jw=Ie("thermometer",cH);const uH=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],hH=Ie("trending-down",uH);const dH=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],fH=Ie("trending-up",dH);const gH=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],mH=Ie("user",gH);const pH=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],Yd=Ie("waves",pH);const yH=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],zw=Ie("wind",yH);const _H=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],bi=Ie("x",_H);async function vH(n){return new Promise(e=>{const t=new FileReader;t.onload=i=>{const r=new DataView(i.target?.result);if(r.getUint16(0)!==65496){e(null);return}let s=2;const o=r.byteLength;for(;s<o;){const l=r.getUint16(s);if(s+=2,l===65505){const u=r.getUint16(s);if(r.getUint32(s+2)!==1165519206){s+=u;continue}const f=s+8,m=r.getUint16(f)===18761,y=xH(r,f,m);e(y);return}if((l&65280)===65280)s+=r.getUint16(s);else break}e(null)},t.onerror=()=>e(null),t.readAsArrayBuffer(n)})}function xH(n,e,t){try{const i=e+n.getUint32(e+4,t),r=n.getUint16(i,t);let s=null;for(let m=0;m<r;m++){const y=i+2+m*12;if(n.getUint16(y,t)===34853){s=e+n.getUint32(y+8,t);break}}if(!s)return null;const o=n.getUint16(s,t);let l=null,u=null,h=null,f=null;for(let m=0;m<o;m++){const y=s+2+m*12,x=n.getUint16(y,t),T=n.getUint16(y+2,t),I=n.getUint32(y+4,t),S=y+8;switch(x){case 1:l=String.fromCharCode(n.getUint8(S));break;case 2:u=O2(n,e+n.getUint32(S,t),3,t);break;case 3:h=String.fromCharCode(n.getUint8(S));break;case 4:f=O2(n,e+n.getUint32(S,t),3,t);break}}if(u&&f&&l&&h){const m=F2(u[0],u[1],u[2],l),y=F2(f[0],f[1],f[2],h);if(!isNaN(m)&&!isNaN(y))return{lat:m,lng:y}}return null}catch{return null}}function O2(n,e,t,i){const r=[];for(let s=0;s<t;s++){const o=n.getUint32(e+s*8,i),l=n.getUint32(e+s*8+4,i);r.push(l===0?0:o/l)}return r}function F2(n,e,t,i){let r=n+e/60+t/3600;return(i==="S"||i==="W")&&(r=-r),r}const FD=200,wH=.7;async function EH(n,e=FD){return new Promise((t,i)=>{const r=new Image,s=document.createElement("canvas"),o=s.getContext("2d");r.onload=()=>{let l=r.width,u=r.height;l>u?l>e&&(u=Math.round(u*e/l),l=e):u>e&&(l=Math.round(l*e/u),u=e),s.width=l,s.height=u,o?.drawImage(r,0,0,l,u),s.toBlob(h=>{h?t(h):i(new Error("Failed to create blob from canvas"))},"image/jpeg",wH)},r.onerror=()=>i(new Error("Failed to load image")),r.src=URL.createObjectURL(n)})}function TH(n){return new Promise((e,t)=>{const i=new FileReader;i.onloadend=()=>{typeof i.result=="string"?e(i.result):t(new Error("Failed to convert blob to base64"))},i.onerror=()=>t(new Error("Failed to read blob")),i.readAsDataURL(n)})}async function VD(n){const e=await EH(n,FD),t=await TH(e);return{thumbnailBlob:e,thumbnailBase64:t}}function jD(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function SH(){const n=Js(N=>N.map),e=ri(N=>N.openCatchForm),[t,i]=q.useState(null),[r,s]=q.useState(!1),[o,l]=q.useState(!1),u=q.useRef(null),h=q.useRef(null);q.useEffect(()=>{if(!n)return;const N=n.getViewport();if(!N)return;const R=600,L=15,j=O=>{if(O.touches.length!==1)return;const le=O.touches[0];h.current={x:le.clientX,y:le.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const me=window.__olMap;if(!me)return;const ge=N.getBoundingClientRect(),ue=[h.current.x-ge.left,h.current.y-ge.top],Q=me.getCoordinateFromPixel(ue);if(Q){const se=DI(Q);O.preventDefault(),i({pixel:[h.current.x,h.current.y],coordinate:se}),s(!0),l(!1),setTimeout(()=>l(!0),300),"vibrate"in navigator&&navigator.vibrate(50)}},R)},k=O=>{if(!u.current||!h.current)return;const le=O.touches[0],me=le.clientX-h.current.x,ge=le.clientY-h.current.y;Math.sqrt(me*me+ge*ge)>L&&(clearTimeout(u.current),u.current=null)},b=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null},M=O=>{r&&O.preventDefault()},V=O=>{O.button===0&&(h.current={x:O.clientX,y:O.clientY},u.current&&clearTimeout(u.current),u.current=window.setTimeout(()=>{if(!h.current)return;const le=window.__olMap;if(!le)return;const me=N.getBoundingClientRect(),ge=[h.current.x-me.left,h.current.y-me.top],ue=le.getCoordinateFromPixel(ge);if(ue){const Q=DI(ue);i({pixel:[h.current.x,h.current.y],coordinate:Q}),s(!0),l(!1),setTimeout(()=>l(!0),300)}},R))},z=O=>{if(!u.current||!h.current)return;const le=O.clientX-h.current.x,me=O.clientY-h.current.y;Math.sqrt(le*le+me*me)>L&&(clearTimeout(u.current),u.current=null)},B=()=>{u.current&&(clearTimeout(u.current),u.current=null),h.current=null};return N.addEventListener("touchstart",j,{passive:!1}),N.addEventListener("touchmove",k,{passive:!0}),N.addEventListener("touchend",b),N.addEventListener("touchcancel",b),N.addEventListener("contextmenu",M),N.addEventListener("mousedown",V),N.addEventListener("mousemove",z),N.addEventListener("mouseup",B),N.addEventListener("mouseleave",B),()=>{N.removeEventListener("touchstart",j),N.removeEventListener("touchmove",k),N.removeEventListener("touchend",b),N.removeEventListener("touchcancel",b),N.removeEventListener("contextmenu",M),N.removeEventListener("mousedown",V),N.removeEventListener("mousemove",z),N.removeEventListener("mouseup",B),N.removeEventListener("mouseleave",B),u.current&&clearTimeout(u.current)}},[n,r]);const f=()=>{o&&(s(!1),i(null),l(!1))},m=()=>{s(!1),i(null),l(!1)},y=q.useRef(null),x=()=>{if(!t)return;const[N,R]=t.coordinate;e({location:{lat:R,lng:N},locationSource:"map"}),m()},T=()=>{y.current?.click()},I=async N=>{const R=N.target.files?.[0];if(!(!R||!t)){try{const L=await vH(R),{thumbnailBase64:j}=await VD(R),k={id:jD(),thumbnailBase64:j,createdAt:new Date().toISOString(),pendingUpload:!0};if(L)e({location:L,locationSource:"photo",photos:[k]});else{const[b,M]=t.coordinate;e({location:{lat:M,lng:b},locationSource:"map",photos:[k]})}}catch(L){console.error("Failed to process photo:",L);const[j,k]=t.coordinate;e({location:{lat:k,lng:j},locationSource:"map"})}N.target.value="",m()}},S=()=>{if(!t)return;const[N,R]=t.coordinate,L=`https://www.google.com/maps?q=${R},${N}`;window.open(L,"_blank"),m()},A=()=>{if(!t)return;const[N,R]=t.coordinate,L=`https://www.google.com/maps?layer=c&cbll=${R},${N}`;window.open(L,"_blank"),m()},D=N=>{const[R,L]=N;return`${L.toFixed(5)}N, ${R.toFixed(5)}E`};return _.jsx(li,{children:r&&t&&_.jsxs(_.Fragment,{children:[_.jsx(Ve.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),_.jsxs(Ve.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(t.pixel[0],window.innerWidth-220),top:Math.min(t.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[_.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:_.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[_.jsx(bl,{size:16}),_.jsx("span",{className:"text-xs font-mono",children:D(t.coordinate)})]})}),_.jsxs("div",{className:"bg-white",children:[_.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(Fw,{size:20,className:"text-green-500"}),_.jsx("span",{className:"font-medium",children:"Maak foto"})]}),_.jsxs("button",{onClick:x,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(Ys,{size:20,className:"text-orange-500"}),_.jsx("span",{className:"font-medium",children:"Vangst toevoegen"})]}),_.jsxs("button",{onClick:A,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(FK,{size:20,className:"text-yellow-600"}),_.jsx("span",{className:"font-medium",children:"Street View"})]}),_.jsxs("button",{onClick:S,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[_.jsx(MD,{size:20,className:"text-blue-600"}),_.jsx("span",{className:"font-medium",children:"Google Maps"})]})]}),_.jsx("input",{ref:y,type:"file",accept:"image/*",capture:"environment",onChange:I,className:"hidden"}),_.jsx("div",{className:"bg-white",children:_.jsxs("button",{onClick:m,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[_.jsx(bi,{size:18}),_.jsx("span",{children:"Annuleren"})]})})]})]})})}function IH(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r}=ii(),s=q.useCallback(l=>{i(l)},[i]),o=q.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return q.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(l),()=>{navigator.geolocation.clearWatch(l)}},[n,s,o,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function CH(){const{tracking:n,toggle:e}=IH();return _.jsx(Ve.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:_.jsx(wK,{size:22,strokeWidth:2})})}const RH="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#2196F3" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function AH(){const n=Js(y=>y.map),e=ii(y=>y.position),t=ii(y=>y.accuracy),i=ii(y=>y.tracking),r=ii(y=>y.smoothHeading),s=at(y=>y.showAccuracyCircle),o=ii(y=>y.firstFix),l=ii(y=>y.resetFirstFix),u=q.useRef(null),h=q.useRef(null),f=q.useRef(null),m=q.useMemo(()=>y=>new Qi({image:new k1({src:RH,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return q.useEffect(()=>{if(!n||!i&&!e)return;const y=ml([5.1214,52.0907]);return u.current=new au({geometry:new pl(y)}),u.current.setStyle(m(0)),h.current=new au({geometry:new pl(y)}),f.current=new j1({source:new P1({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,i,e,m]),q.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const y=ml([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const x=n.getView().getResolution()||1,T=Math.min(t/x,80);h.current.setStyle(new Qi({image:new Nl({radius:T,fill:new Ir({color:"rgba(33, 150, 243, 0.15)"})})}))}else h.current.setStyle(new Qi({}));if(o&&i){n.getView().setCenter(y),n.getView().setZoom(15),l();return}i&&!o&&n.getView().animate({center:y,duration:150})},[n,i,e,t,o,l,s]),q.useEffect(()=>{if(!u.current)return;const y=r!==null?r*Math.PI/180:0;u.current.setStyle(m(y))},[r,m]),null}function bH(){const n=Js(N=>N.map),[e,t]=q.useState(!1),[i,r]=q.useState(""),[s,o]=q.useState([]),[l,u]=q.useState(!1),[h,f]=q.useState(!1),m=q.useRef(null),y=q.useRef(null),x=q.useRef();q.useEffect(()=>{e&&m.current&&m.current.focus()},[e]),q.useEffect(()=>{if(!e)return;const N=R=>{y.current&&!y.current.contains(R.target)&&T()};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[e]),q.useEffect(()=>{if(!e)return;const N=R=>{R.key==="Escape"&&T()};return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},[e]),q.useEffect(()=>{if(x.current&&clearTimeout(x.current),i.length<2){o([]);return}return x.current=window.setTimeout(async()=>{f(!0);try{const R=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();R.response?.docs&&o(R.response.docs)}catch(N){console.error("Search error:",N),o([])}finally{f(!1)}},300),()=>{x.current&&clearTimeout(x.current)}},[i]);const T=()=>{t(!1),r(""),o([]),u(!1)},I=async N=>{try{const L=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(N)}`)).json();if(L.response?.docs?.[0]?.centroide_ll){const k=L.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(k)return{lng:parseFloat(k[1]),lat:parseFloat(k[2])}}}catch(R){console.error("Lookup error:",R)}return null},S=async N=>{if(!n)return;const R=await I(N.id);R&&n.getView().animate({center:ml([R.lng,R.lat]),zoom:16,duration:1e3}),T()},A=async(N,R)=>{R.stopPropagation();const L=await I(N.id);if(L){const j=`https://www.google.com/maps?q=${L.lat},${L.lng}`;window.open(j,"_blank")}T()},D={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?_.jsxs("div",{ref:y,className:"fixed left-[52px] right-14 z-[850]",style:D,children:[_.jsxs(Ve.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[_.jsx(L2,{size:18,className:"search-icon"}),_.jsx("input",{ref:m,type:"text",value:i,onChange:N=>{r(N.target.value),u(!0)},onFocus:()=>u(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),_.jsx("button",{onClick:T,className:"search-clear",title:"Sluiten",children:_.jsx(bi,{size:18})})]}),_.jsx(li,{children:l&&s.length>0&&_.jsx(Ve.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(N=>_.jsxs("li",{className:"search-result-item",children:[_.jsx("div",{className:"search-result-content",onClick:()=>S(N),children:_.jsx("span",{className:"search-result-text",children:N.weergavenaam})}),_.jsx("button",{className:"search-navigate-btn",onClick:R=>A(N,R),title:"Open in Google Maps",children:_.jsx(MD,{size:20})})]},N.id))})}),l&&h&&_.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):_.jsx(Ve.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:D,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:_.jsx(L2,{size:22,className:"text-gray-600"})})}function PH({size:n=18}){return _.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[_.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),_.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),_.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),_.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function kH(){const[n,e]=q.useState(!1),{toggleInfoPanel:t,toggleSettingsPanel:i}=ri(),{user:r,loading:s,signInWithGoogle:o,logout:l}=bD(),u=at(S=>S.showCatchButton),h=at(S=>S.setShowCatchButton),f={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},m=()=>e(!1),y=()=>{m(),t()},x=()=>{m(),i()},T=()=>{m(),o()},I=()=>{m(),l()};return _.jsxs(_.Fragment,{children:[_.jsx(Ve.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:f,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?_.jsx(bi,{size:22,className:"text-white"}):_.jsx(bK,{size:22,className:"text-gray-600"})}),_.jsx(li,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(Ve.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),_.jsxs(Ve.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)"},children:[_.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-blue-500",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Menu"})}),s?_.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:_.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):r?_.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:_.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL?_.jsx("img",{src:r.photoURL,alt:r.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):_.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:_.jsx(mH,{size:16,className:"text-white"})}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("div",{className:"font-medium text-gray-800 truncate text-sm",children:r.displayName||"Gebruiker"}),_.jsx("div",{className:"text-green-600 text-xs",children:"Ingelogd"})]}),_.jsx("button",{onClick:I,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:_.jsx(IK,{size:16})})]})}):_.jsxs("button",{onClick:T,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent border-b border-gray-100",children:[_.jsx(PH,{size:18}),_.jsx("span",{className:"text-gray-700 text-sm",children:"Inloggen met Google"})]}),_.jsx("div",{className:"py-1",children:_.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50 text-sm",children:[_.jsx(Vw,{size:18,className:"text-blue-500"}),_.jsx("span",{children:"Info & handleiding"})]})}),_.jsx("div",{className:"py-1 border-t border-gray-100",children:_.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx(Ys,{size:18,className:"text-green-500"}),_.jsx("span",{className:"text-gray-700 text-sm",children:"Vangst knop"})]}),_.jsx("button",{onClick:()=>h(!u),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${u?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:_.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${u?"left-[22px]":"left-0.5"}`})})]})}),_.jsx("div",{className:"mt-auto border-t border-gray-100",children:_.jsxs("button",{onClick:x,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50 text-sm",children:[_.jsx(JK,{size:18,className:"text-gray-500"}),_.jsx("span",{children:"Instellingen"})]})}),_.jsx("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400 text-xs",children:"VisApp NL v1.2.5"})]})]})})]})}function NH(){const{infoPanelOpen:n,toggleInfoPanel:e}=ri(),[t,i]=q.useState("info"),r=[{id:"info",label:"Info",icon:_.jsx(Vw,{size:14})},{id:"functies",label:"Functies",icon:_.jsx(dK,{size:14})},{id:"handleiding",label:"Handleiding",icon:_.jsx(B$,{size:14})}];return _.jsx(li,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(Ve.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),_.jsxs(Ve.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsx("span",{className:"font-medium text-white",children:"VisApp NL v1.2.5"}),_.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:_.jsx(bi,{size:18,className:"text-white",strokeWidth:2.5})})]}),_.jsx("div",{className:"flex border-b border-gray-200",children:r.map(s=>_.jsxs("button",{onClick:()=>i(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&_.jsx(DH,{}),t==="functies"&&_.jsx(MH,{}),t==="handleiding"&&_.jsx(LH,{}),_.jsx("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:_.jsx("p",{className:"text-xs text-gray-400 text-center",children:"VisApp NL v1.2.5 - Voor jou en je vismaat"})})]})]})]})})}function DH(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),_.jsx("p",{className:"text-gray-600",children:"VisApp NL is d gratis kaartapplicatie voor sportvissers in Nederland. Met aanlegsteigers, boothellingen, dieptekaarten en viswater grenzen. Registreer je vangsten, markeer favoriete plekken en deel met je vismaat."})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen"}),_.jsxs("ul",{className:"space-y-2 text-gray-600",children:[_.jsxs("li",{children:[_.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Aanlegsteigers, boothellingen, viswater gebieden"})]}),_.jsxs("li",{children:[_.jsx("strong",{children:"PDOK / Rijkswaterstaat"})," (CC0/CC-BY)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Dieptekaarten, locatieserver"})]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Open-Meteo"})," (CC-BY)",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:"Weergegevens en windinfo"})]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),_.jsxs("div",{className:"text-gray-600 space-y-2",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Lokale opslag:"})," Je vangsten en favoriete plekken worden lokaal op je apparaat opgeslagen."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"GPS:"})," Je locatie wordt alleen gebruikt om je positie op de kaart te tonen en wordt niet gedeeld."]})]})]})]})}function MH(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(wy,{size:16,className:"text-blue-600"}),"Kaartlagen"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsxs("li",{children:[_.jsx("strong",{children:"Achtergrond:"})," CartoDB, OpenStreetMap, Luchtfoto"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Aanlegsteigers:"})," Marina's en aanmeerplekken"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Boothellingen:"})," Plekken om je boot te water te laten"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Dieptekaart:"})," Waterdiepte informatie"]}),_.jsxs("li",{children:[_.jsx("strong",{children:"Viswater:"})," Grenzen van viswater gebieden"]})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(Ys,{size:16,className:"text-green-600"}),"Vangst Registratie"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Registreer soort, gewicht en lengte"}),_.jsx("li",{children:"Vismethode en aas bijhouden"}),_.jsx("li",{children:"Weergegevens automatisch opgeslagen"}),_.jsx("li",{children:"GPS locatie per vangst"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(bl,{size:16,className:"text-orange-600"}),"Favoriete Plekken"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Markeer je beste visplekken"}),_.jsx("li",{children:"Voeg notities en ratings toe"}),_.jsx("li",{children:"Welke vis zit waar?"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(fd,{size:16,className:"text-cyan-600"}),"Weer & Wind"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Live weergegevens op je locatie"}),_.jsx("li",{children:"Windsnelheid en richting"}),_.jsx("li",{children:"Luchtdruk"}),_.jsx("li",{children:"Visvriendelijkheid indicator"})]})]}),_.jsxs("section",{children:[_.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(gd,{size:16,className:"text-blue-600"}),"GPS & Navigatie"]}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[_.jsx("li",{children:"Live GPS tracking"}),_.jsx("li",{children:"Zoek adressen en plaatsen"}),_.jsx("li",{children:"Open locatie in Google Maps"})]})]})]})}function LH(){return _.jsxs(_.Fragment,{children:[_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),_.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[_.jsxs("li",{children:["Tik op de ",_.jsx("strong",{children:"GPS knop"})," (rechtsonder, blauw) om je locatie te zien"]}),_.jsxs("li",{children:["Gebruik het ",_.jsx("strong",{children:"lagen paneel"})," (linksonder) om kaartlagen aan te zetten"]}),_.jsxs("li",{children:["Tik op de ",_.jsx("strong",{children:"groene vis knop"})," om een vangst te registreren"]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vangst registreren"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Via GPS:"})," Tik op de groene vis knop. Je locatie wordt automatisch ingevuld."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Vul in:"})," Vissoort (verplicht), gewicht, lengte, methode en aas."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Weer:"})," Weergegevens worden automatisch toegevoegd als GPS actief is."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Kaartlagen gebruiken"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Lagen paneel:"})," Linksonder op de kaart."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Achtergrond:"})," Kies tussen kaart, OSM of satelliet."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Overlays:"})," Zet aanlegsteigers, boothellingen, diepte of viswater aan."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken"}),_.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[_.jsxs("p",{children:[_.jsx("strong",{children:"Zoekknop:"})," Rechtsboven naast het menu."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Zoek:"})," Type een adres of plaatsnaam."]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Navigeer:"})," Tik op het pijltje om in Google Maps te openen."]})]})]}),_.jsxs("section",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor vissen"}),_.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[_.jsxs("li",{children:["Gebruik de ",_.jsx("strong",{children:"dieptekaart"})," om diepe plekken te vinden"]}),_.jsxs("li",{children:["Check de ",_.jsx("strong",{children:"weer widget"})," voor visvriendelijke omstandigheden"]}),_.jsx("li",{children:"Lage luchtdruk en bewolkt weer = vaak beter bijten!"}),_.jsxs("li",{children:["Markeer succesvolle plekken als ",_.jsx("strong",{children:"favoriet"})]})]})]})]})}const OH=ml([5.1214,52.0907]),FH=8;function VH(){const n=Js(r=>r.map),e=Yo(r=>r.setLayerVisibility),t=ii(r=>r.stopTracking),i=()=>{t(),e("OpenStreetMap",!0),e("Luchtfoto",!1),e("Labels Overlay",!1),e("Aanlegsteigers",!1),e("Boothellingen",!1),e("Dieptekaart",!1),e("Viswater",!1),n&&n.getView().animate({center:OH,zoom:FH,rotation:0,duration:500})};return _.jsx(Ve.button,{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - Standaard kaart, alle lagen uit, GPS uit",children:_.jsx(GK,{size:18,className:"text-gray-600"})})}const jH={Map:wy,Fish:Ys,Anchor:kD,Layers:wp,Star:Sx},zH={Map:"text-gray-600",Fish:"text-green-600",Anchor:"text-blue-600",Layers:"text-purple-600",Star:"text-yellow-500"},UH={Map:"hover:bg-gray-50",Fish:"hover:bg-green-50",Anchor:"hover:bg-blue-50",Layers:"hover:bg-purple-50",Star:"hover:bg-yellow-50"};function BH(){const{presets:n,applyPreset:e,updatePreset:t,createPreset:i}=ez(),[r,s]=q.useState(!1),[o,l]=q.useState(null),[u,h]=q.useState(!1),[f,m]=q.useState(""),y=I=>{e(I),s(!1)},x=(I,S)=>{I.stopPropagation();const{useLayerStore:A}=require("../../store"),D=A.getState().visible,N=["Aanlegsteigers","Boothellingen","Dieptekaart","Viswater"].filter(R=>D[R]);t(S,{layers:N}),l(S),setTimeout(()=>l(null),2e3)},T=()=>{f.trim()&&(i(f.trim()),m(""),h(!1))};return _.jsxs(_.Fragment,{children:[_.jsx(Ve.button,{onClick:()=>s(!r),className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?_.jsx(Y$,{size:20,className:"text-blue-600"}):_.jsx(wp,{size:20,className:"text-gray-600"})}),_.jsx(li,{children:r&&_.jsxs(_.Fragment,{children:[_.jsx(Ve.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1)}),_.jsxs(Ve.div,{className:"fixed bottom-[116px] left-2 z-[801] bg-white rounded-xl shadow-lg overflow-hidden min-w-[180px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},children:[_.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Presets"})}),_.jsx("div",{className:"p-2 max-h-[250px] overflow-y-auto",children:n.map(I=>{const S=jH[I.icon]||wp,A=zH[I.icon]||"text-blue-600",D=UH[I.icon]||"hover:bg-blue-50",N=o===I.id;return _.jsxs("button",{onClick:()=>y(I.id),className:`w-full h-9 flex items-center gap-2 px-2 ${D} rounded text-left transition-colors border-0 outline-none bg-transparent ${N?"bg-green-50":""}`,children:[_.jsx(S,{size:16,className:`${A} flex-shrink-0`}),_.jsx("span",{className:"text-gray-700 text-sm truncate flex-1",children:I.name}),N?_.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:_.jsx(wx,{size:14,className:"text-green-500"})}):_.jsx("span",{onClick:R=>x(R,I.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan",children:_.jsx(XK,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},I.id)})}),_.jsx("div",{className:"border-t border-gray-200 p-2",children:u?_.jsxs("div",{className:"flex gap-1",children:[_.jsx("input",{type:"text",value:f,onChange:I=>m(I.target.value),onKeyDown:I=>{I.key==="Enter"&&T(),I.key==="Escape"&&h(!1)},placeholder:"Naam...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400"}),_.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs disabled:opacity-50 border-0 outline-none",children:"OK"})]}):_.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",children:[_.jsx(zK,{size:14}),_.jsx("span",{children:"Nieuwe preset"})]})})]})]})})]})}const V2={lat:52.1326,lng:5.2913};function WH({size:n=18,className:e=""}){return _.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[_.jsx("path",{d:"M3 12h18"}),_.jsx("path",{d:"M21 12c-1.5 0-3-1-3-3s1.5-3 3-3"}),_.jsx("path",{d:"M21 12c-1.5 0-3 1-3 3s1.5 3 3 3"}),_.jsx("circle",{cx:"4",cy:"12",r:"1.5",fill:"currentColor"}),_.jsx("path",{d:"M8 12l2-3"}),_.jsx("path",{d:"M8 12l2 3"}),_.jsx("path",{d:"M12 12l2-3"}),_.jsx("path",{d:"M12 12l2 3"}),_.jsx("path",{d:"M16 12l1.5-2"}),_.jsx("path",{d:"M16 12l1.5 2"})]})}function j2({size:n=16,className:e="",clipPercent:t=100}){const i=`fish-clip-${Math.random().toString(36).substr(2,9)}`;return _.jsxs("svg",{width:n*(t/100),height:n,viewBox:`0 0 ${24*(t/100)} 24`,fill:"currentColor",className:e,style:{overflow:"hidden"},children:[_.jsx("defs",{children:_.jsx("clipPath",{id:i,children:_.jsx("rect",{x:"0",y:"0",width:24*(t/100),height:"24"})})}),_.jsxs("g",{clipPath:`url(#${i})`,children:[_.jsx("path",{d:"M6.5 12c0-3.5 3-6 7-6 2.5 0 4.5 1 6 2.5.8.8 1.5 1.8 2 3-.5 1.2-1.2 2.2-2 3-1.5 1.5-3.5 2.5-6 2.5-4 0-7-2.5-7-5z"}),_.jsx("path",{d:"M2.5 12l3-3v6l-3-3z"}),_.jsx("circle",{cx:"17",cy:"11",r:"1",fill:"white"})]})]})}function GH({value:n,maxFish:e=3,color:t}){const i=Math.floor(n),r=n%1>=.5,s=[];for(let o=0;o<i&&o<e;o++)s.push(_.jsx(j2,{size:16,className:t},o));return r&&i<e&&s.push(_.jsx(j2,{size:16,className:t,clipPercent:50},"half")),_.jsx("div",{className:"flex items-center gap-0.5",children:s.length>0?s:_.jsx(WH,{size:18,className:t})})}function zD({phase:n,size:e=20}){const t=n<.5,i=n<.5?n*2:(1-n)*2;return _.jsx("div",{className:"relative rounded-full bg-gray-700 overflow-hidden",style:{width:e,height:e},children:_.jsx("div",{className:"absolute inset-0 bg-yellow-100",style:{clipPath:t?`inset(0 ${(1-i)*100}% 0 0)`:`inset(0 0 0 ${(1-i)*100}%)`}})})}function $H({activity:n,label:e}){const t=()=>n>=.8?"bg-green-500":n>=.6?"bg-lime-500":n>=.4?"bg-amber-500":"bg-red-400";return _.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"text-[10px] text-gray-500 w-12",children:e}),_.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:_.jsx("div",{className:`h-full ${t()} transition-all`,style:{width:`${n*100}%`}})})]})}function Uw(n){const e=29.53058867,t=new Date("2000-01-06T18:14:00Z");return(n.getTime()-t.getTime())/(1e3*60*60*24)%e/e}function Ix(n){const e=Uw(n),t=n.getHours(),i=Math.floor((e*24+12)%24),r=(i+6)%24,s=(i+18)%24,o=[i,(i+12)%24],l=[r,s];let u=.3;return(e<.1||e>.9||e>.4&&e<.6)&&(u+=.3),o.forEach(h=>{const f=Math.abs(t-h);f<=1||f>=23?u+=.3:(f<=2||f>=22)&&(u+=.15)}),l.forEach(h=>{const f=Math.abs(t-h);f<=.5?u+=.15:f<=1&&(u+=.08)}),{major:o,minor:l,overall:Math.min(1,u)}}function KH({data:n,onClose:e}){if(n.length===0)return null;const t=n.map(S=>S.pressure),i=Math.min(...t)-2,r=Math.max(...t)+2,s=r-i,o=300,l=120,u={top:10,right:10,bottom:25,left:35},h=o-u.left-u.right,f=l-u.top-u.bottom,m=n.map((S,A)=>{const D=u.left+A/(n.length-1)*h,N=u.top+f-(S.pressure-i)/s*f;return{x:D,y:N,time:S.time,pressure:S.pressure}}),y=m.map((S,A)=>`${A===0?"M":"L"} ${S.x} ${S.y}`).join(" "),x=new Date,T=n.findIndex(S=>new Date(S.time)>=x)||Math.floor(n.length/3),I=S=>new Date(S).getHours().toString().padStart(2,"0")+":00";return _.jsx(Ve.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:_.jsxs(Ve.div,{className:"bg-white rounded-xl shadow-xl p-4 max-w-sm w-full",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:S=>S.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-3",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(ND,{size:18,className:"text-blue-500"}),"Luchtdruk (72 uur)"]}),_.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(bi,{size:18,className:"text-gray-500"})})]}),_.jsxs("svg",{width:o,height:l,className:"w-full",children:[[0,.25,.5,.75,1].map(S=>{const A=u.top+S*f,D=Math.round(r-S*s);return _.jsxs("g",{children:[_.jsx("line",{x1:u.left,y1:A,x2:o-u.right,y2:A,stroke:"#e5e7eb",strokeWidth:"1"}),_.jsx("text",{x:u.left-4,y:A+4,fontSize:"9",fill:"#9ca3af",textAnchor:"end",children:D})]},S)}),[0,Math.floor(n.length/3),Math.floor(2*n.length/3),n.length-1].map(S=>{if(S>=n.length)return null;const A=u.left+S/(n.length-1)*h;return _.jsx("text",{x:A,y:l-5,fontSize:"8",fill:"#9ca3af",textAnchor:"middle",children:I(n[S].time)},S)}),_.jsx("path",{d:`${m.slice(0,T+1).map((S,A)=>`${A===0?"M":"L"} ${S.x} ${S.y}`).join(" ")} L ${m[T]?.x||u.left} ${l-u.bottom} L ${u.left} ${l-u.bottom} Z`,fill:"rgba(59, 130, 246, 0.15)"}),T<m.length-1&&_.jsx("path",{d:`${m.slice(T).map((S,A)=>`${A===0?"M":"L"} ${S.x} ${S.y}`).join(" ")} L ${m[m.length-1].x} ${l-u.bottom} L ${m[T].x} ${l-u.bottom} Z`,fill:"rgba(59, 130, 246, 0.08)"}),_.jsx("path",{d:y,fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),m[T]&&_.jsxs(_.Fragment,{children:[_.jsx("line",{x1:m[T].x,y1:u.top,x2:m[T].x,y2:l-u.bottom,stroke:"#f59e0b",strokeWidth:"1",strokeDasharray:"3,3"}),_.jsx("circle",{cx:m[T].x,cy:m[T].y,r:"4",fill:"#f59e0b"}),_.jsx("text",{x:m[T].x,y:u.top-2,fontSize:"8",fill:"#f59e0b",textAnchor:"middle",children:"Nu"})]})]}),_.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Dalende druk = vaak beter bijten"})]})})}function HH({onClose:n}){const e=new Date,t=Uw(e),i=Ix(e),r=Array.from({length:24},(l,u)=>{const h=new Date(e);return h.setHours(u,0,0,0),{hour:u,activity:Ix(h).overall}}),s=l=>l<.03||l>.97?"Nieuwe maan":l<.22?"Wassende sikkel":l<.28?"Eerste kwartier":l<.47?"Wassende maan":l<.53?"Volle maan":l<.72?"Afnemende maan":l<.78?"Laatste kwartier":"Afnemende sikkel",o=l=>`${l.toString().padStart(2,"0")}:00`;return _.jsx(Ve.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(Ve.div,{className:"bg-white rounded-xl shadow-xl p-4 max-w-sm w-full max-h-[80vh] overflow-y-auto",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:l=>l.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(DK,{size:18,className:"text-blue-500"}),"Solunar Activiteit"]}),_.jsx("button",{onClick:n,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(bi,{size:18,className:"text-gray-500"})})]}),_.jsxs("div",{className:"flex items-center gap-3 mb-4 p-3 bg-gray-50 rounded-lg",children:[_.jsx(zD,{phase:t,size:40}),_.jsxs("div",{children:[_.jsx("div",{className:"font-medium text-gray-800",children:s(t)}),_.jsxs("div",{className:"text-xs text-gray-500",children:[Math.round(t*100),"% cyclus"]})]})]}),_.jsxs("div",{className:"mb-4",children:[_.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Beste tijden vandaag"}),_.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_.jsxs("div",{className:"bg-green-50 p-2 rounded-lg",children:[_.jsx("div",{className:"text-xs text-green-600 font-medium",children:"Major periodes"}),_.jsx("div",{className:"text-sm text-green-800",children:i.major.map(l=>o(l)).join(", ")})]}),_.jsxs("div",{className:"bg-amber-50 p-2 rounded-lg",children:[_.jsx("div",{className:"text-xs text-amber-600 font-medium",children:"Minor periodes"}),_.jsx("div",{className:"text-sm text-amber-800",children:i.minor.map(l=>o(l)).join(", ")})]})]})]}),_.jsxs("div",{className:"mb-3",children:[_.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Activiteit per uur"}),_.jsx("div",{className:"flex items-end gap-0.5 h-16",children:r.map(({hour:l,activity:u})=>_.jsx("div",{className:`flex-1 rounded-t transition-all ${u>=.7?"bg-green-500":u>=.5?"bg-lime-500":u>=.3?"bg-amber-500":"bg-red-400"} ${l===e.getHours()?"ring-2 ring-blue-500":""}`,style:{height:`${u*100}%`},title:`${o(l)}: ${Math.round(u*100)}%`},l))}),_.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400 mt-1",children:[_.jsx("span",{children:"00:00"}),_.jsx("span",{children:"06:00"}),_.jsx("span",{children:"12:00"}),_.jsx("span",{children:"18:00"}),_.jsx("span",{children:"24:00"})]})]}),_.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Gebaseerd op maanfase en -positie"})]})})}function XH(){const{current:n,loading:e,fetchWeather:t,getFishingCondition:i,getFishingScore:r,pressureHistory:s,getPressureTrend:o}=Fd(),l=ii(j=>j.position),u=at(j=>j.showWeatherWidget),[h,f]=q.useState(!1),[m,y]=q.useState(!1),x={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};if(q.useEffect(()=>{const j=l||V2;t(j.lat,j.lng)},[]),q.useEffect(()=>{l&&t(l.lat,l.lng)},[l,t]),q.useEffect(()=>{const j=l||V2,k=setInterval(()=>{t(j.lat,j.lng)},600*1e3);return()=>clearInterval(k)},[l,t]),!u||!n&&!e)return null;const T=i(),I=r?r():T==="excellent"?3:T==="good"?2:T==="moderate"?1:0,S=Ix(new Date),A=Uw(new Date),D=Math.min(3,I/2+S.overall*1.5),N=j=>j>=2.5?"text-green-500":j>=1.5?"text-lime-500":j>=.8?"text-amber-500":"text-red-500",R=j=>j>=2.5?"bg-green-50 border-green-200":j>=1.5?"bg-lime-50 border-lime-200":j>=.8?"bg-amber-50 border-amber-200":"bg-red-50 border-red-200",L=j=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(j/45)%8];return _.jsxs(_.Fragment,{children:[_.jsx(Ve.div,{className:`fixed left-2 z-[700] bg-white/95 backdrop-blur-sm rounded-xl shadow-sm p-3 min-w-[140px] border ${R(D)}`,style:x,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e?_.jsx("div",{className:"text-sm text-gray-500",children:"Laden..."}):n?_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex items-center justify-between pb-2 border-b border-gray-100",children:[_.jsx(GH,{value:D,color:N(D)}),_.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-1 p-1 hover:bg-white/50 rounded transition-colors border-0 outline-none bg-transparent",title:"Solunar info",children:[_.jsx(zD,{phase:A,size:16}),_.jsx(DD,{size:12,className:"text-gray-400"})]})]}),_.jsx($H,{activity:S.overall,label:"Activiteit"}),_.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[_.jsx(jw,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.temperature),"C"]})]}),_.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[_.jsx(zw,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.windSpeed)," km/u ",L(n.windDirection)]})]}),_.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 text-sm text-gray-500 hover:text-blue-500 transition-colors w-full border-0 outline-none bg-transparent p-0",children:[_.jsx(ND,{size:16,className:"text-gray-400"}),_.jsxs("span",{children:[Math.round(n.pressure)," hPa"]}),(()=>{const j=o();return j==="rising"?_.jsx(fH,{size:14,className:"text-green-500 ml-auto"}):j==="falling"?_.jsx(hH,{size:14,className:"text-red-500 ml-auto"}):_.jsx(kK,{size:14,className:"text-gray-400 ml-auto"})})()]})]}):null}),_.jsx(li,{children:h&&s.length>0&&_.jsx(KH,{data:s,onClose:()=>f(!1)})}),_.jsx(li,{children:m&&_.jsx(HH,{onClose:()=>y(!1)})})]})}function qH(){const n=Fd(o=>o.current);if(!at(o=>o.showWindIndicator)||!n)return null;const t=Math.round(n.windSpeed),i=n.windDirection,r=()=>t<12?"#22c55e":t<20?"#84cc16":t<30?"#eab308":t<40?"#f97316":"#ef4444",s=()=>t<5?"Stil":t<12?"Zwak":t<20?"Matig":t<30?"Vrij krachtig":t<40?"Krachtig":"Hard";return _.jsxs(Ve.div,{className:"fixed bottom-4 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},children:[_.jsxs("div",{className:"relative w-16 h-16",children:[_.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-gray-200"}),_.jsx("span",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-0.5 text-[8px] font-bold text-gray-400",children:"N"}),_.jsx("span",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-0.5 text-[8px] font-bold text-gray-400",children:"Z"}),_.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-0.5 text-[8px] font-bold text-gray-400",children:"W"}),_.jsx("span",{className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-0.5 text-[8px] font-bold text-gray-400",children:"O"}),_.jsx(Ve.div,{className:"absolute inset-2 flex items-center justify-center",style:{transform:`rotate(${i}deg)`},animate:{rotate:i},transition:{type:"spring",stiffness:100},children:_.jsx("svg",{viewBox:"0 0 24 24",className:"w-full h-full",style:{color:r()},children:_.jsx("path",{d:"M12 2l-6 10h4v10h4V12h4L12 2z",fill:"currentColor"})})}),_.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:_.jsx("div",{className:"bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-sm",children:_.jsx("span",{className:"text-xs font-bold",style:{color:r()},children:t})})})]}),_.jsx("div",{className:"text-center mt-1",children:_.jsx("span",{className:"text-[10px] text-gray-500",children:s()})})]})}const md=[{id:"HOEKVHLD",name:"Hoek van Holland",lat:51.9775,lng:4.12},{id:"IJMDMNTHVN",name:"IJmuiden",lat:52.4639,lng:4.5556},{id:"DENHDR",name:"Den Helder",lat:52.9647,lng:4.7456},{id:"HARVLGTHVN",name:"Harlingen",lat:53.1747,lng:5.4083},{id:"VLISSGN",name:"Vlissingen",lat:51.4428,lng:3.5961},{id:"SCHEVNGN",name:"Scheveningen",lat:52.1033,lng:4.2664}];function YH(n,e,t){const i=[],r=29.53058867,s=new Date("2000-01-06T18:14:00Z"),o=t.lng/15*60,l=745;for(let u=0;u<e;u++){const h=new Date(n);h.setDate(h.getDate()+u),h.setHours(0,0,0,0);const m=(h.getTime()-s.getTime())/(1e3*60*60*24)%r/r;let y=m*l*2%1440;y=(y+o)%1440;for(let x=0;x<4;x++){const T=x%2===0,I=x*(l/2);let S=y+I;const A=Math.floor(S/1440);S=S%1440;const D=Math.floor(S/60),N=Math.floor(S%60),R=new Date(h);R.setDate(R.getDate()+A),R.setHours(D,N,0,0);const L=Math.abs(Math.sin(m*Math.PI*2)),j=T?1.8:.4,k=L*.5;i.push({time:R,height:T?j+k:j-k*.5,type:T?"high":"low"})}}return i.sort((u,h)=>u.time.getTime()-h.time.getTime())}function ZH(n,e){let t=md[0],i=1/0;for(const r of md){const s=Math.sqrt(Math.pow(r.lat-n,2)+Math.pow(r.lng-e,2));s<i&&(i=s,t=r)}return t}function Cx(n,e){if(e.length<2)return 1;let t=e[0],i=e[1];for(let u=0;u<e.length-1;u++)if(e[u].time<=n&&e[u+1].time>n){t=e[u],i=e[u+1];break}const r=i.time.getTime()-t.time.getTime(),s=n.getTime()-t.time.getTime(),o=Math.max(0,Math.min(1,s/r)),l=(1-Math.cos(o*Math.PI))/2;return t.height+(i.height-t.height)*l}function QH(){const[n,e]=q.useState(!1),[t,i]=q.useState(md[5]),[r,s]=q.useState(new Date),[o,l]=q.useState(!1),u=ii(R=>R.position),h=at(R=>R.showTideWidget);q.useEffect(()=>{u&&i(ZH(u.lat,u.lng))},[u]);const f=q.useMemo(()=>{const R=new Date;return R.setDate(R.getDate()-2),R.setHours(0,0,0,0),YH(R,5,t)},[t]);if(q.useEffect(()=>{if(!o)return;const R=setInterval(()=>{s(L=>{const j=new Date(L.getTime()+18e5),k=new Date;return k.setDate(k.getDate()+2),k.setHours(23,59,59,999),j>k?(l(!1),k):j})},100);return()=>clearInterval(R)},[o]),!h)return null;const m=new Date,y=Cx(m,f);f.find(R=>R.time>m);const x=new Date;x.setDate(x.getDate()-2),x.setHours(0,0,0,0);const T=new Date;T.setDate(T.getDate()+2),T.setHours(23,59,59,999);const I=T.getTime()-x.getTime(),S=(r.getTime()-x.getTime())/I*100,A=R=>{const L=new Date(x.getTime()+R/100*I);s(L)},D=R=>{const L=new Date,j=Math.floor((R.getTime()-L.setHours(0,0,0,0))/(1440*60*1e3));return j===0?"Vandaag":j===1?"Morgen":j===-1?"Gisteren":j===2?"Overmorgen":j===-2?"Eergisteren":R.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric",month:"short"})},N=R=>R.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return _.jsxs(_.Fragment,{children:[_.jsxs(Ve.button,{className:"fixed bottom-28 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none",onClick:()=>e(!0),whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsx(Yd,{size:18,className:"text-blue-500"}),_.jsxs("div",{className:"text-left",children:[_.jsx("div",{className:"text-[10px] text-gray-500 truncate max-w-[80px]",children:t.name}),_.jsxs("div",{className:"text-xs font-medium text-blue-600",children:[y.toFixed(1),"m"]})]})]}),_.jsx(li,{children:n&&_.jsx(Ve.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1),children:_.jsxs(Ve.div,{className:"bg-white rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:R=>R.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Yd,{size:20,className:"text-white"}),_.jsx("span",{className:"font-semibold text-white",children:"Getijden"})]}),_.jsx("button",{onClick:()=>e(!1),className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(bi,{size:20,className:"text-white"})})]}),_.jsxs("div",{className:"p-4 space-y-4",children:[_.jsx("div",{className:"flex items-center gap-2",children:_.jsx("select",{value:t.id,onChange:R=>{const L=md.find(j=>j.id===R.target.value);L&&i(L)},className:"flex-1 p-2 border border-gray-200 rounded-lg text-sm bg-white",children:md.map(R=>_.jsx("option",{value:R.id,children:R.name},R.id))})}),_.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("div",{className:"text-sm text-gray-500",children:D(r)}),_.jsx("div",{className:"text-2xl font-bold text-blue-600",children:N(r)})]}),_.jsxs("div",{className:"text-right",children:[_.jsx("div",{className:"text-sm text-gray-500",children:"Waterstand"}),_.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Cx(r,f).toFixed(2),"m"]})]})]})}),_.jsx(JH,{tides:f,selectedTime:r,minTime:x,maxTime:T,onTimeSelect:R=>s(R)}),_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[_.jsx("span",{children:D(x)}),_.jsx("span",{className:"font-medium text-blue-500",children:"Nu"}),_.jsx("span",{children:D(T)})]}),_.jsx("input",{type:"range",min:"0",max:"100",value:S,onChange:R=>A(parseFloat(R.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #93c5fd 0%, #93c5fd 40%, #3b82f6 40%, #3b82f6 ${S}%, #e5e7eb ${S}%, #e5e7eb 100%)`}})]}),_.jsxs("div",{className:"flex items-center justify-center gap-4",children:[_.jsx("button",{onClick:()=>{const R=new Date(x);s(R)},className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(H$,{size:20})}),_.jsx("button",{onClick:()=>l(!o),className:"p-3 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors border-0 outline-none",children:o?_.jsx(LD,{size:20}):_.jsx(OD,{size:20})}),_.jsx("button",{onClick:()=>s(new Date),className:"px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none bg-transparent font-medium",children:"Nu"}),_.jsx("button",{onClick:()=>{const R=new Date(T);s(R)},className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(DD,{size:20})})]}),_.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[_.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Volgende getijden"}),_.jsx("div",{className:"grid grid-cols-4 gap-2",children:f.filter(R=>R.time>m).slice(0,4).map((R,L)=>_.jsxs("button",{onClick:()=>s(R.time),className:`p-2 rounded-lg text-center transition-colors border-0 outline-none ${R.type==="high"?"bg-green-50 hover:bg-green-100":"bg-red-50 hover:bg-red-100"}`,children:[_.jsx("div",{className:`text-[10px] font-medium ${R.type==="high"?"text-green-600":"text-red-600"}`,children:R.type==="high"?"HW":"LW"}),_.jsx("div",{className:"text-xs font-medium",children:N(R.time)}),_.jsxs("div",{className:"text-[10px] text-gray-500",children:[R.height.toFixed(1),"m"]})]},L))})]}),_.jsx("div",{className:"text-xs text-gray-400 text-center",children:"Bron: berekening gebaseerd op maanstand  Alleen ter indicatie"})]})]})})})]})}function JH({tides:n,selectedTime:e,minTime:t,maxTime:i,onTimeSelect:r}){const l={top:20,right:15,bottom:30,left:40},u=400-l.left-l.right,h=150-l.top-l.bottom,f=i.getTime()-t.getTime(),m=new Date,y=[],x=240;for(let R=0;R<=x;R++){const L=new Date(t.getTime()+R/x*f),j=Cx(L,n),k=l.left+R/x*u,b=l.top+h-(j-.2)/2.3*h;y.push({x:k,y:b,time:L,height:j})}const T=y.map((R,L)=>`${L===0?"M":"L"} ${R.x} ${R.y}`).join(" "),I=l.left+(m.getTime()-t.getTime())/f*u,S=l.left+(e.getTime()-t.getTime())/f*u,A=y.find(R=>Math.abs(R.time.getTime()-e.getTime())<1800*1e3)?.y||l.top,D=[];for(let R=-2;R<=2;R++){const L=new Date;L.setDate(L.getDate()+R),L.setHours(0,0,0,0);const j=l.left+(L.getTime()-t.getTime())/f*u,k=R===0?"Vandaag":R===1?"Morgen":R===-1?"Gisteren":"";D.push({x:j,label:k})}const N=R=>{const L=R.currentTarget.getBoundingClientRect(),k=(R.clientX-L.left-l.left)/u;if(k>=0&&k<=1){const b=new Date(t.getTime()+k*f);r(b)}};return _.jsxs("svg",{width:400,height:150,className:"w-full cursor-crosshair",onClick:N,children:[[.5,1,1.5,2].map(R=>{const L=l.top+h-(R-.2)/2.3*h;return _.jsxs("g",{children:[_.jsx("line",{x1:l.left,y1:L,x2:400-l.right,y2:L,stroke:"#e5e7eb",strokeWidth:"1"}),_.jsxs("text",{x:l.left-5,y:L+4,fontSize:"10",fill:"#9ca3af",textAnchor:"end",children:[R,"m"]})]},R)}),D.map((R,L)=>_.jsxs("g",{children:[_.jsx("line",{x1:R.x,y1:l.top,x2:R.x,y2:150-l.bottom,stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"4,4"}),R.label&&_.jsx("text",{x:R.x+5,y:140,fontSize:"9",fill:"#6b7280",children:R.label})]},L)),_.jsx("path",{d:`${y.filter(R=>R.time<=m).map((R,L)=>`${L===0?"M":"L"} ${R.x} ${R.y}`).join(" ")} L ${I} ${150-l.bottom} L ${l.left} ${150-l.bottom} Z`,fill:"rgba(59, 130, 246, 0.2)"}),_.jsx("path",{d:`M ${I} ${y.find(R=>R.time>=m)?.y||l.top} ${y.filter(R=>R.time>m).map(R=>`L ${R.x} ${R.y}`).join(" ")} L ${400-l.right} ${150-l.bottom} L ${I} ${150-l.bottom} Z`,fill:"rgba(59, 130, 246, 0.08)"}),_.jsx("path",{d:T,fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),n.map((R,L)=>{const j=l.left+(R.time.getTime()-t.getTime())/f*u,k=l.top+h-(R.height-.2)/2.3*h;return j<l.left||j>400-l.right?null:_.jsx("circle",{cx:j,cy:k,r:"4",fill:R.type==="high"?"#22c55e":"#ef4444",stroke:"white",strokeWidth:"2"},L)}),_.jsx("line",{x1:I,y1:l.top,x2:I,y2:150-l.bottom,stroke:"#f59e0b",strokeWidth:"2"}),_.jsx("text",{x:I,y:l.top-5,fontSize:"9",fill:"#f59e0b",textAnchor:"middle",fontWeight:"bold",children:"NU"}),_.jsx("line",{x1:S,y1:l.top,x2:S,y2:150-l.bottom,stroke:"#8b5cf6",strokeWidth:"1",strokeDasharray:"3,3"}),_.jsx("circle",{cx:S,cy:A,r:"6",fill:"#8b5cf6",stroke:"white",strokeWidth:"2"})]})}function z2(n){return n===0?_.jsx(oH,{size:16,className:"text-yellow-500"}):n<=3?_.jsx(fd,{size:16,className:"text-gray-400"}):n<=49?_.jsx(fd,{size:16,className:"text-gray-500"}):n<=69?_.jsx(tK,{size:16,className:"text-blue-500"}):n<=79?_.jsx(iK,{size:16,className:"text-cyan-500"}):n<=99?_.jsx(J$,{size:16,className:"text-purple-500"}):_.jsx(fd,{size:16,className:"text-gray-400"})}function eX(n){return n===0?"Helder":n<=3?"Bewolkt":n<=49?"Mist":n<=59?"Motregen":n<=69?"Regen":n<=79?"Sneeuw":n<=99?"Onweer":"Onbekend"}function tX(){const n=Fd(A=>A.hourlyForecast),e=Fd(A=>A.getWeatherAtTime),t=at(A=>A.showForecastSlider),[i,r]=q.useState(!1),[s,o]=q.useState(0),[l,u]=q.useState(!1),h=new Date,f=n.findIndex(A=>new Date(A.time)>=h),m=s-24,y=new Date(h.getTime()+m*60*60*1e3),x=e(y);if(q.useEffect(()=>{if(!l)return;const A=setInterval(()=>{o(D=>D>=72?(u(!1),72):D+1)},200);return()=>clearInterval(A)},[l]),!t||n.length===0)return null;const T=A=>A.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"}),I=A=>{const D=new Date,N=new Date(D);N.setDate(N.getDate()+1);const R=new Date(D);return R.setDate(R.getDate()-1),A.toDateString()===D.toDateString()?"Vandaag":A.toDateString()===N.toDateString()?"Morgen":A.toDateString()===R.toDateString()?"Gisteren":A.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})},S=A=>["N","NO","O","ZO","Z","ZW","W","NW"][Math.round(A/45)%8];return _.jsxs(_.Fragment,{children:[_.jsxs(Ve.button,{className:"fixed bottom-44 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none",onClick:()=>r(!0),whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsx(Ex,{size:18,className:"text-blue-500"}),_.jsx("span",{className:"text-xs text-gray-600",children:"Forecast"})]}),_.jsx(li,{children:i&&_.jsx(Ve.div,{className:"fixed inset-0 z-[2000] flex items-end justify-center bg-black/30",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>r(!1),children:_.jsxs(Ve.div,{className:"bg-white rounded-t-2xl shadow-xl p-4 w-full max-w-md",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:A=>A.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[_.jsx(Ex,{size:18,className:"text-blue-500"}),"Weersvoorspelling"]}),_.jsx("button",{onClick:()=>r(!1),className:"p-1 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(bi,{size:18,className:"text-gray-500"})})]}),_.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsxs("div",{children:[_.jsx("div",{className:"text-lg font-bold text-gray-800",children:T(y)}),_.jsx("div",{className:"text-sm text-gray-500",children:I(y)})]}),x&&_.jsxs("div",{className:"flex items-center gap-2",children:[z2(x.weatherCode),_.jsx("span",{className:"text-sm text-gray-600",children:eX(x.weatherCode)})]})]}),x&&_.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-3",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(jw,{size:16,className:"text-orange-500"}),_.jsxs("span",{className:"text-sm font-medium",children:[Math.round(x.temperature),"C"]})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(zw,{size:16,className:"text-blue-500"}),_.jsxs("span",{className:"text-sm font-medium",children:[Math.round(x.windSpeed)," km/u"]})]}),_.jsx("div",{className:"text-right text-sm text-gray-500",children:S(x.windDirection)})]})]}),_.jsxs("div",{className:"mb-4",children:[_.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[_.jsx("span",{children:"-24u"}),_.jsx("span",{className:"font-medium text-blue-500",children:"Nu"}),_.jsx("span",{children:"+48u"})]}),_.jsxs("div",{className:"relative",children:[_.jsx("input",{type:"range",min:"0",max:"72",value:s,onChange:A=>o(parseInt(A.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, #93c5fd 0%, #93c5fd ${24/72*100}%, #3b82f6 ${24/72*100}%, #3b82f6 ${s/72*100}%, #e5e7eb ${s/72*100}%, #e5e7eb 100%)`}}),_.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-1 h-4 bg-blue-600 rounded",style:{left:`${24/72*100}%`}})]})]}),_.jsxs("div",{className:"flex items-center justify-center gap-4",children:[_.jsx("button",{onClick:()=>o(0),className:"px-3 py-1.5 text-xs text-gray-600 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:"Start"}),_.jsx("button",{onClick:()=>u(!l),className:"p-2 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition-colors border-0 outline-none",children:l?_.jsx(LD,{size:16}):_.jsx(OD,{size:16})}),_.jsx("button",{onClick:()=>o(24),className:"px-3 py-1.5 text-xs text-gray-600 hover:bg-gray-100 rounded-lg transition-colors border-0 outline-none bg-transparent",children:"Nu"})]}),_.jsx("div",{className:"mt-4 overflow-x-auto",children:_.jsx("div",{className:"flex gap-2 pb-2",children:n.slice(f,f+12).map((A,D)=>{const N=new Date(A.time),R=Math.abs(N.getTime()-y.getTime())<1800*1e3;return _.jsxs("button",{onClick:()=>{const L=(N.getTime()-h.getTime())/36e5;o(24+Math.round(L))},className:`flex flex-col items-center p-2 rounded-lg min-w-[50px] transition-colors border-0 outline-none ${R?"bg-blue-100":"bg-gray-50 hover:bg-gray-100"}`,children:[_.jsxs("span",{className:"text-[10px] text-gray-500",children:[N.getHours().toString().padStart(2,"0"),":00"]}),z2(A.weatherCode),_.jsxs("span",{className:"text-xs font-medium",children:[Math.round(A.temperature),""]})]},D)})})})]})})})]})}function nX(){const[n,e]=q.useState(!1),{station:t,waterData:i,lastUpdated:r,isLoading:s,fetchData:o,setStation:l,setStationByPosition:u}=k$(),h=ii(T=>T.position),f=at(T=>T.showWaterDataWidget);if(q.useEffect(()=>{h&&u(h.lat,h.lng)},[h,u]),q.useEffect(()=>{o();const T=setInterval(o,600*1e3);return()=>clearInterval(T)},[o,t]),!f)return null;const m=T=>T<8?"text-blue-600":T<14?"text-cyan-500":T<18?"text-green-500":"text-orange-500",y=T=>T<30?"Kalm":T<60?"Licht":T<100?"Matig":T<150?"Ruw":"Hoog",x=T=>T<30?"text-green-500":T<60?"text-green-400":T<100?"text-yellow-500":T<150?"text-orange-500":"text-red-500";return _.jsxs(_.Fragment,{children:[_.jsxs(Ve.button,{className:"fixed bottom-60 left-2 z-[700] bg-white/90 backdrop-blur-sm rounded-xl shadow-sm p-2 flex items-center gap-2 border-0 outline-none",onClick:()=>e(!0),whileHover:{scale:1.02},whileTap:{scale:.98},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[_.jsx(Tx,{size:18,className:"text-cyan-500"}),_.jsxs("div",{className:"text-left",children:[_.jsx("div",{className:"text-[10px] text-gray-500 truncate max-w-[80px]",children:t?.name||"Water"}),i?.temperature!==void 0&&_.jsxs("div",{className:`text-xs font-medium ${m(i.temperature)}`,children:[i.temperature.toFixed(1),"C"]})]})]}),_.jsx(li,{children:n&&_.jsx(Ve.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1),children:_.jsxs(Ve.div,{className:"bg-white rounded-xl shadow-xl w-full max-w-sm max-h-[90vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:T=>T.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-cyan-500 to-blue-500",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Tx,{size:20,className:"text-white"}),_.jsx("span",{className:"font-semibold text-white",children:"Waterdata"})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("button",{onClick:()=>o(),className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",disabled:s,children:_.jsx(BK,{size:18,className:`text-white ${s?"animate-spin":""}`})}),_.jsx("button",{onClick:()=>e(!1),className:"p-1 hover:bg-white/20 rounded-lg transition-colors border-0 outline-none bg-transparent",children:_.jsx(bi,{size:20,className:"text-white"})})]})]}),_.jsxs("div",{className:"p-4 space-y-4",children:[_.jsx("div",{className:"flex items-center gap-2",children:_.jsx("select",{value:t?.id||"",onChange:T=>{const I=qd.find(S=>S.id===T.target.value);I&&l(I)},className:"flex-1 p-2 border border-gray-200 rounded-lg text-sm bg-white",children:qd.map(T=>_.jsx("option",{value:T.id,children:T.name},T.id))})}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-4",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.jsx(jw,{size:18,className:"text-cyan-500"}),_.jsx("span",{className:"text-xs text-gray-500",children:"Watertemperatuur"})]}),i?.temperature!==void 0?_.jsxs("div",{className:`text-2xl font-bold ${m(i.temperature)}`,children:[i.temperature.toFixed(1),"C"]}):_.jsx("div",{className:"text-gray-400",children:"-"}),_.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:i?.temperature!==void 0&&(i.temperature<10?"Koud - minder activiteit":i.temperature<15?"Goed voor roofvis":"Warm - actieve vis")})]}),_.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.jsx(Yd,{size:18,className:"text-blue-500"}),_.jsx("span",{className:"text-xs text-gray-500",children:"Golfhoogte"})]}),i?.waveHeight!==void 0?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:`text-2xl font-bold ${x(i.waveHeight)}`,children:[i.waveHeight," cm"]}),_.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:y(i.waveHeight)})]}):_.jsx("div",{className:"text-gray-400",children:"-"})]}),_.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-4",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.jsx(gd,{size:18,className:"text-green-500"}),_.jsx("span",{className:"text-xs text-gray-500",children:"Stroomsnelheid"})]}),i?.currentSpeed!==void 0?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[i.currentSpeed," cm/s"]}),_.jsx("div",{className:"text-[10px] text-gray-400 mt-1",children:i.currentSpeed<20?"Zwak":i.currentSpeed<50?"Matig":"Sterk"})]}):_.jsx("div",{className:"text-gray-400",children:"-"})]}),_.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-4",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.jsx(gd,{size:18,className:"text-purple-500"}),_.jsx("span",{className:"text-xs text-gray-500",children:"Stroomrichting"})]}),i?.currentDirection!==void 0?_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("div",{className:"w-8 h-8 flex items-center justify-center",style:{transform:`rotate(${i.currentDirection}deg)`},children:_.jsx(gd,{size:24,className:"text-purple-500",fill:"currentColor"})}),_.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[Math.round(i.currentDirection),""]})]}):_.jsx("div",{className:"text-gray-400",children:"-"})]})]}),i?.temperature!==void 0&&_.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[_.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Visactiviteit"}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:_.jsx("div",{className:`h-full transition-all ${i.temperature<5?"w-1/6 bg-blue-500":i.temperature<10?"w-2/6 bg-cyan-500":i.temperature<15?"w-4/6 bg-green-500":i.temperature<20?"w-5/6 bg-yellow-500":"w-3/6 bg-orange-500"}`})}),_.jsx("span",{className:"text-xs text-gray-500",children:i.temperature<5?"Zeer laag":i.temperature<10?"Laag":i.temperature<15?"Goed":i.temperature<20?"Uitstekend":"Goed"})]})]}),_.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx(Vw,{size:12}),_.jsx("span",{children:"Bron: Rijkswaterstaat"})]}),r&&_.jsxs("span",{children:["Bijgewerkt: ",r.toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})]})]})]})]})})})]})}const Ep=[{name:"Snoek",category:"roofvis"},{name:"Snoekbaars",category:"roofvis"},{name:"Baars",category:"roofvis"},{name:"Meerval",category:"roofvis"},{name:"Karper",category:"karperachtig"},{name:"Brasem",category:"karperachtig"},{name:"Voorn",category:"karperachtig"},{name:"Zeelt",category:"karperachtig"},{name:"Kolblei",category:"karperachtig"},{name:"Winde",category:"karperachtig"},{name:"Blankvoorn",category:"karperachtig"},{name:"Ruisvoorn",category:"karperachtig"},{name:"Forel",category:"forel"},{name:"Regenboogforel",category:"forel"},{name:"Beekforel",category:"forel"},{name:"Paling",category:"aal"},{name:"Zeebaars",category:"zout"},{name:"Harder",category:"zout"},{name:"Makreel",category:"zout"},{name:"Horsmakreel",category:"zout"},{name:"Bot",category:"zout"},{name:"Tong",category:"zout"},{name:"Pos",category:"overig"},{name:"Spiering",category:"overig"},{name:"Anders",category:"overig"}],iX=["Spinfissen","Feedervissen","Karpervissen","Vliegvissen","Dropshot","Streetfishing","Sleepvissen","Kunstaas","Levend aas","Match vissen","Anders"],rX=["Wobbler","Twister","Shad","Spinner","Lepel","Jerkbait","Crankbait","Worm","Made","Mais","Brood","Boilie","Pellet","Witvis","Garnaal","Droge vlieg","Natte vlieg","Nymf","Streamer","Anders"],iv=5;function sX({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:i}){const r=q.useRef(null),s=q.useRef(null),o=async u=>{const h=u.target.files;if(!h||h.length===0)return;const f=iv-n.length,m=Array.from(h).slice(0,f);for(const y of m)try{const{thumbnailBase64:x}=await VD(y),T={id:jD(),thumbnailBase64:x,createdAt:new Date().toISOString(),pendingUpload:!0};e(T)}catch(x){console.error("Failed to process image:",x)}u.target.value=""},l=n.length<iv;return _.jsxs("div",{className:"space-y-2",children:[_.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",iv,")"]}),_.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(u=>_.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[_.jsx("img",{src:u.thumbnailUrl||u.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!i&&_.jsx("button",{type:"button",onClick:()=>t(u.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:_.jsx(bi,{size:12,className:"text-white"})}),u.pendingUpload&&_.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Lokaal"})]},u.id)),l&&!i&&_.jsxs(_.Fragment,{children:[_.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[_.jsx(Fw,{size:20,className:"text-gray-400"}),_.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),_.jsxs("button",{type:"button",onClick:()=>r.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-green-400 hover:bg-green-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[_.jsx(mK,{size:20,className:"text-gray-400"}),_.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),_.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),_.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}const oX={Snoek:{colors:["green","yellow","spotted"],pattern:"elongated with spots"},Snoekbaars:{colors:["gray","silver","striped"],pattern:"elongated with stripes"},Baars:{colors:["green","black","striped","red-fins"],pattern:"oval with stripes"},Karper:{colors:["brown","gold","orange"],pattern:"large oval"},Brasem:{colors:["silver","bronze"],pattern:"flat oval"},Voorn:{colors:["silver","red-fins"],pattern:"small oval"},Zeelt:{colors:["green","brown","slimy"],pattern:"elongated"},Meerval:{colors:["dark","brown","black"],pattern:"large with whiskers"},Aal:{colors:["dark","silver-belly"],pattern:"snake-like"},Forel:{colors:["spotted","pink","silver"],pattern:"streamlined with spots"}};async function aX(n){return new Promise(e=>{const t=new Image;t.onload=()=>{const i=document.createElement("canvas"),r=i.getContext("2d");if(!r){e([]);return}const s=100;i.width=s,i.height=s;const o=(t.width-s)/2,l=(t.height-s)/2;r.drawImage(t,o,l,s,s,0,0,s,s);const h=r.getImageData(0,0,s,s).data;let f=0,m=0,y=0,x=0,T=0,I=0;const S=h.length/4;for(let R=0;R<h.length;R+=4){const L=h[R],j=h[R+1],k=h[R+2];f+=L,m+=j,j>L&&j>k&&y++,L>100&&j>80&&j<150&&k<100&&x++,L>150&&j>150&&k>150&&T++,L<80&&j<80&&k<80&&I++}const A=[];y/S>.2&&A.push("green"),x/S>.2&&A.push("brown"),T/S>.2&&A.push("silver"),I/S>.3&&A.push("dark");const D=f/S,N=m/S;D>150&&N>100&&N<180&&A.push("gold"),e(A)},t.src=n})}function lX(n){const e=[];for(const[t,i]of Object.entries(oX)){let r=0;for(const s of n)i.colors.some(o=>o.includes(s)||s.includes(o))&&r++;r>0&&e.push({species:t,score:r/i.colors.length})}return e.sort((t,i)=>i.score-t.score)}async function cX(n){try{const e=await aX(n),t=lX(e);if(t.length===0)return{species:"",confidence:0,suggestions:Ep.slice(0,5).map(o=>o.name)};const i=t[0],r=t.slice(0,5).map(o=>o.species),s=["Snoek","Baars","Karper","Snoekbaars","Brasem"];for(const o of s)!r.includes(o)&&r.length<5&&r.push(o);return{species:i.score>.3?i.species:"",confidence:i.score,suggestions:r.slice(0,5)}}catch(e){return console.error("Fish recognition error:",e),{species:"",confidence:0,suggestions:Ep.slice(0,5).map(t=>t.name)}}}function uX(n){return{Snoek:{avgWeight:3e3,avgLength:70},Snoekbaars:{avgWeight:2500,avgLength:60},Baars:{avgWeight:500,avgLength:30},Karper:{avgWeight:8e3,avgLength:60},Brasem:{avgWeight:2e3,avgLength:45},Voorn:{avgWeight:300,avgLength:25},Zeelt:{avgWeight:1500,avgLength:40},Meerval:{avgWeight:15e3,avgLength:120},Aal:{avgWeight:800,avgLength:60},Forel:{avgWeight:1e3,avgLength:40},Kolblei:{avgWeight:500,avgLength:30},Winde:{avgWeight:1e3,avgLength:40},Kopvoorn:{avgWeight:800,avgLength:35},Ruisvoorn:{avgWeight:400,avgLength:25},Blankvoorn:{avgWeight:300,avgLength:25}}[n]||null}function hX({onClose:n,initialLocation:e,initialLocationSource:t,initialPhotos:i=[]}){const r=HP(ie=>ie.addCatch),s=Fd(ie=>ie.current),o=ii(ie=>ie.position),[l,u]=q.useState(e||(o?{lat:o.lat,lng:o.lng}:null)),[h,f]=q.useState(t||(o?"gps":null)),[m,y]=q.useState(""),[x,T]=q.useState(""),[I,S]=q.useState(""),[A,D]=q.useState(""),[N,R]=q.useState(""),[L,j]=q.useState(""),[k,b]=q.useState(i),[M,V]=q.useState(!1),[z,B]=q.useState([]),[O,le]=q.useState(0),me=async ie=>{if(b(pe=>[...pe,ie]),ie.dataUrl&&!m){V(!0);try{const pe=await cX(ie.dataUrl);if(B(pe.suggestions),le(pe.confidence),pe.species&&pe.confidence>.4){y(pe.species);const xe=uX(pe.species)}}catch(pe){console.error("AI recognition failed:",pe)}finally{V(!1)}}},ge=ie=>{y(ie),B([])},ue=ie=>{b(pe=>pe.filter(xe=>xe.id!==ie))},Q=()=>{o&&(u({lat:o.lat,lng:o.lng}),f("gps"))},se=ie=>{if(ie.preventDefault(),!m||!l){alert("Selecteer een vissoort en zorg dat er een locatie is");return}r({location:l,species:m,weight:x?parseInt(x):void 0,length:I?parseInt(I):void 0,photos:k.length>0?k:void 0,method:A||"Anders",bait:N||void 0,notes:L||void 0,weather:s?{temp:s.temperature,windSpeed:s.windSpeed,windDirection:s.windDirection,pressure:s.pressure}:void 0}),n()},G=(()=>{switch(h){case"gps":return{icon:gd,label:"GPS",color:"text-blue-500"};case"photo":return{icon:Fw,label:"Foto EXIF",color:"text-green-500"};case"map":return{icon:wy,label:"Kaart",color:"text-orange-500"};default:return{icon:bl,label:"Locatie",color:"text-gray-500"}}})(),$=G.icon;return _.jsx(Ve.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(Ve.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:ie=>ie.stopPropagation(),children:[_.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Ys,{className:"text-white",size:24}),_.jsx("h2",{className:"text-lg font-semibold",children:"Vangst registreren"})]}),_.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:_.jsx(bi,{size:20})})]}),_.jsxs("form",{onSubmit:se,className:"p-4 space-y-4",children:[_.jsx("div",{className:"space-y-2",children:l?_.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-gray-50 p-2 rounded-lg",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx($,{size:16,className:G.color}),_.jsxs("span",{className:"text-gray-600",children:[l.lat.toFixed(5),", ",l.lng.toFixed(5)]})]}),_.jsx("span",{className:`text-xs ${G.color} font-medium`,children:G.label})]}):_.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm bg-red-50 p-2 rounded-lg text-red-600",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(bl,{size:16}),_.jsx("span",{children:"Geen locatie"})]}),o&&_.jsx("button",{type:"button",onClick:Q,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded-md border-0 outline-none",children:"Gebruik GPS"})]})}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:["Vissoort *",M&&_.jsxs("span",{className:"flex items-center gap-1 text-xs text-blue-500",children:[_.jsx(vK,{size:12,className:"animate-spin"}),"AI analyseert..."]})]}),_.jsx(li,{children:z.length>0&&!m&&_.jsxs(Ve.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-2 p-2 bg-blue-50 rounded-lg border border-blue-200",children:[_.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mb-2",children:[_.jsx(iH,{size:12}),_.jsxs("span",{children:["AI suggesties ",O>.3?`(${Math.round(O*100)}% zeker)`:""]})]}),_.jsx("div",{className:"flex flex-wrap gap-1",children:z.map(ie=>_.jsx("button",{type:"button",onClick:()=>ge(ie),className:"px-2 py-1 text-xs bg-white border border-blue-300 text-blue-700 rounded-full hover:bg-blue-100 transition-colors",children:ie},ie))})]})}),_.jsxs("select",{value:m,onChange:ie=>{y(ie.target.value),B([])},className:"form-select",required:!0,children:[_.jsx("option",{value:"",children:"Selecteer vissoort..."}),Ep.map(ie=>_.jsx("option",{value:ie.name,children:ie.name},ie.name))]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(YK,{size:14,className:"inline mr-1"}),"Gewicht (gram)"]}),_.jsx("input",{type:"number",value:x,onChange:ie=>T(ie.target.value),placeholder:"bijv. 1500",className:"form-input"})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(KK,{size:14,className:"inline mr-1"}),"Lengte (cm)"]}),_.jsx("input",{type:"number",value:I,onChange:ie=>S(ie.target.value),placeholder:"bijv. 45",className:"form-input"})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vismethode"}),_.jsxs("select",{value:A,onChange:ie=>D(ie.target.value),className:"form-select",children:[_.jsx("option",{value:"",children:"Selecteer methode..."}),iX.map(ie=>_.jsx("option",{value:ie,children:ie},ie))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aas"}),_.jsxs("select",{value:N,onChange:ie=>R(ie.target.value),className:"form-select",children:[_.jsx("option",{value:"",children:"Selecteer aas..."}),rX.map(ie=>_.jsx("option",{value:ie,children:ie},ie))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),_.jsx("textarea",{value:L,onChange:ie=>j(ie.target.value),placeholder:"Extra opmerkingen...",className:"form-input resize-none",rows:2})]}),_.jsx(sX,{photos:k,onAddPhoto:me,onRemovePhoto:ue}),_.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Vangst opslaan"})]})]})})}function dX(){const n=ri(h=>h.catchFormOpen),e=ri(h=>h.catchFormLocation),t=ri(h=>h.catchFormLocationSource),i=ri(h=>h.catchFormInitialPhotos),r=ri(h=>h.openCatchForm),s=ri(h=>h.closeCatchForm),o=ii(h=>h.position),l=at(h=>h.showCatchButton),u=()=>{o?r({location:{lat:o.lat,lng:o.lng},locationSource:"gps"}):r()};return _.jsxs(_.Fragment,{children:[l&&_.jsx(Ve.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-green-500 hover:bg-green-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",onClick:u,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Vangst toevoegen",title:"Vangst toevoegen",children:_.jsx(Ys,{size:22,strokeWidth:2})}),_.jsx(li,{children:n&&_.jsx(hX,{onClose:s,initialLocation:e||void 0,initialLocationSource:t||void 0,initialPhotos:i})})]})}function fX(){const n=Js(r=>r.map),e=HP(r=>r.catches),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new P1,t.current=new j1({source:i.current,zIndex:500}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=ml([r.location.lng,r.location.lat]),o=new au({geometry:new pl(s),catchData:r}),l=r.species.charAt(0).toUpperCase();o.setStyle(new Qi({image:new Nl({radius:14,fill:new Ir({color:"#22c55e"}),stroke:new ku({color:"#fff",width:2})}),text:new lf({text:l,font:"bold 12px sans-serif",fill:new Ir({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function gX(){const n=Js(r=>r.map),e=XP(r=>r.spots),t=q.useRef(null),i=q.useRef(null);return q.useEffect(()=>{if(n)return i.current=new P1,t.current=new j1({source:i.current,zIndex:450}),n.addLayer(t.current),()=>{t.current&&n&&n.removeLayer(t.current)}},[n]),q.useEffect(()=>{i.current&&(i.current.clear(),e.forEach(r=>{const s=ml([r.location.lng,r.location.lat]),o=new au({geometry:new pl(s),spotData:r}),l=r.rating>=4?"#f59e0b":r.rating>=2?"#fbbf24":"#d1d5db";o.setStyle(new Qi({image:new Nl({radius:12,fill:new Ir({color:l}),stroke:new ku({color:"#fff",width:2})}),text:new lf({text:"",font:"bold 14px sans-serif",fill:new Ir({color:"#fff"}),offsetY:1})})),i.current.addFeature(o)}))},[e]),null}function mX({onClose:n,initialLocation:e}){const t=XP(S=>S.addSpot),[i,r]=q.useState(""),[s,o]=q.useState(""),[l,u]=q.useState([]),[h,f]=q.useState(""),[m,y]=q.useState(3),x=e,T=S=>{u(A=>A.includes(S)?A.filter(D=>D!==S):[...A,S])},I=S=>{if(S.preventDefault(),!i||!x){alert("Geef een naam op voor deze locatie");return}t({name:i,location:x,waterBody:s||void 0,fishTypes:l,notes:h||void 0,rating:m}),n()};return _.jsx(Ve.div,{className:"fixed inset-0 z-[2000] flex items-end sm:items-center justify-center bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,children:_.jsxs(Ve.div,{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},onClick:S=>S.stopPropagation(),children:[_.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 text-white px-4 py-3 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Sx,{className:"text-white",size:24}),_.jsx("h2",{className:"text-lg font-semibold",children:"Locatie vastleggen"})]}),_.jsx("button",{onClick:n,className:"p-1.5 border-0 outline-none bg-transparent text-white/80 hover:text-white transition-colors",children:_.jsx(bi,{size:20})})]}),_.jsxs("form",{onSubmit:I,className:"p-4 space-y-4",children:[x&&_.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 p-2 rounded-lg",children:[_.jsx(bl,{size:16}),_.jsxs("span",{children:[x.lat.toFixed(5),", ",x.lng.toFixed(5)]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam *"}),_.jsx("input",{type:"text",value:i,onChange:S=>r(S.target.value),placeholder:"bijv. Mijn favoriete stek",className:"form-input",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water"}),_.jsx("input",{type:"text",value:s,onChange:S=>o(S.target.value),placeholder:"bijv. IJsselmeer, Waal, etc.",className:"form-input"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beoordeling"}),_.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(S=>_.jsx("button",{type:"button",onClick:()=>y(S),className:"p-1 border-0 outline-none bg-transparent",children:_.jsx(Sx,{size:28,className:S<=m?"text-yellow-400 fill-yellow-400":"text-gray-300"})},S))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Welke vis zit hier?"}),_.jsx("div",{className:"flex flex-wrap gap-2",children:Ep.slice(0,12).map(S=>_.jsx("button",{type:"button",onClick:()=>T(S.name),className:`px-3 py-1.5 text-sm rounded-full border-0 outline-none transition-colors ${l.includes(S.name)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S.name},S.name))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notities"}),_.jsx("textarea",{value:h,onChange:S=>f(S.target.value),placeholder:"Tips, omstandigheden, etc.",className:"form-input resize-none",rows:2})]}),_.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 rounded-xl transition-colors",children:"Locatie opslaan"})]})]})})}const pX=[{name:"Aanlegsteigers",icon:kD,color:"#2196F3"},{name:"Boothellingen",icon:tH,color:"#4CAF50"},{name:"Dieptekaart",icon:Yd,color:"#00BCD4"},{name:"Viswater",icon:bl,color:"#9C27B0"}],U2=[{name:"OpenStreetMap",label:"Kaart"},{name:"Luchtfoto",label:"Satelliet"}];function yX(){const[n,e]=q.useState(!1),t=Yo(l=>l.visible),i=Yo(l=>l.toggleLayer),r=Yo(l=>l.setLayerVisibility),s=l=>{U2.forEach(u=>{r(u.name,u.name===l)}),l==="Luchtfoto"?r("Labels Overlay",!0):r("Labels Overlay",!1)},o=()=>{r("Labels Overlay",!t["Labels Overlay"])};return _.jsxs("div",{className:"fixed bottom-[60px] right-2 z-[900]",children:[_.jsx(Ve.button,{className:"w-11 h-11 bg-white/90 hover:bg-white backdrop-blur-sm rounded-xl shadow-sm flex items-center justify-center text-gray-600 border-0 outline-none transition-colors",onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Kaartlagen",children:_.jsx(wp,{size:22})}),_.jsx(li,{children:n&&_.jsxs(_.Fragment,{children:[_.jsx(Ve.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),_.jsxs(Ve.div,{className:"absolute bottom-12 right-0 bg-white rounded-xl shadow-lg overflow-hidden min-w-[200px]",initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},children:[_.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600",children:_.jsx("span",{className:"font-medium text-white text-sm",children:"Kaartlagen"})}),_.jsxs("div",{className:"p-2",children:[_.jsxs("div",{className:"mb-2 pb-2 border-b border-gray-100",children:[_.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Achtergrond"}),_.jsx("div",{className:"flex gap-1",children:U2.map(l=>_.jsx("button",{className:`flex-1 px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t[l.name]?"bg-blue-500 text-white":"bg-transparent text-gray-600 hover:bg-blue-50"}`,onClick:()=>s(l.name),children:l.label},l.name))}),t.Luchtfoto&&_.jsxs("button",{onClick:o,className:`mt-1.5 w-full flex items-center justify-between px-2 py-1.5 text-xs rounded-lg transition-colors border-0 outline-none ${t["Labels Overlay"]?"bg-blue-50 text-blue-600":"bg-transparent text-gray-500 hover:bg-blue-50"}`,children:[_.jsxs("span",{className:"flex items-center gap-1.5",children:[_.jsx(lH,{size:12}),"Labels overlay"]}),t["Labels Overlay"]&&_.jsx(wx,{size:12})]})]}),_.jsx("div",{className:"text-xs font-medium text-gray-400 mb-1.5 px-1",children:"Kaartlagen"}),_.jsx("div",{className:"space-y-0.5",children:pX.map(l=>{const u=l.icon,h=t[l.name];return _.jsxs("button",{className:`w-full flex items-center gap-2 px-2 py-2 rounded-lg transition-colors border-0 outline-none ${h?"bg-blue-50":"bg-transparent hover:bg-blue-50"}`,onClick:()=>i(l.name),children:[_.jsx("div",{className:"w-6 h-6 rounded-md flex items-center justify-center transition-colors",style:{backgroundColor:h?l.color:"#e5e7eb"},children:_.jsx(u,{size:14,className:"text-white"})}),_.jsx("span",{className:`text-sm ${h?"text-blue-700":"text-gray-600"}`,children:l.name}),_.jsx("div",{className:"ml-auto",children:_.jsx("div",{className:"w-4 h-4 rounded flex items-center justify-center transition-all",style:{backgroundColor:h?"#3b82f6":"transparent",border:h?"2px solid #3b82f6":"2px solid #93c5fd"},children:h&&_.jsx(wx,{size:10,className:"text-white",strokeWidth:3})})})]},l.name)})})]})]})]})})]})}function _X(){const n=ri(R=>R.settingsPanelOpen),e=ri(R=>R.toggleSettingsPanel),t=at(R=>R.showCatchButton),i=at(R=>R.setShowCatchButton),r=at(R=>R.showCatches),s=at(R=>R.setShowCatches),o=at(R=>R.showFavoriteSpots),l=at(R=>R.setShowFavoriteSpots),u=at(R=>R.defaultBackground),h=at(R=>R.setDefaultBackground),f=at(R=>R.showWeatherWidget),m=at(R=>R.setShowWeatherWidget),y=at(R=>R.showWindIndicator),x=at(R=>R.setShowWindIndicator),T=at(R=>R.showTideWidget),I=at(R=>R.setShowTideWidget),S=at(R=>R.showForecastSlider),A=at(R=>R.setShowForecastSlider),D=at(R=>R.showWaterDataWidget),N=at(R=>R.setShowWaterDataWidget);return n?_.jsx(Ve.div,{className:"fixed inset-0 z-[1100] flex items-center justify-center p-4 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:_.jsxs(Ve.div,{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm max-h-[80vh] overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:R=>R.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:[_.jsx("h2",{className:"text-lg font-semibold text-white",children:"Instellingen"}),_.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:_.jsx(bi,{size:20,className:"text-white"})})]}),_.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Vangsten"}),_.jsx(Lo,{icon:_.jsx(Ys,{size:18,className:"text-green-500"}),label:"Vangst registreren knop",description:"Toon de groene vis-knop",checked:t,onChange:i}),_.jsx(Lo,{icon:_.jsx(Ys,{size:18,className:"text-blue-500"}),label:"Vangsten op kaart",description:"Toon geregistreerde vangsten",checked:r,onChange:s})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Favoriete plekken"}),_.jsx(Lo,{icon:_.jsx(bl,{size:18,className:"text-yellow-500"}),label:"Favoriete plekken op kaart",description:"Toon opgeslagen visplekken",checked:o,onChange:l})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Kaart"}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:_.jsx(wy,{size:18,className:"text-gray-500"})}),_.jsxs("div",{className:"flex-1",children:[_.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Standaard achtergrond"}),_.jsxs("select",{value:u,onChange:R=>h(R.target.value),className:"mt-1 w-full px-2 py-1 text-sm border border-gray-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-400",children:[_.jsx("option",{value:"OpenStreetMap",children:"OpenStreetMap"}),_.jsx("option",{value:"Luchtfoto",children:"Satelliet"})]})]})]})]}),_.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Weer & Water"}),_.jsx(Lo,{icon:_.jsx(fd,{size:18,className:"text-blue-400"}),label:"Weer widget",description:"Temperatuur, wind, luchtdruk en solunar",checked:f,onChange:m}),_.jsx(Lo,{icon:_.jsx(zw,{size:18,className:"text-cyan-500"}),label:"Wind kompas",description:"Windrichting en snelheid indicator",checked:y,onChange:x}),_.jsx(Lo,{icon:_.jsx(Yd,{size:18,className:"text-blue-500"}),label:"Getijden",description:"Hoog- en laagwater tijden",checked:T,onChange:I}),_.jsx(Lo,{icon:_.jsx(Ex,{size:18,className:"text-purple-500"}),label:"Weersvoorspelling",description:"Tijdslider met 72 uur forecast",checked:S,onChange:A}),_.jsx(Lo,{icon:_.jsx(Tx,{size:18,className:"text-cyan-500"}),label:"Waterdata (RWS)",description:"Temperatuur, golven, stroming",checked:D,onChange:N})]})]}),_.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center text-xs text-gray-400",children:"Instellingen worden automatisch opgeslagen"})]})}):null}function Lo({icon:n,label:e,description:t,checked:i,onChange:r}){return _.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:n}),_.jsxs("div",{className:"flex-1",children:[_.jsx("p",{className:"text-sm font-medium text-gray-700",children:e}),_.jsx("p",{className:"text-xs text-gray-400",children:t})]}),_.jsx("button",{onClick:()=>r(!i),className:`relative w-11 h-6 rounded-full transition-colors border-0 outline-none ${i?"bg-blue-500":"bg-gray-300"}`,children:_.jsx("span",{className:`absolute top-1 w-4 h-4 bg-white rounded-full shadow transition-transform ${i?"left-6":"left-1"}`})})]})}function vX({children:n}){const{isAuthenticated:e,checkPassword:t,signInWithGoogle:i,user:r,loading:s,initAuth:o}=bD(),[l,u]=q.useState(""),[h,f]=q.useState(!1),[m,y]=q.useState(!1),[x,T]=q.useState(null);if(q.useEffect(()=>{o()},[o]),s)return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center",children:_.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"})});if(e)return _.jsx(_.Fragment,{children:n});const I=A=>{A.preventDefault(),t(l)||(f(!0),setTimeout(()=>f(!1),2e3))},S=async()=>{try{T(null),await i()}catch{T("Google login mislukt"),setTimeout(()=>T(null),3e3)}};return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 via-blue-600 to-blue-800 flex items-center justify-center p-4",children:_.jsxs(Ve.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[_.jsxs("div",{className:"flex flex-col items-center mb-6",children:[_.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mb-4 shadow-lg",children:_.jsx(Ys,{size:40,className:"text-white"})}),_.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"VisApp"}),_.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Voor jou en je vismaat"})]}),_.jsxs(Ve.button,{onClick:S,className:"w-full py-3 px-4 bg-white border-2 border-gray-200 rounded-lg font-medium text-gray-700 flex items-center justify-center gap-3 hover:bg-gray-50 hover:border-gray-300 transition-colors mb-4",whileHover:{scale:1.02},whileTap:{scale:.98},children:[_.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[_.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),_.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),_.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),_.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Inloggen met Google"]}),x&&_.jsx(Ve.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center mb-4",children:x}),_.jsxs("div",{className:"flex items-center gap-3 my-4",children:[_.jsx("div",{className:"flex-1 h-px bg-gray-200"}),_.jsx("span",{className:"text-gray-400 text-sm",children:"of"}),_.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),_.jsxs("form",{onSubmit:I,className:"space-y-4",children:[_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:_.jsx(TK,{size:20})}),_.jsx("input",{type:m?"text":"password",value:l,onChange:A=>u(A.target.value),placeholder:"Wachtwoord",className:`w-full pl-10 pr-12 py-3 rounded-lg border-2 transition-colors outline-none ${h?"border-red-400 bg-red-50":"border-gray-200 focus:border-blue-400"}`}),_.jsx("button",{type:"button",onClick:()=>y(!m),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m?_.jsx(lK,{size:20}):_.jsx(uK,{size:20})})]}),h&&_.jsx(Ve.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:"Onjuist wachtwoord"}),_.jsx(Ve.button,{type:"submit",className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-medium shadow-md hover:shadow-lg transition-shadow",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Inloggen"})]}),_.jsx("p",{className:"text-center text-gray-400 text-xs mt-6",children:"Beschermd voor persoonlijk gebruik"})]})})}function xX(){const n=ri(i=>i.spotFormOpen),e=ri(i=>i.spotFormLocation),t=ri(i=>i.closeSpotForm);return _.jsx(vX,{children:_.jsxs("div",{className:"h-screen w-screen overflow-hidden",children:[_.jsx(M$,{}),_.jsx(AH,{}),_.jsx(fX,{}),_.jsx(gX,{}),_.jsx(SH,{}),_.jsx(XH,{}),_.jsx(qH,{}),_.jsx(QH,{}),_.jsx(tX,{}),_.jsx(nX,{}),_.jsx(bH,{}),_.jsx(kH,{}),_.jsx(BH,{}),_.jsx(VH,{}),_.jsx(yX,{}),_.jsx(dX,{}),_.jsx(CH,{}),_.jsx(NH,{}),_.jsx(_X,{}),_.jsx(li,{children:n&&_.jsx(mX,{onClose:t,initialLocation:e||void 0})})]})})}const wX="1.2.8";console.log(`%c VisApp v${wX}`,"background: #2196F3; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");nL.createRoot(document.getElementById("root")).render(_.jsx(xX,{}));export{MX as $,Bb as A,At as B,Nl as C,nt as D,We as E,Ir as F,kj as G,Np as H,V5 as I,gl as J,jb as K,Ub as L,AX as M,Vm as N,Vj as O,PX as P,Wb as Q,Xc as R,Qi as S,L6 as T,pl as U,P1 as V,xb as W,IX as X,CX as Y,bX as Z,LX as _,j1 as a,FI as a0,A4 as a1,b4 as a2,DX as a3,NX as a4,Pd as a5,kX as a6,RX as a7,gr as a8,au as a9,tt as aa,cm as ab,Fm as ac,sP as ad,Nv as ae,ou as af,Nj as ag,ku as b,Bn as c,FX as d,Ji as e,ci as f,ft as g,wC as h,u1 as i,g6 as j,k0 as k,v1 as l,al as m,c1 as n,vb as o,Vb as p,zb as q,SX as r,Oj as s,jp as t,jI as u,Kc as v,VI as w,Fj as x,E1 as y,w1 as z};
//# sourceMappingURL=index-BkBXJc9_.js.map
